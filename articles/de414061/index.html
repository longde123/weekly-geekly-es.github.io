<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÖüèæ üëºüèæ üëµüèª Segne den Jugendstil oder meine Qualen mit Nvidia Optimus. Teil 1. Die Sch√∂nheit der Arch-Dokumentation üßùüèΩ üë©üèª‚Äçüé® üìò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bevor ich anfange 
 Bevor ich mit der Hauptgeschichte beginne, m√∂chte ich einige Punkte klarstellen. Der Artikel richtet sich in erster Linie an Besit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Segne den Jugendstil oder meine Qualen mit Nvidia Optimus. Teil 1. Die Sch√∂nheit der Arch-Dokumentation</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414061/"><h2>  Bevor ich anfange </h2><br>  Bevor ich mit der Hauptgeschichte beginne, m√∂chte ich einige Punkte klarstellen.  Der Artikel richtet sich in erster Linie an Besitzer von Laptops mit Nvidia Optimus-Technologie, die GNU / Linux (im Folgenden: Linux) installieren m√∂chten.  Das Material soll sicherstellen, dass sich das oben genannte Zentralasien mit m√∂glichen L√∂sungen f√ºr das Problem vertraut macht, und seine L√∂sung erleichtern und beschleunigen.  Dar√ºber hinaus ist der Artikel nicht zuletzt <b>motivierend</b> und zielt darauf ab, eine einfache Wahrheit f√ºr die Menschen zu verstehen: Unter Linux wie im Leben gibt es immer eine Problemumgehung, und wenn Sie aufgeben, wird es <i>(in den meisten F√§llen)</i> nicht besser. <br><blockquote>  <b><i>Qui quaerit, reperit</i></b> </blockquote>  <i>- Lateinisches Sprichwort</i> <br><br><h3>  Vorwort </h3><br>  Vorerst war ich ein gew√∂hnlicher Linuxoid.  Ich habe verschiedene Distributionen getestet und langsam neue Dinge gelernt.  Nur weil ich interessiert war.  In der Regel beschr√§nkte sich ‚ÄûWissen‚Äú auf Ubuntu und seine Gabeln sowie Fedora und einige ‚Äûbenutzerfreundliche‚Äú Distributionen.  Aber wie ein anderes lateinisches Sprichwort sagt, Omnia Fluunt, Omnia Mutantur, das hei√üt, alles flie√üt, alles √§ndert sich, und es ist klar, dass dies nicht f√ºr immer weitergehen kann. <br><br><h3>  Alles begann gut </h3><br>  Es sollte angemerkt werden, dass ich nicht viel Platz f√ºr Experimente hatte: einen <i>relativ</i> schwachen PC, der GNOME 3 kaum zog, und ein langsames Internet, das die Gesamtsituation stark komplizierte.  Aber dann mehr f√ºr den Jungen von 12 Jahren und war nicht notwendig.  Am Ende habe ich es satt zu experimentieren, ich habe Windows 10 installiert und Linux f√ºr ein paar Jahre vergessen. <br><br>  Die Zeit verging und nach ungef√§hr 2 Jahren wurde mir klar, dass es Zeit war, mein <s>moosiges St√ºck</s> PC- <s>Eisen</s> zu aktualisieren, und ich begann Geld zu sparen.  Etwas wurde durch den Verkauf seiner Sachen gewonnen, etwas wurde gegeben, mehr als die H√§lfte des Betrags wurde von seinen Eltern geworfen, er musste sogar <s>Opfer bringen</s> , um seine Xbox (!) Zu verkaufen. <a name="habracut"></a>  um Ihre FAQ zu am√ºsieren und Ihre Linux-Kenntnisse zu verbessern.  Dieses Mal habe ich beschlossen, Arch zu installieren.  Ich habe geh√∂rt, dass er sehr gute Unterlagen hat.  Und er fing an. <br><br><h3>  Die Sch√∂nheit der Arch-Dokumentation </h3><br>  Die Installation war schnell und <i>relativ</i> schmerzfrei.  Nochmals vielen Dank an die Dokumentation.  Nach der Installation des von KDE Plasma dargestellten Systems und DE habe ich versucht, den Laptop an meinen externen Monitor anzuschlie√üen, da der Monitor eine Diagonale von 24 'und das Laptop-Display nur 15,6' hat.  Es ist nichts passiert, es war kein Signal auf dem Monitor.  Wie immer fing ich an zu googeln.  Nach 30 Minuten Suche stellte ich fest, dass das Problem bei der Nvidia Optimus-Technologie lag. <br><br><h4>  Ein bisschen √ºber Nvidia Optimus </h4><br>  Nvidia ist eine gute Firma.  In ihrer 25-j√§hrigen Geschichte haben sie viele <i>relativ</i> gute L√∂sungen implementiert.  Nvidia Optimus ist eine solche.  Das Thema ist eine Hybridtechnologie, um den korrekten Betrieb von zwei Grafikkarten (normalerweise leistungsstarke Nvidia-Grafik und integrierter Intel) auf Laptops sicherzustellen.  Wenn es <s>in Windows</s> richtig konfiguriert <s>funktioniert</s> , hilft es, Strom und Laptop-Ressourcen zu sparen.  All dies ist ausgezeichnet, aber was mich dazu veranlasste, dieses Opus zu schreiben, war, dass diese sch√∂ne Technologie unter Linux laut den Entwicklern nur <i>teilweise</i> funktioniert und meiner Meinung nach viel, viel Nerven, Zeit und M√ºhe kostet, um sie zu konfigurieren. <br><br><h3>  Die Sch√∂nheit der Arch-Dokumentation (Fortsetzung) </h3><br>  Nachdem ich die wahre Wurzel des Problems herausgefunden hatte, war ich zun√§chst froh, dass ich festgestellt hatte, ‚Äûwo der Hund begraben ist‚Äú (nur die Nvidia-Karte hatte einen HDMI-Ausgang), und mein erster Schritt bestand darin, die offizielle Arch-Dokumentation zu lesen.  Das Wesentliche war, Xorg.conf und .xinitrc zu verwenden, um X zu zwingen, nur die Nvidia-Karte zu verwenden.  Nach Abschluss dieser Schritte und Neustart ... wurde ein schwarzer Bildschirm angezeigt.  In der Dokumentation hei√üt es, dass in diesem Fall √ºberpr√ºft werden muss, ob in .xinitrc kaufm√§nnisches Und vorhanden ist. Wenn keines vorhanden ist, verwenden Sie die "Alternative Konfiguration", die X dazu zwang, nur eine Intel-Karte zu verwenden.  Dies passte nicht zu mir, da die Intel-Karte bereits standardm√§√üig verwendet wurde und diese Option nicht zu mir passte.  Es gab auch Optionen f√ºr verschiedene DMs.  Sie passten auch nicht, da keiner von ihnen den X-Server aus verschiedenen Gr√ºnden starten konnte. <br>  Jeder von ihnen einzeln zu beschreiben, w√§re eine sehr lange und bedeutungslose √úbung. <br><br><h3>  Qui quaerit, reperit </h3><br>  Dieser Ausdruck in der √úbersetzung aus dem Lateinischen bedeutet "wer sucht, findet".  Es war nicht umsonst, dass ich es am Anfang platziert habe, denn dieser Ausdruck wird f√ºr mich zur idealen Moral f√ºr diesen Artikel. <br><br>  Ich war verzweifelt.  Zwei Tage lang habe ich vergeblich versucht, eine L√∂sung zu finden, die ausl√§ndischen Foren durchsucht (nur auf diesen, da in der orthodoxen LOR die Antwort lautete: Sie k√∂nnen X in keiner Weise √ºber Nvidia starten. Es ist unm√∂glich, sich zu vers√∂hnen).  Trotzdem stie√ü ich an einem wolkigen Morgen des dritten Suchtages auf einen Thread (Link im Keller) im Nvidia-Entwicklungsforum, in dem beschrieben wurde, wie Nvidia Optimus in Arch auf Dell-Laptops implementiert ist.  Mir wurde sofort klar - ich bin gerettet!  Nach den Schritten habe ich neu gestartet und ... einen schwarzen Bildschirm.  Nat√ºrlich war ich ver√§rgert, aber dann erinnerte ich mich: Ich habe mich nicht in der .xinitrc-Zeile registriert, um DE auszuf√ºhren.  Nachdem ich exec startkde geschrieben hatte, startete ich erneut und es funktionierte.  X wurde √ºber Nvidia gestartet.  Ich habe vier lange Tage gebraucht, um Arch zu installieren und zu konfigurieren, und trotzdem habe ich es geschafft! <br><br><h3>  Nachbesprechung </h3><br>  Lassen Sie uns nun die Anweisungen aus dem obigen Thread analysieren.  Fangen wir an: <br><br>  Zun√§chst m√ºssen Sie die KMS-Unterst√ºtzung aktivieren (Kernel Mode Setting, die Methode zur Aufl√∂sung der Aufl√∂sung direkt im Kernel), indem Sie die Kernel-Parameter (Datei / etc / default / grub) in der Zeile GRUB_CMDLINE_LINUX_DEFAULT = parameter hinzuf√ºgen <br><br><pre><code class="bash hljs">nvidia-drm.modeset=1</code> </pre> <br>  Dann erstellen wir ein Skript f√ºr den DM (Login Manager).  Betrachten Sie die Option mit LightDM.  Wir erstellen das Skript /etc/lightdm/display_setup.sh mit folgenden Inhalten: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh xrandr --setprovideroutputsource modesetting NVIDIA-0 xrandr --auto</span></span></code> </pre> <br>  Mit diesem Skript geben wir den Anbieter an und legen die maximal m√∂gliche Bildschirmaufl√∂sung fest. <br><br>  Lassen Sie uns das erstellte Skript ausf√ºhrbar machen: <br><br><pre> <code class="bash hljs">chmod +x /etc/lightdm/display_setup.sh</code> </pre> <br>  Lassen Sie LightDM das obige Skript beim Start ausf√ºhren.  Bearbeiten Sie zun√§chst /etc/lightdm/lightdm.conf: <br><br><pre> <code class="bash hljs">nano /etc/lightdm/lightdm.conf</code> </pre> <br>  Geben Sie den Parameter ein <br><br><pre> <code class="bash hljs">display-setup-script=/etc/lightdm/display_setup.sh</code> </pre> <br>  Sie k√∂nnen die Anweisungen f√ºr SDDM in dem Thread sehen, den ich bereits erw√§hnt habe, Links im Keller. <br><br>  Jetzt m√ºssen wir den CPU-Mikrocode aktualisieren (mehr √ºber den Mikrocode √ºber die Links im Keller): <br><br><pre> <code class="bash hljs">sudo pacman -S intel-ucode</code> </pre> <br>  Installieren Sie nach dem Aktualisieren des Mikrocodes eine Reihe von Paketen von Nvidia: <br><br><pre> <code class="bash hljs">sudo pacman -S lib32-mesa-demos mesa-demos libva-vdpau-driver nvidia nvidia-libgl lib32-nvidia-utils nvidia-settings lib32-opencl-nvidia</code> </pre> <br><blockquote>  <b>Hinweis:</b> Einige der Pakete sind m√∂glicherweise nicht verf√ºgbar.  Installieren Sie in diesem Fall alles separat.  √úberspringen Sie Pakete, die nicht verf√ºgbar sind. </blockquote>  Aktivieren Sie den Daemon nvidia.persistenced, der f√ºr die Persistenz des Nvidia-Treibers verantwortlich ist (mehr dazu im Keller-Link): <br><br><pre> <code class="bash hljs">systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> nvidia-persistenced.service</code> </pre> <br>  GRUB automatisch konfigurieren: <br><br><pre> <code class="bash hljs">sudo grub-mkconfig -o /boot/grub/grub.cfg</code> </pre> <br>  Erstellen Sie eine bootf√§hige RAM-Disk: <br><br><pre> <code class="bash hljs">mkinitcpio -p linux</code> </pre> <br>  √úberpr√ºfen Sie .xinitrc: <br><br><pre> <code class="bash hljs">nano ~/.xinitrc</code> </pre> <br>  Wenn nicht eingegeben, geben Sie ein <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> gnome-session</code> </pre> <br>  f√ºr GNOME und <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">exec</span></span> startkde</code> </pre> <br>  f√ºr KDE Plasma. <br><br>  Neustart: <br><br><pre> <code class="bash hljs">reboot</code> </pre> <br>  Melden Sie sich nach dem Neustart des Laptops mit Ihrem Konto an und genie√üen Sie die Welt von Arch. <br><br><h3>  √úber Hummel und PRIME </h3><br>  Sie haben vielleicht bemerkt, dass ich nichts √ºber die ‚ÄûKr√ºcken‚Äú gesagt habe, die darauf abzielen, den <u>korrekten</u> Betrieb von Nvidia Optimus unter Linux sicherzustellen: Bumblebee und PRIME. <br>  Au√üerdem habe ich nur eine Nvidia-Karte mit einem propriet√§ren Treiber erhalten, Nouveau hat nicht funktioniert (deshalb hei√üt der Artikel ‚ÄûBless Nouveau‚Äú. <br>  Meine pers√∂nliche Erfahrung mit ihnen ist klein und bedauerlich: Beide Kr√ºcken haben meine Nvidia-Grafikkarte nicht gesehen.  Wenn Sie an ihnen interessiert sind, finden Sie im Keller Links zu Materialien dar√ºber. <br><br><h2>  Nachwort </h2><br>  Wenn Sie den gesamten Artikel lesen, sind Sie ein Held <i>(naja oder ein Moderator)</i> . <br><br>  Beim Schreiben eines Artikels habe ich versucht, ihn f√ºr Sie <i>mit relativ</i> lustigen Witzen zu verd√ºnnen, um das Fehlen von Bildern darin irgendwie zu rechtfertigen.  Ich hoffe, Sie haben nach dem Lesen den Zen erreicht. <br><br><h3>  Liste der Quellen </h3><br>  √úber den Mikrocode: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">en.wikipedia.org/wiki/</a> Microcode <br>  √úber Bumblebee: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wiki.archlinux.org/index.php/Bumblebee_</a> (russisch) <br>  √úber PRIME: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wiki.archlinux.org/index.php/PRIME</a> <br>  Thread: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">devtalk.nvidia.com/default/topic/1027679/linux/optimus-support-for-arch-linux-for-dell-i7559-dual-graphics-intel-nvidia-gtx-960m-laptop-/2</a> <br>  Informationen zur Persistenz: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">en.wikipedia.org/wiki/Persistency</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de414061/">https://habr.com/ru/post/de414061/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414049/index.html">Die Hauptspiele der E3 2018: Fallout 76, Metro Exodus, Doom Eternal und andere</a></li>
<li><a href="../de414053/index.html">5 Missverst√§ndnisse √ºber die DSGVO</a></li>
<li><a href="../de414055/index.html">Trans-PRK: einer der Standards f√ºr die Sehkorrektur</a></li>
<li><a href="../de414057/index.html">Rechenzentrumsk√ºhlung: Ein Lied von Eis und Feuer</a></li>
<li><a href="../de414059/index.html">Der Prozentsatz der Ehe unter LED-Lampen. Eine Auswahl von 27.000 verkauften Lampen</a></li>
<li><a href="../de414063/index.html">Morgenkommandant</a></li>
<li><a href="../de414065/index.html">Das beste chinesische Smartphone "bis zu 10 Tausend Rubel" mit AliExpress gegen Xiaomi Redmi 5</a></li>
<li><a href="../de414067/index.html">Starten Sie das mobile Retargeting mit Anpassen: Einstellungen, Berichte und Links</a></li>
<li><a href="../de414069/index.html">Drohnenbeschr√§nkungen w√§hrend der FIFA Fussball-Weltmeisterschaft 2018 (FIFA 2018)</a></li>
<li><a href="../de414071/index.html">Von der √úberwachung bis zum Incident Management. Bericht vom DevOps Moscow Meetup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>