<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤚🏿 🛋️ 📸 Angular 9 dan Ivy: pemuatan komponen yang malas ⏱️ 👩‍👩‍👦‍👦 📞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pemuatan komponen malas di Angular? Mungkin kita berbicara tentang modul memuat malas menggunakan router Angular? Tidak, kita berbicara tentang kompon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Angular 9 dan Ivy: pemuatan komponen yang malas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/484618/">  Pemuatan komponen malas di Angular?  Mungkin kita berbicara tentang modul memuat malas menggunakan router Angular?  Tidak, kita berbicara tentang komponen.  Versi Angular saat ini hanya mendukung pemuatan modul malas.  Tapi Ivy memberi pengembang peluang baru dalam bekerja dengan komponen. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/484618/"><img src="https://habrastorage.org/webt/ox/8d/ub/ox8dubshhrdlijoson4_gyjtarw.png"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Beban malas yang kami gunakan sejauh ini: rute</font> </h2><br>  Pemuatan malas adalah mekanisme yang bagus.  Di Angular, Anda dapat menggunakan mekanisme ini tanpa harus melakukan hampir semua upaya dengan menyatakan rute yang mendukung pemuatan malas.  Berikut adalah contoh dari <a href="https://angular.io/guide/lazy-loading-ngmodules">dokumentasi</a> Angular yang menunjukkan ini: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> routes: Routes = [     { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: <span class="hljs-string"><span class="hljs-string">'customer-list'</span></span>,       <span class="hljs-attr"><span class="hljs-attr">loadChildren</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./customers/customers.module'</span></span>).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">m</span></span></span><span class="hljs-function"> =&gt;</span></span> m.CustomersModule) }     ];</code> </pre> <br>  Berkat kode di atas, sebuah fragmen terpisah untuk <code>customers.module</code> Modul akan dibuat, yang akan dimuat saat pengguna menavigasi sepanjang rute <code>customer-list</code> . <br><br>  Ini adalah cara yang sangat bagus untuk mengurangi ukuran bundel utama proyek dan mempercepat pemuatan awal aplikasi. <br><br>  Namun, meskipun demikian, bukankah menyenangkan untuk dapat mengontrol pemuatan malas secara lebih akurat?  Misalnya, bagaimana jika kita dapat mengatur pemuatan komponen individu yang malas? <br><br>  Sampai sekarang, ini belum mungkin.  Tapi itu semua berubah dengan kedatangan Ivy. <br><br><h2>  <font color="#3AC1EF">Ivy dan konsep "lokalitas"</font> </h2><br>  Modul adalah konsep dasar dan blok bangunan dasar dari setiap aplikasi Angular.  Modul menyatakan komponen, arahan, pipa, layanan. <br><br>  Aplikasi Angular modern tidak dapat ada tanpa modul.  Salah satu alasan untuk ini adalah kenyataan bahwa ViewEngine menambahkan semua metadata yang diperlukan ke modul. <br><br>  Ivy, di sisi lain, mengambil pendekatan yang berbeda.  Di Ivy, komponen bisa ada tanpa modul.  Ini dimungkinkan berkat konsep lokalitas.  Esensinya adalah bahwa semua metadata adalah lokal untuk komponen. <br><br>  Mari kita jelaskan ini dengan menganalisis bundel es2015 yang dihasilkan menggunakan Ivy. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02b/775/370/02b7753703a0599491c3f9076527168f.png"></div><br>  <i><font color="#999999">Es2015-bundle dihasilkan menggunakan Ivy</font></i> <br><br>  Di bagian <code>Component code</code> , Anda dapat melihat bahwa sistem Ivy telah menyimpan kode komponen.  Tidak ada yang istimewa di sini.  Tapi kemudian Ivy menambahkan beberapa metadata ke kode. <br><br>  Bagian pertama metadata ditunjukkan pada gambar sebagai <code>Component factory</code> .  Pabrik tahu bagaimana membuat instantiate komponen.  Di bagian <code>Component metadata</code> , Ivy menempatkan atribut tambahan, seperti <code>type</code> dan <code>selectors</code> , yaitu, semua yang dibutuhkan komponen selama eksekusi program. <br><br>  Perlu disebutkan bahwa Ivy menambahkan fungsi <code>template</code> sini.  Itu ditampilkan di <code>Compiled version of your template</code> bagian <code>Compiled version of your template</code> .  Mari kita membahas fakta menarik ini secara lebih rinci. <br><br>  Fungsi <code>template</code> adalah versi kompilasi dari kode HTML kami.  Dia mengikuti instruksi Ivy untuk membuat DOM.  Ini berbeda dari cara kerja ViewEngine. <br><br>  Sistem ViewEngine mengambil kode dan memotongnya.  Angular kemudian akan mengeksekusi kode jika kita menggunakannya. <br><br>  Dan dengan pendekatan yang digunakan oleh Ivy, komponen yang memanggil perintah Angular bertanggung jawab atas segalanya.  Perubahan ini memungkinkan komponen ada secara mandiri, ini mengarah pada fakta bahwa algoritma tree-shake dapat diterapkan pada kode dasar Angular. <br><br><h2>  <font color="#3AC1EF">Contoh nyata dari pemuatan komponen yang malas</font> </h2><br>  Sekarang kita tahu bahwa pemuatan komponen yang malas dimungkinkan, pertimbangkan dengan contoh nyata.  Yaitu, kami akan membuat aplikasi Kuis yang menanyakan pertanyaan pengguna dengan opsi jawaban. <br><br>  Aplikasi ini menampilkan gambar kota dan opsi dari mana Anda perlu memilih nama kota ini.  Segera setelah pengguna memilih opsi dengan mengklik tombol yang sesuai, tombol ini akan segera berubah, menunjukkan apakah jawabannya benar atau salah.  Jika latar belakang tombol berubah menjadi hijau, maka jawabannya benar.  Jika latar belakang berubah merah, itu berarti jawabannya salah. <br><br>  Setelah jawaban atas pertanyaan saat ini diterima, program akan menampilkan pertanyaan berikut.  Ini tampilannya. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2fc/768/ece/2fc768ecebd5c52399030c0d2dc47c66.gif"></div><br>  <i><font color="#999999">Demo Kuis</font></i> <br><br>  Pertanyaan-pertanyaan yang ditanyakan program kepada pengguna diwakili oleh komponen <code>QuizCardComponent</code> . <br><br><h2>  <font color="#3AC1EF">Konsep pemuatan komponen malas</font> </h2><br>  Pertama mari kita ilustrasikan ide umum pemuatan malas komponen <code>QuizCardComponent</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ab/45a/b2b/4ab45ab2b677ce0d886d2f26a5645edb.png"></div><br>  <i><font color="#999999">Proses Komponen QuizCardComponent</font></i> <br><br>  Setelah pengguna memulai kuis dengan mengklik tombol <code>Start quiz</code> , kami mulai memuat komponen dengan malas.  Setelah komponen tersedia, kami menempatkannya dalam wadah. <br><br>  Kami bereaksi terhadap peristiwa yang <code>questionAnsvered</code> dari komponen yang "malas" dengan cara yang sama seperti kami akan menanggapi acara dari komponen yang biasa.  Yaitu, setelah terjadinya acara, kami menampilkan di layar kartu berikutnya dengan pertanyaan. <br><br><h2>  <font color="#3AC1EF">Analisis kode</font> </h2><br>  Untuk memahami apa yang terjadi selama pemuatan komponen yang malas, kami mulai dengan versi <code>QuizCardComponent</code> disederhanakan, yang menampilkan properti pertanyaan. <br><br>  Kemudian kami akan memperluas komponen ini menggunakan komponen Material Sudut di dalamnya.  Dan pada akhirnya, kami akan menyesuaikan reaksi terhadap peristiwa yang dihasilkan oleh komponen. <br><br>  Mari kita mengatur pemuatan malas dari komponen <code>QuizCardComponent</code> yang <code>QuizCardComponent</code> , yang memiliki templat berikut: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Here's the question<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>Image: <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> {{ question.image }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>Possible selections: <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> {{ question.possibleSelections.toString() }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>Correct answer: <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> {{ question.correctAnswer }}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">li</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Langkah pertama adalah membuat elemen kontainer.  Untuk melakukan ini, kita dapat menggunakan elemen nyata, seperti <code>&lt;div&gt;</code> , atau - menggunakan <code>ng-container</code> , yang memungkinkan kita melakukannya tanpa tambahan level kode-HTML.  Beginilah deklarasi elemen kontainer di mana kita menempatkan komponen "malas": <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-toolbar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>City quiz<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-toolbar</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> *</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ngIf</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"!quizStarted"</span></span></span><span class="hljs-tag">        </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mat-raised-button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span><span class="hljs-tag">        </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"start-quiz-button"</span></span></span><span class="hljs-tag">        (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span><span class="hljs-tag">)=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"startQuiz()"</span></span></span><span class="hljs-tag">&gt;</span></span>Start quiz<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-container</span></span></span><span class="hljs-tag"> #</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">quizContainer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"quiz-card-container"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ng-container</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Dalam komponen yang Anda butuhkan untuk mengakses wadah.  Untuk melakukan ini, kami menggunakan anotasi <code>@ViewChild</code> dan beri tahu kami bahwa kami ingin membaca <code>ViewContainerRef</code> . <br><br>  Perhatikan bahwa dalam Angular 9, properti <code>static</code> di penjelasan <code>@ViewChild</code> disetel ke <code>false</code> secara default: <br><br><pre> <code class="javascript hljs">@ViewChild(<span class="hljs-string"><span class="hljs-string">'quizContainer'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">read</span></span>: ViewContainerRef}) quizContainer: ViewContainerRef;</code> </pre> <br>  Sekarang kami memiliki wadah di mana kami ingin menambahkan komponen "malas".  Selanjutnya, kita perlu <code>ComponentFactoryResolver</code> dan <code>Injector</code> .  Keduanya dapat diperoleh dengan beralih ke metodologi injeksi ketergantungan. <br><br>  Entitas <code>ComponentFactoryResolver</code> adalah registri sederhana yang menetapkan hubungan antara komponen dan kelas <code>ComponentFactory</code> dihasilkan secara otomatis yang dapat digunakan untuk instantiate komponen: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(private quizservice: QuizService,            private cfr: ComponentFactoryResolver,            private injector: Injector) { }</code> </pre> <br>  Sekarang kami memiliki segala yang dibutuhkan untuk mencapai tujuan.  <code>startQuiz</code> bekerja pada isi metode <code>startQuiz</code> dan mengatur pemuatan komponen yang malas: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {QuizCardComponent} = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span>(<span class="hljs-string"><span class="hljs-string">'./quiz-card/quiz-card.component'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> quizCardFactory = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cfr.resolveComponentFactory(QuizCardComponent); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {instance} = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.quizContainer.createComponent(quizCardFactory, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.injector); instance.question = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.quizservice.getNextQuestion();</code> </pre> <br>  Kita dapat menggunakan perintah <code>import</code> ECMAScript untuk mengatur pemuatan malas <code>QuizCardComponent</code> .  Ekspresi impor mengembalikan janji.  Anda dapat bekerja dengannya menggunakan <code>async/await</code> konstruk atau menggunakan <code>.then</code> handler.  Setelah menyelesaikan janji, kami menggunakan destrukturisasi untuk membuat instance komponen. <br><br>  Saat ini, Anda harus menggunakan <code>ComponentFactory</code> untuk memberikan kompatibilitas mundur.  Di masa mendatang, garis yang sesuai tidak diperlukan, karena kami akan dapat bekerja dengan komponen secara langsung. <br><br>  Pabrik <code>ComponentFactory</code> memberi kita <code>componentRef</code> .  Kami melewati <code>componentRef</code> dan <code>Injector</code> ke metode <code>createComponent</code> wadah. <br><br>  Metode <code>createComponent</code> mengembalikan <code>ComponentRef</code> mana instance komponen terkandung.  Kami menggunakan <code>instance</code> untuk melewatkan properti komponen <code>@Input</code> . <br><br>  Di masa depan, semua ini mungkin dapat dilakukan dengan menggunakan metode Angular <code>renderComponent</code> .  Metode ini masih eksperimental.  Namun, sangat mungkin bahwa itu akan berubah menjadi metode Angular biasa.  <a href="https://github.com/LayZeeDK/ivy-dynamic-rendering">Berikut adalah</a> materi yang bermanfaat tentang topik ini. <br><br>  Ini semua yang diperlukan untuk mengatur pemuatan komponen yang malas. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2d4/2bd/4bc/2d42bd4bc38ee01c427c94286e060cbb.png"></div><br>  <i><font color="#999999">Pemuatan komponen yang malas</font></i> <br><br>  Setelah tombol <code>Start quiz</code> ditekan, pemuatan komponen yang malas dimulai.  Jika Anda membuka tab <code>Network</code> alat pengembang, Anda dapat melihat proses pemuatan malas kode fragmen yang diwakili oleh file <code>quiz-card-quiz-card-component.js</code> .  Setelah memuat dan memproses komponen ditampilkan, pengguna melihat kartu pertanyaan. <br><br><h2>  <font color="#3AC1EF">Perpanjangan Komponen</font> </h2><br>  Kami sedang memuat komponen <code>QuizCardComponent</code> .  Ini sangat bagus.  Tetapi aplikasi kami belum berfungsi secara khusus. <br><br>  Mari kita perbaiki ini dengan menambahkan fitur dan komponen tambahan dari Bahan Angular ke dalamnya: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"quiz-card"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-header</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mat-card-avatar</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"quiz-header-image"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-title</span></span></span><span class="hljs-tag">&gt;</span></span>Which city is this?<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-title</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-subtitle</span></span></span><span class="hljs-tag">&gt;</span></span>Click on the correct answer below<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-subtitle</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-header</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"image"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mat-card-image</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"'assets/' + question.image"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Photo of a Shiba Inu"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-actions</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"answer-section"</span></span></span><span class="hljs-tag">&gt;</span></span>    <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">disabled</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"answeredCorrectly !== undefined"</span></span></span><span class="hljs-tag"> *</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ngFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"let selection of question.possibleSelections"</span></span></span><span class="hljs-tag">            </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mat-stroked-button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"primary"</span></span></span><span class="hljs-tag">            [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ngClass</span></span></span><span class="hljs-tag">]=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"{              'correct': answeredCorrectly &amp;&amp; selection === question.correctAnswer,              'wrong': answeredCorrectly === false &amp;&amp; selection === question.correctAnswer             }"</span></span></span><span class="hljs-tag">            (</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span><span class="hljs-tag">)=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"answer(selection)"</span></span></span><span class="hljs-tag">&gt;</span></span>      {{selection}}    <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card-actions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">mat-card</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Kami telah memasukkan beberapa komponen Material yang indah ke dalam komponen.  Bagaimana dengan modul yang sesuai? <br><br>  Mereka tentu saja dapat ditambahkan ke <code>AppModule</code> .  Tetapi ini berarti bahwa modul-modul ini akan dimuat dalam mode "serakah".  Dan ini bukan ide yang bagus.  Selain itu, perakitan proyek akan gagal, dengan pesan berikut: <br><br><pre> <code class="javascript hljs">ERROR <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> src/app/quiz-card/quiz-card.component.html:<span class="hljs-number"><span class="hljs-number">9</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> - error TS<span class="hljs-number"><span class="hljs-number">-998001</span></span>: <span class="hljs-string"><span class="hljs-string">'mat-card'</span></span> is not a known element: <span class="hljs-number"><span class="hljs-number">1.</span></span> If <span class="hljs-string"><span class="hljs-string">'mat-card'</span></span> is an Angular component, then verify that it is part <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>. <span class="hljs-number"><span class="hljs-number">2.</span></span> If <span class="hljs-string"><span class="hljs-string">'mat-card'</span></span> is a Web Component then add <span class="hljs-string"><span class="hljs-string">'CUSTOM_ELEMENTS_SCHEMA'</span></span> to the <span class="hljs-string"><span class="hljs-string">'@NgModule.schemas'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> component to suppress <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> message.</code> </pre> <br>  Apa yang harus dilakukan  Seperti yang mungkin sudah Anda pahami, masalah ini sepenuhnya bisa dipecahkan.  Ini dapat dilakukan dengan menggunakan modul. <br><br>  Tapi kali ini kita akan menggunakannya sedikit berbeda dari sebelumnya.  Kami akan menambahkan modul kecil ke file yang sama dengan <code>QuizCardComponent</code> (dalam file <code>quizcard.component.ts</code> ): <br><br><pre> <code class="javascript hljs">@NgModule({  <span class="hljs-attr"><span class="hljs-attr">declarations</span></span>: [QuizCardComponent],  <span class="hljs-attr"><span class="hljs-attr">imports</span></span>: [CommonModule, MatCardModule, MatButtonModule] }) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QuizCardModule</span></span></span><span class="hljs-class"> </span></span>{ }</code> </pre> <br>  Perhatikan bahwa tidak ada pernyataan <code>export</code> . <br><br>  Spesifikasi modul ini dimiliki secara eksklusif oleh komponen kami, dimuat dalam mode malas.  Akibatnya, satu-satunya komponen yang dideklarasikan dalam modul adalah <code>QuizCardComponent</code> .  Bagian <code>import</code> hanya mengimpor modul yang dibutuhkan komponen kami. <br><br>  Kami tidak mengekspor modul baru sehingga modul yang dimuat dalam mode serakah tidak dapat mengimpornya. <br><br>  Mulai ulang aplikasi dan lihat bagaimana perilakunya ketika Anda mengklik tombol <code> Start quiz</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc5/4bf/c60/bc54bfc6057cc6707e4f01a5bf871de9.png"></div><br>  <i><font color="#999999">Analisis Aplikasi yang Dimodifikasi</font></i> <br><br>  Hebat!  Komponen <code>QuizCardComponent</code> dimuat dalam mode malas dan ditambahkan ke <code>ViewContainer</code> .  Semua dependensi yang diperlukan dimuat dengannya. <br><br>  Kami akan menganalisis bundel aplikasi menggunakan alat <code>webpack-bundle-analyze</code> yang disediakan oleh modul npm yang sesuai.  Ini memungkinkan Anda untuk memvisualisasikan konten file yang dihasilkan Webpack dan memeriksa skema yang dihasilkan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d2a/a5a/2aa/d2aa5a2aae380755aca3872db6d068f9.png"></div><br>  <i><font color="#999999">Analisis bundel aplikasi</font></i> <br><br>  Ukuran bundel utama aplikasi adalah sekitar 260 Kb.  Jika kita mengunduh komponen <code>QuizCardComponent</code> bersamaan dengan itu, maka ukuran data yang diunduh akan sekitar 270 Kb.  Ternyata kami mampu mengurangi ukuran bundel utama sebesar 10 Kb, hanya memuat satu komponen dalam mode malas.  Hasil yang bagus! <br><br>  Kode <code>QuizCardComponent</code> setelah perakitan sampai ke file terpisah.  Jika Anda menganalisis konten file ini, ternyata tidak hanya kode <code>QuizCardComponent</code> , tetapi juga modul Material yang digunakan dalam komponen ini. <br><br>  Meskipun <code>QuizCardComponent</code> menggunakan <code>MatButtonModule</code> dan <code>MatCardModule</code> , hanya <code>MatCardModule</code> masuk ke <code>MatCardModule</code> kode yang sudah jadi.  Alasan untuk ini adalah bahwa kami menggunakan <code>MatButtonModule</code> di <code>AppModule</code> , menampilkan tombol <code>Start quiz</code> .  Akibatnya, kode yang sesuai jatuh ke fragmen lain dari bundel. <br><br>  Sekarang kami telah mengatur pemuatan malas <code>QuizCardComponent</code> .  Komponen ini menampilkan kartu, dirancang dengan gaya Material, berisi gambar, pertanyaan, dan tombol dengan opsi jawaban.  Apa yang terjadi sekarang jika Anda mengklik salah satu tombol ini? <br><br>  Tombol, tergantung pada apakah itu berisi jawaban benar atau salah, menjadi hijau atau merah saat ditekan.  Apa lagi yang terjadi?  Tidak ada  Dan kita perlu bahwa setelah menjawab satu pertanyaan, kartu pertanyaan lain akan ditampilkan.  Perbaiki <br><br><h2>  <font color="#3AC1EF">Penanganan acara</font> </h2><br>  Aplikasi tidak menunjukkan kartu pertanyaan baru ketika Anda mengklik tombol jawab karena fakta bahwa kami belum menyiapkan mekanisme untuk menanggapi peristiwa komponen yang dimuat dalam mode malas.  Kita sudah tahu bahwa komponen <code>QuizCardComponent</code> menghasilkan peristiwa menggunakan <code>EventEmitter</code> .  Jika Anda melihat definisi kelas <code>EventEmitter</code> , Anda bisa mengetahui bahwa itu adalah turunan dari <code>Subject</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> declare <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EventEmitter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">any</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Subject</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt;</span></span></code> </pre> <br>  Ini berarti bahwa <code>EventEmitter</code> memiliki metode <code>subscribe</code> , yang memungkinkan Anda untuk mengonfigurasi respons sistem terhadap peristiwa yang terjadi: <br><br><pre> <code class="javascript hljs">instance.questionAnswered.pipe(    takeUntil(instance.destroy$) ).subscribe(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showNewQuestion());</code> </pre> <br>  Di sini kita berlangganan aliran <code>questionAnswered</code> dan memanggil metode <code>showNextQuestion</code> , yang mengeksekusi logika <code>lazyLoadQuizCard</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> showNewQuestion() {  <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.lazyLoadQuizCard(); }</code> </pre> <br>  <code>takeUntil(instance.destroy$)</code> diperlukan untuk menghapus langganan yang dieksekusi setelah komponen dihancurkan.  Jika kait <code>ngOnDestroy</code> dari siklus hidup komponen <code>ngOnDestroy</code> dipanggil, <code>destroy$</code> disebut dengan <code>next</code> dan <code>complete</code> . <br><br>  Karena komponen sudah dimuat, sistem tidak melakukan permintaan HTTP tambahan.  Kami menggunakan konten dari fragmen kode yang sudah kami miliki, membuat komponen baru dan memasukkannya ke dalam wadah. <br><br><h2>  <font color="#3AC1EF">Kait siklus hidup komponen</font> </h2><br>  Hampir semua kait siklus hidup komponen secara otomatis dipanggil ketika bekerja dengan komponen <code>QuizCardComponent</code> menggunakan teknik lazy loading.  Tetapi satu kait saja tidak cukup.  Bisakah kamu mengerti yang mana? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ceb/4f7/b2a/ceb4f7b2a34bbed6ced31f69713e4f68.png"></div><br>  <i><font color="#999999">Kait siklus hidup komponen</font></i> <br><br>  Ini adalah <code>ngOnChanges</code> paling penting <code>ngOnChanges</code> .  Karena kami sendiri memperbarui properti input instance komponen, kami juga bertanggung jawab untuk memanggil <code>ngOnChanges</code> siklus hidup <code>ngOnChanges</code> . <br><br>  Untuk memanggil kait <code>ngOnChanges</code> dari instance <code>ngOnChanges</code> , Anda perlu membuat sendiri objek <code>SimpleChange</code> : <br><br><pre> <code class="javascript hljs">(instance <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> any).ngOnChanges({    <span class="hljs-attr"><span class="hljs-attr">question</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleChange(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, instance.question, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) });</code> </pre> <br>  Kami secara manual memanggil <code>ngOnChanges</code> instance komponen dan memberikannya objek <code>SimpleChange</code> .  Objek ini menunjukkan bahwa perubahan ini adalah yang pertama, bahwa nilai sebelumnya adalah <code>null</code> , dan bahwa nilai saat ini adalah pertanyaan. <br><br>  Hebat!  Kami memuat komponen dengan modul pihak ketiga, merespons peristiwa yang dihasilkannya dan mengatur panggilan kait yang diperlukan dari siklus hidup komponen. <br><br>  <a href="https://github.com/kreuzerk/city-quiz">Ini adalah</a> kode sumber untuk proyek selesai yang sedang kami kerjakan di sini. <br><br><h2>  <font color="#3AC1EF">Ringkasan</font> </h2><br>  Pemuatan komponen yang malas memberi pengembang Angular peluang besar untuk mengoptimalkan kinerja aplikasi.  Yang dimilikinya adalah alat untuk menyempurnakan komposisi material yang dimuat dalam mode malas.  Sebelumnya, ketika hanya bisa memuat rute dalam mode malas, kami tidak memiliki keakuratan seperti itu. <br><br>  Sayangnya, saat menggunakan modul pihak ketiga dalam komponen, kita juga harus menjaga modul tersebut.  Namun, perlu diingat bahwa di masa depan hal ini dapat berubah. <br><br>  Mesin Ivy memperkenalkan konsep lokalitas, berkat komponen mana yang dapat eksis secara mandiri.  Perubahan ini adalah fondasi masa depan Angular. <br><br>  <b>Pembaca yang budiman!</b>  Apakah Anda berencana untuk menggunakan teknik pemuatan komponen yang malas dalam proyek Angular Anda? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id484618/">https://habr.com/ru/post/id484618/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id484604/index.html">Tahun Baru, Peramban Baru: Microsoft Edge Keluar dari Penilaian Awal dan Sekarang Tersedia untuk Diunduh</a></li>
<li><a href="../id484610/index.html">Selamat tinggal kode bersih</a></li>
<li><a href="../id484612/index.html">Optimasi waktu pembuatan proyek</a></li>
<li><a href="../id484614/index.html">6 rekomendasi untuk mengembangkan aplikasi Go yang aman</a></li>
<li><a href="../id484616/index.html">6 pelajaran dari pengalaman pengoptimalan kinerja layanan Node.js</a></li>
<li><a href="../id484620/index.html">Renderer Grafis PS1 Baru untuk Omega Red Emulator</a></li>
<li><a href="../id484624/index.html">Pola Perpanjangan Kehidupan Puasa dan Perpanjangan Umur</a></li>
<li><a href="../id484628/index.html">Eric Ciaramella sebagai contoh penyensoran di Wikipedia / Google</a></li>
<li><a href="../id484630/index.html">CES 2020: saatnya mengejutkan</a></li>
<li><a href="../id484634/index.html">Node.js VS Python: Mana yang Lebih Baik?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>