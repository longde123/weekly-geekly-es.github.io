<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‰ ğŸš´ğŸ¼ â˜˜ï¸ Cara membuat tongkat penyangga untuk Tinkoff Investments dengan tangan Anda sendiri atau pemberitahuan tindakan yang diperlukan untuk mengambil untung / rugi ğŸ§‘ğŸ¼â€ğŸ¤â€ğŸ§‘ğŸ» ğŸ‘¼ğŸ½ ğŸ›Œ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ada broker seperti itu - Tinkoff Bank. Dan ada masalah dalam kenyataan bahwa pada saat ini broker ini tidak memiliki perintah take / profit loss. Oleh...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara membuat tongkat penyangga untuk Tinkoff Investments dengan tangan Anda sendiri atau pemberitahuan tindakan yang diperlukan untuk mengambil untung / rugi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442734/"> Ada broker seperti itu - Tinkoff Bank.  Dan ada masalah dalam kenyataan bahwa pada saat ini broker ini tidak memiliki perintah take / profit loss.  Oleh karena itu, jika Anda ingin berdagang lebih aktif, maka Anda perlu menggunakan semacam solusi sementara, sementara di kedalaman programmer Tinkoff sedang mengembangkan fitur pembunuh ambil untung / hentikan kerugian, dan di bawah potongan adalah salah satunya. <br>  <b>pembaruan:</b> 03/22/2019, Broker meluncurkan versi utama 3.0.0 di Google Play, di mana take / stop loss masih muncul. <br><a name="habracut"></a><br>  Mengapa saya memutuskan untuk menulis artikel ini di sini?  Bagi saya, Tinkoff Bank dan produk-produknya cukup populer di kalangan orang-orang TI, dan mungkin seseorang memiliki kebutuhan yang sama, tetapi tidak ada keinginan atau waktu untuk mengenakan sepeda.  Karena itu, saya bagikan. <br><br>  Untuk mulai dengan - tentang peluang alternatif yang disediakan oleh broker itu sendiri. <br>  Pertama, Tinkoff memiliki limit order yang muncul pada Februari 2019 (mereka menunggu dua tahun, tidak ada lelucon!), Tetapi mereka bekerja dalam satu hari dan, lebih buruk lagi, dalam interval uang yang kecil, yang menciptakan ketidaknyamanan di pasar yang bergejolak.  Sangat tidak mungkin untuk menetapkan nilai kurang (lebih) dari ambang tertentu yang dihitung dari kutipan saat ini.  Yah, mungkin tidak mungkin untuk meminta lebih dari satu batas pesanan (ketika saya mencoba untuk menyimpan urutan pertama, aplikasi seluler selalu macet, tetapi situs tersebut tidak memiliki fungsi seperti itu). <br>  Kedua, di dalam aplikasi seluler mereka, Anda dapat berlangganan perubahan harga dengan menetapkan ambang batas absolut atau ambang batas untuk perubahan persentase (kenaikan atau penurunan), tetapi Anda dapat menetapkan satu dan hanya satu ambang batas per aset. <br><br>  Logika sepeda saya sederhana: <br>  1) kami memiliki ambang batas (selanjutnya - ambang batas) untuk keamanan (aset) kami, di mana kami harus memiliki tindakan ambil untung / hentikan kerugian secara manual.  Ambang dihitung secara independen, berdasarkan harga pembelian aset; <br>  2) kita perlu mengurai data harga saat ini dari suatu aset; <br>  3) kirim pemberitahuan kepada diri Anda sendiri jika salah satu ambang batas telah tercapai. <br>  Meskipun deskripsi langsung, ada nuansa dalam implementasinya :) <br><br>  1) Sementara portofolio saya terdiri dari satu aset, saya menetapkan ambang batas langsung di badan skrip, dan pencarian kertas bahkan dibuat bukan variabel, tetapi hanya garis ajaib.  Keputusan yang buruk, tetapi cukup untuk menguji ide itu.  Saat portofolio terdiversifikasi, saya membuat file dari mana sekuritas dimuat, bursa tempat mereka diperdagangkan, dan nilai ambang batas. <br><br>  2) Karena aset saya adalah keamanan asing yang diperdagangkan di St. Petersburg Exchange, pertama-tama saya memutuskan untuk mengurai data dari situs web St. Petersburg Exchange dari halaman berikut: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">spbexchange.ru/ru/market-data/Default.aspx</a> <br>  Penyortiran di Bursa Saham St. Petersburg terjadi sesuai dengan volume perdagangan, dan keamanan saya selalu ada di halaman pertama.  Itu bekerja dengan baik, tetapi pada 8 Maret semuanya rusak.  Untuk beberapa alasan, TSLA sudah ada di halaman 25, dan paginator mereka memuat data secara dinamis melalui JS.  Masalah ini dapat diselesaikan "langsung": parsing semua halaman sampai kami menemukan aset kami.  Tetapi pendekatan ini tidak terlalu efektif, jika kita mempertimbangkan waktu eksekusi dari skrip loop.  Sebagai gantinya, saya memutuskan untuk menambahkan parsing dari tradingview.com.  Tidak perlu menyekop daftar panjang di lebih banyak halaman.  Di sana, setiap aset memiliki sesuatu seperti tautan ini: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.tradingview.com/symbols/NASDAQ-TSLA</a> <br>  Tampaknya bagi saya bahwa semuanya harus dimulai dengan cepat dan sederhana, tetapi ada masalah - data yang menarik bagi saya dimuat melalui JS dan Permintaan yang biasa tidak dapat mengatasinya. <br>  Masalah ini memiliki tiga solusi yang saya tahu: <br>  PyQT, selenium (webdriver) dan ekstensi Requests-HTML.  Karena saya sudah memiliki Permintaan dalam proyek, diputuskan untuk menggunakan ekstensi sendiri. <br>  Sayangnya, solusi ini bekerja sangat tidak stabil, saya harus mencari solusi. <br><pre><code class="python hljs">session = HTMLSession() r = session.get(url) my = r.html.render(timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) selector = <span class="hljs-string"><span class="hljs-string">'span.tv-symbol-header-quote__value.tv-symbol-header-quote__value--large.js-symbol-last'</span></span> price = r.html.find(selector)[<span class="hljs-number"><span class="hljs-number">0</span></span>].text r.close() session.close()</code> </pre> <br>  Perhatikan batas waktu, serta panggilan ke metode close ().  Mereka tidak ditemukan dalam semua contoh, tetapi bekerja lebih baik dengan mereka daripada tanpa mereka. <br><br>  3) Kami mendaftar pada layanan yang dapat mengirim SMS (sms.ru), mengambil API mereka, membuat kunci.  Hingga 5 SMS per hari - gratis.  Cukup buat saya. <br>  Kuncinya terlihat seperti ini: <br>  24A41EA5-EEEE-Priv-5555-094143C2EDDD <br>  dan mengirim SMS dalam versi pertama diimplementasikan seperti ini: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mymessage)</span></span></span><span class="hljs-function">:</span></span> sms_url = <span class="hljs-string"><span class="hljs-string">'https://sms.ru/sms/send?api_id=key&amp;to=number&amp;msg=message&amp;json=1'</span></span> sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'key'</span></span>, mykey) sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'number'</span></span>, mynumber) sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, mymessage) sms_response = requests.get(sms_url)</code> </pre> <br><br>  Selama pengembangan, muncul pertanyaan berikut: apa yang harus dilakukan jika kami telah mengirim SMS kepada pengguna tentang melewati ambang batas?  Meskipun tidak ada cek, ia mengirim SMS lagi.  Setiap saat.  Cukup cepat "memakan" batas bebas dan mulai berpikir apa yang harus dilakukan dengannya.  Saya harus menambahkan penghitung SMS terkirim (sms_counter), yang kami periksa sebelum menelepon send_message. <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> sms_counter sms_counter = sms_counter + <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><br>  Pertanyaan lain akan muncul: sangat baik, selama sesi perdagangan kami memproses satu ambang batas dengan aset tertentu, dan ini cocok untuk kami.  Apa yang harus dilakukan untuk sesi perdagangan berikutnya?  Diputuskan untuk me-reset penghitung SMS yang dikirim.  Ada tiga opsi: untuk menyimpan data dalam basis data (tetapi saat ini saya memiliki aplikasi stateless), parse waktu / tanggal atau mulai ulang skrip.  Sejauh ini saya membuat opsi ketiga, tetapi di masa depan saya akan beralih ke opsi kedua atau pertama. <br><br>  Sekarang solusinya sudah operasional, dan dapat diunduh dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Github</a> <br>  Untuk pengguna yang tidak mengerti apa itu Python dan bagaimana mengkonfigurasinya, saya sarankan mencoba meluncurkan <a href="">solusi</a> paket <a href="">untuk Windows</a> <br><br>  Rencana untuk pengembangan lebih lanjut: <br>  1) menguraikan tanggal / waktu, untuk mengatur ulang penghitung SMS (alih-alih memulai ulang skrip); <br>  2) sekarang ini adalah aplikasi tanpa kewarganegaraan, tetapi saya bermaksud mengacaukan basis data; <br>  3) setelah item 2, saya ingin menambahkan pelacakan kenaikan tajam / kenaikan harga, relatif terhadap harga penutupan hari sebelumnya; <br>  4) memperluas peluang "komunikasi": lebih banyak jalur (Telegram, Viber, panggilan suara, opsi lain) dan penyedia (saya bermaksud untuk menambahkan smsc.ru, karena sms.ru kadang-kadang kehilangan responsif, dan meskipun mengirimkan SMS, tetapi skrip tidak dieksekusi lanjut sampai kami mendapat sms_response). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id442734/">https://habr.com/ru/post/id442734/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id442722/index.html">Berhenti mengunduh dan menyimpan angka nol</a></li>
<li><a href="../id442724/index.html">Film "Office Space" berusia 20 tahun: bagaimana ia mengubah pekerjaan kami</a></li>
<li><a href="../id442726/index.html">Robot cheetah MIT dapat melakukan back flips dan berlari cepat</a></li>
<li><a href="../id442730/index.html">Microsoft: Rusia lebih maju dari AS dan Eropa dalam penerapan kecerdasan buatan</a></li>
<li><a href="../id442732/index.html">My Little Relay: Triple Brainfuck, atau What Is Madness</a></li>
<li><a href="../id442736/index.html">6 papan permainan untuk meratakan bahasa Inggris</a></li>
<li><a href="../id442738/index.html">Pembuatan profil dan penelusuran dengan perf</a></li>
<li><a href="../id442740/index.html">Rekayasa terbalik format biner menggunakan file Korg SNG sebagai contoh. Bagian 2</a></li>
<li><a href="../id442742/index.html">Compaq LTE 5000 Notebook, Bagian Dua dan Setengah - Bonus</a></li>
<li><a href="../id442744/index.html">Solusi RIPE dan konsekuensinya untuk mengesampingkan dua LIR Rusia (Netup, gcxc.net)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>