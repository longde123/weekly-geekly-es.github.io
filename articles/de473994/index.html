<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíö üåæ üèπ Modernes Skriptladen üë©üèΩ‚Äç‚öïÔ∏è üë≤üèø ‚òÅÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es ist keine leichte Aufgabe, f√ºr jeden Browser den richtigen Code zu √ºbergeben. 

 In diesem Artikel werden verschiedene Optionen betrachtet, wie die...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modernes Skriptladen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raiffeisenbank/blog/473994/">  Es ist keine leichte Aufgabe, f√ºr jeden Browser den richtigen Code zu √ºbergeben. <br><br>  In diesem Artikel werden verschiedene Optionen betrachtet, wie dieses Problem gel√∂st werden kann. <br><br><img src="https://habrastorage.org/webt/4f/rs/cl/4frsclbbpc2v0pwpxqehbh3tj1w.png"><br><br>  Das √úbergeben von modernem Code durch einen modernen Browser kann die Leistung erheblich verbessern.  Ihre JavaScript-Pakete k√∂nnen eine kompaktere oder optimierte moderne Syntax enthalten und √§ltere Browser unterst√ºtzen. <br><br>  Unter den Tools f√ºr Entwickler dominiert das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Modul- / Nomodelmuster des</a> deklarativen Ladens von modernem oder Legacy-Code, das Browsern Quellen zur Verf√ºgung stellt und es Ihnen erm√∂glicht, zu entscheiden, welche verwendet werden sollen: <br><br><pre><code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"module"</span></span> src=<span class="hljs-string"><span class="hljs-string">"/modern.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script nomodule src=<span class="hljs-string"><span class="hljs-string">"/legacy.js"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Leider ist nicht alles so einfach.  Der oben gezeigte HTML-Ansatz l√∂st <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ein erneutes Laden von Skripten in Edge und Safari aus</a> . <a name="habracut"></a><br><br><h4>  Was kann getan werden? </h4><br>  Je nach Browser m√ºssen wir eine der Optionen f√ºr kompilierte Skripte bereitstellen, aber einige alte Browser unterst√ºtzen nicht die gesamte daf√ºr erforderliche Syntax. <br><br>  Erstens gibt es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Safari Fix</a> .  Safari 10.1 unterst√ºtzt JS-Module, nicht das <code>nomodule</code> Attribut in Skripten, wodurch sowohl moderner als auch <code>nomodule</code> Code ausgef√ºhrt werden kann.  Das von Safari 10 &amp; 11 unterst√ºtzte nicht standardm√§√üige <code>beforeload</code> kann jedoch zum Polyfill- <code>nomodule</code> . <br><br><h4><a name="first"></a>  Methode Eins: Dynamischer Download </h4><br>  Sie k√∂nnen diese Probleme umgehen, indem Sie einen kleinen Skriptlader implementieren.  √Ñhnlich wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">LoadCSS</a> funktioniert.  Anstatt auf die Implementierung von ES-Modulen und des <code>nomodule</code> Attributs in <code>nomodule</code> , k√∂nnen Sie versuchen, ein Modul-Skript als ‚ÄûTest mit einem Lackmustest‚Äú auszuf√ºhren und basierend auf dem Ergebnis einen modernen oder √§lteren Code herunterzuladen. <br><br><pre> <code class="javascript hljs">&lt;!-- use a <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> script to detect modern browsers: --&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"module"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="actionscript"><span class="xml"><span class="actionscript"> self.modern = </span></span><span class="hljs-literal"><span class="xml"><span class="actionscript"><span class="hljs-literal">true</span></span></span></span><span class="xml"><span class="actionscript"> </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;!-- now use that flag to load modern VS legacy code: --&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="javascript"><span class="xml"><span class="javascript"> addEventListener(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">'load'</span></span></span></span><span class="xml"><span class="javascript">, </span></span><span class="hljs-function"><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span></span><span class="xml"><span class="javascript"><span class="hljs-function">(</span></span></span><span class="hljs-params"></span><span class="xml"><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span></span><span class="xml"><span class="javascript">{ </span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">var</span></span></span></span><span class="xml"><span class="javascript"> s = </span></span><span class="hljs-built_in"><span class="xml"><span class="javascript"><span class="hljs-built_in">document</span></span></span></span><span class="xml"><span class="javascript">.createElement(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">'script'</span></span></span></span><span class="xml"><span class="javascript">) </span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">if</span></span></span></span><span class="xml"><span class="javascript"> (</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">'noModule'</span></span></span></span><span class="xml"><span class="javascript"> </span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">in</span></span></span></span><span class="xml"><span class="javascript"> s) { </span></span><span class="hljs-comment"><span class="xml"><span class="javascript"><span class="hljs-comment">// notice the casing s.type = 'module' s.src = '/modern.js' } else { s.src = '/legacy.js' } document.head.appendChild(s) }) </span></span></span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Bei diesem Ansatz m√ºssen Sie jedoch warten, bis das Skript "Lackmus" -Modul abgeschlossen ist, bevor Sie das richtige Skript implementieren.  Dies liegt daran, dass <code>&lt;sript type="module"&gt;</code> immer asynchron arbeitet.  Aber es gibt einen besseren Weg! <br><br>  Sie k√∂nnen die unabh√§ngige Option implementieren, indem Sie √ºberpr√ºfen, ob das <code>nomodule</code> im Browser unterst√ºtzt wird.  Dies bedeutet, dass wir Browser wie Safari 10.1 als veraltet betrachten, auch wenn sie Module unterst√ºtzen.  Aber es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">k√∂nnte</a> das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beste sein</a> .  Hier ist der relevante Code: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'noModule'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s) { <span class="hljs-comment"><span class="hljs-comment">// notice the casing s.type = 'module' s.src = '/modern.js' } else s.src = '/legacy.js' } document.head.appendChild(s)</span></span></code> </pre> <br>  Dies kann schnell in eine Funktion umgewandelt werden, die modernen oder Legacy-Code l√§dt und auch asynchrones Laden von Code erm√∂glicht: <br><br><pre> <code class="javascript hljs">&lt;script&gt; $loadjs(<span class="hljs-string"><span class="hljs-string">"/modern.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"/legacy.js"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">$loadjs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">src,fallback,s</span></span></span><span class="hljs-function">) </span></span>{ s = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'noModule'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s) s.type = <span class="hljs-string"><span class="hljs-string">'module'</span></span>, s.src = src <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>, s.src = fallback <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.head.appendChild(s) } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt;</span></span></code> </pre> <br>  Was ist hier der Kompromiss? <br><br>  <b>Vorladen</b> <br><br>  Da die L√∂sung vollst√§ndig dynamisch ist, kann der Browser unsere JavaScript-Ressourcen erst erkennen, wenn er den Bootstrapping-Code startet, den wir zum Einf√ºgen moderner oder √§lterer Skripte geschrieben haben.  In der Regel durchsucht ein Browser HTML nach Ressourcen, die er im Voraus herunterladen kann.  Dieses Problem ist gel√∂st, aber nicht ideal: Sie k√∂nnen die moderne Version des Pakets in modernen Browsern mit <code>&lt;link rl=modulpreload&gt;</code> . <br><br>  Leider unterst√ºtzt bisher <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nur Chrome das</a> <code>modulepreload</code> . <br><br><pre> <code class="javascript hljs">&lt;link rel=<span class="hljs-string"><span class="hljs-string">"modulepreload"</span></span> href=<span class="hljs-string"><span class="hljs-string">"/modern.js"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"module"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"><span class="xml"><span class="undefined">self.modern=1</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;!-- etc --&gt;</code> </pre> <br>  Wenn diese Technik f√ºr Sie geeignet ist, k√∂nnen Sie die Gr√∂√üe des HTML-Dokuments reduzieren, in das Sie diese Skripte einbetten.  Wenn Ihre Nutzdaten klein sind, z. B. ein Begr√º√üungsbildschirm oder ein Downloadcode f√ºr Clientanwendungen, ist es unwahrscheinlich, dass das L√∂schen des Preload-Scanners die Leistung beeintr√§chtigt.  Wenn Sie auf dem Server viel wichtiges HTML zeichnen, um es an Browser zu senden, ist der Preload-Scanner f√ºr Sie hilfreich, und der beschriebene Ansatz ist nicht die beste Option f√ºr Sie. <br><br>  So k√∂nnte diese L√∂sung im Einsatz aussehen: <br><br><pre> <code class="javascript hljs">&lt;link rel=<span class="hljs-string"><span class="hljs-string">"modulepreload"</span></span> href=<span class="hljs-string"><span class="hljs-string">"/modern.js"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"module"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"><span class="xml"><span class="undefined">self.modern=1</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script&gt; $loadjs(<span class="hljs-string"><span class="hljs-string">"/modern.js"</span></span>,<span class="hljs-string"><span class="hljs-string">"/legacy.js"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">$loadjs</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e,d,c</span></span></span><span class="hljs-function">)</span></span>{c=<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"script"</span></span>),self.modern?(c.src=e,c.type=<span class="hljs-string"><span class="hljs-string">"module"</span></span>):c.src=d,<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.head.appendChild(c)} &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt;</span></span></code> </pre> <br>  Es sollte auch beachtet werden, dass die Liste der Browser, die JS-Module unterst√ºtzen, fast dieselbe ist wie die, die <code>&lt;link rl=preload&gt;</code> .  F√ºr einige Sites kann es angebracht sein, <code>&lt;link rl=preload as=script crossorigin&gt;</code> anstelle von <code>modulepreload</code> .  Die Leistung kann sich verschlechtern, da das klassische <code>modulepreload</code> Skripten keine gleichm√§√üige Analyse im Laufe der Zeit impliziert, wie dies beim <code>modulepreload</code> der Fall <code>modulepreload</code> . <br><br><a name="second"></a><h4>  Methode 2: User Agent verfolgen </h4><br>  Ich habe kein geeignetes Codebeispiel, da das Verfolgen von User Agent keine triviale Aufgabe ist.  Aber dann k√∂nnen Sie den ausgezeichneten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel im Smashing Magazine</a> lesen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">.</a> <br><br>  Tats√§chlich beginnt alles mit dem gleichen <code>&lt;scrit src=bundle.js&gt;</code> in HTML f√ºr alle Browser.  Wenn bundle.js angefordert wird, analysiert der Server die User Agent-Zeichenfolge des anfordernden Browsers und w√§hlt aus, welches JavaScript zur√ºckgegeben werden soll - modern oder alt, je nachdem, wie der Browser erkannt wurde. <br><br>  <b>Der Ansatz ist universell, hat jedoch schwerwiegende Konsequenzen:</b> <b><br></b> <br><ul><li>  Da Smart Server erforderlich sind, funktioniert dieser Ansatz unter statischen Bereitstellungsbedingungen (statische Site-Generatoren, Netlify usw.) nicht. </li><li>  Das Caching f√ºr diese JavaScript-URLs h√§ngt jetzt vom User Agent ab, der sehr volatil ist. </li><li>  Die Definition von UA ‚Äã‚Äãist schwierig und kann zu einer falschen Klassifizierung f√ºhren. </li><li>  Die User Agent-Zeichenfolge ist leicht zu f√§lschen und jeden Tag werden neue UAs angezeigt. </li></ul><br>  Eine M√∂glichkeit, diese Einschr√§nkungen zu umgehen, besteht darin, das Modul- / Nomodelmuster mit der User Agent-Differenzierung zu kombinieren, um zu vermeiden, dass mehrere Versionen des Pakets an dieselbe Adresse gesendet werden.  Dieser Ansatz reduziert die Seiten-Cachef√§higkeit, bietet jedoch ein effizientes Vorladen: Der HTML-generierende Server wei√ü, wann das <code>modulepreload</code> und wann das <code>modulepreload</code> <code>preload</code> . <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">renderPage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request, response</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> html = <span class="hljs-string"><span class="hljs-string">`&lt;html&gt;&lt;head&gt;...`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> agent = request.headers.userAgent; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isModern = userAgent.isModern(agent); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isModern) { html += <span class="hljs-string"><span class="hljs-string">` &lt;link rel="modulepreload" href="modern.mjs"&gt; &lt;script type="module" src="modern.mjs"&gt;&lt;/script&gt; `</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { html += <span class="hljs-string"><span class="hljs-string">` &lt;link rel="preload" as="script" href="legacy.js"&gt; &lt;script src="legacy.js"&gt;&lt;/script&gt; `</span></span>; } response.end(html); }</code> </pre> <br>  F√ºr Websites, die bereits als Antwort auf jede Anforderung HTML auf dem Server generieren, kann dies ein effektiver √úbergang zum Herunterladen moderner Skripte sein. <br><br><a name="third"></a><h4>  Methode drei: feine alte Browser </h4><br>  Der negative Effekt des Modul- / Nomodule-Musters ist in √§lteren Versionen von Chrome, Firefox und Safari sichtbar - ihre Anzahl ist sehr gering, da die Browser automatisch aktualisiert werden.  Bei Edge 16-18 ist die Situation anders, aber es gibt Hoffnung: Neue Versionen von Edge verwenden die Chromium-basierte Rendering-Engine, die keine derartigen Probleme aufweist. <br><br>  F√ºr einige Anwendungen w√§re dies ein idealer Kompromiss: Laden Sie die moderne Version des Codes in 90% der Browser herunter und geben Sie den alten Code alten Code.  Die Last in √§lteren Browsern wird zunehmen. <br><br>  √úbrigens nimmt keiner der User Agents, f√ºr die ein solcher Neustart ein Problem darstellt, keinen wesentlichen Anteil am Mobilfunkmarkt ein.  Daher ist es unwahrscheinlich, dass die Quelle all dieser zus√§tzlichen Bytes mobile Ger√§te oder Ger√§te mit einem schwachen Prozessor sind. <br><br>  Wenn Sie eine Site erstellen, auf die haupts√§chlich mobile oder frische Browser zugreifen, ist f√ºr die meisten dieser Benutzer die einfachste Art von Modul- / Nomodelmuster geeignet.  Stellen Sie einfach sicher, dass Sie das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Safari 10.1-Update</a> hinzuf√ºgen, wenn √§ltere iOS-Ger√§te zu Ihnen kommen. <br><br><pre> <code class="javascript hljs">   iOS-. &lt;!-- polyfill <span class="hljs-string"><span class="hljs-string">`nomodule`</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Safari <span class="hljs-number"><span class="hljs-number">10.1</span></span>: --&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"module"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="javascript"><span class="xml"><span class="javascript"> !</span></span><span class="hljs-function"><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span></span><span class="xml"><span class="javascript"><span class="hljs-function">(</span></span></span><span class="hljs-params"><span class="xml"><span class="javascript"><span class="hljs-function"><span class="hljs-params">e,t,n</span></span></span></span></span><span class="xml"><span class="javascript"><span class="hljs-function">)</span></span></span></span><span class="xml"><span class="javascript">{!(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"noModule"</span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">in</span></span></span></span><span class="xml"><span class="javascript">(t=e.createElement(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"script"</span></span></span></span><span class="xml"><span class="javascript">)))&amp;&amp;</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"onbeforeload"</span></span></span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">in</span></span></span></span><span class="xml"><span class="javascript"> t&amp;&amp;(n=!</span></span><span class="hljs-number"><span class="xml"><span class="javascript"><span class="hljs-number">1</span></span></span></span><span class="xml"><span class="javascript">,e.addEventListener(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"beforeload"</span></span></span></span><span class="xml"><span class="javascript">,</span></span><span class="hljs-function"><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span></span><span class="xml"><span class="javascript"><span class="hljs-function">(</span></span></span><span class="hljs-params"><span class="xml"><span class="javascript"><span class="hljs-function"><span class="hljs-params">e</span></span></span></span></span><span class="xml"><span class="javascript"><span class="hljs-function">)</span></span></span></span><span class="xml"><span class="javascript">{</span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">if</span></span></span></span><span class="xml"><span class="javascript">(e.target===t)n=!</span></span><span class="hljs-number"><span class="xml"><span class="javascript"><span class="hljs-number">0</span></span></span></span><span class="xml"><span class="javascript">;</span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">else</span></span></span></span><span class="xml"><span class="javascript"> </span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">if</span></span></span></span><span class="xml"><span class="javascript">(!e.target.hasAttribute(</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"nomodule"</span></span></span></span><span class="xml"><span class="javascript">)||!n)</span></span><span class="hljs-keyword"><span class="xml"><span class="javascript"><span class="hljs-keyword">return</span></span></span></span><span class="xml"><span class="javascript">;e.preventDefault()},!</span></span><span class="hljs-number"><span class="xml"><span class="javascript"><span class="hljs-number">0</span></span></span></span><span class="xml"><span class="javascript">),t.type=</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"module"</span></span></span></span><span class="xml"><span class="javascript">,t.src=</span></span><span class="hljs-string"><span class="xml"><span class="javascript"><span class="hljs-string">"."</span></span></span></span><span class="xml"><span class="javascript">,e.head.appendChild(t),t.remove())}(</span></span><span class="hljs-built_in"><span class="xml"><span class="javascript"><span class="hljs-built_in">document</span></span></span></span><span class="xml"><span class="javascript">) </span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;!-- <span class="hljs-number"><span class="hljs-number">90</span></span>+% <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> browsers: --&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"modern.js"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"module'&gt;&lt;/script&gt;</span></span></span></span></span></span> &lt;!-- IE, Edge &lt;<span class="hljs-number"><span class="hljs-number">16</span></span>, Safari &lt;<span class="hljs-number"><span class="hljs-number">10.1</span></span>, old desktop: --&gt; <span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">&lt;script src="</span></span></span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">legacy.js</span></span></span></span><span class="xml"><span class="hljs-tag">" </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">nomodule</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">async</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">defer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><a name="fourth"></a><h4>  Methode 4: Paketbedingungen anwenden </h4><br>  Eine gute L√∂sung w√§re die Verwendung von <code>nomodule</code> zum bedingten Herunterladen von Paketen mit Code, der in modernen Browsern wie Polyfills nicht ben√∂tigt wird.  Bei diesem Ansatz wird im schlimmsten Fall die Polyf√ºllung geladen oder sogar ausgef√ºhrt (in Safari 10.1), die Auswirkung ist jedoch auf das ‚Äûerneute Polyf√ºllen‚Äú beschr√§nkt.  Angesichts der Tatsache, dass heute der Ansatz zum Herunterladen und Ausf√ºhren von Polyfills in allen Browsern vorherrscht, kann dies eine w√ºrdige Verbesserung sein. <br><br><pre> <code class="javascript hljs">&lt;!-- newer browsers will not load <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> bundle: --&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">nomodule</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"polyfills.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;!-- all browsers load <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> one: --&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"/bundle.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Sie k√∂nnen die Angular-CLI so konfigurieren, dass dieser Ansatz mit Polyfills verwendet wird, wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Minko</a> Gachev <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gezeigt hat</a> .  Nachdem ich diesen Ansatz kennengelernt hatte, wurde mir klar, dass Sie die automatische Polyfill-Injektion in preact-cli aktivieren k√∂nnen. Diese <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PR</a> zeigt, wie einfach es ist, diese Technik zu implementieren. <br><br>  Und wenn Sie WebPack verwenden, gibt es ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">praktisches Plugin</a> f√ºr das <code>html-webpack-plugin</code> , mit dem Sie Paketen mit Polyfills auf einfache Weise ein Nomodul hinzuf√ºgen k√∂nnen. <br><br><h4>  Also, was soll ich w√§hlen? </h4><br>  Die Antwort h√§ngt von Ihrer Situation ab.  Wenn Sie eine Clientanwendung erstellen und Ihr HTML- <code>&lt;sript&gt;</code> etwas mehr als <code>&lt;sript&gt;</code> , ben√∂tigen Sie m√∂glicherweise die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erste Methode</a> . <br><br>  Wenn Sie eine Site erstellen, die auf dem Server gerendert wird, und sich das Caching leisten k√∂nnen, ist die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zweite Methode</a> m√∂glicherweise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">f√ºr Sie</a> geeignet. <br><br>  Wenn Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">universelles</a> Rendering verwenden, kann der Leistungsgewinn, der durch das Scannen vor dem Laden erzielt wird, sehr wichtig sein.  Achten Sie daher auf die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dritte</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vierte</a> Methode.  W√§hlen Sie, was zu Ihrer Architektur passt. <br><br>  Pers√∂nlich w√§hle ich, wobei ich mich auf die Dauer des Parsens auf Mobilger√§ten konzentriere und nicht auf die Kosten f√ºr das Herunterladen in Desktop-Versionen.  Mobile Benutzer betrachten Parsing- und Daten√ºbertragungskosten als tats√§chliche Kosten (Batterieverbrauch und Daten√ºbertragungsgeb√ºhren), w√§hrend Desktop-Benutzer solche Einschr√§nkungen nicht haben.  Ich gehe auch von der Optimierung f√ºr 90% der Benutzer aus - das Hauptpublikum meiner Projekte verwendet moderne und / oder mobile Browser. <br><br><h4>  Was zu lesen </h4><br>  M√∂chten Sie mehr √ºber dieses Thema erfahren?  Sie k√∂nnen von hier aus beginnen: <br><br><ul><li>  Tolle Zusatzinformationen zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">webpack-esnext-boilerplate</a> . </li><li>  Ralph hat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das Modul / Nomodul in Next.js implementiert</a> und arbeitet an einer L√∂sung f√ºr h√§ufig auftretende Probleme. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473994/">https://habr.com/ru/post/de473994/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473984/index.html">Data Science Digest (Oktober 2019)</a></li>
<li><a href="../de473986/index.html">‚ÄûMein Traum ist es, eine Person durch die B√§ume zu sehen‚Äú - Gr√ºnderin von Lisa Alert √ºber moderne Suchtechnologien</a></li>
<li><a href="../de473988/index.html">Optimierung der Serververteilung √ºber die Racks</a></li>
<li><a href="../de473990/index.html">Lerne OpenGL. Lektion 7.2 - Zeichnen von Text</a></li>
<li><a href="../de473992/index.html">√úberblick √ºber moderne Protokolle in industriellen Automatisierungssystemen</a></li>
<li><a href="../de473998/index.html">Niederlande oder hin und zur√ºck</a></li>
<li><a href="../de474000/index.html">IQBX - elektromechanischer Designer f√ºr Kreise und Heimwerker [Konzeptidee]</a></li>
<li><a href="../de474004/index.html">Von Norilsk nach Riad: Ein echtes Beispiel f√ºr Kingston Industrial Temperature microSD UHS-I-Speicherkarten</a></li>
<li><a href="../de474008/index.html">Greenplum 6: √úberpr√ºfung der neuen Funktionen</a></li>
<li><a href="../de474012/index.html">Sicherheit f√ºr Docker-Container</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>