<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📬 🌠 👩🏿‍🤝‍👨🏼 نحدد هجوم فيروس التشفير ، ونصل إلى وحدة تحكم المجال ونحاول مقاومة هذه الهجمات. 🙊 🙆🏻 🏨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="WannaCry و NotPetya و BadRabbit وغيرها من فيروسات الفدية التي هزت العالم بأسره منذ عام أو عامين. اليوم ، هناك ضوضاء أقل حول هجمات هذه الأنواع من الفير...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>نحدد هجوم فيروس التشفير ، ونصل إلى وحدة تحكم المجال ونحاول مقاومة هذه الهجمات.</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/galssoftware/blog/474574/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ol/w0/dw/olw0dwca4jcb1xs3dod5nhtwfdo.gif"><br><br>  WannaCry و NotPetya و BadRabbit وغيرها من فيروسات الفدية التي هزت العالم بأسره منذ عام أو عامين.  اليوم ، هناك ضوضاء أقل حول هجمات هذه الأنواع من الفيروسات ، ولكن القصص التي تحدث مع الهجمات لا تزال تحدث.  في هذه المقالة ، سأعرض إحدى الأدوات لإيقاف هجوم مثل هذا الفيروس: الكشف عن التطفل بسرعة وتحديد مكان المشكلة.  كل هذا بمساعدة أداة تحليل السجل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وأداة</a> حماية الاختراق. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Quest InTrust</a> .  تحت القط توجد لقطات شاشة ورابط إلى مستودعات البرامج النصية الضارة.  دعنا نذهب! <br><a name="habracut"></a><br>  Quest InTrust هو حل متكامل يتضمن مجموعة من الأنواع المختلفة من السجلات وبيانات syslog والمحللات الجاهزة لأنواع مختلفة من المعدات.  هناك قواعد محددة مسبقا لاتخاذ إجراءات لمنع الهجمات.  الآن سوف نلقي نظرة فاحصة على كل هذا مع أمثلة عن تحليل هجوم فيروس مشفر والوصول إلى وحدة تحكم مجال <br><br><h1 style=";text-align:right;direction:rtl">  هجوم الفدية </h1><br>  مبدأ الهجوم هو إنشاء ملفات أو مجلدات مشفرة جديدة وحذف الملفات الأصلية.  حسنًا ، إذن طلب فدية في عملات بيتكوين أو بطريقة أخرى.  يعتمد تعريف هذا النوع من الهجوم على اكتشاف الحذف الشامل وإنشاء الملفات.  خاصة إذا كان هذا يحدث بعد ساعات الدراسة. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">زوجان من المستودعات مع أمثلة على برامج نصية للتشفير</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">بوويرشيل-الفدية</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الفدية-التشفير encryptor-Decryptor</a> <br></div></div><br>  لجمع أحداث التغيير ، نستخدم التكامل مع حل التدقيق في Quest Change Auditor (تمت كتابته بالفعل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">في المقالة السابقة</a> وحتى <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">بالمقارنة مع منتج من منافس</a> ).  بالنسبة للأحداث من هذا المصدر ، يحتوي InTrust على قواعد محددة مسبقًا لاكتشاف الحالات الشاذة.  بالطبع ، يمكنك إضافة أي منطق معالجة الأحداث هنا.  في المثال الخاص بي ، تم تحديد أنه أثناء الإنشاء الجماعي للملفات (أكثر من 5 قطع في دقيقة واحدة) ، سيتم حظر حساب المستخدم وسيتم رفض الوصول إلى الأدلة المشتركة. <br><br><img src="https://habrastorage.org/webt/t3/s3/17/t3s317ynfhnygdue6ehjvy5gadi.png"><br><br>  تشير إعدادات السياسة إلى الدليل الذي تنطبق عليه القاعدة وقائمة الإعلامات.  إذا كان لدى AD معلومات عن تبعية الموظف ، فيمكنك إرسال خطاب إلى مشرفه.  ومن الحالات المفيدة تحديد محاولات الوصول إلى الملفات التي ، على ما يبدو ، ليست ضرورية لأداء واجبات هذا الموظف المعين.  قد يكون ذلك مناسبًا بشكل خاص قبل الفصل ، عندما تريد أن تأخذ تطورات جاهزة معك. <br><br><img src="https://habrastorage.org/webt/a5/xy/wy/a5xywya_veqwkqljbbrtzqsfyla.png"><br><br>  بعد التحقق من جميع الإعدادات ، دعنا ننتقل إلى برنامج تشفير النصوص المعد مسبقًا.  وتشغيله. <br><br><img src="https://habrastorage.org/webt/qd/f5/h-/qdf5h-zk24kdq47biltyggzgavg.png"><br><br>  في إعدادات الكشف عن الهجوم ، تمت الإشارة إلى "أكثر من 5 ملفات" ، كما ترون ، بعد 7 ملفات تم إيقاف الفيروس (تم حظر المستخدم وتعطيل الوصول إلى الدليل).  من السهل النزول  في الوقت نفسه ، تلقى الموظفون المسؤولون الإخطارات. <br><br><h1 style=";text-align:right;direction:rtl">  الهجوم على وحدة تحكم المجال </h1><br>  فيما يلي سيناريو الهجوم ، الذي يسمح لك بالوصول إلى الحساب الإداري ، ونتيجة لذلك ، وحدة تحكم المجال.  يتم أيضًا تضمين الكشف عن تنفيذ أوامر cmdlets المتخصصة (على سبيل المثال ، تفريغ حسابات المجال) في قائمة قواعد Quest InTrust المحددة مسبقًا (السطر الأول في التحديد في الصورة أدناه).  بالإضافة إلى ذلك ، في المثال الخاص بي ، تتم الإشارة إلى المستخدمين من "الورقة البيضاء" والتي لا تنطبق عليها القواعد (السطر الثاني في التحديد في الصورة أدناه). <br><br><img src="https://habrastorage.org/webt/bk/6j/eg/bk6jegg3lxxw_avksd2etqkhttg.png"><br><br>  باستخدام البرنامج النصي <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">invoke-mimikatz</a> ، يتم تمكين إنشاء تفاصيل الحساب.  في الوقت نفسه ، لا يتم إنشاء أي ملفات على نظام الملفات.  أولاً ، تحقق من اسم الحساب الذي قمت بتسجيل الدخول بموجبه.  كما ترون ، هذا المستخدم هو من "القائمة البيضاء" ، والذي يمكنه تنفيذ أي أوامر cmdlets بحرية. <br><br><img src="https://habrastorage.org/webt/mz/ge/wu/mzgewuwguxg1kc8vssgbddrgfxy.png"><br><br>  ثم ننفذ البرنامج النصي المُعد مسبقًا.  في الخرج ، نحصل على استنتاج نجد فيه تفاصيل مستخدم الاختبار. <br><br><img src="https://habrastorage.org/webt/b4/l6/oi/b4l6oioub43m6dnl1b2dhs9one0.png"><br><br>  في الخطوة التالية ، اكتشفنا المجموعات التي ينتمي إليها هذا المستخدم.  مجموعات المسؤول موجودة. <br><br><img src="https://habrastorage.org/webt/-j/vy/92/-jvy928mvqdn7kjtgoquyhdvwqo.png"><br><br>  الآن نتعلم أسماء وحدات تحكم المجال.  في مثالي ، هو وحده. <br><br><img src="https://habrastorage.org/webt/k2/v2/4z/k2v24z02-4bpvkudt703fpke5jc.png"><br><br>  الخطوة التالية في أي هجوم محتمل هي تسجيل الدخول إلى وحدة تحكم مجال.  يبقى إدخال كلمة المرور التي تم تسليط الضوء عليها بالفعل. <br><br><img src="https://habrastorage.org/webt/ip/8u/d5/ip8ud53rjhhvejbjyf98u-4hbqo.png"><br><br>  والحصول على الوصول إلى تنفيذ أي أوامر على وحدة تحكم المجال. <br><br><img src="https://habrastorage.org/webt/w7/uo/cu/w7uocu-xypu2qh9nd0ycdlxn2du.png"><br><br>  دعونا الآن نحاول القيام بنفس خوارزمية الإجراءات ، ولكن نيابة عن مستخدم لم تتم إضافته إلى "القائمة البيضاء" في InTrust.  من أجل نقاء التجربة ، نتحقق من اسم المستخدم.  ثم نقوم بتنفيذ البرنامج النصي invoke-mimikatz. <br><br><img src="https://habrastorage.org/webt/x-/8h/yp/x-8hypkn4uu8e4q8jhouok6rlvu.png"><br><br>  من بين الإجراءات المذكورة في InTrust كانت إنهاء جلسة الوصول الطرفية وحظر المستخدم.  وهذا ما حدث. <br><br><img src="https://habrastorage.org/webt/fo/iu/sx/foiusxs7rjzlxzjomeows2ambus.png"><br><br>  تحقق الآن من هذا الحساب مرة أخرى. <br><br><img src="https://habrastorage.org/webt/-h/fo/vj/-hfovjzipni1-kbpno0qlmmxxyc.png"><br><br>  يتم منع الهجوم ، يتم حظر المستخدم ، يتم حفظ العالم. <br><br>  إذا كانت لديك سياسات خاصة بك لمحاربة أنواع مختلفة من المتسللين ، يمكنك أيضًا تحديدها في InTrust.  إلى جانب منتجات Quest الأخرى ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تغيير المراجع</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ومراسل المؤسسة</a> ) استنادًا إلى InTrust ، يمكنك إنشاء نظام SIEM متكامل لتحديد ومنع العواقب الوخيمة للهجمات الرقمية على الأعمال. <br><br>  يمكن تجربة InTrust ومنتجات Quest الأخرى في بيئتك كجزء من مشروع تجريبي.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">اترك طلبًا</a> لمعرفة المزيد. <br><br>  لدينا مقالات أخرى على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">البرمجيات</a> العلامة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">بنات</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar474574/">https://habr.com/ru/post/ar474574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar474562/index.html">ليغو MINDSTORMS التعليم EV3 + MicroPython: نحن برنامج منشئ للأطفال في لغة الكبار</a></li>
<li><a href="../ar474564/index.html">Autosampler - الحياة بعد الحياة</a></li>
<li><a href="../ar474566/index.html">تحتاج هذه المدينة إلى بطل جديد: مراجعة حقائب الظهر التي صممت من بوبي هيرو</a></li>
<li><a href="../ar474568/index.html">الحليب من الأسنان: تغيير المهنة للخلايا</a></li>
<li><a href="../ar474572/index.html">هل هذا طبيعي على الإطلاق؟ المشكلة الأساسية في علم النفس</a></li>
<li><a href="../ar474576/index.html">رؤية صوتية انظري من الظلام</a></li>
<li><a href="../ar474578/index.html">لماذا تحارب خدمة التسويق عبر البريد الإلكتروني فعليًا الرسائل غير المرغوب فيها وكيف تعمل</a></li>
<li><a href="../ar474580/index.html">جعل التطبيق متاحًا باستخدام مكتبة اختبار توفر الفأس</a></li>
<li><a href="../ar474582/index.html">(بدون) الخدمات المصرفية عبر الإنترنت الخطرة: دراسة للموارد على شبكة الإنترنت من البنوك في روسيا والعالم</a></li>
<li><a href="../ar474584/index.html">قم بتثبيت Kali Linux بواجهة رسومية على خادم افتراضي</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>