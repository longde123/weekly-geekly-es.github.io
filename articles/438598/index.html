<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö• üêµ üì∏ React & BEM - colaboraci√≥n oficial. Parte historica üëæ üë©‚Äç‚úàÔ∏è üßõüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aqu√≠ est√° la historia de integrar la metodolog√≠a BEM en el universo React. El material que leer√° se basa en la experiencia de los desarrolladores de Y...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>React & BEM - colaboraci√≥n oficial. Parte historica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/438598/"><p>  Aqu√≠ est√° la historia de integrar la metodolog√≠a BEM en el universo React.  El material que leer√° se basa en la experiencia de los desarrolladores de Yandex que desarrollan el servicio m√°s grande y cargado en Rusia: Yandex.Search.  Nunca antes hab√≠amos hablado con tanto detalle y profundidad sobre por qu√© lo hicimos, y no de otra manera, qu√© nos motiv√≥ y qu√© es lo que realmente quer√≠amos.  El extra√±o recibi√≥ comunicados en seco y cr√≠ticas en las conferencias.  Solo al margen se pod√≠a escuchar algo as√≠.  Como coautor, estaba indignado por la escasez de informaci√≥n cada vez que hablaba de nuevas versiones de bibliotecas.  Pero esta vez compartiremos todos los detalles. </p><br><img src="https://habrastorage.org/webt/wb/mt/xc/wbmtxcvurtd6cdv1aomjrtcyfw8.png"><br><p>  Todos han escuchado sobre la metodolog√≠a BEM.  Selectores CSS con guiones bajos.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Se</a> habl√≥ del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enfoque de componentes</a> , teniendo en cuenta la forma en que se escriben los selectores CSS CSS.  Pero no habr√° una palabra sobre CSS en el art√≠culo.  ¬°Solo JS, solo hardcore! </p><a name="habracut"></a><br><p>  Para entender por qu√© apareci√≥ la metodolog√≠a y qu√© problemas enfrent√≥ Yandex en ese momento, le recomiendo que se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">familiarice con la historia de</a> BEM. </p><br><h2 id="prolog">  Prologo </h2><br><p> BEM realmente naci√≥ como una salvaci√≥n de una fuerte conectividad y anidamiento en CSS.  Pero dividir la hoja <code>style.css</code> en archivos para cada bloque, elemento o modificador condujo inevitablemente a una estructuraci√≥n similar del c√≥digo JavaScript. </p><br><p>  En 2011, Open Source adquiri√≥ las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">primeras confirmaciones del</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>i-bem.js</code></a> , que funcionaba junto con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>bem-xjst</code></a> motor de plantillas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>bem-xjst</code></a> .  Ambas tecnolog√≠as surgieron de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">XSLT</a> y sirvieron a la idea popular de separar la l√≥gica de negocios y la presentaci√≥n de componentes.  En el mundo exterior, estos fueron los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">grandes momentos de</a> Handlebars y Underscore. </p><br><p>  <code>bem-xjst</code> es un tipo diferente de motor de plantillas.  Para aumentar mi conocimiento de la arquitectura de los enfoques de estandarizaci√≥n, recomiendo el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe de Sergei Berezhnoy</a> .  <code>bem-xjst</code> probar el motor de plantillas <code>bem-xjst</code> en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">entorno limitado</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">l√≠nea</a> . </p><br><p>  Debido a los detalles de los servicios de b√∫squeda de Yandex, las interfaces de usuario se crean utilizando datos.  La p√°gina de resultados de b√∫squeda es √∫nica para cada consulta. </p><br><p><img src="https://habrastorage.org/webt/6g/af/sc/6gafsczppz4ul8glzeliauwnkjc.png"><br>  <em>Consulta de b√∫squeda por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace</a></em> </p><br><p><img src="https://habrastorage.org/webt/ni/z5/nc/niz5ncgv3rlci2jfymornobfvcy.png"><br>  <em>Consulta de b√∫squeda por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">referencia</a></em> </p><br><p><img src="https://habrastorage.org/webt/eb/6q/ws/eb6qws6vwtclkce_jsumewy4jkk.png"><br>  <em>Consulta de b√∫squeda por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">referencia</a></em> </p><br><p>  Cuando la divisi√≥n en un bloque, elemento y modificador se extendi√≥ al sistema de archivos, esto hizo posible recopilar solo el c√≥digo necesario de manera m√°s efectiva, de hecho para cada p√°gina, para cada solicitud de usuario.  Pero como? </p><br><pre> <code class="plaintext hljs">src/components ‚îú‚îÄ‚îÄ ComponentName ‚îÇ ‚îú‚îÄ‚îÄ _modName ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ComponentName_modName.tsx ‚Äî   ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ComponentName_modName_modVal.tsx ‚Äî    ‚îÇ ‚îú‚îÄ‚îÄ ElementName ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ComponentName-ElementName.tsx ‚Äî   ComponentName ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.i18n ‚Äî   ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ru.ts ‚Äî     ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ en.ts ‚Äî     ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ index.ts ‚Äî    ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.test ‚Äî   ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.page-object.js ‚Äî Page Object ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.hermione.js ‚Äî   ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ ComponentName.test.tsx ‚Äî unit- ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.tsx ‚Äî    ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.scss ‚Äî   ‚îÇ ‚îú‚îÄ‚îÄ ComponentName.examples.tsx ‚Äî    Storybook ‚îÇ ‚îî‚îÄ‚îÄ README.md ‚Äî  </code> </pre> <br><p>  <em>Estructura moderna del directorio de componentes</em> </p><br><p>  Como en otras compa√±√≠as, en Yandex, los desarrolladores de interfaces son responsables de la interfaz, que consiste en la parte del cliente en el navegador y la parte del servidor en <code>Node.js</code>  La parte del servidor procesa los datos de la b√∫squeda "grande" y les impone plantillas.  El procesamiento primario de datos convierte JSON a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BEMJSON</a> , la estructura de datos para <code>bem-xjst</code> motor de plantillas <code>bem-xjst</code> .  El motor de plantillas rodea cada nodo del √°rbol e impone una plantilla sobre √©l.  Dado que la conversi√≥n primaria se lleva a cabo en el servidor, y debido a la divisi√≥n en peque√±as entidades, los nodos corresponden a los archivos, durante la generaci√≥n de la plantilla empujamos el c√≥digo al navegador que se usar√° solo en la p√°gina actual. </p><br><p>  A continuaci√≥n se muestra la correspondencia de los nodos BEMJSON con los archivos del sistema de archivos. </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'Select'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'Item'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elemMods</span></span>: { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'navigation'</span></span> } };</code> </pre> <br><pre> <code class="plaintext hljs">src/components ‚îú‚îÄ‚îÄ Select ‚îÇ ‚îú‚îÄ‚îÄ Item ‚îÇ ‚îÇ _type ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ Select-Item_type_navigation.js ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ Select-Item_type_navigation.css</code> </pre> <br><p>  El sistema modular <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>YModules</code></a> fue responsable de aislar los componentes del c√≥digo JavaScript en el navegador.  Le permite entregar m√≥dulos de forma sincr√≥nica y asincr√≥nica al navegador.  <code>i-bem.js</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">se puede encontrar</a> un ejemplo de c√≥mo funcionan los componentes con <code>YModules</code> e <code>i-bem.js</code> .  Hoy, para la mayor√≠a de los desarrolladores, el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>  webpack</code></a> y el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">est√°ndar</a> in√©dito <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de importaciones din√°micas hacen esto</a> . </p><br><p>  Un conjunto de metodolog√≠a BEM, motor de plantillas declarativas y marco JS con un sistema modular permitieron resolver cualquier problema.  Pero con el tiempo, la din√°mica ha llegado a las interfaces de usuario. </p><br><h2 id="novaya-nadezhda">  Nueva esperanza </h2><br><p>  En 2013, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">React encant√≥ el</a> c√≥digo abierto.  De hecho, Facebook comenz√≥ a usarlo en 2011.  James Long, en sus notas de la conferencia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estadounidense JS Conf</a> , dice: </p><br><blockquote>  Las dos √∫ltimas sesiones fueron una sorpresa.  El primero fue dado por dos desarrolladores de Facebook y anunciaron <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Facebook React</a> .  No tom√© muchas notas porque estaba en estado de shock por la mala idea que creo que es.  Esencialmente, crearon un lenguaje llamado JSX que le permite incrustar XML en JavaScript para crear interfaces de usuario reactivas en vivo.  XML  En JavaScript </blockquote><p>  React ha cambiado el enfoque para dise√±ar aplicaciones web.  Se ha vuelto tan popular que hoy no puedes encontrar un desarrollador que no haya o√≠do hablar de React.  Pero otra cosa es importante: las aplicaciones se han vuelto diferentes, el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SPA ha</a> llegado a nuestras vidas. </p><br><p>  En general, se acepta que los desarrolladores de Yandex tienen un sentido especial de belleza con respecto a la tecnolog√≠a.  A veces extra√±o, que es dif√≠cil discutir, pero nunca sin raz√≥n.  Cuando React estaba ganando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estrellas en GitHub</a> , muchos de los que estaban familiarizados con las tecnolog√≠as web de Yandex insistieron: Facebook gan√≥, abandon√≥ sus manualidades y corri√≥ a reescribir todo en React antes de que sea demasiado tarde.  Es importante entender dos cosas. </p><br><p>  En primer lugar, no hubo guerra.  Las empresas no compiten en la creaci√≥n del mejor marco en la Tierra.  Si una empresa comienza a pasar menos tiempo (lectura - dinero) en tareas de infraestructura con la misma productividad, todos se beneficiar√°n de esto.  No tiene sentido escribir marcos para escribir marcos.  Los mejores desarrolladores crean herramientas que resuelven las tareas de la empresa de la mejor manera.  Empresas, servicios, objetivos: todo es diferente.  De ah√≠ la variedad de herramientas. </p><br><p>  En segundo lugar, est√°bamos buscando una forma de usar React de la forma en que nos gustar√≠a que fuera.  Con todas las caracter√≠sticas que dieron nuestras tecnolog√≠as descritas anteriormente. </p><br><p>  Se cree ampliamente que el c√≥digo que usa React es r√°pido por defecto.  Si t√∫ tambi√©n lo crees, est√°s profundamente equivocado.  Lo √∫nico que hace React es, en la mayor√≠a de los casos, ayuda a interactuar de manera √≥ptima con el DOM. </p><br><p>  Hasta la versi√≥n 16, React ten√≠a un defecto fatal.  Fue 10 veces m√°s lento que <code>bem-xjst</code> en el servidor.  No podr√≠amos permitirnos ese desperdicio.  El tiempo de respuesta para Yandex es una de las m√©tricas clave.  Imagine que cuando solicita una receta de vino caliente, obtendr√° una respuesta 10 veces m√°s lenta de lo habitual.  No estar√° contento con las excusas, incluso si sabe algo sobre desarrollo web.  ¬øQu√© podemos decir sobre la explicaci√≥n como "pero los desarrolladores se han sentido m√°s c√≥modos hablando con el DOM"?  Agregue aqu√≠ la relaci√≥n entre el precio de implementaci√≥n y el beneficio, y usted mismo tomar√° la √∫nica decisi√≥n correcta. </p><br><p>  Afortunadamente para el dolor, los desarrolladores son personas extra√±as.  Si algo no funciona, entonces esta no es una raz√≥n para dejar todo ... </p><br><h2 id="shivorot-navyvorot">  Boca abajo </h2><br><p>  Est√°bamos seguros de que podr√≠amos vencer la lentitud de React.  Ya tenemos un motor de plantillas r√°pido.  Todo lo que necesita es generar HTML en el servidor usando <code>bem-xjst</code> , y en el cliente para "forzar" a React a aceptar este marcado como propio.  La idea era tan simple que nada presagiaba un fracaso. </p><br><p>  En versiones de hasta 15 inclusive, React valid√≥ la validez del marcado utilizando una suma de hash, un algoritmo que convierte cualquier optimizaci√≥n en una calabaza.  Para convencer a React de la validez del marcado, era necesario anotar una identificaci√≥n para cada nodo y calcular la suma hash de todos los nodos.  Tambi√©n significaba admitir un conjunto dual de plantillas: React para el cliente y <code>bem-xjst</code> para el servidor.  Pruebas de velocidad simples con instalaci√≥n de identificaci√≥n dejaron en claro que no ten√≠a sentido continuar. </p><br><p>  El <code>bem-xjst</code> bem <code>bem-xjst</code> es una herramienta muy subestimada.  Mira el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe del responsable principal de Glory Oliyanchuk</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">compru√©balo por</a> ti mismo.  <code>bem-xjst</code> se basa en una arquitectura que le permite usar una sintaxis de plantilla para diferentes transformaciones del √°rbol de origen.  Muy similar a React, ¬øno?  Esta caracter√≠stica hoy permite que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>react-sketchapp</code></a> herramientas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>react-sketchapp</code></a> . </p><br><p>  Fuera de la caja <code>bem-xjst</code> contiene dos tipos de conversiones: en HTML y en JSON.  Cualquier desarrollador lo suficientemente diligente puede escribir su propio motor para transformar plantillas en cualquier cosa.  <code>bem-xjst</code> transformar un √°rbol de datos en una secuencia de llamadas a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">funciones HyperScript</a> .  Lo que significaba compatibilidad total con React y otras implementaciones del algoritmo Virtual DOM, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Preact</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/yPV6pcMdezM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  <em>Una introducci√≥n detallada a la generaci√≥n de llamadas a la funci√≥n HyperScript</em> </p><br><p>  Dado que las plantillas React requieren la coexistencia del dise√±o y la l√≥gica empresarial, tuvimos que incorporar la l√≥gica de <code>i-bem.js</code> a nuestras plantillas, que no estaban destinadas a esto.  Para ellos no era natural.  Iban de manera diferente.  Por cierto! </p><br><p>  A continuaci√≥n se muestra un ejemplo de las profundidades de pegar mundos diferentes en un tiempo de ejecuci√≥n. </p><br><pre> <code class="javascript hljs">block(<span class="hljs-string"><span class="hljs-string">'select'</span></span>).elem(<span class="hljs-string"><span class="hljs-string">'menu'</span></span>)( def()(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> React = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'react'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Menu = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../components/menu/menu'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MenuItem = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../components/menu-item/menu-item'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> _select = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ctx._select; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> selectComponent = _select._select; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> React.createElement.apply(React, [ Menu, { <span class="hljs-attr"><span class="hljs-attr">mix</span></span>: { <span class="hljs-attr"><span class="hljs-attr">block</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.block, <span class="hljs-attr"><span class="hljs-attr">elem</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.elem }, <span class="hljs-attr"><span class="hljs-attr">ref</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">menu</span></span></span><span class="hljs-function"> =&gt;</span></span> selectComponent._menu = menu, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: _select.mods.size, <span class="hljs-attr"><span class="hljs-attr">disabled</span></span>: _select.mods.disabled, <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: _select.mods.mode, <span class="hljs-attr"><span class="hljs-attr">content</span></span>: _select.options, <span class="hljs-attr"><span class="hljs-attr">checkedItems</span></span>: _select.bindings.checkedItems, <span class="hljs-attr"><span class="hljs-attr">style</span></span>: _select.bindings.popupMenuWidth, <span class="hljs-attr"><span class="hljs-attr">onKeyDown</span></span>: _select.bindings.onKeyDown, <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: _select.mods.theme, }].concat(_select.options.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">option</span></span></span><span class="hljs-function"> =&gt;</span></span> React.createElement( MenuItem, { <span class="hljs-attr"><span class="hljs-attr">onClick</span></span>: _select.bindings.onOptionCheck, <span class="hljs-attr"><span class="hljs-attr">theme</span></span>: _select.mods.theme, <span class="hljs-attr"><span class="hljs-attr">val</span></span>: option.value, }, option.content) )) ); }) );</code> </pre> <br><p>  Por supuesto, tuvimos nuestra propia asamblea.  Como sabes, la operaci√≥n m√°s r√°pida es la concatenaci√≥n de cadenas.  El motor <code>bem-xjst</code> se construy√≥ sobre √©l, el ensamblaje se construy√≥ sobre √©l.  Los archivos de bloques, elementos y modificadores yac√≠an en carpetas, y el ensamblaje solo ten√≠a que pegar los archivos en la secuencia correcta.  Con este enfoque, puede pegar JS, CSS y plantillas en paralelo, as√≠ como las propias entidades.  Es decir, si tiene cuatro componentes en un proyecto, cuatro n√∫cleos en la computadora port√°til y el ensamblaje de la tecnolog√≠a de un componente lleva un segundo, la construcci√≥n del proyecto tomar√° dos segundos.  Aqu√≠ deber√≠a quedar m√°s claro c√≥mo logramos insertar solo el c√≥digo necesario en el navegador. </p><br><p>  Todo esto para nosotros lo hizo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ENB</a> .  Recibimos el √°rbol final para la estandarizaci√≥n solo en tiempo de ejecuci√≥n, y dado que la dependencia entre los componentes tuvo que surgir un poco antes para recolectar paquetes, esta funci√≥n fue asumida por la tecnolog√≠a poco conocida <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>deps.js</code></a>  Le permiti√≥ crear un gr√°fico de dependencia entre componentes, despu√©s de lo cual el recopilador podr√≠a pegar el c√≥digo en la secuencia deseada, sin pasar por el gr√°fico. </p><br><p>  React versi√≥n 16 dej√≥ de funcionar en esta direcci√≥n. La velocidad de ejecuci√≥n de las plantillas en el servidor fue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">igual</a> .  En las instalaciones de producci√≥n, la diferencia se hizo imperceptible. </p><br><p>  Nodo: <strong>v8.4.0</strong> <br>  Ni√±os: <strong>5K</strong> </p><br><table><thead><tr><th>  renderizador </th><th>  hora media </th><th>  ops / sec </th></tr></thead><tbody><tr><td>  <strong>preact</strong> v8.2.6 </td><td>  66.235ms </td><td>  15 </td></tr><tr><td>  <strong>bem-xjst</strong> v8.8.4 </td><td>  71.326 ms </td><td>  14 </td></tr><tr><td>  <strong>reaccionar</strong> v16.1.0 </td><td>  73,966 ms </td><td>  14 </td></tr></tbody></table><br><p>  Usando los enlaces a continuaci√≥n puede restaurar el historial del enfoque: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://ru.bem.info/forum/961/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/awinogradov/react-bl</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/awinogradov/xjst-ddsl</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/awinogradov/ddsl-react</a> </li></ul><br><p>  ¬øHemos intentado algo m√°s? </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/veged/bem-components-react</a> : el primer enfoque para implementar la metodolog√≠a en React; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/Yeti-or/bem-hazard</a> : un enfoque similar basado en el motor de plantillas BH.  Con BH, por cierto, puedes jugar en l√≠nea; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/dfilatov/bem-react</a> - creando componentes a trav√©s de BEMJSON; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/rebem</a> : utilidades BEM en el mundo React. </li></ul><br><p><img src="https://habrastorage.org/webt/uv/si/wt/uvsiwtsrexhffeuznrqhpxvtjva.png"></p><br><h2 id="motivaciya">  Motivaci√≥n </h2><br><p>  En el medio de la historia, ser√° √∫til hablar sobre lo que nos motiv√≥.  Vali√≥ la pena hacer esto al principio, pero, qui√©n recuerda el viejo, ese ojo como un regalo.  ¬øPor qu√© necesitamos todo esto?  ¬øQu√© puede aportar BEM que React no puede hacer?  Preguntas que casi todos hacen. </p><br><h3 id="dekompoziciya">  Descomposici√≥n </h3><br><p>  La funcionalidad de los componentes se vuelve m√°s complicada de a√±o en a√±o, y aumenta el n√∫mero de variaciones.  Esto se expresa por las construcciones <code>if</code> o <code>switch</code> , como resultado, la base del c√≥digo crece inevitablemente, como resultado: el peso del componente y el proyecto que usa dicho componente aumenta.  La parte principal de la l√≥gica del componente React est√° contenida en el m√©todo <code>render()</code> .  Para cambiar la funcionalidad de un componente, es necesario reescribir la mayor parte del m√©todo, lo que inevitablemente conduce a un aumento exponencial en el n√∫mero de componentes altamente especializados. </p><br><p>  Todos conocen las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bibliotecas</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">material-ui</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fabric-ui</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">react-bootstrap</a> .  En general, todas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">las bibliotecas conocidas</a> con componentes tienen el mismo inconveniente.  Imagine que tiene varios proyectos y todos usan la misma biblioteca.  Toma los mismos componentes, pero en diferentes variaciones: aqu√≠ hay selecciones con casillas de verificaci√≥n, no hay, hay botones azules con un icono, hay botones rojos sin √©l.  El peso de CSS y JS que le brinda la biblioteca ser√° el mismo en todos los proyectos.  Pero por que?  Las variaciones de componentes est√°n incrustadas dentro del componente en s√≠ y vienen con √©l, lo desee o no.  Para nosotros esto es inaceptable. </p><br><p>  Yandex tambi√©n tiene su propia biblioteca con componentes: Lego.  Se aplica en ~ 200 servicios.  ¬øQueremos que el uso de Lego en la b√∫squeda cueste lo mismo para Yandex.Health?  Ya sabes la respuesta. </p><br><h3 id="krossplatformennaya-razrabotka">  Desarrollo multiplataforma </h3><br><p>  Para admitir m√∫ltiples plataformas, la mayor√≠a de las veces crean una versi√≥n separada para cada plataforma o una versi√≥n adaptativa. </p><br><p>  El desarrollo de versiones individuales requiere recursos adicionales: cuantas m√°s plataformas, m√°s esfuerzo.  Mantener el estado s√≠ncrono de las propiedades del producto en diferentes versiones causar√° nuevas dificultades. </p><br><p>  El desarrollo de una versi√≥n adaptativa complica el c√≥digo, aumenta el peso, reduce la velocidad del producto con la diferencia adecuada entre las plataformas. </p><br><p>  ¬øQueremos que nuestros padres / amigos / colegas / hijos usen versiones de escritorio en dispositivos m√≥viles con menor velocidad de Internet y menor productividad?  Ya sabes la respuesta. </p><br><h3 id="eksperimenty">  Los experimentos </h3><br><p>  Si est√° desarrollando proyectos para una gran audiencia, debe estar seguro de cada cambio.  Los experimentos A / B son una forma de ganar esa confianza. </p><br><p>  Formas de organizar el c√≥digo para experimentos: </p><br><ul><li>  bifurcaci√≥n del proyecto y la creaci√≥n de instancias de servicio en producci√≥n; </li><li>  condiciones de punto dentro de la base del c√≥digo. </li></ul><br><p>  Si el proyecto tiene muchos experimentos largos, ramificar la base del c√≥digo causa costos significativos.  Es necesario mantener actualizada cada rama con el experimento: errores de puerto corregidos y funcionalidad del producto.  La ramificaci√≥n de la base de c√≥digo complica los experimentos de intersecci√≥n varias veces. </p><br><p>  Las condiciones puntuales funcionan de manera m√°s flexible, pero complican la base del c√≥digo: las condiciones del experimento pueden afectar diferentes partes del proyecto.  Una gran cantidad de condiciones degradan el rendimiento al aumentar la cantidad de c√≥digo para el navegador.  Es necesario eliminar las condiciones, hacer que el c√≥digo sea b√°sico o eliminar completamente el experimento fallido. </p><br><p>  En Search ~ 100 experimentos en l√≠nea en varias combinaciones para diferentes audiencias.  Podr√≠as verlo por ti mismo.  Recuerde, tal vez not√≥ la funcionalidad y una semana despu√©s desapareci√≥ m√°gicamente.  ¬øQueremos probar las teor√≠as de productos a costa de mantener cientos de sucursales de la base de c√≥digo activa de 500,000 l√≠neas, que son cambiadas por ~ 60 desarrolladores diariamente?  Ya sabes la respuesta. </p><br><h3 id="globalnye-izmeneniya">  Cambio global </h3><br><p>  Por ejemplo, puede crear un componente <code>CustomButton</code> heredado de <code>Button</code> de una biblioteca.  Pero el <code>CustomButton</code> heredado no se aplicar√° a todos los componentes de la biblioteca que contiene <code>Button</code> .  Una biblioteca puede tener un componente de <code>Search</code> creado a partir de <code>Input</code> y <code>Button</code> .  En este caso, el <code>CustomButton</code> heredado no aparece dentro del componente de <code>Search</code> .  ¬øQueremos recorrer manualmente toda la base de c√≥digo donde <code>Button</code> usa <code>Button</code> ? </p><br><p><img src="https://habrastorage.org/webt/po/7j/fg/po7jfgnxrawurvtkoi-3ch2wneu.jpeg"></p><br><h2 id="dolgaya-doroga-v-kompoziciyu">  Largo camino a la composici√≥n </h2><br><p>  Decidimos cambiar la estrategia.  En el enfoque anterior, tomaron la tecnolog√≠a Yandex como base y trataron de hacer que React funcionara sobre esta base.  Nuevas t√°cticas sugirieron lo contrario.  As√≠ surgi√≥ el proyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bem-react-core</a> . </p><br><blockquote>  Basta!  ¬øPor qu√© reaccionar en absoluto? </blockquote><p>  Vimos en √©l la oportunidad de deshacernos del renderizado inicial expl√≠cito en HTML y del soporte manual del estado del componente JS m√°s adelante en tiempo de ejecuci√≥n; de hecho, fue posible fusionar plantillas BEMHMTL y componentes JS en una sola tecnolog√≠a. </p><br><h3 id="v100httpsgithubcombembem-reacttreev100">  <a href="">v1.0.0</a> </h3><br><p>  Inicialmente, planeamos transferir todas las mejores pr√°cticas y propiedades <code>bem-xjst</code> a la biblioteca en la parte superior de React.  Lo primero que llama la atenci√≥n es la firma o, si lo prefiere, la sintaxis para describir los componentes. </p><br><p>  <em>¬øQu√© has hecho, hay JSX!</em> </p><br><p>  La primera versi√≥n se cre√≥ sobre la base de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">herencia</a> , una biblioteca que ayuda a implementar clases y herencia.  Como algunos de ustedes recuerdan, en aquellos d√≠as, los prototipos prototipos en JavaScript no ten√≠an clases, no hab√≠a <code>super</code> .  En general, todav√≠a est√°n ausentes, m√°s precisamente, estas no son las clases que primero vienen a la mente.  <code>inherit</code> hizo todo lo que las clases en el est√°ndar ES2015 pueden hacer ahora, y lo que se considera magia negra: herencia m√∫ltiple y fusi√≥n de prototipos en lugar de reconstruir la cadena, lo que afecta positivamente el rendimiento.  No se equivocar√° si cree que parece tener sentido como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hereda en Node.js</a> , pero funcionan de manera diferente. </p><br><p>  A continuaci√≥n se muestra un ejemplo de la sintaxis de las plantillas <code>bem-react-core@v1.0.0</code> . </p><br><p>  <strong>App-Header.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { decl } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> decl({ <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'App'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'Header'</span></span>, <span class="hljs-attr"><span class="hljs-attr">attrs</span></span>: { <span class="hljs-attr"><span class="hljs-attr">role</span></span>: <span class="hljs-string"><span class="hljs-string">'heading'</span></span> }, content() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">' '</span></span>; } });</code> </pre> <br><p>  <strong>App-Header@desktop.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { decl } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> decl({ <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'App'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'Header'</span></span>, <span class="hljs-attr"><span class="hljs-attr">tag</span></span>: <span class="hljs-string"><span class="hljs-string">'h1'</span></span>, attrs() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { ...this.__base(...arguments), <span class="hljs-string"><span class="hljs-string">'aria-level'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, }, content() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">` </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.__base(...</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">arguments</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)}</span></span></span><span class="hljs-string">     h1`</span></span>; } });</code> </pre> <br><p>  <strong>App-Header@touch.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { decl } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> decl({ <span class="hljs-attr"><span class="hljs-attr">block</span></span>: <span class="hljs-string"><span class="hljs-string">'App'</span></span>, <span class="hljs-attr"><span class="hljs-attr">elem</span></span>: <span class="hljs-string"><span class="hljs-string">'Header'</span></span>, <span class="hljs-attr"><span class="hljs-attr">tag</span></span>: <span class="hljs-string"><span class="hljs-string">'h2'</span></span>, content() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">` </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.__base(...</span></span><span class="hljs-built_in"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-built_in">arguments</span></span></span></span><span class="hljs-string"><span class="hljs-subst">)}</span></span></span><span class="hljs-string">  `</span></span>; } });</code> </pre> <br><p>  <strong>index.js</strong> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ReactDomServer <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom/server'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppHeader <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'b:App e:Header'</span></span>; ReactDomServer.renderToStaticMarkup(<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppHeader</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml">);</span></span></code> </pre> <br><p>  <strong>output@desktop.html</strong> </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"App-Header"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">role</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"heading"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aria-level</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span>A       h1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <strong>output@touch.html</strong> </p><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"App-Header"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">role</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"heading"</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h2</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  <em>Las plantillas de dispositivo para componentes m√°s complejos se pueden encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> .</em> </p><br><p>  Dado que una clase es un objeto, y trabajar con objetos en JavaScript es m√°s conveniente, la sintaxis es apropiada.  La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sintaxis</a> luego <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">migr√≥</a> a su mente maestra <code>bem-xjst</code> . </p><br><p>  La biblioteca era un dep√≥sito global de declaraciones de objetos: los resultados de ejecutar la funci√≥n <code>decl</code> , partes de entidades: un bloque, elemento o modificador.  BEM proporciona un mecanismo de nomenclatura √∫nico y, por lo tanto, es adecuado para crear claves en una b√≥veda.  El componente React resultante se peg√≥ en su lugar de uso.  El truco es que el <code>decl</code> funcion√≥ al importar el m√≥dulo.  Esto permiti√≥ indicar qu√© partes del componente se necesitan en cada lugar en particular utilizando una simple lista de importaciones.  Pero recuerde: los componentes son complejos, hay muchas partes, la lista de importaciones es larga, los desarrolladores son flojos. </p><br><h4 id="magiya-importov">  Importar Magia </h4><br><p>  Como puede ver, en los ejemplos de c√≥digo hay l√≠neas que <code>import AppHeader from 'b:App e:Header'</code> . </p><br><p>  <em>¬°Rompiste el est√°ndar!</em>  <em>¬°Es imposible!</em>  <em>¬°Simplemente no funcionar√°!</em> </p><br><p>  En primer lugar, el est√°ndar de importaci√≥n no funciona con t√©rminos en el esp√≠ritu "debe haber una ruta a un m√≥dulo real en la l√≠nea de importaci√≥n".  En segundo lugar, es el az√∫car sint√°ctico que se convirti√≥ con Babel.  En tercer lugar, extra√±as construcciones de puntuaci√≥n de <code>import txt from 'raw-loader!./file.txt';</code> para webpack <code>import txt from 'raw-loader!./file.txt';</code>  por alguna raz√≥n no molestaron a nadie. <br>  Entonces, nuestro bloque se presenta en dos plataformas: <code>desktop</code> , <code>touch</code> . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Hello <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'b:Hello'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     : var Hello = [ require('path/to/desktop/Hello/Hello.js'), require('path/to/touch/Hello/Hello.js') ][0].applyDecls();</span></span></code> </pre> <br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠, el c√≥digo importar√° secuencialmente todas las definiciones de componentes </font></font><code>Hello</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y luego llamar√° a una funci√≥n </font></font><code>applyDecls</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que pega todas las declaraciones de bloque desde el repositorio global </font></font><code>inherit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y crea un nuevo componente React que es √∫nico para un lugar espec√≠fico en el proyecto.</font></font></p><br><p><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> puede </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">encontrar</font></a><font style="vertical-align: inherit;"> un complemento para Babel que realiza esta conversi√≥n </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Y el cargador para webpack, que estaba buscando definiciones de componentes en el sistema de archivos, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√° aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Al final, lo que era bueno: </font></font></p><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> breve sintaxis declarativa de plantillas que le permite redefinir diferentes partes del componente en cualquier parte del proyecto; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sin cadenas prototipo en herencia; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Componente de reacci√≥n √∫nico para cada lugar de uso. </font></font></li></ul><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Y eso fue malo: </font></font></p><br><ul><li>   TypeScript/Flow; </li><li>    React- ; </li><li> -         ; </li><li>      . </li></ul><br><h3 id="v200httpsgithubcombembem-reacttreev200"> <a href="">v2.0.0</a> </h3><br><p>     <code>bem-react-core@v1.0.0</code>  ,       . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Elem } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Button } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../Button'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppHeader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Elem</span></span></span><span class="hljs-class"> </span></span>{ block = <span class="hljs-string"><span class="hljs-string">'App'</span></span>; elem = <span class="hljs-string"><span class="hljs-string">'Header'</span></span>; tag() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'h2'</span></span>; } content() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); } }</code> </pre> <br><p>     ,     .    ,   ,      TypeScript/Flow.   ,     <code>inherit</code>  ¬´¬ª ,     ,            . </p><br><p>   : <br> ‚Äî         webpack    Babel; <br> ‚Äî      ; <br> ‚Äî       ,    . </p><br><p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">HOC</a> ,             . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> ReactDOM <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Block, Elem, withMods } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bem-react-core'</span></span>; interface IButtonProps { <span class="hljs-attr"><span class="hljs-attr">children</span></span>: string; } interface IModsProps extends IButtonProps { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">'link'</span></span> | <span class="hljs-string"><span class="hljs-string">'button'</span></span>; } <span class="hljs-comment"><span class="hljs-comment">//   Text class Text extends Elem { block = 'Button'; elem = 'Text'; tag() { return 'span'; } } //   Button class Button&lt;T extends IModsProps&gt; extends Block&lt;T&gt; { block = 'Button'; tag() { return 'button'; } mods() { return { type: this.props.type }; } content() { return ( &lt;Text&gt;{this.props.children}&lt;/Text&gt; ); } } //    Button,    type   link class ButtonLink extends Button&lt;IModsProps&gt; { static mod = ({ type }: any) =&gt; type === 'link'; tag() { return 'a'; } mods() { return { type: this.props.type }; } attrs() { return { href: 'www.yandex.ru' }; } } //   Button  ButtonLink const ButtonView = withMods(Button, ButtonLink); ReactDOM.render( &lt;React.Fragment&gt; &lt;ButtonView type='button'&gt;Click me&lt;/ButtonView&gt; &lt;ButtonView type='link'&gt;Click me&lt;/ButtonView&gt; &lt;/React.Fragment&gt;, document.getElementById('root') );</span></span></code> </pre> <br><p>              ,     . </p><br><p> <code>withMods</code>       ,   (),      .   ,     , withMods        ,      .      .       , ,     ,   ( )   .               .       ,   ,    ‚Äî    ,    . </p><br><p> ,   : </p><br><ul><li>    . ,        .   ,    TS.        ,      .    ES5 TS   super   ,         . , TS     ,    . </li><li>    . TS  ES6  Babel  ES5.      ,    npm-    .  ,          Babel. </li></ul><br><p>  : </p><br><ul><li>       ,   . ,     . :    DOM-.     HOC,      .   withMods       . </li><li>   (, , )       .             <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SFC</a> . </li><li>  CSS-.  CSS-   JS-     .      ,   ,          . </li></ul><br><p>      v2. </p><br><h2 id="manifest">  </h2><br><p> ,    .   .  ,    ,      1  2.      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> . </p><br><p>   ‚Äî    .   CSS-     HOC,        ‚Äî  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dependency injection</a> . </p><br><p>       React: </p><br><ul><li>   CSS-. </li><li>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> (, ); </li></ul><br><p>         .         .        <code>React.ComponentType</code>     -.         HOC     compose    . </p><br><p>             . </p><br><p>        dependency injection,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><code>React.ContextAPI</code></a>    .             ,        ,        .        ,      .   DI ‚Äî  HOC,     .         .     ,  ,         . </p><br><p> ,    ,         .   ,      ,    4 ,    <code>1.5Kb</code> . </p><br><p>     .  Gracias a quienes leyeron hasta el final.     ,     React  . . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/438598/">https://habr.com/ru/post/438598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../438588/index.html">Widget personalizado de googleTranslate para el sitio</a></li>
<li><a href="../438590/index.html">Trueno en el para√≠so o por qu√© no debes usar FlylinkDC ++</a></li>
<li><a href="../438592/index.html">Qu√© buscar al elegir un lector: estamos hablando del factor de forma y visualizaci√≥n</a></li>
<li><a href="../438594/index.html">Lugar de trabajo y 4k @ 60Hz</a></li>
<li><a href="../438596/index.html">Guardar datos del usuario despu√©s de recargar la p√°gina</a></li>
<li><a href="../438600/index.html">SciPy, entrada y salida en MATLAB</a></li>
<li><a href="../438602/index.html">Desmontamos el protocolo de mensajes de buscapersonas POCSAG, parte 1</a></li>
<li><a href="../438604/index.html">Bitrix en un mont√≥n de Nginx + PHP-FPM, configurando el CNC, as√≠ como un cach√© compuesto con comentarios a trav√©s de nginx. Configuraci√≥n modificada</a></li>
<li><a href="../438606/index.html">Agradable degradaci√≥n. Informe Yandex.Taxi</a></li>
<li><a href="../438610/index.html">Plantillas Responsive Figma: creaci√≥n de un componente de dise√±o flexible para iOS Mobile Navigation</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>