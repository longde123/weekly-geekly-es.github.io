<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏽‍🔬 🚈 🦃 Marionnettiste avec ES6 dans un nœud et un navigateur, ou pourquoi Zora est le meilleur framework de test dans sa niche 🏡 🤒 🙋🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tout va bien tant que vous devez exécuter des sources JS à travers les mannequins pour créer un bundle, mais l'enfer commence lorsque vous voulez écri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Marionnettiste avec ES6 dans un nœud et un navigateur, ou pourquoi Zora est le meilleur framework de test dans sa niche</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466551/"><p>  Tout va bien tant que vous devez exécuter des sources JS à travers les mannequins pour créer un bundle, mais l'enfer commence lorsque vous voulez écrire des tests pour votre site ou votre bibliothèque.  Le problème est que tous les frameworks de test utilisent des fonctions spécifiques d'un nœud et / ou sont écrits en ES5.  Ainsi, le lancement de tests E2E n'est pas une tâche triviale et propose de danser avec un tambourin de transpilations et de sourcemaps pour couvrir le code.  Vous ne voulez pas que les erreurs pointent au mauvais endroit? </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-b/ap/4s/-bap4sw3txogxdeww4tsomrzffw.png"></div><br><p>  Dans cet article, je décrirai mon expérience d'utilisation de Puppeteer pour une petite tâche, <br>  et comment j'ai lancé les modules ES6 dans le nœud et le navigateur, n'ayant qu'une seule source pour les tests sans collecteurs. </p><a name="habracut"></a><br><p> Pourquoi Marionnettiste du tout, demandez-vous, pourquoi pas WebDriver?  Je viens de remarquer comment les créateurs des bibliothèques WebGL open source populaires sont tourmentés, par exemple, ils ont 300 pages avec des exemples, chacun pouvant rompre avec n'importe quel commit.  Ils les vérifient après chaque changement, et s'ils ont oublié d'ouvrir quelque chose - désolé <code>¯\_(ツ)_/¯</code> , cela s'est cassé.  Si personne n'a encore résolu ce problème, j'ai décidé de l'essayer dans ma petite bibliothèque.  La première pensée qui a été de lancer un glu sans tête, mais elle est obsolète.  Node-gles prend déjà en charge WebGL2, mais pas l'extension rare que j'ai utilisée.  WebDriver?  Je ne l'ai même pas essayé.  Je ne sais pas si c'est possible, je n'avais pas besoin de python / C # / Java, mais j'avais besoin de JS / TS avec le dernier nœud et la dernière API de navigateur, donc les fonctionnalités de vol peuvent provenir des dernières spécifications. </p><br><p>  Pourquoi les modules ES6?  La prise en charge de WebGL et ES6 dans les navigateurs est à peu près la même.  Et avec des modules groupés ou non, laissez l'utilisateur décider, vous pouvez simplement collecter les deux versions.  Mais il s'avère que pour les tests unitaires, il est très pratique d'utiliser la version avec les modules, car les sourcemaps sont extraits très simplement, et après cela, vous pouvez exécuter les tests sans aucun geste supplémentaire dans le nœud ou dans le navigateur.  En les exécutant en marionnettiste, E2E avec une couverture de code est presque gratuit.  Un script avec une cible dans ES6 était probablement nécessaire, mais sur un petit projet couvert de tests, le js normal fonctionnera également. </p><br><p>  Donc, assez d'introductions, j'ai mis <code>puppeteer</code> et <code>puppeteer-to-istanbul</code> dans le projet et écrit un tel wrapper </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// puppeteer.js import puppeteer from 'puppeteer'; import pup2ist from 'puppeteer-to-istanbul'; (async () =&gt; { const browser = await puppeteer.launch({ headless: process.env.HEADLESS, // headless customization slowMo: 250 // good fature for new configs }); const page = (await browser.pages())[0]; // enable coverage await page.coverage.startJSCoverage(); await page.coverage.startCSSCoverage(); // some additional code with console events here... // navigate to unit test page await page.goto('http://127.0.0.1:1234/'); // disable coverage const jsCoverage = await page.coverage.stopJSCoverage(); const cssCoverage = await page.coverage.stopCSSCoverage(); pup2ist.write([...jsCoverage, ...cssCoverage]) await new Promise(resolve =&gt; setTimeout(resolve, 6000)); await browser.close(); })();</span></span></code> </pre> <br><p>  Qui peut être exécuté avec le <code>node --experimental-modules --no-warnings ./test/puppeteer.js</code> commande <code>node --experimental-modules --no-warnings ./test/puppeteer.js</code> avec un noeud 11+, ou même sans drapeaux sur le noeud 13.2+.  Bien sûr, vous pouvez utiliser <code>require</code> , alors ... Mais pourquoi?  Il s'agit généralement d'un backend, ici le support client n'est même pas nécessaire!  Le code suivant de <code>package.json</code> nous permet de personnaliser les téléchargements HEADLESS dans la console et dans le cloud CI si des paramètres différents sont requis pour eux.  Dans travs / circle-ci, linux sera probablement installé et vous pouvez y définir des variables d'environnement dans ce format.  ouvre <code>concurrently</code> deux processus dans une console en parallèle. </p><br><pre> <code class="json hljs">// package.json { //bla-bla... <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"module"</span></span>, // this line indicates that we are using es6 modules <span class="hljs-attr"><span class="hljs-attr">"scripts"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"test"</span></span>: <span class="hljs-string"><span class="hljs-string">"node --experimental-modules --no-warnings ./test/puppeteer.js"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"server"</span></span>: <span class="hljs-string"><span class="hljs-string">"http-server -c-1 -p 1234"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"not-bad-cmd--dude"</span></span>: <span class="hljs-string"><span class="hljs-string">"concurrently -k -s first \"npm:test\" \"npm:server\""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ci"</span></span>: <span class="hljs-string"><span class="hljs-string">"HEADLESS=true concurrently -k -s first \"npm:test\" \"npm:server\""</span></span>, } }</code> </pre> <br><p>  Sur la machine locale, après avoir entré la commande <code>npm run server</code> , le <code>npm run server</code> http démarre, et sur <code>npm run test</code> marionnettiste dans une fenêtre distincte, la fenêtre chrome.  C'est tout ce que vous devez savoir sur le marionnettiste.  Vous trouverez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ici d'</a> autres exemples de captures d'écran, d'émulations d'appareils, de zones d'administration, etc.  Soit dit en passant, avec le package <code>node_modules</code> , vous avez installé un chrome séparé dans <code>node_modules</code> , si vous n'en avez pas besoin, remplacez-le par <code>puppeteer-core</code> ou <code>puppeteer-firefox</code> .  Il convient de noter que dans l'exemple ci-dessus, nous avons obtenu une couverture de code JS / CSS gratuite qui est écrite dans le dossier .nyc_output, jusqu'à ce que nous nous concentrions sur cela, à ce stade, nous n'avons pas froid ce n'est pas chaud, mais s'il y a quelque chose, c'est là et des statistiques La couverture du test est presque prête à être consultée. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7p/1a/ub/7p1aubzvuejnelkrcqktlhwvwci.png"></div><br><p>  Passons maintenant aux tests eux-mêmes, essayant de choisir où je vais exécuter E2E dans ma petite bibliothèque, je suis tombé sur les graphiques suivants, qui comparaient les performances des frameworks pour les tests.  Probablement, le temps d'exécution n'est pas si important, mais lorsque certains Jest les démarrent 10 fois plus lentement, la question «qu'est-ce que c'est et pourquoi est-elle nécessaire» se pose.  Le critère de sélection principal était l'exécution d'es6 avec la ligne <code>&lt;script type="module" src="./test.js"&gt;&lt;/script&gt;</code> dans la page html.  Puisqu'au moment d'écrire mon code, le nœud ne supportait pas encore entièrement ES6 (hier, il a été publié 12.3 dans lequel les drapeaux ont été supprimés).  J'ai décidé que si vous prenez le cadre avec les sources sur TS ou ES6 +, il devrait définitivement commencer.  En général, vous pouvez probablement prendre une sorte de moka, le déclarer plus haut sur la page et faire référence à la classe déclarée, mais que se passe-t-il si une erreur se produit?  En général, vous pouvez nommer votre test de coureur préféré ici.  Je dirai simplement que Zora prend en charge le format TAP, ce qui signifie que tout un zoo de mangeurs de TAP convient.  Il a la plupart des assertions, il prend en charge async, c'est l'une des plus rapides, écrite en pur ES6 sans dépendances sur le nœud lui-même.  Cela me semblait un vrai diamant pour les petits projets. </p><br><p>  En conséquence, j'ai obtenu des tests qui fonctionnent à la fois dans le navigateur et dans le nœud.  La <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">documentation de</a> Zora contient des instructions complètes sur les assertions et les regroupements de commandes. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// test.js import MyLibrary from '../dist/my-library.module.js'; import { test } from 'https://cdn.jsdelivr.net/npm/zora@3.0.3/dist/bundle/module.js'; test('CPU', async (t) =&gt; { // some stuff here t.ok(tfps != null, 'fps = ' + (tfps != null ? tfps.toFixed(1) : 'null')); t.ok(tcpu != null, 'cpu = ' + (tcpu != null ? tcpu.toFixed(1) : 'null')); }); test('Memory', async (t) =&gt; { // some stuff here t.ok(tmem != null, 'mem = ' + (tmem != null ? tmem.toFixed(1) : 'null')); }); // etc...</span></span></code> </pre> <br><p>  Afin de montrer la console sans assemblages, j'ai dû faire un renifleur similaire.  La console nue n'est pas très présentable, il serait possible de connecter la sortie TAP quelque part pour guider le marathon.  Mais le plus drôle, c'est que les résultats des tests sur votre client peuvent être consultés en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">ligne</a> .  En outre, exactement le même code s'exécute dans CI sur n'importe quel commit. </p><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"en"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- some declarations in head --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- some declarations in body --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">const</span></span></span><span class="javascript"> addSniffer = </span><span class="hljs-function"><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">spyTarget</span></span></span></span><span class="javascript"><span class="hljs-function">) =&gt;</span></span></span><span class="javascript"> </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ spyTarget.apply(</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.console, </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">arguments</span></span></span><span class="javascript">); sniffer([...arguments]); } </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.console.log = addSniffer(</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.console.log); </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.console.error = addSniffer(</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.console.error); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">let</span></span></span><span class="javascript"> screen = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'screen'</span></span></span><span class="javascript">); </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function"> </span></span><span class="hljs-title"><span class="javascript"><span class="hljs-function"><span class="hljs-title">sniffer</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">string</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">let</span></span></span><span class="javascript"> screen = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.getElementById(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"screen"</span></span></span><span class="javascript">); string.forEach(</span><span class="hljs-function"><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">line</span></span></span></span><span class="javascript"><span class="hljs-function"> =&gt;</span></span></span><span class="javascript"> { </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">let</span></span></span><span class="javascript"> div = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.createElement(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"div"</span></span></span><span class="javascript">); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">let</span></span></span><span class="javascript"> text = </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">.createTextNode(line); div.appendChild(text) screen.appendChild(div); }); } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"module"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./test.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Mais ce n'est pas tout, avec des tests prêts à l'emploi, vous pouvez connecter des bots tels que renovate / greenkeeper / dependabot, qui mettraient à jour les dépendances dans votre bibliothèque et effectueraient des validations automatiques, après avoir vérifié l'exactitude des mises à jour.  Et travis / github-ci / circle-ci aurait téléchargé une nouvelle version des packages npm. </p><br><p>  Par exemple, une telle configuration de renovate effectue des validations automatiques le dimanche et augmente la version </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"automerge"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"automergeType"</span></span>: <span class="hljs-string"><span class="hljs-string">"branch"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bumpVersion"</span></span>: <span class="hljs-string"><span class="hljs-string">"patch"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"schedule"</span></span>: [<span class="hljs-string"><span class="hljs-string">"on sunday"</span></span>], <span class="hljs-attr"><span class="hljs-attr">"ignorePaths"</span></span>: [<span class="hljs-string"><span class="hljs-string">".circleci"</span></span>] }</code> </pre> <br><p>  Et travis, lorsque vous avez vous-même augmenté la version ou un bot, peut automatiquement télécharger le package vers npm.  Pour ce faire, créez un compte sur <code>travis-ci.org</code> , activez f2a comme décrit dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">cet article</a> , entrez deux clés secrètes <code>$NPM_EMAIL</code> et <code>$NPM_TOKEN</code> et créez une configuration similaire. </p><br><pre> <code class="plaintext hljs">language: node_js node_js: '12' script: - npm run ci deploy: provider: npm edge: true email: $NPM_EMAIL api_key: $NPM_TOKEN on: branch: master</code> </pre> <br><p>  Au total, c'est en quelque sorte possible, mais il est difficile de se débarrasser des notifications du github qu'une vulnérabilité est apparue dans une sorte de dépendance: D </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr466551/">https://habr.com/ru/post/fr466551/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr466539/index.html">Utilisation de modules JavaScript en production: situation actuelle. 2e partie</a></li>
<li><a href="../fr466541/index.html">Utilisation de DbTool pour amorcer des bases de données dans des applications .NET (Core)</a></li>
<li><a href="../fr466543/index.html">Les prêts Habr Weekly # 17 / Sberbank seront approuvés par AI - effrayant, publicité dans les produits open source - douteux</a></li>
<li><a href="../fr466547/index.html">Bonne fête du programmeur</a></li>
<li><a href="../fr466549/index.html">Principes généraux de fonctionnement de QEMU-KVM</a></li>
<li><a href="../fr466553/index.html">6 leçons tirées de la recherche d'une solution à un problème majeur sur gitlab.com. 2e partie</a></li>
<li><a href="../fr466555/index.html">6 leçons tirées de la recherche d'une solution à un problème majeur sur gitlab.com. Partie 1</a></li>
<li><a href="../fr466557/index.html">Comment créer une mise en page pour le site et ne pas rester extrême</a></li>
<li><a href="../fr466559/index.html">Soit le nouveau Var</a></li>
<li><a href="../fr466561/index.html">Besoin de choix absolument transparents? - Je les ai</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>