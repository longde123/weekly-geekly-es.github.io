<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜí ü§≥üèø üë®üèª‚Äçüè´ Der Tag, an dem ich mich in Fuzzing verliebt habe üèè üí∞ üìì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="2007 habe ich einige Modding- Tools f√ºr den Freelancer Space Simulator geschrieben. Spielressourcen werden im Format "Binary INI" oder "BINI" gespeich...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Der Tag, an dem ich mich in Fuzzing verliebt habe</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438662/"> 2007 habe ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einige</a> Modding- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tools</a> f√ºr den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Freelancer</a> Space Simulator geschrieben.  Spielressourcen werden im Format "Binary INI" oder "BINI" gespeichert.  Wahrscheinlich wurde das Bin√§rformat aus Gr√ºnden der Leistung gew√§hlt: Solche Dateien lassen sich schneller laden und lesen als beliebiger Text im INI-Format. <br><br>  Die meisten Spielinhalte k√∂nnen direkt aus diesen Dateien heraus bearbeitet werden, indem Namen, Produktpreise, Raumfahrzeugstatistiken ge√§ndert oder sogar neue Schiffe hinzugef√ºgt werden.  Bin√§rdateien lassen sich nur schwer direkt √§ndern. Daher besteht der nat√ºrliche Ansatz darin, sie in Text-INI zu konvertieren, √Ñnderungen in einem Texteditor vorzunehmen, dann wieder in das BINI-Format zu konvertieren und die Dateien im Spielverzeichnis zu ersetzen. <br><a name="habracut"></a><br>  Ich habe das BINI-Format nicht analysiert und bin nicht der erste, der lernt, wie man sie bearbeitet.  Aber die vorhandenen Tools gefielen mir nicht und ich hatte meine eigene Vision, wie sie funktionieren sollten.  Ich bevorzuge eine Unix-Oberfl√§che, obwohl das Spiel selbst unter Windows l√§uft. <br><br>  Zu dieser Zeit habe ich gerade die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yacc-</a> Tools (eigentlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bison</a> ) und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Lex</a> (eigentlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Flex</a> ) sowie Autoconf kennengelernt, also habe ich sie genau verwendet.  Es war interessant, diese Dienstprogramme in der Praxis auszuprobieren, obwohl ich andere Open-Source-Projekte sklavisch imitierte und nicht verstand, warum alles so gemacht wurde, auf keine andere Weise.  Aufgrund der Verwendung von yacc / lex und der Erstellung von Konfigurationsskripten war ein vollst√§ndiges Unix-√§hnliches System erforderlich.  Dies ist alles in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalversion der Programme</a> sichtbar. <br><br>  Das Projekt erwies sich als recht erfolgreich: Ich selbst habe diese Tools erfolgreich eingesetzt und sie wurden in verschiedenen Sammlungen f√ºr Freelancer-Modding ver√∂ffentlicht. <br><br><h1>  Refactoring </h1><br>  Mitte 2018 kehrte ich zu diesem Projekt zur√ºck.  Haben Sie sich jemals Ihren alten Code mit dem Gedanken angesehen: Was haben Sie √ºberhaupt gedacht?  Mein INI-Format erwies sich als viel starrer und strenger als n√∂tig, die Bin√§rdatei wurde auf zweifelhafte Weise aufgezeichnet, und die Assembly funktionierte nicht einmal normal. <br><br>  Dank zehn Jahren zus√§tzlicher Erfahrung wusste ich mit Sicherheit, dass ich diese Tools jetzt viel besser schreiben w√ºrde.  Und ich habe es in ein paar Tagen geschafft und sie von Grund auf neu geschrieben.  Dieser neue Code befindet sich jetzt im Master-Thread von Github. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ich mag es, alles so einfach wie m√∂glich zu machen</a> , deshalb habe ich Autoconf zugunsten eines <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einfacheren und tragbareren Makefiles</a> losgeworden.  Kein Yacc oder Lex mehr, aber der Parser wird von Hand geschrieben.  Es wird nur das entsprechende tragbare C verwendet. Das Ergebnis ist so einfach, dass ich das Projekt mit einem kurzen Befehl <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aus Visual Studio zusammenstelle</a> , sodass das Makefile nicht wirklich ben√∂tigt wird.  Wenn Sie <code>stdint.h</code> durch <code>typedef</code> ersetzen, k√∂nnen Sie sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Binitools unter DOS erstellen und ausf√ºhren</a> . <br><br>  Die neue Version ist schneller, kompakter, sauberer und einfacher.  Es ist viel flexibler in Bezug auf INI-Eingaben, so dass es einfacher zu verwenden ist.  Aber ist es wirklich richtig? <br><br><h1>  Fuzzing </h1><br>  Ich habe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mich seit</a> vielen Jahren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">f√ºr Fuzzing</a> interessiert, besonders <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">f√ºr Afl</a> (American Fuzzy Lop).  Aber er hat es nie gemeistert, obwohl er einige der Werkzeuge getestet hat, die ich regelm√§√üig benutze.  Aber Fuzzing fand nichts Bemerkenswertes, zumindest bevor ich aufgab.  Ich habe meine JSON-Bibliothek getestet und aus irgendeinem Grund auch nichts gefunden.  Es ist klar, dass mein JSON-Parser nicht <i>so</i> zuverl√§ssig sein kann, oder?  Aber Fuzzing zeigte nichts.  (Wie sich herausstellte, ist meine JSON-Bibliothek ziemlich zuverl√§ssig, was zum gro√üen Teil den Bem√ºhungen der Community zu verdanken ist!) <br><br>  Aber jetzt habe ich einen relativ neuen INI-Parser.  Obwohl es den urspr√ºnglichen Satz von BINI-Dateien im Spiel erfolgreich analysieren und korrekt zusammenstellen kann, wurde seine Funktionalit√§t nicht <i>wirklich</i> getestet.  Sicherlich wird hier das Fuzzing etwas finden.  Au√üerdem m√ºssen Sie keine einzige Zeile schreiben, um diesen Code auszuf√ºhren.  Die Standardwerkzeuge arbeiten mit Standardeingaben, was ideal ist. <br><br>  Angenommen, Sie haben die erforderlichen Tools installiert (make, gcc, afl), so beginnt das Fuzzing von Binitools wie folgt: <br><br><pre> <code class="bash hljs">$ make CC=afl-gcc $ mkdir <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> out $ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'[x]'</span></span> &gt; <span class="hljs-keyword"><span class="hljs-keyword">in</span></span>/empty $ afl-fuzz -i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> -o out -- ./bini</code> </pre> <br>  Das Dienstprogramm <code>bini</code> akzeptiert INI am Eingang und gibt BINI aus. Daher ist es viel interessanter, es zu √ºberpr√ºfen als das umgekehrte <code>unbini</code> Verfahren.  Da <code>unbini</code> relativ einfache Bin√§rdaten analysiert, hat der (wahrscheinlich) Fuzzer nichts zu suchen.  F√ºr alle F√§lle habe ich es trotzdem √ºberpr√ºft. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/483/089/6dc/4830896dc68da2e5559c899429235f95.png"><br><br>  In diesem Beispiel habe ich den Standard-Compiler f√ºr afl in die GCC-Shell ge√§ndert ( <code>CC=afl-gcc</code> ).  Hier ruft afl GCC im Hintergrund auf, f√ºgt der Bin√§rdatei jedoch ein eigenes Toolkit hinzu.  Beim Fuzzing verwendet <code>afl-fuzz</code> dieses Toolkit, um den Ausf√ºhrungspfad eines Programms zu √ºberwachen.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">In der afl-Dokumentation werden</a> die technischen Details erl√§utert. <br><br>  Ich habe auch die Eingabe- und Ausgabeverzeichnisse erstellt, indem ich in das Eingabeverzeichnis ein minimales Arbeitsbeispiel eingef√ºgt habe, das afl einen Ausgangspunkt gibt.  Wenn es gestartet wird, mutiert es die Eingabedatenwarteschlange und sucht w√§hrend der Programmausf√ºhrung nach √Ñnderungen.  Das Ausgabeverzeichnis enth√§lt die Ergebnisse und vor allem die Eingabedaten, die eindeutige Ausf√ºhrungspfade verursachen.  Mit anderen Worten, viele Eingaben werden am Fuzzer-Ausgang verarbeitet, wodurch viele verschiedene Grenzszenarien √ºberpr√ºft werden. <br><br>  Das interessanteste und be√§ngstigendste Ergebnis ist ein vollst√§ndiger Programmabsturz.  Als ich den Fuzzer f√ºr Binitools zum ersten Mal startete, zeigte <code>bini</code> <i>viele</i> solcher Abst√ºrze.  Innerhalb weniger Minuten entdeckte afl eine Reihe subtiler und interessanter Fehler in meinem Programm, die unglaublich n√ºtzlich waren.  Fazzer fand sogar einen unwahrscheinlichen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fehler eines veralteten Zeigers</a> und √ºberpr√ºfte die unterschiedliche Reihenfolge der verschiedenen Speicherzuordnungen.  Dieser besondere Fehler war ein Wendepunkt, an dem ich den Wert des Fuzzing erkannte. <br><br>  Nicht alle gefundenen Fehler f√ºhrten zu Fehlern.  Ich habe auch die Ausgabe untersucht und untersucht, welche Eingabe zu einem erfolgreichen Ergebnis f√ºhrte und welche nicht, und habe beobachtet, wie das Programm mit verschiedenen Extremf√§llen umging.  Sie lehnte einige Eingaben ab, von denen ich dachte, dass sie sie verarbeiten w√ºrden.  Und umgekehrt verarbeitete sie einige Daten, die ich f√ºr falsch hielt, und interpretierte einige Daten auf unerwartete Weise f√ºr mich.  Selbst nachdem ich Fehler mit Programmabst√ºrzen behoben hatte, √§nderte ich die Parser-Einstellungen, um jeden dieser unangenehmen F√§lle zu beheben. <br><br><h1>  Erstellen Sie eine Testsuite </h1><br>  Sobald ich alle vom Fuzzer erkannten Fehler behoben und den Parser in allen Grenzsituationen angepasst hatte, f√ºhrte ich eine Reihe von Tests aus dem Fuzzer-Datenpaket durch - allerdings nicht direkt. <br><br>  Zuerst habe ich den Fuzzer parallel ausgef√ºhrt - dieser Vorgang wird in der afl-Dokumentation erl√§utert -, sodass ich viele redundante Eingaben erhalten habe.  Mit Redundanz meine ich, dass die Eingabe unterschiedlich ist, aber denselben Ausf√ºhrungspfad hat.  Gl√ºcklicherweise hat afl ein Werkzeug, um damit umzugehen: <code>afl-cmin</code> , ein Werkzeug, um die Shell zu minimieren.  Es werden unn√∂tige Eingaben vermieden. <br><br>  Zweitens waren viele dieser Eingaben l√§nger als erforderlich, um ihren eindeutigen Ausf√ºhrungspfad aufzurufen.  <code>afl-tmin</code> , ein Testfall-Minimierer, der den Testfall reduzierte. <br><br>  Ich habe g√ºltige und ung√ºltige Eingaben getrennt - und im Repository √ºberpr√ºft.  Schauen Sie sich all diese dummen Eing√§nge <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">an, die der Fuzzer</a> anhand einer einzigen minimalen Eingabe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erfunden hat</a> : <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">g√ºltige Eingabe</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ung√ºltige Eingabe</a> </li></ul><br>  Tats√§chlich wird hier der Parser in einem Zustand eingefroren, und eine Reihe von Tests stellt sicher, dass sich ein bestimmter Build auf eine <i>ganz</i> bestimmte Art und Weise verh√§lt.  Dies ist besonders n√ºtzlich, um sicherzustellen, dass Assemblys, die von anderen Compilern auf anderen Plattformen erstellt wurden, sich in Bezug auf ihre Ausgabe gleich verhalten.  Meine Testsuite hat sogar einen Fehler in der Dietlibc-Bibliothek festgestellt, da binitools die Tests nach dem Verkn√ºpfen nicht bestanden hat.  Wenn es notwendig w√§re, nicht triviale √Ñnderungen am Parser vorzunehmen, m√ºsste man im Wesentlichen die aktuellen Tests aufgeben und von vorne beginnen, damit afl einen ganz neuen K√∂rper f√ºr den neuen Parser generiert. <br><br>  Nat√ºrlich hat sich das Fuzzing als leistungsstarke Technik etabliert.  Er fand eine Reihe von Fehlern, die ich allein niemals h√§tte entdecken k√∂nnen.  Seitdem begann ich, es kompetenter zu nutzen, um andere Programme zu testen - nicht nur meine - und fand viele neue Fehler.  Jetzt hat Fuzzer einen festen Platz unter den Werkzeugen in meinem Entwicklungskit eingenommen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de438662/">https://habr.com/ru/post/de438662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de438648/index.html">Vergleich von BI-Systemen (Tableau, Power BI, Oracle, Qlik)</a></li>
<li><a href="../de438650/index.html">Rakete 9M729. Ein paar Worte zum ‚ÄûVersto√ü‚Äú gegen den INF-Vertrag</a></li>
<li><a href="../de438652/index.html">Portabelization IDA</a></li>
<li><a href="../de438654/index.html">OpenSceneGraph: Integration mit dem Qt Framework</a></li>
<li><a href="../de438658/index.html">Wie man lernt zu lernen</a></li>
<li><a href="../de438664/index.html">Schnelles Compiler-Ger√§t. Teil 2</a></li>
<li><a href="../de438666/index.html">Manager gegen Programmierer</a></li>
<li><a href="../de438668/index.html">‚ÄûSuchen Sie nach Geschichten, die vorantreiben‚Äú: Ein Podcast √ºber Podcasts, redaktionelle Arbeiten und Medienkarrieren</a></li>
<li><a href="../de438670/index.html">Angreifer verwenden YouTube-Urheberrechtsstreiks, um Geld von Autoren zu erpressen</a></li>
<li><a href="../de438672/index.html">UTF-8-Codierung in Wi-Fi-Namen und -Kennw√∂rtern (Emoji)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>