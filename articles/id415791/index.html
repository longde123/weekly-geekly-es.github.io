<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¼ ğŸ˜Š ğŸ’› Optimalisasi kontrak pintar. Bagaimana Jenis Soliditas Mempengaruhi Biaya Transaksi ğŸš“ ğŸ‘¨ğŸ½â€âš•ï¸ ğŸ‘†ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="â€œProgrammer menghabiskan banyak waktu untuk mengkhawatirkan kecepatan program mereka, dan upaya untuk mencapai efisiensi sering kali memiliki dampak n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Optimalisasi kontrak pintar. Bagaimana Jenis Soliditas Mempengaruhi Biaya Transaksi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415791/"><blockquote> <i>â€œProgrammer menghabiskan banyak waktu untuk mengkhawatirkan kecepatan program mereka, dan upaya untuk mencapai efisiensi sering kali memiliki dampak negatif yang dramatis pada kemampuan debug dan mendukung mereka.</i>  <i>Penting untuk melupakan optimasi kecil, katakanlah, pada 97% kasus.</i>  <i>Optimalisasi prematur adalah akar dari semua kejahatan!</i>  <i>Tapi kita tidak boleh kehilangan 3% dari mereka yang benar-benar penting! â€</i> <br>  <b>Donald Knut.</b> <br></blockquote><img src="https://habrastorage.org/webt/dw/wh/fv/dwwhfvvtvsgi2ilhvtjscuk8xyc.png" alt="Gas Ethereum"><br><br>  Saat melakukan audit kontrak pintar, kadang-kadang kita bertanya pada diri sendiri apakah pengembangannya terkait dengan 97% di mana tidak perlu memikirkan optimasi atau kita hanya berurusan dengan 3% dari kasus di mana itu penting.  Menurut pendapat kami, lebih mungkin yang kedua.  Tidak seperti aplikasi lain, kontrak pintar tidak diperbarui, mereka tidak dapat dioptimalkan "saat bepergian" (asalkan algoritma mereka tidak diletakkan, tetapi ini adalah topik yang terpisah).  Argumen kedua yang mendukung optimalisasi kontrak <i>awal</i> adalah bahwa, tidak seperti kebanyakan sistem di mana sub-optimalitas hanya diwujudkan dalam skala, terkait dengan spesifikasi besi dan lingkungan, itu diukur dengan sejumlah besar metrik, kontrak pintar pada dasarnya memiliki satu-satunya metrik kinerja - konsumsi gas. <br><br>  Oleh karena itu, secara teknis lebih mudah untuk mengevaluasi efektivitas kontrak, tetapi pengembang sering terus mengandalkan intuisi mereka dan melakukan "optimasi prematur" buta yang sama yang dibicarakan oleh Profesor Knut.  Kami akan memeriksa seberapa intuitif solusi sesuai dengan kenyataan dengan contoh pemilihan kedalaman bit suatu variabel.  Dalam contoh ini, seperti dalam kebanyakan kasus praktis, kami tidak akan mencapai penghematan, dan bahkan sebaliknya, kontrak kami akan menjadi lebih mahal dalam hal konsumsi gas. <br><a name="habracut"></a><br><h2>  Gas jenis apa? </h2><br>  Ethereum seperti komputer global, yang "prosesornya" adalah mesin virtual EVM, "kode program" adalah serangkaian perintah dan data yang dicatat dalam kontrak pintar, dan panggilan adalah transaksi dari dunia luar.  Transaksi dikemas dalam struktur terkait - blok yang terjadi setiap beberapa detik sekali.  Dan karena ukuran blok secara definisi terbatas, dan protokol pemrosesan bersifat deterministik (memerlukan pemrosesan yang seragam dari semua transaksi dalam blok oleh semua node jaringan), maka untuk memenuhi permintaan yang berpotensi tidak terbatas dengan sumber daya node yang terbatas dan melindungi terhadap DoS, sistem harus menyediakan algoritma yang adil untuk memilih permintaan yang akan dilayani, dan yang diabaikan, sebagai mekanisme di banyak blockchain publik, ada prinsip sederhana - pengirim dapat memilih jumlah remunerasi kepada penambang untuk melakukan trans  ktsii dan memilih penambang yang kebutuhannya termasuk blok, dan yang tidak, memilih yang paling menguntungkan untuk diri mereka sendiri. <br><br>  Misalnya, dalam Bitcoin, di mana blok dibatasi hingga satu megabyte, penambang memilih untuk memasukkan transaksi dalam blok atau tidak berdasarkan panjang dan komisi yang diusulkan (memilih orang-orang dengan rasio satoshi maksimum per byte). <br><br>  Untuk protokol Ethereum yang lebih kompleks, pendekatan ini tidak cocok, karena satu byte dapat mewakili tidak adanya operasi (misalnya, kode STOP) dan operasi penulisan yang mahal dan lambat ke penyimpanan (SSTORE).  Oleh karena itu, untuk setiap op-code di udara harganya disediakan, tergantung pada konsumsi sumber dayanya. <br><br><div class="spoiler">  <b class="spoiler_title">Jadwal Biaya dari spesifikasi protokol</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/wb/to/i4/wbtoi4ymmqlobftzqqvykhau2iq.png" alt="Jadwal biaya Ethereum"><br>  Tabel aliran gas untuk berbagai jenis operasi.  Dari spesifikasi protokol <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kertas Kuning Ethereum</a> . <br></div></div><br>  Tidak seperti Bitcoin, pengirim transaksi Ethereum tidak menetapkan komisi dalam cryptocurrency, tetapi jumlah gas maksimum yang bersedia ia keluarkan - mulai <b>Gas</b> dan harga per unit gas - Harga gas.  Ketika mesin virtual mengeksekusi kode, jumlah gas untuk setiap operasi selanjutnya dikurangi dari startGas sampai keluar dari kode tercapai atau gas habis.  Rupanya, itulah mengapa nama aneh digunakan untuk unit kerja ini - transaksi diisi dengan gas seperti mobil, dan itu akan mencapai titik tujuan atau tidak tergantung pada apakah ada cukup volume yang diisi dalam tangki.  Setelah menyelesaikan eksekusi kode, jumlah udara yang diterima dengan mengalikan gas yang dikonsumsi sebenarnya dengan harga yang ditentukan oleh pengirim ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">wei</a> per gas) didebit dari pengirim transaksi.  Dalam jaringan global, ini terjadi pada saat "menambang" blok, yang mencakup transaksi yang sesuai, dan dalam lingkungan Remix, transaksi tersebut "ditambang" secara instan, gratis dan tanpa syarat apa pun. <br><br><h2>  Alat kami - Remix IDE </h2><br>  Untuk "profiling" konsumsi gas, kami akan menggunakan lingkungan online untuk mengembangkan kontrak Ethereum dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">IDE Remix</a> .  IDE ini berisi editor kode penyorotan sintaks, penampil artefak, render antarmuka kontrak, debugger visual mesin virtual, kompiler JS dari semua versi yang mungkin dan banyak alat penting lainnya.  Saya sangat merekomendasikan memulai studi eter dengannya.  Kelebihan lainnya adalah tidak memerlukan instalasi - cukup buka di browser dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">situs resmi</a> . <br><br><h2>  Pemilihan Jenis Variabel </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Spesifikasi bahasa Solidity</a> menawarkan pengembang sebanyak tiga puluh dua bit tipe integer uint - dari 8 hingga 256 bit.  Bayangkan Anda sedang mengembangkan kontrak pintar yang dirancang untuk menyimpan usia seseorang selama bertahun-tahun.  Berapa kedalaman bit yang tidak Anda pilih? <br><br>  Akan sangat wajar untuk memilih jenis minimum yang cukup untuk tugas tertentu - uint8 akan cocok secara matematis di sini.  Adalah logis untuk mengasumsikan bahwa semakin kecil objek yang kita simpan di blockchain dan semakin sedikit memori yang kita habiskan untuk eksekusi, semakin sedikit overhead yang kita miliki, semakin sedikit kita membayar.  Tetapi dalam kebanyakan kasus, asumsi ini akan salah. <br><br>  Untuk percobaan, kami mengambil kontrak paling sederhana dari apa yang ditawarkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi Solidity</a> resmi dan mengumpulkannya dalam dua versi - menggunakan tipe variabel uint256 dan tipe 32 kali lebih kecil - uint8. <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_uint256.sol</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><code>pragma solidity ^<span class="hljs-number"><span class="hljs-number">0.4</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>; contract SimpleStorage { //uint is alias <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> uint256 uint storedData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span> { storedData = x; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> storedData; } }</code> <br></code> </pre> <code><code>pragma solidity ^0.4.0; contract SimpleStorage { //uint is alias for uint256 uint storedData; function set(uint x) public { storedData = x; } function get() public view returns (uint) { return storedData; } }</code> <br></code> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_uint8.sol</b> <div class="spoiler_text"><pre> <code class="hljs powershell">pragma solidity ^<span class="hljs-number"><span class="hljs-number">0.4</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>; contract SimpleStorage { uint8 storedData; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint8 x)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span></span> { storedData = x; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">view</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">returns</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> storedData; } }</code> </pre> <br><br></div></div><br><h2>  Mengukur â€œtabunganâ€ </h2><br>  Jadi, kontrak dibuat, dimuat ke dalam Remix, digunakan, dan metode panggilan ke .set () dijalankan oleh transaksi.  Apa yang kita lihat  <b>Merekam tipe lama lebih mahal daripada yang pendek</b> - 20464 versus 20205 unit gas!  Bagaimana?  Mengapa  Mari kita cari tahu! <br><br><img src="https://habrastorage.org/webt/rq/7p/bo/rq7pbohiqrtea8mp2bem0hddqlu.png" alt="Konsumsi gas Ethereum dalam Remix IDE"><br><br><h2>  Simpan uint8 vs uint256 </h2><br>  Menulis ke penyimpanan persisten adalah salah satu operasi termahal dalam protokol karena alasan yang jelas: pertama, merekam keadaan meningkatkan jumlah ruang disk yang diperlukan oleh node penuh.  Ukuran penyimpanan ini terus meningkat, dan semakin banyak status disimpan di node, semakin lambat sinkronisasi terjadi, semakin tinggi persyaratan infrastruktur (ukuran partisi, jumlah iops).  Pada waktu puncak, operasi IO disk lambat yang menentukan kinerja seluruh jaringan. <br><br>  Adalah logis untuk mengharapkan bahwa penyimpanan uint8 akan berharga puluhan kali lebih murah daripada uint256.  Namun, dalam debugger Anda dapat melihat bahwa kedua nilai tersebut terletak persis sama di slot penyimpanan sebagai nilai 256-bit. <br><br><img src="https://habrastorage.org/webt/7x/v-/e8/7xv-e8hrnzwrta4z0z7adgticm0.png"><br><br>  Dan dalam kasus khusus ini, penggunaan uint8 tidak memberikan keuntungan apa pun dalam biaya penulisan ke penyimpanan. <br><br><h2>  Menangani uint8 vs uint256 </h2><br>  Mungkin kita akan mendapat manfaat ketika bekerja dengan uint8 jika tidak selama penyimpanan, maka setidaknya saat memanipulasi data dalam memori?  Berikut ini membandingkan instruksi untuk fungsi yang sama yang diperoleh untuk berbagai jenis variabel. <br><br><img src="https://habrastorage.org/webt/wj/qq/4h/wjqq4hi8_gkc0lfxckcyhjygbu4.png"><br><br>  Anda dapat melihat bahwa operasi dengan uint8 memiliki lebih <b>banyak instruksi</b> daripada uint256.  Ini karena mesin mengubah nilai 8-bit ke kata 256-bit asli, dan sebagai hasilnya, kode dikelilingi oleh instruksi tambahan yang dibayar pengirim.  Tidak hanya menulis, tetapi juga mengeksekusi kode dengan tipe uint8 dalam hal ini lebih mahal. <br><br><h2>  Di mana penggunaan tipe pendek dapat dibenarkan? </h2><br>  Tim kami telah terlibat dalam audit kontrak cerdas untuk waktu yang lama, dan sejauh ini belum ada kasus praktis tunggal di mana penggunaan tipe kecil dalam kode yang disediakan untuk audit akan mengarah pada penghematan.  Sementara itu, dalam beberapa kasus yang sangat spesifik, penghematan secara teori dimungkinkan.  Misalnya, jika kontrak Anda menyimpan sejumlah besar variabel atau struktur status kecil, maka mereka dapat dikemas ke dalam slot penyimpanan yang lebih sedikit. <br><br>  Perbedaannya akan paling jelas dalam contoh berikut: <br><br>  1. kontrak dengan 32 variabel uint256 <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_32x_uint256.sol</b> <div class="spoiler_text"><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">pragma</span></span> solidity<span class="hljs-regexp"><span class="hljs-regexp"> ^0.4.0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">contract</span></span> SimpleStorage { <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData1; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData2; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData3; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData4; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData5; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData6; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData7; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData8; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData9; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData10; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData11; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData12; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData13; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData14; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData15; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData16; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData17; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData18; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData19; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData20; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData21; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData22; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData23; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData24; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData25; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData26; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData27; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData28; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData29; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData30; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData31; <span class="hljs-attribute"><span class="hljs-attribute">uint</span></span> storedData32; <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> set(uint x) public { <span class="hljs-attribute"><span class="hljs-attribute">storedData1</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData2</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData3</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData4</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData5</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData6</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData7</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData8</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData9</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData10</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData11</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData12</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData13</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData14</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData15</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData16</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData17</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData18</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData19</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData20</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData21</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData22</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData23</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData24</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData25</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData26</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData27</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData28</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData29</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData30</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData31</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData32</span></span> = x; } <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> get() public view returns (uint) { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> storedData1; } }</code> </pre> <br><br></div></div><br>  2. kontrak dengan 32 variabel uint8 <br><br><div class="spoiler">  <b class="spoiler_title">simpleStorage_32x_uint8.sol</b> <div class="spoiler_text"><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">pragma</span></span> solidity<span class="hljs-regexp"><span class="hljs-regexp"> ^0.4.0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">contract</span></span> SimpleStorage { <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData1; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData2; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData3; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData4; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData5; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData6; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData7; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData8; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData9; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData10; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData11; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData12; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData13; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData14; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData15; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData16; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData17; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData18; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData19; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData20; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData21; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData22; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData23; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData24; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData25; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData26; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData27; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData28; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData29; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData30; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData31; <span class="hljs-attribute"><span class="hljs-attribute">uint8</span></span> storedData32; <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> set(uint8 x) public { <span class="hljs-attribute"><span class="hljs-attribute">storedData1</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData2</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData3</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData4</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData5</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData6</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData7</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData8</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData9</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData10</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData11</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData12</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData13</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData14</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData15</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData16</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData17</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData18</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData19</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData20</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData21</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData22</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData23</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData24</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData25</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData26</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData27</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData28</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData29</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData30</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData31</span></span> = x; <span class="hljs-attribute"><span class="hljs-attribute">storedData32</span></span> = x; } <span class="hljs-attribute"><span class="hljs-attribute">function</span></span> get() public view returns (uint) { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> storedData1; } }</code> </pre> <br><br></div></div><br>  Penerapan kontrak pertama (32 uint256) akan lebih murah - hanya 89941 gas, tetapi .set () akan jauh lebih mahal karena  Ini akan menempati 256 slot dalam penyimpanan, yang akan menelan biaya 640.639 gas untuk setiap panggilan.  Kontrak kedua (32 uint8) akan menjadi dua setengah kali lebih mahal ketika menggunakan (221663 gas), tetapi setiap panggilan ke metode .set () akan jauh lebih murah, karena  hanya mengubah satu sel panggung (185291 gas). <br><br><h2>  Haruskah optimasi seperti itu diterapkan? </h2><br>  Seberapa signifikan pengaruh optimasi tipe adalah titik diperdebatkan.  Seperti yang Anda lihat, bahkan untuk case sintetis pilihan khusus, kami <b>tidak mendapatkan</b> banyak perbedaan.  Pilihan untuk menggunakan uint8 atau uint256 lebih merupakan ilustrasi fakta bahwa optimasi harus diterapkan secara bermakna (dengan pemahaman tentang alat, pembuatan profil), atau tidak memikirkannya sama sekali.  Berikut ini beberapa pedoman umum: <br><br><ul><li>  jika kontrak berisi banyak angka kecil atau struktur kompak dalam repositori, maka Anda bisa memikirkan pengoptimalan; </li><li>  jika Anda menggunakan tipe "disingkat" - ingat tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kerentanan over-/ under-flow</a> ; </li><li>  untuk variabel memori dan argumen fungsi yang tidak ditulis ke repositori, selalu lebih baik menggunakan tipe asli uint256 (atau alias uintnya).  Misalnya, tidak masuk akal untuk mengatur daftar iterator ke uint8 - hilang saja; </li><li>  Yang sangat penting untuk pengemasan yang benar dalam slot penyimpanan untuk kompiler adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">urutan variabel dalam kontrak</a> . </li></ul><br><h2>  Referensi </h2><br>  Saya akan berakhir dengan saran yang tidak memiliki kontraindikasi: bereksperimen dengan alat pengembangan, mengetahui spesifikasi bahasa, perpustakaan, dan kerangka kerja.  Berikut adalah tautan yang paling berguna, menurut saya, untuk mulai belajar tentang platform Ethereum: <br><br><ul><li>  Lingkungan pengembangan kontrak <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Remix</a> adalah IDE berbasis browser yang sangat fungsional; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Spesifikasi bahasa Solidity</a> , tautannya akan secara khusus ke bagian Tata Letak Variabel Negara; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Repositori</a> kontrak yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sangat menarik</a> dari tim OpenZeppelin yang terkenal.  Contoh penerapan token, kontrak crowdsale, dan yang paling penting - pustaka <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">SafeMath</a> , yang membantu bekerja dengan aman dengan tipe; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ethereum Yellow Paper</a> , spesifikasi formal mesin virtual Ethereum; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ethereum White Paper</a> , spesifikasi platform Ethereum, dokumen yang lebih umum dan tingkat tinggi dengan sejumlah besar tautan; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ethereum dalam 25 menit</a> , pengantar teknis singkat namun luas untuk Ethereum dari pencipta platform, Vitalik Buterin; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Etherscan blockchain explorer</a> , jendela ke dunia eter nyata, peramban blok, transaksi, token, kontrak di jaringan utama.  Di Etherscan, Anda akan menemukan penjelajah untuk jaringan uji Rinkeby, Ropsten, Kovan (jaringan dengan siaran gratis, dibangun di atas protokol konsensus yang berbeda). </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id415791/">https://habr.com/ru/post/id415791/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id415779/index.html">Implementasi platform perangkat lunak NAS yang aman</a></li>
<li><a href="../id415781/index.html">Mengapa fisikawan berpikir teori string bisa berubah menjadi "teori segalanya"</a></li>
<li><a href="../id415783/index.html">Cakram bintang mengungkapkan kepada kita rahasia kemunculan planet-planet</a></li>
<li><a href="../id415785/index.html">SpaceX mengirimkan robot kecerdasan buatan ke ISS</a></li>
<li><a href="../id415789/index.html">Algoritma Paten untuk Program Komputer</a></li>
<li><a href="../id415793/index.html">Panduan pemesanan domain lengkap</a></li>
<li><a href="../id415795/index.html">Menulis Snapchat UI di Swift</a></li>
<li><a href="../id415797/index.html">Ekspresi reguler + pemrograman logis. Apa hasilnya?</a></li>
<li><a href="../id415801/index.html">Google: AI "telepon" kami tidak cukup baik untuk berbahaya</a></li>
<li><a href="../id415805/index.html">Modifikasi modul penghalang GSM Doorhan untuk kontrol Internet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>