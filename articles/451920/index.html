<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õπüèº üç® üíå Optimice el almacenamiento de correo en Zimbra Collaboration Suite üé• üéæ üé≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En uno de nuestros art√≠culos anteriores sobre planificaci√≥n de infraestructura durante la implementaci√≥n de Zimbra Collabortion Suite en la empresa, s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Optimice el almacenamiento de correo en Zimbra Collaboration Suite</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/zimbra/blog/451920/">  En uno de nuestros <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culos anteriores</a> sobre planificaci√≥n de infraestructura durante la implementaci√≥n de Zimbra Collabortion Suite en la empresa, se dijo que la principal limitaci√≥n en el trabajo de esta soluci√≥n es la velocidad de entrada / salida de los dispositivos de disco en los almacenes de correo.  De hecho, en un momento en que varios cientos de empleados de la empresa acceden simult√°neamente al mismo almac√©n de correo, el ancho del canal para escribir y leer informaci√≥n de los discos duros puede no ser suficiente para el servicio receptivo.  Y si para instalaciones peque√±as de Zimbra esto no se convierte en un problema particular, entonces, en el caso de las grandes empresas y los proveedores de SaaS, todo esto puede llevar a un trabajo de correo electr√≥nico que no responde y, como resultado, a una menor eficiencia de los empleados, as√≠ como a la violaci√≥n del SLA.  Es por eso que al dise√±ar y operar instalaciones Zimbra a gran escala, se debe prestar especial atenci√≥n a la cuesti√≥n de optimizar el funcionamiento de los discos duros en el almacenamiento de correo.  Veamos dos casos e intentemos averiguar qu√© m√©todos de optimizaci√≥n de la carga en los almacenamientos de disco se pueden aplicar en cada uno de ellos. <br><br><img src="https://habrastorage.org/web/524/a74/d9d/524a74d9dc834ae581c7893fc079c693.png" alt="imagen"><a name="habracut"></a><br><br>  <b>1. Optimizaci√≥n al dise√±ar una instalaci√≥n Zimbra a gran escala</b> <br><br>  En la etapa de dise√±o de una instalaci√≥n de Zimbra altamente cargada, su administrador tendr√° que elegir qu√© sistema de almacenamiento de datos usar.  Para decidir sobre este problema, debe saber que la carga principal en los discos duros es creada por MariaDB DBMS, el sistema de b√∫squeda Apache Lucene, as√≠ como el almacenamiento de blobs que forman parte de Zimbra Collaboration Suite.  Es por eso que para el funcionamiento de estos productos de software bajo altas cargas es necesario utilizar equipos confiables y de alta velocidad. <br><br>  En condiciones normales, Zimbra se puede instalar tanto en RAID desde discos duros como en almacenamiento conectado a trav√©s del protocolo NFS.  En casos de instalaciones muy peque√±as, puede instalar Zimbra en una unidad SATA normal.  Sin embargo, en instalaciones grandes, todas estas tecnolog√≠as demuestran varias desventajas en forma de velocidad de escritura reducida o baja confiabilidad, lo cual es inaceptable para las grandes empresas y, especialmente, para los proveedores de SaaS. <br><br>  Es por eso que en condiciones de infraestructuras a gran escala, Zimbra es mejor usar SAN.  Es ella quien en este momento es capaz de proporcionar el mayor ancho de banda para dispositivos de almacenamiento y, al mismo tiempo, debido a la capacidad de conectar una gran cantidad de cach√©, su uso pr√°cticamente no conlleva riesgos significativos para la empresa.  Una buena idea ser√≠a usar NVRAM, que se usa en muchas SAN para acelerar el rendimiento de grabaci√≥n.  Pero es mejor deshabilitar el almacenamiento en cach√© de los datos grabados en los discos, ya que puede provocar da√±os irreparables en los medios y la p√©rdida de datos en caso de problemas de alimentaci√≥n. <br><br>  En cuanto a la elecci√≥n del sistema de archivos, la mejor opci√≥n ser√≠a utilizar el est√°ndar para Linux Ext3 / Ext4.  El matiz principal asociado con el sistema de archivos es que debe montarse con la <b>opci√≥n -noatime</b> .  Este par√°metro deshabilitar√° la funci√≥n de fijar el tiempo del √∫ltimo acceso a los archivos, lo que significa que reducir√° en gran medida la carga de lectura y escritura.  En general, al crear un sistema de archivos ext3 o ext4 para Zimbra, se deben usar los siguientes par√°metros de la utilidad <b>mke2fs</b> : <br><br><blockquote> <b>-j</b> : <b>crea</b> el sistema de archivos con un diario ext3 / ext4. <br>  <b>-L TITLE</b> : para crear un nombre de volumen, luego √∫selo en / etc / fstab <br>  <b>-O dir_index</b> : para usar un √°rbol de b√∫squeda hash para acelerar las b√∫squedas de archivos en directorios grandes <br>  <b>-m 2</b> : para reservar el 2% del volumen en sistemas de archivos grandes en el directorio ra√≠z <br>  <b>-J size = 400</b> - Para crear un registro grande <br>  <b>-b 4096</b> - Para determinar el tama√±o del bloque en bytes <br>  <b>-i 10240</b> : para el almac√©n de mensajes, esta opci√≥n debe coincidir con el tama√±o promedio del mensaje.  Debe considerar cuidadosamente este par√°metro, ya que posteriormente su valor no se puede cambiar </blockquote><br>  Adem√°s, le recomendamos que habilite la <b>sincronizaci√≥n</b> de <b>directorios</b> para el almacenamiento de blobs, el almacenamiento de metadatos de b√∫squeda de Lucene y el almacenamiento de colas MTA.  Esto debe hacerse por la raz√≥n por la que Zimbra usa la utilidad <b>fsync</b> para garantizar que escribir√° blob con datos en el disco.  Sin embargo, cuando el buz√≥n de Zimbra o el MTA crean nuevos archivos durante la entrega del mensaje, se hace necesario escribir en el disco los cambios que ocurrieron en las carpetas correspondientes.  Es por eso que incluso en el caso de que el archivo ya se haya escrito en el disco usando <b>fsync</b> , el registro de agregarlo a los directorios puede no tener tiempo para escribir en el disco y, como resultado, puede perderse debido a una falla repentina del servidor.  Al usar <b>dirsync,</b> estos problemas se pueden evitar. <br><br>  <b>2. Optimizaci√≥n con una infraestructura de Zimbra en funcionamiento</b> <br><br>  A menudo sucede que despu√©s de varios a√±os de operaci√≥n de Zimbra, el n√∫mero de usuarios aumenta significativamente y el servicio se vuelve cada vez menos receptivo todos los d√≠as.  La soluci√≥n a esta situaci√≥n es obvia: solo necesita agregar nuevos servidores a la infraestructura para que el servicio vuelva a funcionar tan r√°pido como antes.  Mientras tanto, est√° lejos de ser siempre posible agregar inmediatamente nuevos servidores a la infraestructura para aumentar su velocidad.  A menudo, los gerentes de TI deben coordinar durante mucho tiempo la compra de nuevos servidores con el departamento de contabilidad o seguridad, adem√°s, los proveedores a menudo no logran retrasar el nuevo servidor o no entregar lo que se necesita. <br><br>  Por supuesto, es mejor construir su infraestructura Zimbra con un margen para tener siempre un margen para su expansi√≥n y no depender de nadie, sin embargo, si el error ya se ha cometido, el administrador de TI solo puede suavizar sus consecuencias.  Por ejemplo, un administrador de TI puede lograr un peque√±o aumento en la productividad al deshabilitar temporalmente los servicios del sistema Linux, que acceden regularmente a los discos duros durante la operaci√≥n y, como resultado, pueden afectar negativamente la velocidad de Zimbra.  Entonces, por un tiempo puedes deshabilitar: <br><br><blockquote>  <b>autofs, netfs</b> - Servicios de descubrimiento de sistemas de archivos remotos <br>  <b>tazas</b> - Servicio de impresi√≥n <br>  <b>xinetd, vsftpd</b> - Servicios incorporados * NIX que probablemente no necesitar√° <br>  <b>portmap, rpcsvcgssd, rpcgssd, rpcidmapd</b> : servicios de llamada a procedimientos remotos que se usan com√∫nmente junto con sistemas de archivos de red <br>  <b>dovecot, cyrus-imapd, sendmail, exim, postfix, ldap</b> - Duplicados de las principales utilidades incluidas en Zimbra Collaboration Suite <br>  <b>slocate / updatedb</b> : dado que Zimbra almacena cada mensaje en un archivo separado, iniciar el servicio updatedb a diario puede causar problemas y, por lo tanto, puede hacerlo manualmente durante la carga m√°s peque√±a del servidor </blockquote><br>  El ahorro de recursos del sistema como resultado de la desactivaci√≥n de estos servicios no es muy significativo, pero incluso esto puede ser muy √∫til en condiciones cercanas a causas de fuerza mayor.  Despu√©s de agregar el nuevo servidor a la infraestructura de Zimbra, se recomienda volver a habilitar los servicios previamente deshabilitados. <br><br>  Tambi√©n es posible optimizar la operaci√≥n de Zimbra moviendo el servicio syslog a un servidor separado para que no cargue discos duros de almacenamiento de correo durante la operaci√≥n.  Para estos fines, casi cualquier computadora, hasta una Raspberry Pi barata de una sola placa, es adecuada. <br><br>  Para todas las preguntas relacionadas con la Suite Zextras, puede contactar al representante de la compa√±√≠a "Zextras" Katerina Triandafilidi por correo electr√≥nico katerina@zextras.com </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/451920/">https://habr.com/ru/post/451920/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../451906/index.html">Vulnerabilidad de Exchange: c√≥mo detectar la elevaci√≥n de privilegios a un administrador de dominio</a></li>
<li><a href="../451908/index.html">La historia de las computadoras: una noche en el Museo Yandex</a></li>
<li><a href="../451912/index.html">La red neuronal profunda de MuseNet escribe m√∫sica</a></li>
<li><a href="../451916/index.html">PHP asincr√≥nico y la historia de una bicicleta</a></li>
<li><a href="../451918/index.html">A la pregunta de TI</a></li>
<li><a href="../451922/index.html">Aritm√©tica de punto fijo en C ++</a></li>
<li><a href="../451926/index.html">Acerca del c√≥digo en vivo despu√©s de 130 transmisiones</a></li>
<li><a href="../451928/index.html">C√≥mo configurar an√°lisis web en p√°ginas AMP</a></li>
<li><a href="../451930/index.html">Automatizaci√≥n de iluminaci√≥n de escaleras</a></li>
<li><a href="../451932/index.html">PHDays 9: Bienvenido a la Secci√≥n de Desarrollo Seguro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>