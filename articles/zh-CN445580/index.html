<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌪️ 😗 👞 VB.NET和C＃之间的差异的详尽列表。 第二部分 🤞🏽 👩🏿‍⚖️ 🔆</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在本文的第一部分中，有关TIOBE等级的VB.NET优于C＃的话题在评论中引起了热烈的反响。 因此，根据AngReload的建议 ，让我们看一下StackOverflow的趋势 。 

 C＃仍然很强大！ 上次讨论这么长时间的革命被取消了！ 同志们，万岁！ 还是不行 TIOBE等级基于搜索引擎查询，...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VB.NET和C＃之间的差异的详尽列表。 第二部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/445580/"> 在本文的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第一</a>部分中，有关TIOBE等级的VB.NET优于C＃的话题在评论中引起了热烈的反响。 因此，根据<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">AngReload</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">建议</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">，</a>让我们看一下StackOverflow的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">趋势</a> 。 <br><img src="https://habrastorage.org/webt/j-/h5/pb/j-h5pbwyspgmneebz20tzlway28.png"><br>  C＃仍然很强大！ 上次讨论这么长时间的革命被取消了！ 同志们，万岁！ 还是不行  TIOBE等级基于搜索引擎查询，而SO等级则基于所问问题的标签。 也许包括很多没有专业知识的人在内的VB.NET开发人员根本不知道StackOverflow的存在？ 或是通过Google甚至Bing到达那里，都不知道如何提出问题？ 或者，也许他们有足够的Miscrosoft文档，而所有几个问题都已得到解答。 <br><br> 无论如何，VB.NET的份额都是引人注目且稳定的，尽管在数量上并不是第一位。 当然，如果没有强大的设计师和语言开发人员团队，这样的结果将是不可能的。 以下是该团队成员<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Anthony Green</a>的文章翻译的第二部分。 <br><a name="habracut"></a><br><h2> 目录内容 </h2><br><div class="spoiler">  <b class="spoiler_title">隐藏文字</b> <div class="spoiler_text"><h4> 转换次数 </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">34.布尔变换</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">35.即使Option Strict设置为On，Enum类型之间以及Enum类型与其基本类型之间的转换也是完全不受限制的。</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">36.整数算术的溢出检查/负下溢完全由编译环境（项目设置）控制，但是VB和C＃使用不同的默认值；</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在VB中，默认情况下启用了溢出检查</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">37.将浮点数转换为整数类型使用库舍入（贝克舍入）而不是截断</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">38.将NotInheritable类与在编译时未实现的接口相互转换不是错误的</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">39.尝试将null解包（拆箱）为有意义的类型会导致该类型的默认值，而不是NullReferenceException</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">40.拆箱支持原始类型转换</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">41.在字符串和字符之间进行转换</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">42.在String和Char数组之间有转换</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">43和44。从字符串到数字和日期类型的转换支持文字语法（通常）</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">45. Char和整数类型之间没有NO转换</a> </li></ul><br><h4> 表达方式 </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">46.什么都不是&lt;&gt; null</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">47.方括号不仅影响解析优先级，而且还影响解析优先级。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">他们将变量重新分类为值</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">48.我总是被归类为意义-即使在结构上</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">49.扩展方法可以通过简单的名称获得。</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">50.静态导入不会合并方法组</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">51和52.部分名称限定和智能名称解析</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">53.集合初始化方法的添加方法可以是扩展方法。</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">54.创建数组使用上限，而不是大小</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">55.魔术的VB数组文字与C＃中的隐式类型的数组创建表达式不同</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">56.匿名类型的字段可以是可变的，并且默认情况下是可变的</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">57. CType和DirectCast都不是C＃中的强制类型</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">58.一些“等效”运营商的优先级不一定是一致的。</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">59.字符串连接是不同的；</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">+和＆在字符串连接的上下文中有所不同；</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">+在VB &lt;&gt; +在C＃</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">60.除法充分发挥作用：3/2 = 1.5</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">61.不完全是Math.Pow</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">62. = / &lt;&gt;运算符从不等于链接的相等/不相等</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">63.字符串的= / &lt;&gt;运算符是不同的（和此上下文中的任何其他关系运算符）</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">64.可空有效类型使用三值逻辑（在关系运算符中传播空值）</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">65.重载的运算符并不总是对应于1：1</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">66.函数（）a = b与（）=&gt; a = b不同</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">67.异步函数lambda永远不会被视为异步void lambda</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">68. VB中的请求是真实的（更真实）</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">69和70。From请求中的As语句并不总是调用强制转换；</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">作为奖励，“ As”运算符可以调用隐式用户转换</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">71–75。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Select语句根本不是必需的，它可以出现在查询的中间，可以出现几次，并且可以使用隐式或显式名称声明多个范围变量。</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">76.结论...</a> </li></ul></div></div><br><h2> 转换次数 </h2><br><a name="section34"></a><h3>  34.布尔变换 </h3><br> 将<code>Boolean True</code>转换为任何带符号的数字类型将产生<code>-1</code> ，而将其转换为任何无符号的类型将为该类型提供最大值，而在C＃中没有此类转换。 但是，例如， <code>Convert.ToInt32</code>方法会将<code>True</code>转换为<code>1</code> ，这就是<code>IL</code>最常表示的方式。 在相反的方向上，除<code>0</code>以外的任何数字都将转换为<code>True</code> 。 <br><br>  <b>怎么了</b>  VB倾向于使用<code>-1</code>到<code>1</code>的原因是因为在任何语言中0（所有位都设置为0）的按位取反是<code>-1</code> （所有位都设置为<code>1</code> ），因此使用此值将逻辑和按位组合<code>And</code> ， <code>Or</code>和<code>Xor</code>等运算。 <br> 还支持与“ True”和“ False”行之间的转换（当然，不区分大小写）。 <br><br><a name="section35"></a><h3>  35.即使Option Strict设置为On，Enum类型之间以及Enum类型与其基本类型之间的转换也是完全不受限制的 </h3><br> 从哲学的角度来看，语言是指<code>Enum</code>类型，而不是基本整数类型的一组命名常量。 最明显的地方是平等。 始终允许将任何整数与枚举值进行比较，而在C＃中会产生错误。 <br><br>  <b>故事时间：</b> Roslyn API经历了许多内部修订。 但是在每种语言中，都为每种语言分配了<code>SyntaxKind</code>枚举，该枚举告诉您节点表示什么语法（例如<code>IfStatement</code> ， <code>TryCastExpression</code> ）。 有一次，开发人员使用了一个试图从该语言中抽象出来的API并返回了一个<code>SyntaxKind</code>值，但仅作为<code>Integer</code> ，并且在比较原始<code>Integer</code>和<code>SyntaxKind</code>时没有收到错误，该开发人员立即来到我的办公室并抱怨： <i>“ int is实施细节，我应该被迫做演员！”</i>  。 <br><br> 多年来，在API的下一个修订版中，我们完全删除了指向特定于语言的类型的属性（ <code>Property Kind As SyntaxKind</code> ），并且所有API开始返回<code>Integer</code> 。 所有的C＃代码都中断了，所有的VB代码继续工作，好像什么都没发生。 <br><br> 稍后，我们决定将该属性重命名为<code>RawKind</code>并添加特定于语言的扩展方法<code>Kind()</code> 。 所有C＃代码都中断了，因为调用方法需要使用括号，但是由于VB中不需要括号，因此所有VB代码都继续工作，就好像什么都没发生一样。 <br><br><a name="section36"></a><h3>  36.检查整数运算的溢出/负溢出完全由编译环境（项目设置）控制，但是VB和C＃使用不同的默认值。 在VB中，默认情况下启用了溢出检查 </h3><br> 整数类型具有范围，例如， <code>Byte</code>可以表示0到255之间的值。那么，将<code>Byte</code> 1与<code>Byte</code> 255相加会发生什么？ 如果禁用了上溢/下溢检查，则值滚动到0。如果类型是带符号的，则滚动到最低的负数（例如，-128表示<code>SByte</code> ）。 这很可能表明程序中存在错误。 如果启用了上溢/下溢检查，则会引发异常。 要理解我的意思，请看一下这个无害的<code>For</code>循环。 <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i As Byte = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span> Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github源代码</a> <br><br> 默认情况下，此循环将在VB中引发异常（因为循环的最后一次迭代超出了<code>Byte</code>边界。但是，关闭了溢出检查后，由于255之后我又变为0，所以它将循环。 <br> 当类型的最小值减去以下的最小值得到最大值时，下溢是相反的情况。 <br><br> 一个更常见的溢出情况就是两个数字的加法。 将数字130和150都作为<code>Byte</code> 。 如果将它们放在一起，答案是280，它不适合Byte。 但是您的处理器无法感知到这一点。 相反，他报告答案是24。 <br><br> 顺便说一下，这与转换无关。 两个字节相加得到一个字节； 这只是二进制数学的工作方式。 尽管例如通过尝试将Long转换为Integer时，也可以通过执行转换来溢出。 在不检查溢出的情况下，该程序只截取了多余的位和填充到该变量中的内容。 <br><br>  <b>有什么区别？</b> 性能。 像所有其他安全检查一样，与非检查选项相比，检查CLR是否溢出需要更多的计算时间。  VB基于这样的理念，即开发人员的生产力比计算性能更重要，因此默认情况下您启用了安全检查。  <i>今天</i>的C＃开发团队<i>可能</i>对项目的默认设置做出不同的决定，但是考虑到最初的C＃开发人员来自C / C ++开发人员，因此这群人可能会要求代码不做任何事情，这可能会浪费处理器周期;  <b>这是一个困难的哲学差异</b> 。 <br><br>  <b>注意：</b>即使关闭了上溢/下溢检查，从<code>Single</code>或<code>Double</code>的<code>PositiveInfinity</code> ， <code>NegativeInfinity</code> ， <code>NaN</code>到<code>Decimal</code>引发异常，因为原则上这些值都不能用Decimal表示。 <br><br><a name="section37"></a><h3>  37.将浮点数转换为整数类型使用银行取整而不是截断 </h3><br> 如果在VB中将1.7转换为整数，结果将为2。在C＃中，结果将为1。关于美国以外的数学规则，我什么也没说，但是当我从实数转换为整数时，我本能地舍入。 在程序员圈子之外，我所认识的人都不相信1.7的最接近整数是1。 <br><br> 实际上有几种舍入方法，VB（以及Math.Round方法）中使用的舍入类型默认称为库舍入或四舍五入统计量。 其本质是，对于两个整数之间的中间数字，VB会四舍五入到最接近的偶数。 因此1.5会四舍五入为2，4.5会四舍五入为4。这实际上对我们在学校的授课方式不起作用-我被教导从0.5向上舍入（从技术上讲，从零开始舍入到边）。 但是，顾名思义，银行四舍五入的优势在于，通过大量计算，您可以在四舍五入时进行除法运算，而不必总是付出或总是保留金钱。 换句话说，在较大的数据集上，这将数据失真限制为最终的统计偏差。 <br><br>  <b>差异来自何处？</b> 四舍五入更加直观和实用，截断速度更快。 如果考虑在LOB应用程序中使用VB，尤其是在VBA上运行的Excel宏之类的应用程序中使用VB，则简单地舍弃小数位会导致...问题。 <br><br> 我认为很明显，转换方法始终是一个有争议的问题，应明确指出，但是如果您需要选择一个... <br><br><a name="section38"></a><h3>  38.将NotInheritable类与在编译时未实现的接口相互转换不是错误的 </h3><br> 一般来说，如果您正在检查NonInheritable类的接口实现，则可以在编译时理解是否可以进行这种转换，因为您知道此类型的所有接口及其所有基本类型。 如果类型是继承的，则无法确定是否无法进行这种转换，因为所引用的运行时对象的类型实际上可能具有实现该接口的更多派生类型。 但是，由于COM互操作而有一个例外，当在编译时可能看不到该类型与接口有关，但在运行时它将与接口有关。 因此，在这种情况下，VB编译器会生成警告。 <br><br>  <b>怎么了</b>  VB和COM在旧社区里还是个孩子的时候就一起成长。 因此，在语言设计中有几种解决方案，其中VB高度关注仅在.NET 1.0发行时COM中才存在的问题。 <br><br><a name="section39"></a><h3>  39.尝试将null解包（拆箱）为有意义的类型会导致该类型的默认值，而不是NullReferenceException </h3><br> 我认为从技术上讲，引用类型也是如此，但是可以： <br><pre> <code class="vbscript hljs"><span class="hljs-built_in"><span class="hljs-built_in">CInt</span></span>(CObj(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>)) = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  <b>怎么了</b> 因为<code>CInt(Nothing) = 0</code> ，并且语言趋于一致，而不管您是否键入变量。 这适用于任何结构，而不仅仅是内置的有意义的类型。 有关更多详细信息，请参见<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">＃25</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">基本原理</a> 。 <br><br><a name="section40"></a><h3>  40.拆箱支持原始类型转换 </h3><br> 在VB和C＃中，都可以将<code>Short</code>转换为<code>Integer</code> ，但是如果尝试将压缩的<code>Short</code>转换为<code>Integer</code>怎么办？ 在VB中， <code>Short</code>将首先解压缩，然后转换为<code>Integer</code> 。 在C＃中，除非您在转换为<code>int</code>之前手动解压缩short，否则将抛出<code>InvalidCastException</code> 。 <br> 这适用于所有内部转换，即打包的数字类型，字符串和数字类型之间的转换，字符串和日期（是，小数和日期是原始类型）。 <br><br>  <b>怎么了</b> 同样，为确保行为一致，无论您的程序是完全键入，键入为Object还是从一个选项重构到另一个选项。 请参阅上面的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">＃39</a> 。 <br><br><a name="section41"></a><h3>  41.在<code>String</code>和<code>Char</code>之间进行转换 </h3><br><ul><li>  <code>String</code>转换为<code>Char</code> ，表示其第一个字符。 </li><li>  <code>Char</code>以唯一合理的方式转换为<code>String</code> 。 </li></ul><br> 因为除了我之外，没有人记得VB中字符文字的语法（而且不应该）。 <br><br><a name="section42"></a><h3>  42.在<code>String</code>和<code>Char</code>数组之间有转换 </h3><br><ul><li>  <code>String</code>转换为由其所有<code>Char</code>组成的<code>Char</code>数组。 </li><li>  <code>Char</code>数组将转换为包含其所有元素的<code>String</code> 。 </li></ul><br> 为了明确起见：这些转换会创建新对象，您无法访问内部<code>String</code>结构。 <br><br>  <b>有趣的故事：</b>我曾经发现（或者可能正在报告它，并且我正在研究）打破.NET 3.5和4.0之间的更改，因为.NET团队在这些版本之间将<code>ParamArray</code>修饰符添加到第二个<code>String.Join</code>重载<code>String.Join</code> （该<code>String.Join</code>需要一个字符串数组） 。 确切的假设会随着时间的流逝而丢失（可能会更好），但是，正如我所相信的，原因是，通过<code>ParamArray</code>修饰符，您现在可以将<code>Char</code>数组转换为字符串，并将其作为单独的元素传递给参数数组。 有趣的主题。 <br><br><a name="section43to44"></a><h3>  43和44。从字符串到数字和日期类型的转换支持文字语法（通常） </h3><br><ul><li> <code>CInt("&amp;HFF") = 255</code> </li> <li> <code>CInt("1e6") = 1_000_000</code> </li> <li> <code>CDate("#12/31/1999#") = #12/31/1999#</code> </li> </ul><br> 这可以与基本前缀一起使用，并可以使用非常方便的方式将十六进制（或八进制）输入转换为数字： <code>CInt("&amp;H" &amp; input)</code> 。 不幸的是，由于VB运行时尚未更新为支持二进制前缀＆B或<code>1_000</code>位数字组<code>1_000</code> ，因此这种对称性在撰写本文时有所<code>1_000</code> ，但我希望在下一版本中可以解决此问题。 科学符号有效，但没有类型后缀，日期转换也支持标准日期格式，因此ISO-8601中使用的JSON格式也适用： <code>CDate("2012-03-19T07: 22Z") = #3/19/2012 02:22:00 AM#</code> 。 <br><br>  <b>怎么了</b> 除了方便我没有其他原因。 但是我<i>真的</i>很想为当今网络中几乎无处不在的其他常见格式提供支持，例如＃FF，U + FF，0xFF。 我认为这可以极大地简化某些类型应用程序中的生活... <br><br><a name="section45"></a><h3>  45. <code>Char</code>和整数类型之间没有NO转换 </h3><br>  <b>什么？！？！？</b> <br> 阅读完所有这些其他转换后，您感到惊讶吗？  VB禁止在<code>Char</code>和<code>Integer</code>之间进行转换： <br><br><ul><li>  <code>CInt("A"c)</code>无法编译。 </li><li>  <code>CChar(1)</code>无法编译。 </li></ul><br>  <b>怎么了</b> 目前尚不清楚会发生什么。 通常，在这种情况下，VB使用务实和/或直观的方法，但是对于表达式<code>CInt("1")</code>我认为一半读者希望数字1（字符值1），而一半读者希望数字49（ASCII / UTF代码用于字符1）。  VB并没有在一半的情况下做出错误的选择，而是具有特殊的功能，可以将字符转换为ASCII / Unicode代码，反之亦然<code>ChrW</code>分别是<code>AscW</code>和<code>ChrW</code> 。 <br><br><h2> 表达方式 </h2><br><a name="section46"></a><h3>  46.什么都不是&lt;&gt; null </h3><br>  VB中的文字<code>Nothing</code>并不表示<i>null</i> 。 它的意思是<i>“它所使用的类型的默认值”，</i>并且碰巧对于引用类型来说，默认值为null。 仅当在以下情况下使用时，差异才重要： <br><br><ol><li> 没有什么是重要的类型，而且... </li><li> 从上下文中还不清楚他正在这样做。 </li></ol><br> 让我们看几个例子，说明这意味着什么。 <br><br> 首先，也许有些奇怪，但是我认为大多数人不会因为该程序将显示“ True”而被炸毁： <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> i = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"True"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github源代码</a> <br><br> 原因很简单：您正在将<code>Integer (0)</code>与该类型的默认值（也为0）进行比较。 当您添加可为空的有意义的类型时，会在VB2005 / 2008中发生此问题。 看一下这个例子： <br><br><pre> <code class="vbscript hljs"> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github源代码</a> <br><br> 明白了，有人怎么会建议类型<code>i</code>是<code>Integer?</code>  （ <code>Nullable(Of Integer)</code> ）。 但是事实并非如此，因为<code>Nothing</code>从上下文中获取类型，并且该上下文中的唯一类型来自第二个操作数，并且这是一个简单的<code>non-nullable Integer</code> （从技术上讲， <code>Nothing</code>从不具有类型）。 下面的示例是解决此问题的另一种方法： <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() M(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(i As Integer) Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Non-nullable"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(i As Integer?) Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Nullable"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">github源代码</a> <br><br> 再次，在这里，从直觉上看，似乎<code>Nothing</code>也<code>Nothing</code>添加“可空”提示，并且语言选择了接受<code>nullable</code>的重载，但它不接受（选择<code>non-nullable</code> ，因为它是“最具体的”）。 至少可以假定，像C＃中的null一样， <code>Nothing</code>表达式根本不适用于<code>Integer</code> ，并且可以通过异常方法选择可为null的重载，但这再次基于错误的想法，即<code>Nothing = null (Is null?)</code> 。 <br><br>  <b>注意：</b>在C＃7.1中添加了一个新的<code>default</code>表达式，该表达式与VB中的<code>Nothing</code>不匹配。 如果使用<code>default</code>而不是<code>null</code>在C＃中重写以上所有三个示例， <b>则将获得完全相同的行为</b> 。 <br><br> 该怎么办？ 有几个建议，但没有一个能胜任： <br><br><ul><li> 每次显示警告时， <code>Nothing</code>转换为有意义的类型，并且在<code>nullable</code>为<code>nullable</code>有效类型中不为<code>null</code> 。 </li><li> 精美地将<code>Nothing</code>扩展为<code>ChrW(0)</code> ， <code>ChrW(0)</code> ， <code>False</code> ， <code>#1/1/0001 12:00:00 AM#</code> <code>ChrW(0)</code> <code>#1/1/0001 12:00:00 AM#</code>或<code>New T</code> （任何结构的默认值）每次在运行时的值是以下之一时上面列出。 </li><li> 添加一个新语法，意思是“ Null，不，真的！”就像<code>Null</code>还是<code>Nothing?</code> </li><li> 添加后缀（？）形式的新语法，该语法将值包装为可空值以帮助推断类型，例如<code>If(False, 0?, Nothing)</code> </li><li> 为内置类型添加可为空的转换运算符，以使其更容易给出类型推断的提示，例如， <code>If (False, CInt? (0), Nothing)</code> </li></ul><br> 我想在评论中和/或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在Twitter上</a>听到您的想法。 <br><br> 总结一下： <br><br><ul><li> 以前-VB6和VBA的含义为“ Nothing”，“ Null”，“ Empty”和“ Missing”。 </li><li>  2002-在VB.NET中只有<code>Nothing</code> （特定上下文中的默认值），而在C＃中则只有<code>null</code> 。 </li><li>  2005年-C＃添加了<code>default(T)</code> （类型<code>T</code>的默认值），因为新添加的泛型会导致您需要初始化值，但是您不知道该值是引用类型还是有效值；  VB不执行任何操作，因为<code>Nothing</code>已关闭该脚本。 </li><li>  2017年-C＃添加了<code>default</code>值（上下文中的<code>default</code>值），因为在许多情况下指定<code>T</code>冗余或不可能 </li></ul><br>  VB继续拒绝添加<code>Null</code>表达式（或等效表达式），因为： <br><br><ul><li> 语法将带来重大变化。 </li><li> 语法不会发生重大变化，但是取决于上下文，其含义将有所不同。 </li><li> 语法不会太显眼（例如<code>Nothing?</code> ）； 想象一下，您需要大声谈论<code>Nothing</code> ， <code>Nothing?</code> 向某人解释一些事情。 </li><li> 语法可能太丑陋（例如<code>Nothing?</code> ）。 </li><li>  <code>Nothing</code>已关闭了空表达式脚本，并且该功能在大多数情况下是完全多余的。 </li><li> 在任何地方，所有文档和所有说明均应进行更新，以建议使用新语法，该语法在大多数情况下基本上都声明<code>Nothing</code> 。 </li><li> 在后期绑定，转换等方面， <code>Nothing</code>和<code>Null</code>在运行时的行为仍然相同。 </li><li> 就像刺中的枪一样。 </li></ul><br> 这样的东西。 <br><br>  <b>离题（但相关）</b> <br><br> 这是一个非常类似于上面第二个示例的示例，但是没有类型推断： <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer? = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">github源代码</a> <br><br> 该程序显示为0。出于相同的原因，它的行为与第二个示例完全相同，但说明了一个单独的尽管相关的问题。 直观地， <code>Dim i as Integer? = If(False, 1, Nothing)</code>  <code>Dim i as Integer? = If(False, 1, Nothing)</code>行为与<code>Dim i As Integer? : If False Then i = 1 Else i = Nothing</code>相同<code>Dim i As Integer? : If False Then i = 1 Else i = Nothing</code>  <code>Dim i As Integer? : If False Then i = 1 Else i = Nothing</code> 。 在这种情况下，情况并非如此，因为条件表达式<code>(If)</code>不会将最终类型的信息“传递”到其操作数。 事实证明，这会破坏VB中依赖于最终（上下文）类型的所有表达式（ <code>Nothing</code> ， <code>AddressOf</code> ，文字，lambda表达式和内插字符串的数组），问题的范围通常从反编译到静默创建不正确的值，再到大声地抛出异常。 这是未编译选项的示例： <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer? = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">False</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> operation As Func(Of Integer, Integer, Integer) = <span class="hljs-keyword"><span class="hljs-keyword">If</span></span>(<span class="hljs-literal"><span class="hljs-literal">True</span></span>, AddressOf Add, AddressOf Subtract) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Add(<span class="hljs-built_in"><span class="hljs-built_in">left</span></span> As Integer, <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> As Integer) As Integer Return <span class="hljs-built_in"><span class="hljs-built_in">left</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Subtract(<span class="hljs-built_in"><span class="hljs-built_in">left</span></span> As Integer, <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> As Integer) As Integer Return <span class="hljs-built_in"><span class="hljs-built_in">left</span></span> - <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br>  <a href="">github源代码</a> <br><br> 该程序将无法编译。 相反，它在<code>If</code>表达式中报告一个错误，当两个<code>AddressOf</code>表达式都<code>AddressOf</code>打算接收<code>Func(Of Integer, Integer, Integer)</code>委托<code>Func(Of Integer, Integer, Integer)</code>时，它无法确定表达式的类型。 <br><br>     ,     <code>Nothing</code>    null (), <code>Nothing</code>    <code>nullability</code> ()  <code>If(,,)</code>       <code>Nothing</code> (  ) () —    ,    <b></b>  . <br><br><a name="section47"></a><h3> 47.       ;      </h3><br>      «3»: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> i As Integer = <span class="hljs-number"><span class="hljs-number">3</span></span> M((i)) Console.WriteLine(i) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M(<span class="hljs-keyword"><span class="hljs-keyword">ByRef</span></span> variable As Integer) variable = -variable <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>    C#  «-3».   ,   VB           — ,   <i></i> .       ,      <code>M(3)</code> ,   <code>M(i)</code> ,      <code>i</code>  ,       .  C#     (  )      ,    M   . <br><br>  <b>怎么了</b>  VB <i></i>   .          Quick Basic (Copyright 1985),     .   ,  <i>  </i>     2002 ,     . <br><br> <b> №1:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">«    »</a>  ,   Visual Basic .NET. <br> <b> №2:</b>        Roslyn ( ,  <i></i>  ( )     (  )),       :         .  C#       ,       <code>((a + b) * c  a + (b * c))</code> . ,    C#,   C++,  ,      ,    ,    .      : «         VB?»  «       C#?»      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">source.roslyn.io</a>  — <code>BoundParenthesized</code>    VB     C#.  ,   ,      . <br><br><a name="section48"></a><h3> 48. <code>Me</code>     —    </h3><br>  VB.NET      <code>Me</code> .     ,  -  ,    —    ,     Me       Structure    .        Me      .  C#    <code>this</code>  ,     <code>this</code> <i> </i>    . <br><br><a name="section49"></a><h3> 49.       </h3><br>  VB,               ,             : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> C <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> M() Extension() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Extension(c As C) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>  C#         (  something.Extension).  ,          C#,         ,   <code>this.Extension()</code> . <br><br>  <b>怎么了</b>   ,               <code>'Me.'</code> , ,         , ,         . VB.NET   .     ,      . <br><br><a name="section50"></a><h3> 50.       (Static imports will not merge method groups) </h3><br> VB   « » (Java-,   C#   VB).  ,     <code>Imports System.Console</code>     <code>WriteLine()</code>      .  2015  C#    .   VB      Shared-   ,  <code>System.Console</code>  <code>System.Diagnostics.Debug</code> ,      <code>WriteLine</code> ,    . C#       ,     ,     . <br><br>  <b>怎么了</b>  ,  ,   VB    ,  C# (   ).    ,                   (      ,  ),  …   ,          . <br><br>  ,  VB       ,  VB        , ,        ,        ,       ,        ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> #6</a> ). VB   .  , VB      2002 . <br><br><a name="section51to52"></a><h3> 51  52.         (Partial-name qualification &amp; Smart-name resolution) </h3><br>      : <br><br><ul><li>   ,    —          (    ).   <code>System</code>  <code>System.Windows.Forms</code> —  ,      ,  <code>System</code>   <code>System.Windows</code>  <code>System.Windows</code>   <code>System.Windows.Forms</code> . </li><li>   ,     ,   ,        .   <code>System</code>  <code>Windows</code> ,  <code>Windows</code>  <code>Form</code> . </li></ul><br>  ,  ,           .       .  VB    Imports   ,  <code>using</code>  C#    . <br><br> ,   VB     <code>System</code> ,          <code>System</code> ,      <code>System</code> .     ,    .      ,    <code>ExtensionAttribute</code> ,   <code>&lt;Runtime.CompilerServices.Extension&gt;</code>  <code>&lt;System.Runtime.CompilerServices.Extension&gt;</code> . <br><br>  C#   . <code>using System</code>   <code>System.Threading</code>       <code>Threading</code> . <br><br>    ,   C#          ,       .  ,     <b></b> <code>System</code> ,           <code>System.Threading</code>  <code>Threading</code> .    ,         ,      ,    ,          . <br><br>    ,  ,   VB,  C# ,          <code>Imports</code> / <code>using</code>  , C#     using    ,         ,     using        . <br><br> <b>    (Quantum Namespaces) ( )</b> <br><br>  ,    !  VB ,      .   ,  <code>System</code>    <code>ComponentModel</code>  <code>System.Windows.Forms</code>    <code>ComponentModel</code> ?  <code>ComponentModel</code>  .   ,        <code>ComponentModel.PropertyChangedEventArgs</code> ,     (  ,          ).     <code>System.Windows.Forms</code> (,  ,     ,         ,   ),        (ambiguity errors). <br><br>   VB2015      (Smart Name Resolution),      <code>System</code>  <code>System.Windows.Forms</code>   <code>ComponentModel</code> ,            ,     <code>System.ComponentModel</code>      <code>System.Windows.Forms.ComponentModel</code> ,      .           ,     ,    ,    ,      .     ,  ,     , .. <code>ComponentModel.PropertyChangedEventArgs</code>   <br> <code>System.ComponentModel.PropertyChangedEventArgs</code> ,   <code>System.Windows.Forms.ComponentModel.PropertyChangedEventArgs</code>  .     ,         . <br><br>       ,        <code>Windows</code>   ,       ( )     ( )    ( ).   <code>WinForms/WPF</code>  <code>UWP</code>        . <br><br><a name="section53"></a><h3> 53.  Add       </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  #33</a> ,  VB - ,      . ,     , —        , : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Contact <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Name As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> FavoriteFood As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> contacts = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Contact) From { {<span class="hljs-string"><span class="hljs-string">"Leo"</span></span>, <span class="hljs-string"><span class="hljs-string">"Chocolate"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Donnie"</span></span>, <span class="hljs-string"><span class="hljs-string">"Bananas"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Raph"</span></span>, <span class="hljs-string"><span class="hljs-string">"The Blood of his Enemies"</span></span>}, {<span class="hljs-string"><span class="hljs-string">"Mikey"</span></span>, <span class="hljs-string"><span class="hljs-string">"Pizza"</span></span>} } <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Add(collection As ICollection(Of Contact), name As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>, favoriteFood As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) collection.Add(<span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Contact <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Name = name, .FavoriteFood = favoriteFood}) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   GitHub</a> <br><br>  C#       ,          Roslyn C#,    .   ,      ( <b></b> ,    ),        VS2015. <br><br><a name="section54"></a><h3> 54.     ,    </h3><br>    ,      VB   <code>Dim buffer(expression) As Byte</code>  <code>Dim buffer = New Byte(expression) {}</code>     <code>expression + 1</code> . <br><br>       Microsoft BASIC,     <code>DIM</code> ( dimension — ). ,  , ,    :    0  expression.     Microsoft BASIC          1 (        ,  1984),         (   ),      2002 . <br><br>    ,     -          ,  ,    VB     ,   BASIC   C     ,    ,    C,      C- .   ,   <code>buffer(10)</code>     0  10,    9! <br><br><a name="section55"></a><h3> 55.   VB <s>- </s>    ,        C# </h3><br>            ,   .     ,    VB      ( )     ,     —    .    : <br><br><ul><li> <code>CType({1, 2, 3}, Short())</code> <b></b>  <code>CType(New Integer() {1, 2, 3}, Short ())</code> ,     <code>Integer</code>   <code>Short</code> . </li><li> <code>CType({1, 2, 3}, Short())</code>     <code>New Short() {1, 2, 3}</code> .  . </li></ul><br>      ,   ,     VB   ,        C#. ,  : <br><br><ul><li> <code>Dim empty As Integer() = {}</code> </li> </ul><br>    : <br><br><ul><li> <code>Dim array As Predicate(Of Char)() = {AddressOf Char.IsUpper, AddressOf Char.IsLower, AddressOf Char.IsWhitespace}</code> </li> </ul><br>    (  ): <br><br><ul><li> <code>Dim byteOrderMark As Byte() = {&amp;HEF, &amp;HBB, &amp;HBF} '   </code> . </li></ul><br>          ,    <code>IList(Of T)</code> , <code>IReadOnlyList(Of T)</code> , <code>ICollection(Of T)</code> , <code>IReadOnlyCollection(Of T)</code>  <code>IEnumerable(Of T)</code> ,          ,     ,    <code>ParamArray IEnumerable</code> . <br><br>  <b>怎么了</b>      ,            VB.    ,    .       2008  VB  C#         «» {},        -    ( ,  , ). ,      ,       ,          +   ,       .   . <br><br><a name="section56"></a><h3> 56.         </h3><br>      ,     LINQ.        ,    . <br><br>   ,   , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . <br><br><a name="section57"></a><h3> 57.  CType,  DirectCast        C# </h3><br>      /  VB  C#. <br> VB <code>CType</code> : <br><br><ul><li>   ; </li><li>    (   ); </li><li>   , , <code>Long</code>  <code>Integer</code> (.  «»); </li><li>  (unboxes)    ; </li><li> <b></b>    ; </li><li> <b></b>    (  <code>CTypeDynamic</code> ). </li></ul><br> VB <code>DirectCast</code> : <br><br><ul><li> <b></b>   ; </li><li>   ; </li><li> <b></b>    (   <code>Integer  Byte</code> ); </li><li>     ; </li><li>     (  ); </li><li> <b></b>   . </li></ul><br>   C# — <code>(Type)expression</code> : <br><br><ul><li>   ; </li><li>   ; </li><li>   ; </li><li>     ; </li><li>    ; </li><li>   . </li></ul><br>    <code>CType</code>      C#   ,         .   ,       .  VB  C#     ,                IL   .      <i></i>    ,   C#,          ,           .    . <br><br>  ,    <code>CType</code> ,     (,        ). <code>CType</code>   ,   <code>DirectCast</code> ,   .  ,      ,        IL   :    <code>Object</code> ( <code>ValueType</code> )       CLR «unbox»     VB-,   ,                 (,  <code>Short</code>  <code>Integer</code> ).  ,      ,   C#.           .         ,      . <br><br>  <b>怎么了</b>    .     ,   ,   ,    ,    . <br><br><a name="section58"></a><h3> 58.   «»     </h3><br>       ,       ,  <code>5 Mod 2 * 3</code>   5  VB,  «»   C# <code>5 % 2 * 3</code>   3. <br><br>   , ,      .        ,       (,   (\)  VB),    ,           ,    <b>  </b> . <b> !</b> <br><br><a name="section59"></a><h3> 59.   ; +  &amp;     ; +  VB &lt;&gt; +  C# </h3><br>     ,  + ()  &amp; ()  VB       +  C#. <br> <b> <code>String</code>   :</b> <br> <b>VB</b> <br><br><ul><li> “1” + 1 = 2.0 </li><li> “1” &amp; 1 = “11” </li></ul><br> <b>C#</b> <br><br><ul><li> «1» + 1 == «11» </li></ul><br> <b>   ,    +  &amp;</b> <br> <b>VB</b> <br><br><ul><li> “obj: “ + AppDomain.CurrentDomain ' Error: + not defined for String and AppDomain. </li><li> ”obj: “ &amp; AppDomain.CurrentDomain ' Error: &amp; not defined for String and AppDomain. </li><li> ”obj: “ + CObj(AppDomain.CurrentDomain) ' Exception, no + operator found. </li><li> ”obj: “ &amp; CObj(AppDomain.CurrentDomain) ' Exception, no &amp; operator found. </li></ul><br> <b>C#</b> <br><br><ul><li> «obj: » + AppDomain.CurrentDomain == «obj: » + AppDomain.CurrentDomain.ToString() </li><li> «obj: » + (object)AppDomain.CurrentDomain == «obj: » + AppDomain.CurrentDomain.ToString() </li><li> «obj: » + (dynamic)AppDomain.CurrentDomain == «obj: » + AppDomain.CurrentDomain.ToString() </li></ul><br> <b>  :</b> <br> <b>VB</b> <br><br><ul><li> 1 + 1 = 2 </li><li> 1 &amp; 1 = “11” </li></ul><br> <b>C#</b> <br><br><ul><li> 1 + 1 == 2 </li></ul><br> <b>  String  Enum:</b> <br> <b>VB</b> <br><br><ul><li> “Today: ” + DayOfWeek.Monday ' Exception: String «Today: » cannot be converted to Double. </li><li> “Today: ” &amp; DayOfWeek.Monday = “Today: 1” </li><li> “Today: ” &amp; DayOfWeek.Monday.ToString() = “Today: Monday” </li></ul><br> <b>C#</b> <br><br><ul><li> «Today: » + DayOfWeek.Monday == «Today: Monday» </li></ul><br> <b> :</b>    ,  +         VB,   -  . +   ,        ,   - . 怎么了  : <br><br><ul><li> “10” — “1” = 9.0, </li><li> “5” * “5” = 25.0, </li><li> “1” &lt;&lt; “3” = 8,  </li><li> “1” + 1 = 2.0,  </li><li> “1” + “1” = “11” </li></ul><br>        .   —    . <br><br> <b>:</b>   +,    <i></i>    .     ,  &amp;,      ,     ( <b></b> ,   ).  ,      ,          . <br><br><a name="section60"></a><h3> 60.   : 3 / 2 = 1,5 </h3><br>       —       : <i>«     ?»</i>  。    «».           : <i>« .      ?»</i> <br>        VB  C#. <br><br>       C, ,  ,     <i>«  5    9?»</i> ,     \.   ,  ,   ,       ,     0 (   ,   -   <code>INumeric</code> ). <br><br><a name="section61"></a><h3> 61. ^   <code>Math.Pow</code> </h3><br>        <code>Math.Pow</code> .   ,         .  ,    ( <code>custom</code> )      (  , <code>System.Numerics.BigInteger</code> ). <br><br> <b>:</b> F#        **,     VB  F#   : <code>op_Exponent</code>  <code>op_Exponentiation</code> .  F#      <code>Pow</code>   .         .  ,       . <br><br><a name="section62"></a><h3> 62.  =/&lt;&gt;    /  </h3><br>  C# '=='   ()  ,   ,      (          ).  VB        . VB    ( <code>Is/IsNot</code> )   . <br><br> <b> :</b>  -    Roslyn     ,     .         .          .   VB        ,   =   ,    C#  ,     ,       ,        . <br><br><a name="section63"></a><h3> 63.  =/&lt;&gt;    (       ) </h3><br>    VB    . <br><br> -,      (  )  - (  ),   ,        <code>Option Compare Binary</code>  <code>Option Compare Text</code> . <code>Option Compare Binary</code> , ,         VS. <br><br>          (   ),    ,    <i></i>  API.  : <br><br><ul><li> /: “A” = “a”/“A” &lt;&gt; “a” </li><li> : “A” &gt; “a” </li><li>  <code>Select Case: Select Case “A” : Case “a”</code> </li></ul><br>  : <br><br><ul><li>  <code>Equals: “A”.Equals(“a”)</code> </li><li>  <code>Contains: ”A”.Contains(“a”)</code> </li><li>   <code>Distinct: From s In {“A”, “a”} Distinct</code> </li></ul><br>    ,    ,    :   VB      .  ,    <code>Option Compare</code> ,    «Empty». <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> s As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> s = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Empty"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="">   GitHub</a> <br><br>    s = ""  VB —    <code>String.IsNullOrEmpty(s)</code> . <br>  ,          ,     ,  ,        ,  .       ,      ,       . <br><br>  <b>怎么了</b>   <code>Option Compare Text</code>    ,   ,    .   ,   ,       . <br>   ,   ,    ,  ,     . <br><br>  ,   ,     .   ,          . ,   ,    (collation)     SQL Server,      .   ,   VB      VB6,   VBA   Office,   Excel  Access,  VBScript  Windows,   -,  -…         .   ,  ,  .NET API     ,    Option Compare Text,        .    ,      .NET API,            . <br><br>   null,    ,    .  VB6    .     <code>String</code>  "".  , VB           <code>String</code>   .            VB,   <code>Left</code>  <code>Mid</code> ,   <code>String</code> .     null   .   <code>Len(CStr(Nothing)) = 0</code>  <code>Left(CStr(Nothing)</code> , <code>5) = ""</code> ,  <code>CStr(Nothing).Length</code>  <code>CStr(Nothing).Trim()</code>  . <br><br>  ,           <code>?</code>  。 (       ). <br><br> <b>  :</b> <br>      ,     ,       ,        .   !    VB   ,   ,    <code>"String A" = "String B"</code> ,     <code>Microsoft.VisualBasic.CompilerServices.Operators.CompareString</code> ,         -    ,         ,     .     LINQ-      .      ,         VB (     ).   ,        ,  -    ,    .    LINQ-to-SQL, LINQ-to-Entities   ,         Microsoft.   ,   VB    ,  ! <br><br>    ,        C#,       VB,  LINQ   .  : 1)  ,  VB   ,   ,  2)  ,  VB  ,   ,     LINQ-.   ,      VB (). <br><br> <b>:</b>  ,    «  API».   <code>Option Compare</code>           VB,   <code>InStr.Replace</code>     <code>Microsoft.VisualBasic.Strings</code> .  ,          ? <br><br> ,  ,                 ,    ? ,  ,     ,        :   ,      ,   . <br><br><a name="section64"></a><h3> 64. Nullable      ( null   ) </h3><br> VB  C# -  nullable.  ,     (null-propagation). <br><br>      SQL, , ,      null.   ,      (, +),         null,      null.    <code>"?."</code> :    <code>obj?.Property obj</code>  null,       null,   . <br><br>   nullable       ,  VB,  C#  .     -   :  . <br><br>  VB,     nullable  ,      null,     null   .   1 + null  null  null + null  null.        ,      (, =  &lt;&gt;)      C#: <br><br><ul><li>    VB,  <code>Is/IsNot</code> ,  <code>Boolean?</code> </li><li>    C# (==, !=, &gt;, &lt;, &gt;=, &lt;=)  <code>bool</code>  <code>bool?</code> </li></ul><br>  VB (    nullable  )  null     <b> null</b> .     <code>Boolean</code>  =  <code>Boolean?</code> ,     <code>True</code> , <code>False</code>  <code>null</code> .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> .  C#    <code>non-nullable bool</code> ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . <br><br>  ,    <b></b> .      null.    VB <b>NULL</b> = <b>NULL</b> —  <b>NULL</b> ,   TRUE. <br> ,      : <br><img src="https://habrastorage.org/webt/rv/79/03/rv7903incqlt1soaqgm9dnxravg.png"><br>    . <b>Null  ,   ,    ,      <u></u>    C#</b> . <br><br>     .   C#   VB,      <i>«    null?»</i>  C# <code>(if (value == null))</code>    .  VB   ,   VB        (=/&lt;&gt;)     <code>(Is/IsNot)</code> ,         VB <code>Is Nothing</code>   <code>non-nullable Boolean</code> . <br><br>      ,    VB    null,     null.     <code>And/AndAlso</code>  <code>Or/OrElse</code> . <br><br>     <code>Integer?</code> (  ),  VB,  C#  null,    : <br><br><ul><li> 1 AND NULL  NULL </li><li> 1 OR NULL  NULL </li></ul><br>     <code>Boolean?</code> ,  VB  . <br><br><ul><li> FALSE AND NULL  FALSE </li><li> TRUE OR NULL  TRUE </li><li> TRUE AND NULL  NULL </li><li> FALSE OR NULL  NULL </li></ul><br>  , <b>  <code>True/False</code>        ,    , <u></u>     null.</b>   ,      <code>AndAlso</code>  <code>OrElse</code>   . <br><br>  C#         (&amp;&amp;/||)   (&amp;/|)   <code>nullable boolean (bool?)</code> .    ,    ,       non-nullable boolean   nullable boolean         . <br><br> <b>   ?</b> <br>   VB  ,  -   : <br><br><pre> <code class="vbscript hljs">Imports System.ComponentModel <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> BindableRange Implements INotifyPropertyChanged <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> _EndDate As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>? <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> EndDate As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>? <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> Return _EndDate <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>(value As <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>?) <span class="hljs-comment"><span class="hljs-comment">' This line here: If value = _EndDate Then Return _EndDate = value RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(NameOf(EndDate))) End Set End Property Public Event PropertyChanged As PropertyChangedEventHandler _ Implements INotifyPropertyChanged.PropertyChanged End Class Module Program WithEvents Range As New BindableRange Sub Main() Range.EndDate = Today Range.EndDate = Today Range.EndDate = Nothing Range.EndDate = Nothing End Sub Private Sub BindableRange_PropertyChanged(sender As Object, e As PropertyChangedEventArgs) _ Handles Range.PropertyChanged Console.WriteLine(e.PropertyName &amp; " changed.") End Sub End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   GitHub</a> <br><br> , , , ,     «EndDate change»    . ,  ,  <b> VB null    </b> ?      ,    <code>EndDate</code> ,       ,      ,      <code>Nothing</code> . <br><br>     VB  : <i>«,  ,   .   »</i> : <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value &lt;&gt; _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> _EndDate = value RaiseEvent PropertyChanged(<span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> PropertyChangedEventArgs(NameOf(EndDate))) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span></code> </pre> <br> <b>    !</b>           .     ,     <b>  non-nullable   </b> .     , <b>   </b> .   ,   : <br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> AndAlso _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> value &lt;&gt; _EndDate <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return</code> </pre> <br> <b>     ?</b> <br>  ,   C#      ,         VB.     (  nullable  ,    ),         ,    null. <br><br>      null —  <b>  «»  « »</b> .         . <br><br>     <b>null  « »  «»</b> .   ,     ,    :          comparer,   ,    comparer  .        Roslyn,         <code>Optional(Of T)</code> ,         ,        ,     null,  ,     . <br><br>      , NULL  « »,      VB  : <br><br><ul><li>    , <b>« ,   ?»</b>     «  ». </li><li> : <i>«       ,      ?»</i> «  ». </li></ul><br> , ,    <b>     SQL- </b> .  ,     NULL  SQL   ,     NULL.        . ,     ,   NULL    .   ,       .     ,      ,   ( ).   ,       ,          ,     ,   ,   NULL   ,     SQL ( ). <br><br>     VB. <b>      nullable    2008 ,   VB      ?</b> <br> LINQ to SQL <br><br>  VB     ,  , ,   ,  ,    ,     LINQ-     .     ! <br><br>   .  SQL Server,   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SET ANSI_NULLS OFF</a> ,   SQL-      C#,      <code>WHERE Column = NULL</code> . , ,        OFF (       ).       SQL Server (  )  .  : <i>«    ?   .    ,      -  Option ANSI_NULLS Off  VB.NET?»</i>  。         : <br><br><img src="https://habrastorage.org/webt/-q/hc/zl/-qhczlj3yptkha7zt5oz5_4mfi0.png"><br><br> ,      ,     ,    ,   ,  SQL Server,     VB. <br> 这样的东西。 <br><br><a name="section65"></a><h3> 65.      1:1 </h3><br>  ,  VB    ,       , ,    .       VB  -   ,    . <br><br> ,  ,        , ,          .    VB    ,    ,      ,    ,    , VB     . <br><br>  9.8.4      . <br><br><a name="section66"></a><h3> 66. Function() a = b   () =&gt; a = b </h3><br>        .    ,   <code>() =&gt; expression</code>  C#    <code>Function() expression</code>  VB.   <code>Function()</code>    -,  - ,       VB.       <code>a = b</code>    ,   <code>a</code>  <code>b</code> ( <code>Boolean</code> ),    <code>b</code>  <code></code> .  -   (delegate relaxation) VB       ( -)   Sub- (   ).         .   <code>() =&gt; a = b</code>  C#  VB —  <code>Sub() a = b</code> .   —  - <b></b> ,             . <br><br>    =,   ,   .    (  <code>Sub</code> -)   ,    (  <code>Function</code> -)   . <br><br><a name="section67"></a><h3> 67.  <code>Async Function</code>       <code>async void</code> </h3><br>  C#   <code>async</code> -,     ,  ,    <code>Task</code>  <code>void</code> ,        ,  <code>Task</code> ,   . <br><br>  VB.NET   , ..  <code>void Async</code>    <code>Async Sub</code> ,   <code>Task</code>  <code>Task(Of T)</code> —   <code>Async Function</code> .   ,   ,     VB,   (relaxing) <code>Task Async</code>   <code>void</code>        .   <b></b>     <code>Async Sub</code> ,       ,    . <br><br><a name="section68"></a><h3> 68.   ()  VB </h3><br>     ,      VB: <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo <span class="hljs-comment"><span class="hljs-comment">'Function [Select](Of T)(selector As Func(Of String, T)) As Foo ' Return Me 'End Function Function Where(predicate As Func(Of String, Boolean)) As Integer Return 0 End Function End Class Module Program Sub Main() Dim c As New Foo Dim q = From x In c Where True Select x End Sub End Module</span></span></code> </pre> <br> <a href="">   GitHub</a> <br><br>         VB,  <i></i>  C#. -,  <code>Foo</code>    <code>Select</code> ,         ,          <code>Where</code> .      <code>Select</code> ,    ,      <code>Select</code> ,   <code>Integer</code>      .   C#     ,        <code>.Where</code> ( <code>Select</code> ).        ,    ,   . <br><br>            LINQ  API.  ,     VB  C#, .  ,  C#   ,      « »,  ,              ,       ,   .  -   ,   «»  ,     ,      -. <br><br>   ,  VB    <b></b>        ,        ,  C#          ,     . <br><br>  ,      Roslyn, : <b>«    (range variables)?»  «     ?»</b>  。        . ,  VB      ,     <code>Let</code> ,   C# — .      ,         VB,    C# 2012   ,   : <br><br><pre> <code class="vbscript hljs">using System; using System.Collections.Generic; using System.Linq; using System.Text; namespace CSharpExamples { struct Point { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> X { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { return <span class="hljs-number"><span class="hljs-number">0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> Y { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { return <span class="hljs-number"><span class="hljs-number">0</span></span>; } } } <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Foo { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IEnumerable&lt;Point&gt; <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span>&lt;T&gt;(Func&lt;<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>, T&gt; selector) { return <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Point[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } } static <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Program { static void Main(<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>[] args) { var c = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Foo(); var q = from X <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> Y = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> Y.CompareTo(<span class="hljs-number"><span class="hljs-number">-1</span></span>); } } }</code> </pre> <br> <a href="">   GitHub</a> <br><br>  ,    — ?    X,   — <code>string</code> .   <code>let</code>     <code>Y</code> ,     string.         ,      Point,     <code>X</code>  <code>Y</code>    ,     ,     <code>int</code>      <code>X</code>  <code>Y</code> , «»  .        <code>Y</code>   <code>select</code> ,    <code>int</code>   <code>int</code> `,  … . <br><br>      ,   <i>«        ?»</i>  。  VS2015  C#  ,   «».   ,  Roslyn         C#,       .          ,          (  ,   ),    -  . <br><br>  <b>怎么了</b>                     ,    ,    ,      .   ,         ,   VB  C#          . <br><br><a name="section69to70"></a><h3> 69  70.  <code>As</code>   <code>From</code>    <code>cast</code> ;     <code>'As'</code>      </h3><br> (     , …) <br><br>    <code>From x As Integer In y</code>  VB,      ,   <code>from int x in y</code>  C#. <br><br> -,  C#     ,    ( )  .    <code>.Cast&lt;T&gt;()</code> .  VB      ,    ,  ,       ,   . <br><br> -,    ,      <code>.Cast</code> (   ).      ,      ,       ,       <code>.Cast</code>  <code>.Select</code> . <br><br>  <b>怎么了</b>  .   VB  . ,    <code>For Each x As T In collection</code> ,  <code>As T</code>          .      <code>From</code>   <code>As</code>    <code>For Each</code> ( ,    <code>As</code> ). <br><br><a name="section71to75"></a><h3> 71-75.  <code>Select</code>   ,     ,                </h3><br> 例如： <br><br><ul><li> <code>From x In y Where x &gt; 10</code> .   ,  <code>Select</code> . </li><li> <code>From x In y Select x Where x &gt; 10</code>  . </li><li> <code>From x In y Select x</code>      ,   <code>From x In y Select x = x</code> ,  <code>x</code>  —       <code>x</code> ,  <code>x</code>  —       <code>Select</code> .  <code>Select</code>  <code></code>    . </li><li> <code>From x In y Select z = x.ToString()</code> ,  <code>x</code>  . </li><li> <code>From x In y Select x.FirstName</code>      ,   <code>From x In y Select FirstName = x.FirstName</code> . </li><li> <code>From x In y Select x.FirstName, x.LastName</code> —   <code>From x In y Select New With {x.FirstName, y.LastName}</code> ,   ,       .               <code>IEnumerable(Of $AnonymousType$)</code> ,         . </li></ul><br>  <b>怎么了</b>    ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Amanda Silver</a> ).    ! <br><br><ul><li>  ,  <code>Select</code>    ,      SQL  ,  <code>Select</code>   ,       .      LINQ  VB       Select ,   SQL,        From   . </li><li>  ,     ,      . </li><li>  ,     <code>Select</code>   ,        SQL,       - -        .   VB     comma separated ( )  -. </li><li>  ,  <code>Select</code>   ,       ,     ,    ,  ,     ,          ,         —   . </li></ul><br> <b>   ?</b>  ,   ,  - ,         ,  : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> numbers = {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>} <span class="hljs-comment"><span class="hljs-comment">' BC36606: Range variable name cannot match the name of a member of the 'Object' class. Dim q = From n In numbers Select n.ToString() End Sub End Module</span></span></code> </pre> <br> <a href="">   GitHub</a> <br><br> <code>BC36606: Range variable name cannot match the name of a member of the 'Object' class</code>  <code>BC30978: Range variable '…' hides a variable in an enclosing block or a range variable previously defined in the query expression</code> —             ,     <code>Object</code> ,        ,   ,     ,   .       ( <code>n.ToString()</code> ),      .   ,            . <br><br><a name="section76"></a><h3> 76+.       </h3><br>        . …  … . …  20-25     ( <i>       — ..</i> ). <br><br><blockquote> 分钟的广告。 15-16   -    .NET- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN445580/">https://habr.com/ru/post/zh-CN445580/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN445562/index.html">彭博社：麦当劳将以3亿美元收购个性化技术菜单开发商</a></li>
<li><a href="../zh-CN445566/index.html">俄罗斯数字档案法案发布</a></li>
<li><a href="../zh-CN445568/index.html">通过端口80远程监视和管理基于Linux / OpenWrt / Lede的设备...</a></li>
<li><a href="../zh-CN445570/index.html">IT领域HR专业人士的事件摘要，2019年4月</a></li>
<li><a href="../zh-CN445572/index.html">美国政府计划在5年内将人们送上月球</a></li>
<li><a href="../zh-CN445582/index.html">CRM系统：保护还是威胁？</a></li>
<li><a href="../zh-CN445584/index.html">OS1：Rust for x86上的原始内核。 第2部分。VGA，GDT，IDT</a></li>
<li><a href="../zh-CN445586/index.html">莫斯科的Android Academy-谈论它的状态并分享课程资料</a></li>
<li><a href="../zh-CN445588/index.html">展览中将展示30秒内人物的3D扫描</a></li>
<li><a href="../zh-CN445590/index.html">英语语法。 谁与 谁-如何理解使用哪个词</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>