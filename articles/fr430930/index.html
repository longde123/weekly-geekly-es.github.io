<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìØ üê≥ ‚úàÔ∏è √Ä propos des graphiques 3D en mots simples üìÖ üçá üí≥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Partie 1. Introduction 
 Salut mon nom est chauve. Je travaille en tant que programmeur graphique depuis plusieurs ann√©es, donc bien que je ne sois en...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√Ä propos des graphiques 3D en mots simples</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430930/"><h2>  Partie 1. Introduction </h2><br>  Salut mon nom est chauve.  Je travaille en tant que programmeur graphique depuis plusieurs ann√©es, donc bien que je ne sois en aucun cas un expert, il semble que je comprenne d√©j√† beaucoup de choses sur tout ce qui concerne le travail avec les graphiques. <br><br>  L'id√©e de cette s√©rie de messages plane depuis longtemps √† la p√©riph√©rie de mon esprit, et refait surface apr√®s avoir lu un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article int√©ressant avec une analyse du dernier Deus Ex</a> . <br><br>  Il me semble que le graphisme, et surtout la complexit√© qu'il apporte dans les jeux modernes, est un sujet int√©ressant.  Tr√®s peu de gens sont curieux de se plonger profond√©ment dans tous ses d√©tails, mais je crois qu'il y a des sujets qui int√©ressent tout le monde.  Je pense que la plupart des gens qui ont jou√© √† des jeux √©taient curieux de savoir comment ces effets ont √©t√© obtenus, ou avec quelle technologie ils ont r√©ussi √† cr√©er des graphismes incroyables dans un nouveau jeu. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4c8/3b9/2ad/4c83b92ad325af58966fc3742aa85a10.jpg"></div><br>  <em>De nombreux composants sont n√©cessaires pour cr√©er m√™me un jeu 3D simple, sans parler d'un projet comme Watch Dogs.</em> <br><br>  Je n'ai qu'une id√©e g√©n√©rale de ce qui doit √™tre pris en compte dans cet article, mais cela d√©pendra des sujets qui susciteront l'int√©r√™t.  Cependant, l'id√©e principale est de cr√©er une description g√©n√©rale de ce qui se passe √† l'int√©rieur du jeu moderne sans effrayer aucun des lecteurs - je suppose que vous n'avez pas de connaissances en math√©matiques et en programmation.  Si vous connaissez la diff√©rence entre le CPU et la carte graphique, et que vous distinguez la RAM du disque dur, ce sera suffisant, et je vous expliquerai le reste. <br><a name="habracut"></a><br>  Cet article sera d√©velopp√© conform√©ment √† sa vid√©o pas √† pas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Chip &amp; Ironicus's Let's Play of Watch Dogs</a> , afin de structurer l√©g√®rement la pr√©sentation.  Le jeu est bien connu pour ses graphismes (et les opinions √† ce sujet peuvent √™tre compl√®tement oppos√©es), et il y a de nombreux aspects qui peuvent √™tre consid√©r√©s avec des exemples s√©par√©s.  Je parlerai peut-√™tre d'autres jeux. <br><br>  Je commencerai par expliquer les bases qui sont √† peu pr√®s les m√™mes pour chaque jeu, mais je vais √©galement examiner certaines des techniques et des effets visuels de Watch Dogs. <br><br>  J'utiliserai un outil appel√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RenderDoc</a> , que j'ai √©crit pendant mon temps libre.  Il est utilis√© pour d√©boguer les probl√®mes graphiques - l'outil vous permet de d√©composer un cadre graphique en parties, et gr√¢ce √† cela, nous verrons comment il se r√©unit. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//OBaA9JD/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Cette animation montre une partie d'un cadre qui est progressivement cr√©√© en cours de rendu avec une carte graphique.</em> <br><br>  La plupart des gens savent que l'infographie (et les graphiques de toute autre vid√©o) se compose d'une s√©rie d'images fixes, chacune √©tant affich√©e pendant une certaine fraction de seconde.  Au cin√©ma, traditionnellement utilis√© 24 images par seconde (images par seconde, FPS), en t√©l√©vision la fr√©quence est √† peu pr√®s la m√™me, environ 24-30 images.  Dans les jeux, le FPS peut √™tre modifiable car beaucoup de travail est effectu√© dans chaque image.  Une chute de fr√©quence en dessous de 30 n'est pas souhaitable, bien qu'elle se produise assez souvent.  Habituellement, la limite sup√©rieure pour les jeux sur console est de 60 FPS.  Les d√©veloppeurs cherchent √† impl√©menter une fr√©quence de 30 ou 60, qui d√©pend des objectifs du jeu.  Sur un PC, avec un affichage avec une fr√©quence d'images √©lev√©e, vous pouvez atteindre 90, 120 ou m√™me plus.  La raison de ces nombres sp√©cifiques est la synchronisation verticale (vsync), dont nous discuterons ci-dessous. <br><br>  Mentalement, nous pouvons regarder cette t√¢che du c√¥t√© oppos√© - au lieu de regarder √† quel <em>point la</em> fr√©quence FPS est √©lev√©e, nous regardons le <em>peu de</em> temps allou√© pour chaque trame.  Si nous voulons que le jeu fonctionne avec une fr√©quence de 30 FPS, alors nous n'avons que 33 millisecondes pour terminer tout le travail n√©cessaire au cadre.  √Ä 60 FPS, le temps est deux fois moins √©lev√© - environ 17 millisecondes.  M√™me pour un ordinateur, cette p√©riode n'est pas tr√®s longue, compte tenu de la quantit√© de travail √† faire.  Pour vous donner une id√©e des quantit√©s, alors, selon des estimations approximatives, la balle se d√©place d'environ 1 m√®tre par milliseconde. <br><br>  Nous parlerons principalement des PC car cette plateforme est ouverte, et je ne peux pas parler de consoles sans craindre de violer les accords de non-divulgation (NDA).  Quoi qu'il en soit, je parlerai essentiellement de ce qui n'est pas tr√®s diff√©rent sur les consoles, mais si quelque chose diff√®re encore, je le soulignerai.  Pour les plates-formes mobiles, la plupart des diff√©rences entre le mat√©riel / consoles PC et le mat√©riel mobile ne sont pas pertinentes pour le sujet de mon article. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d8a/414/db8/d8a414db8e56c45fae566b8da11316e2.jpg"></div><br>  <em>Honn√™tement, j'ai mis cette photo ici pour que vous compreniez que l'article n'aura pas seulement du texte.</em> <br><br>  C'est cette t√¢che qui nous int√©resse - nous ne nous soucierons pas de la fa√ßon dont tous ses calculs d'IA sont effectu√©s, ni de la fa√ßon dont la simulation physique est effectu√©e pour d√©placer des objets.  Les limites de la discipline appel√©e ¬´programmation graphique¬ª sont assez floues, mais je dirai que la programmation graphique commence lorsque nous avons toutes les informations n√©cessaires pour construire un cadre: nous savons ce qui se passe, toutes les textures et mod√®les sont en m√©moire (pas sur disque) ), les animations sont d√©j√† anim√©es, la physique est compt√©e, et il suffit de dessiner un cadre fini pour l'afficher √† l'√©cran. <br><br>  J'ajoute que je consid√©rerai un jeu 3D avec un rendu assez traditionnel, comme Watch Dogs - de nombreux principes de base s'appliquent aux jeux 2D, mais il est un peu plus difficile de d√©montrer des concepts sur eux.  Je vais √©galement expliquer (en particulier aux programmeurs graphiques) que je m'efforce principalement de comprendre, donc, peut-√™tre, j'utiliserai des explications plut√¥t douteuses si elles me permettent d'atteindre mon objectif. <br><br><h2>  Partie 2. En quoi consiste le cadre </h2><br>  La plupart du temps, nous examinerons un seul cadre et parlerons des blocs de construction que le jeu utilise pour cr√©er un cadre fini.  Aussi dans cette partie, il y aura plusieurs nouvelles belles photos. <br><br>  Il existe plusieurs fa√ßons d'assembler un cadre √† partir de blocs de construction.  L'image finie que le joueur voit n'est pas rendue instantan√©ment.  Il a √©t√© dessin√© tout de suite il y a de nombreuses ann√©es, mais les moteurs graphiques modernes utilisent presque toujours une sorte de pr√©traitement.  Avant d'afficher le cadre fini √† l'√©cran, le moteur graphique dessine de nombreuses images interm√©diaires de diff√©rents types qui aident √† calculer l'image finale. <br><br>  Ces images d√©pendent fortement du type de moteur et des techniques que le programmeur graphique doit appliquer.  Par exemple, s'il veut que la lumi√®re du soleil cr√©e les ombres correctes, alors un type d'image sera n√©cessaire pour les ombres.  Il peut √©galement avoir besoin des reflets corrects sur la voiture conduite par le joueur, et pour cela aussi, il a besoin d'une autre image avec des reflets. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/874/47d/95e/87447d95ee62161dc63df6e3dd2406f5.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a3b/9ec/b69/a3b9ecb6984a5aae18fd57d8c2f4a9f2.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1e6/bd2/ff7/1e6bd2ff7c49373dc337d20c0fe2a66a.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fa4/5cb/65d/fa45cb65dfcb2042ecfd06ef6c463022.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3d9/4ed/937/3d94ed937c68dd821ab21c4a1a1cf4fb.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a57/360/2e8/a573602e8f7b69fa3868df93eebc776f.jpg"></div><br>  <em>Divers exemples d'images interm√©diaires utilis√©es dans la construction du cadre Watch Dogs.</em> <br><br>  Dans cet article, je ne consid√©rerai pas chacune des images utilis√©es dans le cadre Watch Dogs, mais uniquement les images de base, afin que vous puissiez apprendre quelque chose.  Il s'agit d'un domaine dans lequel la recherche graphique est constamment en cours et de nouvelles techniques √©mergent.  Les innovations surviennent √©galement √† des niveaux plus petits, mais lorsque le marketing vous parle de nouvelles fonctions graphiques, il fait g√©n√©ralement r√©f√©rence √† de telles am√©liorations. <br><br><hr><br>  Chacune de ces images interm√©diaires est √©galement construite √† partir de fragments encore plus petits.  Chaque objet de la sc√®ne ou un groupe d'objets associ√©s est cr√©√© s√©par√©ment en tant que <em>mod√®le textur√©</em> .  Lors du d√©veloppement d'un jeu, les artistes construisent ces mod√®les dans un √©diteur 3D et cr√©ent toutes les ressources n√©cessaires pour eux.  Ces mod√®les sont ensuite plac√©s dans le monde √† l'aide de l'√©diteur de niveau et une ville virtuelle est progressivement construite √† partir d'eux. <br><br>  Probablement, presque tout le monde le sait, et si vous avez regard√© le d√©veloppement de graphiques 3D en temps r√©el au cours des 20 derni√®res ann√©es, vous savez √† quel point les mod√®les sont devenus plus complexes aujourd'hui.  Aux toutes premi√®res √©tapes de la formation des graphiques, la cartographie des textures √©tait un processus co√ªteux et, si possible, elle √©tait √©limin√©e en peignant des objets de la m√™me couleur.  Les textures ont √©t√© laiss√©es uniquement aux √©l√©ments tels que les yeux ou les visages qui avaient vraiment besoin de d√©tails. <br><br>  Le mod√®le 3D est enti√®rement constitu√© de triangles interconnect√©s qui forment la forme de l'objet.  Chaque triangle a trois points appel√©s sommets, et puisque les triangles sont connect√©s les uns aux autres, les sommets peuvent √™tre partag√©s par plusieurs triangles.  Nous y reviendrons plus tard car les sommets et triangles sont suffisamment importants.  Il convient √©galement de rappeler que certains objets, par exemple des personnages ou des arbres, doivent √™tre anim√©s avant le rendu.  Le mod√®le est cr√©√© sous une forme statique standard et des animations sont appliqu√©es dans chaque image.  Nous y reviendrons √©galement. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/357/03d/382/35703d382d727d1e395283a4fb3aae33.jpg"></div><br>  <em>Il s'agit d'un mod√®le 3D de la t√™te d'Aiden Pierce apr√®s animation.</em>  <em>Les triangles sont visibles car ils sont dessin√©s √† plat et non liss√©s, comme c'est g√©n√©ralement le cas.</em> <br><br>  Pour ajouter plus de d√©tails au mod√®le 3D, les textures sont superpos√©es.  Les textures sont des fichiers d'image plats r√©guliers, g√©n√©ralement carr√©s ou de taille simple, tels que des rectangles avec un rapport de 2: 1.  Les textures sont superpos√©es au mod√®le 3D √† l'aide d'un processus plus complexe, dont je parlerai plus en d√©tail ci-dessous, mais conceptuellement, il est similaire au processus d'emballage d'un cadeau.  Au lieu d'un simple motif r√©p√©titif de papier d'emballage, l'image correspond exactement √† la taille de l'emballage.  Si vous avez vu des mod√®les en papier √† assembler avec de la colle, le principe est le m√™me. <br><br>  Cette analogie est plus appropri√©e que vous ne le pensez, car ces textures sont g√©n√©ralement cr√©√©es en ¬´d√©roulant¬ª un mod√®le 3D dans un flan plat, comme cela se fait avec un mod√®le en papier, apr√®s quoi une texture est dessin√©e par-dessus.  Ce d√©ploiement est souvent effectu√© automatiquement, mais dans le cas d'objets particuli√®rement complexes, il peut √™tre effectu√© manuellement. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b9f/1f7/cf0/b9f1f7cf0d34680c8f313ad11691656f.jpg"></div><br>  <em>Il s'agit de la texture correspondant au mod√®le de t√™te Aiden Pierce illustr√© ci-dessus.</em>  <em>Il y a des parties pour les dents et la langue.</em>  <em>Notez que la zone au-dessus de son front n'est pas textur√©e car elle est recouverte en permanence par la casquette de baseball l√©gendaire Aiden Pearce ‚Ñ¢.</em> <br><br><blockquote><h4>  Remarque </h4><br>  Lors du d√©pliage, certaines parties de l'objet qui n√©cessitent plus de d√©tails augmentent, tandis que d'autres diminuent. </blockquote><br>  Tr√®s souvent, ils parlent de diff√©rents "skins" de mod√®les, en particulier dans le cas de personnages personnalisables.  Aujourd'hui, ce qu'on appelle une ¬´peau¬ª fait g√©n√©ralement r√©f√©rence √† de petits changements dans le mod√®le - une nouvelle ceinture ou un chapeau diff√©rent - mais initialement ce terme est n√© parce que le m√™me mod√®le a √©t√© utilis√©, mais la texture a chang√© (ou ¬´peau¬ª - se traduit litt√©ralement par "Skin") pour cr√©er un personnage qui a l'air diff√©rent.  M√™me aujourd'hui, avec l'aide de telles textures, vous pouvez cr√©er une grande variabilit√© des PNJ ou des objets, ce qui √©conomise du temps et de l'argent - vous n'avez pas besoin de cr√©er de nombreux mod√®les 3D uniques.  Les diff√©rents v√™tements que Aiden peut porter ne sont souvent que des textures diff√©rentes du m√™me mod√®le. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//8ItIFRj/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Voici un bref extrait de la rotation de la t√™te 3D.</em>  <em>Surimpression seule texture, et rien de plus.</em> <br><br>  Dans le cadre que nous consid√©rons, il y a environ 1700 objets rendus dans la partie de rendu principale.  Certains d'entre eux seront les m√™mes mod√®les - des objets tels que des fleurs dans des pots et des poubelles ne sont jamais r√©ellement cr√©√©s s√©par√©ment, c'est un mod√®le ou plusieurs mod√®les plac√©s √† diff√©rents endroits.  Cependant, la quantit√© approximative d'objets dessin√©s pour compl√©ter le cadre est proche de <strong>4700</strong> - cela nous donne une id√©e du travail suppl√©mentaire √† effectuer en plus du rendu de tous ces mod√®les. <br><br>  Regardons un autre exemple d'un objet - une casquette de baseball port√©e par Aiden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/aa2/1ce/636/aa21ce63666b4636b76ebe062f7536ca.jpg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0f7/4d3/b93/0f74d3b9305c6ed4572a5bc55d178a11.jpg"></div><br>  <em>Il s'agit d'un mod√®le de casquette de baseball textur√© et textur√©.</em>  <em>On peut voir que la texture est constitu√©e de parties distinctes qui sont connect√©es au mod√®le.</em> <br><br><blockquote><h4>  Remarque </h4><br>  La visi√®re et la partie principale de la casquette de baseball sur la texture ne se touchent pas, car le scan peut √™tre assez compliqu√© et, si n√©cessaire, peut √™tre effectu√© en plusieurs parties diff√©rentes.  Parfois, texturer un mod√®le de forme complexe sans probl√®mes et coutures visibles n√©cessite une bonne quantit√© de comp√©tences. </blockquote><br>  Les m√™mes principes que nous avons vus avec la t√™te d'Aiden s'appliquent √† la casquette.  En fait, si nous ignorons la texture et les nombres sp√©cifiques n√©cessaires pour effectuer le d√©ballage, le principe est toujours le m√™me. <br><br>  Pour montrer ce qui peut mal se passer pendant le d√©veloppement et pour montrer comment vous pouvez vous amuser lors de la programmation graphique, nous pouvons effectuer une petite exp√©rience.  √âtant donn√© que la plupart des textures ont une taille carr√©e standard et que la m√©thode d'emballage et de d√©pliage des textures sur le mod√®le est √©galement la m√™me, pourquoi ne pas jouer avec elles un peu?  Que se passe-t-il si nous appliquons la texture de la t√™te d'Aiden √† un mod√®le de casquette de baseball? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/212/1b1/5c7/2121b15c7f8355575864f9333c9eeab0.jpg"></div><br>  <em>D√©j√† pas tr√®s similaire √† la casquette de baseball l√©gendaire Aiden Pierce.</em> <br><br>  L√† o√π il y avait un logo sur la texture de la casquette de baseball, l'oreille et les dents sont situ√©es sur la texture de la t√™te.  L√† o√π il y avait une visi√®re, il n'y avait que des cheveux sur la texture de la t√™te.  La superposition est exactement la m√™me, mais une texture diff√©rente est utilis√©e.  Bien s√ªr, cet exemple sera une erreur dans le jeu, mais pensez √† ce qui peut √™tre fait si vous animez la texture ou la faites scintiller - dans les jeux, ces choses sont utilis√©es pour divers effets que vous pouvez maintenant remarquer.  En particulier, le jeu Saint's Row 4 utilise des effets similaires similaires pour la "simulation". <br><br>  Il sera √©galement utile de r√©fl√©chir aux cons√©quences de cela - les jeux combinent tr√®s soigneusement des paires de mod√®les et de textures, c'est-√†-dire que les mod√®les les plus uniques doivent correspondre √† leurs propres textures uniques. <br><br>  Bien s√ªr, cette r√®gle n'est pas absolue - dans certains cas, pour √©conomiser de l'espace, la texture est un motif r√©p√©titif standard qui peut √™tre utilis√© pour de nombreux objets.  Les ensembles d'objets li√©s - par exemple, les marchands de journaux - peuvent utiliser la m√™me texture pour diff√©rents journaux, chaque journal occupant une petite fraction de la texture. <br><br>  N√©anmoins, cela signifie que pour construire l'image finale, tous les blocs de construction doivent √™tre pr√©sents, c'est-√†-dire que de nombreux mod√®les et textures requis peuvent √™tre obtenus.  Dans la partie suivante, nous expliquerons pourquoi certains aspects, tels que la r√©flexion, sont tr√®s difficiles √† mettre en ≈ìuvre correctement.  Je parlerai √©galement de la fa√ßon dont les jeux utilisent de petites astuces pour gagner du temps et des ressources. <br><br><h2>  Partie 3. Ce que vous n'avez pas besoin de dessiner </h2><br>  Souvent, la programmation graphique consiste √† √©quilibrer une douzaine de contraintes diff√©rentes pour obtenir le compromis parfait.  Dans la derni√®re partie, nous avons vu que chaque fois qu'une sc√®ne est dessin√©e, elle est assembl√©e √† partir de nombreux petits blocs de construction - personnes, voitures, panneaux de signalisation, b√¢timents.  Tout ce qui est √† l'√©cran est compos√© de composants individuels qui doivent √™tre dessin√©s.  Il y a plusieurs op√©rations d'√©quilibrage subtiles dont nous discuterons ici. <br><br>  Le processeur central et la carte graphique fonctionnent ensemble pour rendre le cadre.  Le reste du jeu est ex√©cut√© dans le CPU, il d√©cide donc quels objets doivent √™tre dessin√©s dans l'image actuelle, o√π la cam√©ra regarde et quelles animations sont jou√©es.  Une carte graphique est un ¬´cheval de bataille¬ª qui effectue tout le travail complexe impliqu√© dans le rendu des pixels, c'est pourquoi il s'agit d'un appareil sp√©cialis√© distinct. <br><br>  Il s'av√®re que le CPU et la carte graphique ont des limitations sur la vitesse ou la quantit√© de calculs, mais ce sont diff√©rents types de restrictions. <br><br>  En g√©n√©ral, le CPU s'int√©resse davantage √† sa propre partie du travail: combien d'objets devons-nous dessiner au total?  Quelle est la <i>diff√©rence entre</i> ces objets - est-ce 100 lumi√®res identiques ou 100 buissons / plantes / arbres?  Ces objets sont-ils anim√©s, se d√©placent-ils dynamiquement et lesquels sont statiques ou immobiles? <br><br>  La premi√®re chose que nous faisons pour r√©duire la charge autant que possible est de ne dessiner que ce qui est visible √† l'√©cran.  Cela semble √©vident, mais la mise en ≈ìuvre n√©cessite un travail minutieux.  N'oubliez pas que nous construisons chaque cadre √† partir de z√©ro, donc <i>dans chaque cadre,</i> nous devons regarder chaque objet et d√©terminer s'il est visible ou non.  Cela signifie que dans chaque jeu, il y a un vide noir partout suivant le joueur, et quand il ne regarde pas les objets et les personnes, ils cessent d'exister. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//bmSqTLe/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Dans cette animation, nous faisons tourner la cam√©ra, montrant le vide derri√®re le joueur.</em>  <em>Les t√©l√©spectateurs attentifs remarqueront qu'il n'est pas compl√®tement vide ...</em> <br><br>  Il est difficile de d√©velopper des r√®gles pratiques dans ce cas, mais en g√©n√©ral, vous pouvez dessiner environ 1000 objets dans la sc√®ne sans vous soucier du manque d'espace.  Cependant, si vous avez besoin de restituer 5 000 objets, pensez √† utiliser des astuces.  N'oubliez pas que dans la plupart des jeux o√π le joueur peut contr√¥ler la cam√©ra, nous ne pouvons pas savoir sous quel angle il se penchera, vous devez donc √©conomiser de l'espace pour man≈ìuvrer. <br><br>  Il s'av√®re qu'il existe de nombreuses astuces qui vous permettent d'utiliser presque compl√®tement une ressource valide, et elles sont particuli√®rement importantes dans des jeux comme Watch Dogs.  Plus vous vous rapprochez des fronti√®res et plus vous pouvez obtenir de qualit√© visuelle √† partir du m√™me nombre d'objets, meilleur sera le jeu. <br><br>  M√™me si vous regardez ce qui se trouve devant vous dans la sc√®ne, cela ne signifie pas qu'il est n√©cessaire de dessiner toute la ville.  S'il y a un √©norme b√¢timent √† gauche ou √† droite, tout ce qui se trouve derri√®re devient invisible, vous ne pouvez donc pas le dessiner.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> De m√™me, certains objets au loin deviennent tr√®s petits, nous n'avons donc pas √† nous soucier de dessiner de minuscules plantes et arbustes au loin. </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//auvvQ67/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette animation montre que si vous marchez le long de la rue plus loin que ce que nous voyons, alors il n'y a rien dans les rues lat√©rales, mais √† une grande distance les d√©tails deviennent plus petits. </font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En fait, il y a encore beaucoup d'objets dans cette sc√®ne qui s'av√©reront par cons√©quent invisibles. </font><font style="vertical-align: inherit;">Beaucoup reste √† explorer dans ce domaine et diverses techniques sophistiqu√©es doivent √™tre appliqu√©es. </font><font style="vertical-align: inherit;">Vous devez toujours faire des compromis, mais si vous pouvez passer un peu de temps ou trouver un moyen tr√®s intelligent pour √©viter de rendre 100 objets sans presque aucun effort suppl√©mentaire, nous pouvons rendre la sc√®ne encore plus complexe ou plus dense.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De plus, il y a un autre petit probl√®me. Dans certains cas, nous devons dessiner un b√¢timent √† peine visible √† l'√©cran et qui va bien au-del√†. Cela gaspille des ressources. Nous pouvons toujours diviser ces objets en plusieurs parties, puis chaque partie peut √™tre dessin√©e ou saut√©e, c'est-√†-dire qu'il y aura moins de d√©chets. Cependant, nous avons maintenant augment√© le nombre total d'objets dessin√©s lorsqu'ils </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sont</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† l'√©cran et cr√©√© le probl√®me inverse! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cet exemple est l'un des centaines, mais il est facile d'expliquer sur lui quelles d√©cisions doivent √™tre prises et quelles exp√©riences faire pour trouver le point d'√©quilibre parfait pour chaque jeu.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtant donn√© que l'action de notre tir de Watch Dogs a lieu dans la ville, nous pouvons le regarder d'en haut pour comprendre approximativement ce qui est dessin√© exactement. </font><font style="vertical-align: inherit;">Dans cette image statique, il est particuli√®rement visible que Watch Dogs effectue le travail tous les trimestres.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//My8bi1m/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Maintenant, nous nous √©loignons pour montrer la zone visible devant la cam√©ra (d√©sol√© pour l'installation pour gagner du temps).</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/719/960/135/7199601359a0d421147d9f632061bfaf.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une zone de visibilit√© approximative de la cam√©ra est superpos√©e √† l'image. </font><font style="vertical-align: inherit;">La largeur de ce triangle d√©pend du champ de vision - parfois dans les jeux, c'est une option personnalis√©e, parfois une valeur constante.</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ccf/5ff/d45/ccf5ffd455dccf7098393602c9944139.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici un affichage filaire de la sc√®ne, le champ de vision de la cam√©ra est limit√© au blanc.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Certains d'entre vous pourraient d√©j√† penser √† une petite astuce qui vous permettrait de contourner la restriction du rendu d'un certain nombre d'objets - pourquoi ne pas faire des objets une combinaison tr√®s complexe de tout dans une petite zone, jusqu'aux feuilles individuelles? Ensuite, dessiner 1000 objets sera plus que suffisant. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais ici, nous sommes confront√©s √† un ensemble de limitations compl√®tement diff√©rent - les cartes graphiques ont des performances limit√©es et plus l'objet est complexe, plus il faudra de temps pour le dessiner. Autrement dit, m√™me un objet, s'il est assez complexe, peut r√©duire la fr√©quence d'images du jeu √† 20 FPS. Y compris c'est pourquoi j'ai dit que la limite sur le nombre d'objets est assez floue.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le temps pass√© sur un objet d√©pend de la complexit√© et du d√©tail des mod√®les et des textures, ainsi que de la sophistication de l'√©clairage et des ombres. C'est aussi pourquoi les jeux qui tentent d'impl√©menter des graphiques plus complexes ou sophistiqu√©s ont tendance √† utiliser des sc√®nes moins complexes et d√©taill√©es - l'√©quilibrage d√©cale les √©chelles dans un sens ou dans un autre, afin que vous puissiez vous offrir plus d'espace de man≈ìuvre, en sacrifiant ce qui n'est pas si important pour le jeu .</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/45f/2d5/233/45f2d5233fe8bd806ab2fbf18baa038d.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il s'agit d'une sorte de carte thermique, montrant dans quelles parties de la sc√®ne il existe des mod√®les particuli√®rement complexes. Remarquez combien de probl√®mes les arbres et la v√©g√©tation peuvent causer.</font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe un autre ensemble de techniques appel√© ¬´niveau de d√©tail¬ª (LOD), qui est sp√©cifiquement con√ßu pour r√©soudre de tels probl√®mes. Semblable au fait que nous pouvons optimiser le nombre d'objets, en coupant tout ce qui n'est pas n√©cessaire, nous pouvons augmenter l'offre de ¬´complexit√©¬ª, en √©liminant les inutiles. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'un des trucs est en fait bien connu - cela change la r√©solution des textures. Ce sujet recoupe g√©n√©ralement de nombreux autres, donc je vais essayer de l'expliquer de mani√®re accessible.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les textures dans les jeux sont g√©n√©ralement des rectangles avec des tailles √©gales √† la puissance de deux - 512, 1024, 2048, 4096. Il y a plusieurs raisons √† cela, mais l'un des avantages de ceci est que vous pouvez prendre une texture de taille 1024x1024 et en cr√©er facilement une version plus petite avec une taille de 512x512 . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour les raisons que j'expliquerai ci-dessous, il est toujours n√©cessaire que la texture ait toutes sortes de versions plus petites. C'est-√†-dire qu'une texture d'une taille de 1024x1024 aura des versions plus petites de 512x512, 256x256, 128x128, 64x64, 32x32, 16x16, 8x8, 4x4, 2x2 et 1x1. Cependant, l'un des avantages de cela est que si des objets distants sont petits sur l'√©cran, leur appliquer une texture 1024x1024 signifie un gaspillage de ressources. Nous pouvons √©conomiser en utilisant des versions plus petites de la m√™me texture.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> De m√™me, m√™me les objets proches peuvent √™tre consid√©r√©s comme peu importants et utiliser des textures plus petites pour eux. </font></font><br><br><blockquote><h4>  Remarque </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habituellement, lorsqu'un joueur s'approche d'un objet, la plus grande texture est utilis√©e, mais comme la plupart des gens l'ont vu dans un jeu particulier, cela ne se produit pas toujours et les textures semblent trop floues avant le chargement. </font><font style="vertical-align: inherit;">Cela se produit g√©n√©ralement car les textures ne peuvent pas √™tre charg√©es √† partir d'un DVD ou d'un disque dur directement dans la m√©moire de la carte graphique pour le rendu. </font><font style="vertical-align: inherit;">Le plus souvent, cela se produit lorsqu'un joueur change brusquement de position, par exemple, pendant la r√©apparition, le chargement d'un nouveau niveau ou un mouvement tr√®s rapide. </font><font style="vertical-align: inherit;">Dans tous les autres cas, les textures sont g√©n√©ralement charg√©es progressivement, en train de d√©placer le lecteur √† travers le monde.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez √©galement appliquer ce processus de simplification aux mod√®les utilis√©s dans le jeu, bien qu'il soit beaucoup plus difficile √† faire. En cr√©ant des versions simplifi√©es d'objets complexes, vous pouvez vous assurer qu'√† grande distance, ils ne rongent pas une partie d'un approvisionnement limit√© en complexit√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gr√¢ce √† des objets simplifi√©s et des mod√®les rogn√©s, vous pouvez √©conomiser beaucoup d'argent et vous devez utiliser cette approche dans n'importe quel jeu comme Watch Dogs. Mais en m√™me temps, cela peut √™tre un √©norme gaspillage de ressources. Il est n√©cessaire de prendre une d√©cision tr√®s r√©fl√©chie et √©quilibr√©e sur le nombre de versions simplifi√©es des mod√®les n√©cessaires. S'il y en a trop peu, vous ne pourrez pas √©conomiser trop ou il y aura des sauts de qualit√© notables lors de leur modification. S'il y en a trop, vous perdrez de la m√©moire et passerez les heures-homme n√©cessaires pour cr√©er des objets.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/801/f01/9ed/801f019ed8c365cfebbbeea2320bf3d7.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C'est ainsi que les objets et les personnages complexes regardent √† distance lorsqu'ils ne se distinguent pas de leurs versions tr√®s d√©taill√©es.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'esp√®re que vous avez maintenant une id√©e des probl√®mes que les programmeurs graphiques, les artistes et les concepteurs de niveaux essaient de combiner avec la plus haute vitesse graphique. </font><font style="vertical-align: inherit;">Sur consoles, cette √©quation est un peu plus facile √† r√©soudre que sur PC, car l'√©quipement est constant.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la partie pr√©c√©dente, j'ai dit que j'expliquerai pourquoi il est tr√®s difficile de mettre correctement en ≈ìuvre des r√©flexions et d'autres choses similaires. La raison est assez simple - les r√©serves de productivit√© et de ressources dont je ne cesse de parler ne changent pas selon que vous avez une r√©flexion ou non. Si vous voulez cr√©er un reflet qui peut √† nouveau afficher toute la sc√®ne, vous devez refaire tout le travail dont j'ai parl√©. De plus, les r√©flexions d√©pendent beaucoup de l'angle sous lequel nous les regardons, donc pour obtenir des r√©flexions pr√©cises pour chaque objet r√©fl√©chissant, elles doivent √™tre les leurs!</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cela peut devenir incontr√¥lable tr√®s rapidement, et g√©n√©ralement les jeux dans lesquels il y a des r√©flexions se permettent certaines libert√©s ou hypoth√®ses. Les jeux cr√©ent tr√®s rarement des reflets dans des environnements complexes, le maximum qu'il peut √™tre est un miroir dans la salle de bain, o√π il n'y a pas tellement d'objets, la complexit√© de la sc√®ne est petite, et donc vous pouvez vous permettre des d√©penses suppl√©mentaires. Les vrais reflets du jeu ne seront peut-√™tre que sur des surfaces in√©gales ou ondul√©es de l'eau, de sorte que m√™me une sc√®ne tr√®s rugueuse et peu d√©taill√©e suffit pour cr√©er des reflets convaincants.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est g√©n√©ralement difficile d'√©viter compl√®tement les surfaces r√©fl√©chissantes, c'est pourquoi les jeux utilisent des images pr√©-rendues de l'environnement imm√©diat, ce qui donne un r√©sultat ¬´raisonnablement bon¬ª. Mais ils ne r√©sistent pas √† un examen attentif, et si vous regardez attentivement les reflets, vous verrez que c'est une imitation. Il existe des techniques modernes qui aident √† cr√©er des reflets dans certaines conditions, et peut-√™tre plus tard j'en parlerai, mais de telles images pr√©-rendues (¬´pr√©-rendues¬ª) sont toujours n√©cessaires.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06c/9bd/b94/06c9bdb94b41c1a83b7d574cdf90f449.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette image rendue est appel√©e ¬´carte de cube¬ª. Ce n'est pas tout √† fait exact par rapport √† l'endroit o√π se trouve Aiden, mais il est assez proche de lui.</font></font></em> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Watch Dogs restitue les reflets en temps r√©el. Je n'ai pas enqu√™t√© sur ce probl√®me en d√©tail, mais je pense qu'ils sont toujours rendus lorsque le personnage est dans la rue, et sont principalement utilis√©s pour obtenir ses reflets exacts sur la voiture dans laquelle il est assis, pour am√©liorer l'image et lui donner un l√©ger sentiment de r√©alit√© . Puisque le joueur est toujours concentr√© sur sa voiture et son environnement imm√©diat, le fait d'une r√©flexion incorrecte sur d'autres voitures est √† peine perceptible.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il existe de nombreuses approximations disponibles pour acc√©l√©rer le rendu de ces r√©flexions. Par exemple, beaucoup moins d'objets sont rendus dans la r√©flexion que dans la sc√®ne r√©elle - environ 350 au total - et beaucoup d'entre eux sont tr√®s simplifi√©s par rapport aux versions compl√®tes. Je soup√ßonne que des objets complexes, tels que des personnes, sont compl√®tement rejet√©s quelle que soit la distance, mais je n'ai pas test√© cette th√©orie. De plus, il n'y a pas d'ombres sur ces objets, et l'√©clairage est tr√®s simple - seulement celui qui vient du soleil et du ciel. Les r√©flexions sont rendues √† partir du sol comme dans une lentille ¬´fisheye¬ª, c'est-√†-dire que les r√©flexions de la terre elle-m√™me sont impossibles, et ce qui est √† c√¥t√© a tr√®s peu de d√©tails.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais m√™me avec toutes ces simplifications, les r√©flexions ne r√©pondent qu'√† ce qui √©tait pr√©vu. </font><font style="vertical-align: inherit;">Si vous conduisez sous les rails, vous pouvez obtenir le bon reflet avec une vue sur la voiture, ce qui en pratique ne fonctionnerait pas. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cette d√©cision √©tait intentionnelle et difficile √† prendre. </font><font style="vertical-align: inherit;">Le stock est une valeur constante, donc si vous laissez de la place √† ces r√©flexions, vous devez sacrifier autre chose.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ab1/cda/fcd/ab1cdafcde2ca5c15111ca30f5b6bb5f.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici une vue tr√®s ¬´louche¬ª de la sc√®ne autour d'Aiden avec une vue de dessous, faite pour les reflets. </font><font style="vertical-align: inherit;">Vous pouvez naviguer le long des deux feux et rails du train.</font></font></em> <br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a une autre partie du travail que je veux mentionner ici - les ombres. Plus tard, j'ai l'intention de parler du fonctionnement des ombres, car c'est un sujet int√©ressant, mais maintenant la chose la plus importante est de se rappeler que les ombres sont tr√®s similaires aux r√©flexions. Chaque source de lumi√®re projetant une ombre doit restituer une image de sc√®ne de son point de vue. Cette fois, il n'y a pas beaucoup de fa√ßons de simplifier le travail - pour le calcul correct des ombres, chaque source de lumi√®re </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avoir cette image.</font></font><br><br><blockquote><h4>  Remarque </h4><br>      ,    .           ,      ¬´¬ª  ,             .         ,  ,        . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La source d'√©clairage la plus √©vidente et la plus importante est le soleil (ou la lune, si la chose se passe la nuit). </font><font style="vertical-align: inherit;">√âtant donn√© que le soleil est immense, 3 √† 5 images sont g√©n√©ralement rendues pour lui, et non une, comme dans le cas des phares ou d'une lampe de poche. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malheureusement, c'est l'un des cas o√π Watch Dogs ne peut pas servir de bon exemple. </font><font style="vertical-align: inherit;">Le calcul des ombres dans le jeu est assez compliqu√© et, il me semble, est sp√©cialement optimis√© pour le cas des ombres dans la ville. </font><font style="vertical-align: inherit;">Par cons√©quent, je ferais mieux de passer √† Far Cry 4 et de consid√©rer le calcul des ombres sur l'exemple d'une image de ce jeu.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/21c/4a4/ae6/21c4a4ae665924ba44245b8e18249f8b.jpg"></div><br> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici une sc√®ne de Far Cry 4 que j'utilise comme exemple.</font></font></em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7ae/502/26c/7ae50226c3cc0c40c916c58f26ba27f3.jpg"></div><br>  <em>Voici une image avec des informations sur les ombres de cette sc√®ne - chacune d'entre elles n√©cessite un rendu compl√®tement nouveau de la sc√®ne.</em> <br><br>  Par cons√©quent, lorsque nous devons ajouter une projection d'ombre √† la source de lumi√®re, nous devrons rendre la sc√®ne une fois de plus.  Ici, vous pouvez √©galement utiliser certaines des approximations utilis√©es dans le cas des r√©flexions, mais elles sont beaucoup plus petites.  Vous pouvez ignorer les objets petits ou √©loign√©s, mais gardez √† l'esprit que ces objets ne semblent pas projeter d'ombres.  Vous pouvez rendre l'image tr√®s petite, mais les ombres seront granuleuses et peu d√©taill√©es.  Habituellement, il n'est pas possible d'utiliser une version tr√®s simplifi√©e de l'objet, car il semblerait alors que l'objet se projette une ombre sur lui-m√™me, ou que des √©carts apparaissent entre l'objet et son ombre. <br><br>  Une autre cons√©quence tr√®s facile √† ignorer est la n√©cessit√© de cr√©er des images d'ombrage pour chaque source de lumi√®re.  Dans de nombreux cas, il est possible de simplifier les sources d'√©clairage en les combinant - dans Watch Dogs, cela se produit avec les phares de voiture. <br><br>  Lorsque les deux lumi√®res sont allum√©es, une seule source de lumi√®re est dessin√©e, mais elle a une forme sp√©ciale, √† cause de laquelle elle ressemble √† deux rayons.  Si les phares ont des ombres, ce n'est pas si facile √† faire, et ce sera beaucoup plus visible - lorsque le joueur passe devant la voiture, la lumi√®re viendra de quelque part entre les deux phares.  Vous devrez peut-√™tre alors s√©parer les phares, mais en m√™me temps, non seulement il y aura des co√ªts suppl√©mentaires pour le calcul des ombres, mais vous devrez √©galement dessiner un nouvel √©clairage. <br><br><hr><br>  La principale chose que je voulais souligner avec tout cela √©tait le compromis.  Nous pouvons certainement nous d√©barrasser de toutes ces approximations, mais nous devrons d√©penser nos r√©serves de ressources pour cela, c'est-√†-dire sacrifier autre chose.  Chaque d√©veloppeur de jeu doit d√©cider sur quoi il est important pour lui de se concentrer dans le jeu, et ce qui impressionnera ou g√™nera le plus le joueur. <br><br><h2>  Partie 4. D√©placer les pics </h2><br>  Dans cette partie, je parlerai davantage des d√©tails techniques de l'animation d'objets dans la sc√®ne. <br><br>  Les programmeurs graphiques parlent souvent du ¬´pipeline graphique¬ª.  Les graphiques 3D sont un peu comme une cha√Æne de montage avec un mouvement clairement d√©fini d'une √©tape √† l'autre, mais cela ne fonctionne pas avec un seul objet √† la fois. <br><br>  Toutes les cartes graphiques modernes ont approximativement la m√™me bande transporteuse, elles ont un √©quipement sp√©cial et un logiciel qui sont directement flash√©s ¬´en silicium¬ª pour maximiser la vitesse du convoyeur.  Bien s√ªr, il existe de nombreuses variantes entre les diff√©rents fabricants et familles de cartes graphiques, mais nous n'avons g√©n√©ralement pas √† nous soucier de leur fonctionnement √† ce niveau. <br><br><blockquote><h4>  Remarque </h4><br>  Si vous √™tes int√©ress√© par la fa√ßon dont tout fonctionne au niveau mat√©riel abstrait, alors je recommande une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s√©rie d'articles de Fabian Giesen sur le pipeline graphique</a> .  Cette s√©rie d'articles est <em>beaucoup</em> plus d√©taill√©e et n√©cessite beaucoup plus de compr√©hension que mon article. </blockquote><br>  Je vais sauter de nombreux d√©tails pour expliquer des principes int√©ressants et importants.  Dans cette partie, nous allons examiner la premi√®re partie du pipeline, appel√©e <strong>Vertex Shader</strong> . <br><br>  Les shaders se sont g√©n√©ralis√©s il y a environ 16 ans, apr√®s la sortie de DirectX 9, dans laquelle des shaders de vertex et de pixels sont apparus.  Pour expliquer ce que sont les shaders et les comparer avec ce qu'ils √©taient, je vais parler du travail qu'ils font. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/357/03d/382/35703d382d727d1e395283a4fb3aae33.jpg"></div><br>  <em>La t√™te de squelette d'Aiden est √† nouveau avec nous.</em> <br><br>  Permettez-moi de vous rappeler que dans la partie 2, nous avons examin√© les mod√®les √† partir desquels le monde du jeu est cr√©√©.  Ces motifs sont constitu√©s de points individuels appel√©s sommets qui sont connect√©s en triangles.  J'ai dit que je vous en parlerais plus tard, et maintenant je tiens ma promesse. <br><br>  √âtant donn√© que tout dans le monde du jeu se compose de sommets, tout ce qui doit √™tre fait avec ces mod√®les doit √™tre effectu√© avec des sommets.  En ce qui concerne la carte graphique, tout ce qu'elle voit est une longue liste de sommets.  Pour elle, il n'y a rien de tel que l'ex√©cution d'animations, le balancement des feuilles d'arbres ou tout autre concept abstrait. <br><br>  Regardons un exemple simple de ce que nous devons faire - d√©placer et positionner des objets dans le monde.  Pour commencer, prenons un cas simple, pas un personnage. <br><br>  Lors de la cr√©ation d'objets dans des √©diteurs 3D comme Maya et 3D Studio Max, les artistes construisent toujours √† partir de leur propre monde.  Ces objets ne sont pas cr√©√©s imm√©diatement dans l'entourage de Chicago, leur environnement ressemble plut√¥t √† une "salle blanche vide" de la matrice.  Chaque objet est situ√© au centre du vide absolu. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bd0/a55/a3c/bd0a55a3c96f5fefc237bdf22194e009.png"></div><br>  <em>Voici un feu de circulation dans le jeu quelque part sous les rails, et il est situ√© dans son propre monde.</em> <br><br>  Lors de l'enregistrement sur disque, le mod√®le n'a aucune id√©e o√π il se trouvera dans le monde et quand il sera t√©l√©charg√© et transf√©r√© sur la carte graphique.  Cela signifie que lorsque vient le temps de dessiner des objets, nous devons le d√©placer de notre propre monde vers la sc√®ne que nous dessinons.  Cela se produit avec chaque objet dessin√©, et m√™me des objets immobiles tels que des b√¢timents et des ponts se d√©placent √©galement de leur propre monde vers la sc√®ne dans chaque image. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d65/21d/673/d6521d67344753566d0d2b4ff3b4fbf9.png"></div><br>  <em>Ici, nous voyons plusieurs feux de circulation d√©j√† plac√©s dans une sc√®ne finale partiellement construite.</em> <br><br>  Comme je l'ai mentionn√© ci-dessus, les seules choses avec lesquelles nous pouvons travailler sont les pics.  Nous ne pouvons pas simplement dire √† la carte graphique: "Pouvez-vous placer ce feu de circulation sous le pont?  Et puis en mettre un autre un peu plus loin?  Super! " <br><br>  Par cons√©quent, au lieu de dire √† la carte graphique ce qu'elle doit faire avec l'objet lui-m√™me, nous devons dire quoi faire avec tous ses sommets.  Il s'av√®re que dans ce cas, tout devient tr√®s simple.  Si nous changeons tous les sommets exactement de la m√™me mani√®re et qu'ils restent immobiles les uns par rapport aux autres, cela revient √† d√©placer un objet dans son ensemble.  Tout ce que nous devons faire est de comprendre ce que le ¬´changement¬ª est appel√© transformation. <br><br><blockquote><h4>  Remarque </h4><br>  Les calculs math√©matiques de tout cela ne sont pas particuli√®rement compliqu√©s, mais d√©passent le cadre de l'article.  Si vous avez d√©j√† √©tudi√© l'alg√®bre lin√©aire, vous savez probablement tout ce dont vous avez besoin - en gros, tout se r√©sume √† la multiplication matricielle des vecteurs. </blockquote><br>  Avant l'apparition des vertex shaders, les options possibles pour transformer les sommets dans la carte graphique √©taient tr√®s limit√©es.  Des objets en mouvement et en rotation √©taient disponibles, ainsi que certaines autres op√©rations, mais rien de particuli√®rement redondant ou compliqu√©. <br><br>  Les vertex shaders sont de petits programmes informatiques qui s'ex√©cutent sur une carte graphique.  Ils prennent un sommet, effectuent <em>toutes les actions n√©cessaires</em> avec lui et √©mettent un sommet de sortie.  Ils peuvent non seulement le d√©placer, mais aussi les faire sauter de haut en bas, s'√©loigner du sommet le plus proche, osciller en fonction du vent, s'animer et bien plus encore. <br><br>  J'ai pris l'un des vertex shaders utilis√©s dans Watch Dogs et je l'ai exp√©riment√© un peu pour montrer ce qu'il fait.  C'est un travail assez laborieux, mais j'ai r√©ussi √† trouver le vertex shader utilis√© pour les personnages et √† le changer.  Il existe un autre vertex shader utilis√© pour la peau, par exemple, pour les visages et les mains, mais vous comprendrez rapidement le principe. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//Wqyv7B8/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>J'ai fait un changement tr√®s simple qui ajoute un pli au mod√®le de personnage, mais tout le reste est utilis√© comme d'habitude.</em> <br><br>  L'animation ci-dessus montre que les personnages sont √©trangement d√©form√©s.  Cela nous ram√®ne au principe "si vous d√©placez chaque sommet, cela revient √† d√©placer tout l'objet".  La modification apport√©e au vertex shader ne fonctionne que pour un sommet √† la fois, mais comme ils fonctionnent tous avec la m√™me distorsion, l'effet est appliqu√© √† l'objet entier. <br><br>  Vous pouvez √©galement apporter des modifications √† la partie de la transformation, qui est responsable de ¬´se d√©placer simplement en place¬ª, de sorte qu'au lieu de placer le personnage au bon endroit, elle le soul√®ve au-dessus du sol.  Cela n'est pas simul√© √† l'aide de la physique, donc cela n'a rien √† voir avec la gravit√© ou les collisions avec d'autres objets - si nous voulons, nous pouvons faire planer tout le monde dans les airs. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//tktCaw4/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Dans cette animation, nous avons fait monter et descendre progressivement le vertex shader.</em> <br><br>  √âvidemment, tout cela n'est pas tr√®s constructif, mais cela nous donne une id√©e g√©n√©rale du fonctionnement des vertex shaders - si nous voulions maintenant animer les feuilles des arbres pour qu'elles se balancent, nous ferions la m√™me chose.  Ce n'est qu'au lieu de s'√©lever et de s'abaisser qu'ils oscilleraient dans la direction du vent.  Ensuite, nous pouvons changer la force du vent pour que les arbres se balancent plus ou moins. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//5Sl1uhw/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Ici, nous voyons ce qui se passe lorsque tout augmente d'environ sept fois.</em> <br><br>  Je simplifie un peu, mais la t√¢che de la plupart des vertex shaders est de ¬´d√©placer les objets en place¬ª.  L'exception concerne tous les objets anim√©s - les personnes, les animaux, ainsi que les objets tels que les cordes qui se balancent, les v√™tements flottant, etc. <br><br><hr><br>  L'animation des gens est li√©e √† l'id√©e d'utiliser un squelette et une ¬´peau¬ª.  Un squelette est une simple description d'un personnage en mouvement.  √Ä ce stade, nous ne nous soucions pas des boucles, des chapeaux ou des jeans qui ne sont pas anim√©s - seuls les mouvements importants les plus appropri√©s pour le squelette humain sont importants pour nous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f0f/bf2/ce7/f0fbf2ce7c1a0d3d287f8cc4b04b41f2.png"></div><br>  <em>Un simple squelette d'une figure humaine est montr√© ici.</em>  <em>Il n'a pas √©t√© repris de Watch Dogs, car le squelette est difficile √† visualiser en dehors de l'√©diteur 3D.</em> <br><br>  <em>Image sous licence <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Attribution-ShareAlike CC BY-SA</a> ¬© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©quipe MakeHuman</a> 2001-2014</em> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//nXYWZOr/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Il s'agit d'une pose instantan√©e ou d'une pose en T qui montre √† quoi ressemble un personnage sans utiliser d'animations.</em> <br><br>  Les animations - courir, marcher, sauter - ne s'appliquent qu'√† ce squelette.  Cela rend l'ensemble du processus tr√®s simple, car nous devons consid√©rer seulement une centaine d'os au lieu de milliers et milliers de sommets. <br><br>  Apr√®s avoir cr√©√© le squelette, chaque sommet est attach√© √† un ou plusieurs os dans cette pose statique, et cette connexion est appel√©e ¬´skinning¬ª.  Au moment de Half-Life 1, lorsque cette technologie a commenc√© √† √™tre utilis√©e, chaque sommet n'√©tait associ√© qu'√† un seul os.  De nos jours, ils peuvent m√™me joindre quatre os, tandis que chaque os re√ßoit un poids, dont d√©pend le degr√© d'influence de l'os sur l'apex.  Gr√¢ce √† cela, vous pouvez obtenir une animation plus fluide, permettant aux os de se croiser dans diff√©rentes zones sans cr√©er d'angles vifs lors du d√©placement des bras ou des jambes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e5/af5/e31/7e5af5e314bf44d7f9098941be6eacbc.png"></div><br>  <em>Il s'agit du squelette illustr√© ci-dessus avec l'os de la cuisse tourn√©.</em>  <em>Les couleurs montrent le poids de l'os de la hanche par rapport aux sommets du mod√®le.</em> <br><br>  <em>Image sous licence <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Attribution-ShareAlike CC BY-SA</a> ¬© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©quipe MakeHuman</a> 2001-2014</em> <br><br>  Cette technologie a ses limites, en particulier dans les endroits o√π les v√™tements et la peau sont comprim√©s ou √©tir√©s dans des charni√®res, par exemple, sur les coudes et les √©paules.  C'est un moyen d'animation imparfait mais tr√®s efficace.  La limitation la plus s√©rieuse est qu'il est tr√®s difficile de cr√©er des animations de visage convaincantes de cette mani√®re.  Vous pouvez cr√©er de nombreux ¬´faux¬ª os sur votre visage, par exemple pour les sourcils et autour de la bouche, mais ce ne sera qu'une approximation approximative des muscles et de la peau. <br><br>  Une autre caract√©ristique importante de cette technique est que la comparaison des sommets et des os est tr√®s sp√©cifique et est li√©e √† la fa√ßon dont cette comparaison est effectu√©e.  Il est possible d'utiliser des animations pour plusieurs mod√®les diff√©rents, mais chaque mod√®le individuel dans lequel vous souhaitez utiliser le squelette doit √™tre associ√© √† des os.  La raison en est que les animations d√©placent les sommets de leur position d'origine par rapport √† leurs squelettes.  Si les sommets ne sont pas dans les positions attendues, des probl√®mes surviendront. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//JdJEwEW/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Si le mod√®le ne correspond pas au squelette utilis√© par elle, les animations seront <u>compl√®tement</u> incorrectes.</em> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed//Wt5PSQY/embed?ref=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <em>Si nous rendons le personnage deux fois plus large, nous obtenons un effet similaire aux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">¬´beignets suraliment√©s¬ª de Drake</a> , mais il est √† noter que les animations plus proches des pinceaux deviennent incorrectes, car c'est l√† qu'elles sont les plus √©loign√©es de leurs positions d'origine.</em> <br><br>  La premi√®re animation peut vous sembler √©trange - de telles animations glitch se produisent tr√®s souvent dans les jeux.  Habituellement, ils sont caus√©s par le fait que des animations incorrectes sont appliqu√©es au squelette ou que le mod√®le utilise le mauvais squelette.  Comme dans le cas des textures et des mod√®les, le squelette, le skinning et le mod√®le doivent √™tre compar√©s tr√®s soigneusement, sinon les r√©sultats se r√©v√©leront rapidement tristes. <br><br>  J'esp√®re que vous avez une id√©e de l'objectif des vertex shaders et que vous comprenez comment les animations sont utilis√©es pour transformer un mod√®le statique en personnage vivant. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430930/">https://habr.com/ru/post/fr430930/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430918/index.html">√Ä propos de Flutter, en bref: les bases</a></li>
<li><a href="../fr430922/index.html">Exemple de calcul pour standard t√©l√©phonique</a></li>
<li><a href="../fr430924/index.html">Programmation Ada</a></li>
<li><a href="../fr430926/index.html">Le temps est fragment√©; un peu sur la similitude des syst√®mes distribu√©s et un mod√®le de m√©moire faible</a></li>
<li><a href="../fr430928/index.html">√Ä propos de la "maison intelligente": comment cr√©er un r√©tro-√©clairage "intelligent"</a></li>
<li><a href="../fr430932/index.html">Les pirates ont vol√© plus de 21 millions de roubles d'une banque russe</a></li>
<li><a href="../fr430934/index.html">G√©n√©rateur de masque d'extension de plan de num√©rotation Asterisk</a></li>
<li><a href="../fr430936/index.html">DEFCON 21. La conf√©rence DNS peut √™tre dangereuse pour votre sant√©. 2e partie</a></li>
<li><a href="../fr430938/index.html">Comment obtenir les premi√®res commandes en conception lorsqu'il n'y a pas de portefeuille et d'exp√©rience</a></li>
<li><a href="../fr430940/index.html">SDK pour vous, SDK pour moi, SDK pour tout le monde! Comment cr√©er un SDK et pourquoi est-il n√©cessaire</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>