<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õëÔ∏è üë®üèº‚Äçüè´ üìå Estaci√≥n de trabajo criptogr√°fica basada en tokens PKCS # 11. Firma electr√≥nica Parte 2 üéπ ‚ûó üîè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En la primera parte de nuestra historia, mostramos c√≥mo, tener en nuestras manos un token criptogr√°fico con soporte para criptograf√≠a rusa, crear una ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Estaci√≥n de trabajo criptogr√°fica basada en tokens PKCS # 11. Firma electr√≥nica Parte 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457288/"><img src="https://habrastorage.org/webt/fh/ko/2z/fhko2zf-9khxaumrxlaf1muqs-4.png" align="left">  En la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">primera parte de</a> nuestra historia, mostramos c√≥mo, tener en nuestras manos un token criptogr√°fico con soporte para criptograf√≠a rusa, crear una solicitud de certificado, obtener e instalar un certificado para un token, verificar la firma electr√≥nica del certificado y su validez contra la lista de certificados revocados (CRL), eliminar el certificado de ficha, cambiar etiquetas, etc. <a name="habracut"></a>  Despu√©s de haber creado una solicitud de certificado (haber generado un par de claves), recibido un certificado en la CA y establecerlo en un token, nada impide ahora usar un certificado personal (certificado con un par de claves) para la firma electr√≥nica de documentos.  Empecemos  Primero, recuerde d√≥nde se encuentra la utilidad cryptoarmp11. <br><br><div class="spoiler">  <b class="spoiler_title">cryptoarmp11</b> <div class="spoiler_text"><ul><li>  <a href="">Linux32</a> </li><li>  <a href="">Linux64</a> </li><li>  <a href="">OS X</a> </li><li>  <a href="">WIN32</a> </li><li>  <a href="">WIN64</a> </li></ul><br></div></div><br>  A continuaci√≥n, ejecute la utilidad y haga clic en el bot√≥n "1. Firmar el documento": <br><br><img src="https://habrastorage.org/webt/ic/fh/yw/icfhywk5ii-ar98wckdsm6l18fg.png"><br><br>  Seleccionamos el archivo con el documento que queremos firmar y decidimos el directorio donde guardaremos el archivo con la firma (el final del nombre de este archivo ser√° .p7s).  Decidimos si el documento firmado se almacenar√° en el cuerpo de la firma o no (firma adjunta / desconectada).  Y lo m√°s significativo, determinamos el formato de la firma.  En mi opini√≥n, puede cumplir con las siguientes reglas.  Si este es un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">flujo</a> interno de documentos corporativos, donde se lleva a cabo un control estricto sobre las computadoras, entonces es suficiente usar el formato de firma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CAdes</a> -BES, que incluye, adem√°s de la firma matem√°tica, de acuerdo con GOST R 34.10-2012 y el tiempo de generaci√≥n de la firma (campo Hora actual).  Si no hay un control estricto sobre las computadoras (todos pueden configurar en cualquier momento en su computadora), y la fecha de la firma del documento es importante, entonces debe usar el formato CAdes-T o CAdes-XLT1.  Cuando se usan los formatos CAdes-T y CAdes-XLT1, el lado externo est√° involucrado (similar a atraer un natarius), un servidor de sello de tiempo.  Con el formato CAdes-T, la respuesta del servidor de sello de tiempo se agrega al archivo con firma electr√≥nica (consulte el campo "Servidor TSP").  Esta respuesta (y tambi√©n es un documento en formato PKCS # 7, firmado por el servidor TSP) le permite determinar en qu√© momento se firm√≥ el documento.  Debe tenerse en cuenta que a menudo solo se verifica una firma matem√°tica, y se omite la validez de la firma en s√≠ por las marcas de tiempo.  Para verificar la validez de la firma, por supuesto, se requiere la verificaci√≥n de la validez de los certificados.  Entonces, para simplificar este trabajo, el formato de firma CAdes-XLT1 implica la inclusi√≥n en el archivo de firma de todas las pruebas de validez de firma en el momento de su creaci√≥n.  Estos son certificados, incluidos certificados de CA, servidores de sello de tiempo, servidores ocsp, as√≠ como listas de certificados revocados y respuestas de servidores OCSP.  No nos detendremos en esto.  ¬øQui√©n quiere encontrar la literatura adecuada? <br><br>  Entonces, decidimos el formato de la firma y presionamos el bot√≥n "Firmar el documento".  Luego, debemos ingresar otro c√≥digo PIN para el token, luego aparece una advertencia sobre el comienzo de la formaci√≥n de la firma y la necesidad de ser paciente, y finalmente, se crear√° la firma: <br><br><img src="https://habrastorage.org/webt/rh/hx/zu/rhhxzuhqz4un7y5kg_rk8vdqoqs.png"><br><br>  ¬øQu√© se necesita para crear una firma?  Esto, por supuesto, son los c√°lculos matem√°ticos en s√≠ mismos y la recopilaci√≥n de varios datos (certificados, CRL, respuestas del servidor OCSP, marcas de tiempo).  Todo, se crea la firma.  Al recibir el certificado en la CA, aseg√∫rese de averiguar la direcci√≥n del servidor de sello de hora de su CA.  Si los enlaces a los certificados de las autoridades de certificaci√≥n ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cadena de</a> certificados), a las listas de certificados revocados, as√≠ como al servidor OCSP se toman de los certificados, entonces la direcci√≥n del servidor de sello de tiempo deber√° ingresarse manualmente (campo "Servidor TSP"). <br><br>  C√≥mo asegurarse de que la firma se crea correctamente y que el documento se puede transferir al caso.  En Internet puede encontrar varios sitios para verificar la firma.  Algunos de ellos verifican solo la firma desconectada, otros verifican todo e informan bien: <br><br><img src="https://habrastorage.org/webt/3t/23/nd/3t23ndza8h2d2rofsdluh7ghoy4.png"><br><br>  Pero en cualquier caso, esto no le garantiza que su firma ser√° aceptada en la organizaci√≥n donde presente el documento firmado, por ejemplo, en el sitio web del Servicio Estatal.  Esto se debe al hecho de que de diferentes maneras se puede almacenar y verificar la evidencia de la validez de la firma en formato XLT1.  Entonces, por ejemplo, en el sitio web del Servicio Estatal se requiere que la evidencia de la validez del certificado del servidor de sello de tiempo se almacene en la firma recibida del servidor.  Y si no est√°n all√≠, entonces, a pesar del hecho de que pueden estar presentes en la firma del documento, la firma en el sitio web de los Servicios del Estado ser√° invalidada.  Todo est√° bien con nuestra firma: <br><br><img src="https://habrastorage.org/webt/od/ve/dl/odvedlht4frc6dbyvepbcvcqixi.png"><br><br>  Vamos a la p√°gina "2. Trabajar con ES (PKCS7)" e inmediatamente seleccionamos el archivo con la firma creada: <br><br><img src="https://habrastorage.org/webt/ek/xn/_g/ekxn_gbh0tenbm6_lytxeo5ep5w.png"><br><br>  Al cargar una firma, la utilidad completa los campos apropiados en la ventana principal.  La captura de pantalla muestra esto bien.  Muestra cu√°ndo se gener√≥ la firma en la computadora del usuario (campo ‚ÄúFecha de firma:‚Äù), cu√°ndo se verific√≥ esta fecha en el servidor de sello de tiempo (campo ‚ÄúFecha de recepci√≥n del sello de tiempo‚Äù) y cu√°ndo se recopilaron todas las pruebas de validez (campo ‚ÄúFecha de aprobaci√≥n de la etiqueta tiempo "). <br><br>  Las operaciones que se pueden realizar en una firma tambi√©n est√°n claras.  De mayor inter√©s aqu√≠ es la adici√≥n de una firma a un documento previamente firmado.  Para hacer esto, simplemente seleccione un certificado para agregar una nueva firma (an√°logo a la visualizaci√≥n del documento) y no se olvide de elegir un servidor TSP: <br><br><img src="https://habrastorage.org/webt/gx/sd/nz/gxsdnz7yhzqxf_yleckkffrc4uk.png"><br><br>  Y si nos fijamos en qui√©n firm√≥ el documento, ahora hay dos firmantes.  Y ambas firmas se verificaron con √©xito en el sitio web de servicios p√∫blicos: <br><br><img src="https://habrastorage.org/webt/g4/6b/yn/g46bynowr4qatyxcnqyleiacl9i.png"><br><br>  En mi opini√≥n, la utilidad corresponde a las aspiraciones de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tener una utilidad</a> para firmar documentos, tener a mano "certificados en tokens con una clave irrecuperable para que puedan leer todo ellos mismos". <br><br>  Sin embargo, decidimos ir m√°s all√° e incluir en esta utilidad una p√°gina para trabajar con el contenedor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PKCS # 12</a> , que se est√° volviendo cada vez m√°s popular.  Y si ahora para firmar un documento necesita el token PKCS # 11 y una biblioteca para √©l, entonces cuando use PKCS # 12 solo necesitar√° el contenedor en s√≠.  Y, por supuesto, la utilidad de la que hablamos hoy.  Pero esta utilidad es absolutamente autosuficiente y, a diferencia de varios CSP, no parchea ning√∫n n√∫cleo y funciona en cualquier plataforma.  Por lo tanto, pasamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font color="blue">a la tercera parte</font></a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/457288/">https://habr.com/ru/post/457288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457270/index.html">Prisma-CMS como motor para crear MVP r√°pidamente</a></li>
<li><a href="../457276/index.html">Siete amenazas de bot para tu sitio</a></li>
<li><a href="../457282/index.html">"La muerte de Dios" o el colapso de las leyes generalmente aceptadas para construir equipos de TI y crear sistemas de TI en el siglo XXI</a></li>
<li><a href="../457284/index.html">WBOIT en OpenGL: transparencia sin ordenar</a></li>
<li><a href="../457286/index.html">La soluci√≥n de las tareas de WorldSkills del m√≥dulo de red en la competencia de "CCA". Parte 1 - Configuraci√≥n b√°sica</a></li>
<li><a href="../457290/index.html">Conferencia DEFCON 25. Garry Kasparov. "La √∫ltima batalla del cerebro". Parte 2</a></li>
<li><a href="../457292/index.html">WBOIT en OpenGL: transparencia sin ordenar</a></li>
<li><a href="../457294/index.html">"Live high" o mi historia desde la dilaci√≥n hasta el autodesarrollo</a></li>
<li><a href="../457298/index.html">Frontend Weekly Digest (17-23 de junio de 2019)</a></li>
<li><a href="../457300/index.html">El resumen de materiales frescos del mundo del front-end para la √∫ltima semana No. 370 (17 al 23 de junio de 2019)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>