<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ù§Ô∏è üßòüèæ ‚ñ´Ô∏è Asketisches Netz: Prototyp-Flohm√§rkte f√ºr unterwegs und js ‚¨ÜÔ∏è ‚ò†Ô∏è ‚úçüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits, ich m√∂chte das Ergebnis meiner Gedanken dar√ºber teilen, was eine moderne Webanwendung sein kann. Als Beispiel sollten Sie ein Bullet...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Asketisches Netz: Prototyp-Flohm√§rkte f√ºr unterwegs und js</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435908/"><p> <a href=""><img src="https://habrastorage.org/webt/jl/lq/qo/jllqqo3xn1mthylxxodb2-digfw.png" alt="Screenshot"></a> </p><br><p>  Hallo allerseits, ich m√∂chte das Ergebnis meiner Gedanken dar√ºber teilen, was eine moderne Webanwendung sein kann.  Als Beispiel sollten Sie ein Bulletin Board f√ºr Comics entwerfen.  In gewisser Weise ist das betreffende Produkt f√ºr ein Publikum von Geeks und Sympathisanten konzipiert, wodurch Sie die Freiheit in der Benutzeroberfl√§che zeigen k√∂nnen.  In der technischen Komponente ist dagegen die Liebe zum Detail erforderlich. </p><br><p>  In Wahrheit verstehe ich nichts in den Comics, aber ich liebe Flohm√§rkte, besonders im Forum-Format, die in der Null beliebt waren.  Daher ist die Annahme (m√∂glicherweise falsch), aus der die folgenden Schlussfolgerungen hervorgehen, nur eine - die Hauptart der Interaktion mit der Anwendung ist das Anzeigen, die sekund√§ren ver√∂ffentlichen Ank√ºndigungen und Diskussionen. </p><br><p> Unser Ziel wird es sein, eine einfache Anwendung ohne zu erstellen <del>  technisches Know-how </del>  zus√§tzliche Pfeifen im Einklang mit der modernen Realit√§t.  Die Hauptanforderungen, die ich erf√ºllen m√∂chte, sind: </p><a name="habracut"></a><br><ol><li><p>  Serverseite: </p><br><p>  a) F√ºhrt die Funktionen zum Speichern, Validieren und Senden von Benutzerdaten an den Client aus <br>  b) Die oben genannten Vorg√§nge verbrauchen eine akzeptable Menge an Ressourcen (Zeit, einschlie√ülich) <br>  c) Die Anwendung und die Daten sind vor g√§ngigen Angriffsmethoden gesch√ºtzt <br>  d) Es verf√ºgt √ºber eine einfache API f√ºr Clients von Drittanbietern und f√ºr die Interaktion zwischen Servern <br>  e) Plattform√ºbergreifende, einfache Bereitstellung </p><br></li><li><p>  Client-Seite: </p><br><p>  a) Bietet die erforderlichen Funktionen zum Erstellen und Konsumieren von Inhalten <br>  b) Die Benutzeroberfl√§che ist praktisch f√ºr den regelm√§√üigen Gebrauch, der minimale Pfad zu einer Aktion, die maximale Datenmenge pro Bildschirm <br>  c) Au√üerhalb der Kommunikation mit dem Server sind alle in dieser Situation verf√ºgbaren Funktionen verf√ºgbar <br>  d) Die Schnittstelle zeigt die aktuelle Version des Status und des Inhalts an, ohne neu zu starten und zu warten <br>  d) Ein Neustart der Anwendung hat keinen Einfluss auf ihren Status <br>  f) Verwenden Sie nach M√∂glichkeit DOM-Elemente und JS-Code erneut <br>  g) Wir werden zur Laufzeit keine Bibliotheken und Frameworks von Drittanbietern verwenden <br>  h) Das Layout ist semantisch f√ºr Barrierefreiheit, Parser usw. <br>  i) Die Navigation des Hauptinhalts ist √ºber die URL und die Tastatur m√∂glich </p><br></li></ol><br><p>  Meiner Meinung nach erf√ºllen logische Anforderungen und modernste Anwendungen in gewissem Ma√üe diese Bedingungen.  Mal sehen, was mit uns passiert (Link zu Quelle und Demo am Ende des Beitrags). </p><br><div class="spoiler">  <b class="spoiler_title">Warnungen:</b> <div class="spoiler_text"><ul><li>  Ich m√∂chte mich bei den unbekannten Autoren der in der Demo ohne Erlaubnis verwendeten Bilder sowie bei G√∂sse G., Prozorovskaya B. D. und dem Verlag "Library of Florence Pavlenkov" f√ºr die Verwendung von Ausz√ºgen aus dem Werk "Siddhartha" entschuldigen. </li><li>  Der Autor ist kein echter Programmierer. Ich empfehle nicht, den Code oder die in diesem Projekt verwendeten Techniken zu verwenden, wenn Sie nicht wissen, was Sie tun. </li><li>  Ich entschuldige mich f√ºr den Stil des Codes, er h√§tte lesbarer und offensichtlicher geschrieben werden k√∂nnen, aber das macht keinen Spa√ü.  Ein Projekt f√ºr die Seele und f√ºr einen Freund, wie es hei√üt. </li><li>  Ich entschuldige mich auch f√ºr die Alphabetisierungsrate, insbesondere im englischen Text.  Jahre sprechen ab Mai Hart. </li><li>  Die Leistung des vorgestellten Prototyps wurde in [Chrom 70;  Linux x86_64;  1366x768] werde ich Benutzern anderer Plattformen und Ger√§te f√ºr Fehlermeldungen √§u√üerst dankbar sein. </li><li>  Dies ist ein Prototyp und ein vorgeschlagenes Diskussionsthema - Ans√§tze und Prinzipien, ich bitte darum, dass alle Kritikpunkte an der Umsetzung und der √§sthetischen Seite von Argumenten begleitet werden. </li></ul></div></div><br><h2 id="server">  Server </h2><br><p>  Die Sprache f√ºr den Server ist Golang.  Eine einfache, schnelle Sprache mit einer exzellenten Standardbibliothek und Dokumentation ... etwas nervig.  Die anf√§ngliche Wahl fiel auf elixir / erlang, aber da ich go (relativ) bereits kannte, wurde beschlossen, es nicht zu komplizieren (und die notwendigen Pakete waren nur f√ºr go). </p><br><p>  Die Verwendung von Web-Frameworks in der Go-Community wird nicht empfohlen (zu Recht, es lohnt sich zuzugeben), wir w√§hlen einen Kompromiss und verwenden das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Labstack- / Echo-Mikroframework</a> , wodurch der Routineaufwand reduziert wird und meiner Meinung nach nicht viel an Leistung verloren geht. </p><br><p>  Wir verwenden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">tidwall / buntdb</a> als Datenbank.  Erstens ist die integrierte L√∂sung bequemer und reduziert die Overhead-Kosten, und zweitens In-Memory + Schl√ºssel / Wert - <del>  modisch, stilvoll </del>  Schnell und kein Cache erforderlich.  Wir speichern und geben Daten in JSON und validieren sie nur bei √Ñnderungen. </p><br><p>  Beim i3 der zweiten Generation zeigt der integrierte Logger die Ausf√ºhrungszeit f√ºr verschiedene Anforderungen von 0,5 bis 10 ms an.  Das Ausf√ºhren von wrk auf demselben Computer zeigt auch ausreichende Ergebnisse f√ºr unsere Zwecke: </p><br><pre><code class="plaintext hljs">‚ûú comico git:(master) wrk -t2 -c500 -d60s http://localhost:9001/pub/mtimes Running 1m test @ http://localhost:9001/pub/mtimes 2 threads and 500 connections Thread Stats Avg Stdev Max +/- Stdev Latency 20.74ms 16.68ms 236.16ms 72.69% Req/Sec 13.19k 627.43 15.62k 73.58% 1575522 requests in 1.00m, 449.26MB read Requests/sec: 26231.85 Transfer/sec: 7.48MB</code> </pre> <br><pre> <code class="plaintext hljs">‚ûú comico git:(master) wrk -t2 -c500 -d60s http://localhost:9001/pub/goods Running 1m test @ http://localhost:9001/pub/goods 2 threads and 500 connections Thread Stats Avg Stdev Max +/- Stdev Latency 61.79ms 65.96ms 643.73ms 86.48% Req/Sec 5.26k 705.24 7.88k 70.31% 628215 requests in 1.00m, 8.44GB read Requests/sec: 10454.44 Transfer/sec: 143.89MB</code> </pre> <br><h3 id="struktura-proekta">  Projektstruktur </h3><br><p>  Das <u>comico / model-</u> Paket ist in drei Dateien unterteilt: <br>  model.go - enth√§lt eine Beschreibung der Datentypen und allgemeinen Funktionen: Erstellung / Aktualisierung (buntdb unterscheidet nicht zwischen diesen Vorg√§ngen und wir pr√ºfen manuell, ob ein Datensatz vorhanden ist), Validierung, L√∂schung, Abrufen eines Datensatzes und Abrufen einer Liste; <br>  rules.go - enth√§lt Validierungsregeln f√ºr einen bestimmten Typ und eine bestimmte Protokollierungsfunktion. <br>  files.go - arbeite mit Bildern. <br>  Der Mtimes-Typ speichert Daten zur letzten √Ñnderung der verbleibenden Typen in der Datenbank und informiert so den Client dar√ºber, welche Daten sich ge√§ndert haben. </p><br><p>  Das <u>comico / bd-</u> Paket enth√§lt allgemeine Funktionen f√ºr die Interaktion mit der Datenbank: Erstellen, L√∂schen, Ausw√§hlen usw. Buntdb speichert alle √Ñnderungen an einer Datei (in unserem Fall einmal pro Sekunde) im Textformat, was in einigen Situationen praktisch ist.  Die Datenbankdatei wird nicht bearbeitet, √Ñnderungen bei Erfolg der Transaktion werden am Ende hinzugef√ºgt.  Alle meine Versuche, die Integrit√§t der Daten zu verletzen, waren erfolglos. Im schlimmsten Fall gehen √Ñnderungen in der letzten Sekunde verloren. <br>  In unserer Implementierung entspricht jeder Typ einer separaten Datenbank in einer separaten Datei (mit Ausnahme von Protokollen, die ausschlie√ülich im Speicher gespeichert und beim Neustart auf Null zur√ºckgesetzt werden).  Dies ist haupts√§chlich auf die Bequemlichkeit der Sicherung und Verwaltung zur√ºckzuf√ºhren, ein kleines Plus - eine offene Transaktion zum Bearbeiten blockiert den Zugriff auf nur einen Datentyp. <br>  Dieses Paket kann einfach durch ein √§hnliches ersetzt werden, indem eine andere Datenbank verwendet wird, z. B. SQL.  Dazu reicht es aus, folgende Funktionen zu implementieren: </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Exist</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Insert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key, val </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadAll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, pattern </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(str </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, err error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadOne</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(str </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">, err error)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Renew</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">, key </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(err error, newId </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span></code> </pre> <br><p>  Das <u>comico / cnst-Paket</u> enth√§lt einige Konstanten, die in allen Paketen erforderlich sind (Datentypen, Aktionstypen, Benutzertypen).  Dar√ºber hinaus enth√§lt dieses Paket alle f√ºr Menschen lesbaren Nachrichten, mit denen unser Server auf die Au√üenwelt reagiert. </p><br><p>  Das <u>Comico / Server-</u> Paket enth√§lt Routing-Informationen.  Au√üerdem sind nur ein paar Zeilen (dank der Echo-Entwickler), die Autorisierung mithilfe von JWT, CORS, CSP-Headern, Logger, statischer Verteilung, gzip, ACME-Autozertifikat usw. konfiguriert. </p><br><h3 id="tochki-vhoda-api">  API-Einstiegspunkte </h3><br><table><thead><tr><th>  URL </th><th>  Daten </th><th>  Beschreibung </th></tr></thead><tbody><tr><td>  get / pub / (Waren | Beitr√§ge | Benutzer | cmnts | Dateien) </td><td>  - - </td><td>  Abrufen einer Reihe relevanter Ank√ºndigungen, Beitr√§ge, Benutzer, Kommentare und Dateien </td></tr><tr><td>  get / pub / mtimes </td><td>  - - </td><td>  Abrufen der letzten √Ñnderungszeit f√ºr jeden Datentyp </td></tr><tr><td>  post / pub / login </td><td>  {id *: login, pass *: password} </td><td>  Gibt das JWT-Token und seine Dauer zur√ºck </td></tr><tr><td>  Post / Pub / Pass </td><td>  {id *, pass *} </td><td>  Erstellt einen neuen Benutzer, wenn die Daten korrekt sind </td></tr><tr><td>  put / api / pass </td><td>  {id *, pass *} </td><td>  Passwort aktualisieren </td></tr><tr><td>  post | put / api / ware </td><td>  {id *, auth *, title *, type *, price *, text *, images: [], Table: {key: value}} </td><td>  Anzeige erstellen / aktualisieren </td></tr><tr><td>  post | put / api / posts </td><td>  {id *, auth *, title *, type *, text *} </td><td>  Forenbeitrag erstellen / aktualisieren </td></tr><tr><td>  post | put / api / users </td><td>  {id *, Titel, Typ, Status, Schreiber: [], ignoriert: [], Tabelle: {Schl√ºssel: Wert}} </td><td>  Benutzer erstellen / aktualisieren </td></tr><tr><td>  post / api / cmnts </td><td>  {id *, auth *, owner *, type *, to, text *} </td><td>  Kommentarerstellung </td></tr><tr><td>  delete / api / (Waren | Beitr√§ge | Benutzer | cmnts) / [id] </td><td>  - - </td><td>  L√∂scht einen Eintrag mit der ID </td></tr><tr><td>  get / api / activity </td><td>  - - </td><td>  Aktualisiert die letzte Lesezeit eingehender Kommentare f√ºr den aktuellen Benutzer </td></tr><tr><td>  get / api / (abonnieren | ignorieren) / [tag] </td><td>  - - </td><td>  F√ºgt dem Benutzer in der Liste der Abonnements / Ignorieren (falls vorhanden) Tags hinzu oder entfernt sie </td></tr><tr><td>  post / api / upload / (Waren | Benutzer) </td><td>  mehrteilig (Name, Datei) </td><td>  L√§dt Fotoanzeigen / Benutzer-Avatar hoch </td></tr></tbody></table><br><p>  * - Pflichtfelder <br>  api - erfordert autorisierung, pub - nr </p><br><p>  Bei einer Get-Anforderung, die nicht mit der oben genannten √ºbereinstimmt, sucht der Server im Verzeichnis nach einer Datei f√ºr statische Daten (z. B. / img / * - images, /index.html - the client). <br>  Jeder API-Punkt gibt bei Erfolg einen 200-Antwortcode, bei einem Fehler 400 oder 404 und bei Bedarf eine kurze Nachricht zur√ºck. <br>  Zugriffsrechte sind einfach: Das Erstellen eines Eintrags steht einem autorisierten Benutzer zur Verf√ºgung, das Bearbeiten f√ºr den Autor und den Moderator. Der Administrator kann Moderatoren bearbeiten und ernennen. <br>  Die API ist mit der einfachsten Anti-Vandalismus-Funktion ausgestattet: Aktionen werden zusammen mit der Benutzer-ID und der IP-Adresse protokolliert. Bei h√§ufigem Zugriff wird ein Fehler zur√ºckgegeben, in dem Sie aufgefordert werden, etwas zu warten (n√ºtzlich gegen das Erraten von Kennw√∂rtern). </p><br><h2 id="klient">  Kunde </h2><br><p>  Ich mag das Konzept des reaktiven Web'a. Ich denke, dass die meisten modernen Websites / Anwendungen entweder im Rahmen dieses Konzepts oder vollst√§ndig statisch erstellt werden sollten.  Andererseits kann eine einfache Site mit Megabyte JS-Code nur dr√ºcken.  Meiner Meinung nach kann dieses (und nicht nur) Problem von Svelte gel√∂st werden.  Dieses Framework (oder besser gesagt die Sprache zum Erstellen reaktiver Schnittstellen) ist Vue in der erforderlichen Funktionalit√§t nicht unterlegen, hat jedoch einen unbestreitbaren Vorteil: Komponenten werden in Vanilla JS kompiliert, wodurch sowohl die Gr√∂√üe des Bundles als auch die Belastung der virtuellen Maschine (bundle.min.js.gz) reduziert werden Unser Flohmarkt ist nach heutigen Ma√üst√§ben bescheiden (24 KB).  Details finden Sie in der offiziellen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> . </p><br><p>  Wir w√§hlen den SvelteJS-Flohmarkt f√ºr die Kundenseite des Flohmarktes. Wir w√ºnschen Rich Harris alles Gute und die weitere Entwicklung des Projekts! </p><br><p>  PS Ich m√∂chte niemanden beleidigen.  Ich bin sicher, dass jeder Spezialist und jedes Projekt seine eigenen Werkzeuge hat. </p><br><h3 id="klient--dannye">  Kunde / Daten </h3><br><h4 id="url">  URL </h4><br><p>  Wir verwenden f√ºr die Navigation.  Wir simulieren kein mehrseitiges Dokument, sondern verwenden Hash-Seiten mit Abfrageparametern.  F√ºr √úberg√§nge k√∂nnen Sie das √ºbliche &lt;a&gt; ohne js verwenden. </p><br><p>  Abschnitte entsprechen Datentypen: <u>/ # Waren</u> , <u>/ # Beitr√§ge</u> , <u>/ # Benutzer</u> . <br>  Parameter <u>:? Id =</u> <em>record_id</em> <u>,? Page =</u> <em>page_number</em> <u>,? Search =</u> <em>search_query</em> . </p><br><p>  Einige Beispiele: </p><br><ul><li>  <u>/ # posts? id = 1542309643 &amp; page = 999 &amp; search = {auth: anon}</u> - Abschnittsbeitr√§ge, Beitrags-ID - <em>1542309643</em> , Kommentarseite - <em>999</em> , Suchabfrage - <em>{auth: anon}</em> </li><li>  <u>/ # Waren? Seite = 2 &amp; Suche = Siddhartha</u> - Abschnitt <em>Waren</em> , Abschnitt Seite - <em>2</em> , Suchabfrage - <em>Siddhartha</em> </li><li>  <u>/ # Waren? search = wer {Schl√ºssel: Wert} t</u> - Abschnitt <em>Waren</em> , Suchabfrage - besteht aus der Suche nach der <em>wert-</em> Teilzeichenfolge in der Kopfzeile oder im Text der Anzeige und dem Teilzeichenfolgenwert in der <em>Schl√ºsseleigenschaft</em> des tabellarischen Teils der Anzeige </li><li>  <u>/ # Waren? search = {Modell: 100, Anzeige: 256}</u> - Ich denke, hier ist analog alles klar </li></ul><br><p>  Die Funktionen des Parsens und der URL-Generierung in unserer Implementierung sehen folgenderma√üen aus: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(<span class="hljs-string"><span class="hljs-string">'hashchange'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hash = location.hash.slice(<span class="hljs-number"><span class="hljs-number">1</span></span>).split(<span class="hljs-string"><span class="hljs-string">'?'</span></span>), result = {} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!hash[<span class="hljs-number"><span class="hljs-number">1</span></span>]) hash[<span class="hljs-number"><span class="hljs-number">1</span></span>].split(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function"> =&gt;</span></span> { str = str.split(<span class="hljs-string"><span class="hljs-string">'='</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!str[<span class="hljs-number"><span class="hljs-number">0</span></span>] &amp;&amp; !!str[<span class="hljs-number"><span class="hljs-number">1</span></span>]) result[<span class="hljs-built_in"><span class="hljs-built_in">decodeURI</span></span>(str[<span class="hljs-number"><span class="hljs-number">0</span></span>]).toLowerCase()] = <span class="hljs-built_in"><span class="hljs-built_in">decodeURI</span></span>(str[<span class="hljs-number"><span class="hljs-number">1</span></span>]).toLowerCase() }) result.type = hash[<span class="hljs-number"><span class="hljs-number">0</span></span>] || <span class="hljs-string"><span class="hljs-string">'goods'</span></span> store.set({ <span class="hljs-attr"><span class="hljs-attr">hash</span></span>: result }) }) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goto</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ type, id, page, search }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { hash } = store.get(), args = <span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>], query = [] <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-string"><span class="hljs-string">'id'</span></span>, <span class="hljs-string"><span class="hljs-string">'page'</span></span>, <span class="hljs-string"><span class="hljs-string">'search'</span></span>).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">key</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = args[key] !== <span class="hljs-literal"><span class="hljs-literal">undefined</span></span> ? args[key] : hash[key] || <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value !== <span class="hljs-literal"><span class="hljs-literal">null</span></span>) query.push(key + <span class="hljs-string"><span class="hljs-string">'='</span></span> + value) }) location.hash = (type || hash.type || <span class="hljs-string"><span class="hljs-string">'goods'</span></span>) + (!!query.length ? <span class="hljs-string"><span class="hljs-string">'?'</span></span> + query.join(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>) : <span class="hljs-string"><span class="hljs-string">''</span></span>) }</code> </pre> <br><h4 id="api">  API </h4><br><p>  Um Daten mit dem Server auszutauschen, verwenden wir die Fetch-API.  Um aktualisierte Datens√§tze in kurzen Abst√§nden <em>herunterzuladen</em> , <em>senden</em> wir eine Anfrage an <em>/ pub / mtimes</em> . Wenn der Zeitpunkt der letzten √Ñnderung f√ºr einen Typ vom lokalen abweicht, laden wir eine Liste dieses Typs.  Ja, es war m√∂glich, Benachrichtigungen √ºber Updates √ºber SSE oder WebSockets und inkrementelles Laden zu implementieren, aber in diesem Fall k√∂nnen wir darauf verzichten.  Was haben wir bekommen: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GET</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(location.origin + <span class="hljs-string"><span class="hljs-string">'/pub/'</span></span> + type) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">ok</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> })) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type === <span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) store.set({ <span class="hljs-attr"><span class="hljs-attr">online</span></span>: response.ok }) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.ok ? <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> response.json() : [] } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type, mtimes, updates = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> local = store.get()._mtimes, net = mtimes || <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> GET(<span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!net[type] || local[type] === net[type]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = updates[<span class="hljs-string"><span class="hljs-string">'_'</span></span> + type] = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> GET(type) local[type] = net[type]; updates._mtimes = local <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!value &amp;&amp; !!value.sort) store.set(updates) } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkUpdates</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> checkUpdates(), <span class="hljs-number"><span class="hljs-number">30000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mtimes = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> store.GET(<span class="hljs-string"><span class="hljs-string">'mtimes'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>(<span class="hljs-string"><span class="hljs-string">'users'</span></span>, <span class="hljs-string"><span class="hljs-string">'goods'</span></span>, <span class="hljs-string"><span class="hljs-string">'posts'</span></span>, <span class="hljs-string"><span class="hljs-string">'cmnts'</span></span>, <span class="hljs-string"><span class="hljs-string">'files'</span></span>) .forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">type</span></span></span><span class="hljs-function"> =&gt;</span></span> checkUpdate(type, mtimes)) }</code> </pre> <br><p>  Zum Filtern und Paginieren verwenden wir die berechneten Eigenschaften von Svelte basierend auf Navigationsdaten.  Die Richtung der berechneten Werte lautet: <strong>Elemente</strong> (Arrays von Datens√§tzen, die vom Server stammen) =&gt; <strong>ignoreItems</strong> (gefilterte Datens√§tze basierend auf der Ignorierliste des aktuellen Benutzers) =&gt; <strong>scribedItems</strong> (filtert Datens√§tze gem√§√ü der Liste der Abonnements, wenn dieser Modus aktiviert ist) =&gt; <strong>curItem</strong> und <strong>curItems</strong> (berechnet die aktuellen Datens√§tze je nach Abschnitt) =&gt; <strong>filteredItems</strong> (filtert Datens√§tze abh√§ngig von der Suchabfrage, wenn es nur einen Datensatz gibt - filtert Kommentare darauf) =&gt; <strong>maxPage</strong> (berechnet die Anzahl der Seiten basierend auf 12 Datens√§tzen / Kommentaren pro Seite) =&gt; <strong>pagedItem</strong> (gibt das endg√ºltige Array mit zur√ºck  Beitr√§ge / Kommentare basierend auf der aktuellen Seitenzahl). </p><br><p>  Kommentare und Bilder ( <strong>Kommentare</strong> und <strong>_Bilder</strong> ) werden separat berechnet und nach Typ und Eigent√ºmerdatensatz gruppiert. </p><br><p>  Berechnungen erfolgen automatisch und nur wenn sich die zugeh√∂rigen Daten √§ndern, befinden sich die Zwischendaten st√§ndig im Speicher.  In dieser Hinsicht ziehen wir eine unangenehme Schlussfolgerung - f√ºr eine gro√üe Menge an Informationen und / oder deren h√§ufige Aktualisierung kann eine gro√üe Menge an Ressourcen aufgewendet werden. </p><br><h4 id="cache">  Cache </h4><br><p>  Entsprechend der Entscheidung, eine Offline-Anwendung zu erstellen, implementieren wir die Speicherung von Datens√§tzen und einigen Aspekten des Status in localStorage, Bilddateien in CacheStorage.  Die Arbeit mit localStorage ist √§u√üerst einfach. Wir sind uns einig, dass Eigenschaften mit dem Pr√§fix "_" beim Neustart automatisch gespeichert und wiederhergestellt werden, wenn sie ge√§ndert werden.  Dann k√∂nnte unsere L√∂sung so aussehen: </p><br><pre> <code class="javascript hljs">store.on(<span class="hljs-string"><span class="hljs-string">'state'</span></span>, ({ changed, current }) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(changed).forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prop</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!prop.indexOf(<span class="hljs-string"><span class="hljs-string">'_'</span></span>)) localStorage.setItem(prop, <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(current[prop])) }) }) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadState</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; localStorage.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> prop = localStorage.key(i) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(localStorage.getItem(prop) || <span class="hljs-string"><span class="hljs-string">'null'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!value &amp;&amp; !prop.indexOf(<span class="hljs-string"><span class="hljs-string">'_'</span></span>)) state[prop] = value } store.set(state) }</code> </pre> <br><p>  Dateien sind etwas komplizierter.  Zun√§chst verwenden wir die Liste aller relevanten Dateien (mit Erstellungszeit), die vom Server stammen.  Wenn wir diese Liste aktualisieren, vergleichen wir sie mit den alten Werten, legen die neuen Dateien in CacheStorage ab und l√∂schen die veralteten von dort: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cacheImages</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newFiles</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> oldFiles = <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(localStorage.getItem(<span class="hljs-string"><span class="hljs-string">'_files'</span></span>) || <span class="hljs-string"><span class="hljs-string">'[]'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> cache = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(<span class="hljs-string"><span class="hljs-string">'comico'</span></span>) oldFiles.forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">file</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!~newFiles.indexOf(file)) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [ id, type ] = file.split(<span class="hljs-string"><span class="hljs-string">':'</span></span>) cache.delete(<span class="hljs-string"><span class="hljs-string">`/img/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${type}</span></span></span><span class="hljs-string">_</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">_sm.jpg`</span></span>) }}) newFiles.forEach(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">file</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!~oldFiles.indexOf(file)) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> [ id, type ] = file.split(<span class="hljs-string"><span class="hljs-string">':'</span></span>), src = <span class="hljs-string"><span class="hljs-string">`/img/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${type}</span></span></span><span class="hljs-string">_</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${id}</span></span></span><span class="hljs-string">_sm.jpg`</span></span> cache.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Request(src, { <span class="hljs-attr"><span class="hljs-attr">cache</span></span>: <span class="hljs-string"><span class="hljs-string">'no-cache'</span></span> })) }}) }</code> </pre> <br><p>  Anschlie√üend m√ºssen Sie das Abrufverhalten neu definieren, damit die Datei aus CacheStorage entnommen wird, ohne eine Verbindung zum Server herzustellen.  Dazu m√ºssen Sie ServiceWorker verwenden.  Gleichzeitig konfigurieren wir andere Dateien, die zwischengespeichert werden sollen, damit sie au√üerhalb der Kommunikation mit dem Server funktionieren: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CACHE = <span class="hljs-string"><span class="hljs-string">'comico'</span></span>, FILES = [ <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-string"><span class="hljs-string">'/bundle.css'</span></span>, <span class="hljs-string"><span class="hljs-string">'/bundle.js'</span></span> ] self.addEventListener(<span class="hljs-string"><span class="hljs-string">'install'</span></span>, (e) =&gt; { e.waitUntil(caches.open(CACHE).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cache</span></span></span><span class="hljs-function"> =&gt;</span></span> cache.addAll(FILES)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> self.skipWaiting())) }) self.addEventListener(<span class="hljs-string"><span class="hljs-string">'fetch'</span></span>, (e) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> r = e.request <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (r.method !== <span class="hljs-string"><span class="hljs-string">'GET'</span></span> || !!~r.url.indexOf(<span class="hljs-string"><span class="hljs-string">'/pub/'</span></span>) || !!~r.url.indexOf(<span class="hljs-string"><span class="hljs-string">'/api/'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!~r.url.lastIndexOf(<span class="hljs-string"><span class="hljs-string">'_sm.jpg'</span></span>) &amp;&amp; e.request.cache !== <span class="hljs-string"><span class="hljs-string">'no-cache'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> e.respondWith(fromCache(r)) e.respondWith(toCache(r)) }) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromCache</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(CACHE)).match(request) || <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Response(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, { <span class="hljs-attr"><span class="hljs-attr">status</span></span>: <span class="hljs-number"><span class="hljs-number">404</span></span> }) } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toCache</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">request</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(request).catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> fromCache(request)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!!response &amp;&amp; response.ok) (<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> caches.open(CACHE)).put(request, response.clone()) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response }</code> </pre> <br><p>  Es sieht etwas ungeschickt aus, erf√ºllt aber seine Funktionen. </p><br><h3 id="klient--interfeys">  Client / Schnittstelle </h3><br><p>  Komponentenstruktur: <br>  index.html |  main.js <br>  == <u>header.html</u> - enth√§lt ein Logo, eine Statusleiste, ein Hauptmen√º, ein unteres Navigationsmen√º und ein Formular zum <u>Einreichen von</u> Kommentaren <br>  == <u>beiseite.html</u> - ist ein Container f√ºr alle modalen Komponenten <br>  ==== <u>goodForm.html</u> - Formular zum Hinzuf√ºgen und Bearbeiten einer Anzeige <br>  ==== userForm.html - Formular des aktuellen Benutzers bearbeiten <br>  ====== <u>tableForm.html</u> - Ein Fragment des Formulars zur Eingabe von Tabellendaten <br>  ==== <u>postForm.html</u> - Formular f√ºr den Forumsbeitrag <br>  ==== <u>login.html</u> - <u>Anmelde-</u> / Registrierungsformular <br>  ==== <u>activity.html</u> - Zeigt Kommentare an, die an den aktuellen Benutzer gerichtet sind <br>  ==== <u>goodImage.html</u> - Zeigen <u>Sie</u> die Haupt- und <u>Zusatzfotoanzeigen an</u> <br>  == <u>main.html</u> - Container f√ºr den Hauptinhalt <br>  ==== <u>goods.html</u> - Liste oder einzelne Ank√ºndigungskarten <br>  ==== <u>users.html</u> - Gleiches gilt f√ºr Benutzer <br>  ==== <u>posts.html</u> - Ich denke, es ist klar <br>  ==== <u>cmnts.html</u> - Liste der Kommentare zum aktuellen <u>Beitrag</u> <br>  ====== <u>cmntsPager.html</u> - Paginierung f√ºr Kommentare </p><br><ul><li>  In jeder Komponente versuchen wir, die Anzahl der HTML-Tags zu minimieren. </li><li>  Wir verwenden Klassen nur als Indikator f√ºr den Zustand. </li><li>  Wir nehmen √§hnliche Funktionen wie der Store heraus (schlanke Store-Eigenschaften und -Methoden k√∂nnen direkt von Komponenten verwendet werden, indem ihnen das Pr√§fix '$' hinzugef√ºgt wird). </li><li>  Die meisten Funktionen erwarten ein Benutzerereignis oder eine √Ñnderung bestimmter Eigenschaften, bearbeiten die Statusdaten, speichern das Ergebnis ihrer Arbeit im Status und beenden es.  Somit wird eine geringe Koh√§renz und Erweiterbarkeit des Codes erreicht. </li><li>  F√ºr die scheinbare Geschwindigkeit von √úberg√§ngen und anderen UI-Ereignissen trennen wir Manipulationen mit Daten im Hintergrund und Aktionen im Zusammenhang mit der Schnittstelle so weit wie m√∂glich. Dabei wird das aktuelle Berechnungsergebnis verwendet und bei Bedarf neu erstellt. Der Rest wird freundlicherweise vom Framework ausgef√ºhrt. </li><li>  Die Daten des auszuf√ºllenden Formulars werden f√ºr jede Eingabe in localStorage gespeichert, um deren Verlust zu verhindern. </li><li>  In allen Komponenten verwenden wir den unver√§nderlichen Modus, in dem das Eigenschaftsobjekt nur dann als ge√§ndert betrachtet wird, wenn ein neuer Link empfangen wird, unabh√§ngig von der √Ñnderung in den Feldern, wodurch unsere Anwendungen ein wenig beschleunigt werden, wenn auch aufgrund einer geringf√ºgigen Erh√∂hung der Codemenge. </li></ul><br><h3 id="klient--upravlenie">  Kunde / Management </h3><br><p>  Zur Steuerung √ºber die Tastatur verwenden wir die folgenden Kombinationen: <br>  <strong>Alt + s</strong> / <strong>Alt + a</strong> - schaltet die Seite der Datens√§tze vorw√§rts / r√ºckw√§rts, w√§hrend ein Datensatz die Seite der Kommentare wechselt. <br>  <strong>Alt + w</strong> / <strong>Alt + q</strong> - wechselt zum n√§chsten / vorherigen Datensatz (falls vorhanden), arbeitet im Listenmodus, in einem einzelnen Datensatz und in der Bildansicht <br>  <strong>Alt + x</strong> / <strong>Alt + z</strong> - scrollt die Seite nach unten / oben.  Schaltet in der Bildansicht Bilder vorw√§rts / r√ºckw√§rts um <br>  <strong>Escape</strong> - schlie√üt das modale Fenster, wenn es ge√∂ffnet ist, kehrt zur Liste zur√ºck, wenn ein einzelner Eintrag ge√∂ffnet ist, bricht die Suchabfrage im Listenmodus ab <br>  <strong>Alt + c</strong> - konzentriert sich je nach aktuellem Modus auf das Such- oder Kommentarfeld <br>  <strong>Alt + V</strong> - Aktivieren / Deaktivieren des Fotoansichtsmodus f√ºr eine einzelne Anzeige <br>  <strong>Alt + r</strong> - √∂ffnet / schlie√üt die Liste der eingehenden Kommentare f√ºr einen autorisierten Benutzer <br>  <strong>Alt + t</strong> - Schaltet helle / dunkle Themen um <br>  <strong>Alt + g</strong> - Liste der Anzeigen <br>  <strong>Alt + u</strong> - Benutzer <br>  <strong>Alt + p</strong> - Forum <br>  Ich wei√ü, dass diese Kombinationen in vielen Browsern vom Browser selbst verwendet werden, aber f√ºr mein Chrome konnte ich mir nichts Bequemeres einfallen lassen.  Ich freue mich √ºber Ihre Vorschl√§ge. </p><br><p>  Neben der Tastatur k√∂nnen Sie nat√ºrlich auch die Browserkonsole verwenden.  Beispiel: <em>store.goBack ()</em> , <em>store.nextPage ()</em> , <em>store.prevPage ()</em> , <em>store.nextItem ()</em> , <em>store.prevItem ()</em> , <em>store.search (stringValue)</em> , <em>store.checkUpdate ('Waren' || ' Benutzer '||' Beitr√§ge '||' Dateien '||' cmnts ')</em> - tun, was der Name impliziert;  <em>store.get (). Kommentare</em> und <em>store.get () ._ images</em> - gibt gruppierte Dateien und Kommentare zur√ºck;  <em>store.get (). ignoreItems</em> und <em>store.get (). scribedItems</em> sind Listen von Datens√§tzen, die Sie ignorieren und verfolgen.  Eine vollst√§ndige Liste aller Zwischen- und berechneten Daten finden Sie unter <em>store.get ()</em> .  Ich glaube nicht, dass jemand dies ernsthaft braucht, aber das Filtern von Datens√§tzen nach Benutzer und das L√∂schen von Datens√§tzen schien mir von der Konsole aus recht praktisch zu sein. </p><br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  Hier k√∂nnen Sie Ihre Bekanntschaft mit dem Projekt beenden, weitere Details finden Sie im Quellcode.  Als Ergebnis haben wir eine ziemlich schnelle und kompakte Anwendung erhalten, die in den meisten Pr√ºfern f√ºr Validatoren, Sicherheit, Geschwindigkeit, Verf√ºgbarkeit usw. gute Ergebnisse ohne gezielte Optimierung zeigt. <br>  Ich w√ºrde gerne die Meinung der Community erfahren, wie gerechtfertigt die Ans√§tze zur Organisation der im Prototyp verwendeten Anwendungen sind, welche Fallstricke es geben k√∂nnte und was Sie grundlegend anders implementieren w√ºrden. <br>  Quellcode, Beispielinstallationsanweisungen und Demo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> (bitte <del>  zerst√∂ren </del>  im Rahmen des Strafgesetzbuches zu testen). </p><br><p>  Nachtrag.  Ein wenig kaufm√§nnisch zum Schluss.  Sagen Sie mir, ist es mit einem solchen Level wirklich m√∂glich, f√ºr Geld zu programmieren?  Wenn nicht, worauf Sie zuerst achten sollten, wenn ja, sagen Sie mir, wo sie jetzt nach interessanten Arbeiten an einem √§hnlichen Stapel suchen.  Vielen Dank. </p><br><p>  Nachtrag.  Ein bisschen mehr √ºber Geld und Arbeit.  Wie gef√§llt Ihnen diese Idee: Angenommen, eine Person ist bereit, f√ºr jedes Gehalt an einem f√ºr sie interessanten Projekt zu arbeiten. Daten zu Aufgaben und deren Bezahlung werden jedoch √∂ffentlich verf√ºgbar sein (Verf√ºgbarkeit und ein Code zur Beurteilung der Leistungsqualit√§t sind w√ºnschenswert), wenn die Bezahlung deutlich unter dem Markt liegt, die Wettbewerber des Arbeitgebers kann viel Geld f√ºr die Erf√ºllung ihrer Aufgaben anbieten, wenn es h√∂her ist - viele K√ºnstler k√∂nnen ihre Dienste zu einem niedrigeren Preis anbieten.  Wird ein solches System in einigen Situationen den Markt (IT) optimaler und fairer ausbalancieren? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de435908/">https://habr.com/ru/post/de435908/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de435898/index.html">Woran Sie bei einem NALSD-Interview denken sollten</a></li>
<li><a href="../de435900/index.html">Verkapseln Sie es</a></li>
<li><a href="../de435902/index.html">Sie k√∂nnen SELECT nicht einfach nehmen und schreiben, wenn der Anbieter dies nicht zul√§sst ... aber wir werden schreiben</a></li>
<li><a href="../de435904/index.html">KI √ºbersetzte Gehirnaktivit√§t in Sprache</a></li>
<li><a href="../de435906/index.html">Schrittmacher-Cluster-Speicher + DRBD (Dual Primary) + ctdb</a></li>
<li><a href="../de435910/index.html">Warum hat BSD den Kampf mit GNU / Linux verloren?</a></li>
<li><a href="../de435912/index.html">Die Hauptprobleme bei der Entwicklung moderner Schnittstellen</a></li>
<li><a href="../de435914/index.html">Packen von ASP.NET Core-Anwendungen mit Docker</a></li>
<li><a href="../de435916/index.html">Wenn Sie VK hacken, wird die Zwei-Faktor-Authentifizierung nicht gespeichert</a></li>
<li><a href="../de435920/index.html">Entwicklerkochbuch: DDD-Rezepte (Teil 4, Strukturen)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>