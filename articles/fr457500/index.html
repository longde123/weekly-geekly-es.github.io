<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≥üèø üëäüèæ üôá Comment nous avons fait le pilote automatique pour une station-service üîï üë©üèΩ‚Äçü§ù‚Äçüë®üèø üë©üèæ‚Äçü§ù‚Äçüë©üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! Je travaille dans une petite startup √† Berlin qui d√©veloppe des pilotes automatiques pour les voitures. Nous achevons un projet de stat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons fait le pilote automatique pour une station-service</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457500/"> Bonjour, Habr!  Je travaille dans une petite startup √† Berlin qui d√©veloppe des pilotes automatiques pour les voitures.  Nous achevons un projet de stations-service d'un grand constructeur automobile allemand, et j'aimerais en parler: comment nous l'avons fait, quelles difficult√©s nous avons rencontr√©es et quelles nouvelles choses nous avons d√©couvertes.  Dans cette partie je parlerai du module de perception et un peu de l'architecture de la solution dans son ensemble.  √Ä propos du reste des modules, peut-√™tre, nous le dirons dans les parties suivantes.  Je serai tr√®s heureux de recevoir des commentaires et un regard de l'ext√©rieur sur notre approche. <br><a name="habracut"></a><br>  Le communiqu√© de presse du projet du client est disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Pour commencer, je vais vous expliquer pourquoi le constructeur automobile s'est tourn√© vers nous et n'a pas fait le projet lui-m√™me.  Il est difficile pour les grandes entreprises allemandes de modifier les processus, et le format de d√©veloppement automobile est rarement adapt√© aux logiciels - les it√©rations sont longues et n√©cessitent une bonne planification.  Il me semble que les constructeurs automobiles allemands comprennent cela, et vous pouvez donc trouver des startups qui sont fond√©es par eux, mais qui travaillent en tant qu'entreprise ind√©pendante (par exemple, AID d'Audi et Zenuity de Volvo).  D'autres constructeurs automobiles organisent des √©v√©nements comme Startup Autobahn, o√π ils recherchent des entrepreneurs potentiels pour des t√¢ches et de nouvelles id√©es.  Ils peuvent commander un produit ou un prototype et, apr√®s une courte p√©riode, obtenir le r√©sultat final.  Cela peut s'av√©rer plus rapide que d'essayer de faire la m√™me chose vous-m√™me, et cela ne co√ªte pas plus cher que son propre d√©veloppement en termes de co√ªts.  La complexit√© des changements de processus est bien d√©montr√©e par le nombre d'autorisations n√©cessaires pour commencer √† tester une voiture avec pilote automatique chez les clients: consentement √† l'enregistrement vid√©o des personnes (m√™me si nous n'enregistrons pas de donn√©es, et nous utilisons la vid√©o en streaming uniquement sous forme anonyme sans identifier des personnes sp√©cifiques), consentement √† l'enregistrement vid√©o territoires, le consentement du syndicat et du consul de travail pour tester ces technologies, le consentement du service de s√©curit√©, le consentement du service informatique - ce n'est pas toute la liste. <br><br><h2>  D√©fi </h2><br>  Dans le projet en cours, le client veut comprendre s'il est possible de conduire des voitures dans des centres de service en utilisant ¬´AI¬ª.  Le script utilisateur est: <br><br><ol><li>  Le technicien veut commencer √† travailler avec une machine qui se trouve quelque part dans le parking en dehors de la zone d'essai. </li><li>  Il s√©lectionne la voiture sur la tablette, s√©lectionne la bo√Æte de service et clique sur "Drive in". </li><li>  La voiture roule √† l'int√©rieur et s'arr√™te au point final (ascenseur, rampe ou autre chose). </li><li>  Lorsque le technicien a fini de travailler sur la voiture, il appuie sur un bouton de la tablette, la voiture sort et se gare dans un espace vide √† l'ext√©rieur. </li></ol><br>  Caract√©ristiques: toutes les voitures n'ont pas de cam√©ras.  Sur les machines sur lesquelles ils se trouvent, nous n'y avons pas acc√®s.  Les seules donn√©es sur la machine auxquelles nous avons acc√®s sont les sonars et l'odom√©trie <br><br><div class="spoiler">  <b class="spoiler_title">Sonars et odom√©trie</b> <div class="spoiler_text">  Les sonars sont des capteurs de distance qui sont install√©s en cercle sur une voiture et ressemblent souvent √† des points ronds, ils vous permettent d'estimer la distance √† l'objet, mais seulement de pr√®s et avec une faible pr√©cision.  Odom√©trie - donn√©es sur la vitesse et la direction r√©elles de la voiture.  Connaissant ces donn√©es et la position initiale, vous pouvez d√©terminer assez pr√©cis√©ment la position actuelle de la machine. <br></div></div><br>  Ainsi, la voiture doit √™tre contr√¥l√©e par des capteurs externes install√©s dans la zone de service. <br><br><h2>  Solution </h2><br>  L'architecture du produit final est la suivante: <br><br><ul><li>  Dans la zone de service, nous installons des cam√©ras externes, des lidars et d'autres choses (bonjour Tesla). </li><li>  Les donn√©es des cam√©ras sont transmises √† Jetson TX2 (trois cam√©ras chacune), qui sont charg√©es de trouver la machine et de pr√©-traiter les images des cam√©ras. </li><li>  De plus, les donn√©es de la cam√©ra arrivent au serveur central, qui est fi√®rement appel√© tour de contr√¥le et sur lequel elles tombent dans les modules de perception, de suivi et de planification de chemin.  √Ä la suite de l'analyse, une d√©cision est prise sur le sens de d√©placement suppl√©mentaire de la voiture et elle est envoy√©e √† la voiture. </li><li>  √Ä ce stade du projet, un autre Jetson TX2 est plac√© dans la voiture, qui, √† l'aide de notre pilote, se connecte √† Vector, qui d√©chiffre les donn√©es de la voiture et envoie des commandes.  TX2 re√ßoit les commandes de contr√¥le d'un serveur central et les diffuse √† la voiture. </li></ul><br>  Pour le niveau d'infrastructure, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ROS est</a> utilis√©. <br><br>  Voici ce qui se passe apr√®s qu'un technicien ait choisi une voiture et cliqu√© sur ¬´conduire¬ª: <br><br><ol><li>  Le syst√®me recherche une voiture: nous envoyons une commande √† la voiture pour faire clignoter les alarmes, apr√®s quoi nous pouvons d√©terminer laquelle des voitures dans le parking est s√©lectionn√©e par le technicien.  Au stade initial du d√©veloppement, nous avons √©galement envisag√© la possibilit√© de d√©terminer la machine par la plaque d'immatriculation, mais dans certaines zones de la voiture gar√©e, le num√©ro peut ne pas √™tre visible.  De plus, si nous d√©terminions la voiture par son num√©ro d'immatriculation, la r√©solution des photos devrait √™tre consid√©rablement augment√©e, ce qui affecterait n√©gativement la productivit√©, et nous utilisons la m√™me image pour la recherche et la conduite.  Cette √©tape se produit une fois et n'est r√©p√©t√©e que si, pour une raison quelconque, nous avons perdu la voiture lors du suivi. </li><li>  D√®s que la voiture est trouv√©e, nous d√©posons les images des cam√©ras que la voiture frappe dans le module de perception, qui segmente l'espace et donne les coordonn√©es de tous les objets, leur orientation et leurs tailles.  Ce processus est en cours, fonctionnant √† environ 30 images par seconde.  Les processus suivants sont √©galement constants et ex√©cut√©s jusqu'√† ce que la machine arrive au point final. </li><li>  Le module de suivi re√ßoit les entr√©es de la perception, des sonars et de l'odom√©trie, stocke tous les objets trouv√©s en m√©moire, les combine, affine l'emplacement, pr√©dit la position et la vitesse des objets. </li><li>  Ensuite, le planificateur de chemin, qui est divis√© en deux parties: planificateur de chemin global pour l'itin√©raire global et planificateur de chemin local pour le local (responsable d'√©viter les obstacles), construit un chemin et d√©cide o√π aller √† notre voiture, envoie une commande. </li><li>  Jetson prend la commande en voiture et la diffuse dans la voiture. </li></ol><br>  Le d√©part s'effectue de la m√™me mani√®re que l'arriv√©e. <br><br><h2>  Perception </h2><br>  L'un des modules principaux et, √† mon avis, le plus int√©ressant est la perception.  Ce module d√©crit les donn√©es des capteurs de mani√®re √† ce que vous puissiez prendre une d√©cision pr√©cise sur le mouvement.  Dans notre projet, il donne les coordonn√©es, l'orientation et les tailles de tous les objets qui tombent sur la cam√©ra.  Lors de la conception de ce module, nous avons d√©cid√© de commencer par des algorithmes qui nous permettraient d'analyser l'image en une seule passe.  Nous avons essay√©: <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VAE d√©m√™l√©</a> .  Une petite modification apport√©e √† la Œ≤-VAE nous a permis de former le r√©seau afin que les vecteurs latents stockent les informations d'image dans une vue sch√©matique descendante. </li><li>  GAN conditionnel (l'impl√©mentation la plus connue est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pix2pix</a> ).  Ce r√©seau peut √™tre utilis√© pour cr√©er des cartes.  Nous l'avons √©galement utilis√© pour construire une vue sch√©matique d'en haut, en y mettant les donn√©es d'une ou de toutes les cam√©ras en m√™me temps et en attendant une vue sch√©matique d'en haut en sortie. </li></ol><br>  <i>L'une des it√©rations GAN conditionnelles pour une cam√©ra, de gauche √† droite: image d'entr√©e, pr√©diction de r√©seau, r√©sultat attendu</i> <br><br><img src="https://habrastorage.org/webt/w1/m9/ax/w1m9ax7idlos-x3jawcob3kmxzm.png"><br><br>  En fait, l'id√©e de ces approches est de s'assurer que le r√©seau final peut comprendre l'emplacement et l'orientation de toutes les voitures et autres objets en mouvement qui sont tomb√©s sur l'appareil photo en regardant une fois la photo d'entr√©e.  Dans ce cas, les donn√©es sur les objets seront stock√©es dans des vecteurs latents.  La formation du r√©seau a eu lieu sur les donn√©es du simulateur, qui est une copie exacte du point o√π la d√©monstration aura lieu.  Et nous avons r√©ussi √† obtenir certains r√©sultats, mais nous avons d√©cid√© de ne pas utiliser ces m√©thodes pour plusieurs raisons: <br><br><ul><li>  Dans le temps imparti, nous n'avons pas pu apprendre √† utiliser les donn√©es des vecteurs latents pour d√©crire l'image.  Le r√©sultat du r√©seau a toujours √©t√© une image - une vue de dessus avec une disposition sch√©matique des objets.  C'est moins pr√©cis et nous craignions qu'une telle pr√©cision ne soit pas suffisante pour conduire une voiture. </li><li>  La solution n'est pas √©volutive: pour toutes les installations ult√©rieures et pour les cas o√π vous devez changer la direction de certaines cam√©ras, une reconfiguration du simulateur et une formation compl√®te r√©p√©t√©e sont n√©cessaires. </li></ul><br>  N√©anmoins, nous √©tions int√©ress√©s √† comprendre les possibilit√©s de ces approches, et nous les garderons √† l'esprit pour les t√¢ches futures. <br><br>  Apr√®s cela, nous avons abord√© la t√¢che d'autre part, √† travers une recherche r√©guli√®re d'objets + un r√©seau pour d√©terminer la position spatiale des objets trouv√©s (par exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ceci</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cela</a> ).  Cette option nous a sembl√© la plus pr√©cise.  Le seul inconv√©nient est qu'il est plus lent que les approches propos√©es auparavant, mais il s'inscrit dans notre cadre de retard possible, car la vitesse de la voiture dans la zone de service ne d√©passe pas 5 km / h.  Le travail le plus int√©ressant dans le domaine de la pr√©diction de la position 3D de l'objet nous a sembl√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">celui-ci</a> , qui montre de tr√®s bons r√©sultats sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">KITTI</a> .  Nous avons construit un r√©seau similaire avec quelques changements et √©crit notre propre algorithme pour d√©terminer la bo√Æte environnante, et pour √™tre plus pr√©cis, un algorithme pour estimer les coordonn√©es du centre de la projection de l'objet sur le sol - pour prendre des d√©cisions sur la direction du mouvement, nous n'avons pas besoin de donn√©es sur la hauteur des objets.  L'image de l'objet et son type (voiture, pi√©ton, ..) sont transmis √† l'entr√©e du r√©seau, et ses dimensions et son orientation spatiale sont sorties.  Ensuite, le module √©value le centre de projection et fournit des donn√©es pour tous les objets: les coordonn√©es du centre, l'orientation et les dimensions (largeur et longueur). <br><br>  Dans le produit final, chaque image est d'abord parcourue √† travers le r√©seau pour rechercher des objets, puis tous les objets sont envoy√©s au r√©seau 3D pour pr√©dire l'orientation et la taille, apr√®s quoi nous estimons le centre de projection de chacun et l'envoyons ainsi que les donn√©es d'orientation et de taille.  Une caract√©ristique de cette m√©thode est qu'elle est tr√®s fortement li√©e √† la pr√©cision de la fronti√®re de la bo√Æte fronti√®re du r√©seau de recherche d'objets.  Pour cette raison, des r√©seaux comme YOLO ne nous convenaient pas.  Nous avons trouv√© l'√©quilibre optimal entre les performances et la pr√©cision de la bo√Æte fronti√®re sur le r√©seau RetinaNet. <br><br>  Il convient de noter une chose qui nous a eu de la chance sur ce projet: le terrain est plat.  Eh bien, ce n'est pas aussi plat qu'une communaut√© bien connue, mais il n'y a pas de virages sur notre territoire.  Cela permet l'utilisation de cam√©ras monoculaires fixes pour projeter des objets dans les coordonn√©es du plan terrestre sans information sur la distance √† l'objet.  Les plans futurs comprennent l'introduction de la pr√©vision monoculaire de la profondeur.  Il y a beaucoup de travaux sur ce sujet, par exemple, l'un des derniers et tr√®s int√©ressants que nous essayons pour de futurs projets.  La pr√©diction de la profondeur vous permettra de travailler non seulement sur un sol plat, elle devrait potentiellement augmenter la pr√©cision de la d√©termination des obstacles, simplifier le processus de configuration de nouvelles cam√©ras et √©liminer la n√©cessit√© d'√©tiqueter chaque objet - peu nous importe quel type d'objet il s'agit s'il s'agit d'une sorte d'obstacle. <br><br>  C'est tout, merci d'avoir lu, et je serai heureux de r√©pondre aux questions.  En prime, je veux parler d'un effet n√©gatif inattendu: le pilote automatique ne se soucie pas de l'orientation de la voiture, pour lui, peu importe comment aller - avant ou arri√®re.  L'essentiel est de conduire de mani√®re optimale et de ne pas percuter qui que ce soit.  Par cons√©quent, il y a une forte probabilit√© que la voiture se d√©place une partie du chemin en marche arri√®re, en particulier dans les petites zones o√π une grande maniabilit√© est requise.  Cependant, les gens sont habitu√©s au fait que la voiture avance principalement et attendent souvent le m√™me comportement du pilote automatique.  Si un homme d'affaires voit une voiture qui, au lieu de rouler en avant, recule, il peut consid√©rer que le produit n'est pas pr√™t et contient des erreurs. <br><br>  <b>PS</b> Je m'excuse qu'il n'y a pas d'images et de vid√©os avec de vrais tests, mais je ne peux pas les publier pour des raisons l√©gales. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457500/">https://habr.com/ru/post/fr457500/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457468/index.html">M√©moire universelle: SRAM, DRAM et m√©moire flash dans une bouteille</a></li>
<li><a href="../fr457470/index.html">Calcul des feuilles: comment un buisson inhabituel a chang√© l'√©quation d'un mod√®le de croissance v√©g√©tale</a></li>
<li><a href="../fr457476/index.html">R√©duction de la taille d'une image Docker avec une application Spring Boot</a></li>
<li><a href="../fr457480/index.html">Cr√©ation d'une application d'√©coute pour visualiser le trafic MMORPG mobile</a></li>
<li><a href="../fr457490/index.html">Aisioshechka de Zuckerberg - bri√®vement et dans le cas de la Balance</a></li>
<li><a href="../fr457502/index.html">Comment le mod√®le de notation RICE am√©liore la hi√©rarchisation des fonctionnalit√©s du produit</a></li>
<li><a href="../fr457504/index.html">Pourquoi √©crire votre grille de donn√©es React en 2019</a></li>
<li><a href="../fr457510/index.html">Utilisez mcrouter pour faire √©voluer horizontalement memcached</a></li>
<li><a href="../fr457512/index.html">R√©plication logique entre les versions de PostgreSQL</a></li>
<li><a href="../fr457514/index.html">Nevanger</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>