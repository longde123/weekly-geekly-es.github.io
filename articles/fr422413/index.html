<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçº üë®üèº‚Äçüîß ü§ôüèΩ Application de Arm Mbed OS. R√©glage fin üòÄ ü•† üåî</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apr√®s avoir utilis√© Arm Mbed OS, il √©tait possible de faire clignoter une LED , il √©tait temps de tester et de configurer d'autres services importants...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Application de Arm Mbed OS. R√©glage fin</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422413/"><p><img src="https://habrastorage.org/webt/db/tg/fq/dbtgfq4owssxgshqlazk5lwycxm.png" alt="LNDC1"></p><br><p>  Apr√®s avoir utilis√© <strong>Arm Mbed OS,</strong> il √©tait possible de faire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">clignoter une LED</a> , il √©tait temps de tester et de configurer d'autres services importants.  Ce qui suit est d√©crit: </p><br><ul><li>  <strong>Technologie de</strong> configuration <strong>Mbed</strong> </li><li>  Pourquoi est-il difficile de passer au <strong>C ++</strong> dans <strong>RTOS</strong> normal </li><li>  Comment √©conomiser de la m√©moire dans <strong>RTOS</strong> </li><li>  Comment les interruptions sont-elles organis√©es dans <strong>Mbed OS</strong> </li><li>  <strong>Qu'il</strong> est pratique de d√©boguer le <strong>syst√®me d'exploitation Mbed</strong> </li><li>  Comment se d√©barrasser d'une couche suppl√©mentaire d'abstraction <strong>SDK</strong> </li></ul><a name="habracut"></a><br><p>  <em>Nous continuons notre connaissance de la technologie de programmation des microcontr√¥leurs de la famille <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MKE18F</a> utilisant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ARM Mbed OS</a></em> </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Premier article</a> </li></ul><br><h2 id="tehnologiya-konfigurirovaniya-mbed">  Technologie de configuration Mbed </h2><br><p>  Un √©l√©ment important du projet Mbed est le syst√®me de <strong>configuration</strong> et d'assemblage <strong>automatiques</strong> , en <strong>ligne</strong> et <strong>hors ligne</strong> , c'est-√†-dire  localement sur l'ordinateur de l'utilisateur.  Il est propos√© de configurer en √©ditant des <strong>fichiers .json</strong> avec des noms sp√©ciaux.  Ensuite, les scripts du projet <strong>Python</strong> convertissent ces fichiers en fichiers d'en-t√™te, fichiers d'espace de travail de l'IDE s√©lectionn√© par l'utilisateur, fichiers de commandes de l'√©diteur de liens et autres fichiers de prise en charge. </p><br><p>  Mais le probl√®me de la m√©thode d√©crite r√©side dans l'opacit√© du point de vue des textes sources, car il nous est tr√®s difficile de suivre o√π et ce que le syst√®me de configuration change dans les sources.  D'un autre c√¥t√©, dans notre cas, il n'y a aucune raison de soutenir la capacit√© du projet √† √™tre automatiquement transf√©r√© vers diff√©rents IDE. </p><br><p>  Il a donc √©t√© d√©cid√© d'abandonner cette approche.  Comme indiqu√© dans un article pr√©c√©dent, il a simplement √©t√© transform√© en un projet en ligne pour l' <strong>IDE IAR</strong> , un tas non structur√© de fichiers a √©t√© obtenu dans l'espace de travail IDE, puis ils ont √©t√© syst√©matis√©s et inutiles ont √©t√© jet√©s.  Par cons√©quent, vous n'avez plus besoin d'effectuer de configuration via des fichiers <strong>.json</strong> et il n'y a que trois endroits sp√©cifiques o√π se trouvent les param√®tres affectant la configuration de <strong>Mbed</strong> : </p><br><ul><li>  <strong>Options du compilateur</strong> IDE </li><li>  <strong>Linker MKE18F512xxx16_flash.icf fichier batch</strong> </li><li>  Fichier d'en-t√™te <strong>mbed_config.h</strong> </li></ul><br><p>  Dans le fichier <strong>mbed_config.h</strong> , <strong>vous</strong> pouvez compter environ 130 d√©finitions, ce qui est tr√®s ennuyeux au d√©but.  Mais heureusement, la plupart d'entre eux concernent des piles de protocoles sans fil qui ne sont pas actuellement utilis√©s dans le projet.  Pour plus de commodit√©, les entr√©es ont √©t√© tri√©es de fa√ßon √† ce que les entr√©es r√©elles soient plac√©es en haut.  Initialement, les d√©finitions des diff√©rents modules du fichier <strong>mbed_config.h sont</strong> situ√©es de mani√®re al√©atoire, mais apr√®s le tri, cela ressemble √† ceci: </p><br><div class="spoiler">  <b class="spoiler_title">Ouverte</b> <div class="spoiler_text"><pre><code class="hljs smalltalk"><span class="hljs-symbol"><span class="hljs-symbol">#ifndef</span></span> __MBED_CONFIG_DATA__ <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> __MBED_CONFIG_DATA__ // <span class="hljs-type"><span class="hljs-type">Configuration</span></span> parameters <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_RTOS_PRESENT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:rtos <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_ALL_STATS_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> //<span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">DEVICE_SLEEP</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>       <span class="hljs-type"><span class="hljs-type">SLEEP</span></span>      <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_APP_MAIN_STACK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_APP_TIMER_THREAD_STACK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_APP_IDLE_THREAD_STACK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_DEFAULT_SERIAL_BAUD_RATE</span></span> <span class="hljs-number"><span class="hljs-number">3000000</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_ERROR_ALL_THREADS_INFO</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_ERROR_FILENAME_CAPTURE_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_ERROR_HIST_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_ERROR_HIST_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_FORCE_NON_COPYABLE_ERROR</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_MAX_ERROR_FILENAME_LEN</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_POLL_USE_LOWPOWER_TIMER</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_BAUD_RATE</span></span> <span class="hljs-number"><span class="hljs-number">3000000</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_BUFFERED_SERIAL</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_CONVERT_NEWLINES</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_CONVERT_TTY_NEWLINES</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PLATFORM_STDIO_FLUSH_AT_EXIT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:platform <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_DRIVERS_UART_SERIAL_RXBUF_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:drivers <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_DRIVERS_UART_SERIAL_TXBUF_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:drivers <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_PRESENT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_DISPATCH_FROM_APPLICATION</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_EVENTSIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_HIGHPRIO_EVENTSIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_HIGHPRIO_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_SHARED_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_EVENTS_USE_LOWPOWER_TIMER_TICKER</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:events <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_CELLULAR_DEBUG_AT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:cellular <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_CELLULAR_RANDOM_MAX_START_DELAY</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:cellular <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_CELLULAR_USE_APN_LOOKUP</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:cellular <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_FILESYSTEM_PRESENT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:filesystem <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_KINETIS_EMAC_RX_RING_LEN</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> // set by library:kinetis-emac <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_KINETIS_EMAC_TX_RING_LEN</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> // set by library:kinetis-emac <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_ADR_ON</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_APP_PORT</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_APPLICATION_EUI</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_APPLICATION_KEY</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_APPSKEY</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_AUTOMATIC_UPLINK_MESSAGE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_DEVICE_ADDRESS</span></span> <span class="hljs-number"><span class="hljs-number">0x00000000</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_DEVICE_EUI</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_DUTY_CYCLE_ON</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_LBT_ON</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_NB_TRIALS</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_NWKSKEY</span></span> {<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>} // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_OVER_THE_AIR_ACTIVATION</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_PHY</span></span> <span class="hljs-type"><span class="hljs-type">EU868</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_PUBLIC_NETWORK</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LORA_TX_MAX_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span> // set by library:lora <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_ADDR_TIMEOUT</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_ADDR_TIMEOUT_MODE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_DEBUG_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_DEFAULT_THREAD_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_ENABLE_PPP_TRACE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_ETHERNET_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_IP_VER_PREF</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_IPV4_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_IPV6_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_MEM_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">36560</span></span> // set by library:lwip[<span class="hljs-type"><span class="hljs-type">Freescale</span></span>] <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_PPP_THREAD_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">768</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_SOCKET_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_TCP_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_TCP_SERVER_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_TCP_SOCKET_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_TCPIP_THREAD_STACKSIZE</span></span> <span class="hljs-number"><span class="hljs-number">1200</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_UDP_SOCKET_MAX</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_LWIP_USE_MBED_TRACE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_CHANNEL</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_CHANNEL_MASK</span></span> <span class="hljs-number"><span class="hljs-number">0x7fff800</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_CHANNEL_PAGE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_DEVICE_TYPE</span></span> <span class="hljs-type"><span class="hljs-type">NET_6LOWPAN_ROUTER</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_PANID_FILTER</span></span> <span class="hljs-number"><span class="hljs-number">0xffff</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_PSK_KEY</span></span> {<span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xa2</span></span>, <span class="hljs-number"><span class="hljs-number">0xa3</span></span>, <span class="hljs-number"><span class="hljs-number">0xa4</span></span>, <span class="hljs-number"><span class="hljs-number">0xa5</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0xa7</span></span>, <span class="hljs-number"><span class="hljs-number">0xa8</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0xaa</span></span>, <span class="hljs-number"><span class="hljs-number">0xab</span></span>, <span class="hljs-number"><span class="hljs-number">0xac</span></span>, <span class="hljs-number"><span class="hljs-number">0xad</span></span>, <span class="hljs-number"><span class="hljs-number">0xae</span></span>, <span class="hljs-number"><span class="hljs-number">0xaf</span></span>} // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_PSK_KEY_ID</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_SEC_LEVEL</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_6LOWPAN_ND_SECURITY_MODE</span></span> <span class="hljs-type"><span class="hljs-type">NONE</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_HEAP_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">32500</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_CHANNEL</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_CHANNEL_MASK</span></span> <span class="hljs-number"><span class="hljs-number">0x7fff800</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_CHANNEL_PAGE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_COMMISSIONING_DATASET_TIMESTAMP</span></span> <span class="hljs-number"><span class="hljs-number">0x10000</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_EXTENDED_PANID</span></span> {<span class="hljs-number"><span class="hljs-number">0xf1</span></span>, <span class="hljs-number"><span class="hljs-number">0xb5</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xb2</span></span>,<span class="hljs-number"><span class="hljs-number">0xc4</span></span>, <span class="hljs-number"><span class="hljs-number">0xd5</span></span>, <span class="hljs-number"><span class="hljs-number">0xa1</span></span>, <span class="hljs-number"><span class="hljs-number">0xbd</span></span> } // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_ML_PREFIX</span></span> {<span class="hljs-number"><span class="hljs-number">0xfd</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0d</span></span>, <span class="hljs-number"><span class="hljs-number">0xb8</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>, <span class="hljs-number"><span class="hljs-number">0x0</span></span>} // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_NETWORK_NAME</span></span> <span class="hljs-comment"><span class="hljs-comment">"Thread Network"</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_PANID</span></span> <span class="hljs-number"><span class="hljs-number">0x0700</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_CONFIG_PSKC</span></span> {<span class="hljs-number"><span class="hljs-number">0xc8</span></span>, <span class="hljs-number"><span class="hljs-number">0xa6</span></span>, <span class="hljs-number"><span class="hljs-number">0x2e</span></span>, <span class="hljs-number"><span class="hljs-number">0xae</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0xf3</span></span>, <span class="hljs-number"><span class="hljs-number">0x46</span></span>, <span class="hljs-number"><span class="hljs-number">0xa9</span></span>, <span class="hljs-number"><span class="hljs-number">0x9e</span></span>, <span class="hljs-number"><span class="hljs-number">0x57</span></span>, <span class="hljs-number"><span class="hljs-number">0x85</span></span>, <span class="hljs-number"><span class="hljs-number">0x98</span></span>, <span class="hljs-number"><span class="hljs-number">0x9d</span></span>, <span class="hljs-number"><span class="hljs-number">0x1c</span></span>, <span class="hljs-number"><span class="hljs-number">0xd0</span></span>} // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_DEVICE_TYPE</span></span> <span class="hljs-type"><span class="hljs-type">MESH_DEVICE_TYPE_THREAD_ROUTER</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_MASTER_KEY</span></span> {<span class="hljs-number"><span class="hljs-number">0x10</span></span>, <span class="hljs-number"><span class="hljs-number">0x11</span></span>, <span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-number"><span class="hljs-number">0x33</span></span>, <span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">0x55</span></span>, <span class="hljs-number"><span class="hljs-number">0x66</span></span>, <span class="hljs-number"><span class="hljs-number">0x77</span></span>, <span class="hljs-number"><span class="hljs-number">0x88</span></span>, <span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0xaa</span></span>, <span class="hljs-number"><span class="hljs-number">0xbb</span></span>, <span class="hljs-number"><span class="hljs-number">0xcc</span></span>, <span class="hljs-number"><span class="hljs-number">0xdd</span></span>, <span class="hljs-number"><span class="hljs-number">0xee</span></span>, <span class="hljs-number"><span class="hljs-number">0xff</span></span>} // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_PSKD</span></span> <span class="hljs-comment"><span class="hljs-comment">"ABCDEFGH"</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_SECURITY_POLICY</span></span> <span class="hljs-number"><span class="hljs-number">255</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_THREAD_USE_STATIC_LINK_CONFIG</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_MBED_MESH_API_USE_MALLOC_FOR_HEAP</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:mbed-mesh-api <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_CONFIGURATION</span></span> nanostack_full // set by library:nanostack <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_CRITICAL_SECTION_USABLE_FROM_INTERRUPT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_EVENT_LOOP_DISPATCH_FROM_APPLICATION</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_EVENT_LOOP_THREAD_STACK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">6144</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_EVENT_LOOP_USE_MBED_EVENTS</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NANOSTACK_HAL_NVM_CFSTORE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nanostack-hal <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DEFAULT_MESH_TYPE</span></span> <span class="hljs-type"><span class="hljs-type">THREAD</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DEFAULT_STACK</span></span> <span class="hljs-type"><span class="hljs-type">LWIP</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DEFAULT_WIFI_SECURITY</span></span> <span class="hljs-type"><span class="hljs-type">NONE</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DNS_CACHE_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DNS_RESPONSE_WAIT_TIME</span></span> <span class="hljs-number"><span class="hljs-number">5000</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DNS_RETRIES</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_DNS_TOTAL_ATTEMPTS</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_NSAPI_PRESENT</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:nsapi <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PPP_CELL_IFACE_APN_LOOKUP</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:ppp-cell-iface <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PPP_CELL_IFACE_AT_PARSER_BUFFER_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">256</span></span> // set by library:ppp-cell-iface <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PPP_CELL_IFACE_AT_PARSER_TIMEOUT</span></span> <span class="hljs-number"><span class="hljs-number">8000</span></span> // set by library:ppp-cell-iface <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_PPP_CELL_IFACE_BAUD_RATE</span></span> <span class="hljs-number"><span class="hljs-number">115200</span></span> // set by library:ppp-cell-iface <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_CONF_TARGET_NETWORK_DEFAULT_INTERFACE_TYPE</span></span> <span class="hljs-type"><span class="hljs-type">ETHERNET</span></span> // set by target:<span class="hljs-type"><span class="hljs-type">K66F</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_BLOCK_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_ENABLE_INFO</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_INTRINSICS</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_LOOKAHEAD</span></span> <span class="hljs-number"><span class="hljs-number">512</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_PROG_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">MBED_LFS_READ_SIZE</span></span> <span class="hljs-number"><span class="hljs-number">64</span></span> // set by library:littlefs <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NSAPI_PPP_AVAILABLE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NSAPI_PPP_IPV4_AVAILABLE</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NSAPI_PPP_IPV6_AVAILABLE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> // set by library:lwip <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NVSTORE_ENABLED</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> // set by library:nvstore <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NVSTORE_MAX_KEYS</span></span> <span class="hljs-number"><span class="hljs-number">16</span></span> // set by library:nvstore // <span class="hljs-type"><span class="hljs-type">Macros</span></span> <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> _RTE_ // defined by library:rtos <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">NS_USE_EXTERNAL_MBED_TLS</span></span> // defined by library:nanostack <span class="hljs-symbol"><span class="hljs-symbol">#define</span></span> <span class="hljs-type"><span class="hljs-type">UNITY_INCLUDE_CONFIG_H</span></span> // defined by library:utest <span class="hljs-symbol"><span class="hljs-symbol">#endif</span></span></code> </pre> </div></div><br><h2 id="osobennosti-perehoda-na-c-v-primenenii-k-rtos">  Caract√©ristiques de la transition vers C ++ appliqu√©es √† RTOS </h2><br><p>  <strong>L'API de</strong> niveau sup√©rieur dans <strong>Mbed</strong> est √©crite en <strong>C ++</strong> , donc ce langage doit √™tre utilis√© dans le code de l'application.  Mais il y a des nuances que vous devez conna√Ætre. <br>  L'utilisation de <strong>C ++</strong> pour <strong>RTOS</strong> sur de petits syst√®mes embarqu√©s est encore relativement rare.  Le probl√®me ici est que les projets <strong>RTOS</strong> r√©ussis s'efforcent d'√™tre multi-plateforme, tandis que <strong>C ++</strong> impose des exigences √©lev√©es sur la gestion des ressources de la plate-forme par rapport √† <strong>C.</strong>  La raison en est le d√©sir de cacher √† l'utilisateur les d√©tails de la gestion des ressources de bas niveau.  Il s'agit principalement de ressources m√©moire.  Les constructeurs, destructeurs, threads, exceptions avec destruction automatique, mod√®les d'objets de structure de donn√©es, etc. utilisent des op√©rations implicites avec la m√©moire dynamique.  Mais la ressource de <strong>RAM</strong> dans les petits syst√®mes est tr√®s limit√©e.  La RAM est la ressource la plus rare dans ces syst√®mes et en particulier dans <strong>RTOS</strong> .  Dans <strong>RTOS,</strong> chaque t√¢che se voit attribuer une pile, le d√©veloppeur ne peut pas pr√©dire sa taille exacte √† l'avance et choisit donc avec une marge.  Ainsi, la pr√©sence de <strong>RTOS</strong> avec une dizaine de t√¢ches n√©cessite imm√©diatement une taille de <strong>RAM</strong> de 10 √† 30 ko.  Beaucoup de m√©moire est n√©cessaire pour les diff√©rents analyseurs et protocoles (HTTP, HTML ...) et les syst√®mes de fichiers.  Si un √©cran est utilis√©, les besoins en <strong>RAM</strong> libre sont encore augment√©s. </p><br><p>  Les biblioth√®ques d'environnements de d√©veloppement tels que <strong>IAR</strong> sont √©quip√©es de bons gestionnaires de m√©moire dynamique, mais elles sont con√ßues pour un environnement d'ex√©cution monothread.  Pour qu'ils puissent commencer √† travailler dans <strong>RTOS,</strong> vous devez √©crire du code suppl√©mentaire.  Ce processus est appel√© <strong>reciblage</strong> . <br>  Dans <strong>RTOS</strong> √©crit en <strong>C, le</strong> reciblage n'est g√©n√©ralement pas effectu√©.  Puisqu'il n'y a pas d'op√©rations implicites avec de la m√©moire dynamique au niveau du langage, toutes les op√©rations sont effectu√©es explicitement en appelant leurs propres versions thread-safe du <strong>malloc</strong> et <strong>des</strong> fonctions <strong>libres</strong> .  Le programmeur a un contr√¥le total sur les op√©rations avec la m√©moire dynamique et peut facilement appliquer toutes les mesures possibles pour l'enregistrer. </p><br><p>  Dans le cas de <strong>C ++,</strong> si nous voulons utiliser toutes les fonctionnalit√©s de ce langage, nous devrons faire du <strong>reciblage</strong> .  Mais le <strong>reciblage</strong> dans chaque environnement de d√©veloppement est un processus purement individuel.  Cela rend la vie difficile aux d√©veloppeurs <strong>RTOS</strong> . </p><br><p>  La figure ci-dessous est un exemple de structure d'appel avec reciblage.  Les fonctions <em>__write</em> , <em>__lseek</em> , <em>__read</em> peuvent ne pas √™tre impl√©ment√©es par l'utilisateur, mais leur fonctionnalit√© reste √† la discr√©tion de l' <strong>IDE</strong> .  Et certainement <strong>printf</strong> et <strong>scanf</strong> ne seront pas multithread. </p><br><img src="https://habrastorage.org/webt/xq/fa/8e/xqfa8eksi4rb4ytbicaehymj0py.png"><br><p>  <strong>Mbed est l'</strong> un des rares sinon le seul <strong>RTOS</strong> qui fournit des codes source avec un reciblage d√©j√† fait pour une triade d'outils de d√©veloppement bien connus: <strong>GCC</strong> , <strong>IAR</strong> , <strong>Keil</strong> <br>  Malgr√© tout ce qui pr√©c√®de, vous pouvez trouver des articles sur le portage de <strong>RTOS</strong> vers <strong>C ++</strong> sans effectuer de reciblage, par exemple, en r√©solvant le probl√®me en rempla√ßant simplement certaines fonctions standard courantes par les v√¥tres.  Cela peut fonctionner, mais le programmeur doit alors √™tre conscient de diverses restrictions implicites et non document√©es lors de l'utilisation de constructions <strong>C ++</strong> dans <strong>IAR</strong> (uniquement les constructeurs statiques, v√©rifier tous les mod√®les pour les <strong>nouveaux</strong> , √©liminer les exceptions, etc.).  Il sera d√©j√† difficile d'appeler <strong>C ++</strong> .  <strong>Mbed, en</strong> tant que syst√®me convivial, supprime bon nombre de ces limitations, abordant <strong>Arduino</strong> en toute simplicit√©. </p><br><p>  En plus de toutes les versions r√©centes de IAR, il est difficile de passer √† C11 et C ++ 14, comme d√©crit ici - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://www.iar.com/support/resources/articles/exploring-c11-and-c14/</a> </p><br><h2 id="kak-organizuyutsya-preryvaniya-v-mbed">  Comment les interruptions sont-elles organis√©es dans Mbed </h2><br><p>  Curieusement, il ne sera pas possible de trouver une classe ou une fonction ou quelque chose qui convienne pour organiser le service d'interruption dans l'API Mbed.  Vous ne pouvez trouver que la classe <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">InterruptIn</a></strong> , qui est destin√©e uniquement aux ports externes. </p><br><p>  Les r√©ponses √† ces questions doivent √™tre recherch√©es dans <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CMSIS-RTOS</a></strong> , √† savoir dans la <em>couche d'acc√®s p√©riph√©rique CMSIS Cortex-M4</em> .  Les macros y sont d√©finies: </p><br><ul><li>  <strong><em>NVIC_SetVector</em></strong> - d√©finit la routine de service d'interruption (ISR) pour un vecteur donn√© </li><li>  <strong><em>NVIC_SetPriority</em></strong> - D√©finit la priorit√© du vecteur d'interruption sp√©cifi√©. </li><li>  <strong><em>NVIC_EnableIRQ</em></strong> - autorise les appels d'interruption sur un vecteur donn√© </li></ul><br><p>  Voici comment l'organisation d'interruption du minuteur <strong>SysTick</strong> est initialis√©e: </p><br><pre> <code class="hljs lisp"> NVIC_SetVector(<span class="hljs-name"><span class="hljs-name">mbed_get_m0_tick_irqn</span></span>(), (<span class="hljs-name"><span class="hljs-name">uint32_t</span></span>)SysTick_Handler)<span class="hljs-comment"><span class="hljs-comment">; //   mbed_get_m0_tick_irqn       SysTick. //        SysTick_IRQn    MKE18F16.h //  SysTick_Handler   . NVIC_SetPriority(mbed_get_m0_tick_irqn(), 0xFF); // 0xFF    .      .   NVIC    MKE18F16   16  . ..   4-  . NVIC_EnableIRQ(mbed_get_m0_tick_irqn()); //    .</span></span></code> </pre> <br><p>  Les priorit√©s de t√¢che Mbed et les priorit√©s d'interruption ne doivent pas √™tre confondues. </p><br><p>  Si la priorit√© n'est pas attribu√©e, elle est par d√©faut d√©finie sur maximum. <br>  √Ä partir des gestionnaires d'interruption affect√©s de cette mani√®re, vous pouvez appeler tous les services <strong>RTOS</strong> qui ne provoquent pas d'attentes.  C'est-√†-dire  transmettre des drapeaux, des s√©maphores, des messages, des bo√Ætes aux lettres, etc.  Les services ne sont toutefois pas appel√©s √† partir de l' <strong>ISR</strong> lui-m√™me, mais en appelant des interruptions logicielles en d√©finissant le bit <strong>PENDSVSET</strong> dans le <em>contr√¥le d'interruption et le registre d'√©tat</em> ( <strong>ICSR</strong> ) du <em>bloc de contr√¥le syst√®me</em> ( <strong>SCB</strong> ) du noyau <strong>Cortex-M</strong> .  C'est-√†-dire  une fois le gestionnaire d'interruptions en cours termin√©, s'il n'y a pas d'autres interruptions prioritaires, le gestionnaire syst√®me sera appel√© par le vecteur <strong>PendSV</strong> o√π le service sera ex√©cut√©. </p><br><h2 id="kak-v-mbed-proishodit-rabota-s-dinamicheskoy-pamyatyu">  Comment Mbed fonctionne-t-il avec la m√©moire dynamique? </h2><br><p>  <strong>La m√©moire dynamique,</strong> ou bien le <strong>tas</strong> ou le <strong>tas,</strong> est un composant requis lors de la programmation en <strong>C ++</strong> .  Dans notre projet <strong>Mbed</strong> sous <strong>IAR</strong> , la taille de cette zone m√©moire est d√©termin√©e dans le fichier de param√®tres de l'√©diteur de liens <strong>MKE18F512xxx16_flash.icf</strong> en √©crivant dans la variable <strong>__size_heap__</strong> .  Nous d√©finissons la taille pour qu'elle occupe toute la m√©moire libre restante.  Nous savons <strong>combien</strong> de m√©moire libre reste du fichier <strong>.map</strong> apr√®s la compilation, c'est-√†-dire  le dimensionnement du <strong>tas</strong> est un processus it√©ratif. </p><br><h3 id="vyzov-staticheskih-konstruktorov-obektov-c">  Appel de constructeurs statiques d'objets C ++ </h3><br><p>  Un probl√®me important lors de l'utilisation de <strong>C ++</strong> est o√π et comment les constructeurs d'objets globaux sont appel√©s.  M√™me dans <strong>RTOS</strong> affirmant du s√©rieux, par exemple, <strong>MAX</strong> , cela est ignor√©, c'est-√†-dire  laiss√© au hasard.  L√†, les concepteurs sont engag√©s dans une biblioth√®que d'environnement de d√©veloppement monothread standard avec le m√©canisme d'allocation de m√©moire monothread habituel.  Mais apr√®s le d√©but, les <strong>RTOS</strong> communs cr√©ent leur propre m√©canisme de gestion de la m√©moire dynamique, et la m√©moire occup√©e par les objets globaux reste oubli√©e.  C'est un trou dans nos efforts pour √©conomiser la m√©moire et tout contr√¥ler. </p><br><p>  <strong>Mbed a</strong> abord√© cette question beaucoup plus s√©rieusement.  L√† pour chaque environnement de d√©veloppement a sa propre approche.  Dans l' <strong>IAR,</strong> cela se fait comme suit: </p><br><ul><li>  le flux d'initialisation est intercept√© par le code utilisateur avant m√™me que les concepteurs appellent </li><li>  les m√©thodes de blocage des flux de <strong>l'API RTOS sont</strong> substitu√©es dans la biblioth√®que standard </li><li>  les fonctions standard <strong>new</strong> , <strong>delete</strong> , <strong>malloc</strong> , <strong>free</strong> ... sont redirig√©es vers les appels vers l' <strong>API de</strong> m√©moire dynamique <strong>RTOS</strong> . </li></ul><br><p>  <strong>Mbed</strong> utilise des adaptateurs de biblioth√®que <strong>IAR</strong> pour un fonctionnement multithread <br>  Vous pouvez lire sur l'adaptation d'IAR pour le multithreading ici - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://supp.iar.com/FilesPublic/UPDINFO/005691/arm/doc/infocenter/DLIBThreadSupport.html</a> <br>  <strong>Mbed a</strong> adapt√© les <em>verrous</em> syst√®me et <em>les verrous de flux de fichiers de</em> la biblioth√®que <strong>IAR</strong> .  Ils sont impl√©ment√©s dans le fichier <em>mbed_boot.c</em> et utilisent des <strong>mutex OS</strong> . </p><br><p>  L'ex√©cutable de la fonction <strong>__iar_program_start</strong> dans les toutes premi√®res lignes du fichier <strong>startup_MKE18F16.s</strong> initialise la pile du syst√®me d'exploitation et la m√©moire dynamique en appelant <em>mbed_set_stack_heap</em> </p><br><h2 id="naznachenie-razmerov-stekov-zadach">  Dimensionnement des piles de t√¢ches </h2><br><p>  La suppression des piles de t√¢ches au minimum est l'option la plus int√©ressante pour √©conomiser de la <strong>RAM</strong> . <br>  Pour les t√¢ches n√©cessitant moins de pile, diff√©rentes techniques sont utilis√©es.  Par exemple, les fonctions de biblioth√®que affectent fortement la pile pour la sortie et le formatage des lignes <strong>printf</strong> , <strong>sprintf</strong> , <strong>scanf</strong> , etc.  Ils ont la possibilit√© d'allouer de grandes zones temporaires pour le stockage des donn√©es sur la pile.  Si nous refusons d'utiliser ces fonctions dans la t√¢che, nous pouvons r√©duire la pile de t√¢ches de quelques centaines d'octets. </p><br><p>  Mbed OS au d√©marrage cr√©e imm√©diatement trois t√¢ches avec des noms: <strong>"main_thread"</strong> , <strong>"timer_thread"</strong> , <strong>"idle_thread"</strong> .  La taille de pile par d√©faut pour eux a √©t√© d√©termin√©e par des macros dans le fichier d'en-t√™te <strong>mbed_rtx_conf.h</strong> .  Nous avons d√©plac√© les d√©clarations de ces piles vers le <strong>fichier de</strong> configuration <strong>mbed_config.h</strong> et r√©duit la taille des piles.  Maintenant, les d√©finitions ressemblent √† ceci: </p><br><ul><li>  La pile de t√¢ches <strong>"main_thread"</strong> est d√©finie par la macro <strong>MBED_CONF_APP_MAIN_STACK_SIZE</strong> = 1024 octets </li><li>  La pile de t√¢ches <strong>timer_thread</strong> est d√©finie par la macro <strong>MBED_CONF_APP_TIMER_THREAD_STACK_SIZE</strong> = 512 octets </li><li>  La pile de t√¢ches <strong>idle_thread</strong> est d√©finie par la macro <strong>MBED_CONF_APP_IDLE_THREAD_STACK_SIZE</strong> = 512 octets </li></ul><br><h2 id="sredstva-kontrolya-za-ispolzovaniem-resursov-pamyati-v-mbed">  Contr√¥les d'utilisation de la m√©moire Mbed </h2><br><p>  La m√©moire dynamique ainsi que la pile sont des ressources qui n√©cessitent une attention constante.  Pour voir combien de m√©moire dynamique est utilis√©e et quelle est l'intensit√© des demandes, combien de pile reste pour chaque t√¢che et quel √©tait le pic de chargement de la pile dans Mbed, il existe des compteurs sp√©ciaux.  Par d√©faut, ils sont d√©sactiv√©s par la directive de compilation conditionnelle; pour les activer, vous devez d√©clarer <strong>MBED_ALL_STATS_ENABLED</strong> .  Lorsque la d√©finition est d√©clar√©e, vous devez √©crire votre propre proc√©dure pour afficher des informations √† l'utilisateur.  Nous avons √©crit une proc√©dure sp√©ciale pour la sortie des statistiques vers l'√©mulateur de terminal VT100, qui sera discut√©e plus tard. </p><br><p>  En plus des outils fournis par OS, l'environnement de d√©veloppement IAR dans les versions r√©centes ajoute une nouvelle fonctionnalit√© - <strong>les canaris empil√©s</strong> .  Lisez √† leur sujet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Les probl√®mes g√©n√©raux de protection de pile contre le d√©bordement sont discut√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><h2 id="sredstva-otladki-i-analiza-koda-mbed">  Outils de d√©bogage et d'analyse de code Mbed </h2><br><p>  Une √©tude vraiment approfondie du travail de <strong>Mbed</strong> sur la nouvelle plate-forme n'est possible qu'en utilisant le d√©bogueur <strong>JTAG / SWD</strong> . </p><br><img width="300" align="left" src="https://habrastorage.org/webt/64/xh/my/64xhmylaiz-_eejrufyuqmo_2n8.png"><br><p>  <strong>Les sources Mbed</strong> regorgent de macros √† plusieurs niveaux et d'instructions de compilation conditionnelle.  En regardant simplement la source, vous ne pouvez pas dire quelles fonctions fonctionnent et lesquelles ne fonctionnent pas, o√π le programme s'ex√©cute et o√π il ne fonctionne pas.  La seule solution consiste √† connecter le d√©bogueur et √† analyser pas √† pas le chemin d'ex√©cution du programme.  D√©j√† au stade du portage, il est presque impossible de se passer d'un d√©bogage √©tape par √©tape. </p><br><p>  Je recommanderais les versions de d√©bogueurs <strong>Segger</strong> de <strong>J-Link Pro</strong> et <strong>J-Link Ultra</strong> .  Ils se distinguent par une bande passante √©lev√©e, plusieurs fois sup√©rieure √† celle des mod√®les bon march√© courants.  Pour les syst√®mes de d√©bogage en temps r√©el difficile, cela est important.  Lors du suivi d'√©v√©nements rapides, ces d√©bogueurs sont moins sujets aux d√©bordements et n√©cessitent moins d'it√©rations de d√©bogage.  En plus du d√©bogage √©tape par √©tape, ils sont capables de consigner les interruptions, de conserver des statistiques sur les interruptions, y compris leurs dur√©es d'ex√©cution, de prendre en charge les technologies de d√©bogage <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><strong>RTT</strong></a> et <strong>ITM</strong> , de d√©tecter les exceptions mat√©rielles et d'autres fonctions. </p><br><p>  Vous trouverez ci-dessous une vue de la fen√™tre du d√©bogueur IAR lorsque vous utilisez l'adaptateur J-Link. </p><br><p><img src="https://habrastorage.org/webt/n2/of/it/n2ofit9jpectc6sncr6c3sl1gzo.png"></p><br><p>  Cela ne vaut pas la peine d‚Äô√™tre sauv√©, 90% du temps de d√©veloppement est consacr√© au d√©bogage.  Bien que les traceurs Segger <strong>J-Trace,</strong> plus chers, n'offrent plus un grand avantage, car la s√©rie <strong>MKE18F n'a</strong> pas d'interface de traceur sp√©ciale. </p><br><p>  <strong>Le deuxi√®me</strong> outil de d√©bogage, bien s√ªr, est les E / S via <strong>UART</strong> .  Mbed dispose d'au moins quatre technologies diff√©rentes pour acc√©der √† un canal de donn√©es s√©rie via <strong>UART</strong> , </p><br><p>  C‚Äôest: </p><br><ul><li>  redirection via la classe <strong>DirectSerial</strong> des fonctions d'E / S <strong>C / C ++</strong> standard </li><li>  class <strong>RawSerial</strong> </li><li>  <strong>s√©rie de</strong> classe </li><li>  classe <strong>UARTSerial</strong> </li></ul><br><p>  Une vari√©t√© assez inhabituelle.  Les quatre peuvent √™tre utilis√©s simultan√©ment pour une sortie vers le m√™me port.  Certains d'entre eux sont plus fonctionnels, certains le sont moins, certains sont document√©s et d'autres non.  √Ä l'avenir, dans notre projet, nous utiliserons <strong>RawSerial</strong> , la classe la moins <strong>gourmande en</strong> ressources. </p><br><h2 id="skolko-my-teryaem-taymerov-portirovav-mbed">  Combien de minuteries perdons-nous en portant Mbed </h2><br><p>  Pour faire clignoter la LED, la fonction d' <strong>attente</strong> de <strong>l'API</strong> Mbed OS a <strong>√©t√©</strong> utilis√©e.  Le dernier article parlait des probl√®mes de portage.  Mais ce n'est pas tout, sauf que Mbed garde un compteur de son travail (il peut √™tre lu par la fonction <strong>mbed_stats_cpu_get</strong> ) et il y a une <strong>API timer</strong> .  Ces services utilisent les fonctions de bas niveau du fichier <strong>lp_ticker.c</strong> .  Dans ce fichier, le temporisateur <strong>LPTMR du</strong> kit p√©riph√©rique <strong>Kinetis</strong> est utilis√© pour organiser le <strong>d√©compte</strong> du temps.  Pendant le processus de portage, ce fichier a √©t√© modifi√© pour correspondre aux m√©thodes d'horloge utilis√©es dans le microcontr√¥leur <strong>MKE18F512VLL16</strong> . </p><br><p>  Ainsi, le <strong>port Mbed</strong> capture compl√®tement deux modules de compteur - <strong>PIT</strong> et <strong>LPTMR</strong> et le <strong>temporisateur</strong> principal <strong>SysTick</strong> .  Il faut s'en souvenir lors de la planification des ressources pour une t√¢che appliqu√©e. </p><br><h2 id="osobennosti-nachalnoy-zagruzki-mke18f">  Caract√©ristiques du Bootstrap MKE18F </h2><br><p>  La famille de <strong>puces MKE18F</strong> poss√®de une <strong>ROM</strong> int√©gr√©e avec un chargeur de d√©marrage via des interfaces s√©rie: <strong>UART, CAN, SPI, I2C</strong> .  Mais il est pr√©vu d'utiliser notre chargeur de d√©marrage s√©curis√© sur notre carte, de sorte que le travail d'un chargeur de d√©marrage normal n'est pas souhaitable. <br>  Dans ce cas, les puces <strong>Kinetis doivent</strong> faire attention au contenu de la <strong>zone Program Flash</strong> √† <strong>0x040D</strong> .  Il y a une constante stock√©e qui d√©termine l'ordre de d√©marrage.  Dans notre cas, la constante <strong>0x7B</strong> doit y √™tre √©crite, indiquant le d√©marrage √† partir de <strong>la</strong> m√©moire <strong>Flash</strong> , et non √† partir de la <strong>ROM</strong> et d√©sactivant la fonction <strong>NMI</strong> sur la sortie externe.  Avec une valeur diff√©rente pour cette constante, le programme peut se bloquer dans le chargeur de d√©marrage int√©gr√© appel√© accidentellement √† partir de la ROM. </p><br><p>  Il est √©galement important de se rappeler que l‚Äô√©criture dans la m√©moire flash du contr√¥leur n‚Äôest possible qu‚Äô√† une fr√©quence centrale de <strong>120 MHz</strong> et non plus, c‚Äôest-√†-dire  En mode <strong>HRUN</strong> , l'enregistrement <strong>Flash</strong> n'est pas possible. </p><br><h2 id="aktiviziruem-watchdog">  Activer le chien de garde </h2><br><p>  La carte de notre contr√¥leur est destin√©e √† un usage industriel, ce qui signifie que vous ne pouvez pas vous passer de <strong>Watchdog</strong> . </p><br><p>  Initialement, la macro <strong>DISABLE_WDOG</strong> dans le fichier <strong>system_MKE18F16.h a</strong> √©t√© d√©finie pour d√©sactiver le <strong>chien de garde</strong> .  Pour corriger la situation, cette macro a √©t√© effac√©e et sa propre initialisation de <strong>WDOG a √©t√©</strong> impl√©ment√©e. </p><br><p>  L'initialisation de <strong>Watchdog se</strong> fait dans la fonction <strong>SystemInit</strong> .  Le compteur de <strong>surveillance</strong> est mis √† jour dans la t√¢che <strong>IDLE</strong> . </p><br><p>  Une telle approche n√©cessite que les t√¢ches de priorit√© plus √©lev√©e ne capturent pas exclusivement le processeur pendant plus de <strong>100 ms</strong> .  Mais cela peut facilement se produire, par exemple, lors de la sortie de grands vidages de donn√©es vers le terminal.  Par cons√©quent, partout o√π nous interrompons de longues proc√©dures dans des t√¢ches avec une priorit√© sup√©rieure √† <strong>IDLE</strong> en courts fragments entrecoup√©s de pauses √† l'aide de la fonction d' <strong>attente</strong> . </p><br><h2 id="vopros-drayverov-iz-postavki-sdk">  Probl√®me de pilotes li√© √† la livraison du SDK </h2><br><p>  <strong>Les</strong> pilotes <strong>SDK</strong> sont pr√©fix√©s par <strong>fsl</strong> situ√© dans le r√©pertoire <strong>NXP_MKE18F_drivers</strong> et constituent une sorte de couche d'abstraction p√©riph√©rique.  Ils sont cens√©s faciliter la programmation de p√©riph√©riques difficiles √† apprendre, mais malheureusement peu document√©s.  Au contraire, leur documentation se limite aux commentaires dans les en-t√™tes de fonction.  Il y a une confusion pour qui alors ils sont √©crits et comment ils peuvent nous lib√©rer de l'√©tude des manuels √† la p√©riph√©rie du microcontr√¥leur.  Ma r√©ponse n'est pas possible.  Les pilotes facilitent simplement le transfert de programmes vers diff√©rents microcontr√¥leurs au sein de la m√™me famille.  Mais pour les appliquer efficacement, vous devez tr√®s bien g√©rer la documentation p√©riph√©rique.  Ainsi, les pilotes du <strong>SDK</strong> r√©solvent un probl√®me plut√¥t priv√© des d√©veloppeurs des pilotes eux-m√™mes, loin des besoins des utilisateurs qui commencent √† apprendre <strong>Kinetis</strong> . </p><br><p>  Les pilotes sont √©galement con√ßus pour fonctionner sur toutes les puces de la famille, c'est-√†-dire  √™tre universel et donc satur√© de macros conditionnelles et v√©rifie que pour chaque puce particuli√®re ne porte aucune fonction utile. </p><br><p>  Les pilotes peuvent toujours aider d'une certaine mani√®re √† mieux comprendre comment g√©rer les p√©riph√©riques, mais apr√®s avoir compris le pilote, vous pouvez l'ignorer en toute s√©curit√©. <br>  √Ä cet √©gard, il n'est pas surprenant que dans ce projet, l'acc√®s aux p√©riph√©riques non affect√©s par le port Mbed passe directement par le pilote. </p><br><p>  Cependant, il peut y avoir des pr√©occupations concernant les d√©pendances d'un p√©riph√©rique particulier sur la disponibilit√© des pilotes SDK.  Ici, vous devez examiner le code source des pilotes.  Le principal danger des d√©pendances provient de la s√©paration des fonctions des pilotes <strong>DMA</strong> .  Pour √©viter cela, vous devez suivre et interdire aux services Mbed r√©guliers d'utiliser <strong>DMA</strong> lorsque vous travaillez avec des p√©riph√©riques.  Si <strong>DMA</strong> reste intact par les pilotes du <strong>SDK</strong> , alors presque tout ce qui ne s'applique pas aux 2 modules de temporisation mentionn√©s ( <strong>PIT</strong> et <strong>LPTMR</strong> ) et l'UART de d√©bogage peuvent √™tre supprim√©s ou ignor√©s du r√©pertoire <strong>NXP_MKE18F_drivers</strong> . </p><br><p>  Un danger moindre, mais √©galement important, peut provenir de la priorit√© des p√©riph√©riques impliqu√©s via les pilotes du SDK.  Par exemple, vous devez savoir quelle priorit√© est affect√©e aux interruptions SysTick, au d√©bogage des UART et aux temporisateurs.  Dans une situation o√π leur priorit√© est √©gale ou sup√©rieure √† la priorit√© de la p√©riph√©rie utilis√©e dans la gestion en temps r√©el, cela peut conduire √† une d√©gradation de la qualit√© de la gestion. </p><br><p>  N'oubliez pas que le port <strong>Mbed</strong> pour le <strong>MKE18F</strong> initie les interruptions UART et timer sans priorisation, c.-√†-d.  ils obtiennent le niveau maximum par d√©faut. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422413/">https://habr.com/ru/post/fr422413/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr422401/index.html">Un autre framework de plugin C ++</a></li>
<li><a href="../fr422403/index.html">20 septembre, Moscou - une r√©union pour les analystes</a></li>
<li><a href="../fr422407/index.html">Rechercher et trier les textes associ√©s</a></li>
<li><a href="../fr422409/index.html">Python: m√©taprogrammation en production. Premi√®re partie</a></li>
<li><a href="../fr422411/index.html">Nouveaux r√¥les dans les entreprises √† l'√®re de la servitisation</a></li>
<li><a href="../fr422415/index.html">Python: m√©taprogrammation en production. Deuxi√®me partie</a></li>
<li><a href="../fr422417/index.html">Slavik et GMT + 3 ou avantage pour les personnes</a></li>
<li><a href="../fr422419/index.html">Pas sans panique chez Go</a></li>
<li><a href="../fr422421/index.html">Microsoft va radicalement am√©liorer Skype</a></li>
<li><a href="../fr422423/index.html">Python et DataScience: explorer la puissance de la biblioth√®que universelle Numpy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>