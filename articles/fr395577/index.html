<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏻 👨🏽‍🚀 🐳 Carte STM32 pas cher + Arduino IDE UPD 17/08/2017 ☑️ 👩‍👩‍👦‍👦 🛁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vous souhaitez mettre à niveau vos projets Arduino? Faites-les fonctionner plus rapidement, effectuez des mesures et des ajustements plus précis et aj...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Carte STM32 pas cher + Arduino IDE UPD 17/08/2017</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395577/"><img src="https://habrastorage.org/files/c77/812/08e/c7781208e99a4b5ba071204b56d89691.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous souhaitez mettre à niveau vos projets Arduino? </font><font style="vertical-align: inherit;">Faites-les fonctionner plus rapidement, effectuez des mesures et des ajustements plus précis et ajoutez des bugs (ils sont inévitables avec les nouveaux appareils). </font><font style="vertical-align: inherit;">Alors cet article est fait pour vous. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le thème Arduino capture de plus en plus les esprits de l'humanité, mais tôt ou tard, nous sommes confrontés au fait que nous manquons quelque chose, par exemple, budget / tailles / </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">broches de</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> port / capacité de bit / performance ... Comme l'a dit un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sage</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - «Celui qui veut, il cherche des opportunités qui ne veut pas cherche des raisons. » </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les bonnes personnes comprennent cela et commencent lentement à associer </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32 au thème Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , car les microcontrôleurs AVR huit bits, sur lesquels de nombreuses cartes Arduino sont basées, ne peuvent pas toujours faire face aux tâches.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un résumé de cet article au format vidéo:</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/878k4KqF7Xs" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'accord, moins de paroles et plus proche du sujet. </font><font style="vertical-align: inherit;">Dans cet article, je considérerai une carte de débogage bon marché, basée sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">microcontrôleur STM32F103C8T6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br>
<br>
<img src="https://habrastorage.org/files/b41/614/68c/b4161468c90142148c300aaa7e2f846e.JPG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour commencer, comparons les principaux paramètres de la carte STM32 et son prix analogique - Arduino Nano V3.0:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fréquence de fonctionnement 72 MHz, contre 16 pour Arduino;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La quantité de mémoire Flash est de 64 Ko, contre 32;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM, c'est RAM (où les variables sont stockées), le STM32 a jusqu'à 20 kilo-octets, l'arduinka n'en a que 2;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ADC 12 bits rapide, tandis que les cartes Arduino qui utilisent des microcontrôleurs AVR (c'est généralement la majorité) utilisent 10 bits. </font><font style="vertical-align: inherit;">Cela signifie que dans le cas de STM32, la fonction est analogRead (*); </font><font style="vertical-align: inherit;">renverra 0..4095 contre 0..1023, ce qui dans le premier cas conduit à des mesures plus précises;</font></font></li>
<li>16-   ,  8-  Arduino ,  ,  <s>analogWrite(*);</s>pwmWrite(*);    0..65535,   0..255.       ,    ,     ;</li>
<li>   USB,       Arduino    2 ;</li>
<li>  —  2  3.6(    2 AA ),  2.7...5   ;</li>
<li>     — 1.9   1.8().</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De toute évidence, la carte de débogage basée sur STM32 surpasse l'Arduino Nano à tous égards, sauf pour le prix, mais d'accord 10 cents est un bon prix pour de grandes performances, mais sur les périphériques avec lesquels le STM32 est bourré, je ne sais absolument pas ce que vaut le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DMA</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ou des horloges en temps réel intégrées dans le microcontrôleur. </font></font><br>
<br>
<img src="https://habrastorage.org/files/2d1/1b1/c4c/2d11b1c4c96342dbb0b7fe9aeedd046c.JPG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout cela rend cette carte extrêmement attrayante en tout sauf une chose - pour un débutant, comme moi, le thème STM32 semble trop long, il existe des sites entiers dédiés à la programmation de ces microcontrôleurs. Mais si vous vous faites des amis STM32 avec l'IDE Arduino, le seuil d'entrée tombe à un niveau extrêmement bas. Bien que, comme on dit, "Dans chaque baril de miel, il y a une mouche dans la pommade", mais plus sur cela ci-dessous.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Commençons à préparer la carte pour travailler avec l'IDE Arduino. </font><font style="vertical-align: inherit;">La première chose à faire est de télécharger un chargeur de démarrage spécial sur le microcontrôleur, qui vous permettra de flasher la carte via USB matériel, et directement depuis l'environnement de développement. </font><font style="vertical-align: inherit;">Pour ce faire, déplacez le cavalier supérieur (alias «BOOT0»), en position «1»:</font></font><br>
<br>
<img src="https://habrastorage.org/files/198/fd7/ed4/198fd7ed436d475d88bcf52498d474d6.JPG" alt="image"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À quoi servent les cavaliers BOOT0 et BOOT1?</font></font></b><div class="spoiler_text">  ,   STM32   ,     (system memory),  ,        USB to UART ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ST-Link V2</a>.<br>
<br>
<img src="https://habrastorage.org/files/5a4/813/115/5a48131155d249a1b97e5619c133a0af.png" alt="image"><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous avons besoin d'un adaptateur USB vers UART. Il convient de rappeler que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32 est une logique 3,3</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> V, la compatibilité avec 5 V n'est pas garantie, il est donc recommandé d'utiliser USB vers UART, qui a la possibilité de sélectionner des modes de fonctionnement avec une logique 3,3 / 5 V. J'ai utilisé un adaptateur bon marché basé sur CH340G: </font></font><br>
<br>
<img src="https://habrastorage.org/files/85c/50b/0cb/85c50b0cbdf442daa01f436e37fd4b9b.jpg" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* comme vous pouvez le voir, le fabricant ne s'est pas </font><font style="vertical-align: inherit;">retourné </font><font style="vertical-align: inherit;">avec un flux wash, bien sûr, cela n'affecte pas le travail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai connecté la carte à l'adaptateur USB vers UART comme suit: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
G &lt;-&gt; GND; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5V &lt;-&gt; 5V; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PA10 &lt;-&gt; TXD; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PA9 &lt;-&gt; RXD. </font></font><br>
<br>
<img src="https://habrastorage.org/files/fa1/7c6/356/fa17c635681842d6b94add76cf4b2beb.jpg" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* PA10 / PA9 sur la carte est simplement signé comme A10 / A9 - ces ports sont le premier matériel USART, il y en a 3 sur la carte, il y a aussi 2 I2C matériels et 2 SPI.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par souci de commodité, j'ai alimenté la carte à partir de 5 V, pour une alimentation à partir de 3,3 V, la carte a une broche «3,3». </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Attention, 5 V peut facilement désactiver le microcontrôleur</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , alors faites bien attention à la connexion. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Téléchargez, installez et exécutez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Flash Loader Demonstrator</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (disponible dans les archives de l'article): </font></font><br>
<br>
<img src="https://habrastorage.org/files/124/554/93b/12455493b0334429b4f975143717ef88.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sélectionnez le numéro de port COM de notre adaptateur, dans mon cas c'est COM43, puis cliquez sur "Suivant": </font></font><br>
<br>
<img src="https://habrastorage.org/files/866/092/649/866092649ba24aaf9db036baa5aa29df.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque j'ai un nouveau microcontrôleur, la </font><s><font style="vertical-align: inherit;">volée</font></s><font style="vertical-align: inherit;"> ne </font><s><font style="vertical-align: inherit;">s'est</font></s><font style="vertical-align: inherit;"> toujours </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pas assise</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">personne n'y a rien écrit (bien sûr, sauf le fabricant lui-même), puis par défaut il y a une protection en lecture, le programme nous avertit que si vous cliquez sur le bouton "Supprimer la protection", la mémoire Flash sera effacée, c'est-à-dire s'il y avait une sorte de firmware - elle prendra sa retraite. Dans mon cas, il n'y a rien d'utile, alors j'appuie hardiment. Ensuite, je vois ce qui suit: </font></font><br>
<br>
<img src="https://habrastorage.org/files/faf/937/62f/faf93762f79843ec8bb1989cc5ed2295.PNG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cliquez sur "OK": </font></font><br>
<br>
<img src="https://habrastorage.org/files/132/4ea/aa8/1324eaaa861144bca5619c2703a49b38.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque ma carte de débogage est basée sur le microcontrôleur STM32F103 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - il y a 64 Ko de mémoire Flash, il y a aussi un </font><font style="vertical-align: inherit;">microcontrôleur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> STM32F103 </font><font style="vertical-align: inherit;">, où il y a deux fois plus de Flash. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cliquez ensuite sur "Suivant": </font></font><br>
<br>
<img src="https://habrastorage.org/files/021/79d/9e9/02179d9e9acb48fd845b79364cf3765a.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encore une fois, "Suivant", et nous voyons la fenêtre suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/files/eb8/373/a44/eb8373a444d2489ba2ac37077ebe9093.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sélectionnez "Télécharger sur l'appareil" et cliquez sur "...":</font></font><br>
<br>
<img src="https://habrastorage.org/files/cd4/f1e/af6/cd4f1eaf6e4a4557befea62a0d5f91ee.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Changez le type de fichier en * .bin et ouvrez le fichier «generic_boot20_pc13.bin» (également présent dans l'archive) qui peut être extrait du projet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32duino-bootloader</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous cliquons sur le bouton "Suivant", après le firmware du chargeur de démarrage, nous verrons un feu vert: </font></font><br>
<br>
<img src="https://habrastorage.org/files/694/7e2/a39/6947e2a39b0e4dd2995145f80ec1a1b8.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, nous devons télécharger, pour l'environnement de développement Arduino IDE, un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">noyau STM32</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> spécial </font><font style="vertical-align: inherit;">(il est également dans les archives de l'article). </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il y a une nuance ici, au moment de la rédaction, le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">noyau ne fonctionne pas sur les versions de l'environnement de développement sur 1.6.5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , j'ai 1.6.5-r5 que j'ai </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">téléchargé ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></s> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le noyau a été testé pour fonctionner sur la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">version 1.6.9 d'Arduino IDE</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, décompressez le contenu dans Mes documents \ Arduino \ hardware:</font></font><br>
<br>
<img src="https://habrastorage.org/files/98b/ed2/7f9/98bed27f9cf3403d9518307b9d5a9b57.PNG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans mon cas, le chemin complet ressemble à ceci - "C: \ Users \ RSK \ Documents \ Arduino \ hardware" </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien sûr, le système ne peut pas déterminer le système de l'appareil, vous devez donc toujours installer les pilotes sur la carte. Nous allons dans le dossier "Mes Documents \ Arduino \ hardware \ Arduino_STM32 \ drivers \ win" (ou "drivers \ win", dans le cas d'une archive de l'article), et exécutons le fichier "install_drivers.bat" en tant qu'administrateur: </font></font><br>
<br>
<img src="https://habrastorage.org/files/99a/523/588/99a523588e134d478d0d72988d9b1e6a.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après cela, le cavalier supérieur (qui "BOOT0"), mettez-la en position "0" et connectez la carte à l'ordinateur via un câble microUSB: </font></font><br>
<br>
<img src="https://habrastorage.org/files/be6/c72/ff8/be6c72ff836947a382a558c1e6323a60.JPG" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Elle doit être définie dans le gestionnaire de périphériques comme "Maple DFU" ou "Maple Serial (COM *)": </font></font><br>
<br>
<img src="https://habrastorage.org/files/97b/154/a3b/97b154a3b891400ca365af6e0c7ef922.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
On ne sait pas pourquoi après la première connexion la carte est définie différemment sur différents ordinateurs, mais pas le point, nous procédons à la configuration de l'IDE Arduino.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous lançons l'environnement de développement, puis Outils -&gt; </font></font><br>
<br>
<img src="https://habrastorage.org/files/3c6/306/4e1/3c63064e14424feeba0dd583863de356.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Carte </font><font style="vertical-align: inherit;">-&gt; Gestionnaire de cartes: </font><font style="vertical-align: inherit;">Ici, vous devez installer le noyau de la carte Arduino Due. Sélectionnez la dernière version et cliquez sur «Installer»: </font></font><br>
<br>
<img src="https://habrastorage.org/files/558/187/594/558187594cfb4bce944089a37d76d7f9.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
puis Outils -&gt; Carte -&gt; «Générique STM32F103C», puis Variante: «STM32F103C8 (20k RAM. 64k Flash)», Méthode de téléchargement: «STM32duino bootloader», Port - numéro de port COM de la carte , en général, tout est comme dans la capture d'écran: </font></font><br>
<br>
<img src="https://habrastorage.org/files/3a3/2a2/ecd/3a32a2ecdfdf4ca2bb9164eeffa9050d.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout, la carte est prête pour le firmware et la programmation dans l'environnement de développement Arduino IDE. Faisons clignoter quelques croquis des exemples qui sont «cousus» dans le noyau, allez dans Fichier -&gt; Dossier avec des croquis -&gt; matériel -&gt; Arduino_STM32 -&gt; STM32F1 -&gt; bibliothèques -&gt; A_STM32_Examples -&gt; Numérique -&gt; Blink: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fdb/7df/6fb/fdb7df6fb6b64ade9f6c23a031367e4b.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Classique «Bonjour tout le monde» dans le monde des microcontrôleurs. Nous changeons PB1 en PC13, car la LED sur la carteconnecté à ce port:</font></font><br>
<br>
<img src="https://habrastorage.org/files/a24/e91/2d9/a24e912d93fb42869921f9c9dd985bd5.JPG" alt="image"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
* Au fait, il s'allume à un niveau bas sur la jambe PC13. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous appuyons sur le bouton «Télécharger», après le firmware, l'environnement de développement affichera quelque chose comme: </font></font><br>
<br>
<img src="https://habrastorage.org/files/ae6/07b/674/ae607b6742f744088bd27b5388dbf31b.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
«Terminé! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Réinitialisation de l'USB pour revenir au mode d'exécution </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Erreur de réinitialisation après le téléchargement: usb_reset: impossible de réinitialiser le périphérique, erreur de victoire: impossible de trouver le fichier spécifié. ". </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais le firmware s'est ensuite chargé avec succès, bien que ce ne soit pas toujours le cas, parfois l'IDE Arduino donne d'autres messages.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Impossible de trouver le périphérique DFU</font></font></b><div class="spoiler_text"> ,  :<br>
<br>
<img src="https://habrastorage.org/files/2f7/9b6/3c3/2f79b63c37dd44f6804f39c83d8ca14c.png" alt="image"><br>
<br>
«dfu-util — © 2007-2008 by OpenMoko Inc.<br>
Couldn't find the DFU device: [1EAF:0003]<br>
This program is Free Software and has ABSOLUTELY NO WARRANTY»<br>
<br>
 ,     .<br>
</div></div><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recherche d'unité DFU [1EAF: 0003] ...</font></font></b><div class="spoiler_text">   :<br>
<br>
<img src="https://habrastorage.org/files/b2f/a3e/a09/b2fa3ea09c004c8caf3175f1053e9d39.png" alt="image"><br>
<br>
«Searching for DFU device [1EAF:0003]…<br>
Assuming the board is in perpetual bootloader mode and continuing to attempt dfu programming...»<br>
<br>
    ,         .      Arduino Pro Mini.<br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Et maintenant, à propos de la "mouche dans la pommade", à propos de laquelle j'ai écrit au début de l'article, pour une raison quelconque, il n'est pas toujours possible de flasher la carte dans l'environnement de développement, encore plus, elle n'est pas toujours déterminée par l'ordinateur. </font><font style="vertical-align: inherit;">J'ai décidé ceci pour moi comme suit, avant de télécharger le firmware (avant de cliquer sur le bouton "Télécharger"), je clique sur "Reset" sur la carte, et après le firmware, je redémarre à nouveau la carte. </font><font style="vertical-align: inherit;">Dans ce cas, le pourcentage de probabilité que la planche soit cousue est de 99%. </font><font style="vertical-align: inherit;">On ne sait pas pourquoi cela fonctionne de cette façon, mais c'est un fait. </font><font style="vertical-align: inherit;">Je pense que tôt ou tard ce montant sera corrigé, et tout redémarrera automatiquement au besoin. </font><font style="vertical-align: inherit;">Et pour résoudre ce problème plus rapidement, il est nécessaire que la communauté de cette merveilleuse carte de débogage STM32 se développe, alors partagez cet article avec des amis, en particulier des amis programmeurs. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À propos du brochage:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cliquable</font></font></b><div class="spoiler_text">    ,    (   ):<br>
<br>
<a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/4b0/def/711/4b0def711af2f6fc049dcb9c2c6c759e.png" alt="image"></a><br>
() <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.stm32duino.com/viewtopic.php?p=11137</a><br>
<br>
      , : <br>
<br>
<i>digitalWrite(PB0, LOW); <br>
<s>analogWrite(PA8, 65535);</s>pwmWrite(PA8, 65535); <br>
analogRead(PA0); <br>
LiquidCrystal lcd(PB0, PA7, PA6, PA5, PA4, PA3);</i><br>
<br>
     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">docs.leaflabs.com/docs.leaflabs.com/index.html</a>          Arduino IDE,    .<br>
<br>
    ,     :<br>
<i>Documents\Arduino\hardware\Arduino_STM32\STM32F1\variants\generic_stm32f103c\board.cpp</i><br>
<br>
   ,  :<br>
<ul>
<li>,    <s>analogWrite();</s>pwmWrite(); — PB0, PA7, PA6, PA3, PA2, PA1, PA0, PB7, PB6, PA10, PA9, PA8,     ,     ;</li>
<li>,  analogRead(); — PB0, PA7, PA6, PA5, PA4, PA3, PA2, PA1, PA0.</li>
</ul><br>
<br>
    .       ,   1.9 .<br>
<br>
 ,   PA12/PA11   D+/D- USB,       ,   ,    2-     ,    .<br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le circuit imprimé:</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cliquable</font></font></b><div class="spoiler_text"><a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/133/e87/543/133e875430de3f6b647547475f8358af.jpg" alt="image"></a><br>
() <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.stm32duino.com/viewtopic.php?p=11464#p11464</a><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enfin, enfin:</font></font><br>
<br>
<img src="https://habrastorage.org/files/9cb/14b/562/9cb14b562e7f43b58a156618f171aa84.JPG" alt="image"><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Salut geektimes.ru</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//https://github.com/mk90/LiquidCrystalRus</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//STM32  !</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;LiquidCrystalRus.h&gt;</span></span></span></span><font></font>
<font></font>
<span class="hljs-function"><span class="hljs-function">LiquidCrystalRus </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">lcd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PB9, PB8, PB7, PB6, PB5, PB4)</span></span></span></span>;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  lcd.begin(<span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>);<font></font>
  lcd.print(<span class="hljs-string"><span class="hljs-string">""</span></span>);<font></font>
  lcd.setCursor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);<font></font>
  lcd.print(<span class="hljs-string"><span class="hljs-string">"geektimes.ru"</span></span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  lcd.setCursor(<span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>);<font></font>
  lcd.print(millis() / <span class="hljs-number"><span class="hljs-number">1000</span></span>);<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Liens: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Archive vers l'article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Portail d'un ami de Roger Clark dédié au portage de STM32</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , questions / suggestions / remerciements, tout y est; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/rogerclarkmelbourne/Arduino_STM32</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://docs.leaflabs.com/docs.leaflabs.com/index.html</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - c'est ce projet que Roger a pris comme base, donc il y a beaucoup de choses utiles, bien qu'en anglais; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La version 1.6.5-r5 de l'IDE Arduino peut être téléchargée ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mon article, dans une certaine mesure, croise l' </font><font style="vertical-align: inherit;">ami </font><font style="vertical-align: inherit;">" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32 vs Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">@RaJa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fiche technique sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STM32F103C8T6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toutes mes publications sur les geektimes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD 15/07/2016</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le noyau a été testé pour fonctionner sur la version 1.6.9 d'Arduino IDE: </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geektimes.ru/post/277928/#comment_9532576</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
PS</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quoi d'autre oublié</font></font></b><div class="spoiler_text">       :<br>
<br>
<img src="https://habrastorage.org/files/08e/d64/4c5/08ed644c5daf40cb80ef5e2aa9442d51.JPG" alt="image"><br>
<br>
   ,      .<br>
<br>
   ,    microUSB :<br>
<br>
<img src="https://habrastorage.org/files/9fa/27c/f23/9fa27cf2394a446d8411f0b14f77f427.jpg" alt="image"><br>
<br>
      , ,   .<br>
</div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr395577/">https://habr.com/ru/post/fr395577/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr395565/index.html">Bogue de fourche du logiciel Ethereum, annulation des résultats et croissance de l'ondulation</a></li>
<li><a href="../fr395567/index.html">Test du SSD Kingston UV400 480 Go - SSD Raisin</a></li>
<li><a href="../fr395571/index.html">Спросите Итана №66: Мы что, нашли тёмную материю?</a></li>
<li><a href="../fr395573/index.html">Les vendeurs russes tirent la sonnette d'alarme: les produits sont moins chers dans les magasins en ligne étrangers</a></li>
<li><a href="../fr395575/index.html">SanDisk lance MicroSDXC jusqu'à 256 Go</a></li>
<li><a href="../fr395579/index.html">Quel devrait être le véritable gouvernement électronique? L'Estonie montre un exemple</a></li>
<li><a href="../fr395581/index.html">Comment l'édition génomique changera l'agriculture. Si nous permettons ...</a></li>
<li><a href="../fr395583/index.html">L'itinérance l'emportera sur les innovations, pas sur les lois</a></li>
<li><a href="../fr395587/index.html">De vrais chars dans l'univers du jeu</a></li>
<li><a href="../fr395591/index.html">OnePlus 3: la nouveauté Android la plus attendue de l'été</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>