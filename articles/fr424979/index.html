<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äçüîß üë®üèø‚Äçüîß üèôÔ∏è Orme. Confortable et maladroit. Http, Task üë®üèø‚Äçüé§ ‚è™ üèà</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous continuons de parler de l' orme 0,18 . 


 Orme. Confortable et maladroit 
 Orme. Confortable et maladroit. La composition 
 Orme. Confortable et...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Orme. Confortable et maladroit. Http, Task</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424979/"><p>  Nous continuons de parler de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">orme 0,18</a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Orme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Confortable et maladroit</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Orme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Confortable et maladroit.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La composition</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Orme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Confortable et maladroit.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Json.Encoder et Json.Decoder</a> </p><br><p>  Dans cet article, nous examinons les probl√®mes d'interaction avec le c√¥t√© serveur. </p><a name="habracut"></a><br><h2 id="vypolnenie-zaprosov">  Ex√©cution de requ√™te </h2><br><p>  Des exemples de requ√™tes simples peuvent √™tre trouv√©s dans la description du package <a href="https://package.elm-lang.org/packages/elm-lang/">Http</a> . </p><br><p>  Le type de demande est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Request a</a> . <br>  Le type de r√©sultat de la requ√™te est Result <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Error</a> a. <br>  Les deux types sont param√©tr√©s par le type d'utilisateur, dont le d√©codeur doit √™tre sp√©cifi√© lors de la g√©n√©ration de la requ√™te. </p><br><p>  Vous pouvez ex√©cuter la demande √† l'aide des fonctions: </p><br><ol><li>  Http.send; </li><li>  Http.toTask. </li></ol><br><p>  Http.send vous permet d'ex√©cuter la demande et √† la fin, transmet le message √† la fonction de mise √† jour sp√©cifi√©e dans le premier argument.  Le message contient des donn√©es sur le r√©sultat de la demande. </p><br><p> Http.toTask vous permet de cr√©er une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">t√¢che √†</a> partir d'une demande que vous pouvez ex√©cuter.  √Ä mon avis, l'utilisation de la fonction Http.toTask est la plus pratique, car les instances de t√¢che peuvent √™tre combin√©es √† l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aide de diverses fonctions</a> , par exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.map2</a> . </p><br><p>  Regardons un exemple.  Par exemple, pour enregistrer les donn√©es utilisateur, deux requ√™tes d√©pendantes cons√©cutives doivent √™tre ex√©cut√©es.  Que ce soit en cr√©ant un message de l'utilisateur et en lui enregistrant des photos (certains CDN sont utilis√©s). </p><br><p>  Tout d'abord, consid√©rez l'impl√©mentation du cas Http.Send.  Pour cela, nous avons besoin de deux fonctions: </p><br><pre><code class="hljs vbscript">save : UserData -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> UserData save userData = Http.post ‚Äú/some/url‚Äù (Http.jsonBody (encodeUserData userData)) decodeUserData saveImages : <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; Images -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> CDNData saveImages id images = Http.post (‚Äú/some/cdn/<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>/‚Äù ++ (toString id)) (imagesBody images) decodedCDNData</code> </pre> <br><p>  Les types UserData et CDNData ne seront pas d√©crits; par exemple, ils ne sont pas importants.  La fonction encodeUserData est un encodeur.  saveImages accepte un identifiant de donn√©es utilisateur, qui est utilis√© pour former l'adresse, et une liste de photos.  La fonction imagesBody forme un corps de requ√™te de type <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://package.elm-lang.org/packages/elm-lang/">multipart / form-data</a> .  Les fonctions decodeUserData et decodedCDNData d√©codent la r√©ponse du serveur pour les donn√©es utilisateur et le r√©sultat de la demande au CDN, respectivement. </p><br><p>  Ensuite, nous avons besoin de deux messages, les r√©sultats de la requ√™te: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">) | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ImagesSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  Supposons que, quelque part dans l'impl√©mentation de la fonction de mise √† jour, il existe une section de code qui stocke les donn√©es.  Par exemple, cela pourrait ressembler √† ceci: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ClickedSomething -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Http.send DataSaved (<span class="hljs-keyword"><span class="hljs-keyword">save</span></span> model.userData))</code> </pre> <br><p>  Dans ce cas, une requ√™te est cr√©√©e et marqu√©e avec un message DataSaved.  De plus, ce message est re√ßu: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> DataSaved (Ok userData) -&gt; ( {<span class="hljs-keyword"><span class="hljs-keyword">model</span></span> | userData = userData}, Http.send ImagesSaved (saveImages userData.id model.images)) DataSaved (Err reason) -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Cmd.None)</code> </pre> <br><p>  En cas de sauvegarde r√©ussie, nous mettons √† jour les donn√©es du mod√®le et appelons la demande de sauvegarde des photos o√π nous transf√©rons l'identifiant de donn√©es utilisateur re√ßu.  Le traitement du message ImagesSaved sera similaire √† DataSaved, il sera n√©cessaire de g√©rer les cas r√©ussis et ayant √©chou√©. </p><br><p>  Consid√©rez maintenant l'option d'utiliser la fonction Http.toTask.  En utilisant les fonctions d√©crites, nous d√©finissons une nouvelle fonction: </p><br><pre> <code class="hljs erlang-repl">saveAll : UserData -&gt; Images -&gt; Task Http.Error (UserData, CDNData) saveAll : userData images = save model.userData |&gt; Http.toTask |&gt; Task.andThen (\newUserData -&gt; saveImages usersData.id images |&gt; Http.toTask |&gt; Task.map (\newImages -&gt; (userData, newImages) } )</code> </pre> <br><p>  Maintenant, en utilisant la possibilit√© de combiner des t√¢ches, nous pouvons obtenir toutes les donn√©es dans un seul message: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)) update : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class">) update msg model case </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> of </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ClickedSomething</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attempt</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">saveAll</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) -&gt; ( {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class"> | </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">}, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">none</span></span></span><span class="hljs-class">) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Err</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reason</span></span></span><span class="hljs-class">) -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">None</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  Pour ex√©cuter les requ√™tes, nous utilisons la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.attempt</a> , qui vous permet de terminer la t√¢che.  √Ä ne pas confondre avec la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.perform</a> .  Task.perform - vous permet d'effectuer des t√¢ches qui <strong>ne peuvent pas √©chouer</strong> .  Task.attempt - Effectue des t√¢ches qui <strong>peuvent √©chouer</strong> . </p><br><p>  Cette approche est plus compacte en termes de nombre de messages, de complexit√© de la fonction de mise √† jour et permet de garder la logique plus locale. </p><br><p>  Dans mes projets, applications et composants, je cr√©e souvent le module Commands.elm, dans lequel je d√©cris les fonctions d'interaction avec la partie serveur avec le type ... -&gt; Task Http.Error a. </p><br><h2 id="sostoyanie-vypolneniya-zaprosov">  Demander le statut d'ex√©cution </h2><br><p>  Dans le processus d'ex√©cution des requ√™tes, l'interface doit souvent √™tre bloqu√©e en tout ou en partie, et √©galement signaler les erreurs d'ex√©cution des requ√™tes, le cas √©ch√©ant.  En g√©n√©ral, l'√©tat d'une demande peut √™tre d√©crit comme: </p><br><ol><li>  la demande n'est pas termin√©e; </li><li>  la demande est en cours; </li><li>  La demande a √©t√© accept√©e; </li><li>  la demande a √©chou√©. </li></ol><br><p>  Pour une telle description, il existe un package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RemoteData</a> .  Au d√©but, je l'ai utilis√© activement, mais au fil du temps, la pr√©sence d'un type suppl√©mentaire de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WebData</a> est devenue redondante, et travailler avec elle √©tait fastidieux.  Au lieu de ce package, les r√®gles suivantes sont apparues: </p><br><ol><li>  d√©clarer toutes les donn√©es du serveur comme Peut-√™tre.  Dans ce cas, Nothing, indique l'absence de donn√©es; </li><li>  d√©clarer un attribut de chargement de type Int dans le mod√®le d'application ou de composant.  Le param√®tre stocke le nombre de requ√™tes ex√©cut√©es.  Le seul inconv√©nient de cette approche est la n√©cessit√© d'incr√©menter et de d√©cr√©menter l'attribut au d√©but de la demande et √† la fin, respectivement; </li><li>  d√©clarer un attribut d'erreur de type List String dans le mod√®le d'application ou de composant.  Cet attribut est utilis√© pour stocker des donn√©es d'erreur. </li></ol><br><p>  Le sch√©ma d√©crit n'est pas beaucoup mieux que l'option avec le package RemoteData, comme le montre la pratique.  Si quelqu'un a d'autres options, partagez les commentaires. </p><br><p>  Le statut d'ex√©cution de la demande doit inclure la progression du t√©l√©chargement √† partir du package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Progress</a> . </p><br><h2 id="posledovatelnost-zadach">  S√©quence de t√¢ches </h2><br><p>  Consid√©rez les options pour les s√©quences de t√¢ches qui se trouvent souvent dans le d√©veloppement: </p><br><ol><li>  t√¢ches d√©pendantes s√©quentielles; </li><li>  t√¢ches ind√©pendantes coh√©rentes; </li><li>  t√¢ches ind√©pendantes parall√®les. </li></ol><br><p>  Les t√¢ches d√©pendantes successives ont d√©j√† √©t√© examin√©es ci-dessus; je vais donner une description g√©n√©rale et des approches de mise en ≈ìuvre dans cette section. </p><br><p>  La s√©quence de t√¢ches est interrompue lors du premier √©chec et une erreur est renvoy√©e.  En cas de succ√®s, une combinaison de r√©sultats est renvoy√©e: </p><br><pre> <code class="hljs erlang-repl">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p>  Ce code cr√©e une t√¢che de type Erreur de t√¢che (a, b), qui peut √™tre effectu√©e ult√©rieurement. </p><br><p>  La fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.andThen vous</a> permet de transf√©rer une nouvelle t√¢che pour ex√©cution si la pr√©c√©dente est termin√©e avec succ√®s.  La fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.map vous</a> permet de convertir les r√©sultats d'ex√©cution du melon en cas de succ√®s. </p><br><p>  Il existe des options lorsque la r√©ussite de la t√¢che ne sera pas suffisante et que vous devez v√©rifier la coh√©rence des donn√©es.  Supposons que les ID utilisateur correspondent: </p><br><pre> <code class="hljs pgsql">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.andThen (\resultB -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> resultA.userId == resultB.userId <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> -&gt; Task.succeed (resultA, resultB) <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> -&gt; Task.fail ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> the same‚Äù ) )</code> </pre> <br><p>  Il convient de noter qu'au lieu de la fonction Task.map, la fonction Task.andThen est utilis√©e et le succ√®s de la deuxi√®me t√¢che est d√©termin√© ind√©pendamment √† l'aide des fonctions <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.succeed</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.fail</a> . </p><br><p>  Si l'une des t√¢ches peut √©chouer et que cela est acceptable, vous devez utiliser la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.onError</a> pour indiquer la valeur en cas d'erreur: </p><br><pre> <code class="hljs julia">someTaskA |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.onError (\msg -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>,succeed defaultValue) |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.andThen (\resultA -&gt; someTaskB |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p>  L'appel √† la fonction Task.onError doit √™tre d√©clar√© imm√©diatement apr√®s la d√©claration de la t√¢che. </p><br><p>  Des requ√™tes ind√©pendantes successives peuvent √™tre effectu√©es √† l'aide des fonctions Task.mapN.  Ce qui vous permet de combiner plusieurs r√©sultats de t√¢che en un seul.  La premi√®re t√¢che interrompue interrompt l'ex√©cution de la cha√Æne enti√®re, utilisez donc la fonction Task.onError pour les valeurs par d√©faut.  Consultez √©galement la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.sequence</a> , elle vous permet d'effectuer une s√©rie de t√¢ches similaires. </p><br><p>  Les t√¢ches parall√®les dans l'impl√©mentation actuelle du langage ne sont pas d√©crites.  Leur impl√©mentation est possible au niveau de l'application ou du composant gr√¢ce au traitement des √©v√©nements dans la fonction de mise √† jour.  Toute logique reste sur les √©paules du d√©veloppeur. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr424979/">https://habr.com/ru/post/fr424979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr424969/index.html">Guide Node.js, partie 9: Utilisation du syst√®me de fichiers</a></li>
<li><a href="../fr424971/index.html">Habrokast "Sunset Manually" # 1. Essayer de mettre en place un environnement pour d√©velopper un jouet pour Windows</a></li>
<li><a href="../fr424973/index.html">D√©tection de visages sur vid√©o: Raspberry Pi et Neural Compute Stick</a></li>
<li><a href="../fr424975/index.html">Profondeurs SIEM: corr√©lations pr√™tes √† l'emploi. Partie 2. Le sch√©ma de donn√©es comme reflet du mod√®le ¬´monde¬ª</a></li>
<li><a href="../fr424977/index.html">Apprendre des erreurs: optimiser les applications sur l'App Store et Google Play</a></li>
<li><a href="../fr424981/index.html">RPG de texte d'oeuf de P√¢ques dans le code du moteur de recherche Google</a></li>
<li><a href="../fr424985/index.html">Dans un pr√©c√©dent judiciaire important, les agences de renseignement am√©ricaines n'ont pas √©t√© en mesure d'√©couter des appels dans le messager</a></li>
<li><a href="../fr424987/index.html">R√©cup√©rez des images floues et d√©focalis√©es √† l'aide du filtre Wiener. Impl√©mentation en C ++ OpenCV</a></li>
<li><a href="../fr424989/index.html">Processus de conception: 7 √©tapes pour un projet parfait</a></li>
<li><a href="../fr424991/index.html">Quand les anciennes m√©thodes ne fonctionnent pas: Vasily Mazin - sur une approche hybride du d√©veloppement de l'IA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>