<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍🔧 👨🏿‍🔧 🏙️ Orme. Confortable et maladroit. Http, Task 👨🏿‍🎤 ⏪ 🏈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous continuons de parler de l' orme 0,18 . 


 Orme. Confortable et maladroit 
 Orme. Confortable et maladroit. La composition 
 Orme. Confortable et...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Orme. Confortable et maladroit. Http, Task</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424979/"><p>  Nous continuons de parler de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">orme 0,18</a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Orme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Confortable et maladroit</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Orme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Confortable et maladroit.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">La composition</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Orme.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Confortable et maladroit.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Json.Encoder et Json.Decoder</a> </p><br><p>  Dans cet article, nous examinons les problèmes d'interaction avec le côté serveur. </p><a name="habracut"></a><br><h2 id="vypolnenie-zaprosov">  Exécution de requête </h2><br><p>  Des exemples de requêtes simples peuvent être trouvés dans la description du package <a href="https://package.elm-lang.org/packages/elm-lang/">Http</a> . </p><br><p>  Le type de demande est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Request a</a> . <br>  Le type de résultat de la requête est Result <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Error</a> a. <br>  Les deux types sont paramétrés par le type d'utilisateur, dont le décodeur doit être spécifié lors de la génération de la requête. </p><br><p>  Vous pouvez exécuter la demande à l'aide des fonctions: </p><br><ol><li>  Http.send; </li><li>  Http.toTask. </li></ol><br><p>  Http.send vous permet d'exécuter la demande et à la fin, transmet le message à la fonction de mise à jour spécifiée dans le premier argument.  Le message contient des données sur le résultat de la demande. </p><br><p> Http.toTask vous permet de créer une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tâche à</a> partir d'une demande que vous pouvez exécuter.  À mon avis, l'utilisation de la fonction Http.toTask est la plus pratique, car les instances de tâche peuvent être combinées à l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">aide de diverses fonctions</a> , par exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.map2</a> . </p><br><p>  Regardons un exemple.  Par exemple, pour enregistrer les données utilisateur, deux requêtes dépendantes consécutives doivent être exécutées.  Que ce soit en créant un message de l'utilisateur et en lui enregistrant des photos (certains CDN sont utilisés). </p><br><p>  Tout d'abord, considérez l'implémentation du cas Http.Send.  Pour cela, nous avons besoin de deux fonctions: </p><br><pre><code class="hljs vbscript">save : UserData -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> UserData save userData = Http.post “/some/url” (Http.jsonBody (encodeUserData userData)) decodeUserData saveImages : <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; Images -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> CDNData saveImages id images = Http.post (“/some/cdn/<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>/” ++ (toString id)) (imagesBody images) decodedCDNData</code> </pre> <br><p>  Les types UserData et CDNData ne seront pas décrits; par exemple, ils ne sont pas importants.  La fonction encodeUserData est un encodeur.  saveImages accepte un identifiant de données utilisateur, qui est utilisé pour former l'adresse, et une liste de photos.  La fonction imagesBody forme un corps de requête de type <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://package.elm-lang.org/packages/elm-lang/">multipart / form-data</a> .  Les fonctions decodeUserData et decodedCDNData décodent la réponse du serveur pour les données utilisateur et le résultat de la demande au CDN, respectivement. </p><br><p>  Ensuite, nous avons besoin de deux messages, les résultats de la requête: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">) | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ImagesSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  Supposons que, quelque part dans l'implémentation de la fonction de mise à jour, il existe une section de code qui stocke les données.  Par exemple, cela pourrait ressembler à ceci: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ClickedSomething -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Http.send DataSaved (<span class="hljs-keyword"><span class="hljs-keyword">save</span></span> model.userData))</code> </pre> <br><p>  Dans ce cas, une requête est créée et marquée avec un message DataSaved.  De plus, ce message est reçu: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> DataSaved (Ok userData) -&gt; ( {<span class="hljs-keyword"><span class="hljs-keyword">model</span></span> | userData = userData}, Http.send ImagesSaved (saveImages userData.id model.images)) DataSaved (Err reason) -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Cmd.None)</code> </pre> <br><p>  En cas de sauvegarde réussie, nous mettons à jour les données du modèle et appelons la demande de sauvegarde des photos où nous transférons l'identifiant de données utilisateur reçu.  Le traitement du message ImagesSaved sera similaire à DataSaved, il sera nécessaire de gérer les cas réussis et ayant échoué. </p><br><p>  Considérez maintenant l'option d'utiliser la fonction Http.toTask.  En utilisant les fonctions décrites, nous définissons une nouvelle fonction: </p><br><pre> <code class="hljs erlang-repl">saveAll : UserData -&gt; Images -&gt; Task Http.Error (UserData, CDNData) saveAll : userData images = save model.userData |&gt; Http.toTask |&gt; Task.andThen (\newUserData -&gt; saveImages usersData.id images |&gt; Http.toTask |&gt; Task.map (\newImages -&gt; (userData, newImages) } )</code> </pre> <br><p>  Maintenant, en utilisant la possibilité de combiner des tâches, nous pouvons obtenir toutes les données dans un seul message: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)) update : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class">) update msg model case </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> of </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ClickedSomething</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attempt</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">saveAll</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) -&gt; ( {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class"> | </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">}, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">none</span></span></span><span class="hljs-class">) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Err</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reason</span></span></span><span class="hljs-class">) -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">None</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p>  Pour exécuter les requêtes, nous utilisons la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.attempt</a> , qui vous permet de terminer la tâche.  À ne pas confondre avec la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.perform</a> .  Task.perform - vous permet d'effectuer des tâches qui <strong>ne peuvent pas échouer</strong> .  Task.attempt - Effectue des tâches qui <strong>peuvent échouer</strong> . </p><br><p>  Cette approche est plus compacte en termes de nombre de messages, de complexité de la fonction de mise à jour et permet de garder la logique plus locale. </p><br><p>  Dans mes projets, applications et composants, je crée souvent le module Commands.elm, dans lequel je décris les fonctions d'interaction avec la partie serveur avec le type ... -&gt; Task Http.Error a. </p><br><h2 id="sostoyanie-vypolneniya-zaprosov">  Demander le statut d'exécution </h2><br><p>  Dans le processus d'exécution des requêtes, l'interface doit souvent être bloquée en tout ou en partie, et également signaler les erreurs d'exécution des requêtes, le cas échéant.  En général, l'état d'une demande peut être décrit comme: </p><br><ol><li>  la demande n'est pas terminée; </li><li>  la demande est en cours; </li><li>  La demande a été acceptée; </li><li>  la demande a échoué. </li></ol><br><p>  Pour une telle description, il existe un package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RemoteData</a> .  Au début, je l'ai utilisé activement, mais au fil du temps, la présence d'un type supplémentaire de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WebData</a> est devenue redondante, et travailler avec elle était fastidieux.  Au lieu de ce package, les règles suivantes sont apparues: </p><br><ol><li>  déclarer toutes les données du serveur comme Peut-être.  Dans ce cas, Nothing, indique l'absence de données; </li><li>  déclarer un attribut de chargement de type Int dans le modèle d'application ou de composant.  Le paramètre stocke le nombre de requêtes exécutées.  Le seul inconvénient de cette approche est la nécessité d'incrémenter et de décrémenter l'attribut au début de la demande et à la fin, respectivement; </li><li>  déclarer un attribut d'erreur de type List String dans le modèle d'application ou de composant.  Cet attribut est utilisé pour stocker des données d'erreur. </li></ol><br><p>  Le schéma décrit n'est pas beaucoup mieux que l'option avec le package RemoteData, comme le montre la pratique.  Si quelqu'un a d'autres options, partagez les commentaires. </p><br><p>  Le statut d'exécution de la demande doit inclure la progression du téléchargement à partir du package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Progress</a> . </p><br><h2 id="posledovatelnost-zadach">  Séquence de tâches </h2><br><p>  Considérez les options pour les séquences de tâches qui se trouvent souvent dans le développement: </p><br><ol><li>  tâches dépendantes séquentielles; </li><li>  tâches indépendantes cohérentes; </li><li>  tâches indépendantes parallèles. </li></ol><br><p>  Les tâches dépendantes successives ont déjà été examinées ci-dessus; je vais donner une description générale et des approches de mise en œuvre dans cette section. </p><br><p>  La séquence de tâches est interrompue lors du premier échec et une erreur est renvoyée.  En cas de succès, une combinaison de résultats est renvoyée: </p><br><pre> <code class="hljs erlang-repl">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p>  Ce code crée une tâche de type Erreur de tâche (a, b), qui peut être effectuée ultérieurement. </p><br><p>  La fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.andThen vous</a> permet de transférer une nouvelle tâche pour exécution si la précédente est terminée avec succès.  La fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.map vous</a> permet de convertir les résultats d'exécution du melon en cas de succès. </p><br><p>  Il existe des options lorsque la réussite de la tâche ne sera pas suffisante et que vous devez vérifier la cohérence des données.  Supposons que les ID utilisateur correspondent: </p><br><pre> <code class="hljs pgsql">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.andThen (\resultB -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> resultA.userId == resultB.userId <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> -&gt; Task.succeed (resultA, resultB) <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> -&gt; Task.fail “<span class="hljs-keyword"><span class="hljs-keyword">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> the same” ) )</code> </pre> <br><p>  Il convient de noter qu'au lieu de la fonction Task.map, la fonction Task.andThen est utilisée et le succès de la deuxième tâche est déterminé indépendamment à l'aide des fonctions <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.succeed</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.fail</a> . </p><br><p>  Si l'une des tâches peut échouer et que cela est acceptable, vous devez utiliser la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.onError</a> pour indiquer la valeur en cas d'erreur: </p><br><pre> <code class="hljs julia">someTaskA |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.onError (\msg -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>,succeed defaultValue) |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.andThen (\resultA -&gt; someTaskB |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p>  L'appel à la fonction Task.onError doit être déclaré immédiatement après la déclaration de la tâche. </p><br><p>  Des requêtes indépendantes successives peuvent être effectuées à l'aide des fonctions Task.mapN.  Ce qui vous permet de combiner plusieurs résultats de tâche en un seul.  La première tâche interrompue interrompt l'exécution de la chaîne entière, utilisez donc la fonction Task.onError pour les valeurs par défaut.  Consultez également la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Task.sequence</a> , elle vous permet d'effectuer une série de tâches similaires. </p><br><p>  Les tâches parallèles dans l'implémentation actuelle du langage ne sont pas décrites.  Leur implémentation est possible au niveau de l'application ou du composant grâce au traitement des événements dans la fonction de mise à jour.  Toute logique reste sur les épaules du développeur. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr424979/">https://habr.com/ru/post/fr424979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr424969/index.html">Guide Node.js, partie 9: Utilisation du système de fichiers</a></li>
<li><a href="../fr424971/index.html">Habrokast "Sunset Manually" # 1. Essayer de mettre en place un environnement pour développer un jouet pour Windows</a></li>
<li><a href="../fr424973/index.html">Détection de visages sur vidéo: Raspberry Pi et Neural Compute Stick</a></li>
<li><a href="../fr424975/index.html">Profondeurs SIEM: corrélations prêtes à l'emploi. Partie 2. Le schéma de données comme reflet du modèle «monde»</a></li>
<li><a href="../fr424977/index.html">Apprendre des erreurs: optimiser les applications sur l'App Store et Google Play</a></li>
<li><a href="../fr424981/index.html">RPG de texte d'oeuf de Pâques dans le code du moteur de recherche Google</a></li>
<li><a href="../fr424985/index.html">Dans un précédent judiciaire important, les agences de renseignement américaines n'ont pas été en mesure d'écouter des appels dans le messager</a></li>
<li><a href="../fr424987/index.html">Récupérez des images floues et défocalisées à l'aide du filtre Wiener. Implémentation en C ++ OpenCV</a></li>
<li><a href="../fr424989/index.html">Processus de conception: 7 étapes pour un projet parfait</a></li>
<li><a href="../fr424991/index.html">Quand les anciennes méthodes ne fonctionnent pas: Vasily Mazin - sur une approche hybride du développement de l'IA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>