<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§ â˜˜ï¸ ğŸ¤›ğŸ½ åœ£è¯èŠ‚å¤ªç©ºæ¼«æ­¥ ğŸŒ± ğŸ§•ğŸ¾ ğŸ¤¾ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼ 

 åœ£è¯èŠ‚å‰ä¸ä¹…ï¼Œæˆ‘ä»¬å†³å®šåœ¨ITéƒ¨é—¨å­¦ä¹ Spacewalk-è¿™æ˜¯Red Hatç³»ç»Ÿï¼Œå®ƒæ˜¯Satelliteçš„å…è´¹æ¨¡æ‹Ÿäº§å“ï¼Œç”¨äºé›†ä¸­å¼é…ç½®ç®¡ç†ï¼Œç³»ç»Ÿæ›´æ–°ä»¥åŠå¯¹æ•´ä¸ªæœåŠ¡å™¨å›­åŒºçš„ä¾¿æ·æ”¯æŒã€‚ 

 ç”±äºå®˜æ–¹ç½‘ç«™ä¸Šæä¾›çš„æ–‡æ¡£ä¸è¶³ä»¥æä¾›æœ‰å…³å„ç§æ•…éšœæ’é™¤çš„å…¶ä»–æ³¨é‡Šï¼Œå› æ­¤ä»»åŠ¡æ˜¯ç ”ç©¶äº§å“ï¼Œä½¿å…¶é¦–å…ˆé€æ­¥å¼•å…¥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ£è¯èŠ‚å¤ªç©ºæ¼«æ­¥</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435578/">å“ˆHaï¼ <br><br> åœ£è¯èŠ‚å‰ä¸ä¹…ï¼Œæˆ‘ä»¬å†³å®šåœ¨ITéƒ¨é—¨å­¦ä¹ Spacewalk-è¿™æ˜¯Red Hatç³»ç»Ÿï¼Œå®ƒæ˜¯Satelliteçš„å…è´¹æ¨¡æ‹Ÿäº§å“ï¼Œç”¨äºé›†ä¸­å¼é…ç½®ç®¡ç†ï¼Œç³»ç»Ÿæ›´æ–°ä»¥åŠå¯¹æ•´ä¸ªæœåŠ¡å™¨å›­åŒºçš„ä¾¿æ·æ”¯æŒã€‚ <br><br> ç”±äºå®˜æ–¹ç½‘ç«™ä¸Šæä¾›çš„æ–‡æ¡£ä¸è¶³ä»¥æä¾›æœ‰å…³å„ç§æ•…éšœæ’é™¤çš„å…¶ä»–æ³¨é‡Šï¼Œå› æ­¤ä»»åŠ¡æ˜¯ç ”ç©¶äº§å“ï¼Œä½¿å…¶é¦–å…ˆé€æ­¥å¼•å…¥æœåŠ¡å™¨ï¼Œç„¶åå†å¼•å…¥äº§å“ã€‚ <br><br> å¼•å…¥Spacewalkçš„ä¸»è¦æ€æƒ³ä¸ä»…æ˜¯é›†ä¸­åŒ–å’Œç®€åŒ–æ§åˆ¶ï¼Œè¿˜å› ä¸ºæ²¡æœ‰å…ˆä¾‹ï¼Œæ‰€ä»¥æ²¡æœ‰äººä¼šç”¨ä¿çš®çš„ç¬”åœ¨æ–°é¡¹ç›®çš„æœåŠ¡å™¨ä¸Šæ’­æ”¾æ›´æ–°ã€‚ <br><br> ç»è¿‡ä¸¤å‘¨çš„å·¥ä½œï¼Œæˆ‘æ‰€è·å¾—çš„æ‰€æœ‰çŸ¥è¯†éƒ½è¢«è¾“å…¥åˆ°Confluenceçš„å†…éƒ¨ç±»ä¼¼ç‰©ä¸­ï¼Œå¹¶ä¸”æœ‰ä¸€å¤©çš„ä¼‘æ¯æ—¥ä¿ƒä½¿æˆ‘æ’°å†™æœ‰å…³Habrçš„æ–‡ç« ã€‚ <br><a name="habracut"></a><br> åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘æƒ³ç®€è¦ä»‹ç»ä¸€ä¸‹å—å½±å“çš„å’Œä¸å—å½±å“çš„ï¼Œä»¥å…å‡è£…ä½¿ç”¨Spacewalkçš„å®Œæ•´æ‰‹å†Œï¼š <br><br>  +æœåŠ¡å™¨/å®¢æˆ·ç«¯çš„å®‰è£…å’Œé…ç½® <br>  + GUIä¸­çš„ç³»ç»Ÿè®¾ç½® <br>  +å¯¹å®‰è£…/æ›´æ–°è½¯ä»¶åŒ…è¿›è¡Œæ•…éšœæ’é™¤ï¼Œä½¿ç”¨é…ç½® <br>  +å‹˜è¯¯è¡¨ï¼ˆæ”¶é›†æœ‰å…³å…³é”®æ›´æ–°ï¼Œæ¼æ´ç­‰çš„ä¿¡æ¯ï¼‰ <br><br>  -ä»£ç†ï¼ˆæ”¾å¼ƒHAåï¼Œéœ€æ±‚æ¶ˆå¤±äº†ï¼‰ <br>  -è¡¥é‹åŒ / kickstart <br>  -OpenSCAP <br><br><h3> ç³»ç»Ÿè¦æ±‚ </h3><br> ç”±äºæ•´ä¸ªåŸºç¡€æ¶æ„éƒ½åœ¨VMWareä¸Šè¿è¡Œï¼Œå› æ­¤è¯¥å·¥ä½œæ˜¯åœ¨è¿è¡ŒCentOS 7çš„VMä¸Šè¿›è¡Œçš„ã€‚å¼€å‘äººå‘˜å»ºè®®çš„ç³»ç»Ÿè¦æ±‚ä¸ºï¼š <br><br><ul><li>  4GB RAM </li><li>  / var /å«æ˜Ÿ/ 6 GBå¯ç”¨ç©ºé—´ </li><li>  DB 12GB </li></ul><br> æˆ‘ç”¨è¿‡ï¼š <br><br><ul><li>  6GB RAM </li><li>  4ä¸ªCPU </li><li>  40GBç¡¬ç›˜ </li></ul><br> æˆ‘è¿˜å»ºè®®æ‚¨ç¦ç”¨SELinuxï¼Œå¦‚æœä¸ä½¿ç”¨ï¼Œè¯·ç¦ç”¨firewalldã€‚ æˆ–å°†httpæœåŠ¡æ·»åŠ åˆ°ä¾‹å¤–ä¸­ã€‚ <br><br> æ³¨æ„ï¼šåœ¨æ–‡ç« ç»“å°¾ï¼Œå°†æœ‰Ansibleçš„å‰§æœ¬ï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ¨åˆ†ä»¥åŠbashè„šæœ¬ã€‚ åœ¨ä»–ä»¬çš„å¸®åŠ©ä¸‹ï¼Œå‡ åˆ†é’Ÿä¹‹å†…å°±å¯ä»¥éƒ¨ç½²æ•´ä¸ªåŸºç¡€æ¶æ„ã€‚ <br><br><h3> å®‰è£…æ–¹å¼ </h3><br> åœ¨å®˜æ–¹æ–‡æ¡£å’Œå¤šä¸ªç«™ç‚¹ä¸­éƒ½å¯¹å®‰è£…æœ¬èº«è¿›è¡Œäº†æè¿°ï¼Œä½†æ˜¯ï¼Œå‡ºäºæ–‡ç« çš„å®Œæ•´æ€§ï¼Œè®©æˆ‘åœ¨è¿™é‡ŒæåŠè¿™ä¸€ç‚¹ã€‚ <br><br>  Spacewalkå¯ä¸ä¸¤ç§DBMSä¸€èµ·ä½¿ç”¨ï¼šPostgreSQLå’ŒOracle RDBMSã€‚ æˆ‘å¯¹ç¬¬ä¸€ä¸ªæœ‰ç»éªŒï¼Œç°åœ¨å°†ä½¿ç”¨å®ƒã€‚ <br><br> æœ‰ä¸¤ä¸ªå®‰è£…é€‰é¡¹ï¼šé€šè¿‡æ¥è‡ªSpacewalkçš„è‡ªåŠ¨å®‰è£…ç¨‹åºï¼ˆå®ƒä»¬å°†åœ¨åŒä¸€æœåŠ¡å™¨ä¸Šå®‰è£…å’Œé…ç½®è‡ªèº«ä»¥åŠæ•°æ®åº“ï¼‰å’Œæ‰‹åŠ¨å®‰è£…ï¼ˆå¯åœ¨å…¶ä¸­å°†æ•°æ®åº“å’Œåº”ç”¨ç¨‹åºæ”¾åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼‰è¿›è¡Œæ‰‹åŠ¨å®‰è£…ã€‚ æˆ‘å°†è€ƒè™‘è¿™ä¸¤ä¸ªé€‰é¡¹ï¼Œæˆ‘å°†ä»å•ç‹¬å®‰è£…å¼€å§‹ã€‚ <br><br><h4>  PostgreSQLçš„ </h4><br><pre><code class="bash hljs">yum install -y postgresql-server</code> </pre> <br> è¿˜éœ€è¦ä¸ºPGè¿æ¥PL / Tclæ¨¡å—ï¼š <br><br><pre> <code class="bash hljs">yum install -y postgresql-pltcl postgresql-setup initdb systemctl start postgresql</code> </pre> <br> åˆ›å»ºä¸€ä¸ªæ•°æ®åº“ï¼Œä¸€ä¸ªç”¨æˆ·ï¼Œå¹¶è¿æ¥æ¨¡å—ï¼š <br><br><pre> <code class="bash hljs">su - postgres -c <span class="hljs-string"><span class="hljs-string">'PGPASSWORD=verystrong; createdb spcwlkdb ; createlang plpgsql spcwlkdb ; createlang pltclu spcwlkdb ; yes $PGPASSWORD | createuser -P -sDR spcwlkuser'</span></span></code> </pre> <br> ä¸ºäº†é¿å…è¿æ¥é—®é¢˜ï¼Œå€¼å¾—æ›´æ”¹<i>/var/lib/pgsql/data/pg_hba.conf</i> ï¼Œåœ¨æ‰€æœ‰è¡Œä¹‹å‰æ·»åŠ ä»¥ä¸‹è¡Œï¼š <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">local</span></span> spcwlkdb spcwlkuser md5 host spcwlkdb spcwlkuser 127.0.0.1/8 md5 <span class="hljs-built_in"><span class="hljs-built_in">local</span></span> spcwlkdb postgres ident</code> </pre> <br> é‡æ–°å¯åŠ¨æ‰€æœ‰å†…å®¹ï¼š <br><br><pre> <code class="bash hljs">systemctl restart postgresql</code> </pre> <br> å¦‚æœæ‰“ç®—å°†åº”ç”¨ç¨‹åºå’Œæ•°æ®åº“å®‰è£…åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¯·ç¡®ä¿åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šå®‰è£…äº†<i>postgresql-contrib</i>è½¯ä»¶åŒ…ã€‚ <br><br><h4> å¤ªç©ºæ¼«æ­¥ </h4><br> æˆ‘ä»¬è¿æ¥å­˜å‚¨åº“ï¼š <br><br><pre> <code class="bash hljs">rpm -Uvh https://copr-be.cloud.fedoraproject.org/results/@spacewalkproject/spacewalk-2.8/epel-7-x86_64/00736372-spacewalk-repo/spacewalk-repo-2.8-11.el7.centos.noarch.rpm</code> </pre> <br> è¿˜è¦è¿æ¥epelï¼š <br><br><pre> <code class="bash hljs">rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</code> </pre> <br>  Javaï¼š <br><br><pre> <code class="bash hljs">(<span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /etc/yum.repos.d &amp;&amp; curl -O https://copr.fedorainfracloud.org/coprs/g/spacewalkproject/java-packages/repo/epel-7/group_spacewalkproject-java-packages-epel-7.repo)</code> </pre> <br> ç°åœ¨ç›´æ¥å®‰è£…Spacewalk-postgresçš„å®‰è£…ç¨‹åºï¼š <br><br><pre> <code class="bash hljs">yum -y install spacewalk-setup-postgresql</code> </pre> <br> è¿æ¥åˆ°æˆ‘ä»¬çš„æ•°æ®åº“ï¼š <br><br><pre> <code class="bash hljs">spacewalk-setup-postgresql create --db spcwlkdb --user spcwlkuser --password verystrong</code> </pre> <br> å¦‚æœæ‚¨ä½¿ç”¨å•ç‹¬çš„æ•°æ®åº“/åº”ç”¨ç¨‹åºæ–¹æ³•ï¼Œåˆ™éœ€è¦æ·»åŠ <i>--standalone</i>æ ‡å¿—å¹¶æŒ‡å®šæ•°æ®åº“æœåŠ¡å™¨çš„IPåœ°å€ï¼Œä¹Ÿä¸è¦å¿˜è®°æ‰“å¼€ç«¯å£5432ã€‚ <br><br>  <i>æ³¨æ„ï¼šå»ºè®®æ‚¨æ ¹æ®ç¡¬ä»¶è°ƒæ•´æ•°æ®åº“ï¼Œä»¥æé«˜æ•´ä¸ªç³»ç»Ÿçš„ç”Ÿäº§æ•ˆç‡ã€‚</i> <br><br> ç°åœ¨å®‰è£…Spacewalkæœ¬èº«å¹¶è¿è¡Œå®‰è£…ï¼š <br><br><pre> <code class="bash hljs">yum -y install spacewalk-postgresql spacewalk-setup --external-postgresql</code> </pre> <br> æ¥ä¸‹æ¥ï¼Œå°†è¯¢é—®æœ‰å…³SSLè¯ä¹¦å’Œæ•°æ®åº“çš„å‡ ä¸ªé—®é¢˜ã€‚ æ‚¨å¯ä»¥æ‰‹åŠ¨è¾“å…¥æ‰€æœ‰å€¼ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<i>--answer-file</i>æ ‡å¿—å¹¶ä½¿ç”¨ç­”æ¡ˆæŒ‡å®š<i>æ–‡ä»¶</i>çš„è·¯å¾„ï¼Œä»¥ä¾¿å°†æ¥è‡ªåŠ¨å®‰è£…ï¼š <br><br><pre> <code class="bash hljs">admin-email = root@localhost ssl-set-cnames = spcwlkserver ssl-set-org = Unicorn ssl-set-org-unit = EOH ssl-set-city = Prague ssl-set-state = HMP ssl-set-country = CZ ssl-password = verystrong ssl-set-email = root@localhost ssl-config-sslvhost = Y db-backend=postgresql db-name=spcwlkdb db-user=spcwlkuser db-password=verystrong db-host=localhost db-port=5432 <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span>-tftp=Y</code> </pre> <br> è¦ç›´æ¥æ§åˆ¶åº”ç”¨ç¨‹åºï¼Œåº”ä½¿ç”¨ï¼š <br><br><pre> <code class="bash hljs">/usr/sbin/spacewalk-service [stop|start|restart]</code> </pre> <br> è¦æ˜¾ç¤ºå¯¹åº”ç”¨ç¨‹åºæœ‰è´¡çŒ®çš„æ‰€æœ‰ç¬¬ä¸‰æ–¹æœåŠ¡ï¼š <br><br><pre> <code class="bash hljs">spacewalk-service status</code> </pre> <br><h4> é€‰é¡¹äºŒï¼Œè‡ªåŠ¨å®‰è£… </h4><br> è¿æ¥å­˜å‚¨åº“åï¼Œè®¾ç½®å¹¶è¿è¡Œï¼š <br><br><pre> <code class="bash hljs">yum -y install spacewalk-setup-postgresql yum -y install spacewalk-postgresql spacewalk-setup</code> </pre> <br> å†æ¬¡ï¼Œå°†è¯¢é—®æœ‰å…³æ•°æ®åº“å’ŒSSLçš„é—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨<i>--answer-file</i>å¯†é’¥ä»¥åŠåŒ…å«ç­”æ¡ˆçš„æ–‡ä»¶è·¯å¾„ã€‚ <br><br><h3> åŸºæœ¬å’Œå­æ¸ é“ï¼Œå›è´­ </h3><br> ä¸ºäº†ç®¡ç†å®¢æˆ·ç«™ï¼ŒSpacewalkä½¿ç”¨äº†ä¸€ä¸ªæ‰€è°“çš„æ¸ é“ç³»ç»Ÿï¼Œè¯¥æ¸ é“å¯ä»¥æ˜¯ä¸»æ¸ é“ï¼ˆå­æ¸ é“ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å­æ¸ é“ï¼ˆå­æ¸ é“ï¼‰ï¼Œæ‚¨éœ€è¦çš„å­˜å‚¨åº“å·²é™„åŠ åˆ°æ¯ä¸ªæ¸ é“ï¼Œä»¥åŠä¸€ä¸ªå¯†é’¥-å®¢æˆ·ç«¯ä¸ä¹‹é…å¯¹æœåŠ¡å™¨ã€‚ <br><br> ç»“æœï¼Œå­˜å‚¨åº“ä¸é€šé“åŒæ­¥ï¼Œé€šé“åˆä¸å®¢æˆ·ç«¯è¿æ¥ï¼ŒSpacewalké€šå¸¸å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ å€¼å¾—ä¸€æçš„æ˜¯å¯ä»¥ä¸æ¸ é“ç»‘å®šçš„å‹˜è¯¯è¡¨ï¼Œå®ƒç®€åŒ–äº†æ›´æ–°å’Œç¨‹åºåŒ…æ§åˆ¶ã€‚ <br><br> å¯ä»¥æ ¹æ®ä¸åŒçš„æ ‡å‡†å¯¹æ‰€æœ‰å®¢æˆ·ç«¯è¿›è¡Œåˆ†ç»„ï¼Œæ—¢å¯ä»¥ä½¿ç”¨ç›¸åŒçš„é€šé“ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„é€šé“æˆ–å­˜å‚¨åº“ï¼Œä¸€æ¬¡å¯ä»¥ä¸å¤§é‡å®¢æˆ·ç«¯ä¸€èµ·å·¥ä½œï¼Œè¿™æœ‰åŠ©äºåœ¨100å¤šä¸ªæœåŠ¡å™¨ä¸Šè¿›è¡Œæ›´æ–°ã€‚ <br><br> æ‰€æœ‰å·²å®‰è£…è½¯ä»¶åŒ…çš„åˆ—è¡¨å‡å¯ç”¨ï¼Œå¹¶ä¸”åœ¨å­˜å‚¨åº“åŒæ­¥ä¹‹åä¹Ÿå¯ä»¥å®‰è£…ã€‚ æœ‰äº›è¦ç‚¹å¾ˆç›´è§‚ï¼Œå› æ­¤é€è¡Œè€ƒè™‘æ¯ä¸ªé¡¹ç›®æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ <br><br>  Spacewalkä¸­çš„æ‰€æœ‰åŠ¨ä½œå‡æŒ‰æ—¶é—´è¡¨è¿›è¡Œï¼ˆæ—¶é—´è¡¨ï¼‰ï¼Œå‡ ä¹å¯ä»¥åœ¨æœ€æ–¹ä¾¿çš„æ—¶é—´é…ç½®ä»»ä½•åŠ¨ä½œã€‚ <br><br> å®‰è£…åï¼Œå¯ä»¥è½¬åˆ°æœåŠ¡å™¨çš„åœ°å€ï¼Œé€šè¿‡å›¾å½¢ç•Œé¢è¿›è¡Œè¿›ä¸€æ­¥é…ç½®ï¼š <br><br><img src="https://habrastorage.org/webt/bb/iq/co/bbiqcow_kswo_i91vsqceeg6g0s.png"><br><br> è¾“å…¥å¯†ç ï¼Œç®¡ç†å‘˜åç§°ï¼Œç»„ç»‡åç§°ï¼ˆè¿™ä¹Ÿæ˜¯ç®¡ç†å®¢æˆ·ç«¯çš„æ–¹æ³•ä¹‹ä¸€ï¼‰ï¼Œç„¶åè½¬åˆ°å¼€å§‹é¢æ¿ã€‚ <br><br> ç›®å‰ï¼Œæ‚¨å¯ä»¥è‡ªå·±æµè§ˆå¯ç”¨é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥ç»§ç»­åˆ›å»ºé¢‘é“ã€‚ <br><br>  <i>é¢‘é“-ç®¡ç†è½¯ä»¶é¢‘é“-åˆ›å»ºé¢‘é“ï¼š</i> <br><br><img src="https://habrastorage.org/webt/5m/6o/f9/5m6of99m6ey7yq0rxbdmenvhcuw.png"><br><br> æˆ‘å»ºè®®æ ¹æ®ç»‘å®šåˆ°è¯¥é€šé“çš„æ“ä½œç³»ç»Ÿçš„ç±»å‹å’Œç±»å‹æ¥è®¾ç½®é€šé“åç§°ï¼Œä¾‹å¦‚<i>CentOS_7_x86_64</i> ï¼Œæ‚¨å¯ä»¥å®‰å…¨åœ°é€‰æ‹©sha256ä½œä¸ºæ£€æŸ¥å¯¹è±¡ï¼Œâ€œé€šé“1æ‘˜è¦â€å­—æ®µç”¨äºé€šé“çš„<i>ç®€çŸ­</i>è¯´æ˜ã€‚ æ­¤å¤–ï¼Œæ‚¨å¯ä»¥é€‰æ‹©æä¾›å…¶ä»–ä¿¡æ¯ã€‚ <br><br> ç°åœ¨åˆ›å»ºä¸€ä¸ªå­é¢‘é“å¹¶å°†å…¶ç»‘å®šåˆ°ä¸»é¢‘é“ã€‚ æˆ‘ä»¬ä¸åˆ›å»ºä¸»é¢‘é“çš„æ–¹å¼ç›¸åŒï¼Œåªæ˜¯åœ¨â€œçˆ¶é¢‘é“â€å­—æ®µä¸­ï¼Œæˆ‘ä»¬å°†æŒ‡ç¤ºå…ˆå‰åˆ›å»ºçš„é¢‘é“ã€‚ <br><br> å°†å­˜å‚¨åº“ç»‘å®šåˆ°ä¸»æ¸ é“å’Œå­æ¸ é“ã€‚ <br>  <i>æ¸ é“-ç®¡ç†å­˜å‚¨åº“</i> <br><br><img src="https://habrastorage.org/webt/a3/gq/ok/a3gqokxrwd10mlfq4geiw0f1nqy.png"><br><br> å¯¹äºä¸»è¦æ¸ é“ï¼Œæˆ‘å°†åŸºç¡€èµ„æºç”¨äºæ¬¡è¦æ¸ é“-æ›´æ–°ã€‚ <br><br> åˆ›å»ºå­˜å‚¨åº“åï¼Œéœ€è¦å°†å®ƒä»¬è¿æ¥åˆ°é€šé“ã€‚ <br>  <i>é¢‘é“-ç®¡ç†è½¯ä»¶é¢‘é“</i> ï¼Œæ‰“å¼€æ‚¨çš„ä¸»è¦é¢‘é“ï¼Œç„¶åæ‰“å¼€â€œå­˜å‚¨åº“â€éƒ¨åˆ†ã€‚ <br><br><img src="https://habrastorage.org/webt/hw/ro/og/hwroogjvybx0p1z2mslzxf8nunq.png"><br><br> å°†åˆ›å»ºæ‰€æœ‰å·²åˆ›å»ºçš„å­˜å‚¨åº“ï¼Œé€‰æ‹©æ‰€éœ€çš„å­˜å‚¨åº“ï¼Œå¯¹å…¶è¿›è¡Œæ ‡è®°ï¼Œç„¶åå•å‡»â€œæ›´æ–°èµ„æºâ€ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œæ‰“å¼€â€œåŒæ­¥â€å­é¡¹ï¼š <br><br><img src="https://habrastorage.org/webt/ho/j7/4m/hoj74mhjkorduvftwkwbteuxzk4.png"><br><br> åœ¨å¯ä»¥åŒæ­¥å­˜å‚¨åº“å’Œé€šé“çš„ä½ç½®ï¼Œé…ç½®åŒæ­¥è®¡åˆ’ã€‚ <br><br>  <i>æ³¨æ„ï¼šå°±ç¬”è€Œè¨€ï¼Œæˆ‘å¿…é¡»ä»å®¢æˆ·ç«¯ç³»ç»Ÿä¸­åˆ é™¤æ ‡å‡†å­˜å‚¨åº“ã€‚</i> <br><br><h4> å®¢æˆ·ç«¯å®‰è£…ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨é…å¯¹ï¼Œå¯†é’¥ç®¡ç†ï¼Œè®¾ç½®é…ç½®é€šé“ </h4><br> å¦‚å‰æ‰€è¿°ï¼ŒSpacewalkä½¿ç”¨æ¥è‡ªRed Hat Networkçš„å¯†é’¥ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿç”¨äºé…å¯¹å’Œç®¡ç†ã€‚ <br><br> è¦åˆ›å»ºå¯†é’¥ï¼Œè¯·è½¬åˆ°<i>ç³»ç»Ÿ-æ¿€æ´»å¯†é’¥-åˆ›å»ºå¯†é’¥ï¼š</i> <br><br><img src="https://habrastorage.org/webt/ea/df/vf/eadfvfezxpeh1s_lt9blgfox3j8.png"><br><br> è¿™é‡Œçš„ä¸€åˆ‡éƒ½éå¸¸ç®€å•ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ‚¨å¯ä»¥è‡ªå·±è®¾ç½®å¯†é’¥ï¼Œå…¶æ ¼å¼å§‹ç»ˆä¸º<i>1-XXXXXX</i> ï¼Œå¹¶ä¸”æ¯ä¸ªå¯†é’¥éƒ½é™„åŠ åˆ°é€šé“ã€‚ é€šç”¨é»˜è®¤æ ‡è®°ä¼šå¼ºåˆ¶æ–°ç³»ç»Ÿé€‰æ‹©å…³é”®å‚æ•°ã€‚ <br><br>  <b>å®¢æˆ·ç«¯å®‰è£…</b> <br><br> è¿æ¥å®¢æˆ·ç«¯å­˜å‚¨åº“å¹¶å®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…ï¼š <br><br><pre> <code class="bash hljs">rpm -Uvh https://copr-be.cloud.fedoraproject.org/results/@spacewalkproject/spacewalk-2.8-client/epel-7-x86_64/00742644-spacewalk-repo/spacewalk-client-repo-2.8-11.el7.centos.noarch.rpm yum -y install rhn-client-tools rhn-check rhn-setup rhnsd m2crypto yum-rhn-plugin rhncfg-actions deltarpm</code> </pre> <br><br>  <i>æ³¨æ„ï¼šéœ€è¦rhncfg-actionså’Œdeltarpmæ‰èƒ½ä½¿é…ç½®å’Œé¥æ§å™¨æ­£å¸¸å·¥ä½œã€‚</i> <br><br>  Spacewalkä½¿ç”¨rhn_checkåŒæ­¥å®¢æˆ·ç«¯æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨æ¯4å°æ—¶è¿è¡Œä¸€æ¬¡ã€‚ è¿™ä¸ªå€¼å¯ä»¥å‡å°‘åˆ°60åˆ†é’Ÿï¼Œä½†å¯¹æˆ‘æ¥è¯´ï¼Œæ²¡æœ‰ä¸€ä¸ªé€‰é¡¹æ˜¯æœ€ä½³çš„ï¼Œå› æ­¤æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼šä½¿ç”¨osadï¼ˆéšSpacewalkä¸€èµ·æä¾›ï¼‰ï¼Œæˆ–ä¸ºrhn_checkæ·»åŠ ä¸€ä¸ªcronjobï¼Œä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬æµ‹è¯•ç³»ç»Ÿï¼Œç„¶åå¯ä»¥æ ¹æ®éœ€è¦æ›´æ”¹è¯¥å€¼ã€‚ <br><br><pre> <code class="bash hljs">crontab -e * * * * * /usr/sbin/rhn_check</code> </pre> <br> åŒæ ·ä¹Ÿä¸ä¼šåœ¨Cronä¸­æ·»åŠ / usr / bin / rhn-actions-control --enable-allï¼Œå®ƒç”¨äºéƒ¨ç½²é…ç½®ï¼Œæœ‰æ—¶ä¼šå˜å¾—æ„šè ¢ã€‚ <br><br> æˆ‘ä»¬è¿”å›åˆ°å¯†é’¥ç®¡ç†ï¼Œå¤åˆ¶æˆ‘ä»¬åˆ›å»ºçš„å¯†é’¥IDï¼Œç„¶åæ‰§è¡Œï¼š <br><br><pre> <code class="bash hljs">rhnreg_ks --serverUrl=http://your-server-ip/XMLRPC --activationkey=1-YOURKEY --force</code> </pre> <br> åªæ˜¯ä¸è¦å¿˜è®°å°†IPå’Œå¯†é’¥å€¼æ›´æ”¹ä¸ºæ‚¨è‡ªå·±çš„ã€‚ å†æ¬¡ï¼Œæˆ‘å»ºè®®æ‚¨ä½¿ç”¨<i>--force</i>æ ‡å¿—ï¼Œå› ä¸ºæˆ‘æ³¨æ„åˆ°æ²¡æœ‰ä½¿ç”¨æ­¤æ ‡å¿—çš„é—®é¢˜ã€‚ <br><br> æˆ‘ä»¬è¿”å›<i>ç³»ç»Ÿ-å…¨éƒ¨</i> ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´æ³¨æ„åˆ°æˆ‘ä»¬çš„ç³»ç»Ÿã€‚ ç°åœ¨ï¼Œæ‚¨å¯ä»¥æ‰“å¼€å®ƒå¹¶æ¢ç´¢å…¶ä¸­çš„å†…å®¹å’Œæ–¹å¼ï¼Œä½†æ˜¯ï¼Œæˆ‘ç°åœ¨å¼ºçƒˆå»ºè®®åˆ›å»ºä¸€ä¸ªç»„ï¼Œä»¥æ›´æ–¹ä¾¿åœ°è¿›è¡Œç³»ç»Ÿç®¡ç†ã€‚ <br><br>  <i>ç³»ç»Ÿ-ç³»ç»Ÿç»„-åˆ›å»ºç»„</i> ï¼Œå¡«å†™åç§°å’Œæè¿°ï¼Œä¿å­˜ï¼Œæ‰“å¼€æ–°åˆ›å»ºçš„ç»„ï¼Œè½¬åˆ°â€œ <i>ç³»ç»Ÿâ€</i>éƒ¨åˆ†ï¼Œç„¶åå°†ç³»ç»Ÿæ·»åŠ åˆ°è¯¥ç»„ã€‚ <br><br> ç°åœ¨ï¼Œå°†ç³»ç»Ÿè®¢é˜…é¢‘é“ï¼Œ <i>ç³»ç»Ÿ-æ‚¨çš„ç³»ç»Ÿ-è½¯ä»¶æ–‡ä»¶å¤¹-è½¯ä»¶é¢‘é“å­æ–‡ä»¶å¤¹ï¼š</i> <br><br><img src="https://habrastorage.org/webt/7f/hp/lu/7fhplurd2imupn4cio2n7ymcz1y.png"><br><br> é€‰æ‹©æ‚¨çš„é¢‘é“ï¼Œç„¶åå•å‡»ç¡®è®¤ã€‚ ä¸ºäº†å¨±ä¹ï¼Œæ‚¨å¯ä»¥å°è¯•å®‰è£…è½¯ä»¶åŒ…<i>Software-Packages-Install</i> ã€‚ <br><br>  <b>é…ç½®é€šé“</b> <br><br> ä¸ºäº†ç®¡ç†å®¢æˆ·ç«¯æœåŠ¡å™¨/æœ¬åœ°è®¡ç®—æœºä»¥åŠè¿œç¨‹æ§åˆ¶ä¹‹é—´çš„é…ç½®ï¼Œå€¼å¾—è®¾ç½®é…ç½®é€šé“å¹¶å°†ç³»ç»Ÿé“¾æ¥åˆ°è¯¥é€šé“ã€‚ <br> æˆ‘ä»¬è½¬åˆ°â€œ <i>é…ç½®â€â€œé…ç½®é€šé“â€â€œåˆ›å»ºé…ç½®é€šé“â€</i> ï¼Œè®¾ç½®åç§°ï¼Œæè¿°ï¼Œä¿å­˜ï¼Œç„¶ååœ¨â€œ <i>é…ç½®â€â€œç®¡ç†é…ç½®é€šé“â€â€œè®¢é˜…é€šé“â€ä¸­</i>è¿›è¡Œç­¾åï¼Œå¹¶å°†é…ç½®é€šé“ç­¾ååˆ°è½¯ä»¶é€šé“å’Œç³»ç»Ÿã€‚ <br><br><img src="https://habrastorage.org/webt/jy/ki/wt/jykiwtrdmame71pab7yyzr40lay.png"><br><br> ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä»æœåŠ¡å™¨å’Œæœ¬åœ°è®¡ç®—æœºä¸Šéƒ¨ç½²é…ç½®ï¼Œå¹¶åˆ›å»ºåˆ†åŒºã€‚ <br><br>  <i>é…ç½®-æ·»åŠ æ–‡ä»¶-åˆ›å»ºæ–‡ä»¶/ä¸Šä¼ æ–‡ä»¶ï¼š</i> <br><br><img src="https://habrastorage.org/webt/cf/js/ie/cfjsieqwp21zlmem7goijg7cqui.png"><br><br> åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥bashè„šæœ¬çš„å½¢å¼å‘é€è¿œç¨‹å‘½ä»¤ï¼š <br><br><img src="https://habrastorage.org/webt/hy/xw/d-/hyxwd-znezglfc-glf5yhn44wsq.png"><br><br> æé†’æ‚¨ï¼Œæ‰€æœ‰æ“ä½œéƒ½ç»è¿‡æ—¶é—´è¡¨ï¼Œå¯ä»¥åœ¨â€œäº‹ä»¶â€éƒ¨åˆ†æ‰¾åˆ°åº”ç”¨äºè¯¥ç³»ç»Ÿçš„æ‰€æœ‰æ“ä½œçš„åˆ—è¡¨ï¼š <br><br><img src="https://habrastorage.org/webt/9m/fp/hj/9mfphjmglxmqpxfd_cdqpsf8g2s.png"><br><br>  <b>å‹˜è¯¯</b> <br><br>  Spacewalkæœ€é‡è¦çš„åŠŸèƒ½ä¹‹ä¸€æ˜¯å‹˜è¯¯æ”¯æŒï¼Œå®ƒå¾ˆæ–¹ä¾¿åœ°ç»‘å®šåˆ°é¢‘é“å¹¶å…è®¸æ‚¨ç›‘è§†æœ€æ–°æ›´æ–°çš„é‡è¦æ€§çº§åˆ«ã€‚ è¿™æ˜¯ç›´æ¥åœ¨æœåŠ¡å™¨ä¸Šé…ç½®çš„ï¼Œé™¤äº†è„šæœ¬å¤–ï¼Œæ‚¨è¿˜éœ€è¦ä¸‹è½½Pearlæ‰€éœ€çš„è½¯ä»¶åŒ…ï¼š <br><br><pre> <code class="bash hljs">yum -y install perl-Frontier-RPC perl-Text-Unidecode wget https://raw.githubusercontent.com/stevemeier/cefs/master/errata-import.pl chmod +x errata-import.pl</code> </pre> <br> ç„¶ååˆ›å»ºä¸»è¦çš„æ›´æ–°å’Œæ”¶é›†è„šæœ¬å‹˜è¯¯è¡¨ï¼Œè¯¥å‹˜è¯¯è¡¨å°†å­˜å‚¨åœ¨<i>/ etc / rhn /ä¸­ï¼š</i> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash cd /etc/rhn/ wget -N http://cefs.steve-meier.de/errata.latest.xml wget -N https://www.redhat.com/security/data/oval/com.redhat.rhsa-all.xml export SPACEWALK_USER='root' export SPACEWALK_PASS='verystrong' ./errata-import.pl --server YourServerIPAddress --errata errata.latest.xml --rhsa-oval com.redhat.rhsa-all.xml --publish unset SPACEWALK_USER unset SPACEWALK_PASS</span></span></code> </pre> <br> åœ¨å¯¼å‡ºä¸­ï¼ŒæŒ‡å®šæ‚¨åœ¨å¼€å§‹æ—¶æŒ‡å®šçš„Spacewalkç®¡ç†å‘˜çš„åç§°å’Œå¯†ç ã€‚ <br><br> è®©æˆ‘ä»¬ä½¿è„šæœ¬å¯æ‰§è¡Œï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°Cronä¸­ï¼š <br><br><pre> <code class="bash hljs">chmod +x spcwlk_errata.sh crontab -e 0 2 * * 7 /usr/bin/sh /etc/rhn/spcwlk_errata.sh</code> </pre> <br> è®©æˆ‘ä»¬ç«‹å³æ‰§è¡Œå®ƒï¼Œä»¥æŸ¥çœ‹å›¾å½¢ç•Œé¢ä¸­çš„æ›´æ”¹ã€‚ æ‰§è¡Œå°†éœ€è¦ä¸€äº›æ—¶é—´ã€‚ <br><br><img src="https://habrastorage.org/webt/5v/yy/v9/5vyyv9a4xpmq7c2lqqglozhdrsk.png"><br><br><h4> æ€»ç»“ </h4><br> æˆ‘ä¸ªäººè®¤ä¸ºå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œè®¾ç½®å’Œå®‰è£…ä»£ç†ï¼Œä»¥åŠå°†æ•´ä¸ªç³»ç»Ÿå‡çº§ä¸ºHAã€‚ æˆ‘æœ‰ä¸€ä¸ªæƒ³æ³•ï¼Œå¯ä»¥é€šè¿‡èµ·æå™¨é…ç½®åº”ç”¨ç¨‹åºï¼Œå¹¶åœ¨æ•°æ®åº“ä¸Šè¿›è¡ŒåŒæ­¥ã€‚ ç»“æœï¼Œé‰´äºå®¢æˆ·ç«¯ç«™çš„æœåŠ¡å™¨æ•°é‡ä¸æ˜¯å¾ˆå¤§ï¼Œå› æ­¤å†³å®šæ”¾å¼ƒæ­¤æƒ³æ³•ã€‚ ä½†æ˜¯ï¼Œå¦‚æœäº‹å®è¯æ˜è¯¥ç³»ç»Ÿåœ¨æ¥ä¸‹æ¥çš„å…­ä¸ªæœˆä¸­éå¸¸æœ‰ç”¨ï¼Œåˆ™å¯èƒ½å¿…é¡»æ‰©å±•åŸå§‹æœåŠ¡å™¨ã€‚ <br><br><h4> è‡ªåŠ¨åŒ–æŠ€æœ¯ </h4><br>  <b>ä¼ºæœå™¨ï¼š</b> <br><br><div class="spoiler">  <b class="spoiler_title">æœåŠ¡å™¨éƒ¨ç½²çš„Bashè„šæœ¬ï¼ˆDISABLES firewalldï¼‰ï¼š</b> <div class="spoiler_text"><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh # rpm -Uvh https://copr-be.cloud.fedoraproject.org/results/@spacewalkproject/spacewalk-2.8/epel-7-x86_64/00736372-spacewalk-repo/spacewalk-repo-2.8-11.el7.centos.noarch.rpm rpm -Uvh https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm (cd /etc/yum.repos.d &amp;&amp; curl -O https://copr.fedorainfracloud.org/coprs/g/spacewalkproject/java-packages/repo/epel-7/group_spacewalkproject-java-packages-epel-7.repo) yum -y install spacewalk-setup-postgresql spacewalk-postgresql wget perl-Frontier-RPC perl-Text-Unidecode perl-XML-Simple # mkdir /usr/share/spcwlk-tmp/ echo 'admin-email = root@localhost ssl-set-cnames = spcwlkserver ssl-set-org = Unicorn ssl-set-org-unit = EOH ssl-set-city = Prague ssl-set-state = SCK ssl-set-country = CZ ssl-password = verystrong ssl-set-email = root@localhost ssl-config-sslvhost = Y db-backend=postgresql db-name=spcwlkdb db-user=spcwlkuser db-password=verystrong db-host=localhost db-port=5432 enable-tftp=Y' &gt; /usr/share/spcwlk-tmp/spcwlk_answer spacewalk-setup --answer-file=/usr/share/spcwlk-tmp/spcwlk_answer # systemctl stop firewalld systemctl disable firewalld #</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Bashè„šæœ¬æ¥å®‰è£…å‹˜è¯¯ï¼ˆé¦–å…ˆä¸ºSpacewalkç®¡ç†å‘˜è®¾ç½®åç§°å’Œå¯†ç ï¼‰ï¼š</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh # wget https://raw.githubusercontent.com/stevemeier/cefs/master/errata-import.pl -P /etc/rhn/ echo '#!/bin/bash cd /etc/rhn/ wget -N http://cefs.steve-meier.de/errata.latest.xml wget -N https://www.redhat.com/security/data/oval/com.redhat.rhsa-all.xml export SPACEWALK_USER='gui username' export SPACEWALK_PASS='Password to your gui account' ./errata-import.pl --server YourServerIPAddress --errata errata.latest.xml --rhsa-oval com.redhat.rhsa-all.xml --publish unset SPACEWALK_USER unset SPACEWALK_PASS' &gt; /etc/rhn/spcwlk_errata.sh # chmod +x /etc/rhn/errata-import.pl chmod +x /etc/rhn/spcwlk_errata.sh # echo '#!/bin/bash # /etc/rhn/./spcwlk_errata.sh' &gt; /etc/rhn/spcwlk_errata_cron.sh chmod +x /etc/rhn/spcwlk_errata_cron.sh echo '0 2 * * 7 /usr/bin/sh /etc/rhn/spcwlk_errata_cron.sh' &gt;&gt; /var/spool/cron/root /etc/rhn/./spcwlk_errata.sh #</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">ç”¨äºæœåŠ¡å™¨éƒ¨ç½²çš„Ansibleæ‰‹å†Œï¼ˆè¯·ä¸è¦å¿˜è®°æ·»åŠ ç­”æ¡ˆæ–‡ä»¶ï¼‰ï¼š</b> <div class="spoiler_text"><pre> <code class="bash hljs">- hosts: spcwlk-server tasks: - name: Install Spacewalk repo yum: name: https://copr-be.cloud.fedoraproject.org/results/@spacewalkproject/spacewalk-2.8/epel-7-x86_64/00736372-spacewalk-repo/spacewalk-repo-2.8-11.el7.centos.noarch.rpm state: present - name: Install epel repo yum: name: https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm state: present - name: Install PostgreSQL packages yum: name: - spacewalk-setup-postgresql - spacewalk-postgresql - wget - perl-Frontier-RPC - perl-Text-Unidecode - perl-XML-Simple - name: Creates directory <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Spacewalk answer file file: path: /usr/share/spcwlk-tmp/ state: directory mode: 0755 - name: Deploy answer file copy: src: /etc/ansible/spcwlk_answer dest: /usr/share/spcwlk-tmp/spcwlk_answer - name: Spacewalk Server Deploy shell: spacewalk-setup --answer-file=/usr/share/spcwlk-tmp/spcwlk_answer - name: Stop firewalld systemd: name: firewalld state: stopped enabled: no</code> </pre> <br></div></div><br>  <b>å®¢æˆ·ï¼š</b> <br><br><div class="spoiler">  <b class="spoiler_title">ç”¨äºå®¢æˆ·ç«¯éƒ¨ç½²çš„Bashè„šæœ¬ï¼ˆä¸è¦å¿˜è®°IPå’Œå¯†é’¥ï¼‰ï¼š</b> <div class="spoiler_text"><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh # rpm -Uvh https://copr-be.cloud.fedoraproject.org/results/@spacewalkproject/spacewalk-2.8-client/epel-7-x86_64/00742644-spacewalk-repo/spacewalk-client-repo-2.8-11.el7.centos.noarch.rpm yum -y install rhn-client-tools rhn-check rhn-setup rhnsd m2crypto yum-rhn-plugin rhncfg-actions deltarpm wget echo '#!/bin/bash # /usr/sbin/rhn_check' &gt; rhn_check.sh mv rhn_check.sh /etc/cron.hourly/ chmod +x /etc/cron.hourly/rhn_check.sh echo '* * * * * /usr/bin/sh /etc/cron.hourly/rhn_check.sh' &gt;&gt; /var/spool/cron/root /usr/bin/rhn-actions-control --enable-all cd /usr/share/rhn/ wget http://YourServerIPAddress/pub/RHN-ORG-TRUSTED-SSL-CERT rhnreg_ks --serverUrl=http://172.22.64.41/XMLRPC --activationkey=1-xxxxxxxxxxxxxxxxxxxxxxxxxxxx --force</span></span></code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">ç”¨äºå®¢æˆ·ç«¯éƒ¨ç½²çš„Anisbleæ‰‹å†Œï¼š</b> <div class="spoiler_text"><pre> <code class="bash hljs">- hosts: spcwlk-clients tasks: - name: Install spacewalk repo yum: name: https://copr-be.cloud.fedoraproject.org/results/@spacewalkproject/spacewalk-2.8-client/epel-7-x86_64/00742644-spacewalk-repo/spacewalk-client-repo-2.8-11.el7.centos.noarch.rpm state: present - name: Install client packages yum: name: - rhn-client-tools - rhn-check - rhn-setup - rhnsd - m2crypto - yum-rhn-plugin - rhncfg-actions - deltarpm - wget - name: Create cronjob <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rhn_check cron: name: <span class="hljs-string"><span class="hljs-string">"rhn_check"</span></span> minute: <span class="hljs-string"><span class="hljs-string">"*"</span></span> hour: <span class="hljs-string"><span class="hljs-string">"*"</span></span> day: <span class="hljs-string"><span class="hljs-string">"*"</span></span> month: <span class="hljs-string"><span class="hljs-string">"*"</span></span> weekday: <span class="hljs-string"><span class="hljs-string">"*"</span></span> job: <span class="hljs-string"><span class="hljs-string">"/usr/sbin/rhn_check"</span></span> - name: Enable controls <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> config and remote control deployment shell: /usr/bin/rhn-actions-control --<span class="hljs-built_in"><span class="hljs-built_in">enable</span></span>-all - name: Get certificate from server to client get_url: url: http://YourServerIPAddress/pub/RHN-ORG-TRUSTED-SSL-CERT dest: /usr/share/rhn/ - name: Register client to server rhn_register: state: present server_url: http://YourServerIPAddress/XMLRPC activationkey: <span class="hljs-string"><span class="hljs-string">"{{ activation_key }}"</span></span></code> </pre> <br></div></div><br> è°¢è°¢å¤§å®¶é˜…è¯»æœ¬æ–‡ã€‚ ç¥ä½ å¥½è¿ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN435578/">https://habr.com/ru/post/zh-CN435578/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN435564/index.html">ä½¿ç”¨GtkApplicationã€‚ Librsvgæ¸²æŸ“åŠŸèƒ½</a></li>
<li><a href="../zh-CN435568/index.html">VyOSå¼€æºè·¯ç”±å™¨</a></li>
<li><a href="../zh-CN435572/index.html">Anycubic i3 Megaï¼šPrusa i3çš„é«˜å“è´¨ç¿»æ‹</a></li>
<li><a href="../zh-CN435574/index.html">Zigå¦‚ä½•å·¥ä½œï¼Ÿ</a></li>
<li><a href="../zh-CN435576/index.html">1Cï¼Œæ— ç—›è‹¦</a></li>
<li><a href="../zh-CN435580/index.html">Javaï¼ŒSpringï¼ŒKurentoå’Œåª’ä½“æœåŠ¡</a></li>
<li><a href="../zh-CN435582/index.html">å¦‚ä½•åœ¨ä¸åœæœºçš„æƒ…å†µä¸‹åœ¨å·²åŠ è½½ç³»ç»Ÿ24/7ä¸Šæ·»åŠ ç´¢å¼•ï¼Ÿ</a></li>
<li><a href="../zh-CN435584/index.html">Slush2018ã€‚ç¬¬ä¸€å¤©ï¼Œç¬¬äºŒå¤©</a></li>
<li><a href="../zh-CN435586/index.html">è¨æ»¡æ•™æˆ–Olinuxinoå®šåˆ¶å›ºä»¶çš„è‰ºæœ¯ã€‚ å†…æ ¸å’ŒUbuntuç¬¬3éƒ¨åˆ†</a></li>
<li><a href="../zh-CN435588/index.html">æ¨å¹¿å…·æœ‰å®é™…æ•°å­—ç»éªŒçš„ç§»åŠ¨åº”ç”¨ç¨‹åº</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>