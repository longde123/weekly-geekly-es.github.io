<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçü§ù‚Äçüë®üèª üòå ü§±üèæ Regreso al futuro con WebAssembly üë®‚Äç‚öïÔ∏è ü§¥üèΩ üö£üèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! Les presento la traducci√≥n del art√≠culo "Regreso al futuro con WebAssembly" de Attila V√°g√≥. 

 Esta publicaci√≥n es una traducci√≥n de un art...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Regreso al futuro con WebAssembly</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453008/">  Hola Habr!  Les presento la traducci√≥n del art√≠culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Regreso al futuro con WebAssembly"</a> de Attila V√°g√≥. <br><br><h4>  Esta publicaci√≥n es una traducci√≥n de un art√≠culo que habla sobre las propiedades de WebAssemly y Emscripten.  Art√≠culo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=http://">original</a> en ingl√©s. </h4><br>  <i>El autor del art√≠culo, Attila Vago, es un desarrollador senior de software en HMH.</i>  <i>Escribe c√≥digo, blogs y otras cosas en Internet.</i>  <i>Un pol√≠glota de lenguajes de programaci√≥n, una figura pragm√°tica, apasionada por JavaScript y de f√°cil acceso.</i>  <i>Persona f√°cilmente inspiradora e inspiradora con una fuerte adicci√≥n a las cosas para nerds, excelente comida, cerveza artesanal y Lego.</i>  <i>Usado por Mac.</i>  <i>Hace ejercicio a las 6 de la ma√±ana.</i> <br><br><p>  En 2011, escrib√≠ mi primera l√≠nea independiente de c√≥digo no HTML (trabaj√© con √©l en 2007), y fue escrita en la muy buena C que ense√±√≥ el profesor David J. Malan de la Universidad de Harvard.  Siempre ser√° mi inspiraci√≥n no solo para el estudio de la programaci√≥n, sino tambi√©n para el pensamiento program√°tico.  Tambi√©n record√© que hacer un s√°ndwich de mantequilla de man√≠ es solo para m√≠, pero es una tarea incre√≠blemente dif√≠cil para una computadora e igualmente dif√≠cil para una persona que finge ser una computadora. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wEdvGqxafq8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><p>  Si vio el video, al menos los primeros 18 minutos (s√© que lleva mucho tiempo, pero la programaci√≥n lleva tiempo), entonces comprender√° por qu√© hasta el d√≠a de hoy C est√° cerca de mi coraz√≥n.  Para mi decepci√≥n, no lo aprend√≠, porque, seamos sinceros, para un desarrollador web, C es la menor de las prioridades.  Nunca tuve una raz√≥n real para sumergirme profundamente en este lenguaje, a pesar de comprar innumerables cursos de Udemy y libros en C, nunca los toqu√© (mant√©n tu aspecto cr√≠tico para ti, t√∫ tambi√©n lo hiciste) o me ment√≠ a m√≠ mismo que si compro reloj inteligente Pebble, que funciona en C, luego aseg√∫rese de escribir un c√≥digo para ellos.  Si, seguro!  Ninguno de estos motivos fue lo suficientemente bueno. </p><br><h4>  ¬øQu√© es WebAssembly y c√≥mo supera a JS? </h4><br><p>  WebAssembly (Wasm para abreviar) es un formato de instrucciones binarias para una m√°quina virtual apilada. </p><blockquote>  "Wasm se desarroll√≥ como una plataforma port√°til para compilar lenguajes de alto nivel como C / C ++ / Rust, que le permite implementar aplicaciones de cliente y servidor en Internet" </blockquote>  - explica amablemente webassembly.org <p></p><br><p>  En otras palabras, lo anterior significa que puede escribir m√≥dulos que funcionan en Internet en un navegador / servidor, pero que est√°n escritos en lenguajes como C, compilados en un archivo binario y, por lo tanto, incre√≠blemente r√°pidos porque funcionan directamente en el hardware de la m√°quina.  En comparaci√≥n, los lenguajes de script como JavaScript tienen varios niveles de abstracci√≥n entre el c√≥digo y el hardware, lo que, entre otras cosas, los hace lentos.  Por supuesto, esto no siempre importa, y cada uno de ellos tiene su propio lugar en el programa o incluso en el ecosistema web. </p><br><p>  En base a esto, Wasm by structure (inicialmente) solo admite n√∫meros enteros y n√∫meros de punto flotante, lo que brinda una gran potencia inform√°tica y, por lo tanto, a menudo se usa para implementaciones de tipo canvas.  Es importante comprender que WebAssembly no es una amenaza para JavaScript, al menos no todav√≠a, y, como ver√° m√°s adelante en este art√≠culo, C y JavaScript pueden vivir muy felizmente en el mismo proyecto y pueden ejecutar el c√≥digo del otro.  S√≠, algo por el estilo. </p><br><br><h4>  Emscripten "pegamentos" C y JS </h4><br><p>  Ahora espera!  S√© lo que digo.  No puede decir cosas como "ejecutar C en JS y viceversa" y esperar que el mundo no reaccione. No importa cu√°n extra√±o suene, no estoy enga√±ando. Resulta que Emscripten es una cadena de herramientas para compilar en asm.js y WebAssembly, dise√±ado usando LLVM (Dios m√≠o, aprend√≠ la mitad de estas cosas mientras escrib√≠a el texto del art√≠culo), lo que le permite ejecutar C y C ++ en Internet a una velocidad casi nativa sin complementos. </p><br><p>  Bueno, esto es lo que necesitas destacar de esto para ti.  Emscripten lo ayuda a compilar el c√≥digo C en WebAssembly, proporcionando herramientas adicionales para facilitar la carga del desarrollador cuando se trata de comunicarse entre los dos idiomas, y le ayuda a iniciar Wasm en su proyecto web.  El comando de compilaci√≥n b√°sico para Emscripten es el siguiente: </p><br><pre><code class="plaintext hljs">emcc lib/strings.c -s WASM=1 -o public/strings.js</code> </pre> <br>  Mientras que un comando no b√°sico se ejecuta as√≠: <br><br><pre> <code class="plaintext hljs">emcc lib/imports.c -s WASM=1 -s EXPORTED_FUNCTIONS="['_getNum', '_main', '_getDoubleNum', '_greet']" -o public/imports.js</code> </pre> <br><p>  Configurar Emscripten no es lo m√°s f√°cil, pero no lanzar un cohete.  Lo √∫nico que complica la configuraci√≥n es que tiene muchas dependencias como Python, Node, xCode, Git y cMake.  Todas las instrucciones se pueden encontrar en la p√°gina de instalaci√≥n y son f√°ciles de seguir. <br>  Por lo tanto, Emscripten: <br><br></p><ul><li>  es una gran herramienta para portar, que le permite compilar proyectos existentes escritos en C o C ++ y ejecutarlos en todos los navegadores modernos.  <i>¬°Sal de aqu√≠, Internet Explorer!</i> </li><li>  ideal para API porque convierte OpenGL a WebGL y le permite usar API familiares como SDL o directamente HTML5.  <i>Oh si!</i> </li><li>  Y es muy r√°pido: gracias a LLVM, Emscripten, asm.js y WebAssembly, el c√≥digo se ejecuta a casi su propia velocidad.  <i>¬°Corre, conejo, corre!</i> <br></li></ul><p></p><br><p>  Nota: No necesita Emscripten para generar Wasm, ya que todos los navegadores nuevos tienen una API para admitir Wasm en la misma ventana, que ejecuta Emscripten como la capa superior, lo que facilita mucho la vida del desarrollador.  Por ejemplo, Emscripten ajustar√° la cantidad de memoria para usted, que puede ser tediosa a trav√©s de C. </p><br><h4>  Ejemplos ... ejemplos est√°n en todas partes! </h4><br><p>  Como dicen, <i>"una l√≠nea de c√≥digo vale m√°s que mil palabras"</i> , esta es una prerrogativa del narrador y todo eso, as√≠ que sin m√°s pre√°mbulos, echemos un vistazo a un c√≥digo real.  Comentario fuera del tema: ese d√≠a no pude superar la sintaxis de C. No se compil√≥ la mitad del tiempo, porque mi c√≥digo ser√≠a inestable.  Y despu√©s de ocho a√±os, estoy as√≠: <i>"S√≠, parece JavaScript"</i> . </p><br><p>  Chicos, si alguien comienza a ver el c√≥digo C en mi React, solo tr√°iganme de vuelta a la realidad, ¬øde acuerdo? </p><br><p>  Un poco fuera de tema, aqu√≠ est√° el c√≥digo C actual: </p><br><img src="http://habrastorage.org/webt/ck/lg/et/cklgetgfjlx_kvbbco7_mfazc7w.png" alt="imagen"><br><br><p>  Y, en consecuencia, en JavaScript: </p><br><img src="http://habrastorage.org/webt/tt/co/wk/ttcowkhhzlmtmqlqgst67lulqbg.png" alt="imagen"><br><br><p>  OK, ¬øqu√© sucede exactamente en estos archivos?  En realidad bastante, as√≠ que lo enumerar√©. <br></p><ol><li>  Es importante comprender que <b>main ()</b> , a menos que se especifique lo contrario, siempre comienza primero y tambi√©n se compila de manera predeterminada.  Si desea compilar otra funci√≥n, deber√° establecerla espec√≠ficamente en el indicador de la matriz <b>EXPORTED_FUNCTIONS</b> , como se muestra en la secci√≥n anterior. </li><li>  Escribes tu c√≥digo C, como de costumbre, importando sus bibliotecas regulares, pero adem√°s obtienes az√∫car sint√°ctico Emscripten, as√≠ como m√°s m√©todos / funciones que con cualquier otra herramienta. </li><li>  El archivo <b>imports.js</b> (el nombre es arbitrario, pero siempre el mismo que el archivo C) al que hace referencia HTML no es m√°s que el "pegamento" Emscripten, que se genera autom√°ticamente en la compilaci√≥n.  No necesita preocuparse por eso, solo aseg√∫rese de que est√© realmente referenciado. </li><li>  <b>Printf</b> es solo una instrucci√≥n C ordinaria que registra una cadena en la consola.  Nada especial, sigue adelante. </li><li>  Las l√≠neas 14 y 17 son un antipatr√≥n, pero un buen ejemplo de ejecutar JS en su c√≥digo C. La √∫nica diferencia real entre <b>emscripten_run_script</b> y <b>emscripten_async_run_script</b> es que este √∫ltimo le permite ejecutar JS en C de forma as√≠ncrona.  Principalmente con <b>setTimeout ()</b> .  La raz√≥n por la que dije que esto es un antipatr√≥n es porque lo es.  La idea general de WebAssembly es ejecutar C en JS, no JS en C, y por lo tanto ... </li><li>  Las l√≠neas 20 y 24 y sus funciones JS asociadas en el archivo <b>index.html</b> representan la plantilla correcta, es decir, declarar su JS en su JS y devolver algo para C. </li><li>  <b>EM_JS</b> , que luego lanza <b>jsFunction</b> , es simplemente una forma m√°s f√°cil: lograr el mismo objetivo que en los puntos 4 y 5. </li></ol><br><p>  El resultado previsto de lo anterior es el siguiente: </p><br><img src="http://habrastorage.org/webt/xd/lp/ew/xdlpewar42x522efjks9j2tdii4.png" alt="imagen"><br><br><p></p><h4>  Se√±oras por delante! </h4><p></p><br><p>  Como con cualquier c√≥digo, WebAssembly tambi√©n tiene un orden de ejecuci√≥n.  ¬°No te metas con la cola!  El orden en este caso es est√°ndar para el orden C.  Todo comienza en Main () y siempre que <b>main () est√©</b> listo, Wasm est√° listo.  Sin embargo, ¬øqu√© sucede si necesita una funci√≥n est√°tica para llamar en tiempo de ejecuci√≥n?  Bueno, solo un poco de az√∫car sint√°ctica Emscripten, y todo funciona como un reloj: </p><br><img src="http://habrastorage.org/webt/ak/vg/vy/akvgvyjdhbok35-ggr2ktamzsys.png" alt="imagen"><br><br><h4>  Recolectamos moscas del pastel </h4><br><p>  Este es un c√≥digo bien escrito, especialmente las cosas simples ilustradas en las secciones anteriores, pero todos sabemos que el mundo real es mucho m√°s grande que el "Hola Mundo", y la mitad del tiempo de cada desarrollador se dedica a descubrir por qu√© el c√≥digo no est√° haciendo lo que deber√≠a.  Los errores son simplemente inevitables y, en cierto sentido, son parte de la vida. </p><br><p>  Cuando ejecuta C en JS o cualquier Wasm, todo puede volverse a√∫n m√°s deprimente.  Afortunadamente, Emscripten viene al rescate nuevamente al proporcionar dos m√©todos de depuraci√≥n muy √∫tiles: </p><br><pre> <code class="plaintext hljs">// browser debugger gets triggered emscripten_debugger(); // browser console warning with stack-trace emscripten_log(EM_LOG_WARN, ‚Äú'param' your message‚Äù);</code> </pre> <br><h4>  Quick Gonzalez se apresura a ayudar </h4><br>  Lo creas o no, los creadores de Emscripten han pensado en todo.  Una gran caracter√≠stica, y la √∫ltima que mencionar√© en este art√≠culo, ya que hay demasiados para ponerlos en uno, es la base para un r√°pido desarrollo y pruebas.  Puede compilar su Wasm, construir un proyecto e iniciar el servidor de una sola vez: <p></p><br><pre> <code class="plaintext hljs">emrun --port 7777 --no_browser public/index.html Now listening at http://localhost:7777/</code> </pre> <br>  La p√°gina html que est√° ejecutando no es compatible con emrun.  La captura de Stdout, stderr y exit (c√≥digo de retorno) no funcionar√°.  Vuelva a compilar la aplicaci√≥n con el indicador de enlace --emrun para habilitar esto, o pase --no_emrun_detect a emrun para ocultar esta verificaci√≥n. <br><p>  De acuerdo, en dos personas ... el ejemplo anterior funciona, pero el siguiente funciona mejor, lo que explica el error que se muestra. </p><br><pre> <code class="plaintext hljs">&lt;b&gt;// compile as emrun project emcc lib/strings.c -s WASM=1 --emrun -o public/index.html // run the emrun server again emrun --port 7777 --no_browser public/index.html&lt;/b&gt;</code> </pre> <br><p>  Solo lo dejo as√≠.  Estudiando WebAssembly, celebr√© el d√≠a de San Patricio y al d√≠a siguiente.  No estoy muy seguro de lo que suceder√° despu√©s, pero me emocion√≥ lo suficiente como para sentarme frente al monitor durante dos d√≠as, tratando de entrar en los conceptos b√°sicos de WebAssebly, y eso deber√≠a significar algo, ¬øverdad?  Este es el c√≥digo C que he escrito desde 2011, y se siente genial.  Creo que WebAssembly tiene un futuro real, pero no estoy seguro de si se har√° cargo completamente de la red y matar√° a JS, como algunos predican.  Que piensas </p><br><img src="https://cdn-images-1.medium.com/max/800/1*PM2kQWEmOeAsRwenG-bDAA.png" alt="imagen"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/453008/">https://habr.com/ru/post/453008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452998/index.html">Android Un widget din√°mico en forma de tarjetas basado en StackView (algo as√≠ como Tinder)</a></li>
<li><a href="../453000/index.html">Tienda de equipaje: BUgHunting. C√≥mo encontrar 200 errores por d√≠a</a></li>
<li><a href="../453002/index.html">Nuevo terminal de Windows: respuestas a sus preguntas</a></li>
<li><a href="../453004/index.html">Enviamos a Habr a Marte, t√∫ tambi√©n puedes volar</a></li>
<li><a href="../453006/index.html">Los t√©rminos de TI como un ejemplo del proceso de cultivo de papa</a></li>
<li><a href="../453010/index.html">Comparaci√≥n de 10 l√°mparas hal√≥genas H4 Philips, Osram, PIAA, Koito, Bosch. Los resultados son sorprendentes.</a></li>
<li><a href="../453012/index.html">Una breve historia fotogr√°fica sobre un viaje al Observatorio de la Monta√±a del C√°ucaso</a></li>
<li><a href="../453014/index.html">EyeWire: contin√∫e estudiando los secretos del cerebro</a></li>
<li><a href="../453016/index.html">Top 3D Academy invita a intercambiar un programa de experiencias en la f√°brica de Foliplast</a></li>
<li><a href="../453018/index.html">Estudio de la influencia de varios reflectores y dispersores en la forma de un haz de luz.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>