<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÄÑÔ∏è ‚öìÔ∏è üë©üèª‚ÄçüöÄ Confer√™ncia DEFCON 19. Os chefes adoram o Excel, os hackers tamb√©m üë©üèæ‚Äçüöí üë®üèæ‚Äçüè≠ üß¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sauda√ß√µes a todos! Quem fala espanhol? √ìtimo! Ganhamos esse pr√™mio porque, pela manh√£, nosso time, o time espanhol, participou de um torneio de futebo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Confer√™ncia DEFCON 19. Os chefes adoram o Excel, os hackers tamb√©m</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/480370/"> Sauda√ß√µes a todos!  Quem fala espanhol?  √ìtimo!  Ganhamos esse pr√™mio porque, pela manh√£, nosso time, o time espanhol, participou de um torneio de futebol e recebeu esse trof√©u, ent√£o pe√ßo desculpas √† Argentina e √† √Åfrica do Sul por termos conquistado esse pr√™mio.  Obrigado a todos por terem vindo √† nossa apresenta√ß√£o.  Antes de mais, deixe-me apresentar-lhe o meu amigo Juan Corrido, e eu sou Chema Alonso.  Trabalhamos em uma pequena empresa espanhola Informatica64 e, antes de iniciar uma conversa sobre o assunto, quero apresentar nosso pa√≠s. <br><br><img src="https://habrastorage.org/webt/-b/tf/lf/-btflfdt73igrodvnmcaqlqwnra.jpeg"><a name="habracut"></a><br><br>  A Espanha √© um pa√≠s pequeno no meio de tudo, est√° localizado entre Europa, √Åfrica e Am√©rica do Sul, porque esta √© a nossa hist√≥ria.  Se voc√™ nunca esteve na Espanha, deveria ir para l√°.  Eu sou de Madri, √© uma cidade bonita, era a capital de um grande imp√©rio h√° 500 anos.  Se voc√™ vier a Madri, n√£o se sentir√° estrangeiro, porque se veio a Madri, j√° √© Madri.  Juanito de outra cidade, de Sevilha.  Esta cidade foi a capital do Imp√©rio √Årabe no s√©culo VII, quando a Espanha era um pa√≠s √°rabe.  No slide, voc√™ v√™ a Torre Dourada, que √© constru√≠da em ouro, que foi trazida para a Europa da Am√©rica do Sul. <br>  Sevilha √© muito famosa por seu flamenco, festivais e monumentos - neste slide, um dos maiores monumentos arquitet√¥nicos, a Plaza de Espa√±a, voc√™ provavelmente conhece.  Voc√™ deve visitar este monumento e se apaixonar, porque se Anakin Skywalker se apaixonar por Sevilha, voc√™ tamb√©m poder√° faz√™-lo.  Ent√£o n√£o se esque√ßa de visitar o nosso pa√≠s. <br><br>  Juanito, de Triana, √© uma pequena rep√∫blica independente em Sevilha, famosa pela Semana Santa, porque seus habitantes s√£o muito religiosos e milhares deles realizam apresenta√ß√µes religiosas nesse momento e, √© claro, depois que bebem. <br><br><img src="https://habrastorage.org/webt/0l/-z/yr/0l-zyrakhusiqc5rltere9eegzs.jpeg"><br><br>  Portanto, trabalhamos na Informatica64 e provavelmente muitos de voc√™s j√° ouviram falar de uma ferramenta que desenvolvemos chamada Foca.  Esta √© uma ferramenta gratuita que voc√™ pode usar para hackear informa√ß√µes, testes de penetra√ß√£o e assim por diante.  Amanh√£ publicaremos em nosso workshop on-line √†s 8 horas uma nova e terceira vers√£o deste programa, para que qualquer um de voc√™s possa participar do teste. <br><br>  O t√≥pico de nossa palestra hoje √© sobre aplicativos remotos usando o Citrix e o Windows Terminal Service.  As empresas as colocam nas nuvens.  Em nossa apresenta√ß√£o, descreveremos como usar aplicativos com a extens√£o .ica e os arquivos do Servi√ßo de Terminal, automatizando a an√°lise de dados usando o FOCA.  Isso permite que um invasor identifique software interno, redes internas e combine informa√ß√µes durante a verifica√ß√£o de PTR e durante ataques maliciosos usando arquivos do Excel.  Como resultado, usaremos o complicado recurso de pol√≠tica de seguran√ßa dos aplicativos remotos do Excel, que permite aos hackers ignorar restri√ß√µes de macro e obter informa√ß√µes confidenciais da empresa. <br><br>  Anteriormente, realizamos uma grande quantidade de trabalho nesse t√≥pico, no Citrix e no Windows Terminal Service, mas ainda acreditamos que isso √© importante, porque at√© agora ningu√©m se preocupou seriamente com esse problema.  Mostraremos como √© f√°cil para um hacker se infiltrar nos dados da empresa usando essas ferramentas. <br><br>  √â muito f√°cil encontrar o ponto de entrada de uma empresa que est√° procurando aplicativos remotos ou conex√µes remotas via Google.  Eles est√£o procurando arquivos .rdp.  Voc√™ pode encontrar quase dois mil lugares, 2000 servidores publicando esses aplicativos.  Voc√™ tamb√©m pode encontrar sites governamentais que usam aplicativos remotos de "nuvem", basta clicar neles e ver o que acontece. <br><br><img src="https://habrastorage.org/webt/qi/ei/i3/qieii365itff3ffjrmf0g83fxm8.jpeg"><br><br><img src="https://habrastorage.org/webt/nk/ci/yv/nkciyvrjzb9glhjlv-14iiefiec.jpeg"><br><br>  Voc√™ pode fazer a mesma coisa no BING.  Voc√™ n√£o pode usar o modificador de extens√£o de arquivo, mas pode usar o tipo de arquivo .txt e procurar qualquer modificador que apare√ßa em todos os arquivos em milhares de aplicativos remotos encontrados. <br><br>  Alguns dos lugares que descobrimos usando esses aplicativos remotos s√£o sites do governo.  No slide, voc√™ v√™ o sistema de gerenciamento de ordens de patrulha localizado no dom√≠nio .mil nos EUA, este √© o site das for√ßas armadas. <br><br><img src="https://habrastorage.org/webt/xu/jl/sp/xujlsppljishj5vgipw2ybfarqc.jpeg"><br><br>  √çamos fazer uma demonstra√ß√£o com base neste site e conversamos com Jeff, mas hoje ele a corrigiu e n√£o sabemos o porqu√™.  Mas estamos prontos para mostrar uma experi√™ncia com outro site do governo - o Departamento de Transportes da Calif√≥rnia. <br><br><img src="https://habrastorage.org/webt/s0/oc/12/s0oc12svfjj0zjuplxoyyklvqci.jpeg"><br><br>  Apenas lendo esta p√°gina, na parte inferior, voc√™ encontra o aplicativo RouteCleaning remoto, que √© um arquivo com a extens√£o .ica, e fa√ßa o download clicando no link.  Vamos ver o que temos.  Garanto-lhe, funcionou 5 minutos atr√°s.  Bem, n√£o tivemos sucesso, mas n√£o se preocupe, temos outra demonstra√ß√£o. <br><br>  Nesse ambiente, como veremos, h√° muitas coisas com que se preocupar e √© muito dif√≠cil garantir a seguran√ßa de todos os aplicativos.  Este slide com Leonardo DiCaprio n√£o faz sentido, pois se refere a uma demonstra√ß√£o fracassada.  Desculpe novamente, mas h√° 5 minutos realmente funcionou. <br><br>  Voc√™ insiste em que tentemos novamente?  Bem, digitaremos novamente o Departamento de Transportes da Calif√≥rnia no navegador.  N√£o, n√£o funciona novamente.  Eles consertaram!  Mas acredite, h√° 5 minutos tudo deu certo para n√≥s.  Bem, n√£o se preocupe. <br><br>  Vamos continuar.  O maior problema com esses arquivos de configura√ß√£o √© a verbosidade.  Voc√™ pode simplesmente ler os arquivos .txt e encontrar neles muitos tipos de informa√ß√µes, como o endere√ßo IP interno e as senhas criptografadas do usu√°rio.  Voc√™ pode quebrar essas senhas criptografadas, mas n√£o poder√° acessar o sistema usando uma conta an√¥nima ou conta de usu√°rio.  O mencionado aqui √© um software interno.  Portanto, esses arquivos s√£o ideais para ataques cibern√©ticos espec√≠ficos, como o APT, para pessoas que coletam informa√ß√µes para organizar esses ataques.  Uma simples pesquisa de arquivos .ica na Internet torna poss√≠vel detectar arquivos com uma senha para Oracle simplesmente no texto. <br><br><img src="https://habrastorage.org/webt/vq/pt/n7/vqptn7pbh0m9bgc022sspzh3apk.jpeg"><br><br>  Para isso, voc√™ n√£o precisa fazer nada de especial, h√° informa√ß√µes suficientes nesses arquivos.  Portanto, decidimos adicionar esse tipo de arquivo √† nossa ferramenta FOCA, que √© usada para coletar informa√ß√µes e identificar os sites da empresa.  Voc√™ j√° v√™ uma nova vers√£o do programa, que estar√° dispon√≠vel amanh√£ para aqueles que procuram esses tipos de arquivos e extraem informa√ß√µes deles. <br><br><img src="https://habrastorage.org/webt/ow/0y/lu/ow0yluzqhm1bkua_m5t-t_t3rqy.jpeg"><br><br>  O segundo grande problema √© que s√£o todos os arquivos de texto com a extens√£o .txt, para que o invasor possa modificar livremente os arquivos de configura√ß√£o e acessar outras partes do sistema operacional.  Ele pode gerar mensagens de erro no servidor; portanto, ao usar o Citrix, voc√™ receber√° uma mensagem informando que esse arquivo ou aplicativo n√£o est√° no servidor.  Um hacker tamb√©m poder√° obter a lista inteira de aplicativos instalados no seu computador. <br><br>  √â muito simples fazer isso com os Servi√ßos de Terminal - no modo de aplicativo remoto, o comando -0 dar√° acesso a toda a √°rea de trabalho, e o comando -1 dar√° acesso apenas aos aplicativos.  Vers√µes com n√∫mero &lt;6 para protocolos RDP criam um shell alternativo, embora n√£o funcionem com os Servi√ßos de Terminal em 2008.  Por exemplo, voc√™ recebe v√°rias mensagens de erro, como "Acesso negado", porque esse arquivo pertence ao sistema operacional.  Mas o fato de voc√™ n√£o poder acessar esse arquivo significa que ele n√£o est√° localizado no servidor, mas no computador. <br><br><img src="https://habrastorage.org/webt/8u/hw/wo/8uhwwodvdr_9kmag9zu43rqliay.jpeg"><br><br>  O positivo √© que voc√™ pode fazer o mesmo no Citrix, e n√£o h√° prote√ß√£o aqui para impedir uma conex√£o, outra conex√£o, outra e assim por diante, voc√™ nem precisa inserir o captcha. <br><br>  Voc√™ pode otimizar esse procedimento com a ajuda de um programa criado por n√≥s chamado CACA ("AS"), que √© uma abrevia√ß√£o da frase "aplicativos de computador Citrix". <br><br><img src="https://habrastorage.org/webt/7r/41/yj/7r41yjylksdddkk5welwudrcsri.jpeg"><br><br>  Voc√™ s√≥ precisa abrir ‚ÄúAS‚Äù, selecionar um arquivo .ica, ao lado do bloco de notas, voc√™ ver√° uma lista de configura√ß√µes ‚Äún√£o exceda‚Äù, ‚Äúcalcular‚Äù, ‚Äún√∫mero de amea√ßas‚Äù e assim por diante, pressione o bot√£o Iniciar e poder√° tomar um caf√© enquanto CACA faz o trabalho para voc√™.  Ela tenta abrir o aplicativo enquanto faz instant√¢neos; assim, quando terminar o trabalho, voc√™ poder√° ver as mensagens de erro.  Assim, voc√™ pode descobrir se esse aplicativo existe ou n√£o no servidor.  Voc√™ pode usar uma lista muito grande de aplicativos.  Ao iniciar o "KAKA" no seu computador no in√≠cio do dia, no final do dia, voc√™ receber√° uma lista de aplicativos em "KAKA". <br><br>  Outra coisa que pode ser feita com os Servi√ßos de Terminal, chamamos "Tocando o Piano".  Existem muitos links nos Servi√ßos de Terminal e Citrix, especialmente no Windows 2008, muitas vari√°veis, como% SystemRoot%,% ProgramFiles%,% SystemDrive%, muitos atalhos de teclado e muitas fun√ß√µes que permitem que um hacker alcance essas partes do sistema, para que nem o administrador do sistema recebe. <br><br>  N√≥s realmente gostamos do Windows Server 2008, porque ajudar√° em tudo!  Se voc√™ solicitar um aplicativo que n√£o esteja no sistema operacional, o Windows Server 2008 exibir√° uma janela com um erro e um bot√£o de ajuda.  Por que n√£o aproveitar essa cortesia?  Portanto, quando voc√™ clica no bot√£o Ajuda, o programa oferece a voc√™ a leitura do manual com muitos links que permitem abrir o IE, ativar o painel ‚ÄúAbrir arquivo‚Äù, executar algum tipo de comando e assim por diante. <br><br><img src="https://habrastorage.org/webt/ry/b8/ln/ryb8lnxbvm02dfqlrrnlnclabny.jpeg"><br><br>  "Tocar piano" permite que voc√™ use muitos atalhos de teclado para acessar v√°rias partes do sistema operacional. <br><br><img src="https://habrastorage.org/webt/hj/rn/zn/hjrnzn7fjeuw3tash6eh0jgylwc.jpeg"><br><br>  Ao us√°-los, obtemos mais e mais novos atalhos de teclado. <br><br><img src="https://habrastorage.org/webt/2e/u1/-h/2eu1-hnxz9qbff_vnrd6enjfqcg.jpeg"><br><br>  Uma caracter√≠stica interessante √© a fun√ß√£o de teclas adesivas.  Se voc√™ pressionar a tecla SHIFT tr√™s a quatro vezes seguidas, o sistema operacional exibir√° um menu para definir a fun√ß√£o das teclas de ader√™ncia no painel de controle.  Portanto, mesmo que voc√™ n√£o tenha acesso ao painel de controle por meio de teclas, voc√™ pode configurar todos os pain√©is de controle do sistema operacional simplesmente clicando em ‚ÄúSalvar‚Äù. <br><br>  Agora, mostraremos uma demonstra√ß√£o no site da Citrix.  Este √© um site da Sitrix, mas esta p√°gina tem como objetivo demonstrar os recursos dos servidores, portanto nossa demonstra√ß√£o √© totalmente legal. <br><br><img src="https://habrastorage.org/webt/rr/cu/sh/rrcushzvtok_bjrmerh4vaz09ea.jpeg"><br><br>  N√≥s inserimos o nome de usu√°rio e a senha e entram no ambiente Citrix.  Voc√™ v√™ muitas aplica√ß√µes aqui.  Vamos usar o Excel, porque o tema da nossa apresenta√ß√£o √© o Excel.  Ent√£o, vamos para o aplicativo e execute o Excel. <br><br><img src="https://habrastorage.org/webt/fm/qo/x9/fmqox9tkjjmjrezlkup3yfa3awy.jpeg"><br><br>  O sistema est√° agora carregando componentes do cliente.  Tudo est√° pronto, agora usamos o IE.  Acredite, o Excel funciona, apenas a velocidade da Internet √© baixa.  Aqui, finalmente, a janela do Windows Server 2008 apareceu, estamos nos conectando ao Excel remoto.  Muito devagar ... se algu√©m realizar um ataque intermedi√°rio a essa rede, pare de fazer isso (risos).  O que aconteceu com a internet? <br><br>  Muito, muito devagar ... bem, finalmente!  Abrimos o Excel!  Como voc√™ pode ver, os dados financeiros confidenciais da empresa apareceram na tela. <br><br><img src="https://habrastorage.org/webt/nm/pe/ko/nmpeko9r7mthcedds8pxcrsshtk.jpeg"><br><br>  Esse arquivo deve ser protegido pelo ambiente Citrix, vamos tentar usar vari√°veis ‚Äã‚Äãde ambiente para conectar-se ao diret√≥rio raiz.  Como voc√™ pode ver, quando tentamos abrir a biblioteca "Meus documentos", recebemos mensagens de "Acesso negado", mas voc√™ pode fazer muitos truques. <br><br>  Um desses truques √© criar um atalho para o comando cmd e execut√°-lo ... n√£o funciona!  Eles consertaram.  N√£o √© assustador, existem muitos consoles.  Crie um atalho para o PowerShell e execute-o.  Como voc√™ pode ver, funcionou!  Agora podemos acessar tudo o que precisamos. <br><br><img src="https://habrastorage.org/webt/sd/oi/fy/sdoifyzdqaon5ui5zhoofnpa68i.jpeg"><br><br>  Isso √© muito dif√≠cil para n√≥s, porque todos os dias os sistemas operacionais est√£o se tornando mais complicados e os aplicativos que publicam no servidor tamb√©m est√£o se tornando mais complicados.  Portanto, cada aplicativo que voc√™ publica nos Servi√ßos de Terminal serve como uma maneira de acessar seu sistema operacional.  Al√©m disso, cada aplicativo √© uma maneira de aumentar os privil√©gios de acesso.  Aplicativos complexos s√£o ideais para essas opera√ß√µes, e o Excel √© um aplicativo t√£o complexo que as empresas publicam por meio de servi√ßos para aplicativos remotos. <br><br>  Essa √© uma ferramenta muito poderosa, e os chefes adoram o Excel, porque voc√™ pode criar muitos gr√°ficos e tabelas engra√ßados, analisar um monte de dados, conectar o Excel a bancos de dados, executar a minera√ß√£o de dados e fazer muitas outras coisas favor√°veis ‚Äã‚Äãaos neg√≥cios. <br><br><img src="https://habrastorage.org/webt/xq/b3/_r/xqb3_rujerxhdixxlu6pmi4kdpe.jpeg"><br><br>  Mas, para fazer tudo isso, voc√™ precisa de um ambiente Visual Basic.  Voc√™ pode remover o Visual Basic do seu Excel, mas, ao mesmo tempo, ele se tornar√° um aplicativo completamente diferente e n√£o permanecer√° no Excel. <br>  Portanto, a ideia √© que, gra√ßas aos recursos do Visual Basic, voc√™ possa fazer muitas coisas com o Excel.  Vamos demonstrar isso. <br><br>  Portanto, temos o Windows 2008 com servi√ßos de terminal e, nesse ambiente, publicamos o Excel 2007. N√≥s o usamos porque as pol√≠ticas de seguran√ßa e as restri√ß√µes de aplicativos s√£o mais ou menos as mesmas.  A principal diferen√ßa entre a seguran√ßa do MS Office 2010 e 2007 √© a sandbox, ou seja, em rela√ß√£o aos arquivos que voc√™ baixa de uma fonte n√£o segura na Internet.  Por√©m, depois de baixar o arquivo no seu computador, as pol√≠ticas de seguran√ßa do grupo ser√£o as mesmas para as macros.  Voc√™ pode usar macros n√£o assinadas e macros de terceiros. <br><br>  Assim, neste ambiente, podemos executar o Excel com macros.  Por padr√£o, as pol√≠ticas de seguran√ßa permitem ao usu√°rio escolher se deseja ativar ou n√£o as macros.  No entanto, ao iniciar o Excel em um servidor remoto, essa op√ß√£o √© uma op√ß√£o adicional e as macros s√£o ativadas por padr√£o, pois o Visual Basic for Applications n√£o funciona no computador local, mas no servidor.  Esta √© uma grande diferen√ßa. <br><br><img src="https://habrastorage.org/webt/3m/ue/h2/3mueh2avz1mkmipf9a9bh22asec.jpeg"><br><br>  Neste exemplo, criaremos um painel e voc√™ ver√° que, na mensagem da pol√≠tica de seguran√ßa, esta op√ß√£o para trabalhar com a macro √© selecionada pelo usu√°rio - seja para permitir ou n√£o que esse conte√∫do seja usado.  Obviamente, clicamos em "Permitir", ap√≥s o qual um gr√°fico com indicadores financeiros da empresa aparece na tela. <br><br><img src="https://habrastorage.org/webt/oz/xh/nv/ozxhnvjau-hcrxlw4wsuqoo6ras.jpeg"><br><br>  Com essa atitude em rela√ß√£o ao aplicativo, voc√™ pode fazer muitas coisas, por exemplo, visualizar os processos em execu√ß√£o.  Usando a Instrumenta√ß√£o de Gerenciamento do Windows, voc√™ pode usar os comandos para obter os resultados e exibi-los em um arquivo do Excel. <br><br>  Fecharemos esta janela e retornaremos √† apresenta√ß√£o.  Depois de visualizar esta demonstra√ß√£o, fica claro que voc√™ deve cuidar da seguran√ßa do Excel em um ambiente remoto.  A primeira coisa que o administrador do sistema deve cuidar √© bloquear alguns consoles especiais, como -cmd.exe, -powershell, -script, -cscript.  Mas h√° muitos consoles por l√° e um backup no Windows Server 2008 cria c√≥pias de todos esses pain√©is de controle.  Isso cria um problema duplo, porque os consoles s√£o duplicados.  Nesse ambiente, todos os consoles s√£o proibidos; por isso, usamos ACL ACLs e pol√≠ticas de seguran√ßa, mas podemos at√© usar consoles de outro sistema operacional. <br><br>  Essa id√©ia foi apresentada por Stevens e que voc√™ pode incorporar uma dll em um arquivo do Excel e que essa dll √© um int√©rprete generalizado.  Portanto, simplesmente chamando o int√©rprete da sua dll, voc√™ ter√° acesso ao servidor.  Ent√£o, vamos ver a segunda demonstra√ß√£o, que trata de consoles proibidos.  Iremos para o Windows Server 2008 e tentaremos executar o cmd.exe, que √© proibido.  Voc√™ v√™ que nada funciona para n√≥s, porque esse console √© proibido - uma inscri√ß√£o parece que esse programa est√° bloqueado pelas pol√≠ticas de seguran√ßa do grupo. <br><br><img src="https://habrastorage.org/webt/ow/tt/xf/owttxfdf1f5nmgmbk0sqlgwmfaw.jpeg"><br><br>  Mas o arquivo do Excel que estamos prestes a abrir cont√©m .dll do ReactOS e .dll para o editor de registro, tamb√©m do ReactOS.  Portanto, abrimos a linha de comando pressionando o bot√£o "Linha de comando" e agora o arquivo do Excel extrai o .dll para execut√°-lo.  De fato, obteremos um interpretador de comando do ReactOS. <br><br><img src="https://habrastorage.org/webt/ow/tt/xf/owttxfdf1f5nmgmbk0sqlgwmfaw.jpeg"><br><br>  Voc√™ v√™ na tela que temos o interpretador de comandos ReactOS, que praticamente n√£o √© diferente do interpretador de comandos do Windows 2008. Portanto, esse √© um bom truque. <br><br><img src="https://habrastorage.org/webt/cq/ia/40/cqia40wgsqxbasnpjnqrvsvyrp4.jpeg"><br><br>  Ao mesmo tempo, nenhum cmd.exe √© vis√≠vel no gerenciador de tarefas, porque √© uma .dll dentro do arquivo do Excel e somente o aplicativo EXCEL.EXE pode ser visto no gerenciador de tarefas, para que a empresa atacada n√£o suspeite de nada. <br><br><img src="https://habrastorage.org/webt/_-/bt/qh/_-btqhcrqfh3jqqvxfvbxhrk7ws.jpeg"><br><br>  Vamos voltar aos nossos slides.  Depois de ver a √∫ltima demonstra√ß√£o, voc√™ pode dizer - ok, vou desligar todas as macros do meu computador.  Mas o fato √© que, de acordo com as pol√≠ticas de seguran√ßa, desabilitar o Visual Basic significa proibir seu uso para todos os aplicativos de escrit√≥rio, e n√£o apenas para o Excel, isto √©, afetar√° o Word, PowerPoint, Access e assim por diante. <br><br>  Existem 4 op√ß√µes de seguran√ßa de macro nas configura√ß√µes do Excel: n√£o use macros, use apenas macros assinadas, use macros a crit√©rio do usu√°rio para cada caso espec√≠fico e use todas as macros.  Se o usu√°rio for um hacker, ele selecionar√° 3 op√ß√µes.  Agora, mostraremos a demonstra√ß√£o do Excel, para a qual escolhemos a primeira op√ß√£o - n√£o use macros. <br><br>  Novamente usamos o arquivo do Excel publicado atrav√©s do ambiente remoto, portanto, retornamos ao Windows 2008 e sa√≠mos da conex√£o inativa √† Internet.  Em seguida, vamos aos pol√≠ticos, marque a caixa de sele√ß√£o "Ativar" para ativar as pol√≠ticas de seguran√ßa e selecione o terceiro par√¢metro "Nenhum aviso para todas as macros, mas com proibi√ß√£o de todas as macros" no menu suspenso. <br><br><img src="https://habrastorage.org/webt/4c/vc/7x/4cvc7xfp4siqopcbiwimozjvvs4.jpeg"><br><br>  Em seguida, clicamos nos bot√µes "Aplicar" e "OK", aguardamos a altera√ß√£o dos par√¢metros, retornamos ao cliente e abrimos o arquivo do Excel.  Este √© um dos meus truques favoritos.  Ao abrir um documento, voc√™ v√™ que nada pode ser feito porque tudo √© proibido.       ,      ,    . <br><br><img src="https://habrastorage.org/webt/dq/rr/qz/dqrrqzbzztd8nxmyw71a03lb3qw.jpeg"><br><br>   Excel    ‚Äì      trusted locations.    ‚Äì  ,      ,         .   ,       .             ,    ‚Äì      ,       .             ,       ‚Äì   Excel.    ,     ,         .  ,  ,  ! <br><br><img src="https://habrastorage.org/webt/95/gc/7r/95gc7rlc_t8cc15v4kyid8elxdo.jpeg"><br><br>   ,   ‚Äì   !     ,   ‚Äì      ! ,   ,    ,            .      .  ,      . <br><br> ,        4 .  : 1  ‚Äì  , 2-    ,  ‚Äì  ,  4 ‚Äì      .            ¬´     ¬ª. <br><br>  ¬´¬ª, ¬´¬ª      . <br><br><img src="https://habrastorage.org/webt/oq/qo/jy/oqqojyvfg8qzshzdop-xdteftu4.jpeg"><br><br> ,     Excel   ,        ,          .    ¬´    ¬ª,      ¬´   ¬ª. <br><br><img src="https://habrastorage.org/webt/ax/9i/1o/ax9i1ohjtbjwjl1vnujzkhecj_u.jpeg"><br><br>    ,      .    ,    ,          . ,     ,        Certificate Import Wizard! <br><br> ,   ,      ‚Äì    ¬´ ¬ª  ¬´     ¬ª ( ). <br><br><img src="https://habrastorage.org/webt/yo/kc/la/yokclairjf89fzunzom98aoi60s.jpeg"><br><br>   ,     ,     . ,        .           CRL,  CRL      HTTP  LDAP,  HTTP       SQL Injection,     SQL .          Excel    -,      ,    , ,   ,     CRL. <br><br>         SQL, ,     ,    -   CA    DHS ,      .   ,      ,   FOCA. <br><br><img src="https://habrastorage.org/webt/i2/-z/ha/i2-zha056nrm8tanrrl-kr4ke2a.jpeg"><br><br>      : <br><br><ul><li>     DHS; </li><li>   ; </li><li>    Excel  CA; </li><li>   URL  CRL  , , ; </li><li>    DHS  Excel   . </li></ul><br> , , ,        ,            . <br><br><img src="https://habrastorage.org/webt/t_/dr/cl/t_drcl0rnjimbjyxktz_9o375y8.jpeg"><br><br>       ,    ,  , -,           ,    .          Excel    ,   .     ,                   . <br><br><img src="https://habrastorage.org/webt/ui/yk/vd/uiykvdbo0vabx2pywa79tnnm2jy.jpeg"><br><br>          TS Web Access ‚Äì     ¬´  TS Web Access¬ª.  ,       ,    ,        HTTP.       ,  ,   ,    . <br><br>   , ,    ! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Xi0qUZCz6F0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>   :) </h3><br> ,    .    ?     ?  ,     , <a href="https://ua-hosting.company/cloudvps/nl"> VPS    $4.99</a> , <b>  entry-level ,      :</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">   VPS (KVM) E5-2697 v3 (6 Cores) 10GB DDR4 480GB SSD 1Gbps  $19     ?</a> (   RAID1  RAID10,  24    40GB DDR4). <br><br> <b>Dell R730xd  2    - Equinix Tier IV  ?</b>    <b><a href="https://ua-hosting.company/serversnl">2  Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100   $199</a>  ! <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - a partir de US $ 99! </font></font></b></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Leia sobre</font></font><a href="https://habr.com/company/ua-hosting/blog/329618/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como criar um pr√©dio de infraestrutura. </font><font style="vertical-align: inherit;">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt480370/">https://habr.com/ru/post/pt480370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt480356/index.html">Dicas √∫teis sobre Python que voc√™ n√£o conheceu</a></li>
<li><a href="../pt480358/index.html">O pre√ßo oculto das bibliotecas CSS-in-JS nos aplicativos React</a></li>
<li><a href="../pt480362/index.html">Aventuras do hexafluoreto de ur√¢nio empobrecido alem√£o na R√∫ssia. Parte 1. Hist√≥ria e tecnologias de enriquecimento</a></li>
<li><a href="../pt480364/index.html">Metaf√≠sica da inje√ß√£o de depend√™ncia</a></li>
<li><a href="../pt480368/index.html">Captura de vazamentos de mem√≥ria em C / C ++</a></li>
<li><a href="../pt480374/index.html">Reagir √† DogBot da Robotics: Revolu√ß√£o na Ind√∫stria da Constru√ß√£o</a></li>
<li><a href="../pt480376/index.html">De jogos de computador a mensagens secretas: discuta ovos de P√°scoa em lan√ßamentos de vinil</a></li>
<li><a href="../pt480378/index.html">14 projetos de c√≥digo aberto para aprimorar as habilidades de ci√™ncia de dados (f√°cil, normal, dif√≠cil)</a></li>
<li><a href="../pt480386/index.html">Backups autom√°ticos de equipamentos de rede e seu armazenamento no sistema de controle de vers√£o</a></li>
<li><a href="../pt480388/index.html">Confer√™ncia HACKTIVITY 2012. A teoria do Big Bang: A evolu√ß√£o do pentesting na seguran√ßa aprimorada. Parte 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>