<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ซ โ๏ธ ๐๐ฝ ุนุฑุถ NodeMCU ููููุฐุฌ ุจุฑูุงูุฌ ุงูุชุดุบูู ุงูุจุณูุท (SDM): ูุงุฌูุฉ ูุณุชุฎุฏู ุฏููุงููููุฉ โฎ๏ธ ๐ฉ๐ฝโ๐ณ ๐ซ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="NodeMCU ุนุจุงุฑุฉ ุนู ุจุฑูุงูุฌ ุซุงุจุช ุชูุงุนูู ุ ูุงูุฐู ูุณูุญ ุจุชุดุบูู ูุชุฑุฌู Lua ุนูู ูุชุญูู ESP8266 (ุฏุนู ESP32 ููุฏ ุงูุชุทููุฑ). ุฌูุจุง ุฅูู ุฌูุจ ูุน ุฌููุน ูุงุฌูุงุช ุงูุฃุฌูุฒุฉ ุงูุนุงุฏ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุนุฑุถ NodeMCU ููููุฐุฌ ุจุฑูุงูุฌ ุงูุชุดุบูู ุงูุจุณูุท (SDM): ูุงุฌูุฉ ูุณุชุฎุฏู ุฏููุงููููุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449992/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/45/dq/e8/45dqe8yvyxvpg_kcien-88xslei.jpeg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">NodeMCU</a> ุนุจุงุฑุฉ ุนู ุจุฑูุงูุฌ <em>ุซุงุจุช ุชูุงุนูู</em> ุ ูุงูุฐู ูุณูุญ ุจุชุดุบูู ูุชุฑุฌู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Lua</a> ุนูู ูุชุญูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ESP8266</a> (ุฏุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ESP32</a> ููุฏ ุงูุชุทููุฑ).  ุฌูุจุง ุฅูู ุฌูุจ ูุน ุฌููุน ูุงุฌูุงุช ุงูุฃุฌูุฒุฉ ุงูุนุงุฏูุฉ ุ ููุฏ ูุญุฏุฉ ูุงู ูุงู ููุธุงู ุงููููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SPIFFS</a> . </p><br><p style=";text-align:right;direction:rtl">  ุชูุถุญ ูุฐู ุงูููุงูุฉ ุงููุญุฏุฉ ุงูููุทูุฉ ุงูุฌุฏูุฏุฉ ูู NodeMCU - sdm.  SDM ูุฑูุฒ ุฅูู ุทุฑุงุฒ ุจุฑูุงูุฌ ุงูุชุดุบูู ุงูุจุณูุท ููููุฑ ุชุฌุฑูุฏ ุทุฑุงุฒ ุจุฑูุงูุฌ ุชุดุบูู ุงูุฌูุงุฒ ูููุธุงู.  ูู ุงูุฌุฒุก ุงูุฃูู ูู ูุฐู ุงูููุงูุฉ ุณููุงูุด ุงููููุฐุฌ ููุณู ุ ููู ุงูุฌุฒุก ุงูุซุงูู ุณูููู ุนุฑุถูุง ููุงุฌูุฉ ูุณุชุฎุฏู ุงูููุจ ุงูุชู ุชู ุฅูุดุงุคูุง ุฏููุงูููููุง ุจุงุณุชุฎุฏุงู sdm ูุน ุจุนุถ ุงูุชุนูููุงุช. </p><a name="habracut"></a><br><h1 id="driver-model-basics" style=";text-align:right;direction:rtl">  ุฃุณุงุณูุงุช ูููุฐุฌ ุงูุณุงุฆู </h1><br><p style=";text-align:right;direction:rtl">  ุนูุตุฑูู ุฑุฆูุณููู ูู ุงููููุฐุฌ ููุง <em>ุงูุฃุฌูุฒุฉ</em> <em>ูุจุฑุงูุฌ ุงูุชุดุบูู</em> .  ุงูุฌูุงุฒ ุนุจุงุฑุฉ ุนู ุชูุซูู ูุฌุฑุฏ ูุจุนุถ ุงูุฃุฌูุฒุฉ ุฃู ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ.  ูู ุงูููุทูู ูุถุน ุงูุฃุฌูุฒุฉ ูู ุชุณูุณู ูุฑูู ููุฃุดุฌุงุฑ ุ ูุน ูุฌูุฏ ูุชุญูู ูู ุงูุฃุนูู ูุญุงููุงุช ูู ุงููุณุท ูุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ูุฃูุฑุงู. </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">DEVICES + DRIVERS | +-----+ | +-----+ |1WIRE&lt;----------------------+1WIRE| ++-+-++ | +-----+ | | | | +---------+ | +--------+ | +------+ | | | +------+DS1820| +---v----+ +---v----+ +---v----+ | | +------+ |DS1820|0| |DS1820|1| |DS1822|0| | | +---^----+ +---^----+ +---^----+ | | +------+ | | +--------------+DS1822| | | | | +------+ +-----------+------------------+ +</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุฑูุงูุฌ ุชุดุบูู ุงูุฌูุงุฒ ูู ุฌุฒุก ูู ุงูููุทู ุงููุฑุชุจุท ุจุฌูุงุฒ ูุนูู.  ุชุณูู ุงููุธุงุฆู ุงูุชู ูููุฑูุง ุจุฑูุงูุฌ ุงูุชุดุบูู <em>ุงูุฃุณุงููุจ</em> ุ ูุชุณูู ุญุงููุงุช ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ ุจุจุฑูุงูุฌ ุงูุชุดุบูู <em>ุณูุงุช</em> .  ูู ูู ุงูุทุฑู ูุงูุณูุงุช ุชุนูุด ุฏุงุฎู ุงูุณุงุฆู. </p><br><p style=";text-align:right;direction:rtl">  ููุณูุงุช ูุธููุชุงู <em>ูุฑุชุจุทุชุงู</em> ุจูุง: ุฎุทุงุทูู <em>getter</em> ู <em>setter</em> .  ูุฐูู ุ ุชูุนุฒููุฒ ูุธููุฉ ุฃุณููุจ ูุฌููุนุฉ ุงูุนูู ุงููุงุฆูุฉ ุ ูููููุง ุชุณุชููู ุฃูุถูุง ุฐุงูุฑุฉ ุฃูุจุฑ (ุฐุงูุฑุฉ ุฌูุงุฒ ุงูุชุญูู ุงูุตุบูุฑ ุดุญูุญุฉ ุ ุชุฐูุฑุ). </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">sdm.attr_add(drv, <span class="hljs-comment"><span class="hljs-comment">-- device handle "ref", -- attribute name "Reference voltage", -- attribute description 5, function(dev) -- this is a getter function return sdm.attr_data(sdm.attr_handle(dev, "ref")) end, function(dev, value) -- this is a setter function sdm.attr_set(sdm.attr_handle(dev, "ref"), value) end )</span></span></code> </pre> <br><h2 id="device-binding" style=";text-align:right;direction:rtl">  ุฑุจุท ุงูุฌูุงุฒ </h2><br><p style=";text-align:right;direction:rtl">  ุฌุฒุก ุตุนุจ ูู ุทุฑุงุฒ ุจุฑูุงูุฌ ุงูุชุดุบูู ูู ุฑุจุท ุจุฑูุงูุฌ ุชุดุบูู ุงูุฌูุงุฒ.  ุงูุนูููุฉ ูู ุญุฏ ุฐุงุชูุง ุจุณูุทุฉ: ูุทุงุจู ุงูุฌูุงุฒ ูุน ูู ุจุฑูุงูุฌ ุชุดุบูู ูุชุงุญ ุญุชู ููุงุณุจ.  ููุงู ุฌุฒุกุงู ููุท ููููุฏูู - ูุทุงุจูุฉ ุงูููุทู ูุจุนุถ ุงูุจูุงูุงุช ููุทุงุจูุชููุง. </p><br><p style=";text-align:right;direction:rtl">  ูู SDM ูุทุงุจูุฉ ุงูููุทู ูุนูุด ูู ุจุฑุงูุฌ ุงูุชุดุบูู ุชุญุช ุงุณู <code>_poll()</code> .  ุฅููุง ุทุฑููุฉ ุนุงุฏูุฉ ุชูุฏุนู ุจููุจุถ ุงูุฌูุงุฒ ููุนููุฉ ูุชูุฑุฌุน <code>true</code> ุฃู <code>false</code> ุฅุฐุง ูุงู ุงูุฌูุงุฒ ูููู ุฃู ูุง ูููู ุชูุตููู ุจุจุฑูุงูุฌ ุงูุชุดุบูู ุนูู ุงูุชูุงูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">sdm.method_add(drv, <span class="hljs-string"><span class="hljs-string">"_poll"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dev, drv, par)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> attr = sdm.attr_data(sdm.local_attr_handle(dev, <span class="hljs-string"><span class="hljs-string">"id"</span></span>)) <span class="hljs-comment"><span class="hljs-comment">-- get device attribute "id" if attr == nil then return false end -- if it does not have one, driver does not match -- parent name must be "ESP8266_1W" and first byte of "id" must be "0x28" return (sdm.device_name(par) == "ESP8266_1W") and (attr:byte(1) == 0x28) end )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ูู ููุถุญ ูู ุงููุซุงู ุฃุนูุงู ุ ูุทุงุจู ุจุฑูุงูุฌ ุงูุชุดุบูู ุงูุฌูุงุฒ ุจุงุณุชุฎุฏุงู ุงูุณูุฉ.  ูููู ููุง ูู ูุฐููุฑ ุฃุนูุงู ุ ุชุฑุชุจุท ุงูุณูุงุช ููุท ูุน ุจุฑูุงูุฌ ุงูุชุดุบูู.  ุจุดูู ุนุงู ุ ูุฐุง ุตุญูุญ ุ ูููู ููุงู ุจุนุถ ุงูุณูุงุช ุงูุชู ูุง ูููู ุงุณุชุฑุฌุงุนูุง ุนุจุฑ ุงูุจุฑุงูุฌ.  ูุฐู ูู ูุนุฑูุงุช ุฑูุงูุฉ ุ ูุชุณุชุฎุฏู ุฏุจุงุจูุณ ุงูุฎ  ุจุงููุณุจุฉ ูุฃููุฆู ุ ุชูุช ุฅุถุงูุฉ ููุน ุฎุงุต ูู ุงูุณูุฉ ุฅูู ุณูุฉ sdm - <em>ุงููุญููุฉ</em> .  ูุฐู ุงูุณูุฉ ูุฑุชุจุทุฉ ุจูุซูู ูุงุญุฏ ููุฌูุงุฒ ูุนุงุฏุฉ ูุง ุชููู ุบูุฑ ูุงุจูุฉ ููุชุบููุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุดูุก ุงููุญูุฏ ุงููุชุจูู ูุชูููู ุนู ุชุฌููุฏ ุงูุณุงุฆู.  ุนุงุฏุฉู ูุง ุชุชุทูุจ ุงูุฃุฌูุฒุฉ ููุนูุง ูู ุงูุชููุฆุฉ ุนูุฏ ุจุฏุก ุงูุชุดุบูู ูุงูุชูุธูู ุจุนุฏ ุงูุงุณุชุฎุฏุงู.  ููุฐุง ุงูุบุฑุถ ุ ุชุณุชุฎุฏู <code>_init()</code> ู <code>_free()</code> . <br>  ุฅุฐุง ูุงู ูุฏู ุจุฑูุงูุฌ <code>_init()</code> ุทุฑููุฉ ุ ูุณูุชู ุงุณุชุฏุนุงุคู ุชููุงุฆููุง ุจุนุฏ ุฑุจุท ุงูุฌูุงุฒ.  ุงูุดูุก ููุณู ูุน <code>_free()</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">sdm.method_add(drv, <span class="hljs-string"><span class="hljs-string">"_init"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dev, drv, par)</span></span></span></span> sdm.device_rename(dev, sdm.request_name(<span class="hljs-string"><span class="hljs-string">"DS18B20"</span></span>)) <span class="hljs-comment"><span class="hljs-comment">-- rename device sdm.attr_copy(dev, "temp") -- copy attribute sdm.attr_copy(dev, "precision") -- copy attribute local met = sdm.method_dev_handle(par, "setup") -- get 1Wire bus pin init function .. local func = sdm.method_func(met) -- .. and .. func(par, dev) -- .. call it end ) sdm.method_add(drv, "_free", nil, function(dev, drv, par) local met = sdm.method_dev_handle(par, "free") -- get 1Wire bus pin free function .. local func = sdm.method_func(met) -- .. and .. func(par, dev) -- .. call it end )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฑุจูุง ูุณุฃู ุงููุงุฑุฆ ุงูููุธ: ูุง ูุนูู "ูุณุฎุฉ ุงูุณูุฉ" ูู ุงููุซุงู ุฃุนูุงู ุชุนููุ  ูุณูููู ุนูู ุตูุงุจ ุ ูุฃู ูุฐุง ูุชุนูู ุจุงูููุน ุงูุซุงูุซ ูู ุงูุณูุงุช ุงูุชู ูู ููุงูุดูุง ุจุนุฏ - <em>ุงูุณูุฉ ุงูุฎุงุตุฉ</em> .  ููุณ ูู ุงูููุทูู ุฃู ุชุชู ูุดุงุฑูุฉ ุฌููุน ุจูุงูุงุช ุงูุณูุงุช ุจูู ุฌููุน ูุซููุงุช ุงูุฌูุงุฒ.  ููุฐุง ุงูุบุฑุถ ุ ุชููุฑ sdm ุขููุฉ ูุณุฎ ุงูุณูุฉ ูู ุจุฑูุงูุฌ ุงูุชุดุบูู ูุฑุจุทูุง ุจุงูุฌูุงุฒ.  ูุฐุง ูุฌุนู ุจุฑูุงูุฌ ุงูุชุดุบูู ุณูุฉ ูููุฐุฌ ุฃู ูุงูุจ. </p><br><p style=";text-align:right;direction:rtl">  ููุฎุต ุณุฑูุน: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุงุณุชุฎุฏุงู <em>ุงูุณูุงุช ุงููุญููุฉ</em> ููุจูุงูุงุช ุงูุชู ูุง ูููู ุงุณุชุฑุฌุงุนูุง ุจูุงุณุทุฉ ุงูุจุฑูุงูุฌ.  ูุซู ูุนุฑูุงุช ุงูุฌูุงุฒ ูุงูุฏุจุงุจูุณ ุงููุชุตูุฉ ููุง ุฅูู ุฐูู </li><li style=";text-align:right;direction:rtl">  ูุชู ุงุณุชุฎุฏุงู <em>ุณูุงุช ุจุฑูุงูุฌ ุงูุชุดุบูู</em> ููุจูุงูุงุช ุงููุดุชุฑูุฉ ุจูู ุฌููุน ูุซููุงุช ุงูุฃุฌูุฒุฉ ุงููุชุตูุฉ ุจุจุฑูุงูุฌ ุงูุชุดุบูู ูุฐุง. </li><li style=";text-align:right;direction:rtl">  ูุชู ูุณุฎ <em>ุงูุณูุงุช ุงูุฎุงุตุฉ</em> ูู ุณูุงุช ุจุฑูุงูุฌ ุงูุชุดุบูู ูุงูุงุญุชูุงุธ ุจุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ ุจูุซูู ุฌูุงุฒ ูุงุญุฏ ููุท.  ูุฐุง ุงูููุน ูู ุงูุฃูุซุฑ ุดููุนุง. </li></ul><br><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><thead><tr><th>  ููุชููุงุช </th><th>  ุงูุณูุฉ ุงููุญููุฉ </th><th>  ุงูุณูุฉ ุงูุฎุงุตุฉ </th><th>  ุณุงุฆู (ุงูุนุงูุฉ) ุงูุณูุฉ </th></tr></thead><tbody><tr><td>  ุชุฎุฒูููุง ูู </td><td>  ุฌูุงุฒ </td><td>  ุฌูุงุฒ </td><td>  ุณุงุฆู </td></tr><tr><td>  ูููู ุงููุตูู ุฅูููุง ุจุงุณุชุฎุฏุงู ููุจุถ ุงูุณุงุฆู </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td>  ูููู ุงููุตูู ุฅูููุง ุจุงุณุชุฎุฏุงู ููุจุถ ุงูุฌูุงุฒ </td><td>  + </td><td>  + </td><td>  + </td></tr><tr><td>  ูุดุชุฑู ุจูู ุงูุฃุฌูุฒุฉ </td><td>  - </td><td>  - </td><td>  + </td></tr><tr><td>  ุชุณุชูุฑ ุนูุฏ ูุตู ุงูุณุงุฆู </td><td>  + </td><td>  - </td><td>  + </td></tr></tbody></table></div><br><h1 id="web-user-interface-implementation" style=";text-align:right;direction:rtl">  ุชูููุฐ ูุงุฌูุฉ ูุณุชุฎุฏู ุงูููุจ </h1><br><h2 id="server-code" style=";text-align:right;direction:rtl">  ููุฏ ุงูุฎุงุฏู </h2><br><p style=";text-align:right;direction:rtl">  ููุฌุฏ ูุดุฑูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://github.com/marcoskirsch/nodemcu-">httpserver nodemcu</a> ุฌููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://github.com/marcoskirsch/nodemcu-">ูููู</a> ุจุชูููุฐ ููุฏ ุงูุฎุงุฏู ุงูุฎุงุต ุจู NudeMCU.  ููุฃุณู ูุจุฏู ุฃูู ูุฏ ูุงุช.  ุชู ุงุณุชุฎุฏุงูู ูุฃุณุงุณ ููุฎุงุฏู.  ุฃููุงู ุ ุชู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://gitlab.com/matsievskiysv/nodemcu-">ููู</a> ูุธุงุฆู ุงูุฎุงุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://gitlab.com/matsievskiysv/nodemcu-">ุฅูู LFS</a> ููู ุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://gitlab.com/matsievskiysv/nodemcu-pseudo">ุชุนุฏูููุง ููููุงู</a> ูุชูุฏูู ุตูุญุฉ ุซุงุจุชุฉ ูุงุญุฏุฉ ููู ููุงููุฉ.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Vue.js</a> ูู ุงูุงุฎุชูุงุฑ ุงูุฃูุซู ูุตูุญุงุช ุงูููุจ ุงููุงุฆูุฉ ุนูู ุงูููุงูุจ.  ูุฐูู ุชู ุงุณุชุฎุฏุงูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุงุฌูุฉ ุงูุฃูุงููุฉ</a> .  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู NodeMCU ูุฏ ูุง ุชููู ูุชุตูุงู ุจุงูุฅูุชุฑูุช.  ููุฐุง ุงูุณุจุจ ุ ูุฌุจ ุฃู ุชููู ููุชุจุฉ <code>vue.js</code> ููุฌูุฏุฉ ูุญูููุง ูุชุฎุฏููุง ุฎุงุฏู NodeMCU. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃู ุฌููุน ุงูุฃุฌูุฒุฉ ููุธูุฉ ูู ูููู ุดุฌุฑุฉ ุ ูุชู ุงููุตูู ุฅูููุง ุชูุงููุง ูุซู ุงูุฏููู: <code>/ESP8266/ESP8266_1W/DS18S20-0</code> .  ููุง <code>/ESP8266</code> ูู ุตูุญุฉ NodeMCU ุ ู <code>/ESP8266/ESP8266_1W</code> ูู ุตูุญุฉ ุญุงููุฉ <em>1Wire</em> ูุฃุฎูุฑุงู <code>/ESP8266/ESP8266_1W/DS18S20-0</code> ูู ูุณุชุดุนุฑ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุง ุฐูุฑูุง ุณุงุจููุง ุ ูุชู ุฅูุดุงุก ุฌููุน ุตูุญุงุช ุงูุฌูุงุฒ ูู ุตูุญุฉ ูุงูุจ ูุงุญุฏุฉ ูุชู ุชูุฏูููุง ูู ูู ููุงููุฉ.  ููุฏ <em>JS</em> ุฏุงุฎู ูุฐู ุงูุตูุญุฉ ุซู ูุฌุนู ุทูุจ ูููุณ ุนููุงู URL ุ ูุนุจุฃ ูุณุจูุง ูุน <code>/api</code> .  ุนูู ุณุจูู ุงููุซุงู ุฃุนูุงู ุ ุณูููู ุนููุงู URL ููุงุชุตุงู <code>/api/ESP8266/ESP8266_1W/DS18S20-0</code> .  ูู ูุซู ูุฐู ุงูุทูุจุงุช ุ ูุณุชุฌูุจ ุงูุฎุงุฏู ููุจูุงูุงุช ุงูุฎุงุตุฉ ุจุงูุฌูุงุฒ ุงููุดูุฑุฉ <em>JSON</em> ุ ูุงูุชู ุชููุฃ ุงูุตูุญุฉ.  ุจุงูุทุจุน ุ ูุฏ ูุชู ุชุฎุทู ุทูุจ ุตูุญุฉ <em>HTML</em> ุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ุฅูู ุงูุจูุงูุงุช ุงูุฃูููุฉ ููุท. </p><br><h2 id="device-tree" style=";text-align:right;direction:rtl">  ุดุฌุฑุฉ ุงูุฌูุงุฒ </h2><br><p style=";text-align:right;direction:rtl">  ูุชู ุงูุชูููู ุงูุฃููู ููุฌูุงุฒ ุจุงุณุชุฎุฏุงู ุจููุฉ <em>ุดุฌุฑุฉ ุงูุฌูุงุฒ ุงูุจุณูุทุฉ</em> .  ูู ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุดุฌุฑุฉ ุงูุฌูุงุฒ</a> ุ ูููู ุฃุจุณุท.  ูุตู ุชูููู ุงูุฌูุงุฒ ุจูุง ูู ุฐูู ุงูุณูุงุช ุงููุญููุฉ ููุฌูุงุฒ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> root={ <span class="hljs-comment"><span class="hljs-comment">-- local_attributes={}, children={ { name="ESP8266_1W", -- local_attributes={}, children = { { name="DS18S20-0", -- static declaration alternative to 1Wire poll method local_attributes={ { name="id", desc=nil, -- empty description to save space data=string.char(16) .. string.char(221) .. string.char(109) .. string.char(104) .. string.char(3) .. string.char(8) .. string.char(0) .. string.char(150) -- ugly way to create byte array }, { datapin=2 } } }, } }, { name="ESP8266_SPI", -- local_attributes={}, children = { { name="MCP3208-0" }, } }, } }</span></span></code> </pre> <br><h2 id="hardware-setup" style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ ุงูุฃุฌูุฒุฉ </h2><br><p style=";text-align:right;direction:rtl">  ููุง ูุจุฏุฃ ุงูุนุฑุถ.  ููุฐุง ุงูุบุฑุถ ุชู ุชูุตูู ูุฌููุนุฉ ูู ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ุฅูู NodeMCU: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณุชุดุนุงุฑ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DS18B20</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DS18S20</a> ุงุณุชุดุนุงุฑ ุฏุฑุฌุฉ ุงูุญุฑุงุฑุฉ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MCP3208</a> ADC </li></ul><br><p style=";text-align:right;direction:rtl">  <em>ุชุฑุชุจุท</em> ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ <em>1Wire</em> ุฅูู ููุณ ุฏุจูุณ. </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/fb/sw/zi/fbswzi7xav_pj4waz6g19hktrso.jpeg"></a> </p><br><h2 id="web-pages-and-drivers" style=";text-align:right;direction:rtl">  ุตูุญุงุช ุงูููุจ ูุจุฑุงูุฌ ุงูุชุดุบูู </h2><br><h3 id="root-device" style=";text-align:right;direction:rtl">  ุฌูุงุฒ ุงูุฌุฐุฑ </h3><br><p style=";text-align:right;direction:rtl">  ุงูุบุฑุถ ุงูุฑุฆูุณู ูู ุฌูุงุฒ ุงูุฌุฐุฑ (ุงููุนุฑูู ุฃูุถูุง ุจุงุณู ESP8266) ูู ุชูููุฑ ููุงู ูุฃุทูุงูู ููุงุชุตุงู ุจู.  ููุน ุฐูู ุ ูุง ููุชุตุฑ ูุฌูุฏ ุฃุณุงููุจ ุฃู ุณูุงุช ูุฑุชุจุทุฉ ุจู. </p><br><p style=";text-align:right;direction:rtl">  ููุชุทู ุงูุดูุฑุฉ ูุฐุง ูู <a href="">ููุง</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">sdm.method_add(drv, <span class="hljs-string"><span class="hljs-string">"_init"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dev, drv, par)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> attr = sdm.attr_handle(dev, <span class="hljs-string"><span class="hljs-string">"id"</span></span>) <span class="hljs-comment"><span class="hljs-comment">-- get device "id" attribute sdm.attr_set(attr, node.chipid()) -- set "id" value attr = sdm.attr_handle(dev, "float") -- get device "float" attribute sdm.attr_set(attr, 3 / 2 ~= 1) -- set to true if firmware supports floating point instructions end ) sdm.attr_add(drv, "float", "Floating point build", false, function(drv) -- attribute value is set inside "_init" function local attr = sdm.attr_drv_handle(drv, "float") return sdm.attr_data(attr) -- just return stored value end, nil )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุถูู ูุฐุง ุงูุฑูุฒ <code>float</code> ุงูุณูุฉ ุงูุฐู ูุณุชุฎุฏู ููุงุญุชูุงุธ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจููุน</a> ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ.  ุชุชู ุชููุฆุฉ ูููุชูุง ูู <code>_init()</code> ููู ูุธููุฉ ุฎุงุตุฉ ุ ูุชู ุชุดุบูููุง ูุฑุฉ ูุงุญุฏุฉ ุนูุฏูุง ูุชุตู ุจุฑูุงูุฌ ุงูุชุดุบูู ุจุงูุฌูุงุฒ. </p><br><p style=";text-align:right;direction:rtl">  ูุฐู ูู ุงูุตูุญุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ููุฌูุงุฒ ุงูุฌุฐุฑ. </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/mg/5q/lo/mg5qlog3-nwjkl6itrfw6ynyvuo.png"></a> </p><br><p style=";text-align:right;direction:rtl">  ููุง ูููููุง ุฃู ูุฑู ุฃู ุงูุฌูุงุฒ ุงูุฌุฐุฑ ูุญุชูู ุนูู <code>heap</code> ุทุฑููุฉ ูุงุญุฏุฉ ุ ูููุง ุณูุงุช ุณุงุฆู <code>float</code> <code>id</code> .  ุฃุฎูุฑูุง ุ ูุฏูู <em>ุฌูุงุฒุงู ูุชุตูุงู ุจู -</em> ุญุงููุงุช <em>SPI</em> ู 1 <em>Wire</em> . </p><br><h3 id="spi" style=";text-align:right;direction:rtl">  SPI </h3><br><p style=";text-align:right;direction:rtl">  <a href="">ุณุงุฆู <em>SPI</em></a> ููุณุช ูุซูุฑุฉ ููุงูุชูุงู ููุบุงูุฉ.  ุงููุง ูุฌุฑุฏ ุฎุฑุงุฆุท ูุธุงุฆู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">NodeMCU SPI</a> . </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/qx/mx/g8/qxmxg8mnkmnl5aglfq7q5zhpnv0.png"></a> </p><br><h3 id="mcp3208" style=";text-align:right;direction:rtl">  MCP3208 </h3><br><p style=";text-align:right;direction:rtl">  <em>MCP3208</em> ุนุจุงุฑุฉ ุนู ุดุฑูุญุฉ <em>ADC</em> .  ููู ูููุณ ุงููููุชูุฉ ูู ุงูุตูุฑ ุฅูู <em>ุงููุฑุฌุน</em> ููุนูุฏ ุฑูุฒ 12 ุจุช.  ูุง ูู ูุซูุฑ ููุงูุชูุงู ุญูู ุชูููุฐ <a href="">ุจุฑูุงูุฌ ุงูุชุดุบูู</a> ูุฐุง ูู ุฃู ุณูุฉ <code>ref</code> ุณุชููู ููุฌูุฏุฉ ููุท ุฅุฐุง ูุงูุช ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ุชุฏุนู ุญุณุงุจ ุงููุงุตูุฉ ุงูุนุงุฆูุฉ.  ุฅุฐุง ูู ููู ูุฏุนูููุง ุ ูุจุฏูุงู ูู ุงูุฌูุฏ ุงููุทูู ุ ูุชู ุฅุฑุฌุงุน ุฑูุฒ ุงูุฌูุฏ ุจูุงุณุทุฉ ูู ูู ุงูุทุฑู <code>single</code> <code>differential</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">sdm.method_add(drv, <span class="hljs-string"><span class="hljs-string">"single"</span></span>, <span class="hljs-string"><span class="hljs-string">"Single ended measure 0|1|2|3|4|5|6|7"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dev, channel)</span></span></span></span> <span class="hljs-comment"><span class="hljs-comment">-- ... if ref ~= nil then -- this part is executed only if floating point arithmetic is enabled rv = ref * rv / 4096 end return rv end ) if 3/2~=1 then -- other alternative is to access ESP8266 "float" method sdm.attr_add(drv, "ref", "Reference voltage", 5, function(dev) return sdm.attr_data(sdm.attr_handle(dev, "ref")) end, function(dev, value) sdm.attr_set(sdm.attr_handle(dev, "ref"), value) end ) end</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/m_/_l/cc/m__lccntxwsrorrujvky3opbm0s.png"></a> </p><br><p style=";text-align:right;direction:rtl">  ูุงุญุธ ุฃูุถูุง ุฃู ูุฐุง ุงูุฌูุงุฒ ูุญุชูู ุนูู ุณูุฉ ูููุฒุฉ ุชุญูู ุนูุงูุฉ <em>ุฎุงุตุฉ</em> .  ูุชู ุถุจุทู ุนูู ุฃุณุงุณ ูู ุฌูุงุฒ. </p><br><h3 id="1wire" style=";text-align:right;direction:rtl">  1Wire </h3><br><p style=";text-align:right;direction:rtl">  <a href=""><em>1 ูููู</em> ุจุฑูุงูุฌ ุงูุชุดุบูู</a> ุจุชูููุฐ ุทุฑููุฉ <code>poll</code> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจุญุซ ุงูุฏููุงูููู ุนู ุงูุฃุฌูุฒุฉ</a> . </p><br><p style=";text-align:right;direction:rtl">  ูุจุงุดุฑุฉ ุจุนุฏ ุงูุชุดุงู ุงูุฌูุงุฒ ููุนู ุบูุฑ ูุนุฑูู.  ูุฐูู ูุชู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนููุงูู ุงููุฑูุฏ</a> <em>1Wire</em> ูุงุณู ุฌุฏูุฏ ููุฌูุงุฒ (ูุชู ุชูุซูู ุงูุจุงูุชุงุช ูุฃุฑูุงู ููุตููุฉ ุจุญุฑู <code>_</code> ). </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">sdm.method_add(drv, <span class="hljs-string"><span class="hljs-string">"poll"</span></span>, <span class="hljs-string"><span class="hljs-string">"Poll for devices"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(bus, pin)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> children = sdm.device_children(bus) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> {} <span class="hljs-comment"><span class="hljs-comment">-- already attached local ids = {} -- get IDs of attached devices for name, handle in pairs(children) do local dpin = sdm.attr_data(sdm.local_attr_handle(handle, "pin")) if dpin == pin then ids[sdm.attr_data(sdm.local_attr_handle(handle, "id"))] = true end end ow.reset_search(pin) -- reset previous search while true do -- for all found devices local id = ow.search(pin) if id == nil then break end if ids[id] == nil then -- if not already present local name = "" for i=1,#id do name = name .. tostring(id:byte(i)) .. "_" end name = name:sub(1,-2) -- add to system with their ID used as name local device = sdm.device_add(name, bus) -- add "pin" attribute local rv = sdm.local_attr_add(device, "datapin", nil, pin, nil, nil) -- add "id" attribute local rv = sdm.local_attr_add(device, "id", nil, id, nil, nil) -- poll for driver local rv = sdm.device_poll(device) end end end )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐู ูู ุงูุตูุญุฉ ุงูุฃูููุฉ ูุจุฑูุงูุฌ <em>1Wire</em> . </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/j2/uq/ax/j2uqaxkhqilv0k1fmwaq2hn0iwq.png"></a> </p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฅุตุฏุงุฑ ุงุณุชุฏุนุงุก <code>poll</code> ุจุงุณุชุฎุฏุงู ุงููุณูุทุฉ <code>2</code> ูุตูุญุฉ ููุนุดุฉ ุ ูุธูุฑ ูุณู ุงูุฃุทูุงู.  ูุงุญุธ ุฃู ุฃุณูุงุก ุงูุฃุทูุงู ูุงุจูุฉ ูููุฑุงุกุฉ ุงูุจุดุฑูุฉ.  ูุฐุง ูุฃูู ุชู ุงุณุชุฏุนุงุก ุฏุงูุฉ <code>device_rename()</code> ุฃุซูุงุก <code>_init</code> . </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/_z/2x/na/_z2xnadqlt_qgyokfxomwivtwkq.png"></a> </p><br><h3 id="ds18s20" style=";text-align:right;direction:rtl">  DS18S20 </h3><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุงูุชููุฆุฉ ุ ูุชุญูู <a href="">ุจุฑูุงูุฌ ุชุดุบูู DS18S20 ูู</a> ุฃู <em>ูุนุฑู</em> ุงูุฌูุงุฒ ูุจุฏุฃ ุจู <code>0x10</code> ุ ููู ุฑูุฒ ุนุงุฆูุฉ ููุฌูุงุฒ.  ุนูุฏ ุชูุตูู ุงูุฌูุงุฒ ุจุจุฑูุงูุฌ ุงูุชุดุบูู ุ ุชุชู ุฅุนุงุฏุฉ ุชุณููุชู ุจุงุณู <code>DS18S20-X</code> ุ ุญูุซ <code>DS18S20</code> ูู ุงุณู ุฃุณุงุณู ู <code>X</code> ูู ุฑูู ูุซูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">sdm.method_add(drv, <span class="hljs-string"><span class="hljs-string">"_poll"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dev, drv, par)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> attr = sdm.attr_data(sdm.local_attr_handle(dev, <span class="hljs-string"><span class="hljs-string">"id"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> attr == <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (sdm.device_name(par) == <span class="hljs-string"><span class="hljs-string">"ESP8266_1W"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (attr:<span class="hljs-built_in"><span class="hljs-built_in">byte</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>) == <span class="hljs-number"><span class="hljs-number">0x10</span></span>) <span class="hljs-comment"><span class="hljs-comment">-- check family ID end ) sdm.method_add(drv, "_init", nil, function(dev, drv, par) sdm.device_rename(dev, sdm.request_name("DS18S20")) -- rename device sdm.attr_copy(dev, "temp") -- copy attribute to device local met = sdm.method_dev_handle(par, "setup") local func = sdm.method_func(met) -- use parent "setup" method on the device func(par, dev) end )</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/bm/pk/41/bmpk419dphexm-xlvnxq7hw2jxc.png"></a> </p><br><p style=";text-align:right;direction:rtl">  ูุง ุชุญุชูู <code>id</code> ุงูุณูุงุช ุงููุญููุฉ ู <code>datapin</code> ุนูู ุฎุทุงุทูู <code>setter</code> ู <code>setter</code> ุ ูุฐูู ุชููู ุฃุณูุงุกูุง ูุฑุฆูุฉ ููุท. </p><br><h3 id="ds18b20" style=";text-align:right;direction:rtl">  DS18B20 </h3><br><p style=";text-align:right;direction:rtl">  <a href="">ุจุฑูุงูุฌ ุชุดุบูู DS18B20</a> ูู ููุณ <a href="">ุจุฑูุงูุฌ ุชุดุบูู DS18S20</a> ุชูุฑูุจูุง.  ุงููุฑู ุงููุญูุฏ ูู ุทุฑููุฉ <code>precision</code> .  <em>ููุชุฑุถ</em> ููุง ุงูุณุงุฆููู <em>DS18ุ 20</em> ุฅูุดุงุก ุนุฏุฏ ุตุญูุญ ููุง ูุณุชุฎุฏู ุชูุณูู <em>ุงููุงุตูุฉ</em> ุงูุนุงุฆูุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">sdm.attr_add(drv, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>, <span class="hljs-string"><span class="hljs-string">"Precision (9|10|11|12)"</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dev, precision)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> attr = sdm.attr_dev_handle(dev, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sdm.attr_data(attr) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dev, precision)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> par = sdm.device_parent(dev) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> attr = sdm.attr_dev_handle(dev, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> ex = sdm.method_func(sdm.method_dev_handle(par, <span class="hljs-string"><span class="hljs-string">"exchange"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> modes = {[<span class="hljs-number"><span class="hljs-number">9</span></span>]=<span class="hljs-number"><span class="hljs-number">0x1f</span></span>, [<span class="hljs-number"><span class="hljs-number">10</span></span>]=<span class="hljs-number"><span class="hljs-number">0x3f</span></span>, [<span class="hljs-number"><span class="hljs-number">11</span></span>]=<span class="hljs-number"><span class="hljs-number">0x5f</span></span>, [<span class="hljs-number"><span class="hljs-number">12</span></span>]=<span class="hljs-number"><span class="hljs-number">0x7f</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> modes[precision] ~= <span class="hljs-literal"><span class="hljs-literal">nil</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> ex(par, dev, {<span class="hljs-number"><span class="hljs-number">0x4e</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, modes[precision]}) sdm.attr_set(attr, precision) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> )</code> </pre> <br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/er/lj/gb/erljgbs9zby8767izkmsunyhdd8.png"></a> </p><br><h2 id="memory-usage" style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุฐุงูุฑุฉ ุญุฑุฉ <em>ESP8266</em> ุญูุงูู <em>40</em> <em>ูููู</em> .  ูุชู ููู ุฑูุฒ ุงูุฎุงุฏู ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://gitlab.com/matsievskiysv/nodemcu-">LFS</a> ุ ูุฐูู ูุง ูุณุชุบุฑู ุฃู ูุณุงุญุฉ RAM ูู ููุช ุงูุชููุฆุฉ (ุงุณุชุบุฑู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://github.com/marcoskirsch/nodemcu-">ุงูุฑูุฒ ุงูุฃุตูู</a> ุญูุงูู <em>10 ูููู</em> ). </p><br><p style=";text-align:right;direction:rtl">  <em>SDM</em> ูุณุชุบุฑู ุญูุงูู <em>10k</em> ููุฏุฉ 5 ุจุฑุงูุฌ ุชุดุบูู ุงูุฌูุงุฒ ู 5 ุฃุฌูุฒุฉ.  ุฃูู ููููุงู ูุจูุงุก ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ุบูุฑ ุงูุนุงุฆูุฉ.  ูุฐูู ูู ุงูุฃูุถู ุชุญุฏูุฏ ุจุฑุงูุฌ ุงูุชุดุบูู ุงููุทููุจุฉ ููุท ูููููุฉ ูู ูุชูุงูู ุงููุฏ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจูุงู ุจุฑูุงูุฌ</a> ุงูุชุดุบูู.  ุงููููุฉ ุงูุฃูุซุฑ ุงุณุชููุงููุง ููุฐุงูุฑุฉ ูู ุฎุฏูุฉ ููุชุจุฉ <code>vue.js</code> </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/yy/u-/_i/yyu-_idkp2osapmg3-jy5z2r8ly.png"></a> </p><br><p style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ุทูุจ ุจูุงูุงุช <em>JSON ุบูุฑ</em> ูุดูุฑุฉ (ุจุงุณุชุฎุฏุงู <code>curl</code> ) ุ ูุฏ ููุฎูุถ โโุงุณุชููุงู ุงูุฐุฑูุฉ ูู ุงูุฐุงูุฑุฉ ุจุดูู ูุจูุฑ. </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/w_/hu/xx/w_huxxzt4w2wszdqq04bgbonbt0.png"></a> </p><br><h2 id="instead-of-an-epilogue" style=";text-align:right;direction:rtl">  ุจุฏูุง ูู ุฎุงุชูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุฅุญุฏู ุงูุทุฑู ุงูุฃููู ุงูุชู ุทุจูุชูุง ุจุงุณุชุฎุฏุงู sdm ูู ุงูุฑุจุท ูู <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>node.restart()</code></a> . <br>  ุชุฌุฑุจุฉ ุฐูู ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ูุณุชุฎุฏู ุงูููุจ ุฃูุชุฌุช ูุชูุฌุฉ ุบุฑูุจุฉ.  ูุจุงุดุฑุฉ ุจุนุฏ ุฅุตุฏุงุฑ ูุชุตูุญ ุงูููุจ ููุทูุจ ุ ุชูุช ุฅุนุงุฏุฉ ุชุดุบูู ุงูุดุฑูุญุฉ ููุง ูู ูุชููุน.  ูููู ูุธุฑูุง ูุฃู NodeMCU ูู ูุณุชุฌุจ ุจุดูู ุตุญูุญ ูุทูุจ HTTP ุ ุฌุฑุจ ูุชุตูุญ ุงูููุจ ููุณ ุงูุทูุจ ูุฑุฉ ุฃุฎุฑู.  ุนูุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุฎุงุฏู NodeMCU ููุงู ููุฏ ุงูุชุดุบูู ูุฑุฉ ุฃุฎุฑู ุ ูุชุตูุญ ูุชุตู ุจู ุ ุฅุนุงุฏุฉ ุชุนููู <em>ุงููุญุงููุฉ</em> ุงูุฏุงุฎููุฉ <em>ูุฑุฉ ุฃุฎุฑู</em> ุงูุนุฏุงุฏ ูุฏุนุง ุงูุฃุณููุจ <code>node.restart()</code> ุ ูุจุงูุชุงูู ุจุฏุก ุญููุฉ ูุง ููุงุฆูุฉ ูู ุฅุนุงุฏุฉ ุชุดุบูู NodeMCU. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar449992/">https://habr.com/ru/post/ar449992/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar449976/index.html">ุญุงููุงุช ุงูุฌูุนูุงุช ูุชุนุฏุฏุฉ ูุคุดุฑุงุช ุงูุชุฑุงุจุท ูู C ++. ุชูุฑูุฑ ูุงูุฏูุณ</a></li>
<li><a href="../ar449978/index.html">ูุตุงุฑุน ุฅูุฌูุฑ ุฃูุชุงุฑูู ูู ูุงุฏู ุชุณูุง ุจููุณูู 20 ุฃุณุทูุฑุฉ ุนู ุชุณูุง ูุงูุณูุงุฑุงุช ุงูููุฑุจุงุฆูุฉ</a></li>
<li><a href="../ar449984/index.html">ุฃุฎุจุงุฑ Google ู ููู ุชููุณุชูู: ุชุตูุฑ ุญููุงุช ุฒูุงู ูููุฉ Word2Vec ุจุงุณุชุฎุฏุงู t-SNE</a></li>
<li><a href="../ar449986/index.html">Blockchain: ูุงุฐุง ูุฌุจ ุฃู ูุจูู ุญุงูุฉุ</a></li>
<li><a href="../ar449990/index.html">ููููุฉ ุชูููู ุตุฏุงูุงุช ุงููุงุชูุณ ูุงูุตูุบ ูุงูุญุจุฑุ</a></li>
<li><a href="../ar449994/index.html">ุณุชุณุงุนุฏู ุงูููุงุนุฏ ุงูุฐูุจูุฉ ุงูุซูุงููุฉ ูุดูุงูุฏุฑูุงู ุนูู ุฅูุดุงุก ูุงุฌูุฉ ุฃูุถู</a></li>
<li><a href="../ar449996/index.html">ููู ุฎูุงุฑุฒููุฉ FFT</a></li>
<li><a href="../ar449998/index.html">ุฃุณุฆูุฉ ูุฃุฌูุจุฉ: ูุง ูุญุชุงุฌ ุงููุณุงูุฑ ุฅูู ูุนุฑูุชู ุญูู ุงูููุงุญุงุช ูุจู ุงูุณูุฑ</a></li>
<li><a href="../ar450000/index.html">(ูู ุงููููู ุฅูู ุงููุณุงุฑ (ูู ุฎูุงู ุงููุธุฑ ุงูุฒุฌุงุฌ</a></li>
<li><a href="../ar450002/index.html">ุงูุจุญุซ ุนู ุงูุฃุฎุทุงุก ูู LLVM 8 ุจุงุณุชุฎุฏุงู PVS-Studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>