<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè© üòØ üöÇ "Je ne vois aucune raison d'utiliser Python pour travailler avec Spark, √† part la paresse" üåá üèóÔ∏è üë©üèæ‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'autre jour, nous avons d√©cid√© de parler avec Dmitry Bugaychenko ( dmitrybugaychenko ), l'un de nos professeurs du programme d'analyse de donn√©es sur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"Je ne vois aucune raison d'utiliser Python pour travailler avec Spark, √† part la paresse"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/newprolab/blog/442812/"><p>  L'autre jour, nous avons d√©cid√© de parler avec Dmitry Bugaychenko ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">dmitrybugaychenko</a> ), l'un de nos professeurs du programme d'analyse de donn√©es sur Scala, et de discuter avec lui des probl√®mes r√©els d'utilisation de Scala dans les t√¢ches de science des donn√©es et d'ing√©nierie des donn√©es.  Dmitry est ing√©nieur analytique √† Odnoklassniki. </p><br><p><img src="https://habrastorage.org/webt/6h/7b/ut/6h7butyls-jgjkhi1plmqmd9gxy.jpeg" alt="image"></p><a name="habracut"></a><br><p>  <strong>- Dima, tu travailles √† Odnoklassniki.</strong>  <strong>Dites-moi, que faites-vous l√†-bas?</strong> <strong><br></strong> <br>  √Ä Odnoklassniki, j'ai commenc√© √† travailler en 2011 sur un projet de recommandation musicale.  C'√©tait une t√¢che tr√®s int√©ressante et difficile - la plupart des services de recommandation musicale √† cette √©poque √©taient bas√©s sur du contenu de publication bien catalogu√©, alors que nous avions un vrai UGC (contenu g√©n√©r√© par l'utilisateur), qui devait d'abord √™tre peign√© et tri√© en √©tag√®res.  En g√©n√©ral, le syst√®me r√©sultant s'est r√©v√©l√© assez bon et ils ont d√©cid√© d'√©tendre l'exp√©rience √† d'autres sections du site: recommandations de groupe, amiti√©s, classement du flux, etc.  Parall√®lement, l'√©quipe s'est agrandie, l'infrastructure s'est d√©velopp√©e, de nouveaux algorithmes et technologies ont √©t√© introduits.  Maintenant, j'ai un √©ventail assez large de responsabilit√©s: coordination des donn√©es des scientifiques, d√©veloppement de l'infrastructure DS, projets de recherche, etc. </p><br><p>  <strong>- Depuis combien de temps utilisez-vous Spark?</strong>  <strong>Quel est le besoin?</strong> </p><br><p>  Les premi√®res tentatives de se faire des amis avec Spark remontaient √† 2013, mais sans succ√®s.  Nous avions un besoin urgent d'un puissant outil interactif qui nous permettait de tester rapidement des hypoth√®ses, mais Spark de cette √©poque ne pouvait pas fournir la stabilit√© et l'√©volutivit√© dont nous avions besoin.  La deuxi√®me tentative que nous avons faite un an plus tard, en 2014, et cette fois, tout s'est bien pass√©.  La m√™me ann√©e, nous avons commenc√© √† mettre en ≈ìuvre des outils d'analyse de streaming bas√©s sur Kafka et Samza, avons essay√© Spark Streaming, mais cela n'a pas pu d√©marrer.  En raison de la mise en ≈ìuvre relativement pr√©coce, en 2017, nous √©tions en mesure de rattraper un certain temps - une grande quantit√© de code sur le premier Spark nous a emp√™ch√© de passer au second, mais √† l'√©t√© 2018, nous avons r√©solu ce probl√®me et travaillons maintenant sur 2.3.3.  Dans cette version, le streaming a d√©j√† fonctionn√© plus stable et nous avons d√©j√† fait de nouvelles t√¢ches de production dessus. </p><br><p>  <strong>- Si je comprends bien, vous utilisez l'API Scala, pas Python, comme la plupart.</strong>  <strong>Pourquoi</strong> </p><br><p>  Je ne vois sinc√®rement aucune raison d'utiliser Python pour travailler avec Spark, sauf pour la paresse.  L'API Scala est plus flexible et beaucoup plus efficace, mais pas plus compliqu√©e.  Si vous utilisez les fonctionnalit√©s standard de Spark SQL, le code Scala est presque identique au code Python correspondant et la vitesse sera identique.  Mais si vous essayez de cr√©er la fonction d√©finie par l'utilisateur la plus simple, la diff√©rence devient √©vidente - le travail du code Scala reste aussi efficace, et le code Python transforme un cluster multic≈ìur en citrouille et commence √† br√ªler des kilowatts / heures pour une activit√© compl√®tement improductive.  √Ä l'√©chelle avec laquelle nous devons travailler, nous ne pouvons tout simplement pas nous permettre un tel gaspillage. </p><br><p>  <strong>- C Python est compr√©hensible.</strong>  <strong>Et par rapport √† Java, Scala est-il quelque chose de mieux pour l'analyse des donn√©es?</strong>  <strong>En Java, beaucoup de choses sont √©crites dans la pile de Big Data.</strong> </p><br><p> Nous utilisons Java tr√®s largement, y compris dans l'apprentissage automatique.  Nous essayons de ne pas nous lancer dans les applications Scala les plus charg√©es.  Mais en mati√®re d'analyse interactive et de prototypage rapide, le laconicisme de Scala devient un plus.  Certes, vous devez toujours garder √† l'esprit que lors de la programmation dans Scala, il est tr√®s facile de tirer les jambes jusqu'aux oreilles - de nombreux mod√®les peuvent ne pas se comporter comme vous vous attendez d'une position de bon sens, et certaines op√©rations simples provoquent des copies inutiles et des tentatives de mat√©rialisation jeux de donn√©es en m√©moire. </p><br><p>  <strong>- Avec tous ces avantages, pourquoi Scala n'est-il pas encore si populaire?</strong>  <strong>Surpasse-t-il clairement Python et Java?</strong> </p><br><p>  Scala est un outil tr√®s puissant qui n√©cessite une qualification suffisamment √©lev√©e de celui qui l'utilise.  De plus, avec le d√©veloppement en √©quipe, des exigences suppl√©mentaires sont √©galement impos√©es au niveau g√©n√©ral de la culture de d√©veloppement: le code sur Scala est tr√®s facile √† √©crire, mais pas toujours lu avec succ√®s par l'auteur apr√®s un certain temps, et sous le capot d'une API simple, il peut cr√©er une sorte de jeu.  Par cons√©quent, une attention particuli√®re doit √™tre accord√©e au maintien d'un style unifi√©, de tests fonctionnels et de stress de la solution. </p><br><p>  Eh bien, lorsque l'on compare les langages JVM, on ne peut que mentionner Kotlin - il gagne en popularit√©, est consid√©r√© par beaucoup comme plus ¬´v√©rifi√© id√©ologiquement¬ª, et prend m√™me en charge Spark dans le cadre du projet sparklin, bien qu'il soit encore tr√®s limit√©.  Nous-m√™mes ne l'utilisons pas encore pour Spark, mais nous suivons de pr√®s l'√©volution. </p><br><p>  <strong>- Retour √† Spark.</strong>  <strong>Si je comprends bien, vous n'aimiez toujours pas cette fonctionnalit√© de l'API Scala et vous avez √©crit une sorte de fork pour Spark?</strong> </p><br><p>  Il serait faux d'appeler notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fork de</a> projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PravdaML</a> : cette biblioth√®que ne remplace pas, mais compl√®te la fonctionnalit√© SparkML avec de nouvelles fonctionnalit√©s.  Nous sommes arriv√©s aux d√©cisions qui y ont √©t√© mises en ≈ìuvre, en essayant de mettre √† l'√©chelle et de mettre sur les rails reproductibles les mod√®les de classement des bandes.  Le fait est que lors du d√©veloppement d'algorithmes efficaces d'apprentissage automatique distribu√©, vous devez prendre en compte de nombreux facteurs ¬´techniques¬ª: comment d√©composer correctement les donn√©es en n≈ìuds, √† quel moment mettre en cache, sous-√©chantillonner, etc.  Il n'y a aucun moyen de g√©rer ces aspects dans le SparkML standard, et ils doivent √™tre d√©plac√©s au-del√† du pipeline ML, ce qui affecte n√©gativement la g√©rabilit√© et la reproductibilit√©. </p><br><p>  <strong>- Je me souviens que tu avais deux options pour le nom ...</strong> </p><br><p>  Oui, le nom d'origine ok-ml-pipelines semblait ennuyeux pour les gars, nous sommes donc en train de ¬´rebranding¬ª avec le nouveau nom PravdaML. </p><br><p>  <strong>- Beaucoup de gens l'utilisent en dehors de votre √©quipe?</strong> </p><br><p>  Je ne pense pas beaucoup, mais nous y travaillons.  J </p><br><p>  <strong>- Parlons des r√¥les et des professions dans le domaine du travail avec les donn√©es.</strong>  <strong>Dites-moi, un scientifique des donn√©es devrait-il √©crire du code en production ou est-ce d√©j√† un autre m√©tier et r√¥le?</strong> <strong><br></strong> <br>  La r√©ponse √† cette question est mon avis, et il y a une dure r√©alit√©.  J'ai toujours cru que pour une impl√©mentation r√©ussie des solutions ML, une personne doit comprendre o√π et pourquoi tout cela est impl√©ment√© (qui est l'utilisateur, quels sont ses besoins et quels besoins l'entreprise a), il doit comprendre quelles m√©thodes math√©matiques peuvent √™tre appliqu√©es pour d√©velopper la solution, et comment ces m√©thodes peuvent fonctionner d'un point de vue technique.  Par cons√©quent, √† Odnoklassniki, nous essayons toujours d'adh√©rer au mod√®le de la responsabilit√© unique, lorsqu'une personne propose une initiative, la met en ≈ìuvre et la met en ≈ìuvre.  Bien s√ªr, pour r√©soudre des probl√®mes priv√©s individuels, qu'il s'agisse d'un SGBD efficace ou d'une mise en page interactive, vous pouvez toujours attirer des personnes ayant une vaste exp√©rience dans ces domaines, mais l'int√©gration de tout cela dans un seul m√©canisme reste avec le scientifique, en tant que personne qui comprend le mieux exactement quoi et comment cela devrait fonctionner. sortie. </p><br><p>  Mais il existe √©galement une dure r√©alit√© sur le march√© du travail, qui est d√©sormais tr√®s surchauff√© dans le domaine du blanchiment d'argent, ce qui conduit √† ce que de nombreux jeunes sp√©cialistes ne jugent pas n√©cessaire d'√©tudier autre chose que le blanchiment lui-m√™me.  En cons√©quence, il devient de plus en plus difficile de trouver un sp√©cialiste du cycle complet.  Bien qu'une bonne alternative soit apparue r√©cemment: la pratique a montr√© que les bons programmeurs apprennent le ML assez rapidement et assez bien.  J </p><br><p>  <strong>- L'ing√©nieur de datation a besoin de conna√Ætre Scala?</strong>  <strong>Comment √ßa va au fait?</strong>  <strong>Dois-je entrer dans la jungle de la programmation fonctionnelle?</strong> </p><br><p>  Il est absolument n√©cessaire de conna√Ætre Scala, ne serait-ce que parce que deux outils fondamentaux tels que Kafka et Spark sont √©crits dessus, et vous devez pouvoir lire leur code source.  Quant √† la ¬´jungle de la programmation fonctionnelle¬ª, je leur d√©conseille fortement d'en abuser: plus les d√©veloppeurs peuvent lire et comprendre le code, mieux c'est.  M√™me si pour cela il faut parfois d√©ployer un design fonctionnel ¬´√©l√©gant¬ª dans un cycle banal. </p><br><p>  <strong>- L'univers des m√©tiers dans ce domaine a d√©j√† cess√© de s'√©tendre, ou faut-il encore attendre l'√©mergence de nouveaux m√©tiers?</strong> </p><br><p>  Je pense que dans un avenir pr√©visible en ML et DS, il y aura un tournant li√© √† l'automatisation: les principaux mod√®les que les gens suivent lorsqu'ils travaillent avec des attributs, choisissent un mod√®le et ses param√®tres et v√©rifient la qualit√© seront automatis√©s.  Cela conduira au fait que la demande de sp√©cialistes qui ¬´s√©lectionnent les param√®tres¬ª diminuera consid√©rablement, mais les ing√©nieurs AutoML capables de mettre en ≈ìuvre et de d√©velopper des solutions automatis√©es seront en demande. </p><br><p>  <strong>"Vous enseignez activement, si je comprends bien."</strong>  <strong>Pourquoi consid√©rez-vous cela important?</strong>  <strong>Quelle est la motivation derri√®re cela?</strong> </p><br><p>  Nous allons tous un jour prendre notre retraite et la qualit√© de notre vie d√©pendra grandement de qui nous remplacera.  Par cons√©quent, l'investissement dans l'√©ducation de la prochaine g√©n√©ration est l'un des plus importants. </p><br><p>  <strong>- Sur notre programme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Data Analysis on Scala"</a> vous animerez plusieurs cours.</strong>  <strong>Parlez-moi bri√®vement d'eux.</strong>  <strong>Quelle est leur importance?</strong> </p><br><p>  Dans ces cours, nous √©tudierons simplement comment l'ing√©nierie et les math√©matiques s'imbriquent: comment organiser correctement le processus, sans introduire de barri√®res inutiles √† ETL-&gt; ML-&gt; Prod.  Le cours sera construit autour des capacit√©s de Spark ML: concepts de base, conversions prises en charge, algorithmes impl√©ment√©s et leurs limites.  Nous aborderons la zone o√π les fonctionnalit√©s SparkML existantes ne sont pas suffisantes, et il devient n√©cessaire d'utiliser des extensions telles que PravdaML.  Eh bien, il y aura certainement de la pratique, non seulement au niveau de ¬´l'assemblage d'une solution √† partir de cubes pr√™ts √† l'emploi¬ª, mais aussi sur la fa√ßon de comprendre qu'un nouveau ¬´cube¬ª est n√©cessaire ici et comment le mettre en ≈ìuvre. </p><br><p>  <strong>- Y a-t-il un jeu de mots pr√©f√©r√© avec Scala?</strong>  <strong>Mur d'escalade, grimpeur, art rupestre - utilisez-vous dans votre routine quotidienne?</strong> </p><br><p>  √Ä moins que l'√©pith√®te ¬´indoskal¬ª, que nous utilisons pour aborder des morceaux d'open source particuli√®rement remarquables, dont l'auteur voulait clairement d√©montrer la capacit√© remarquable de construire du code illisible en utilisant des abstractions fonctionnelles. </p><br><p>  <strong>- Moscou ou Peter?</strong> </p><br><p>  Chaque ville a son zeste.  Moscou est une ville riche et bien entretenue avec un rythme rapide.  Peter est plus calme et rempli du charme de l'ancienne capitale europ√©enne.  Par cons√©quent, j'aime venir √† Moscou pour visiter, mais je pr√©f√®re vivre √† Saint-P√©tersbourg. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr442812/">https://habr.com/ru/post/fr442812/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr442800/index.html">Bot Telegram simple en Python en 30 minutes</a></li>
<li><a href="../fr442804/index.html">MVCC-1. L'isolement</a></li>
<li><a href="../fr442806/index.html">Le programme pr√©liminaire DUMP-2019 est pr√™t. Intervenants de Evil Martians, Tinkoff.ru, HTML Academy, SkyEng, 2GIS</a></li>
<li><a href="../fr442808/index.html">Nous vous invitons √† la Droid Party - une r√©union consacr√©e aux probl√®mes pratiques de d√©veloppement d'applications et d'appareils Android</a></li>
<li><a href="../fr442810/index.html">Mythes de la physique populaire, suite: gravit√©</a></li>
<li><a href="../fr442814/index.html">10 ans se sont √©coul√©s, et personne n'a compris comment utiliser la blockchain. Et l√† encore?</a></li>
<li><a href="../fr442816/index.html">Cr√©ez votre propre contr√¥leur de jeu</a></li>
<li><a href="../fr442818/index.html">10 erreurs courantes en anglais √©crit et comment y faire face</a></li>
<li><a href="../fr442820/index.html">Coroutines personnalis√©es dans Unity avec pr√©f√©rence et courtisanes</a></li>
<li><a href="../fr442822/index.html">Centre de donn√©es en mer et en orbite: ont-ils une signification pratique?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>