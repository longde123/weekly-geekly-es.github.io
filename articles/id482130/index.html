<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🈵 🎙️ 🏖️ Penugasan skala besar hak untuk pengguna domain dari hutan yang berbeda 👋🏽 🎸 🎣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rupanya karma saya adalah ini: menerapkan tugas-tugas standar dalam segala macam cara yang tidak sepele. Jika seseorang memiliki visi yang berbeda ten...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Penugasan skala besar hak untuk pengguna domain dari hutan yang berbeda</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482130/">  Rupanya karma saya adalah ini: menerapkan tugas-tugas standar dalam segala macam cara yang tidak sepele.  Jika seseorang memiliki visi yang berbeda tentang masalah - saya meminta diskusi, untuk menyelesaikan masalah tersebut. <br><br>  Suatu pagi yang cerah, tugas yang menarik muncul: untuk mendistribusikan hak kepada kelompok pengguna pada bola yang berbeda yang berisi subfolder proyek dengan folder dokumen.  Semuanya baik-baik saja dan skrip ditugaskan menetapkan hak ke folder.  Dan kemudian ternyata kelompok-kelompok tersebut harus berisi pengguna domain yang berbeda, dari hutan yang berbeda ( <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25B5%25D1%2580%25D0%25B0%25D1%2580%25D1%2585%25D0%25B8%25D1%258F_%25D0%25BE%25D0%25B1%25D1%258A%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D0%25B2_Active_Directory">bagi mereka yang lupa apa itu</a> ).  Misalkan bola itu sendiri di-host di media Synology terdaftar di domain FB dari hutan PSI.  Tujuan: untuk memungkinkan pengguna domain di hutan lain memiliki akses ke konten bola ini, dan sangat selektif. <br><a name="habracut"></a><br>  TK setelah beberapa saat tampak dalam bentuk berikut: <br><br><ul><li>  2 hutan: Hutan PSI, Hutan TG. <br><br><img src="https://habrastorage.org/webt/wm/mu/ky/wmmukygta6ggezns9okz4nypuqq.png" alt="gambar"></li><li>  Setiap hutan memiliki 3 domain: PSI (ZG, PSI, FB);  TG (TG, HU, KC). </li><li>  Ada hubungan saling percaya antara hutan, Synology melihat semua kelompok Keamanan di semua hutan. </li><li>  Balon dan folder / subfolder harus memiliki akun admin domain FB dengan hak Kontrol Penuh </li><li>  Nama folder balon harus disistematisasikan.  Manajemen sedang menegosiasikan ID proyek. Saya memutuskan untuk menetapkan nama kelompok Keamanan ke ID proyek. </li><li>  Folder proyek dalam bola sistem harus berisi struktur yang disiapkan sebelumnya dalam file .xlsx, dengan hak akses yang sesuai (R / RW / NA, di mana NA - tidak ada akses) <br><br><img src="https://habrastorage.org/webt/3a/py/vo/3apyvo-2q-qkg7td0pnw-rqpvdy.png" alt="gambar"></li><li>  Seharusnya dimungkinkan untuk membatasi hak pengguna / anggota grup dari satu proyek hanya pada direktori tertentu dari proyek ini.  Pengguna mungkin tidak memiliki akses ke direktori / proyek lain, sesuai dengan keanggotaan grup. </li><li>  Saat membuat folder proyek, grup dalam domain yang sesuai dengan nama ID proyek yang sesuai harus dibuat secara otomatis. </li></ul><br><h4>  Catatan untuk ToR </h4><br><ul><li>  Hubungan yang membangun kepercayaan bukan bagian dari TK </li><li>  ID Proyek berisi angka dan huruf Latin </li><li>  Peran pengguna proyek untuk semua domain memiliki nama generik </li><li>  File .xlsx dengan folder dan izin (matriks akses) disiapkan sebelum dimulainya seluruh proyek </li><li>  Saat mengimplementasikan proyek, dimungkinkan untuk membuat grup pengguna di domain yang sesuai </li><li>  Otomatisasi dicapai dengan menggunakan alat administrasi MS Windows standar </li></ul><br><h4>  Implementasi TK </h4><br>  Setelah memformalkan persyaratan ini, jeda taktis diambil untuk menguji metode membuat direktori dan memberikan hak kepada mereka.  Seharusnya hanya menggunakan PowerShell, agar tidak menyulitkan proyek.  Seperti yang saya tulis sebelumnya, algoritma skrip tampak cukup sederhana: <br><br><ul><li>  daftar grup dengan nama yang berasal dari ID proyek (misalnya, KC40587) dan peran terkait yang ditunjukkan dalam matriks akses: KC40587-EN- untuk insinyur;  KC40587-PM - untuk manajer produk, dll. </li><li>  dapatkan SID dari grup yang dibuat </li><li>  mendaftarkan folder proyek dan set direktori yang sesuai (daftar subfolder tergantung pada bola di mana ia dibuat dan didefinisikan dalam matriks akses) </li><li>  menetapkan hak untuk grup sesuai dengan matriks akses ke subdirektori baru proyek. </li></ul><br>  Kesulitan yang ditemui pada tahap 1: <br><br><ul><li>  kurangnya pemahaman tentang cara mengatur matriks akses dalam skrip (array multidimensi sekarang diterapkan, tetapi cara untuk mengisinya dicari berdasarkan konten file .xlsx file / akses matriks) <br><br><img src="https://habrastorage.org/webt/bx/zq/rk/bxzqrkid29fvb3dt3qvykqlgb1i.png" alt="gambar"></li><li>  ketidakmungkinan menetapkan hak akses pada bola SMB pada drive synology menggunakan PoSH (https://social.technet.microsoft.com/Forums/en-US/3f1a949f-0919-46f1-9e10-89256cf07e65/error-using-setacl-on-nas -share? forum = winserverpowershell), karena itu banyak waktu yang hilang dan saya harus menyesuaikan semuanya dengan skrip menggunakan utilitas pengeditan izin icacls, yang membutuhkan penciptaan gudang teks dan file cmd perantara. </li></ul><br>  Dalam mode saat ini, eksekusi file-file cmd dikendalikan secara manual, pada kenyataan kebutuhan untuk mendaftarkan folder untuk proyek. <br><br><img src="https://habrastorage.org/webt/1p/zz/a4/1pzza4mxf3tssw6klg8elt8k_le.png" alt="gambar"><br><br>  Ternyata juga skrip harus dieksekusi, termasuk untuk mendaftarkan grup di hutan lain (mereka menggunakan istilah Cross-domains), dan rasionya bisa tidak hanya 1 banding satu, tetapi 1 untuk banyak. <br><br><img src="https://habrastorage.org/webt/0s/a0/bd/0sa0bd8melox5vdkjihq_fdudou.png" alt="gambar"><br><br>  Ini berarti bahwa kelompok-kelompok dari lintas-domain lain, termasuk hutan tetangga, sekarang dapat mengklaim akses ke sumber daya suatu domain.  Untuk mencapai keseragaman, diputuskan untuk membuat struktur simetris dalam OU dari semua domain yang dilayani dari semua hutan (oval vertikal hitam).  Seperti yang mereka katakan, dalam tentara semuanya harus jelek, tetapi seragam: <br><br><img src="https://habrastorage.org/webt/jd/yw/xm/jdywxmilhxenmbyiwjj7xerjfto.png" alt="gambar"><br><br>  Jadi, ketika mendaftarkan proyek 80XXX di domain TG, skrip mengeksekusi: <br><br>  1. Pembuatan OU yang sesuai (oval horisontal merah) di domain ini dan lintas-domain, yaitu domain-domain yang karyawannya harus memiliki akses ke sumber daya ini. <br><br>  2. mengisi OU dengan grup dengan nama formulir &lt;SRC_ domain&gt; &lt;DST_domain&gt; &lt;ID_project&gt; -, di mana: <br><br><ul><li>  SRC_ domain - domain-silang yang karyawannya akan memiliki akses ke sumber daya domain DST </li><li>  DST_domain - domain, ke sumber daya yang, pada kenyataannya, akses harus diberikan, yaitu, untuk yang semuanya dimulai </li><li>  &lt;ID_project&gt; - nomor proyek </li><li>  GULA - nama-nama peran yang tercantum dalam matriks akses. </li></ul><br>  3. membaca susunan SID dari semua grup dari semua domain yang terlibat dan menyimpannya untuk transfer data selanjutnya ke file yang menentukan hak untuk subfolder proyek tertentu <br><br>  4. pembuatan file sumber (parameter / restore) dengan seperangkat izin untuk menggunakan utilitas icacKC dalam mode file yang dapat dieksekusi “icacKC" \\ as-nasNN \ KC \ Projects "/ restore C: \ Temp \ KC \ KC40XX \ KC40XX.txt" <br><br>  5. membuat file CMD yang menggabungkan semua icacl yang diluncurkan untuk semua folder proyek <br><br><img src="https://habrastorage.org/webt/hr/ik/8d/hrik8d5grjq9t45vvgwua2krgic.png" alt="gambar"><br><br>  Seperti yang telah ditulis sebelumnya, file yang dapat dieksekusi diluncurkan secara manual dan evaluasi hasil eksekusi juga dilakukan secara manual. <br><br>  Kesulitan yang ditemui pada akhirnya: <br><br><ul><li>  jika folder proyek sudah diisi dengan sejumlah besar file, maka mengerjakan perintah icacls pada volume yang tersedia dapat memakan waktu yang cukup lama, dan dalam beberapa kasus menyebabkan kegagalan (misalnya, jika ada jalur file yang panjang); </li><li>  selain opsi / restore, saya harus menambahkan baris dengan opsi / reset jika folder tidak dibuat, tetapi ditransfer dari folder yang sudah ada sebelumnya, dengan hak warisan dimatikan dari root; </li><li>  bagian dari skrip untuk membuat grup harus dieksekusi pada as sembarang dari masing-masing hutan, masalahnya menyangkut akun administratif untuk setiap pohon. </li></ul><br>  Kesimpulan umum: sangat aneh bahwa belum ada utilitas dengan fungsi serupa di pasaran.  Tampaknya mungkin untuk mengimplementasikan fungsionalitas tersebut berdasarkan portal Sharepoint. <br>  Ini juga memberikan fakta yang tidak dapat dimengerti bahwa tidak mungkin untuk menggunakan utilitas PoSH untuk mengatur izin pada folder pada perangkat sinologi. <br><br>  Akan, saya siap untuk berbagi skrip dengan membuat semacam proyek di github, jika menarik bagi siapa pun. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id482130/">https://habr.com/ru/post/id482130/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id482108/index.html">Kecerdasan yang tenang. Metode untuk mengidentifikasi potensi kerentanan WEB</a></li>
<li><a href="../id482110/index.html">Linux berjalan di kartu bisnis saya</a></li>
<li><a href="../id482114/index.html">Kirim email menggunakan asyncio dan aiohttp dari aplikasi Django</a></li>
<li><a href="../id482126/index.html">Ulasan keras untuk TensorFlow</a></li>
<li><a href="../id482128/index.html">gReebok terdeteksi. Dermatovenerolog sendiri</a></li>
<li><a href="../id482132/index.html">Salinan Tesla Cybertruck ditemukan di Moskow. Ini adalah ... Rusia LADA Samara</a></li>
<li><a href="../id482134/index.html">Perbandingan hibrida atau apa yang diharapkan pemilik headphone Meze Rumania untuk 84 990 dan 239 990 rubel</a></li>
<li><a href="../id482136/index.html">Bagaimana proyek monobrand bisa masuk ke TOP dengan mengalahkan agregator dan layanan internal mesin pencari?</a></li>
<li><a href="../id482140/index.html">Permainan papan untuk programmer muda berusia 4-10 tahun. Apa yang bisa ditemukan di pasaran pada akhir 2019</a></li>
<li><a href="../id482142/index.html">23 menit Pembenaran yang cerdik</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>