<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤ğŸ½ ğŸ¤›ğŸ½ ğŸï¸ ç±»JavaScript JavaScriptåºåˆ—åŒ–æ”¯æŒ â›¹ğŸ½ ğŸ’µ ğŸ¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åºè¨€ 


 å½“å‰ï¼Œæˆ‘æ­£åœ¨å¼€å‘Javascriptæ¨¡å¼ç¼–è¾‘å™¨ï¼Œåœ¨æ­¤å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†æœ¬æ–‡å°†è¦è§£å†³çš„é—®é¢˜ï¼Œå³å¤æ‚æ•°æ®å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ 


åœ¨ä¸æ¶‰åŠé¡¹ç›®ç»†èŠ‚çš„æƒ…å†µä¸‹ï¼Œæˆ‘æ³¨æ„åˆ°æ ¹æ®æˆ‘çš„æƒ³æ³•ï¼Œæ–¹æ¡ˆæ˜¯ä»åŸºç±»ç»§æ‰¿çš„å…ƒç´ ï¼ˆé¡¶ç‚¹ï¼‰çš„æ•°ç»„ã€‚ å› æ­¤ï¼Œæ¯ä¸ªå­ç±»éƒ½å®ç°å…¶è‡ªå·±çš„é€»è¾‘ã€‚ æ­¤å¤–ï¼Œé¡¶ç‚¹åŒ…å«å½¼æ­¤çš„é“¾æ¥ï¼ˆç®­...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç±»JavaScript JavaScriptåºåˆ—åŒ–æ”¯æŒ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413113/"><h3 id="prolog"> åºè¨€ </h3><br><p> å½“å‰ï¼Œæˆ‘æ­£åœ¨å¼€å‘Javascriptæ¨¡å¼ç¼–è¾‘å™¨ï¼Œåœ¨æ­¤å·¥ä½œè¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†æœ¬æ–‡å°†è¦è§£å†³çš„é—®é¢˜ï¼Œå³å¤æ‚æ•°æ®å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ </p><br><p>åœ¨ä¸æ¶‰åŠé¡¹ç›®ç»†èŠ‚çš„æƒ…å†µä¸‹ï¼Œæˆ‘æ³¨æ„åˆ°æ ¹æ®æˆ‘çš„æƒ³æ³•ï¼Œæ–¹æ¡ˆæ˜¯ä»åŸºç±»ç»§æ‰¿çš„å…ƒç´ ï¼ˆé¡¶ç‚¹ï¼‰çš„æ•°ç»„ã€‚ å› æ­¤ï¼Œæ¯ä¸ªå­ç±»éƒ½å®ç°å…¶è‡ªå·±çš„é€»è¾‘ã€‚ æ­¤å¤–ï¼Œé¡¶ç‚¹åŒ…å«å½¼æ­¤çš„é“¾æ¥ï¼ˆç®­å¤´ï¼‰ï¼Œè¿™äº›é“¾æ¥ä¹Ÿéœ€è¦ä¿ç•™ã€‚ ä»ç†è®ºä¸Šè®²ï¼Œé¡¶ç‚¹å¯ä»¥ç›´æ¥å¼•ç”¨è‡ªå·±ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–é¡¶ç‚¹å¼•ç”¨ã€‚ æ ‡å‡†JSON.stringifyæ— æ³•åºåˆ—åŒ–è¿™æ ·çš„æ•°ç»„ï¼Œå› æ­¤æˆ‘å†³å®šåˆ›å»ºè‡ªå·±çš„åºåˆ—åŒ–ç¨‹åºæ¥è§£å†³ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼š </p><br><ol><li> èƒ½å¤Ÿåœ¨åºåˆ—åŒ–æœŸé—´ä¿å­˜ç±»ä¿¡æ¯ï¼Œå¹¶åœ¨ååºåˆ—åŒ–æœŸé—´æ¢å¤å®ƒã€‚ </li><li> ä¿å­˜å’Œè¿˜åŸå¯¹è±¡é“¾æ¥çš„èƒ½åŠ›ï¼ŒåŒ…æ‹¬ å¾ªç¯çš„ã€‚ </li></ol><br><p> é˜…è¯»æ›´å¤šæœ‰å…³è¯¥é—®é¢˜çš„é™ˆè¿°åŠå…¶è§£å†³æ–¹æ¡ˆçš„ä¿¡æ¯ã€‚ </p><a name="habracut"></a><br><h3 id="proekt-serializatora-na-github">  Githubåºåˆ—åŒ–å™¨é¡¹ç›® </h3><br><p> é“¾æ¥åˆ°githubé¡¹ç›®ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">link</a> ã€‚ <br> å¤æ‚çš„ç¤ºä¾‹ä¹Ÿä½äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">test-src</a>æ–‡ä»¶å¤¹ä¸­ã€‚ </p><br><p> é€’å½’åºåˆ—åŒ–å™¨ï¼š <a href="">link</a> ã€‚ <br> å¹³é¢åºåˆ—åŒ–å™¨ï¼š <a href="">link</a> ã€‚ </p><br><h3 id="postanovka-zadachi"> é—®é¢˜é™ˆè¿° </h3><br><p> æ­£å¦‚æˆ‘å·²ç»æŒ‡å‡ºçš„ï¼Œæœ€åˆçš„ä»»åŠ¡æ˜¯ä¸ºç¼–è¾‘å™¨åºåˆ—åŒ–ä»»æ„ç”µè·¯ã€‚ ä¸ºäº†ä¸æµªè´¹æ—¶é—´æè¿°ç¼–è¾‘å™¨ï¼Œæˆ‘ä»¬å°†ä»»åŠ¡è®¾ç½®å¾—æ›´å®¹æ˜“ã€‚ å‡è®¾æˆ‘ä»¬è¦ä½¿ç”¨ES6 Javascriptç±»å¯¹ç®€å•ç®—æ³•æ–¹æ¡ˆè¿›è¡Œæ­£å¼æè¿°ï¼Œç„¶åå¯¹è¯¥æ–¹æ¡ˆè¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ </p><br><p> åœ¨äº’è”ç½‘ä¸Šï¼Œæˆ‘æ‰¾åˆ°äº†ç¡®å®šä¸¤ä¸ªå€¼ä¸­æœ€å¤§å€¼çš„æœ€ç®€å•ç®—æ³•çš„åˆé€‚å›¾ç‰‡ï¼š </p><br><p><img src="https://habrastorage.org/webt/dk/fa/yk/dkfaykajbnvk5ma4djpceof1wps.png" alt="å›¾ç‰‡"></p><br><p> åœ¨è¿™é‡Œæˆ‘å¿…é¡»è¯´æˆ‘ä¸æ˜¯Javaè¯­è¨€å¼€å‘äººå‘˜ï¼Œè€Œæˆ‘çš„â€œæœ¬æœºâ€è¯­è¨€æ˜¯Cï¼ƒï¼Œå› æ­¤è§£å†³é—®é¢˜çš„æ–¹æ³•å–å†³äºCï¼ƒä¸­é¢å‘å¯¹è±¡å¼€å‘çš„ç»éªŒã€‚ æŸ¥çœ‹æ­¤å›¾ï¼Œæˆ‘çœ‹åˆ°ä»¥ä¸‹ç±»å‹çš„é¡¶ç‚¹ï¼ˆæ¡ä»¶åç§°å’Œç‰¹æ®Šè§’è‰²ä¸èµ·ä½œç”¨ï¼‰ï¼š </p><br><ul><li> å¼€å§‹é¡¶ç‚¹ï¼ˆå¼€å§‹ï¼‰ </li><li> æœ€ç»ˆé«˜å³°ï¼ˆå®Œæˆï¼‰ </li><li> é˜Ÿé•¿ï¼ˆæŒ‡æŒ¥å®˜ï¼‰ </li><li> èµ‹å€¼é¡¶ç‚¹ï¼ˆè®©ï¼‰ </li><li> éªŒè¯éªŒè¯é¡¶éƒ¨ï¼ˆå¦‚æœæœ‰ï¼‰ </li></ul><br><p> è¿™äº›é¡¶ç‚¹åœ¨æ•°æ®é›†æˆ–è¯­ä¹‰ä¸Šæœ‰ä¸€äº›åŒºåˆ«ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æ˜¯ä»åŸºæœ¬é¡¶ç‚¹ï¼ˆèŠ‚ç‚¹ï¼‰ç»§æ‰¿çš„ã€‚ åœ¨ç›¸åŒçš„åœ°æ–¹ï¼Œåœ¨Nodeç±»ä¸­ï¼Œæè¿°äº†linkså­—æ®µï¼Œå…¶ä¸­åŒ…å«åˆ°å…¶ä»–é¡¶ç‚¹çš„é“¾æ¥ï¼Œå¹¶ä¸”addLinkæ–¹æ³•å…è®¸æ·»åŠ è¿™äº›é“¾æ¥ã€‚ æ‰€æœ‰ç±»çš„å®Œæ•´ä»£ç éƒ½å¯ä»¥åœ¨<a href="">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚ </p><br><p> è®©æˆ‘ä»¬ç¼–å†™ä»å›¾ç‰‡ä¸­æ”¶é›†ç”µè·¯çš„ä»£ç ï¼Œç„¶åå°è¯•åºåˆ—åŒ–ç»“æœã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ç®—æ³•è®¾è®¡ä»£ç </b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   let start = new Schema.Start(); let input = new Schema.Command(' A, B'); let check = new Schema.If('A &gt; B'); let maxIsA = new Schema.Let('Max', 'A'); let maxIsB = new Schema.Let('Max', 'B'); let output = new Schema.Command(' Max'); let finish = new Schema.Finish(); //   start.addLink(input); input.addLink(check); check.addLink(maxIsA, { condition: 'true' }); check.addLink(maxIsB, { condition: 'false' }); maxIsA.addLink(output); maxIsB.addLink(output); output.addLink(finish); //    ( ) let schema = [ start, input, check, maxIsA, maxIsB, output, finish ];</span></span></code> </pre> </div></div><br><p> å¦‚æœæˆ‘ä»¬ä½¿ç”¨JSON.stringifyåºåˆ—åŒ–æ­¤æ¨¡å¼ï¼Œæˆ‘ä»¬å°†å¾—åˆ°å¯æ€•çš„ç»“æœã€‚ æˆ‘å°†ç»™å‡ºç»“æœçš„å‰å‡ è¡Œï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ æˆ‘çš„è¯„è®ºï¼š </p><br><div class="spoiler">  <b class="spoiler_title">JSON.stringifyç»“æœ</b> <div class="spoiler_text"><pre> <code class="hljs objectivec">[ <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"d9c8ab69-e4fa-4433-80bb-1cc7173024d6"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Start"</span></span>, <span class="hljs-string"><span class="hljs-string">"links"</span></span>: { <span class="hljs-string"><span class="hljs-string">"2e3d482b-187f-4c96-95cd-b3cde9e55a43"</span></span>: { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2e3d482b-187f-4c96-95cd-b3cde9e55a43"</span></span>, <span class="hljs-string"><span class="hljs-string">"target"</span></span>: <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"f87a3913-84b0-4b70-8927-6111c6628a1f"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Command"</span></span>, <span class="hljs-string"><span class="hljs-string">"links"</span></span>: { <span class="hljs-string"><span class="hljs-string">"4f623116-1b70-42bf-8a47-da1e9be5e4b2"</span></span>: { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"4f623116-1b70-42bf-8a47-da1e9be5e4b2"</span></span>, <span class="hljs-string"><span class="hljs-string">"target"</span></span>: <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"94a47403-13ab-4c83-98fe-3b201744c8f2"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"If"</span></span>, <span class="hljs-string"><span class="hljs-string">"links"</span></span>: { ...</code> </pre> </div></div><br><p> å› ä¸º ç¬¬ä¸€ä¸ªé¡¶ç‚¹åŒ…å«åˆ°ç¬¬äºŒä¸ªé¡¶ç‚¹çš„é“¾æ¥ï¼Œä¹ŸåŒ…å«åˆ°ç¬¬äºŒä¸ªé¡¶ç‚¹çš„é“¾æ¥ï¼Œç„¶åç”±äºå…¶åºåˆ—åŒ–ï¼Œæ•´ä¸ªç”µè·¯è¢«åºåˆ—åŒ–ã€‚ ç„¶åï¼Œç¬¬äºŒä¸ªå³°è¢«åºåˆ—åŒ–ï¼Œæ‰€æœ‰ä¸ä¹‹ç›¸å…³çš„åºåˆ—ï¼Œä¾æ­¤ç±»æ¨ã€‚ æ‚¨å¯ä»¥ä»…é€šè¿‡æ ‡è¯†ç¬¦ä»æ­¤å“ˆå¸Œè¿˜åŸåŸå§‹é“¾æ¥ï¼Œä½†æ˜¯å¦‚æœä»»ä½•ä¸€ä¸ªé¡¶ç‚¹ç›´æ¥æˆ–é€šè¿‡å…¶ä»–é¡¶ç‚¹å¼•ç”¨è‡ªèº«ï¼Œåˆ™å®ƒä»¬å°†æ— æµäºäº‹ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåºåˆ—åŒ–ç¨‹åºå°†<u>å¼•å‘Uncaught TypeErrorï¼šå°†å¾ªç¯ç»“æ„è½¬æ¢ä¸ºJSON</u>é”™è¯¯ã€‚ å¦‚æœä¸æ¸…æ¥šï¼Œä¸‹é¢æ˜¯ç”Ÿæˆæ­¤é”™è¯¯çš„æœ€ç®€å•ç¤ºä¾‹ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https</a> : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">//jsfiddle.net/L4guo86w/</a> ã€‚ </p><br><p> æ­¤å¤–ï¼ŒJSONä¸åŒ…å«æœ‰å…³æºç±»çš„ä»»ä½•ä¿¡æ¯ï¼Œå› æ­¤æ— æ³•äº†è§£åºåˆ—åŒ–ä¹‹å‰æ¯ä¸ªé¡¶ç‚¹çš„ç±»å‹ã€‚ </p><br><p> æ„è¯†åˆ°è¿™äº›é—®é¢˜åï¼Œæˆ‘ä¸Šç½‘äº†ï¼Œå¼€å§‹å¯»æ‰¾ç°æˆçš„è§£å†³æ–¹æ¡ˆã€‚ æœ‰å¾ˆå¤šï¼Œä½†å¤§å¤šæ•°éƒ½éå¸¸ç¬¨é‡ï¼Œæˆ–è€…éœ€è¦å¯¹å¯åºåˆ—åŒ–ç±»è¿›è¡Œç‰¹æ®Šæè¿°ï¼Œå› æ­¤å†³å®šè‡ªå·±åˆ¶é€ ä¸€è¾†è‡ªè¡Œè½¦ã€‚ æ˜¯çš„ï¼Œæˆ‘å–œæ¬¢è‡ªè¡Œè½¦ã€‚ </p><br><h3 id="koncepciya-serializatora"> åºåˆ—åŒ–å™¨æ¦‚å¿µ </h3><br><p> æœ¬éƒ¨åˆ†é€‚ç”¨äºé‚£äº›æƒ³ä¸æˆ‘ä¸€èµ·åˆ›å»ºåºåˆ—åŒ–ç®—æ³•çš„äººï¼Œå°½ç®¡å®é™…ä¸Šæ˜¯è¿™æ ·ã€‚ </p><br><h4 id="sohranenie-informacii-o-tipah-dannyh"> ä¿å­˜æ•°æ®ç±»å‹ä¿¡æ¯ </h4><br><p>  Javascriptçš„é—®é¢˜ä¹‹ä¸€æ˜¯ç¼ºå°‘å¯åœ¨Cï¼ƒæˆ–Javaï¼ˆå±æ€§å’Œåå°„ï¼‰ç­‰è¯­è¨€ä¸­å®ç°å¥‡è¿¹çš„å…ƒæ•°æ®ã€‚ å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä¸éœ€è¦å…·æœ‰å®šä¹‰å¯åºåˆ—åŒ–å­—æ®µï¼ŒéªŒè¯å’Œå…¶ä»–èŠ¯ç‰‡åˆ—è¡¨çš„åŠŸèƒ½çš„è¶…å¤æ‚åºåˆ—åŒ–ã€‚ å› æ­¤ï¼Œä¸»è¦æ€æƒ³æ˜¯å‘å¯¹è±¡æ·»åŠ æœ‰å…³å…¶ç±»å‹çš„ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨æ™®é€šçš„JSON.stringifyå¯¹å…¶è¿›è¡Œåºåˆ—åŒ–ã€‚ </p><br><p> åœ¨å¯»æ‰¾è§£å†³æ–¹æ¡ˆæ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸€ç¯‡æœ‰è¶£çš„æ–‡ç« ï¼Œå…¶æ ‡é¢˜ç¿»è¯‘ä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œ 6ç§åœ¨JSONä¸­æ·»åŠ ç±»å‹ä¿¡æ¯çš„é”™è¯¯æ–¹æ³•â€</a> ã€‚ å®é™…ä¸Šï¼Œè¿™äº›æ–¹æ³•éå¸¸å¥½ï¼Œæˆ‘é€‰æ‹©äº†ç¬¬5ç§æ–¹æ³•ã€‚å¦‚æœæ‚¨æ‡’äºé˜…è¯»æœ¬æ–‡ï¼Œä½†æ˜¯æˆ‘å¼ºçƒˆå»ºè®®æ‚¨è¿™æ ·åšï¼Œé‚£ä¹ˆæˆ‘å°†ç®€è¦æè¿°è¯¥æ–¹æ³•ï¼šåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å°†å…¶åŒ…è£…åœ¨å¦ä¸€ä¸ªå¯¹è±¡ä¸­åç§°æ ¼å¼ä¸º<code>"@&lt;type&gt;"</code>çš„å­—æ®µï¼Œè¯¥å€¼æ˜¯å¯¹è±¡çš„æ•°æ®ã€‚ ååºåˆ—åŒ–æœŸé—´ï¼Œæˆ‘ä»¬æå–ç±»å‹åç§°ï¼Œä»æ„é€ å‡½æ•°ä¸­é‡æ–°åˆ›å»ºå¯¹è±¡ï¼Œç„¶åè¯»å–å…¶å­—æ®µçš„æ•°æ®ã€‚ </p><br><p> å¦‚æœæˆ‘ä»¬ä»ä¸Šé¢çš„ç¤ºä¾‹ä¸­åˆ é™¤é“¾æ¥ï¼Œåˆ™æ ‡å‡†JSON.stringifyä¼šåƒè¿™æ ·å¯¹æ•°æ®è¿›è¡Œåºåˆ—åŒ–ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">JSON.stringify</b> <div class="spoiler_text"><pre> <code class="hljs json">[ { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"d04d6a58-7215-4102-aed0-32122e331cf4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Start"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: {} }, { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"5c58c3fc-8ce1-45a5-9e44-90d5cebe11d3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Command"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">" A, B"</span></span> }, ... }</code> </pre> </div></div><br><p> æˆ‘ä»¬çš„åºåˆ—åŒ–å™¨å°†åƒè¿™æ ·åŒ…è£…å®ƒï¼š </p><br><div class="spoiler">  <b class="spoiler_title">åºåˆ—åŒ–ç»“æœ</b> <div class="spoiler_text"><pre> <code class="hljs json">[ { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Start"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"d04d6a58-7215-4102-aed0-32122e331cf4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Start"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: {} } }, { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Command"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"5c58c3fc-8ce1-45a5-9e44-90d5cebe11d3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Command"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">" A, B"</span></span> } }, ... }</code> </pre> </div></div><br><p> å½“ç„¶ï¼Œæœ‰ä¸€ä¸ªç¼ºç‚¹ï¼šåºåˆ—åŒ–ç¨‹åºå¿…é¡»çŸ¥é“å…¶å¯ä»¥åºåˆ—åŒ–çš„ç±»å‹ï¼Œå¹¶ä¸”å¯¹è±¡æœ¬èº«ä¸åº”åŒ…å«åç§°ä»¥ç‹—å¼€å¤´çš„å­—æ®µã€‚ ä½†æ˜¯ï¼Œç¬¬äºŒä¸ªé—®é¢˜æ˜¯é€šè¿‡ä¸å¼€å‘äººå‘˜è¾¾æˆåè®®æˆ–ç”¨å…¶ä»–ç¬¦å·æ›¿æ¢ç‹—ç¬¦å·æ¥è§£å†³çš„ï¼Œè€Œç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ç”¨ä¸€è¡Œä»£ç è§£å†³çš„ï¼ˆä¸‹é¢å°†ä½œä¸ºç¤ºä¾‹ï¼‰ã€‚ æˆ‘ä»¬ç¡®åˆ‡çŸ¥é“å°†è¦åºåˆ—åŒ–çš„å†…å®¹ï¼Œå¯¹å—ï¼Ÿ </p><br><h4 id="reshenie-problemy-so-ssylkami"> è§£å†³é“¾æ¥é—®é¢˜ </h4><br><p> å°±ç®—æ³•è€Œè¨€ï¼Œå®ƒä»ç„¶æ›´ç®€å•ï¼Œä½†æ˜¯æ›´éš¾ä»¥å®ç°ã€‚ </p><br><p> å½“åºåˆ—åŒ–åœ¨åºåˆ—åŒ–å™¨ä¸­æ³¨å†Œçš„ç±»çš„å®ä¾‹æ—¶ï¼Œæˆ‘ä»¬ä¼šå°†å®ƒä»¬å­˜å‚¨åœ¨ç¼“å­˜ä¸­å¹¶ä¸ºå…¶åˆ†é…ä¸€ä¸ªåºåˆ—å·ã€‚ å¦‚æœå°†æ¥å†æ¬¡é‡åˆ°è¯¥å®ä¾‹ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€ä¸ªå®šä¹‰ä¸­ï¼Œæˆ‘ä»¬å°†æ·»åŠ æ­¤æ•°å­—ï¼ˆå­—æ®µåç§°å°†é‡‡ç”¨<code>"@&lt;type&gt;|&lt;index&gt;"</code> ï¼‰ï¼Œå¹¶åœ¨åºåˆ—åŒ–çš„ä½ç½®ä»¥å¯¹è±¡çš„å½¢å¼æ’å…¥é“¾æ¥ </p><br><pre> <code class="hljs json"> { <span class="hljs-attr"><span class="hljs-attr">"@&lt;type&gt;"</span></span>: &lt;index&gt; }</code> </pre> <br><p> å› æ­¤ï¼Œåœ¨ååºåˆ—åŒ–æœŸé—´ï¼Œæˆ‘ä»¬å°†æŸ¥çœ‹è¯¥å­—æ®µçš„ç¡®åˆ‡å€¼ã€‚ å¦‚æœè¿™æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ ¹æ®è¯¥æ•°å­—ä»ç¼“å­˜ä¸­æå–å¯¹è±¡ã€‚ å¦åˆ™ï¼Œè¿™æ˜¯ä»–çš„ç¬¬ä¸€ä¸ªå®šä¹‰ã€‚ </p><br><p> è®©æˆ‘ä»¬å°†é“¾æ¥ä»æ–¹æ¡ˆçš„ç¬¬ä¸€é¡¶éƒ¨è¿”å›åˆ°ç¬¬äºŒé¡¶éƒ¨ï¼Œå¹¶æŸ¥çœ‹ç»“æœï¼š </p><br><div class="spoiler">  <b class="spoiler_title">åºåˆ—åŒ–ç»“æœ</b> <div class="spoiler_text"><pre> <code class="hljs json">[ { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Start"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"a26a3a29-9462-4c92-8d24-6a93dd5c819a"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Start"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"25fa2c44-0446-4471-a013-8b24ffb33bac"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Link"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"25fa2c44-0446-4471-a013-8b24ffb33bac"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"target"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Command|1"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"4f4f5521-a2ee-4576-8aec-f61a08ed38dc"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Command"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">" A, B"</span></span> } } } } } } }, { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Command"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, ... }</code> </pre> </div></div><br><p> ä¹ä¸€çœ‹ä¼¼ä¹ä¸å¤ªæ¸…æ¥šï¼Œå› ä¸º é¦–å…ˆåœ¨Linké€šä¿¡å¯¹è±¡çš„ç¬¬ä¸€ä¸ªé¡¶ç‚¹å†…å®šä¹‰ç¬¬äºŒä¸ªé¡¶ç‚¹ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•èµ·ä½œç”¨å¾ˆé‡è¦ã€‚ æ­¤å¤–ï¼Œæˆ‘åˆ›å»ºäº†åºåˆ—åŒ–å™¨çš„ç¬¬äºŒä¸ªç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬ç»•è¿‡æ ‘çš„æ·±åº¦ä¸æ˜¯å®½åº¦ï¼Œè€Œæ˜¯å®½åº¦ï¼Œä»è€Œé¿å…äº†è¿™ç§â€œæ¢¯å­â€ã€‚ </p><br><h3 id="sozdanie-serializatora"> åˆ›å»ºåºåˆ—åŒ–å™¨ </h3><br><p> æœ¬éƒ¨åˆ†é€‚ç”¨äºæœ‰å…´è¶£å®æ–½ä¸Šè¿°æ€æƒ³çš„äººå‘˜ã€‚ </p><br><h4 id="zagotovka-serializatora"> åºåˆ—åŒ–å™¨ç©ºç™½ </h4><br><p> åƒå…¶ä»–ä»»ä½•æ–¹æ³•ä¸€æ ·ï¼Œæˆ‘ä»¬çš„åºåˆ—åŒ–å™¨å°†æœ‰ä¸¤ç§ä¸»è¦æ–¹æ³•-åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬å°†éœ€è¦ä¸€ç§æ–¹æ³•æ¥å‘Šè¯‰åºåˆ—åŒ–ç¨‹åºåº”è¯¥åºåˆ—åŒ–çš„ç±»ï¼ˆæ³¨å†Œï¼‰å’Œä¸åº”è¯¥åºåˆ—åŒ–çš„ç±»ï¼ˆå¿½ç•¥ï¼‰ã€‚ ä¸ºäº†ä¸å¯¹DOMå…ƒç´ ï¼ŒJQueryå¯¹è±¡æˆ–ä»»ä½•å…¶ä»–æ— æ³•åºåˆ—åŒ–æˆ–ä¸éœ€è¦åºåˆ—åŒ–çš„æ•°æ®ç±»å‹è¿›è¡Œåºåˆ—åŒ–ï¼Œåè€…æ˜¯å¿…éœ€çš„ã€‚ ä¾‹å¦‚ï¼Œåœ¨æˆ‘çš„ç¼–è¾‘å™¨ä¸­ï¼Œæˆ‘å­˜å‚¨äº†å¯¹åº”äºé¡¶ç‚¹æˆ–é“¾æ¥çš„å¯è§†å…ƒç´ ã€‚ å®ƒæ˜¯åœ¨åˆå§‹åŒ–æœŸé—´åˆ›å»ºçš„ï¼Œå¹¶ä¸”å½“ç„¶ä¸åº”è¯¥è½å…¥æ•°æ®åº“ä¸­ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">åºåˆ—åŒ–ç¨‹åºå¤–å£³ç¨‹åºä»£ç </b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializer</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** *  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._nameToCtor = []; <span class="hljs-comment"><span class="hljs-comment">//    this._ctorToName = []; //    this._ignore = [Element]; //    } /** *   * @param {string} alias  * @param {Function} ctor  */ register(alias, ctor) { if (typeof ctor === 'undefined' &amp;&amp; typeof alias === 'function') { //    -  ctor = alias; alias = ctor.name; } this._nameToCtor[alias] = ctor; this._ctorToName[ctor] = alias; } /** *     * @param {Function} ctor  */ ignore(ctor) { if (this._ignore.indexOf(ctor) &lt; 0) { this._ignore.push(ctor); } } /** *   * @param {any} val  * @param {Function} [replacer]       * @param {string} [space]   * @returns {string}  */ serialize(val, replacer, space) { return JSON.stringify(new SerializationContext(this).serialize(val), replacer, space); } /** *     json * @param {any} val    json * @returns {any}  */ deserialize(val) { //     if (isString(val)) val = JSON.parse(val); return new DeserializationContext(this).deserialize(val); } }</span></span></code> </pre> </div></div><br><p> è¯´æ˜ </p><br><p> è¦æ³¨å†Œä¸€ä¸ªç±»ï¼Œæ‚¨å¿…é¡»é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹å¼ä¹‹ä¸€å°†å…¶æ„é€ å‡½æ•°ä¼ é€’ç»™registeræ–¹æ³•ï¼š </p><br><ol><li> æ³¨å†Œï¼ˆMyClassï¼‰ </li><li> æ³¨å†Œï¼ˆ'MyNamespace.MyClass'ï¼ŒMyClassï¼‰ </li></ol><br><p> åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œç±»åç§°å°†ä»æ„é€ å‡½æ•°çš„åç§°ä¸­æå–ï¼ˆIEä¸­ä¸æ”¯æŒï¼‰ï¼Œåœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œæ‚¨è‡ªå·±æŒ‡å®šåç§°ã€‚ ç¬¬äºŒç§æ–¹æ³•æ˜¯å¯å–çš„ï¼Œå› ä¸º å…è®¸æ‚¨ä½¿ç”¨åç§°ç©ºé—´ï¼Œç¬¬ä¸€ç§æ˜¯è®¾è®¡ä½¿ç„¶ï¼Œå¯ä»¥ä½¿ç”¨é‡æ–°å®šä¹‰çš„åºåˆ—åŒ–é€»è¾‘æ¥æ³¨å†Œå†…ç½®Javascriptç±»å‹ã€‚ </p><br><p> å¯¹äºæˆ‘ä»¬çš„ç¤ºä¾‹ï¼Œåºåˆ—åŒ–å™¨çš„åˆå§‹åŒ–å¦‚ä¸‹ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Schema <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./schema'</span></span>; ... <span class="hljs-comment"><span class="hljs-comment">//   let serializer = new Serializer(); //   Object.keys(Schema).forEach(key =&gt; serializer.register(`Schema.${key}`, Schema[key]));</span></span></code> </pre> <br><p>  Schemaå¯¹è±¡åŒ…å«æ‰€æœ‰é¡¶ç‚¹ç±»çš„æè¿°ï¼Œå› æ­¤ç±»æ³¨å†Œä»£ç ä»…å ä¸€è¡Œã€‚ </p><br><h4 id="kontekst-serializacii-i-deserializacii"> åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ä¸Šä¸‹æ–‡ </h4><br><p> æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ç¥ç§˜çš„SerializationContextå’ŒDeserializationContextç±»ã€‚ æ˜¯ç”±ä»–ä»¬æ¥å®Œæˆæ‰€æœ‰å·¥ä½œï¼Œå¹¶ä¸”ä¸»è¦æ˜¯ä¸ºäº†å°†æ•°æ®ä¸ä¸åŒçš„åºåˆ—åŒ–/ååºåˆ—åŒ–è¿‡ç¨‹åˆ†ç¦»å¼€æ¥ï¼Œå› ä¸º å¯¹äºæ¯ä¸ªå‘¼å«ï¼Œä»–ä»¬éƒ½éœ€è¦å­˜å‚¨ä¸­é—´ä¿¡æ¯-åºåˆ—åŒ–å¯¹è±¡çš„ç¼“å­˜å’Œé“¾æ¥çš„åºåˆ—å·ã€‚ </p><br><h4 id="serializationcontext"> åºåˆ—åŒ–ä¸Šä¸‹æ–‡ </h4><br><p> æˆ‘å°†ä»…è¯¦ç»†åˆ†æé€’å½’åºåˆ—åŒ–å™¨ï¼Œå› ä¸º å®ƒä»¬çš„â€œæ‰å¹³â€å¯¹è±¡åœ¨æŸç§ç¨‹åº¦ä¸Šæ›´åŠ å¤æ‚ï¼Œå¹¶ä¸”ä»…åœ¨å¤„ç†å¯¹è±¡æ ‘çš„æ–¹æ³•ä¸Šæœ‰æ‰€ä¸åŒã€‚ </p><br><p> è®©æˆ‘ä»¬ä»æ„é€ å‡½æ•°å¼€å§‹ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *  * @param {Serializer} ser  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(ser) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.__proto__.__proto__ = ser; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cache = []; <span class="hljs-comment"><span class="hljs-comment">//    this.index = 0; //     }</span></span></code> </pre> <br><p> æˆ‘<code>this.__proto__.__proto__ = ser;</code>è§£é‡Šè¿™æ¡ç¥ç§˜çº¿ï¼š <code>this.__proto__.__proto__ = ser;</code> <br> åœ¨æ„é€ å‡½æ•°çš„è¾“å…¥å¤„ï¼Œæˆ‘ä»¬æ¥å—åºåˆ—åŒ–ç¨‹åºæœ¬èº«çš„å¯¹è±¡ï¼Œå¹¶ä¸”æ­¤è¡Œä»å…¶ç»§æ‰¿æˆ‘ä»¬çš„ç±»ã€‚ è¿™å…è®¸é€šè¿‡<code>this</code>è®¿é—®åºåˆ—åŒ–å™¨æ•°æ®ã€‚ <br> ä¾‹å¦‚ï¼Œ <code>this._ignore</code>å¼•ç”¨åºåˆ—åŒ–ç¨‹åºæœ¬èº«çš„è¢«å¿½ç•¥ç±»çš„åˆ—è¡¨ï¼ˆâ€œé»‘åå•â€ï¼‰ï¼Œè¿™éå¸¸æœ‰ç”¨ã€‚ å¦åˆ™ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸ç¼–å†™ç±»ä¼¼<code>this._serializer._ignore</code> ã€‚ </p><br><p> ä¸»è¦åºåˆ—åŒ–æ–¹æ³•ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   * @param {any} val  * @returns {string}  */</span></span> serialize(val) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.isArray(val)) { <span class="hljs-comment"><span class="hljs-comment">//  return this.serializeArray(val); } else if (isObject(val)) { //  if (this._ignore.some(e =&gt; val instanceof e)) { //   return undefined; } else { return this.serializeObject(val); } } else { //   return val; } }</span></span></code> </pre> <br><p> åº”è¯¥æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¤„ç†çš„æ•°æ®æœ‰ä¸‰ç§åŸºæœ¬ç±»å‹ï¼šæ•°ç»„ï¼Œå¯¹è±¡å’Œç®€å•å€¼ã€‚ å¦‚æœå¯¹è±¡çš„æ„é€ å‡½æ•°åœ¨â€œé»‘åå•â€ä¸­ï¼Œåˆ™è¯¥å¯¹è±¡ä¸ä¼šåºåˆ—åŒ–ã€‚ </p><br><p> é˜µåˆ—åºåˆ—åŒ–ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   * @param {Array} val  * @returns {Array}  */</span></span> serializeArray(val) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> res = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> val) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> e = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.serialize(item); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> e !== <span class="hljs-string"><span class="hljs-string">'undefined'</span></span>) res.push(e); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; }</code> </pre> <br><p> æ‚¨å¯ä»¥é€šè¿‡mapç¼–å†™è¾ƒçŸ­çš„æ–‡å­—ï¼Œä½†è¿™å¹¶ä¸é‡è¦ã€‚ åªæœ‰ä¸€ä»¶äº‹å¾ˆé‡è¦-æ£€æŸ¥æœªå®šä¹‰çš„å€¼ã€‚ å¦‚æœæ•°ç»„ä¸­å­˜åœ¨ä¸å¯åºåˆ—åŒ–çš„ç±»ï¼Œé‚£ä¹ˆå¦‚æœä¸è¿›è¡Œæ­¤æ£€æŸ¥ï¼Œå®ƒå°†ä»¥æœªå®šä¹‰çš„å½¢å¼è½å…¥æ•°ç»„ä¸­ï¼Œè¿™ä¸æ˜¯å¾ˆå¥½ã€‚ åŒæ ·åœ¨æˆ‘çš„å®ç°ä¸­ï¼Œæ•°ç»„è¢«åºåˆ—åŒ–è€Œæ²¡æœ‰é”®ã€‚ ä»ç†è®ºä¸Šè®²ï¼Œæ‚¨å¯ä»¥ä¼˜åŒ–ç”¨äºåºåˆ—åŒ–å…³è”æ•°ç»„çš„ç®—æ³•ï¼Œä½†æ˜¯å‡ºäºè¿™äº›ç›®çš„ï¼Œæˆ‘æ›´å–œæ¬¢ä½¿ç”¨å¯¹è±¡ã€‚ å¦å¤–ï¼ŒJSON.stringifyä¹Ÿä¸å–œæ¬¢å…³è”æ•°ç»„ã€‚ </p><br><p> å¯¹è±¡åºåˆ—åŒ–ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">ä»£å·</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   * @param {Object} val  * @returns {Object}  */</span></span> serializeObject(val) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._ctorToName[val.constructor]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (name) { <span class="hljs-comment"><span class="hljs-comment">//     if (!val.__uuid) val.__uuid = ++uuid; let cached = this.cache[val.__uuid]; if (cached) { //     if (!cached.index) { //     cached.index = ++this.index; let key = Object.keys(cached.ref)[0]; let old = cached.ref[key]; cached.ref[`@${name}|${cached.index}`] = old; delete cached.ref[key]; } //     return { [`@${name}`]: cached.index }; } else { let res; let cached = { ref: { [`@${name}`]: {} } }; this.cache[val.__uuid] = cached; if (typeof val.serialize === 'function') { //     res = val.serialize(); } else { //   res = this.serializeObjectInner(val); } cached.ref[Object.keys(cached.ref)[0]] = res; return cached.ref; } } else { //   return this.serializeObjectInner(val); } }</span></span></code> </pre> </div></div><br><p> æ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸²è¡Œå™¨æœ€å›°éš¾çš„éƒ¨åˆ†ï¼Œå®ƒçš„æ ¸å¿ƒã€‚ è®©æˆ‘ä»¬æ‹†å¼€ã€‚ </p><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬æ£€æŸ¥ç±»æ„é€ å‡½æ•°æ˜¯å¦å·²åœ¨åºåˆ—åŒ–ç¨‹åºä¸­æ³¨å†Œã€‚ å¦‚æœä¸æ˜¯ï¼Œåˆ™è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹è±¡ï¼Œå°†ä¸ºå…¶è°ƒç”¨<code>serializeObjectInner</code>å®ç”¨ç¨‹åºæ–¹æ³•ã€‚ </p><br><p> å¦åˆ™ï¼Œæˆ‘ä»¬æ£€æŸ¥å¯¹è±¡æ˜¯å¦è¢«åˆ†é…äº†å”¯ä¸€æ ‡è¯†ç¬¦<strong>__uuid</strong> ã€‚ è¿™æ˜¯æ‰€æœ‰åºåˆ—åŒ–ç¨‹åºéƒ½é€šç”¨çš„ç®€å•è®¡æ•°å™¨å˜é‡ï¼Œç”¨äºåœ¨ç¼“å­˜ä¸­ä¿ç•™å¯¹ç±»å®ä¾‹çš„å¼•ç”¨ã€‚ æ‚¨å¯ä»¥ä¸ä½¿ç”¨å®ƒï¼Œè€Œå°†å®ä¾‹æœ¬èº«æœ¬èº«ä¸å¸¦å¯†é’¥å­˜å‚¨åœ¨é«˜é€Ÿç¼“å­˜ä¸­ï¼Œä½†æ˜¯è¦æ£€æŸ¥å¯¹è±¡æ˜¯å¦å­˜å‚¨åœ¨é«˜é€Ÿç¼“å­˜ä¸­ï¼Œåˆ™å¿…é¡»éå†æ•´ä¸ªé«˜é€Ÿç¼“å­˜ï¼Œè¿™é‡Œè¶³ä»¥æ£€æŸ¥å¯†é’¥ã€‚ æˆ‘è®¤ä¸ºå°±æµè§ˆå™¨ä¸­å¯¹è±¡çš„å†…éƒ¨å®ç°è€Œè¨€ï¼Œè¿™æ›´å¿«ã€‚ å¦å¤–ï¼Œæˆ‘æ•…æ„ä¸åºåˆ—åŒ–ä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿<strong>å¼€å¤´çš„</strong>å­—æ®µï¼Œå› æ­¤<strong>__uuid</strong>å­—æ®µä¸ä¼šåƒå…¶ä»–ç§æœ‰ç±»å­—æ®µé‚£æ ·è½å…¥ç”Ÿæˆçš„jsonä¸­ã€‚ å¦‚æœè¿™å¯¹äºæ‚¨çš„ä»»åŠ¡ä¸å¯æ¥å—ï¼Œåˆ™å¯ä»¥æ›´æ”¹æ­¤é€»è¾‘ã€‚ </p><br><p> æ¥ä¸‹æ¥ï¼Œé€šè¿‡<strong>__uuid</strong>çš„å€¼<strong>ï¼Œ</strong>æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æè¿°äº†é«˜é€Ÿç¼“å­˜ï¼ˆ <strong>cached</strong> ï¼‰ä¸­ç±»çš„å®ä¾‹ã€‚ </p><br><p> å¦‚æœå­˜åœ¨è¿™æ ·çš„å¯¹è±¡ï¼Œåˆ™è¯¥å€¼å·²åœ¨å‰é¢è¿›è¡Œäº†åºåˆ—åŒ–ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä¹‹å‰æ²¡æœ‰è¿™æ ·åšï¼Œæˆ‘ä»¬å°†ä¸ºè¯¥å¯¹è±¡åˆ†é…ä¸€ä¸ªåºåˆ—å·ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!cached.index) { <span class="hljs-comment"><span class="hljs-comment">//     cached.index = ++this.index; let key = Object.keys(cached.ref)[0]; let old = cached.ref[key]; cached.ref[`@${name}|${cached.index}`] = old; delete cached.ref[key]; }</span></span></code> </pre> <br><p> è¯¥ä»£ç çœ‹èµ·æ¥å¾ˆæ··ä¹±ï¼Œå¯ä»¥é€šè¿‡ä¸ºæˆ‘ä»¬åºåˆ—åŒ–çš„æ‰€æœ‰ç±»åˆ†é…ä¸€ä¸ªæ•°å­—æ¥ç®€åŒ–ä»£ç ã€‚ ä½†æ˜¯å¯¹äºè°ƒè¯•å’Œæ„ŸçŸ¥ç»“æœï¼Œæœ€å¥½å°†æ•°å­—ä»…åˆ†é…ç»™å°†æ¥æœ‰é“¾æ¥çš„é‚£äº›ç±»ã€‚ </p><br><p> åˆ†é…ç¼–å·åï¼Œæˆ‘ä»¬æ ¹æ®ç®—æ³•è¿”å›é“¾æ¥ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     return { [`@${name}`]: cached.index };</span></span></code> </pre> <br><p> å¦‚æœå¯¹è±¡æ˜¯ç¬¬ä¸€æ¬¡åºåˆ—åŒ–çš„ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå…¶ç¼“å­˜çš„å®ä¾‹ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> res; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cached = { <span class="hljs-attr"><span class="hljs-attr">ref</span></span>: { [<span class="hljs-string"><span class="hljs-string">`@</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${name}</span></span></span><span class="hljs-string">`</span></span>]: {} } }; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.cache[val.__uuid] = cached;</code> </pre> <br><p> ç„¶ååºåˆ—åŒ–å®ƒï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> val.serialize === <span class="hljs-string"><span class="hljs-string">'function'</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//     res = val.serialize(); } else { //   res = this.serializeObjectInner(val); } cached.ref[Object.keys(cached.ref)[0]] = res;</span></span></code> </pre> <br><p> è¯¥ç±»å°†æ£€æŸ¥åºåˆ—åŒ–æ¥å£çš„å®ç°ï¼ˆå°†åœ¨åé¢è®¨è®ºï¼‰ï¼Œä»¥åŠ<code>Object.keys(cached.ref)[0]</code>çš„æ„é€ ã€‚ äº‹å®æ˜¯ï¼Œcached.refå­˜å‚¨äº†æŒ‡å‘åŒ…è£…å¯¹è±¡<code>{ "@&lt;type&gt;[|&lt;index&gt;]": &lt;&gt; }</code> ï¼Œä½†æ˜¯å¯¹è±¡å­—æ®µçš„åç§°å¯¹æˆ‘ä»¬æ¥è¯´æ˜¯æœªçŸ¥çš„ï¼Œå› ä¸º åœ¨æ­¤é˜¶æ®µï¼Œæˆ‘ä»¬å°šä¸çŸ¥é“åç§°æ˜¯å¦åŒ…å«å¯¹è±¡ç¼–å·ï¼ˆç´¢å¼•ï¼‰ã€‚ è¯¥æ„é€ ä»…æå–å¯¹è±¡çš„ç¬¬ä¸€ä¸ªä¹Ÿæ˜¯å”¯ä¸€çš„å­—æ®µã€‚ </p><br><p> æœ€åï¼Œåºåˆ—åŒ–å¯¹è±¡å†…éƒ¨çš„å®ç”¨æ–¹æ³•ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   * @param {Object} val  * @returns {Object}  */</span></span> serializeObjectInner(val) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> res = {}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyNames(val)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!(isString(key) &amp;&amp; key.startsWith(<span class="hljs-string"><span class="hljs-string">'__'</span></span>))) { <span class="hljs-comment"><span class="hljs-comment">//  ,      res[key] = this.serialize(val[key]); } } return res; }</span></span></code> </pre> <br><p> æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶å°†å­—æ®µä»æ—§å¯¹è±¡å¤åˆ¶åˆ°å…¶ä¸­ã€‚ </p><br><h4 id="deserializationcontext"> ååºåˆ—åŒ–ä¸Šä¸‹æ–‡ </h4><br><p> ååºåˆ—åŒ–è¿‡ç¨‹ä»¥ç›¸åçš„é¡ºåºè¿›è¡Œï¼Œä¸éœ€è¦ç‰¹æ®Šæ³¨é‡Šã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ä»£å·</b> <div class="spoiler_text"><pre> <code class="hljs powershell">/** *   */ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DeserializationContext</span></span></span></span> { /** *  * @<span class="hljs-keyword"><span class="hljs-keyword">param</span></span> {Serializer} ser  */ constructor(ser) { this.__proto__.__proto__ = ser; this.cache = []; //    } /** *   json * @<span class="hljs-keyword"><span class="hljs-keyword">param</span></span> {any} val  json * @returns {any}  */ deserialize(val) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Array.isArray(val)) { //  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> this.deserializeArray(val); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isObject(val)) { //  <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> this.deserializeObject(val); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //   <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> val; } } /** *   * @<span class="hljs-keyword"><span class="hljs-keyword">param</span></span> {Object} val  * @returns {Object}  */ deserializeArray(val) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> val.map(item =&gt; this.deserialize(item)); } /** *   * @<span class="hljs-keyword"><span class="hljs-keyword">param</span></span> {Array} val  * @returns {Array}  */ deserializeObject(val) { let res = {}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (let key of Object.getOwnPropertyNames(val)) { let <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = val[<span class="hljs-type"><span class="hljs-type">key</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isString(key) &amp;&amp; key.startsWith(<span class="hljs-string"><span class="hljs-string">'@'</span></span>)) { //   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isInteger(<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>)) { //  res = this.cache[<span class="hljs-type"><span class="hljs-type">data</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (res) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { console.error(`     <span class="hljs-variable"><span class="hljs-variable">$</span></span>{<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>}`); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //   let [<span class="hljs-type"><span class="hljs-type">name</span></span>, <span class="hljs-type"><span class="hljs-type">id</span></span>] = key.substr(<span class="hljs-number"><span class="hljs-number">1</span></span>).split(<span class="hljs-string"><span class="hljs-string">'|'</span></span>); let ctor = this._nameToCtor[<span class="hljs-type"><span class="hljs-type">name</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ctor) { //     res = new ctor(); //   ,    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (id) this.cache[<span class="hljs-type"><span class="hljs-type">id</span></span>] = res; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (typeof res.deserialize === <span class="hljs-string"><span class="hljs-string">'function'</span></span>) { //     res.deserialize(<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (let key of Object.getOwnPropertyNames(<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>)) { res[<span class="hljs-type"><span class="hljs-type">key</span></span>] = this.deserialize(data[<span class="hljs-type"><span class="hljs-type">key</span></span>]); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //    console.error(`  <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">{name}"</span></span>  .`); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> val[<span class="hljs-type"><span class="hljs-type">key</span></span>]; } } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { //   res[<span class="hljs-type"><span class="hljs-type">key</span></span>] = this.deserialize(val[<span class="hljs-type"><span class="hljs-type">key</span></span>]); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res; } }</code> </pre> </div></div><br><h3 id="dopolnitelnye-vozmozhnosti"> é™„åŠ åŠŸèƒ½ </h3><br><h4 id="interfeys-serializacii"> åºåˆ—åŒ–ä»‹é¢ </h4><br><p>  Javascriptä¸­æ²¡æœ‰æ¥å£æ”¯æŒï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åŒæ„ï¼Œå¦‚æœè¯¥ç±»å®ç°äº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ–¹æ³•ï¼Œåˆ™è¿™äº›æ–¹æ³•å°†åˆ†åˆ«ç”¨äºåºåˆ—åŒ–/ååºåˆ—åŒ–ã€‚ </p><br><p> å¦å¤–ï¼ŒJavascriptå…è®¸æ‚¨ä¸ºå†…ç½®ç±»å‹å®ç°è¿™äº›æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œå¯¹äºDateï¼š </p><br><div class="spoiler">  <b class="spoiler_title">å°†æ—¥æœŸåºåˆ—åŒ–ä¸ºISOæ ¼å¼</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.prototype.serialize = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toISOString(); }; <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.prototype.deserialize = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">val</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> date = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(val); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setDate(date.getDate()); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setTime(date.getTime()); };</code> </pre> </div></div><br><p> æœ€ä¸»è¦çš„æ˜¯è¦è®°ä½æ³¨å†Œæ—¥æœŸç±»å‹ï¼š <code>serializer.register(Date);</code>  ã€‚ </p><br><p> ç»“æœï¼š </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"@Date"</span></span>: <span class="hljs-string"><span class="hljs-string">"2018-06-02T20:41:06.861Z"</span></span> }</code> </pre> <br><p> å”¯ä¸€çš„é™åˆ¶ï¼šåºåˆ—åŒ–çš„ç»“æœä¸åº”ä¸ºæ•´æ•°ï¼Œå› ä¸º åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒå°†è¢«è§£é‡Šä¸ºå¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚ </p><br><p> åŒæ ·ï¼Œæ‚¨å¯ä»¥å°†ç®€å•çš„ç±»åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚ å°†æè¿°é¢œè‰²çš„Colorç±»åºåˆ—åŒ–ä¸º<code>#rrggbb</code>è¡Œçš„ç¤ºä¾‹åœ¨<a href="">githubä¸Š</a> ã€‚ </p><br><h4 id="ploskiy-serializator"> å¹³é¢åºåˆ—åŒ–å™¨ </h4><br><p> äº²çˆ±çš„è¯»è€…ï¼Œå°¤å…¶æ˜¯å¯¹æ‚¨æ¥è¯´ï¼Œæˆ‘å†™äº†<a href="">åºåˆ—åŒ–</a>å™¨çš„<a href="">ç¬¬äºŒä¸ªç‰ˆæœ¬</a> ï¼Œå®ƒæ²¡æœ‰æ·±åº¦åœ°é€’å½’éå†å¯¹è±¡æ ‘ï¼Œè€Œæ˜¯ä½¿ç”¨é˜Ÿåˆ—éå†å¯¹è±¡çš„å®½åº¦ã€‚ </p><br><p> ä¸ºäº†è¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘å°†ç»™å‡ºåœ¨ä¸¤ç§æƒ…å†µä¸‹æˆ‘ä»¬æ–¹æ¡ˆçš„å‰ä¸¤ä¸ªé¡¶ç‚¹çš„åºåˆ—åŒ–ç¤ºä¾‹ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">é€’å½’åºåˆ—åŒ–å™¨ï¼ˆæ·±åº¦åºåˆ—åŒ–ï¼‰</b> <div class="spoiler_text"><pre> <code class="hljs json">[ { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Start"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"5ec74f26-9515-4789-b852-12feeb258949"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Start"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"102c3dca-8e08-4389-bc7f-68862f2061ef"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Link"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"102c3dca-8e08-4389-bc7f-68862f2061ef"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"target"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Command|1"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"447f6299-4bd4-48e4-b271-016a0d47fc0e"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Command"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">" A, B"</span></span> } } } } } } }, { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Command"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> } ]</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">å¹³é¢ä¸²è¡Œå™¨ï¼ˆä¸²è¡ŒåŒ–èŒƒå›´ï¼‰</b> <div class="spoiler_text"><pre> <code class="hljs json">[ { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Start"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1412603f-24c2-4513-836e-f2b0c0392483"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Start"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"b94ac7e5-d75f-44c1-960f-a02f52c994da"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Link"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"b94ac7e5-d75f-44c1-960f-a02f52c994da"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"target"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Command"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> } } } } } }, { <span class="hljs-attr"><span class="hljs-attr">"@Schema.Command|1"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"a93e452e-4276-4d6a-86a1-0681226d79f0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Command"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">" A, B"</span></span> } } ]</code> </pre> </div></div><br><p> å°±ä¸ªäººè€Œè¨€ï¼Œæˆ‘ç”šè‡³æ¯”ç¬¬ä¸€ä¸ªæ›´å–œæ¬¢ç¬¬äºŒä¸ªé€‰é¡¹ï¼Œä½†åº”è®°ä½é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ä¸èƒ½ä½¿ç”¨å¦ä¸€ä¸ªé€‰é¡¹ã€‚ éƒ½æ˜¯å…³äºé“¾æ¥çš„ã€‚ è¯·æ³¨æ„ï¼Œåœ¨å¹³é¢ä¸²è¡Œå™¨ä¸­ï¼ŒæŒ‡å‘ç¬¬äºŒä¸ªé¡¶ç‚¹çš„é“¾æ¥ä½äºå…¶æè¿°ä¹‹å‰ã€‚ </p><br><h3 id="plyusy-i-minusy-serializatora"> åºåˆ—åŒ–ç¨‹åºçš„ä¼˜ç¼ºç‚¹ </h3><br><p> ä¼˜ç‚¹ï¼š </p><br><ul><li> åºåˆ—åŒ–å™¨ä»£ç éå¸¸ç®€å•å’Œç´§å‡‘ï¼ˆå¤§çº¦300è¡Œï¼Œå…¶ä¸­ä¸€åŠæ˜¯æ³¨é‡Šï¼‰ã€‚ </li><li> åºåˆ—åŒ–å™¨æ˜“äºä½¿ç”¨ï¼Œä¸éœ€è¦ç¬¬ä¸‰æ–¹åº“ã€‚ </li><li> å†…ç½®äº†å¯¹åºåˆ—åŒ–æ¥å£çš„æ”¯æŒï¼Œä»¥å®ç°å¯¹ç±»çš„ä»»æ„åºåˆ—åŒ–ã€‚ </li><li> ç»“æœä»¤äººæ„‰æ‚¦ï¼Œä»¤äººèµå¿ƒæ‚¦ç›®ï¼ˆIMHOï¼‰ã€‚ </li><li> ç”¨å…¶ä»–è¯­è¨€å¼€å‘ç±»ä¼¼çš„åºåˆ—åŒ–å™¨/ååºåˆ—åŒ–å™¨ä¸æ˜¯é—®é¢˜ã€‚ å¦‚æœåºåˆ—åŒ–çš„ç»“æœåœ¨èƒŒé¢å¤„ç†ï¼Œåˆ™å¯èƒ½éœ€è¦è¿™æ ·åšã€‚ </li></ul><br><p> ç¼ºç‚¹ï¼š </p><br><ul><li> åºåˆ—åŒ–ç¨‹åºéœ€è¦æ³¨å†Œå¯ä»¥åºåˆ—åŒ–çš„ç±»ã€‚ </li><li> å¯¹å¯¹è±¡çš„å­—æ®µåæœ‰ä¸€äº›é™åˆ¶ã€‚ </li><li> åºåˆ—åŒ–å™¨æ˜¯ç”¨Javaè¯­è¨€ç¼–å†™çš„noobï¼Œå› æ­¤å¯èƒ½åŒ…å«é”™è¯¯å’Œé”™è¯¯ã€‚ </li><li> å¤§é‡æ•°æ®çš„æ€§èƒ½å¯èƒ½ä¼šå—åˆ°å½±å“ã€‚ </li></ul><br><p> å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œä»£ç æ˜¯ç”¨ES6ç¼–å†™çš„ã€‚ å½“ç„¶ï¼Œå¯ä»¥è½¬æ¢ä¸ºJavascriptçš„æ—©æœŸç‰ˆæœ¬ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰æ£€æŸ¥ç»“æœä»£ç ä¸ä¸åŒæµè§ˆå™¨çš„å…¼å®¹æ€§ã€‚ </p><br><h3 id="drugie-moi-publikacii"> æˆ‘çš„å…¶ä»–å‡ºç‰ˆç‰© </h3><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨åŠŸèƒ½è§£é‡Šå™¨åœ¨.NETä¸Šå¯¹é¡¹ç›®è¿›è¡Œæœ¬åœ°åŒ–</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç”¨åŸºäºæ¨¡å‹çš„æ•°æ®å¡«å……æ–‡æœ¬æ¨¡æ¿ã€‚</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">.NETä½¿ç”¨åŠ¨æ€å­—èŠ‚ç ï¼ˆILï¼‰å‡½æ•°çš„å®ç°</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN413113/">https://habr.com/ru/post/zh-CN413113/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN413103/index.html">3CX v15.5 Update 5 Betaå’ŒRESTä¸AmoCRMé›†æˆå‘å¸ƒ</a></li>
<li><a href="../zh-CN413105/index.html">ç‰©è”ç½‘æä¾›å•†çš„è¯´æ˜ã€‚ LoraWANä¸­çš„æ¿€æ´»å’Œå®‰å…¨æ€§</a></li>
<li><a href="../zh-CN413107/index.html">Svelto.ECSé¡¹ç›®Wikiçš„ç¿»è¯‘ã€‚ é€‚ç”¨äºUnity3Dçš„ECSæ¡†æ¶</a></li>
<li><a href="../zh-CN413109/index.html">å¦‚ä½•æ„å»ºSaaSäº§å“é›†æˆå¹³å°ï¼šPoster Cloud Checkoutä½“éªŒ</a></li>
<li><a href="../zh-CN413111/index.html">STM32 + NetBeans =ï¼Ÿ</a></li>
<li><a href="../zh-CN413117/index.html">å¦‚ä½•åœ¨bashä¸­å®‰å…¨ç¼–ç¨‹</a></li>
<li><a href="../zh-CN413119/index.html">ä¸Šå‘¨ç¬¬317å¤©ï¼ˆ2018å¹´5æœˆ28æ—¥è‡³6æœˆ3æ—¥ï¼‰çš„å‰ç«¯ä¸–ç•Œæ‘˜è¦</a></li>
<li><a href="../zh-CN413121/index.html">è«æ–¯ç§‘æ¥ç­ç…§ç‰‡ä¹‹æ—…</a></li>
<li><a href="../zh-CN413123/index.html">åŠ å…¥NoSQLæ•°æ®åº“</a></li>
<li><a href="../zh-CN413125/index.html">åŸºå› ç–—æ³•ä¸ºè‚Œè‚‰èç¼©çš„å°æ‚£è€…æä¾›äº†ç”Ÿå­˜çš„æœºä¼š</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>