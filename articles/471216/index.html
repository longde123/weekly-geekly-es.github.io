<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üå®Ô∏è üò∑ ‚úäüèº La larga historia de la gu√≠a: c√≥mo escrib√≠ un servicio para rutas de senderismo inteligentes durante 5 a√±os üßëüèΩ ‚õé üè°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Muchos tienen uno o m√°s de sus proyectos caseros. Estas son peque√±as utilidades, piezas experimentales, muestras de nuevas tecnolog√≠as, "asesinos" de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La larga historia de la gu√≠a: c√≥mo escrib√≠ un servicio para rutas de senderismo inteligentes durante 5 a√±os</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471216/"><p> Muchos tienen uno o m√°s de sus proyectos caseros.  Estas son peque√±as utilidades, piezas experimentales, muestras de nuevas tecnolog√≠as, "asesinos" de Facebook y mucho m√°s.  Notablemente con menos frecuencia, tales proyectos se llevan a cabo durante mucho tiempo. </p><br><p>  En el art√≠culo compartir√© mi experiencia y le contar√© c√≥mo durante 5 a√±os trabaj√© ocasionalmente en el desarrollo de una gu√≠a inteligente para San Petersburgo, c√≥mo logr√© no abandonar este negocio, c√≥mo cambi√≥ la actitud hacia el proyecto y qu√© sucedi√≥ al final. </p><br><p><img src="https://habrastorage.org/webt/ee/8f/lg/ee8flg22vilx7tptxu7jal6iity.jpeg"></p><a name="habracut"></a><br><blockquote>  A continuaci√≥n se describen muchas soluciones t√©cnicas y bicicletas dudosas, pero no se sorprenda: casi todas est√°n justificadas por los objetivos establecidos en ese momento y los recursos disponibles (= generalmente mi conocimiento y tiempo) </blockquote><br><h2 id="ideya">  Idea </h2><br><p>  En cualquier gran ciudad tur√≠stica hay cientos de gu√≠as, buenas y no muy buenas, donde se pintan las rutas principales, se indican los puntos principales y un mont√≥n de otra informaci√≥n √∫til. <br>  Pero las rutas all√≠ son constantes y limitadas, y las vistas son generalmente las m√°s importantes, como "qu√© ver en 3 d√≠as". </p><br><p>  Por lo tanto, surgi√≥ la idea de construir rutas inteligentes.  El usuario selecciona los puntos A y B y recibe no la ruta m√°s corta cl√°sica, sino algo cercano, pero que pasa por las atracciones cercanas. </p><br><p>  La audiencia de tal gu√≠a no es solo turistas, sino tambi√©n residentes locales que desean diversificar sus rutas t√≠picas a casa / trabajo / tienda (¬°y hubo tales cr√≠ticas en la aplicaci√≥n!) O simplemente mejor conocer la ciudad. </p><br><p>  <strong>TL; DR</strong> <br>  La conclusi√≥n es la aplicaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Wander para</a> Android, que ahora solo funciona para San Petersburgo. </p><br><h2 id="akt-1-prototip">  Acto 1: prototipo </h2><br><p> La idea surgi√≥ en la universidad en 2014, ni siquiera estoy seguro de que la idea fuera originalmente m√≠a, en alg√∫n curso fue necesario dividirse en grupos, presentar proyectos y completarlos como un documento final.  Se estrellaron y generaron la idea del proyecto, y luego comenz√≥ el nombre <code>TravelPath</code> . </p><br><p>  Se supon√≠a que era un servicio web, sab√≠a un poco sobre PHP, as√≠ que eleg√≠ PHP. <br>  Fue necesario resolver varios problemas: </p><br><p>  <strong>1. Base de atracciones</strong> <br>  Aqu√≠ nos reunimos con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OpenStreetMap</a> , result√≥ que este es el proyecto m√°s genial que nos queda perfectamente.  OSM es un proyecto de mapa comunitario sin fines de lucro basado en la comunidad.  Al igual que Wikipedia, solo sobre mapas. <br>  Descargue el mapa en formato xml de San Petersburgo: <a href="">hay</a> una lista de recursos donde puede hacer esto. <br>  Recuerdo que en ese momento, los archivos de mapas pesaban m√°s de 1 GB, por lo que se escribe un analizador de transmisi√≥n que selecciona objetos de categor√≠as preseleccionadas: monumentos, parques, iglesias, museos. <br>  OSM tiene una amplia documentaci√≥n sobre etiquetas, atributos y todo lo que necesita <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> , gracias a √©l no ser√° dif√≠cil descubrir c√≥mo obtener los datos que necesita de las tarjetas. </p><br><p>  Los datos cartogr√°ficos son creados por entusiastas, por lo tanto, no en todas partes y no siempre los objetos tienen las etiquetas necesarias, algunos lugares tienen errores, problemas.  Pero para las grandes ciudades, los datos son de bastante alta calidad. </p><br><p>  Si desenterr√© correctamente mi c√≥digo anterior, us√© las siguientes etiquetas para buscar objetos: </p><br><ul><li>  <code>building</code> significa <code>cathedral</code> , <code>chapel</code> , <code>church</code> ha convertido en una categor√≠a de <code>church</code> </li><li>  <code>amenity</code> con valores de la <code>fountain</code> cae en <code>monument</code> </li><li>  <code>tourism</code> con <code>artwork</code> y valores de <code>viewpoint</code> va al <code>monument</code> , <code>zoo</code> y <code>museum</code> a <code>museum</code> , y <code>park</code> <code>theme_park</code> al <code>park</code> </li><li>  <code>historic</code> con <code>boundary_stone</code> , <code>castle</code> , <code>memorial</code> , los valores del <code>monument</code> van a la categor√≠a de <code>monument</code> </li><li>  <code>leisure</code> con un valor en el <code>park</code> naturalmente, termina en el <code>park</code> </li></ul><br><p>  ¬°Ponemos todos los objetos recibidos en una base de datos con coordenadas y nos alegramos!  Se han lanzado m√°s de 1.200 puntos en San Petersburgo. </p><br><p>  <strong>2. Construyendo una ruta</strong> <br>  No estaba destinado a implementar sistemas complejos como parte del curso, y el conocimiento t√©cnico en ese momento era escaso, por lo que decidimos dividir la construcci√≥n de la ruta en dos partes: la elecci√≥n de los objetos en la ruta y la construcci√≥n de la ruta en s√≠.  En parte, esto determin√≥ el destino del futuro, porque m√°s tarde no quise cambiar este esquema. </p><br><p>  La construcci√≥n de una ruta entre los puntos seleccionados fue dada por la API de Google Maps, que construy√≥ rutas de autom√≥viles bastante bien, pero en ese momento no sab√≠a c√≥mo caminar, al menos en Rusia. </p><br><p>  La elecci√≥n de los objetos tuvo que ser implementada por usted mismo.  Result√≥ el siguiente esquema de la aplicaci√≥n: </p><br><p><img src="https://habrastorage.org/webt/qf/ji/cu/qfjicujbis8zm-4ojiuumt9vkqk.jpeg"></p><br><p>  La principal desventaja del enfoque es la selecci√≥n de puntos en la ruta sin tener en cuenta el mapa, solo en funci√≥n de las coordenadas GPS.  Y, en general, esto funciona razonablemente bien, especialmente donde hay una cuadr√≠cula de calles frecuente.  Problemas raros son notables a lo largo de r√≠os con puentes raros, por ejemplo. </p><br><p>  A continuaci√≥n, se nos ocurre un algoritmo para seleccionar puntos en la ruta.  Por un lado, es necesario que la ruta no se desv√≠e mucho hacia un lado, pero por otro lado todav√≠a selecciona algunos puntos en los vecindarios dados. </p><br><p>  No es una declaraci√≥n muy clara del problema, sali√≥ el mismo algoritmo, algo similar a A * ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">wiki</a> ): se cree que desde cada punto hay transiciones a cada uno.  Adem√°s, en A *, el precio de ir al v√©rtice n cuando se busca la ruta AB generalmente se expresa de la siguiente manera: <code>f(n) = g(An) + h(nB)</code> , donde <code>g(x,y)</code> es la longitud del camino de x a y, y <code>h(x,y)</code> es una estimaci√≥n heur√≠stica de la distancia de xay.  Mi precio es el mismo: <code>f(n) = h(x,n) + h(n,y) * q</code> , donde q es una constante menor que 1. Al cambiar el valor de q, puede afectar el n√∫mero de puntos en la ruta. </p><br><p>  Implementamos el algoritmo y, por supuesto, todo funciona, ajustamos la interfaz, compramos un dominio, lo subimos al hosting, escribimos informes y otros burocracias y nos regocijamos.  Se parec√≠a a esto (y no cambi√≥ mucho despu√©s): </p><br><p><img src="https://habrastorage.org/webt/b3/fw/uz/b3fwuz0lqz_x3z2adx9qv-usau8.jpeg"></p><br><p>  <strong>Total:</strong> obtuve un prototipo de una idea genial, me familiaric√© con OSM, Google API, trabaj√© en equipo, obtuve cr√©dito en la universidad y tambi√©n fue interesante. </p><br><h2 id="akt-2-pervaya-polnocennaya-web-versiya">  Acto 2: primera versi√≥n web completa </h2><br><p>  Realmente me gust√≥ la idea y decid√≠ desarrollarla m√°s, pero ya es una.  Y fue claro de inmediato lo que se necesitaba en primer lugar: en ese momento, Google Maps a√∫n no pod√≠a construir rutas para caminar, solo se estaban construyendo las de autom√≥viles.  Y toda la idea de la aplicaci√≥n se trata principalmente de caminar, lo que significa que debe poder construir rutas a lo largo de los callejones sombreados de parques, caminos peatonales, puentes y mucho m√°s. </p><br><p>  Fue en 2015, y continu√© trabajando en TravelPath, asum√≠ la correcci√≥n de este defecto fatal: comenc√© a construir caminos por mi cuenta. </p><br><p>  No cambi√© la tecnolog√≠a, <code>PHP</code> + <code>MySQL</code> .  Por supuesto, inmediatamente me di cuenta de que esta no era la mejor pila t√©cnica para tal tarea (¬øconstruir rutas en PHP? ¬øEn serio?). <br>  Pero estaba limitado en el tiempo y no estaba listo para cambiar a una pila m√°s razonable, y en segundo lugar, hasta ahora el proyecto estaba escrito "sobre la mesa": me gustar√≠a usar una aplicaci√≥n de este tipo desde un dispositivo m√≥vil, y en esos a√±os solo significaba desarrollo nativo.  Es decir, su inaplicabilidad en forma de versi√≥n web era obvia, incluso a pesar de algunos intentos de hacer una interfaz adaptativa. </p><br><p>  Surgieron las siguientes tareas: </p><br><p>  <strong>1. Obteniendo un gr√°fico de ciudad</strong> <br>  Aqu√≠ el mismo OSM nos salva.  Nuevamente, descargue el gr√°fico en formato xml, anal√≠celo, seleccione solo los tipos de caminos necesarios y admire la cantidad de datos; en ese momento, salieron m√°s de 3 millones de v√©rtices y 500k bordes.  La primera idea es que el gr√°fico puede no estar relacionado. <br>  Los patios, territorios cerrados, cosas incomprensibles no son muy interesantes para construir una ruta, por lo que seleccionamos alg√∫n punto, rodeamos todo el gr√°fico, marcamos los v√©rtices pasados ‚Äã‚Äãy obtenemos la parte conectada del gr√°fico. <br>  En total, salieron m√°s de 600k picos y 150k bordes. <br>  Guardado lo recibido en la base de datos y se fue hasta mejores tiempos. </p><br><p>  <strong>2. Construyendo una ruta</strong> <br>  Hay datos, todo queda en manos de los peque√±os: crea rutas en ellos.  No tuvimos que inventar nada nuevo: recuerde el curso de los algoritmos, lea cuidadosamente los art√≠culos sobre el trabajo con gr√°ficos, tome el algoritmo A *, implem√©ntelo en PHP y <del>  alegrarse </del>  frustrado por lo lento que funciona todo. </p><br><p>  Hay muchos datos, por lo tanto, al construir el gr√°fico, no utilizamos el completo, sino que solo leemos parte de √©l, todo lo que cae dentro del rect√°ngulo obtenido de todos los puntos seleccionados en la ruta. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qc/p7/9k/qcp79klhlir-x7udd5im-0h-cw0.jpeg"></div><br><p>  (marco rojo = ~ dicho gr√°fico fue le√≠do para construir la ruta) </p><br><p>  Lo mismo con los puntos candidatos para la ruta: tenemos en cuenta no todo, sino solo aquellos entre el inicio y el final + un valor peque√±o. <br>  Habiendo seleccionado el tama√±o de este rect√°ngulo (la constante por la cual lo incrementamos), tratamos de garantizar que leamos el tama√±o m√≠nimo de datos requerido. <br>  Tambi√©n exist√≠a la idea de dividir la ciudad en cuadrados, construir la ruta primero por cuadrados, y luego leer el gr√°fico dentro de estos cuadrados y buscar un camino solo a lo largo de √©l.  Y puede calcular previamente las rutas entre todos los cuadrados vecinos.  O incluso m√°s: para calcular y guardar el camino entre todas las vistas.  Luego, sobre la marcha, solo queda construir los caminos desde el primer objeto hasta el primero, y desde el √∫ltimo objeto hasta la l√≠nea de meta. <br>  Pero las manos no alcanzaron la realizaci√≥n de tales bicicletas. </p><br><p>  <strong>3. Enrutamiento en un tiempo razonable</strong> <br>  Inmediatamente se hizo evidente que el cuello de botella es el almacenamiento y el trabajo con datos: el algoritmo de b√∫squeda en s√≠ no est√° particularmente acelerado.  Y los puntos de referencia en la rodilla confirman que la mayor parte del tiempo se pasa leyendo de la base de datos y manipulaciones similares. <br>  ¬øQu√© se debe hacer en tales casos?  No almacene este gr√°fico.  Pero tengo una forma especial, <code>MySQL</code> y nada m√°s, pero el problema debe resolverse. </p><br><ol><li>  El primero: los datos se normalizaron, lo cual era conveniente al analizar, pero leer decenas de miles de registros e incluso de dos tablas es doloroso.  La soluci√≥n obvia es hacer una de dos tablas (para v√©rtices y aristas), solo para aristas, en las que en cada registro se registran las coordenadas de ambos v√©rtices y su id. </li><li>  Contamos por adelantado los v√©rtices m√°s cercanos del gr√°fico a las vistas, y no lo hacemos sobre la marcha cada vez. </li><li>  Se gasta una cantidad significativa de tiempo buscando el punto del gr√°fico m√°s cercano al usuario dado.  Para acelerar esto, divid√≠ todo el gr√°fico en peque√±os sectores, usando la f√≥rmula de coordenadas, puede obtener instant√°neamente la identificaci√≥n del sector y luego seleccionar el v√©rtice solo dentro del sector, y no en todo el gr√°fico, que es mucho m√°s r√°pido. </li></ol><br><p>  Despu√©s de todas las manipulaciones, obtenemos la construcci√≥n de cualquier ruta de caminata razonable en San Petersburgo en 2 segundos, lo que suena bien: este es un tiempo de espera aceptable para los usuarios. <br>  El esquema final sali√≥ as√≠: </p><br><p><img src="https://habrastorage.org/webt/gk/f0/mh/gkf0mhnk5i9xnnnm6g1eym_a3ce.jpeg"></p><br><p>  <strong>Total: Conoc√≠</strong> a√∫n mejor los datos de OSM, en la pr√°ctica resolv√≠ problemas de gr√°ficos (el caso cuando los algoritmos de gr√°ficos finalmente fueron √∫tiles), escrib√≠ mis primeros puntos de referencia. </p><br><h2 id="akt-3-pervaya-normalnaya-web-versiya">  Acto 3: la primera versi√≥n web normal </h2><br><p>  Aqu√≠ vienen los primeros pensamientos sobre el proyecto como un producto que puede ser √∫til para alguien, y no sobre las manualidades sobre la mesa. <br>  Por lo tanto, debe resolver los dos problemas m√°s importantes: </p><br><ol><li>  Era inmediatamente obvio que construir rutas como lo hice en el √∫ltimo p√°rrafo est√° mal. </li><li>  Una gu√≠a en el navegador puede no ser conveniente para nadie: desea caminar por la ciudad, buscando una aplicaci√≥n conveniente donde pueda leer lo que es especial, etc.  En resumen, al menos, necesita una interfaz adaptativa genial y, en el buen sentido, una aplicaci√≥n m√≥vil. </li></ol><br><p>  Pero en esta etapa, decid√≠ tratar solo con el primer punto.  Estudiamos Internet sobre este tema y aqu√≠ nuevamente OSM ayuda, o mejor dicho, el proyecto que naci√≥ gracias a ellos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OSRM</a> . <br>  Basado en datos de mapas de OSM, la m√°quina de enrutamiento de c√≥digo abierto puede construir una variedad de rutas en un buen momento.  S√≠, y un proyecto de c√≥digo abierto con buena documentaci√≥n que puede instalar en su servidor y usar. <br>  Como beneficio adicional, tambi√©n tiene una API bastante conveniente. <br>  Y antaresm ya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">escribi√≥</a> sobre OSRM en un habr que me ayud√≥ en ese momento.  Es cierto que ha fluido mucha agua y el art√≠culo est√° desactualizado.  Pero muchas gracias al autor!  La documentaci√≥n real y bastante buena est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br>  Despu√©s de una instalaci√≥n exitosa, descartamos, casi sin arrepentimiento, todo nuestro c√≥digo sobre las rutas y comenzamos a seguir las rutas en la API OSRM, y el diagrama final es el siguiente: </p><br><p><img src="https://habrastorage.org/webt/by/2_/sg/by2_sgklt4qfns1b6l_i544t9z8.jpeg"></p><br><p>  Ni siquiera tocamos la parte del cliente; por su parte, la API de nuestro servicio no cambia. </p><br><p>  <strong>Total</strong> : pens√© en el uso real de la aplicaci√≥n por parte de otros, result√≥ ser una arquitectura normal y buenas rutas.  La versi√≥n web todav√≠a est√° disponible, aunque no ha cambiado desde entonces.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://travelpath.ru/</a> </p><br><h2 id="akt-4-android-prilozhenie">  Acto 4: aplicaci√≥n de Android </h2><br><p>  A pesar de la soluci√≥n a un problema pasado, todav√≠a est√° claro que el proyecto sigue siendo in√∫til para todos, excepto para m√≠.  Porque necesita una interfaz normal y, lo m√°s importante, una aplicaci√≥n m√≥vil, no una versi√≥n de navegador.  Ahora la tecnolog√≠a ha avanzado y, tal vez, ya ser√° posible crear una aplicaci√≥n de navegador de este tipo que funcione bien para clientes m√≥viles, pero no en 2015-2016.  Lo que significaba una posibilidad muy limitada de utilizar el proyecto en forma de versi√≥n web: sentarse en casa, seleccionar lugares interesantes para visitar con anticipaci√≥n.  Por lo tanto, si estamos hablando de un producto normal, necesita una aplicaci√≥n m√≥vil con una buena interfaz. </p><br><p>  Luego, en 2016, comenc√© a escribir en Java (pero en el backend) y pens√© que en Android tambi√©n escrib√≠an en Java.  ¬øPor qu√© no probar el desarrollo de aplicaciones? Deber√≠a ser una experiencia interesante. <br>  El segundo problema es que no s√© c√≥mo dise√±ar y no har√© una buena interfaz yo mismo.  Vine a visitar mi primer lugar de trabajo (un peque√±o estudio Le-Dantu) e invit√© a mi colega <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">burovk a</a> participar en el proyecto.  Por extra√±o que parezca, estuvo de acuerdo, por lo que muchas gracias :) </p><br><p>  <strong>Los primeros dise√±os y prototipos.</strong> <br>  En primer lugar, estamos tratando de encontrar un nuevo nombre, porque TravelPath no es una abreviatura muy, y tambi√©n hablando.  Y as√≠, a trav√©s de los esfuerzos de Cyril aparece "Wander" con un logotipo divertido: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6t/8y/7f/6t8y7fht6pqmxvwnajhrtimxe5u.png"></div><br><p>  Lo he asociado fuertemente con un hombre bigotudo, pero en general me gusta. </p><br><p>  Luego aparecen los primeros dise√±os de la aplicaci√≥n futura: </p><br><p><img src="https://habrastorage.org/webt/t4/u6/x8/t4u6x8pszrlpk7vop64rizgsywu.jpeg"></p><br><p>  Tambi√©n pensamos, discutimos, aparece la segunda opci√≥n, que se convierte en la primera versi√≥n de la aplicaci√≥n: </p><br><p><img src="https://habrastorage.org/webt/uk/nr/py/uknrpyeckiz1gdqogmtyngojun4.jpeg"></p><br><p>  Desde el lado del desarrollo, conscientemente decid√≠ no usar todo tipo de marcos de moda que hagan magia diferente, porque existen grandes riesgos al usarlos sin comprender el trabajo, y estudiar tanto los conceptos b√°sicos como los que requieren demasiado tiempo.  Google, leemos muelles oficiales, art√≠culos educativos y superamos dificultades. </p><br><p>  De los problemas y tareas que se recuerdan: </p><br><ul><li>  Para Android, existe <code>ProGuard</code> , una utilidad que comprime el c√≥digo fuente durante el ensamblaje, elimina lo no utilizado, cambia los nombres y m√°s.  Es razonable que exista, pero cuando ingresa al desarrollo y lo hace usted mismo, no es obvio que haya cambios de nombre en los campos y esto puede afectar el comportamiento.  Y que todo sucede solo en el montaje de productos.  Como resultado del lanzamiento, todo es genial, pero por alguna raz√≥n no hay estad√≠sticas.  Comienza a debitar desde el backend, y el cliente env√≠a algunas tonter√≠as, en lugar de los nombres de campo normales: <code>a, b, c</code> , etc.  Muletas para que la API pueda analizar esto h√°bilmente, y luego descubres que ProGuard lo intent√≥ y necesitas especificar las clases necesarias como una excepci√≥n en su configuraci√≥n.  Nada inusual en general, pero el reloj de depuraci√≥n se fue volando. </li><li>  Una tarea interesante fue actualizar los datos de la aplicaci√≥n.  La base de datos principal viene con un archivo <code>apk</code> y lo actualizo antes de cada lanzamiento.  Pero tambi√©n debe admitir la actualizaci√≥n a trav√©s de la red para que los clientes siempre tengan datos nuevos si hay alg√∫n cambio. <br>  En la primera versi√≥n, decid√≠ centrarme en el momento de la √∫ltima actualizaci√≥n.  La aplicaci√≥n almacena el tiempo del objeto m√°s fresco, en cada inicio le pregunta al backend con este tiempo si ha aparecido algo nuevo.  Se le env√≠an actualizaciones, el cliente recuerda nuevamente la hora del m√°s nuevo de los objetos recibidos (pero no la hora de la actualizaci√≥n en s√≠, esto es importante). <br>  Result√≥ que pens√© mal, porque un a√±o despu√©s apareci√≥ una quinta categor√≠a: edificios.  Y al actualizar de la versi√≥n anterior a la nueva, surge un problema.  Tuve que cambiar un poco y el cliente env√≠a tiempo para cada categor√≠a, no la general.  Pero el esquema a√∫n no es perfecto: al agregar nuevos campos a los objetos, surgen problemas que no se pueden resolver de esa manera.  Hay ideas sobre c√≥mo hacerlo mejor, pero las manos no llegaron y, en general, la tarea no es muy prioritaria.  Moralidad: vale la pena abordar estos temas con cuidado y pensar con un poco de anticipaci√≥n. </li></ul><br><p>  Y tambi√©n quiero decir lo que todo el mundo ya sabe: Stack Overflow es incre√≠blemente genial y esto es especialmente notable cuando vuelas al desarrollo de algo extra√±o como yo lo hice: escribe inmediatamente la aplicaci√≥n, y no sin problemas de cursos, gu√≠as, ejemplos de demostraci√≥n .  Y cuando no hay nadie para preguntarle a un amigo.  Pero adem√°s de √©l, los chats sobre el desarrollo de Android tambi√©n ayudaron: all√≠ puede hacer preguntas m√°s abstractas y pedir consejos sobre la mejor manera de hacer algo. </p><br><p>  5 de diciembre de 2016 la aplicaci√≥n llega a Google Play <br>  Solo ten√≠a funciones b√°sicas: trazar una ruta, ver informaci√≥n sobre puntos.  ¬°Pero incluso eso parec√≠a un √©xito!  El √©xito, por supuesto, solo en sus propios ojos.  Se entendi√≥ que la aplicaci√≥n a√∫n est√° en bruto y necesita ser mejorada. </p><br><p>  <strong>La primera versi√≥n completa y los medios</strong> <br>  Por lo tanto, considero que el pr√≥ximo lanzamiento es una versi√≥n completa y el primer lanzamiento. <br>  En primer lugar, revisamos tanto el dise√±o como el logotipo; ahora se ha convertido as√≠: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4c/0q/ii/4c0qii9_t77tgksfkp31mldx94k.png" width="96"></div><br><p>  Y agregaron funcionalidades importantes para la gu√≠a: favoritos, puntos de vista en el mapa, una lista de atracciones con una b√∫squeda.  La aplicaci√≥n actualizada se ve√≠a as√≠: </p><br><p><img src="https://habrastorage.org/webt/eo/fh/2j/eofh2jhc1tjz8lyrc1t-ra9kpnk.jpeg"></p><br><p>  Otra idea surgi√≥: contactar a Museum Night y hacer un modo separado para el evento en San Petersburgo. <br>  La Noche de los museos es una fiesta internacional anual en la que los museos est√°n abiertos por la noche, a menudo con programas especiales.  Un boleto √∫nico es v√°lido y muchos intentan moverse por muchos museos a la vez.  Al mismo tiempo, no hay un navegador / mapa para dispositivos m√≥viles, solo algunas funcionalidades en el sitio web oficial del evento. <br>  Parece que encaja perfectamente con la idea de Wander y tambi√©n est√° en demanda.  Me puse en contacto con los organizadores del evento, pero, desafortunadamente, la idea no fue apreciada y se mantuvo en mi mente hasta tiempos mejores. </p><br><p>  Al final, result√≥ genial y finalmente la aplicaci√≥n se pudo usar por completo.  El 2 de junio de 2018, se lanz√≥ un lanzamiento y decidimos intentar mostr√°rselo al mundo: compramos publicidad en VKontakte e Instagram.  Pero lo m√°s importante, escribieron a un par de medios de comunicaci√≥n.  El peri√≥dico escribi√≥ una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nota</a> sobre el lanzamiento de la aplicaci√≥n, luego de que varias publicaciones de Petersburgo - The Village, Dog y otras - fueran escritas o reimpresas con un abanico.  ¬°Y finalmente hubo tr√°fico!  Las instalaciones se apresuraron con un pico, gr√°ficos de actividad dentro de la aplicaci√≥n, tambi√©n.  Por supuesto, no tuvimos que alegrarnos por mucho tiempo, pero obtuvimos los primeros usuarios, comentarios √∫tiles y, en general, fue muy motivador.  En el mismo verano, el tr√°fico de la b√∫squeda de Google Play fue notable, lo que fue muy agradable, pero m√°s tarde el resultado no pudo reproducirse. <br>  En conjunto, esto dio una motivaci√≥n bastante fuerte y ayud√≥ a seguir trabajando en la aplicaci√≥n. </p><br><p>  <strong>¬øQu√© hacer a continuaci√≥n?</strong>  <strong>Noche de museo, malvado Google, rutas circulares</strong> </p><br><p>  La temporada ha pasado, la actividad en la aplicaci√≥n ha ca√≠do dr√°sticamente y estaba claro que solo las funciones de corte no son muy √∫tiles: nadie las ver√°, no hay presupuesto para el marketing.  Era necesario pensar en algo y luego volvimos a la idea postergada con la Noche de los museos. <br>  Pero, de nuevo, no fue posible acordar una asociaci√≥n, sin embargo, esta vez decidimos no posponer la idea, sino hacer todo por nuestra cuenta.  Result√≥ una serie de caracter√≠sticas √∫tiles en un modo de gu√≠a separado: museos en el mapa, rutas solo para participantes, informaci√≥n breve, favoritos. </p><br><p>  Adem√°s de este modo, incluso desde el trabajo atrasado obtuvimos la preservaci√≥n de la ruta y, lo m√°s importante, la caracter√≠stica de las rutas circulares. </p><br><p>  Las rutas circulares siempre fueron m√°s importantes que las rutas AB, pero se ignoraron obstinadamente.  A√∫n as√≠, las personas a menudo caminan alrededor del metro / casa / trabajo / hotel que a prop√≥sito de A a B. Finalmente, llegaron a sus manos y se me ocurri√≥ una simple heur√≠stica: <br>  Obtenemos todos los puntos dentro del radio dado.  El radio es el limitador de la longitud de la ruta.  Seleccionamos alg√∫n punto primero (condicionalmente aleatorio).  Todos los dem√°s est√°n ordenados en orden ascendente del √°ngulo entre este, el centro y el punto dado.          /  ,  . </p><br><p>       ,            . </p><br><p>     ,  ,   : </p><br><p><img src="https://habrastorage.org/webt/fe/nx/6s/fenx6slnfgifc85nw-prhsv51mq.jpeg"></p><br><p>    ,   ,       ,     ,  ,    .     ‚Äî  ,         , . </p><br><p>        Kotlin   , ,   Wander.   ,     .    ,   .         ,     java   ‚Äî       . </p><br><p>     ,  ,  ,   .          ‚Äî    The Village.        -        1000 ,    1400   . ,      Wander  , , ,       .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> . </p><br><p>    Google  .            ‚Äî  2018      ,         API.        ‚Äî         2018-        <code>Places API</code>   .         API,   -  ‚Äî        .        . </p><br><p>        ‚Äî  <code>Places API</code> ,          .        ,      .  ,         ‚Äî   Google Maps,    .           . </p><br><p> <strong></strong> :  android        Google Play,       .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">burovk</a> ,    Wander    ,       . </p><br><h2 id="ty-teper-ne-tolko-razrabotchik">      </h2><br><p>    ,   ,       ,     ‚Äî       .      ,  ,    ,      ‚Äî     .   ,   ‚Äî ,      .    ,         ,     . </p><br><ul><li>                 ‚Äî          <code>git tag v1.0.5</code> . </li><li>   ,   ,   ,    . </li><li>         -   ,       . </li><li>            ‚Äî      ,    //etc       . </li></ul><br><p>        Android  .      , ,      ,       . </p><br><p>       ‚Äî      ,    . </p><br><h2 id="plany">  </h2><br><p>  !  ,       .  , ,    ,           ,      ,   . <br>      : </p><br><ol><li>     ‚Äî ? -   ? </li><li>   .   ,    ‚Äî   . </li><li>   IOS </li><li>   </li></ol><br><p>     . ,   IOS      ,    . </p><br><p>      ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  </a> .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Google Play</a> . </p><br><h2 id="vyvody">  Conclusiones </h2><br><ul><li>      ,   ‚Äî .      ,          .           . ,       . </li><li>   ‚Äî  ,      .   backend ,       ,    android   Kotlin,   ,  ,     .     ,     . </li><li>      ‚Äî .      - ,           .   -   .   ,    ‚Äî   . </li></ul><br><p>     .         IOS (   ) ‚Äî   ! </p><br><p>  PS <br>         ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://habr.com/post/414433/</a> .         . ,       (    -!),       . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471216/">https://habr.com/ru/post/471216/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471198/index.html">Estudiamos la declaraci√≥n del teorema del l√≠mite central usando la distribuci√≥n exponencial</a></li>
<li><a href="../471202/index.html">C√≥mo no pude encender mi MacBook debido a la desinstalaci√≥n de TeamViewer</a></li>
<li><a href="../471204/index.html">Reconocer fecha y hora en lenguaje natural</a></li>
<li><a href="../471210/index.html">Dios ... Balada sobre un programador</a></li>
<li><a href="../471212/index.html">10 consejos y trucos para ayudarte a convertirte en el mejor desarrollador de VueJS</a></li>
<li><a href="../471220/index.html">Cockpit: simplifique las tareas administrativas t√≠picas en Linux a trav√©s de una interfaz web conveniente</a></li>
<li><a href="../471222/index.html">Comprender las pol√≠ticas de privacidad de aplicaciones y servicios ayudar√° a las redes neuronales</a></li>
<li><a href="../471226/index.html">Linux tiene muchas caras: c√≥mo trabajar en cualquier distribuci√≥n</a></li>
<li><a href="../471228/index.html">Grokay PyTorch</a></li>
<li><a href="../471232/index.html">Mi experiencia conectando LPS331AP a Omega Onion2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>