<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ£ ğŸ“ƒ ğŸ”º åœ¨Golangå’ŒgRPCä¸Šæ„å»ºå¾®æœåŠ¡æ¶æ„ï¼Œç¬¬1éƒ¨åˆ† â†™ï¸ ğŸ‰ ğŸ‘ŠğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¾®æœåŠ¡æ¶æ„ç®€ä»‹ 
 ç¬¬1éƒ¨åˆ†ï¼ˆå…±10éƒ¨åˆ†ï¼‰ 


 æ”¹ç¼–çš„Ewan Valentineæ–‡ç« ã€‚ 


 è¿™æ˜¯ä¸€ä¸ªç”±åéƒ¨åˆ†ç»„æˆçš„ç³»åˆ—ï¼Œæˆ‘å°†å°è¯•æ¯æœˆæ’°å†™ä¸€æ¬¡æœ‰å…³åœ¨Golangä¸Šæ„å»ºå¾®æœåŠ¡çš„æ–‡ç« ã€‚ æˆ‘å°†ä½¿ç”¨protobufå’ŒgRPCä½œä¸ºä¸»è¦çš„ä¼ è¾“åè®®ã€‚ 


 æˆ‘ä½¿ç”¨çš„å †æ ˆï¼šgolangï¼Œmongodbï¼Œg...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨Golangå’ŒgRPCä¸Šæ„å»ºå¾®æœåŠ¡æ¶æ„ï¼Œç¬¬1éƒ¨åˆ†</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425653/"><h2 id="vvedenie-v-mikroservisnuyu-arhitekturu"> å¾®æœåŠ¡æ¶æ„ç®€ä»‹ </h2><br><h4 id="chast-1-iz-10"> ç¬¬1éƒ¨åˆ†ï¼ˆå…±10éƒ¨åˆ†ï¼‰ </h4><br><p> æ”¹ç¼–çš„Ewan Valentineæ–‡ç« ã€‚ </p><br><p> è¿™æ˜¯ä¸€ä¸ªç”±åéƒ¨åˆ†ç»„æˆçš„ç³»åˆ—ï¼Œæˆ‘å°†å°è¯•æ¯æœˆæ’°å†™ä¸€æ¬¡æœ‰å…³åœ¨Golangä¸Šæ„å»ºå¾®æœåŠ¡çš„æ–‡ç« ã€‚ æˆ‘å°†ä½¿ç”¨protobufå’ŒgRPCä½œä¸ºä¸»è¦çš„ä¼ è¾“åè®®ã€‚ </p><br><p> æˆ‘ä½¿ç”¨çš„å †æ ˆï¼šgolangï¼Œmongodbï¼Œgrpcï¼Œdockerï¼ŒGoogle Cloudï¼ŒKubernetesï¼ŒNATSï¼ŒCircleCIï¼ŒTerraformå’Œgo-microã€‚ </p><br><p> æˆ‘ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªï¼Ÿ ç”±äºèŠ±äº†æˆ‘å¾ˆé•¿æ—¶é—´æ‰å¼„æ¸…æ¥šå¹¶è§£å†³ç´¯ç§¯çš„é—®é¢˜ã€‚ æˆ‘è¿˜æƒ³ä¸æ‚¨åˆ†äº«æˆ‘åœ¨Goå’Œå…¶ä»–æ–°æŠ€æœ¯ä¸Šåˆ›å»ºï¼Œæµ‹è¯•å’Œéƒ¨ç½²å¾®æœåŠ¡çš„çŸ¥è¯†ã€‚ </p><br><p> åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘æƒ³å±•ç¤ºæ„å»ºå¾®æœåŠ¡çš„åŸºæœ¬æ¦‚å¿µå’ŒæŠ€æœ¯ã€‚ è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç®€å•çš„å®ç°ã€‚ è¯¥é¡¹ç›®å°†å…·æœ‰ä»¥ä¸‹å®ä½“ï¼š </p><br><ul><li> è´§è¿ </li><li> åº“å­˜ </li><li> è¯•ç”¨ </li><li> ç”¨æˆ· </li><li> è§’è‰² </li><li> è®¤è¯æ–¹å¼ </li></ul><a name="habracut"></a><br><img src="https://habrastorage.org/webt/rw/x9/gb/rwx9gbtjbpn9m44olxapvk2ecgq.jpeg"><br><p> è¦èµ°å¾—æ›´è¿œï¼Œæ‚¨éœ€è¦å®‰è£…Golangå’Œå¿…è¦çš„åº“ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªgitå­˜å‚¨åº“ã€‚ </p><br><h2 id="teoriya"> ç†è®º </h2><br><h4 id="chto-takoe-mikroservisnaya-arhitektura"> ä»€ä¹ˆæ˜¯å¾®æœåŠ¡æ¶æ„ï¼Ÿ </h4><br><p> å¾®æœåŠ¡å°†å•ç‹¬çš„åŠŸèƒ½éš”ç¦»åˆ°æœåŠ¡ä¸­ï¼Œå°±æ­¤æœåŠ¡æ‰§è¡Œçš„åŠŸèƒ½è€Œè¨€ï¼Œå®ƒä»¬æ˜¯è‡ªç»™è‡ªè¶³çš„ã€‚ ä¸ºäº†ä¸å…¶ä»–æœåŠ¡å…¼å®¹ï¼Œå®ƒå…·æœ‰ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„é¢„å®šä¹‰æ¥å£ã€‚ <br> å¾®æœåŠ¡ä½¿ç”¨é€šè¿‡æŸäº›ä¸­é—´æ¶ˆæ¯ä»£ç†ä¼ è¾“çš„æ¶ˆæ¯ç›¸äº’é€šä¿¡ã€‚ </p><br><img src="https://habrastorage.org/webt/tr/aq/dm/traqdmhafa_yvh0haprr05w7rgo.png"><br><p> ç”±äºå¾®æœåŠ¡æ¶æ„ï¼Œè¯¥åº”ç”¨ç¨‹åºæ— æ³•æ•´ä½“æ‰©å±•ï¼Œä½†å¯ä»¥éƒ¨åˆ†æ‰©å±•ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆæƒæœåŠ¡æ¯”å…¶ä»–æœåŠ¡æ›´é¢‘ç¹åœ°â€œæŠ½æâ€ï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ å®ä¾‹æ•°é‡ã€‚ è¯¥æ¦‚å¿µæ€»ä½“ä¸Šä¸äº‘è®¡ç®—å’Œå®¹å™¨åŒ–çš„æ¦‚å¿µä¸€è‡´ã€‚ </p><br><h4 id="pochemu-golang"> ä¸ºä»€ä¹ˆé€‰æ‹©é«˜æœ— </h4><br><p> å‡ ä¹æ‰€æœ‰è¯­è¨€éƒ½æ”¯æŒå¾®æœåŠ¡ï¼Œæ¯•ç«Ÿï¼Œå¾®æœåŠ¡æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œè€Œä¸æ˜¯ç‰¹å®šçš„ç»“æ„æˆ–å·¥å…·ã€‚ ä½†æ˜¯ï¼ŒæŸäº›è¯­è¨€æ¯”å…¶ä»–è¯­è¨€æ›´é€‚åˆï¼Œå¹¶ä¸”å¯¹å¾®æœåŠ¡ä¹Ÿæœ‰æ›´å¥½çš„æ”¯æŒã€‚  Golangæ˜¯ä¸€ç§å—æ”¯æŒçš„è¯­è¨€ã€‚ </p><br><h4 id="poznakomimsya-s-protobufgrpc"> è®¤è¯†protobuf / gRPC </h4><br><p> å¦‚å‰æ‰€è¿°ï¼Œå¾®æœåŠ¡è¢«åˆ’åˆ†ä¸ºå•ç‹¬çš„ä»£ç åº“ï¼Œä¸å¾®æœåŠ¡ç›¸å…³çš„é‡è¦é—®é¢˜ä¹‹ä¸€æ˜¯é€šä¿¡ã€‚ å¦‚æœæ‚¨æ‹¥æœ‰æ•´ä½“ï¼Œåˆ™å¯ä»¥ç›´æ¥ä»ç¨‹åºçš„å¦ä¸€ä¸ªä½ç½®ç›´æ¥è°ƒç”¨ä»£ç ã€‚ </p><br><p> ä¸ºäº†è§£å†³é€šä¿¡é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ ç»Ÿçš„RESTæ–¹æ³•ï¼Œå¹¶é€šè¿‡HTTPä»¥JSONæˆ–XMLæ ¼å¼ä¼ è¾“æ•°æ®ã€‚ ä½†æ˜¯è¿™ç§æ–¹æ³•æœ‰å…¶ç¼ºç‚¹ï¼Œä¾‹å¦‚ï¼Œåœ¨å‘é€æ¶ˆæ¯ä¹‹å‰ï¼Œæ‚¨å¿…é¡»å…ˆå¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼Œç„¶åå†å°†å…¶è§£ç å›æ¥æ”¶ç«¯ã€‚ è¿™æ˜¯å¼€é”€ï¼Œå¹¶ä¸”å¢åŠ äº†ä»£ç çš„å¤æ‚æ€§ã€‚ </p><br><p> æœ‰è§£å†³åŠæ³•ï¼ è¿™æ˜¯<strong>gRPC</strong>åè®®-ä¸€ç§è½»é‡çº§çš„ï¼ŒåŸºäºäºŒè¿›åˆ¶çš„åè®®ï¼Œæ¶ˆé™¤äº†HTTPæ ‡å¤´çš„ä¼ è¾“ï¼Œè¿™å°†èŠ‚çœä¸€äº›å­—èŠ‚ã€‚ æœªæ¥çš„HTTP2è¿˜æš—ç¤ºä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿™å†æ¬¡ä»£è¡¨äº†gRPCã€‚  HTTP2å…è®¸åŒå‘é€šä¿¡ï¼Œå®ƒå¾ˆæ£’ï¼ </p><br><p>  GRPCè¿˜å…è®¸æ‚¨ä»¥å‹å¥½çš„æ ¼å¼å®šä¹‰æœåŠ¡çš„æ¥å£-è¿™æ˜¯<strong>protobuf</strong> ã€‚ </p><br><h2 id="praktika"> ç»ƒä¹  </h2><br><p> åˆ›å»ºæ–‡ä»¶/project/consigment.protoã€‚ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Protobufå®˜æ–¹æ–‡æ¡£</a> </p><br><div class="spoiler">  <b class="spoiler_title">è°ƒé…åè®®</b> <div class="spoiler_text"><pre><code class="plaintext hljs">//consigment.proto syntax = "proto3"; package go.micro.srv.consignment; service ShippingService { rpc CreateConsignment(Consignment) returns (Response) {} } message Consignment { string id = 1; string description = 2; int32 weight = 3; repeated Container containers = 4; string vessel_id = 5; } message Container { string id = 1; string customer_id = 2; string origin = 3; string user_id = 4; } message Response { bool created = 1; Consignment consignment = 2; }</code> </pre> </div></div><br><p> è¿™æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå…¶ä¸­åŒ…å«è¦æä¾›ç»™å…¶ä»–æœåŠ¡çš„æœåŠ¡ï¼šservice ShippingServiceï¼Œç„¶åæˆ‘ä»¬å°†å®šä¹‰æ¶ˆæ¯ã€‚  Protobufæ˜¯ä¸€ç§é™æ€ç±»å‹çš„åè®®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰ç±»å‹ï¼ˆç±»ä¼¼äºgolangä¸­çš„ç»“æ„ï¼‰ã€‚ åœ¨è¿™é‡Œï¼Œå®¹å™¨åµŒå¥—åœ¨æ‰¹å¤„ç†ä¸­ã€‚ </p><br><p> å®‰è£…åº“ï¼Œç¼–è¯‘å™¨å¹¶ç¼–è¯‘æˆ‘ä»¬çš„åè®®ï¼š </p><br><pre> <code class="bash hljs">$ go get -u google.golang.org/grpc $ go get -u github.com/golang/protobuf/protoc-gen-go $ sudo apt install protobuf-compiler $ mkdir consignment &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> consignment $ protoc -I=. --go_out=plugins=grpc:. consignment.proto</code> </pre> <br><p> è¾“å‡ºåº”ä¸ºæ–‡ä»¶ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">consignment.pb.go</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// Code generated by protoc-gen-go. DO NOT EDIT. // source: consignment.proto package consignment import ( fmt "fmt" proto "github.com/golang/protobuf/proto" context "golang.org/x/net/context" grpc "google.golang.org/grpc" math "math" ) // Reference imports to suppress errors if they are not otherwise used. var _ = proto.Marshal var _ = fmt.Errorf var _ = math.Inf // This is a compile-time assertion to ensure that this generated file // is compatible with the proto package it is being compiled against. // A compilation error at this line likely means your copy of the // proto package needs to be updated. const _ = proto.ProtoPackageIsVersion2 // please upgrade the proto package type Consignment struct { Id int32 `protobuf:"varint,1,opt,name=id,proto3" json:"id,omitempty"` Description string `protobuf:"bytes,2,opt,name=description,proto3" json:"description,omitempty"` Weight int32 `protobuf:"varint,3,opt,name=weight,proto3" json:"weight,omitempty"` Containers []*Container `protobuf:"bytes,4,rep,name=containers,proto3" json:"containers,omitempty"` VesselId string `protobuf:"bytes,5,opt,name=vessel_id,json=vesselId,proto3" json:"vessel_id,omitempty"` XXX_NoUnkeyedLiteral struct{} `json:"-"` XXX_unrecognized []byte `json:"-"` XXX_sizecache int32 `json:"-"` } func (m *Consignment) Reset() { *m = Consignment{} } func (m *Consignment) String() string { return proto.CompactTextString(m) } func (*Consignment) ProtoMessage() {} func (*Consignment) Descriptor() ([]byte, []int) { return fileDescriptor_3804bf87090b51a9, []int{0} } func (m *Consignment) XXX_Unmarshal(b []byte) error { return xxx_messageInfo_Consignment.Unmarshal(m, b) } func (m *Consignment) XXX_Marshal(b []byte, deterministic bool) ([]byte, error) { return xxx_messageInfo_Consignment.Marshal(b, m, deterministic) } func (m *Consignment) XXX_Merge(src proto.Message) { xxx_messageInfo_Consignment.Merge(m, src) } func (m *Consignment) XXX_Size() int { return xxx_messageInfo_Consignment.Size(m) } func (m *Consignment) XXX_DiscardUnknown() { xxx_messageInfo_Consignment.DiscardUnknown(m) } var xxx_messageInfo_Consignment proto.InternalMessageInfo func (m *Consignment) GetId() int32 { if m != nil { return m.Id } return 0 } func (m *Consignment) GetDescription() string { if m != nil { return m.Description } return "" } func (m *Consignment) GetWeight() int32 { if m != nil { return m.Weight } return 0 } func (m *Consignment) GetContainers() []*Container { if m != nil { return m.Containers } return nil } func (m *Consignment) GetVesselId() string { if m != nil { return m.VesselId } return "" } type Container struct { Id int32 `protobuf:"varint,1,opt,name=id,proto3" json:"id,omitempty"` CustomerId string `protobuf:"bytes,2,opt,name=customer_id,json=customerId,proto3" json:"customer_id,omitempty"` Origin string `protobuf:"bytes,3,opt,name=origin,proto3" json:"origin,omitempty"` UserId string `protobuf:"bytes,4,opt,name=user_id,json=userId,proto3" json:"user_id,omitempty"` XXX_NoUnkeyedLiteral struct{} `json:"-"` XXX_unrecognized []byte `json:"-"` XXX_sizecache int32 `json:"-"` } func (m *Container) Reset() { *m = Container{} } func (m *Container) String() string { return proto.CompactTextString(m) } func (*Container) ProtoMessage() {} func (*Container) Descriptor() ([]byte, []int) { return fileDescriptor_3804bf87090b51a9, []int{1} } func (m *Container) XXX_Unmarshal(b []byte) error { return xxx_messageInfo_Container.Unmarshal(m, b) } func (m *Container) XXX_Marshal(b []byte, deterministic bool) ([]byte, error) { return xxx_messageInfo_Container.Marshal(b, m, deterministic) } func (m *Container) XXX_Merge(src proto.Message) { xxx_messageInfo_Container.Merge(m, src) } func (m *Container) XXX_Size() int { return xxx_messageInfo_Container.Size(m) } func (m *Container) XXX_DiscardUnknown() { xxx_messageInfo_Container.DiscardUnknown(m) } var xxx_messageInfo_Container proto.InternalMessageInfo func (m *Container) GetId() int32 { if m != nil { return m.Id } return 0 } func (m *Container) GetCustomerId() string { if m != nil { return m.CustomerId } return "" } func (m *Container) GetOrigin() string { if m != nil { return m.Origin } return "" } func (m *Container) GetUserId() string { if m != nil { return m.UserId } return "" } type Response struct { Created bool `protobuf:"varint,1,opt,name=created,proto3" json:"created,omitempty"` Consignment *Consignment `protobuf:"bytes,2,opt,name=consignment,proto3" json:"consignment,omitempty"` XXX_NoUnkeyedLiteral struct{} `json:"-"` XXX_unrecognized []byte `json:"-"` XXX_sizecache int32 `json:"-"` } func (m *Response) Reset() { *m = Response{} } func (m *Response) String() string { return proto.CompactTextString(m) } func (*Response) ProtoMessage() {} func (*Response) Descriptor() ([]byte, []int) { return fileDescriptor_3804bf87090b51a9, []int{2} } func (m *Response) XXX_Unmarshal(b []byte) error { return xxx_messageInfo_Response.Unmarshal(m, b) } func (m *Response) XXX_Marshal(b []byte, deterministic bool) ([]byte, error) { return xxx_messageInfo_Response.Marshal(b, m, deterministic) } func (m *Response) XXX_Merge(src proto.Message) { xxx_messageInfo_Response.Merge(m, src) } func (m *Response) XXX_Size() int { return xxx_messageInfo_Response.Size(m) } func (m *Response) XXX_DiscardUnknown() { xxx_messageInfo_Response.DiscardUnknown(m) } var xxx_messageInfo_Response proto.InternalMessageInfo func (m *Response) GetCreated() bool { if m != nil { return m.Created } return false } func (m *Response) GetConsignment() *Consignment { if m != nil { return m.Consignment } return nil } func init() { proto.RegisterType((*Consignment)(nil), "Consignment") proto.RegisterType((*Container)(nil), "Container") proto.RegisterType((*Response)(nil), "Response") } func init() { proto.RegisterFile("consignment.proto", fileDescriptor_3804bf87090b51a9) } var fileDescriptor_3804bf87090b51a9 = []byte{ // 281 bytes of a gzipped FileDescriptorProto 0x1f, 0x8b, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xff, 0x64, 0x91, 0xbf, 0x4e, 0x33, 0x31, 0x10, 0xc4, 0xbf, 0xcb, 0xff, 0x5b, 0x7f, 0x02, 0xc5, 0x05, 0x58, 0x50, 0x70, 0xba, 0x2a, 0xa2, 0x70, 0x11, 0x9e, 0x00, 0xa5, 0x4a, 0xeb, 0xd0, 0xa3, 0x60, 0xaf, 0x2e, 0x2b, 0x11, 0xfb, 0x64, 0x3b, 0xe1, 0x75, 0x78, 0x54, 0x74, 0xbe, 0x1c, 0x18, 0x51, 0xce, 0xac, 0x67, 0xf7, 0xa7, 0x31, 0x2c, 0xb5, 0xb3, 0x81, 0x1a, 0x7b, 0x44, 0x1b, 0x65, 0xeb, 0x5d, 0x74, 0xf5, 0x67, 0x01, 0x6c, 0xf3, 0xe3, 0xf2, 0x2b, 0x18, 0x91, 0x11, 0x45, 0x55, 0xac, 0xa6, 0x6a, 0x44, 0x86, 0x57, 0xc0, 0x0c, 0x06, 0xed, 0xa9, 0x8d, 0xe4, 0xac, 0x18, 0x55, 0xc5, 0xaa, 0x54, 0xb9, 0xc5, 0x6f, 0x60, 0xf6, 0x81, 0xd4, 0x1c, 0xa2, 0x18, 0xa7, 0xd4, 0x45, 0xf1, 0x47, 0x00, 0xed, 0x6c, 0xdc, 0x93, 0x45, 0x1f, 0xc4, 0xa4, 0x1a, 0xaf, 0xd8, 0x1a, 0xe4, 0x66, 0xb0, 0x54, 0x36, 0xe5, 0xf7, 0x50, 0x9e, 0x31, 0x04, 0x7c, 0x7f, 0x25, 0x23, 0xa6, 0xe9, 0xc6, 0xa2, 0x37, 0xb6, 0xa6, 0x3e, 0x42, 0xf9, 0x9d, 0xfa, 0xc3, 0xf7, 0x00, 0x4c, 0x9f, 0x42, 0x74, 0x47, 0xf4, 0x5d, 0xb6, 0xe7, 0x83, 0xc1, 0xda, 0x9a, 0x0e, 0xcf, 0x79, 0x6a, 0xc8, 0x26, 0xbc, 0x52, 0x5d, 0x14, 0xbf, 0x85, 0xf9, 0x29, 0xf4, 0xa1, 0x49, 0x3f, 0xe8, 0xe4, 0xd6, 0xd4, 0x2f, 0xb0, 0x50, 0x18, 0x5a, 0x67, 0x03, 0x72, 0x01, 0x73, 0xed, 0x71, 0x1f, 0xb1, 0x3f, 0xb9, 0x50, 0x83, 0xe4, 0x12, 0x58, 0x56, 0x66, 0xba, 0xcb, 0xd6, 0xff, 0x65, 0x56, 0xa5, 0xca, 0x1f, 0xac, 0x9f, 0xe1, 0x7a, 0x77, 0xa0, 0xb6, 0x25, 0xdb, 0xec, 0xd0, 0x9f, 0x49, 0x23, 0x97, 0xb0, 0xdc, 0xa4, 0x6d, 0x79, 0xff, 0xbf, 0x56, 0xdc, 0x95, 0x72, 0x40, 0xa9, 0xff, 0xbd, 0xcd, 0xd2, 0x8f, 0x3d, 0x7d, 0x05, 0x00, 0x00, 0xff, 0xff, 0x84, 0x5c, 0xa4, 0x06, 0xc6, 0x01, 0x00, 0x00, } // Reference imports to suppress errors if they are not otherwise used. var _ context.Context var _ grpc.ClientConn // This is a compile-time assertion to ensure that this generated file // is compatible with the grpc package it is being compiled against. const _ = grpc.SupportPackageIsVersion4 // ShippingServiceClient is the client API for ShippingService service. // // For semantics around ctx use and closing/ending streaming RPCs, please refer to https://godoc.org/google.golang.org/grpc#ClientConn.NewStream. type ShippingServiceClient interface { CreateConsignment(ctx context.Context, in *Consignment, opts ...grpc.CallOption) (*Response, error) } type shippingServiceClient struct { cc *grpc.ClientConn } func NewShippingServiceClient(cc *grpc.ClientConn) ShippingServiceClient { return &amp;shippingServiceClient{cc} } func (c *shippingServiceClient) CreateConsignment(ctx context.Context, in *Consignment, opts ...grpc.CallOption) (*Response, error) { out := new(Response) err := c.cc.Invoke(ctx, "/ShippingService/CreateConsignment", in, out, opts...) if err != nil { return nil, err } return out, nil } // ShippingServiceServer is the server API for ShippingService service. type ShippingServiceServer interface { CreateConsignment(context.Context, *Consignment) (*Response, error) } func RegisterShippingServiceServer(s *grpc.Server, srv ShippingServiceServer) { s.RegisterService(&amp;_ShippingService_serviceDesc, srv) } func _ShippingService_CreateConsignment_Handler(srv interface{}, ctx context.Context, dec func(interface{}) error, interceptor grpc.UnaryServerInterceptor) (interface{}, error) { in := new(Consignment) if err := dec(in); err != nil { return nil, err } if interceptor == nil { return srv.(ShippingServiceServer).CreateConsignment(ctx, in) } info := &amp;grpc.UnaryServerInfo{ Server: srv, FullMethod: "/ShippingService/CreateConsignment", } handler := func(ctx context.Context, req interface{}) (interface{}, error) { return srv.(ShippingServiceServer).CreateConsignment(ctx, req.(*Consignment)) } return interceptor(ctx, in, info, handler) } var _ShippingService_serviceDesc = grpc.ServiceDesc{ ServiceName: "ShippingService", HandlerType: (*ShippingServiceServer)(nil), Methods: []grpc.MethodDesc{ { MethodName: "CreateConsignment", Handler: _ShippingService_CreateConsignment_Handler, }, }, Streams: []grpc.StreamDesc{}, Metadata: "consignment.proto", }</span></span></code> </pre> <br><p> å¦‚æœæ˜¯ï¼Œåˆ™å‡ºäº†ç‚¹é—®é¢˜ã€‚ è¯·æ³¨æ„ï¼Œå‚æ•°-Iæ˜¯ç¼–è¯‘å™¨æ­£åœ¨å¯»æ‰¾æ–‡ä»¶çš„è·¯å¾„ï¼Œ--go_outæ˜¯å°†åœ¨å…¶ä¸­åˆ›å»ºæ–°æ–‡ä»¶çš„è·¯å¾„ã€‚ æ€»æ˜¯æœ‰å¸®åŠ© </p><br><pre> <code class="bash hljs">$ protoc -h</code> </pre> </div></div><br><p> è¿™æ˜¯gRPC / protobufåº“è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç ï¼Œå› æ­¤æ‚¨å¯ä»¥å°†protobufå®šä¹‰ä¸è‡ªå·±çš„ä»£ç å…³è”ã€‚ </p><br><h4 id="napishem-maingo"> æˆ‘ä»¬å°†ç¼–å†™main.go </h4><br><div class="spoiler">  <b class="spoiler_title">main.go</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> seaport <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"net"</span></span> <span class="hljs-comment"><span class="hljs-comment">//    pbf "seaport/consignment" "golang.org/x/net/context" "google.golang.org/grpc" "google.golang.org/grpc/reflection" ) const ( port = ":50051" ) //IRepository -   type IRepository interface { Create(*pbf.Consignment) (*pbf.Consignment, error) } // Repository -    , //        type Repository struct { consignments []*pbf.Consignment } //Create -    func (repo *Repository) Create(consignment *pbf.Consignment) (*pbf.Consignment, error) { updated := append(repo.consignments, consignment) repo.consignments = updated return consignment, nil } //         //       .     //         . . type service struct { repo IRepository } // CreateConsignment -        , //    create,      //     gRPC. func (s *service) CreateConsignment(ctx context.Context, req *pbf.Consignment) (*pbf.Response, error) { //      consignment, err := s.repo.Create(req) if err != nil { return nil, err } //   `Response`, //        return &amp;pbf.Response{Created: true, Consignment: consignment}, nil } func main() { repo := &amp;Repository{} //   gRPC    tcp lis, err := net.Listen("tcp", port) if err != nil { log.Fatalf("failed to listen: %v", err) } s := grpc.NewServer() //      gRPC,    //        //  `Response`,       pbf.RegisterShippingServiceServer(s, &amp;service{repo}) //      gRPC. reflection.Register(s) if err := s.Serve(lis); err != nil { log.Fatalf("failed to serve: %v", err) } }</span></span></code> </pre> </div></div><br><p> è¯·ä»”ç»†é˜…è¯»ä»£ç ä¸­çš„æ³¨é‡Šã€‚ æ˜¾ç„¶ï¼Œè¿™é‡Œæˆ‘ä»¬æ­£åœ¨åˆ›å»ºå®ç°é€»è¾‘ï¼Œåœ¨è¯¥é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬çš„gRPCæ–¹æ³•ä½¿ç”¨ç”Ÿæˆçš„æ ¼å¼è¿›è¡Œäº¤äº’ï¼Œå¹¶åœ¨ç«¯å£50051ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„gRPCæœåŠ¡å™¨ã€‚ <br> æ‚¨å¯ä»¥ä½¿ç”¨<strong>$ go run main.goæ¥è¿è¡Œå®ƒ</strong> ï¼Œä½†æ˜¯æ‚¨å°†çœ‹ä¸åˆ°ä»»ä½•ä¸œè¥¿ï¼Œä¹Ÿå°†æ— æ³•ä½¿ç”¨å®ƒâ€¦â€¦å› æ­¤ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯ä»¥å®é™…è¿è¡Œå®ƒã€‚ </p><br><p> è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢ï¼Œè¯¥ç•Œé¢éœ€è¦ä¸€ä¸ªJSONæ–‡ä»¶å¹¶ä¸æˆ‘ä»¬çš„gRPCæœåŠ¡è¿›è¡Œäº¤äº’ã€‚ </p><br><p> åœ¨æ ¹ç›®å½•ä¸­ï¼Œåˆ›å»º<strong>$ mkdir consignment-cli</strong>çš„æ–°å­ç›®å½•ã€‚ åœ¨æ­¤ç›®å½•ä¸­ï¼Œåˆ›å»ºå…·æœ‰ä»¥ä¸‹å†…å®¹çš„cli.goæ–‡ä»¶ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">cli.go</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"encoding/json"</span></span> <span class="hljs-string"><span class="hljs-string">"io/ioutil"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> pbf <span class="hljs-string"><span class="hljs-string">"seaport/consignment"</span></span> <span class="hljs-string"><span class="hljs-string">"golang.org/x/net/context"</span></span> <span class="hljs-string"><span class="hljs-string">"google.golang.org/grpc"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ( address = <span class="hljs-string"><span class="hljs-string">"localhost:50051"</span></span> defaultFilename = <span class="hljs-string"><span class="hljs-string">"consignment.json"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">//    func parseFile(file string) (*pbf.Consignment, error) { var consignment *pbf.Consignment data, err := ioutil.ReadFile(file) if err != nil { return nil, err } json.Unmarshal(data, &amp;consignment) return consignment, err } func main() { //     conn, err := grpc.Dial(address, grpc.WithInsecure()) if err != nil { log.Fatalf("  : %v", err) } defer conn.Close() client := pbf.NewShippingServiceClient(conn) //    consignment.json, //          file := defaultFilename if len(os.Args) &gt; 1 { file = os.Args[1] } consignment, err := parseFile(file) if err != nil { log.Fatalf("   : %v", err) } r, err := client.CreateConsignment(context.Background(), consignment) if err != nil { log.Fatalf("  : %v", err) } log.Printf(": %t", r.Created) }</span></span></code> </pre> </div></div><br><p> ç°åœ¨åˆ›å»ºä¸€ä¸ªæ‰¹å¤„ç†ï¼ˆconsignment-cli / consignment.jsonï¼‰ï¼š </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"weight"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"containers"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"customer_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"_001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"user_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"_001"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"origin"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"vessel_id"</span></span>: <span class="hljs-string"><span class="hljs-string">"_001"</span></span> }</code> </pre> <br><p> ç°åœ¨ï¼Œå¦‚æœæ‚¨ä»<strong>æµ·æ¸¯</strong>è½¯ä»¶åŒ…ä¸­è¿è¡Œ<strong>$ goè¿è¡Œmain.go</strong> ï¼Œç„¶ååœ¨å•ç‹¬çš„ç»ˆç«¯é¢æ¿ä¸­è¿è¡Œ<strong>$ goè¿è¡Œcli.goã€‚</strong> æ‚¨åº”è¯¥çœ‹åˆ°æ¶ˆæ¯â€œ Createdï¼štrueâ€ã€‚ <br> ä½†æ˜¯æˆ‘ä»¬å¦‚ä½•éªŒè¯ç¡®åˆ‡åˆ›å»ºäº†ä»€ä¹ˆå‘¢ï¼Ÿ è®©æˆ‘ä»¬ä½¿ç”¨GetConsignmentsæ–¹æ³•æ›´æ–°æˆ‘ä»¬çš„æœåŠ¡ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ‰€æœ‰åˆ›å»ºçš„æ‰¹å¤„ç†ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">è°ƒé…åè®®</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">//consigment.proto syntax = "proto3"; service ShippingService{ rpc CreateConsignment(Consignment) returns (Response) {} //    rpc GetConsignments(GetRequest) returns (Response) {} } message Consignment { int32 id = 1; string description = 2; int32 weight = 3; repeated Container containers = 4; string vessel_id = 5; } message Container { int32 id =1; string customer_id =2; string origin = 3; string user_id = 4; } //    message GetRequest {} message Response { bool created = 1; Consignment consignment = 2; //     //     repeated Consignment consignments = 3; }</span></span></code> </pre> </div></div><br><p> å› æ­¤ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åœ¨æœåŠ¡ä¸Šåˆ›å»ºäº†ä¸€ä¸ªåä¸º<strong>GetConsignments</strong>çš„æ–°æ–¹æ³•ï¼Œå¹¶ä¸”è¿˜åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„<strong>GetRequest</strong> ï¼Œè¯¥æ–¹æ³•å°šæœªåŒ…å«ä»»ä½•å†…å®¹ã€‚ æˆ‘ä»¬è¿˜åœ¨å›å¤é‚®ä»¶ä¸­æ·»åŠ äº†å·²å‘é€æ‰¹æ¬¡çš„å­—æ®µã€‚ æ‚¨ä¼šæ³¨æ„åˆ°è¿™é‡Œçš„ç±»å‹å…·æœ‰é‡å¤çš„å…³é”®å­—ï¼Œç›´åˆ°è¯¥ç±»å‹ä¸ºæ­¢ã€‚ æ‚¨å¯èƒ½å·²ç»çŒœåˆ°äº†ï¼Œè¿™åªæ˜¯æ„å‘³ç€å°†æ­¤å­—æ®µè§†ä¸ºè¿™äº›ç±»å‹çš„æ•°ç»„ã€‚ </p><br><p> ä¸è¦æ€¥äºè¿è¡Œè¯¥ç¨‹åºï¼Œæˆ‘ä»¬çš„gRPCæ–¹æ³•çš„å®ç°æ˜¯åŸºäºprotobufåº“åˆ›å»ºçš„æ¥å£çš„åŒ¹é…ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æˆ‘ä»¬çš„å®ç°ä¸æˆ‘ä»¬çš„protoå®šä¹‰ç›¸åŒ¹é…ã€‚ </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">//seaport/main.go //IRepository -   type IRepository interface { Create(*pbf.Consignment) (*pbf.Consignment, error) GetAll() []*pbf.Consignment } //GetAll -       func (repo *Repository) GetAll() []*pbf.Consignment { return repo.consignments } //GetConsignments -         func (s *service) GetConsignments(ctx context.Context, req *pbf.GetRequest) (*pbf.Response, error) { consignments := s.repo.GetAll() return &amp;pbf.Response{Consignments: consignments}, nil }</span></span></code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åŒ…æ‹¬äº†æ–°çš„GetConsignmentsæ–¹æ³•ï¼Œæ›´æ–°äº†åˆ†åˆ«åœ¨consignments.protoå®šä¹‰ä¸­åˆ›å»ºçš„å­˜å‚¨åº“å’Œæ¥å£ã€‚ å¦‚æœ<strong>å†æ¬¡</strong>è¿è¡Œ<strong>$ goï¼Œè¯·å†æ¬¡è¿è¡Œmain.go</strong> ï¼Œè¯¥ç¨‹åºå°†å†æ¬¡è¿è¡Œã€‚ </p><br><p> è®©æˆ‘ä»¬æ›´æ–°cliå·¥å…·ï¼Œä½¿å…¶åŒ…å«è°ƒç”¨æ­¤æ–¹æ³•çš„åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥åˆ—å‡ºæˆ‘ä»¬çš„å‚ä¸è€…ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">cli.go</b> <div class="spoiler_text"><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"encoding/json"</span></span> <span class="hljs-string"><span class="hljs-string">"io/ioutil"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> pbf <span class="hljs-string"><span class="hljs-string">"seaport/consignment"</span></span> <span class="hljs-string"><span class="hljs-string">"golang.org/x/net/context"</span></span> <span class="hljs-string"><span class="hljs-string">"google.golang.org/grpc"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ( address = <span class="hljs-string"><span class="hljs-string">"localhost:50051"</span></span> defaultFilename = <span class="hljs-string"><span class="hljs-string">"consignment.json"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">//    func parseFile(file string) (*pbf.Consignment, error) { var consignment *pbf.Consignment data, err := ioutil.ReadFile(file) if err != nil { return nil, err } json.Unmarshal(data, &amp;consignment) return consignment, err } func main() { //     conn, err := grpc.Dial(address, grpc.WithInsecure()) if err != nil { log.Fatalf("  : %v", err) } defer conn.Close() client := pbf.NewShippingServiceClient(conn) //    consignment.json, //          file := defaultFilename if len(os.Args) &gt; 1 { file = os.Args[1] } consignment, err := parseFile(file) if err != nil { log.Fatalf("   : %v", err) } r, err := client.CreateConsignment(context.Background(), consignment) if err != nil { log.Fatalf("  : %v", err) } log.Printf(": %t", r.Created) getAll, err := client.GetConsignments(context.Background(), &amp;pbf.GetRequest{}) if err != nil { log.Fatalf("    : %v", err) } for _, cns := range getAll.Consignments { fmt.Printf("Id: %v\n", cns.GetId()) fmt.Printf("Description: %v\n", cns.GetDescription()) fmt.Printf("Weight: %d\n", cns.GetWeight()) fmt.Printf("VesselId: %v\n", cns.GetVesselId()) for _, cnt := range cns.GetContainers() { fmt.Printf("\tId: %v\n", cnt.GetId()) fmt.Printf("\tUserId: %v\n", cnt.GetUserId()) fmt.Printf("\tCustomerId: %v\n", cnt.GetCustomerId()) fmt.Printf("\tOrigin: %v\n", cnt.GetOrigin()) } } }</span></span></code> </pre> </div></div><br><p> å°†ä¸Šé¢çš„ä»£ç æ·»åŠ åˆ°cli.goä¸­ï¼Œ <strong>ç„¶åå†æ¬¡</strong>è¿è¡Œ<strong>$ goè¿è¡Œcli.goã€‚</strong> å®¢æˆ·ç«¯å°†è¿è¡ŒCreateConsignmentï¼Œç„¶åè°ƒç”¨GetConsignmentsã€‚ è€Œä¸”æ‚¨åº”è¯¥åœ¨ç­”æ¡ˆåˆ—è¡¨ä¸­çœ‹åˆ°è¯¥èšä¼šçš„ç»„æˆã€‚ </p><br><p> å› æ­¤ï¼Œæˆ‘ä»¬æ‹¥æœ‰ç¬¬ä¸€ä¸ªä½¿ç”¨protobufå’ŒgRPCä¸ä¹‹äº¤äº’çš„å¾®æœåŠ¡å’Œå®¢æˆ·ç«¯ã€‚ </p><br><p> æœ¬ç³»åˆ—çš„ä¸‹ä¸€éƒ¨åˆ†å°†åŒ…æ‹¬go-microé›†æˆï¼Œè¿™æ˜¯åˆ›å»ºåŸºäºgRPCçš„å¾®æœåŠ¡çš„å¼ºå¤§åŸºç¡€ã€‚ æˆ‘ä»¬è¿˜å°†åˆ›å»ºç¬¬äºŒé¡¹æœåŠ¡ã€‚ åœ¨æœ¬ç³»åˆ—æ–‡ç« çš„ä¸‹ä¸€éƒ¨åˆ†ï¼Œè¯·è€ƒè™‘æˆ‘ä»¬åœ¨Dockerå®¹å™¨ä¸­æœåŠ¡çš„å·¥ä½œã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN425653/">https://habr.com/ru/post/zh-CN425653/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN425641/index.html">åŠ æ‹¿å¤§åŸå¸‚å±…æ°‘å·²ç»å¼€å‘äº†å…¬äº¤è½¦è€Œéæ±½è½¦çš„â€œä¼˜æ­¥æœåŠ¡â€</a></li>
<li><a href="../zh-CN425643/index.html">10æœˆ8æ—¥è‡³14æ—¥åœ¨è«æ–¯ç§‘ä¸¾è¡Œçš„æ•°å­—æ´»åŠ¨</a></li>
<li><a href="../zh-CN425645/index.html">SpaceXå’ŒSAOCOM-1Aæ–°ä»»åŠ¡ã€‚ å®Œæˆ</a></li>
<li><a href="../zh-CN425647/index.html">UIæµ‹è¯•ï¼šä»¥ä¸åŒçš„åˆ†è¾¨ç‡æ£€æŸ¥ç³»ç»Ÿ</a></li>
<li><a href="../zh-CN425649/index.html">æ€§è™å¾…ï¼Œæˆˆå°”å’ŒDrupalå¼€å‘è€…çš„è¿½æ±‚</a></li>
<li><a href="../zh-CN425657/index.html">æƒ©ç½šçš„å¿…ç„¶æ€§ï¼Œçªå‡»æ£€æŸ¥çš„æœ‰æ•ˆæ€§</a></li>
<li><a href="../zh-CN425659/index.html">äº¤äº’å¼è®¾è®¡ä¸å¿…å¤ªå¤æ‚ã€‚</a></li>
<li><a href="../zh-CN425661/index.html">Angularå¼€å‘äººå‘˜çš„22ä¸ªæŠ€å·§ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN425663/index.html">Angularå¼€å‘äººå‘˜çš„22ä¸ªæŠ€å·§ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN425665/index.html">Gitï¼šä¿®å¤é”™è¯¯å’Œä¿®å¤æäº¤</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>