<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì¥ ü¶é üë©üèº‚Äçü§ù‚Äçüë®üèΩ Tus monolitos distribuidos est√°n tramando detr√°s de ti üßòüèæ üÜî üß£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Habr! 

 La traducci√≥n de hoy toca no solo y no tanto microservicios, un tema que todos tienen en sus labios hoy, sino que tambi√©n recuerda lo im...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tus monolitos distribuidos est√°n tramando detr√°s de ti</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/453470/">  Hola Habr! <br><br>  La traducci√≥n de hoy toca no solo y no tanto microservicios, un tema que todos tienen en sus labios hoy, sino que tambi√©n recuerda lo importante que es llamar a las cosas por su nombre.  La transici√≥n a la arquitectura de microservicios a veces es necesaria, pero, como lo subraya una vez m√°s el autor, requiere una cuidadosa consideraci√≥n de las consecuencias.  ¬°Disfruta y una lectura fruct√≠fera! <br><br><img src="https://habrastorage.org/webt/im/q8/dr/imq8drim-mkatdxhbytwowus1ik.jpeg"><br><a name="habracut"></a><br>  De vez en cuando hago la misma pregunta. <br><blockquote>  ¬øExiste una verdad tan importante que solo unos pocos est√©n de acuerdo con usted?  - Peter Thiel </blockquote>  Antes de sentarme para esta publicaci√≥n, prob√© este tema durante mucho tiempo con un tema, que hoy est√° en una tendencia seria: se trata de microservicios.  Creo que ahora tengo algo que contar;  Algunos hallazgos se basan en la reflexi√≥n, otros en la experiencia pr√°ctica.  Entonces te digo. <br>  Comencemos con una verdad importante que nos servir√° como punto de referencia en el camino como una estrella polar. <br><br>  La mayor√≠a de las implementaciones de microservicios no son m√°s que monolitos distribuidos. <br><br><h4>  Era de los monolitos </h4><br>  Cualquier sistema comenz√≥ como una aplicaci√≥n monol√≠tica.  No entrar√© en detalles sobre este tema aqu√≠, muchos ya han escrito sobre muchos.  Sin embargo, la mayor parte de la informaci√≥n sobre los monolitos se dedica a cuestiones tales como la productividad y la escalabilidad del desarrollador, al tiempo que deja entre corchetes el activo m√°s valioso de cualquier empresa de Internet: los datos. <br><br><img src="https://habrastorage.org/webt/83/75/yh/8375yhxrmoq8jmhfl-wz97u7slg.png"><br><br>  <i>Arquitectura de aplicaci√≥n monol√≠tica t√≠pica</i> <br><br>  Si los datos son tan importantes, ¬øpor qu√© se presta tanta atenci√≥n a otros temas, pero no a ellos?  La respuesta, en general, es simple: porque no son tan dolorosas como la pregunta de datos. <br>  Quiz√°s el monolito es la √∫nica etapa en el ciclo de vida del sistema donde usted: <br><br><ul><li>  Comprenda completamente su modelo de datos; </li><li>  Puede cooperar con los datos (se supone que su base de datos est√° seleccionada correctamente para su aplicaci√≥n). </li></ul><br>  En t√©rminos de datos, el monolito es ideal.  Y dado que los datos son el activo m√°s valioso de cualquier compa√±√≠a, es mejor no romper el monolito, a menos que tenga una muy buena raz√≥n, o una combinaci√≥n de tales razones.  En la mayor√≠a de los casos, la raz√≥n decisiva para esto es la necesidad de escalar (ya que vivimos en el mundo real con sus limitaciones f√≠sicas). <br><br>  Cuando llega este momento, lo m√°s probable es que su sistema entre en una nueva hip√≥stasis: se <b>convierte en un monolito distribuido</b> . <br><br><h4>  La era de los monolitos distribuidos </h4><br>  Digamos que las cosas van bien en su empresa y la aplicaci√≥n necesita crecer.  Tiene cada vez m√°s clientes importantes y sus requisitos de facturaci√≥n e informes han cambiado tanto en t√©rminos de un conjunto de oportunidades como de su volumen. <br><br>  Al abordar seriamente la demolici√≥n del monolito, en particular, intentar√° implementar dos peque√±os servicios, uno de los cuales proporcionar√° informes y el segundo, la facturaci√≥n.  Lo m√°s probable es que estos nuevos servicios proporcionen una API HTTP y tengan una base de datos dedicada para el almacenamiento de estado a largo plazo.  Despu√©s de muchas confirmaciones, usted, como nosotros en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Unbabel</a> , puede obtener algo similar a la siguiente ilustraci√≥n. <br><br><img src="https://habrastorage.org/webt/lg/js/9g/lgjs9grnmyupckoplo0to5q-kjm.png"><br><br>  <i>Una vista generalizada de la arquitectura del sistema despu√©s de separar los servicios de facturaci√≥n e informes de la aplicaci√≥n monol√≠tica principal</i> <br><br>  Todo va seg√∫n lo planeado. <br><br><ul><li>  El equipo contin√∫a dividiendo el monolito en sistemas m√°s peque√±os; </li><li>  Los transportadores de integraci√≥n / entrega continua funcionan como un reloj; </li><li>  El cl√∫ster de Kubernetes es saludable, los ingenieros son productivos y felices con todo. </li></ul><br>  La vida es bella <br><br>  Pero, ¬øy si digo que en este momento las viles conspiraciones teje contra ti? <br><br>  Ahora, mirando su sistema, encontrar√° que los datos se han distribuido en muchos sistemas diferentes.  Comenz√≥ con la etapa cuando ten√≠a una base de datos √∫nica donde se almacenaban todos los objetos de datos, y ahora sus objetos de datos se han extendido a diferentes lugares.  Quiz√°s piense que no hay ning√∫n problema, ya que se necesitan microservicios para crear abstracciones y sellar datos, ocultando la complejidad interna del sistema. <br><br>  Tienes toda la raz√≥n.  Pero con el aumento de la escala, surgen problemas m√°s complejos: ahora, en cualquier momento, se ve obligado a cumplir con los requisitos comerciales (por ejemplo, para realizar un seguimiento de alguna m√©trica), lo que requiere el acceso a los datos ubicados en m√°s de un sistema. <br><br>  Que hacer  De hecho, hay muchas opciones.  Pero a toda prisa, tambi√©n debe atender a una gran fraternidad de clientes que se han registrado recientemente con usted, por lo que debe encontrar un equilibrio entre "r√°pido" y "bueno".  Habiendo discutido los detalles, usted decide construir un sistema adicional que realice un cierto trabajo ETL, contribuyendo a la soluci√≥n de las tareas finales.  Este sistema tendr√° que tener acceso a todas las r√©plicas de lectura que contienen la informaci√≥n que necesita.  La siguiente figura muestra c√≥mo podr√≠a funcionar un sistema de este tipo. <br><br><img src="https://habrastorage.org/webt/76/op/x0/76opx0yinpcv5fbxh9x8sais2hm.png"><br><br>  <i>Un ejemplo generalizado de un sistema anal√≠tico ETL (en Unbabel lo llamamos an√°lisis de traducci√≥n autom√°tica)</i> <br><br>  En Unbabel, utilizamos este enfoque, ya que: <br><br><ul><li>  No afecta demasiado el rendimiento de cada microservicio; </li><li>  No requiere cambios importantes en la infraestructura (solo agregue un nuevo microservicio); </li><li>  Pudimos satisfacer lo suficientemente r√°pido nuestros requisitos comerciales. </li></ul><br>  La experiencia sugiere que durante alg√∫n tiempo este enfoque funcionar√°, hasta alcanzar una cierta escala.  En Unbabel, nos sirvi√≥ muy bien hasta hace muy poco, cuando comenzamos a enfrentar desaf√≠os cada vez m√°s serios.  Aqu√≠ hay algunas cosas que se convirtieron en un dolor de cabeza para nosotros: <br><br>  <b>1. Cambios de datos</b> <br><br>  Una de las principales ventajas de los microservicios es la encapsulaci√≥n.  La representaci√≥n interna de los datos puede cambiar, pero esto no afecta a los clientes del sistema, ya que se comunican a trav√©s de una API externa.  Sin embargo, nuestra estrategia requer√≠a acceso directo a la representaci√≥n interna de los datos y, por lo tanto, tan pronto como el equipo solo realiz√≥ algunos cambios en la presentaci√≥n de los datos (por ejemplo, cambiar el nombre de un campo o cambiar el tipo de <code>text</code> a <code>uuid</code> ), tambi√©n tuvimos que cambiar y volver a implementar nuestro ETL- servicio <br><br>  <b>2. La necesidad de procesar muchos esquemas de datos diferentes</b> <br><br>  A medida que aumentaba la cantidad de sistemas a los que necesit√°bamos conectarnos, tuvimos que lidiar con formas cada vez m√°s heterog√©neas de presentar datos.  Era obvio que no pod√≠amos escalar todos estos esquemas, las relaciones entre ellos y sus representaciones. <br><br>  <i><b>La ra√≠z de todo mal</b></i> <br><br>  Para obtener una imagen completa de lo que est√° sucediendo en el sistema, tuvimos que detenernos en un enfoque parecido a un monolito.  La diferencia era que no ten√≠amos un sistema y una base de datos, sino docenas de esos pares, cada uno con su propia representaci√≥n de datos;  Adem√°s, en algunos casos, los mismos datos se replicaron en varios sistemas. <br><br>  Prefiero llamar a este sistema un monolito distribuido.  Por qu√©  Dado que es completamente inadecuado para rastrear cambios en el sistema, y ‚Äã‚Äãla √∫nica forma de mostrar el estado del sistema es recopilar un servicio que se conecte directamente a los almacenes de datos de todos los microservicios.  Es interesante ver cu√°ntos colosos de Internet tambi√©n enfrentaron desaf√≠os similares en alg√∫n momento de su desarrollo.  Un buen ejemplo en este caso que siempre me gusta dar es la red de LinkedIn. <br><br><img src="https://habrastorage.org/webt/bx/zv/l8/bxzvl8oaw7htdnldzu7fr3toxdm.png"><br><br>  <i>Este es el tipo de error de datos que los flujos de informaci√≥n de Linkedin representaron alrededor de 2011 - fuente</i> <br><br>  En este momento, se preguntar√°n: "¬øqu√© van a hacer con todo esto?"  La respuesta es simple: debe comenzar a rastrear los cambios y realizar un seguimiento de las acciones importantes a medida que ocurren. <br><br>  <b>Romper un monolito distribuido utilizando Event Sourcing</b> <br><br>  Como pr√°cticamente el resto del mundo, los sistemas en Internet son receptivos.  Por lo tanto, una solicitud a la API puede conducir a la inserci√≥n de un nuevo registro en la base de datos.  Actualmente, en la mayor√≠a de los casos, estos detalles no nos molestan, ya que estamos interesados ‚Äã‚Äãprincipalmente en actualizar el estado de la base de datos.  La actualizaci√≥n del estado de una base de datos es una consecuencia condicional de alg√∫n evento (en este caso, una solicitud de API).  El fen√≥meno del evento es simple y, sin embargo, el potencial de los eventos es muy grande: incluso se pueden usar para destruir un monolito distribuido. <br><br>  <b>Un evento no es m√°s que un hecho inmutable de alguna modificaci√≥n que ocurri√≥ en su sistema</b> .  En la arquitectura de microservicios, los eventos se vuelven cr√≠ticos y ayudan a comprender los flujos de datos, y sobre la base de deducir el estado agregado de varios sistemas.  Cada microservicio que realiza una acci√≥n que es interesante desde el punto de vista de todo el sistema debe generar un evento junto con toda la informaci√≥n esencial relacionada con el hecho de que este evento representa. <br><br>  Quiz√°s tengas una pregunta: <br>  "¬øC√≥mo pueden los microservicios que generan eventos ayudarme a resolver el problema del monolito distribuido?" <br><br>  Si tiene sistemas que generan eventos, puede haber un registro de hechos con las siguientes propiedades: <br><br><ul><li>  Falta de enlace a cualquier almac√©n de datos: los eventos generalmente se serializan utilizando formatos binarios como JSON, Avro o Protobufs; </li><li>  Inmutabilidad: tan pronto como se genera un evento, es imposible cambiarlo; </li><li>  Reproducibilidad: se puede restaurar el estado del sistema en cualquier momento dado;  Para hacer esto, simplemente "reproduzca" el registro de eventos. </li></ul><br>  Con este registro, puede mostrar el estado utilizando cualquier tipo de l√≥gica a nivel de aplicaci√≥n.  Ya no est√° asociado con ning√∫n conjunto de microservicios y <i>N</i> formas en que se presentan los datos.  La √∫nica fuente de verdad y su √∫nico almac√©n de datos es ahora el repositorio donde se almacenan sus eventos. <br><br>  Aqu√≠ hay algunas razones por las cuales el registro de eventos me parece la forma de ayudar a romper el Monolito Distribuido: <br><br>  <b>1. La √∫nica fuente de verdad</b> <br><br>  En lugar de mantener N fuentes de datos que pueden ser necesarias para conectarse a (m√∫ltiples) bases de datos heterog√©neas, en este nuevo escenario, la verdad √∫ltima se almacena exactamente en un repositorio: el registro de eventos. <br><br>  <b>2. Formato de datos universal</b> <br><br>  En la versi√≥n anterior del sistema, ten√≠amos que lidiar con muchos formatos de datos, ya que est√°bamos directamente conectados a la base de datos.  En el nuevo dise√±o, podemos actuar de manera mucho m√°s flexible. <br><br>  Digamos que te gust√≥ una foto de Instagram publicada por uno de tus amigos.  Tal acci√≥n se puede describir: "Al <i>usuario X le gust√≥ la imagen P</i> ".  Y aqu√≠ hay un evento que representa este hecho: <br><br><img src="https://habrastorage.org/webt/ff/sp/2x/ffsp2xttqkwolrptkfa3bw66mdc.png"><br><br>  <i>Un evento correspondiente al enfoque AVO (Actor, Verbo, Objeto), simulando el hecho de que el usuario selecciona la imagen que le gusta.</i> <br><br>  <b>3. Debilitar la comunicaci√≥n entre productores y consumidores.</b> <br><br>  Por √∫ltimo, pero no menos importante, una de las mayores ventajas de las operaciones de eventos es el debilitamiento efectivo de la comunicaci√≥n entre los productores de datos y los consumidores.  Esta situaci√≥n no solo simplifica el escalado, sino que tambi√©n reduce el n√∫mero de dependencias entre ellos.  El √∫nico contrato que queda entre los sistemas en este caso es el diagrama de eventos. <br><br><hr><br>  Al comienzo de este art√≠culo se plante√≥ la pregunta: ¬øExiste una verdad tan importante en la que solo unos pocos est√©n de acuerdo con usted? <br><br>  Perm√≠tanme volver al final de esta excursi√≥n.  Creo que la mayor√≠a de las empresas no consideran los datos como "entidades de primera clase" cuando comienzan la migraci√≥n a la arquitectura de microservicios.  Se argumenta que todos los cambios de datos a√∫n se pueden realizar a trav√©s de la API, pero este enfoque en √∫ltima instancia conduce a una complicaci√≥n constante del servicio en s√≠. <br><br>  Creo que el √∫nico enfoque verdadero para capturar los cambios de datos en una arquitectura de microservicio es hacer que los sistemas emitan eventos de acuerdo con un contrato estrictamente definido.  Tener un registro de eventos correctamente compilado le permite mostrar una gran cantidad de datos en funci√≥n de cualquier conjunto de requisitos empresariales.  En este caso, solo tiene que aplicar diferentes reglas a los mismos hechos.  En algunos casos, dicha fragmentaci√≥n de datos puede evitarse si su empresa (especialmente sus gerentes de producto) trata los datos como un producto.  Sin embargo, este es un tema para otro art√≠culo. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/453470/">https://habr.com/ru/post/453470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../453458/index.html">Programaci√≥n reactiva real en Svelte 3.0</a></li>
<li><a href="../453460/index.html">Cuando cansado de lo virtual</a></li>
<li><a href="../453464/index.html">Futuro Cu√°ntico (continuaci√≥n)</a></li>
<li><a href="../453466/index.html">HolyJS 2019: Informe de SEMrush (Parte 2)</a></li>
<li><a href="../453468/index.html">La evoluci√≥n de las aplicaciones web Java</a></li>
<li><a href="../453472/index.html">Bicicleta del monitor de energ√≠a PZEM004T y ESP8266, con monitoreo de personas</a></li>
<li><a href="../453474/index.html">Control por computadora a trav√©s de control remoto desde un amplificador usando Arduino y Node.js</a></li>
<li><a href="../453478/index.html">Estudiamos la salud de los sat√©lites Starlink Ilona Mask</a></li>
<li><a href="../453482/index.html">Introducci√≥n al aprendizaje profundo con TensorFlow</a></li>
<li><a href="../453484/index.html">Contador BCD de 4 bits</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>