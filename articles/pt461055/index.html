<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐙 📛 🎇 Rekko Challenge 2019: como foi 🌟 👨‍🔧 👨‍👩‍👦‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Há pouco tempo, um concurso de sistemas de recomendação do cinema online Okko - Rekko Challenge 2019 foi realizado na plataforma Boosters . Para mim, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rekko Challenge 2019: como foi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/461055/"><img src="https://habrastorage.org/webt/hb/u7/gu/hbu7guq0ic25zumfxsf5bbipkcq.png"><br><br>  Há pouco tempo, um concurso de sistemas de recomendação do cinema online Okko - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rekko Challenge 2019</a> foi realizado na plataforma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Boosters</a> .  Para mim, essa foi a primeira experiência de participar de uma competição com uma tabela de líderes (antes eu tentava força apenas em uma hackathon).  A tarefa é interessante e familiar para mim da prática; existe um fundo de prêmios, o que significa que fazia sentido participar.  Como resultado, ocupei o 14º lugar, pelo qual os organizadores emitiram uma camiseta comemorativa.  Nice  Obrigada <br><br>  Neste artigo, imergirei você brevemente na tarefa, falarei sobre as hipóteses apresentadas por mim, bem como como arrastar a concorrência nos sistemas de recomendação e entrar no top 15 sem acumular experiência, o que será especialmente útil para aqueles que apenas participarão de concursos. <br><a name="habracut"></a><br><h3>  Sistemas Recomendadores </h3><br>  O principal objetivo dos sistemas de recomendação é dar ao usuário o que ele <s>deseja</s> comprar (infelizmente, essa visão hipertrofiada é imposta a nós por aplicativos comerciais). <br>  Existem diferentes instruções de tarefas (classificação, busca por similares, previsão de um elemento específico) e, portanto, maneiras de resolvê-las.  Bem, todos nós amamos a variabilidade na escolha, que é fornecida por um conjunto de várias soluções possíveis para cada problema.  Várias abordagens são bem descritas no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Anatomia dos sistemas recomendadores</a> .  É claro que ninguém cancelou o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">teorema</a> da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NFL</a> , o que significa que no problema competitivo podemos tentar algoritmos diferentes. <br><br><h3>  Declaração do problema </h3><br>  Leia mais sobre a tarefa e os dados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo pelos</a> organizadores.  TL; DR aqui descreverei o mínimo necessário para entender o contexto. <br><br>  O conjunto de dados contém pouco mais de dez mil filmes com atributos anônimos.  As seguintes opções estão disponíveis como matrizes de interação de itens do usuário: <br><br><ul><li>  transações - contém fatos de usuários que compram conteúdo / alugam / visualizam por assinatura; </li><li>  classificações - classificações de filmes por usuários; </li><li>  favoritos - o evento de adicionar um filme aos favoritos. </li></ul><br>  Todas as informações são obtidas durante um certo período de tempo, apresentadas em unidades arbitrárias vinculadas ao real. <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>t</mi><mi>s</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.146ex" height="2.66ex" viewBox="0 -832 5660.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-73" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-3D" x="1108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-66" x="2165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-28" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="3105" y="0"></use><g transform="translate(3466,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-61" x="918" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6C" x="1447" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-29" x="5270" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>t</mi><mi>s</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> ts = f (ts_ {real}) </script></p><br>  O conteúdo tinha o seguinte conjunto de atributos: <br><br><img src="https://habrastorage.org/webt/14/hj/uu/14hjuuoannzvkwpal7n7xwqyvyk.png"><br><br>  Você pode ler sobre eles em detalhes no artigo pelos organizadores, mas quero prestar atenção imediatamente ao que chamou minha atenção: o parâmetro "attribute".  Continha uma sacola de atributos categóricos com uma cardinalidade de ~ 36 mil.  Havia uma média de 15 valores por filme.  À primeira vista, apenas os atributos mais básicos que descrevem o conteúdo são criptografados nesses valores: atores, diretores, país, assinaturas ou coleções às quais o filme pertence. <br><br>  É necessário prever 20 filmes que os usuários de testes assistirão nos próximos dois meses.  Os usuários de teste são 50 mil dos 500 mil usuários.  Na tabela de classificação, eles são divididos ao meio: 25 mil cada, em público / privado. <br><br><h3>  Métrica </h3><br>  Os organizadores escolheram Média Normalizar Precisão Média em 20 elementos (MNAP @ 20) como métrica.  A principal diferença do MAP habitual é que, para usuários que não assistiram a 20 filmes no período de teste, o racionamento não ocorre em k, mas no valor real dos filmes assistidos. <br><br><img src="https://habrastorage.org/webt/tk/xt/fn/tkxtfnagqxtookssvkg8rjiicqg.png"><br><br>  Leia mais e veja o código no Cython <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui.</a> <br><br><h3>  Validação </h3><br>  Chegando à solução do problema.  Antes de tudo, era necessário decidir o que era validado.  Como precisamos prever filmes no futuro, não podemos fazer uma análise simples por usuários.  Devido ao fato do tempo ser anonimizado, tive que pelo menos começar a decifrá-lo pelo menos aproximadamente.  Para fazer isso, peguei vários usuários, fiz uma programação de transações e revelei uma certa sazonalidade.  Supunha-se que fosse diário e, conhecendo a diferença horária entre os dias, podemos calcular por qual período os dados foram carregados.  Descobriu-se que eram transações por 6 meses.  Isso foi confirmado mais tarde no canal de telegrama onde o concurso foi discutido. <br><br><img src="https://habrastorage.org/webt/ba/3_/67/ba3_67yp9-znxb9b_uoeummo6li.png"><br><br>  O gráfico acima mostra a frequência horária das transações usando dados de um mês como exemplo.  Três picos importantes a cada semana são semelhantes às noites de sexta, sábado e domingo. <br><br>  Consequentemente, temos seis meses de exibição, e os filmes precisam ser previstos para os próximos dois.  Usaremos o último terço do tempo da amostra de treinamento como um conjunto de dados de validação. <br><br><img src="https://habrastorage.org/webt/mu/uy/cm/muuycmuqlah95etk4kqmdrbpygo.jpeg"><br><br>  As próximas submissões mostraram que a divisão foi bem escolhida e a velocidade de validação local se correlacionou de maneira excelente com a tabela de classificação. <br><br><h3>  Tentativa de descriptografar dados </h3><br>  Para começar, decidi tentar anonimizar todos os filmes, para que: <br><br><ul><li>  gerar um monte de sinais por meta-informação do conteúdo.  Pelo menos, as seguintes pessoas vêm à mente: gêneros, elenco, entrada em assinaturas, descrição de texto, etc; </li><li>  jogue no forno de interações laterais para reduzir a escassez da matriz.  Sim, as regras da concorrência não proibiram o uso de dados externos.  Obviamente, não havia esperança de uma correspondência com conjuntos de dados abertos, mas ninguém cancelou a análise de portais russos. </li></ul><br>  Parece ser uma motivação lógica, que, de acordo com as minhas expectativas, se tornaria uma solução completa. <br><br>  Em primeiro lugar, decidi analisar o site da Okko e retirar todos os filmes, juntamente com suas propriedades (classificação, duração, restrições de idade e outros).  Bem, como analisar - tudo acabou sendo bastante simples; nesse caso, você pode usar a API: <br><br><img src="https://habrastorage.org/webt/c6/i8/8s/c6i88s9db6wj9nl7aqvysuappt8.png"><br><br>  Depois de entrar no catálogo e escolher um gênero ou assinatura específica, você só precisava entrar em qualquer um dos elementos.  Em resposta à solicitação acima, todo o conjunto de filmes do gênero / assinatura com todos os atributos cai.  Very comfortable :) <br><br><div class="spoiler">  <b class="spoiler_title">Portanto, os atributos de um elemento na estrutura pareciam</b> <div class="spoiler_text"><pre><code class="json hljs"><span class="hljs-string"><span class="hljs-string">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"c2f98ef4-2eb5-4bfd-b765-b96589d4c470"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SERIAL"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"originalName"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"covers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"basicCovers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"      ,    ..."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"worldReleaseDate"</span></span>: <span class="hljs-number"><span class="hljs-number">1558731600000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ageAccessType"</span></span>: <span class="hljs-string"><span class="hljs-string">"16"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ageAccessDescription"</span></span>: <span class="hljs-string"><span class="hljs-string">"16+    16 "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"duration"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"trailers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"kinopoiskRating"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"okkoRating"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">"imdbRating"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"staraja-gvardija"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"has3d"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasFullHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasUltraHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasDolby"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasSound51"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasMultiAudio"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasSubtitles"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"inSubscription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"inNovelty"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"earlyWindow"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"releaseType"</span></span>: <span class="hljs-string"><span class="hljs-string">"RELEASE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"playbackStartDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"playbackTimeMark"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"products"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"PURCHASE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"consumptionMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fromConsumptionMode"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"qualities"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Q_FULL_HD"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"fromQuality"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"price"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currencyCode"</span></span>: <span class="hljs-string"><span class="hljs-string">"RUB"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"priceCategory"</span></span>: <span class="hljs-string"><span class="hljs-string">"679"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startDate"</span></span>: <span class="hljs-number"><span class="hljs-number">1554670800000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"endDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscription"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"bc682dc6-c0f7-498e-9064-7d6cafd8ca66"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"119228"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"offer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"originalPrice"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, ... ], <span class="hljs-attr"><span class="hljs-attr">"emptyReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"licenses"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"assets"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"genres"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detective"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"GENRE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detective"</span></span> } }, ... ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"countries"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3b9706f4-a681-47fb-918e-182ea9dfef0b"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"COUNTRY"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"russia"</span></span> } } ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"subscriptions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"bc682dc6-c0f7-498e-9064-7d6cafd8ca66"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"119228"</span></span> } }, ... ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"promoText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"innerColor"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"updateRateDescription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"contentCountDescription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"copyright"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionStartDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionEndDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionActivateDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"stickerText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fullSeasonPriceText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"purchaseDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"expireDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lastWatchedChildId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bookmarkDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"userRating"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"consumeDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lastStartingDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"watchDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startingDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"earlyWatchDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre> <br></div></div><br>  Resta analisar todos os gêneros, analisar JSON e permitir duplicatas, pois um filme pode pertencer a vários gêneros / assinaturas. <br><br>  Sim, aqui tive sorte e economizei muito tempo.  Se esse não for o seu caso, e você precisar analisar o conteúdo html, há artigos no hub que podem ajudar com isso, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  "O negócio é o chapéu", pensei, "só podemos segurá-lo."  "O ponto é o chapéu", percebi no dia seguinte: os dados não eram absolutamente correspondentes.  Sobre isso abaixo. <br><br>  Em primeiro lugar, o tamanho do catálogo era significativamente diferente: no conjunto de dados - 10.200, coletado no site - 8870. Isso decorre da historicidade do conjunto de dados: foi baixado apenas o que está no site agora e os dados da competição para 2018.  Alguns dos filmes ficaram indisponíveis.  Opa <br><br>  Em segundo lugar, um dos atributos em potencial da correspondência era a intuição persistente apenas sobre o seguinte: <br><br>  <i>feature5</i> - limite de idade.  Foi fácil o suficiente para entender.  A cardinalidade do atributo é de 5 valores flutuantes exclusivos e "-1".  Entre os dados coletados, o atributo "ageAccessType" foi encontrado com apenas uma cardinalidade de 5. O mapeamento ficou assim: <br><br><pre> <code class="python hljs">catalogue.age_rating = catalogue.age_rating.map({<span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.4496666915</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.5927161087</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">0.6547073468</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">0.6804096966000001</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>})</code> </pre><br>  <i>feature2</i> - classificação de filme convertido a partir da pesquisa de filmes.  Inicialmente, no estágio da EDA, a ideia de que estamos lidando com uma classificação foi submetida pela correlação do parâmetro com o número total de visualizações.  Posteriormente, a crença de que essa classificação era de uma pesquisa de filme confirmou a presença do parâmetro "kinopoiskRating" nos dados do site. <br><br>  Um passo mais perto da partida!  Agora resta encontrar uma maneira de reverter a conversão para o parâmetro <i>feature2</i> apresentado de forma anônima. <br><br>  Aqui está a aparência da distribuição de valores no <i>feature2</i> : <br><br><img src="https://habrastorage.org/webt/pq/pl/_d/pqpl_d1lpm0xed8limzxedbevfa.png"><br><br>  E assim a distribuição dos valores dos parâmetros <i>kinopoiskRating</i> : <br><br><img src="https://habrastorage.org/webt/wn/6a/np/wn6anpuxtav5ghzgq4tdme0lji8.png"><br><br>  Quando mostrei essas imagens ao meu colega Sasha, ele imediatamente viu que isso era um grau de três.  Três matemáticos não são respeitados, mas o número Pi é muito par.  Como resultado, ficou assim: <br><br><img src="https://habrastorage.org/webt/tw/tt/4u/twtt4uravymgxe1lhxj2d9ydqly.png"><br><br>  Parece ser tudo, mas não exatamente.  Vemos distribuições idênticas, mas os valores nominais e a quantidade ainda não convergem.  Se conhecêssemos um certo número de exemplos de comparação, restaria apenas aproximar uma função linear para encontrar o fator.  Mas nós não os tínhamos. <br><br>  Aproximar, a propósito, não é a palavra mais adequada.  Precisamos de uma solução com um erro quase igual a zero.  A precisão nos dados coletados é de 2 caracteres após o separador.  Se você considera que há muitos filmes com uma classificação de 6.xx e há filmes com a mesma classificação, lute pela precisão aqui. <br><br>  O que mais você pode tentar?  Você pode confiar nos valores mínimos e máximos e usar o MinMaxScaler, mas a falta de confiabilidade desse método levanta imediatamente dúvidas.  Deixe-me lembrá-lo de que o número de filmes não coincidiu inicialmente, e nosso conjunto de dados é histórico e o estado atual no site.  I.e.  não há garantias de que os filmes com classificações mínima e máxima em ambos os grupos sejam idênticos (verificou-se que eles tinham uma restrição de idade diferente e a duração não convergiu da palavra "completamente"), assim como não há entendimento de quantas vezes a OKKO é atualizada API que muda diariamente a classificação da pesquisa de filmes. <br><br>  Então ficou claro que eu precisava de mais candidatos a atributos para correspondência. <br><br>  <b>O que mais é interessante?</b> <br><br>  <i>feature1</i> é algum tipo de data.  Em tese, por datas, os organizadores prometeram a preservação da separação de estados, o que implicava uma função linear.  Em geral, a transformação deveria ter sido idêntica ao atributo <i>ts</i> para as matrizes de interação.  Se você olhar para a distribuição de filmes por <i>feature_1</i> ... <br><br><img src="https://habrastorage.org/webt/q2/94/dn/q294dngcpjgbfdgxcpwsrsv-1lu.png"><br><br>  ... a hipótese da data de lançamento do filme é imediatamente eliminada.  A intuição sugere que o número de filmes produzidos pela indústria deve aumentar ao longo do tempo.  Isto é confirmado abaixo. <br><br>  Existem 14 atributos nos dados que recebemos do site.  De fato, infelizmente, os valores estavam contidos apenas para o seguinte: <br><br><img src="https://habrastorage.org/webt/wg/bw/64/wgbw64outbnbatpbee2vt5ge8y0.png"><br><br><img src="https://habrastorage.org/webt/5t/ba/pw/5tbapwosxnjwma2wxnznoj3ntfm.png"><br><br><img src="https://habrastorage.org/webt/rj/l8/jb/rjl8jbpximeqbwahvzmrdbummm4.png"><br><br>  Nenhum dos exemplos acima é semelhante ao <i>feature_1</i> .  Bem, não havia mais idéias para comparação, e parece que todo o barulho com essa tarefa foi em vão.  É claro que ouvi falar de concursos, onde os caras marcaram os dados manualmente, mas não quando se trata de centenas e milhares de cópias. <br><br><h3>  Solução </h3><br>  <b>1. Modelos simples</b> <br><br>  Percebendo que nem tudo é tão simples, comecei a trabalhar humildemente com o que é.  Para começar, eu queria começar com um simples.  Tentei várias soluções frequentemente usadas na indústria, a saber: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">filtragem colaborativa</a> (no nosso caso, baseada em itens) e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fatoração de matrizes</a> . <br><br>  A comunidade faz uso extensivo de algumas bibliotecas python adequadas para essas tarefas: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">implícita</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LightFM</a> .  O primeiro é capaz de fatorar com base no ALS, bem como na filtragem colaborativa de vizinhos mais próximos, com várias opções para pré-processar a matriz item-item.  O segundo possui dois fatores distintos: <br><br><ul><li>  A fatoração é baseada no SGD, o que possibilita o uso de funções de perda baseadas em amostragem, incluindo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WARP</a> . </li><li>  Ele usa uma abordagem híbrida, combinando informações sobre atributos e itens do usuário no modelo de forma que o vetor latente do usuário seja a soma dos vetores latentes de seus atributos.  E da mesma forma para itens.  Essa abordagem se torna extremamente conveniente quando há um problema de partida a frio para o usuário / item. </li></ul><br>  Como não possuímos atributos de usuário (além da capacidade de exibi-los com base na interação com os filmes), usei apenas os atributos dos itens. <br><br>  No total, 6 configurações foram para enumerar os parâmetros.  Uma combinação de três matrizes foi usada como matriz de interação, onde as classificações foram convertidas em binárias.  Resultados comparativos com os melhores hiperparâmetros para cada configuração na tabela abaixo. <br><div class="scrollable-table"><table><tbody><tr><td>  <b>Modelo</b> </td><td>  <b>Teste MNAP @ 20</b> </td></tr><tr><td>  ALS implícito </td><td>  0,02646 </td></tr><tr><td>  Cosine implícito kNN CF </td><td>  <b>0,03170</b> </td></tr><tr><td>  TFIDF implícito kNN CF </td><td>  0,03113 </td></tr><tr><td>  LightFM (sem recursos do item), perda de BPR </td><td>  0,02567 </td></tr><tr><td>  LightFM (sem recursos do item), perda de WARP </td><td>  0,02632 </td></tr><tr><td>  LightFM com recursos de itens, perda de WARP </td><td>  0,02635 </td></tr></tbody></table></div><br>  Como você pode ver, a filtragem colaborativa clássica provou ser muito melhor do que outros modelos.  Não é perfeito, mas não é necessário muito da linha de base.  Enviar com esta configuração forneceu 0,03048 no ranking público.  Não me lembro da posição naquele momento, mas no momento do encerramento da competição, essa finalização definitivamente alcançaria o top 80 e proporcionou uma medalha de bronze. <br><br>  <b>2. Olá Boosting</b> <br><br>  O que poderia ser melhor que um modelo?  Correto: vários modelos. <br><br>  Portanto, a próxima opção foi o conjunto ou, no contexto das recomendações, um modelo de classificação do segundo nível.  Como abordagem, peguei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">este</a> artigo dos caras da Avito.  Parece estar cozinhando estritamente de acordo com a receita, mexendo e temperando periodicamente com os atributos dos filmes.  O único desvio foi o número de candidatos: peguei os 200 melhores no LightFM, porque  com 500.000 usuários, mais simplesmente não coube na memória. <br><br>  Como resultado, a velocidade obtida por mim na validação foi pior do que em um modelo. <br><br>  Após vários dias de experimentação, percebeu-se que nada estava funcionando e que nada funcionaria por si só.  Ou não sei como cozinhar (spoiler: a segunda resposta correta).  O que estou fazendo de errado?  Duas razões vieram à mente: <br><br><ul><li>  Por um lado, tirar as 200 primeiras do modelo de primeiro nível é sensato do ponto de vista da geração de amostras "negativas", ou seja,  aqueles filmes que também são relevantes para o usuário, mas não são assistidos por ele.  Por outro lado, alguns desses filmes podem ser assistidos durante o período de teste, e apresentamos esses exemplos como negativos.  Em seguida, decidi reduzir os riscos desse fato, reconsiderando a hipótese com o seguinte experimento: tomei todos os exemplos positivos + aleatórios para a amostra de treinamento.  A velocidade na amostra de teste não melhorou.  Aqui é necessário esclarecer que, na amostra do teste, também havia previsões de topo do modelo de primeiro nível, porque na tabela de líderes ninguém me contou todos os exemplos positivos. </li><li>  Dos 10.200 filmes disponíveis no catálogo, apenas 8.296 filmes fizeram interações.  Quase 2.000 filmes foram privados da atenção do usuário, em parte porque não estavam disponíveis para compra / aluguel / como parte de uma assinatura.  Os caras do chat perguntaram se filmes inacessíveis poderiam ficar disponíveis no período de teste.  A resposta foi sim.  É definitivamente impossível jogá-los fora.  Assim, sugeri que quase 2.000 filmes adicionais estarão disponíveis nos próximos 2 meses.  Caso contrário, por que jogá-los no conjunto de dados? </li></ul><br>  <b>3. Neurônios</b> <br><br>  No parágrafo anterior, a pergunta foi feita: como podemos trabalhar com filmes para os quais não há interações?  Sim, recordamos os recursos do item no LightFM, mas, como lembramos, eles não entraram.  O que mais?  Neurônios! <br><br>  O arsenal de código aberto possui algumas bibliotecas de alto nível bastante populares para trabalhar com sistemas de recomendação: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Spotlight</a> de Maciej Kula (autor do LightFM) e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TensorRec</a> .  O primeiro sob o capô PyTorch, o segundo - Tensorflow. <br><br>  O Spotlight pode levar em consideração conjuntos de dados implícitos / explícitos com neurônios e sequências de modelos.  Ao mesmo tempo, na fatoração “pronta para uso”, não há como adicionar recursos de usuário / item; <br><br>  O TensorRec, por outro lado, sabe apenas como fatorar e é uma estrutura interessante: <br><br><ul><li>  gráfico de representação - um método de transformação (pode ser definido de forma diferente para o usuário / item) dos dados de entrada na incorporação, com base nos quais os cálculos no gráfico de previsão ocorrerão.  A escolha consiste em camadas com diferentes opções de ativação.  Também é possível usar uma classe abstrata e manter uma transformação personalizada, consistindo em uma sequência de camadas keras. </li><li>  O gráfico de previsão permite selecionar a operação no final: seu produto de ponto favorito, distância euclidiana e cosseno. </li><li>  perda - também há muito por onde escolher.  Ficamos satisfeitos com a implementação do WMRB (essencialmente o mesmo WARP, só sabe aprender em lote e distribuído) </li></ul><br>  Mais importante ainda, o TensorRec é capaz de trabalhar com recursos contextuais e, de fato, o autor admite que ele foi originalmente inspirado pela idéia do LightFM.  Bem, vamos ver.  Tomamos interações (somente transações) e recursos de itens. <br><br>  Enviamos para pesquisa de várias configurações e aguardamos.  Comparado ao LightFM, o treinamento e a validação levam muito tempo. <br><br>  Além disso, havia alguns inconvenientes que precisavam ser encontrados: <br><br><ol><li>  Ao alterar o sinalizador detalhado, o método de <i>ajuste</i> não mudou nada e nenhum retorno de chamada foi fornecido para você.  Eu tive que escrever uma função que treinou internamente uma época usando o método <i>fit_partial</i> e, em seguida, executei a validação para treinamento e teste (em ambos os casos, as amostras foram usadas para acelerar o processo). </li><li>  Em geral, o autor do framework é um ótimo companheiro e utiliza o tf.SparseTensor em qualquer lugar.  No entanto, vale a pena entender que, como previsão, inclusive para validação, o resultado é denso como um vetor com o comprimento n_items para cada usuário.  Duas dicas seguem a seguir: faça um ciclo para gerar previsões com lotes (o método da biblioteca não possui esse parâmetro) com filtragem top-k e prepare as tiras com RAM. </li></ol><br>  Por fim, na melhor opção de configuração, consegui extrair 0,02869 na minha amostra de teste.  Havia algo semelhante ao LB. <br><br>  Bem, o que eu esperava?  Que a adição de não linearidade aos recursos do item dará um duplo aumento na métrica?  É ingênuo. <br><br>  <b>4. Beck essa tarefa</b> <br><br>  Então espere um momento.  Parece que eu novamente encontrei neurônios de malabarismo.  Que hipótese eu queria testar quando assumi esse negócio?  A hipótese foi: “Nos próximos 2 meses da seleção atrasada, quase 2.000 novos filmes serão vistos na tabela de classificação.  Alguns deles terão uma grande quantidade de opiniões. ” <br><br>  Então você pode verificá-lo em duas etapas: <br><br><ol><li>  Seria bom ver quantos filmes nós adicionamos no período de teste honestamente dividido por nós em relação ao trem.  Se considerarmos apenas as opiniões, os filmes “novos” são apenas 240 (!).  A hipótese imediatamente tremeu.  Parece que a compra de novo conteúdo não pode diferir nessa quantidade de período para período. </li><li>  Nós terminamos.  Temos a oportunidade de treinar o modelo para usar apenas a apresentação com base nos recursos do item (no LightFM, por exemplo, isso é feito por padrão, se não preenchermos previamente a matriz de atributos com a matriz de identidade).  Além disso, por infidelidade, podemos nos submeter apenas a este modelo (!) Nossos filmes inacessíveis e nunca vistos.  A partir desses resultados, enviamos e obtemos 0,0000136. </li></ol><br>  Bingo!  Isso significa que você pode parar de extrair a semântica dos atributos do filme.  A propósito, mais tarde, no DataFest, os caras da OKKO disseram que a maior parte do conteúdo inacessível eram apenas alguns filmes antigos. <br><br>  Você precisa tentar algo novo e novo - velho e esquecido.  No nosso caso, não completamente esquecido, mas o que aconteceu alguns dias atrás.  Filtragem colaborativa? <br><br>  <b>5. Ajuste a linha de base</b> <br><br>  Como posso ajudar a linha de base do CF? <br><br>  <b>Idéia número 1</b> <br><br>  Na Internet, encontrei uma apresentação sobre o uso do teste da razão de verossimilhança para filtrar filmes menores. <br><br>  Abaixo deixarei meu código python para calcular a pontuação do LLR, que tive que escrever de joelhos para testar essa ideia. <br><br><div class="spoiler">  <b class="spoiler_title">Cálculo LLR</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.sparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> csr_matrix <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tqdm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tqdm <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LLR</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, interaction_matrix, interaction_matrix_2=None)</span></span></span><span class="hljs-function">:</span></span> interactions, lack_of_interactions = self.make_two_tables(interaction_matrix) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> interaction_matrix_2 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: interactions_2, lack_of_interactions_2 = self.make_two_tables(interaction_matrix_2) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: interactions_2, lack_of_interactions_2 = interactions, lack_of_interactions self.num_items = interaction_matrix.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>] self.llr_matrix = np.zeros((self.num_items, self.num_items)) <span class="hljs-comment"><span class="hljs-comment"># k11 - item-item co-occurrence self.k_11 = np.dot(interactions, interactions_2.T) # k12 - how many times row elements was bought without column elements self.k_12 = np.dot(interactions, lack_of_interactions_2.T) # k21 - how many times column elements was bought without row elements self.k_21 = np.dot(lack_of_interactions, interactions_2.T) # k22 - how many times elements was not bought together self.k_22 = np.dot(lack_of_interactions, lack_of_interactions_2.T) def make_two_tables(self, interaction_matrix): interactions = interaction_matrix if type(interactions) == csr_matrix: interactions = interactions.todense() interactions = np.array(interactions.astype(bool).T) lack_of_interactions = ~interactions interactions = np.array(interactions, dtype=np.float32) lack_of_interactions = np.array(lack_of_interactions, dtype=np.float32) return interactions, lack_of_interactions def entropy(self, k): N = np.sum(k) return np.nansum((k / N + (k == 0)) * np.log(k / N)) def get_LLR(self, item_1, item_2): k = np.array([[self.k_11[item_1, item_2], self.k_12[item_1, item_2]], [self.k_21[item_1, item_2], self.k_22[item_1, item_2]]]) LLR = 2 * np.sum(k) * (self.entropy(k) - self.entropy(np.sum(k, axis=0)) - self.entropy(np.sum(k, axis=1))) return LLR def compute_llr_matrix(self): for item_1 in range(self.num_items): for item_2 in range(item_1, self.num_items): self.llr_matrix[item_1, item_2] = self.get_LLR(item_1, item_2) if item_1 != item_2: self.llr_matrix[item_2, item_1] = self.llr_matrix[item_1, item_2] def get_top_n(self, n=100, mask=False): filtered_matrix = self.llr_matrix.copy() for i in tqdm(range(filtered_matrix.shape[0])): ind = np.argpartition(filtered_matrix[i], -n)[-n:] filtered_matrix[i][[x for x in range(filtered_matrix.shape[0]) if x not in ind]] = 0 if mask: return filtered_matrix != 0 else: return filtered_matrix</span></span></code> </pre><br></div></div><br>  Como resultado, a matriz resultante pode ser usada como uma máscara para deixar apenas as interações mais significativas e existem duas opções: use threshold ou deixe os elementos top-k com o valor mais alto.  Da mesma forma, a combinação de várias influências em uma compra em uma velocidade é usada para classificar itens; em outras palavras, o teste mostra o quanto é importante, por exemplo, adicionar aos favoritos a possibilidade de conversão em uma compra.  Parece promissor, mas o uso mostrou que a filtragem usando a pontuação LLR gera um aumento muito pequeno, e a combinação de várias pontuações apenas piora o resultado.  Aparentemente, o método não é para esses dados.  Das vantagens, só posso notar que, ao descobrir como implementar essa idéia, tive que cavar o implícito sob o capô. <br><br>  Um exemplo de aplicação implícita dessa lógica personalizada será deixado sob o gato. <br><br><div class="spoiler">  <b class="spoiler_title">Modificação da matriz em implícita</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   LLR scores.     n_items * n_items. llr = LLR(train_csr, train_csr) llr.compute_llr_matrix() #     id, ,      llr_based_mask = llr.get_top_n(n=500, mask=True) #     ,  - CosineRecommender. model = CosineRecommender(K=10200) model.fit(train_csr.T) # model.similarity -   co-occurrence (  Cosine - ).        . masked_matrix = np.array(model.similarity.todense()) * llr_based_mask #  fit()  scorer     model.similarity. #     . model.scorer = NearestNeighboursScorer(csr_matrix(masked_matrix)) #      :   recommend   . test_predict = {} for id_ in tqdm(np.unique(test_csr.nonzero()[0])): test_predict[id_] = model.recommend(id_, train_csr, filter_already_liked_items=True, N=20) #   tuples (item_id, score),   id  . test_predict_ids = {k: [x[0] for x in v] for k, v in test_predict.items()} #       / ,     ,   Cython.</span></span></code> </pre> <br></div></div><br>  <b>Idéia número 2</b> <br><br>  Outra idéia surgiu que poderia melhorar as previsões sobre a filtragem colaborativa simples.  O setor costuma usar algum tipo de função de amortecimento para estimativas antigas, mas temos um caso não tão simples.  Provavelmente, você precisa levar em consideração 2 casos possíveis: <br><br><ol><li>  Os usuários que assistem ao serviço são principalmente novos </li><li>  "Examinadores".  Ou seja, aqueles que vieram relativamente recentemente e podem assistir a filmes populares anteriormente. </li></ol><br>  Assim, é possível dividir o componente colaborativo em dois grupos diferentes automaticamente.  Para fazer isso, inventei uma função que, em vez de valores implícitos, definidos como "1" ou "0" na interseção do usuário e do filme, um valor que mostra a importância desse filme no histórico de exibição do usuário. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>t</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mi>i</mi><mi>l</mi><mi>m</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3B1;</mo></mrow><mo>&amp;#x2217;</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3B2;</mo></mrow><mo>&amp;#x2217;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x394;</mo></mrow><mi>W</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.356ex" height="2.66ex" viewBox="0 -832 22111.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-72" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-75" x="813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-73" x="1385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="1855" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-28" x="2216" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-66" x="2606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-69" x="3156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6C" x="3502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6D" x="3800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-65" x="4679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-29" x="5145" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-3D" x="5812" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-3B1" x="6869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-2217" x="7731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-53" x="8454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="9100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-61" x="9461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-72" x="9991" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="10442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-54" x="10804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-69" x="11508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6D" x="11854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-65" x="12732" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-2B" x="13421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-3B2" x="14421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-2217" x="15210" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-394" x="15933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-57" x="16766" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-61" x="17815" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="18344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-63" x="18706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-68" x="19139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-54" x="19716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-69" x="20420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6D" x="20766" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-65" x="21644" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>t</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>f</mi><mi>i</mi><mi>l</mi><mi>m</mi><mi>e</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>α</mo></mrow><mo>∗</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo>β</mo></mrow><mo>∗</mo><mrow class="MJX-TeXAtom-ORD"><mo>Δ</mo></mrow><mi>W</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> trust (filme) = α * StartTime + β * ΔWatchTime </script></p><br>  onde <i>StartTime</i> é a data de lançamento do filme e <i>ΔWatchTime</i> é a diferença entre a data de lançamento e a data em que o usuário assistiu, e <i>α</i> e <i>β</i> são hiperparâmetros. <br><br>  Aqui, o primeiro termo é responsável por aumentar a velocidade dos filmes lançados recentemente, e o segundo é levar em consideração o vício dos usuários em filmes antigos.  Se um filme foi lançado há muito tempo e o usuário o comprou imediatamente, hoje, esse fato não deve ser levado em consideração muito.  Se esse é um tipo de novidade, recomendamos que seja recomendado a um número maior de usuários que também assistem a novos itens.  Se o filme é bastante antigo e o usuário o assistiu apenas agora, isso também pode ser importante para pessoas como ele. <br><br>  Ainda existe um pouco - para separar os coeficientes <i>α</i> e <i>β</i> .  Sair para a noite, e o trabalho está feito.  Como não havia nenhuma suposição sobre o intervalo, ele foi inicialmente grande e abaixo estão os resultados de uma pesquisa ideal local. <br><br><img src="https://habrastorage.org/webt/ej/iy/qk/ejiyqkpfmhz43nlifcd3o_zv40o.png"><br><br>  Usando essa idéia, um modelo simples em uma matriz deu uma velocidade de 0,03627 na validação local e 0,03685 no LB público, o que imediatamente parece um bom impulso em comparação com os resultados anteriores.  Naquele momento, ele me levou ao top 20. <br><br> <b> №3</b> <br><br>    ,   ,    ,    .     CF   .      : <br><br><img src="https://habrastorage.org/webt/pk/xd/uk/pkxduk8vw3eyyojevyibbesixbi.png"><br><br> ,            25 . <br><br> ,    ,    0.040312    ,         0.03870  0.03990  public/private      14-   . <br><br><h3> Acknowledgments </h3><br>    jupyter notebook —  .      ,     .      output       .      .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cookiecutter-data-science</a> — Ocean.       .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> .                   . <br><br><h3>   ( ) </h3><br>       private  ,                   .    ,                 .   : <br><br><img src="https://habrastorage.org/webt/vq/c1/ds/vqc1dsjoq63esgrlttp3v9-ky2g.jpeg"><br><br> ,   ,        ,   : <br><br><img src="https://habrastorage.org/webt/p3/im/w3/p3imw3yj1ip5bvqorv_uexldawu.jpeg"><br><br>            ,   2 .           .  ,       . <br><br><img src="https://habrastorage.org/webt/i9/rs/gw/i9rsgwcjimnuhjbgqcpmlyaj2rk.jpeg"><br><br><h3>  Conclusão </h3><br>  —  .      ,     .    ?   ,        —  feature importance   ,   ,       «»   . ,    . <br><br> ,           .    ; , ,  . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt461055/">https://habr.com/ru/post/pt461055/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt461045/index.html">Obtenha uma extração do Rosreestr através do FSIS USRN e python. Parte 1</a></li>
<li><a href="../pt461047/index.html">Escrever ou não escrever. Cartas às autoridades durante os eventos</a></li>
<li><a href="../pt461049/index.html">ONYX BOOX Faust - Quem procura não é obrigado a passear</a></li>
<li><a href="../pt461051/index.html">Os 10 erros mais comuns que encontrei nos projetos Go</a></li>
<li><a href="../pt461053/index.html">Conectamos mapas on-line ao navegador no smartphone. Parte 2 - cartões de vetor</a></li>
<li><a href="../pt461057/index.html">Canais de telegrama sobre desenvolvimento de jogos</a></li>
<li><a href="../pt461059/index.html">Escrevendo um aplicativo Android para fãs de filmes - Parte 1 (prototipagem)</a></li>
<li><a href="../pt461061/index.html">Ligas de magnésio, limites duplos e segregação</a></li>
<li><a href="../pt461063/index.html">Interação de R com bancos de dados no exemplo do Microsoft SQL Server e outros DBMS</a></li>
<li><a href="../pt461067/index.html">As 65 principais perguntas sobre SQL das entrevistas de emprego para as quais você deve estar preparado em 2019. Parte I</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>