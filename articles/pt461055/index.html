<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêô üìõ üéá Rekko Challenge 2019: como foi üåü üë®‚Äçüîß üë®‚Äçüë©‚Äçüë¶‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° pouco tempo, um concurso de sistemas de recomenda√ß√£o do cinema online Okko - Rekko Challenge 2019 foi realizado na plataforma Boosters . Para mim, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rekko Challenge 2019: como foi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/461055/"><img src="https://habrastorage.org/webt/hb/u7/gu/hbu7guq0ic25zumfxsf5bbipkcq.png"><br><br>  H√° pouco tempo, um concurso de sistemas de recomenda√ß√£o do cinema online Okko - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rekko Challenge 2019</a> foi realizado na plataforma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Boosters</a> .  Para mim, essa foi a primeira experi√™ncia de participar de uma competi√ß√£o com uma tabela de l√≠deres (antes eu tentava for√ßa apenas em uma hackathon).  A tarefa √© interessante e familiar para mim da pr√°tica; existe um fundo de pr√™mios, o que significa que fazia sentido participar.  Como resultado, ocupei o 14¬∫ lugar, pelo qual os organizadores emitiram uma camiseta comemorativa.  Nice  Obrigada <br><br>  Neste artigo, imergirei voc√™ brevemente na tarefa, falarei sobre as hip√≥teses apresentadas por mim, bem como como arrastar a concorr√™ncia nos sistemas de recomenda√ß√£o e entrar no top 15 sem acumular experi√™ncia, o que ser√° especialmente √∫til para aqueles que apenas participar√£o de concursos. <br><a name="habracut"></a><br><h3>  Sistemas Recomendadores </h3><br>  O principal objetivo dos sistemas de recomenda√ß√£o √© dar ao usu√°rio o que ele <s>deseja</s> comprar (infelizmente, essa vis√£o hipertrofiada √© imposta a n√≥s por aplicativos comerciais). <br>  Existem diferentes instru√ß√µes de tarefas (classifica√ß√£o, busca por similares, previs√£o de um elemento espec√≠fico) e, portanto, maneiras de resolv√™-las.  Bem, todos n√≥s amamos a variabilidade na escolha, que √© fornecida por um conjunto de v√°rias solu√ß√µes poss√≠veis para cada problema.  V√°rias abordagens s√£o bem descritas no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Anatomia dos sistemas recomendadores</a> .  √â claro que ningu√©m cancelou o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">teorema</a> da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">NFL</a> , o que significa que no problema competitivo podemos tentar algoritmos diferentes. <br><br><h3>  Declara√ß√£o do problema </h3><br>  Leia mais sobre a tarefa e os dados no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo pelos</a> organizadores.  TL; DR aqui descreverei o m√≠nimo necess√°rio para entender o contexto. <br><br>  O conjunto de dados cont√©m pouco mais de dez mil filmes com atributos an√¥nimos.  As seguintes op√ß√µes est√£o dispon√≠veis como matrizes de intera√ß√£o de itens do usu√°rio: <br><br><ul><li>  transa√ß√µes - cont√©m fatos de usu√°rios que compram conte√∫do / alugam / visualizam por assinatura; </li><li>  classifica√ß√µes - classifica√ß√µes de filmes por usu√°rios; </li><li>  favoritos - o evento de adicionar um filme aos favoritos. </li></ul><br>  Todas as informa√ß√µes s√£o obtidas durante um certo per√≠odo de tempo, apresentadas em unidades arbitr√°rias vinculadas ao real. <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>t</mi><mi>s</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>t</mi><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.146ex" height="2.66ex" viewBox="0 -832 5660.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-73" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-3D" x="1108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-66" x="2165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-28" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="3105" y="0"></use><g transform="translate(3466,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-61" x="918" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6C" x="1447" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-29" x="5270" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>t</mi><mi>s</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>t</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>e</mi><mi>a</mi><mi>l</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> ts = f (ts_ {real}) </script></p><br>  O conte√∫do tinha o seguinte conjunto de atributos: <br><br><img src="https://habrastorage.org/webt/14/hj/uu/14hjuuoannzvkwpal7n7xwqyvyk.png"><br><br>  Voc√™ pode ler sobre eles em detalhes no artigo pelos organizadores, mas quero prestar aten√ß√£o imediatamente ao que chamou minha aten√ß√£o: o par√¢metro "attribute".  Continha uma sacola de atributos categ√≥ricos com uma cardinalidade de ~ 36 mil.  Havia uma m√©dia de 15 valores por filme.  √Ä primeira vista, apenas os atributos mais b√°sicos que descrevem o conte√∫do s√£o criptografados nesses valores: atores, diretores, pa√≠s, assinaturas ou cole√ß√µes √†s quais o filme pertence. <br><br>  √â necess√°rio prever 20 filmes que os usu√°rios de testes assistir√£o nos pr√≥ximos dois meses.  Os usu√°rios de teste s√£o 50 mil dos 500 mil usu√°rios.  Na tabela de classifica√ß√£o, eles s√£o divididos ao meio: 25 mil cada, em p√∫blico / privado. <br><br><h3>  M√©trica </h3><br>  Os organizadores escolheram M√©dia Normalizar Precis√£o M√©dia em 20 elementos (MNAP @ 20) como m√©trica.  A principal diferen√ßa do MAP habitual √© que, para usu√°rios que n√£o assistiram a 20 filmes no per√≠odo de teste, o racionamento n√£o ocorre em k, mas no valor real dos filmes assistidos. <br><br><img src="https://habrastorage.org/webt/tk/xt/fn/tkxtfnagqxtookssvkg8rjiicqg.png"><br><br>  Leia mais e veja o c√≥digo no Cython <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui.</a> <br><br><h3>  Valida√ß√£o </h3><br>  Chegando √† solu√ß√£o do problema.  Antes de tudo, era necess√°rio decidir o que era validado.  Como precisamos prever filmes no futuro, n√£o podemos fazer uma an√°lise simples por usu√°rios.  Devido ao fato do tempo ser anonimizado, tive que pelo menos come√ßar a decifr√°-lo pelo menos aproximadamente.  Para fazer isso, peguei v√°rios usu√°rios, fiz uma programa√ß√£o de transa√ß√µes e revelei uma certa sazonalidade.  Supunha-se que fosse di√°rio e, conhecendo a diferen√ßa hor√°ria entre os dias, podemos calcular por qual per√≠odo os dados foram carregados.  Descobriu-se que eram transa√ß√µes por 6 meses.  Isso foi confirmado mais tarde no canal de telegrama onde o concurso foi discutido. <br><br><img src="https://habrastorage.org/webt/ba/3_/67/ba3_67yp9-znxb9b_uoeummo6li.png"><br><br>  O gr√°fico acima mostra a frequ√™ncia hor√°ria das transa√ß√µes usando dados de um m√™s como exemplo.  Tr√™s picos importantes a cada semana s√£o semelhantes √†s noites de sexta, s√°bado e domingo. <br><br>  Consequentemente, temos seis meses de exibi√ß√£o, e os filmes precisam ser previstos para os pr√≥ximos dois.  Usaremos o √∫ltimo ter√ßo do tempo da amostra de treinamento como um conjunto de dados de valida√ß√£o. <br><br><img src="https://habrastorage.org/webt/mu/uy/cm/muuycmuqlah95etk4kqmdrbpygo.jpeg"><br><br>  As pr√≥ximas submiss√µes mostraram que a divis√£o foi bem escolhida e a velocidade de valida√ß√£o local se correlacionou de maneira excelente com a tabela de classifica√ß√£o. <br><br><h3>  Tentativa de descriptografar dados </h3><br>  Para come√ßar, decidi tentar anonimizar todos os filmes, para que: <br><br><ul><li>  gerar um monte de sinais por meta-informa√ß√£o do conte√∫do.  Pelo menos, as seguintes pessoas v√™m √† mente: g√™neros, elenco, entrada em assinaturas, descri√ß√£o de texto, etc; </li><li>  jogue no forno de intera√ß√µes laterais para reduzir a escassez da matriz.  Sim, as regras da concorr√™ncia n√£o proibiram o uso de dados externos.  Obviamente, n√£o havia esperan√ßa de uma correspond√™ncia com conjuntos de dados abertos, mas ningu√©m cancelou a an√°lise de portais russos. </li></ul><br>  Parece ser uma motiva√ß√£o l√≥gica, que, de acordo com as minhas expectativas, se tornaria uma solu√ß√£o completa. <br><br>  Em primeiro lugar, decidi analisar o site da Okko e retirar todos os filmes, juntamente com suas propriedades (classifica√ß√£o, dura√ß√£o, restri√ß√µes de idade e outros).  Bem, como analisar - tudo acabou sendo bastante simples; nesse caso, voc√™ pode usar a API: <br><br><img src="https://habrastorage.org/webt/c6/i8/8s/c6i88s9db6wj9nl7aqvysuappt8.png"><br><br>  Depois de entrar no cat√°logo e escolher um g√™nero ou assinatura espec√≠fica, voc√™ s√≥ precisava entrar em qualquer um dos elementos.  Em resposta √† solicita√ß√£o acima, todo o conjunto de filmes do g√™nero / assinatura com todos os atributos cai.  Very comfortable :) <br><br><div class="spoiler">  <b class="spoiler_title">Portanto, os atributos de um elemento na estrutura pareciam</b> <div class="spoiler_text"><pre><code class="json hljs"><span class="hljs-string"><span class="hljs-string">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"c2f98ef4-2eb5-4bfd-b765-b96589d4c470"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SERIAL"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"originalName"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"covers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"basicCovers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"      ,    ..."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"worldReleaseDate"</span></span>: <span class="hljs-number"><span class="hljs-number">1558731600000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ageAccessType"</span></span>: <span class="hljs-string"><span class="hljs-string">"16"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ageAccessDescription"</span></span>: <span class="hljs-string"><span class="hljs-string">"16+    16 "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"duration"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"trailers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"kinopoiskRating"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"okkoRating"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">"imdbRating"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"staraja-gvardija"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"has3d"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasFullHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasUltraHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasDolby"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasSound51"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasMultiAudio"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasSubtitles"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"inSubscription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"inNovelty"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"earlyWindow"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"releaseType"</span></span>: <span class="hljs-string"><span class="hljs-string">"RELEASE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"playbackStartDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"playbackTimeMark"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"products"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"PURCHASE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"consumptionMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fromConsumptionMode"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"qualities"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Q_FULL_HD"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"fromQuality"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"price"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currencyCode"</span></span>: <span class="hljs-string"><span class="hljs-string">"RUB"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"priceCategory"</span></span>: <span class="hljs-string"><span class="hljs-string">"679"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startDate"</span></span>: <span class="hljs-number"><span class="hljs-number">1554670800000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"endDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscription"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"bc682dc6-c0f7-498e-9064-7d6cafd8ca66"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"119228"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"offer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"originalPrice"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, ... ], <span class="hljs-attr"><span class="hljs-attr">"emptyReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"licenses"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"assets"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"genres"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detective"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"GENRE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detective"</span></span> } }, ... ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"countries"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3b9706f4-a681-47fb-918e-182ea9dfef0b"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"COUNTRY"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"russia"</span></span> } } ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"subscriptions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"bc682dc6-c0f7-498e-9064-7d6cafd8ca66"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"119228"</span></span> } }, ... ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"promoText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"innerColor"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"updateRateDescription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"contentCountDescription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"copyright"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionStartDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionEndDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionActivateDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"stickerText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fullSeasonPriceText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"purchaseDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"expireDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lastWatchedChildId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bookmarkDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"userRating"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"consumeDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lastStartingDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"watchDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startingDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"earlyWatchDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre> <br></div></div><br>  Resta analisar todos os g√™neros, analisar JSON e permitir duplicatas, pois um filme pode pertencer a v√°rios g√™neros / assinaturas. <br><br>  Sim, aqui tive sorte e economizei muito tempo.  Se esse n√£o for o seu caso, e voc√™ precisar analisar o conte√∫do html, h√° artigos no hub que podem ajudar com isso, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  "O neg√≥cio √© o chap√©u", pensei, "s√≥ podemos segur√°-lo."  "O ponto √© o chap√©u", percebi no dia seguinte: os dados n√£o eram absolutamente correspondentes.  Sobre isso abaixo. <br><br>  Em primeiro lugar, o tamanho do cat√°logo era significativamente diferente: no conjunto de dados - 10.200, coletado no site - 8870. Isso decorre da historicidade do conjunto de dados: foi baixado apenas o que est√° no site agora e os dados da competi√ß√£o para 2018.  Alguns dos filmes ficaram indispon√≠veis.  Opa <br><br>  Em segundo lugar, um dos atributos em potencial da correspond√™ncia era a intui√ß√£o persistente apenas sobre o seguinte: <br><br>  <i>feature5</i> - limite de idade.  Foi f√°cil o suficiente para entender.  A cardinalidade do atributo √© de 5 valores flutuantes exclusivos e "-1".  Entre os dados coletados, o atributo "ageAccessType" foi encontrado com apenas uma cardinalidade de 5. O mapeamento ficou assim: <br><br><pre> <code class="python hljs">catalogue.age_rating = catalogue.age_rating.map({<span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.4496666915</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.5927161087</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">0.6547073468</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">0.6804096966000001</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>})</code> </pre><br>  <i>feature2</i> - classifica√ß√£o de filme convertido a partir da pesquisa de filmes.  Inicialmente, no est√°gio da EDA, a ideia de que estamos lidando com uma classifica√ß√£o foi submetida pela correla√ß√£o do par√¢metro com o n√∫mero total de visualiza√ß√µes.  Posteriormente, a cren√ßa de que essa classifica√ß√£o era de uma pesquisa de filme confirmou a presen√ßa do par√¢metro "kinopoiskRating" nos dados do site. <br><br>  Um passo mais perto da partida!  Agora resta encontrar uma maneira de reverter a convers√£o para o par√¢metro <i>feature2</i> apresentado de forma an√¥nima. <br><br>  Aqui est√° a apar√™ncia da distribui√ß√£o de valores no <i>feature2</i> : <br><br><img src="https://habrastorage.org/webt/pq/pl/_d/pqpl_d1lpm0xed8limzxedbevfa.png"><br><br>  E assim a distribui√ß√£o dos valores dos par√¢metros <i>kinopoiskRating</i> : <br><br><img src="https://habrastorage.org/webt/wn/6a/np/wn6anpuxtav5ghzgq4tdme0lji8.png"><br><br>  Quando mostrei essas imagens ao meu colega Sasha, ele imediatamente viu que isso era um grau de tr√™s.  Tr√™s matem√°ticos n√£o s√£o respeitados, mas o n√∫mero Pi √© muito par.  Como resultado, ficou assim: <br><br><img src="https://habrastorage.org/webt/tw/tt/4u/twtt4uravymgxe1lhxj2d9ydqly.png"><br><br>  Parece ser tudo, mas n√£o exatamente.  Vemos distribui√ß√µes id√™nticas, mas os valores nominais e a quantidade ainda n√£o convergem.  Se conhec√™ssemos um certo n√∫mero de exemplos de compara√ß√£o, restaria apenas aproximar uma fun√ß√£o linear para encontrar o fator.  Mas n√≥s n√£o os t√≠nhamos. <br><br>  Aproximar, a prop√≥sito, n√£o √© a palavra mais adequada.  Precisamos de uma solu√ß√£o com um erro quase igual a zero.  A precis√£o nos dados coletados √© de 2 caracteres ap√≥s o separador.  Se voc√™ considera que h√° muitos filmes com uma classifica√ß√£o de 6.xx e h√° filmes com a mesma classifica√ß√£o, lute pela precis√£o aqui. <br><br>  O que mais voc√™ pode tentar?  Voc√™ pode confiar nos valores m√≠nimos e m√°ximos e usar o MinMaxScaler, mas a falta de confiabilidade desse m√©todo levanta imediatamente d√∫vidas.  Deixe-me lembr√°-lo de que o n√∫mero de filmes n√£o coincidiu inicialmente, e nosso conjunto de dados √© hist√≥rico e o estado atual no site.  I.e.  n√£o h√° garantias de que os filmes com classifica√ß√µes m√≠nima e m√°xima em ambos os grupos sejam id√™nticos (verificou-se que eles tinham uma restri√ß√£o de idade diferente e a dura√ß√£o n√£o convergiu da palavra "completamente"), assim como n√£o h√° entendimento de quantas vezes a OKKO √© atualizada API que muda diariamente a classifica√ß√£o da pesquisa de filmes. <br><br>  Ent√£o ficou claro que eu precisava de mais candidatos a atributos para correspond√™ncia. <br><br>  <b>O que mais √© interessante?</b> <br><br>  <i>feature1</i> √© algum tipo de data.  Em tese, por datas, os organizadores prometeram a preserva√ß√£o da separa√ß√£o de estados, o que implicava uma fun√ß√£o linear.  Em geral, a transforma√ß√£o deveria ter sido id√™ntica ao atributo <i>ts</i> para as matrizes de intera√ß√£o.  Se voc√™ olhar para a distribui√ß√£o de filmes por <i>feature_1</i> ... <br><br><img src="https://habrastorage.org/webt/q2/94/dn/q294dngcpjgbfdgxcpwsrsv-1lu.png"><br><br>  ... a hip√≥tese da data de lan√ßamento do filme √© imediatamente eliminada.  A intui√ß√£o sugere que o n√∫mero de filmes produzidos pela ind√∫stria deve aumentar ao longo do tempo.  Isto √© confirmado abaixo. <br><br>  Existem 14 atributos nos dados que recebemos do site.  De fato, infelizmente, os valores estavam contidos apenas para o seguinte: <br><br><img src="https://habrastorage.org/webt/wg/bw/64/wgbw64outbnbatpbee2vt5ge8y0.png"><br><br><img src="https://habrastorage.org/webt/5t/ba/pw/5tbapwosxnjwma2wxnznoj3ntfm.png"><br><br><img src="https://habrastorage.org/webt/rj/l8/jb/rjl8jbpximeqbwahvzmrdbummm4.png"><br><br>  Nenhum dos exemplos acima √© semelhante ao <i>feature_1</i> .  Bem, n√£o havia mais id√©ias para compara√ß√£o, e parece que todo o barulho com essa tarefa foi em v√£o.  √â claro que ouvi falar de concursos, onde os caras marcaram os dados manualmente, mas n√£o quando se trata de centenas e milhares de c√≥pias. <br><br><h3>  Solu√ß√£o </h3><br>  <b>1. Modelos simples</b> <br><br>  Percebendo que nem tudo √© t√£o simples, comecei a trabalhar humildemente com o que √©.  Para come√ßar, eu queria come√ßar com um simples.  Tentei v√°rias solu√ß√µes frequentemente usadas na ind√∫stria, a saber: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">filtragem colaborativa</a> (no nosso caso, baseada em itens) e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fatora√ß√£o de matrizes</a> . <br><br>  A comunidade faz uso extensivo de algumas bibliotecas python adequadas para essas tarefas: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">impl√≠cita</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LightFM</a> .  O primeiro √© capaz de fatorar com base no ALS, bem como na filtragem colaborativa de vizinhos mais pr√≥ximos, com v√°rias op√ß√µes para pr√©-processar a matriz item-item.  O segundo possui dois fatores distintos: <br><br><ul><li>  A fatora√ß√£o √© baseada no SGD, o que possibilita o uso de fun√ß√µes de perda baseadas em amostragem, incluindo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WARP</a> . </li><li>  Ele usa uma abordagem h√≠brida, combinando informa√ß√µes sobre atributos e itens do usu√°rio no modelo de forma que o vetor latente do usu√°rio seja a soma dos vetores latentes de seus atributos.  E da mesma forma para itens.  Essa abordagem se torna extremamente conveniente quando h√° um problema de partida a frio para o usu√°rio / item. </li></ul><br>  Como n√£o possu√≠mos atributos de usu√°rio (al√©m da capacidade de exibi-los com base na intera√ß√£o com os filmes), usei apenas os atributos dos itens. <br><br>  No total, 6 configura√ß√µes foram para enumerar os par√¢metros.  Uma combina√ß√£o de tr√™s matrizes foi usada como matriz de intera√ß√£o, onde as classifica√ß√µes foram convertidas em bin√°rias.  Resultados comparativos com os melhores hiperpar√¢metros para cada configura√ß√£o na tabela abaixo. <br><div class="scrollable-table"><table><tbody><tr><td>  <b>Modelo</b> </td><td>  <b>Teste MNAP @ 20</b> </td></tr><tr><td>  ALS impl√≠cito </td><td>  0,02646 </td></tr><tr><td>  Cosine impl√≠cito kNN CF </td><td>  <b>0,03170</b> </td></tr><tr><td>  TFIDF impl√≠cito kNN CF </td><td>  0,03113 </td></tr><tr><td>  LightFM (sem recursos do item), perda de BPR </td><td>  0,02567 </td></tr><tr><td>  LightFM (sem recursos do item), perda de WARP </td><td>  0,02632 </td></tr><tr><td>  LightFM com recursos de itens, perda de WARP </td><td>  0,02635 </td></tr></tbody></table></div><br>  Como voc√™ pode ver, a filtragem colaborativa cl√°ssica provou ser muito melhor do que outros modelos.  N√£o √© perfeito, mas n√£o √© necess√°rio muito da linha de base.  Enviar com esta configura√ß√£o forneceu 0,03048 no ranking p√∫blico.  N√£o me lembro da posi√ß√£o naquele momento, mas no momento do encerramento da competi√ß√£o, essa finaliza√ß√£o definitivamente alcan√ßaria o top 80 e proporcionou uma medalha de bronze. <br><br>  <b>2. Ol√° Boosting</b> <br><br>  O que poderia ser melhor que um modelo?  Correto: v√°rios modelos. <br><br>  Portanto, a pr√≥xima op√ß√£o foi o conjunto ou, no contexto das recomenda√ß√µes, um modelo de classifica√ß√£o do segundo n√≠vel.  Como abordagem, peguei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">este</a> artigo dos caras da Avito.  Parece estar cozinhando estritamente de acordo com a receita, mexendo e temperando periodicamente com os atributos dos filmes.  O √∫nico desvio foi o n√∫mero de candidatos: peguei os 200 melhores no LightFM, porque  com 500.000 usu√°rios, mais simplesmente n√£o coube na mem√≥ria. <br><br>  Como resultado, a velocidade obtida por mim na valida√ß√£o foi pior do que em um modelo. <br><br>  Ap√≥s v√°rios dias de experimenta√ß√£o, percebeu-se que nada estava funcionando e que nada funcionaria por si s√≥.  Ou n√£o sei como cozinhar (spoiler: a segunda resposta correta).  O que estou fazendo de errado?  Duas raz√µes vieram √† mente: <br><br><ul><li>  Por um lado, tirar as 200 primeiras do modelo de primeiro n√≠vel √© sensato do ponto de vista da gera√ß√£o de amostras "negativas", ou seja,  aqueles filmes que tamb√©m s√£o relevantes para o usu√°rio, mas n√£o s√£o assistidos por ele.  Por outro lado, alguns desses filmes podem ser assistidos durante o per√≠odo de teste, e apresentamos esses exemplos como negativos.  Em seguida, decidi reduzir os riscos desse fato, reconsiderando a hip√≥tese com o seguinte experimento: tomei todos os exemplos positivos + aleat√≥rios para a amostra de treinamento.  A velocidade na amostra de teste n√£o melhorou.  Aqui √© necess√°rio esclarecer que, na amostra do teste, tamb√©m havia previs√µes de topo do modelo de primeiro n√≠vel, porque na tabela de l√≠deres ningu√©m me contou todos os exemplos positivos. </li><li>  Dos 10.200 filmes dispon√≠veis no cat√°logo, apenas 8.296 filmes fizeram intera√ß√µes.  Quase 2.000 filmes foram privados da aten√ß√£o do usu√°rio, em parte porque n√£o estavam dispon√≠veis para compra / aluguel / como parte de uma assinatura.  Os caras do chat perguntaram se filmes inacess√≠veis poderiam ficar dispon√≠veis no per√≠odo de teste.  A resposta foi sim.  √â definitivamente imposs√≠vel jog√°-los fora.  Assim, sugeri que quase 2.000 filmes adicionais estar√£o dispon√≠veis nos pr√≥ximos 2 meses.  Caso contr√°rio, por que jog√°-los no conjunto de dados? </li></ul><br>  <b>3. Neur√¥nios</b> <br><br>  No par√°grafo anterior, a pergunta foi feita: como podemos trabalhar com filmes para os quais n√£o h√° intera√ß√µes?  Sim, recordamos os recursos do item no LightFM, mas, como lembramos, eles n√£o entraram.  O que mais?  Neur√¥nios! <br><br>  O arsenal de c√≥digo aberto possui algumas bibliotecas de alto n√≠vel bastante populares para trabalhar com sistemas de recomenda√ß√£o: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Spotlight</a> de Maciej Kula (autor do LightFM) e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">TensorRec</a> .  O primeiro sob o cap√¥ PyTorch, o segundo - Tensorflow. <br><br>  O Spotlight pode levar em considera√ß√£o conjuntos de dados impl√≠citos / expl√≠citos com neur√¥nios e sequ√™ncias de modelos.  Ao mesmo tempo, na fatora√ß√£o ‚Äúpronta para uso‚Äù, n√£o h√° como adicionar recursos de usu√°rio / item; <br><br>  O TensorRec, por outro lado, sabe apenas como fatorar e √© uma estrutura interessante: <br><br><ul><li>  gr√°fico de representa√ß√£o - um m√©todo de transforma√ß√£o (pode ser definido de forma diferente para o usu√°rio / item) dos dados de entrada na incorpora√ß√£o, com base nos quais os c√°lculos no gr√°fico de previs√£o ocorrer√£o.  A escolha consiste em camadas com diferentes op√ß√µes de ativa√ß√£o.  Tamb√©m √© poss√≠vel usar uma classe abstrata e manter uma transforma√ß√£o personalizada, consistindo em uma sequ√™ncia de camadas keras. </li><li>  O gr√°fico de previs√£o permite selecionar a opera√ß√£o no final: seu produto de ponto favorito, dist√¢ncia euclidiana e cosseno. </li><li>  perda - tamb√©m h√° muito por onde escolher.  Ficamos satisfeitos com a implementa√ß√£o do WMRB (essencialmente o mesmo WARP, s√≥ sabe aprender em lote e distribu√≠do) </li></ul><br>  Mais importante ainda, o TensorRec √© capaz de trabalhar com recursos contextuais e, de fato, o autor admite que ele foi originalmente inspirado pela id√©ia do LightFM.  Bem, vamos ver.  Tomamos intera√ß√µes (somente transa√ß√µes) e recursos de itens. <br><br>  Enviamos para pesquisa de v√°rias configura√ß√µes e aguardamos.  Comparado ao LightFM, o treinamento e a valida√ß√£o levam muito tempo. <br><br>  Al√©m disso, havia alguns inconvenientes que precisavam ser encontrados: <br><br><ol><li>  Ao alterar o sinalizador detalhado, o m√©todo de <i>ajuste</i> n√£o mudou nada e nenhum retorno de chamada foi fornecido para voc√™.  Eu tive que escrever uma fun√ß√£o que treinou internamente uma √©poca usando o m√©todo <i>fit_partial</i> e, em seguida, executei a valida√ß√£o para treinamento e teste (em ambos os casos, as amostras foram usadas para acelerar o processo). </li><li>  Em geral, o autor do framework √© um √≥timo companheiro e utiliza o tf.SparseTensor em qualquer lugar.  No entanto, vale a pena entender que, como previs√£o, inclusive para valida√ß√£o, o resultado √© denso como um vetor com o comprimento n_items para cada usu√°rio.  Duas dicas seguem a seguir: fa√ßa um ciclo para gerar previs√µes com lotes (o m√©todo da biblioteca n√£o possui esse par√¢metro) com filtragem top-k e prepare as tiras com RAM. </li></ol><br>  Por fim, na melhor op√ß√£o de configura√ß√£o, consegui extrair 0,02869 na minha amostra de teste.  Havia algo semelhante ao LB. <br><br>  Bem, o que eu esperava?  Que a adi√ß√£o de n√£o linearidade aos recursos do item dar√° um duplo aumento na m√©trica?  √â ing√™nuo. <br><br>  <b>4. Beck essa tarefa</b> <br><br>  Ent√£o espere um momento.  Parece que eu novamente encontrei neur√¥nios de malabarismo.  Que hip√≥tese eu queria testar quando assumi esse neg√≥cio?  A hip√≥tese foi: ‚ÄúNos pr√≥ximos 2 meses da sele√ß√£o atrasada, quase 2.000 novos filmes ser√£o vistos na tabela de classifica√ß√£o.  Alguns deles ter√£o uma grande quantidade de opini√µes. ‚Äù <br><br>  Ent√£o voc√™ pode verific√°-lo em duas etapas: <br><br><ol><li>  Seria bom ver quantos filmes n√≥s adicionamos no per√≠odo de teste honestamente dividido por n√≥s em rela√ß√£o ao trem.  Se considerarmos apenas as opini√µes, os filmes ‚Äúnovos‚Äù s√£o apenas 240 (!).  A hip√≥tese imediatamente tremeu.  Parece que a compra de novo conte√∫do n√£o pode diferir nessa quantidade de per√≠odo para per√≠odo. </li><li>  N√≥s terminamos.  Temos a oportunidade de treinar o modelo para usar apenas a apresenta√ß√£o com base nos recursos do item (no LightFM, por exemplo, isso √© feito por padr√£o, se n√£o preenchermos previamente a matriz de atributos com a matriz de identidade).  Al√©m disso, por infidelidade, podemos nos submeter apenas a este modelo (!) Nossos filmes inacess√≠veis e nunca vistos.  A partir desses resultados, enviamos e obtemos 0,0000136. </li></ol><br>  Bingo!  Isso significa que voc√™ pode parar de extrair a sem√¢ntica dos atributos do filme.  A prop√≥sito, mais tarde, no DataFest, os caras da OKKO disseram que a maior parte do conte√∫do inacess√≠vel eram apenas alguns filmes antigos. <br><br>  Voc√™ precisa tentar algo novo e novo - velho e esquecido.  No nosso caso, n√£o completamente esquecido, mas o que aconteceu alguns dias atr√°s.  Filtragem colaborativa? <br><br>  <b>5. Ajuste a linha de base</b> <br><br>  Como posso ajudar a linha de base do CF? <br><br>  <b>Id√©ia n√∫mero 1</b> <br><br>  Na Internet, encontrei uma apresenta√ß√£o sobre o uso do teste da raz√£o de verossimilhan√ßa para filtrar filmes menores. <br><br>  Abaixo deixarei meu c√≥digo python para calcular a pontua√ß√£o do LLR, que tive que escrever de joelhos para testar essa ideia. <br><br><div class="spoiler">  <b class="spoiler_title">C√°lculo LLR</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.sparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> csr_matrix <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tqdm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tqdm <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LLR</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, interaction_matrix, interaction_matrix_2=None)</span></span></span><span class="hljs-function">:</span></span> interactions, lack_of_interactions = self.make_two_tables(interaction_matrix) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> interaction_matrix_2 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: interactions_2, lack_of_interactions_2 = self.make_two_tables(interaction_matrix_2) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: interactions_2, lack_of_interactions_2 = interactions, lack_of_interactions self.num_items = interaction_matrix.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>] self.llr_matrix = np.zeros((self.num_items, self.num_items)) <span class="hljs-comment"><span class="hljs-comment"># k11 - item-item co-occurrence self.k_11 = np.dot(interactions, interactions_2.T) # k12 - how many times row elements was bought without column elements self.k_12 = np.dot(interactions, lack_of_interactions_2.T) # k21 - how many times column elements was bought without row elements self.k_21 = np.dot(lack_of_interactions, interactions_2.T) # k22 - how many times elements was not bought together self.k_22 = np.dot(lack_of_interactions, lack_of_interactions_2.T) def make_two_tables(self, interaction_matrix): interactions = interaction_matrix if type(interactions) == csr_matrix: interactions = interactions.todense() interactions = np.array(interactions.astype(bool).T) lack_of_interactions = ~interactions interactions = np.array(interactions, dtype=np.float32) lack_of_interactions = np.array(lack_of_interactions, dtype=np.float32) return interactions, lack_of_interactions def entropy(self, k): N = np.sum(k) return np.nansum((k / N + (k == 0)) * np.log(k / N)) def get_LLR(self, item_1, item_2): k = np.array([[self.k_11[item_1, item_2], self.k_12[item_1, item_2]], [self.k_21[item_1, item_2], self.k_22[item_1, item_2]]]) LLR = 2 * np.sum(k) * (self.entropy(k) - self.entropy(np.sum(k, axis=0)) - self.entropy(np.sum(k, axis=1))) return LLR def compute_llr_matrix(self): for item_1 in range(self.num_items): for item_2 in range(item_1, self.num_items): self.llr_matrix[item_1, item_2] = self.get_LLR(item_1, item_2) if item_1 != item_2: self.llr_matrix[item_2, item_1] = self.llr_matrix[item_1, item_2] def get_top_n(self, n=100, mask=False): filtered_matrix = self.llr_matrix.copy() for i in tqdm(range(filtered_matrix.shape[0])): ind = np.argpartition(filtered_matrix[i], -n)[-n:] filtered_matrix[i][[x for x in range(filtered_matrix.shape[0]) if x not in ind]] = 0 if mask: return filtered_matrix != 0 else: return filtered_matrix</span></span></code> </pre><br></div></div><br>  Como resultado, a matriz resultante pode ser usada como uma m√°scara para deixar apenas as intera√ß√µes mais significativas e existem duas op√ß√µes: use threshold ou deixe os elementos top-k com o valor mais alto.  Da mesma forma, a combina√ß√£o de v√°rias influ√™ncias em uma compra em uma velocidade √© usada para classificar itens; em outras palavras, o teste mostra o quanto √© importante, por exemplo, adicionar aos favoritos a possibilidade de convers√£o em uma compra.  Parece promissor, mas o uso mostrou que a filtragem usando a pontua√ß√£o LLR gera um aumento muito pequeno, e a combina√ß√£o de v√°rias pontua√ß√µes apenas piora o resultado.  Aparentemente, o m√©todo n√£o √© para esses dados.  Das vantagens, s√≥ posso notar que, ao descobrir como implementar essa id√©ia, tive que cavar o impl√≠cito sob o cap√¥. <br><br>  Um exemplo de aplica√ß√£o impl√≠cita dessa l√≥gica personalizada ser√° deixado sob o gato. <br><br><div class="spoiler">  <b class="spoiler_title">Modifica√ß√£o da matriz em impl√≠cita</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   LLR scores.     n_items * n_items. llr = LLR(train_csr, train_csr) llr.compute_llr_matrix() #     id, ,      llr_based_mask = llr.get_top_n(n=500, mask=True) #     ,  - CosineRecommender. model = CosineRecommender(K=10200) model.fit(train_csr.T) # model.similarity -   co-occurrence (  Cosine - ).        . masked_matrix = np.array(model.similarity.todense()) * llr_based_mask #  fit()  scorer     model.similarity. #     . model.scorer = NearestNeighboursScorer(csr_matrix(masked_matrix)) #      :   recommend   . test_predict = {} for id_ in tqdm(np.unique(test_csr.nonzero()[0])): test_predict[id_] = model.recommend(id_, train_csr, filter_already_liked_items=True, N=20) #   tuples (item_id, score),   id  . test_predict_ids = {k: [x[0] for x in v] for k, v in test_predict.items()} #       / ,     ,   Cython.</span></span></code> </pre> <br></div></div><br>  <b>Id√©ia n√∫mero 2</b> <br><br>  Outra id√©ia surgiu que poderia melhorar as previs√µes sobre a filtragem colaborativa simples.  O setor costuma usar algum tipo de fun√ß√£o de amortecimento para estimativas antigas, mas temos um caso n√£o t√£o simples.  Provavelmente, voc√™ precisa levar em considera√ß√£o 2 casos poss√≠veis: <br><br><ol><li>  Os usu√°rios que assistem ao servi√ßo s√£o principalmente novos </li><li>  "Examinadores".  Ou seja, aqueles que vieram relativamente recentemente e podem assistir a filmes populares anteriormente. </li></ol><br>  Assim, √© poss√≠vel dividir o componente colaborativo em dois grupos diferentes automaticamente.  Para fazer isso, inventei uma fun√ß√£o que, em vez de valores impl√≠citos, definidos como "1" ou "0" na interse√ß√£o do usu√°rio e do filme, um valor que mostra a import√¢ncia desse filme no hist√≥rico de exibi√ß√£o do usu√°rio. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>t</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mi>i</mi><mi>l</mi><mi>m</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3B1;</mo></mrow><mo>&amp;#x2217;</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x3B2;</mo></mrow><mo>&amp;#x2217;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x394;</mo></mrow><mi>W</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.356ex" height="2.66ex" viewBox="0 -832 22111.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-72" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-75" x="813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-73" x="1385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="1855" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-28" x="2216" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-66" x="2606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-69" x="3156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6C" x="3502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6D" x="3800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-65" x="4679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-29" x="5145" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-3D" x="5812" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-3B1" x="6869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-2217" x="7731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-53" x="8454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="9100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-61" x="9461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-72" x="9991" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="10442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-54" x="10804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-69" x="11508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6D" x="11854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-65" x="12732" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-2B" x="13421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-3B2" x="14421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-2217" x="15210" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMAIN-394" x="15933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-57" x="16766" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-61" x="17815" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-74" x="18344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-63" x="18706" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-68" x="19139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-54" x="19716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-69" x="20420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-6D" x="20766" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhjjQt894wF0gLPGKAq95mKk-adebw#MJMATHI-65" x="21644" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>t</mi><mi>r</mi><mi>u</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>f</mi><mi>i</mi><mi>l</mi><mi>m</mi><mi>e</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>Œ±</mo></mrow><mo>‚àó</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>r</mi><mi>t</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo>Œ≤</mo></mrow><mo>‚àó</mo><mrow class="MJX-TeXAtom-ORD"><mo>Œî</mo></mrow><mi>W</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> trust (filme) = Œ± * StartTime + Œ≤ * ŒîWatchTime </script></p><br>  onde <i>StartTime</i> √© a data de lan√ßamento do filme e <i>ŒîWatchTime</i> √© a diferen√ßa entre a data de lan√ßamento e a data em que o usu√°rio assistiu, e <i>Œ±</i> e <i>Œ≤</i> s√£o hiperpar√¢metros. <br><br>  Aqui, o primeiro termo √© respons√°vel por aumentar a velocidade dos filmes lan√ßados recentemente, e o segundo √© levar em considera√ß√£o o v√≠cio dos usu√°rios em filmes antigos.  Se um filme foi lan√ßado h√° muito tempo e o usu√°rio o comprou imediatamente, hoje, esse fato n√£o deve ser levado em considera√ß√£o muito.  Se esse √© um tipo de novidade, recomendamos que seja recomendado a um n√∫mero maior de usu√°rios que tamb√©m assistem a novos itens.  Se o filme √© bastante antigo e o usu√°rio o assistiu apenas agora, isso tamb√©m pode ser importante para pessoas como ele. <br><br>  Ainda existe um pouco - para separar os coeficientes <i>Œ±</i> e <i>Œ≤</i> .  Sair para a noite, e o trabalho est√° feito.  Como n√£o havia nenhuma suposi√ß√£o sobre o intervalo, ele foi inicialmente grande e abaixo est√£o os resultados de uma pesquisa ideal local. <br><br><img src="https://habrastorage.org/webt/ej/iy/qk/ejiyqkpfmhz43nlifcd3o_zv40o.png"><br><br>  Usando essa id√©ia, um modelo simples em uma matriz deu uma velocidade de 0,03627 na valida√ß√£o local e 0,03685 no LB p√∫blico, o que imediatamente parece um bom impulso em compara√ß√£o com os resultados anteriores.  Naquele momento, ele me levou ao top 20. <br><br> <b> ‚Ññ3</b> <br><br>    ,   ,    ,    .     CF   .      : <br><br><img src="https://habrastorage.org/webt/pk/xd/uk/pkxduk8vw3eyyojevyibbesixbi.png"><br><br> ,            25 . <br><br> ,    ,    0.040312    ,         0.03870  0.03990  public/private      14-   . <br><br><h3> Acknowledgments </h3><br>    jupyter notebook ‚Äî  .      ,     .      output       .      .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cookiecutter-data-science</a> ‚Äî Ocean.       .        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> .                   . <br><br><h3>   ( ) </h3><br>       private  ,                   .    ,                 .   : <br><br><img src="https://habrastorage.org/webt/vq/c1/ds/vqc1dsjoq63esgrlttp3v9-ky2g.jpeg"><br><br> ,   ,        ,   : <br><br><img src="https://habrastorage.org/webt/p3/im/w3/p3imw3yj1ip5bvqorv_uexldawu.jpeg"><br><br>            ,   2 .           .  ,       . <br><br><img src="https://habrastorage.org/webt/i9/rs/gw/i9rsgwcjimnuhjbgqcpmlyaj2rk.jpeg"><br><br><h3>  Conclus√£o </h3><br>  ‚Äî  .      ,     .    ?   ,        ‚Äî  feature importance   ,   ,       ¬´¬ª   . ,    . <br><br> ,           .    ; , ,  . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt461055/">https://habr.com/ru/post/pt461055/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt461045/index.html">Obtenha uma extra√ß√£o do Rosreestr atrav√©s do FSIS USRN e python. Parte 1</a></li>
<li><a href="../pt461047/index.html">Escrever ou n√£o escrever. Cartas √†s autoridades durante os eventos</a></li>
<li><a href="../pt461049/index.html">ONYX BOOX Faust - Quem procura n√£o √© obrigado a passear</a></li>
<li><a href="../pt461051/index.html">Os 10 erros mais comuns que encontrei nos projetos Go</a></li>
<li><a href="../pt461053/index.html">Conectamos mapas on-line ao navegador no smartphone. Parte 2 - cart√µes de vetor</a></li>
<li><a href="../pt461057/index.html">Canais de telegrama sobre desenvolvimento de jogos</a></li>
<li><a href="../pt461059/index.html">Escrevendo um aplicativo Android para f√£s de filmes - Parte 1 (prototipagem)</a></li>
<li><a href="../pt461061/index.html">Ligas de magn√©sio, limites duplos e segrega√ß√£o</a></li>
<li><a href="../pt461063/index.html">Intera√ß√£o de R com bancos de dados no exemplo do Microsoft SQL Server e outros DBMS</a></li>
<li><a href="../pt461067/index.html">As 65 principais perguntas sobre SQL das entrevistas de emprego para as quais voc√™ deve estar preparado em 2019. Parte I</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>