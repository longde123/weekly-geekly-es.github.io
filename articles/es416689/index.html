<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title> ぞ  Acerca de las caracter铆sticas de la arquitectura de Android a trav茅s de los ojos de un desarrollador que no es Android   </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recientemente, hemos redise帽ado por completo la aplicaci贸n Pyrus para Android. La primera versi贸n de la aplicaci贸n ya funcionaba con Android 2.2. Al n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Acerca de las caracter铆sticas de la arquitectura de Android a trav茅s de los ojos de un desarrollador que no es Android</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416689/"> Recientemente, hemos redise帽ado por completo la aplicaci贸n Pyrus para Android.  La primera versi贸n de la aplicaci贸n ya funcionaba con Android 2.2.  Al negarnos a admitir Android por debajo de 4.1, pudimos pagar la deuda t茅cnica acumulada y simplificamos significativamente el c贸digo fuente.  S铆, perdimos una parte de los usuarios (menos del 1%), pero por otro lado, ahorramos tiempo a los desarrolladores para corregir errores raros.  Podremos invertirlo en el desarrollo de funcionalidades para todos los usuarios actuales y nuevos.  A la larga, esto es mucho m谩s importante. <br><br>  Aqu铆 compartimos experiencias que pueden ser 煤tiles para aquellos que est谩n considerando comenzar a desarrollar la plataforma Android. <br><a name="habracut"></a><br>  Android atrae buenas herramientas de desarrollo, lenguaje probado en el tiempo (Java) con la sintaxis habitual, una gran audiencia de usuarios.  Sin embargo, crear aplicaciones convenientes en Android es dif铆cil: a pesar de la API desarrollada, a menudo sucede que no hay un componente listo para usar con un comportamiento adecuado.  Debe abandonar las ideas del dise帽ador de experiencia de usuario, aceptar depender de bibliotecas de terceros o escribir usted mismo.  No todas las soluciones arquitect贸nicas en Android resultaron exitosas, y esto tambi茅n aumenta la cantidad de c贸digo sin un beneficio obvio. <br><br><h3>  Muriendo y resucitando de las cenizas </h3><br>  La interfaz en Android se basa en la actividad.  Este es un contenedor que generalmente ocupa toda la pantalla del dispositivo, otros widgets viven en 茅l y recibe eventos sobre la interacci贸n del usuario. <br><br>  Cuando el usuario activa la aplicaci贸n, se genera un evento onResume en la Actividad.  Presion茅 el bot贸n de Inicio - La actividad desapareci贸, pero antes de eso recibi贸 el evento onPause.  Hasta ahora, todo es l贸gico.  驴Qu茅 sucede cuando un usuario gira la pantalla del dispositivo 90 grados?  Nunca adivinar谩s: el sistema operativo mata la actividad y se vuelve a crear.  Cuando desinstala una actividad, todos los componentes que contiene se eliminan.  Esto significa que debe escribir un c贸digo especial que guarde el estado de los widgets dentro de la Actividad (posici贸n de desplazamiento, texto seleccionado, estado de las casillas de verificaci贸n) y los restaure despu茅s de que se vuelva a crear el padre.  Android hace algo de este trabajo por ti, pero no todo. <br><br>  Es dif铆cil entender qu茅 llev贸 a los arquitectos a tomar esa decisi贸n.  M谩s tarde, alguien decidi贸 que se ve铆a feo y agreg贸 el mismo par谩metro, que suprime el comportamiento predeterminado del sistema.  Ahora, en lugar de volver a crear Actividad, el SO puede llamar al m茅todo especial onConfigurationChanged.  Esta "soluci贸n" parece un truco sucio y solo exacerb贸 el problema, porque la documentaci贸n de Android <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dice</a> "esta t茅cnica deber铆a considerarse una medida extrema y no se recomienda para la mayor铆a de las aplicaciones". <br><br><h3>  Fragmentos Fragmentados </h3><br>  Inicialmente, el sistema operativo Android fue creado para tel茅fonos.  Con el advenimiento de las tabletas, el equipo de Android decidi贸 acertadamente que los elementos de la interfaz que anteriormente estaban separados por diferentes actividades debido al peque帽o tama帽o de la pantalla del tel茅fono ahora pueden coexistir en la pantalla grande de la tableta.  (Ejemplo: la lista de cartas y el correo electr贸nico en el tel茅fono estaban en dos Actividades diferentes, y en la tableta compartieron una pantalla juntos). S铆, el problema es que varias Actividades no pueden interactuar simult谩neamente con el usuario por dise帽o.  Por lo tanto, se necesita otro mecanismo para reutilizar componentes, y se encontr贸 una soluci贸n: aparecieron fragmentos (Fragmento). <br><br>  Por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">definici贸n</a> , un Fragmento representa un comportamiento o parte de una interfaz de usuario en una Actividad.  Todo esta claro.  Sin embargo, en las instrucciones para usar fragmentos encontramos la secci贸n "Agregar un fragmento que no tiene una interfaz de usuario".  Que?  隆Resulta que un fragmento puede no tener su propia ventana para renderizar! <br><br>  Pero, 驴qu茅 sucede con los fragmentos al girar la pantalla?  Los desarrolladores de Android pensaron en esto: cuando recrea una actividad, todos sus fragmentos tambi茅n se recrean autom谩ticamente.  Sin embargo, tras una cuidadosa consideraci贸n, el fragmento tiene el m茅todo "setRetainInstance", si lo llama, este fragmento no se eliminar谩 ni restaurar谩 durante los turnos. <br><br>  Esbelto y consistente, este concepto no puede ser llamado. <br><br><h3>  Operaci贸n asincr贸nica </h3><br>  El subproceso de procesamiento de eventos no puede bloquearse mediante operaciones largas, por lo tanto, el intercambio de datos con el disco y la red debe realizarse de forma asincr贸nica en otros subprocesos.  Android proporciona hasta cuatro mecanismos para la operaci贸n asincr贸nica: AsyncTask, Service, IntentService, Thread.  Se alienta a los desarrolladores a determinar cu谩l es el mejor para ellos.  La elecci贸n no es trivial: por ejemplo, si la aplicaci贸n inici贸 AsyncTask y el usuario gir贸 la pantalla durante su ejecuci贸n, al finalizar el trabajo, AsyncTask no puede encontrar una nueva Actividad (creada despu茅s del turno).  Y ninguno de los cuatro mecanismos implementa una l贸gica simple: si el usuario inici贸 el segundo proceso asincr贸nico sin esperar los resultados del primero, y luego el primero todav铆a termin贸 antes, entonces es apropiado ignorar y no reflejar sus resultados en la interfaz de usuario. <br><br>  Se hace evidente la aparici贸n de numerosas bibliotecas: buses de datos para organizar el trabajo asincr贸nico dentro de una aplicaci贸n de Android. <br><br><h3>  Reiniciar la aplicaci贸n despu茅s de OOM </h3><br>  Si Android se queda sin RAM, el sistema operativo puede completar cualquier proceso.  Cuando el usuario active la aplicaci贸n en el futuro, el sistema intentar谩 restaurar su estado.  En teor铆a, esto deber铆a ser invisible para el desarrollador (si implement贸 el m茅todo onSaveInstanceState en todos los componentes): el propio sistema recrea la pila de Actividad tal como estaba durante la parada forzada.  Sin embargo, si la inicializaci贸n lleva tiempo (por ejemplo, cargar cach茅s desde el disco o desde la red), ser谩 correcto mostrarle al usuario un indicador de espera.  Resulta que al crear una actividad, a煤n necesita monitorear el "arranque en fr铆o" y llevar a cabo la inicializaci贸n manualmente.  Sin mencionar que al reiniciar, no se restauran Thread y AsyncTask. <br><br>  驴Qu茅 posibilidades hay de quedarse sin memoria en la pr谩ctica?  T铆picamente, esta situaci贸n ocurre cuando se procesan im谩genes de alta resoluci贸n.  Por ejemplo, una imagen de 2048x1536 ocupa 12Mb en la memoria de un objeto de mapa de bits.  La cantidad de memoria disponible para la aplicaci贸n depende del modelo de dispositivo espec铆fico y, a veces, es muy peque帽a (64 Mb o 128 Mb).  Dado que el recolector de basura en todas las versiones de Android anteriores a 8.0 no estaba compactando, incluso si tiene 100Mb de memoria libre, pero est谩 dividido en bloques de 10Mb, un intento de asignar memoria para esa imagen condujo a un bloqueo de la aplicaci贸n. <br><br><h3>  Recogida de basura eterna </h3><br>  Una vez que nuestro usuario se dio cuenta de que al desplazarse por las listas largas, la aplicaci贸n "se retrasaba": cada 2-3 segundos la animaci贸n se deten铆a por breves pausas (200-300 ms), y luego continuaba.  El an谩lisis mostr贸 que la recolecci贸n de basura a menudo comienza sospechosamente en la aplicaci贸n.  Result贸 que la clase HashMap est谩ndar (que usamos para obtener un objeto Java por su ID) es ineficiente en nuestro caso: necesitamos crear un objeto contenedor para cada clave, que es un entero (int).  Por lo tanto, el n煤mero de asignaciones de memoria aumenta sin ning煤n beneficio.  La soluci贸n fue cambiar a un contenedor especial SparseArray (disponible solo en Android, no en la plataforma est谩ndar de Java), lo que inmediatamente redujo la presi贸n sobre el recolector de basura. <br><br>  驴Qu茅 tiene que ver el retraso en la animaci贸n?  El hecho es que el recolector de basura en Android detuvo todos los hilos durante su funcionamiento, incluido el hilo principal involucrado en el renderizado.  En las versiones de Android que comienzan con 5.0, se usa otra m谩quina virtual (ART en lugar de Dalvik) y un algoritmo diferente de recolecci贸n de basura, que detiene cada vez menos la animaci贸n.  (Puede leer sobre c贸mo comparar el tiempo de recolecci贸n de basura <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu铆</a> ). <br><br><h3>  Ver documentos </h3><br>  Si desea insertar vistas previas de documentos en su aplicaci贸n, se ve obligado a decepcionar: en Android no hay un componente integrado que pueda mostrar archivos de Word, Excel, Powerpoint.  Sin mencionar los archivos ZIP o documentos PDF.  Salida?  Obligue al usuario a instalar aplicaciones de terceros para ver cada tipo de archivo o usar el componente WebView (en realidad un navegador).  En ambos casos, cuando el usuario graba el archivo, se iniciar谩 una aplicaci贸n externa y algunos escenarios simplemente no se pueden implementar, por ejemplo, una alimentaci贸n de im谩genes: no hay una manera f谩cil de integrar WebView en un ViewPager est谩ndar. <br><br><h3>  Que sigue </h3><br>  Algunos estudios afirman que la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">complejidad del desarrollo de Android es relativamente alta</a> .  Nuestra experiencia muestra que es f谩cil para un desarrollador competente acostumbrarse a las caracter铆sticas de esta plataforma.  Y aunque hoy Android es el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sistema operativo m贸vil m谩s popular del mundo</a> , en 5-10 a帽os la situaci贸n puede cambiar radicalmente. <br><br>  En los 煤ltimos a帽os, Google ha estado desarrollando en secreto el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nuevo Fuchsia OC</a> con un modelo de seguridad fundamentalmente diferente (en comparaci贸n con el sistema operativo moderno).  Probablemente usar谩 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dart</a> como el lenguaje de programaci贸n principal y el marco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Flutter</a> como la forma principal de crear aplicaciones.  Se rumorea que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuchsia puede reemplazar Android y ChromeOS</a> en todos los dispositivos.  Si Google hace esto, es probable que la compa帽铆a brinde soporte nativo para aplicaciones escritas para Android (como lo hizo Microsoft al cambiar de DOS a Windows).  Por lo tanto, hasta ahora no puede preocuparse y continuar acumulando experiencia en Android.  Y para aquellos que quieran mirar hacia el futuro, pueden descargar Flutter y jugar con 茅l <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu铆</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es416689/">https://habr.com/ru/post/es416689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es416679/index.html">Computaci贸n perif茅rica: una combinaci贸n amistosa de la "niebla" con las "nubes"</a></li>
<li><a href="../es416681/index.html">C贸mo PostgreSQL y ClickHouse en Python mucho, r谩pida e inmediatamente en numpy</a></li>
<li><a href="../es416683/index.html">Que sigue O c贸mo elegir caracter铆sticas para el desarrollo</a></li>
<li><a href="../es416685/index.html">Seguimiento de Epson ColorWorks: sus preguntas, nuestras respuestas</a></li>
<li><a href="../es416687/index.html">QSAN Storage como competidor de las marcas Tier 1</a></li>
<li><a href="../es416691/index.html">Seguridad del aprendizaje autom谩tico: 驴t茅cnicas de defensa eficaces o nuevas amenazas?</a></li>
<li><a href="../es416693/index.html">Certificados de D-Link y Changing Information Technologies utilizados para firmar malware</a></li>
<li><a href="../es416695/index.html">Compatibilidad con vSphere 6.7 y otras funciones de la 煤ltima actualizaci贸n Veaam Backup & Replication 9.5 3a</a></li>
<li><a href="../es416697/index.html">Fusi贸n de operadores de telecomunicaciones en 2018</a></li>
<li><a href="../es416699/index.html">Francotirador geek o c贸mo hacer un "buen ojo"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>