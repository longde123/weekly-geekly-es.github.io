<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ»â€ğŸ¤â€ğŸ‘¨ğŸ¿ ğŸ§›ğŸ¿ ğŸ•Šï¸ NASçš„å…¶ä»–å®‰å…¨è½¯ä»¶ ğŸ¤¶ ğŸ— ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¯¥ç³»åˆ—æ–‡ç« çš„æ ‡é¢˜ä¸ºâ€œ æ„å»ºå®‰å…¨NASâ€ ã€‚ å› æ­¤ï¼Œæœ¬æ–‡å°†è€ƒè™‘æé«˜å®‰å…¨çº§åˆ«ã€‚ æ­¤å¤–ï¼Œè¿˜å°†ä»‹ç»é‚£äº›æˆ‘æ²¡æœ‰ä½¿ç”¨è¿‡ä½†å¯ä»¥åº”ç”¨çš„å·¥å…·ã€‚ 
 è°å’Œå¦‚ä½•ï¼Ÿ 


 è°æ¥æ”»å‡»ç³»ç»Ÿï¼Œä»–å°†å¦‚ä½•åšï¼Ÿ 


 è¿™é€šå¸¸æ˜¯è°ˆè®ºå®‰å…¨æ€§ä¹‹å‰éœ€è¦å›ç­”çš„ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚ 
 è‡³å°‘åœ¨NASçš„æƒ…å†µä¸‹ï¼Œè¿™æ ·çš„ç­”æ¡ˆå·²ç»æ˜¯éšå«çš„ã€‚ ä½†æ˜¯ä¸ºäº†å®Œå…¨å›ç­”...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>NASçš„å…¶ä»–å®‰å…¨è½¯ä»¶</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421279/"><p><img src="https://habrastorage.org/webt/39/ch/xl/39chxldtklziggqygx3wgmom0ky.png"></p><br><p> è¯¥ç³»åˆ—æ–‡ç« çš„æ ‡é¢˜ä¸ºâ€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ„å»ºå®‰å…¨NASâ€</a> ã€‚ å› æ­¤ï¼Œæœ¬æ–‡å°†è€ƒè™‘æé«˜å®‰å…¨çº§åˆ«ã€‚ æ­¤å¤–ï¼Œè¿˜å°†ä»‹ç»é‚£äº›æˆ‘æ²¡æœ‰ä½¿ç”¨è¿‡ä½†å¯ä»¥åº”ç”¨çš„å·¥å…·ã€‚ </p><a name="habracut"></a><br><h2 id="kto-i-kak"> è°å’Œå¦‚ä½•ï¼Ÿ </h2><br><p> è°æ¥æ”»å‡»ç³»ç»Ÿï¼Œä»–å°†å¦‚ä½•åšï¼Ÿ </p><br><p> è¿™é€šå¸¸æ˜¯è°ˆè®ºå®‰å…¨æ€§ä¹‹å‰éœ€è¦å›ç­”çš„ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚ <br> è‡³å°‘åœ¨NASçš„æƒ…å†µä¸‹ï¼Œè¿™æ ·çš„ç­”æ¡ˆå·²ç»æ˜¯éšå«çš„ã€‚ ä½†æ˜¯ä¸ºäº†å®Œå…¨å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œæ­£åœ¨æ„å»ºå¨èƒæ¨¡å‹å’Œå…¥ä¾µè€…æ¨¡å‹ã€‚ </p><br><p> å…¬å¸æ­£åœ¨å…¶å¼€å‘å‘¨æœŸä¸­è¿›å…¥å¨èƒå»ºæ¨¡é˜¶æ®µã€‚ <br> å¾®è½¯ä¸ºæ­¤æä¾›äº†ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SDL</a> ï¼Œäººä»¬<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‹¥æœ‰äº†å…¶ä»–æ¨¡å‹</a> ã€‚ </p><br><p> å®ƒä»¬æš—ç¤ºä½¿ç”¨æŸäº›æŠ€æœ¯ï¼Œä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">STRIDE</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DREAD</a> ï¼ˆSTRIDEä»ç„¶æ›´é€šç”¨ï¼Œå¹¶ä¸”åœ¨ä»ªå™¨ä¸Šå¾—åˆ°å¾ˆå¥½çš„æ”¯æŒï¼‰ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œåœ¨STRIDEä¸­ï¼Œæ¨¡å‹æ˜¯å»ºç«‹åœ¨æ•°æ®æµä¸Šçš„ï¼Œå¹¶ä¸”é€šå¸¸åºå¤§ï¼Œç¹é‡ä¸”ç†è§£ä¸æ¸…ã€‚ ä½†æ˜¯ï¼Œè¯¥å·¥å…·æä¾›äº†æ½œåœ¨å¨èƒçš„åˆ—è¡¨ï¼Œè¿™æœ‰åŠ©äºå¯¹å…¶è¿›è¡Œè€ƒè™‘ã€‚ </p><br><p> å¨èƒæ¨¡å‹æ˜¯åˆ†ç±»ä¿¡æ¯ï¼Œå› ä¸ºå®ƒå¯ä»¥ä½¿æ”»å‡»è€…æ›´è½»æ¾åœ°åˆ†æç³»ç»Ÿå¹¶å‘ç°æ¼æ´ã€‚ å¦‚æœä»–æ”¶åˆ°æ¨¡å‹ï¼Œä»–å°†ä¸å¿…è‡ªå·±å»ºç«‹æ¨¡å‹ï¼Œå› ä¸ºåˆ†æå¸ˆå·²ç»åšå¥½äº†ä¸€åˆ‡å‡†å¤‡ã€‚ </p><br><p>  <strong>è¿™æ˜¯ä¸€åˆ†é’Ÿçš„å¹¿å‘Šã€‚</strong> </p><br><p><img src="https://habrastorage.org/webt/w4/ye/cz/w4yeczwns0wzroeq-ufxttf9yhm.jpeg"></p><br><p> è¿™å°±æ˜¯è®¤çœŸçš„å…¬å¸å»ºç«‹æ¨¡å‹çš„æ–¹å¼ã€‚ å¦‚æœè¿™å¾ˆæœ‰è¶£ï¼Œæˆ‘å¯ä»¥åœ¨å¦ä¸€ç¯‡æ–‡ç« ä¸­è¿›è¡Œæè¿°ã€‚ </p><br><p> åœ¨è¿™é‡Œï¼Œæˆ‘å°†ç”¨è‹±è¯­æè¿°æ‰€è°“çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œå¼ºåŒ–â€</a> ï¼Œå¹¶å¤„ç†ç³»ç»Ÿæ„å»ºè¿‡ç¨‹ä¸­å‡ºç°çš„å®‰å…¨æ¼æ´ã€‚ </p><br><p> åŸºæœ¬ä¸Šï¼Œé€šè¿‡å…³é—­å·²çŸ¥çš„ç³»ç»Ÿæ¼æ´ï¼Œå¯¹å…¶è¿›è¡Œç›‘è§†å¹¶å®šæœŸå¯¹å…¶è¿›è¡Œæ£€æŸ¥ï¼Œå¯ä»¥å°†å®‰å…¨çº§åˆ«ç»´æŒåœ¨æ­¤çº§åˆ«ã€‚ </p><br><h2 id="literatura-po-teme"> ç›¸å…³æ–‡çŒ® </h2><br><p> é˜…è¯»å†…å®¹ï¼š </p><br><ul><li> å€¼å¾—ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Hardened Linuxé¡¹ç›®å¼€å§‹</a> ï¼Œæ¯ä¸ªäººéƒ½ä¼šå‘ç°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¾ˆå¤šæœ‰ç”¨çš„ä¸œè¥¿</a> ã€‚ </li><li>  harden-docè½¯ä»¶åŒ…åŒ…å«2012å¹´æ—§çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Securing Debianæ‰‹å†Œ</a> ï¼Œä½†å››å¤„è¿è¡Œä¸ä¼šå¹²æ‰°å¯¹è¯¥é—®é¢˜çš„ç†è§£ã€‚ </li><li> ç„¶åï¼Œé˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Debian 8 Hardening</a>ç®€çŸ­æ¼”ç»ƒã€‚ </li><li> æœ€åï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…³äºåŠ å›ºdebè½¯ä»¶åŒ…</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C / C ++ä»£ç </a>çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°å‹æŒ‡å—</a>å¾ˆå¯èƒ½å°†æ— ç”¨ã€‚ </li></ul><br><h2 id="snapshoty-i-doker"> å¿«ç…§å’ŒDocker </h2><br><p> ä»¥å‰ï¼Œå·²å®‰è£…zfs-autosnapshotã€‚ ä»–åå¤å¸®åŠ©æˆ‘ï¼Œå› ä¸º æˆ‘å¯ä»¥ä»å¿«ç…§è¿˜åŸæŸåçš„é…ç½®ï¼ˆä¾‹å¦‚ï¼Œç”¨äºNextcloudï¼‰ã€‚ <br> ä½†æ˜¯ï¼Œéšç€æ—¶é—´çš„æµé€ï¼Œç³»ç»Ÿå¼€å§‹å˜æ…¢ï¼Œæˆåƒä¸Šä¸‡çš„å¿«ç…§æˆå€å¢åŠ ã€‚ </p><br><p> <code>com.sun:auto-snapshot=false</code> ï¼Œåœ¨ä¸ºå®¹å™¨åˆ›å»ºçˆ¶æ–‡ä»¶ç³»ç»Ÿæ—¶ï¼Œæˆ‘å¿˜è®°è®¾ç½®æ ‡å¿—<code>com.sun:auto-snapshot=false</code> ã€‚ </p><br><p> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸå§‹æ–‡ç« ä¸­ï¼Œ</a>æ­¤é—®é¢˜å·²å¾—åˆ°è§£å†³ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•æ¶ˆé™¤å¤šä½™çš„å¿«ç…§ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">æœ‰å…³å¦‚ä½•æ›´æ­£é”™è¯¯çš„è¯¦ç»†ä¿¡æ¯ã€‚</b> <div class="spoiler_text"><p> é¦–å…ˆï¼Œåœ¨Dockerçš„çˆ¶æ–‡ä»¶ç³»ç»Ÿä¸Šå…³é—­zfs-auto-snapshotï¼š </p><br><pre> <code class="plaintext hljs">zfs set com.sun:auto-snapshot=false tank0/docker/lib</code> </pre> <br><p> ç°åœ¨åˆ é™¤æœªä½¿ç”¨çš„å®¹å™¨å’Œå›¾åƒï¼š </p><br><pre> <code class="plaintext hljs">docker container prune docker image prune</code> </pre> <br><p> åˆ é™¤å¿«ç…§ï¼š </p><br><pre> <code class="plaintext hljs">zfs list -t snapshot -o name -S creation | grep -e ".*docker/lib.*@zfs-auto-snap" | tail -n +1500 | xargs -n 1 zfs destroy -vr</code> </pre> <br><p> å¹¶åœ¨æ‰€æœ‰å›¾åƒæ–‡ä»¶ç³»ç»Ÿä¸Šå°†å…¶å…³é—­ï¼š </p><br><pre> <code class="plaintext hljs">zfs list -t filesystem -o name -S creation | grep -e "tank0/docker/lib" | xargs -n 1 zfs set com.sun:auto-snapshot=false</code> </pre> <br><p> æ›´å¤šç»†èŠ‚å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>é˜…è¯»ã€‚ </p></div></div><br><h2 id="ldap">  LDAP </h2><br><p> ä¸Šä¸€æ¬¡ï¼Œä»…åˆ›å»ºäº†ä¸€ä¸ªå…·æœ‰ç®¡ç†å‘˜è§’è‰²çš„LDAPç”¨æˆ·ã€‚ </p><br><p> ä½†æ˜¯å¤§å¤šæ•°æœåŠ¡ä¸éœ€è¦æ›´æ”¹ç”¨æˆ·æ•°æ®åº“ä¸­çš„ä»»ä½•å†…å®¹ã€‚ å› æ­¤ï¼Œæœ€å¥½æ·»åŠ ä¸€ä¸ªåªè¯»ç”¨æˆ·ã€‚ ä¸ºäº†ä¸æ‰‹åŠ¨åˆ›å»ºè§’è‰²ï¼Œå¯ä»¥ä½¿ç”¨å®¹å™¨åˆå§‹åŒ–è„šæœ¬ã€‚ </p><br><p> é¦–å…ˆï¼Œåœ¨<code>docker-compose.yml</code>æ·»åŠ è®¾ç½®ä»¥å¯ç”¨åªè¯»ç”¨æˆ·ï¼š </p><br><pre> <code class="plaintext hljs">- "LDAP_READONLY_USER=true" - "LDAP_READONLY_USER_USERNAME=readonly" - "LDAP_READONLY_USER_PASSWORD=READONLY_PASSWORD"</code> </pre> <br><p> æ‰°æµæ¿ä¸‹çš„å®Œæ•´æ–‡ä»¶ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">docker-compose.yml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">version: "2" networks: ldap: docker0: external: name: docker0 services: open-ldap: image: "osixia/openldap" hostname: "open-ldap" restart: always environment: - "LDAP_ORGANISATION=NAS" - "LDAP_DOMAIN=nas.nas" - "LDAP_ADMIN_PASSWORD=ADMIN_PASSWORD" - "LDAP_CONFIG_PASSWORD=CONFIG_PASSWORD" - "LDAP_READONLY_USER=true" - "LDAP_READONLY_USER_USERNAME=readonly" - "LDAP_READONLY_USER_PASSWORD=READONLY_PASSWORD" - "LDAP_TLS=true" - "LDAP_TLS_ENFORCE=false" - "LDAP_TLS_CRT_FILENAME=ldap_server.crt" - "LDAP_TLS_KEY_FILENAME=ldap_server.key" - "LDAP_TLS_CA_CRT_FILENAME=ldap_server.crt" volumes: - ./certs:/container/service/slapd/assets/certs - ./ldap_data/var/lib:/var/lib/ldap - ./ldap_data/etc/ldap/slapd.d:/etc/ldap/slapd.d networks: - ldap ports: - 172.21.0.1:389:389 - 172.21.0.1:636:636 phpldapadmin: image: "osixia/phpldapadmin:0.7.1" hostname: "nas.nas" restart: always networks: - ldap - docker0 expose: - 443 links: - open-ldap:open-ldap-server volumes: - ./certs:/container/service/phpldapadmin/assets/apache2/certs environment: - VIRTUAL_HOST=ldap.* - VIRTUAL_PORT=443 - VIRTUAL_PROTO=https - CERT_NAME=NAS.cloudns.cc - "PHPLDAPADMIN_LDAP_HOSTS=open-ldap-server" #- "PHPLDAPADMIN_HTTPS=false" - "PHPLDAPADMIN_HTTPS_CRT_FILENAME=certs/ldap_server.crt" - "PHPLDAPADMIN_HTTPS_KEY_FILENAME=private/ldap_server.key" - "PHPLDAPADMIN_HTTPS_CA_CRT_FILENAME=certs/ldap_server.crt" - "PHPLDAPADMIN_LDAP_CLIENT_TLS_REQCERT=allow" ldap-ssp: image: openfrontier/ldap-ssp:https volumes: - /etc/ssl/certs/ssl-cert-snakeoil.pem:/etc/ssl/certs/ssl-cert-snakeoil.pem - /etc/ssl/private/ssl-cert-snakeoil.key:/etc/ssl/private/ssl-cert-snakeoil.key restart: always networks: - ldap - docker0 expose: - 80 links: - open-ldap:open-ldap-server environment: - VIRTUAL_HOST=ssp.* - VIRTUAL_PORT=80 - VIRTUAL_PROTO=http - CERT_NAME=NAS.cloudns.cc - "LDAP_URL=ldap://open-ldap-server:389" - "LDAP_BINDDN=cn=admin,dc=nas,dc=nas" - "LDAP_BINDPW=ADMIN_PASSWORD" - "LDAP_BASE=ou=users,dc=nas,dc=nas" - "MAIL_FROM=admin@nas.nas" - "PWD_MIN_LENGTH=8" - "PWD_MIN_LOWER=3" - "PWD_MIN_DIGIT=2" - "SMTP_HOST=" - "SMTP_USER=" - "SMTP_PASS="</code> </pre> </div></div><br><p> ç„¶åï¼Œæ‚¨éœ€è¦è½¬å‚¨å¹¶åˆ é™¤ï¼š </p><br><pre> <code class="plaintext hljs">$ cd /tank0/docker/services/ldap $ tar czf ~/ldap_backup.tgz . $ ldapsearch -Wx -D "cn=admin,dc=nas,dc=nas" -b "dc=nas,dc=nas" -H ldap://172.21.0.1 -LLL &gt; ldap_dump.ldif $ docker-compose down $ rm -rf ldap_data $ docker-compose up -d</code> </pre> <br><p> ä¸ºäº†é˜²æ­¢æœåŠ¡å™¨ä»è½¬å‚¨ä¸­æ¢å¤æ—¶ä¸ä¼šå‡ºç°é‡å¤çš„å…ƒç´ ï¼Œè¯·åˆ é™¤æ–‡ä»¶ä¸­çš„è¡Œï¼š </p><br><pre> <code class="plaintext hljs">dn: dc=nas,dc=nas objectClass: top objectClass: dcObject objectClass: organization o: NAS dc: nas dn: cn=admin,dc=nas,dc=nas objectClass: simpleSecurityObject objectClass: organizationalRole cn: admin description: LDAP administrator userPassword:: PASSWORD_BASE64</code> </pre><br><p> å¹¶è¿˜åŸç”¨æˆ·å’Œç»„ï¼š </p><br><pre> <code class="plaintext hljs">$ ldapadd -Wx -D "cn=admin,dc=nas,dc=nas" -H ldap://172.21.0.1 -f ldap_dump.ldif</code> </pre> <br><p> è¿™æ ·çš„é‡å…½å°†å‡ºç°åœ¨æ•°æ®åº“ä¸­ï¼š </p><br><pre> <code class="plaintext hljs">dn: cn=readonly,dc=nas,dc=nas cn: readonly objectClass: simpleSecurityObject objectClass: organizationalRole userPassword:: PASSWORD_BASE64 description: LDAP read only user</code> </pre> <br><p> å®¹å™¨å°†åœ¨LDAPæœåŠ¡å™¨é…ç½®ä¸­åˆ›å»ºè§’è‰²ã€‚ <br> æ¢å¤åæ‰§è¡Œæ£€æŸ¥å¹¶åˆ é™¤å¤‡ä»½ï¼š </p><br><pre> <code class="plaintext hljs">$ rm ~/ldap_backup.tgz</code> </pre> <br><h3 id="dobavlenie-grupp-v-ldap"> å°†ç»„æ·»åŠ åˆ°LDAP </h3><br><p> æ–¹ä¾¿çš„æ˜¯å°†LDAPç”¨æˆ·åˆ†ä¸ºç±»ä¼¼äºLinuxä¸ŠPOSIXç»„çš„ç»„ã€‚ <br> ä¾‹å¦‚ï¼Œå¯ä»¥åˆ›å»ºå…¶ç”¨æˆ·å°†æœ‰æƒè®¿é—®å­˜å‚¨åº“ï¼Œè®¿é—®äº‘æˆ–è®¿é—®åº“çš„ç»„ã€‚ </p><br><p> å¯ä»¥è½»æ¾åœ°å°†ç»„æ·»åŠ åˆ°phpLDAPAdminä¸­ï¼Œè€Œæˆ‘ä¸ä¼šåœ¨æ­¤é‡ç‚¹ä»‹ç»ã€‚ </p><br><p> æˆ‘åªæ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š </p><br><ul><li> è¯¥ç»„æ˜¯ä»â€œé»˜è®¤â€æ¨¡æ¿åˆ›å»ºçš„ã€‚ è¿™<strong>ä¸æ˜¯POSIX</strong>ç»„ï¼Œè€Œæ˜¯ä¸€ç»„åç§°ã€‚ </li><li> å› æ­¤ï¼Œè¯¥ç»„å…·æœ‰ä¸€ä¸ª<code>objectClass</code>å±æ€§ï¼Œå…¶ä¸­åŒ…å«<code>groupOfUniqueNames</code>çš„å€¼ã€‚ </li></ul><br><p> <a href=""><img src="https://habrastorage.org/webt/tx/i8/yj/txi8yjxxtbvlzynr1yttkn-ddgc.png" alt="å°†ç»„æ·»åŠ åˆ°phpLDAPAdmin"></a> </p><br><h2 id="docker"> ç å¤´å·¥äºº </h2><br><p> åœ¨Dockerä¸­ï¼Œå‡ ä¹æ‰€æœ‰äº‹æƒ…éƒ½ä¸ºæ‚¨å®Œæˆã€‚ <br> é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä½¿ç”¨OMVå†…æ ¸ä¸­åŒ…å«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„ç³»ç»Ÿè°ƒç”¨é™åˆ¶</a> ï¼š </p><br><pre> <code class="plaintext hljs"># grep SECCOMP /boot/config-4.16.0-0.bpo.2-amd64 CONFIG_HAVE_ARCH_SECCOMP_FILTER=y CONFIG_SECCOMP_FILTER=y CONFIG_SECCOMP=y</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨è¿™é‡Œï¼Œæ‚¨</a>å¯ä»¥è¯¦ç»†äº†è§£åŸºæœ¬çš„Dockerå®‰å…¨è§„åˆ™ã€‚ <br> å¦å¤–ï¼Œå¦‚æœå¯ç”¨äº†AppArmorï¼Œåˆ™Dockerå¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸å…¶</a>é›†æˆï¼Œå¹¶å°†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…¶é…ç½®æ–‡ä»¶è½¬å‘åˆ°container</a> ã€‚ </p><br><h2 id="set"> è”æ’­ç½‘ </h2><br><h3 id="ustranenie-vozmozhnosti-obnaruzheniya-os"> æ¶ˆé™¤æ“ä½œç³»ç»Ÿå‘ç° </h3><br><p> ç½‘ç»œä½äºè·¯ç”±å™¨åé¢ï¼Œä½†å¯ä»¥é€šè¿‡æ›´æ”¹ç½‘ç»œå †æ ˆçš„æŸäº›å‚æ•°æ¥è¿›è¡Œå¥½å¥‡çš„ç»ƒä¹ ï¼Œä»¥ä½¿ç­”æ¡ˆæ— æ³•è¯†åˆ«OSã€‚ <br> è¿™æ ·åšå‡ ä¹æ²¡æœ‰çœŸæ­£çš„å¥½å¤„ï¼Œå› ä¸ºæ”»å‡»è€…å°†ç ”ç©¶æœåŠ¡æ ‡è¯­å¹¶ä¸”ä»ç„¶äº†è§£æ‚¨ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæ“ä½œç³»ç»Ÿã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">Nmapæ˜¾ç¤ºè®¾å¤‡ä¸Šæ­£åœ¨è¿è¡Œçš„æ“ä½œç³»ç»Ÿã€‚</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"># nmap -O localhost Starting Nmap 7.40 ( https://nmap.org ) at 2018-08-26 14:39 MSK Nmap scan report for localhost (127.0.0.1) Host is up (0.000015s latency). Other addresses for localhost (not scanned): ::1 Not shown: 992 closed ports PORT STATE SERVICE 53/tcp open domain 80/tcp open http 443/tcp open https 5432/tcp open postgresql Device type: general purpose Running: Linux 3.X|4.X OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 OS details: Linux 3.8 - 4.6 Network Distance: 0 hops OS detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 4.07 seconds</code> </pre> </div></div><br><p> ä»sysctl.confä¸‹è½½è®¾ç½®ï¼š </p><br><pre> <code class="plaintext hljs"># sysctl -p /etc/sysctl.conf net.ipv4.conf.all.accept_redirects = 0 net.ipv6.conf.all.accept_redirects = 0 net.ipv4.conf.all.send_redirects = 0 net.ipv4.conf.all.accept_source_route = 0 net.ipv6.conf.all.accept_source_route = 0 net.ipv4.tcp_rfc1337 = 1 net.ipv4.ip_default_ttl = 128 net.ipv4.icmp_ratelimit = 900 net.ipv4.tcp_synack_retries = 7 net.ipv4.tcp_syn_retries = 7 net.ipv4.tcp_window_scaling = 1 net.ipv4.tcp_timestamps = 1</code> </pre> <br><p> ç­‰ç­‰... </p><br><div class="spoiler">  <b class="spoiler_title">Nmapæ— æ³•ç¡®å®šæ“ä½œç³»ç»Ÿã€‚</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"># nmap -O localhost Starting Nmap 7.40 ( https://nmap.org ) at 2018-08-26 14:40 MSK Nmap scan report for localhost (127.0.0.1) Host is up (0.000026s latency). Other addresses for localhost (not scanned): ::1 Not shown: 992 closed ports PORT STATE SERVICE 53/tcp open domain 80/tcp open http 443/tcp open https 5432/tcp open postgresql No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.40%E=4%D=8/26%OT=53%CT=1%CU=43022%PV=N%DS=0%DC=L%G=Y%TM=5B8291C OS:3%P=x86_64-pc-linux-gnu)SEQ(SP=FA%GCD=1%ISR=105%TI=Z%CI=I%TS=8)OPS(O1=MF OS:FD7ST11NW7%O2=MFFD7ST11NW7%O3=MFFD7NNT11NW7%O4=MFFD7ST11NW7%O5=MFFD7ST11 OS:NW7%O6=MFFD7ST11)WIN(W1=AAAA%W2=AAAA%W3=AAAA%W4=AAAA%W5=AAAA%W6=AAAA)ECN OS:(R=Y%DF=Y%T=80%W=AAAA%O=MFFD7NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F= OS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=80%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5( OS:R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=A%A=Z% OS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N OS:%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=80%C OS:D=S) Network Distance: 0 hops OS detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.52 seconds</code> </pre> </div></div><br><p> è¿™äº›è®¾ç½®éœ€è¦å†™å…¥<code>/etc/sysctl.conf</code> ï¼Œç„¶ååœ¨æ¯æ¬¡é‡æ–°å¯åŠ¨æ—¶å°†è‡ªåŠ¨è¯»å–å®ƒä»¬ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">å®Œæ•´çš„/etc/sysctl.conf</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">################################################################### # Additional settings - these settings can improve the network # security of the host and prevent against some network attacks # including spoofing attacks and man in the middle attacks through # redirection. Some network environments, however, require that these # settings are disabled so review and enable them as needed. # # Do not accept ICMP redirects (prevent MITM attacks) net.ipv4.conf.default.accept_redirects = 0 net.ipv6.conf.default.accept_redirects = 0 net.ipv4.conf.all.accept_redirects = 0 net.ipv6.conf.all.accept_redirects = 0 # _or_ # Accept ICMP redirects only for gateways listed in our default # gateway list (enabled by default) # net.ipv4.conf.all.secure_redirects = 1 # # Do not send ICMP redirects (we are not a router) net.ipv4.conf.all.send_redirects = 0 # # Do not accept IP source route packets (we are not a router) net.ipv4.conf.all.accept_source_route = 0 net.ipv6.conf.all.accept_source_route = 0 ## protect against tcp time-wait assassination hazards ## drop RST packets for sockets in the time-wait state ## (not widely supported outside of linux, but conforms to RFC) net.ipv4.tcp_rfc1337 = 1 # # Log Martian Packets #net.ipv4.conf.all.log_martians = 1 # ################################################################### # Magic system request Key # 0=disable, 1=enable all # Debian kernels have this set to 0 (disable the key) # See https://www.kernel.org/doc/Documentation/sysrq.txt # for what other values do #kernel.sysrq=1 ################################################################### # Protected links # # Protects against creating or following links under certain conditions # Debian kernels have both set to 1 (restricted) # See https://www.kernel.org/doc/Documentation/sysctl/fs.txt #fs.protected_hardlinks=0 #fs.protected_symlinks=0 vm.overcommit_memory = 1 vm.swappiness = 10 ################################################################### # Anti-fingerprinting. # # Def: 64. net.ipv4.ip_default_ttl = 128 #   ICMP  (  1000) net.ipv4.icmp_ratelimit = 900 #    ,     . # Def: 5. net.ipv4.tcp_synack_retries = 7 # Def: 5. net.ipv4.tcp_syn_retries = 7 #   TCP window  timespamp    1323. net.ipv4.tcp_window_scaling = 1 net.ipv4.tcp_timestamps = 1 # Redis requirement. net.core.somaxconn = 511</code> </pre> </div></div><br><p> é˜²æ­¢å®šä¹‰æœåŠ¡ç‰ˆæœ¬çš„ä¿æŠ¤æ›´åŠ æœ‰ç”¨ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥ä½¿ç”¨Nmapï¼š </p><br><pre> <code class="plaintext hljs"># nmap -sV -sR --allports --version-trace 127.0.0.1</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">ç»“æœå¯¹äºç³»ç»Ÿè€Œè¨€ä¸æ˜¯å¾ˆå¥½ã€‚</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Not shown: 991 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u3 (protocol 2.0) 25/tcp open smtp Postfix smtpd 80/tcp open http nginx 1.13.12 111/tcp open rpcbind 2-4 (RPC #100000) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 443/tcp open ssl/http nginx 1.13.12 445/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 3493/tcp open nut Network UPS Tools upsd 8000/tcp open http Icecast streaming media server 2.4.2 Service Info: Hosts: nas.localdomain, NAS; OS: Linux; CPE: cpe:/o:linux:linux_kernel Final times for host: srtt: 22 rttvar: 1 to: 100000</code> </pre> </div></div><br><p> ä½†æ˜¯ç”±äºæœåŠ¡çš„ä¼ªè£…ï¼Œå¹¶éä¸€åˆ‡éƒ½æ˜¯é¡ºåˆ©çš„ï¼š </p><br><ul><li> å¯¹äºæ¯ç§æœåŠ¡ï¼Œè¿™é‡Œéœ€è¦ä¸€ç§å•ç‹¬çš„æ–¹æ³•ã€‚ </li><li> åˆ é™¤ç‰ˆæœ¬çš„åŠŸèƒ½å¹¶éå§‹ç»ˆå¯ç”¨ã€‚ </li></ul><br><p> ä¾‹å¦‚ï¼Œå¯¹äºSSHï¼Œå¯ä»¥åœ¨<code>/etc/ssh/sshd_confg</code>æ·»åŠ <code>DebianBanner no</code>é€‰é¡¹ã€‚ </p><br><p> ç»“æœï¼š </p><br><pre> <code class="plaintext hljs">22/tcp open ssh OpenSSH 7.4p1 (protocol 2.0)</code> </pre> <br><p> æ›´å¥½çš„æ˜¯ï¼Œå®ƒå°†æ— æ³•æ­£å¸¸å·¥ä½œï¼šSSHä½¿ç”¨è¯¥ç‰ˆæœ¬æ¥ç¡®å®šæ”¯æŒå“ªäº›åŠŸèƒ½ï¼Œå¹¶ä¸”å¯ä»¥ä»…é€šè¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¿®è¡¥æœåŠ¡å™¨</a>æ¥æ›´æ”¹å®ƒã€‚ </p><br><h3 id="port-knocking"> æ¸¯å£æ•²é—¨ </h3><br><p> ä¸æ˜¯æœ€çŸ¥åçš„å®‰å…¨æŠ€æœ¯ï¼Œå®ƒå…è®¸çŸ¥é“å¯†é’¥çš„è¿œç¨‹ç”¨æˆ·è¿æ¥åˆ°å°é—­ç«¯å£ã€‚ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é¡¹å·¥ä½œç±»ä¼¼äºå¯†ç é”</a> ï¼šæ¯ä¸ªäººéƒ½çŸ¥é“æœåŠ¡å®ˆæŠ¤ç¨‹åºæ­£åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œä½†æ˜¯ç›´åˆ°æ‹¨å…¥å¯†ç åâ€œå®ƒä»¬éƒ½ä¸å­˜åœ¨â€ã€‚ <br> ä¾‹å¦‚ï¼Œä¸ºäº†è¿æ¥åˆ°SSHæœåŠ¡å™¨ï¼Œç”¨æˆ·éœ€è¦æ‰“å¼€UDPç«¯å£7000ï¼ŒTCP 7007å’ŒUDP 7777ã€‚ <br> ä¹‹åï¼Œé˜²ç«å¢™å°†ä½¿ç”¨å…¶IPåœ¨<strong>å…³é—­çš„</strong> TCPç«¯å£22ä¸Šå¯åŠ¨ã€‚ </p><br><p> æ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>é˜…è¯»æœ‰å…³å…¶å·¥ä½œåŸç†çš„æ›´å¤šä¿¡æ¯ã€‚ å¹¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨Debianæ‰‹å†Œä¸­</a> ã€‚ </p><br><p> æˆ‘ä¸å»ºè®®ä½¿ç”¨ï¼Œå› ä¸º é€šå¸¸ï¼Œfail2banå°±è¶³å¤Ÿäº†ã€‚ </p><br><h3 id="fayrvoll"> é˜²ç«å¢™åŠŸèƒ½ </h3><br><p> æˆ‘é€šè¿‡Web GUI OpenMediaVaulté…ç½®é˜²ç«å¢™ï¼Œæˆ‘å‘æ‚¨å»ºè®®ã€‚ </p><br><p> <a href=""><img src="https://habrastorage.org/webt/cv/a9/eo/cva9eoxcbu4h8ut8cwrwczkjop8.png"></a> </p><br><p> æ‰“å¼€å¿…è¦çš„ç«¯å£ï¼Œä¾‹å¦‚443å’Œ22ï¼Œå…¶ä½™çš„è¿›è¡Œå“å°ã€‚ è¿˜å»ºè®®å¯ç”¨ä¸¢å¼ƒæ•°æ®åŒ…çš„æ—¥å¿—è®°å½•ã€‚ </p><br><h3 id="ssh">  SSH </h3><br><div class="spoiler">  <b class="spoiler_title">å¦‚æœSSHæŒ‚åœ¨å‘Internetå¼€æ”¾çš„ç«¯å£22ä¸Šï¼Œæ‚¨å°†æ”¶åˆ°è®¸å¤šæœ‰è¶£çš„æ¶ˆæ¯...</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"># grep "invalid user" /var/log/auth.log|head Aug 26 00:07:57 nas sshd[29786]: input_userauth_request: invalid user test [preauth] Aug 26 00:07:59 nas sshd[29786]: Failed password for invalid user test from 185.143.160.137 port 51268 ssh2 Aug 26 00:11:01 nas sshd[5641]: input_userauth_request: invalid user 0 [preauth] Aug 26 00:11:01 nas sshd[5641]: Failed none for invalid user 0 from 5.188.10.180 port 49025 ssh2 Aug 26 00:11:04 nas sshd[5644]: input_userauth_request: invalid user 0101 [preauth] Aug 26 00:11:06 nas sshd[5644]: Failed password for invalid user 0101 from 5.188.10.180 port 59867 ssh2 Aug 26 00:32:55 nas sshd[20367]: input_userauth_request: invalid user ftp [preauth] Aug 26 00:32:56 nas sshd[20367]: Failed password for invalid user ftp from 5.188.10.144 port 47981 ssh2 Aug 26 00:32:57 nas sshd[20495]: input_userauth_request: invalid user guest [preauth] Aug 26 00:32:59 nas sshd[20495]: Failed password for invalid user guest from 5.188.10.144 port 34202 ssh2</code> </pre> </div></div><br><p> å†’ç€çç¢çš„é£é™©ï¼Œæˆ‘ä»ç„¶è®°å¾—å®ƒæ˜¯å¿…éœ€çš„ï¼š </p><br><ul><li> ä¸¥æ ¼ç¦æ­¢rootç™»å½•ã€‚ </li><li> å°†ç™»å½•åé™åˆ¶ä¸ºä»…æŒ‡å®šç”¨æˆ·ã€‚ </li><li> å°†ç«¯å£æ›´æ”¹ä¸ºéæ ‡å‡†ç«¯å£ã€‚ </li><li> å»ºè®®ç¦ç”¨å¯†ç èº«ä»½éªŒè¯ï¼Œä»…ä¿ç•™å¯†é’¥ã€‚ </li></ul><br><p> é˜…è¯»æ›´å¤šå†…å®¹æ˜¯å¯èƒ½çš„ï¼Œä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨è¿™é‡Œ</a> ã€‚ </p><br><p> é€šè¿‡èœå•â€œæœåŠ¡-&gt; SSHâ€ï¼Œå¯ä»¥ä»OpenMediaVaultç•Œé¢è½»æ¾å®Œæˆæ‰€æœ‰è¿™äº›æ“ä½œã€‚ <br> é™¤éæˆ‘æ²¡æœ‰å°†ç«¯å£æ›´æ”¹ä¸ºéæ ‡å‡†ç«¯å£ï¼Œå¦åˆ™å°†22ä¿ç•™åœ¨æœ¬åœ°ç½‘ç»œä¸Šï¼Œåªæ˜¯æ›¿æ¢äº†NATè·¯ç”±å™¨ä¸­çš„ç«¯å£ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">è¿™æ˜¯æˆ‘å°è¯•ç¼–è¯‘çš„ä¸€ä¸ªæœ‰è¶£çš„å¸æˆ·åˆ—è¡¨ï¼Œç›´åˆ°æˆ‘å°†SSHDç«¯å£æ›´æ”¹ä¸ºä¸åŒäº22çš„ç«¯å£ã€‚</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"># grep "invalid user" /var/log/auth.log|sed 's/.*invalid user \([^ ]*\) .*/\1/'|sort|uniq 0 0101 1234 22 admin ADMIN administrateur administrator admins alfred amanda amber Anonymous apache avahi backup@network bcnas benjamin bin cacti callcenter camera cang castis charlotte clamav client cristina cron CSG cvsuser cyrus david db2inst1 debian debug default denis elvira erik fabio fax ftp ftpuser gary gast GEN2 guest I2b2workdata2 incoming jboss john juan matilda max mia miner muhammad mysql nagios nginx noc office oliver operator oracle osmc pavel pi pmd postgres PROCAL prueba RSCS sales sales1 scaner selena student07 sunos support sybase sysadmin teamspeak telecomadmin test test1 test2 test3 test7 tirocu token tomcat tplink ubnt ubuntu user1 vagrant victor volition www-data xghwzp xxx zabbix zimbra</code> </pre> </div></div><br><p> ä¸€æ—¦å®Œæˆï¼Œæœªç»æˆæƒçš„ç™»å½•å°è¯•å°†å˜å¾—ä¸é‚£ä¹ˆé¢‘ç¹ã€‚ </p><br><p> ä¸ºäº†è¿›ä¸€æ­¥æ”¹å–„è¿™ç§æƒ…å†µï¼Œæœ‰å¯èƒ½åœ¨å‡ æ¬¡ç™»å½•å°è¯•åé˜»æ­¢æ”»å‡»è€…è®¿é—®æŸäº›IPã€‚ </p><br><p> å¯ç”¨äºï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Fail2ban</a> ã€‚ ä¸€ä¸ªæµè¡Œçš„å®ç”¨ç¨‹åºï¼Œä¸ä»…é€‚ç”¨äºSSHï¼Œè€Œä¸”é€‚ç”¨äºè®¸å¤šå…¶ä»–åº”ç”¨ç¨‹åºã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‹’ç»ä¸»æœº</a> çœ‹èµ·æ¥åƒæ˜¯fail2banã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sshguard</a> ï¼Œå¦‚æœæ‚¨æ„¿æ„ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨å®ƒï¼Œä½†æ˜¯æˆ‘å¯¹æ­¤å¹¶ä¸æ„Ÿå…´è¶£ã€‚ </li></ul><br><p> æˆ‘æ­£åœ¨ä½¿ç”¨fail2banã€‚ å®ƒå°†ç›‘è§†æ—¥å¿—ä¸­æŸäº›IPæ–¹é¢çš„å„ç§ä¸è‰¯æ“ä½œï¼Œå¹¶åœ¨è¶…å‡ºå“åº”æ•°é‡çš„æƒ…å†µä¸‹å°†å…¶ç¦æ­¢ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">/var/log/fail2ban.logã€‚</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">2018-08-29 21:17:25,351 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.144 2018-08-29 21:17:25,473 fail2ban.actions [8650]: NOTICE [sshd] Ban 5.188.10.144 2018-08-29 21:17:27,359 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.144 2018-08-29 21:28:13,128 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:13,132 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:15,137 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:20,145 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:25,153 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:25,421 fail2ban.actions [8650]: NOTICE [sshd] Ban 5.188.10.176 2018-08-29 21:30:05,272 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:05,274 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:13,285 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:13,286 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:15,289 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:15,803 fail2ban.actions [8650]: NOTICE [sshd] Ban 5.188.10.180</code> </pre> </div></div><br><p> é€šè¿‡æ·»åŠ é˜²ç«å¢™è§„åˆ™æ¥ç¦æ­¢ã€‚ åœ¨æŒ‡å®šçš„æ—¶é—´åï¼Œè¯¥è§„åˆ™å°†è¢«åˆ é™¤ï¼Œç”¨æˆ·å¯ä»¥å†æ¬¡å°è¯•ç™»å½•ã€‚ </p><br><p> æœ€åˆï¼Œåªæœ‰SSHå¤„äºæ‰“å¼€çŠ¶æ€ï¼Œä½†æ˜¯å¯ä»¥å¯ç”¨å¯¹WebæœåŠ¡å™¨å’Œå…¶ä»–æœåŠ¡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼ˆè‡³å°‘æ˜¯ç›¸åŒçš„OMVï¼‰</a>çš„æ—¥å¿—çš„æ§åˆ¶ã€‚ <br> å¹¶ä¸”ï¼Œä»å®¹å™¨ä¸­å–å‡ºæ—¥å¿—å¹¶åœ¨å…¶ä¸Šè®¾ç½®fail2banã€‚ </p><br><p> æˆ‘å»ºè®®æ·»åŠ æœåŠ¡æ¥å“å°ã€‚ <br> æ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>æˆ–åœ¨æœ¬<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœºWiki</a>ä¸Šäº†è§£æœ‰å…³é…ç½®çš„æ›´å¤š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¿¡æ¯</a> ã€‚ </p><br><h2 id="logi"> æ—¥å¿— </h2><br><h3 id="lwatchhttpspackagesdebianorgstretchadminlwatch">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰‹è¡¨</a> </h3><br><p> ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œåº”è¯¥å®‰è£…ä¸€ä¸ªå°çš„å®ç”¨ç¨‹åºã€‚ å®ƒå°†çªå‡ºæ˜¾ç¤ºæ—¥å¿—å¹¶ä»¥æ¼‚äº®çš„å½¢å¼æ˜¾ç¤ºå®ƒä»¬ã€‚ <br> å¯ä»¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»»ä½•æ­¤ç±»å®ç”¨ç¨‹åº</a> ï¼Œä¸»è¦æ˜¯çªå‡ºæ˜¾ç¤ºæ—¥å¿—çš„é”™è¯¯å’Œé—®é¢˜åŒºåŸŸï¼Œä»¥ä¾¿äºå¯¹å…¶è¿›è¡Œå¯è§†åŒ–åˆ†æã€‚ </p><br><h3 id="logcheckhttplogcheckorg">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ—¥å¿—æ£€æŸ¥</a> </h3><br><p> åªéœ€å®‰è£…å’Œé…ç½®logcheckå°±æ˜¯å€¼å¾—çš„ï¼Œè¿™æ ·å½“æ‚¨ç¡®å®šæ—¥å¿—ä¸­æŠ¥å‘Šçš„é…ç½®é—®é¢˜æ—¶ï¼Œæ‚¨ä¼šç«‹å³åœ¨é‚®ä»¶ä¸­çœ‹åˆ°æ­¤é—®é¢˜ã€‚ <br> å°½ç®¡ç¡®å®éœ€è¦è¿›è¡Œè°ƒæ•´ï¼Œä½†å®ƒå¯ä»¥å¸®åŠ©æ‚¨æŸ¥çœ‹å‡ºäº†ä»€ä¹ˆé—®é¢˜ã€‚ </p><br><p> å®‰è£…æ–¹å¼ï¼š </p><br><pre> <code class="plaintext hljs"># apt-get install logcheck</code> </pre> <br><p> å®‰è£…åï¼Œå®ƒå°†ç«‹å³å‘é€æŠ¥å‘Šã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">æŠ¥å‘Šç¤ºä¾‹ã€‚</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">System Events =-=-=-=-=-=-= Oct 2 02:02:15 nas kernel: [793847.981226] [DROPPED] IN=br-ce OUT= PHYSIN=veth6c2a68e MAC=ff:ff:ff:ff:ff:ff: SRC=172.22.0.11 DST=255.255.255.255 LEN=29 TOS=0x00 PREC=0x00 TTL=64 ID=40170 DF PROTO=UDP SPT=35623 DPT=35622 LEN=9 Oct 2 02:02:20 nas hddtemp[13791]: /dev/sdh: Micron_1100 N #020Ğ‚: 32 C Oct 2 02:02:37 nas kernel: [793869.247128] [DROPPED] IN=br-7ba OUT= MAC= SRC=172.31.0.1 DST=172.31.255.255 LEN=239 TOS=0x00 PREC=0x00 TTL=128 ID=23017 DF PROTO=UDP SPT=138 DPT=138 LEN=219 Oct 2 02:02:37 nas kernel: [793869.247174] [DROPPED] IN=br-7ba OUT= MAC= SRC=172.31.0.1 DST=172.31.255.255 LEN=232 TOS=0x00 PREC=0x00 TTL=128 ID=23018 DF PROTO=UDP SPT=138 DPT=138 LEN=212 Oct 2 02:02:37 nas kernel: [793869.247195] [DROPPED] IN=br-673 OUT= MAC= SRC=192.168.224.1 DST=192.168.239.255 LEN=239 TOS=0x00 PREC=0x00 TTL=128 ID=8959 DF PROTO=UDP SPT=138 DPT=138 LEN=219 Oct 2 02:02:37 nas kernel: [793869.247203] [DROPPED] IN=br-673 OUT= MAC= SRC=192.168.224.1 DST=192.168.239.255 LEN=232 TOS=0x00 PREC=0x00 TTL=128 ID=8960 DF PROTO=UDP SPT=138 DPT=138 LEN=212 Oct 2 02:02:50 nas hddtemp[13791]: /dev/sdh: Micron_1100 N #020Ğ‚: 32 C</code> </pre> </div></div><br><p> å¯ä»¥çœ‹å‡ºæœ‰å¾ˆå¤šå¤šä½™çš„ä¸œè¥¿ï¼Œè¿›ä¸€æ­¥çš„è°ƒæ•´å°†å½’ç»“ä¸ºè¿‡æ»¤å®ƒã€‚ </p><br><p> é¦–å…ˆï¼Œå…³é—­hddtempï¼Œç”±äºSSDåç§°ä¸­çš„éASCIIå­—ç¬¦ï¼Œæ­¤æ“ä½œæ— æ³•æ­£å¸¸å·¥ä½œã€‚ <br> ä¿®å¤hddtempæ–‡ä»¶åï¼Œæ¶ˆæ¯åœæ­¢å‡ºç°ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">/etc/logcheck/ignore.d.server/hddtemp</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">^\w{3} [ :0-9]{11} [._[:alnum:]-]+ hddtemp\[[0-9]+\]: /dev/([hs]d[az]|sg[0-9]):.*[0-9]+.*[CF] ^\w{3} [ :0-9]{11} [._[:alnum:]-]+ hddtemp\[[0-9]+\]: /dev/([hs]d[az]|sg[0-9]):.*drive is sleeping</code> </pre> </div></div><br><p> ç„¶åï¼Œå¯ä»¥æŸ¥çœ‹logcheckæ‰€è¯´çš„å†…å®¹é˜»æ­¢äº†é˜²ç«å¢™çš„å¹¿æ’­æµé‡ï¼š </p><br><pre> <code class="plaintext hljs">[793869.247128] [DROPPED] IN=br-7ba OUT= MAC= SRC=172.31.0.1 DST=172.31.255.255 LEN=239 TOS=0x00 PREC=0x00 TTL=128 ID=23017 DF PROTO=UDP SPT=138 DPT=138 LEN=219</code> </pre> <br><p> å› æ­¤ï¼Œæ‚¨éœ€è¦å¯ç”¨æ¥è‡ªè·¯ç”±å™¨å’Œå®¹å™¨çš„å¹¿æ’­æµé‡ï¼š </p><br><ul><li> å…·æœ‰urbackupçš„å®¹å™¨çš„ç«¯å£35622ã€‚ </li><li> è·¯ç”±å™¨çš„ç«¯å£5678æ˜¯RouterOSé‚»å±…å‘ç°ã€‚ å¯ä»¥åœ¨è·¯ç”±å™¨ä¸Šç¦ç”¨å®ƒã€‚ </li><li> æŒ‡å‘åœ°å€224.0.0.251çš„ç«¯å£5353æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">mDNS</a> ã€‚ </li></ul><br><p> æ£€æŸ¥æ—¥å¿—æ£€æŸ¥ï¼š </p><br><pre> <code class="plaintext hljs">sudo -u logcheck logcheck -t -d</code> </pre> <br><p> æœ€åï¼Œé—®é¢˜å˜å¾—æ˜¾è€Œæ˜“è§ï¼š </p><br><pre> <code class="plaintext hljs">Oct 21 21:58:18 nas systemd[1]: Removed slice User Slice of user. Oct 21 21:58:31 nas systemd[1]: smbd.service: Unit cannot be reloaded because it is inactive. Oct 21 21:58:31 nas root: /etc/dhcp/dhclient-enter-hooks.d/samba returned non-zero exit status 1</code> </pre> <br><p> äº‹å®è¯æ˜ï¼ŒSAMBAæ— æ³•å¯åŠ¨ã€‚ ç¡®å®ï¼Œåˆ†æè¡¨æ˜æˆ‘æ˜¯é€šè¿‡systemctlä¼ªè£…çš„ï¼ŒOMVè¯•å›¾å¯åŠ¨å®ƒã€‚ </p><br><p>  Logcheckä»ç„¶ä¼šé€šè¿‡å„ç§é‚®ä»¶å‘é€åƒåœ¾é‚®ä»¶ã€‚ <br> ä¾‹å¦‚ï¼Œåœ¨è¿™é‡Œä¼ é€’äº†zfs-auto-snapshotï¼š </p><br><pre> <code class="plaintext hljs">Oct 21 22:00:57 nas zfs-auto-snap: @zfs-auto-snap_frequent-2018-10-21-1900, 16 created, 16 destroyed, 0 warnings.</code> </pre> <br><p> è¦å¿½ç•¥ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">/etc/logcheck/ignore.d.server/zfs-auto-snapshot</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">^\w{3} [ :0-9]{11} [._[:alnum:]-]+ zfs-auto-snap: \@zfs-auto-snap_[[:alnum:]-]+, [0-9]+ created, [0-9]+ destroyed, 0 warnings.$</code> </pre> </div></div><br><p>  rrdcachedä¹Ÿè¢«å¿½ç•¥ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">/etc/logcheck/ignore.d.server/rrdcached</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ rrdcached\[[0-9]+\]: flushing old values$ ^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ rrdcached\[[0-9]+\]: rotating journals$ ^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ rrdcached\[[0-9]+\]: started new journal [./[:alnum:]]+$ ^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ rrdcached\[[0-9]+\]: removing old journal [./[:alnum:]]+$</code> </pre> </div></div><br><p> å¦å¤–ï¼Œå»ºè®®åˆ é™¤zedï¼ˆå¦‚æœä»æœªåˆ é™¤ï¼‰ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">/etc/logcheck/ignore.d.server/zed</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">^\w{3} [ :0-9]{11} [._[:alnum:]-]+ (/usr/bin/)?zed: .*$ ^\w{3} [ :0-9]{11} [._[:alnum:]-]+ (/usr/bin/)?zed\[[0-9]+\]: .*$</code> </pre> </div></div><br><p> ç­‰ç­‰ã€‚ è®¸å¤šäººè®¤ä¸ºlogcheckæ˜¯ä¸€ä¸ªéå¸¸æ— ç”¨çš„å®ç”¨ç¨‹åºã€‚ <br> å¦‚æœæ‚¨å°†å…¶ç”¨ä½œè®¾ç½®å¹¶å¿˜è®°çš„ä¸œè¥¿ï¼Œåˆ™ä¸ºçœŸã€‚ </p><br><p> ä½†æ˜¯ï¼Œå¦‚æœæ‚¨äº†è§£logcheckåªæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ—¥å¿—è¿‡æ»¤å™¨ï¼Œæ²¡æœ‰å¯å‘å¼ï¼Œé­”æœ¯å’Œè‡ªé€‚åº”ç®—æ³•ï¼Œå°±ä¸ä¼šå‡ºç°å…¶å¿…è¦æ€§çš„é—®é¢˜ã€‚ åå¤åˆ†æä»–å‘é€çš„å†…å®¹ï¼Œæˆ–è€…é€šè¿‡æ·»åŠ å®ƒä»¥å¿½ç•¥æˆ–æ›´æ­£å®ƒï¼Œé€æ¸æœ‰å¯èƒ½è·å–ä¿¡æ¯ä¸°å¯Œçš„æŠ¥å‘Šã€‚ </p><br><p> ä½¿ç”¨è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œåˆ†ææ¯”ä½¿ç”¨åŒæ‰‹é€šè¿‡ç›¸åŒçš„æ­£åˆ™è¡¨è¾¾å¼è¿è¡Œæ—¥å¿—è¦å¥½å¾—å¤šï¼Œå¹¶ä¸”é€šå¸¸æ¯”ä½¿ç”¨Splunkç­‰å®Œæ•´çš„æ•°æ®åˆ†æç³»ç»Ÿè¦å¥½ã€‚ </p><br><p>  LogcheckåŠå…¶é…ç½®å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Wiki Gentoo</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„é˜…è¯»</a> ã€‚ </p><br><h2 id="ids-urovnya-uzla"> èŠ‚ç‚¹çº§IDS </h2><br><p> åœ¨è¿™é‡Œï¼Œæˆ‘å°†å‚è€ƒæˆ‘è‡ªå·±çš„æ–‡ç« <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œ SOCé¢†åŸŸè§£å†³æ–¹æ¡ˆçš„ç®€è¦åˆ†æå’Œæ•°æ®ä¼ è¾“ç½‘ç»œä¸­ç¥ç»ç½‘ç»œå¼‚å¸¸æ£€æµ‹å™¨çš„å¼€å‘â€</a> ï¼Œå…¶ä¸­æœ‰å‡ ä¸ªç¤ºä¾‹ã€‚ </p><br><p> æ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨Wikiä¸Šé˜…è¯»</a>æœ‰å…³IDS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„</a>æ›´å®Œæ•´çš„è¯„è®ºå’Œæ¯”è¾ƒã€‚ </p><br><h3 id="stig-4httpswwwstigviewercomstigred_hat_enterprise_linux_6">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">STIG-4</a> </h3><br><p> ä¸€ä¸ªå¤æ‚çš„å¤§å‹è„šæœ¬ï¼Œç”¨äºå¯¹RedHatä¸­å·²çŸ¥å·®è·çš„é™æ€åˆ†æã€‚ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Debianä¸­</a>æœ‰å…¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç«¯å£</a> ï¼Œæˆ‘å»ºè®®è‡³å°‘ä¸‹è½½å¹¶è¿è¡Œä¸€æ¬¡ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">STIG-4æ“ä½œç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"># cd root@nas:~# git clone https://github.com/hardenedlinux/STIG-4-Debian Cloning into 'STIG-4-Debian'... remote: Enumerating objects: 572, done. remote: Total 572 (delta 0), reused 0 (delta 0), pack-reused 572 Receiving objects: 100% (572/572), 634.37 KiB | 0 bytes/s, done. Resolving deltas: 100% (316/316), done. root@nas:~# cd STIG-4-Debian/ root@nas:~/STIG-4-Debian# bash stig-4-debian.sh -H Script Run: Mon Nov 12 23:58:34 MSK 2018 Start checking process... [ FAIL ] The cryptographic hash of system files and commands must match vendor values. ... Pass Count: 54 Failed Count: 137</code> </pre> </div></div><br><p> ä½¿ç”¨æ­¤è„šæœ¬çš„è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š </p><br><ul><li> æ‘†è„±è„šæœ¬ã€‚ </li><li> ç”¨<code>[ FAIL ]</code>åœ¨äº’è”ç½‘ä¸Šæœç´¢æ¯ä¸€è¡Œã€‚ </li><li> é€šå¸¸ï¼Œå°†æ‰¾åˆ°STIGåœ¨çº¿æ•°æ®åº“çš„é“¾æ¥ã€‚ </li><li> è¯·æŒ‰ç…§æ•°æ®åº“ä¸­çš„è¯´æ˜è¿›è¡Œæ›´æ­£ï¼Œä»¥å…å®ƒæ˜¯Debianã€‚ </li><li> å†æ¬¡è¿è¡Œè„šæœ¬ã€‚ </li></ul><br><h3 id="rkhunterhttprkhuntersourceforgenet">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çŒæ‰‹</a> </h3><br><p> å…³äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RkHunterçš„æ–‡ç« </a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¤ªå¤šäº†</a> ã€‚ <br> é•¿æœŸä½¿ç”¨ï¼Œå¹¿æ³›ä½¿ç”¨ï¼Œè¿˜åœ¨å‘å±•ä¸­ã€‚ æœ‰ä¸€ä¸ªDebianä»“åº“ã€‚ </p><br><h3 id="tigerhttpswwwnongnuorgtiger">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è™ç‰Œ</a> </h3><br><p> æ‰§è¡Œç³»ç»Ÿå®¡æ ¸å’Œå…¥ä¾µæ£€æµ‹çš„æ¨¡å—åŒ–å¤–å£³è„šæœ¬ã€‚ <br> å®ƒæœ‰ç‚¹ç±»ä¼¼äºSTIG-4ã€‚ <br> å®ƒå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹å®ç”¨ç¨‹åºæ¥åˆ†ææ—¥å¿—ï¼Œä»¥æ£€æµ‹è¿åæ ¡éªŒå’Œçš„è¡Œä¸ºã€‚ </p><br><p> ç”±å¤§é‡ä¸åŒçš„æ¨¡å—ç»„æˆã€‚ </p><br><p> ä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ªæ¨¡å—å¯ä»¥æ£€æµ‹ä½¿ç”¨å·²åˆ é™¤æ–‡ä»¶çš„æœåŠ¡ï¼Œè¿™ç§æƒ…å†µæ˜¯åœ¨ç³»ç»Ÿå‡çº§è¿‡ç¨‹ä¸­æ›´æ”¹äº†æœåŠ¡ä½¿ç”¨çš„åº“æ—¶å‘ç”Ÿçš„ï¼Œä½†æ˜¯ç”±äºæŸç§åŸå› æœåŠ¡æ²¡æœ‰é‡æ–°å¯åŠ¨ã€‚ </p><br><p> æœ‰ä¸€äº›æ¨¡å—å¯ç”¨äºæœç´¢ä¸å†ä½¿ç”¨çš„æœåŠ¡ç”¨æˆ·ï¼Œæ£€æŸ¥ç³»ç»Ÿæ˜¯å¦ç¼ºå°‘å®‰å…¨è¡¥ä¸ï¼Œæ£€æŸ¥umaskç­‰ã€‚ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç”·äººçš„</a>æ›´å¤šç»†èŠ‚ã€‚ </p><br><p> å®ƒå·²ç»æœ‰10å¹´æ²¡æœ‰å¼€å‘äº†ï¼ˆæ˜¯çš„ï¼Œæˆ‘ä¸æ˜¯å”¯ä¸€æ”¾å¼ƒè½¯ä»¶çš„äººï¼‰ã€‚ </p><br><h3 id="samhainhttpswwwla-samhnadesamhain">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¨å§†æµ·å› </a> </h3><br><p> å…¸å‹çš„HIDSå¯ä»¥ï¼š </p><br><ul><li> é€šè¿‡åŠ å¯†å“ˆå¸Œæ£€æŸ¥æ•´ä¸ªç³»ç»Ÿçš„å®Œæ•´æ€§ã€‚ </li><li> æœç´¢å…·æœ‰å·²å®‰è£…SUIDï¼ˆä¸åº”å®‰è£…ï¼‰çš„å„ç§å¯æ‰§è¡Œæ–‡ä»¶ã€‚ </li><li> æ£€æµ‹éšè—çš„è¿›ç¨‹ã€‚ </li><li> ç­¾ç½²æ—¥å¿—å’Œæ•°æ®åº“ã€‚ </li></ul><br><p> æ­¤å¤–ï¼Œå®ƒè¿˜å…·æœ‰é€šè¿‡Webç•Œé¢è¿›è¡Œçš„é›†ä¸­ç›‘è§†ä»¥åŠå°†æ—¥å¿—é›†ä¸­å‘é€åˆ°æœåŠ¡å™¨çš„åŠŸèƒ½ã€‚ <br>       ,        . <br>       . </p><br><p> ,  ,           . ,  ,    ,    ,         . </p><br><p> -     HIDS:        . <br>     Samhain,      . </p><br><h3 id="tripwirehttpssourceforgenetprojectstripwire"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Tripwire</a> </h3><br><p>   ,   Samhain,  Tripwire â€”    . <br>    ,   . </p><br><h3 id="lynishttpscisofycomlynis"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Lynis</a> </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  RkHunter</a> . </p><br><p>  ,    . <br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>     . <br>   Tiger       ,     ,  . <br>   ,  .    ,       , Lynix    Tripwire. </p><br><h3 id="chkrootkithttpwwwchkrootkitorg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Chkrootkit</a> </h3><br><p>     .    . <br> : </p><br><ul><li>   ,  . </li><li>       . </li><li> ,     latslog, wtmp  utmp. </li><li>     ,   ,     . </li></ul><br><p>      . </p><br><h3 id="ninjahttpforkbomborgninja"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Ninja</a> </h3><br><p>        Linux. </p><br><p>      ninja-build. </p><br><p> ,      .      UID/GID, Ninja      ,         ,    (,     , ). <br>          (, su). <br>   ,     . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  Ubuntu</a> ,     Debian. </p><br><h2 id="skanery-bezopasnosti">   </h2><br><p>       .   .    ,    ,    ,   . <br>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Nmap</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">W3af</a>  Web-. </p><br><h2 id="sistemy-alternativnyh-modeley-bezopasnosti">     </h2><br><p>  Linux  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> (  )  </a> . <br>      .  ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> . </p><br><p>   ,  ,   ,    . </p><br><p>        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  " Linux"  IBM</a> . </p><br><p>  NAS        ,    AppArmor. <br>  ,       ,     . <br> ,          ,          ,         . </p><br><h3 id="access-control-listshttpsdocsoraclecomcde19253-01820-0836ftyxiindexhtml"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Access Control Lists</a> </h3><br><p>     ,     . <br>  , ZFS       . </p><br><div class="spoiler"> <b class="spoiler_title">   ACL  ZFS.</b> <div class="spoiler_text"><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å°†æ–°æ–‡ä»¶æ·»åŠ åˆ°ç›®å½•çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åœ¨ç›®å½•ä¸­åˆ›å»ºå­ç›®å½•çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åˆ é™¤æ–‡ä»¶çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åˆ é™¤ç›®å½•å†…æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> æ‰§è¡Œæ–‡ä»¶æˆ–æœç´¢ç›®å½•å†…å®¹çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åˆ—å‡ºç›®å½•å†…å®¹çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¯»å–ACLçš„æƒé™ï¼ˆlså‘½ä»¤ï¼‰ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å…è®¸è¯»å–åŸºæœ¬æ–‡ä»¶å±æ€§ï¼ˆACLä»¥å¤–çš„â€œ statâ€å‘½ä»¤çº§åˆ«çš„å±æ€§ï¼‰ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¯»å–æ–‡ä»¶å†…å®¹çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> è¯»å–æ‰©å±•æ–‡ä»¶å±æ€§æˆ–åœ¨ç›®å½•ä¸­æœç´¢æ‰©å±•æ–‡ä»¶å±æ€§çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> åˆ›å»ºæ‰©å±•å±æ€§æˆ–å†™å…¥æ‰©å±•å±æ€§ç›®å½•çš„æƒé™ã€‚ </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ä¿®æ”¹æˆ–æ›¿æ¢æ–‡ä»¶å†…å®¹çš„æƒé™ã€‚ </font></font></li><li>      ,     ,   . </li><li>       ACL    chmod. </li><li>        .        chown  chgrp . </li><li>           ,     .               PRIV_FILE_CHOWN. </li><li>      ACL   . </li><li>   ACL      . </li><li>   ACL   ,         ,     .     ACL    file_inherit,  dir_inherit   . </li><li>   ACL       ,      . </li></ul></div></div><br><p>  ACL    , ,     ,   .         . </p><br><p>    EXT ,  ZFS  ACL      <code>setfacl/getfacl</code> ,    <code>chmod</code>  <code>ls</code> . </p><br><h3 id="apparmorhttpsgitlabcomapparmorapparmorwikishome"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AppArmor</a> </h3><br><p><img src="https://habrastorage.org/webt/p2/yt/br/p2ytbr0l4cq_ujt9sh_njrh1t7k.jpeg"></p><br><p>         . </p><br><p> ,         ,     <code>exec</code> ,  ,      <code>open</code> , <code>exec</code>  . <br>      ,     . <br> AppArmor ,       . <br>  ,      . <br>     capabilites. </p><br><p>     ,    .       ,   ,      ,   . </p><br><div class="spoiler"> <b class="spoiler_title">     ping.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#include &lt;tunables/global&gt; profile ping /{usr/,}bin/ping flags=(complain) { #include &lt;abstractions/base&gt; #include &lt;abstractions/consoles&gt; #include &lt;abstractions/nameservice&gt; capability net_raw, capability setuid, network inet raw, network inet6 raw, /{,usr/}bin/ping mixr, /etc/modules.conf r, # Site-specific additions and overrides. See local/README for details. #include &lt;local/bin.ping&gt; }</code> </pre> </div></div><br><p> ,       , ..     . ,  ,           ( <code>local/bin.ping</code> ),    ,     . </p><br><p>     deb-based . <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  firejail</a> ,    . </p><br><p>      ,   ,      . </p><br><p>    Debian, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . </p><br><h3 id="selinuxhttpselinuxprojectorgpagemain_page"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SELinux</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/uk/8e/_4/uk8e_4yzmie_mnhkeak2sxxztem.png" alt="SELinuxä½“ç³»ç»“æ„"></a> </p><br><p>    . <br>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">NSA</a> ,      Debian   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . </p><br><p>   SELinux   " " (type enforcement). </p><br><p>  , , ,      SELinux .      "". </p><br><p> ,    ,   <code>firefox_t</code> . <br> SELinux         ,     . </p><br><p> ä¸€ä¸ªä¾‹å­ï¼š </p><br><pre> <code class="plaintext hljs">allow firefox_t user_home_t : file { read write };</code> </pre> <br><p>     , ,  <code>firefox_t</code>         , ,  <code>user_home_t</code> . </p><br><p> ä¸€ä¸ªä¾‹å­ï¼š </p><br><pre> <code class="plaintext hljs">allow user_t user_home_t:file { create read write unlink };</code> </pre> <br><p>    <code>user_t</code>  , ,       <code>user_home_t</code> .  <code>user_t</code> ,  ,  . </p><br><p> ,      . </p><br><p>     AppArmor -,  ,   ,        . </p><br><div class="spoiler"> <b class="spoiler_title">     SELinux   .</b> <div class="spoiler_text"><ul><li> <strong></strong>  SELinux     Linux.     su  sudo,  SELinux  .   Linux    SELinux ,     1:1,     root. </li><li> <strong></strong> ,   ,   .  " ", "Web-", " ".     ,     <code>object_r</code> . <br>      ,  . </li><li> <strong></strong>  <strong></strong>      .  â€”    ,  . </li><li> <strong></strong>  <strong></strong>     .  ,   ,        . ,     <code>user_u:user_r:user_t</code> ,        <code>user_u:object_r:user_home_t</code> .     : </li></ul><br><pre> <code class="plaintext hljs">user:role:type:range</code> </pre> <br><p>   â€” SELinux user.    â€”   , .  â€”   MLS . </p><br><p> ,     ,  ,  <code>user_home_t.</code> <code>user_home_t</code> â€”  ,         ,     . </p><br><ul><li> <strong> </strong>  <strong> </strong> ,   <code>dir</code>    <code>file</code>     ,    ,    .      ,     . , <code>file</code>     (create),  (read),  (write)   (unlink),   <code>unix_stream_socket object</code> ( UNIX)     (create),   (connect),    (sendto). </li></ul></div></div><br><p>     ,        . <br>     . ,    (,     ),    . </p><br><p> ,   AppArmor,  permissive ,       ,    . <br>       . <br>   ,       ,    AppArmor       . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   SELinux</a>   . <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  </a> . <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  IBM</a> . </p><br><h3 id="grsecurityhttpswwwgrsecuritynet"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GrSecurity</a> </h3><br><p>    Debian -  .  ,    ,   . <br> ,   (     ), â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Gentoo</a> .     : hardening <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  </a> . </p><br><p> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   </a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  Debian</a>  ,    GrSecurity  PaX. </p><br><h3 id="tomoyohttptomoyoosdnjp"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Tomoyo</a> </h3><br><p> Tomoyo  Debian   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . </p><br><p>        .   AppArmor,   .   2003 . <br>   ,    ,  . <br>    ,    AppArmor,     . </p><br><h2 id="melochi">  </h2><br><p>        <code>/etc/securetty</code>  ,  root       ( ),        . </p><br><p>       PAM,       <code>/etc/security</code> . </p><br><p>    ,  Samhain  Tripwire,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">debsums</a> ,      . </p><br><h2 id="zaklyuchenie"> ç»“è®º </h2><br><p>    .     ,      . </p><br><p>  ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Github </a> ,   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN421279/">https://habr.com/ru/post/zh-CN421279/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN421265/index.html">å‡æœŸåçš„æ€ªå…½ï¼šAMD Threadripper 2990WX 32æ ¸å’Œ2950X 16æ ¸ï¼ˆç¬¬2éƒ¨åˆ†ï¼‰</a></li>
<li><a href="../zh-CN421269/index.html">ç¾å›½æœºåœºå®‰è£…çš„äººè„¸è¯†åˆ«ç³»ç»Ÿå¸®åŠ©æŠ“ä½äº†æ”»å‡»è€…</a></li>
<li><a href="../zh-CN421271/index.html">æœ‰å…³Azureçš„ä¸€äº›æœ‰ç”¨çš„èµ„æ–™ã€‚ ç¬¬2éƒ¨åˆ†-è¯¾ç¨‹</a></li>
<li><a href="../zh-CN421275/index.html">æˆ‘åœ¨12ä¸ªæœˆå†…å–æ‰ä¸¤å®¶åˆåˆ›å…¬å¸åçš„ç†è§£</a></li>
<li><a href="../zh-CN421277/index.html">ä»¥æ ‘è¯†åˆ«ä¸ºä¾‹çš„å«æ˜Ÿå›¾åƒåˆ†å‰²</a></li>
<li><a href="../zh-CN421281/index.html">3CXæŠ€æœ¯æ”¯æŒç­”æ¡ˆï¼šåœ¨IPç”µè¯æ˜¾ç¤ºå±ä¸Šå®‰è£…æ‚¨è‡ªå·±çš„å¾½æ ‡</a></li>
<li><a href="../zh-CN421283/index.html">å…³äºå“ˆå¸ƒé›·çš„â€œæ®µè½â€çš„ä¹¦ã€‚ ç¬¬ä¸€ç« ï¼šå®ˆæœ›è€…ç§‘å­¦å®¶</a></li>
<li><a href="../zh-CN421285/index.html">å…‰å­¦è·Ÿè¸ªå™¨ï¼šASEFå’ŒMOSSE</a></li>
<li><a href="../zh-CN421287/index.html">å¤ªé˜³èƒ½ç‚‰çš„æœˆé¥¼</a></li>
<li><a href="../zh-CN421289/index.html">ä¸€å¹´åŠçš„æ—¶é—´é‡Œï¼Œä¿„ç½—æ–¯çš„ç”µåŠ¨æ±½è½¦æ•°é‡ä»920å¢åŠ åˆ°2500</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>