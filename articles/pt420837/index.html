<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§òüèº ‚òØÔ∏è ü§¥üèΩ Teste de matrizes RAID de software para dispositivos NVMe usando a metodologia SNIA üë®üèª‚Äçüåæ üíö üî∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° alguns meses, enquanto trabalhavam no pr√≥ximo projeto, os profissionais do nosso laborat√≥rio de pesquisa estudaram os discos e as solu√ß√µes de softw...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Teste de matrizes RAID de software para dispositivos NVMe usando a metodologia SNIA</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raidix/blog/420837/"><img src="https://habrastorage.org/webt/4j/ib/lz/4jiblzb0pamckpjzolpdiq1gr8s.jpeg"><br><br>  H√° alguns meses, enquanto trabalhavam no pr√≥ximo projeto, os profissionais do nosso laborat√≥rio de pesquisa estudaram os discos e as solu√ß√µes de software NVMe para encontrar a melhor op√ß√£o para montar uma matriz de software. <br><br>  Os resultados dos testes foram surpreendentemente desanimadores - o enorme potencial de velocidade dos discos NVMe n√£o se correlacionou com o desempenho demonstrado dos produtos de software existentes. <br><a name="habracut"></a><br>  Nossos desenvolvedores n√£o gostaram.  E eles decidiram escrever seu produto ... Um produto que os comerciantes subseq√ºentemente criaram com o nome RAIDIX ERA. <br><br>  Hoje, mais de uma d√∫zia de empresas produzem servidores adaptados para o uso de unidades NVMe.  O mercado de produtos que suportam e desenvolvem essa tecnologia tem um enorme potencial.  No relat√≥rio anal√≠tico da G2M, s√£o apresentados n√∫meros bastante convincentes, convincentes de que este protocolo de transfer√™ncia de dados dominar√° em um futuro pr√≥ximo. <br><br><img src="https://habrastorage.org/webt/wd/f6/ol/wdf6olgkq9vam7sfinx9sb843ek.png"><br>  <i><font color="#99999">Gr√°fico do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio G2M</a></font></i> <br><br>  Atualmente, um dos l√≠deres na produ√ß√£o de componentes NVMe √© a Intel.  Foi no equipamento deles que realizamos testes para avaliar as capacidades dos produtos de software existentes para gerenciar um hardware "inovador". <br><br>  Juntamente com nosso parceiro, Promobit (um fabricante de servidores e sistemas de armazenamento de dados sob a marca comercial BITBLAZE), organizamos testes das unidades NVMe da Intel e do software comum para gerenciar esses dispositivos.  O teste foi realizado de acordo com o m√©todo SNIA. <br><br>  Neste artigo, compartilharemos os n√∫meros obtidos durante o teste do sistema de hardware Intel NVMe, matrizes de software do MDRAID, Zvol sobre ZFS RAIDZ2 e, de fato, nosso novo desenvolvimento. <br><br><h2>  Configura√ß√£o de hardware </h2><br>  Para a base da plataforma de teste, adotamos o sistema de servidor Intel Server System R2224WFTZS.  Possui 2 soquetes para a instala√ß√£o de processadores escal√°veis ‚Äã‚ÄãIntel Xeon e 12 canais de mem√≥ria (24 DIMMs no total) DDR 4 com uma frequ√™ncia de at√© 2666 MHz. <br><br>  Mais informa√ß√µes sobre a plataforma do servidor podem ser encontradas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no site do fabricante</a> . <br><br>  Todas as unidades NVMe conectadas atrav√©s de 3 backplanes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">F2U8X25S3PHS</a> . <br><br>  No total, temos 12 unidades NVMe INTEL SSDPD2MD800G4 com firmware CVEK6256004E1P0BGN no sistema. <br><br>  A plataforma do servidor foi equipada com dois processadores Intel¬Æ Xeon¬Æ Gold 6130 CPU a 2.10GHz com Hyper-Threading ativado, permitindo o lan√ßamento de dois threads a partir de cada n√∫cleo.  Assim, na sa√≠da, recebemos 64 threads de computa√ß√£o. <br><br><h2>  Prepara√ß√£o do teste </h2><br>  Todos os testes neste artigo foram realizados de acordo com a especifica√ß√£o da metodologia SNIA SSS PTSe v 1.1.  Inclusive, foi realizada uma prepara√ß√£o preliminar do armazenamento para obter um resultado est√°vel e honesto. <br><br>  O SNIA permite que o usu√°rio defina os par√¢metros para o n√∫mero de threads e a profundidade da fila; portanto, configuramos 64/32, com 64 threads de computa√ß√£o em 32 n√∫cleos. <br><br>  Cada teste foi realizado em 16 rodadas para levar o sistema a um n√≠vel est√°vel de indicadores e excluir valores aleat√≥rios. <br><br>  Antes de iniciar os testes, fizemos uma prepara√ß√£o preliminar do sistema: <br><br><ol><li>  Instalando a vers√£o do kernel 4.11 no CentOS 7.4. </li><li>  Desative C-STATES e P-STATES. </li><li>  Execute o utilit√°rio admiss√£o ajustado e defina o perfil de desempenho de lat√™ncia. </li></ol><br>  O teste de cada produto e item foi realizado com as seguintes etapas: <br><br>  Prepara√ß√£o de dispositivos de acordo com a especifica√ß√£o SNIA (dependente da carga e independente). <br><br><ol><li>  Teste de IOps em blocos de 4k, 8k, 16k, 32k, 64k, 128k, 1m com varia√ß√µes de combina√ß√µes de leitura / grava√ß√£o 0/100, 5/95, 35/65, 50/50, 65/35, 95/5, 100/0 . </li><li>  Testes de lat√™ncia com blocos de 4k, 8k, 16k com varia√ß√µes das combina√ß√µes de leitura / grava√ß√£o 0/100, 65/35 e 100/0.  O n√∫mero de encadeamentos e a profundidade da fila √© 1-1.  Os resultados s√£o registrados como atrasos m√©dios e m√°ximos. </li><li>  Teste de produ√ß√£o com blocos de 128k e 1M, em 64 linhas de 8 equipes. </li></ol><br>  Come√ßamos testando o desempenho, lat√™ncia e taxa de transfer√™ncia da plataforma de hardware.  Isso nos permitiu avaliar o potencial do equipamento proposto e comparar com os recursos das solu√ß√µes de software aplicadas. <br><br><h2>  Teste 1. Teste de Hardware </h2><br>  Para come√ßar, decidimos ver do que uma unidade Intel DCM D3700 NVMe √© capaz. <br>  Na especifica√ß√£o, o fabricante declara os seguintes par√¢metros de desempenho: <br><blockquote>  Leitura aleat√≥ria (100% de intervalo) 450.000 IOPS <br>  Grava√ß√£o aleat√≥ria (100% de intervalo) 88000 IOPS </blockquote><br><h3>  Teste 1.1 Uma unidade NVMe.  Teste de IOPS </h3><br>  Resultado de desempenho (IOps) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  84017,8 </td><td>  91393.8 </td><td>  117271.6 </td><td>  133059.4 </td><td>  175086.8 </td><td>  281131.2 </td><td>  390969.2 </td></tr><tr><td>  8k </td><td>  42602,6 </td><td>  45735,8 </td><td>  58980,2 </td><td>  67321.4 </td><td>  101357.2 </td><td>  171316.8 </td><td>  216551.4 </td></tr><tr><td>  16k </td><td>  21618,8 </td><td>  22834,8 </td><td>  29703,6 </td><td>  33821.2 </td><td>  52552.6 </td><td>  89731,2 </td><td>  108347 </td></tr><tr><td>  32k </td><td>  10929,4 </td><td>  11322 </td><td>  14787 </td><td>  16811 </td><td>  26577,6 </td><td>  47185.2 </td><td>  50670,8 </td></tr><tr><td>  64k </td><td>  5494,4 </td><td>  5671,6 </td><td>  7342,6 </td><td>  8285,8 </td><td>  13130,2 </td><td>  23884 </td><td>  27249.2 </td></tr><tr><td>  128k </td><td>  2748,4 </td><td>  2805,2 </td><td>  3617,8 </td><td>  4295,2 </td><td>  6506,6 </td><td>  11997,6 </td><td>  13631 </td></tr><tr><td>  1m </td><td>  351,6 </td><td>  354,8 </td><td>  451,2 </td><td>  684,8 </td><td>  830,2 </td><td>  1574,4 </td><td>  1702,8 </td></tr></tbody></table><br>  Resultado de desempenho (IOps) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/ja/gw/al/jagwaldo3cvyw5bxk9uxgeaqvtq.png"><br><br>  Nesta fase, obtivemos resultados que n√£o atingem exatamente os de f√°brica.  Provavelmente, o NUMA (o esquema de implementa√ß√£o da mem√≥ria do computador usado nos sistemas multiprocessadores, quando o tempo de acesso √† mem√≥ria √© determinado por sua localiza√ß√£o em rela√ß√£o ao processador) desempenhou seu papel, mas, por enquanto, n√£o prestaremos aten√ß√£o a ele. <br><br><h3>  Teste 1.2 Uma unidade NVMe.  Testes de atraso </h3><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,02719 </td><td>  0,072134 </td><td>  0,099402 </td></tr><tr><td>  8k </td><td>  0,029864 </td><td>  0,093092 </td><td>  0,121582 </td></tr><tr><td>  16k </td><td>  0,046726 </td><td>  0,137016 </td><td>  0,16405 </td></tr></tbody></table><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/di/dg/cy/didgcy1xldxrxa8e9qec9cfri8y.png"><br><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6,9850 </td><td>  4.7147 </td><td>  1,5098 </td></tr><tr><td>  8k </td><td>  7.0004 </td><td>  4.3118 </td><td>  1,4086 </td></tr><tr><td>  16k </td><td>  7.0068 </td><td>  4,6445 </td><td>  1.1064 </td></tr></tbody></table><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/j0/sp/1y/j0sp1ynjubpq8yfuikeiogvhzz0.png"><br><br><h3>  Teste 1.3 Taxa de transfer√™ncia </h3><br>  A etapa final √© avaliar a taxa de transfer√™ncia.  Aqui est√£o os seguintes indicadores: <br><blockquote>  Grava√ß√£o sequencial de 1 MB - 634 MBps. <br>  Leitura sequencial de 1 MB - 1707 MBps. <br>  Grava√ß√£o sequencial de 128Kb - 620 MBps. <br>  Leitura sequencial de 128Kb - 1704 MBps. </blockquote><br>  Depois de lidar com uma unidade, passamos a avaliar toda a plataforma, que consiste em 12 unidades. <br><br><h3>  Teste 1.4 Sistema em 12 unidades.  Teste de IOPS </h3><br>  Aqui, uma decis√£o forte foi tomada para economizar tempo e mostrar resultados apenas para trabalhar com o bloco 4k, que √© de longe o cen√°rio mais comum e indicativo para avaliar o desempenho. <br><br>  Resultado de desempenho (IOps) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  1363078.6 </td><td>  1562345 </td><td>  1944105 </td><td>  2047612 </td><td>  2176476 </td><td>  3441311 </td><td>  4202364 </td></tr></tbody></table><br>  Resultado de desempenho (IOps) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/lz/nb/za/lznbza47oi8rjwokg-eobx2rfnc.png"><br><br><h3>  Teste o sistema 1.5 em 12 unidades.  Testes de largura de banda </h3><br><blockquote>  Grava√ß√£o sequencial de 1 MB - 8612 MBps. <br>  Leitura sequencial de 1 MB - 20481 MBps. <br>  Grava√ß√£o sequencial de 128Kb - 7500 MBps. <br>  Leitura sequencial de 128Kb - 20400 MBps. </blockquote><br>  Analisaremos os indicadores de desempenho de hardware obtidos novamente no final do artigo, comparando-os com os n√∫meros do software testado nele. <br><br><h2>  Teste 2: Testando o MDRAID </h2><br>  Quando falamos sobre uma matriz de software, o MDRAID vem √† mente primeiro.  Lembre-se de que este √© o RAID de software b√°sico para Linux, que √© distribu√≠do gratuitamente. <br><br>  Vamos ver como o MDRAID lida com o sistema de 12 discos proposto com um n√≠vel de matriz RAID 0. Todos n√≥s entendemos que a cria√ß√£o de RAID 0 em 12 unidades requer coragem especial, mas agora precisamos desse n√≠vel de matriz para demonstrar os recursos m√°ximos desta solu√ß√£o. <br><br><h3>  Teste 2.1 MDRAID.  Teste RAID 0. IOPS </h3><br>  Resultado de desempenho (IOps) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  1010396 </td><td>  1049306.6 </td><td>  1312401.4 </td><td>  1459698,6 </td><td>  1932776.8 </td><td>  2692752.8 </td><td>  2963943.6 </td></tr><tr><td>  8k </td><td>  513627,8 </td><td>  527230.4 </td><td>  678140 </td><td>  771887.8 </td><td>  1146340.6 </td><td>  1894547.8 </td><td>  2526853.2 </td></tr><tr><td>  16k </td><td>  261087.4 </td><td>  263638.8 </td><td>  343679.2 </td><td>  392655.2 </td><td>  613912,8 </td><td>  1034843.2 </td><td>  1288299.6 </td></tr><tr><td>  32k </td><td>  131198.6 </td><td>  130947.4 </td><td>  170846.6 </td><td>  216039.4 </td><td>  309028.2 </td><td>  527920.6 </td><td>  644774.6 </td></tr><tr><td>  64k </td><td>  65083.4 </td><td>  65099.2 </td><td>  85257,2 </td><td>  131005,6 </td><td>  154839,8 </td><td>  268425 </td><td>  322739 </td></tr><tr><td>  128k </td><td>  32550,2 </td><td>  32718.2 </td><td>  43378,6 </td><td>  66999,8 </td><td>  78935.8 </td><td>  136869,8 </td><td>  161015.4 </td></tr><tr><td>  1m </td><td>  3802 </td><td>  3718,4 </td><td>  3233,4 </td><td>  3467,2 </td><td>  3546 </td><td>  6150,8 </td><td>  8193,2 </td></tr></tbody></table><br>  Resultado de desempenho (IOps) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/jf/d1/kl/jfd1klb3wv6px-vjbxypjff8nmu.png"><br><br><h3>  Teste 2.2 MDRAID.  RAID 0. Testes de atraso </h3><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,03015 </td><td>  0,067541 </td><td>  0.102942 </td></tr><tr><td>  8k </td><td>  0,03281 </td><td>  0,082132 </td><td>  0.126008 </td></tr><tr><td>  16k </td><td>  0,050058 </td><td>  0,114278 </td><td>  0.170798 </td></tr></tbody></table><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/6l/_o/im/6l_oimj5-72qy9d6w9tobclq3n4.png"><br><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6,7042 </td><td>  3.7257 </td><td>  0,8568 </td></tr><tr><td>  8k </td><td>  6.5918 </td><td>  2.2601 </td><td>  0,9004 </td></tr><tr><td>  16k </td><td>  6.3466 </td><td>  2,7741 </td><td>  2.5678 </td></tr></tbody></table><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/ms/-s/or/ms-sorgvctpuijgx_jf2uomifty.png"><br><br><h3>  Teste 2.3 MDRAID.  RAID 0. Testes de largura de banda </h3><br><blockquote>  Grava√ß√£o sequencial de 1 MB - 7820 MBPS. <br>  Leitura sequencial de 1 MB - 20418 MBPS. <br>  Grava√ß√£o sequencial de 128Kb - 7622 MBPS. <br>  Leitura sequencial de 128Kb - 20.380 MBPS. </blockquote><br><h3>  Teste 2.4 MDRAID.  RAID 6. Teste de IOPS </h3><br>  Vamos agora ver o que esse sistema possui no n√≠vel RAID 6. <br><br>  Op√ß√µes de cria√ß√£o de matriz <br><blockquote>  mdadm --create --verbose --chunk 16K / dev / md0 --level = 6 --raid-devices = 12 / dev / nvme0n1 / dev / nvme1n1 / dev / nvme2n1 / dev / nvme3n1 / dev / nvme4n1 / dev / nvme5n1 / dev / nvme8n1 / dev / nvme9n1 / dev / nvme10n1 / dev / nvme11n1 / dev / nvme6n1 / dev / nvme7n1 </blockquote><br>  O volume total da matriz foi de <b>7450,87</b> GiB. <br><br>  Iniciamos o teste ap√≥s a inicializa√ß√£o preliminar da matriz RAID. <br><br>  Resultado de desempenho (IOps) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  39907.6 </td><td>  42849 </td><td>  61609,8 </td><td>  78167,6 </td><td>  108594,6 </td><td>  641950.4 </td><td>  1902561.6 </td></tr><tr><td>  8k </td><td>  19474,4 </td><td>  20701,6 </td><td>  30316.4 </td><td>  39737,8 </td><td>  57051,6 </td><td>  394072.2 </td><td>  1875791.4 </td></tr><tr><td>  16k </td><td>  10371.4 </td><td>  10979,2 </td><td>  16022 </td><td>  20992,8 </td><td>  29955,6 </td><td>  225157.4 </td><td>  1267495.6 </td></tr><tr><td>  32k </td><td>  8505,6 </td><td>  8824,8 </td><td>  12896 </td><td>  16657,8 </td><td>  23823 </td><td>  173261.8 </td><td>  596857.8 </td></tr><tr><td>  64k </td><td>  5679,4 </td><td>  5931 </td><td>  8576,2 </td><td>  11137,2 </td><td>  15906,4 </td><td>  109469.6 </td><td>  320874.6 </td></tr><tr><td>  128k </td><td>  3976,8 </td><td>  4170,2 </td><td>  5974,2 </td><td>  7716,6 </td><td>  10996 </td><td>  68124.4 </td><td>  160453.2 </td></tr><tr><td>  1m </td><td>  768,8 </td><td>  811,2 </td><td>  1177,8 </td><td>  1515 </td><td>  2149,6 </td><td>  4880,4 </td><td>  5499 </td></tr></tbody></table><br>  Resultado de desempenho (IOps) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/p7/as/5s/p7as5s0v49uhmbhznnvjrpmfgf0.png"><br><br><h3>  Teste 2.5 MDRAID.  RAID 6. Testes de atraso </h3><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0.193702 </td><td>  0,145565 </td><td>  0,10558 </td></tr><tr><td>  8k </td><td>  0,266582 </td><td>  0,186618 </td><td>  0,127142 </td></tr><tr><td>  16k </td><td>  0.426294 </td><td>  0,281667 </td><td>  0,169504 </td></tr></tbody></table><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/ls/zv/3f/lszv3flgx0nduvygoxigvjfdfgk.png"><br><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6.1306 </td><td>  4.5416 </td><td>  4.2322 </td></tr><tr><td>  8k </td><td>  6.2474 </td><td>  4.5197 </td><td>  3.5898 </td></tr><tr><td>  16k </td><td>  5.4074 </td><td>  5.5861 </td><td>  4.1404 </td></tr></tbody></table><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/fv/id/ri/fvidriesmmcwdstzhrsnmwd-kqa.png"><br><br>  Vale ressaltar que aqui o MDRAID mostrou um n√≠vel muito bom de atrasos. <br><br><h3>  Teste 2.6 MDRAID.  RAID 6. Testes de largura de banda </h3><br><blockquote>  Grava√ß√£o sequencial de 1 MB - 890 MBPS. <br>  Leitura sequencial de 1 MB - 18800 MBPS. <br>  Grava√ß√£o sequencial de 128Kb - 870 MBPS. <br>  Leitura sequencial de 128Kb - 10400 MBPS. </blockquote><br><h2>  Teste 3. Zvol sobre ZFS RAIDZ2 </h2><br>  O ZFS possui uma fun√ß√£o interna de cria√ß√£o de RAID e um gerenciador de volume interno que cria dispositivos de bloco virtual, usados ‚Äã‚Äãpor muitos fabricantes de armazenamento.  Tamb√©m aproveitaremos esses recursos criando um pool com prote√ß√£o RAIDZ2 (an√°loga ao RAID 6) e um volume de bloco virtual em cima dele. <br><br>  A vers√£o 0.79 (ZFS) foi compilada.  Op√ß√µes de cria√ß√£o de matriz e volume: <br><blockquote>  ashift = 12 / compress√£o - desativada / desduplica√ß√£o - desativada / tamanho do registro = 1M / atime = desativada / cachefile = nenhuma / Tipo RAID = RAIDZ2 </blockquote><br>  O ZFS mostra resultados muito bons com o pool rec√©m-criado.  No entanto, com duplica√ß√£o repetida, o desempenho √© reduzido significativamente. <br><br>  A abordagem SNIA √© boa porque permite ver resultados reais de testes de sistemas de arquivos semelhantes (o baseado no ZFS) ap√≥s substitui√ß√µes repetidas neles. <br><br><h3>  Teste 3.1 ZVOL (ZFS).  RAIDZ2.  Teste de IOps </h3><br>  Resultado de desempenho (IOps) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  15719,6 </td><td>  15147,2 </td><td>  14190.2 </td><td>  15592,4 </td><td>  17965,6 </td><td>  44832,2 </td><td>  76314.8 </td></tr><tr><td>  8k </td><td>  15536,2 </td><td>  14929,4 </td><td>  15140,8 </td><td>  16551 </td><td>  17898.8 </td><td>  44553,4 </td><td>  76187.4 </td></tr><tr><td>  16k </td><td>  16696,6 </td><td>  15937,2 </td><td>  15982,6 </td><td>  17350 </td><td>  18546,2 </td><td>  44895,4 </td><td>  75549,4 </td></tr><tr><td>  32k </td><td>  11859,6 </td><td>  10915 </td><td>  9698,2 </td><td>  10235,4 </td><td>  11265 </td><td>  26741,8 </td><td>  38167.2 </td></tr><tr><td>  64k </td><td>  7444 </td><td>  6440,2 </td><td>  6313,2 </td><td>  6578,2 </td><td>  7465,6 </td><td>  14145,8 </td><td>  19099 </td></tr><tr><td>  128k </td><td>  4425,4 </td><td>  3785,6 </td><td>  4059,8 </td><td>  3859,4 </td><td>  4246,4 </td><td>  7143,4 </td><td>  10052,6 </td></tr><tr><td>  1m </td><td>  772 </td><td>  730,2 </td><td>  779,6 </td><td>  784 </td><td>  824,4 </td><td>  995,8 </td><td>  1514,2 </td></tr></tbody></table><br>  Resultado de desempenho (IOps) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/0j/cf/fr/0jcffrp4gkeayltgnp5us5rg2q8.png"><br><br>  Os n√∫meros de desempenho s√£o completamente inexpressivos.  Ao mesmo tempo, o zvol puro (antes de reescrever) fornece resultados significativamente melhores (5 a 6 vezes mais).  Aqui, o teste mostrou que, ap√≥s a primeira c√≥pia, o desempenho cai. <br><br><h3>  Teste 3.2 ZVOL (ZFS).  RAIDZ2.  Testes de atraso </h3><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,332824 </td><td>  0,255225 </td><td>  0,218354 </td></tr><tr><td>  8k </td><td>  0,3299 </td><td>  0,259013 </td><td>  0,225514 </td></tr><tr><td>  16k </td><td>  0.139738 </td><td>  0.180467 </td><td>  0.233332 </td></tr></tbody></table><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/ys/fj/hb/ysfjhbkrepf-zzj6bvdtx_hhrlm.png"><br><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  90,55 </td><td>  69.9718 </td><td>  84,4018 </td></tr><tr><td>  8k </td><td>  91.6214 </td><td>  86.6109 </td><td>  104.7368 </td></tr><tr><td>  16k </td><td>  108.2192 </td><td>  86.2194 </td><td>  105.658 </td></tr></tbody></table><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/du/ue/_1/duue_1fwxcx-n4dmyd455pdrc40.png"><br><br><h3>  Teste 3.3 ZVOL (ZFS).  RAIDZ2.  Testes de largura de banda </h3><br><blockquote>  Grava√ß√£o sequencial de 1 MB - 1150 MBPS. <br>  Leitura sequencial de 1 MB - 5500 MBPS. <br>  Grava√ß√£o sequencial de 128Kb - 1100 MBPS. <br>  Leitura seq√ºencial de 128Kb - 5300 MBPS. </blockquote><br><h2>  Teste 4: RAIDIX ERA </h2><br>  Vejamos agora os testes do nosso novo produto - RAIDIX ERA. <br>  Criamos o RAID6.  Tamanho da faixa: 16kb.  Ap√≥s a conclus√£o da inicializa√ß√£o, execute o teste. <br><br>  Resultado de desempenho (IOps) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  354887 </td><td>  363830 </td><td>  486865.6 </td><td>  619349.4 </td><td>  921403.6 </td><td>  2202384.8 </td><td>  4073187.8 </td></tr><tr><td>  8k </td><td>  180914.8 </td><td>  185371 </td><td>  249927.2 </td><td>  320438.8 </td><td>  520188.4 </td><td>  1413096.4 </td><td>  2510729 </td></tr><tr><td>  16k </td><td>  92115,8 </td><td>  96327,2 </td><td>  130661.2 </td><td>  169247.4 </td><td>  275446.6 </td><td>  763307.4 </td><td>  1278465 </td></tr><tr><td>  32k </td><td>  59994.2 </td><td>  61765.2 </td><td>  83512,8 </td><td>  116562.2 </td><td>  167028.8 </td><td>  420216.4 </td><td>  640418.8 </td></tr><tr><td>  64k </td><td>  27660,4 </td><td>  28229,8 </td><td>  38687,6 </td><td>  56603,8 </td><td>  76976 </td><td>  214958.8 </td><td>  299137.8 </td></tr><tr><td>  128k </td><td>  14475,8 </td><td>  14730 </td><td>  20674,2 </td><td>  30358,8 </td><td>  40259 </td><td>  109258.2 </td><td>  160141.8 </td></tr><tr><td>  1m </td><td>  2892,8 </td><td>  3031,8 </td><td>  4032,8 </td><td>  6331,6 </td><td>  7514,8 </td><td>  15871 </td><td>  19078 </td></tr></tbody></table><br>  Resultado de desempenho (IOps) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/px/on/md/pxonmd9exhzvhwqse0wugnzkc9o.png"><br><br><h3>  Teste 4.2 RAIDIX ERA.  RAID 6. Testes de atraso </h3><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,16334 </td><td>  0,136397 </td><td>  0,10958 </td></tr><tr><td>  8k </td><td>  0,207056 </td><td>  0,163325 </td><td>  0,132586 </td></tr><tr><td>  16k </td><td>  0,313774 </td><td>  0,225767 </td><td>  0,182928 </td></tr></tbody></table><br>  <b>Tempo m√©dio de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/hv/ad/xq/hvadxqbbwsigpbfi2d40nhsfevo.png"><br><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma de tabela.  Mistura de leitura / grava√ß√£o%. <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  5.371 </td><td>  3.4244 </td><td>  3.5438 </td></tr><tr><td>  8k </td><td>  5.243 </td><td>  3,7415 </td><td>  3.5414 </td></tr><tr><td>  16k </td><td>  7.628 </td><td>  4,2891 </td><td>  4.0562 </td></tr></tbody></table><br>  <b>Tempo m√°ximo de resposta</b> (ms) em forma gr√°fica.  Mistura de leitura / grava√ß√£o%. <br><br><img src="https://habrastorage.org/webt/pk/ys/bb/pkysbbysl2ldmme0fcbptzjh0ug.png"><br><br>  Atrasos s√£o semelhantes aos produzidos pelo MDRAID.  Por√©m, para conclus√µes mais precisas, uma estimativa dos atrasos sob uma carga mais s√©ria deve ser realizada. <br><br><h3>  Teste 4.3 RAIDIX ERA.  RAID 6. Testes de largura de banda </h3><br><blockquote>  Grava√ß√£o sequencial de 1 MB - 8160 MBPS. <br>  Leitura sequencial de 1 MB - 19700 MBPS. <br>  Grava√ß√£o sequencial de 128Kb - 6200 MBPS. <br>  Leitura sequencial de 128Kb - 19700 MBPS. </blockquote><br><h2>  Conclus√£o </h2><br>  Como resultado dos testes, vale a pena comparar os n√∫meros obtidos das solu√ß√µes de software com o que a plataforma de hardware nos fornece. <br><br>  Para analisar o desempenho da carga aleat√≥ria, compararemos a velocidade do RAID 6 (RAIDZ2) ao trabalhar com um bloco em 4k. <br><table><tbody><tr><th></th><th>  MD RAID 6 </th><th>  RAIDZ2 </th><th>  RAIDIX ERA RAID 6 </th><th>  Hardware </th></tr><tr><td>  4k R100% / W0% </td><td>  1902561 </td><td>  76314 </td><td>  4073187 </td><td>  4.494.142 </td></tr><tr><td>  4k R65% / W35% </td><td>  108594 </td><td>  17965 </td><td>  921403 </td><td>  1823432 </td></tr><tr><td>  4k R0% / W100% </td><td>  39907 </td><td>  15719 </td><td>  354887 </td><td>  958054 </td></tr></tbody></table><br><img src="https://habrastorage.org/webt/cm/4g/ff/cm4gffjnga2flpdn0nl3yxiwew0.png"><br><br>  Para analisar o desempenho da carga serial, veremos o RAID 6 (RAIDZ2) com um bloco de 128k.  Entre os threads, usamos um deslocamento de 10 GB para eliminar o acerto do cache e mostrar o desempenho real. <br><table><tbody><tr><th></th><th>  MD RAID 6 </th><th>  RAIDZ2 </th><th>  RAIDIX ERA RAID 6 </th><th>  Hardware </th></tr><tr><td>  128k seq read </td><td>  10400 </td><td>  5300 </td><td>  19700 </td><td>  20.400 </td></tr><tr><td>  128k seq write </td><td>  870 </td><td>  1100 </td><td>  6200 </td><td>  7500 </td></tr></tbody></table><br><img src="https://habrastorage.org/webt/6l/dw/wt/6ldwwti-7dql_njqadpemrz1mxi.png"><br><br><h3>  Qual √© o resultado? </h3><br>  Matrizes RAID de software populares e acess√≠veis para trabalhar com dispositivos NVMe n√£o podem mostrar o desempenho inerente ao potencial de hardware. <br><br>  Aqui h√° uma necessidade muito √≥bvia de um software de controle que possa agitar a situa√ß√£o e mostrar que a simbiose de controle de programa com unidades NVMe pode ser muito produtiva e flex√≠vel. <br><br>  Entendendo essa solicita√ß√£o, nossa empresa criou um produto RAIDIX ERA, cujo desenvolvimento se concentrou na solu√ß√£o dos seguintes problemas: <br><br><ul><li>  Alto desempenho de leitura e grava√ß√£o (v√°rios milh√µes de IOps) em matrizes com Paridade no modo de mixagem. </li><li>  Desempenho de streaming de 30 GBps, inclusive durante failover e recupera√ß√£o. </li><li>  Suporte para n√≠veis RAID 5, 6, 7.3. </li><li>  Inicializa√ß√£o e reconstru√ß√£o em segundo plano. </li><li>  Configura√ß√µes flex√≠veis para diferentes tipos de carga (lado do usu√°rio). </li></ul><br>  Hoje, podemos dizer que essas tarefas foram conclu√≠das e o produto est√° pronto para uso. <br><br>  Ao mesmo tempo, entendendo o interesse de muitas partes interessadas em tais tecnologias, preparamos para o lan√ßamento n√£o apenas uma licen√ßa paga, mas tamb√©m uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">licen√ßa gratuita</a> , que pode ser totalmente usada para resolver problemas nas unidades NVMe e SSD. <br><br>  Leia mais sobre o RAIDIX ERA <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em nosso site</a> . <br><br><h2>  UPD  Teste ZFS reduzido com tamanho de registro e tamanho de bloco de 8k </h2><br>  Tabela de op√ß√µes do ZFS <br><table><tbody><tr><th>  NAME </th><th>  PROPRIEDADE </th><th>  VALUE </th><th>  FONTE </th></tr><tr><td>  tanque </td><td>  tamanho </td><td>  8K </td><td>  local </td></tr><tr><td>  tanque </td><td>  compress√£o </td><td>  fora </td><td>  padr√£o </td></tr><tr><td>  tanque </td><td>  dedup </td><td>  fora </td><td>  padr√£o </td></tr><tr><td>  tanque </td><td>  soma de verifica√ß√£o </td><td>  fora </td><td>  local </td></tr><tr><td>  tanque </td><td>  volblocksize </td><td>  - </td><td>  - </td></tr><tr><td>  tanque / ataque </td><td>  tamanho </td><td>  - </td><td>  - </td></tr><tr><td>  tanque / ataque </td><td>  compress√£o </td><td>  fora </td><td>  local </td></tr><tr><td>  tanque / ataque </td><td>  dedup </td><td>  fora </td><td>  padr√£o </td></tr><tr><td>  tanque / ataque </td><td>  soma de verifica√ß√£o </td><td>  fora </td><td>  local </td></tr><tr><td>  tanque / ataque </td><td>  volblocksize </td><td>  8k </td><td>  padr√£o </td></tr></tbody></table><br>  A grava√ß√£o piorou, a leitura √© melhor. <br>  Mesmo assim, todos os resultados s√£o significativamente piores que outras solu√ß√µes <br><table><tbody><tr><th>  Tamanho do bloco </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  13703,8 </td><td>  14399,8 </td><td>  20903,8 </td><td>  25669 </td><td>  31610 </td><td>  66955,2 </td><td>  140849,8 </td></tr><tr><td>  8k </td><td>  15126 </td><td>  16227,2 </td><td>  22393,6 </td><td>  27720,2 </td><td>  34274,8 </td><td>  67008 </td><td>  139480.8 </td></tr><tr><td>  16k </td><td>  11111.2 </td><td>  11412.4 </td><td>  16980,8 </td><td>  20812,8 </td><td>  24680,2 </td><td>  48803.6 </td><td>  83710.4 </td></tr></tbody></table></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt420837/">https://habr.com/ru/post/pt420837/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt420825/index.html">Hoje ser√° a primeira partida entre os profissionais OpenAI e Dota 2 (pessoas vencidas). Entendemos como o bot funciona</a></li>
<li><a href="../pt420827/index.html">Crie um projeto simples do maven usando Java EE + WildFly10 + JPA (Hibernate) + Postgresql + EJB + IntelliJ IDEA</a></li>
<li><a href="../pt420829/index.html">Sistema de trabalho. Vis√£o geral do outro lado</a></li>
<li><a href="../pt420831/index.html">O dispositivo para a emiss√£o de cookies "Cook 3000"</a></li>
<li><a href="../pt420833/index.html">Principais erros de monetiza√ß√£o de aplicativos [e como corrigi-los]</a></li>
<li><a href="../pt420841/index.html">Hotfix pr√©-hospitalar ou ‚ÄúHey Swagger! Onde est√£o meus erros?</a></li>
<li><a href="../pt420843/index.html">7 de setembro de Ecaterimburgo - uma reuni√£o para desenvolvedores .NET</a></li>
<li><a href="../pt420845/index.html">Domar os obstinados com o uso de uma muleta: o orif√≠cio do adaptador Wi-Fi WF2190 (Realtek8812AU Wireless LAN 802.11ac USB)</a></li>
<li><a href="../pt420847/index.html">Introdu√ß√£o √† programa√ß√£o de sombreador para layouts</a></li>
<li><a href="../pt420853/index.html">Conhe√ßa o Pseudo Console do Windows (ConPTY)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>