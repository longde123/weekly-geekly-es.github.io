<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§±üèø üöÜ üßõüèø Kivy. De la cr√©ation √† la production est une √©tape. 2e partie üöå üë®‚Äçüë©‚Äçüë¶ üõï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Partie 1 

 Salutations! 

 Aujourd'hui, comme toujours, parlons de la cr√©ation d'applications mobiles avec le framework Kivy et Python. En particulie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kivy. De la cr√©ation √† la production est une √©tape. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414353/"><img src="https://habrastorage.org/webt/bu/vd/zj/buvdzj9m_o2hofykxup3chiad7i.png" align="left">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>Partie 1</b></a> <br><br>  Salutations! <br><br>  Aujourd'hui, comme toujours, parlons de la cr√©ation d'applications mobiles avec le framework Kivy et Python.  En particulier, il se concentrera sur la cr√©ation d'un client mobile pour une ressource Internet et sa publication sur Google Play.  Je vais vous dire quels probl√®mes un novice et un d√©veloppeur exp√©riment√© peuvent avoir, qui ont d√©cid√© de s‚Äôessayer au d√©veloppement multiplateforme avec Kivy, ce qui peut et ne devrait pas √™tre fait en programmation avec Python pour Android. <br><a name="habracut"></a><br>  Un matin, j'ai trouv√© dans mon courrier sur Habr√© une lettre me demandant si je pouvais utiliser Python et Kivy pour ¬´recr√©er le site svyatye.com dans une application mobile afin que les gens puissent le lire et l'utiliser hors ligne¬ª avec la publication ult√©rieure du client dans App Store de Google Play.  En suivant le lien et en parcourant la ressource, qui s'est av√©r√©e √™tre une grande biblioth√®que de citations, j'ai imagin√© √† quoi cela ressemblerait dans une pr√©sentation mobile et comment je cr√©erais des listes de ¬´plus de 30 236 dictons des saints p√®res et enseignants de l'√©glise¬ª malgr√© la longueur des citations, parfois , atteint plus de 10 000 caract√®res (5 √† 6 pages de texte imprim√©).  Depuis que je travaille avec Kivy depuis longtemps, j'ai rapidement compris comment et ce que je ferais.  Par cons√©quent, il a r√©pondu au client qu'il ne serait pas difficile de faire une telle demande.  Cependant, des difficult√©s, dont je parlerai plus loin, sont n√©anmoins apparues ... <br><br>  Aucune sp√©cification technique n'a √©t√© fournie.  La seule exigence est que l'application fonctionne comme une horloge.  Pas de d√©lais.  Il n'y avait pas non plus de disposition d'interface.  "Tout devrait √™tre aussi simple que possible, sans animations, transformations et autres enveloppes, en un mot, aussi aust√®re que possible."  Et bien, tant mieux.  De plus, ma d√©cision est d√©j√† m√ªre - l'application utilisera un objet RecycleView, qui affichera les cat√©gories, sous-cat√©gories, listes d'auteurs de citations et de citations elles-m√™mes. <br><br><h3>  Listes </h3><br>  Cependant, RecycleView, qui vous permet d'ouvrir d'√©normes listes de plusieurs milliers en une fraction de seconde, s'est comport√© de mani√®re tr√®s diff√©rente de celle souhait√©e.  Non, il n'y a eu aucun probl√®me lors de l'ouverture des listes de devis, tout a fonctionn√© rapidement, je n'ai m√™me pas charg√© de nouveaux devis avec la fen√™tre ¬´Attendre¬ª sur le site, car la liste des devis de la cat√©gorie s√©lectionn√©e a √©t√© rendue instantan√©ment et compl√®tement.  Le probl√®me √©tait diff√©rent - le client a insist√© pour que le texte du devis dans la liste soit affich√© dans son int√©gralit√© et que RecycleView n'√©tait pas enti√®rement appropri√© ici.  Le fait est que le principe de fonctionnement de ce widget est le suivant: un objet est cr√©√© sur toute la liste, qui est ensuite simplement clon√©, √† la suite de quoi nous avons une vitesse incroyable de rendu de la liste, quelle que soit sa taille.  Mais il y a une chose - la hauteur de l'√©l√©ment de liste doit √™tre fix√©e et connue √† l'avance.  Mais si vous devez calculer dynamiquement la hauteur de l'√©l√©ment de liste suivant lors du d√©filement, comme dans mon cas, il y a un d√©calage notable - la liste se bloque pendant une fraction de seconde, ce qui, vous voyez, n'est en aucun cas pr√™t pour la prodaction. <br><br>  Avec un chagrin de moiti√©, j'ai r√©ussi √† persuader le client d'une liste avec un aper√ßu des citations, dont le texte s'ouvrirait enti√®rement par tapu au texte de l'aper√ßu, comme cela a √©t√© fait dans presque tous les forums, non pas parce que RecycleView ne pouvait pas faire face √† la t√¢che, mais parce qu'il √©tait le plus logique: faire d√©filer le texte multi-page du devis, surtout si le devis n'int√©ressait pas l'utilisateur, de mon point de vue ce n'√©tait pas correct. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pi/3d/nw/pi3dnwwczjvhvomwwtz-aej8w7s.png"></div>  <i><b>Fig.</b></i>  <i><b>1</b></i> <i><b><br></b></i>  <i><b>Aper√ßu et texte int√©gral lorsque vous appuyez sur l'aper√ßu du devis</b></i> <br><br>  Cette option a fonctionn√© tr√®s rapidement, mais ... le client ne l'aimait pas ... J'ai d√ª utiliser un ScrollView lent, qui rend la liste AVANT qu'elle ne s'affiche √† l'√©cran, ce qui signifie qu'elle ne g√®le pas le d√©filement de la liste de devis, car elle calcule et restitue √† l'avance tous les param√®tres des √©l√©ments de la liste, ce qui, Naturellement, cela affectera la vitesse √† laquelle la liste est affich√©e √† l'√©cran.  Habituellement, la performance est mise en premier lieu, et ici, ils me disent: ¬´que ce soit plus lent¬ª. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lj/nf/wd/ljnfwdbv70f9ykkmwpau3ykypao.jpeg"></div><br>  Eh bien, je ne discutais plus, et m√™me si je n'aimais vraiment pas cette solution, je devais tout transf√©rer vers ScrollView.  Comme, comme je l'ai dit, ScrollView est tr√®s lent, il a √©t√© d√©cid√© d'afficher des citations par portions de dix chacune avec un chargement automatique suppl√©mentaire des dix suivantes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2ca/124/840/2ca124840069a9a452aefd3faa5c53e3.gif"></div><br>  En allant un peu plus loin, je dirai que lorsque les premiers retours des utilisateurs sont venus avec une demande, ils ont dit que les signets ne feraient pas vraiment de mal, comme il me semble, le client doutait toujours de la d√©cision d'utiliser ScrollView, comme si nous omettions les aper√ßus des devis et RecycleView, puis sans probl√®me, ils pouvaient restaurer instantan√©ment √† partir des signets pr√©c√©demment consult√©s par l'utilisateur dans les listes de devis de la session pr√©c√©dente, quelle que soit leur dur√©e.  Et avec ScrollView, l'utilisateur vieillira simplement en attendant que la liste soit affich√©e au moins dans l'esprit des citations. <br><br><h3>  Buildozer et services </h3><br>  Au fur et √† mesure du d√©veloppement de l'application, il a √©t√© propos√© d'y d√©poser un service qui enverrait un devis al√©atoire de la base de donn√©es √† l'utilisateur une fois par jour.  Je n'avais jamais trait√© de t√¢ches similaires √† Kivy auparavant, mais en me rappelant qu'il existe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un article</a> sur Habr√© √† ce sujet, j'ai d√©cid√© de l'essayer. <br><br>  Apr√®s avoir tu√© une semaine enti√®re, cass√© cinq claviers et deux moniteurs, je n'ai pas pu compiler le package selon les instructions de l'article ci-dessus - lors de la compilation, la classe requise n'a pas √©t√© trouv√©e.  Apr√®s avoir √©crit √† l'auteur de l'article, j'ai sugg√©r√© que, apparemment, seules deux raisons pour lesquelles j'avais √©chou√© √©taient vraies: soit j'√©tais un idiot, soit les d√©veloppeurs ont cass√© Buildozer, un outil pour cr√©er des packages APK pour Android.  Mes hypoth√®ses se sont av√©r√©es vraies - "Bien s√ªr, ils l'ont cass√©, apr√®s la version 0.33 ce qu'ils vont collecter." <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j1/sl/le/j1sllelwpmfwhkjxhi1hotfap5w.jpeg"></div><br>  Oui, la part du lion des questions sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">forum Kivy est</a> li√©e √† divers probl√®mes qui se posent pr√©cis√©ment avec Buildozer.  Maintenant, chaque version de cet outil n√©cessite sa propre version de Cython, que vous s√©lectionnerez exp√©rimentalement pendant une longue p√©riode, en utilisant les derni√®res versions de Buildozer, vous ne pourrez pas ajouter de biblioth√®que √† votre projet JAR, car bien que le projet soit assembl√©, la biblioth√®que n'y sera pas ajout√©e et vous serez encore une semaine , comme moi, asseyez-vous √† la recherche d'un probl√®me.  Et ... vous ne la trouverez pas.  Par cons√©quent, pour les d√©butants et les personnes ayant une mentalit√© faible, travailler avec Buildozer peut apporter √† la clinique. <br><br>  J'ai donc crach√© sur ce tracteur mort, je suis all√© en enfer, je suis all√© sur github, j'ai t√©l√©charg√© python-pour-android, pris Crystax-NDK sur le site, install√© Python 3.5 et tranquillement assembl√© l'APK du projet avec la troisi√®me branche Python, qui s'est av√©r√©e √™tre beaucoup plus simple, qu'avec le c√©l√®bre Buildozer. <br><br>  Et les services?  Mais rien.  Ils ne fonctionnent pas.  Plus pr√©cis√©ment, le service cr√©√© dans votre projet ne commencera pas par un red√©marrage du smartphone, peu importe ce que l'auteur de l'article pr√©tend √† propos des services dans Kivy.  Apr√®s avoir trouv√© sur Google Play et install√© son projet, j'ai constat√© qu'aucun service ne red√©marre avec le red√©marrage du programme.  100% des services dans Kivy ne commencent qu'avec le lancement de l'application elle-m√™me.  Plus tard, si vous fermez l'application, le service continuera de fonctionner sans bruit jusqu'√† ce que vous √©teigniez l'appareil. <br><br><h3>  √Ä propos de Python 2 et Python 3 </h3><br>  En f√©vrier de cette ann√©e, Moscou Python a eu lieu au bureau de Moscou de Yandex, dans lequel Vladislav Shashkov a fait une pr√©sentation sur le th√®me: ¬´L'application mobile Python avec kivy / buildozer est la cl√© du succ√®s¬ª.  Il a donc eu la stupidit√© de dire que Python 2 dans l'assemblage APK est plus rapide que Python 3. Ne croyez personne, ce n'est pas vrai.  Python 3 est plus rapide que Python 2 en principe!  Lorsque j'ai d√©velopp√© ¬´Quotes of the Saints¬ª (on supposait √©galement que la deuxi√®me branche Python serait utilis√©e dans l'assemblage), j'ai √©t√© horrifi√© de constater que la base de cotation de 20 Mo, qui est utilis√©e dans l'application lorsqu'il n'y a pas de connexion r√©seau, est lue √† l'aide de json. charge jusqu'√† 13-16 secondes sur un appareil mobile!  Et la m√™me base, mais d√©j√† avec Python 3, il est trait√© sur l'appareil en 1-2 secondes!  Tirez vos propres conclusions ... <br><br><h3>  √Ä propos de React Native </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bm/92/89/bm92891hjs-ffkf8__e5tej0fly.jpeg"></div><br>  Oui, dans mes articles, j'ai d√©cid√© de faire des parall√®les entre Kivy et d'autres frameworks pour le d√©veloppement multiplateforme.  Ici, il vous suffit d'ouvrir le spoiler et de voir comment les applications simples, rapides et √©l√©gantes sont cr√©√©es sur React Native ... <br><br><div class="spoiler">  <b class="spoiler_title">Exemple</b> <div class="spoiler_text">  Essayons de dessiner une interface compl√®te.  Nous r√©√©crivons App.js en utilisant les composants de la biblioth√®que native: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Container, Content} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {StyleSheet, Text, View} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> styles = StyleSheet.create({ <span class="hljs-attr"><span class="hljs-attr">container</span></span>: { <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> }, }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Container</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{styles.container}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Lorem ipsum... </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Container</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre> <br><br>  Nous voyons le nouveau composant AppFooter que nous devons cr√©er.  Nous allons dans le dossier ./components/ et cr√©ons le fichier AppFooter.js avec le contenu suivant: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Footer, FooterTab, Button, Text} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooter = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> AppFooter;</code> </pre><br>  Tout est pr√™t pour essayer de construire notre application! <br><br>  Nos boutons ne savent pas encore comment basculer.  Il est temps de leur enseigner.  Pour ce faire, vous devez faire deux choses: apprendre √† g√©rer l'√©v√©nement click et apprendre √† stocker l'√©tat.  Commen√ßons par l'√âtat.  Comme nous avons refus√© de stocker l'√©tat dans le composant, ayant opt√© pour des composants purs et un magasin global, nous utiliserons Redux. <br><br>  Tout d'abord, nous devons cr√©er notre c√¥t√©. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {createStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = {}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore(reducers, initialState);</code> </pre><br>  Cr√©ons un blanc pour les r√©ducteurs.  Dans le dossier des r√©ducteurs, cr√©ez le fichier index.js avec le contenu suivant: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> (state = [], action) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-attr"><span class="hljs-attr">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } };</code> </pre><br>  Connectez les r√©ducteurs √† App.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> reducers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducers'</span></span>;</code> </pre><br>  Maintenant, nous devons distribuer notre magasin sur les composants.  Cela se fait en utilisant sp√©cifiquement le composant Provider.  Nous le connectons au projet: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Provider} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>;</code> </pre><br>  Et enveloppez tous les composants dans un fournisseur.  App.js mis √† jour ressemble √† ceci: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Container, Content} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {StyleSheet, Text, View} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {createStore} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Provider} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> reducers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./reducers'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = {}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore(reducers, initialState); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> styles = StyleSheet.create({ <span class="hljs-attr"><span class="hljs-attr">container</span></span>: { <span class="hljs-attr"><span class="hljs-attr">padding</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> }, }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> App = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Provider</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">store</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{store}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Container</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{styles.container}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> Lorem ipsum... </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Content</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Container</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Provider</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App;</code> </pre><br>  Maintenant, notre application peut stocker son √©tat.  Profitons de cela.  Nous ajoutons l'√©tat du mode, d√©fini par d√©faut sur ARTICLES.  Cela signifie que lors du premier rendu, notre application sera configur√©e pour afficher la liste des articles. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: <span class="hljs-string"><span class="hljs-string">'ARTICLES'</span></span> };</code> </pre><br>  Pas mal, mais l'√©criture manuelle de valeurs de cha√Æne entra√Æne des erreurs potentielles.  Obtenons des constantes.  Cr√©ez un fichier ./constants/index.js avec le contenu suivant: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> MODES = { <span class="hljs-attr"><span class="hljs-attr">ARTICLES</span></span>: <span class="hljs-string"><span class="hljs-string">'ARTICLES'</span></span>, <span class="hljs-attr"><span class="hljs-attr">PODCAST</span></span>: <span class="hljs-string"><span class="hljs-string">'PODCAST'</span></span> };</code> </pre><br>  Et r√©√©crivez App.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {MODES} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./constants'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> initialState = { <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: MODES.ARTICLES };</code> </pre><br>  Eh bien, il y a un √©tat, il est temps de le passer au pied de page.  Jetons un autre regard sur nos ./components/AppFooter.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Footer, FooterTab, Button, Text} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooter = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> AppFooter;</code> </pre><br>  Comme nous pouvons le voir, l'√©tat du commutateur est d√©termin√© √† l'aide de la propri√©t√© active du composant Button.  Poussons l'√©tat actuel de l'application sur Button.  Ce n'est pas difficile, le composant principal de la hotte est le composant Provider que nous avons connect√© plus t√¥t.  Il ne reste plus qu'√† en prendre l'√©tat actuel et √† mettre les composants AppFooter dans les propri√©t√©s (accessoires).  Tout d'abord, nous modifions notre AppFooter pour que l'√©tat des boutons puisse √™tre contr√¥l√© en passant le mode via des accessoires: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Footer, FooterTab, Button, Text} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {MODES} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../constants"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooter = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{mode = MODES.ARTICLES}</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mode</span></span></span></span><span class="xml"><span class="hljs-tag"> === </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">MODES.ARTICLES}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mode</span></span></span></span><span class="xml"><span class="hljs-tag"> === </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">MODES.PODCAST}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">FooterTab</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Footer</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> AppFooter;</code> </pre><br>  Commen√ßons maintenant √† cr√©er un conteneur.  Cr√©ez le fichier ./containers/AppFooterContainer.js. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {MODES} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../constants"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooterContainer = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{MODES.ARTICLES}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ); export default AppFooterContainer;</span></span></code> </pre> <br>  Et connectez le conteneur AppFooterContainer dans App.js au lieu du composant AppFooter.  Jusqu'√† pr√©sent, notre conteneur n'est pas diff√©rent du composant, mais tout changera d√®s que nous le connecterons √† l'√©tat de l'application.  Faisons-le! <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {connect} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapStateToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: state.mode }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooterContainer = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{mode}</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mode}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ); export default connect( mapStateToProps )(AppFooterContainer);</span></span></code> </pre><br>  Tr√®s fonctionnel!  Toutes les fonctionnalit√©s sont devenues propres.  Que se passe-t-il ici?  Nous connectons notre conteneur √† l'√©tat √† l'aide de la fonction connect et connectons ses accessoires au contenu de l'√©tat global √† l'aide de la fonction mapStateToProps.  Tr√®s propre et magnifique. <br><br>  Nous avons donc appris √† r√©partir les donn√©es de haut en bas.  Maintenant, nous devons apprendre √† changer notre √©tat mondial de bas en haut.  Les actions sont con√ßues pour g√©n√©rer des √©v√©nements sur la n√©cessit√© de changer l'√©tat global.  Cr√©ons une action qui se produit lorsqu'un bouton est cliqu√©. <br><br>  Cr√©ez le fichier ./actions/index.js: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SET_MODE } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./actionTypes'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> setMode = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">mode</span></span></span><span class="hljs-function">) =&gt;</span></span> ({<span class="hljs-attr"><span class="hljs-attr">type</span></span>: SET_MODE, mode});</code> </pre><br>  Et le fichier ./actions/actionTypes, dans lequel nous allons stocker les constantes avec les noms d'actions: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SET_MODE = <span class="hljs-string"><span class="hljs-string">'SET_MODE'</span></span>;</code> </pre><br>  L'action cr√©e un objet avec le nom de l'√©v√©nement et l'ensemble de donn√©es qui accompagnent cet √©v√©nement, et rien de plus.  Nous allons maintenant apprendre √† g√©n√©rer cet √©v√©nement.  Nous revenons au conteneur AppFooterContainer et connectons la fonction mapDispatchToProps qui connectera les r√©partiteurs d'√©v√©nements aux accessoires du conteneur. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AppFooter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../components/AppFooter.js'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {connect} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-redux'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {setMode} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapStateToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: state.mode }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mapDispatchToProps = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dispatch</span></span></span><span class="hljs-function">) =&gt;</span></span> ({ setMode(mode) { dispatch(setMode(mode)); } }); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooterContainer = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{mode, setMode}</span></span></span><span class="hljs-function">) =&gt;</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">AppFooter</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{mode}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">setMode</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{setMode}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ); export default connect( mapStateToProps, mapDispatchToProps )(AppFooterContainer);</span></span></code> </pre><br>  Eh bien, nous avons une fonction qui d√©clenche l'√©v√©nement SET_MODE et nous l'avons ignor√© dans le composant AppFooter.  Deux probl√®mes demeurent: <br><br>  Personne n'appelle cette fonction. <br>  Personne n'√©coute l'√©v√©nement. <br><br>  Nous allons traiter le premier probl√®me.  Nous allons au composant AppFooter et connectons l'appel √† la fonction setMode. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {Footer, FooterTab, Button, Text} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'native-base'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> {MODES} <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"../constants"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> AppFooter = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{mode = MODES.ARTICLES, setMode = (</span></span></span><span class="hljs-function">) =&gt;</span></span> {}}) =&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;Footer&gt; &lt;FooterTab&gt; &lt;Button active={mode === MODES.ARTICLES} onPress={ (</span></span></span><span class="hljs-function">) =&gt;</span></span> setMode(MODES.ARTICLES)}&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/Button&gt; &lt;Button active={mode === MODES.PODCAST} onPress={ () =&gt; setMode(MODES.PODCAST)}&gt; &lt;Text&gt;&lt;/</span></span>Text&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/FooterTab&gt; &lt;/</span></span>Footer&gt; ); <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> AppFooter;</code> </pre><br>  Maintenant, lorsque le bouton est enfonc√©, l'√©v√©nement SET_MODE sera d√©clench√©.  Il reste √† apprendre comment changer l'√©tat global √† mesure qu'il se pr√©sente.  Nous allons dans le ./reducers/index.js pr√©c√©demment cr√©√© et cr√©ons un r√©ducteur pour cet √©v√©nement: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SET_MODE } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/actionTypes'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> (state = [], action) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (action.type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> SET_MODE: { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign({}, state, { <span class="hljs-attr"><span class="hljs-attr">mode</span></span>: action.mode }); } <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state } };</code> </pre><br>  Super!  Maintenant, cliquer sur le bouton g√©n√®re un √©v√©nement qui modifie l'√©tat global et le pied de page, apr√®s avoir re√ßu ces modifications, redessine les boutons. <br><br></div></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Article original</a> <br>  Vrai, incroyablement simple?  Il est effrayant d'imaginer combien de programmeurs meurent de vieillesse sur des projets React Native et combien d'argent est pay√© pour toute cette honte.  Le r√©sultat de tout cela est un petit exemple, un peu plus compliqu√© que Hello World. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pu/a8/at/pua8at2kpzufujza3a9kpzmvzqc.png"></div><br>  Une fois apr√®s le programme de concert de l'album "... Et Justice pour tous" en 1988, le leader de Metallica, James Hetfield, a d√©clar√©: "C'est ainsi ... mais il est impossible de jouer vivant."  Donc, apr√®s avoir √©crit l'exemple de code sur React Native, je suis devenu solidaire de James - c'est-√†-dire ... mais il est impossible d'√©crire vivant! <br><br>  Et voici comment la m√™me chose se fait en utilisant le framework Kivy: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.factory <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Factory <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.lang <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Builder Builder.load_string(<span class="hljs-string"><span class="hljs-string">""" &lt;MyButton@Button&gt;: background_down: 'button_down.png' background_normal: 'button_normal.png' color: 0, 0, 0, 1 bold: True on_press: self.parent.parent.ids.textEdit.text = self.text; \ self.color = [.10980392156862745, .5372549019607843, .996078431372549, 1] on_release: self.color = [0, 0, 0, 1] &lt;MyActivity@BoxLayout&gt;: orientation: 'vertical' TextInput: id: textEdit BoxLayout: size_hint_y: None height: dp(45) MyButton: text: '' MyButton: text: '' """</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Program</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(App)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> my_activity = Factory.MyActivity() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> my_activity Program().run()</code> </pre><br>  C'est si simple que m√™me les commentaires sont redondants ici. <br><br>  Oui, vous ne le saviez peut-√™tre pas, mais tout est √©crit en Kivy: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vimeo.com/29348760</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vimeo.com/206290310</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vimeo.com/25680681</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.youtube.com/watch?v=u4NRu7mBXtA</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.youtube.com/watch?v=9rk9OQLSoJw</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.youtube.com/watch?v=aa9LXpg_gd0</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.youtube.com/watch?v=FhRXAD8-UkE</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.youtube.com/watch?v=GJ3f88ebDqc&amp;t=111s</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.youtube.com/watch?v=D_M1I9GvpYs</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.youtube.com/watch?v=VotPQafL7Nw</a> <br><br>  En conclusion, je donne une vid√©o de l'application: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/-gfwyi7TgLI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  √âcrivez dans les commentaires quels articles vous aimeriez voir sur Kivy sur les pages de Habr.  Si possible, tous les souhaits seront r√©alis√©s.  A bient√¥t, dzzya! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr414353/">https://habr.com/ru/post/fr414353/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414343/index.html">Traduction automatique de neurones de Google</a></li>
<li><a href="../fr414345/index.html">D√©veloppement inverse de la minuterie VL-76-S</a></li>
<li><a href="../fr414347/index.html">Agression passive: comment elle d√©truit notre vie professionnelle et comment y faire face</a></li>
<li><a href="../fr414349/index.html">Obtenez les statistiques de co√ªts du MCC: Tinkoff et Rocketbank</a></li>
<li><a href="../fr414351/index.html">Instruments de musique les plus insolites: orgue Hammond, orchestre Vako et Synclavier</a></li>
<li><a href="../fr414355/index.html">La vie apr√®s l'explosion</a></li>
<li><a href="../fr414357/index.html">Nous utilisons l'API Web Bluetooth pour connecter le moniteur de fr√©quence cardiaque et d√©velopper l'application √† l'aide de Vue.js</a></li>
<li><a href="../fr414359/index.html">Interaction avec le serveur via l'API dans iOS sur Swift 3. Partie 1</a></li>
<li><a href="../fr414361/index.html">Unity3D: architecture de jeu, objets scriptables, singletones</a></li>
<li><a href="../fr414363/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 319 (11-17 juin 2018)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>