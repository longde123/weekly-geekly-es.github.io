<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💌 🚾 📥 دمج محرك HTML في تطبيق Windows الأصلي - الاختيار والبنية ⚠️ 🆖 🏓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="كيف ترجمنا العمل مع HTML في 1C: Enterprise من Internet Explorer إلى WebKit 

 ظهرت القدرة على عرض HTML في نماذج 1C في النظام الأساسي 1C: Enterprise في...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>دمج محرك HTML في تطبيق Windows الأصلي - الاختيار والبنية</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/1c/blog/425713/" style=";text-align:right;direction:rtl">  <b>كيف ترجمنا العمل مع HTML في 1C: Enterprise من Internet Explorer إلى WebKit</b> <br><br>  ظهرت القدرة على عرض HTML في نماذج 1C في النظام الأساسي 1C: Enterprise في عام 2003 ، الإصدار 8.0.  للعمل مع HTML ، استخدم النظام الأساسي محرك المتصفح Internet Explorer (1C: Enterprise في ذلك الوقت كان يعمل فقط مع Windows).  تم استخدام محرك المتصفح من قبل النظام الأساسي لأغراض نفعية.  على سبيل المثال ، للكتابة من الصفر <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">عنصر</a> كامل لتحرير النص بكلمة - مع إمكانية حلول الألوان والخطوط المختلفة ، وإدراج الصور ، وما إلى ذلك.  - مهمة صعبة للغاية.  وإذا كنت تستخدم HTML لهذه الأغراض وتستخدم محرك متصفح الإنترنت كأداة للعرض ، فإن المهمة تكون مبسطة إلى حد كبير.  أيضًا ، بمساعدة المحرك ، تم تنفيذ عدد من الآليات الأخرى (على سبيل المثال ، عرض <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">معلومات المساعدة</a> ) والعناصر (على سبيل المثال ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">المجدول</a> ). <br><br>  حسنًا ، جعلت قدرة مطوري التطبيقات على العرض باستخدام تصميم HTML المخصص وفقًا لمعايير عالم أنظمة المحاسبة في بعض الأحيان من الممكن تقديم مجموعة متنوعة من الميزات الرائعة إلى واجهة تطبيقات الأعمال. <br><br>  مع مرور الوقت ، بدأت المنصة في دعم Linux أولاً ، ثم macOS.  لم يكن Internet Explorer مناسبًا للعمل مع HTML في أنظمة التشغيل هذه لأسباب واضحة ؛  في Linux ، استخدمنا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">WebKitGTK +</a> ، وعلى macOs ، مكتبة قائمة على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الكاكاو</a> .  وبالتالي ، تم انتهاك وحدة قاعدة الرموز لأنظمة التشغيل المختلفة (التي نحاول الحفاظ عليها لرمز العميل عند مستوى 95٪) في هذا المجال.  حسنًا ، أصبح محرك IE في هذا الوقت مصدرًا لعدد من المشاكل. <br><img src="https://habrastorage.org/webt/xo/c6/2k/xoc62k11ifqv9dfeunr279csd4q.png" alt="الصورة"><br><a name="habracut"></a><br>  المشاكل: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يحتوي محرك IE على رمز مصدر مغلق - وهذا يعني: <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  التعديل المرن للمحرك مع احتياجات المنصة غير ممكن </li><li style=";text-align:right;direction:rtl">  تصحيح وفهم العمليات بالداخل </li><li style=";text-align:right;direction:rtl">  لا يمكن إصلاح الأخطاء والأخطاء عن طريق تحديث إصدار المحرك </li></ul></li><li style=";text-align:right;direction:rtl">  المحرك غير مناسب لتنفيذ مهام برمجة الويب الحديثة </li><li style=";text-align:right;direction:rtl">  مشاكل الأداء على الأجهزة الضعيفة </li></ul><br>  لذا ، كانت ترجمة العمل باستخدام HTML في الإصدار 1C: Enterprise for Windows من محرك IE إلى شيء آخر واضحة.  ماذا تختار؟ <br><br>  بادئ ذي بدء ، قمنا بصياغة متطلبات المحرك: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  دعم تقنيات برمجة الويب الحديثة </li><li style=";text-align:right;direction:rtl"> مصدر مفتوح للتخصيص المرن للمحرك وفهم منطقه </li><li style=";text-align:right;direction:rtl">  أداء عالي على أجهزة الكمبيوتر البطيئة </li><li style=";text-align:right;direction:rtl">  من المستحسن أن يتطلب المحرك عددًا صغيرًا من مكتبات الجهات الخارجية للعمل </li></ul><br><h2 style=";text-align:right;direction:rtl">  اختيار المحرك </h2><br>  ماذا تختار من؟  بدأنا ، بالطبع ، مع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">WebKit</a> ، والذي عملنا معه بالفعل في إصدارات النظام الأساسي لنظامي التشغيل Linux و macOS. <br><br>  تم تطوير WebKit في Apple في أوائل العقد الأول من القرن الحالي بناءً على محركات المصدر المفتوح <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">KHTML</a> و <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">KJS</a> .  بناءً على WebKit ، تم إنشاء متصفح Safari ، لاحقًا - Chrome (حتى تحول Chrome لاحقًا من WebKit إلى <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Blink</a> ، والذي يعتمد مرة أخرى على رمز WebCore من WebKit). <br><br>  كود المصدر ل WebKit مفتوح المصدر ومرخص بموجب <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">LGPL</a> .  تمت كتابة WebKit لنظام التشغيل macOS ، وهناك العديد من المنافذ لنظام التشغيل Windows: <br><br><h3 style=";text-align:right;direction:rtl">  WebKit AppleWin </h3><br>  هذا هو المنفذ الذي يقترح مطورو WebKit بناءه تحت Windows بشكل افتراضي.  تم صنعه من قبل موظفي Apple في منتصف إلى أواخر 2000s.  يستخدم مكتبة رسومات <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CoreGraphics</a> ، وهي نسخة مبسطة من المكتبة لنظام macOS ، والتي يتم نقلها إلى Windows.  لتنفيذ جافا سكريبت ، يستخدم المنفذ مكتبة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">JavaScriptCore</a> بنفس واجهة برمجة التطبيقات المستخدمة في تنفيذ النظام الأساسي لنظام Linux.  هذا يجعلها المرشح الرئيسي للاستخدام. <br><br><h3 style=";text-align:right;direction:rtl">  WebKit WinCairo </h3><br>  يستخدم هذا الميناء مكتبة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">القاهرة</a> للرسومات.  لبعض الوقت ، تعمل Apple بنشاط على تطوير هذا المنفذ كنظير لمنفذ AppleWin الرئيسي.  تتمثل ميزة هذا المنفذ في أنه أقل اعتمادًا على مكتبات macOS الخاصة التي تتطلبها CoreGraphics.  بالإضافة إلى ذلك ، يستخدم المنفذ نفس مكتبة الرسومات ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">القاهرة</a> ) مثل محرك WebKitGTK + ، والذي نستخدمه في تنفيذ Linux للنظام الأساسي ، وهو أمر جيد لتوحيد سلوك رمزنا. <br><br><h3 style=";text-align:right;direction:rtl">  QtWebKit </h3><br>  تطبيق آخر لمحرك WebKit لنظام التشغيل Windows ، أصبح الآن مستقلاً عن مطوري المحرك نفسه.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Qt</a> هي مكتبة شعبية عبر الأنظمة الأساسية مع مكتبة رسومات QtGui الخاصة بها.  يستخدم هذا المنفذ أيضًا مكتبة JavaScriptCore للتعامل مع JavaScript ، ولكن له عيوبه: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  اعتماد قوي على المكونات الرئيسية لـ Qt ، والتي ، إذا تم استخدامها في برامج الجهات الخارجية ، ستحتاج إلى تسليمها معها </li><li style=";text-align:right;direction:rtl">  مجموعة مختلفة من الواجهات للعمل مع مكونات عرض HTML مقارنة بـ WebKitGTK والمنطق الخاص بها للعمل معهم. </li></ul><br><h3 style=";text-align:right;direction:rtl">  WebKitGtk + لنظام التشغيل Windows </h3><br>  لقد استخدمنا بالفعل WebKitGtk + في إصدار Linux من النظام الأساسي.  ولكن تم استبعاد خيار استخدامه في Windows بسبب تعقيد التجميع وضعف التوثيق لهذه العملية وعدم وجود دعم مستمر لمجال التطوير هذا من مطوري WebKitGTK +. <br><br><h3 style=";text-align:right;direction:rtl">  Chromium (Blink) </h3><br>  المحرك الأول والوحيد الذي لا يشبه WebKit ، والذي تم اعتباره مرشحًا لحل المشكلة.  تم رفضه بسبب الاختلافات الكبيرة في منطق مكونات عرض HTML مقارنة بـ WebKitGTK + ومكتبة أخرى للعمل مع JavaScript ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">V8</a> ). <br><br><h3 style=";text-align:right;direction:rtl">  ماذا تختار؟ </h3><br>  بعد البحث ، وصل AppleWin و WinCairo إلى النهائيات. <br>  لإجراء الاختيار النهائي ، درسنا كيفية عمل WebKit. <br><br><h2 style=";text-align:right;direction:rtl">  هيكل محرك WebKit </h2><br>  عادةً ما تختلف منافذ WebKit المختلفة بطريقتين.  الأول هو التنفيذ المباشر لنظام تشغيل معين باستخدام مكونات خاصة بنظام التشغيل.  والثاني هو مكتبة رسومات.  يوضح الشكل أدناه الاختلافات في هذا المعنى بين منافذ WebKit.  بالنسبة إلى Windows ، كتب مطورو WebKit منافذ على CoreGraphics والمكتبة في القاهرة. <br><br><img src="https://habrastorage.org/webt/y5/m5/mo/y5m5moefn2yjpbt4ohq9iwqqqj4.png" alt="الصورة"><br><br>  نموذج مبسط للمحرك: يتم تغذية ثلاث آليات تقليدية لتنسيق صفحة الويب - HTML و JavaScript و CSS - إلى المحرك ، وتقوم بتشكيل وعرض الصفحة منها: <br><br><img src="https://habrastorage.org/webt/j4/2n/r5/j42nr5vmxoryxsbq-c_mxe9oots.png" alt="الصورة"><br><br>  يتكون المحرك نفسه من عدة مكونات: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  WTF (Web Template Framework ، وليس ما قد تعتقده): هنا تجد تطبيقاتك الخاصة لهياكل البيانات لتشغيل المحرك ، بالإضافة إلى العمل مع التدفقات </li><li style=";text-align:right;direction:rtl">  JavaScriptCore: مكون ، كما يوحي الاسم ، للعمل مع لغة JavaScript </li><li style=";text-align:right;direction:rtl">  WebCore: كل العمل مع DOM ، الأنماط ، تحليل HTML و XML مكتوب هنا.  كل "السحر" الرئيسي للمحرك يتم هنا. </li><li style=";text-align:right;direction:rtl">  النظام الأساسي: ينفذ الإجراءات التقنية للتفاعل مع الشبكة ، ووضع البيانات في قاعدة بيانات ، وفك تشفير الصور ، والعمل مع الوسائط </li><li style=";text-align:right;direction:rtl">  WebKit و WebKit2 API - ربط جميع المكونات وتوفير الوصول إليها </li></ul><br><img src="https://habrastorage.org/webt/ao/zr/gp/aozrgpbezfy8ex2ufhbnrzqf68e.png" alt="الصورة"><br>  يوضح الشكل التالي العلاقة بين مكونات WebKit والميزات الخاصة بنظام التشغيل.  كما ترى ، هناك بعض النقاط المحددة التي يجب تنفيذها لكل نظام تشغيل على حدة.  على الرغم من أن JavaScriptCore يسمح لك باستخدام نفسك في كل منفذ دون تنفيذ منفصل. <br><br><img src="https://habrastorage.org/webt/r7/hz/c8/r7hzc8sbq6bcn_qpltvdzpimugu.png" alt="الصورة"><br><br><h3 style=";text-align:right;direction:rtl">  كيف يتم تكوين صفحة الويب </h3><br>  من الشبكة ، يأتي الرد على طلب إلى الخادم ببيانات لتنزيلها.  يقوم المُحمل بتمرير البيانات إلى المحلل اللغوي ، الذي يتفاعل مع مكون JavaScript ، ويشكل DOM وورقة النمط.  بعد ذلك ، يتم نقل البيانات التي تم إنشاؤها إلى شجرة العرض وعرضها في سياق رسومي. <br><img src="https://habrastorage.org/webt/k-/id/dh/k-iddhrnyvvcw8yzacaigtetlai.png" alt="الصورة"><br>  تتكون الصفحة نفسها أيضًا من مكونات فردية.  يقوم مكون WebCore بتطبيق فئة الصفحة ، مما يسمح بالوصول إلى الصفحة بأكملها.  تحتوي الصفحة على إطار رئيسي - MainFrame ، يحتوي الإطار دائمًا على مستند.  يمكن أن يحتوي الإطار الرئيسي على أي عدد من الإطارات الأخرى ، مع وجود مستندات بداخله أيضًا.  لكل إطار ، يتم تكوين بعض الأحداث بشكل منفصل ، بالإضافة إلى سياقات بيانية وجافا سكريبت محددة. <br><br><img src="https://habrastorage.org/webt/zv/fo/9c/zvfo9cqiclfhckd1wmzpnnv4jx4.png" alt="الصورة"><br><br>  يعمل محلل HTML المبسط مثل هذا.  من مجموعة وحدات البايت المستلمة من الخادم ، يقوم مفكك التشفير بإنشاء مجموعة من الأحرف للتحليل.  يتم تحويل الرموز إلى رموز مميزة أو رموز مميزة ، والتي عادة ما تكون قطعًا أولية من التعليمات البرمجية مع معلومات وصفية حول نوع النص ، سواء كان جزءًا من بنية اللغة أو المحتوى.  ثم يتم تشكيل العقد من الرموز لبناء شجرة DOM.  يشكل منشئ الشجرة من مجموعة من العقد نموذج كائن كامل لمستند صفحة ويب. <br><br><img src="https://habrastorage.org/webt/iq/9q/b5/iq9qb5qwciws_d-rfzze2afuopw.png" alt="الصورة"><br><br><h2 style=";text-align:right;direction:rtl">  الاختيار النهائي </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Applewin <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  الإيجابيات: <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  تم تنفيذه على مكتبة رسومات تعمل على نظام macOS - النظام الأساسي المستهدف لمطوري WebKit </li></ul></li><li style=";text-align:right;direction:rtl">  السلبيات: <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  عدم تنفيذ آلية الطباعة </li><li style=";text-align:right;direction:rtl">  عدد كبير من التبعيات </li></ul></li></ul></li><li style=";text-align:right;direction:rtl">  Wincairo <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  الإيجابيات: <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  مكتبة الرسومات نفسها (القاهرة) ، كما هو مستخدم في منفذ Linux لمنصة 1C </li></ul></li><li style=";text-align:right;direction:rtl">  السلبيات: <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ضروري لمهامنا غير موجود </li></ul></li></ul></li></ul><br>  هزم WinCairo.  من أجل التطوير ، تم استخدام أحدث إصدار من WebKit المتاح في ذلك الوقت - 605.1.11. <br><br><h2 style=";text-align:right;direction:rtl">  التنفيذ </h2><br>  على الرغم من تغطية المحرك جيدًا من خلال اختبارات الوحدة (حوالي 30.000 لجميع مكونات المحرك ، التي كتبها مؤلفو المحرك) ، هناك أخطاء وعيوب في عمليات التنفيذ لأنظمة التشغيل "غير الأساسية" (أي لكل ما هو ليس macOS).  تم اكتشاف فجوات التنفيذ هذه تدريجيًا أثناء تطوير المحرك واختباره كجزء من النظام الأساسي 1C: Enterprise. <br><br><h3 style=";text-align:right;direction:rtl">  قم بتنزيل HTML عبر السحب والإفلات </h3><br>  عند سحب النص إلى النافذة ، تم العثور على أنه إذا كان النص الذي يتم سحبه يحتوي على أحرف غير ASCII ، يتم إدراج الحروف الهيروغليفية في المستند النهائي.  ظهر الخطأ فقط في تطبيق Windows للمحرك ، لأنه يعمل مع آلية خاصة بنظام التشغيل لسحب العناصر وإفلاتها.  اتضح أن النص لم يتم فك ترميزه من UNICODE إلى UTF-16 قبل تمريره إلى معالج حدث الإدراج. <br><br><h3 style=";text-align:right;direction:rtl">  قم بتغيير Shift + أدخل سلوك لوحة المفاتيح </h3><br>  في معظم برامج تحرير النصوص (بما في ذلك Microsoft Word) ، تُدخل هذه المجموعة فاصل أسطر.  السلوك القياسي لـ WebKit هو إدراج فقرة جديدة (كما لو كان ببساطة الضغط على Enter).  قمنا بتغيير المحرك ، مما جعل السلوك أكثر دراية للمستخدمين. <br><br><h3 style=";text-align:right;direction:rtl">  تنظيم آلية التراجع والإعادة. </h3><br>  يوفر WebKit واجهة برمجة تطبيقات لتنفيذ آليته الخاصة لإلغاء إجراءات المستخدم وتكرارها.  مخططها هو كما يلي: عندما يقوم المستخدم بإجراء معين منفصل من وجهة نظر المحرك (على سبيل المثال ، التحول إلى فقرة جديدة ، التنسيق بخط مائل ، لصق) ، يقوم WebKit بإبلاغ المطور حول هذا باستخدام واجهة برمجة التطبيقات حتى يتمكن من تسجيل هذا الإجراء. <br><br>  في عملية اختبار الآلية المنفذة ، تم اكتشاف شيء غير سار: المحرك لا يبلغ عن التغييرات في هيكل الجداول.  تمت إضافة أوامر لإضافة الخلايا وإزالتها وتغيير سمة colSpan ، والتي أصبحت جزءًا من الإجراءات المركبة ، مثل ، على سبيل المثال ، إضافة / إزالة عمود أو صف في جدول.  يتم تسجيل هذه الأوامر المركبة في نفس مجموعة التراجع والإعادة ، بالإضافة إلى الأوامر من المحرك تضمن التشغيل الصحيح للآلية. <br><br><h3 style=";text-align:right;direction:rtl">  لصق من Excel </h3><br>  قد يعلم أولئك الذين عملوا مع حافظة Windows و Excel أنه ، أولاً ، عند النسخ من Excel إلى HTML ، فإن تنسيق الحافظة في الجزء المنسوخ يحتوي فقط على علامات الخلايا والصفوف ، ولكن ليس علامة الجدول نفسه ، وثانيًا ، لا يتم نقل الأنماط من مستند Excel إلى الخلايا.  ولهذا السبب ، فإن إدراج جدول ألوان ، على سبيل المثال ، في عنصر قابل للتعديل في Chrome يبدو كما يلي: <br><br>  الأصل: <br><br><img src="https://habrastorage.org/webt/gp/qu/fd/gpqufdcqtefrrio5zechwq0ufus.png" alt="الصورة"><br><br>  في Chrome: <br><br><img src="https://habrastorage.org/webt/gf/6y/uu/gf6yuuqrxmu8il-7bgoeql7xtwy.png" alt="الصورة"><br><br>  لم يأخذ مطورو WebKit كلا هذين العاملين في الاعتبار.  سمح لنا انفتاح رمز المحرك بتحسين آلية الإدراج ، والآن أصبح جزء الجدول المدرج في حقل HTML للمستند قريبًا من الأصل: <br><br><img src="https://habrastorage.org/webt/l8/pi/bo/l8piboap1-odjv6iwb2jd4zdhim.png" alt="الصورة"><br><br><h3 style=";text-align:right;direction:rtl">  جيل الخط المائل </h3><br>  إذا لم يكن لدى Windows إصدار مائل من خط غير قياسي ، فيمكن لمعظم محرري النصوص إنشاء مثل هذا الخط باستخدام نسخته العادية.  ومع ذلك ، لم يكن WebKit يعرف كيفية القيام بذلك وضلل المطورين بضع مرات: كيف وضعنا النص في علامة &lt;i&gt; في كود HTML الخاص بالمستند ، ولكن على الرغم من ذلك ظل النص مستقيماً.  السبب هو أن محرك WebKit يختار الخط المطلوب في منفذ WinCairo الذي نستخدمه - إذا لم يكن هناك إصدار مائل ، فإن المحرك يستخدم الإصدار العادي.  تم استبدال هذا السلوك باستخدام الخط المائل الذي تم إنشاؤه بواسطة مكتبة رسومات القاهرة. <br><br><h3 style=";text-align:right;direction:rtl">  أخطاء في فك تشفير الصور والرسوم المتحركة </h3><br>  تم العثور على أخطاء في سلوك المحرك عند العمل مع العناصر الرسومية.  عند تحميل بعض الصور بتنسيق PNG ، لوحظ تشويه الصورة ، وأحيانًا غيابه على الإطلاق.  لم يكن من الممكن معرفة سبب هذا السلوك ، حيث حدث خطأ عند فك تشفير الصور في أحشاء مكتبة libpng. <br><br>  تجريبياً ، وجد أنه عند ربط مكتبة libpng بطريقة ديناميكية بدلاً من ثابتة ، يتم إصلاح المشكلة.  بالمناسبة ، في الإصدار الحالي من المحرك ، يتم الربط بهذه الطريقة.  تقرر أن تفعل الشيء نفسه. <br><br>  كانت المشكلة الأخرى هي المحرك عند تحميل الرسوم المتحركة بتنسيق GIF.  تم تكرار الخطأ بشكل دوري عند تحميل الصفحة بمثل هذه الرسوم المتحركة وأدى إلى تعطل البرنامج.  حدث الخطأ بسبب عدم التزامن عند العمل مع المخزن المؤقت الذي يتم وضع الإطار التالي من الصورة المتحركة فيه.  تم حل المشكلة باستخدام أدوات مزامنة WebKit الداخلية. <br><br><h3 style=";text-align:right;direction:rtl">  الدعم الإملائي </h3><br>  في التجميع مع Internet Explorer ، في Windows الإصدار 8 والإصدارات الأحدث ، يمكن تمكين التدقيق الإملائي لحقل HTML القابل للتحرير.  للقيام بذلك ، كان يكفي أن ينسب "التدقيق الإملائي" يساوي "صحيح".  لدى WebKit حلول مختلفة لمنافذ مختلفة: في Linux ، توجد مكتبة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Enchant</a> ، على macOS لديها آلية خاصة بها ، مألوفة لجميع مستخدمي منتجات Apple.  ولكن بالنسبة لنظام التشغيل Windows ، لا يوجد تطبيق ، ولكن يتم توفير واجهة برمجة التطبيقات (API) لحلها الخاص.  استخدمنا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Windows Spell Checking API</a> ، المتوفر بدءًا من Windows 8 ، وقمنا بتطبيق آلية مماثلة للبناء باستخدام Internet Explorer.  بالمناسبة ، الآن في مستند منسق في 1C الأصلي: عملاء Enterprise تعمل هذه الوظيفة أيضًا.  قبل الإصدار 8.3.14 ، تم تعطيله بسبب ضعف أداء Internet Explorer. <br><br><h3 style=";text-align:right;direction:rtl">  دعم نظام التشغيل Windows XP </h3><br>  لا يزال بعض عملائنا يعملون على نظام التشغيل Windows XP ، ولن يقوموا بترقية نظام التشغيل في المستقبل القريب.  محزن لنا كمطورين ، لكنه صحيح.  لذا - نحن بحاجة إلى دعمهم.  وهنا كانت لدينا مفاجأة غير سارة: لم يدعم مطورو WebKit لمدة عام المحرك في WinXP.  فشلت محاولة إنشاء نسخة من المحرك مع مجموعة من أدوات البناء لـ WinXP - يستخدم مطورو WebKit المكتبات المتوفرة فقط من Windows Vista والإصدارات الأحدث. <br><br>  ماذا تفعل  كانت الخيارات على النحو التالي: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  اترك تطبيق WinXP مع محرك Internet Explorer ، واستخدم WebKit في الإصدارات القديمة من Windows </li><li style=";text-align:right;direction:rtl">  خذ لتطوير إصدار سابق من محرك WebKit ، والذي يعمل في ويندوز إكس بي ، واستخدم هذا الإصدار في جميع أنظمة التشغيل </li><li style=";text-align:right;direction:rtl">  استخدم الإصدار المناسب من WebKit في WinXP ، واستخدم أحدث محرك في الإصدارات القديمة من Windows </li><li style=";text-align:right;direction:rtl">  قم بنقل الإصدار الحالي من المحرك إلى WinXP بنفسك واستخدمه في كل مكان </li></ol><br>  لم يكن السؤال بسيطا.  يتيح لك الخيار الأول استخدام أحدث إصدار من محرك WebKit ، ولكنه سيجبرك على إعادة التنفيذ القديم باستخدام Internet Explorer.  في مثل هذا الحل ، سيكون من الصعب ضمان تشغيل البرنامج بدون أخطاء ، وسيكون الرمز نفسه معقدًا للغاية.  قدم الخيار الثاني نفس السلوك في جميع أنظمة تشغيل Windows ، ومع ذلك ، فلن يترك لنا فرصة التطوير - تحديث المحرك لإصلاح الأخطاء والحصول على ميزات جديدة من مطوري المحرك في الإصدارات الأحدث.  يتيح لك الخيار الثالث استخدام الإصدار الحالي من المحرك في الإصدارات القديمة من Windows ، ولكنه يعقد بشكل كبير منطق التثبيت ويضمن نفس سلوك الإصدار في جميع أنظمة التشغيل.  بدا الخيار الرابع مفضلاً على جميع الخيارات الأخرى ، ولكن كان من المستحيل التنبؤ بالتعقيد وبشكل عام إمكانية مثل هذا الحل. <br><br>  ومع ذلك ، قررنا أن ننتهز الفرصة وننفذ الخيار الرابع ، وهو الأكثر صحة من وجهة نظر معمارية (باستخدام شفرة مصدر محرك واحد في جميع إصدارات Windows).  تعمل النسخة المنقولة من WebKit بشكل مختلف في WinXP والإصدارات الأحدث من Windows: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  اضطررت إلى التخلي عن أدوات DirectX الجديدة (d3d11) لصالح DirectX9 القديم (d3d9) وتكييف ملفات الرؤوس الخاصة بها مع الإصدار الأحدث من SDK. </li><li style=";text-align:right;direction:rtl">  يتم استدعاء وظائف SDK الجديدة ، عند تنفيذها على إصدارات جديدة من Windows ، على العنوان (الذي تم الحصول عليه من خلال <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GetProcAddress</a> ). </li><li style=";text-align:right;direction:rtl">  لنقل البيانات بين التدفقات في المحرك ، يستخدم WinXP التخزين المحلي لمؤشر الترابط ، في الإصدارات الجديدة - التخزين المحلي بالألياف. </li></ul><br><h2 style=";text-align:right;direction:rtl">  الملخص </h2><br>  لذا ، الآن في منصة 1C: Enterprise بدءًا من الإصدار 8.3.14 (الإصدار - نهاية 2018) سيتم دعم HTML على أعلى مستوى - HTML5 ، OpenGL ، إلخ.  كل من كمية ونوعية الزبيب التي يمكن اتخاذها في القرارات على منصتنا محدودة فقط من خلال خيال المطور.  ومع ذلك ، بالطبع ، نظام تشغيل العميل - على WinXP ، لن تعمل العديد من كعك HTML5 اللذيذ ، لأسباب واضحة. <br><br>  الآن على تطبيقات Windows على 1C: ستتمكن منصة Enterprise من إظهار هذا: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/zL6beG-cNEI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  ولكن ، باستخدام "مزايا" HTML في حلول التطبيقات ، لا تنسى الفطرة السليمة.  يعد استخدام HTML مناسبًا وموصى به للمهام المتخصصة (عرض المساعدة والتقنيات وأوصاف المنتج ، ...) ، ولكن ليس لتنفيذ مهام منطق الأعمال (إدخال / إخراج المعلومات المنظمة).  للقيام بذلك ، تحتاج إلى استخدام معيار 1C: آليات واجهة المؤسسة التي توفر الدعم التلقائي لحقوق الوصول ، وإدارة الوظائف ، والتكيف مع عامل شكل الجهاز ، ودعم إعدادات المستخدم ، وعمل العديد من الآليات الأخرى ، والتي بدونها يصبح التشغيل الكامل لتطبيق الأعمال مستحيلًا تقريبًا. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar425713/">https://habr.com/ru/post/ar425713/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar425703/index.html">كافكا في Wargaming: Blitz</a></li>
<li><a href="../ar425705/index.html">النسخ المتماثل من خادم بيرسونا لـ MySQL إلى PostgreSQL باستخدام أداة pg_chameleon</a></li>
<li><a href="../ar425707/index.html">نظام الإخطار من وحدة التحكم إلى Telegram</a></li>
<li><a href="../ar425709/index.html">قدمنا ​​مذكرة للصينيين الذين جاءوا إليك</a></li>
<li><a href="../ar425711/index.html">فقدان خط غير متطابق</a></li>
<li><a href="../ar425715/index.html">البرنامج التعليمي في الكيمياء: الانعكاس الحمضي للدوائر الدقيقة (كيفية فضح بلورة الدائرة الدقيقة لتصويرها اللاحق)</a></li>
<li><a href="../ar425717/index.html">الشبكة العصبية لمطوري C ++</a></li>
<li><a href="../ar425719/index.html">الكرفس في المشاريع المزدحمة: القليل من الممارسة</a></li>
<li><a href="../ar425723/index.html">يعمل Facebook بنشاط على تطوير خدمة للعثور على عمل وتوظيف موظفين في شبكة اجتماعية</a></li>
<li><a href="../ar425725/index.html">نينتندو براءات الاختراع - لعبة الصبي</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>