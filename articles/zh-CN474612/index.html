<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§‘ ğŸ“– ğŸ’‡ğŸ¾ EBAä½“ç³»ç»“æ„åˆç§°å…¨ååº”æ€§ ğŸ¤¾ğŸ¿ ğŸ‘¨ğŸ¿â€ğŸ¨ ğŸ’Ÿ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å‡ å¹´å‰ï¼Œæˆ‘æ¥åˆ°Tinkoffçš„ä¸€ä¸ªæ–°é¡¹ç›®â€œ Customers and Projectsâ€ ï¼ˆ å®¢æˆ·å’Œé¡¹ç›® ï¼‰åˆšåˆšå¼€å§‹ã€‚ 
 ç°åœ¨ï¼Œæˆ‘ä¸è®°å¾—å½“æ—¶å¯¹æˆ‘çš„æ–°æ¶æ„çš„æ„Ÿå—äº†ã€‚ ä½†æ˜¯æˆ‘å¯ä»¥è‚¯å®šåœ°è®°å¾—ï¼šåœ¨é€šå¸¸çš„ç½‘ç»œè®¿é—®å’ŒåŸºç¡€è®¿é—®ä¹‹å¤–ï¼Œåœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨Rxæ˜¯ä¸å¯»å¸¸çš„ã€‚ æ—¢ç„¶è¯¥ä½“ç³»ç»“æ„å·²ç»é€šè¿‡äº†ä¸€äº›å‘å±•çš„æ¼”è¿›è·¯å¾„ï¼Œé‚£...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>EBAä½“ç³»ç»“æ„åˆç§°å…¨ååº”æ€§</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/474612/"><p> å‡ å¹´å‰ï¼Œæˆ‘æ¥åˆ°Tinkoffçš„ä¸€ä¸ªæ–°é¡¹ç›®â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Customers and Projectsâ€</a> ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®¢æˆ·å’Œé¡¹ç›®</a> ï¼‰åˆšåˆšå¼€å§‹ã€‚ <br> ç°åœ¨ï¼Œæˆ‘ä¸è®°å¾—å½“æ—¶å¯¹æˆ‘çš„æ–°æ¶æ„çš„æ„Ÿå—äº†ã€‚ ä½†æ˜¯æˆ‘å¯ä»¥è‚¯å®šåœ°è®°å¾—ï¼šåœ¨é€šå¸¸çš„ç½‘ç»œè®¿é—®å’ŒåŸºç¡€è®¿é—®ä¹‹å¤–ï¼Œåœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨Rxæ˜¯ä¸å¯»å¸¸çš„ã€‚ æ—¢ç„¶è¯¥ä½“ç³»ç»“æ„å·²ç»é€šè¿‡äº†ä¸€äº›å‘å±•çš„æ¼”è¿›è·¯å¾„ï¼Œé‚£ä¹ˆæˆ‘æƒ³æœ€åè°ˆè°ˆå‘ç”Ÿäº†ä»€ä¹ˆä»¥åŠå‘ç”Ÿäº†ä»€ä¹ˆã€‚ </p><br><p><img src="https://habrastorage.org/webt/gk/ru/ve/gkruveswoxzhqfxjfasm_vaf2qq.png"></p><br><p> ä»¥æˆ‘çš„è§‚ç‚¹ï¼Œæ‰€æœ‰å½“å‰æµè¡Œçš„ä½“ç³»ç»“æ„-MVPï¼ŒMVVMç”šè‡³MVI-é•¿æœŸä»¥æ¥ä¸€ç›´å¤„äºèˆå°ä¸Šï¼Œå¹¶ä¸æ€»æ˜¯åº”æœ‰çš„ã€‚ ä»–ä»¬æ²¡æœ‰ç¼ºé™·å—ï¼Ÿ æˆ‘çœ‹åˆ°å¾ˆå¤šã€‚ æˆ‘ä»¬åœ¨è‡ªå·±çš„ä½ç½®å†³å®šè¶³ä»¥æ‰¿å—å®ƒï¼Œå¹¶ï¼ˆé‡æ–°ï¼‰å‘æ˜äº†ä¸€ç§æ–°çš„å¼‚æ­¥æ¶æ„ã€‚ </p><a name="habracut"></a><br><p> æˆ‘å°†ç®€è¦æè¿°æˆ‘å¯¹å½“å‰ä½“ç³»ç»“æ„ä¸æ»¡æ„çš„åœ°æ–¹ã€‚ æœ‰äº›è§‚ç‚¹å¯èƒ½ä¼šå¼•èµ·äº‰è®®ã€‚ ä¹Ÿè®¸æ‚¨ä»æœªé‡åˆ°è¿‡è¿™ç§æƒ…å†µï¼Œè€Œæ˜¯ç¼–å†™äº†å®Œç¾çš„ï¼Œé€šå¸¸æ¥è¯´æ˜¯ç»åœ°çš„ç¼–ç¨‹ã€‚ ç„¶ååŸè°…æˆ‘ï¼Œä¸€ä¸ªç½ªäººã€‚ <br> æ‰€ä»¥æˆ‘çš„ç—›è‹¦æ˜¯ï¼š </p><br><ul><li> å·¨å¤§çš„Presenter / ViewModelã€‚ </li><li>  MVIä¸­æœ‰å¤§é‡çš„å¼€å…³ç›’ã€‚ </li><li> æ— æ³•é‡ç”¨Presenter / ViewModelçš„æŸäº›éƒ¨åˆ†ï¼Œå› æ­¤ï¼Œéœ€è¦å¤åˆ¶ä»£ç ã€‚ </li><li> å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä¿®æ”¹çš„å¯å˜å˜é‡å †ã€‚ å› æ­¤ï¼Œè¿™ç§ä»£ç éš¾ä»¥ç»´æŠ¤å’Œä¿®æ”¹ã€‚ </li><li> æœªåˆ†è§£çš„å±å¹•æ›´æ–°ã€‚ </li><li> ç¼–å†™æµ‹è¯•å¾ˆéš¾ã€‚ </li></ul><br><h2 id="problematika">  <strong>å‘è¡Œ</strong> </h2><br><blockquote> åœ¨æ¯æ—¶æ¯åˆ»ï¼Œåº”ç”¨ç¨‹åºéƒ½å…·æœ‰ç¡®å®šå…¶è¡Œä¸ºå’Œç”¨æˆ·æ‰€è§å†…å®¹çš„ç‰¹å®šçŠ¶æ€ã€‚ æ­¤çŠ¶æ€åŒ…æ‹¬å˜é‡çš„æ‰€æœ‰å€¼-ä»ç®€å•æ ‡å¿—åˆ°å•ä¸ªå¯¹è±¡ã€‚ è¿™äº›å˜é‡ä¸­çš„æ¯ä¸€ä¸ªéƒ½æœ‰è‡ªå·±çš„ç”Ÿå‘½ï¼Œå¹¶ç”±ä»£ç çš„ä¸åŒéƒ¨åˆ†æ§åˆ¶ã€‚ æ‚¨åªèƒ½é€ä¸€æ£€æŸ¥æ‰€æœ‰åº”ç”¨ç¨‹åºï¼Œæ‰èƒ½ç¡®å®šåº”ç”¨ç¨‹åºçš„å½“å‰çŠ¶æ€ã€‚ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å…³äºç°ä»£Kotlin MVIæ¶æ„çš„æ–‡ç« </a> <br><cut></cut><br></blockquote><br><h2 id="glava-1-evolyuciya--nashe-vsyo">  <strong>ç¬¬1ç« ã€‚è¿›åŒ–å°±æ˜¯æˆ‘ä»¬çš„ä¸€åˆ‡</strong> </h2><br><p> æœ€åˆï¼Œæˆ‘ä»¬åœ¨MVPä¸Šè¿›è¡Œäº†ç¼–å†™ï¼Œä½†æœ‰äº›æ”¹åŠ¨ã€‚ å®ƒæ˜¯MVPå’ŒMVIçš„æ··åˆä½“ã€‚ æ¥è‡ªMVPçš„å®ä½“å…·æœ‰æ¼”ç¤ºè€…å’ŒViewç•Œé¢çš„å½¢å¼ï¼š </p><br><pre><code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewTaskView</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> newTaskAction: Observable&lt;NewTaskAction&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> taskNameChangeAction: Observable&lt;String&gt; <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> onChangeState: Consumer&lt;SomeViewState&gt; }</code> </pre> <br><p> å·²ç»åœ¨è¿™é‡Œæ‚¨å¯ä»¥æ³¨æ„åˆ°è¦æ³¨æ„çš„é—®é¢˜ï¼šè¿™é‡Œçš„è§†å›¾è·ç¦»MVPè§„èŒƒå¾ˆè¿œã€‚ æ¼”ç¤ºè€…ä¸­æœ‰ä¸€ç§æ–¹æ³•ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(view: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SomeView</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Disposable</code> </pre> <br><p> åœ¨å¤–éƒ¨ï¼Œä¼ é€’äº†ä¸€ä¸ªæ¥å£å®ç°ï¼Œè¯¥æ¥å£å®ç°ä»¥å“åº”æ–¹å¼è®¢é˜…UIæ›´æ”¹ã€‚ å®ƒå·²ç»å……æ»¡äº†MVIï¼ </p><br><p> æ›´å¤šå°±æ˜¯æ›´å¤šã€‚ åœ¨Presenterä¸­ï¼Œåˆ›å»ºäº†ä¸åŒçš„äº¤äº’å™¨å¹¶è®¢é˜…äº†Viewæ›´æ”¹ï¼Œä½†æ˜¯å®ƒä»¬æ²¡æœ‰ç›´æ¥è°ƒç”¨UIæ–¹æ³•ï¼Œè€Œæ˜¯è¿”å›äº†ä¸€äº›å…¨å±€çŠ¶æ€ï¼Œå…¶ä¸­å­˜åœ¨æ‰€æœ‰å¯èƒ½çš„å±å¹•çŠ¶æ€ï¼š </p><br><pre> <code class="kotlin hljs">compositeDisposable.add( Observable.merge(firstAction, secondAction) .observeOn(AndroidSchedulers.mainThread()) .subscribe(view.onChangeState)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> compositeDisposable</code> </pre> <br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeViewState</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> progress: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>? = <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> error: Throwable? = <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> errorMessage: String? = error?.message, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> result: TaskUi? = <span class="hljs-literal"><span class="hljs-literal">null</span></span>)</code> </pre><br><p> æ´»åŠ¨æ˜¯SomeViewStateMachineæ¥å£çš„åä»£ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeViewStateMachine</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toSuccess</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(task: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SomeUiModel</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(error: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toProgress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">changeSomeButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(buttonEnabled: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> }</code> </pre> <br><p> å½“ç”¨æˆ·å•å‡»å±å¹•ä¸Šçš„æŸäº›å†…å®¹æ—¶ï¼Œæ¼”ç¤ºè€…è¿›å…¥ä¸€ä¸ªäº‹ä»¶ï¼Œä»–åˆ›å»ºäº†ä¸€ä¸ªæ–°æ¨¡å‹ï¼Œè¯¥æ¨¡å‹ç”±ç‰¹æ®Šç±»ç»˜åˆ¶ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeViewStateResolver</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> stateMachine: SomeViewStateMachine) : Consumer&lt;SomeViewState&gt; { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">accept</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(stateUpdate: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SomeViewState</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stateUpdate.result != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { stateMachine.toSuccess(stateUpdate.result) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stateUpdate.error != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; stateUpdate.progress == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { stateMachine.toError(stateUpdate.errorMessage) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stateUpdate.progress == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { stateMachine.toProgress() } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (stateUpdate.someButtonEnabled != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { stateMachine.changeSomeButton(stateUpdate.someButtonEnabled) } } }</code> </pre> <br><p> åŒæ„ï¼Œæœ‰äº›å¥‡æ€ªçš„MVPï¼Œç”šè‡³ç¦»MVIè¿˜å¾ˆè¿œã€‚ å¯»æ‰¾çµæ„Ÿã€‚ </p><br><h2 id="glava-2-redux">  <strong>ç¬¬2ç« Redux</strong> </h2><br><p><img src="https://habrastorage.org/webt/sw/bm/pf/swbmpfddkyjohcxemag4a0zdatm.jpeg"></p><br><p> åœ¨è°ˆè®ºä»–ä¸å…¶ä»–å¼€å‘äººå‘˜çš„é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é¢†å¯¼</a> ï¼ˆå½“æ—¶è¿˜æ˜¯ç°åœ¨ï¼‰çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sergey Boishtyan</a>äº†è§£äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Redux</a> ã€‚ </p><br><p> çœ‹äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Dorfmanå…³äºæ‰€æœ‰æ¶æ„çš„è®¨è®º</a>å¹¶ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Redux</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€èµ·ç©</a>äº†ä¹‹åï¼Œæˆ‘ä»¬å†³å®šä½¿ç”¨å®ƒæ¥å‡çº§æˆ‘ä»¬çš„æ¶æ„ã€‚ <br> ä½†æ˜¯é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä»”ç»†ç ”ç©¶ä¸€ä¸‹æ¶æ„ï¼Œå¹¶äº†è§£å…¶ä¼˜ç¼ºç‚¹ã€‚ </p><br><p>  <strong>åŠ¨ä½œç‰‡</strong> <br> æè¿°åŠ¨ä½œã€‚ </p><br><p>  <strong>åŠ¨ä½œåˆ›é€ è€…</strong> <br> ä»–å°±åƒç³»ç»Ÿåˆ†æå¸ˆä¸€æ ·ï¼šæ ¼å¼åŒ–å¹¶è¡¥å……å®¢æˆ·éœ€æ±‚è§„èŒƒï¼Œä»¥ä¾¿ç¨‹åºå‘˜ç†è§£ä»–ã€‚ <br> å½“ç”¨æˆ·åœ¨å±å¹•ä¸Šå•å‡»æ—¶ï¼ŒActionsCreatorä¼šå½¢æˆä¸€ä¸ªç”¨äºä¸­é—´ä»¶çš„æ“ä½œï¼ˆæŸç§ä¸šåŠ¡é€»è¾‘ï¼‰ã€‚ ä¸šåŠ¡é€»è¾‘ä¸ºæˆ‘ä»¬æä¾›äº†ç‰¹å®šReduceræ¥æ”¶å’Œæå–çš„æ–°æ•°æ®ã€‚ </p><br><p> å¦‚æœå†æ¬¡æŸ¥çœ‹å›¾ç‰‡ï¼Œå¯èƒ½ä¼šæ³¨æ„åˆ°è¯¸å¦‚å­˜å‚¨ä¹‹ç±»çš„å¯¹è±¡ã€‚ å•†åº—å•†åº—å‡é€Ÿå™¨ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çœ‹åˆ°å‰ç«¯å…„å¼Ÿ-ä¸å¹¸çš„å…„å¼Ÿ-çŒœæµ‹å¯ä»¥å°†ä¸€ä¸ªå¤§å¯¹è±¡é”¯æˆè®¸å¤šå°å¯¹è±¡ï¼Œæ¯ä¸ªå°å¯¹è±¡éƒ½å°†è´Ÿè´£è‡ªå·±çš„å±å¹•éƒ¨åˆ†ã€‚ è¿™åªæ˜¯ä¸€ä¸ªå¾ˆæ£’çš„æƒ³æ³•ï¼ </p><br><p> ç®€å•çš„ActionCreatorsçš„ç¤ºä¾‹ä»£ç ï¼ˆå°å¿ƒï¼ŒJavaScriptï¼ï¼‰ï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addTodo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">text</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: ADD_TODO, text } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toggleTodo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">index</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: TOGGLE_TODO, index } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setVisibilityFilter</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">filter</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">type</span></span>: SET_VISIBILITY_FILTER, filter } }</code> </pre> <br><p>  <strong>å‡é€Ÿå™¨</strong> </p><br><blockquote> åŠ¨ä½œæè¿°äº†æŸäº›äº‹æƒ…å‘ç”Ÿçš„äº‹å®ï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡ç¤ºåº”ç”¨ç¨‹åºçš„çŠ¶æ€åº”å¦‚ä½•å“åº”ä»¥è¿›è¡Œæ›´æ”¹ï¼Œè¿™å¯¹äºReduceræ¥è¯´æ˜¯å¯è¡Œçš„ã€‚ </blockquote><p> ç®€è€Œè¨€ä¹‹ï¼ŒReducerçŸ¥é“å¦‚ä½•åˆ†è§£/åˆ·æ–°å±å¹•ã€‚ </p><br><p> ä¼˜ç‚¹ï¼š </p><br><ul><li> åˆ†è§£çš„å±å¹•æ›´æ–°ã€‚ </li><li> å•å‘æ•°æ®æµã€‚ </li></ul><br><p> ç¼ºç‚¹ï¼š </p><br><ul><li> æœ€å–œæ¬¢çš„åˆ‡æ¢ã€‚ <br><pre> <code class="kotlin hljs">function todoApp(state = initialState, action) { switch (action.type) { case SET_VISIBILITY_FILTER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Object.assign({}, state, { visibilityFilter: action.filter }) case ADD_TODO: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Object.assign({}, state, { todos: [ ...state.todos, { text: action.text, completed: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ] }) <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> state }</code> </pre> </li><li> ä¸€å †çŠ¶æ€å¯¹è±¡ã€‚ </li><li> å°†é€»è¾‘åˆ†ç¦»åˆ°ActionCreatorå’ŒReducerä¸­ã€‚ </li></ul><br><p> æ˜¯çš„ï¼Œåœ¨æˆ‘ä»¬çœ‹æ¥ï¼ŒActionCreatorå’ŒReducerçš„åˆ†ç¦»å¹¶ä¸æ˜¯è¿æ¥æ¨¡å‹å’Œå±å¹•çš„æœ€ä½³é€‰æ‹©ï¼Œå› ä¸ºç¼–å†™instanceofï¼ˆisï¼‰æ˜¯ä¸€ç§ä¸å¥½çš„æ–¹æ³•ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å‘æ˜äº†æˆ‘ä»¬çš„æ¶æ„ï¼ </p><br><h2 id="glava-3-eba">  <strong>ç¬¬3ç« EBA</strong> </h2><br><p><img src="https://habrastorage.org/webt/os/6w/7_/os6w7_sgmegw6nsh7lyebs_o9de.jpeg"></p><br><p> åœ¨EBAä¸­ï¼Œä»€ä¹ˆæ˜¯Actionå’ŒActionCreatorï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> Action = () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> ActionMapper&lt;T&gt; = (T) -&gt; Action <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActionCreator</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">T</span></span></span><span class="hljs-class">&gt; : </span><span class="hljs-type"></span></span><span class="hljs-class"><span class="hljs-type"></span></span>(T) -&gt; (Observable&lt;Action&gt;)</code> </pre> <br><p> æ˜¯çš„ï¼Œæ¶æ„çš„ä¸€åŠæ˜¯ç±»å‹åˆ«åå’Œæ¥å£ã€‚ ç®€å•ç­‰äºä¼˜é›…ï¼ </p><br><p> ä¸ºäº†é‡‡å–è¡ŒåŠ¨è€Œä¸ä¼ é€ä»»ä½•æ•°æ®ï¼Œéœ€è¦é‡‡å–è¡ŒåŠ¨ã€‚ ç”±äºActionCreatorè¿”å›ä¸€ä¸ªObservableï¼Œå› æ­¤æˆ‘ä»¬ä¸å¾—ä¸å°†ActionåŒ…è£…åœ¨å¦ä¸€ä¸ªlambdaä¸­ä»¥ä¼ è¾“ä¸€äº›æ•°æ®ã€‚ äº‹å®è¯æ˜ï¼ŒActionMapperæ˜¯ä¸€ç§ç±»å‹åŒ–çš„Actionï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥ä¼ é€’æ›´æ–°å±å¹•/è§†å›¾æ‰€éœ€çš„å†…å®¹ã€‚ <br><br>  <strong>åŸºæœ¬å‡è®¾ï¼š</strong> <br></p><div class="spoiler">  <b class="spoiler_title">ä¸€ä¸ªActionCreator-å±å¹•çš„ä¸€éƒ¨åˆ†</b> <div class="spoiler_text"><p> åœ¨ç¬¬ä¸€æ®µä¸­ï¼Œæ‰€æœ‰å†…å®¹éƒ½å¾ˆæ¸…æ¥šï¼šä¸ºäº†é¿å…éš¾ä»¥ç†è§£çš„äº¤å‰æ›´æ–°ï¼Œæˆ‘ä»¬åŒæ„ä¸€ä¸ªActionCreatoråªèƒ½æ›´æ–°å…¶å±å¹•éƒ¨åˆ†ã€‚ å¦‚æœæ˜¯åˆ—è¡¨ï¼Œåˆ™ä»…æ›´æ–°åˆ—è¡¨ï¼Œå¦‚æœä»…æŒ‰é’®åˆ™æ›´æ–°ã€‚ </p></div></div><br><div class="spoiler">  <b class="spoiler_title">ä¸éœ€è¦åŒ•é¦–</b> <div class="spoiler_text"><p> ä½†æ˜¯ï¼Œä¸€ä¸ªå¥‡æ€ªçš„æ˜¯ï¼Œä¸ºä»€ä¹ˆåŒ•é¦–ä¸èƒ½å–æ‚¦æˆ‘ä»¬ï¼Ÿ æˆ‘å‘Šè¯‰ä½  <br> ä¸€ä¸ªå…¸å‹çš„æ•…äº‹æ˜¯é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªæŠ½è±¡çš„è°¢å°”ç›–åˆååŒ•é¦–å¤§å¸ˆï¼ˆåˆç§°â€œè¿™ä¸ªæŠ½è±¡æ˜¯åšä»€ä¹ˆï¼Ÿâ€ï¼‰ã€‚ </p><br><p> äº‹å®è¯æ˜ï¼Œå¦‚æœæ‚¨å°è¯•ä½¿ç”¨åŒ•é¦–ï¼Œåˆ™å¿…é¡»æ¯æ¬¡éƒ½å‘æ¯ä¸ªæ–°çš„ï¼ˆä¸ä»…æ˜¯æ–°çš„ï¼‰å¼€å‘äººå‘˜è¿›è¡Œè§£é‡Šã€‚ ä¹Ÿè®¸æ‚¨è‡ªå·±å·²ç»å¿˜è®°äº†æ­¤æ³¨é‡Šçš„ä½œç”¨ï¼Œè€Œæ‚¨å»äº†googleã€‚ </p><br><p> æ‰€æœ‰è¿™äº›éƒ½æå¤§åœ°å¢åŠ äº†åˆ›å»ºç‰¹å¾çš„è¿‡ç¨‹ï¼Œè€Œæ²¡æœ‰å¸¦æ¥å¤ªå¤šçš„ä¾¿åˆ©ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å†³å®šç”±æˆ‘ä»¬è‡ªå·±åŠ¨æ‰‹åˆ›å»ºæ‰€éœ€çš„ä¸œè¥¿ï¼Œå› ä¸ºæ²¡æœ‰ä»£ç ç”Ÿæˆï¼Œæ‰€ä»¥ç»„è£…èµ·æ¥ä¼šæ›´å¿«ã€‚ æ˜¯çš„ï¼Œæˆ‘ä»¬å°†èŠ±è´¹é¢å¤–çš„äº”åˆ†é’Ÿæ—¶é—´æ¥æ‰‹åŠ¨ç¼–å†™æ‰€æœ‰ä¾èµ–é¡¹ï¼Œä½†æ˜¯æˆ‘ä»¬å°†èŠ‚çœå¤§é‡çš„ç¼–è¯‘æ—¶é—´ã€‚ æ˜¯çš„ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åˆ°å¤„éƒ½æŠ›å¼ƒåŒ•é¦–ï¼Œå®ƒåœ¨å…¨çƒèŒƒå›´å†…ä½¿ç”¨ï¼Œå®ƒåˆ›å»ºäº†ä¸€äº›é€šç”¨çš„ä¸œè¥¿ï¼Œä½†æ˜¯æˆ‘ä»¬ç”¨Javaç¼–å†™å®ƒä»¬æ˜¯ä¸ºäº†æ›´å¥½çš„ä¼˜åŒ–ï¼Œä»¥å…å¸å¼•kaptã€‚ </p></div></div><br><p>  <strong>å»ºç­‘æ–¹æ¡ˆ</strong> ï¼š </p><br><p><img src="https://habrastorage.org/webt/1w/m6/1a/1wm61atrwg2dmy4hkzfherwsbqc.png"></p><br><p>  Componentæ˜¯Daggerä¸­ç›¸åŒç»„ä»¶çš„ç±»ä¼¼ç‰©ï¼Œåªæ˜¯æ²¡æœ‰Daggerã€‚ ä»–çš„ä»»åŠ¡æ˜¯åˆ›å»ºæ´»é¡µå¤¹ã€‚ æ´»é¡µå¤¹å°†ActionCreatorsè¿æ¥åœ¨ä¸€èµ·ã€‚ ä»Viewåˆ°Binderäº‹ä»¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Œä»Binderåˆ°Viewï¼Œå°†å‘é€æ›´æ–°å±å¹•çš„æ“ä½œã€‚ </p><br><p>  <strong>åŠ¨ä½œåˆ›é€ è€…</strong> </p><br><p><img src="https://habrastorage.org/webt/8v/nw/3p/8vnw3p52mcfzyyhegcxtkexgokm.png"></p><br><p> ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™æ˜¯ä»€ä¹ˆæ ·çš„ä¸œè¥¿-ActionCreatorã€‚ åœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œå®ƒåªæ˜¯å•å‘åœ°å¤„ç†åŠ¨ä½œã€‚ å‡è®¾æœ‰è¿™æ ·ä¸€ç§æƒ…å†µï¼šç”¨æˆ·å•å‡»â€œåˆ›å»ºä»»åŠ¡â€æŒ‰é’®ã€‚ åº”è¯¥æ‰“å¼€å¦ä¸€ä¸ªå±å¹•ï¼Œæˆ‘ä»¬å°†åœ¨æ­¤å¤„æè¿°å®ƒï¼Œè€Œæ— éœ€ä»»ä½•å…¶ä»–è¯·æ±‚ã€‚ </p><br><p> ä¸ºæ­¤ï¼Œæˆ‘ä»¬åªéœ€ä½¿ç”¨æˆ‘ä»¬å¿ƒçˆ±çš„Jakeçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RxBinding</a>è®¢é˜…æŒ‰é’®ï¼Œç„¶åç­‰å¾…ç”¨æˆ·å•å‡»å®ƒã€‚ å‘ç”Ÿç‚¹å‡»åï¼ŒBinderä¼šå°†äº‹ä»¶å‘é€åˆ°ç‰¹å®šçš„ActionCreatorï¼Œåè€…å°†è°ƒç”¨æˆ‘ä»¬çš„Actionï¼Œè¿™å°†ä¸ºæˆ‘ä»¬æ‰“å¼€ä¸€ä¸ªæ–°å±å¹•ã€‚ è¯·æ³¨æ„ï¼Œæ²¡æœ‰å¼€å…³ã€‚ æ¥ä¸‹æ¥ï¼Œæˆ‘å°†åœ¨ä»£ç ä¸­æ˜¾ç¤ºä¸ºä»€ä¹ˆä¼šè¿™æ ·ã€‚ <br> å¦‚æœæˆ‘ä»¬çªç„¶éœ€è¦è®¿é—®ç½‘ç»œæˆ–æ•°æ®åº“ï¼Œåˆ™å¯ä»¥åœ¨æ­¤å¤„å‘å‡ºè¿™äº›è¯·æ±‚ï¼Œä½†æ˜¯è¦é€šè¿‡é€šè¿‡æ¥å£è°ƒç”¨ä¼ é€’ç»™ActionCreatoræ„é€ å‡½æ•°çš„äº¤äº’å™¨è¿›è¡Œè°ƒç”¨ï¼š </p><br><blockquote> å…è´£å£°æ˜ï¼šè¿™é‡Œçš„ä»£ç æ ¼å¼ä¸å®Œå…¨æ­£ç¡®ï¼Œæˆ‘æœ‰æœ¬æ–‡çš„è§„åˆ™ï¼Œå› æ­¤ä»£ç æ˜“äºé˜…è¯»ã€‚ </blockquote><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LoadItemsActionCreator</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> getItems: () -&gt; Observable&lt;List&lt;ViewTyped&gt;&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> showLoadedItems: ActionMapper&lt;DiffResult&lt;ViewTyped&gt;&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> diffCalculator: DiffCalculator&lt;ViewTyped&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> errorItem: ErrorView, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> emptyItem: ViewTyped? = <span class="hljs-literal"><span class="hljs-literal">null</span></span>) : ActionOnEvent</code> </pre> <br><p>  â€œé€šè¿‡å…¶è°ƒç”¨çš„æ¥å£â€ä¸€è¯çš„æ„æ€æ˜¯ç¡®åˆ‡åœ°å£°æ˜getItemsçš„å£°æ˜æ–¹å¼ï¼ˆæ­¤å¤„ViewTypedæ˜¯æˆ‘ä»¬ç”¨äºå¤„ç†åˆ—è¡¨çš„æ¥å£ï¼‰ã€‚ é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œæˆ‘ä»¬å·²åœ¨åº”ç”¨ç¨‹åºçš„å…«ä¸ªä¸åŒéƒ¨åˆ†é‡ç”¨äº†è¯¥ActionCreatorï¼Œå› ä¸ºå®ƒå†™çš„å°½å¯èƒ½å¤šã€‚ </p><br><p> ç”±äºäº‹ä»¶å…·æœ‰å“åº”æ€§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­æ·»åŠ å…¶ä»–è¿ç®—ç¬¦æ¥ç»„è£…ä¸€æ¡é“¾ï¼Œä¾‹å¦‚ï¼ŒstartWithï¼ˆshowLoadingActionï¼‰ç”¨äºæ˜¾ç¤ºåŠ è½½ï¼ŒonErrorReturnï¼ˆerrorActionï¼‰ç”¨äºæ˜¾ç¤ºå¸¦æœ‰é”™è¯¯çš„å±å¹•çŠ¶æ€ã€‚ <br> æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½æ˜¯ååº”æ€§çš„ï¼ </p><br><h2 id="primer-">  <strong>ä¾‹å­</strong> </h2><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AboutFragment</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CompositionFragment</span></span></span></span>(R.layout.fragment_about) { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onViewCreated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(view: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">View</span></span></span></span><span class="hljs-function"><span class="hljs-params">, savedInstanceState: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Bundle</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onViewCreated(view, savedInstanceState) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> component = AboutComponent( setVersionName = { { appVersion.text = it } }, openPdfAction = { (url, name) -&gt; { openPdf(url, name) } }) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> events = AboutEventsImpl( bindEvent = bindEvent, openPolicyPrivacyEvent = confidentialityPolicy.clicks(), openProcessingPersDataEvent = personalDataProtection.clicks(), unbindEvent = unBindEvent) component.binder().bind(events) }</code> </pre> <br><p> æœ€åï¼Œæˆ‘ä»¬ä»¥ä»£ç ä¸ºä¾‹æ¥çœ‹çœ‹è¯¥æ¶æ„ã€‚ é¦–å…ˆï¼Œæˆ‘é€‰æ‹©äº†æœ€ç®€å•çš„å±å¹•ä¹‹ä¸€-å…³äºåº”ç”¨ç¨‹åºï¼Œå› ä¸ºå®ƒæ˜¯é™æ€å±å¹•ã€‚ <br> è€ƒè™‘åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> component = AboutComponent( setVersionName = { { appVersion.text = it } }, openPdfAction = { (url, name) -&gt; { openPdf(url, name) } } )</code> </pre> <br><p> ç»„ä»¶å‚æ•°-Actions / ActionMappers-å¸®åŠ©å°†Viewä¸ActionCreatorså…³è”ã€‚ åœ¨ActionMapper'e setVersionNameä¸­ï¼Œæˆ‘ä»¬ä¼ é€’é¡¹ç›®çš„ç‰ˆæœ¬ï¼Œå¹¶å°†æ­¤å€¼åˆ†é…ç»™å±å¹•ä¸Šçš„æ–‡æœ¬ã€‚ åœ¨openPdfActionä¸­ï¼Œä¸€å¯¹æŒ‡å‘æ–‡æ¡£çš„é“¾æ¥å’Œä¸€ä¸ªåç§°ï¼Œä»¥æ‰“å¼€ç”¨æˆ·å¯ä»¥é˜…è¯»æ­¤æ–‡æ¡£çš„ä¸‹ä¸€ä¸ªå±å¹•ã€‚ </p><br><p> è¿™æ˜¯ç»„ä»¶æœ¬èº«ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AboutComponent</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> setVersionName: ActionMapper&lt;String&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openPdfAction: ActionMapper&lt;Pair&lt;String, String&gt;&gt;) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">binder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: AboutEventsBinder { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openPolicyPrivacy = OpenPdfActionCreator(openPdfAction, someUrlString) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openProcessingPersonalData = OpenPdfActionCreator(openPdfAction, anotherUrlString) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> setVersionName = setVersionName.toSimpleActionCreator( moreComponent::currentVersionName ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> AboutEventsBinder(setVersionName, openPolicyPrivacy, openProcessingPersonalData) } }</code> </pre> <br><p> è®©æˆ‘æé†’æ‚¨ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> Action = () -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typealias</span></span> ActionMapper&lt;T&gt; = (T) -&gt; Action</code> </pre> <br><p> å¥½çš„ï¼Œè®©æˆ‘ä»¬ç»§ç»­ã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">binder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: AboutEventsBinder</code> </pre> <br><p> è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°äº†è§£AboutEventsBinderã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AboutEventsBinder</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> setVersionName: ActionOnEvent, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openPolicyPrivacy: ActionOnEvent, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openProcessingPersonalData: ActionOnEvent) : BaseEventsBinder&lt;AboutEvents&gt;() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindInternal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(events: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">AboutEvents</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Observable&lt;Action&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.merge( setVersionName(events.bindEvent), openPolicyPrivacy(events.openPolicyPrivacyEvent), openProcessingPersonalData(events.openProcessingPersDataEvent)) } }</code> </pre> <br><p>  ActionOnEventæ˜¯å¦ä¸€ä¸ªç±»å‹åˆ«åï¼Œä»¥å…æ¯æ¬¡éƒ½å†™ã€‚ </p><br><pre> <code class="kotlin hljs">ActionCreator&lt;Observable&lt;*&gt;&gt;</code> </pre> <br><p> åœ¨AboutEventsBinderä¸­ï¼Œæˆ‘ä»¬ä¼ é€’ActionCreatorå¹¶è°ƒç”¨å®ƒä»¬ï¼Œå°†å…¶ç»‘å®šåˆ°ç‰¹å®šäº‹ä»¶ã€‚ ä½†æ˜¯ï¼Œè¦äº†è§£æ‰€æœ‰è¿™äº›å¦‚ä½•è¿æ¥ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹åŸºç±»-BaseEventsBinderã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseEventsBinder</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">in EVENTS : BaseEvents</span></span></span><span class="hljs-class">&gt;</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> uiScheduler: Scheduler = AndroidSchedulers.mainThread() ) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(events: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EVENTS</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { bindInternal(events).observeOn(uiScheduler) .takeUntil(events.unbindEvent) .subscribe(Action::invoke) } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindInternal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(events: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EVENTS</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Observable&lt;Action&gt; }</code> </pre><br><p> æˆ‘ä»¬çœ‹åˆ°äº†ç†Ÿæ‚‰çš„bindInternalæ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨åç»§æ–¹æ³•ä¸­å¯¹å…¶è¿›è¡Œäº†é‡æ–°å®šä¹‰ã€‚ ç°åœ¨è€ƒè™‘ç»‘å®šæ–¹æ³•ã€‚ æ‰€æœ‰çš„é­”æœ¯éƒ½åœ¨è¿™é‡Œã€‚ æˆ‘ä»¬æ¥å—BaseEventsæ¥å£çš„ç»§æ‰¿è€…ï¼Œå°†å…¶ä¼ é€’ç»™bindInternalæ¥è¿æ¥äº‹ä»¶å’ŒåŠ¨ä½œã€‚ ä¸€æ—¦æˆ‘ä»¬è¯´äº†ä»€ä¹ˆï¼Œæˆ‘ä»¬å°±åœ¨uiæµä¸Šæ‰§è¡Œå¹¶è®¢é˜…ã€‚ æˆ‘ä»¬è¿˜çœ‹åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„hack-takeUntilã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseEvents</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> unbindEvent: EventObservable }</code> </pre> <br><p> åœ¨BaseEventsä¸­å®šä¹‰äº†unbindEventå­—æ®µä»¥æ§åˆ¶é€€è®¢åï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ‰€æœ‰ç»§æ‰¿äººä¸­å®ç°å®ƒã€‚ è¿™ä¸ªå¥‡å¦™çš„å­—æ®µä½¿æ‚¨å¯ä»¥åœ¨æ´»åŠ¨ç»“æŸåè‡ªåŠ¨å–æ¶ˆè®¢é˜…ã€‚ å¤ªå¥½äº†ï¼ ç°åœ¨ï¼Œæ‚¨ä¸å†å…³æ³¨ï¼Œä¹Ÿä¸å¿…æ‹…å¿ƒç”Ÿå‘½å‘¨æœŸå¹¶å®‰ç„¶å…¥ç¡ã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openPolicyPrivacy = OpenPdfActionCreator(openPdfAction, policyPrivacyUrl) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openProcessingPersonalData = OpenPdfActionCreator(openPdfAction, personalDataUrl)</code> </pre> <br><p> è¿”å›ç»„ä»¶ã€‚ åœ¨è¿™é‡Œæ‚¨å·²ç»å¯ä»¥çœ‹åˆ°é‡ç”¨çš„æ–¹æ³•ã€‚ æˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªå¯ä»¥æ‰“å¼€pdfæŸ¥çœ‹å±å¹•çš„ç±»ï¼Œè€Œå¯¹æˆ‘ä»¬æ¥è¯´urlæ— å…³ç´§è¦ã€‚ æ²¡æœ‰ä»£ç é‡å¤ã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OpenPdfActionCreator</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openPdfAction: ActionMapper&lt;Pair&lt;String, String&gt;&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> pdfUrl: String) : ActionOnEvent { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EventObservable</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Observable&lt;Action&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> event.map { openPdfAction(pdfUrl to pdfUrl.substringAfterLast(FILE_NAME_DELIMITER)) } } }</code> </pre> <br><p>  ActionCreatorä»£ç ä¹Ÿå°½å¯èƒ½ç®€å•ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ‰§è¡Œä¸€äº›å­—ç¬¦ä¸²æ“ä½œã€‚ </p><br><p> è®©æˆ‘ä»¬å›åˆ°è¯¥ç»„ä»¶å¹¶è€ƒè™‘ä»¥ä¸‹ActionCreatorï¼š </p><br><pre> <code class="kotlin hljs">setVersionName.toSimpleActionCreator(moreComponent::currentVersionName)</code> </pre> <br><p> ä¸€æ—¦æˆ‘ä»¬å˜å¾—å¤ªæ‡’äº†ï¼Œå°±æ— æ³•ç¼–å†™ç›¸åŒä¸”æœ¬è´¨ä¸Šç®€å•çš„ActionCreatorsã€‚ æˆ‘ä»¬ä½¿ç”¨äº†Kotlinçš„åŠ›é‡å¹¶å†™äº†extension'yã€‚ ä¾‹å¦‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦å°†é™æ€å­—ç¬¦ä¸²ä¼ é€’ç»™ActionMapperã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;R&gt;</span></span></span><span class="hljs-function"> ActionMapper</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;R&gt;</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toSimpleActionCreator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( mapper: ()</span></span></span></span> -&gt; R): ActionCreator&lt;Observable&lt;*&gt;&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> : ActionCreator&lt;Observable&lt;*&gt;&gt; { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Observable</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;*&gt;)</span></span></span></span>: Observable&lt;Action&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> event.map { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span><span class="hljs-symbol"><span class="hljs-symbol">@toSimpleActionCreator</span></span>(mapper()) } } } }</code> </pre> <br><p> æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æ ¹æœ¬ä¸éœ€è¦ä¼ è¾“ä»»ä½•ä¸œè¥¿ï¼Œè€Œåªéœ€è¦è°ƒç”¨æŸäº›åŠ¨ä½œå³å¯ï¼Œä¾‹å¦‚ï¼Œæ‰“å¼€ä»¥ä¸‹å±å¹•ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> Action.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toActionCreator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: ActionOnEvent { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> : ActionOnEvent { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EventObservable</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Observable&lt;Action&gt; { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> event.map { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span><span class="hljs-symbol"><span class="hljs-symbol">@toActionCreator</span></span> } } } }</code> </pre> <br><p> å› æ­¤ï¼Œåœ¨ç»„ä»¶ç»“æŸåï¼Œè¿”å›ç‰‡æ®µï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> events = AboutEventsImpl( bindEvent = bindEvent, openPolicyPrivacyEvent = confidentialityPolicy.throttleFirstClicks(), openProcessingPersDataEvent = personalDataProtection.throttleFirstClicks(), unbindEvent = unBindEvent)</code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªè´Ÿè´£æ¥æ”¶ç”¨æˆ·äº‹ä»¶çš„ç±»çš„åˆ›å»ºã€‚ å–æ¶ˆç»‘å®šå’Œç»‘å®šåªæ˜¯æˆ‘ä»¬ä½¿ç”¨Trelloçš„Naviåº“è·å–çš„å±å¹•ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> &lt;T&gt; NaviComponent.observe(event: Event&lt;T&gt;): Observable&lt;T&gt; = RxNavi.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">observe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(this, event)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> unBindEvent: Observable&lt;*&gt; = observe(Event.DESTROY_VIEW) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> bindEvent: Observable&lt;*&gt; = Observable.just(<span class="hljs-literal"><span class="hljs-literal">true</span></span>)  <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> bindEvent = observe(Event.POST_CREATE)</code> </pre> <br><p> äº‹ä»¶æ¥å£æè¿°äº†ç‰¹å®šå±å¹•çš„äº‹ä»¶ï¼Œæ­¤å¤–å®ƒè¿˜å¿…é¡»ç»§æ‰¿BaseEventsã€‚ ä»¥ä¸‹å§‹ç»ˆæ˜¯æ¥å£çš„å®ç°ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œäº‹ä»¶ä¸å±å¹•ä¸Šçš„äº‹ä»¶æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œä½†æ˜¯ç¢°å·§æ‚¨éœ€è¦å°†ä¸¤ä¸ªäº‹ä»¶ä¿æŒåœ¨ä¸€èµ·ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œåœ¨å‘ç”Ÿé”™è¯¯çš„æƒ…å†µä¸‹ï¼Œæ‰“å¼€å’Œé‡æ–°åŠ è½½æ—¶å±å¹•åŠ è½½çš„äº‹ä»¶åº”åˆå¹¶ä¸ºä¸€ä¸ªäº‹ä»¶-ä»…åŠ è½½å±å¹•ã€‚ </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AboutEvents</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BaseEvents { val bindEvent: EventObservable val openPolicyPrivacyEvent: EventObservable val openProcessingPersDataEvent: EventObservable } class AboutEventsImpl</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> bindEvent: EventObservable, <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openPolicyPrivacyEvent: EventObservable, <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openProcessingPersDataEvent: EventObservable, <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> unbindEvent: EventObservable) : AboutEvents</code> </pre> <br><p> æˆ‘ä»¬å›åˆ°ç‰‡æ®µï¼Œå°†æ‰€æœ‰å†…å®¹ç»„åˆåœ¨ä¸€èµ·ï¼ æˆ‘ä»¬è¦æ±‚ç»„ä»¶åˆ›å»ºç»‘å®šå™¨å¹¶å°†ç»‘å®šå™¨è¿”å›ç»™æˆ‘ä»¬ï¼Œç„¶ååœ¨å…¶ä¸Šè°ƒç”¨bindæ–¹æ³•ï¼Œåœ¨æ­¤æˆ‘ä»¬ä¼ é€’ç›‘è§†å±å¹•äº‹ä»¶çš„å¯¹è±¡ã€‚ </p><br><pre> <code class="kotlin hljs">component.binder().bind(events)</code> </pre> <br><p> æˆ‘ä»¬å·²ç»åœ¨è¿™ä¸ªæ¶æ„ä¸Šå†™äº†ä¸€ä¸ªé¡¹ç›®å¤§çº¦ä¸¤å¹´äº†ã€‚ å…±äº«åŠŸèƒ½çš„é€Ÿåº¦å¯¹ç®¡ç†äººå‘˜çš„å¿«ä¹æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼ ä»–ä»¬æ²¡æœ‰æ—¶é—´æå‡ºæ–°çš„å»ºè®®ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»å®Œæˆäº†æ—§çš„å»ºè®®ã€‚ è¯¥ä½“ç³»ç»“æ„éå¸¸çµæ´»ï¼Œå…è®¸æ‚¨é‡ç”¨å¤§é‡ä»£ç ã€‚ <br> è¿™ç§ä½“ç³»ç»“æ„çš„ç¼ºç‚¹å¯ä»¥ç§°ä¸ºçŠ¶æ€ä¸å®ˆæ’ã€‚ æˆ‘ä»¬æ²¡æœ‰åƒMVIä¸­é‚£æ ·æè¿°å±å¹•çŠ¶æ€çš„å®Œæ•´æ¨¡å‹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¤„ç†å®ƒã€‚ å–œæ¬¢-è§ä¸‹æ–‡ã€‚ </p><br><h2 id="glava-4-bonus">  <strong>ç¬¬4ç« å¥–é‡‘</strong> </h2><br><p> æˆ‘è®¤ä¸ºæ¯ä¸ªäººéƒ½çŸ¥é“åˆ†æçš„é—®é¢˜ï¼šæ²¡æœ‰äººå–œæ¬¢ç¼–å†™å®ƒï¼Œå› ä¸ºå®ƒéå†æ‰€æœ‰å±‚çº§å¹¶æ¶ˆé™¤äº†æŒ‘æˆ˜ã€‚ å‰ä¸€æ®µæ—¶é—´ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é¢å¯¹å®ƒã€‚ ä½†æ˜¯ç”±äºæˆ‘ä»¬çš„ä½“ç³»ç»“æ„ï¼Œè·å¾—äº†éå¸¸æ¼‚äº®çš„å®ç°ã€‚ </p><br><p> å› æ­¤ï¼Œæˆ‘çš„æƒ³æ³•æ˜¯ï¼šåˆ†æé€šå¸¸æ˜¯ä¸ºäº†å“åº”ç”¨æˆ·æ“ä½œè€Œç•™ä¸‹çš„ã€‚ æˆ‘ä»¬åªæœ‰ä¸€ä¸ªå¯ä»¥ç´¯ç§¯ç”¨æˆ·æ“ä½œçš„ç±»ã€‚ å¥½çš„ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ã€‚ </p><br><p>  <strong>ç¬¬ä¸€æ­¥</strong> æˆ‘ä»¬é€šè¿‡å°†äº‹ä»¶åŒ…è£…åœ¨trackAnalyticsä¸­æ¥ç¨å¾®æ›´æ”¹BaseEventsBinderåŸºç±»ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseEventsBinder</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">in EVENTS : BaseEvents</span></span></span><span class="hljs-class">&gt;</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> trackAnalytics: TrackAnalytics&lt;EVENTS&gt; = EmptyAnalyticsTracker(), <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> uiScheduler: Scheduler = AndroidSchedulers.mainThread()) { <span class="hljs-meta"><span class="hljs-meta">@SuppressLint(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"CheckResult"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bind</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(events: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EVENTS</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { bindInternal(trackAnalytics(events)).observeOn(uiScheduler) .takeUntil(events.unbindEvent) .subscribe(Action::invoke) } <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-keyword"><span class="hljs-keyword">abstract</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bindInternal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(events: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EVENTS</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Observable&lt;Action&gt; }</code> </pre><br><p>  <strong>ç¬¬äºŒæ­¥</strong> æˆ‘ä»¬åˆ›å»ºtrackAnalyticså˜é‡çš„ç¨³å®šå®ç°ï¼Œä»¥ä¿æŒå‘åå…¼å®¹æ€§ï¼Œå¹¶ä¸”ä¸ä¼šç ´åå°šä¸éœ€è¦åˆ†æçš„ç»§æ‰¿äººï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TrackAnalytics</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EVENTS : BaseEvents</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(events: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EVENTS</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: EVENTS } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">EmptyAnalyticsTracker</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EVENTS : BaseEvents</span></span></span><span class="hljs-class">&gt; : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TrackAnalytics</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">EVENTS</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(events: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">EVENTS</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: EVENTS = events }</code> </pre> <br><p>  <strong>ç¬¬ä¸‰æ­¥</strong> æˆ‘ä»¬ä¸ºæ‰€éœ€çš„å±å¹•ï¼ˆä¾‹å¦‚ï¼Œé¡¹ç›®åˆ—è¡¨å±å¹•ï¼‰ç¼–å†™TrackAnalyticsæ¥å£çš„å®ç°ï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TrackProjectsEvents</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TrackAnalytics</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ProjectsEvents</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">invoke</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(events: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ProjectsEvents</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: ProjectsEvents { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> : ProjectsEvents <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> events { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> boardClickEvent = events.boardClickEvent.trackTypedEvent { allProjectsProjectClick(it.title) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openBoardCreationEvent = events.openBoardCreationEvent.trackEvent { allProjectsAddProjectClick() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openCardsSearchEvent = events.openCardsSearchEvent.trackEvent { allProjectsSearchBarClick() } } } }</code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å†æ¬¡ä»¥ä»£è¡¨çš„å½¢å¼ä½¿ç”¨Kotlinçš„åŠ›é‡ã€‚ æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªç”±æˆ‘ä»¬åˆ›å»ºçš„æ¥å£ç»§æ‰¿ç¨‹åº-åœ¨è¿™ç§æƒ…å†µä¸‹ä¸ºProjectsEventsã€‚ ä½†æ˜¯å¯¹äºæŸäº›äº‹ä»¶ï¼Œæ‚¨éœ€è¦é‡æ–°å®šä¹‰äº‹ä»¶çš„è¿›è¡Œæ–¹å¼ï¼Œå¹¶é€šè¿‡å‘é€åˆ†æåœ¨äº‹ä»¶å‘¨å›´æ·»åŠ ç»‘å®šã€‚ å®é™…ä¸Šï¼ŒtrackEventåªæ˜¯doOnNextï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function"> Observable</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trackEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">crossinline</span></span></span></span><span class="hljs-function"><span class="hljs-params"> event: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">AnalyticsSpec</span></span></span></span><span class="hljs-function"><span class="hljs-params">.()</span></span></span></span> -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>): Observable&lt;T&gt; = doOnNext { event(analyticsSpec) } <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function"> Observable</span><span class="hljs-type"><span class="hljs-function"><span class="hljs-type">&lt;T&gt;</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trackTypedEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">crossinline</span></span></span></span><span class="hljs-function"><span class="hljs-params"> event: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">AnalyticsSpec</span></span></span></span><span class="hljs-function"><span class="hljs-params">.(</span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">T</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Unit</span></span>): Observable&lt;T&gt; = doOnNext { event(analyticsSpec, it) }</code> </pre> <br><p>  <strong>ç¬¬4æ­¥</strong> å‰©ä¸‹çš„è¦è½¬ç§»åˆ°æ´»é¡µå¤¹ã€‚ ç”±äºæˆ‘ä»¬å°†å…¶æ„é€ åœ¨ç»„ä»¶ä¸­ï¼Œå› æ­¤å¦‚æœæ‚¨çªç„¶éœ€è¦ï¼Œæˆ‘ä»¬å°†æœ‰æœºä¼šå‘æ„é€ å‡½æ•°æ·»åŠ å…¶ä»–ä¾èµ–é¡¹ã€‚ ç°åœ¨ï¼ŒProjectsEventsBinderæ„é€ å‡½æ•°å°†å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProjectsEventsBinder</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> loadItems: LoadItemsActionCreator, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> refreshBoards: ActionOnEvent, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openBoard: ActionCreator&lt;Observable&lt;BoardId&gt;&gt;, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openScreen: ActionOnEvent, <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> openCardSearch: ActionOnEvent, trackAnalytics: TrackAnalytics&lt;ProjectsEvents&gt;) : BaseEventsBinder&lt;ProjectsEvents&gt;(trackAnalytics)</code> </pre> <br><p> æ‚¨å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>GitHubä¸Š</strong></a>æŸ¥çœ‹å…¶ä»–ç¤ºä¾‹ã€‚ </p><br><h2 id="voprosy-i-otvety">  <strong>é—®ä¸ç­”</strong> </h2><br><div class="spoiler">  <b class="spoiler_title">æ‚¨å¦‚ä½•ä¿æŒå±å¹•çŠ¶æ€ï¼Ÿ</b> <div class="spoiler_text"><p> æ²¡åŠæ³• æˆ‘ä»¬é˜»æ­¢æ–¹å‘ã€‚ ä½†æ˜¯æˆ‘ä»¬ä¹Ÿä½¿ç”¨å‚æ•°/ intentå¹¶å°†OPENED_FROM_BACKSTACKå˜é‡ä¿å­˜åœ¨é‚£é‡Œã€‚ åœ¨è®¾è®¡æ´»é¡µå¤¹æ—¶ï¼Œæˆ‘ä»¬ä¼šåŠ ä»¥è€ƒè™‘ã€‚ å¦‚æœä¸ºå‡-ä»ç½‘ç»œåŠ è½½æ•°æ®ã€‚ å¦‚æœä¸ºtrue-ä»ç¼“å­˜ã€‚ è¿™ä½¿æ‚¨å¯ä»¥å¿«é€Ÿé‡æ–°åˆ›å»ºå±å¹•ã€‚ </p><br><p> å¯¹äºåå¯¹å®šå‘é˜»æ­¢çš„æ¯ä¸ªäººï¼šå°è¯•æµ‹è¯•å’Œå­˜å‚¨æœ‰å…³ç”¨æˆ·ç¿»è½¬æ‰‹æœºçš„é¢‘ç‡ä»¥åŠæœ‰å¤šå°‘ç”¨æˆ·å¤„äºä¸åŒå®šå‘çš„åˆ†æã€‚ ç»“æœå¯èƒ½ä»¤äººæƒŠè®¶ã€‚ </p></div></div><br><div class="spoiler">  <b class="spoiler_title">æˆ‘ä¸æƒ³ç¼–å†™ç»„ä»¶ï¼Œå¦‚ä½•ç”¨åŒ•é¦–äº¤æœ‹å‹ï¼Ÿ</b> <div class="spoiler_text"><p> æˆ‘ä¸å»ºè®®è¿™æ ·åšï¼Œä½†æ˜¯å¦‚æœæ‚¨ä¸ä»‹æ„ç¼–è¯‘æ—¶é—´ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åŒ•é¦–åˆ›å»ºComponentã€‚ ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰å°è¯•ã€‚ </p></div></div><br><div class="spoiler">  <b class="spoiler_title">æˆ‘ä¸æ˜¯ç”¨kotlinç¼–å†™çš„ï¼Œç”¨Javaå®ç°æœ‰å“ªäº›å›°éš¾ï¼Ÿ</b> <div class="spoiler_text"><p> ç›¸åŒçš„éƒ½å¯ä»¥ç”¨Javaç¼–å†™ï¼Œåªæ˜¯çœ‹èµ·æ¥ä¸ä¼šé‚£ä¹ˆæ¼‚äº®ã€‚ </p></div></div><br><p> å¦‚æœæ‚¨å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œé‚£ä¹ˆä¸‹ä¸€éƒ¨åˆ†å°†æ˜¯å…³äºå¦‚ä½•åœ¨è¿™ç§æ¶æ„ä¸Šç¼–å†™æµ‹è¯•çš„ï¼ˆè¿™å°†æ¸…æ¥šä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤šçš„æ¥å£ï¼‰ã€‚  Spoiler-ç¼–å†™å¾ˆå®¹æ˜“ï¼Œæ‚¨å¯ä»¥åœ¨é™¤ç»„ä»¶ä¹‹å¤–çš„æ‰€æœ‰å±‚ä¸Šè¿›è¡Œç¼–å†™ï¼Œä½†æ˜¯æ‚¨æ— éœ€æµ‹è¯•å®ƒï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªç»‘å®šå¯¹è±¡ã€‚ </p><br><p> æ„Ÿè°¢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Tinkoff Business</a>ç§»åŠ¨å¼€å‘å›¢é˜Ÿçš„åŒäº‹ä¸ºæœ¬æ–‡æ’°å†™æ‰€æä¾›çš„å¸®åŠ©ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN474612/">https://habr.com/ru/post/zh-CN474612/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN474596/index.html">åœ¨TSDä¸Šçš„åº”ç”¨ä»¥åŠé€šè¿‡HTTPæœåŠ¡ä¸1Cï¼šEnterprise 8.3çš„é€šä¿¡ã€‚ ç¬¬5éƒ¨åˆ†ï¼ˆèœå•ï¼Œä¼´éšå¯¹è±¡ï¼‰</a></li>
<li><a href="../zh-CN474598/index.html">æ²¡æœ‰å·¥ä½œç»éªŒçš„QAå·¥ç¨‹å¸ˆé¢è¯•æ–¹æ³•</a></li>
<li><a href="../zh-CN474602/index.html">æ±‚è§£ç®€å•çº¿æ€§å›å½’æ–¹ç¨‹</a></li>
<li><a href="../zh-CN474606/index.html">Blogspamå¦‚ä½•å·¥ä½œ</a></li>
<li><a href="../zh-CN474610/index.html">åŸºäºNUCçš„åª’ä½“ç³»ç»Ÿ-å®¶åº­ä½“éªŒ</a></li>
<li><a href="../zh-CN474618/index.html">ä¸ºWooCommerceåˆ¶ä½œ3Dé…ç½®å™¨</a></li>
<li><a href="../zh-CN474620/index.html">æ•°æ®ä¸­å¿ƒä¿¡æ¯å®‰å…¨</a></li>
<li><a href="../zh-CN474622/index.html">34ä¸ªå¼€æºPythonåº“ï¼ˆ2019ï¼‰</a></li>
<li><a href="../zh-CN474626/index.html">Google Analyticsï¼ˆåˆ†æï¼‰å’ŒYandex.Metricaæœ¯è¯­ï¼šå¦‚ä½•ä¸æ··æ·†æ‰€æœ‰è¿™äº›æ•°æ®</a></li>
<li><a href="../zh-CN474628/index.html">å¼•å…¥æ–°çš„Microsoft Edgeå’ŒBing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>