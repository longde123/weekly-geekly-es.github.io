<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖐️ 👧🏼 👆🏽 Schriftarten vorladen 👨🏼‍🎤 #⃣ 👨🏾‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Autor des Artikels, dessen Übersetzung wir heute veröffentlichen, möchte darüber sprechen, warum er die Schriftarten vorlädt, auch wenn er es nich...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Schriftarten vorladen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/470870/">  Der Autor des Artikels, dessen Übersetzung wir heute veröffentlichen, möchte darüber sprechen, warum er die Schriftarten vorlädt, auch wenn er es nicht sollte. <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/2r/jy/xq/2rjyxqifqzb06x5rhh1zj-y28ao.png"></a> <br>  Als er die Site erstellte, auf der das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Original</a> dieses Materials veröffentlicht wurde, wollte er keine seiner eigenen Schriftarten verwenden.  Dies würde die Leistung der Website zwangsläufig beeinträchtigen, wenn auch nicht sehr stark.  Der Autor des Artikels sagt, er habe sich bemüht, eine schnelle Website zu erstellen.  Am Ende wurde jedoch beschlossen, eine spezielle Schriftart für Seitentitel zu verwenden und gleichzeitig zu versuchen, diese Lösung so wenig wie möglich auf die Leistung des Projekts auszuwirken. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Erste Schritte</font> </h2><br>  Zunächst habe ich beschlossen, die Schriftartdatei so klein wie möglich zu halten.  Also habe ich eine Teilmenge dieser Schriftart erstellt.  Mit anderen Worten, ich habe aus der Schriftart nur die Zeichen ausgewählt, die für die Wörter im Titel erforderlich sind. <br><br>  Als Ergebnis erhielt ich eine sehr kompakte Datei, deren Größe weniger als 2 KB betrug.  Außerdem habe ich es an derselben Stelle platziert wie alle anderen Materialien auf der Site, wodurch ich Abhängigkeiten von Drittanbietern und die Zeit, die für die Verbindung mit einer anderen Domain aufgewendet wurde, loswerden konnte. <br><br>  Und schließlich wurde der Link zur Schriftartdatei in den in die Seite eingebetteten CSS-Code oben im HTML-Code und nicht in die externe CSS-Datei eingefügt. <br><br>  Dies bedeutet, dass der Browser die Schriftartdatei erkennen und herunterladen kann, ohne ein externes Stylesheet herunterladen zu müssen.  Dies ist übrigens ein häufiger Grund dafür, dass Schriftarten später als nötig geladen werden. <br><br><h2>  <font color="#3AC1EF">Überraschung</font> </h2><br>  Da für die Anzeige von Text spezielle Schriftarten erforderlich sind, muss der Browser diese als Ressourcen mit hoher Priorität behandeln. <br><br>  Infolgedessen habe ich erwartet, dass die Schriftartdatei sehr schnell geladen wird.  Die Seiten meiner Ressource waren auf jeden Fall ziemlich "hell", daher dachte ich, dass nichts das Laden der Schriftartdatei verhindern sollte. <br><br>  Als ich die Seite analysierte, war ich leicht schockiert. <br><br>  Als ich die Site mit den Chrome-Entwicklertools betrachtete und in Webpagetest untersuchte, stellte ich fest, dass die Schriftart mit hoher Priorität nach den Bildern geladen wurde - Ressourcen mit niedriger Priorität. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a9e/b69/42b/a9eb6942be47a8350a3419a54e7382ef.png"></div><br>  <i><font color="#999999">Die Bilder werden vor dem Herunterladen der Schriftart heruntergeladen</font></i> <br><br>  Es schien mir völliger Unsinn. <br><br>  Ich wusste mit Sicherheit, dass der Browser vor dem Herunterladen der Schriftart warten kann, bis er feststellt, dass die Schriftart zum Anzeigen der Seite benötigt wird.  Das Element, in dem meine Schriftart verwendet wurde, befand sich jedoch ganz oben auf der Seite im <code>&lt;header&gt;</code> , viel höher als die Tags mit Bildern, die vor dem Herunterladen der Schriftart geladen wurden.  Das entsprechende Element befand sich nicht nur im Seitencode, sondern auch im DOM-Baum. <br><br><h2>  <font color="#3AC1EF">Vorladen von Schriftarten als Lösung für das Problem</font> </h2><br>  Das <code>preload</code> Attribut teilt dem Browser mit, dass die entsprechende Ressource, die zum Anzeigen der aktuellen Seite erforderlich ist, vorgeladen werden muss. <br><br>  Die Verwendung dieses Attributs ist eine gute Möglichkeit, wichtige Ressourcen frühzeitig herunterzuladen, die sonst später vom Browser erkannt würden. <br><br>  Schriftdateien sind ein gutes Beispiel für die Verwendung dieses Mechanismus.  Wenn der Link zur Schriftartdatei in einem externen Stylesheet erstellt wird, erkennt der Browser die Schriftart erst, wenn er dieses Stylesheet lädt. <br><br>  Die Verwendung des <code>preload</code> Attributs <code>preload</code> Anwenden auf Schriftdateien teilt dem Browser mit, dass beim Anzeigen der Seite die entsprechenden Schriftarten benötigt werden. <br>  Darüber hinaus ist dieser Mechanismus mit dem <code>&lt;link&gt;</code> -Element sehr einfach zu implementieren. <br><br><pre> <code class="plaintext hljs">&lt;link rel="preload" href="myfont.woff2" as="font" type="font/woff2" crossorigin&gt;</code> </pre> <br>  Alternativ können Sie die Preload-Direktive zum Antwortheader hinzufügen (obwohl, sofern nicht anders angegeben, einige Server oder CDNs dieses Design möglicherweise als vom <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://www.cloudflare.com/website-optimization/">Server initiierte</a> Anforderung zum Übertragen von Ressourcen an den Client interpretieren). <br><br>  Ich hatte nicht erwartet, dass ich auf dieser Site Mechanismen zum Vorladen von Ressourcen verwenden müsste.  Mein CSS-Code ist sehr bescheiden. Ich habe ihn in den HTML-Code der Seite eingebettet, damit die Seiten beim ersten Besuch der Website von den Browsern schneller angezeigt werden.  Da meine Schriftart nicht vom Laden einer externen CSS-Datei abhängig war, hätte der Browser sie auf jeden Fall sehr früh und ohne „Hinweise“ zum Vorladen erkennen müssen. <br><br>  Ich fand jedoch heraus, dass das Vorladen der Schriftart zur Wiederherstellung der Gerechtigkeit führte, da die Schriftartdatei jetzt geladen wurde, bevor die Bilddateien heruntergeladen wurden. <br><br>  Hier ist das Wasserfalldiagramm von Webpagetest - Ich habe die Stellen hervorgehoben, an denen die Arbeit mit der Schriftartdatei gezeigt wird.  Oben in der Abbildung wird das Vorspannen nicht verwendet.  Unten - gebraucht. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b8c/d2e/789/b8cd2e789c21ffe4d26175ef0bbd1711.png"></div><br>  <i><font color="#999999">Vorladen und Arbeiten mit der Schriftartdatei.</font></i> <br><br>  Vielleicht wäre es sinnvoller, das Storyboard des Seitenladevorgangs zu betrachten (hier wurde aus Gründen der Klarheit eine Nachahmung einer sehr langsamen Verbindung verwendet). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/451/efc/532/451efc532263db4aa64740322d011bef.png"></div><br>  <i><font color="#999999">Im oberen Storyboard wird das Vorladen nicht verwendet.</font></i>  <i><font color="#999999">Unten - gebraucht</font></i> <br><br>  Nebenbei stelle ich fest, dass ich das Handle für die <code>font-display: fallback</code> .  Das heißt, der Titel wurde ursprünglich mit der Sicherungsschriftart angezeigt, falls meine Schriftart langsam geladen wurde.  Für diesen Test habe ich diese Funktion jedoch deaktiviert, da es sonst sehr schwierig wäre, zwischen den Schritten beim Laden der Seite zu unterscheiden. <br><br><h2>  <font color="#3AC1EF">Warum hat es funktioniert?</font> </h2><br>  Um eine Webseite anzuzeigen, muss der Browser den DOM-Baum und den CSSOM-Baum erstellen, die später zum Erstellen des Rendering-Baums verwendet werden. <br><br>  Es <code>preload</code> dass die Verwendung des <code>&lt;link&gt;</code> -Elements mit dem <code>preload</code> Attribut zum Herunterladen der Schriftart es dem Browser ermöglicht, CSSOM zu erstellen, bevor das DOM abgeschlossen ist. <br><br>  Sie können dies in den folgenden Bildern sehen, die eine Untersuchung des Seitenladevorgangs mit den Chrome-Entwicklertools zeigen. <br><br>  So sieht die Arbeit mit Seitenmaterialien ohne Vorladen aus.  Zuerst wird das DOM erstellt und das Bild geladen, dann wird CSSOM erstellt und die Schriftart geladen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/70e/d87/be1/70ed87be14271c5d93563d18161eaba7.png"></div><br>  <i><font color="#999999">Arbeiten Sie mit der Seite ohne Vorladen</font></i> <br><br>  Und hier ist das gleiche, aber mit der Verwendung von Vorspannung.  Hier beginnt der Browser mit der Erstellung von CSSOM, dem Herunterladen der Schriftart, dem DOM und dem Herunterladen der Bilder. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c75/ea3/101/c75ea31011fe25c4527c7b6c64f86b2e.png"></div><br>  <i><font color="#999999">Arbeiten mit der Seite mit Preload</font></i> <br><br><h2>  <font color="#3AC1EF">Gibt es Alternativen zum Vorladen?</font> </h2><br>  Angenommen, ich könnte das <code>preload</code> Attribut nicht verwenden, um die Priorität der Schriftartdatei zu erhöhen.  Was könnte ich dann tun?  Wie können Sie die Priorität von Bildern senken? <br><br>  Aus Neugier versuchte ich, die obige Idee umzusetzen und fügte den Elementen, die die Bilder beschreiben, das Attribut <code>loading="lazy"</code> hinzu.  In Chrome 76 (dem einzigen Browser, der dies zum Zeitpunkt des Schreibens unterstützte) müsste dies die Priorität von Bildern außerhalb des ursprünglich sichtbaren Bereichs der Seite verringern. <br><br>  Das Testen dieser Idee mit Entwicklertools hat gezeigt, dass dies dazu führt, dass Schriftarten früher heruntergeladen werden.  Vielleicht ist dies eine Erinnerung wert, da die Browserunterstützung für verzögerte Lademechanismen mit der Zeit zunimmt. <br><br><h2>  <font color="#3AC1EF">Unterschiedliche Browser verhalten sich unterschiedlich</font> </h2><br>  Ich habe das Projekt in verschiedenen Browsern und auf mehreren Geräten getestet.  Beim Testen habe ich festgestellt, dass iOS Safari (iPhone 8) dasselbe Verhalten wie Chrome aufweist.  Schriftarten werden nämlich standardmäßig nach Bildern geladen, aber mit dem <code>preload</code> Attribut können <code>preload</code> die Situation beheben. <br><br>  Das Problem des späten Ladens von Schriftarten trat auch in Firefox auf, aber das <code>preload</code> Attribut wird von diesem Browser standardmäßig noch nicht unterstützt. Die Verwendung des <code>preload</code> Attributs beim Anzeigen einer Site in Firefox hat also nichts geändert. <br><br>  In Edge werden Schriftarten auch später als gewünscht geladen.  Es gab das Gefühl, dass die Verwendung von Webload Pagetest unter Verwendung des <code>preload</code> Attributs nur teilweise funktionierte.  Es schien mir nämlich, dass es wie ein doppelter Schriftdownload aussah.  Sobald es früher geladen wurde, das zweite Mal später. <br><br>  Im vorigen Absatz habe ich darüber gesprochen, dass ich "eine Sensation hatte" und dass ich "schien".  Tatsache ist, dass beim Versuch, dieses Verhalten mit meiner eigenen Version von Edge zu testen, die "doppelten" Downloads verschwunden sind.  Jetzt hatte ich das Gefühl, dass die Verwendung des <code>preload</code> Attributs <code>preload</code> Laden von Schriftarten nicht beschleunigt.  Möglicherweise war dieser Unterschied im Verhalten der Seite das Ergebnis der Behebung eines Fehlers in Edge. In diesem Fall wurde der Fehler jedoch auf Kosten der Änderung des Mechanismus zum Vorladen von Ressourcen korrigiert. <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  Hier haben wir darüber gesprochen, warum das Vorladen von Schriftarten nicht schadet, selbst wenn die Links zu ihren Dateien im auf der Seite eingebetteten CSS-Code erstellt werden. <br><br>  Browser verhalten sich nicht immer so, wie wir es wollen oder wie wir es erwarten.  Wir haben jedoch Tools, die das Verhalten von Browsern beeinflussen und sie in die von uns benötigte Richtung neigen. <br><br>  Früher dachte ich, dass das Vorladen von Schriftarten auf meiner Website völlig sinnlos ist.  Aus all dem, worüber ich gesprochen habe, habe ich eine wichtige Lektion für mich gelernt.  Es besteht darin, dass Sie niemals etwas annehmen sollten. <br><br>  Am Ende kann ich sagen, dass das Vorladen von Schriftarten eine großartige Möglichkeit ist, die Ausgabe von Text auf Webseiten zu beschleunigen. <br><br>  <b>Liebe Leser!</b>  Verwenden Sie in Ihren Webprojekten Mechanismen zum Vorladen von Schriftarten? <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/-o/2e/tu/-o2etuqogwhmdnmysb9_vivc9v4.png"></a> </div><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de470870/">https://habr.com/ru/post/de470870/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de470852/index.html">Verarbeitung von 40 TB Code aus 10 Millionen Projekten auf einem dedizierten Server mit Go für 100 US-Dollar</a></li>
<li><a href="../de470856/index.html">Telegramm GRAM Wallet: Nutzungsbedingungen</a></li>
<li><a href="../de470858/index.html">Antiquitäten: Benchmark des 386. Prozessors und der schneidigen neunziger Jahre</a></li>
<li><a href="../de470864/index.html">Über die Freuden des Wechsels zum Panel und nicht nur</a></li>
<li><a href="../de470868/index.html">Zeit bis zum ersten Byte: Was ist das und warum ist es wichtig?</a></li>
<li><a href="../de470872/index.html">Leistungsmetriken für die Suche nach unglaublich schnellen Webanwendungen</a></li>
<li><a href="../de470874/index.html">Optimierung des Ladens von JavaScript auf Wikipedia</a></li>
<li><a href="../de470876/index.html">Erstellen Sie mit Babel benutzerdefinierte JavaScript-Syntaxkonstrukte. Teil 1</a></li>
<li><a href="../de470878/index.html">Erstellen Sie mit Babel benutzerdefinierte JavaScript-Syntaxkonstrukte. Teil 2</a></li>
<li><a href="../de470880/index.html">Spielmechanik. Abenteuer, das Konzept der Null und überzeugende Sprachtherapie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>