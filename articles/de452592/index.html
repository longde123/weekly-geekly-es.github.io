<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üç¥ üë©üèª‚Äç‚öñÔ∏è ü§öüèæ Teil 0. Erfordert, dass ein Elf in der Matrix arbeitet. Umzug ist m√∂glich üßúüèæ ü•á üåç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Achtung: enth√§lt Systemprogrammierung. Ja, im Wesentlichen enth√§lt es nichts anderes. 


 Stellen wir uns vor, Sie h√§tten die Aufgabe erhalten, ein Fa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Teil 0. Erfordert, dass ein Elf in der Matrix arbeitet. Umzug ist m√∂glich</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452592/"><p>  <strong>Achtung: enth√§lt Systemprogrammierung.</strong>  <strong>Ja, im Wesentlichen enth√§lt es nichts anderes.</strong> </p><br><p> Stellen wir uns vor, Sie h√§tten die Aufgabe erhalten, ein Fantasy-Fantasy-Spiel zu schreiben.  Nun, da √ºber die Elfen.  Und √ºber die virtuelle Realit√§t.  Von Kindheit an haben Sie davon getr√§umt, so etwas zu schreiben, und sind ohne zu z√∂gern damit einverstanden.  Bald merkt man, dass man den gr√∂√üten Teil der Welt der Elfen aus Witzen aus dem alten Bashorgh und anderen unterschiedlichen Quellen kennt.  <em>Ups, ein Problem.</em>  Wo unsere nicht verschwunden sind ... Durch reichhaltige Programmiererfahrung gehen Sie zu Google, geben die "Elfenspezifikation" ein und folgen den Links.  Oh!  Dieser f√ºhrt zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einer Art PDF</a> ... also, was wir hier haben ... eine Art <code>Elf32_Sword</code> - <code>Elf32_Sword</code> - es scheint so, als ob Sie es brauchen.  32 ist anscheinend das Level des Charakters und die beiden Viere in den folgenden Spalten sind wahrscheinlich Schaden.  Genau das, was Sie brauchen und au√üerdem wie systematisiert! .. </p><a name="habracut"></a><br><p>  Wie in einer Programmieraufgabe der Olympiade nach einigen Abs√§tzen eines detaillierten Textes zum Thema Japan, Samurai und Geisha ausgef√ºhrt: ‚ÄûWie Sie bereits verstanden haben, wird es bei der Aufgabe √ºberhaupt nicht darum gehen.‚Äú  Oh ja, der Wettbewerb war nat√ºrlich eine Weile.  Im Allgemeinen erkl√§re ich f√ºnf Minuten Hartn√§ckigkeit f√ºr geschlossen. </p><br><p>  Heute werde ich versuchen, √ºber das Parsen einer Datei im 64-Bit- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ELF-</a> Format zu sprechen.  Im Prinzip speichern sie keine nativen Programme, statischen Bibliotheken, dynamischen Bibliotheken, jede implementierungsspezifische wie Crashdumps ... Sie werden beispielsweise unter Linux und vielen anderen Unix-√§hnlichen Systemen verwendet, ja, sagen sie, sogar auf Telefonen Die Unterst√ºtzung wurde zuvor aktiv in die gepatchte Firmware gestopft.  Es scheint schwierig zu sein, das Format zum Speichern von Programmen von seri√∂sen Betriebssystemen zu unterst√ºtzen.  Also dachte ich.  Ja, das ist es wahrscheinlich.  Wir werden jedoch einen ganz bestimmten Anwendungsfall unterst√ºtzen: das Laden von eBPF-Bytecode aus <code>.o</code> Dateien.  Warum so?  Nur f√ºr weitere Experimente ben√∂tige ich einen ernsthaften (d. H. Nicht <em>kniehohen</em> ) plattform√ºbergreifenden Bytecode, der von C abgerufen und nicht manuell geschrieben werden kann. EBPF ist also einfach und es gibt ein LLVM-Backend daf√ºr.  Und ich muss nur ELF als Container analysieren, in den dieser Bytecode vom Compiler gestellt wird. </p><br><p>  Nur f√ºr den Fall, ich werde klarstellen: Der Artikel ist eine explorative Programmierung und erhebt keinen Anspruch auf Vollst√§ndigkeit.  Das ultimative Ziel ist es, einen Bootloader zu erstellen, mit dem Sie C-Programme lesen k√∂nnen, die in eBPF mit Clang kompiliert wurden - die, die ich habe -, in einem Volumen, das ausreicht, um die Experimente fortzusetzen. </p><br><h1 id="zagolovok">  √úberschrift </h1><br><p>  Beginnend mit dem Nullpunktversatz im ELF liegt der Header.  Es enth√§lt genau die Buchstaben E, L, F, die Sie sehen k√∂nnen, wenn Sie versuchen, es mit einem Texteditor zu √∂ffnen, sowie einige globale Variablen.  Tats√§chlich ist der Header die einzige Struktur in der Datei, die sich an einem festen Versatz befindet, und er enth√§lt Informationen, um den Rest der Struktur zu finden.  <em>(Im Folgenden werde ich von der Dokumentation f√ºr das 32-Bit-Format und von <code>elf.h</code> , die sich mit 64-Bit <code>elf.h</code> . Wenn Sie also Fehler bemerken, k√∂nnen Sie diese <code>elf.h</code> korrigieren.)</em> </p><br><p>  Das erste, was uns in der Datei begegnet, ist das <code>unsigned char e_ident[16]</code> .  Erinnern Sie sich an diese lustigen Artikel in der Reihe "Alle folgenden Aussagen sind falsch"?  Hier ist es ungef√§hr gleich: ELF kann 32- oder 64-Bit-Code, Little oder Big Endian und sogar ein Dutzend Prozessorarchitekturen enthalten.  Sie werden es als Elf64 unter Little Endian lesen - nun, viel Gl√ºck ... Diese Reihe von Bytes ist eine Art Signatur dessen, was sich darin befindet und wie man es analysiert. </p><br><p>  Mit den ersten vier Bytes ist alles einfach - es ist <code>[0x7f, 'E', 'L', 'F']</code> .  Wenn sie nicht √ºbereinstimmen, gibt es Grund zu der Annahme, dass es sich um falsche Bienen handelt.  Das n√§chste Byte enth√§lt die Klasse <del>  Charakter </del>  Datei: <code>ELFCLASS32</code> oder <code>ELFCLASS64</code> - Bittiefe.  Der Einfachheit halber arbeiten wir nur mit 64-Bit-Dateien (gibt es ein 32-Bit-eBPF?).  Wenn sich herausstellt, dass die Klasse <code>ELFCLASS32</code> , <code>ELFCLASS32</code> wir einfach mit einem Fehler: <code>ELFCLASS32</code> die Strukturen "schweben" und die √úberpr√ºfung der Integrit√§t wird nicht schaden, dies zu tun.  Das letzte f√ºr uns interessante Byte in dieser Struktur gibt die Endianness der Datei an - wir arbeiten nur mit der nativen Bytereihenfolge f√ºr unseren Prozessor. </p><br><p>  Nur f√ºr den Fall, ich werde klarstellen: Wenn Sie mit dem ELF-Format in C arbeiten, sollten Sie nicht jedes int durch den geschickt berechneten Offset <code>elf.h</code> - <code>elf.h</code> enth√§lt die erforderlichen Strukturen und sogar <code>e_ident</code> in <code>e_ident</code> : <code>EI_MAG0</code> , <code>EI_MAG1</code> , <code>EI_MAG2</code> , <code>EI_MAG3</code> , <code>EI_CLASS</code> , <code>EI_DATA</code> ... Sie m√ºssen nur bringen Zeiger auf die Daten, die aus der Datei gelesen oder in den Speicher abgebildet wurden, auf den Zeiger auf die Struktur und gelesen. </p><br><p>  Zus√§tzlich zu <code>e_ident</code> enth√§lt <code>e_ident</code> Header weitere Felder, von denen einige nur √ºberpr√ºft werden und andere f√ºr die weitere Analyse verwendet werden, jedoch sp√§ter.  Wir √ºberpr√ºfen n√§mlich, ob <code>e_machine == EM_BPF</code> ( <code>e_machine == EM_BPF</code> "unter der Architektur des eBPF-Prozessors"), <code>e_type == ET_REL</code> , <code>e_shoff != 0</code> .  Die letzte Pr√ºfung hat folgende Bedeutung: Eine Datei kann Informationen zum Verkn√ºpfen (Abschnittstabelle und Abschnitte), zum Starten (Programmtabelle und Segmente) oder beides enthalten.  Bei den letzten beiden √úberpr√ºfungen √ºberpr√ºfen wir, ob die ben√∂tigten Informationen (wie zum Verkn√ºpfen) in der Datei enthalten sind.  √úberpr√ºfen Sie auch, ob die Version des Formats <code>EV_CURRENT</code> . </p><br><p>  <strong>Nehmen Sie sofort eine Reservierung vor, ich werde die G√ºltigkeit der Datei nicht √ºberpr√ºfen, vorausgesetzt, wenn wir sie in unseren Prozess laden, vertrauen wir ihr.</strong>  Im Code des Kernels oder anderer Programme, die mit nicht vertrauensw√ºrdigen Dateien arbeiten, ist dies nat√ºrlich <strong>auf keinen Fall m√∂glich</strong> . </p><br><h1 id="tablica-sekciy">  Abschnittstabelle </h1><br><p>  Wie gesagt, wir interessieren uns f√ºr die Verkn√ºpfungsansicht der Datei, dh der Abschnittstabelle und der Abschnitte selbst.  Informationen dazu, wo Sie nach der Abschnittstabelle suchen m√ºssen, finden Sie in der Kopfzeile.  Dort wird auch die <strong>Gr√∂√üe</strong> sowie die <strong>Gr√∂√üe eines Elements angegeben</strong> - es kann gr√∂√üer als <code>sizeof(Elf64_Shdr)</code> (da es die Versionsnummer des Formats beeinflusst, wei√ü ich ehrlich gesagt nicht).  Einige Hauptabschnittsnummern sind reserviert und in der Tabelle nicht vorhanden.  Ihre Referenzierung hat eine besondere Bedeutung.  Wir sind anscheinend nur an <code>SHN_UNDEF</code> interessiert (Null ist ebenfalls reserviert - der fehlende Abschnitt; wie Sie wissen, ist der Titel in der Tabelle <code>SHN_ABS</code> noch vorhanden) <code>SHN_ABS</code> .  Das Zeichen "im Abschnitt <code>SHN_UNDEF</code> definiert" ist tats√§chlich undefiniert, und in <code>SHN_ABS</code> es tats√§chlich einen absoluten Wert und wird nicht <code>SHN_ABS</code> .  <code>SHN_ABS</code> scheint jedoch auch <code>SHN_ABS</code> mich nicht <code>SHN_ABS</code> sein. </p><br><h2 id="tablica-strok">  Zeilentabelle </h2><br><p>  Hier sto√üen wir zum ersten Mal auf Stringtabellen - Tabellen von Strings, die in einer Datei verwendet werden.  Wenn <code>const char *strtab</code> eine Tabelle mit Zeichenfolgen ist, lautet der Name <code>sh_name</code> nur <code>strtab + sh_name</code> .  Ja, es ist nur eine Zeile, die mit einem bestimmten Index beginnt und bis zum Null-Byte reicht.  Linien k√∂nnen sich schneiden (genauer gesagt, eine kann das Suffix der anderen sein).  Abschnitte k√∂nnen Namen haben. Im ELF-Header zeigt das Feld <code>e_shstrndx</code> auf einen Abschnitt der <code>e_shstrndx</code> (der f√ºr Abschnittsnamen, falls mehrere vorhanden sind) und das Feld <code>sh_name</code> im Abschnittskopf auf eine bestimmte Zeile. </p><br><p>  Das erste (Null) und das letzte Byte der Zeilentabelle enthalten Nullzeichen.  Letzteres ist verst√§ndlich, warum: Wertstunde, endet die letzte Zeile.  Der Nullpunktversatz gibt jedoch einen <em>fehlenden</em> oder <em>leeren</em> Namen an - je nach Kontext. </p><br><h2 id="zagruzka-sekciy">  Abschnitte laden </h2><br><p>  Der Header jedes Abschnitts enth√§lt zwei Adressen: eine, <code>sh_addr</code> ist die Ladeadresse (wo der Abschnitt im Speicher abgelegt wird), die andere, <code>sh_offset</code> ist der Offset in der Datei, in der sich dieser Abschnitt befindet.  Ich wei√ü nicht, wie beide sind, aber jeder dieser Werte kann einzeln 0 sein: In einem Fall bleibt der Abschnitt "auf der Festplatte", da es eine Art von Serviceinformationen gibt.  In einem anderen <code>.bss</code> wird der Abschnitt <em>nicht von der Festplatte geladen.</em> Sie m√ºssen ihn lediglich ausw√§hlen und mit Nullen ( <code>.bss</code> ) <code>.bss</code> .  Ehrlich gesagt, obwohl ich die Download-Adresse nicht verarbeiten musste - wo sie hochgeladen wurde, wurde sie dort hochgeladen :) Allerdings haben wir ehrlich gesagt auch spezielle Programme. </p><br><h1 id="relokaciya">  Umzug </h1><br><p>  Und jetzt das Interessante: Wie Sie wissen, gehen Sicherheitsma√ünahmen nicht in die Matrix, ohne dass ein Bediener an der Basis verbleibt.  Und da wir hier immer noch Fantasie haben, wird die Verbindung zum Betreiber telepathisch sein.  Oh ja, ich habe angek√ºndigt, dass f√ºnf Minuten Hartn√§ckigkeit abgeschlossen sind.  Im Allgemeinen werden wir den Verkn√ºpfungsprozess kurz diskutieren. </p><br><p>  F√ºr mein Experiment ben√∂tige ich einen Code, der zu einem regul√§ren So-Boot kompiliert wurde und mit regul√§rem <code>libdl</code> geladen ist.  Hier werde ich nicht einmal im Detail beschreiben - √∂ffnen <code>dlopen</code> einfach <code>dlopen</code> , ziehen Sie die Zeichen √ºber <code>dlsym</code> und schlie√üen Sie es mit <code>dlclose</code> wenn das Programm <code>dlclose</code> .  Dies sind jedoch auch Implementierungsdetails, die nicht mit <em>unserem</em> ELF-Dateilader zusammenh√§ngen.  Es gibt einfach einen <em>Kontext</em> : die F√§higkeit, einen Zeiger nach Namen zu erhalten. </p><br><p>  Im Allgemeinen ist der eBPF-Befehlssatz ein Triumph des ausgerichteten Maschinencodes: Ein Befehl ben√∂tigt immer 8 Bytes und hat eine Struktur </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> opcode; <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> dst:<span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> src:<span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> offset; <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> imm; };</code> </pre> <br><p>  Dar√ºber hinaus d√ºrfen viele Felder in jeder spezifischen Anweisung nicht verwendet werden - es geht uns nicht darum, Platz f√ºr einen "Maschinen" -Code zu sparen. </p><br><p>  Tats√§chlich kann der erste Befehl unmittelbar auf den zweiten folgen, der keine Opcodes enth√§lt, sondern einfach das unmittelbare Feld von 32 auf 64 Bit erweitert.  Hier ist ein Patch f√ºr einen solchen zusammengesetzten Befehl namens <code>R_BPF_64_64</code> . </p><br><p>  Um den Umzug durchzuf√ºhren, sehen wir uns noch einmal die Abschnittstabelle f√ºr <code>sh_type == SHT_REL</code> .  Das Feld <code>sh_info</code> des Headers gibt an, welchen Abschnitt wir patchen, und <code>sh_link</code> - aus welcher Tabelle eine Beschreibung der Zeichen <code>sh_link</code> . </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> Elf64_Addr r_offset; Elf64_Xword r_info; } Elf64_Rel;</code> </pre> <br><p>  Tats√§chlich gibt es zwei Arten von Umzugsabschnitten: <code>REL</code> und <code>RELA</code> - der zweite enth√§lt explizit einen zus√§tzlichen Begriff, aber ich habe ihn noch nicht gesehen. Daher f√ºgen wir der Tatsache, dass er nicht erf√ºllt ist, nur die Behauptung hinzu, dass er nicht erf√ºllt wird, und wir werden ihn verarbeiten.  Als n√§chstes werde ich dem Wert, der in den Anweisungen geschrieben ist, die Adresse des Symbols hinzuf√ºgen.  Und wo bekommt man es?  Hier sind, wie wir bereits wissen, Optionen m√∂glich: </p><br><ul><li>  Das Symbol bezieht sich auf den Abschnitt <code>SHN_ABS</code> .  Dann nimm einfach <code>st_value</code> </li><li>  Das Zeichen bezieht sich auf den Abschnitt `SHN_UNDEF.  Ziehen Sie dann das √§u√üere Symbol </li><li>  In anderen F√§llen patchen Sie einfach den Link zu einem anderen Abschnitt derselben Datei. " </li></ul><br><h1 id="kak-poprobovat-samomu">  Wie Sie es selbst versuchen </h1><br><p>  Was soll ich zuerst lesen?  Zus√§tzlich zu der bereits angegebenen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Spezifikation ist</a> es sinnvoll, <a href="">diese Datei</a> zu lesen, in der das iovisor-Team Informationen sammelt, die √ºber eBPF aus dem Linux-Kernel extrahiert wurden. </p><br><p>  Zweitens, wie sollte eigentlich jeder damit arbeiten?  Zuerst m√ºssen Sie die ELF-Datei von irgendwoher bekommen.  Wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bei StackOverfow angegeben</a> , wird uns das Team helfen. </p><br><pre> <code class="bash hljs">clang -O2 -emit-llvm -c bpf.c -o - | llc -march=bpf -filetype=obj -o bpf.o</code> </pre> <br><p>  Zweitens m√ºssen Sie irgendwie eine Referenzanalyse der Datei in St√ºcke bekommen.  In einer normalen Situation w√ºrde uns der Befehl <code>objdump</code> helfen: </p><br><pre> <code class="plaintext hljs">$ objdump : objdump &lt;&gt; &lt;()&gt;     &lt;()&gt;.          : -a, --archive-headers Display archive header information -f, --file-headers Display the contents of the overall file header -p, --private-headers Display object format specific file header contents -P, --private=OPT,OPT... Display object format specific contents -h, --[section-]headers Display the contents of the section headers -x, --all-headers Display the contents of all headers -d, --disassemble Display assembler contents of executable sections -D, --disassemble-all Display assembler contents of all sections --disassemble=&lt;sym&gt; Display assembler contents from &lt;sym&gt; -S, --source Intermix source code with disassembly -s, --full-contents Display the full contents of all sections requested -g, --debugging Display debug information in object file -e, --debugging-tags Display debug information using ctags style -G, --stabs Display (in raw form) any STABS info in the file -W[lLiaprmfFsoRtUuTgAckK] or --dwarf[=rawline,=decodedline,=info,=abbrev,=pubnames,=aranges,=macro,=frames, =frames-interp,=str,=loc,=Ranges,=pubtypes, =gdb_index,=trace_info,=trace_abbrev,=trace_aranges, =addr,=cu_index,=links,=follow-links] Display DWARF info in the file -t, --syms Display the contents of the symbol table(s) -T, --dynamic-syms Display the contents of the dynamic symbol table -r, --reloc Display the relocation entries in the file -R, --dynamic-reloc Display the dynamic relocation entries in the file @&lt;file&gt; Read options from &lt;file&gt; -v, --version Display this program's version number -i, --info List object formats and architectures supported -H, --help Display this information</code> </pre> <br><p>  Aber in diesem Fall ist es machtlos: </p><br><pre> <code class="plaintext hljs">$ objdump -d test-bpf.o test-bpf.o:   elf64-little objdump:      UNKNOWN!</code> </pre> <br><p>  Genauer gesagt werden Abschnitte angezeigt, aber das Zerlegen ist ein Problem.  Hier erinnern wir uns, was wir mit LLVM gesammelt haben.  LLVM verf√ºgt √ºber eigene erweiterte Analoga von Dienstprogrammen aus binutils mit Namen der Form <code>llvm-&lt; &gt;</code> .  Sie verstehen beispielsweise den LLVM-Bitcode.  Und sie verstehen auch eBPF - es h√§ngt sicher von den Kompilierungsoptionen ab, aber da es kompiliert wurde, sollte es wahrscheinlich immer analysiert werden.  Aus praktischen Gr√ºnden empfehle ich daher, ein Skript zu erstellen: </p><br><pre> <code class="bash hljs">vim <span class="hljs-built_in"><span class="hljs-built_in">test</span></span>-bpf.c <span class="hljs-comment"><span class="hljs-comment">#     clang -Oz -emit-llvm -c test-bpf.c -o - | llc -march=bpf -filetype=obj -o test-bpf.o llvm-objdump -d -t -r test-bpf.o</span></span></code> </pre> <br><p>  Dann f√ºr eine solche Quelle: </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdint.h&gt; extern uint64_t z; uint64_t func(uint64_t x, uint64_t y) { return x + y + z; }</span></span></span></span></code> </pre> <br><p>  Es wird ein solches Ergebnis geben: </p><br><pre> <code class="plaintext hljs">$ ./compile-bpf.sh test-bpf.o: file format ELF64-BPF Disassembly of section .text: 0000000000000000 func: 0: bf 20 00 00 00 00 00 00 r0 = r2 1: 0f 10 00 00 00 00 00 00 r0 += r1 2: 18 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 r1 = 0 ll 0000000000000010: R_BPF_64_64 z 4: 79 11 00 00 00 00 00 00 r1 = *(u64 *)(r1 + 0) 5: 0f 10 00 00 00 00 00 00 r0 += r1 6: 95 00 00 00 00 00 00 00 exit SYMBOL TABLE: 0000000000000000 l df *ABS* 00000000 test-bpf.c 0000000000000000 ld .text 00000000 .text 0000000000000000 g F .text 00000038 func 0000000000000000 *UND* 00000000 z</code> </pre> <br><p>  <a href="">Code</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1. QInst: Es ist besser, einen Tag zu verlieren und dann in f√ºnf Minuten zu fliegen (Schreibger√§te sind trivial)</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de452592/">https://habr.com/ru/post/de452592/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de452576/index.html">√úber Introvertierte in der IT</a></li>
<li><a href="../de452580/index.html">20 Projekte, 20 Sprachen, Frist gestern. Teil 3</a></li>
<li><a href="../de452584/index.html">Programmierer haben falsche Vorstellungen √ºber die Unix-Zeit</a></li>
<li><a href="../de452586/index.html">So starten Sie die Programmierung in Adobe Illustrator. Teil eins</a></li>
<li><a href="../de452590/index.html">Der Amerikaner schuf ein mobiles Klassenzimmer f√ºr den Unterricht von Kindern in Low-Budget-3D-Druckschulen. Das Projekt hat bereits mehr als 100.000 gesammelt</a></li>
<li><a href="../de452596/index.html">735.000 IPv4-Adressen wurden von einem Betr√ºger √ºbernommen und an die Registrierung zur√ºckgegeben</a></li>
<li><a href="../de452598/index.html">Management eines Programmierteams: Wie und wie kann man sie richtig motivieren? Teil eins</a></li>
<li><a href="../de452602/index.html">Cisco Hyperflex f√ºr Datenbankmanagementsysteme mit hoher Auslastung</a></li>
<li><a href="../de452606/index.html">UDB. Was ist das Teil 8. Adressierung von UDB</a></li>
<li><a href="../de452608/index.html">Teil 1. QInst: Es ist besser, einen Tag zu verlieren und dann in f√ºnf Minuten zu fliegen (Schreibger√§te sind trivial)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>