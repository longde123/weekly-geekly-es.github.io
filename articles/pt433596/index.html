<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî≤ üë®üèø‚Äçü§ù‚Äçüë®üèΩ üë®‚Äçüë®‚Äçüëß‚Äçüëß Erro de Magalh√£es: satura√ß√£o de buffer ou expedi√ß√£o ao redor do mundo usando SQLite FTS üòÄ üõÄüèæ üíÜ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De alguma forma, contornei o recente erro de Magalh√£es em Habr√© e as vulnerabilidades associadas a ele, tentarei corrigir essa omiss√£o. 
 Um pouco de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erro de Magalh√£es: satura√ß√£o de buffer ou expedi√ß√£o ao redor do mundo usando SQLite FTS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433596/"><p>  De alguma forma, contornei o recente erro de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Magalh√£es</a> em Habr√© e as vulnerabilidades associadas a ele, tentarei corrigir essa omiss√£o. </p><br><h4 id="nemnogo-istorii">  Um pouco de hist√≥ria </h4><br><ul><li>  Em 1 de novembro de 2018, um relat√≥rio de bug n√∫mero 900910 chegou ao Chromium: "V√°rios problemas no SQLite via WebSQL".  O erro √© relatado por Wenxiang Qian da Equipe Tencent Blade. </li><li>  Em 5 de novembro de 2018, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">erro foi encerrado</a> no n√∫cleo da biblioteca SQLite (FTS3), onde ele vive praticamente desde o momento em que o m√≥dulo foi criado, ou seja,  desde novembro de 2009. </li><li>  28 de novembro de 2018, ele se funde no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Chromium</a> </li><li>  Um pouco mais tarde, a Equipe Blade Tencent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">publica</a> uma mensagem de erro, dando o nome de Magalh√£es, especialmente sem revelar detalhes, e indicando que a publica√ß√£o de explora√ß√µes prontas e PoC ainda n√£o est√° planejada. </li><li> Uma semana depois, a Internet est√° cheia de PoC, travando o Chrome, o Electron dev-framework, etc.  As evid√™ncias e outras informa√ß√µes de que a vulnerabilidade foi usada para fins maliciosos ainda n√£o s√£o. </li><li>  <abbr title="Dr. D. Richard Hipp, criador do SQLite e autor da corre√ß√£o">DRH</abbr> , confirmou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">suspeitas no Hacker News de</a> que a vulnerabilidade existe (pelo menos se a execu√ß√£o de uma consulta SQL "estrangeira" for permitida ou uma inje√ß√£o de SQL de um cen√°rio semelhante). </li></ul><br><h4 id="chto-mozhet-byt-podverzheno-uyazvimosti">  O que poderia ser vulner√°vel? </h4><br><p>  Potencialmente, todos os dispositivos e programas usando SQLite (com FTS ativado) ou usando ou com base em aplicativos baseados nele (como o Chromium).  A extens√£o em que eles podem ser afetados e o efeito de uma poss√≠vel "perda" depende se um vetor de ataque adequado √© encontrado. </p><br><h4 id="nemnogo-podrobnee-o-magellan-sqlite-bughttpsbladetencentcommagellanindex_enhtml">  Um pouco mais sobre o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Magellan SQLite BUG</a> </h4><a name="habracut"></a><br><p>  O erro est√° associado ao estouro da soma de n√∫meros inteiros, tamb√©m conhecido como <abbr title="na programa√ß√£o, a soma dos dois termos pode subitamente ser menor que a maior">estouro de n√∫mero inteiro</abbr> , que pode ser causado no subsistema <abbr title="m√≥dulo de √≠ndice de texto completo embutido do SQLite">FTS3 / 4</abbr> alterando o √≠ndice FTS da tabela, que por sua vez pode levar √† reescrita da mem√≥ria ou √† finaliza√ß√£o com uma exce√ß√£o. </p><br><p>  A aplica√ß√£o artificial direcionada desse estouro inteiro, atrav√©s do "corte" competente de buffers de grava√ß√£o, leva ao estouro de mem√≥ria e pode ser usada no futuro por consultas SQL especialmente criadas. </p><br><p>  Como resultado, em teoria, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">muitos aplicativos</a> que usam SQLite (com tabelas FTS virtuais) e, em particular, navegadores populares que suportam SQLite com base em SQLite com FTS ativado (por exemplo, Google Chrome, Chromium, Opera, Slimjet Browser, SRWare Iron, Torch, podem ser vulner√°veis). Drag√£o Comodo, CoolNovo, Navegador Yandex, Vivaldi, etc.). </p><br><p>  Os bancos de dados SQLite geralmente s√£o muito populares, fornecidos por mais de uma d√∫zia de linguagens de programa√ß√£o, cadeia de ferramentas, estruturas etc., s√£o usados ‚Äã‚Äãpor aplicativos para dispositivos m√≥veis e computadores completos e geralmente s√£o encontrados at√© em solu√ß√µes de servidor.  Por exemplo, navegadores da web populares como Google Chrome, Mozilla Firefox e Yandex Browser, muitos mensageiros instant√¢neos (por exemplo, WhatsApp, Viber, WeChat e outros) armazenam dados nesse formato etc.  etc. </p><br><p>  O mesmo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fossil SCM</a> , por exemplo, usa o banco de dados SQLite para armazenar o hist√≥rico de revis√µes e permite usar a indexa√ß√£o de texto completo por meio do FTS (e fornece acesso a ele a partir do focinho da interface do usu√°rio / web, onde, por exemplo, existe a possibilidade de criar suas pr√≥prias consultas SQL, por exemplo, relat√≥rios de tickets personalizados etc.) </p><br><p>  <em>Atualiza√ß√£o: DRH, co-autor e desenvolvedor do Fossil, aparentemente pensou a mesma coisa e j√° " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fechou o buraco</a> " atualizando o SQLite para 3.26.0</em> </p><br><p>  Esse excesso "previs√≠vel" n√£o √© algo muito agrad√°vel por si s√≥, mas se voc√™ se lembra do que exatamente pode ser armazenado no pr√≥prio banco (do conte√∫do das revistas √†s pr√≥prias tabelas) ... <br>  Portanto, n√£o seja camarada pregui√ßoso ... e seja atualizado, atualizado. </p><br><h4 id="gde-vzyat-fiks">  Onde conseguir a corre√ß√£o? </h4><br><p>  O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">patch [940f2adc8541a838] √©</a> fornecido como parte da atualiza√ß√£o do SQLite 3.25.3 (para a qual Chromium e companhia. Tamb√©m foram atualizados, por exemplo, Chrome na vers√£o 71.0.3578.80). </p><br><p>  O SQLite vers√£o 3.26 tamb√©m fornece recursos de seguran√ßa adicionais para cont√™ineres FTS, por exemplo: </p><blockquote>  suporte para tabelas de sombra somente leitura quando a op√ß√£o SQLITE_DBCONFIG_DEFENSIVE est√° ativada </blockquote><br><h4 id="kakova-opasnost-etoy-uyazvimosti">  Qual √© o perigo dessa vulnerabilidade? </h4><br><p>  Cr√≠tico.  Permite a execu√ß√£o remota de c√≥digo.  Um vazamento de mem√≥ria e falha no programa tamb√©m s√£o prov√°veis. </p><br><h4 id="est-li-primery-gotovyh-exploit-ov-pozvolyayuschie-ispolzovat-uyazvimost">  Existem exemplos de explora√ß√µes prontas para explorar a vulnerabilidade? </h4><br><p>  Sim </p><br><p>  Em particular, a equipe Tencent Blade afirma que executou com sucesso um ataque ao Google Home usando esta vulnerabilidade (o acesso √† descri√ß√£o do problema no rastreador de bugs do Google est√° fechado) e, como mencionado acima, n√£o h√° nenhum plano para divulgar o c√≥digo de explora√ß√£o no momento. </p><br><h4 id="usloviya-ispolzovaniya-uyazvimosti">  Termos de uso da vulnerabilidade? </h4><br><p>  A vulnerabilidade pode ser executada remotamente, por exemplo, quando uma determinada p√°gina da web √© acessada em um navegador ou em um cen√°rio semelhante, por exemplo, permitindo executar instru√ß√µes SQL (se o FTS n√£o estiver desativado, se um poss√≠vel vetor de ataque for detectado e / ou a presen√ßa ou ocorr√™ncia de outros fatores que facilitam a explora√ß√£o vulnerabilidades). </p><br><p>  Este, ali√°s, n√£o √© o primeiro erro do tipo overflow e satura√ß√£o de buffer no SQLite especificamente e no m√≥dulo FTS em particular (por exemplo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">[56be976859294027]</a> ), mas √© provavelmente o maior de seu tipo em significado, impacto te√≥rico e "escala" relativa nas formas de aplica√ß√£o e avalia√ß√£o poss√≠veis das consequ√™ncias disso. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt433596/">https://habr.com/ru/post/pt433596/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt433580/index.html">Roskomnadzor planeja introduzir um novo sistema de fechaduras no valor de 20 bilh√µes de rublos</a></li>
<li><a href="../pt433582/index.html">E se a participa√ß√£o nos lucros 30/70 deixar de ser um padr√£o para desenvolvedores de jogos?</a></li>
<li><a href="../pt433586/index.html">Como n√£o vencemos o hackathon</a></li>
<li><a href="../pt433588/index.html">Desempenho surpreendente de algoritmos paralelos C ++ 17. Mito ou Realidade?</a></li>
<li><a href="../pt433592/index.html">Informa√ß√µes: Yandex.Phone</a></li>
<li><a href="../pt433598/index.html">Como o LLVM otimiza a fun√ß√£o</a></li>
<li><a href="../pt433600/index.html">O Pixel 3 aprende como determinar a profundidade nas fotos</a></li>
<li><a href="../pt433602/index.html">A simplicidade matem√°tica pode estar na base da velocidade da evolu√ß√£o.</a></li>
<li><a href="../pt433604/index.html">Trabalho confort√°vel com o Android Studio</a></li>
<li><a href="../pt433606/index.html">Profundidades do SIEM: correla√ß√µes prontas para uso. Parte 3.2 Metodologia de Normaliza√ß√£o de Eventos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>