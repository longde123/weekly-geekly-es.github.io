<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñêüèΩ üè≥Ô∏è‚Äçüåà ‚úçüèæ Votre chemin, graphique: comment nous n'avons pas trouv√© un bon graphique de r√©seau et avons cr√©√© le notre üëµüèΩ üßôüèª ‚õ≥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Enqu√™tant sur les cas d'hame√ßonnage, de r√©seaux de zombies, de transactions frauduleuses et de groupes de pirates informatiques, les experts du Groupe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Votre chemin, graphique: comment nous n'avons pas trouv√© un bon graphique de r√©seau et avons cr√©√© le notre</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/461639/"><img src="https://habrastorage.org/webt/5w/z_/im/5wz_imjcrurw4gk_wubv6gqanig.jpeg"><br><br>  Enqu√™tant sur les cas d'hame√ßonnage, de r√©seaux de zombies, de transactions frauduleuses et de groupes de pirates informatiques, les experts du Groupe IB utilisent depuis de nombreuses ann√©es l'analyse graphique pour identifier toutes sortes de connexions.  Diff√©rents cas ont leurs propres tableaux de donn√©es, leurs propres algorithmes d'identification de connexion et des interfaces adapt√©es √† des t√¢ches sp√©cifiques.  Tous ces outils √©taient un d√©veloppement interne du Groupe-IB et n'√©taient disponibles que pour nos employ√©s. <br><br>  L'analyse graphique de l'infrastructure r√©seau ( <i>graphique r√©seau</i> ) a √©t√© le premier outil interne que nous avons int√©gr√© √† tous les produits publics de l'entreprise.  Avant de cr√©er notre propre graphique de r√©seau, nous avons analys√© de nombreux d√©veloppements similaires sur le march√© et n'avons pas trouv√© un seul produit qui satisferait nos propres besoins.  Dans cet article, nous parlerons de la fa√ßon dont nous avons cr√©√© le graphique de r√©seau, comment l'utiliser et quelles difficult√©s nous avons rencontr√©es. <br><br>  <b>Dmitry Volkov,</b> CTO Group-IB et responsable Cyber ‚Äã‚ÄãIntelligence <a name="habracut"></a><br><br><h1>  <font color="#e63619">Que peut faire un graphe de r√©seau Group-IB?</font> </h1><br><h3>  Enqu√™tes </h3><br>  Depuis la cr√©ation du Groupe IB en 2003 jusqu'√† aujourd'hui, l'identification, le deanon et la responsabilisation des cybercriminels ont √©t√© la principale priorit√© de notre travail.  Aucune enqu√™te sur une cyberattaque ne pourrait se passer d'une analyse de l'infrastructure r√©seau de l'attaquant.  Au tout d√©but de notre parcours, il a √©t√© assez p√©nible de ¬´travailler manuellement¬ª pour trouver des relations qui pourraient aider √† identifier les criminels: informations sur les noms de domaine, les adresses IP, les empreintes digitales des serveurs, etc. <br><br>  La plupart des attaquants tentent d'agir le plus anonymement possible sur le r√©seau.  Cependant, comme tout le monde, ils font des erreurs.  La t√¢che principale de cette analyse est de trouver les projets historiques ¬´blancs¬ª ou ¬´gris¬ª des attaquants qui se croisent avec l'infrastructure malveillante utilis√©e dans l'incident r√©el sur lequel nous enqu√™tons.  S'il est possible de d√©tecter des "projets blancs", alors trouver l'attaquant, en r√®gle g√©n√©rale, devient une t√¢che triviale.  Dans le cas des ¬´gris¬ª, la recherche demande plus de temps et d'efforts, car leurs propri√©taires tentent d'anonymiser ou de masquer les donn√©es d'enregistrement, mais les chances restent assez √©lev√©es.  En r√®gle g√©n√©rale, au d√©but de leur activit√© criminelle, les attaquants accordent moins d'attention √† leur propre s√©curit√© et commettent plus d'erreurs, de sorte que plus nous pouvons plonger dans l'histoire, plus les chances de r√©ussite de l'enqu√™te sont grandes.  C'est pourquoi un graphique de r√©seau avec une bonne histoire est un √©l√©ment extr√™mement important d'une telle enqu√™te.  Autrement dit, plus les donn√©es historiques d'une entreprise sont profondes, meilleur est son graphique.  Supposons qu'une histoire de 5 ans peut aider √† r√©soudre, conditionnellement, 1 √† 2 des 10 crimes, et qu'une histoire de 15 ans donne une chance de r√©soudre les dix. <br><br><h3>  D√©tection du phishing et de la fraude </h3><br>  Chaque fois que nous recevons un lien suspect vers des ressources de phishing, frauduleuses ou pirat√©es, nous cr√©ons automatiquement un graphique des ressources r√©seau associ√©es et v√©rifions que tous les h√¥tes trouv√©s contiennent un contenu similaire.  Cela vous permet de trouver √† la fois d'anciens sites de phishing actifs mais inconnus et de nouveaux sites pr√©par√©s pour de futures attaques, mais qui ne sont pas encore utilis√©s.  Un exemple √©l√©mentaire assez courant: nous avons trouv√© un site de phishing sur un serveur avec seulement 5 sites.  En v√©rifiant chacun d'eux, nous trouvons √©galement du contenu de phishing sur d'autres sites, ce qui signifie que nous pouvons bloquer 5 au lieu de 1. <br><br><h3>  Recherche backend </h3><br>  Ce processus est n√©cessaire pour d√©terminer o√π se trouve r√©ellement le serveur malveillant. <br>  99% des magasins de cartes, des forums de piratage, de nombreuses ressources de phishing et d'autres serveurs malveillants se cachent derri√®re leurs propres serveurs proxy et les proxys de services l√©gitimes, par exemple Cloudflare.  Conna√Ætre le vrai backend est tr√®s important pour les investigations: il devient connu le fournisseur d'h√©bergement duquel vous pouvez supprimer le serveur, il devient possible d'√©tablir des connexions avec d'autres projets malveillants. <br><br>  Par exemple, vous disposez d'un site de phishing pour collecter les donn√©es de carte bancaire qui se r√©sout √† l'adresse IP 11/11/11/11, et une adresse de magasin de cartes qui se r√©sout √† l'adresse IP 22.22.22.22.  Au cours de l'analyse, il peut s'av√©rer que le site de phishing et la boutique de cartes ont une adresse IP principale commune, par exemple, 33.33.33.33.  Cette connaissance vous permet de cr√©er un lien entre les attaques de phishing et une boutique de cartes sur laquelle, peut-√™tre, ils vendent des donn√©es de carte bancaire. <br><br><h3>  Corr√©lation d'√©v√©nements </h3><br>  Lorsque vous avez deux d√©clencheurs diff√©rents (par exemple, sur IDS) avec diff√©rents logiciels malveillants et diff√©rents serveurs pour contr√¥ler l'attaque, vous les consid√©rerez comme deux √©v√©nements ind√©pendants.  Mais s'il existe une bonne connexion entre les infrastructures malveillantes, il devient √©vident qu'il ne s'agit pas d'attaques diff√©rentes, mais d'√©tapes d'une attaque multi-√©tapes plus complexe.  Et si l'un des √©v√©nements est d√©j√† attribu√© √† un groupe d'attaquants, le second peut √©galement √™tre attribu√© au m√™me groupe.  Bien s√ªr, le processus d'attribution est beaucoup plus complexe, alors consid√©rez l'√©criture comme un exemple simple. <br><br><h3>  Indicateurs d'enrichissement </h3><br>  Nous n'y pr√™terons pas beaucoup d'attention, car c'est le sc√©nario le plus courant pour utiliser des graphiques en cybers√©curit√©: vous donnez un indicateur √† l'entr√©e et vous obtenez un tableau d'indicateurs associ√©s √† la sortie. <br><br><h3>  D√©tection de mod√®le </h3><br>  L'identification des patrons est essentielle pour une chasse efficace.  Les graphiques permettent non seulement de trouver des √©l√©ments li√©s, mais aussi de r√©v√©ler des propri√©t√©s communes inh√©rentes √† un certain groupe de pirates.  La connaissance de ces fonctionnalit√©s uniques vous permet de reconna√Ætre l'infrastructure de l'attaquant m√™me au stade de la pr√©paration et sans preuve confirmant l'attaque, comme les e-mails de phishing ou les logiciels malveillants. <br><br><h1>  <font color="#e63619">Pourquoi avons-nous cr√©√© notre propre graphique de r√©seau?</font> </h1><br>  Je r√©p√®te que nous avons envisag√© des solutions de diff√©rents fournisseurs avant de conclure que nous devons d√©velopper notre propre outil capable de faire ce qui ne se trouve dans aucun produit existant.  Il a fallu plusieurs ann√©es pour le cr√©er, au cours desquelles nous l'avons compl√®tement chang√© plus d'une fois.  Mais, malgr√© la longue p√©riode de d√©veloppement, nous n'avons toujours pas trouv√© un seul analogue qui satisferait nos exigences.  En utilisant notre propre produit, nous avons pu r√©soudre presque tous les probl√®mes que nous avons trouv√©s dans les graphiques de r√©seau existants.  Ci-dessous, nous examinons ces probl√®mes en d√©tail: <br><br><div class="scrollable-table"><table><tbody><tr><th width="350">  Le probl√®me </th><th width="350">  Solution </th></tr><tr><td>  Absence de fournisseur avec diff√©rentes collections de donn√©es: domaines, DNS passif, SSL passif, enregistrements DNS, ports ouverts, ex√©cution de services sur les ports, fichiers qui interagissent avec les noms de domaine et les adresses IP.  Explication.  Les fournisseurs fournissent g√©n√©ralement des types de donn√©es distincts, et pour obtenir une image compl√®te, vous devez acheter des abonnements √† tout le monde.  Mais m√™me ainsi, il n'est pas toujours possible d'obtenir toutes les donn√©es: certains fournisseurs SSL passifs ne fournissent que des donn√©es sur les certificats √©mis par des autorit√©s de certification de confiance, et la couverture des certificats auto-sign√©s est extr√™mement faible.  D'autres fournissent des donn√©es sur les certificats auto-sign√©s, mais les collectent uniquement √† partir de ports standard. </td><td>  Nous avons collect√© nous-m√™mes toutes les collections ci-dessus.  Par exemple, pour collecter des donn√©es sur les certificats SSL, nous avons √©crit notre propre service qui les collecte aupr√®s des autorit√©s de certification de confiance et en analysant l'int√©gralit√© de l'espace IPv4.  Les certificats ont √©t√© collect√©s non seulement sur IP, mais √©galement sur tous les domaines et sous-domaines de notre base de donn√©es: si vous avez le domaine example.com et son sous-domaine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.example.com</a> et qu'ils se r√©solvent tous en IP 1.1.1.1, alors lorsque vous essayez d'obtenir SSL- certificat du port 443 par IP, domaine et son sous-domaine, vous pouvez obtenir trois r√©sultats diff√©rents.  Pour collecter des donn√©es sur des ports ouverts et des services en cours d'ex√©cution, j'ai d√ª cr√©er mon propre syst√®me de scan distribu√©, car pour d'autres services les adresses IP des serveurs de scan √©taient souvent dans les ¬´listes noires¬ª.  Nos serveurs d'analyse sont √©galement sur liste noire, mais le r√©sultat de la recherche des services dont nous avons besoin est plus √©lev√© que ceux qui analysent simplement autant de ports que possible et vendent l'acc√®s √† ces donn√©es. </td></tr><tr><td>  Manque d'acc√®s √† la base de donn√©es compl√®te des documents historiques.  Explication.  Chaque fournisseur normal a un bon historique accumul√©, mais pour des raisons naturelles, nous, en tant que client, n'avons pas pu acc√©der √† toutes les donn√©es historiques.  C'est-√†-dire  vous pouvez obtenir toute l'histoire par un enregistrement s√©par√©, par exemple, par domaine ou adresse IP, mais vous ne pouvez pas voir l'historique de tout - et sans cela, vous ne pouvez pas voir l'image enti√®re. </td><td>  Pour collecter autant d'enregistrements historiques par domaine que possible, nous avons achet√© diverses bases de donn√©es, analys√© de nombreuses ressources ouvertes qui poss√©daient cette histoire (il est bon qu'il y en ait beaucoup) et convenu avec les registraires de noms de domaine.  Toutes les mises √† jour dans nos propres collections, bien s√ªr, sont stock√©es avec un historique complet des modifications. </td></tr><tr><td>  Toutes les solutions existantes vous permettent de construire un graphique en mode manuel.  Explication.  Disons que vous avez achet√© de nombreux abonnements aupr√®s de tous les fournisseurs de donn√©es possibles (ils sont g√©n√©ralement appel√©s ¬´enrichissement¬ª).  Lorsque vous avez besoin de construire un graphique, vous donnez la commande ¬´mains¬ª pour construire √† partir de l'√©l√©ment de communication souhait√©, puis parmi les √©l√©ments apparus, s√©lectionnez ceux qui sont n√©cessaires et donnez la commande pour compl√©ter les connexions √† partir d'eux, et ainsi de suite.  Dans ce cas, la responsabilit√© de la fa√ßon dont le graphique sera construit incombe enti√®rement √† la personne. </td><td>  Nous avons fait un graphique automatique.  C'est-√†-dire  si vous avez besoin de construire un graphique, les connexions √† partir du premier √©l√©ment sont automatiquement construites, plus √©loign√©es de toutes les suivantes √©galement.  Le sp√©cialiste indique uniquement la profondeur avec laquelle construire le graphique.  Le processus de remplissage automatique des graphiques est simple, mais d'autres fournisseurs ne l'impl√©mentent pas car cela donne une √©norme quantit√© de r√©sultats non pertinents, et nous avons √©galement d√ª tenir compte de cet inconv√©nient (voir ci-dessous). </td></tr><tr><td>  Beaucoup de r√©sultats non pertinents sont le probl√®me de tous les graphiques sur les √©l√©ments du r√©seau.  Explication.  Par exemple, un ¬´mauvais domaine¬ª (a particip√© √† l'attaque) est associ√© √† un serveur auquel au cours des 10 derni√®res ann√©es 500 autres domaines ont √©t√© associ√©s.  Lors de l'ajout manuel ou de la cr√©ation automatique d'un graphique, tous ces 500 domaines doivent √©galement se d√©placer vers le graphique, bien qu'ils ne soient pas li√©s √† l'attaque.  Ou, par exemple, vous v√©rifiez l'indicateur IP du rapport de s√©curit√© du fournisseur.  En r√®gle g√©n√©rale, ces rapports sortent avec un retard important et couvrent souvent un an ou plus.  Tr√®s probablement, au moment o√π vous lisez le rapport, le serveur avec cette adresse IP est d√©j√† lou√© √† d'autres personnes avec d'autres connexions, et la construction du graphique conduira au fait que vous avez de nouveau re√ßu des r√©sultats non pertinents. </td><td>  Nous avons form√© le syst√®me pour identifier les √©l√©ments non pertinents selon la m√™me logique que nos experts l'ont fait √† la main.  Par exemple, vous v√©rifiez le mauvais domaine example.com, qui se r√©sout d√©sormais en IP 11.11.11.11, et il y a un mois en IP 22.22.22.22.  En plus du domaine example.com, example.ru est associ√© √† IP 11.11.11.11, et 25 000 autres domaines sont associ√©s √† IP 22.22.22.22.  Le syst√®me, comme une personne, comprend que 11.11.11.11 est tr√®s probablement un serveur d√©di√©, et puisque le domaine example.ru est similaire en orthographe √† example.com, alors, avec une forte probabilit√©, ils sont connect√©s et devraient √™tre sur le graphique;  mais l'IP 22.22.22.22 appartient √† l'h√©bergement partag√©, vous n'avez donc pas besoin de mettre tous ses domaines dans le graphique s'il n'y a pas d'autres connexions indiquant qu'un de ces 25 000 domaines doit √©galement √™tre supprim√© (par exemple, example.net).  Avant que le syst√®me ne se rende compte que les connexions doivent √™tre rompues et que certains √©l√©ments ne doivent pas √™tre mis sur le graphique, il prend en compte les nombreuses propri√©t√©s des √©l√©ments et des clusters dans lesquels ces √©l√©ments sont combin√©s, ainsi que la force des connexions actuelles.  Par exemple, si nous avons un petit cluster (50 √©l√©ments) dans le graphique, qui comprend un mauvais domaine, et un autre gros cluster (5 000 √©l√©ments) et les deux clusters sont connect√©s par un lien (ligne) avec une tr√®s faible r√©sistance (poids), alors cette connexion se rompra et les √©l√©ments du grand cluster seront supprim√©s.  Mais s'il existe de nombreux liens entre les petits et les grands clusters et que leur force augmente progressivement, alors dans ce cas, la connexion ne se rompra pas et les √©l√©ments n√©cessaires des deux clusters resteront sur le graphique. <br></td></tr><tr><td>  L'intervalle de propri√©t√© du serveur et du domaine n'est pas pris en compte.  Explication.  L'enregistrement des ¬´mauvais domaines¬ª expire t√¥t ou tard et ils sont rachet√©s √† des fins malveillantes ou l√©gitimes.  M√™me avec un h√©bergement pare-balles, les serveurs sont lou√©s √† diff√©rents pirates, il est donc essentiel de conna√Ætre et de prendre en compte l'intervalle lorsqu'un domaine / serveur particulier √©tait sous le contr√¥le d'un seul propri√©taire.  Nous rencontrons souvent une situation o√π un serveur avec IP 11.11.11.11 est maintenant utilis√© comme C&amp;C pour un bot bancaire, et Ransomware a √©t√© g√©r√© il y a 2 mois.  Si vous √©tablissez une connexion, sans tenir compte des intervalles de propri√©t√©, il semblera qu'il existe une connexion entre les propri√©taires du botnet bancaire et du ransomware, bien que ce ne soit pas le cas.  Dans notre travail, une telle erreur est critique. </td><td>  Nous avons appris au syst√®me √† d√©terminer les intervalles de propri√©t√©.  Pour les domaines, cela est relativement simple, car le whois affiche souvent les dates de d√©but et de fin de l'enregistrement et, lorsqu'il existe un historique complet des modifications du whois, il est facile de d√©terminer les intervalles.  Lorsque le domaine n'a pas expir√©, mais que sa gestion a √©t√© transf√©r√©e √† d'autres propri√©taires, vous pouvez √©galement le suivre.  Il n'y a pas un tel probl√®me pour les certificats SSL, car il est √©mis une fois, il n'est pas renouvel√© et il n'est pas transmis.  Mais pour les certificats auto-sign√©s, vous ne pouvez pas faire confiance aux dates indiqu√©es dans les dates d'expiration des certificats, car vous pouvez g√©n√©rer un certificat SSL aujourd'hui et sp√©cifier la date de d√©but du certificat √† partir de 2010.  Le plus difficile est de d√©terminer les intervalles de propri√©t√© des serveurs, car seuls les h√©bergeurs ont les dates et les baux.  Pour d√©terminer la p√©riode de propri√©t√© du serveur, nous avons commenc√© √† utiliser les r√©sultats de l'analyse des ports et √† cr√©er des empreintes digitales des services en cours d'ex√©cution sur les ports.  Sur la base de ces informations, nous pouvons dire assez pr√©cis√©ment quand le propri√©taire du serveur a chang√©. </td></tr><tr><td>  Peu de connexions.  Explication.  D√©sormais, ce n'est m√™me plus un probl√®me d'obtenir gratuitement une liste de domaines contenant une adresse e-mail sp√©cifique ou de d√©couvrir tous les domaines associ√©s √† une adresse IP sp√©cifique.  Mais, lorsqu'il s'agit de pirates qui font tout leur possible pour rendre le suivi difficile, des ¬´astuces¬ª suppl√©mentaires sont n√©cessaires pour trouver de nouvelles propri√©t√©s et √©tablir de nouvelles connexions. </td><td>  Nous avons pass√© beaucoup de temps √† rechercher comment r√©cup√©rer des donn√©es qui ne sont pas disponibles de la mani√®re habituelle.  Nous ne pouvons pas d√©crire comment cela fonctionne ici pour des raisons √©videntes, mais dans certaines circonstances, les pirates font des erreurs lors de l'enregistrement de domaines ou de la location et de la configuration de serveurs, qui vous permettent de trouver des adresses e-mail, des alias de pirates, des adresses de backend.  Plus vous extrayez de connexions, plus vous pouvez cr√©er de graphiques avec pr√©cision. <br></td></tr></tbody></table></div><br><h1>  <font color="#e63619">Comment fonctionne notre graphique</font> </h1><br>  Pour commencer √† utiliser le graphique r√©seau, vous devez saisir le domaine, l'adresse IP, l'e-mail ou l'empreinte digitale du certificat SSL dans la zone de recherche.  Un analyste peut contr√¥ler trois conditions: le temps, la profondeur de pas et le nettoyage. <br><br><img src="https://habrastorage.org/webt/tc/dp/fy/tcdpfyhagm1jh52ksaklg5ohsko.png"><br><br><h4>  Le temps </h4><br>  Heure - la date ou l'intervalle auquel l'√©l√©ment de recherche a √©t√© utilis√© √† des fins malveillantes.  Si vous ne sp√©cifiez pas ce param√®tre, le syst√®me d√©terminera le dernier intervalle de propri√©t√© de cette ressource.  Par exemple, le 11 juillet, Eset a publi√© un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport</a> sur la fa√ßon dont Buhtrap utilise un exploit de 0 jour pour le cyberespionnage.  √Ä la fin du rapport, il y a 6 indicateurs.  L'un d'eux, Secure-telemetry [.] Net, a √©t√© r√©enregistr√© le 16 juillet.  Par cons√©quent, si vous cr√©ez un graphique apr√®s le 16 juillet, vous recevrez des r√©sultats non pertinents.  Mais si vous indiquez que ce domaine a √©t√© utilis√© avant cette date, alors 126 nouveaux domaines et 69 adresses IP qui ne sont pas r√©pertori√©s dans le rapport Eset tombent sur le graphique: <br><br><ul><li>  ukrfreshnews [.] com </li><li>  unian-search [.] com </li><li>  vesti-world [.] info </li><li>  runewsmeta [.] com </li><li>  foxnewsmeta [.] biz </li><li>  sobesednik-meta [.] info </li><li>  rian-ua [.] net </li><li>  et autres </li></ul><br>  En plus des indicateurs de r√©seau, nous trouvons imm√©diatement des liens vers des fichiers malveillants qui avaient des liens vers cette infrastructure et des balises qui nous indiquent que Meterpreter, AZORult ont √©t√© utilis√©s. <br><br>  La grande chose est que vous obtenez ce r√©sultat en une seconde et que vous n'avez plus besoin de passer des jours √† analyser les donn√©es.  Bien s√ªr, cette approche r√©duit parfois le temps des enqu√™tes de plusieurs fois, ce qui est souvent critique. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h4/oi/an/h4oianoutpvnbrb2f3hhukxxtge.png"></div><br><h4>  Le nombre d'√©tapes ou la profondeur de r√©cursivit√© avec laquelle le graphique sera construit </h4><br>  Par d√©faut, la profondeur est 3. Cela signifie que tous les √©l√©ments directement li√©s seront trouv√©s √† partir de l'√©l√©ment requis, puis chaque nouvel √©l√©ment sera construit de nouvelles connexions √† d'autres √©l√©ments, et √† partir des nouveaux √©l√©ments de la derni√®re √©tape, il y aura de nouveaux √©l√©ments. <br><br>  Prenons un exemple sans rapport avec APT et les exploits √† 0 jour.  Habr√© a r√©cemment d√©crit un cas int√©ressant de fraude li√©e aux crypto-monnaies.  Le rapport mentionne le domaine - themcx [.] Co, utilis√© par les escrocs pour h√©berger le site du soi-disant √©changeur Miner Coin Exchange et la recherche t√©l√©phonique [.] Xyz, pour attirer le trafic. <br><br>  D'apr√®s la description, il est clair que le syst√®me n√©cessite une infrastructure suffisamment grande pour attirer le trafic vers des ressources frauduleuses.  Nous avons d√©cid√© de regarder cette infrastructure en construisant un graphique en 4 √©tapes.  La sortie √©tait un graphique avec 230 domaines et 39 adresses IP.  Ensuite, nous divisons les domaines en 2 cat√©gories: ceux qui sont similaires aux services pour travailler avec les crypto-monnaies et ceux qui sont con√ßus pour capter le trafic via les services de v√©rification t√©l√©phonique: <br><div class="scrollable-table"><table><tbody><tr><th width="350">  Li√© √† la crypto-monnaie </th><th width="350">  Associ√© aux services de poin√ßonnage par t√©l√©phone </th></tr><tr><td>  coinkeeper [.] cc </td><td>  site d'enregistrement des appelants [.]. </td></tr><tr><td>  mcxwallet [.] co </td><td>  enregistrements t√©l√©phoniques [.] espace </td></tr><tr><td>  btcnoise [.] com </td><td>  fone-uncover [.] xyz </td></tr><tr><td>  montre cryptominer [.] </td><td>  num√©ro-d√©couvrir [.] info </td></tr></tbody></table></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/cj/ve/yqcjvezppd6oulazlfojthyfqwk.png"></div><br><h4>  Le nettoyage </h4><br>  Par d√©faut, l'option ¬´Effacer le graphique¬ª est activ√©e et tous les √©l√©ments non pertinents seront supprim√©s du graphique.  Soit dit en passant, il a √©t√© utilis√© dans tous les exemples pr√©c√©dents.  Je pr√©vois une question naturelle: comment s'assurer que quelque chose d'important ne dispara√Æt pas? :  ,     ,         = 1.                 . <br><br>         whois, DNS,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hc/wd/yz/hcwdyzowhht2vljiyxzcspjdgaa.png"></div><br><h3>   </h3><br>     APT- ,               .       ,      ,        ,         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8b/6v/st/8b6vstloohn7p-vq4wqngh-_ara.png"></div><br>         .      ‚Äî lloydsbnk-uk[.]com,          3 ,    250  ,       2015    .       ,     ,       . <br><br>          2 . <br><br> ,    2019               -,          . ,  swift-department.com, saudconsultancy.com, vbgrigoryanpartners.com. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kv/vs/5s/kvvs5sma6yo7kym8lq3fomys67e.png"></div><br><h3> Cobalt gang </h3><br>   2018    Cobalt,      ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/gs/57/gqgs57x9zvmfioavsfo5u-04p1k.png"></div><br>      hXXps://nationalbank.bz/Doc/Prikaz.doc.    ,  powershell,        hXXp://wateroilclub.com/file/dwm.exe  %Temp%\einmrmdmy.exe.  %Temp%\einmrmdmy.exe aka dwm.exe ‚Äî CobInt stager,      hXXp://admvmsopp.com/rilruietguadvtoefmuy. <br><br> ,               .     nationalbank[.]bz       ,           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wa/yv/rg/wayvrgnysrvft9tjv8p_apiwis4.png"></div><br>     IP- 46.173.219[.]152           .    40 , , bl0ckchain[.]ug <br> paypal.co.uk.qlg6[.]pw <br> cryptoelips[.]com <br><br>    ,       ,    ,              ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/he/au/mt/heaumtr6jhhfktfn6qgjttwkzt0.png"></div><br>      nationalbank[.]bz,     ,      500             Cobalt,    . ,      : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pz/kc/f4/pzkcf4fyxxhaqmem5jzwb9ituti.png"></div><br><h1>  <font color="#e63619">Conclusion</font> </h1><br>     ,    ,             ,         .          .    ,        ,     ,   .      ‚Äú‚Äù   ,   .       ,         .               .          Group-IB        .        .  ,   ,         ,   ,     . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr461639/">https://habr.com/ru/post/fr461639/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr461625/index.html">Le condens√© de mat√©riaux int√©ressants pour le d√©veloppeur mobile # 308 (22-28 juillet)</a></li>
<li><a href="../fr461629/index.html">12 √©tapes pour trouver du travail √† distance</a></li>
<li><a href="../fr461631/index.html">17 fa√ßons de p√©n√©trer le r√©seau interne de l'entreprise</a></li>
<li><a href="../fr461633/index.html">√âv√©nements num√©riques √† Moscou du 29 juillet au 04 ao√ªt</a></li>
<li><a href="../fr461637/index.html">Le prince saoudien pr√©voit de construire une ville du futur avec la pluie artificielle, les syst√®mes intelligents et la m√©decine g√©n√©tique</a></li>
<li><a href="../fr461641/index.html">R√©solution de probl√®mes avec pwnable.kr 11-coin1, 12-blackjack, 13-lotto. Erreurs dans la logique d'application</a></li>
<li><a href="../fr461643/index.html">Comment √™tes-vous all√© √† la Alfa Bank School of System Analysis?</a></li>
<li><a href="../fr461645/index.html">Pr√©sentation de SwiftUI: cr√©ation d'une application simple √† l'aide de TableView</a></li>
<li><a href="../fr461647/index.html">5 comp√©tences importantes et manqu√©es n√©cessaires au meilleur d√©veloppeur</a></li>
<li><a href="../fr461649/index.html">Comment vais-je sauver le monde</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>