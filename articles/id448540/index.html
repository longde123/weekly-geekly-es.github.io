<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👜 🚌 🥄 VMware NSX untuk yang terkecil. Bagian 5. Mengkonfigurasi penyeimbang beban 👷🏼 🥪 🌠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bagian Satu Pendahuluan 
 Bagian Dua Konfigurasikan Firewall dan Aturan NAT 
 Bagian tiga. Pengaturan DHCP 
 Bagian Empat Pengaturan rute 

 Terakhir ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VMware NSX untuk yang terkecil. Bagian 5. Mengkonfigurasi penyeimbang beban</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/448540/"><img src="https://habrastorage.org/webt/cs/bv/4v/csbv4vf7zldwjd6etj65xyw309o.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian Satu</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pendahuluan</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian Dua</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Konfigurasikan Firewall dan Aturan NAT</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian tiga.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengaturan DHCP</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian Empat</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pengaturan rute</a> <br><br>  Terakhir kali kita berbicara tentang kemampuan NSX Edge dalam hal perutean statis dan dinamis, dan hari ini kita akan berurusan dengan penyeimbang. <br><br>  Sebelum melanjutkan dengan pengaturan, saya ingin mengingat secara singkat jenis utama penyeimbangan. <br><a name="habracut"></a><br><h3>  Teori </h3><br>  Semua solusi penyeimbangan payload saat ini paling sering dibagi menjadi dua kategori: menyeimbangkan pada level keempat (transportasi) dan ketujuh (diterapkan) dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">model OSI</a> .  Model OSI bukan titik referensi terbaik saat menjelaskan metode penyeimbangan.  Misalnya, jika penyeimbang L4 juga mendukung penghentian TLS, apakah ini kemudian menjadi penyeimbang L7?  Tapi begitulah. <br><br><ul><li>  <b>Penyeimbang L4 adalah yang</b> paling sering berdiri di antara klien dan set backend proxy tengah yang tersedia, yang mengakhiri koneksi TCP (yaitu, merespons secara independen terhadap SYN), memilih backend dan memulai sesi TCP baru ke arahnya, mengirimkan SYN sendiri.  Jenis ini adalah salah satu dasar, opsi lain dimungkinkan. </li><li>  <b>L7 balancer</b> mendistribusikan lalu lintas ke backend yang tersedia "lebih canggih" daripada L4 balancer.  Dia dapat memutuskan backend berdasarkan, misalnya, isi pesan HTTP (URL, cookie, dll.). </li></ul><br>  Terlepas dari jenisnya, penyeimbang dapat mendukung fungsi-fungsi berikut: <br><br><ul><li>  Penemuan layanan adalah proses menentukan set backend yang tersedia (Static, DNS, Consul, Etcd, dll.). </li><li>  Memeriksa kesehatan backend yang terdeteksi ("ping" aktif backend menggunakan permintaan HTTP, deteksi pasif masalah dalam koneksi TCP, keberadaan beberapa 503 kode HTTP dalam jawaban dalam satu baris, dll.). </li><li>  Menyeimbangkan sendiri (round robin, seleksi acak, sumber IP hash, URI). </li><li>  Pengakhiran TLS dan verifikasi sertifikat. </li><li>  Opsi terkait keamanan (otentikasi, pencegahan serangan DoS, batas kecepatan) dan banyak lagi. </li></ul><br>  NSX Edge menawarkan dukungan untuk dua mode penempatan penyeimbang: <br><br>  <b>Mode proxy, atau satu-lengan</b> .  Dalam mode ini, saat mengirim permintaan ke salah satu backend, NSX Edge menggunakan alamat IP-nya sebagai alamat sumber.  Dengan demikian, penyeimbang melakukan fungsi Sumber dan Tujuan NAT.  Backend melihat semua lalu lintas yang dikirim dari penyeimbang dan merespons langsung ke sana.  Dalam skema ini, penyeimbang harus berada di segmen jaringan yang sama dengan server internal. <br><br>  Begini caranya: <br><br><ol><li>  Pengguna mengirim permintaan ke alamat VIP (alamat penyeimbang) yang dikonfigurasi pada Edge. </li><li>  Edge memilih salah satu backend dan melakukan NAT tujuan, mengganti alamat VIP dengan alamat backend yang dipilih. </li><li>  Edge menjalankan source NAT, menggantikan alamat pengguna yang mengirim permintaan dengan miliknya. </li><li>  Paket dikirim ke backend yang dipilih. </li><li>  Backend tidak merespons langsung ke pengguna, tetapi Edge, karena alamat asli pengguna telah diubah ke alamat penyeimbang. </li><li>  Edge mengirimkan respons server ke pengguna. </li></ol><br>  Skema di bawah ini. <br><br><img src="https://habrastorage.org/webt/ta/jx/m5/tajxm5nceoc5z9oeea0_apjftvs.png"><br><br>  <b>Mode transparan, atau sebaris.</b>  Dalam skenario ini, penyeimbang memiliki antarmuka dalam jaringan internal dan eksternal.  Namun, tidak ada akses langsung ke jaringan internal dari eksternal.  Penyeimbang beban bawaan berfungsi sebagai gateway NAT untuk mesin virtual di jaringan internal. <br><br>  Mekanismenya adalah sebagai berikut: <br><br><ol><li>  Pengguna mengirim permintaan ke alamat VIP (alamat penyeimbang) yang dikonfigurasi pada Edge. </li><li>  Edge memilih salah satu backend dan melakukan NAT tujuan, mengganti alamat VIP dengan alamat backend yang dipilih. </li><li>  Paket dikirim ke backend yang dipilih. </li><li>  Backend menerima permintaan dengan alamat asli pengguna (sumber NAT tidak dieksekusi) dan merespons langsung ke sana. </li><li>  Lalu lintas lagi diterima oleh penyeimbang beban, karena dalam skema inline biasanya berfungsi sebagai gateway default untuk server farm. </li><li>  Edge menjalankan source NAT untuk mengirim lalu lintas ke pengguna, menggunakan VIP-nya sebagai alamat IP sumber. </li></ol><br>  Skema di bawah ini. <br><br><img src="https://habrastorage.org/webt/w0/su/z0/w0suz0nii_gq5r4qcmibzge0zja.png"><br><br><h3>  Berlatih </h3><br>  Pada testbed saya, 3 server dengan Apache dikonfigurasi, yang dikonfigurasi untuk bekerja pada HTTPS.  Edge akan menyeimbangkan permintaan HTTPS menggunakan metode round robin, mem-proksi setiap permintaan baru ke server baru. <br><br>  Mari kita mulai. <br><br><h4>  Menghasilkan Sertifikat SSL Yang Akan Menggunakan NSX Edge </h4><br>  Anda dapat mengimpor sertifikat CA yang valid atau menggunakan yang ditandatangani sendiri.  Dalam tes ini, saya akan menggunakan yang ditandatangani sendiri. <br><br><ol><li>  Di antarmuka vCloud Director, buka pengaturan layanan Edge. <br><br><img src="https://habrastorage.org/webt/i-/dq/th/i-dqthihewvxbuenqctf75z02nw.png"></li><li>  Buka tab Sertifikat.  Dari daftar tindakan, pilih penambahan CSR baru. <br><br><img src="https://habrastorage.org/webt/zw/jz/zy/zwjzzymdjpgwylcdi93pus7wmrk.png"></li><li>  Isi kolom yang wajib diisi dan klik Keep. <br><br><img src="https://habrastorage.org/webt/c6/bj/zo/c6bjzodgmz0yepyhwdy00_dhoqg.png"></li><li>  Pilih CSR yang baru dibuat dan pilih opsi CSR yang ditandatangani sendiri. <br><br><img src="https://habrastorage.org/webt/z2/2k/sg/z22ksgjo22tjo1dpgfr-gvutbhu.png"></li><li>  Pilih periode validitas sertifikat dan klik Simpan <br><br><img src="https://habrastorage.org/webt/nl/wh/1w/nlwh1wu3amwefnuies4jxj0tiry.png"></li><li>  Sertifikat yang ditandatangani sendiri muncul di daftar yang tersedia. <br><br><img src="https://habrastorage.org/webt/r9/u5/1q/r9u51qb5gt-rsf0ysyzx4byeezg.png"></li></ol><br><h4>  Konfigurasikan Profil Aplikasi </h4><br>  Profil aplikasi memberi Anda lebih banyak kontrol atas lalu lintas jaringan dan membuatnya mudah dan efisien.  Dengan bantuan mereka, Anda dapat menentukan perilaku untuk jenis lalu lintas tertentu. <br><br><ol><li>  Buka tab Load Balancer dan nyalakan balancer.  Opsi Akselerasi yang diaktifkan di sini memungkinkan penyeimbang untuk menggunakan penyeimbangan L4 lebih cepat daripada L7. <br><br><img src="https://habrastorage.org/webt/tr/gy/vb/trgyvbidsrd3xyyh-g6gis9igms.png"></li><li>  Buka tab Profil aplikasi untuk mengatur profil aplikasi.  Klik +. <br><br><img src="https://habrastorage.org/webt/nm/ng/aq/nmngaqjer2nwulb1mtrqttk0s0u.png"></li><li>  Tetapkan nama profil dan pilih jenis lalu lintas untuk mana profil akan diterapkan.  Saya akan menjelaskan beberapa parameter. <br><br>  <b>Kegigihan</b> - menyimpan dan melacak data sesi, misalnya: server spesifik mana dari kolam yang melayani permintaan pengguna.  Ini memastikan bahwa permintaan pengguna dikirim ke anggota kumpulan yang sama sepanjang masa sesi atau sesi berikutnya. <br><br>  <b>Aktifkan SSL lolos</b> - ketika opsi ini dipilih, NSX Edge berhenti mengakhiri SSL.  Sebaliknya, penghentian terjadi langsung pada server yang melakukan penyeimbangan. <br><br>  <b>Masukkan X-Forwarded-For HTTP header</b> - memungkinkan Anda untuk menentukan alamat IP sumber klien yang terhubung ke server web melalui penyeimbang. <br><br>  <b>Aktifkan Pool Side SSL</b> - memungkinkan Anda menentukan bahwa kumpulan yang dipilih terdiri dari server HTTPS. <br><br><img src="https://habrastorage.org/webt/ah/bm/i9/ahbmi974xepvaiwrqwtxy4uio6u.png"></li><li>  Karena saya akan menyeimbangkan lalu lintas HTTPS, saya harus mengaktifkan Pool Side SSL dan memilih sertifikat yang sebelumnya dibuat di Sertifikat Server Virtual -&gt; tab Sertifikat Layanan. <br><br><img src="https://habrastorage.org/webt/w2/ij/jn/w2ijjndohiaackavyj05iwjudpg.png"></li><li>  Demikian pula untuk Pool Certificate -&gt; Service Certificate. <br><br><img src="https://habrastorage.org/webt/hn/5j/sy/hn5jsy5-tnudpfdcpome_wqwu0i.png"></li></ol><br><h4>  Kami membuat kumpulan server, lalu lintas ke mana Pools akan diseimbangkan </h4><br><ol><li>  Buka tab Pools.  Klik +. <br><br><img src="https://habrastorage.org/webt/1x/2c/e-/1x2ce--4asvoflplvlaiklfukhc.png"></li><li>  Atur nama kumpulan, pilih algoritme (saya akan menggunakan round robin) dan tipe pemantauan untuk pemeriksaan kesehatan backend. Opsi Transparan menunjukkan apakah sumber klien IP awal terlihat oleh server internal. <br><br><ul><li>  Jika opsi ini dinonaktifkan, lalu lintas untuk server internal berasal dari IP sumber penyeimbang. <br></li><li>  Jika opsi ini diaktifkan, server internal melihat klien IP sumber.  Dalam konfigurasi ini, NSX Edge harus bertindak sebagai gateway default untuk memastikan bahwa paket yang dikembalikan melewati NSX Edge. </li></ul><br>  NSX mendukung algoritma balancing berikut: <br><br><ul><li>  <b>IP_HASH</b> - pemilihan server berdasarkan hasil fungsi hash untuk IP sumber dan tujuan setiap paket. </li><li>  <b>LEASTCONN</b> - menyeimbangkan koneksi yang masuk, tergantung pada jumlah yang sudah tersedia di server tertentu.  Koneksi baru akan diarahkan ke server dengan jumlah koneksi paling sedikit. </li><li>  <b>ROUND_ROBIN</b> - koneksi baru dikirim ke setiap server secara bergantian, sesuai dengan bobot yang ditentukan. </li><li>  <b>URI</b> - bagian kiri URI (sebelum tanda tanya) dipotong dan dibagi dengan total berat server di kumpulan.  Hasilnya menunjukkan server mana yang menerima permintaan, memastikan bahwa permintaan selalu dialihkan ke server yang sama, selama semua server tetap tersedia. </li><li>  <b>HTTPHEADER</b> - menyeimbangkan berdasarkan header HTTP tertentu, yang dapat ditentukan sebagai parameter.  Jika tajuknya hilang atau tidak memiliki arti, algoritma ROUND_ROBIN digunakan. </li><li>  <b>URL</b> - setiap permintaan GET HTTP mencari parameter URL yang ditentukan sebagai argumen.  Jika parameter diikuti oleh tanda dan nilai yang sama, maka nilainya hash dan dibagi dengan total berat server yang berjalan.  Hasilnya menunjukkan server mana yang menerima permintaan.  Proses ini digunakan untuk melacak ID pengguna dalam permintaan dan untuk memastikan bahwa id pengguna yang sama selalu dikirim ke server yang sama, selama semua server tetap tersedia. </li></ul><br><img src="https://habrastorage.org/webt/ru/a-/w1/rua-w1fjpzumfbu92ujeakfw0hm.png"></li><li>  Di blok Anggota, klik + untuk menambahkan server ke kumpulan. <br><br><img src="https://habrastorage.org/webt/qd/io/cf/qdiocfo-f-kjw6aot0q9ekbd37i.png"><br><br>  Di sini Anda perlu menentukan: <br><br><ul><li>  nama server </li><li>  Alamat IP server; </li><li>  port tempat server akan menerima lalu lintas; </li><li>  port untuk pemeriksaan kesehatan (Monitor pemeriksaan kesehatan); </li><li>  Bobot - dengan parameter ini Anda dapat menyesuaikan jumlah lalu lintas yang diterima proporsional untuk anggota tertentu dari kumpulan; </li><li>  Max Connections - jumlah maksimum koneksi ke server; </li><li>  Koneksi Min - jumlah minimum koneksi yang harus diproses server sebelum lalu lintas dialihkan ke anggota kumpulan berikutnya. </li></ul><br><img src="https://habrastorage.org/webt/wi/re/hv/wirehvt2ivslsykeopxoeuvrhky.png"><br><br>  Inilah yang tampak seperti kumpulan terakhir dari tiga server. <br><br><img src="https://habrastorage.org/webt/u1/t1/xs/u1t1xsnzgp9-zs4odzuklgark30.png"></li></ol><br><h4>  Tambahkan Server Virtual </h4><br><ol><li>  Buka tab Server Virtual.  Klik +. <br><br><img src="https://habrastorage.org/webt/k5/pt/j0/k5ptj0t6ziwg25ec17vcjntpgzm.png"></li><li>  Kami mengaktifkan server virtual menggunakan Enable Virtual Server. <br><br>  Kami memberinya nama, pilih Profil Aplikasi yang dibuat sebelumnya, Pool dan tentukan alamat IP yang akan menerima permintaan Virtual Server dari luar.  Tentukan protokol dan port 443 HTTPS. <br>  Parameter opsional di sini: <br><br>  <b>Batas Koneksi</b> - jumlah maksimum koneksi simultan yang dapat ditangani oleh server virtual; <br>  <b>Batas Tingkat Koneksi (CPS)</b> - Jumlah maksimum permintaan masuk baru per detik. <br><br><img src="https://habrastorage.org/webt/xa/rp/xu/xarpxupxblhb_tt0qsatlfn5b-m.png"></li></ol><br><br>  Ini melengkapi konfigurasi penyeimbang, Anda dapat memeriksa kinerjanya.  Server memiliki konfigurasi paling sederhana, yang memungkinkan Anda memahami server mana dari kolam yang memproses permintaan.  Selama penyiapan, kami memilih algoritma penyeimbang Round Robin, dan parameter Bobot untuk setiap server sama dengan satu, sehingga setiap permintaan berikutnya akan diproses oleh server berikutnya dari kumpulan. <br><br>  Masukkan alamat eksternal penyeimbang di browser dan lihat: <br><br><img src="https://habrastorage.org/webt/nt/he/7u/nthe7uim5gmdqb9odzyub_hdkeq.png"><br><br>  Setelah menyegarkan halaman, permintaan akan diproses oleh server berikut: <br><br><img src="https://habrastorage.org/webt/ke/d1/xf/ked1xfdi_nmdye9ci5nswvgzjaq.png"><br><br>  Dan lagi - untuk memeriksa server ketiga dari kolam: <br><br><img src="https://habrastorage.org/webt/nu/uo/8u/nuuo8uvhb1dq2tozx2nrtjwfo68.png"><br><br>  Saat memeriksa, Anda dapat melihat bahwa sertifikat yang dikirimkan Edge kepada kami adalah sama dengan yang kami hasilkan di awal. <br><br>  Periksa status penyeimbang dari konsol Edge gateway.  Untuk melakukan ini, masukkan <b>tampilkan pool layanan loadbalancer</b> . <br><br><img src="https://habrastorage.org/webt/ba/_6/jq/ba_6jqyhlyemoguhvwshmhgabbq.png"><br><br><h4>  Konfigurasikan Monitor Layanan untuk memeriksa status server di kumpulan </h4><br>  Menggunakan Service Monitor, kita dapat memonitor status server di backend pool.  Jika respons terhadap permintaan tidak sesuai dengan yang diharapkan, server dapat ditarik dari kumpulan sehingga tidak menerima permintaan baru. <br><br>  Secara default, tiga metode verifikasi dikonfigurasikan: <br><br><ul><li>  Monitor TCP </li><li>  Monitor HTTP </li><li>  HTTPS-monitor. </li></ul><br>  Buat yang baru. <br><br><ol><li>  Buka tab Pemantauan Layanan, klik +. <br><br><img src="https://habrastorage.org/webt/i_/ca/e4/i_cae4kdihjj0ewts1v1d-yeeog.png"></li><li>  Pilih: <br><br><ul><li>  nama untuk metode baru; </li><li>  interval di mana permintaan akan dikirim, </li><li>  batas waktu respons </li><li>  tipe pemantauan adalah permintaan HTTPS menggunakan metode GET, kode status yang diharapkan adalah 200 (OK) dan URL permintaan. </li></ul></li><li>  Ini melengkapi konfigurasi Monitor Layanan baru, sekarang kita dapat menggunakannya saat membuat kumpulan. <br><br><img src="https://habrastorage.org/webt/by/vj/ea/byvjea2dm23pabgtmueiedehzhq.png"></li></ol><br><h4>  Konfigurasikan Aturan Aplikasi </h4><br>  Aturan Aplikasi adalah cara untuk memanipulasi traffic berdasarkan pemicu spesifik.  Dengan menggunakan alat ini, kita dapat membuat aturan penyeimbangan muatan tingkat lanjut, yang mungkin tidak dapat dikonfigurasi melalui profil Aplikasi atau menggunakan layanan lain yang tersedia di Edge Gateway. <br><br><ol><li>  Untuk membuat aturan, buka tab Aturan Aplikasi penyeimbang. <br><br><img src="https://habrastorage.org/webt/lc/ff/uw/lcffuwfhhtf6nn1emi7_e-3cjdu.png"></li><li>  Pilih nama, skrip yang akan menggunakan aturan, dan klik Simpan. <br><br><img src="https://habrastorage.org/webt/1y/a-/o0/1ya-o0rss2uga8gzuasij20yd70.png"></li><li>  Setelah aturan dibuat, kita perlu mengedit Virtual Server yang sudah dikonfigurasi. <br><br><img src="https://habrastorage.org/webt/xg/ha/jf/xghajfs-6ntwycerfn_nun0wvlq.png"></li><li>  Di tab Tingkat Lanjut, tambahkan aturan yang kami buat. <br><br><img src="https://habrastorage.org/webt/le/zv/vs/lezvvste4xmuvdzj4l8jrp5trbq.png"></li></ol><br><br>  Pada contoh di atas, kami telah menyertakan dukungan tlsv1. <br><br>  Beberapa contoh lagi: <br><br>  Arahkan lalu lintas ke kumpulan lain. <br><br>  Dengan skrip ini, kita dapat mengarahkan lalu lintas ke kumpulan penyeimbang lain jika kumpulan utama tidak berfungsi.  Agar aturan berfungsi, beberapa kumpulan harus dikonfigurasi pada penyeimbang dan semua anggota kumpulan utama harus dalam kondisi down.  Tentukan nama pool, bukan ID-nya. <br><br><pre><code class="plaintext hljs">acl pool_down nbsrv(PRIMARY_POOL_NAME) eq 0 use_backend SECONDARY_POOL_NAME if PRIMARY_POOL_NAME</code> </pre> <br>  Arahkan lalu lintas ke sumber daya eksternal. <br><br>  Di sini kita mengarahkan lalu lintas ke situs web eksternal jika semua anggota kelompok utama berada dalam kondisi tidak aktif. <br><br><pre> <code class="plaintext hljs">acl pool_down nbsrv(NAME_OF_POOL) eq 0 redirect location http://www.example.com if pool_down</code> </pre> <br>  Lebih banyak contoh di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br><br>  Itu semua tentang penyeimbang.  Jika Anda memiliki pertanyaan, tanyakan, saya siap menjawab. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id448540/">https://habr.com/ru/post/id448540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id448530/index.html">Bagaimana Megaphone tidur di langganan seluler</a></li>
<li><a href="../id448532/index.html">Pusat Data Luar Angkasa. Ringkas percobaan</a></li>
<li><a href="../id448534/index.html">Mengapa kita membutuhkan sakelar industri dengan EMC yang ditingkatkan?</a></li>
<li><a href="../id448536/index.html">Transparansi - The Butcherts 'Panacea</a></li>
<li><a href="../id448538/index.html">Bangun solusi failover berdasarkan arsitektur Oracle RAC dan AccelStor Shared-Nothing</a></li>
<li><a href="../id448544/index.html">Bundel dalam baja. Bagaimana mereka terbentuk</a></li>
<li><a href="../id448546/index.html">UITableView header dan footer ukuran otomatis dengan AutoLayout</a></li>
<li><a href="../id448548/index.html">Konstruksi dalam seni: dari Brueghel ke Vasya Lozhkin</a></li>
<li><a href="../id448550/index.html">Kontes Laporan di #PAYMENTSECURITY 2019 Dibuka</a></li>
<li><a href="../id448552/index.html">ProLiant Series 100 - The Lost Younger Brother</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>