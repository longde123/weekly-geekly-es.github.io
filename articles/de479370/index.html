<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚å®Ô∏è üòù üèÆ Selbstgemachte Erfassung von Mifare-Kryptoschl√ºsseln und Selbstkopieren von IronLogic-T√ºrsprechschl√ºsseln üë®üèø‚Äçüöí ‚öìÔ∏è üßìüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kryptoschl√ºssel kaum zu greifen und Mifare-Schl√ºsselanh√§nger f√ºr Intercoms zu kopieren, ist nat√ºrlich unm√∂glich, aber es ist durchaus m√∂glich, ein Ger...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Selbstgemachte Erfassung von Mifare-Kryptoschl√ºsseln und Selbstkopieren von IronLogic-T√ºrsprechschl√ºsseln</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479370/">  Kryptoschl√ºssel kaum zu greifen und Mifare-Schl√ºsselanh√§nger f√ºr Intercoms zu kopieren, ist nat√ºrlich unm√∂glich, aber es ist durchaus m√∂glich, ein Ger√§t zusammenzustellen, das dies erm√∂glicht.  Ich werde hier nicht darauf eingehen, was Mifare ist, sondern auf technische Details eingehen. Ich m√∂chte lediglich darauf hinweisen, dass diese Technologie derzeit zum Beispiel f√ºr Intercoms verwendet wird. Um einen Intercom-Schl√ºsselbund zu kopieren, m√ºssen Sie die kryptografischen Schl√ºssel kennen, mit denen er geschlossen wurde. <br><blockquote>  Achtung!  Dieser Artikel dient nur zu Bildungszwecken.  Wir weisen darauf hin, dass das Eindringen in Informationssysteme strafbar ist. </blockquote>  Viele an der MIfare-Technologie Interessierte haben wahrscheinlich den einfachsten Mifare-Karten- / Schl√ºsselleser zum Lesen und Schreiben, bestehend aus einem PN532-Modul und einem USB-UART-Adapter: <br><br><img src="https://habrastorage.org/webt/05/xq/ra/05xqrajis6urtbznevn5vfgy8xi.jpeg"><br><br>  Durch eine einfache und kosteng√ºnstige Ausgestaltung kann dieses Ger√§t zum Erfassen aus gemacht werden <br>  Leserauthentifizierungsdaten, mit deren Hilfe die Kryptoschl√ºssel berechnet werden, werden so zum Lesen und Kopieren ben√∂tigt.  Es gibt auch im Handel erh√§ltliche Ger√§te f√ºr diesen Zweck - SMKey, Proxmark3, Chameleon und einige mehr.  Dies sind Ger√§te mit vielen Funktionen, bequem, aber nicht billig. <br><br>  Ich mache Sie auf eine kosteng√ºnstigere Option aufmerksam, die auf einem √§hnlichen ‚Äûkleinen Gentleman's Set‚Äú aus dem PN532-Modul und einem USB-UART-Adapter basiert, mit dem Sie Daten von einem Mifare-Leseger√§t wie einer Gegensprechanlage erfassen und die kryptografischen Schl√ºssel berechnen k√∂nnen, mit denen das Leseger√§t auf das Tag verweist. <br><a name="habracut"></a><br>  Das entwickelte Ger√§t verf√ºgt im Grunde genommen √ºber ein kosteng√ºnstiges, ‚Äûbeliebtes‚Äú Debug-Board auf der Basis des Prozessors STM32F103C8T6, auch ‚ÄûBluePill‚Äú genannt, mit angeschlossenem PN532-Modul und USB-UART-Adapter.  Dieses Ger√§t ist √ºber ein USB-OTG-Kabel mit einem Smartphone unter Android verbunden.  All dies wird in einer Modellversion ohne L√∂ten mit Hilfe von Jumpern zusammengebaut und hat so etwas, obwohl es nicht vorstellbar ist, aber ziemlich funktioniert: <br><br><img src="https://habrastorage.org/webt/91/je/bh/91jebhmz4putgxatntmyldqvnas.jpeg"><br><br>  Das Montagebild ist sehr einfach und wird in Textform dargestellt: <br><br>  PN532 ___________________STM32F103C8T6 <br><br>  SCK _____________________ PA5 (SPI1_SCK) <br>  MISO ____________________ PA6 (SPI1_MISO) <br>  MOSI ____________________ PA7 (SPI1_MOSI) <br>  SS ______________________ PB0 (GPIO_OUTPUT) <br>  SIGIN ___________________ PB11 (TIM2_CH4) <br>  SIGOUT __________________ PA12 (TIM1_ETR) <br>  SIGOUT __________________ PA0 (TIM2_ETR) <br>  VCC _____________________ + 5V <br>  GND_____________________GND <br><br><br>  USB-UART ________________ STM32F103C8T6 <br><br>  RX ______________________ PA9 (USART1_TX) <br>  TX ______________________ PA10 (USART1_RX) <br>  + 5V _____________________ + 5V <br>  GND_____________________GND <br><br>  WICHTIG!  PN532-Schnittstellenschalter m√ºssen auf SPI-Modus eingestellt sein!  Sie k√∂nnen STM32 mit dem Dienstprogramm FlashLoaderDemonstrator √ºber den vorhandenen USB-UART-Adapter flashen. <br><br>  Hier ist eine Demo zum Erfassen eines Kryptoschl√ºssels von einem T√ºrsprechleser-Simulator (Arduino + PN532): <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/aUDXUIzN1kc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Da IronLogic (IL) -Leseger√§te, f√ºr die dieses Ger√§t entwickelt wurde, versuchen, ein Tag mit einem Kryptoschl√ºssel zu lesen, der anhand der UID dieses Tags berechnet wird, muss diese UID zuerst festgelegt werden.  Sie k√∂nnen dies auf zwei Arten tun - manuell oder vom Tag lesen.  Danach machen wir ein Capture und warten auf die Berechnung der Kryptoschl√ºssel. <br><br>  Die n√§chste Registerkarte des Classic Recording-Programms nutzt die F√§higkeit fr√ºherer Versionen von IL-Readern, Kopien auf billige Mifare Classic-Rohlinge zu schreiben.  Diese Methode basiert auf der Tatsache, dass der IL-Leser nach der Autorisierung nicht die urspr√ºngliche UID des Tags an die Gegensprechanlage sendet, sondern die im ersten Block aufgezeichneten Informationen (im Allgemeinen die gleiche wie die UID des Originals).  Dazu m√ºssen wir den Kryptoschl√ºssel des Etiketts erfassen und berechnen, der als Leerzeichen dient, den Nullsektor damit schlie√üen und vier Bytes der UID des Etiketts, das als Prototyp dient, in den ersten Block dieses Etiketts schreiben.  Dazu m√ºssen wir nicht einmal den urspr√ºnglichen Kryptow√§hrungsschl√ºssel abrufen und den Speicherauszug entfernen. Es reicht aus, um die UID herauszufinden. Dies ist jedoch nur dann der Fall, wenn das Original "original" und keine Kopie ist. Dann m√ºssen Sie den ersten Block noch lesen und schon schreibe auf eine Kopie.  Betrachten Sie zur Verdeutlichung dieses Beispiel: Angenommen, Sie m√∂chten eine Kopie des Originalschl√ºssels mit der UID 0xEBD52AC5 erstellen, die auch im ersten Block des Originals auf einem normalen Mifare Classic-Etikett mit einer UID (z. B. 0x12345678) geschrieben ist.  Dazu finden wir mit Hilfe des vorgestellten Ger√§ts, das treffend von einem Genossen Shaitan-Mashina genannt wird, die Kryptow√§hrung f√ºr diese UID und f√ºr das bestimmte Objekt (Eingang, Zuhause ...), das wir ben√∂tigen.  Der Kryptoschl√ºssel sei 0xABCDEF098765, dann bearbeite den Nullsektor des Copy-Dumps wie folgt: <br><br><img src="https://habrastorage.org/webt/rc/sh/lb/rcshlbqwctujngjr0dkvnhlb8zk.jpeg"><br><br>  Im ersten Block schreiben wir die UID des urspr√ºnglichen 0xEBD52AC5 und im dritten Block sind die sechs Bytes des f√ºr dieses Werkst√ºck gefundenen Kryptoschl√ºssels 0xABCDEF098765.  Wir schreiben den Speicherauszug in das leere Feld und erhalten eine Kopie des Intercom-Schl√ºssels.  So etwas wie dieser SMKey kopiert IronLogic auf normalem Mifare Classic, und genau das macht dieses Aufnahmeprogramm.  In das Feld "Code" geben wir manuell 4 Bytes der UID des Originalschl√ºssels ein oder lesen sie ab, die im ersten Block der Kopie aufgezeichnet wird.  Wir starten und folgen dann den Anweisungen des Programms.  Zuerst lesen wir die UID des Werkst√ºcks, dann bringen wir das Ger√§t zur Gegensprechanlage und erfassen Authentifizierungsdaten.  Nach Abschluss der Berechnung bietet das Programm an, den Rohling f√ºr die Datenaufzeichnung mitzubringen.  Wenn mehr als ein kryptografischer Schl√ºssel gefunden wird, wird ihm nach dem Aufzeichnen der ersten Option die M√∂glichkeit gegeben, die empfangene Kopie zu √ºberpr√ºfen.  Wenn die Kopie nicht passt, sollten Sie den n√§chsten berechneten Schl√ºssel versuchen oder das Leerzeichen f√ºr die zuk√ºnftige Verwendung l√∂schen (wiederherstellen).  Eine Kopie funktioniert m√∂glicherweise auch nicht, weil der Code, der im ersten Block der Kopie geschrieben wurde, falsch definiert wurde - beispielsweise, wenn Sie versuchen, die echte UID nicht des urspr√ºnglichen Schl√ºsselanh√§nger zu schreiben, sondern eine Kopie, die mit der oben beschriebenen Methode erstellt wurde. In diesem Fall sollten Sie die UID nicht verwenden Beschriftungen und Daten aus dem 1. Block, die im Abschnitt "Kopieren eines Sektors" abgerufen werden k√∂nnen. <br><br>  Diese Methode funktioniert auch nicht mit den neuesten Versionen der IL-Reader-Software.  In diesem Fall kann eine Kopie erstellt werden, indem der gesamte 0. Sektor (4 S√§tze) auf ein Werkst√ºck kopiert wird, mit dem Sie den 0. Sektor mithilfe des Abschnitts ‚ÄûKopieren eines Sektors‚Äú in der Anwendung aufzeichnen k√∂nnen.  Hier finden wir auch zuerst den urspr√ºnglichen Kryptow√§hrungsschl√ºssel, lesen seinen Nullsektor und schreiben dann in das Leerzeichen.  Aufgrund des Mangels an verf√ºgbaren OTP- und OTP-2.0-Rohlingen wurde diese Funktion bisher nur an ZERO-Rohlingen getestet, obwohl neuere Leserversionen die Verwendung von OTP-2.0 erfordern. <br><br>  Nun, f√ºr den Anfang: Im Anwendungsbereich ‚ÄûUID-Aufzeichnung‚Äú k√∂nnen Sie die UID √§ndern, den besch√§digten 0. Block wiederherstellen und die NULL-Werkst√ºck-Kryptoschl√ºssel auf die Standardeinstellungen zur√ºcksetzen. <br><br>  Also - um es kurz zusammenzufassen.  Um ein solches Ger√§t herzustellen, kaufen oder suchen wir ein PN532-Modul, einen der USB-UART-Adapter FTDI, PL2303, CH340 oder CP2102, ein Debug-Board STM32F103C8T6, anderthalb Dutzend Jumper, einen USB-OTG-Adapter und ein Smartphone (Tablet) auf Android mit OTG.  Wir bauen das Ger√§t selbst nach obigem Schema zusammen, flashen * .bin mit der STM32-Datei und installieren die * .apk-Anwendung aus dem <a href="https://yadi.sk/d/1qKtoRTPWBYBpg">Archiv</a> <br><cut>  auf einem Smartphone.  F√ºr einen ordnungsgem√§√üen Betrieb muss die Anwendung auf dem Smartphone gestartet werden, wenn der USB-UART-Adapter entweder standardm√§√üig oder manuell angeschlossen ist. Andernfalls erh√§lt die Anwendung keinen Zugriff auf den Adapter. <br><br>  Ich m√∂chte ein paar Worte zum PN532-Modul sagen - nicht alle diese Module sind ‚Äûgleich n√ºtzlich‚Äú!  Von den drei Modulen (wie im obigen Foto), die ich gekauft habe, hat eines keine Tags gelesen und geschrieben, insbesondere ZERO und OTP-2.0, aber es funktionierte normalerweise im passiven Modus mit Intercom-Readern, das andere verhielt sich genau umgekehrt und nur das dritte mehr. weniger mit Tags und Intercoms umgehen (obwohl schlechter als die ersten beiden).  Vielleicht habe ich Pech und diese bestimmte Menge von Modulen erwies sich als nicht von bester Qualit√§t, aber andere Leute beschweren sich dar√ºber.  Jedoch - zu jemandem als gl√ºcklich.  Was sage ich  PN532-Module wurden f√ºr ein etwas anderes Layout angeboten, das teurer ist, aber laut Testberichten keine derartigen Probleme aufweist: <br><br><img src="https://habrastorage.org/webt/jr/vi/9s/jrvi9sfl-57ao-v8t0otqa0mm8a.jpeg"><br><br>  Wenn jemand auf PN532 st√∂√üt, das Beschriftungen nicht gut schreibt oder liest, kann ich empfehlen, dem Ger√§t ein RC522-Modul hinzuzuf√ºgen, das einen Cent wert ist, dessen Funktionen jedoch nach folgendem Schema einwandfrei ausgef√ºhrt werden: <br><br>  RC522____________________STM32F103C8T6 <br><br>  RST ______________________ PB12 (GPIO_OUTPUT) <br>  SCK ______________________ PB13 (SPI2_SCK) <br>  MISO _____________________ PB14 (SPI2_MISO) <br>  MOSI _____________________ PB15 (SPI2_MOSI) <br>  SDA ______________________ PA8 (GPIO_OUTPUT) <br>  VCC ______________________ + 5V <br>  GND______________________GND <br>  In diesem Fall funktioniert der PN532 nur, wenn Daten vom Leseger√§t erfasst werden, und die gesamte Belastung durch das Arbeiten mit Tags liegt auf den Schultern des RC522. <br><br>  Abschlie√üend m√∂chte ich sagen, dass die Leistung des Ger√§ts unter realen Bedingungen nur mit IronLogic-Leseger√§ten der ersten Generation ohne ZERO-, OTP- und OTP-2.0-Filter getestet wurde.  Andere Versionen haben einfach keinen Zugriff, sodass f√ºr modernere IL-Leseger√§te Softwareentwicklung erforderlich ist, und nat√ºrlich die Anwesenheit dieser Leseger√§te. <br><br>  <a href="https://yadi.sk/d/1qKtoRTPWBYBpg">Archiv</a> </cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479370/">https://habr.com/ru/post/de479370/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479358/index.html">Kurzreferenz der C ++ - Wertkategorien: Teil 2</a></li>
<li><a href="../de479360/index.html">Erstellen Sie mit wenigen Klicks ein Open-Source-Projekt f√ºr Angels</a></li>
<li><a href="../de479364/index.html">Bewertung der besten CPUs f√ºr Gaming-PCs im Jahr 2019</a></li>
<li><a href="../de479366/index.html">Mobile Umfrageergebnisse von Freitag</a></li>
<li><a href="../de479368/index.html">So erreichen Sie CMM Level 5 QS und Testen</a></li>
<li><a href="../de479374/index.html">Achten Sie auf Ihre Dongles: Sicherheitsstudie f√ºr Logitech-Tastaturempf√§nger</a></li>
<li><a href="../de479376/index.html">Gesch√ºtzt durch Knox - Samsung Mobile Security Mechanisms</a></li>
<li><a href="../de479378/index.html">Denken Sie an SRE: Betrachten Sie Projekte mit den Augen eines SRE-Ingenieurs</a></li>
<li><a href="../de479382/index.html">Beschleunigte Entwicklung mit Spring Boot DevTools</a></li>
<li><a href="../de479384/index.html">Was macht Big Data in MegaFon und wie kommt man dorthin?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>