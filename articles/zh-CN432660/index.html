<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📁 👩🏿‍🎨 🏣 PVS-Studio：支持编码标准MISRA C和MISRA C ++ 🤲🏾 👨🏽‍🏫 🧖</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="从版本6.27开始，PVS-Studio静态代码分析器可以根据MISRA C和MISRA C ++标准对警告进行分类。 由于这些标准的支持，分析仪已变得可以有效地用于提高嵌入式程序的安全性，可移植性和可靠性。 

 今年，我们开始在PVS-Studio分析仪中支持CWE和SEI CERT等标准。 基...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PVS-Studio：支持编码标准MISRA C和MISRA C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/432660/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d5/54d/9e6/7d554d9e67b20169e7b7b30a8e854ebd.png" alt="PVS-Studio，MISRA C，MISRA C ++"></div><br> 从版本6.27开始，PVS-Studio静态代码分析器可以根据MISRA C和MISRA C ++标准对警告进行分类。 由于这些标准的支持，分析仪已变得可以有效地用于提高嵌入式程序的安全性，可移植性和可靠性。 <br><a name="habracut"></a><br> 今年，我们开始在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PVS-Studio</a>分析仪中支持<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CWE</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SEI CERT</a>等标准。 基本上，支持归结为根据这些标准在分析仪中已经实现的诊断的分类。 此外，已实施了几个新的诊断程序或扩展了几个旧的诊断程序以更完全满足这些标准。 <br><br>  PVS-Studio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">诊断程序符合</a>各种标准的符合性表： <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CWE合规</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">合规SEI CERT</a> </li></ul><br> 现在是时候制定MISRA C和MISRA C ++标准了。 这些是由<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MISRA</a> （汽车工业软件可靠性协会）创建的C和C ++软件开发标准。 该标准的目标是提高嵌入式程序的安全性，可移植性和可靠性。 标准文本已付款。 <br><br> 我们认为分析仪的强度足以在现有的大型项目中使用并开始使用。 您可以在代码的基础上运行PVS-Studio，检测旧错误，然后定期使用分析仪尽早发现新缺陷。 <br><br> 许多分析仪采用不同的路径并实施与编码标准相关的诊断。 他们建议如何更好地命名变量，提醒您在文件的开头插入注释，等等。 这是必要且有用的。 但是，在这种情况下，分析仪非常“嘈杂”，并生成大量警告，其中淹没了有关错误的警告。 <br><br> 我们决定将PVS-Studio用作搜索错误的分析器。 这就是他的竞争优势。 程序员可以在大型代码库上运行它，并确保他不会被关于代码设计的大量消息所淹没，并且能够专注于错误。 <br><br> 因此，我们最初对MISRA标准持<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">批评态度，</a>并且很长一段时间没有计划实施它们。  MISRA标准旨在简化和提高整个代码的质量，从而有助于防止错误。 也就是说，其中的大多数诊断都与编写代码的样式有关。 最好用一个例子来解释。 <br><br>  MISRA标准中有一条规则，该规则将<i>if语句</i>的主体括在花括号中。 在MISRA C中，这是规则15.6；在MISRA C ++中，它是6-4-1。 错误的代码示例： <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == bestOffs) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>;</code> </pre> <br> 正确的代码是： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == bestOffs) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; }</code> </pre> <br> 此类诊断不能应用于在Winodws，Linux或macOS操作系统的控制下编写的现有项目。 例如，仅上述关于大括号的规则为WinMerge项目提供了<b>1947</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V2507</a>诊断<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">操作</a> （MISRA C 15.6，MISRA C ++ 6-4-1）。 但是WinMerge是一个小项目！ 在C和C ++中，只有大约250,000行代码。 <br><br> 直到2018年，PVS-Studio分析仪一直专注于测试在Windows，Linux和macOS上运行的桌面应用程序。 因此，对MISRA的支持几乎没有实际意义。 没有人会在现有的大型桌面项目中实施此标准。 <br><br> 自2018年我们开始支持嵌入式系统以来，一切都发生了变化。 今年，分析仪支持： <br><br><ul><li> 窗户  IAR嵌入式工作台，用于ARM C，C ++的C / C ++编译器 </li><li>  Windows / Linux  Keil µVision，DS-MDK，ARM编译器5/6 C，C ++ </li><li>  Windows / Linux 德州仪器Code Composer Studio，ARM代码生成工具C，C ++ </li><li>  Windows / Linux / macOS。  GNU Arm嵌入式工具链，Arm嵌入式GCC编译器，C，C ++ </li></ul><br> 与桌面项目不同，许多嵌入式开发人员已经在编写项目时考虑了MISRA的建议，他们对我们分析仪的支持将对开发人员非常有用。 <br><br> 但是，我们仍然担心其中一位开发人员在不了解的情况下可能会认为我们通过在分析器中引入“奇怪的诊断”来“破坏”了分析器。 因此，MISRA诊断默认情况下处于关闭状态。 我们认为这是一个非常正确的决定。 仅当您确切知道它们的用途和使用方法时，才能包含这些诊断程序。 <br><br> 例如，对于应用程序程序员来说，可能不清楚为什么分析器突然禁止他们使用动态内存。 即 为什么突然之间您无法使用<i>malloc</i>函数或<i>new</i>运算符分配内存。 但是嵌入式设备的开发人员已经很好地理解了此类限制（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">V2511</a> ）。 在某些连续运行的设备中，使用内存可能突然耗尽的程序确实是不可接受的。 <br><br> 因此，现在您可以安装或更新PVS-Studio并开始使用实现MISRA C和MISRA C ++中的规则的诊断程序。 支持的规则集不完整，但这不应成为开始使用PVS-Studio的障碍。 目前，还没有一个静态分析器可以完全实现所有MISRA规则。 将来，我们计划扩展在MISRA中实施的诊断规则集，并希望成为其支持完整性的领先工具。 <br><br> 要在Visual Studio或PVS-Studio Standalone实用程序中启用MISRA诊断，您需要在设置中将“已禁用”更改为“全部显示”。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6a3/bcd/d5f/6a3bcdd5fba435e143819e96d40bc2c6.png" alt="启用MISRA"></div><br> 由于“禁用”意味着根本不会生成警告，也不会进入报告，因此需要重新启动分析。 默认情况下，设置为禁用模式，以减小报告的大小。 包含MISRA诊断程序可能导致大量操作，并带有报告的文件（* .plog文件）大大增加。 <br><br> 为了分析Linux和macOS操作系统中的项目，有一个实用程序pvs-studio-analyzer。 默认情况下，此处仅包含通用诊断程序（General Analysis，GA）。 可以使用-a选项启用其他规则： <br><br><pre> <code class="cpp hljs">-a [MODE], --analysis-mode [MODE] MODE defines the type of warnings: <span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-number"><span class="hljs-number">64</span></span>-bit errors; <span class="hljs-number"><span class="hljs-number">2</span></span> - reserved; <span class="hljs-number"><span class="hljs-number">4</span></span> - General Analysis; <span class="hljs-number"><span class="hljs-number">8</span></span> - Micro-optimizations; <span class="hljs-number"><span class="hljs-number">16</span></span> - Customers Specific Requests; <span class="hljs-number"><span class="hljs-number">32</span></span> - MISRA. Modes can be combined by adding the values Default: <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br> 要启用GA和MISRA警报，您必须使用以下参数运行分析： <br><br><pre> <code class="cpp hljs">pvs-studio-analyzer analyze ... -a <span class="hljs-number"><span class="hljs-number">36</span></span> ... -o /path/to/report.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> ...</code> </pre> <br> 值36是4（GA-General Diagnostics）和32（MISRA）的按位或。 <br><br> 此外，建议创建多个具有不同警报类型的报告，例如： <br><br><pre> <code class="cpp hljs">plog-converter -a GA:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span> -t tasklist -o /path/to/ga_results.tasks /path/to/project.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> plog-converter -a MISRA:<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span> -t tasklist -m misra -o /path/to/misra_results.tasks /path/to/project.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span></code> </pre> <br> 第一个ga_results.tasks报告将包含“高”和“中”置信度级别的常规警告。 <br><br> 第二个报告“ misra_results.tasks”将仅获得与所有级别的MISRA相关的警告。  “ -m misra”开关表示除PVS-Studio格式的数字外，该报告还将包含根据MISRA分类的诊断号。 <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文档</a>中介绍了Linux和macOS中所有分析仪的启动模式以及报告格式。 <br><br>  PS：我们想通过选择MISRA作为PVS-Studio的发展方向之一来评估我们的猜测。 如果您对此主题感兴趣，请<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">写信给我们</a> 。 即使您尚不打算使用PVS-Studio，也请写信。 我们想问您一些澄清的问题。 <br><br> 附加链接： <br><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">下载PVS-Studio</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何在Linux和macOS上运行PVS-Studio</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PVS-Studio 6.22静态代码分析器适用于ARM编译器（Keil，IAR）</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PVS-Studio包括对GNU Arm嵌入式工具链的支持</a> </li></ol><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/ts/z9/km/tsz9kmyjtteajhd4x1au60rsrvq.png" align="left"></a> </p><br><br> 如果您想与说英语的读者分享这篇文章，请使用以下链接：Andrey Karpov。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PVS-Studio：支持MISRA C和MISRA C ++编码标准</a> 。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN432660/">https://habr.com/ru/post/zh-CN432660/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN432650/index.html">收集软件项目的需求-无需削减</a></li>
<li><a href="../zh-CN432652/index.html">您需要SD-WAN吗？</a></li>
<li><a href="../zh-CN432654/index.html">数据存储位置：IXcellerate数据中心游览</a></li>
<li><a href="../zh-CN432656/index.html">Python类型注释简介</a></li>
<li><a href="../zh-CN432658/index.html">杜马州人大代表提议禁止未经中央银行注册而运作的汇款系统</a></li>
<li><a href="../zh-CN432664/index.html">如果需要，我们可以在React，Vue甚至jQuery中实现Angular组件</a></li>
<li><a href="../zh-CN432666/index.html">产品管理聚会视频录制</a></li>
<li><a href="../zh-CN432668/index.html">轻松的网络端口管理</a></li>
<li><a href="../zh-CN432670/index.html">机器学习数学学科的路线图，第1部分</a></li>
<li><a href="../zh-CN432672/index.html">我们在寻找什么开发人员来开发1C：企业平台</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>