<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÇ üçß üôçüèø Redes neurais e aprendizado profundo, cap√≠tulo 3, parte 1: melhorando a maneira como as redes neurais s√£o treinadas ü§±üèº üï∞Ô∏è üë®‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conte√∫do 

- Cap√≠tulo 1: usando redes neurais para reconhecer n√∫meros manuscritos 
- Cap√≠tulo 2: como o algoritmo de retropropaga√ß√£o funciona 
- Cap√≠t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Redes neurais e aprendizado profundo, cap√≠tulo 3, parte 1: melhorando a maneira como as redes neurais s√£o treinadas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458724/"><div class="spoiler">  <b class="spoiler_title">Conte√∫do</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap√≠tulo 1: usando redes neurais para reconhecer n√∫meros manuscritos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap√≠tulo 2: como o algoritmo de retropropaga√ß√£o funciona</a> </li><li>  Cap√≠tulo 3: <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1: aprimorando o m√©todo de treinamento de redes neurais</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2: Por que a regulariza√ß√£o ajuda a reduzir a reciclagem?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3: como escolher hiperpar√¢metros de redes neurais?</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap√≠tulo 4: prova visual de que as redes neurais s√£o capazes de computar qualquer fun√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap√≠tulo 5: por que as redes neurais profundas s√£o t√£o dif√≠ceis de treinar?</a> </li><li>  Cap√≠tulo 6: <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1: Aprendizado Profundo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2: progresso recente no reconhecimento de imagens</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Posf√°cio: existe um algoritmo simples para criar intelig√™ncia?</a> </li></ul></div></div><br>  Quando uma pessoa aprende a jogar golfe, geralmente passa a maior parte do tempo realizando um golpe b√°sico.  Ele ent√£o aborda outros golpes, gradualmente, estudando esses ou aqueles truques, com base no golpe b√°sico e desenvolvendo-o.  Da mesma forma, at√© agora focamos no entendimento do algoritmo de retropropaga√ß√£o.  Este √© o nosso "ataque b√°sico", a base para o treinamento da maior parte do trabalho com redes neurais (SN).  Neste cap√≠tulo, falarei sobre um conjunto de t√©cnicas que podem ser usadas para melhorar nossa implementa√ß√£o mais simples de retropropaga√ß√£o e para melhorar a maneira de ensinar NS. <br><br>  Entre as t√©cnicas que aprenderemos neste cap√≠tulo est√£o: a melhor op√ß√£o para o papel da fun√ß√£o de custo, a saber, a fun√ß√£o de custo com entropia cruzada;  quatro chamados  m√©todos de regulariza√ß√£o (regulariza√ß√£o de L1 e L2, exclus√£o de neur√¥nios [abandono], extens√£o artificial dos dados de treinamento), que melhoram a generaliza√ß√£o de nossa SN al√©m dos limites dos dados de treinamento;  melhor m√©todo para inicializar pesos de rede;  um conjunto de m√©todos heur√≠sticos para ajud√°-lo a escolher bons hiperpar√¢metros para a rede.  Tamb√©m vou considerar v√°rias outras t√©cnicas, um pouco mais superficialmente.  Na maioria das vezes, essas discuss√µes s√£o independentes uma da outra, para que voc√™ possa pular sobre elas, se desejar.  Tamb√©m implementamos muitas tecnologias no c√≥digo de trabalho e as usamos para melhorar os resultados obtidos para a tarefa de classifica√ß√£o de n√∫meros manuscritos, estudada no Cap√≠tulo 1. <br><a name="habracut"></a><br>  Obviamente, consideramos apenas uma fra√ß√£o do grande n√∫mero de t√©cnicas desenvolvidas para uso em redes neurais.  A conclus√£o √© que a melhor maneira de entrar no mundo da abund√¢ncia de t√©cnicas dispon√≠veis √© estudar em detalhes algumas das mais importantes.  O dom√≠nio dessas t√©cnicas importantes n√£o √© apenas √∫til por si s√≥, mas tamb√©m aprofundar√° sua compreens√£o dos problemas que podem surgir ao usar redes neurais.  Como resultado, voc√™ estar√° preparado para adaptar rapidamente novas t√©cnicas, conforme necess√°rio. <br><br><h2>  Fun√ß√£o de custo de entropia cruzada </h2><br>  Muitos de n√≥s odeiam estar errados.  Logo depois de come√ßar a aprender piano, dei um pequeno concerto na frente de uma plat√©ia.  Eu estava nervoso e comecei a tocar uma pe√ßa uma oitava abaixo do necess√°rio.  Fiquei confuso e n√£o pude continuar at√© que algu√©m apontasse um erro para mim.  Eu estava com muita vergonha.  No entanto, embora isso seja desagrad√°vel, tamb√©m aprendemos muito rapidamente, decidindo que est√°vamos errados.  E certamente da pr√≥xima vez que falei com o p√∫blico, toquei na oitava certa!  Por outro lado, aprendemos mais lentamente quando nossos erros n√£o est√£o bem definidos. <br><br>  Idealmente, esperamos que nossas redes neurais aprendam rapidamente com seus erros.  Isso acontece na pr√°tica?  Para responder a essa pergunta, vejamos um exemplo absurdo.  Envolve um neur√¥nio com apenas uma entrada: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/711/536/586/711536586b63bd594c00d3ade2e88580.png"><br><br>  Estamos ensinando esse neur√¥nio a fazer algo ridiculamente simples: aceite 1 e d√™ 0. √â claro que poder√≠amos encontrar uma solu√ß√£o para um problema t√£o trivial selecionando manualmente o peso e o deslocamento, sem usar o algoritmo de treinamento.  No entanto, ser√° bastante √∫til tentar usar a descida do gradiente para obter peso e deslocamento como resultado do treinamento.  Vejamos como um neur√¥nio √© treinado. <br><br>  Por defini√ß√£o, vou escolher um peso inicial de 0,6 e um deslocamento inicial de 0,9.  Esses s√£o alguns valores gerais atribu√≠dos como ponto de partida e eu n√£o os selecionei especificamente.  Inicialmente, um neur√¥nio de sa√≠da produz 0,82; portanto, precisamos aprender muito para chegar perto da sa√≠da desejada de 0,0.  O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo original</a> possui um formul√°rio interativo no qual voc√™ pode clicar em "Executar" e observar o processo de aprendizado.  Essa anima√ß√£o n√£o √© pr√©-gravada, o navegador calcula o gradiente e, em seguida, usa-o para atualizar o peso e o deslocamento e mostra o resultado.  A velocidade de aprendizado √© Œ∑ = 0,15, lenta o suficiente para poder ver o que est√° acontecendo, mas r√°pida o suficiente para que a aprendizagem ocorra em segundos.  A fun√ß√£o de custo C √© quadr√°tica, introduzida no primeiro cap√≠tulo.  Em breve vou lembr√°-lo de sua forma exata, portanto n√£o √© necess√°rio voltar e vasculhar l√°.  O treinamento pode ser iniciado v√°rias vezes, basta clicar no bot√£o "Executar". <br><br>  Como voc√™ pode ver, o neur√¥nio aprende rapidamente o peso e o vi√©s, o que diminui o custo e produz uma sa√≠da de 0,09.  Este n√£o √© o resultado desejado de 0,0, mas √© muito bom.  Suponha que escolhemos um peso inicial e um deslocamento de 2,0.  Nesse caso, a sa√≠da inicial ser√° 0,98, o que est√° completamente errado.  Vamos ver como, nesse caso, o neur√¥nio aprender√° a produzir 0. <br><br>  Embora este exemplo use a mesma taxa de aprendizado (Œ∑ = 0,15), vemos que o aprendizado √© mais lento.  Cerca de 150 das primeiras √©pocas, pesos e deslocamentos dificilmente mudam.  Em seguida, o treinamento acelera e, quase como no primeiro exemplo, o neur√¥nio se move rapidamente para 0,0.  esse comportamento √© estranho, n√£o √© como aprender uma pessoa.  Como eu disse no come√ßo, geralmente aprendemos mais rapidamente quando estamos muito enganados.  Mas acabamos de ver como nosso neur√¥nio artificial aprende com grande dificuldade, cometendo muitos erros - muito mais dif√≠cil do que quando ele cometeu um pequeno erro.  Al√©m disso, verifica-se que esse comportamento surge n√£o apenas em nosso exemplo simples, mas tamb√©m em um NS de prop√≥sito mais geral.  Por que o aprendizado √© t√£o lento?  Posso encontrar uma maneira de evitar esse problema? <br><br>  Para entender a fonte do problema, lembramos que nosso neur√¥nio aprende atrav√©s de altera√ß√µes no peso e no deslocamento a uma taxa determinada pelas derivadas parciais da fun√ß√£o de custo, ‚àÇC / ‚àÇw e ‚àÇC / ‚àÇb.  Dizer "aprender √© lento" √© o mesmo que dizer que essas derivadas parciais s√£o pequenas.  O problema √© entender por que eles s√£o pequenos.  Para fazer isso, vamos calcular as derivadas parciais.  Lembre-se de que usamos a fun√ß√£o de custo quadr√°tico, que √© dada pela equa√ß√£o (6): <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;">f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;">y </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">- </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;">) </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mn MJXp-script" id="MJXp-Span-16" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;">2</font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-17"><span class="MJXp-mn" id="MJXp-Span-18"><font style="vertical-align: inherit;"> 2</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"> t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mn" id="MJXp-Span-24"><font style="vertical-align: inherit;">54</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-4">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-9"><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-14"><span class="MJXp-mo" id="MJXp-Span-15" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-16" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-17"><span class="MJXp-mn" id="MJXp-Span-18"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-19">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mn" id="MJXp-Span-24"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.352ex" height="3.021ex" viewBox="0 -987.6 10915.4 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-3D" x="1038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="2344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="2895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="3346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="3876" y="0"></use><g transform="translate(4309,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="1109" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2109" y="0"></use><g transform="translate(2639,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-32" x="550" y="583"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-32" x="7792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="8542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="8904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="9433" y="0"></use><g transform="translate(9914,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-34" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> C = \ frac {(y-a) ^ 2} {2} \ tag {54} </script></p><br><br>  onde a √© a sa√≠da do neur√¥nio quando x = 1 √© usado na entrada e y = 0 √© a sa√≠da desejada.  Para escrever isso diretamente por meio de peso e deslocamento, lembre-se de que a = œÉ (z), onde z = wx + b.  Utilizando a regra da cadeia para diferencia√ß√£o por peso e deslocamento, obtemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-25"><span class="MJXp-mtext" id="MJXp-Span-26">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30">c</span><span class="MJXp-mrow" id="MJXp-Span-31"><span class="MJXp-mtext" id="MJXp-Span-32">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40">C</span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mtext" id="MJXp-Span-42">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">w</span></span><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">a</span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">y</span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-57">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">m</span><span class="MJXp-msup" id="MJXp-Span-62"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-64" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66">z</span><span class="MJXp-mo" id="MJXp-Span-67" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">x</span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">a</span><span class="MJXp-mtext" id="MJXp-Span-71">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">m</span><span class="MJXp-msup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-78" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">z</span><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-82">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">g</span><span class="MJXp-mrow" id="MJXp-Span-86"><span class="MJXp-mn" id="MJXp-Span-87">55</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.863ex" height="2.78ex" viewBox="0 -883.9 28788.2 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="3043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-43" x="3341" y="0"></use></g><g transform="translate(6317,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="3043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-77" x="3341" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-3D" x="10652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="11709" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="12098" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="12850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="13851" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="14348" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="14988" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="15457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="15803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="16283" y="0"></use><g transform="translate(17162,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="17986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="18375" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="18844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-78" x="19233" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-3D" x="20084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="21140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="21919" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="22389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="22734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="23215" y="0"></use><g transform="translate(24093,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="24918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="25307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="25776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="26415" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="26777" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="27306" y="0"></use><g transform="translate(27787,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-35" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> \ frac {\ parcial C} {\ parcial w} = (a-y) \ sigma '(z) x = a \ sigma' (z) \ tag {55} </script></p><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-88"><span class="MJXp-mtext" id="MJXp-Span-89">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">c</span><span class="MJXp-mrow" id="MJXp-Span-94"><span class="MJXp-mtext" id="MJXp-Span-95">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">C</span></span><span class="MJXp-mrow" id="MJXp-Span-104"><span class="MJXp-mtext" id="MJXp-Span-105">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-107">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">b</span></span><span class="MJXp-mo" id="MJXp-Span-114" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">a</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">y</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-120">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">m</span><span class="MJXp-msup" id="MJXp-Span-125"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-127" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-128" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">z</span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">a</span><span class="MJXp-mtext" id="MJXp-Span-133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">m</span><span class="MJXp-msup" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-140" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">z</span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-144">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">g</span><span class="MJXp-mrow" id="MJXp-Span-148"><span class="MJXp-mn" id="MJXp-Span-149">56</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="64.867ex" height="2.78ex" viewBox="0 -883.9 27928.7 1197.1" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="3043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-43" x="3341" y="0"></use></g><g transform="translate(6317,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="3043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-62" x="3341" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-3D" x="10365" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="11422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="11811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="12563" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="13564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="14061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="14701" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="15170" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="15516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="15996" y="0"></use><g transform="translate(16875,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="17699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="18088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="18557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-3D" x="19224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="20280" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="21060" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="21529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="21875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="22355" y="0"></use><g transform="translate(23234,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="24058" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="24448" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="24916" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="25556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="25917" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="26447" y="0"></use><g transform="translate(26927,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-36" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> \ frac {\ parcial C} {\ parcial b} = (a-y) \ sigma '(z) = a \ sigma' (z) \ tag {56} </script></p><br><br>  onde substitu√≠ x = 1 e y = 0.  Para entender o comportamento dessas express√µes, vamos dar uma olhada no termo œÉ '(z) √† direita.  Lembre-se da forma de um sigm√≥ide: <br><br><img src="https://habrastorage.org/webt/qp/md/8t/qpmd8tvjtjws0nis2rfaxcv59x8.png"><br><br>  O gr√°fico mostra que quando a sa√≠da do neur√¥nio est√° pr√≥xima de 1, a curva se torna muito plana e œÉ '(z) se torna pequeno.  As equa√ß√µes (55) e (56) nos dizem que ‚àÇC / ‚àÇw e ‚àÇC / ‚àÇb se tornam muito pequenos.  Da√≠ a desacelera√ß√£o na aprendizagem.  Al√©m disso, como veremos um pouco mais tarde, a desacelera√ß√£o do treinamento ocorre, de fato, pela mesma raz√£o e na Assembl√©ia Nacional de natureza mais geral, e n√£o apenas no nosso exemplo mais simples. <br><br><h2>  Introdu√ß√£o √† fun√ß√£o de custo de entropia cruzada </h2><br>  O que fazemos com a desacelera√ß√£o do aprendizado?  Acontece que podemos resolver o problema substituindo a fun√ß√£o quadr√°tica do valor por outra fun√ß√£o do valor, conhecida como entropia cruzada.  Para entender a entropia cruzada, nos afastamos de nosso modelo mais simples.  Suponha que treinemos um neur√¥nio com v√°rios valores de entrada x <sub>1</sub> , x <sub>2</sub> , ... pesos correspondentes w <sub>1</sub> , w <sub>2</sub> , ... e deslocamento b: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a5e/9a8/ddf/a5e9a8ddf40b507400692516269bd632.png"><br><br>  A sa√≠da do neur√¥nio, √© claro, ser√° a = œÉ (z), onde z = w <sub>j</sub> w <sub>j</sub> x <sub>j</sub> + b √© a soma ponderada das entradas.  Definimos a fun√ß√£o de custo da entropia cruzada para um dado neur√¥nio como <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">C</span><span class="MJXp-mo" id="MJXp-Span-152" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-154">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">c</span><span class="MJXp-mrow" id="MJXp-Span-159"><span class="MJXp-mn" id="MJXp-Span-160">1</span></span><span class="MJXp-mrow" id="MJXp-Span-161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">n</span></span><span class="MJXp-mtext" id="MJXp-Span-163">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">u</span><span class="MJXp-msubsup" id="MJXp-Span-166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-168" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-169">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">t</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">y</span><span class="MJXp-mtext" id="MJXp-Span-176">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">m</span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-184">1</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">y</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-188">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">n</span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-192">1</span><span class="MJXp-mo" id="MJXp-Span-193" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">a</span><span class="MJXp-mo" id="MJXp-Span-195" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-196">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">t</span><span class="MJXp-mo" id="MJXp-Span-202" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-203">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">g</span><span class="MJXp-mrow" id="MJXp-Span-207"><span class="MJXp-mn" id="MJXp-Span-208">57</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="67.318ex" height="2.66ex" viewBox="0 -832 28984.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-3D" x="1038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="2094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="3123" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="3673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="4125" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="4654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="5088" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6E" x="5588" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="6439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-75" x="6908" y="0"></use><g transform="translate(7481,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-78" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="9114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-65" x="9412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="9879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="10429" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-5B" x="10791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="11069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6E" x="11817" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-65" x="12417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="12884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-75" x="13762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="14335" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2B" x="15436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="16436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="16826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="17549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="18549" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="19047" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="19686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6E" x="19985" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="20585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="20975" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="21697" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="22698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="23228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="23867" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="24319" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="24664" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-68" x="25145" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="25721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-5D" x="26083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="26611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="26973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="27502" y="0"></use><g transform="translate(27983,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-37" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> C = - \ frac {1} {n} \ sum_x \ left [y \ n em um + (1-y) \ ln (1-a) \ right] \ tag {57} </script></p><br><br>  onde n √© o n√∫mero total de unidades de dados de treinamento, a soma passa por todos os dados de treinamento xey √© a sa√≠da desejada correspondente. <br><br>  N√£o √© √≥bvio que a equa√ß√£o (57) resolve o problema de diminuir a velocidade da aprendizagem.  Honestamente, nem √© √≥bvio que fa√ßa sentido cham√°-lo de uma fun√ß√£o de valor!  Antes de voltarmos √† desacelera√ß√£o do aprendizado, vejamos em que sentido a entropia cruzada pode ser interpretada como uma fun√ß√£o do valor. <br><br>  Duas propriedades em particular tornam razo√°vel a interpreta√ß√£o da entropia cruzada como uma fun√ß√£o do valor.  Em primeiro lugar, √© maior que zero, ou seja, C&gt; 0.  Para ver isso, observe que (a) todos os membros individuais da soma em (57) s√£o negativos, pois os dois logaritmos s√£o obtidos de n√∫meros no intervalo de 0 a 1 e (b) o sinal de menos est√° na frente da soma. <br><br>  Em segundo lugar, se a sa√≠da real do neur√¥nio estiver pr√≥xima da sa√≠da desejada para todas as entradas de treinamento x, a entropia cruzada ser√° pr√≥xima de zero.  Para provar isso, precisaremos assumir que as sa√≠das desejadas y ser√£o 0 ou 1. Normalmente, isso acontece ao resolver problemas de classifica√ß√£o ou ao calcular fun√ß√µes booleanas.  Para entender o que acontece se voc√™ n√£o fizer essa suposi√ß√£o, consulte os exerc√≠cios no final da se√ß√£o. <br><br>  Para provar isso, imagine que y = 0 e a‚âà0 para alguma entrada x.  Assim ser√° quando o neur√¥nio lidar bem com essa entrada.  Vemos que o primeiro termo da express√£o (57) para o valor desaparece, j√° que y = 0, e o segundo ser√° ‚àíln (1 - a) ‚âà0.  O mesmo acontece quando y = 1 e a‚âà1.  Portanto, a contribui√ß√£o do valor ser√° pequena se a sa√≠da real estiver pr√≥xima da desejada. <br><br>  Resumindo, entendemos que a entropia cruzada √© positiva e tende a zero quando o neur√¥nio calcula melhor a sa√≠da desejada y para todas as entradas de treinamento x.  Esperamos a presen√ßa de ambas as propriedades na fun√ß√£o de custo.  E, de fato, essas duas propriedades s√£o cumpridas pelo valor quadr√°tico.  Portanto, para entropia cruzada √© uma boa not√≠cia.  No entanto, a fun√ß√£o de custo de entropia cruzada tem uma vantagem porque, diferentemente do valor quadr√°tico, evita o problema de diminuir a velocidade da aprendizagem.  Para ver isso, vamos calcular a derivada parcial do valor com entropia cruzada por peso.  Substitua a = œÉ (z) em (57), aplique a regra da cadeia duas vezes e obtenha <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-209"><span class="MJXp-mtext" id="MJXp-Span-210">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">c</span><span class="MJXp-mrow" id="MJXp-Span-215"><span class="MJXp-mtext" id="MJXp-Span-216">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">C</span></span><span class="MJXp-mrow" id="MJXp-Span-225"><span class="MJXp-mtext" id="MJXp-Span-226">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">l</span><span class="MJXp-msubsup" id="MJXp-Span-234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-236" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-237" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-239">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">c</span><span class="MJXp-mrow" id="MJXp-Span-244"><span class="MJXp-mn" id="MJXp-Span-245">1</span></span><span class="MJXp-mrow" id="MJXp-Span-246"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">n</span></span><span class="MJXp-mtext" id="MJXp-Span-248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">u</span><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">t</span><span class="MJXp-mo" id="MJXp-Span-259" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-260">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">c</span><span class="MJXp-mrow" id="MJXp-Span-265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">y</span></span><span class="MJXp-mrow" id="MJXp-Span-267"><span class="MJXp-mtext" id="MJXp-Span-268">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">a</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">z</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">c</span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-285">1</span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">y</span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-289"><span class="MJXp-mn" id="MJXp-Span-290">1</span><span class="MJXp-mo" id="MJXp-Span-291" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-292">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">a</span><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">z</span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">a</span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-310">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">c</span><span class="MJXp-mrow" id="MJXp-Span-315"><span class="MJXp-mtext" id="MJXp-Span-316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">l</span><span class="MJXp-mtext" id="MJXp-Span-324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">a</span></span><span class="MJXp-mrow" id="MJXp-Span-330"><span class="MJXp-mtext" id="MJXp-Span-331">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">l</span><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-341" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-342">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">g</span><span class="MJXp-mrow" id="MJXp-Span-346"><span class="MJXp-mn" id="MJXp-Span-347">58</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="138.677ex" height="2.78ex" viewBox="0 -832 59708.1 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="3043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-43" x="3341" y="0"></use></g><g transform="translate(6317,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="3043" y="0"></use><g transform="translate(3341,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6A" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-3D" x="11044" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="12100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="13129" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="13679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="14131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="14660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="15094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6E" x="15594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="16445" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-75" x="16914" y="0"></use><g transform="translate(17487,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-78" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="19120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-65" x="19419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="19885" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="20436" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="20797" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="21437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="21987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="22439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="22968" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="23402" y="0"></use><g transform="translate(23899,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="3343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="3811" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="28322" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="29573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="30124" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="30575" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="31105" y="0"></use><g transform="translate(31538,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="2112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="2610" y="0"></use></g><g transform="translate(34538,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="2788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="3268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="4147" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="4676" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="5066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="5534" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-64" x="40712" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="41236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="41581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-65" x="42033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="42499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="42845" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="43206" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="43736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="44375" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="44926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="45377" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="45907" y="0"></use><g transform="translate(46340,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="3043" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="3591" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="4061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="4406" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="4887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="5765" y="0"></use></g><g transform="translate(52635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="1283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="1734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2168" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="3043" y="0"></use><g transform="translate(3341,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6A" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="57335" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="57697" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="58226" y="0"></use><g transform="translate(58707,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-38" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> \ frac {\ parcial C} {\ parcial w_j} = - \ frac {1} {n} \ sum_x \ left (\ frac {y} {\ sigma (z)} - \ frac {(1-y)} {1- \ sigma (z)} \ direita) \ frac {\ parcial \ sigma} {\ parcial w_j} \ tag {58} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-348"><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-350" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-351">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">c</span><span class="MJXp-mrow" id="MJXp-Span-356"><span class="MJXp-mn" id="MJXp-Span-357">1</span></span><span class="MJXp-mrow" id="MJXp-Span-358"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">n</span></span><span class="MJXp-mtext" id="MJXp-Span-360">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">u</span><span class="MJXp-msubsup" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-365" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-366">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">t</span><span class="MJXp-mo" id="MJXp-Span-371" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-372">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">c</span><span class="MJXp-mrow" id="MJXp-Span-377"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">y</span></span><span class="MJXp-mrow" id="MJXp-Span-379"><span class="MJXp-mtext" id="MJXp-Span-380">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">a</span><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">z</span><span class="MJXp-mo" id="MJXp-Span-388" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-389" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-390">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">c</span><span class="MJXp-mrow" id="MJXp-Span-395"><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-397">1</span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">y</span><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-401"><span class="MJXp-mn" id="MJXp-Span-402">1</span><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-404">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-408">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">a</span><span class="MJXp-mo" id="MJXp-Span-410" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">z</span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">t</span><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-420">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">m</span><span class="MJXp-msup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-427" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">z</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-433" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-434">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-437">g</span><span class="MJXp-mrow" id="MJXp-Span-438"><span class="MJXp-mn" id="MJXp-Span-439">59</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.73ex" height="2.901ex" viewBox="0 -883.9 40355.9 1249" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-3D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="1056" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="2084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="2635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="3086" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="3616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="4049" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6E" x="4550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="5400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-75" x="5870" y="0"></use><g transform="translate(6442,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-78" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6C" x="8076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-65" x="8374" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="8841" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="9391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="9753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="10392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="10943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="11394" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="11924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="12357" y="0"></use><g transform="translate(12855,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="3343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="3811" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="17278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-66" x="18529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="19079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="19531" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-63" x="20060" y="0"></use><g transform="translate(20494,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-79" x="2112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="2610" y="0"></use></g><g transform="translate(23493,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2212" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="1973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="2442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="2788" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="3268" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="4147" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="4676" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="5066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="5534" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-72" x="29668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="30119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="30465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-68" x="30945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="31522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="31883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-73" x="32523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-69" x="32992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="33338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6D" x="33818" y="0"></use><g transform="translate(34697,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-2032" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-28" x="35521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-7A" x="35911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-29" x="36379" y="0"></use><g transform="translate(36769,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-74" x="37983" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-61" x="38344" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMATHI-67" x="38874" y="0"></use><g transform="translate(39354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-35"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/458724/&amp;usg=ALkJrhhhZhEAG3a0TjlP3x-rs3aRUNwtVA#MJMAIN-39" x="500" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> = - \ frac {1} {n} \ sum_x \ left (\ frac {y} {\ sigma (z)} - \ frac {(1-y)} {1- \ sigma (z)} \ right) \ sigma '(z) x_j \ tag {59} </script></p><br><br>  Reduzindo a um denominador comum e simplificando, obtemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-440"><span class="MJXp-mtext" id="MJXp-Span-441">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">c</span><span class="MJXp-mrow" id="MJXp-Span-446"><span class="MJXp-mtext" id="MJXp-Span-447">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">C</span></span><span class="MJXp-mrow" id="MJXp-Span-456"><span class="MJXp-mtext" id="MJXp-Span-457">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">l</span><span class="MJXp-msubsup" id="MJXp-Span-465"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-467" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-469">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-471">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">c</span><span class="MJXp-mrow" id="MJXp-Span-474"><span class="MJXp-mn" id="MJXp-Span-475">1</span></span><span class="MJXp-mrow" id="MJXp-Span-476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">n</span></span><span class="MJXp-mtext" id="MJXp-Span-478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">u</span><span class="MJXp-msubsup" id="MJXp-Span-481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-482" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-483" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-484">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">c</span><span class="MJXp-mrow" id="MJXp-Span-489"><span class="MJXp-mtext" id="MJXp-Span-490">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">m</span><span class="MJXp-msup" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-497" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">z</span><span class="MJXp-mo" id="MJXp-Span-500" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-503" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mrow" id="MJXp-Span-504"><span class="MJXp-mtext" id="MJXp-Span-505">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">a</span><span class="MJXp-mo" id="MJXp-Span-511" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">z</span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-514" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-515">1</span><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-517">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">a</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">z</span><span class="MJXp-mo" id="MJXp-Span-525" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-526" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-527" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-528">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">a</span><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">z</span><span class="MJXp-mo" id="MJXp-Span-536" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-537" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">y</span><span class="MJXp-mo" id="MJXp-Span-539" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-540" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-541">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">g</span><span class="MJXp-mrow" id="MJXp-Span-545"><span class="MJXp-mn" id="MJXp-Span-546">60</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> \ frac {\ parcial C} {\ parcial w_j} = \ frac {1} {n} \ sum_x \ frac {\ sigma '(z) x_j} {\ sigma (z) (1- \ sigma (z)) } (\ sigma (z) -y). \ tag {60} </script></p><br><br>  Usando a defini√ß√£o de sigm√≥ide, œÉ (z) = 1 / (1 + e <sup>‚àíz</sup> ) e um pouco de √°lgebra, podemos mostrar que œÉ ‚Ä≤ (z) = œÉ (z) (1 - œÉ (z)).  Pedirei que voc√™ verifique isso mais adiante no exerc√≠cio, mas, por enquanto, aceite-o como a verdade.  Os termos œÉ (z) e œÉ (z) (1 - œÉ (z)) s√£o cancelados e isso leva a <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-547"><span class="MJXp-mtext" id="MJXp-Span-548">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">c</span><span class="MJXp-mrow" id="MJXp-Span-553"><span class="MJXp-mtext" id="MJXp-Span-554">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">C</span></span><span class="MJXp-mrow" id="MJXp-Span-563"><span class="MJXp-mtext" id="MJXp-Span-564">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">l</span><span class="MJXp-msubsup" id="MJXp-Span-572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-574" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-575" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-576">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">c</span><span class="MJXp-mrow" id="MJXp-Span-581"><span class="MJXp-mn" id="MJXp-Span-582">1</span></span><span class="MJXp-mrow" id="MJXp-Span-583"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">n</span></span><span class="MJXp-mtext" id="MJXp-Span-585">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">u</span><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-593" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-594" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-595">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">a</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">z</span><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">y</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">g</span><span class="MJXp-mrow" id="MJXp-Span-612"><span class="MJXp-mn" id="MJXp-Span-613">61</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> \ frac {\ parcial C} {\ parcial w_j} = \ frac {1} {n} \ sum_x x_j (\ sigma (z) -y). \ tag {61} </script></p><br><br>  √ìtima express√£o.  Daqui resulta que a velocidade com que os pesos s√£o treinados √© controlada por œÉ (z) -y, isto √©, por um erro na sa√≠da.  Quanto maior o erro, mais r√°pido o neur√¥nio aprende.  Isso poderia ser esperado intuitivamente.  Esta op√ß√£o evita a desacelera√ß√£o no aprendizado causada pelo termo œÉ '(z) em uma equa√ß√£o de custo quadr√°tico semelhante (55).  Quando usamos entropia cruzada, o termo œÉ '(z) √© reduzido e n√£o precisamos mais nos preocupar com sua pequenez.  Essa redu√ß√£o √© um milagre especial garantido pela fun√ß√£o de custo de entropia cruzada.  De fato, √© claro, isso n√£o √© um milagre.  Como veremos mais adiante, a entropia cruzada foi escolhida especificamente para essa propriedade. <br><br>  Da mesma forma, a derivada parcial para o vi√©s pode ser calculada.  N√£o darei todos os detalhes novamente, mas voc√™ pode verificar facilmente se <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-614"><span class="MJXp-mtext" id="MJXp-Span-615">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">c</span><span class="MJXp-mrow" id="MJXp-Span-620"><span class="MJXp-mtext" id="MJXp-Span-621">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">C</span></span><span class="MJXp-mrow" id="MJXp-Span-630"><span class="MJXp-mtext" id="MJXp-Span-631">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-636">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">b</span></span><span class="MJXp-mo" id="MJXp-Span-640" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-641">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">c</span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mn" id="MJXp-Span-647">1</span></span><span class="MJXp-mrow" id="MJXp-Span-648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">n</span></span><span class="MJXp-mtext" id="MJXp-Span-650">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">u</span><span class="MJXp-msubsup" id="MJXp-Span-653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-655" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-657">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">a</span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">z</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-666" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">y</span><span class="MJXp-mo" id="MJXp-Span-668" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-670">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">g</span><span class="MJXp-mrow" id="MJXp-Span-674"><span class="MJXp-mn" id="MJXp-Span-675">62</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> \ frac {\ parcial C} {\ parcial b} = \ frac {1} {n} \ sum_x (\ sigma (z) -y). \ tag {62} </script></p><br><br>  Isso novamente ajuda a evitar o atraso no aprendizado devido ao termo œÉ '(z) em uma equa√ß√£o semelhante para o valor quadr√°tico (56). <br><br><h3>  Exerc√≠cio </h3><br><ul><li>  Verifique se œÉ ‚Ä≤ (z) = œÉ (z) (1 - œÉ (z)). </li></ul><br><br>  Vamos voltar ao nosso exemplo absurdo com o qual brincamos anteriormente e ver o que acontece se usarmos entropia cruzada em vez do valor quadr√°tico.  Para sintonizar, come√ßamos com o caso em que o custo quadr√°tico funcionou perfeitamente quando o peso inicial era 0,6 e a compensa√ß√£o era 0,9.  O artigo original possui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uma forma interativa</a> na qual voc√™ pode clicar no bot√£o Executar e ver o que acontece quando voc√™ substitui o valor quadr√°tico por entropia cruzada. <br><br>  N√£o √© de surpreender que o neur√¥nio neste caso seja treinado perfeitamente, como antes.  Agora, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">vamos ver</a> o caso em que o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neur√¥nio ficava preso</a> , com peso e deslocamento a partir de 2,0. <br><br><img src="https://habrastorage.org/webt/mg/xt/bb/mgxtbb83sfsoikt345v4hukgpmi.png"><br><br>  Sucesso!  Desta vez, o neur√¥nio aprendeu rapidamente, como quer√≠amos.  Se voc√™ observar atentamente, poder√° ver que a inclina√ß√£o da curva de custo √© inicialmente mais √≠ngreme em compara√ß√£o com a regi√£o plana da curva de valor quadr√°tico correspondente.  Essa entropia entre pa√≠ses nos d√° essa frieza e n√£o nos deixa presos onde esperamos o treinamento mais r√°pido de um neur√¥nio quando ele come√ßa com grandes erros. <br><br>  Eu n√£o disse que velocidade de treinamento foi usada nos √∫ltimos exemplos.  Anteriormente, com um valor quadr√°tico, usamos Œ∑ = 0,15.  Devemos usar a mesma velocidade nos novos exemplos?  De fato, mudando a fun√ß√£o de custo, √© imposs√≠vel dizer exatamente o que significa usar a "mesma" velocidade de aprendizado;  ser√° uma compara√ß√£o de ma√ß√£s com laranjas.  Para ambas as fun√ß√µes de custo, experimentei procurando uma velocidade de aprendizado que me permitisse ver o que est√° acontecendo.  Se voc√™ ainda estiver interessado, nos exemplos mais recentes, Œ∑ = 0,005. <br><br>  Voc√™ pode argumentar que mudar a velocidade do aprendizado torna os gr√°ficos sem sentido.  Quem se importa com a rapidez com que um neur√¥nio aprende se podemos escolher arbitrariamente uma velocidade de aprendizado?  Mas essa obje√ß√£o n√£o leva em considera√ß√£o o ponto principal.  O significado dos gr√°ficos n√£o est√° na velocidade absoluta da aprendizagem, mas em como essa velocidade muda.  Ao usar a fun√ß√£o quadr√°tica, o treinamento √© mais lento se o neur√¥nio estiver muito errado, e ent√£o vai mais r√°pido quando o neur√¥nio se aproxima da resposta desejada.  Com a entropia cruzada, o aprendizado √© mais r√°pido quando um neur√¥nio comete um grande erro.  E essas declara√ß√µes n√£o dependem de uma determinada velocidade de aprendizado. <br><br>  Examinamos entropia cruzada para um neur√¥nio.  No entanto, √© f√°cil generalizar para redes com muitas camadas e muitos neur√¥nios.  Suponha que y = y <sub>1</sub> , y <sub>2</sub> , ... s√£o os valores desejados dos neur√¥nios de sa√≠da, ou seja, os neur√¥nios da √∫ltima camada, e um <sup>L</sup> <sub>1</sub> , um <sup>L</sup> <sub>2</sub> , ... s√£o os pr√≥prios valores de sa√≠da.  Ent√£o a entropia cruzada pode ser definida como: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-676"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">C</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-679" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-680">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">c</span><span class="MJXp-mrow" id="MJXp-Span-685"><span class="MJXp-mn" id="MJXp-Span-686">1</span></span><span class="MJXp-mrow" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">n</span></span><span class="MJXp-mtext" id="MJXp-Span-689">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">u</span><span class="MJXp-msubsup" id="MJXp-Span-692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-694" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-695">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">u</span><span class="MJXp-msubsup" id="MJXp-Span-698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-700" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-701">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">t</span><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-709" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-710">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">n</span><span class="MJXp-msubsup" id="MJXp-Span-713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-717" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-719">1</span><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-723" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-725">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">n</span><span class="MJXp-mo" id="MJXp-Span-728" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-729">1</span><span class="MJXp-mo" id="MJXp-Span-730" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-731"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-736">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">t</span><span class="MJXp-mo" id="MJXp-Span-742" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-743">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">g</span><span class="MJXp-mrow" id="MJXp-Span-747"><span class="MJXp-mn" id="MJXp-Span-748">63</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> C = - \ frac {1} {n} \ sum_x \ sum_j \ left [y_j \ ln a ^ L_j + (1-y_j) \ ln (1-a ^ L_j) \ right] \ tag {63} </script></p><br><br>  √â o mesmo que a equa√ß√£o (57), s√≥ que agora nossa soma de todos os neur√¥nios de sa√≠da.  N√£o analisarei a derivada em detalhes, mas √© razo√°vel supor que, usando a express√£o (63), possamos evitar a desacelera√ß√£o nas redes com muitos neur√¥nios.  Se estiver interessado, voc√™ pode obter a derivada no problema abaixo. <br><br>  Ali√°s, o termo ‚Äúentropia cruzada‚Äù que eu uso confundiu alguns dos primeiros leitores do livro porque contradiz outras fontes.  Em particular, frequentemente a entropia cruzada √© determinada para duas distribui√ß√µes de probabilidade, pj <br>  e qj, como ‚àë <sub>j</sub> p <sub>j</sub> lnq <sub>j</sub> .  Essa defini√ß√£o pode ser associada a (57), se um neur√¥nio sigm√≥ide for considerado como fornecendo uma distribui√ß√£o de probabilidade que consiste na ativa√ß√£o dos valores dos neur√¥nios ae 1-a complementares. <br><br>  No entanto, se tivermos muitos neur√¥nios sigm√≥ides na √∫ltima camada, o vetor a <sup>L</sup> <sub>j</sub> geralmente n√£o fornece uma distribui√ß√£o de probabilidade.  Como resultado, a defini√ß√£o do tipo ‚àë <sub>j</sub> p <sub>j</sub> lnq <sub>j</sub> n√£o <sub>tem</sub> sentido, pois n√£o trabalhamos com distribui√ß√µes de probabilidade.  Em vez disso (63), pode-se imaginar como um conjunto resumido de entropias cruzadas de cada neur√¥nio √© resumido, onde a ativa√ß√£o de cada neur√¥nio √© interpretada como parte de uma distribui√ß√£o de probabilidade de dois elementos (√© claro, n√£o h√° elementos de probabilidade em nossas redes, portanto, na verdade, n√£o s√£o probabilidades).  Nesse sentido, (63) ser√° uma generaliza√ß√£o da entropia cruzada para distribui√ß√µes de probabilidade. <br><br>  Quando usar entropia cruzada em vez de valor quadr√°tico?  De fato, a entropia cruzada quase sempre ser√° usada melhor se voc√™ tiver neur√¥nios de sa√≠da sigm√≥ide.  Para entender isso, lembre-se de que, ao configurar uma rede, geralmente inicializamos pesos e compensa√ß√µes usando um processo aleat√≥rio.  Pode acontecer que essa escolha leve ao fato de que a rede interpretar√° completamente alguns dados de entrada de treinamento - por exemplo, o neur√¥nio de sa√≠da tender√° a 1, quando deve ir para 0 ou vice-versa.  Se usarmos um valor quadr√°tico que retarda o treinamento, ele n√£o interromper√° o treinamento, pois os pesos continuar√£o a ser treinados em outros exemplos de treinamento, mas essa situa√ß√£o √© obviamente indesej√°vel. <br><br><h3>  Exerc√≠cios </h3><br><ul><li>  Um problema da entropia cruzada √© que, a princ√≠pio, pode ser dif√≠cil lembrar os pap√©is correspondentes de y e a.  √â f√°cil ficar confuso, como ser√° correto, - [ylna + (1 - y) ln (1 - a)] ou - [alny + (1 - a) ln (1 - y)].  O que acontecer√° com a segunda express√£o quando y = 0 ou 1?  Esse problema afeta a primeira express√£o?  Porque </li><li>  Na discuss√£o de um √∫nico neur√¥nio no in√≠cio da se√ß√£o, eu disse que a entropia cruzada √© pequena se œÉ (z) yy para todos os dados de entrada do treinamento.    ,  y  0  1.       ,     (, ) y      0  1. ,      ,  œÉ(z)=y    .   ,     <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-749"><span class="MJXp-mtable" id="MJXp-Span-750"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-751" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-752" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">C</span><span class="MJXp-mo" id="MJXp-Span-754" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mfrac" id="MJXp-Span-756" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-757">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-759"><span class=""><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761" style="margin-left: 0px;">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-762" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">y</span><span class="MJXp-mi" id="MJXp-Span-764">ln</span><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">y</span><span class="MJXp-mo" id="MJXp-Span-767" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-769">1</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">y</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-773">ln</span><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-775" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-776">1</span><span class="MJXp-mo" id="MJXp-Span-777" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">y</span><span class="MJXp-mo" id="MJXp-Span-779" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> C = -\frac{1}{n} \sum_x [y \ln y+(1-y) \ln(1-y)] \tag{64} </script></p>  .  ‚àí[ylny+(1‚àíy)ln(1‚àíy)]    . </li></ul><br><br><h3>  </h3><br><ul><li>     .      ,             <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-781"><span class="MJXp-mtable" id="MJXp-Span-782"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-783" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-784" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-785" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-786">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-788">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-795" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-796" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-797">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-799"><span class=""><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">L</span><span class="MJXp-mo" id="MJXp-Span-807">‚àí</span><span class="MJXp-mn" id="MJXp-Span-808">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-817" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-821" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-827" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \sigma'(z^L_j) \tag{65} </script></p>  œÉ'(z <sup>L</sup> <sub>j</sub> )   ,      . ,          Œ¥ <sup>L</sup>     x   <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-828"><span class="MJXp-mtable" id="MJXp-Span-829"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-830" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-831" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-832"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833" style="margin-right: 0.05em;">Œ¥</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-834" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-838" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-839" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">y</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> \delta^L = a^L-y \tag{66} </script></p>   ,  ,           <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-841"><span class="MJXp-mtable" id="MJXp-Span-842"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-843" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-844" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-845" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-846">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-848">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-855" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-856" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-857">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-859"><span class=""><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">L</span><span class="MJXp-mo" id="MJXp-Span-867">‚àí</span><span class="MJXp-mn" id="MJXp-Span-868">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-869" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-877" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-14"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \tag{67} </script></p>  œÉ'(z <sup>L</sup> <sub>j</sub> ) ,       ,       ,          .         .     ,       . </li><li>         . ,       . ,      ,       ,     ,  a <sup>L</sup> <sub>j</sub> = z <sup>L</sup> <sub>j</sub> . ,         Œ¥L     x  <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-879"><span class="MJXp-mtable" id="MJXp-Span-880"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-881" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-882" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-883"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884" style="margin-right: 0.05em;">Œ¥</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-885" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-886" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-887"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-889" style="vertical-align: 0.5em;">L</span></span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">y</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \delta^L = a^L-y \tag{68} </script></p>     ,   ,  ,           ,  <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-892"><span class="MJXp-mtable" id="MJXp-Span-893"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-894" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-895" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-896" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-897">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-899">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">k</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-906" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-907" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-908">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-910"><span class=""><span class="MJXp-mo" id="MJXp-Span-911" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912" style="margin-left: 0px;">x</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-913"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-916"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">L</span><span class="MJXp-mo" id="MJXp-Span-918">‚àí</span><span class="MJXp-mn" id="MJXp-Span-919">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-925" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-926"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-928" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-929" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \frac{\partial C}{\partial w^L_{jk}} = \frac{1}{n} \sum_x a^{L-1}_k (a^L_j-y_j) \tag{69} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-930"><span class="MJXp-mtable" id="MJXp-Span-931"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-932" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-933" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-934" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-935">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">C</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-937">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-940"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">j</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-943" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-944" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-945">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-947"><span class=""><span class="MJXp-mo" id="MJXp-Span-948" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949" style="margin-left: 0px;">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-950" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-955" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-958" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-959" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> \frac{\partial C}{\partial b^L_{j}} = \frac{1}{n} \sum_x (a^L_j-y_j) \tag{70} </script></p>  ,     ,          .         . </li></ul><br><br><h2>        MNIST </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A entropia cruzada √© f√°cil de implementar como parte de um programa que ensina a rede usando descida de gradiente e propaga√ß√£o de retorno. Faremos isso mais tarde desenvolvendo uma vers√£o aprimorada do nosso programa de classifica√ß√£o num√©rica manuscrita do MNIST, network.py. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O novo programa</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© chamado network2.py e inclui n√£o apenas entropia cruzada, mas tamb√©m v√°rias outras t√©cnicas desenvolvidas neste cap√≠tulo. Enquanto isso, vamos ver o qu√£o bem nosso novo programa classifica os d√≠gitos MNIST. Como no cap√≠tulo 1, usaremos uma rede com 30 neur√¥nios ocultos e um mini-pacote de tamanho 10. Definiremos a velocidade de aprendizado Œ∑ = 0,5 e aprenderemos 30 eras.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como eu j√° disse, √© imposs√≠vel dizer exatamente qual velocidade de treinamento √© adequada e, nesse caso, experimentei a sele√ß√£o. √â verdade que existe uma maneira de relacionar heuristicamente a taxa de aprendizado com a entropia e o valor quadr√°tico. Vimos anteriormente que, nos termos do gradiente para o valor quadr√°tico, existe um termo adicional œÉ '= œÉ (1-œÉ). Suponha que </font><font style="vertical-align: inherit;">calculemos a </font><font style="vertical-align: inherit;">m√©dia desses valores para œÉ, </font><sub><font style="vertical-align: inherit;">0 </font></sub></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dœÉ œÉ (1 - œÉ) = 1/6. Pode-se observar que o custo quadr√°tico (aproximadamente) aprende, em m√©dia, 6 vezes mais devagar para a mesma taxa de aprendizado. Isso sugere que um bom ponto de partida seria dividir a velocidade de aprendizado de uma fun√ß√£o quadr√°tica por 6. √â claro que esse n√£o √© um argumento estrito, e voc√™ n√£o deve levar isso muito a s√©rio. Mas √†s vezes pode ser √∫til como ponto de partida.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A interface do network2.py √© um pouco diferente do network.py, mas ainda deve ficar claro o que est√° acontecendo. </font><font style="vertical-align: inherit;">A documenta√ß√£o em network2.py pode ser obtida usando o comando help (network2.Network.SGD) no shell python.</font></font><br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, evaluation_data=test_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br>  Observe, a prop√≥sito, que o comando net.large_weight_initializer () √© usado para inicializar pesos e compensa√ß√µes da mesma maneira como descrito no cap√≠tulo 1. Precisamos execut√°-lo porque alteraremos a inicializa√ß√£o de pesos por padr√£o mais tarde.  Como resultado, ap√≥s iniciar todos os comandos acima, obtemos uma rede que funciona com uma precis√£o de 95,49%.  Isso est√° muito pr√≥ximo do resultado do primeiro cap√≠tulo, 95,42%, usando o valor quadr√°tico. <br><br>  Vejamos tamb√©m o caso em que usamos 100 neur√¥nios ocultos e entropia cruzada e deixamos o resto da mesma forma.  Nesse caso, a precis√£o √© de 96,82%.  Essa √© uma grande melhoria em rela√ß√£o aos resultados do primeiro cap√≠tulo, onde alcan√ßamos uma precis√£o de 96,59% usando o valor quadr√°tico.  A altera√ß√£o pode parecer pequena, mas pense que o erro caiu de 3,41% para 3,18%.  Ou seja, eliminamos aproximadamente 1/14 dos erros.  Isso √© muito bom. <br><br>  √â muito bom que a fun√ß√£o de custo de entropia cruzada nos d√™ resultados semelhantes ou melhores em compara√ß√£o com o valor quadr√°tico.  No entanto, eles n√£o provam inequivocamente que a entropia cruzada √© a melhor escolha.  O fato √© que eu n√£o tentei escolher os hiperpar√¢metros - a velocidade do treinamento, o tamanho da minipacote, etc.  Para tornar a melhoria mais convincente, precisamos lidar adequadamente com a otimiza√ß√£o.  Mas os resultados ainda s√£o inspiradores, e nossos c√°lculos te√≥ricos confirmam que a entropia cruzada √© uma escolha melhor do que a fun√ß√£o de custo quadr√°tico. <br><br>  Nesse sentido, este cap√≠tulo inteiro e, em princ√≠pio, o restante do livro ser√£o apresentados.  Vamos desenvolver novas tecnologias, test√°-las e obter "melhores resultados".  Claro, √© bom que vejamos essas melhorias.  Mas interpret√°-los √© sempre dif√≠cil.  S√≥ ser√° convincente se observarmos melhorias ap√≥s um trabalho s√©rio na otimiza√ß√£o de todos os outros hiperpar√¢metros.  E esse √© um trabalho bastante complicado, que requer grandes recursos computacionais, e geralmente n√£o lidaremos com uma investiga√ß√£o t√£o completa.  Em vez disso, iremos al√©m com base em testes informais, como os listados acima.  Mas voc√™ deve ter em mente que esses testes n√£o s√£o evid√™ncias inequ√≠vocas e monitorar cuidadosamente esses casos quando os argumentos come√ßarem a falhar. <br><br>  At√© agora, discutimos a entropia cruzada em detalhes.  Por que desperdi√ßar tanto esfor√ßo se isso oferece uma melhoria t√£o pequena em nossos resultados do MNIST?  Mais adiante neste cap√≠tulo, veremos outras t√©cnicas - em particular a regulariza√ß√£o - que oferecem melhorias muito mais fortes.  Ent√£o, por que nos concentramos na entropia cruzada?  Em particular, como a entropia cruzada √© uma fun√ß√£o de valor usada com frequ√™ncia, vale a pena entender bem.  Mas a raz√£o mais importante √© que a satura√ß√£o dos neur√¥nios √© um problema importante no campo das redes neurais, ao qual retornaremos constantemente ao longo do livro.  Portanto, discuti a entropia cruzada com tanto detalhe, pois √© um bom laborat√≥rio come√ßar a entender a satura√ß√£o dos neur√¥nios e como abordar abordagens para esse problema. <br><br><h2>  O que significa entropia cruzada?  De onde vem? </h2><br>  Nossa discuss√£o sobre entropia cruzada girou em torno da an√°lise alg√©brica e da implementa√ß√£o pr√°tica.  Isso √© √∫til, mas, como resultado, quest√µes conceituais mais amplas permanecem sem resposta, por exemplo: o que significa entropia cruzada?  Existe uma maneira intuitiva de apresent√°-lo?  Como as pessoas poderiam sugerir entropia cruzada? <br><br>  Vamos come√ßar com o √∫ltimo: o que poderia nos fazer pensar em entropia cruzada?  Suponha que descobrimos uma desacelera√ß√£o do aprendizado descrita anteriormente e percebemos que ela foi causada pelos termos œÉ '(z) nas equa√ß√µes (55) e (56).  Olhando de relance para essas equa√ß√µes, poder√≠amos pensar se √© poss√≠vel escolher uma fun√ß√£o de custo para que o termo œÉ '(z) desapare√ßa.  Ent√£o o custo C = C <sub>x de</sub> um exemplo de treinamento satisfaria as equa√ß√µes: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-960"><span class="MJXp-mtext" id="MJXp-Span-961">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968"><font style="vertical-align: inherit;">p </font></span></span><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970"><font style="vertical-align: inherit;">r </font></span></span><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971"><font style="vertical-align: inherit;">c </font></span></span><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974"><font style="vertical-align: inherit;">l </font></span></span><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975"><font style="vertical-align: inherit;">C </font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978"><font style="vertical-align: inherit;">p </font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980"><font style="vertical-align: inherit;">r </font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981"><font style="vertical-align: inherit;">c </font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984"><font style="vertical-align: inherit;">l </font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">w </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-987" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">j</font></span></span></span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"> = </font></span><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">x </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-991" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">j</font></span></span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> ( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">- </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995"><font style="vertical-align: inherit;">y </font></span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mrow" id="MJXp-Span-1001"><span class="MJXp-mn" id="MJXp-Span-1002"><font style="vertical-align: inherit;">71</font></span></span></font><span class="MJXp-mrow" id="MJXp-Span-966"><span class="MJXp-mtext" id="MJXp-Span-967">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mtext" id="MJXp-Span-977">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-987" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-991" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-997">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-1001"><span class="MJXp-mn" id="MJXp-Span-1002"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> \ frac {\ parcial C} {\ parcial w_j} = x_j (a-y) \ tag {71} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1003"><span class="MJXp-mtext" id="MJXp-Span-1004">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">c</span><span class="MJXp-mrow" id="MJXp-Span-1009"><span class="MJXp-mtext" id="MJXp-Span-1010">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1019"><span class="MJXp-mtext" id="MJXp-Span-1020">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">b</span></span><span class="MJXp-mo" id="MJXp-Span-1029" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1030" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">a</span><span class="MJXp-mo" id="MJXp-Span-1032" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">y</span><span class="MJXp-mo" id="MJXp-Span-1034" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1035">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">g</span><span class="MJXp-mrow" id="MJXp-Span-1039"><span class="MJXp-mn" id="MJXp-Span-1040">72</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-19"> \ frac {\ parcial C} {\ parcial b} = (a-y) \ tag {72} </script></p><br><br>  Se escolhermos uma fun√ß√£o de valor que os torne verdadeiros, eles prefeririam simplesmente descrever um entendimento intuitivo de que quanto maior o erro inicial, mais r√°pido o neur√¥nio aprende.  Eles tamb√©m resolveriam o problema de desacelera√ß√£o.  De fato, come√ßando com essas equa√ß√µes, mostrar√≠amos que √© poss√≠vel derivar a forma de entropia cruzada simplesmente seguindo um instinto matem√°tico.  Para ver isso, observamos que, com base na regra da cadeia, obtemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1041"><span class="MJXp-mtext" id="MJXp-Span-1042">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">c</span><span class="MJXp-mrow" id="MJXp-Span-1047"><span class="MJXp-mtext" id="MJXp-Span-1048">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1057"><span class="MJXp-mtext" id="MJXp-Span-1058">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">b</span></span><span class="MJXp-mo" id="MJXp-Span-1067" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1068">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">c</span><span class="MJXp-mrow" id="MJXp-Span-1073"><span class="MJXp-mtext" id="MJXp-Span-1074">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1083"><span class="MJXp-mtext" id="MJXp-Span-1084">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">a</span></span><span class="MJXp-mtext" id="MJXp-Span-1093">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">m</span><span class="MJXp-msup" id="MJXp-Span-1098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1100" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">z</span><span class="MJXp-mo" id="MJXp-Span-1103" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1104">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107">g</span><span class="MJXp-mrow" id="MJXp-Span-1108"><span class="MJXp-mn" id="MJXp-Span-1109">73</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-20"> \ frac {\ parcial C} {\ parcial b} = \ frac {\ parcial C} {\ parcial a} \ sigma '(z) \ tag {73} </script></p><br><br>  Usando na √∫ltima equa√ß√£o œÉ ‚Ä≤ (z) = œÉ (z) (1 - œÉ (z)) = a (1 - a), obtemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1110"><span class="MJXp-mtext" id="MJXp-Span-1111">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">c</span><span class="MJXp-mrow" id="MJXp-Span-1116"><span class="MJXp-mtext" id="MJXp-Span-1117">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1126"><span class="MJXp-mtext" id="MJXp-Span-1127">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">b</span></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1137">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">c</span><span class="MJXp-mrow" id="MJXp-Span-1142"><span class="MJXp-mtext" id="MJXp-Span-1143">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1152"><span class="MJXp-mtext" id="MJXp-Span-1153">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">a</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">a</span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1164">1</span><span class="MJXp-mo" id="MJXp-Span-1165" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">a</span><span class="MJXp-mo" id="MJXp-Span-1167" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1168">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">g</span><span class="MJXp-mrow" id="MJXp-Span-1172"><span class="MJXp-mn" id="MJXp-Span-1173">74</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-21"> \ frac {\ parcial C} {\ parcial b} = \ frac {\ parcial C} {\ parcial a} a (1-a) \ tag {74} </script></p><br><br>  Comparando com a equa√ß√£o (72), obtemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1174"><span class="MJXp-mtext" id="MJXp-Span-1175">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">c</span><span class="MJXp-mrow" id="MJXp-Span-1180"><span class="MJXp-mtext" id="MJXp-Span-1181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1190"><span class="MJXp-mtext" id="MJXp-Span-1191">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">a</span></span><span class="MJXp-mo" id="MJXp-Span-1200" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1201">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">c</span><span class="MJXp-mrow" id="MJXp-Span-1206"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">a</span><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">a</span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1213">1</span><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">a</span><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtext" id="MJXp-Span-1217">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220">g</span><span class="MJXp-mrow" id="MJXp-Span-1221"><span class="MJXp-mn" id="MJXp-Span-1222">75</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> \ frac {\ parcial C} {\ parcial a} = \ frac {a-y} {a (1-a)} \ tag {75} </script></p><br><br>  Integrando esta express√£o sobre a, obtemos: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1223"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">C</span><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1226" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1227" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">y</span><span class="MJXp-mtext" id="MJXp-Span-1229">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">a</span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1235">1</span><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">y</span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1239">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">n</span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1243">1</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">a</span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1249"><span class="MJXp-mtext" id="MJXp-Span-1250">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">e</span></span><span class="MJXp-mtext" id="MJXp-Span-1262">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">g</span><span class="MJXp-mrow" id="MJXp-Span-1266"><span class="MJXp-mn" id="MJXp-Span-1267">76</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-23"> C = - [y \ ln a + (1-y) \ ln (1-a)] + {\ rm constante} \ tag {76} </script></p><br><br>  Essa √© a contribui√ß√£o de um exemplo de treinamento separado x para a fun√ß√£o de custo.  Para obter a fun√ß√£o de custo total, precisamos calcular a m√©dia de todos os exemplos de treinamento e chegamos a: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">C</span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1271" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1272">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">c</span><span class="MJXp-mrow" id="MJXp-Span-1277"><span class="MJXp-mn" id="MJXp-Span-1278">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">n</span></span><span class="MJXp-mtext" id="MJXp-Span-1281">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">u</span><span class="MJXp-msubsup" id="MJXp-Span-1284"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1286" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">y</span><span class="MJXp-mtext" id="MJXp-Span-1289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">m</span><span class="MJXp-mo" id="MJXp-Span-1293" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1294" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1295">1</span><span class="MJXp-mo" id="MJXp-Span-1296" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">y</span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1299">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">n</span><span class="MJXp-mo" id="MJXp-Span-1302" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1303">1</span><span class="MJXp-mo" id="MJXp-Span-1304" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">a</span><span class="MJXp-mo" id="MJXp-Span-1306" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1308" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-1309"><span class="MJXp-mtext" id="MJXp-Span-1310">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1318">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">e</span></span><span class="MJXp-mtext" id="MJXp-Span-1322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">g</span><span class="MJXp-mrow" id="MJXp-Span-1326"><span class="MJXp-mn" id="MJXp-Span-1327">77</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-24"> C = - \ frac {1} {n} \ sum_x [y \ n em + (1-y) \ ln (1-a)] + {\ rm constante} \ tag {77} </script></p><br><br>  A constante aqui √© a m√©dia das constantes individuais de cada um dos exemplos de treinamento.  Como voc√™ pode ver, as equa√ß√µes (71) e (72) determinam exclusivamente a forma da entropia cruzada, carne para uma constante comum.  A entropia cruzada n√£o foi magicamente retirada do ar.  Ela poderia ser encontrada de uma maneira simples e natural. <br><br>  E a id√©ia intuitiva de entropia cruzada?  Como imaginamos isso?  Uma explica√ß√£o detalhada nos levaria a superar nosso curso de treinamento.  No entanto, podemos mencionar a exist√™ncia de uma maneira padr√£o de interpretar entropia cruzada, originada no campo da teoria da informa√ß√£o.  Grosso modo, a entropia cruzada √© uma surpresa.  Por exemplo, nosso neur√¥nio est√° tentando calcular a fun√ß√£o x ‚Üí y = y (x).  Mas, em vez disso, conta a fun√ß√£o x ‚Üí a = a (x).  Suponha que imaginemos a estimativa de um neur√¥nio da probabilidade de que y = 1 e 1-a √© a probabilidade de que o valor correto para y seja 0. Ent√£o a entropia cruzada mede o quanto estamos "surpresos", em m√©dia, quando encontre o verdadeiro valor de y.  N√£o ficamos surpresos se esperamos uma sa√≠da, e ficamos surpresos se a sa√≠da for inesperada.  Claro, eu n√£o dei uma defini√ß√£o estrita de "surpresa", ent√£o tudo isso pode parecer discurso ret√≥rico.  Mas, de fato, na teoria da informa√ß√£o, existe uma maneira exata de determinar o inesperado.  Infelizmente, n√£o conhe√ßo nenhum exemplo de uma discuss√£o boa, curta e auto-suficiente sobre esse ponto na Internet.  Mas se voc√™ estiver interessado em aprofundar um pouco mais, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wikipedia</a> possui boas informa√ß√µes gerais que o enviar√£o na dire√ß√£o certa.  Detalhes podem ser encontrados no Cap√≠tulo 5, sobre desigualdade Kraft, em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">livro sobre teoria da informa√ß√£o</a> . <br><br><h3>  Desafio </h3><br><ul><li>  Discutimos em detalhes a desacelera√ß√£o no aprendizado que pode ocorrer quando os neur√¥nios est√£o saturados em redes usando a fun√ß√£o de custo quadr√°tico no aprendizado.  Outro fator que pode inibir a aprendizagem √© a presen√ßa do termo x <sub>j</sub> na equa√ß√£o (61).  Por isso, quando a sa√≠da x <sub>j se</sub> aproxima de zero, o peso correspondente w <sub>j</sub> ser√° treinado lentamente.  Explique por que √© imposs√≠vel eliminar o termo x <sub>j</sub> escolhendo alguma fun√ß√£o de custo engenhosa. </li></ul><br><br><h2>  Softmax (fun√ß√£o m√°xima suave) </h2><br>  Neste cap√≠tulo, usaremos principalmente a fun√ß√£o de custo de entropia cruzada para resolver os problemas de desacelera√ß√£o do aprendizado.  No entanto, gostaria de discutir brevemente outra abordagem para esse problema, com base no chamado  softmax-camadas de neur√¥nios.  N√£o usaremos as camadas Softmax no restante deste cap√≠tulo; portanto, se voc√™ estiver com pressa, poder√° pular esta se√ß√£o.  No entanto, o Softmax ainda vale a pena entender, em particular porque √© interessante por si s√≥, e em particular porque usaremos as camadas do Softmax no Cap√≠tulo 6, em nossa discuss√£o sobre redes neurais profundas. <br><br>  A id√©ia do Softmax √© definir um novo tipo de camada de sa√≠da para HC.  Come√ßa da mesma maneira que a camada sigm√≥ide, com a forma√ß√£o de insumos ponderados <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1328"><span class="MJXp-msubsup" id="MJXp-Span-1329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1334">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">u</span><span class="MJXp-msubsup" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1339" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">k</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">k</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">L</span><span class="MJXp-mo" id="MJXp-Span-1352">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1353">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1357">j</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> z ^ L_j = \ sum_ {k} w ^ L_ {jk} a ^ {L-1} _k + b ^ L_j </script>  .  No entanto, n√£o usamos um sigm√≥ide para obter uma resposta.  Na camada Softmax, aplicamos a fun√ß√£o Softmax a z <sup>L</sup> <sub>j</sub> .  Segundo ela, a ativa√ß√£o a <sup>L</sup> <sub>j do</sub> neur√¥nio de sa√≠da n. J √© igual a: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1359"><span class="MJXp-msubsup" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1363">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1365">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">c</span><span class="MJXp-mrow" id="MJXp-Span-1370"><span class="MJXp-msubsup" id="MJXp-Span-1371"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1373" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1374"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1375" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1378"><span class="MJXp-mtext" id="MJXp-Span-1379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">u</span><span class="MJXp-msubsup" id="MJXp-Span-1382"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1384" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1385"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1387" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1392">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1393">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">g</span><span class="MJXp-mrow" id="MJXp-Span-1396"><span class="MJXp-mn" id="MJXp-Span-1397">78</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-26"> a ^ L_j = \ frac {e ^ {z ^ L_j}} {\ sum_k e ^ {z ^ L_k}} \ tag {78} </script></p><br><br>  onde no denominador somamos todos os neur√¥nios de sa√≠da. <br><br>  Se a fun√ß√£o Softmax n√£o lhe √© familiar, a equa√ß√£o (78) parecer√° misteriosa para voc√™.  N√£o √© de todo √≥bvio por que devemos usar essa fun√ß√£o.  Tamb√©m n√£o √© √≥bvio que isso nos ajudar√° a resolver o problema de desacelerar o aprendizado.  Para entender melhor a equa√ß√£o (78), suponha que tenhamos uma rede com quatro neur√¥nios de sa√≠da e quatro entradas ponderadas correspondentes, que designaremos como z <sup>L</sup> <sub>1</sub> , z <sup>L</sup> <sub>2</sub> , z <sup>L</sup> <sub>3</sub> e z <sup>L</sup> <sub>4</sub> .  O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo original</a> cont√©m controles deslizantes interativos, aos quais s√£o atribu√≠dos os poss√≠veis valores das entradas ponderadas e o cronograma das ativa√ß√µes de sa√≠da correspondentes.  Um bom ponto de partida para estud√°-los seria usar o controle deslizante inferior para aumentar z <sup>L</sup> <sub>4</sub> . <br><br><img src="https://habrastorage.org/webt/na/og/gw/naoggwrddhdvbb8oazriohydiy8.png"><br><br><img src="https://habrastorage.org/webt/tz/-7/_4/tz-7_4zl_-vtam3qzx22klosse8.png"><br><br>  Ao aumentar z <sup>L</sup> <sub>4</sub> , pode-se observar um aumento na ativa√ß√£o de sa√≠da correspondente, um <sup>L</sup> <sub>4</sub> e uma diminui√ß√£o em outras ativa√ß√µes de sa√≠da.  Com a diminui√ß√£o de z <sup>L</sup> <sub>4,</sub> a <sup>L</sup> <sub>4</sub> diminuir√° e todas as outras ativa√ß√µes de sa√≠da aumentar√£o.  Observando atentamente, voc√™ ver√° que, nos dois casos, a mudan√ßa geral em outras ativa√ß√µes compensa exatamente a mudan√ßa que ocorre em um <sup>L</sup> <sub>4</sub> .  A raz√£o para isso √© a garantia de que todas as ativa√ß√µes de sa√≠da no total d√£o 1, o que podemos provar usando a equa√ß√£o (78) e alguma √°lgebra: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1398"><span class="MJXp-mtext" id="MJXp-Span-1399">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">u</span><span class="MJXp-msubsup" id="MJXp-Span-1402"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1404" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1410">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">c</span><span class="MJXp-mrow" id="MJXp-Span-1415"><span class="MJXp-mtext" id="MJXp-Span-1416">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1418">u</span><span class="MJXp-msubsup" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1421" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-msubsup" id="MJXp-Span-1422"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1424" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1427">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1429"><span class="MJXp-mtext" id="MJXp-Span-1430">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">u</span><span class="MJXp-msubsup" id="MJXp-Span-1433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1435" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1436"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1438" style="vertical-align: 0.5em;"><span class="MJXp-msubsup" id="MJXp-Span-1439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1444">1</span><span class="MJXp-mtext" id="MJXp-Span-1445">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1448">g</span><span class="MJXp-mrow" id="MJXp-Span-1449"><span class="MJXp-mn" id="MJXp-Span-1450">79</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27"> \ sum_j a ^ L_j = \ frac {\ sum_j e ^ {z ^ L_j}} {\ sum_k e ^ {z ^ L_k}} = 1 \ tag {79} </script></p><br><br>  Como resultado, com um aumento em um <sup>L</sup> <sub>4, as</sub> ativa√ß√µes de sa√≠da restantes devem diminuir no mesmo valor no total para garantir que a soma de todas as ativa√ß√µes de sa√≠da seja igual a 1. E, √© claro, declara√ß√µes semelhantes ser√£o verdadeiras para todas as outras ativa√ß√µes. <br><br>  Tamb√©m resulta da equa√ß√£o (78) que todas as ativa√ß√µes de sa√≠da s√£o positivas, uma vez que a fun√ß√£o exponencial √© positiva.  Combinando isso com a observa√ß√£o do par√°grafo anterior, descobrimos que a sa√≠da da camada Softmax ser√° um conjunto de n√∫meros positivos, totalizando 1. Em outras palavras, a sa√≠da da camada Softmax pode ser representada como uma distribui√ß√£o de probabilidade. <br><br>  O fato de a sa√≠da da camada Softmax ser uma distribui√ß√£o de probabilidade √© muito agrad√°vel.  Em muitos problemas, √© conveniente poder interpretar as ativa√ß√µes de sa√≠da a <sup>L</sup> <sub>j</sub> como uma estimativa da rede da probabilidade de que o bulet j seja a op√ß√£o correta.  Assim, por exemplo, no problema de classifica√ß√£o MNIST, podemos interpretar um <sup>L</sup> <sub>j</sub> como uma estimativa pela rede da probabilidade de que j ser√° a vers√£o correta da classifica√ß√£o de um d√≠gito. <br><br>  Por outro lado, se a camada de sa√≠da era sigm√≥ide, ent√£o definitivamente n√£o podemos assumir que as ativa√ß√µes formam uma distribui√ß√£o de probabilidade.  N√£o vou provar isso estritamente, mas √© razo√°vel supor que as ativa√ß√µes da camada sigm√≥ide no caso geral n√£o formam uma distribui√ß√£o de probabilidade.  Portanto, usando uma camada de sa√≠da sigm√≥ide, n√£o teremos uma interpreta√ß√£o t√£o simples das ativa√ß√µes de sa√≠da. <br><br><h3>  Exerc√≠cio </h3><br><ul><li>  Fa√ßa um exemplo mostrando que em uma rede com uma camada de sa√≠da sigm√≥ide, as ativa√ß√µes de sa√≠da a <sup>L</sup> <sub>j</sub> nem sempre somam 1. </li></ul><br><br>  Come√ßamos a entender um pouco sobre as fun√ß√µes da Softmax e como as camadas da Softmax se comportam.  Apenas para resumir: os expoentes na equa√ß√£o (78) garantem que todas as ativa√ß√µes de sa√≠da sejam positivas.  A soma no denominador da equa√ß√£o (78) garante que a Softmax d√™ um total de 1. Portanto, esse tipo de equa√ß√£o n√£o parece mais misterioso: √© uma maneira natural de garantir que as ativa√ß√µes de sa√≠da formem uma distribui√ß√£o de probabilidade.  O Softmax pode ser imaginado como uma maneira de escalar z <sup>L</sup> <sub>j</sub> e depois compact√°-los para formar uma distribui√ß√£o de probabilidade. <br><br><h3>  Exerc√≠cios </h3><br><ul><li>  A monotonia do Softmax.  Mostre que La <sup>L</sup> <sub>j</sub> / ‚àÇz <sup>L</sup> <sub>k √©</sub> positivo se j = k e negativo se j ‚â† k.  Como resultado, <sub>√©</sub> garantido um aumento em z <sup>L</sup> <sub>j</sub> para aumentar a ativa√ß√£o de sa√≠da correspondente a <sup>L</sup> <sub>j</sub> e diminui todas as outras ativa√ß√µes de sa√≠da.  J√° vimos isso empiricamente usando o exemplo de controles deslizantes, mas essa prova ser√° rigorosa. </li><li>  N√£o localidade Softmax.  Uma caracter√≠stica interessante das camadas sigm√≥ides √© que a sa√≠da a <sup>L</sup> <sub>j</sub> √© uma fun√ß√£o da entrada ponderada correspondente, a <sup>L</sup> <sub>j</sub> = œÉ (z <sup>L</sup> <sub>j</sub> ).  Explique por que esse n√£o √© o caso da camada Softmax: qualquer ativa√ß√£o de sa√≠da a <sup>L</sup> <sub>j</sub> depende de todas as entradas ponderadas. </li></ul><br><br><h3>  Desafio </h3><br><ul><li>  Inverta a camada Softmax.  Suponha que temos um NS com uma camada Softmax de sa√≠da e as ativa√ß√µes a <sup>L</sup> <sub>j s√£o</sub> conhecidas.  Mostre que as entradas ponderadas correspondentes t√™m a forma z <sup>L</sup> <sub>j</sub> = ln a <sup>L</sup> <sub>j</sub> + C, onde C √© uma constante independente de j. </li></ul><br><br><h2>  Problema de desacelera√ß√£o da aprendizagem </h2><br>  J√° nos familiarizamos bastante com as camadas de neur√¥nios Softmax.  Mas at√© agora n√£o vimos como as camadas Softmax nos permitem resolver o problema de desacelerar o aprendizado.  Para entender isso, vamos definir uma fun√ß√£o de custo com base na "probabilidade de log".  Usaremos x para indicar a entrada de treinamento da rede e y para a sa√≠da desejada correspondente.  O LPS associado a esta entrada de treinamento ser√°: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1451"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">C</span><span class="MJXp-mtext" id="MJXp-Span-1453">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1457">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">v</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1460">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1461">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">u</span><span class="MJXp-msubsup" id="MJXp-Span-1464"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">y</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1468">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471">g</span><span class="MJXp-mrow" id="MJXp-Span-1472"><span class="MJXp-mn" id="MJXp-Span-1473">80</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-28"> C \ equiv - \ em um ^ L_y \ tag {80} </script></p><br><br>  Portanto, se, por exemplo, estudarmos imagens MNIST, e a imagem 7 for inserida na entrada, o LPS ser√° - em um <sup>L</sup> <sub>7</sub> .  Para entender isso intuitivamente, consideramos o caso em que a rede lida bem com o reconhecimento, ou seja, √© certo que est√° na entrada 7. Nesse caso, ele avaliar√° o valor da probabilidade correspondente a <sup>L</sup> <sub>7</sub> como pr√≥ximo de 1, portanto, o custo - em um <sup>L</sup> <sub>7</sub> ser√° pequeno .  Por outro lado, se a rede n√£o funcionar bem, a probabilidade de um <sup>L7</sup> ser√° menor e o custo - em um L7 ser√° maior.  Portanto, o LPS se comporta conforme o esperado de uma fun√ß√£o de custo. <br><br>  E o problema da desacelera√ß√£o?  Para analis√°-lo, lembramos que o principal na desacelera√ß√£o √© o comportamento de ‚àÇC / ‚àÇw <sup>L</sup> <sub>jk</sub> e ‚àÇC / ‚àÇb <sup>L</sup> <sub>j</sub> .  N√£o descreverei em detalhes a captura da derivada - pedirei que voc√™ fa√ßa isso em tarefas, mas usando alguma √°lgebra, voc√™ pode mostrar que: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1474"><span class="MJXp-mtext" id="MJXp-Span-1475">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">c</span><span class="MJXp-mrow" id="MJXp-Span-1480"><span class="MJXp-mtext" id="MJXp-Span-1481">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1487">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1489">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1490"><span class="MJXp-mtext" id="MJXp-Span-1491">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">l</span><span class="MJXp-msubsup" id="MJXp-Span-1499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1511" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-1512">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">g</span><span class="MJXp-mrow" id="MJXp-Span-1516"><span class="MJXp-mn" id="MJXp-Span-1517">81</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-29"> \ frac {\ parcial C} {\ parcial b ^ L_j} = a ^ L_j-y_j \ tag {81} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1518"><span class="MJXp-mtext" id="MJXp-Span-1519">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1520">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">c</span><span class="MJXp-mrow" id="MJXp-Span-1524"><span class="MJXp-mtext" id="MJXp-Span-1525">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1531">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">C</span></span><span class="MJXp-mrow" id="MJXp-Span-1534"><span class="MJXp-mtext" id="MJXp-Span-1535">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1542">l</span><span class="MJXp-msubsup" id="MJXp-Span-1543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1546">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">k</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1549" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1550"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1551" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1553"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">L</span><span class="MJXp-mo" id="MJXp-Span-1555">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1556">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">k</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1560">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1562" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1565" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1566" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1567">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">g</span><span class="MJXp-mrow" id="MJXp-Span-1571"><span class="MJXp-mn" id="MJXp-Span-1572">82</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-30"> \ frac {\ parcial C} {\ parcial w ^ L_ {jk}} = a ^ {L-1} _k (a ^ L_j-y_j) \ tag {82} </script></p><br><br>  Eu brinquei um pouco com a nota√ß√£o aqui e estou usando "y" um pouco diferente do que no √∫ltimo par√°grafo.  L√°, y denota a sa√≠da de rede desejada - ou seja, se a sa√≠da for ‚Äú7‚Äù, a entrada ser√° a imagem 7. E nessas equa√ß√µes, y denota o vetor de ativa√ß√£o de sa√≠da correspondente a 7, ou seja, um vetor com todos os zeros, exceto a unidade em 7 posi√ß√£o. <br><br>  Essas equa√ß√µes s√£o iguais √†s express√µes semelhantes que obtivemos em uma an√°lise anterior da entropia cruzada.  Compare, por exemplo, as equa√ß√µes (82) e (67).  Essa √© a mesma equa√ß√£o, embora a √∫ltima seja calculada sobre os exemplos de treinamento.  E, como no primeiro caso, essas express√µes garantem que o aprendizado n√£o seja mais lento.  √â √∫til imaginar que a camada Softmax de sa√≠da com LPS √© bastante semelhante √† camada com sa√≠da sigm√≥ide e custo com base na entropia cruzada. <br><br>  Dada sua semelhan√ßa, o que deve ser usado - sa√≠da sigm√≥ide e entropia cruzada, ou sa√≠da Softmax e LPS?  De fato, em muitos casos, ambas as abordagens funcionam bem.  Embora mais adiante neste cap√≠tulo, usaremos uma camada de sa√≠da sigm√≥ide com um custo baseado na entropia cruzada.  Mais tarde, no cap√≠tulo 6, √†s vezes usaremos a sa√≠da Softmax e o LPS.  O motivo das mudan√ßas √© tornar algumas das redes a seguir mais semelhantes √†s redes encontradas em alguns artigos de pesquisa influentes.  De um ponto de vista mais geral, o Softmax e o LPS devem ser usados ‚Äã‚Äãquando voc√™ precisar interpretar as ativa√ß√µes de sa√≠da como probabilidades.  Isso nem sempre √© necess√°rio, mas pode ser √∫til em problemas de classifica√ß√£o (como MNIST), que incluem classes sem interse√ß√£o. <br><br><h3>  As tarefas </h3><br><ul><li>  Derive as equa√ß√µes (81) e (82). </li><li>  De onde vem o nome Softmax?  Suponha que alteremos a fun√ß√£o Softmax para que as ativa√ß√µes de sa√≠da sejam dadas pela equa√ß√£o <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1573"><span class="MJXp-msubsup" id="MJXp-Span-1574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1579">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">c</span><span class="MJXp-mrow" id="MJXp-Span-1584"><span class="MJXp-msubsup" id="MJXp-Span-1585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1587" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">c</span><span class="MJXp-msubsup" id="MJXp-Span-1589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1591">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1593"><span class="MJXp-mtext" id="MJXp-Span-1594">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">u</span><span class="MJXp-msubsup" id="MJXp-Span-1597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1599" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-1600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1602" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1603">c</span><span class="MJXp-msubsup" id="MJXp-Span-1604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1605" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">k</span></span></span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1611">g</span><span class="MJXp-mrow" id="MJXp-Span-1612"><span class="MJXp-mn" id="MJXp-Span-1613">83</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> a ^ L_j = \ frac {e ^ {c z ^ L_j}} {\ sum_k e ^ {c z ^ L_k}} \ tag {83} </script></p>  onde c √© uma constante positiva.  Observe que c = 1 corresponde √† fun√ß√£o padr√£o Softmax.  Mas, usando um valor diferente de c, obtemos outra fun√ß√£o que ainda ser√° qualitativamente semelhante √† Softmax.  Mostre que as ativa√ß√µes de sa√≠da formam uma distribui√ß√£o de probabilidade, como √© o caso do Softmax regular.  Suponha que fa√ßamos c muito grande, ou seja, c ‚Üí &amp; inf;  Qual √© o valor limite das ativa√ß√µes de sa√≠da a <sup>L</sup> <sub>j</sub> ?  Depois de resolver esse problema, deve ficar claro por que uma fun√ß√£o com c = 1 √© considerada uma "vers√£o suavizada" da fun√ß√£o m√°xima.  √â da√≠ que vem o termo softmax. </li><li>  Propaga√ß√£o traseira com Softmax e LPS.  No √∫ltimo cap√≠tulo, derivamos o algoritmo de retropropaga√ß√£o para uma rede contendo camadas sigm√≥ides.  Para aplicar esse algoritmo √†s camadas de rede e Softmax, precisamos derivar a express√£o para o erro Œ¥ <sup>L</sup> <sub>j</sub> ‚â° C / ‚àÇz <sup>L</sup> <sub>j</sub> .  Mostre que uma express√£o adequada seria <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1614"><span class="MJXp-mtext" id="MJXp-Span-1615">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1620"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1623"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1625"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1629" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1630"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1632" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634"><font style="vertical-align: inherit;"> t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636"><font style="vertical-align: inherit;">g </font></span><span class="MJXp-mrow" id="MJXp-Span-1637"><span class="MJXp-mn" id="MJXp-Span-1638"><font style="vertical-align: inherit;">84</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-1633">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-1637"><span class="MJXp-mn" id="MJXp-Span-1638"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> \ delta ^ L_j = a ^ L_j -y_j \ tag {84} </script></p>  Usando essa express√£o, podemos aplicar o algoritmo de retropropaga√ß√£o √† rede usando a camada Softmax de sa√≠da e o LPS. </li></ul><br><br><h2>  Reciclagem e regulariza√ß√£o </h2><br>  O ganhador do Nobel, Enrico Fermi, j√° foi convidado a opinar sobre o modelo matem√°tico proposto por v√°rios colegas para resolver um importante problema f√≠sico n√£o resolvido.  O modelo correspondia perfeitamente ao experimento, mas Fermi estava c√©tico quanto a isso.  Ele perguntou quantos par√¢metros livres podem ser alterados.  "Quatro", eles disseram a ele.  Fermi respondeu: "Lembro como meu amigo Johnny von Neumann gostava de dizer que, com quatro par√¢metros, voc√™ pode empurrar um elefante para l√° e, com cinco, voc√™ pode faz√™-lo balan√ßar a tromba". <br><br>  O significado da hist√≥ria, √© claro, √© que modelos com um grande n√∫mero de par√¢metros livres podem descrever uma gama surpreendentemente ampla de fen√¥menos.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mesmo se esse modelo funcionar bem com os dados dispon√≠veis, ele n√£o ser√° automaticamente um bom modelo. </font><font style="vertical-align: inherit;">Apenas pode significar que o modelo tem liberdade suficiente para descrever quase todos os conjuntos de dados de um determinado tamanho sem revelar a id√©ia principal do fen√¥meno. </font><font style="vertical-align: inherit;">Quando isso acontece, o modelo funciona bem com os dados existentes, mas n√£o pode generalizar a nova situa√ß√£o. </font><font style="vertical-align: inherit;">Um verdadeiro teste de um modelo √© sua capacidade de fazer previs√µes em situa√ß√µes que ele n√£o havia encontrado antes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fermi e von Neumann suspeitaram de modelos com quatro par√¢metros. Nosso NS com 30 neur√¥nios ocultos para a classifica√ß√£o dos d√≠gitos MNIST possui quase 24.000 par√¢metros! Estes s√£o alguns par√¢metros. Nosso NS com 100 neur√¥nios ocultos tem quase 80.000 par√¢metros, e os NSs avan√ßados avan√ßados desses par√¢metros √†s vezes t√™m milh√µes ou at√© bilh√µes. Podemos confiar nos resultados de seu trabalho?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos complicar esse problema criando uma situa√ß√£o em que nossa rede generaliza mal uma nova situa√ß√£o para ele. Usaremos NS com 30 neur√¥nios ocultos e 23.860 par√¢metros. Mas n√£o treinaremos a rede com todas as 50.000 imagens MNIST. Em vez disso, usamos apenas os primeiros 1000. O uso de um conjunto limitado tornar√° o problema de generaliza√ß√£o mais √≥bvio. Estudaremos como antes, usando a fun√ß√£o de custo baseada na entropia cruzada, com uma velocidade de aprendizado de Œ∑ = 0,5 e um tamanho de minipacote de 10. No entanto, estudaremos 400 eras, o que √© um pouco mais do que antes, pois existem exemplos de treinamento n√£o temos muito. Vamos usar o network2 para ver como a fun√ß√£o de custo muda:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, evaluation_data=test_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando os resultados, podemos construir um gr√°fico da mudan√ßa de custo ao treinar a rede (os gr√°ficos foram feitos usando o programa overfitting.py): </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/202/918/ebd/202918ebd6b97ceb7fa451a150c879c1.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parece encorajador, h√° uma redu√ß√£o suave no custo, conforme o esperado. Lembre-se de que mostrei apenas as √©pocas de 200 a 399. Como resultado, vemos em escala ampliada os est√°gios finais do treinamento, nos quais, como veremos mais adiante, tudo de mais interessante acontece. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora vamos ver como a precis√£o da classifica√ß√£o nos dados de verifica√ß√£o muda com o tempo:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d52/ead/ddb/d52eadddb40981a35b36a852dc346674.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ent√£o eu novamente aumentei o cronograma. Nas primeiras 200 eras, que n√£o s√£o vis√≠veis aqui, a precis√£o aumenta para quase 82%. Ent√£o o treinamento diminui gradualmente. Finalmente, por volta da era 280, a precis√£o da classifica√ß√£o cessa de melhorar. Em √©pocas posteriores, apenas pequenas flutua√ß√µes estoc√°sticas s√£o observadas em torno do valor de precis√£o alcan√ßado na 280¬™ √©poca. Compare isso com o gr√°fico anterior, onde o custo associado aos dados de treinamento est√° diminuindo gradualmente. Se voc√™ estudar apenas esse custo, parecer√° que o modelo est√° melhorando. No entanto, os resultados do trabalho com dados de teste nos dizem que essa melhoria √© apenas uma ilus√£o. Como no modelo que Fermi n√£o gostou, o que nossa rede estuda ap√≥s a era 280 n√£o √© mais generalizado para dados de verifica√ß√£o. Portanto, esse treinamento deixa de ser √∫til. Dizemos que, ap√≥s a era 280, a rede est√° se recuperando,ou sobreajuste.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voc√™ pode estar se perguntando se n√£o estou estudando o custo com base nos dados de treinamento e n√£o na precis√£o da classifica√ß√£o dos dados de verifica√ß√£o. Em outras palavras, talvez o problema seja que estamos comparando ma√ß√£s com laranjas. O que acontecer√° se compararmos o custo dos dados de treinamento com o custo da verifica√ß√£o, ou seja, compararemos medidas compar√°veis? Ou talvez pud√©ssemos comparar a precis√£o da classifica√ß√£o dos dados de treinamento e teste? De fato, o mesmo fen√¥meno aparece independentemente de como a compara√ß√£o √© feita. Mas os detalhes est√£o mudando. Por exemplo, vamos ver o valor dos dados de verifica√ß√£o:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/81e/c1b/01a/81ec1b01a439d1766585dc57587b907c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pode-se observar que o custo dos dados de verifica√ß√£o melhora at√© a era 15 e depois come√ßa a se deteriorar completamente, embora o custo dos dados de treinamento continue a melhorar. Este √© outro sinal de um modelo reciclado. No entanto, surge a quest√£o: em que √©poca devemos considerar o ponto em que o treinamento come√ßa a prevalecer sobre o treinamento - 15 ou 280? Do ponto de vista pr√°tico, estamos interessados ‚Äã‚Äãem melhorar a precis√£o da classifica√ß√£o dos dados de verifica√ß√£o, e o custo √© apenas um mediador da precis√£o da classifica√ß√£o. Portanto, faz sentido considerar a era de 280 um ponto, ap√≥s o qual a reciclagem come√ßa a prevalecer sobre o treinamento de nossa Assembl√©ia Nacional. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outro sinal de reciclagem pode ser visto na precis√£o da classifica√ß√£o dos dados de treinamento:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ff/5f3/dd6/6ff5f3dd69e5182de0ebfc1e54e8db0b.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A precis√£o est√° crescendo, chegando a 100%. Ou seja, nossa rede classifica corretamente todas as 1000 imagens de treinamento! Enquanto isso, a precis√£o da verifica√ß√£o aumenta para apenas 82,27%. Ou seja, nossa rede estuda apenas os recursos do conjunto de treinamento e n√£o aprende a reconhecer n√∫meros. Parece que a rede simplesmente se lembra do conjunto de treinamento, n√£o entendendo os n√∫meros suficientemente bem para generalizar isso para o conjunto de testes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A reciclagem √© um problema s√©rio da Assembl√©ia Nacional. Isso √© especialmente verdadeiro para os NSs modernos, que geralmente t√™m uma enorme quantidade de pesos e deslocamentos. Para um treinamento eficaz, precisamos de uma maneira de determinar quando o treinamento ocorre para n√£o ser treinado novamente. E tamb√©m gostar√≠amos de poder reduzir os efeitos da reciclagem.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma maneira √≥bvia de detectar reciclagem √© usar a abordagem acima, monitorar a precis√£o do trabalho com dados de verifica√ß√£o durante o treinamento em rede. Se percebermos que a precis√£o dos dados de verifica√ß√£o n√£o est√° mais melhorando, devemos interromper o treinamento. Obviamente, estritamente falando, isso n√£o ser√° necessariamente um sinal de reciclagem. Talvez a precis√£o de trabalhar com dados de teste e treinamento pare de melhorar ao mesmo tempo. No entanto, a aplica√ß√£o dessa estrat√©gia impedir√° a reciclagem. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E usaremos uma pequena varia√ß√£o dessa estrat√©gia. Lembre-se de que quando carregamos dados no MNIST, os dividimos em tr√™s conjuntos:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper()</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At√© agora, usamos training_data e test_data, e ignoramos validation_data [confirmando]. Os dados de valida√ß√£o cont√™m 10.000 imagens, que diferem das 50.000 imagens do conjunto de treinamento MNIST e das 10.000 imagens do conjunto de valida√ß√£o. Em vez de usar test_data para evitar overfitting, usaremos validation_data. Para fazer isso, usaremos quase a mesma estrat√©gia descrita acima para test_data. Ou seja, calcularemos a precis√£o da classifica√ß√£o de validation_data no final de cada √©poca. Quando a precis√£o da classifica√ß√£o de validation_data estiver cheia, deixaremos de aprender. Essa estrat√©gia √© chamada de parada antecipada. Obviamente, na pr√°tica, n√£o seremos capazes de descobrir imediatamente que a precis√£o est√° saciada. Em vez disso, continuaremos treinando at√© ter certeza disso (e decidirquando voc√™ precisa parar, nem sempre √© f√°cil, e voc√™ pode usar abordagens mais ou menos agressivas para isso).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que usar validation_data para impedir a reciclagem em vez de test_data? Faz parte de uma estrat√©gia mais geral o uso de validation_data para avaliar diferentes op√ß√µes de hiperpar√¢metros - o n√∫mero de √©pocas para aprender, a velocidade do aprendizado, a melhor arquitetura de rede etc. Usamos essas estimativas para encontrar e atribuir bons valores aos hiperpar√¢metros. E, embora ainda n√£o tenha mencionado isso, foi em parte por isso que fiz a escolha de hiperpar√¢metros nos exemplos anteriores do livro.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, essa observa√ß√£o n√£o responde √† pergunta de por que usamos validation_data, e n√£o test_data, para evitar o super ajuste. Simplesmente substitui a resposta a uma pergunta mais geral - por que usamos validation_data, e n√£o test_data, para selecionar hiperpar√¢metros? Para entender isso, lembre-se de que, ao escolher hiperpar√¢metros, √© prov√°vel que tenhamos que escolher entre uma variedade de op√ß√µes. Se atribuirmos hiperpar√¢metros com base nas classifica√ß√µes de test_data, provavelmente adaptaremos esses dados muito especificamente para test_data. Ou seja, podemos encontrar hiperpar√¢metros adequados aos recursos espec√≠ficos de dados espec√≠ficos de test_data; no entanto, a opera√ß√£o de nossa rede n√£o ser√° generalizada para outros conjuntos de dados. Evitamos isso selecionando hiperpar√¢metros usando validation_data. E ent√£o, tendo recebido o GP, precisamos,realizamos uma avalia√ß√£o final da precis√£o usando test_data. Isso nos d√° confian√ßa de que nossos resultados com test_data s√£o uma verdadeira medida do grau de generaliza√ß√£o do NS. Em outras palavras, dados de suporte s√£o dados de treinamento especiais que nos ajudam a aprender um bom GP. Essa abordagem para localizar GPs √†s vezes √© chamada de m√©todo de reten√ß√£o, pois validation_data √© "mantido" separadamente do training_data.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na pr√°tica, mesmo depois de avaliar a qualidade do trabalho em test_data, queremos mudar de id√©ia e tentar uma abordagem diferente - talvez uma arquitetura de rede diferente - que inclua buscas por um novo conjunto de GPs. Nesse caso, existe o perigo de nos adaptarmos desnecessariamente ao test_data? Precisamos de um n√∫mero potencialmente infinito de conjuntos de dados para garantir que nossos resultados sejam bem generalizados? Em geral, esse √© um problema profundo e complexo. Mas, para nossos prop√≥sitos pr√°ticos, n√£o nos preocuparemos muito com isso. Simplesmente nos aprofundamos em pesquisas adicionais usando um m√©todo simples de reten√ß√£o baseado em training_data, validation_data e test_data, conforme descrito acima.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At√© agora, consideramos a reciclagem usando 1000 imagens de treinamento. O que acontece se usarmos um conjunto completo de treinamento de 50.000 imagens? Vamos deixar todos os outros par√¢metros inalterados (30 neur√¥nios ocultos, velocidade de aprendizado 0,5, tamanho de minipacote 10), mas estudaremos 30 √©pocas usando todas as 50.000 imagens. Aqui est√° um gr√°fico que mostra a precis√£o da classifica√ß√£o nos dados de treinamento e teste. Observe que aqui eu usei dados de valida√ß√£o em vez de dados de valida√ß√£o para facilitar a compara√ß√£o dos resultados com gr√°ficos anteriores.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ac/939/bd9/3ac939bd9760316faf84350fca4cd00d.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pode-se observar que os indicadores de precis√£o nos dados de teste e treinamento permanecem mais pr√≥ximos um do outro do que quando se usam 1000 exemplos de treinamento. </font><font style="vertical-align: inherit;">Em particular, a melhor precis√£o de classifica√ß√£o, 97,86%, √© apenas 2,53% superior a 95,33% dos dados de verifica√ß√£o. </font><font style="vertical-align: inherit;">Compare com uma pausa precoce de 17,73%! </font><font style="vertical-align: inherit;">A reciclagem est√° ocorrendo, mas √© bastante reduzida. </font><font style="vertical-align: inherit;">Nossa rede compila informa√ß√µes muito melhor, passando do treinamento para os dados de teste. </font><font style="vertical-align: inherit;">Em geral, uma das melhores maneiras de reduzir a reciclagem √© aumentar a quantidade de dados de treinamento. </font><font style="vertical-align: inherit;">Com dados de treinamento suficientes, √© dif√≠cil treinar at√© mesmo uma rede muito grande. </font><font style="vertical-align: inherit;">Infelizmente, obter dados de treinamento √© caro e / ou dif√≠cil, portanto, essa op√ß√£o nem sempre √© pr√°tica.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Regulariza√ß√£o </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aumentar a quantidade de dados de treinamento √© uma maneira de reduzir a reciclagem. </font><font style="vertical-align: inherit;">Existem outras maneiras de reduzir a reciclagem? </font><font style="vertical-align: inherit;">Uma abordagem poss√≠vel √© reduzir o tamanho da rede. </font><font style="vertical-align: inherit;">√â verdade que as redes grandes t√™m potencial mais do que as pequenas, por isso estamos relutantes em recorrer a essa op√ß√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Felizmente, existem outras t√©cnicas que podem reduzir a reciclagem, mesmo quando corrigimos o tamanho da rede e dos dados de treinamento. </font><font style="vertical-align: inherit;">Eles s√£o conhecidos como t√©cnicas de regulariza√ß√£o. </font><font style="vertical-align: inherit;">Neste cap√≠tulo, descreverei uma das t√©cnicas mais populares, √†s vezes chamadas de enfraquecimento de pesos ou regulariza√ß√£o de L2. </font><font style="vertical-align: inherit;">Sua ideia √© adicionar um membro extra chamado membro de regulariza√ß√£o √† fun√ß√£o de custo. </font><font style="vertical-align: inherit;">Aqui est√° a entropia cruzada com regulariza√ß√£o:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1639"><span class="MJXp-mtable" id="MJXp-Span-1640"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1641" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1642" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-1644" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-1645" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1646" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1647"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1649"><span class=""><span class="MJXp-mo" id="MJXp-Span-1650" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1651" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1654"><span class="MJXp-mo" id="MJXp-Span-1655" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">[</span></span><span class="MJXp-msubsup" id="MJXp-Span-1656"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1658" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mi" id="MJXp-Span-1659">ln</span><span class="MJXp-mo" id="MJXp-Span-1660" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1665" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1666" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1667">1</span><span class="MJXp-mo" id="MJXp-Span-1668" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1669"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1670" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1671" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1672" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi" id="MJXp-Span-1673">ln</span><span class="MJXp-mo" id="MJXp-Span-1674" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1675" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1676">1</span><span class="MJXp-mo" id="MJXp-Span-1677" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">L</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">j</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1683" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1685" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">Œª</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1687">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1688">n</span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1689"><span class=""><span class="MJXp-mo" id="MJXp-Span-1690" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691" style="margin-left: 0px;">w</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1692"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693" style="margin-right: 0.05em;">w</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1694" style="vertical-align: 0.5em;">2</span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-33"> C = -\frac{1}{n} \sum_{xj} \left[ y_j \ln a^L_j+(1-y_j) \ln (1-a^L_j)\right] + \frac{\lambda}{2n} \sum_w w^2 \tag{85} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O primeiro termo √© uma express√£o comum para entropia cruzada. </font><font style="vertical-align: inherit;">Mas adicionamos um segundo, a soma dos quadrados de todos os pesos da rede. </font><font style="vertical-align: inherit;">√â dimensionado pelo fator Œª / 2n, onde Œª&gt; 0 √© o par√¢metro de regulariza√ß√£o e n, como de costume, √© o tamanho do conjunto de treinamento. </font><font style="vertical-align: inherit;">Discutiremos como escolher Œª. </font><font style="vertical-align: inherit;">Tamb√©m √© importante notar que os vieses n√£o est√£o inclu√≠dos no termo de regulariza√ß√£o. </font><font style="vertical-align: inherit;">Sobre isso abaixo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, √© poss√≠vel regularizar outras fun√ß√µes de custo, por exemplo, quadr√°ticas. </font><font style="vertical-align: inherit;">Isso pode ser feito de maneira semelhante:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1709"><span class="MJXp-mtable" id="MJXp-Span-1710"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1711" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1712" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-1714" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1715" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1716"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1717"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1719"><span class=""><span class="MJXp-mo" id="MJXp-Span-1720" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-1722" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äñ</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font></span><span class="MJXp-mo" id="MJXp-Span-1724" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1727" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L</font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-1728"><span class="MJXp-mo" id="MJXp-Span-1729" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬≤</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1730" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1731" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1732" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1734"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1736"><span class=""><span class="MJXp-mo" id="MJXp-Span-1737" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œ£</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1741" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> C = \frac{1}{2n} \sum_x \|y-a^L\|^2 + \frac{\lambda}{2n} \sum_w w^2 \tag{86} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nos dois casos, podemos escrever a fun√ß√£o de custo regularizado como </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1742"><span class="MJXp-mtable" id="MJXp-Span-1743"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1744" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1745" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1750" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1751" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1752" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-1754"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1755"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1756"><span class=""><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œ£</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1761" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> C = C_0 + \frac{\lambda}{2n} \sum_w w^2 \tag{87} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© a fun√ß√£o de custo original sem regulariza√ß√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â intuitivamente claro que o objetivo da regulariza√ß√£o √© convencer a rede a preferir pesos menores, todas as outras coisas sendo iguais. </font><font style="vertical-align: inherit;">Pesos grandes s√≥ ser√£o poss√≠veis se eles melhorarem significativamente a primeira parte da fun√ß√£o de custo. </font><font style="vertical-align: inherit;">Em outras palavras, a regulariza√ß√£o √© uma maneira de escolher um compromisso entre encontrar pesos pequenos e minimizar a fun√ß√£o de custo inicial. </font><font style="vertical-align: inherit;">√â importante que esses dois elementos do compromisso dependam do valor de Œª: quando Œª √© pequeno, preferimos minimizar a fun√ß√£o de custo original e, quando Œª √© grande, preferimos pesos pequenos.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N√£o √© de todo √≥bvio por que a escolha de tal compromisso deve ajudar a reduzir a reciclagem! </font><font style="vertical-align: inherit;">Mas acontece que ajuda. </font><font style="vertical-align: inherit;">Vamos descobrir por que isso ajuda na pr√≥xima se√ß√£o. </font><font style="vertical-align: inherit;">Mas primeiro, vamos trabalhar com um exemplo mostrando que a regulariza√ß√£o reduz a reciclagem. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para construir um exemplo, primeiro precisamos entender como aplicar o algoritmo de treinamento com descida de gradiente estoc√°stico a um NS regularizado. </font><font style="vertical-align: inherit;">Em particular, precisamos saber como calcular as derivadas parciais, ‚àÇC / ‚àÇw e ‚àÇC / ‚àÇb para todos os pesos e compensa√ß√µes na rede. </font><font style="vertical-align: inherit;">Depois de tomar as derivadas parciais na equa√ß√£o (87), obtemos:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1762"><span class="MJXp-mtable" id="MJXp-Span-1763"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1764" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1765" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1766" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1767"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1769"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1771" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1772" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1773"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1776" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1777"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> +</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1780" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1783"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> w</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> \frac{\partial C}{\partial w} = \frac{\partial C_0}{\partial w} + \frac{\lambda}{n} w \tag{88} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1784"><span class="MJXp-mtable" id="MJXp-Span-1785"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1786" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1787" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1788" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1789"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1790"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1791"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1793" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> =</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1794" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1795"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1797" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1798" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1799"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \frac{\partial C}{\partial b} = \frac{\partial C_0}{\partial b} \tag{89} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os termos ‚àÇC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / ‚àÇw e ‚àÇC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / ‚àÇw podem ser calculados atrav√©s do OP, conforme descrito no cap√≠tulo anterior. </font><font style="vertical-align: inherit;">Vimos que √© f√°cil calcular o gradiente da fun√ß√£o de custo regularizado: voc√™ s√≥ precisa usar o OP como de costume e adicionar Œª / nw √† derivada parcial de todos os termos de peso. </font><font style="vertical-align: inherit;">As derivadas parciais em rela√ß√£o aos deslocamentos n√£o mudam, portanto, a regra do aprendizado por descida gradiente para deslocamentos n√£o difere da usual:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1801"><span class="MJXp-mtable" id="MJXp-Span-1802"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1803" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1804" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1806" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1807"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1808" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1810" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1811"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1812"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1814" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1815"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> b \rightarrow b -\eta \frac{\partial C_0}{\partial b} \tag{90} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A regra de treinamento para pesos se transforma em: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1817"><span class="MJXp-mtable" id="MJXp-Span-1818"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1819" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1820" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1826" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1827"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1828"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1830" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1831"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> -</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1834" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">n</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">w</span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> w \rightarrow w-\eta \frac{\partial C_0}{\partial w}-\frac{\eta \lambda}{n} w \tag{91} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1839"><span class="MJXp-mtable" id="MJXp-Span-1840"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1841" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1842" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1843" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1844"><span class="MJXp-mo" id="MJXp-Span-1845" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">(</span></span><span class="MJXp-mn" id="MJXp-Span-1846">1</span><span class="MJXp-mo" id="MJXp-Span-1847" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mfrac" id="MJXp-Span-1848" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1849">Œ∑</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">Œª</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">n</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1852" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;">)</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">w</span><span class="MJXp-mo" id="MJXp-Span-1854" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">Œ∑</span><span class="MJXp-mfrac" id="MJXp-Span-1856" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1857">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-1858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1860" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1861">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1862">w</span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> = \left(1-\frac{\eta \lambda}{n}\right) w -\eta \frac{\partial C_0}{\partial w} \tag{92} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tudo √© o mesmo da regra de descida de gradiente usual, exceto que primeiro escalamos o peso w por um fator de 1 - Œ∑Œª / n. Esse dimensionamento √†s vezes √© chamado de perda de peso, pois reduz o peso. √Ä primeira vista, parece que os pesos est√£o irresistivelmente tendendo a zero. Mas n√£o √© assim, j√° que o outro termo pode levar a um aumento de peso se isso levar a uma diminui√ß√£o na fun√ß√£o de custo irregular. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ok, deixe a descida gradiente funcionar assim. E quanto √† descida do gradiente estoc√°stico? Bem, como na vers√£o irregular da descida do gradiente estoc√°stico, podemos estimar ‚àÇC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / ‚àÇw atrav√©s da m√©dia do mini-pacote de m exemplos de treinamento. Portanto, a regra de aprendizado regularizado para a descida do gradiente estoc√°stico se transforma (veja a equa√ß√£o (20)):</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1863"><span class="MJXp-mtable" id="MJXp-Span-1864"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1865" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1866" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-1868" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1869"><span class="MJXp-mo" id="MJXp-Span-1870" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(</font></font></span></span><span class="MJXp-mn" id="MJXp-Span-1871"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1872" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1873" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1875"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œª</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1876"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.5em;"><span class="MJXp-right MJXp-scale5" style="font-size: 3em; margin-left: -0.13em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mo" id="MJXp-Span-1879" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-</font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1880" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1881"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1883"><span class=""><span class="MJXp-mo" id="MJXp-Span-1884" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1886" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1887"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1888"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1890" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1891"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-41"> w \rightarrow \left(1-\frac{\eta \lambda}{n}\right) w -\frac{\eta}{m} \sum_x \frac{\partial C_x}{\partial w} \tag{93} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde a soma vale para os exemplos de treinamento x no minipacote e C </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √© o custo irregular de cada exemplo de treinamento. </font><font style="vertical-align: inherit;">Tudo √© o mesmo da regra usual da descida do gradiente estoc√°stico, com exce√ß√£o de 1 - Œ∑Œª / n, o fator de perda de peso. </font><font style="vertical-align: inherit;">Por fim, para concluir a imagem, deixe-me escrever uma regra regularizada para compensa√ß√µes. </font><font style="vertical-align: inherit;">Naturalmente, √© exatamente o mesmo que no caso irregular (veja a equa√ß√£o (21)):</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1893"><span class="MJXp-mtable" id="MJXp-Span-1894"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-1895" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1896" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1898" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1899"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-1900" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1901" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1904"><span class=""><span class="MJXp-mo" id="MJXp-Span-1905" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1907" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1908"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1909"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1911" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-1912"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-42"> b \rightarrow b - \frac{\eta}{m} \sum_x \frac{\partial C_x}{\partial b} \tag{94} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde o valor vale para os exemplos de treinamento x no minipacote. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos ver como a regulariza√ß√£o muda a efic√°cia de nossa Assembl√©ia Nacional. Usaremos uma rede com 30 neur√¥nios ocultos, um mini-pacote de tamanho 10, uma velocidade de aprendizado de 0,5 e uma fun√ß√£o de custo com entropia cruzada. No entanto, desta vez, usamos o par√¢metro de regulariza√ß√£o Œª = 0,1. No c√≥digo, chamei essa vari√°vel de lmbda, pois a palavra lambda √© reservada em python para coisas n√£o relacionadas ao nosso t√≥pico. Tamb√©m usei test_data novamente em vez de validation_data. Mas eu decidi usar test_data, porque os resultados podem ser comparados diretamente com nossos resultados irregulares. Voc√™ pode alterar facilmente o c√≥digo para que ele use validation_data e verifique se os resultados s√£o semelhantes.</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, ... evaluation_data=test_data, lmbda = <span class="hljs-number"><span class="hljs-number">0.1</span></span>, ... monitor_evaluation_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, ... monitor_training_cost=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O custo dos dados de treinamento est√° diminuindo constantemente, como no caso anterior, sem regulariza√ß√£o: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a20/73d/9f9/a2073d9f90ed8bc7d861e48a0f8a9c75.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mas desta vez, a precis√£o em test_data continua aumentando em todas as 400 √©pocas: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/695/4d8/c1b/6954d8c1ba89251488688d13a4f75613.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, a regulariza√ß√£o suprimiu a reciclagem. Al√©m disso, a precis√£o aumentou significativamente e a precis√£o da classifica√ß√£o de pico atinge 87,1%, em compara√ß√£o com o pico de 82,27% alcan√ßado no caso sem regulariza√ß√£o. Em geral, quase certamente alcan√ßamos melhores resultados ao continuar estudando ap√≥s 400 eras. Empiricamente, a regulariza√ß√£o parece tornar nossa rede melhor generalizar o conhecimento e reduzir significativamente os efeitos da reciclagem.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que acontece se deixarmos nosso ambiente artificial, que usa apenas 1.000 fotos de ensino, e retornarmos ao conjunto completo de 50.000 imagens? </font><font style="vertical-align: inherit;">Obviamente, j√° vimos que a reciclagem √© um problema muito menor, com um conjunto completo de 50.000 imagens. </font><font style="vertical-align: inherit;">A regulariza√ß√£o ajuda a melhorar o resultado? </font><font style="vertical-align: inherit;">Vamos manter os valores anteriores dos hiperpar√¢metros - 30 √©pocas, velocidade 0,5, tamanho de minipacote 10. No entanto, precisamos alterar o par√¢metro de regulariza√ß√£o. </font><font style="vertical-align: inherit;">O fato √© que o tamanho n do conjunto de treinamento saltou de 1000 para 50 000, e isso altera o fator de enfraquecimento dos pesos 1 - Œ∑Œª / n. </font><font style="vertical-align: inherit;">Se continuarmos a usar Œª = 0,1, isso significa que os pesos s√£o enfraquecidos muito menos e, como resultado, o efeito da regulariza√ß√£o diminui. </font><font style="vertical-align: inherit;">N√≥s compensamos isso aceitando Œª = 5.0.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ok, vamos treinar nossa rede reinicializando primeiro os pesos: </font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, ... evaluation_data=test_data, lmbda = <span class="hljs-number"><span class="hljs-number">5.0</span></span>, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, monitor_training_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Temos os resultados: </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f13/8c6/190/f138c6190ae49d3c90ddeb15b3964011.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muitas coisas agrad√°veis. Em primeiro lugar, nossa precis√£o de classifica√ß√£o nos dados de verifica√ß√£o aumentou de 95,49% sem regulariza√ß√£o para 96,49% com regulariza√ß√£o. Esta √© uma grande melhoria. Em segundo lugar, pode-se ver que a diferen√ßa entre os resultados do trabalho nos conjuntos de treinamento e teste √© muito menor do que antes, menor que 1%. A diferen√ßa ainda √© decente, mas obviamente fizemos progressos significativos na redu√ß√£o da reciclagem. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por fim, veja qual precis√£o de classifica√ß√£o obtemos ao usar 100 neur√¥nios ocultos e o par√¢metro de regulariza√ß√£o &amp; lambda = 5.0. N√£o darei uma an√°lise detalhada da reciclagem, isso √© apenas divers√£o, para ver quanta precis√£o pode ser alcan√ßada com nossos novos truques: uma fun√ß√£o de custo com entropia cruzada e regulariza√ß√£o de L2.</font></font><br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], cost=network2.CrossEntropyCost) &gt;&gt;&gt; net.large_weight_initializer() &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>, lmbda=<span class="hljs-number"><span class="hljs-number">5.0</span></span>, ... evaluation_data=validation_data, ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O resultado final √© uma precis√£o de classifica√ß√£o de 97,92% nos dados de suporte. Um grande salto em compara√ß√£o com o caso de 30 neur√¥nios ocultos. Voc√™ pode ajustar um pouco mais, iniciar o processo por 60 √©pocas com Œ∑ = 0,1 e Œª = 5,0 e superar a barreira de 98%, atingindo uma precis√£o de 98,04 nos dados de suporte. Nada mal para 152 linhas de c√≥digo! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descrevi a regulariza√ß√£o como uma maneira de reduzir a reciclagem e aumentar a precis√£o da classifica√ß√£o. Mas essas n√£o s√£o suas √∫nicas vantagens. Empiricamente, depois de tentar atrav√©s de muitos lan√ßamentos nossa rede MNIST, alterando pesos a cada vez, descobri que lan√ßamentos sem regulariza√ß√£o √†s vezes "ficavam presos", obviamente, caindo no m√≠nimo local da fun√ß√£o de custo. Como resultado, lan√ßamentos diferentes √†s vezes produziam resultados muito diferentes. E a regulariza√ß√£o, pelo contr√°rio, permite obter resultados reproduz√≠veis muito mais f√°ceis.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por que isso √© assim? </font><font style="vertical-align: inherit;">Heuristicamente, quando a fun√ß√£o de custo n√£o tem regulariza√ß√£o, √© prov√°vel que o comprimento do vetor de pesos aumente, sendo todas as outras coisas iguais. </font><font style="vertical-align: inherit;">Com o tempo, isso pode levar a um vetor muito grande de pesos. </font><font style="vertical-align: inherit;">E por isso, o vetor das escalas pode ficar travado, mostrando aproximadamente na mesma dire√ß√£o, pois as altera√ß√µes devido √† descida do gradiente fazem apenas pequenas altera√ß√µes de dire√ß√£o com um grande comprimento do vetor. </font><font style="vertical-align: inherit;">Acredito que, devido a esse fen√¥meno, √© muito dif√≠cil para nosso algoritmo de treinamento estudar adequadamente o espa√ßo de pesos e, portanto, √© dif√≠cil encontrar um bom m√≠nimo da fun√ß√£o de custo.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt458724/">https://habr.com/ru/post/pt458724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt458708/index.html">Deseja <s> perder peso </s> para aprender TI por conta pr√≥pria? Me pergunte como</a></li>
<li><a href="../pt458710/index.html">Ofuscador de espa√ßo em branco para PHP</a></li>
<li><a href="../pt458716/index.html">Primeira olhada no Delta Amplon RT UPS</a></li>
<li><a href="../pt458718/index.html">Grande entrevista com Cliff Click, o pai da compila√ß√£o JIT em Java</a></li>
<li><a href="../pt458720/index.html">A escola de programadores hh.ru, pela d√©cima vez, abre um conjunto de especialistas em TI</a></li>
<li><a href="../pt458726/index.html">Habr Special // Podcast com autor de Invasion. Uma Breve Hist√≥ria dos Hackers Russos</a></li>
<li><a href="../pt458728/index.html">O que s√£o bicicletas el√©tricas (revis√£o em grupo de cinco modelos de dois fabricantes), parte 2</a></li>
<li><a href="../pt458730/index.html">Combatendo a complexidade no desenvolvimento de software</a></li>
<li><a href="../pt458732/index.html">SIG? ou n√£o GIS? Essa √© a quest√£o</a></li>
<li><a href="../pt458734/index.html">Dias √∫teis do data center: insignificantes por 7 anos de opera√ß√£o. E a continua√ß√£o sobre o rato</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>