<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥩 🔁 👶🏿 So bestehen Sie einen Cyber-Test am Checkpoint 🐲 👰🏼 🧑🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits, ich bin Nikita Kurtin , Kuratorin der israelischen Hochschule für IT und Sicherheit HackerU 

 Checkpoint , das führende israelische...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So bestehen Sie einen Cyber-Test am Checkpoint</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/429112/"> Hallo allerseits, ich bin <b>Nikita Kurtin</b> , Kuratorin der israelischen Hochschule für IT und Sicherheit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>HackerU</b></a> <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Checkpoint</a></b> , das führende israelische Unternehmen für Informationssicherheit, hat diesen Sommer eine Reihe von Cyber-Tests veröffentlicht. <br><br>  Die Aufgaben wurden in sechs Kategorien unterteilt: <br><br>  • Logik <br>  • Web <br>  • Programmierung <br>  • Vernetzung <br>  • Rückwärtsfahren <br>  • Überraschung <br><br>  Zwei Aufgaben für jede Richtung.  In diesem Beitrag werde ich Ihnen erzählen, wie ich nur vier Tests durchlaufen habe, in den nächsten drei anderen: <br><br>  <b>Checkpoint</b> hatte es bereits geschafft, meinerseits Respekt und Interesse zu gewinnen, und so entschied ich mich, diese Herausforderungen anzunehmen.  Aufgrund der Beschäftigung konnte ich es mir jedoch leisten, nur 8 von 12 Aufgaben (aus vier verschiedenen Kategorien) zu übernehmen.  Und ich habe es geschafft, 7 davon zu lösen. <br><br>  Die Challenge endete offiziell Ende September 2018. <br><br><img src="https://habrastorage.org/webt/ms/aj/or/msajorgjjbivojhhdbh5bpk2d_c.png" alt="Bild"><br><br>  Jetzt kann ich Ihnen mit gutem Gewissen Schritt für Schritt erzählen, wie ich die folgenden Probleme gelöst habe: <br><br>  • Logische Herausforderung "PNG ++" <br>  • Web Challenge „Roboter sind zurück“ <br>  • Web Challenge "Diego Gallery" <br>  • Programmieraufgabe „Vorsichtige Schritte“ <br>  • Die Aufgabe, "Puzzle" zu programmieren <br>  • Netzwerk-Herausforderung „Ping Pong“ <br>  • Networking Challenge "Protokoll" <br><br>  <u><b>Herausforderung: PNG ++</b></u> <u><br></u> <br>  Beschreibung: <br><br>  Dieses <i>Bild</i> (Link zur verschlüsselten PNG-Datei) <i>wurde mit einer benutzerdefinierten Verschlüsselung codiert.</i> <i><br><br></i>  <i>Wir haben es geschafft, den größten Teil dieses Codes hier zu lesen (Link zum Python-Code).</i> <i><br></i>  <i>Leider hat jemand träge Kaffee auf den gesamten key_transformator.py verschüttet.</i> <i><br><a name="habracut"></a></i>  <i>Können Sie uns helfen, dieses Bild zu entschlüsseln?</i> <br><br>  Python-Code: <br><br><img src="https://habrastorage.org/webt/zz/4y/ap/zz4yapgm1vncifqjksq4jqnbfz0.png" alt="Bild"><br><br>  Die Verschlüsselungslogik lautet wie folgt: <br><br>  1. Stellen Sie die Schlüssellänge (Schlüsselgröße) auf 4 Byte ein <br><br>  2. Lesen Sie die Bytes der Datei "flag.png" in der Variablen "img" <br><br>  3. Fügen Sie der Datei einen Abstand hinzu, und zwar bis zum ersten nächsten Vielfachen von vier.  Das Auffüllen entspricht der Anzahl der fehlenden Bytes.  Wenn die Dateilänge beispielsweise 29 Byte beträgt (3 fehlen), fügen Sie drei Byte mit dem Dezimalwert 3 (ASCII 0x03) hinzu.  Mit anderen Worten, Auffüllbytes dürfen nicht leer sein (ASCII 0x00), da ihr Dezimalwert Null ist, was das Auffüllen nicht impliziert. <br><br>  4. Stellen Sie die Starttaste mit vier zufälligen Großbuchstaben ([AZ]) ein. <br><br>  5. Machen Sie dasselbe mit allen Bytes in der Datei und verschlüsseln Sie Ketten von jeweils vier Bytes <br><br>  a.  Jedes Byte in der Datei wird byteweise vom Schlüssel gestrichen <br>  b.  Der Schlüssel wird ständig in einen anderen Schlüssel konvertiert, dafür ist key_transformator.transform (Schlüssel) verantwortlich <br>  c.  Enc_data werden verschlüsselte Bytes hinzugefügt <br><br>  6. Geben Sie enc_data (verschlüsselte Bytes) in encrypted.png ein <br><br>  Zu Beginn habe ich den PNG-Format-Header überprüft und festgestellt, dass die ersten acht Bytes wie folgt sind: <br><br>  [137, 80, 78, 71, 13, 10, 26, 10] <br><br>  Ich habe die ersten acht Bytes der verschlüsselten Datei genommen und sie mit diesen acht Bytes verdreht: <br><br><img src="https://habrastorage.org/webt/gj/2z/sv/gj2zsvokw6ajdykiypksss3hyc8.png" alt="Bild"><br><br>  Der Schlüssel des ersten Blocks stellte sich wie folgt heraus: <br>  [85, 80, 82, 81] <br><br>  Und der zweite Block - so: <br>  [86, 81, 83, 82] <br><br>  Da jeder nachfolgende Schlüssel dynamisch mit dem vorherigen Schlüssel generiert wird (key = key_transformator.transform (key)), habe ich den Algorithmus verstanden: Fügen Sie jedem Byte im vorherigen Schlüssel einen hinzu: <br>  85 -&gt; 86 <br>  80 -&gt; 81 <br>  82 -&gt; 83 <br>  81 -&gt; 82 <br><br>  Und dann wurde mir klar, dass der Name der Herausforderung einen kranken Hinweis verbarg. <br><br>  Ich habe zwei "Hilfsfunktionen" geschrieben: <br><br>  • „nextKey“, der den nächsten Schlüssel basierend auf dem letzten wiederherstellt <br>  • „nextChar“, das den nächsten Buchstaben wiederherstellt und in den meisten Fällen einfach um eins erhöht, wenn er innerhalb der Bytegrenzen liegt (255) <br><br><img src="https://habrastorage.org/webt/iy/m0/ny/iym0nyw_8a8mbqtgfu3iom3zdi4.png" alt="Bild"><br><br>  Ich habe die ursprünglichen 4 Bytes [85, 80 82, 81] in Buchstaben konvertiert: "UPRQ" und den Algorithmus zurückgeführt <br><br><img src="https://habrastorage.org/webt/xc/4x/pf/xc4xpfo8bv7c6dx_lmy2lxxxnxm.png" alt="Bild"><br><br>  Das Flag wurde in der entschlüsselten Datei angegeben: <br><br><img src="https://habrastorage.org/webt/pu/ke/ea/pukeea0_x7zo2mc3jyv_hipjihc.png" alt="Bild"><br><br>  <u><b>Herausforderung: Die Rückkehr der Roboter</b></u> <u><br></u> <br><br>  Beschreibung: <br><br>  <i>Die Roboter sind cool, aber glauben Sie mir: Ihr Zugang sollte begrenzt sein!</i>  Schau es dir an (Link) <br><br>  Nachdem Sie dem Link gefolgt sind, sehen Sie eine bestimmte Seite, die Robotern gewidmet ist.  Grundsätzlich deutet alles darauf hin, dass Sie das Vorhandensein der Datei "robots.txt" überprüfen sollten. <br><br><img src="https://habrastorage.org/webt/i3/85/gp/i385gpm2k1shd1zjods7ellwhxs.png" alt="Bild"><br><br>  Durch Hinzufügen von ./robots.txt zur URL erhalten wir Folgendes: <br><br><img src="https://habrastorage.org/webt/ic/fs/qg/icfsqglz7pm83jpqhnyuibevqwm.png" alt="Bild"><br><br>  Ich habe ./secret_login.html überprüft und bin auf eine Registrierungsseite gestoßen <br><br><img src="https://habrastorage.org/webt/_r/uw/uq/_ruwuq-tramkokydryvhliq6fks.png" alt="Bild"><br><br>  Als nächstes überprüfte ich den Quellcode des Formulars, um die Passwortbestätigung zu finden, und sah dieses Javascript: <br><br><img src="https://habrastorage.org/webt/y1/na/pe/y1napezb5awnipexnz9pudxulbm.png" alt="Bild"><br><br>  Wenn der Wert bestätigt wird, wird er anscheinend an die Autorisierungsfunktion gesendet, die den übergebenen Wert mit der Funktion btoa (Base64-Decodierungsfunktion in Javascript) decodiert und dann mit der Zeichenfolge „SzMzcFQjM1IwYjB0JDB1dA ==“ vergleicht. <br><br>  Ich habe diese Zeile entschlüsselt <br><br><img src="https://habrastorage.org/webt/ho/hx/w4/hohxw4qi3wre5-6rasvxo6csv7w.png" alt="Bild"><br><br>  Ich habe den resultierenden Wert in die Passwortzeichenfolge eingefügt.  Bingo! <br><br><img src="https://habrastorage.org/webt/qe/jg/n3/qejgn31fh6jrxc-7yh7sy2g3vfk.png" alt="Bild"><br><br><br>  <b><u>Herausforderung: Diego Gallery</u></b> <b><br></b> <br>  Beschreibung: <br><br>  <i>Ich habe vor kurzem begonnen, eine Plattform zu entwickeln, um die Fotos meiner Katze zu verwalten und meine flag.txt zu sichern.</i>  <i>Bitte überprüfen Sie mein System (Link zum Anmeldeformular).</i> <i><br><br></i>  <i>Um Fehler im Sicherheitssystem zu vermeiden, wie z. B. die Möglichkeit, SQL-Code einzufügen, habe ich ein eigenes Schema entwickelt.</i> <i><br><br></i>  <i>Die Kurzbeschreibung finden Sie hier (Link zum Diagramm)</i> <br><br>  Anmeldeformular: <br><br><img src="https://habrastorage.org/webt/5d/ml/5k/5dml5k0tqhbpkpcffcuvcir2zgq.png" alt="Bild"><br><br>  Voreingestellte Schaltung: <br><br><img src="https://habrastorage.org/webt/jb/wa/jh/jbwajhtbh7rxeqwchqs4-zguhgg.png" alt="Bild"><br><br>  Nachdem ich den Testbenutzernamen und das Passwort festgelegt hatte, bekam ich Zugang zur öffentlichen Galerie der Katze "Diego". <br><br>  Da ich mich als regulärer Benutzer registriert habe, habe ich herausgefunden, dass Sie möglicherweise einen Weg zur Eskalation von PE-Berechtigungen (Privilege Escalation) finden müssen.  Beim Durchsuchen des Schemas nach registrierten Benutzern habe ich festgestellt, dass der Unterschied zwischen dem regulären Benutzer und dem Administrator im dritten Abschnitt des Schemas liegt, der durch drei Striche getrennt ist. <br><br>  Nachdem geschätzt wurde, dass, wenn sich der erste Wert (Benutzername) auf den ersten Abschnitt und der zweite (Kennwort) auf den zweiten bezieht, die Rolle vom System unmittelbar nach dem Eintritt des Benutzers mit den aktuellen Rechten zugewiesen wird. <br><br>  Zum Beispiel: <br><br>  START ||| Erster Wert ||| Zweiter Wert ||| Benutzer (vom Webdienst hinzugefügt) ||| ENDE <br><br>  Meine Nutzlast war wie folgt: <br><br>  • Erster Wert: “niki ||| niki ||| admin ||| END \ nSTART ||| other“ <br>  • Zweiter Wert: "Sonstige" <br><br>  Dies hat wahrscheinlich die folgenden Protokollzeilen generiert: <br><br>  START ||| niki ||| niki ||| admin ||| END <br>  START ||| other ||| other ||| user ||| END <br><br>  Danach konnte ich mich als Administrator anmelden und die vollen Rechte erhalten: <br><br><img src="https://habrastorage.org/webt/p0/1v/0h/p01v0hcr31jqfel7olalnnvyzxa.png" alt="Bild"><br><br>  Durch Drücken der Tasten wird nur eine Warnung ausgelöst, dass die Flagge sicher ist. <br>  Innerhalb der URL können Sie jedoch lesen: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php</a> ?  view = log.txt <br><br>  Was sehr explizit auf <i>LFI (Local File Inclusion) über URL</i> anspielt <br><br>  Ich habe versucht: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php?view=flag.txt</a> <br><br>  Und die Flagge gehörte mir. <br><br><img src="https://habrastorage.org/webt/js/ux/bj/jsuxbjcvsikvpgglmeesevd9iey.png" alt="Bild"><br><br>  <b><u>Herausforderung: Vorsichtige Schritte</u></b> <b><br></b> <br>  Beschreibung: <br><br>  <i>Dies (Dateilink) ist eine Reihe von Archiven, die wir gefunden haben.</i>  <i>Wir sind sicher, dass die geheime Flagge irgendwo in ihnen versteckt ist.</i> <i><br></i>  <i>Wir sind absolut sicher, dass die gesuchten Daten im Kommentarbereich jeder Datei versteckt sind.</i> <i><br></i>  <i>Könnten Sie vorsichtig zwischen den Dateien wechseln und die Flagge finden?</i> <i><br></i>  <i>Viel Glück</i> <br><br>  Nach dem Extrahieren der Datei erhalten Sie ein Verzeichnis mit dem Namen "archives" mit zweitausend darin enthaltenen Dateien mit dem Titel "unzipme. [Number]". <br><br><img src="https://habrastorage.org/webt/cu/08/gu/cu08guzhfz3ce9eypciwpsuz7so.png" alt="Bild"><br><br>  Ich habe das binwalk-Programm verwendet, um die erste Datei zu überprüfen.  Und hier ist, was das Programm mir gab: <br><br><img src="https://habrastorage.org/webt/dg/t5/je/dgt5je6znvxzcslet4awihbmyy8.png" alt="Bild"><br><br>  Ja, also im Kommentarbereich haben wir sowohl Buchstaben als auch Zahlen.  Nochmal Hinweise? <br><br>  Zuerst überlegte ich, ob ich die Buchstaben mit den angegebenen Indizes aus dieser Zip-Datei verbinden und die nächste Datei bereits mit Index 245 überprüfen sollte. <br><br>  Aber hier kam eine Überraschung: Die zweite Datei war nicht in Zip, sondern im RAR-Format. <br><br><img src="https://habrastorage.org/webt/am/fn/wo/amfnwo5q-st0m2qqqmdb1fqw51s.png" alt="Bild"><br><br>  Deshalb musste ich es "anrarnieren", um zu den Kommentaren zu gelangen: <br><br><img src="https://habrastorage.org/webt/1a/sn/ew/1asnewamm2r4kv-ells856jizqg.png" alt="Bild"><br><br>  Meine Logik bestand darin, die Datei über binwalk auszuführen. Wenn ich auf einen RAR stieß, packen Sie ihn aus, um zu den Kommentaren zu gelangen.  Andernfalls können Sie den Kommentarbereich direkt anzeigen, um weitere Aktionen zu verstehen. <br><br>  Meine erste Vermutung: Die Nummer ist der Dateiindex (jeder wurde von 0 bis 1999 nummeriert).  Ich habe jedoch festgestellt, dass einige Zahlen negativ sind, was bedeutet, dass sie kein Index sein können. <br><br>  Zweite Vermutung: Die Zahl ist ein Sprung, der durchaus negativ sein kann.  Für jede Nummer brauchte ich einen Sprung zur nächsten Datei.  Ich wusste, dass wenn mein Code ständig zur nächsten berechneten Datei springt, dies eine kleine Falle in Form eines Zyklus erzeugen kann und mein Code in einer Endlosschleife stecken bleibt.  Also habe ich einen Python-Code mit einem Kontolimit geschrieben.  Und nach mehreren Tests stellte ich fest, dass die Zahl 120 völlig ausreichen würde: <br><br><img src="https://habrastorage.org/webt/i6/wp/r6/i6wpr6fkyddpaiqpj5mcqak1two.png" alt="Bild"><br><br>  Und die Flagge gehörte mir: <br><br><img src="https://habrastorage.org/webt/az/kb/xl/azkbxlwld_iazfgfbzb9sy9zcco.png" alt="Bild"><br><br>  Die anderen drei, die ich im nächsten Beitrag beschrieben habe, lesen, versuchen, ich freue mich über Ihre Kommentare </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de429112/">https://habr.com/ru/post/de429112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de429102/index.html">Verkauf von Elektrofahrzeugen in Kanada</a></li>
<li><a href="../de429104/index.html">Hohe Daten</a></li>
<li><a href="../de429106/index.html">GUS für Infrastruktur</a></li>
<li><a href="../de429108/index.html">Google: Das Entfernen von "Raubkopien" -Links aus der Ausgabe löst das Problem illegaler Inhalte nicht</a></li>
<li><a href="../de429110/index.html">CSS-Tipps, die Sie in Tutorials wahrscheinlich nicht finden</a></li>
<li><a href="../de429114/index.html">So bestehen Sie einen Cyber-Test am Checkpoint Teil 2</a></li>
<li><a href="../de429116/index.html">Erstellen Sie reaktionsschnelle Bilder</a></li>
<li><a href="../de429118/index.html">Flughafenanalyst</a></li>
<li><a href="../de429120/index.html">Java Challengers # 3: Polymorphismus und Vererbung</a></li>
<li><a href="../de429122/index.html">Die nahe Zukunft von NetApp</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>