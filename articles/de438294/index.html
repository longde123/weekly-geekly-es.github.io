<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏾‍🚀 🙋🏾 🏥 Zuckende Streamer in einem PUBG-Match finden 👩‍💼 👩🏾‍🍳 🎅🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor kurzem haben wir zusammen mit den Wiederholungen von minmax.gg/chickendinner eine neue Funktion veröffentlicht, mit der die von den teilnehmenden ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Zuckende Streamer in einem PUBG-Match finden</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438294/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b8/261/fcb/0b8261fcbf965321f750c1e272b37339.jpg" alt="Bild"></div><br>  Vor kurzem haben wir zusammen mit den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="noopener">Wiederholungen von</a> minmax.gg/chickendinner eine neue Funktion veröffentlicht, mit der die von den teilnehmenden PUBG Twitch-Streamern ausgestrahlten Videos angezeigt werden.  Um es zu implementieren, mussten wir Twitch-Streamer an ihren Namen im Spiel erkennen, was sich als ziemlich interessante Aufgabe herausstellte. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/728/4b0/b8f/7284b0b8f675134aa04dc46398a52e1b.gif"></div><br>  <i>Unsere neue Twitch-Funktion in Aktion.</i> <br><br><h2>  Die Wahrscheinlichkeit, dass Sie im selben Match mit dem Streamer spielen </h2><br>  Bevor wir mit der Entwicklung dieser Funktion begannen, wollten wir sicherstellen, dass die Wahrscheinlichkeit eines Spiels, in dem einer der Spieler auf Twitch gestreamt hat, groß genug ist, um unsere Bemühungen zu rechtfertigen.  Wir können eine sehr grobe Schätzung vornehmen, indem wir die Anzahl der aktiven Spieler betrachten und sie mit der Anzahl der aktiven Sendungen vergleichen. <br><br>  Zum Zeitpunkt des Schreibens sendete das Spiel auf Twitch ungefähr 2100 Benutzer, und auf Steam gab es ungefähr 700.000 aktive Spieler in PUBG.  Dies bedeutet, dass zu diesem Zeitpunkt Streamer ungefähr 0,3% der Spielerbasis ausmachten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5a6/ca3/24f/5a6ca324f8fb9d22756caec476464959.png"></div><br>  Wenn man bedenkt, dass 100 Personen das Match am häufigsten spielen, ist die Wahrscheinlichkeit, dass mindestens einer von ihnen ein Streamer ist, das Gegenteil der Wahrscheinlichkeit, dass <em>niemand</em> ein Streamer ist.  Da die Wahrscheinlichkeit, dass der Spieler kein Streamer ist, 99,7% beträgt, beträgt die Wahrscheinlichkeit, dass keiner der 100 Spieler ein Streamer ist, 0,997 hoch 100, d. H. 0,74.  Mit anderen Worten, in jedem Spiel besteht eine Wahrscheinlichkeit von ungefähr 25 Prozent, dass mindestens ein Spieler auf Twitch streamt. <br><br>  Es ist erwähnenswert, dass wir bei Twitch eine starke Verlagerung in Richtung Nordamerika im Vergleich zur allgemeinen Basis der PUBG-Spieler annehmen können. Wenn Sie also Spiele aus Nordamerika sehen, wird der Prozentsatz wahrscheinlich viel höher sein. <br><br><h2>  Errate die Namen </h2><br>  Jetzt, da wir wissen, dass es eine gute Chance gibt, in einem bestimmten Spiel einen Streamer zu finden, woher wissen wir, ob ein Spieler ein Spiel auf Twitch streamt? <br><br>  Für zusätzliche Boni können Sie Ihr Twitch-Konto mit dem Spiel verbinden. Leider sind diese Daten nicht über die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="noopener">PUBG-API</a> verfügbar.  Wir brauchen eine andere Möglichkeit, den Spielernamen an den Streamer in Twitch zu binden. <br><br>  Schauen wir uns einen hypothetischen Streamer mit einem <em>Mitch-</em> Kontonamen an.  Mitch spielt regelmäßig in PUBG, aber sein Twitch-Kanal hat noch nicht das Niveau erreicht, von dem er träumt.  Nach dem Nachdenken ändert er seinen Namen im Spiel in <em>TwitchMitch</em> .  Jetzt weiß jeder, dass Mitch auf Twitch streamt. <br><br>  Dieses Prinzip ist sehr verbreitet, manchmal mit leicht unterschiedlichen Variationen: <em>TTVMitch</em> oder <em>Mitch_TV</em> .  Solche Namen können programmgesteuert erkannt und daraus ein Konto bei Twitch ermittelt werden, sodass wir Videos zur Anzeige in der Wiederholung des Spiels erhalten können. <br><br><h2>  Manuelle Zuordnung </h2><br>  Dieser Ansatz gibt uns einen sehr guten Bezugspunkt, ist aber bei weitem nicht genug.  Die Namen der beliebtesten Streamer stimmen nicht mit diesem Muster überein.  Um sie zu finden, müssen Sie vom PUBG-Konto aus individuell auf den Namen ihres Twitch-Kanals verlinken. <br><br>  Um dies zu bewältigen, haben wir begonnen, manuell nach den beliebtesten Streamern auf Twitch zu suchen und die Namen der Spielkonten aufzuzeichnen, die auf dem Bildschirm angezeigt werden.  Wenn Sie Glück haben, können Sie den Moment einfangen, in dem der Spieler in der Lobby wartet, wo Sie den Namen an mehreren Stellen finden können: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7e0/2b0/d11/7e02b0d118ff09436f925b0e641e8c38.png"></div><br>  Es ist jedoch viel wahrscheinlicher, einen Spieler zu finden, der bereits im Spiel spielt.  Wenn er mit der Mannschaft spielt, ist sein Name immer in der unteren linken Ecke sichtbar: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad8/030/bda/ad8030bda4f3f0bc2ebf969b90fa612b.png"></div><br>  Es muss jedoch berechnet werden, welcher der Namen ihm gehört, da er nicht immer gleich ist.  Der einfachste Weg, dies zu tun, besteht darin, auf die Minikarte in der unteren rechten Ecke zu schauen, die auf der Markierung des Spielers zentriert ist und mit einer Zahl und Farbe markiert ist. <br><br>  Der ganzheitlichste Ansatz besteht darin, den zentralen unteren Teil des Bildschirms zu untersuchen, in dem Sie Folgendes finden: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/405/15c/f0b/40515cf0b945f4a13e4f9363054bee81.png"></div><br>  Dieser Text enthält den Kontonamen, die aktuelle Version des Spiels, die letzten 6 Zeichen der Übereinstimmungskennung und die Serverregion.  Es ist zu bedenken, dass es nicht immer so sauber ist wie oben gezeigt, da es sich normalerweise mit dem vermischt, was dahinter auf dem Bildschirm passiert.  Der Text ist klein, was bedeutet, dass er bei schwerwiegenden Videoartefakten unscharf und schlecht lesbar sein kann.  Aber früher oder später werden Sie einen Rahmen finden, der gut genug ist, um ihn zu lesen. <br><br>  Vielleicht denken Sie bereits darüber nach, was wir damals realisiert haben - dies ist eine ideale Aufgabe für eine automatische Computerlösung! <br><br><h2>  Computer Vision </h2><br>  Unter idealen Bedingungen sollte der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="noopener">OCR-</a> Algorithmus erkennen, was im folgenden Text geschrieben steht.  Nachdem wir einige Optionen ausprobiert hatten, entschieden wir schließlich, dass die Google <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="noopener">Cloud Vision-API</a> die besten Ergebnisse liefert.  Wir können ein Skript erstellen, das Folgendes ausführt: <br><br><ol><li>  Ruft eine Live-PUBG-Sendung ab und schneidet den unteren Rand des Screenshots aus ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Twitch API</a> bietet ein Vorschaubild in voller Größe, sodass wir keine Screenshots selbst machen müssen). </li><li>  Sendet einen Screenshot an die Cloud Vision-API und analysiert den Namen des Spielers aus dem Ergebnis. </li><li>  Überprüft über die PUBG-API, ob der Player vorhanden ist, und speichert dann das Twitch-Konto aus dem PUBG-Konto in unserer Datenbank. </li></ol><br>  Dies funktioniert bis auf ein kleines Detail hervorragend: Google verlangt 1,5 US-Dollar pro tausend Anfragen an die Cloud Vision-API.  Zu jedem Zeitpunkt können ungefähr 2-3.000 aktive Streamer vorhanden sein, sodass selbst ein einzelner Skriptlauf bis zu 4,5 US-Dollar kostet.  Angesichts der Tatsache, dass wir wahrscheinlich viele Screenshots mit unlesbarem Text erhalten, müssen Sie das Skript mehrmals ausführen, um eine signifikante Datenmenge zu erhalten.  Mit anderen Worten, ein solcher Ansatz wird schnell zu einem sehr kostspieligen Unterfangen.  Glücklicherweise können wir Anfragen für Cloud Vision etwas intelligenter organisieren.  Wir können die Tatsache nutzen, dass Google die Zahlung für einzelne Anfragen anfordert, unabhängig von der Größe des Bildes.  Das heißt, wir können viele Bilder mit dem Raster verbinden: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e90/1ec/f4b/e901ecf4b93fdedc2fa645feee12912f.png"></div><br>  Dann senden wir dieses Bildraster an die API und hängen den resultierenden Text an das Bandlaufwerk an, das dem Bereich entspricht, in dem der Text gefunden wurde. <br><br>  Die Größe der von Google gleichzeitig gesendeten Daten ist begrenzt. Daher nehmen wir 300 zusammengeklebte Bilder für eine Anfrage auf.  Dies bedeutet, dass wir jetzt 300 Mal dasselbe Skript zum gleichen Preis wie zuvor ausführen können, was diesen Ansatz sehr praktikabel und effektiv macht. <br><br><h2>  Füllen Sie die letzten Lücken aus </h2><br>  Unser Skript hat ein paar Wochen funktioniert, und bisher haben wir 25.000 Vergleiche zwischen Twitch und PUBG erzielt.  Das Skript konnte jedoch einige Streamer nicht binden, z. B. diejenigen, die über dem Text am unteren Bildschirmrand eine eigene Überlagerung haben. <br><br>  Wir müssen diese Streamer manuell binden.  Anstatt dies alleine zu tun, haben wir beschlossen, eine Funktion hinzuzufügen, mit der unsere Besucher den Namen eines Streamers senden können, den sie nicht in unserer Datenbank gefunden haben: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4cd/180/4ce/4cd1804ce5d78b7f9cad545af3544b41.png"></div><br>  Wir werden gerne weiter mit den Methoden experimentieren, um solche Kontenpaare zu erhalten, und noch mehr möchten wir neue Wege finden, um vorhandene Informationen zu nutzen.  Erwarten Sie neue Artikel von uns! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de438294/">https://habr.com/ru/post/de438294/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de438280/index.html">Objekte in Django "löschen"</a></li>
<li><a href="../de438286/index.html">Arbeiten mit Zeitzonen in JavaScript</a></li>
<li><a href="../de438288/index.html">Furchtloser Schutz. Speichersicherheit in Rust</a></li>
<li><a href="../de438290/index.html">Post-mortem mit GGJ-2019: wie man Unebenheiten bekommt, aber trotzdem das Spiel macht</a></li>
<li><a href="../de438292/index.html">Apartment Automation mit HomePod, Raspberry Pi und Node.js.</a></li>
<li><a href="../de438296/index.html">OpenSceneGraph: Plugin-System</a></li>
<li><a href="../de438298/index.html">Warum unterrichten, wenn das Entwickeln rentabler ist? Gespräch mit GeekBrains</a></li>
<li><a href="../de438302/index.html">Die erstaunliche Kreativität der digitalen Evolution</a></li>
<li><a href="../de438304/index.html">Vergabe von Unteraufträgen? Cool du schlägst</a></li>
<li><a href="../de438306/index.html">Strahlung: Wochentags radiochemisches Labor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>