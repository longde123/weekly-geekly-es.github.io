<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèüÔ∏è üå≠ üëºüèæ Klasik abadi, atau ikhtisar vektor serangan baru melalui Microsoft Office üíü üèß üôÜüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Peretas telah mengeksploitasi kredibilitas manusia dan kecerobohan selama beberapa dekade. Sebagian besar pengguna membuka keamanan e-mail, sekilas, l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Klasik abadi, atau ikhtisar vektor serangan baru melalui Microsoft Office</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/433142/"><p><img src="https://habrastorage.org/webt/kw/nd/ax/kwndax-gdv9ffqc1p4xjlvt98ig.png" alt="gambar"><br>  Peretas telah mengeksploitasi kredibilitas manusia dan kecerobohan selama beberapa dekade.  Sebagian besar pengguna membuka keamanan e-mail, sekilas, lampiran e-mail tanpa ragu-ragu dan, tanpa mengetahuinya, meluncurkan malware.  Untuk melindungi diri dari serangan semacam itu, Anda perlu mengetahui musuh secara langsung.  Hari ini kita akan mencoba mencari tahu bagaimana tiga teknik baru untuk mengeksekusi kode dalam aplikasi kantor ditemukan tahun ini diatur, dan metode perlindungan apa yang ada. </p><a name="habracut"></a><br><h4 id="xlm-makrosy">  Makro Xlm </h4><br><p> Pakar Outflank telah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">memperkenalkan</a> cara baru untuk menjalankan kode di MS Office Excel melalui apa yang disebut makro XLM (tidak harus bingung dengan XML).  Meskipun teknologi makro XLM telah digunakan selama lebih dari 26 tahun (pertama kali muncul di Excel 4.0 untuk Windows 3.0 / 3.1), masih didukung oleh semua versi Microsoft Office Excel hingga Office 2016. </p><br><p>  Untuk membuat makro XLM di Excel, Anda harus mengikuti langkah-langkah ini: <br>  Di menu konteks lembar Excel, pilih "Sisipkan". </p><br><p><img src="https://habrastorage.org/webt/67/xk/4z/67xk4zajwn9lfivlx22sepe8mfo.png" alt="gambar"></p><br><p>  Selanjutnya, pilih "MS Excel 4.0". </p><br><p><img src="https://habrastorage.org/webt/hn/jm/px/hnjmpxngzz89cnn55udbpqrvwvi.png" alt="gambar"></p><br><p>  Akibatnya, lembar "Makro1" akan muncul, di sel mana pun, menggunakan fungsi "EXEC", proses yang diinginkan dapat dimulai.  Untuk menjalankan makro secara otomatis, sel pertama harus diganti namanya menjadi "Auto_open" (mirip dengan prosedur AutoOpen () di makro VBA). </p><br><p>  Setelah membuka dokumen yang disimpan, pemberitahuan standar muncul dengan permintaan untuk menjalankan makro. </p><br><p><img src="https://habrastorage.org/webt/am/yg/v_/amygv_5ssyott6a0rovv6tmztdw.png" alt="gambar"></p><br><p>  Lembar makro dapat disembunyikan dengan memilih "Sembunyikan" di menu konteks. </p><br><p>  Selain kemampuan untuk memulai proses, makro XLM dapat mengakses Win32 API menggunakan fungsi REGISTER dan CALL.  Berikut ini adalah kode PoC untuk makro yang menerapkan teknik injeksi shellcode. </p><br><p><img src="https://habrastorage.org/webt/xf/2i/zw/xf2izwfzcskz31cimua40hxayb4.png" alt="gambar"></p><br><p>  Pada saat yang sama, fungsi pengkodean CHAR digunakan untuk menyimpan karakter kode shell di dalam sel makro.  Untuk menghapus byte nol, Anda bisa menggunakan utilitas msfvenom, yang merupakan bagian dari Metasploit Framework. </p><br><p>  Dengan metode penyimpanan di dalam file Excel, makro XLM secara signifikan berbeda dari makro VBA klasik yang muncul setahun kemudian di Excel 5.0.  Dalam format .xlsm Excel baru, yang merupakan arsip ZIP, makro XLM disimpan di dalam file XML di direktori macrosheets.  Dalam format .xsl (Excel 97-2003), makro disimpan di dalam aliran OLE. </p><br><p>  Lebih lanjut terlihat bahwa makro VBA disimpan dalam wadah terpisah (pada gambar di sebelah kiri), sedangkan makro XLM terletak di wadah data yang sama. </p><br><p><img src="https://habrastorage.org/webt/vk/b4/ah/vkb4ahksxymoxkgyrtfcjo0igci.png" alt="gambar"></p><br><p>  Perbedaan-perbedaan dalam metode penyimpanan makro ini secara signifikan mempengaruhi kualitas deteksi mereka oleh antivirus, khususnya, teknologi Antarmuka Pemindaian Antimalware (AMSI) tidak mendukung XLM, meskipun ada dukungan yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diklaim</a> dari Office 365. </p><br><p>  Misalnya, Metasploit PowerShell kode web_delivery diimplementasikan di Excel menggunakan makro VBA dan XLM (dalam gambar di bawah). </p><br><p><img src="https://habrastorage.org/webt/mp/pg/30/mppg30vb0ssgy9znbnmomcayq9e.png" alt="gambar"></p><br><p><img src="https://habrastorage.org/webt/2j/n3/z4/2jn3z4x3budl5irzemobw6li3vm.png" alt="gambar"></p><br><p>  Di Virustotal, dokumen Excel dengan makro VBA memicu 21 dari 59 antivirus. </p><br><p><img src="https://habrastorage.org/webt/xk/7x/tn/xk7xtnip5rsocfra6wmqk3ydobu.png" alt="gambar"></p><br><p>  Pada saat yang sama, dokumen serupa dengan makro XLM tidak menimbulkan kecurigaan terhadap antivirus. </p><br><p><img src="https://habrastorage.org/webt/6w/5z/pn/6w5zpnmshm7pmwhuxgon_ootlcg.png" alt="gambar"></p><br><p>  <strong>Demonstrasi</strong> <br>  Eksekusi Kode melalui Macro XLM di Kantor </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/G-2uir9TeFQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4 id="microsoft-office-online-video">  Video Online Microsoft Office </h4><br><p>  Tim peneliti Cumulate telah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menemukan</a> cara baru untuk mengeksekusi kode di Word dengan memasukkan video menggunakan Video Online.  Menggunakan elemen ini, Anda dapat menambahkan video YouTube ke dokumen, lalu ganti tautannya dengan kode JavaScript yang akan dieksekusi di Internet Explorer ketika Anda membuka dokumen dan mengklik video.  Vektor berikut terlihat paling cocok untuk rekayasa sosial: </p><br><ul><li>  Menambahkan kode exploit untuk IE / Flash dalam iframe dengan video YouTube. </li><li>  Menambahkan kode JavaScript di iframe dengan video YouTube menggunakan metode msSaveOrOpenBlob, di mana ia akan disarankan untuk mengunduh dan menjalankan file jahat.  Badan file terdapat di dalam javascript base64. </li></ul><br><p>  Untuk membuat file dengan ekstensi docx.  dengan beban yang dijelaskan, Anda harus melakukan langkah-langkah berikut: </p><br><p>  1. Tambahkan video YouTube melalui "Sisipkan - Video Online". </p><br><p><img src="https://habrastorage.org/webt/ty/kg/ea/tykgeapsiwbx7kq1gp7egsv3zma.png" alt="gambar"></p><br><p>  2. Simpan file docx yang dibuat. </p><br><p>  3. Buka zip docx yang disimpan.  Format docx  adalah arsip zip dari konten berikut: <br><img src="https://habrastorage.org/webt/wm/pp/fb/wmppfb5hpuuv7g-tvhtqjbom7ye.png" alt="gambar"></p><br><p>  4.Dalam direktori Word dalam file document.xml dalam elemen embeddedHtml, tambahkan kode JavaScript Anda dengan memasukkannya ke dalam tubuh iframe atau dengan mengganti tautan yang sesuai (src) di iframe. </p><br><p>  5. Buat arsip zip (dengan ekstensi docx) dengan perubahan yang dibuat. </p><br><p>  Lebih lanjut, ketika membuka file docx yang dihasilkan, pengguna diharuskan mengklik tautan video dan meluncurkan file yang diunduh.  Atau, Anda dapat menampilkan tangkapan layar dengan proposal untuk memperbarui Flash Player, mendorong pengguna untuk mengunduh dan menjalankan file.  Tidak ada peringatan keamanan yang ditampilkan. </p><br><p><img src="https://habrastorage.org/webt/hx/0z/fx/hx0zfxdxfl5dhfkckbt_g2mo50s.png" alt="gambar"></p><br><p>  Seperti dalam kasus macro XLM, teknik eksekusi kode ini tidak terdeteksi oleh antivirus apa pun di Virustotal dan terlihat sangat menarik bagi penulis virus, dan juga umum dalam rekayasa sosial sebagai bagian dari pengujian penetrasi. </p><br><p>  <strong>Demonstrasi</strong> <br>  Eksekusi kode melalui Video Online di Kantor </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/E4lqdRNyA9Y" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4 id="vba-stomping">  Vba menghentak </h4><br><p>  Pada konferensi Derbycon 2018, teknik untuk meluncurkan makro VBA dalam dokumen Office <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diperkenalkan</a> , yang disebut VBA Stomping.  Inti dari teknik ini adalah untuk menghapus / memodifikasi (sebagai pilihan untuk mengisi dengan nol) kode sumber VBA dalam tubuh dokumen kantor, meninggalkan kode makro yang dikompilasi yang disebut p-code tidak tersentuh.  Kode VBA, serta versinya yang dikompilasi, terletak di dalam file vbaProject.bin yang terletak di arsip zip (file dengan ekstensi .docm, .xslm). </p><br><p><img src="https://habrastorage.org/webt/2h/o0/62/2ho062u42yrxr81jebhqf1zegyu.png" alt="gambar"></p><br><p>  Dengan demikian, teknik ini bermuara pada menghapus / mengisi dengan nol bagian dari file vbaProject.bin. </p><br><p><img src="https://habrastorage.org/webt/me/jq/iq/mejqiqu1zpf6w2nethawrkz7ao4.png" alt="gambar"></p><br><p>  Akibatnya, dokumen tersebut tidak menimbulkan kecurigaan di antara antivirus yang menganalisis makro hanya dengan kode sumbernya.  Misalnya, dengan bantuan teknik ini, para peneliti dapat mengurangi jumlah tanggapan antivirus terhadap Trojan perbankan Emotet, yang didistribusikan melalui file kantor, dari 36/59 ke 7/58 pada Virustotal. </p><br><p><img src="https://habrastorage.org/webt/wo/bi/2c/wobi2cimjqfwlp_mxurz8v8ruoa.png" alt="gambar"></p><br><p><img src="https://habrastorage.org/webt/d8/bk/ni/d8bknikd5av_ae0e1yk1szf0bqm.png" alt="gambar"></p><br><p>  Selain itu, teknik ini menyulitkan untuk menganalisis file, karena tidak ada alat, tanpa menggunakan dekompilasi, akan dapat mengekstrak kode sumber VBA, yang juga tidak akan ditampilkan di editor makro Office hingga diselesaikan. </p><br><h4 id="zaschita">  Perlindungan </h4><br><p>  Rekomendasi untuk melawan teknik yang dijelaskan adalah tradisional untuk perlindungan terhadap metode rekayasa sosial: </p><br><ol><li>  Meningkatkan kesadaran karyawan tentang masalah keamanan informasi. </li><li>  Melarang penggunaan makro di Microsoft Office. </li><li>  Pendekatan terintegrasi untuk memastikan keamanan informasi, termasuk penggunaan solusi Endpoint, serta alat keamanan perimeter (firewall generasi berikutnya, solusi UTM, gateway surat). </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id433142/">https://habr.com/ru/post/id433142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id433130/index.html">Semoga kekuatan bersama kita: kekebalan kita sendiri terhadap kanker</a></li>
<li><a href="../id433132/index.html">"Kalender Tester" untuk bulan Desember. Coba pendekatan yang berbeda</a></li>
<li><a href="../id433136/index.html">System.Transaksi Infrastruktur di Dunia .NET</a></li>
<li><a href="../id433138/index.html">Lima prinsip desain produk saat Pemesanan</a></li>
<li><a href="../id433140/index.html">Modul Google Pay Client Siap</a></li>
<li><a href="../id433144/index.html">.NET Core 2.2 dirilis. Apa yang baru? (1 dari 3)</a></li>
<li><a href="../id433146/index.html">[Kompetisi] 25 konsol game teratas (kocok dulu)</a></li>
<li><a href="../id433152/index.html">Kami mentransfer Zimbra dari server tunggal ke infrastruktur multi-server</a></li>
<li><a href="../id433154/index.html">Pengalaman pengguna 5G NR diharapkan di dunia nyata</a></li>
<li><a href="../id433156/index.html">Dell go public dan menuju cloud hybrid</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>