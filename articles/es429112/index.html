<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ùï ü§µüèΩ üç• C√≥mo pasar una prueba cibern√©tica en Checkpoint üë®üèº‚Äçüíº üíø ü§¥üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos, soy Nikita Kurtin , curadora de la Escuela Superior Israel√≠ de Inform√°tica y Seguridad HackerU 

 Checkpoint , la principal compa√±√≠a isr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo pasar una prueba cibern√©tica en Checkpoint</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vyshtech/blog/429112/"> Hola a todos, soy <b>Nikita Kurtin</b> , curadora de la Escuela Superior Israel√≠ de Inform√°tica y Seguridad <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b>HackerU</b></a> <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Checkpoint</a></b> , la principal compa√±√≠a israel√≠ de seguridad de la informaci√≥n, public√≥ una serie de pruebas cibern√©ticas este verano. <br><br>  Las tareas se dividieron en seis categor√≠as: <br><br>  ‚Ä¢ l√≥gica <br>  ‚Ä¢ Web <br>  ‚Ä¢ Programaci√≥n <br>  ‚Ä¢ Redes <br>  ‚Ä¢ marcha atr√°s <br>  ‚Ä¢ sorpresa <br><br>  Dos tareas para cada direcci√≥n.  En esta publicaci√≥n, te contar√© c√≥mo realic√© solo cuatro pruebas, en las otras tres siguientes: <br><br>  <b>Checkpoint</b> ya hab√≠a logrado ganar respeto e inter√©s por mi parte, as√≠ que decid√≠ aceptar estos desaf√≠os.  Sin embargo, debido al empleo, pude permitirme asumir solo 8 de 12 tareas (de cuatro categor√≠as diferentes).  Y logr√© resolver 7 de ellos. <br><br>  El desaf√≠o finaliz√≥ oficialmente a fines de septiembre de 2018. <br><br><img src="https://habrastorage.org/webt/ms/aj/or/msajorgjjbivojhhdbh5bpk2d_c.png" alt="imagen"><br><br>  As√≠ que ahora, con la conciencia tranquila, puedo contarles paso a paso c√≥mo me abr√≠ paso para resolver los siguientes problemas: <br><br>  ‚Ä¢ Desaf√≠o l√≥gico "PNG ++" <br>  ‚Ä¢ Desaf√≠o web "Los robots han vuelto" <br>  ‚Ä¢ Web Challenge "Galer√≠a Diego" <br>  ‚Ä¢ Tarea de programaci√≥n "Pasos cuidadosos" <br>  ‚Ä¢ La tarea de programar "Puzzle" <br>  ‚Ä¢ Reto de redes "Ping Pong" <br>  ‚Ä¢ Networking Challenge "Protocolo" <br><br>  <u><b>Desaf√≠o: PNG ++</b></u> <u><br></u> <br>  Descripci√≥n: <br><br>  Esta imagen (enlace al archivo PNG cifrado) <i>se codific√≥ utilizando un cifrado personalizado.</i> <i><br><br></i>  <i>Logramos leer la mayor parte de este c√≥digo aqu√≠ (enlace al c√≥digo de Python).</i> <i><br></i>  <i>Desafortunadamente, alguien derram√≥ lentamente caf√© en todo key_transformator.py.</i> <i><br><a name="habracut"></a></i>  <i>¬øPodr√≠as ayudarnos a descifrar esta imagen?</i> <br><br>  C√≥digo de Python: <br><br><img src="https://habrastorage.org/webt/zz/4y/ap/zz4yapgm1vncifqjksq4jqnbfz0.png" alt="imagen"><br><br>  La l√≥gica de cifrado es la siguiente: <br><br>  1. Establezca la longitud de la clave (tama√±o de la clave) en 4 bytes <br><br>  2. Lea los bytes del archivo "flag.png" en la variable "img" <br><br>  3. Agregue relleno al archivo, al primer m√∫ltiplo m√°s cercano de cuatro.  El relleno es igual al n√∫mero de bytes que faltan.  Por ejemplo, si la longitud del archivo es de 29 bytes (faltan 3), agregue tres bytes con el valor decimal 3 (ASCII 0x03).  O, en otras palabras, los bytes de relleno no pueden estar vac√≠os (ASCII 0x00), porque su valor decimal es cero, lo que no implica relleno. <br><br>  4. Configure la tecla de inicio con cuatro letras may√∫sculas aleatorias ([AZ]). <br><br>  5. Haz lo mismo con todos los bytes en el archivo, encriptando cadenas de cuatro bytes a la vez <br><br>  a.  Cada byte en el archivo se pelea por byte de la clave <br>  b.  La clave se convierte constantemente en otra clave, key_transformator.transform (key) es responsable de esto <br>  c.  Los bytes encriptados se agregan a enc_data <br><br>  6. Ingrese enc_data (bytes encriptados) en encrypted.png <br><br>  Para comenzar, verifiqu√© el encabezado del formato PNG y descubr√≠ que los primeros ocho bytes son los siguientes: <br><br>  [137, 80, 78, 71, 13, 10, 26, 10] <br><br>  Tom√© los primeros ocho bytes del archivo encriptado y los gir√© con estos ocho bytes: <br><br><img src="https://habrastorage.org/webt/gj/2z/sv/gj2zsvokw6ajdykiypksss3hyc8.png" alt="imagen"><br><br>  La clave del primer bloque result√≥ as√≠: <br>  [85, 80, 82, 81] <br><br>  Y el segundo bloque, as√≠: <br>  [86, 81, 83, 82] <br><br>  Dado que cada clave posterior se genera din√°micamente utilizando la clave anterior (clave = key_transformator.transform (clave), entend√≠ el algoritmo: agregue uno a cada byte en la clave anterior: <br>  85 -&gt; 86 <br>  80 -&gt; 81 <br>  82 -&gt; 83 <br>  81 -&gt; 82 <br><br>  Y luego me di cuenta de que el nombre del desaf√≠o ocultaba una pista enfermiza. <br><br>  Escrib√≠ dos "funciones de ayuda": <br><br>  ‚Ä¢ "nextKey", que restaura la siguiente clave en funci√≥n de la √∫ltima <br>  ‚Ä¢ "nextChar", que restaura la siguiente letra, y en la mayor√≠a de los casos simplemente aumenta en uno si cae dentro de los l√≠mites de bytes (255) <br><br><img src="https://habrastorage.org/webt/iy/m0/ny/iym0nyw_8a8mbqtgfu3iom3zdi4.png" alt="imagen"><br><br>  Convert√≠ los 4 bytes originales [85, 80 82, 81] en letras: ‚ÄúUPRQ‚Äù y ejecut√© el algoritmo nuevamente <br><br><img src="https://habrastorage.org/webt/xc/4x/pf/xc4xpfo8bv7c6dx_lmy2lxxxnxm.png" alt="imagen"><br><br>  La bandera se especific√≥ en el archivo descifrado: <br><br><img src="https://habrastorage.org/webt/pu/ke/ea/pukeea0_x7zo2mc3jyv_hipjihc.png" alt="imagen"><br><br>  <u><b>Desaf√≠o: el regreso de los robots</b></u> <u><br></u> <br><br>  Descripci√≥n: <br><br>  <i>Los robots son geniales, pero cr√©anme: ¬°su acceso debe ser limitado!</i>  Compru√©balo (enlace) <br><br>  Despu√©s de seguir el enlace, ver√° una determinada p√°gina dedicada a los robots.  B√°sicamente, todo sugiere que debe verificar la presencia del archivo "robots.txt". <br><br><img src="https://habrastorage.org/webt/i3/85/gp/i385gpm2k1shd1zjods7ellwhxs.png" alt="imagen"><br><br>  Al agregar ./robots.txt a la url obtenemos lo siguiente: <br><br><img src="https://habrastorage.org/webt/ic/fs/qg/icfsqglz7pm83jpqhnyuibevqwm.png" alt="imagen"><br><br>  Revis√© ./secret_login.html y encontr√© una p√°gina de registro <br><br><img src="https://habrastorage.org/webt/_r/uw/uq/_ruwuq-tramkokydryvhliq6fks.png" alt="imagen"><br><br>  Luego, verifiqu√© el c√≥digo fuente del formulario para encontrar la confirmaci√≥n de contrase√±a y vi este Javascript: <br><br><img src="https://habrastorage.org/webt/y1/na/pe/y1napezb5awnipexnz9pudxulbm.png" alt="imagen"><br><br>  Parece que cuando se confirma el valor, se env√≠a a la funci√≥n de autorizaci√≥n, que decodifica el valor pasado utilizando la funci√≥n btoa (funci√≥n de decodificaci√≥n base64 en Javascript) y luego lo compara con la cadena: "SzMzcFQjM1IwYjB0JDB1dA ==". <br><br>  Decodifiqu√© esta l√≠nea <br><br><img src="https://habrastorage.org/webt/ho/hx/w4/hohxw4qi3wre5-6rasvxo6csv7w.png" alt="imagen"><br><br>  Insert√© el valor resultante en la cadena de contrase√±a.  Bingo! <br><br><img src="https://habrastorage.org/webt/qe/jg/n3/qejgn31fh6jrxc-7yh7sy2g3vfk.png" alt="imagen"><br><br><br>  <b><u>Desaf√≠o: Galer√≠a Diego</u></b> <b><br></b> <br>  Descripci√≥n: <br><br>  <i>Recientemente comenc√© a desarrollar una plataforma para administrar las fotos de mi gato y asegurar mi flag.txt.</i>  <i>Por favor revise mi sistema (enlace al formulario de registro).</i> <i><br><br></i>  <i>Para evitar jambas en el sistema de seguridad, como la capacidad de incrustar c√≥digo SQL, se me ocurri√≥ mi propio esquema.</i> <i><br><br></i>  <i>Su breve descripci√≥n est√° disponible aqu√≠ (enlace al diagrama)</i> <br><br>  Formulario de registro: <br><br><img src="https://habrastorage.org/webt/5d/ml/5k/5dml5k0tqhbpkpcffcuvcir2zgq.png" alt="imagen"><br><br>  Circuito preestablecido: <br><br><img src="https://habrastorage.org/webt/jb/wa/jh/jbwajhtbh7rxeqwchqs4-zguhgg.png" alt="imagen"><br><br>  Despu√©s de configurar el nombre de usuario y la contrase√±a de prueba, obtuve acceso a la galer√≠a p√∫blica del gato "Diego". <br><br>  Desde que me registr√© como usuario habitual, pens√© que tal vez necesito encontrar una forma de escalar los privilegios de PE (escalada de privilegios).  Al examinar el esquema para usuarios registrados, vi que la diferencia entre el usuario normal y el administrador est√° en la tercera secci√≥n del esquema, separada por tres guiones. <br><br>  Habiendo estimado que si el primer valor (nombre de usuario) se refiere a la primera secci√≥n, y el segundo (contrase√±a) se refiere a la segunda, el sistema asigna el rol inmediatamente despu√©s de que ingrese el usuario con los derechos actuales. <br><br>  Por ejemplo: <br><br>  START ||| Primer valor ||| Segundo valor ||| usuario (Agregado por el servicio web) ||| END <br><br>  Mi carga √∫til fue la siguiente: <br><br>  ‚Ä¢ Primer valor: "niki ||| niki ||| admin ||| END \ nSTART ||| otro" <br>  ‚Ä¢ Segundo valor: "otro" <br><br>  Esto probablemente gener√≥ las siguientes l√≠neas de registro: <br><br>  START ||| niki ||| niki ||| admin ||| END <br>  START ||| otro ||| otro ||| usuario ||| FIN <br><br>  Despu√©s de eso, pude iniciar sesi√≥n como administrador y obtener todos los derechos: <br><br><img src="https://habrastorage.org/webt/p0/1v/0h/p01v0hcr31jqfel7olalnnvyzxa.png" alt="imagen"><br><br>  Al presionar los botones solo se activa una advertencia de que la bandera es segura. <br>  Sin embargo, dentro de la URL puedes leer: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php</a> ?  view = log.txt <br><br>  Que alude muy expl√≠citamente a <i>LFI (Inclusi√≥n de archivos locales) a trav√©s de URL</i> <br><br>  Lo intent√©: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">35.194.63.219/csa_2018/diegos_gallery/_nwryqcttstvs/admin-panel/index.php?view=flag.txt</a> <br><br>  Y la bandera era m√≠a. <br><br><img src="https://habrastorage.org/webt/js/ux/bj/jsuxbjcvsikvpgglmeesevd9iey.png" alt="imagen"><br><br>  <b><u>Desaf√≠o: pasos cuidadosos</u></b> <b><br></b> <br>  Descripci√≥n: <br><br>  <i>Este (enlace de archivo) es un mont√≥n de archivos que encontramos.</i>  <i>Estamos seguros de que la bandera secreta est√° oculta en alg√∫n lugar dentro de ellos.</i> <i><br></i>  <i>Estamos absolutamente seguros de que los datos que buscamos est√°n ocultos en la secci√≥n de comentarios de cada archivo.</i> <i><br></i>  <i>¬øPodr√≠as ir cuidadosamente entre los archivos y encontrar la bandera?</i> <i><br></i>  <i>Buena suerte</i> <br><br>  Despu√©s de extraer el archivo, obtienes un directorio llamado "archivos" con dos mil archivos dentro, titulado "descomprimir. [N√∫mero]". <br><br><img src="https://habrastorage.org/webt/cu/08/gu/cu08guzhfz3ce9eypciwpsuz7so.png" alt="imagen"><br><br>  Utilic√© el programa binwalk para verificar el primer archivo.  Y esto es lo que me dio el programa: <br><br><img src="https://habrastorage.org/webt/dg/t5/je/dgt5je6znvxzcslet4awihbmyy8.png" alt="imagen"><br><br>  S√≠, en la secci√≥n de comentarios tenemos letras y n√∫meros.  Consejos de nuevo? <br><br>  Al principio pens√© si deber√≠a conectar las letras con los √≠ndices dados de este archivo zip y verificar el siguiente archivo con el √≠ndice 245. <br><br>  Pero aqu√≠ lleg√≥ una sorpresa: el segundo archivo no estaba en formato zip, sino en formato rar. <br><br><img src="https://habrastorage.org/webt/am/fn/wo/amfnwo5q-st0m2qqqmdb1fqw51s.png" alt="imagen"><br><br>  Por lo tanto, tuve que "anrarn" para poder acceder a los comentarios: <br><br><img src="https://habrastorage.org/webt/1a/sn/ew/1asnewamm2r4kv-ells856jizqg.png" alt="imagen"><br><br>  Mi l√≥gica era ejecutar el archivo a trav√©s de binwalk, y si me encontraba con un RAR, descomprimirlo para obtener los comentarios.  De lo contrario, vea directamente la secci√≥n de comentarios para comprender otras acciones. <br><br>  Mi primera suposici√≥n: el n√∫mero es el √≠ndice del archivo (cada uno estaba numerado del 0 al 1999).  Sin embargo, descubr√≠ que algunos n√∫meros son negativos, lo que significa que no pueden ser un √≠ndice. <br><br>  Segunda suposici√≥n: el n√∫mero es un salto, que bien puede ser negativo.  Para cada n√∫mero, necesitaba un salto al siguiente archivo.  Sab√≠a que si mi c√≥digo salta constantemente al siguiente archivo calculado, esto puede crear una peque√±a trampa en forma de ciclo y mi c√≥digo se atascar√° en un bucle sin fin.  Entonces escrib√≠ un c√≥digo de Python con un l√≠mite de cuenta.  Y despu√©s de varias pruebas, descubr√≠ que el n√∫mero 120 ser√≠a suficiente: <br><br><img src="https://habrastorage.org/webt/i6/wp/r6/i6wpr6fkyddpaiqpj5mcqak1two.png" alt="imagen"><br><br>  Y la bandera era m√≠a: <br><br><img src="https://habrastorage.org/webt/az/kb/xl/azkbxlwld_iazfgfbzb9sy9zcco.png" alt="imagen"><br><br>  Los otros tres que describ√≠ en la siguiente publicaci√≥n, lean, prueben, me complacer√°n sus comentarios </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es429112/">https://habr.com/ru/post/es429112/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es429102/index.html">Venta de veh√≠culos el√©ctricos en Canad√°</a></li>
<li><a href="../es429104/index.html">Datos altos</a></li>
<li><a href="../es429106/index.html">CIS para infraestructura</a></li>
<li><a href="../es429108/index.html">Google: la eliminaci√≥n de enlaces "pirateados" de la emisi√≥n no resolver√° el problema del contenido ilegal</a></li>
<li><a href="../es429110/index.html">Consejos CSS que es poco probable que encuentres en tutoriales</a></li>
<li><a href="../es429114/index.html">C√≥mo pasar una prueba cibern√©tica en Checkpoint Parte 2</a></li>
<li><a href="../es429116/index.html">Crea im√°genes receptivas</a></li>
<li><a href="../es429118/index.html">Analista de aeropuerto</a></li>
<li><a href="../es429120/index.html">Desafiadores Java # 3: Polimorfismo y Herencia</a></li>
<li><a href="../es429122/index.html">El futuro cercano de NetApp</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>