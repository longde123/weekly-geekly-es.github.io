<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òÄÔ∏è ü¶Ö üéã composer vs npm: pengembangan multi-modul ‚ô®Ô∏è üåí ‚ö°Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam tiga atau empat tahun terakhir, ketika pemrograman dalam PHP, saya menggunakan composer untuk mengelola dependensi aplikasi. Sekarang ada kebutu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>composer vs npm: pengembangan multi-modul</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458018/"><p> Dalam tiga atau empat tahun terakhir, ketika pemrograman dalam PHP, saya menggunakan <code>composer</code> untuk mengelola dependensi aplikasi.  Sekarang ada kebutuhan untuk beralih ke <code>nodejs</code> dan, sebagai hasilnya, mengkonfigurasi lingkungan pengembangan yang sudah dikenal.  Untungnya, saya menggunakan PhpStorm IDE, yang memungkinkan Anda bekerja dengan PHP dan JS.  Fitur dari proyek di mana saya berpartisipasi adalah multi-modularitas.  Fungsionalitas dibagi di antara modul-modul yang tidak begitu banyak digunakan kembali untuk mengurangi kompleksitas akhir aplikasi karena penguraian menjadi komponen yang digabungkan secara longgar.  Secara umum, adalah normal untuk proyek-proyek ini ketika, dalam kerangka penyelesaian satu masalah, perubahan dilakukan pada beberapa modul dan berkomitmen untuk beberapa repositori. </p><br><p><img src="https://habrastorage.org/webt/m4/iq/rl/m4iqrli786zgy9s0gnx0rigfuvy.png" alt="gambar"></p><br><p>  Ketika mengatur proyek <code>nodejs</code> , saya menemukan beberapa fitur yang menyulitkan pengembangan multi-modul.  Publikasi ini lahir dalam proses mencoba menangani fitur-fitur ini.  Di bawah potongan, tampilan PHP pada penggelaran proyek <code>nodejs</code> . </p><a name="habracut"></a><br><h1 id="struktura-demo-proekta">  Struktur Proyek Demo </h1><br><p>  Proyek ini terdiri dari 3 modul: </p><br><ul><li>  <strong>aplikasi</strong> : modul kepala yang menghubungkan dependensi; </li><li>  <strong>modul fungsional</strong> : berisi fungsi-fungsi yang dipanggil dari modul kepala; </li><li>  <strong>modul dasar</strong> : berisi fungsi-fungsi yang dipanggil dari modul fungsi; </li></ul><br><p><img src="https://habrastorage.org/webt/qk/st/tt/qkstttimj9wzdf_vrzsofd0katu.png" alt="gambar"></p><br><p>  Kode untuk setiap modul terletak di github: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">habr-cvsn-app</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">habr-cvsn-mod-func</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">habr-cvsn-mod-base</a> </li></ul><br><p>  Deskriptor modul untuk masing-masing manajer dependensi ( <code>composer.json</code> dan <code>package.json</code> ) terletak di setiap modul, yaitu, setiap modul dapat diperluas baik sebagai modul php maupun sebagai modul js.  Kode PHP dan kode JS dalam modul hanya ditempatkan berdampingan, tanpa saling berpotongan. </p><br><p>  Menjalankan aplikasi untuk dieksekusi: </p><br><pre> <code class="plaintext hljs">$ php index.php $ nodejs index.js</code> </pre> <br><p>  Hasil kerja dalam kedua kasus: </p><br><pre> <code class="plaintext hljs">This is application. This is func module. This is base module.</code> </pre> <br><h1 id="celi">  Tujuan </h1><br><p>  Sebuah proyek di lingkungan kerja harus memungkinkan: </p><br><ul><li>  melacak perubahan IDE di setiap modul yang terlibat dalam pengembangan; </li><li>  Menggunakan IDE, lakukan perubahan pada repositori berbeda dalam satu tindakan. </li><li>  Gunakan debugger untuk melacak eksekusi kode modul; </li></ul><br><h1 id="razvyortyvanie-cherez-composer">  Penempatan melalui <code>composer</code> </h1><br><p>  Semuanya akrab di sini.  Dalam deskriptor penyebaran ( <a href="">composer.json</a> ) dari aplikasi, tentukan alamat repositori dengan modul dan tentukan cabang-cabang utama dari modul sebagai dependensi dengan versi yang diinginkan: </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"require"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"flancer64/habr-cvsn-mod-base"</span></span>: <span class="hljs-string"><span class="hljs-string">"dev-master as 0.1.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"flancer64/habr-cvsn-mod-func"</span></span>: <span class="hljs-string"><span class="hljs-string">"dev-master as 0.1.0"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"repositories"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"vcs"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://github.com/flancer64/habr-cvsn-mod-base"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"vcs"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"https://github.com/flancer64/habr-cvsn-mod-func"</span></span> } ] }</code> </pre> <br><p>  Setelah menjalankan perintah: </p><br><pre> <code class="plaintext hljs">$ composer install</code> </pre> <br><p>  <code>./vendor</code> dengan modul muncul di direktori <code>./vendor</code> , yang pada gilirannya berisi direktori <code>.git</code> : </p><br><ul><li> <code>./vendor/</code> <br> <ul><li> <code>./flancer64/</code> <br> <ul><li> <code>./habr-cvsn-mod-base/</code> <br> <ul><li> <code>./.git/</code> </li> </ul></li><li> <code>./habr-cvsn-mod-base/</code> <br> <ul><li> <code>./.git/</code> </li> </ul></li></ul></li></ul></li></ul><br><p>  Artinya, <code>composer</code> segera menyebarkan dependensi dalam bentuk yang sesuai untuk pengembangan (kontrol versi).  Tetap hanya untuk mengkonfigurasi IDE PhpStorm (meletakkan modul tergantung di bawah kontrol versi): </p><br><p><img src="https://habrastorage.org/webt/tp/xi/ct/tpxictvxsbyzv4fccdvsjpnma4u.png" alt="gambar"></p><br><p>  dan Anda dapat melacak perubahan di semua modul yang dikembangkan: </p><br><p><img src="https://habrastorage.org/webt/ej/xj/t0/ejxjt0f798ouz2pjv1yaobrf__s.png" alt="gambar"></p><br><p>  dan komit semua perubahan pada repositori lokal secara bersamaan: </p><br><p><img src="https://habrastorage.org/webt/ik/ur/h6/ikurh6ivwrjznbaammtzstlynom.png" alt="gambar"></p><br><p>  dan dorong ke remote: </p><br><p><img src="https://habrastorage.org/webt/fe/0w/ye/fe0wyew4cjslo0i-e8ov20r1hi4.png" alt="gambar"></p><br><p>  Debugging juga tidak masalah.  Kita dapat mengatur breakpoint pada setiap baris kode modul dasar - setelah memulai aplikasi di bawah debugger, break terjadi jika perlu: </p><br><p><img src="https://habrastorage.org/webt/-7/m5/as/-7m5asrixo9vxvdmjyeze-soxrw.png" alt="gambar"></p><br><p>  Secara umum, lingkungan yang biasa, senyaman sandal. </p><br><h1 id="obychnoe-razvyortyvanie-cherez-npm">  Penempatan normal hingga npm </h1><br><p>  Tidak seperti <code>composer</code> <code>npm</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tidak menganggap</a> bahwa dalam proyek modul apa pun dari direktori <code>node_modules</code> mungkin di bawah kontrol versi.  Kita dapat menentukan dalam deployment descriptor <a href="">package.json</a> bahwa modul harus diambil dari repositori eksternal (misalnya, dari githib): </p><br><pre> <code class="plaintext hljs">{ "dependencies": { "habr-cvsn-mod-base": "github:flancer64/habr-cvsn-mod-base", "habr-cvsn-mod-func": "github:flancer64/habr-cvsn-mod-func" } }</code> </pre> <br><p>  tetapi kami tidak memiliki opsi untuk meminta <code>npm</code> membuat repositori lokal untuk modul yang dimuat (subdirektori. <code>.git</code> ). </p><br><p>  Setelah menjalankan perintah: </p><br><pre> <code class="plaintext hljs">$ npm install</code> </pre> <br><p>  dependensi diunduh dan diinstal secara lokal tanpa kemungkinan menggunakan kontrol versi: </p><br><p><img src="https://habrastorage.org/webt/dh/o0/mc/dho0mcrzaxvfmdssn2qohh_8ccc.png" alt="gambar"></p><br><p>  (tidak ada subdirektori <code>./.git/</code> dalam <code>./node_modules/habr-cvsn-mod-base/</code> ) </p><br><p>  Tetapi debugger berhenti di modul dasar tanpa masalah: </p><br><p><img src="https://habrastorage.org/webt/dt/vt/wp/dtvtwpda85xbzw1x_0ichusnlec.png" alt="gambar"></p><br><h1 id="razvyortyvanie-cherez-npm-s-ispolzovaniem-opcii-link">  Sebarkan melalui npm menggunakan opsi tautan </h1><br><p>  Agar modul dari <code>./node_modules/</code> dapat disimpan di bawah kontrol versi, pengembang <code>npm</code> menyarankan menggunakan opsi ' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tautan</a> '.  Singkatnya, inti dari pendekatan ini adalah bahwa modul yang perlu diversi diklon ke tempat sewenang-wenang pada disk pengembang (misalnya, di <code>/home/alex/work/habr/</code> ), dan kemudian ditautkan ke <code>/usr/lib/node_modules/</code> menggunakan perintah: </p><br><pre> <code class="plaintext hljs"># npm link</code> </pre> <br><p>  (Saya membutuhkan hak akses root untuk menjalankan) </p><br><p>  Setelah itu, Anda sudah dapat menggunakan perintah di proyek: </p><br><pre> <code class="plaintext hljs">$ npm link habr-cvsn-mod-base $ npm link habr-cvsn-mod-func</code> </pre> <br><p>  <code>npm</code> akan menemukan modul yang sesuai di <code>/usr/lib/node_modules/</code> dan menutup subdirektori yang sesuai dari proyek <code>./node_modules/</code> : </p><br><pre> <code class="plaintext hljs">$ ls -lh ./node_modules/ total 0 lrwxrwxrwx 1 alex alex 57 j≈´l 2 16:18 habr-cvsn-mod-base -&gt; ../../../../../../usr/lib/node_modules/habr-cvsn-mod-base lrwxrwxrwx 1 alex alex 57 j≈´l 2 16:18 habr-cvsn-mod-func -&gt; ../../../../../../usr/lib/node_modules/habr-cvsn-mod-func</code> </pre> <br><p>  Modul-modul di <code>/usr/lib/node_modules/</code> sendiri, pada gilirannya, adalah tautan ke lokasi asli modul: </p><br><pre> <code class="plaintext hljs">$ ls -lh /usr/lib/node_modules/ ... lrwxrwxrwx 1 root root 39 j≈´l 2 16:18 habr-cvsn-mod-base -&gt; /home/alex/work/habr/habr-cvsn-mod-base lrwxrwxrwx 1 root root 39 j≈´l 2 16:18 habr-cvsn-mod-func -&gt; /home/alex/work/habr/habr-cvsn-mod-func ...</code> </pre> <br><p>  Dan di tempat permanen mereka, "pendaftaran" berisi repositori lokal: </p><br><pre> <code class="plaintext hljs">$ ls -lha /home/alex/work/habr/habr-cvsn-mod-base ... drwxrwxr-x 8 alex alex 4,0K j≈´l 2 16:18 .git ...</code> </pre> <br><p>  Dengan demikian, kita dapat mengkonfigurasi IDE untuk mengontrol perubahan dalam dependensi proyek: </p><br><p><img src="https://habrastorage.org/webt/iq/j6/hg/iqj6hgpdibzci4rq6bjao-kcnvq.png" alt="gambar"></p><br><p>  Masalah dimulai ketika Anda mencoba menjalankan aplikasi: </p><br><pre> <code class="plaintext hljs">$ nodejs index.js internal/modules/cjs/loader.js:670 throw err; ^ Error: Cannot find module 'habr-cvsn-mod-base' at Function.Module._resolveFilename (internal/modules/cjs/loader.js:668:15) at Function.Module._load (internal/modules/cjs/loader.js:591:27) at Module.require (internal/modules/cjs/loader.js:723:19) at require (internal/modules/cjs/helpers.js:14:16) at Object.&lt;anonymous&gt; (/home/alex/work/habr/habr-cvsn-mod-func/src/index.js:3:14) ...</code> </pre> <br><p>  Aplikasi melihat modul fungsional tertaut, tetapi modul fungsional itu sendiri tidak melihat modul dasar tertaut.  Untuk keluar dari situasi, gunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kunci --preserve-symlinks</a> untuk <code>nodejs</code> : </p><br><pre> <code class="plaintext hljs">$ nodejs --preserve-symlinks index.js</code> </pre> <br><p>  Tambahkan kunci ke perintah peluncuran proyek di IDE: </p><br><p><img src="https://habrastorage.org/webt/j6/cn/iq/j6cniq5xukbvipc0u2rlbt9xayi.png" alt="gambar"></p><br><p>  Sekarang peluncurannya berlalu, tetapi ada masalah dengan debugging - break point dalam dependensi tidak berhasil.  Anda bisa berhenti di modul kepala dan turun langkah-langkah ke sumber-sumber ketergantungan, tetapi IDE PhpStorm tidak melihat breakpoint itu sendiri di runtime, meskipun itu menampilkan: </p><br><p><img src="https://habrastorage.org/webt/dy/ss/kh/dysskhjjmhb89kqt7afqgpfzvxg.png" alt="gambar"></p><br><p>  Pengembang IDE <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengatakan</a> bahwa itu harus bekerja, tetapi tidak berfungsi (cache memerah, IDE dihidupkan ulang). </p><br><p>  Secara umum, tujuan publikasi ini adalah untuk mewawancarai kawan-kawan bagaimana mereka keluar dalam situasi yang sama, tetapi dalam proses penulisan artikel, kombinasi lain muncul untuk pengembangan proyek: </p><br><h1 id="razmeschenie-ishodnikov-vo-vnutrennih-katalogah-npm-proekta">  Penempatan kode sumber dalam direktori internal proyek npm </h1><br><p>  Ternyata jika untuk menghubungkan Anda menggunakan klon modul dari github yang dibuat oleh <code>composer</code> di subdirektori <code>./vendor/</code> , alih-alih diikat ke direktori di luar proyek, maka skrip js dijalankan tanpa <code>--preserve-symlinks</code> dan, lebih penting bagi saya, PhpStorm IDE melihat breakpoint di dalam modul.  Karena  tidak masuk akal untuk menggunakan <code>composer</code> hanya untuk kloning modul proyek, saya menggunakan <code>git</code> biasa dan mengkloning kode sumber modul ke subdirektori <code>./own_modules</code> .  Kemudian dia mengulangi manipulasi dari paragraf sebelumnya: </p><br><ul><li>  menghubungkan modul-modul dalam subdirektori <code>./own_modules/...</code> dengan pustaka sistem <code>/usr/lib/node_modules/</code> ; </li><li>  modul yang terhubung di perpustakaan sistem dengan proyek; </li><li>  Mengkonfigurasi PhpStorm IDE agar berfungsi dengan repositori lokal di subdirektori <code>./own_modules/</code> ; </li></ul><br><p><img src="https://habrastorage.org/webt/ki/h2/sl/kih2slporij6mqupqogbki6ehgy.png" alt="gambar"></p><br><p>  Saya tidak tahu apa alasannya, tetapi ketika sumber modul dependen ada di dalam proyek, hasil akhir majelis sangat berbeda dari ketika sumber modul dependen berada di direktori di luar proyek. </p><br><h1 id="rezyume">  Ringkasan </h1><br><p>  Membandingkan dua pendekatan untuk membangun aplikasi multi-modul (PHP dengan <code>composer</code> dan JS dengan <code>npm</code> ), saya dapat menyimpulkan bahwa <code>composer</code> lebih ramah pengembang daripada <code>npm</code> .  Ada kemungkinan bahwa pengembang <code>composer</code> (rilis pertama pada 2012) memperhitungkan pengalaman pengembang <code>npm</code> (rilis pertama pada 2010).  Namun, dengan beberapa upaya tambahan, <code>npm</code> juga memberikan kesempatan untuk mengembangkan aplikasi multi-modul dalam kondisi yang cukup nyaman. </p><br><p>  Script perintah untuk penyebaran proyek dalam berbagai mode: </p><br><ul><li>  <a href="">rebuild_composer.sh</a> </li><li>  <a href="">rebuild_npm_01_regular.sh</a> </li><li>  <a href="">rebuild_npm_02_link_external.sh</a> </li><li>  <a href="">rebuild_npm_03_link_internal.sh</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id458018/">https://habr.com/ru/post/id458018/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id458002/index.html">Apa yang sebenarnya terjadi dengan Boeing Malaysia yang hilang (bagian 1/3)</a></li>
<li><a href="../id458004/index.html">Sistem kontrol lalu lintas pesawat ruang angkasa Soyuz-TM bagian 2</a></li>
<li><a href="../id458006/index.html">Situs tanpa server dinamis di Halaman Github (bagi mereka yang tidak tahu, serverless menggunakan server API pihak ketiga)</a></li>
<li><a href="../id458010/index.html">The Adventures of the Elusive Malvari, Bagian II: Script VBA Rahasia</a></li>
<li><a href="../id458014/index.html">Robot FEDOR - pelatihan dengan kru ISS baru dan tugas luar angkasa pertama</a></li>
<li><a href="../id458020/index.html">Juli Acara IT Digest</a></li>
<li><a href="../id458022/index.html">Sidik jari melalui iklan spanduk? Sekarang ini sudah biasa</a></li>
<li><a href="../id458026/index.html">Perbandingan Format Serialisasi</a></li>
<li><a href="../id458030/index.html">JavaScript Fungsional: lima cara untuk menemukan rata-rata aritmatika elemen array dan metode .reduce ()</a></li>
<li><a href="../id458040/index.html">Dari Moskow ke Tomsk. Kisah satu langkah</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>