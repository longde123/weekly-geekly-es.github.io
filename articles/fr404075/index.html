<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐌 🚠 🐇 Une autre montre avec WiFi. Horloge380 🔩 💘 👩🏿‍🌾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ma version de la montre parfaite. Franchement, je suis fatigué de régler l'horloge. Pour que l'horloge s'ajuste d'elle-même, il est nécessaire d'équip...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Une autre montre avec WiFi. Horloge380</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404075/"><img src="https://habrastorage.org/web/14e/ece/29d/14eece29d8334fd7ad379e67ecfef596.jpg"><br><br>  Ma version de la montre parfaite.  Franchement, je suis fatigué de régler l'horloge.  Pour que l'horloge s'ajuste d'elle-même, il est nécessaire d'équiper au moins un des systèmes permettant d'obtenir le temps: <br><br>  1) GPS <br>  2) DCF77 <br>  3) Ethernet ou WiFi <br>  4) GSM <br>  5) Propre système <br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les avantages et les minutes de chaque système ont déjà été décrits ici.</a> <br><br>  Au début, je voulais faire mon système.  Mais ensuite je me suis installé sur le WiFi.  Il semblerait que le marché devrait être plein d'horloges de bureau / murales avec synchronisation WiFi.  Cependant, je n'ai pas trouvé ce que je voulais.  Peut-être que je regardais mal bien sûr.  J'ai donc décidé de l'assembler moi-même.  Au début, j'ai essayé d'assembler une montre sur le WS2812B, mais je ne l'aimais pas.  Ils sont trop gros.  Au final, j'ai opté pour des LED ordinaires.  Eh bien, bien sûr, en tant que WiFi, j'ai décidé d'utiliser l'ESP8266. <br><br>  En réfléchissant à la conception des futures montres, j'ai décidé de les rendre aussi fines que possible.  Par conséquent, tous les éléments sont sélectionnés avec une hauteur minimale.  Et placé tout d'un côté.  Le plus difficile a été de trouver un ionistor mince et une inductance. <br><br>  En plus des éléments nécessaires à la montre, j'ai ajouté des empreintes pour: <br><br>  1) STM8S003F3U6 (Soudain, quelque chose ne fonctionnera pas avec ESP8266) <br>  2) DS18B20U <br>  3) BMP280 ou BME280 <br><br>  Pour l’avenir, je dirai qu’elles ne m’ont pas été utiles. <br><br>  Après un mois de réflexion, de dessin d'un diagramme et de traçage, j'ai obtenu une telle planche double face, de 140x56 mm.  Et l'épaisseur, avec les éléments, est inférieure à 2 mm.  La taille d'un chiffre est de ~ 25x48 mm. <br><br><img src="https://habrastorage.org/web/5db/208/4c3/5db2084c3fe143e5899aca5cf5f6fb03.png"><br><br><img src="https://habrastorage.org/web/11f/42f/521/11f42f5216da435381c20845f80b703f.png"><br><br>  Bien sûr, j'ai commandé des circuits imprimés et du matériel en Chine.  J'ai dû prendre une partie de la configuration avec des modules, car cela s'est avéré moins cher.  Ces modules donneurs sont ESP-09 et GY-302: <br><br><img src="https://habrastorage.org/web/d38/fcc/d3a/d38fccd3ae3f46fa8bc8d517b1b9da6f.png"><img src="https://habrastorage.org/web/83c/67c/d10/83c67cd10c5b4ebfabb12d3894b12d6e.png"><br><br>  Les LED sont contrôlées par un contrôleur PWM 16 canaux PCA9685BS avec interface I2C et transistors à effet de champ BSS138.  En général, les microcircuits de la montre sont spécialement sélectionnés avec I2C, pour simplifier le traçage et le contrôle. <br><br>  Après un mois, les planches elles-mêmes ont été resserrées, puis quelques semaines plus tard, le reste du paquet.  Les frais étaient couverts d'or d'immersion gratuitement. <br><br><img src="https://habrastorage.org/web/e46/aa3/00e/e46aa300e8aa40e1bf2dc67482d5079c.png"><br><br>  Après avoir reçu tout l'équipement, j'ai commencé à monter la carte.  Appliquez la pâte à souder sur la carte pendant très peu de temps, environ une heure, à l'aide d'un distributeur. <br><br><img src="https://habrastorage.org/web/1f4/270/973/1f4270973331488f86a3bfb21cddf8ab.png"><br><br>  Mais il m'a fallu environ 5 heures pour ranger les éléments, mais seulement les LED de taille 0603 sur la planche de 380 pièces. <br><br><img src="https://habrastorage.org/web/bd2/aa9/b72/bd2aa9b728c747c89a2fd24e1454932d.png"><br><br>  Après avoir disposé presque tous les éléments, nous envoyons la planche au poêle infrarouge.  J'ai celui-ci: <br><br><img src="https://habrastorage.org/web/1a4/1db/ac0/1a41dbac06a94655ae8027b482719df5.png"><br><br>  Après avoir fondu dans le poêle, il est nécessaire de corriger les défauts et de souder manuellement l'ionistor.  Et enfin, la carte après l'installation. <br><br><img src="https://habrastorage.org/web/001/ab7/e98/001ab7e985c04305a5a5cb5aa10037fa.png"><br><br>  Pour programmer l'ESP8266, j'ai décidé d'utiliser l'environnement Arduino.  Parce que c'est le démarrage le plus simple et le plus rapide pour l'ESP8266, et c'est juste une montre entière, pas un contrôle de protection dans une centrale nucléaire. <br><br>  Après quelques jours d'écriture de code et de correction d'erreurs d'installation, j'ai pu le faire afficher l'heure et me synchroniser avec le serveur NTP via WiFi.  La synchronisation avec NTP a lieu toutes les 5 heures.  Le reste du temps, le WiFi est désactivé pour réduire la consommation. <br><br><img src="https://habrastorage.org/web/b1e/7d7/97b/b1e7d797b2c448269299222f03cf697d.png"><br><br>  Il y a 4 boutons tactiles à l'arrière de la carte, et sur la carte elle-même est un contrôleur MPR121.  Cependant, la bibliothèque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/adafruit/Adafruit_MPR121</a> pour Arduino ne fonctionne pas sur ESP8266.  La raison de son inopérabilité est probablement très simple, mais honnêtement, je vais vous dire que nous n'avons pas le temps d'étudier ce problème. <br><br>  La planche a fonctionné sans échec chez moi pendant environ un mois, alors que je pensais à la conception finale, mais cela ne m'est venu à l'esprit que de simplement coller la planche au verre.  Ce que j'ai fait. <br><br><div class="spoiler">  <b class="spoiler_title">Les photos</b> <div class="spoiler_text"><img src="https://habrastorage.org/web/ab6/6d0/2fe/ab66d02fed7742709743bd224c7224b0.jpg"><br><br><img src="https://habrastorage.org/web/98f/154/d30/98f154d302954e32a0d269c4212505e2.jpg"><br><br><img src="https://habrastorage.org/web/26d/252/dfa/26d252dfa1e047b6bf3c8d68be425469.jpg"><br><br><img src="https://habrastorage.org/web/c97/459/5bb/c974595bbe3d46ac83e905416a6d84ba.jpg"><br><br><img src="https://habrastorage.org/web/517/685/59f/51768559fe824906b53cdbdb2ba5941b.jpg"><br><br><img src="https://habrastorage.org/web/d4f/c7b/61e/d4fc7b61e9994b67b381084a36d3ef37.jpg"><br><br><img src="https://habrastorage.org/web/ca2/70e/512/ca270e512055419a9f1756cce5080328.jpg"><br><br><img src="https://habrastorage.org/web/b76/deb/295/b76deb295e564956934c683ae2f30f21.jpg"><br><br><img src="https://habrastorage.org/web/d6d/75b/acc/d6d75bacc00443a684da973a67b873b9.jpg"><br><br><img src="https://habrastorage.org/web/014/56a/011/01456a011f324372ab42b7dce566a688.jpg"><br></div></div><br>  Plans futurs si cela: <br><br>  1) Améliorez le firmware; <br>  a.  effectuer des réglages via l'interface Web; <br>  b.  effectuer la mise à jour du firmware via l'interface Web; <br>  2) Traitez les boutons tactiles. <br><br>  Les fichiers source sont ici: <br><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/denruss/clock380</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/denruss/clock380_sketch</a> <br><br>  Vous pouvez commander un PCB à partir du lien: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">www.pcbway.com/project/shareproject/clock380.html</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr404075/">https://habr.com/ru/post/fr404075/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr404063/index.html">Test d'oncologie salivaire: un peu d'histoire et de Salitest</a></li>
<li><a href="../fr404067/index.html">Le MIT a développé des vêtements et des chaussures «respirants» pour le sport</a></li>
<li><a href="../fr404069/index.html">Vaisseau spatial du futur: vue du concepteur général</a></li>
<li><a href="../fr404071/index.html">Pièce de rechange pour lunettes enfants Fisher Price</a></li>
<li><a href="../fr404073/index.html">Processeur Intel 8008 - que contient-il?</a></li>
<li><a href="../fr404077/index.html">La neurophysiologie de la perception musicale: quelques mots sur "l'orgasme" musical</a></li>
<li><a href="../fr404079/index.html">Modèle de présentation de l'application mobile Axure</a></li>
<li><a href="../fr404081/index.html">«De l'air sans saleté»: comment faire une radio «propre»</a></li>
<li><a href="../fr404083/index.html">À la mort du mythe du rat taupe nu: mais quand même, il vieillit</a></li>
<li><a href="../fr404085/index.html">Musique, navigation, écrans de projection - Développement multimédia automobile</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>