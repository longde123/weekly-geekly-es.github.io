<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🎨 🥥 👨🏾‍🎓 Pavel 2.0: consultant reptiloid sur JS, node.js avec sockets et téléphonie 👩‍👩‍👧‍👦 ⚖️ 👨🏻‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Notre INTERCOM'18 s'est donc éteint, avec des préférences et des analyses de rentabilité. Comme d'habitude, l'entrée à la conférence était payante: ce...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pavel 2.0: consultant reptiloid sur JS, node.js avec sockets et téléphonie</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/Voximplant/blog/426417/">  Notre INTERCOM'18 s'est donc éteint, avec des préférences et des analyses de rentabilité.  Comme d'habitude, l'entrée à la conférence était payante: ceux qui le souhaitaient pouvaient acheter des billets pour TimePad au prix fort, ou ... bénéficiez d'une remise auprès d'un consultant reptilien <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">directement sur le site</a> .  L'année dernière, cela a fonctionné comme un rappel familier: vous laissez le téléphone sous une forme spéciale, Pavel vous appelle dans une minute et pose des questions;  plus les réponses sont correctes, plus la remise est élevée.  Cette fois, nous avons décidé de changer la mécanique, ce qui la rendait plus difficile à la fois techniquement et en termes de problèmes.  Sous la coupe - les boyaux Pavlik 2.0, avec le nœud actuel et les sockets Web, n'oubliez pas de porter une combinaison avant l'ouverture. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9s/ar/48/9sar48meb2azvgldnfztbcmdw1e.jpeg"></div><a name="habracut"></a><br><h3>  Mécanique du concours </h3><br>  Vous visitez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">intercomconf.com à</a> partir d'un navigateur de bureau, dans le coin inférieur droit Pavlik se "réveille" sous la forme d'un chat et propose de jouer au jeu.  Entrez le numéro, cliquez sur «Voici mon numéro» - après cela, Pavel lève une session entre votre navigateur et notre backend. <br><br><img src="https://habrastorage.org/webt/lp/gd/bm/lpgdbmqdl91pn2pt9qvnu4brqf8.png" width="600"><br><br>  Si tout s'est bien passé et que votre numéro n'a pas encore participé au tirage, alors Paul proposera d'appeler le 8-800.  Ici, le cloud Voximplant entre et le quiz commence: <br><br><img src="https://habrastorage.org/webt/td/2n/vx/td2nvx8ax2rkugrmsofg2kgrrqy.jpeg" width="600"><br>  <i>Réponse: délai / délai.</i>  <i>Basé sur le meme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">C'est très bien</a> .</i> <br><br>  Oui, les puzzles étaient quelque chose comme ça.  Trois tentatives ont été faites pour chaque question: au début, il y avait une image «complexe», puis c'était plus simple et à la fin la plus simple.  Les premières tentatives ont donné le plus de points;  après 5 énigmes, Pavel a compté des points et a donné un billet gratuit ou une remise de 10% à 30%. <br><br>  En même temps, notre reptiloïde est assez intelligent: il a émis des messages d'erreur (si vous avez entré le numéro de téléphone de manière incorrecte, par exemple), a déterminé que le numéro avait déjà participé au dessin («Je vois un numéro familier sur l'écran de mon mobile inexistant. Une tentative dans une main - ce sont les règles. ") Et, plus important encore, corrélait le navigateur et le cloud.  Comment cette audacieuse IVR a-t-elle fonctionné? <br><br><h3>  Dans les mâchoires <del>  la folie </del>  reptiloid </h3><br><img src="https://habrastorage.org/webt/lm/jn/oy/lmjnoyfsqwhbzy31_u-3_zcx6-a.jpeg" width="600"><br>  <i>Réponse: centre d'appels.</i>  <i>Dit Nuff.</i> <br><br>  Pour mettre les choses au sec, Paul 2.0 est un RVI fonctionnant dans notre cloud.  Par conséquent, toute la logique reptiloïde doit être énoncée dans un script JS, non?  Oui, mais non. <br><br>  La deuxième version de Pavel est synchronisée avec le navigateur du client: sur le site Pavel affiche les rébus, et sur le téléphone entend vos réponses, en fonction des changements de photos et du résultat affiché.  À première vue, cette interaction pourrait être mise en œuvre à l'aide de notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://voximplant.com/docs/references/">API HTTP</a> : <br><br><ul><li>  tout d'abord, le navigateur exécuterait le script à l'aide de la méthode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://voximplant.com/docs/references/">StartScenarios</a> .  Dans la réponse, la méthode renvoie les paramètres <b>media_session_access_url</b> et <b>media_session_access_secure_url</b> qui <b>contiennent respectivement les</b> URL pour HTTP et HTTPS; </li><li>  on pourrait communiquer avec le script en cours en utilisant les URL reçues; </li><li>  le script indiquerait au navigateur les images à utiliser et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://voximplant.com/docs/references/voxengine/net&amp;usg=ALkJrhgk3usM-Jwv6yNaNJxSZ03Py_j2QA#">mettrait à</a> jour le score à l'aide de la méthode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://voximplant.com/docs/references/voxengine/net&amp;usg=ALkJrhgk3usM-Jwv6yNaNJxSZ03Py_j2QA#">httpRequestAsync</a> . </li></ul><br>  Mais comment «attraper» un navigateur personnalisé?  En effet, dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://voximplant.com/docs/references/voxengine/net&amp;usg=ALkJrhgk3usM-Jwv6yNaNJxSZ03Py_j2QA#">httpRequestAsync,</a> vous devez passer une URL unique.  Et oui, les photos - elles doivent également être stockées quelque part. <br><br>  Par conséquent, en plus du script cloud JS, nous avons utilisé notre backend sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">express.js</a> associé à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">socket.io</a> : lorsque le visiteur a entré le numéro, le navigateur a donné ce numéro au backend via http, après quoi la session http s'est transformée en une session sur les sockets web.  En conséquence, le script communiquait constamment avec le backend via http, et déjà le backend utilisait des sockets web pour lancer rapidement des images et des points calculés dans le navigateur. <br><br><div class="spoiler">  <b class="spoiler_title">Du côté des sockets web, le backend ressemblait à ceci:</b> <div class="spoiler_text"><div class="oembed"><script type="text/javascript" src="https://gist.github.com/b999c84579e25069c7ad853dea5a8c8b.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist92463804" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-pavel-backend-js" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-pavel-backend-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-pavel-backend-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-s">'use strict'</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-pavel-backend-js-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-s1">express</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'express'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-pavel-backend-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-s1">request</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'request'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-pavel-backend-js-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-s1">low</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'lowdb'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-pavel-backend-js-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-k">const</span> <span class="pl-v">FileSync</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'lowdb/adapters/FileSync'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-pavel-backend-js-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-pavel-backend-js-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> <span class="pl-s1">app</span> <span class="pl-c1">=</span> <span class="pl-s1">express</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-pavel-backend-js-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> <span class="pl-s1">http</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'http'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-pavel-backend-js-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> <span class="pl-s1">server</span> <span class="pl-c1">=</span> <span class="pl-s1">http</span><span class="pl-kos">.</span><span class="pl-en">createServer</span><span class="pl-kos">(</span><span class="pl-s1">app</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-pavel-backend-js-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> <span class="pl-s1">io</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'socket.io'</span><span class="pl-kos">)</span><span class="pl-kos">(</span><span class="pl-s1">http</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">listen</span><span class="pl-kos">(</span><span class="pl-s1">server</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-pavel-backend-js-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> <span class="pl-s1">session</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'express-session'</span><span class="pl-kos">)</span><span class="pl-kos">(</span><span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-pavel-backend-js-LC12" class="blob-code blob-code-inner js-file-line">  <span class="pl-c1">secret</span>: <span class="pl-s">'secret'</span><span class="pl-kos">,</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-pavel-backend-js-LC13" class="blob-code blob-code-inner js-file-line">  <span class="pl-c1">resave</span>: <span class="pl-c1">true</span><span class="pl-kos">,</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-pavel-backend-js-LC14" class="blob-code blob-code-inner js-file-line">  <span class="pl-c1">saveUninitialized</span>: <span class="pl-c1">true</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-pavel-backend-js-LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-pavel-backend-js-LC16" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> <span class="pl-s1">sharedsession</span> <span class="pl-c1">=</span> <span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">'express-socket.io-session'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-pavel-backend-js-LC17" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-pavel-backend-js-LC18" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> <span class="pl-s1">sockets</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span><span class="pl-kos">}</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-pavel-backend-js-LC19" class="blob-code blob-code-inner js-file-line"><span class="pl-k">var</span> <span class="pl-c1">PORT</span> <span class="pl-c1">=</span> <span class="pl-s1">process</span><span class="pl-kos">.</span><span class="pl-c1">env</span><span class="pl-kos">.</span><span class="pl-c1">PORT</span> <span class="pl-c1">||</span> <span class="pl-c1">3001</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-pavel-backend-js-LC20" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-pavel-backend-js-LC21" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">app</span><span class="pl-kos">.</span><span class="pl-en">use</span><span class="pl-kos">(</span><span class="pl-s1">session</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-pavel-backend-js-LC22" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-pavel-backend-js-LC23" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">io</span><span class="pl-kos">.</span><span class="pl-en">use</span><span class="pl-kos">(</span><span class="pl-s1">sharedsession</span><span class="pl-kos">(</span><span class="pl-s1">session</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-pavel-backend-js-LC24" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-pavel-backend-js-LC25" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">io</span><span class="pl-kos">.</span><span class="pl-en">on</span><span class="pl-kos">(</span><span class="pl-s">'connection'</span><span class="pl-kos">,</span> <span class="pl-k">function</span> <span class="pl-kos">(</span><span class="pl-s1">socket</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-pavel-backend-js-LC26" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">socket</span><span class="pl-kos">[</span><span class="pl-s1">socket</span><span class="pl-kos">.</span><span class="pl-c1">handshake</span><span class="pl-kos">.</span><span class="pl-c1">session</span><span class="pl-kos">.</span><span class="pl-c1">caller_id</span><span class="pl-kos">]</span> <span class="pl-c1">===</span> undefined <span class="pl-c1">&amp;&amp;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-pavel-backend-js-LC27" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">socket</span><span class="pl-kos">.</span><span class="pl-c1">handshake</span><span class="pl-kos">.</span><span class="pl-c1">session</span><span class="pl-kos">.</span><span class="pl-c1">caller_id</span> !== undefined<span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-pavel-backend-js-LC28" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">sockets</span><span class="pl-kos">[</span><span class="pl-s1">socket</span><span class="pl-kos">.</span><span class="pl-c1">handshake</span><span class="pl-kos">.</span><span class="pl-c1">session</span><span class="pl-kos">.</span><span class="pl-c1">caller_id</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-s1">socket</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-pavel-backend-js-LC29" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-pavel-backend-js-LC30" class="blob-code blob-code-inner js-file-line"><span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-pavel-backend-js-LC31" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-pavel-backend-js-LC32" class="blob-code blob-code-inner js-file-line"><span class="pl-s1">app</span><span class="pl-kos">.</span><span class="pl-en">use</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-s1">req</span><span class="pl-kos">,</span> <span class="pl-s1">res</span><span class="pl-kos">,</span> <span class="pl-s1">next</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-pavel-backend-js-LC33" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">let</span> <span class="pl-s1">allowedOrigins</span> <span class="pl-c1">=</span> <span class="pl-kos">[</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-pavel-backend-js-LC34" class="blob-code blob-code-inner js-file-line">    <span class="pl-c">// allowed hosts</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-pavel-backend-js-LC35" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">]</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-pavel-backend-js-LC36" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">let</span> <span class="pl-s1">origin</span> <span class="pl-c1">=</span> <span class="pl-s1">req</span><span class="pl-kos">.</span><span class="pl-c1">headers</span><span class="pl-kos">.</span><span class="pl-c1">origin</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-pavel-backend-js-LC37" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">allowedOrigins</span><span class="pl-kos">.</span><span class="pl-en">indexOf</span><span class="pl-kos">(</span><span class="pl-s1">origin</span><span class="pl-kos">)</span> <span class="pl-c1">&gt;</span> <span class="pl-c1">-</span><span class="pl-c1">1</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-pavel-backend-js-LC38" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">res</span><span class="pl-kos">.</span><span class="pl-en">setHeader</span><span class="pl-kos">(</span><span class="pl-s">'Access-Control-Allow-Origin'</span><span class="pl-kos">,</span> <span class="pl-s1">origin</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-pavel-backend-js-LC39" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-pavel-backend-js-LC40" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">res</span><span class="pl-kos">.</span><span class="pl-en">header</span><span class="pl-kos">(</span><span class="pl-s">'Access-Control-Allow-Headers'</span><span class="pl-kos">,</span> <span class="pl-s">'Origin, X-Requested-With, Content-Type, Accept'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-pavel-backend-js-LC41" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">res</span><span class="pl-kos">.</span><span class="pl-en">header</span><span class="pl-kos">(</span><span class="pl-s">'Access-Control-Allow-Methods'</span><span class="pl-kos">,</span> <span class="pl-s">'GET,PUT,POST,DELETE,PATCH,OPTIONS'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-pavel-backend-js-LC42" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">res</span><span class="pl-kos">.</span><span class="pl-en">header</span><span class="pl-kos">(</span><span class="pl-s">'Access-Control-Allow-Credentials'</span><span class="pl-kos">,</span> <span class="pl-c1">true</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-pavel-backend-js-LC43" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">req</span><span class="pl-kos">.</span><span class="pl-c1">method</span> <span class="pl-c1">===</span> <span class="pl-s">'OPTIONS'</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-pavel-backend-js-LC44" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">res</span><span class="pl-kos">.</span><span class="pl-en">sendStatus</span><span class="pl-kos">(</span><span class="pl-c1">200</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-pavel-backend-js-LC45" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-pavel-backend-js-LC46" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">next</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-pavel-backend-js-LC47" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span></td>
      </tr>
      <tr>
        <td id="file-pavel-backend-js-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-pavel-backend-js-LC48" class="blob-code blob-code-inner js-file-line"><span class="pl-kos">}</span><span class="pl-kos">)</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">pavel-backend.js</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div></div></div><br>  Mais encore, la plupart de la logique était stockée dans le script.  Considérez un reptiloïde de ce côté ... <br><br><h3>  Suivez le script </h3><br><img src="https://habrastorage.org/webt/ie/7g/dp/ie7gdpgmabvx9bstj2g2vdtofps.jpeg" width="600"><br>  <i>Réponse: apprentissage automatique.</i>  <i>Tiré d'Instagram <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Arnie lui-même</a> .</i> <br><br>  De l'évidence: vous devez absolument connecter le module de reconnaissance <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ASR</a> . <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(Modules.ASR);</code> </pre> <br>  De l'intéressant: <br><br><ul><li>  il y avait un objet <b>questions</b> dans le script avec toutes les réponses et les noms de fichiers <b>.jpg</b> ; <br>  à chaque exécution du script, les questions étaient mélangées à l'aide de la fonction d'aide à la lecture <b>aléatoire</b> : <br><br><div class="spoiler">  <b class="spoiler_title">afficher le code</b> <div class="spoiler_text"><div class="oembed"><script type="text/javascript" src="https://gist.github.com/d42443034ded9a468987531cd7e13e30.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist92463983" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-shuffle-js" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-shuffle-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-shuffle-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">shuffle</span><span class="pl-kos">(</span><span class="pl-s1">a</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-shuffle-js-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">var</span> <span class="pl-s1">j</span><span class="pl-kos">,</span> <span class="pl-s1">x</span><span class="pl-kos">,</span> <span class="pl-s1">i</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-shuffle-js-LC3" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">for</span> <span class="pl-kos">(</span><span class="pl-s1">i</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span><span class="pl-kos">.</span><span class="pl-c1">length</span> <span class="pl-c1">-</span> <span class="pl-c1">1</span><span class="pl-kos">;</span> <span class="pl-s1">i</span> <span class="pl-c1">&gt;</span> <span class="pl-c1">0</span><span class="pl-kos">;</span> <span class="pl-s1">i</span><span class="pl-c1">--</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-shuffle-js-LC4" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">j</span> <span class="pl-c1">=</span> <span class="pl-v">Math</span><span class="pl-kos">.</span><span class="pl-en">floor</span><span class="pl-kos">(</span><span class="pl-v">Math</span><span class="pl-kos">.</span><span class="pl-en">random</span><span class="pl-kos">(</span><span class="pl-kos">)</span> * <span class="pl-kos">(</span><span class="pl-s1">i</span> <span class="pl-c1">+</span> <span class="pl-c1">1</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-shuffle-js-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">x</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span><span class="pl-kos">[</span><span class="pl-s1">i</span><span class="pl-kos">]</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-shuffle-js-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">a</span><span class="pl-kos">[</span><span class="pl-s1">i</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-s1">a</span><span class="pl-kos">[</span><span class="pl-s1">j</span><span class="pl-kos">]</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-shuffle-js-LC7" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">a</span><span class="pl-kos">[</span><span class="pl-s1">j</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-s1">x</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-shuffle-js-LC8" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-shuffle-js-LC9" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">return</span> <span class="pl-s1">a</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-shuffle-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-shuffle-js-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-kos">}</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">shuffle.js</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div></div></div></li><li>  Un gestionnaire «de niveau supérieur» pour un appel entrant ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CallAlerting</a> ) vérifie l'unicité du téléphone et contient également des gestionnaires pour la connexion et la fin d'un appel.  Juste à l'intérieur de <b>onCallConnected,</b> il y a un appel au backend (lire, à socketio): <br><br><div class="spoiler">  <b class="spoiler_title">afficher le code</b> <div class="spoiler_text"><div class="oembed"><script type="text/javascript" src="https://gist.github.com/87860faac3c6aeb7fed8f812e7af7a0f.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist92464040" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-oncallconnected-js" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-oncallconnected-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-oncallconnected-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-v">VoxEngine</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-v">AppEvents</span><span class="pl-kos">.</span><span class="pl-c1">CallAlerting</span><span class="pl-kos">,</span> <span class="pl-k">async</span> <span class="pl-kos">(</span><span class="pl-s1">e</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-oncallconnected-js-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-v">CallEvents</span><span class="pl-kos">.</span><span class="pl-c1">Connected</span><span class="pl-kos">,</span> <span class="pl-s1">onCallConnected</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-oncallconnected-js-LC3" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-v">CallEvents</span><span class="pl-kos">.</span><span class="pl-c1">Disconnected</span><span class="pl-kos">,</span> <span class="pl-s1">onCallDisconnected</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-oncallconnected-js-LC4" class="blob-code blob-code-inner js-file-line">  <span class="pl-c">// ...</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-oncallconnected-js-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-kos">}</span><span class="pl-kos">)</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-oncallconnected-js-LC6" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-oncallconnected-js-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-k">function</span> <span class="pl-en">onCallConnected</span><span class="pl-kos">(</span><span class="pl-s1">e</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-oncallconnected-js-LC8" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">say</span><span class="pl-kos">(</span><span class="pl-s">" , !  :     ,      ,      &lt;say-as stress='2'&gt;&lt;/say-as&gt;."</span> <span class="pl-c1">+</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-oncallconnected-js-LC9" class="blob-code blob-code-inner js-file-line">    <span class="pl-s">"    ,     .          . ??? !"</span><span class="pl-kos">,</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-oncallconnected-js-LC10" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">Language</span><span class="pl-kos">.</span><span class="pl-c1">RU_RUSSIAN_MALE</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-oncallconnected-js-LC11" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-v">CallEvents</span><span class="pl-kos">.</span><span class="pl-c1">PlaybackFinished</span><span class="pl-kos">,</span> <span class="pl-s1">startGame</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-oncallconnected-js-LC12" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">record</span><span class="pl-kos">(</span><span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-oncallconnected-js-LC13" class="blob-code blob-code-inner js-file-line">    <span class="pl-c1">stereo</span>: <span class="pl-c1">true</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-oncallconnected-js-LC14" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-oncallconnected-js-LC15" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-v">CallEvents</span><span class="pl-kos">.</span><span class="pl-c1">RecordStarted</span><span class="pl-kos">,</span> <span class="pl-k">async</span> <span class="pl-kos">(</span><span class="pl-s1">rec</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-oncallconnected-js-LC16" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">let</span> <span class="pl-s1">res</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-v">Net</span><span class="pl-kos">.</span><span class="pl-en">httpRequestAsync</span><span class="pl-kos">(</span><span class="pl-s1">ws</span> <span class="pl-c1">+</span> <span class="pl-s">'/urlResult?caller_id='</span> <span class="pl-c1">+</span> <span class="pl-en">encodeURIComponent</span><span class="pl-kos">(</span><span class="pl-s1">caller_id</span><span class="pl-kos">)</span> <span class="pl-c1">+</span> <span class="pl-s">'&amp;url='</span> <span class="pl-c1">+</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-oncallconnected-js-LC17" class="blob-code blob-code-inner js-file-line">      <span class="pl-en">encodeURIComponent</span><span class="pl-kos">(</span><span class="pl-s1">rec</span><span class="pl-kos">.</span><span class="pl-c1">url</span><span class="pl-kos">)</span><span class="pl-kos">)</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-oncallconnected-js-LC18" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-oncallconnected-js-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-oncallconnected-js-LC19" class="blob-code blob-code-inner js-file-line"><span class="pl-kos">}</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">onCallConnected.js</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div></div></div></li><li>  juste au-dessus de <b>startGame</b> est <b>visible</b> , seulement les questions sont mélangées, coupées et envoyées au backend avec les indices d'image: <br><br><div class="spoiler">  <b class="spoiler_title">afficher le code</b> <div class="spoiler_text"><div class="oembed"><script type="text/javascript" src="https://gist.github.com/860a38c3f7185910920583ceccc23170.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist92464157" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-startgame-js" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-startgame-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-startgame-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">async</span> <span class="pl-k">function</span> <span class="pl-en">startGame</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-startgame-js-LC2" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">removeEventListener</span><span class="pl-kos">(</span><span class="pl-v">CallEvents</span><span class="pl-kos">.</span><span class="pl-c1">PlaybackFinished</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-startgame-js-LC3" class="blob-code blob-code-inner js-file-line">  <span class="pl-en">shuffle</span><span class="pl-kos">(</span><span class="pl-s1">questions</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-startgame-js-LC4" class="blob-code blob-code-inner js-file-line">  <span class="pl-s1">questions</span> <span class="pl-c1">=</span> <span class="pl-s1">questions</span><span class="pl-kos">.</span><span class="pl-en">slice</span><span class="pl-kos">(</span><span class="pl-c1">0</span><span class="pl-kos">,</span> <span class="pl-c1">5</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-startgame-js-LC5" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">let</span> <span class="pl-s1">res</span> <span class="pl-c1">=</span> <span class="pl-k">await</span> <span class="pl-v">Net</span><span class="pl-kos">.</span><span class="pl-en">httpRequestAsync</span><span class="pl-kos">(</span><span class="pl-s1">ws</span> <span class="pl-c1">+</span> <span class="pl-s">'/voxResult?caller_id='</span> <span class="pl-c1">+</span> <span class="pl-en">encodeURIComponent</span><span class="pl-kos">(</span><span class="pl-s1">caller_id</span><span class="pl-kos">)</span> <span class="pl-c1">+</span> <span class="pl-s">'&amp;data='</span> <span class="pl-c1">+</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-startgame-js-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-en">encodeURIComponent</span><span class="pl-kos">(</span><span class="pl-c1">JSON</span><span class="pl-kos">.</span><span class="pl-en">stringify</span><span class="pl-kos">(</span><span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-startgame-js-LC7" class="blob-code blob-code-inner js-file-line">      <span class="pl-c1">action</span>: <span class="pl-s">"start"</span><span class="pl-kos">,</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-startgame-js-LC8" class="blob-code blob-code-inner js-file-line">      <span class="pl-c">// qIndex  attempts   = 0</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-startgame-js-LC9" class="blob-code blob-code-inner js-file-line">      <span class="pl-c1">data</span>: <span class="pl-s1">questions</span><span class="pl-kos">[</span><span class="pl-s1">qIndex</span><span class="pl-kos">]</span><span class="pl-kos">.</span><span class="pl-c1">pics</span><span class="pl-kos">[</span><span class="pl-s1">attempts</span><span class="pl-kos">]</span><span class="pl-kos">,</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-startgame-js-LC10" class="blob-code blob-code-inner js-file-line">      <span class="pl-c1">points</span>: <span class="pl-s1">points</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-startgame-js-LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-startgame-js-LC12" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">try</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-startgame-js-LC13" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">res</span> <span class="pl-c1">=</span> <span class="pl-c1">JSON</span><span class="pl-kos">.</span><span class="pl-en">parse</span><span class="pl-kos">(</span><span class="pl-s1">res</span><span class="pl-kos">.</span><span class="pl-c1">text</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-startgame-js-LC14" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span> <span class="pl-k">catch</span> <span class="pl-kos">(</span><span class="pl-s1">err</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-startgame-js-LC15" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">Logger</span><span class="pl-kos">.</span><span class="pl-en">write</span><span class="pl-kos">(</span><span class="pl-s1">err</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-startgame-js-LC16" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-startgame-js-LC17" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">res</span><span class="pl-kos">.</span><span class="pl-c1">result</span> <span class="pl-c1">===</span> <span class="pl-c1">true</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-startgame-js-LC18" class="blob-code blob-code-inner js-file-line">    <span class="pl-v">Logger</span><span class="pl-kos">.</span><span class="pl-en">write</span><span class="pl-kos">(</span><span class="pl-s">"===--- The Game has started! ---==="</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-startgame-js-LC19" class="blob-code blob-code-inner js-file-line">    <span class="pl-en">startASR</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">//  </span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-startgame-js-LC20" class="blob-code blob-code-inner js-file-line">    <span class="pl-en">wireCall</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span> <span class="pl-c">//    ASR</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-startgame-js-LC21" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span></td>
      </tr>
      <tr>
        <td id="file-startgame-js-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-startgame-js-LC22" class="blob-code blob-code-inner js-file-line"><span class="pl-kos">}</span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">startGame.js</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div></div></div></li><li>  <b>startASR</b> crée <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une instance ASR</a> et indique le dictionnaire de reconnaissance préféré.  Lorsque le joueur prononce la réponse, la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">arrête l'ASR</a> et commence à traiter le résultat - <b>onRecognitionResult</b> ; </li><li>  <b>onRecognitionResult</b> supprime l'excédent de la réponse: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> rr = e[<span class="hljs-number"><span class="hljs-number">0</span></span>].replace(<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).replace(<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).replace(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>).replace(<span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>); rr = rr.replace(<span class="hljs-regexp"><span class="hljs-regexp">/ /g</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>);</code> </pre> <br>  Et puis, il commence à compter les tentatives, les points et exprime également des commentaires en cours de route: <br><br><div class="spoiler">  <b class="spoiler_title">afficher le code</b> <div class="spoiler_text"><div class="oembed"><script type="text/javascript" src="https://gist.github.com/7e95f1ddee5549954365ffce492ecca3.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-31007ea0d3bd9f80540adfbc55afc7bd.css"><div id="gist92464285" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-onrecognitionresult-js" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-javascript ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8" data-paste-markdown-skip="">
      <tbody><tr>
        <td id="file-onrecognitionresult-js-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-onrecognitionresult-js-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">let</span> <span class="pl-s1">found</span> <span class="pl-c1">=</span> <span class="pl-s1">questions</span><span class="pl-kos">[</span><span class="pl-s1">qIndex</span><span class="pl-kos">]</span><span class="pl-kos">.</span><span class="pl-c1">answers</span><span class="pl-kos">.</span><span class="pl-en">some</span><span class="pl-kos">(</span><span class="pl-s1">r</span> <span class="pl-c1">=&gt;</span> <span class="pl-s1">rr</span><span class="pl-kos">.</span><span class="pl-en">indexOf</span><span class="pl-kos">(</span><span class="pl-s1">r</span><span class="pl-kos">)</span> &gt;= <span class="pl-c1">0</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-onrecognitionresult-js-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-v">Logger</span><span class="pl-kos">.</span><span class="pl-en">write</span><span class="pl-kos">(</span><span class="pl-s">"FOUND: "</span> <span class="pl-c1">+</span> <span class="pl-s1">found</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-onrecognitionresult-js-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">found</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-onrecognitionresult-js-LC4" class="blob-code blob-code-inner js-file-line">  <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">attempts</span> <span class="pl-c1">==</span> <span class="pl-c1">0</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-onrecognitionresult-js-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">points</span> <span class="pl-c1">+=</span> <span class="pl-c1">5</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-onrecognitionresult-js-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">say</span><span class="pl-kos">(</span><span class="pl-s">"&lt;say-as stress='3'&gt;&lt;/say-as&gt;!  !"</span><span class="pl-kos">,</span> <span class="pl-v">Language</span><span class="pl-kos">.</span><span class="pl-c1">RU_RUSSIAN_MALE</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-onrecognitionresult-js-LC7" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">attempts</span> <span class="pl-c1">==</span> <span class="pl-c1">1</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-onrecognitionresult-js-LC8" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">points</span> <span class="pl-c1">+=</span> <span class="pl-c1">3</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-onrecognitionresult-js-LC9" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">say</span><span class="pl-kos">(</span><span class="pl-s">"!   ."</span><span class="pl-kos">,</span> <span class="pl-v">Language</span><span class="pl-kos">.</span><span class="pl-c1">RU_RUSSIAN_MALE</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-onrecognitionresult-js-LC10" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">attempts</span> <span class="pl-c1">==</span> <span class="pl-c1">2</span><span class="pl-kos">)</span> <span class="pl-kos">{</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-onrecognitionresult-js-LC11" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">points</span> <span class="pl-c1">+=</span> <span class="pl-c1">1</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-onrecognitionresult-js-LC12" class="blob-code blob-code-inner js-file-line">    <span class="pl-s1">call</span><span class="pl-kos">.</span><span class="pl-en">say</span><span class="pl-kos">(</span><span class="pl-s">" …    .  ."</span><span class="pl-kos">,</span> <span class="pl-v">Language</span><span class="pl-kos">.</span><span class="pl-c1">RU_RUSSIAN_MALE</span><span class="pl-kos">)</span><span class="pl-kos">;</span></td>
      </tr>
      <tr>
        <td id="file-onrecognitionresult-js-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-onrecognitionresult-js-LC13" class="blob-code blob-code-inner js-file-line">  <span class="pl-kos">}</span><span class="pl-kos"></span></td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">onRecognitionResult.js</a>
        hosted with ❤ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div></div></div><br>  La fonction incrémente également les variables avec des tentatives et le numéro de question afin de passer à la question suivante ou de terminer le jeu; </li><li>  La fonction finale <b>gameFinished</b> donne au backend le nombre de points si une personne gagne un code promotionnel - cela peut être vu dans le navigateur et entendu au téléphone, car  Pavlik exprime la victoire;  après ce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">raccrochage</a> est fait. </li></ul><br>  La liste générale du script approche 300 lignes, la pièce la plus volumineuse est le traitement du résultat de la reconnaissance, <b>onRecognitionResult</b> . <br><br><h3>  Parler fossile </h3><br><img src="https://habrastorage.org/webt/cu/fr/uu/cufruuroskavmlgsn0d91flyju8.jpeg" width="600"><br>  <i>Réponse: Firefox.</i>  <i>Nous avons tout.</i> <br><br>  Pavel est un dinosaure, mais il se tient au courant: il se développe année après année et aime toujours plaisanter.  Nous espérons que vous avez évalué la deuxième version de notre reptiloid en direct et en termes de mise en œuvre.  Partagez vos opinions dans les commentaires, soyez en bonne santé et souvenez-vous - Paul vous aime! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr426417/">https://habr.com/ru/post/fr426417/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr426407/index.html">Comment rendre le voyage à la conférence aussi inutile que possible</a></li>
<li><a href="../fr426409/index.html">Le pirate Alexei, qui protège les routeurs MikroTik sans la permission des propriétaires, est devenu célèbre</a></li>
<li><a href="../fr426411/index.html">Développement de classes de descripteurs C ++ / CLI</a></li>
<li><a href="../fr426413/index.html">Principes SOLIDES que chaque développeur doit connaître</a></li>
<li><a href="../fr426415/index.html">Fintech-digest: contrôle de la digitalisation par la Banque Centrale, salaire de crypto-monnaie, carte Mir sous forme de bracelets et porte-clés</a></li>
<li><a href="../fr426419/index.html">Surcharge interdite ou méthodes de pontage en Java</a></li>
<li><a href="../fr426421/index.html">EHCI humainement en russe</a></li>
<li><a href="../fr426423/index.html">mmWave sur smartphones: comment Qualcomm a rendu possible l'impossible</a></li>
<li><a href="../fr426425/index.html">Toute la vérité sur RTOS. Article # 14. Sections de mémoire: introduction et services de base</a></li>
<li><a href="../fr426427/index.html">Des trucs utiles pour "bourrer": une petite sélection à petits prix</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>