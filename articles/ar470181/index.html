<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛠️ 🏷️ 👼🏻 كيف تعمل طريقة ليفنبرغ ماركوارت ↘️ 👤 🤲🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="خوارزمية ليفنبرغ ماركوارت بسيطة. خوارزمية ليفنبرغ ماركوارت فعالة. 

 ويقولون عنه إنه في مكان ما بين نزول التدرج وطريقة نيوتن ، مهما كان ذلك. حسنًا ، إ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>كيف تعمل طريقة ليفنبرغ ماركوارت</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470181/" style=";text-align:right;direction:rtl">  خوارزمية ليفنبرغ ماركوارت بسيطة.  خوارزمية ليفنبرغ ماركوارت فعالة. <br><br>  ويقولون عنه إنه في مكان ما بين نزول التدرج وطريقة نيوتن ، مهما كان ذلك.  حسنًا ، إنه من النوع الذي تم <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تسويته</a> باستخدام طريقة نيوتن وارتباطه بنسل التدرج.  ولكن ماذا يعني عندما ينطقون بهذه العبارة العميقة؟  دعونا نحاول التسلل قليلا. <br><a name="habracut"></a><br>  في مقالاته ، الرفيق ليفنبرغ [ك. طريقة لحل بعض المشاكل في المربعات الأخيرة.  رابعا.  تطبيق ورقة.  الرياضيات.  1944. المجلد.  2. ص 164-168.] ، وبعده المواطن ماركوارت [ماركوارت ، دونالد (1963).  "خوارزمية لتقدير المربعات الصغرى للمعلمات غير الخطية."  مجلة SIAM على الرياضيات التطبيقية.  11 (2): 431-441.] تعتبر مشكلة المربعات الصغرى ، والتي تبدو كما يلي: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e47/8ff/bd3/e478ffbd37ce67d12a8efa37326ce496.gif" title="&quot;\ sum_ {i = 1} ^ {N} \ left (f (x_ {i}، \ theta) -d_ {i} \ right) ^ {2} \ rightarrow \ min&quot;">  . <br><br>  والتي يمكن كتابتها أسهل في شكل ناقل <br><br><img src="https://habrastorage.org/getpro/habr/post_images/43a/e3d/87f/43ae3d87f8c0662510f39e6a7e1453a0.gif" title="&quot;\ parallel f (\ theta) -d \ parallel_ {2} ^ {2} \ rightarrow \ min&quot;">  . <br><br>  ويمكنك حتى أسهل من خلال التسجيل الكامل على المربعات الصغرى.  هذا لن يؤثر على القصة. <br><br>  لذلك ، تعتبر المشكلة <br><br><img src="https://habrastorage.org/getpro/habr/post_images/573/d8c/243/573d8c243893d6b70f894859eebc6e22.gif" title="&quot;\ dfrac {1} {2} \ parallel f (x) \ parallel_ {2} ^ {2} = \ dfrac {1} {2} f ^ {T} (x) f (x) \ rightarrow \ min&quot;">  . <br><br>  تنشأ مثل هذه المشكلة في كثير من الأحيان بحيث لا يمكن المبالغة في أهمية إيجاد طريقة فعالة لحلها.  ولكن سنبدأ من آخر.  في مقال سابق ، تبين أنه يمكن الحصول على طريقة تدرج النسب المعروفة ، وليس فقط ، من الاعتبارات التالية.  دعنا نقول أننا وصلنا إلى مرحلة ما <img src="https://habrastorage.org/getpro/habr/post_images/779/0dd/0ef/7790dd0efb4a03a4c876741804d9b559.gif" title="&quot;X&quot;">  الذي يهم وظيفة الحد الأدنى <img src="https://habrastorage.org/getpro/habr/post_images/903/406/15f/90340615fd75f4a3550a82c374838b6b.gif" title="&quot;f (x)&quot;">  .  نحدد وظيفة مساعدة في هذه المرحلة <img src="https://habrastorage.org/getpro/habr/post_images/8bf/1d5/4e1/8bf1d54e1f36dd4c9dfd5720437af51c.gif" title="&quot;g (p) = f (x + p)&quot;">  ، وكذلك بعض من نموذجها <img src="https://habrastorage.org/getpro/habr/post_images/c5b/160/400/c5b1604002da7b2c951dd57929933d24.gif" title="&quot;\ bar {g} (p) \ approg g (p)&quot;">  .  بالنسبة لهذا النموذج ، نطرح مشكلة مساعدة <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ab/24f/2cd/5ab24f2cdd939fb1186c5ebc91807432.gif" title="&quot;\\\ bar {g} (p) \ rightarrow \ min \\ p \ in \ Omega&quot;"><br><br>  حيث <img src="https://habrastorage.org/getpro/habr/post_images/7e0/838/1ee/7e08381eec55a31db8263ce4d9b04120.gif" title="&quot;أوميغا&quot;">  - مجموعة معينة محددة سلفًا من القيم المسموح بها ، يتم اختيارها بحيث يكون للمشكلة حل بسيط ووظيفة <img src="https://habrastorage.org/getpro/habr/post_images/462/957/dda/462957dda265f4fb8be04327f1c12b0f.gif" title="&quot;\ bar {g}&quot;">  تقريب بدقة تماما <img src="https://habrastorage.org/getpro/habr/post_images/da7/7c5/b48/da77c5b4891cf3d059f1b04a28b230ef.gif" title="&quot;G&quot;">  في <img src="https://habrastorage.org/getpro/habr/post_images/7e0/838/1ee/7e08381eec55a31db8263ce4d9b04120.gif" title="&quot;أوميغا&quot;">  .  يسمى هذا المخطط طريقة منطقة الثقة ، والكثير <img src="https://habrastorage.org/getpro/habr/post_images/7e0/838/1ee/7e08381eec55a31db8263ce4d9b04120.gif" title="&quot;أوميغا&quot;">  حيث يتم تقليل قيمة وظيفة النموذج - منطقة الثقة لهذه الوظيفة.  لنسب التدرج ، اتخذنا <img src="https://habrastorage.org/getpro/habr/post_images/c7e/85c/48e/c7e85c48eb16123c23a9e08714f50a0e.gif" title="&quot;\ Omega = \ left \ {p \ quad | \ parallel p \ parallel_ {2} = \ Delta \ right \}&quot;">  ، لطريقة نيوتن <img src="https://habrastorage.org/getpro/habr/post_images/7cf/b4b/920/7cfb4b9203c4faccd18c1837b9c0e59f.gif" title="&quot;\ Omega = \ left \ {p \ quad | \ parallel p \ parallel_ {H (x)} = \ Delta \ right \}&quot;">  ، وكنموذج ل <img src="https://habrastorage.org/getpro/habr/post_images/da7/7c5/b48/da77c5b4891cf3d059f1b04a28b230ef.gif" title="&quot;G&quot;">  الجزء الخطي من التوسع تايلور <img src="https://habrastorage.org/getpro/habr/post_images/a98/a08/49f/a98a0849fa75ac2a6bbcbbc2bbda3054.gif" title="&quot;\ bar {g} = f (x) + \ bigtriangledown f ^ {T} (x) p&quot;">  . <br><br>  دعونا نرى ما يحدث إذا قمنا بتعقيد النموذج من خلال اتخاذ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b2a/d63/f01/b2ad63f0162c3cad2512d187035cbf2d.gif" title="&quot;\ bar {g} (p) = f (x) + \ bigtriangledown f ^ {T} (x) p + \ dfrac {1} {2} p ^ {T} H (x) p&quot;">  . <br><br>  نحن تقليل هذه الوظيفة النموذجية في منطقة الثقة الاهليلجيه <img src="https://habrastorage.org/getpro/habr/post_images/e99/c58/ecc/e99c58ecc60ed62c044f7690e444d1d2.gif" title="&quot;\ dfrac {1} {2} \ parallel p \ parallel_ {B} ^ {2} = \ Delta&quot;">  (تم إضافة المضاعف لسهولة الحساب).  عند تطبيق طريقة لاغرانج المضاعفة ، نحصل على المشكلة <br><br><img src="https://habrastorage.org/getpro/habr/post_images/44c/4c6/050/44c4c6050ba6f69f94a8c222d68c95f3.gif" title="&quot;\ bigtriangledown f ^ {T} (x) p + \ dfrac {1} {2} p ^ {T} H (x) p + \ dfrac {\ lambda} {2} p ^ {T} Bp- \ lambda \ Delta \ rightarrow \ min &quot;">  . <br><br>  الذي حل يرضي المساواة <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a3/851/c83/4a3851c834bc50c9b670673f6665f792.gif" title="&quot;H (x) p + \ lambda Bp + \ bigtriangledown f (x) = 0&quot;"><br><br>  أو <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2c4/7f5/3d4/2c47f53d4e43da14ea21b9fe9d7bb533.gif" title="&quot;\ left (H (x) + \ lambda B \ right) p = - \ bigtriangledown f (x)&quot;"><br><br>  هنا ، على عكس ما رأيناه سابقًا عند استخدام النموذج الخطي ، <i>لا</i> يعتمد الاتجاه <i>p</i> <i>فقط على المقياس</i> <img src="https://habrastorage.org/getpro/habr/post_images/dab/ea9/01c/dabea901c4b1a4079aa96d47bcee4e75.gif" title="&quot;B&quot;">  ، ولكن أيضا على اختيار <i>حجم المنطقة الثقة</i> <img src="https://habrastorage.org/getpro/habr/post_images/a2b/068/6ad/a2b0686adbc103ad9f96be85cca5d418.gif" title="&quot;\ دلتا&quot;">  ، مما يعني أن تقنية البحث الخطي غير قابلة للتطبيق (على الأقل بشكل معقول).  كما تبين أنه من الصعب تحديد القيمة بشكل صريح <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  المقابلة ل <img src="https://habrastorage.org/getpro/habr/post_images/a2b/068/6ad/a2b0686adbc103ad9f96be85cca5d418.gif" title="&quot;\ دلتا&quot;">  .  ومع ذلك ، فمن الواضح أنه مع زيادة <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  طول <img src="https://habrastorage.org/getpro/habr/post_images/4b2/8c1/3d5/4b28c13d5f5d658adb7478fbc9efc923.gif" title="&quot;P&quot;">  سوف تنخفض.  إذا ، ومع ذلك ، ما زلنا فرض الشرط <img src="https://habrastorage.org/getpro/habr/post_images/d64/14f/5fb/d6414f5fbe0850f1d6cd0710c69a89fe.gif" title="&quot;\ lambda \ geq0&quot;">  ، لن يكون طول الخطوة أكثر من ذلك الذي ستعطيه طريقة نيوتن (كل ما هو عصري ، بدون تعديلات وشروط). <br><br>  لذلك يمكننا بدلا من ذلك عن معين <img src="https://habrastorage.org/getpro/habr/post_images/a2b/068/6ad/a2b0686adbc103ad9f96be85cca5d418.gif" title="&quot;\ دلتا&quot;">  ابحث عن القيمة الصحيحة <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  ، افعل العكس تماما: ابحث عن هذا <img src="https://habrastorage.org/getpro/habr/post_images/d64/14f/5fb/d6414f5fbe0850f1d6cd0710c69a89fe.gif" title="&quot;\ lambda \ geq0&quot;">  تحت أي شرط <img src="https://habrastorage.org/getpro/habr/post_images/553/80b/dc5/55380bdc5a434366df6d181078d6a8b7.gif" title="&quot;g (p) &amp; lt؛ g (0)&quot;">  .  هذا هو نوع من استبدال البحث المتأخر في هذه الحالة.  اقترح ماركوارد الإجراء البسيط التالي: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>إذا لبعض القيمة</i> <i><img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;"></i>  <i>حالة</i> <i><img src="https://habrastorage.org/getpro/habr/post_images/eca/77f/2af/eca77f2af789bf09851ed403e71813c5.gif" title="&quot;g (p (\ lambda)) &amp; lt؛ g (0)&quot;"></i>  <i>القيام به ثم كرر</i> <i><img src="https://habrastorage.org/getpro/habr/post_images/cc3/5f3/35e/cc35f335e8bf25ccc19e392f3311591a.gif" title="&amp; quot؛ \ lambda '\ leftarrow \ alpha \ lambda، \ lambda \ leftarrow \ lambda' &amp; quot؛"></i>  <i>حتى ل</i> <i><img src="https://habrastorage.org/getpro/habr/post_images/3aa/df9/299/3aadf929956784b2e081f8a634cff90f.gif" title="&amp; quot؛ g (p (\ lambda ') &amp; lt؛ g (p (\ lambda)) &amp; quot؛"></i> </li><li style=";text-align:right;direction:rtl">  <i>إذا</i> <i><img src="https://habrastorage.org/getpro/habr/post_images/22b/75c/294/22b75c29456939ef738c81e53f52db6b.gif" title="&quot;g (p (\ lambda)) \ geq g (0)&quot;"></i>  <i>اقبل</i> <i><img src="https://habrastorage.org/getpro/habr/post_images/434/e0a/742/434e0a742c4ad3ae7e4cea8c1289d363.gif" title="&quot;\ lambda \ leftarrow \ beta \ lambda&quot;"></i>  <i>وكرر.</i> </li></ol><br>  هنا <img src="https://habrastorage.org/getpro/habr/post_images/4f2/68e/81e/4f268e81e07eb6a87b5798903d82f2c0.gif" title="&quot;0 &amp; lt؛ \ alpha &amp; lt؛ 1&quot;">  و <img src="https://habrastorage.org/getpro/habr/post_images/0ea/d14/4f2/0ead144f2f1591e5747e51404639631f.gif" title="&quot;\ beta &amp; gt؛ 1&quot;">  هي الثوابت التي هي معلمات الطريقة.  الضرب بواسطة <img src="https://habrastorage.org/getpro/habr/post_images/389/a99/83e/389a9983ea24ad0b3af0559c2aca381b.gif" title="&quot;\ alpha&quot;">  يتوافق مع توسيع منطقة الثقة ، والضرب في <img src="https://habrastorage.org/getpro/habr/post_images/76d/0eb/69b/76d0eb69ba026a58bbe3edd275fee712.gif" title="&quot;\ beta&quot;">  - تضييق لها. <br><br>  يمكن تطبيق التقنية المحددة على <i>أي</i> وظيفة موضوعية.  لاحظ أنه لم تعد هناك حاجة إلى التحديد الإيجابي لهيسيان ، على عكس الحالة التي تم بحثها سابقًا ، عندما تم تقديم طريقة نيوتن كحالة خاصة لطريقة النسب المتسلسل.  ليست هناك حاجة إلى عدم تنكسها ، وهو أمر مهم للغاية في بعض الحالات.  ومع ذلك ، في هذه الحالة ، يرتفع سعر البحث عن الاتجاه ، لأن كل تغيير <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  يؤدي إلى الحاجة إلى حل نظام خطي لتحديد <img src="https://habrastorage.org/getpro/habr/post_images/4b2/8c1/3d5/4b28c13d5f5d658adb7478fbc9efc923.gif" title="&quot;P&quot;">  . <br><br>  دعونا نرى ما يحدث إذا طبقنا هذا النهج على مشكلة المربعات الصغرى. <br><br>  وظيفة التدرج <img src="https://habrastorage.org/getpro/habr/post_images/f58/e0b/7a5/f58e0b7a5457a6f69dd3c16e2d5aadc5.gif" title="&quot;\ bigtriangledown \ left (\ dfrac {1} {2} f ^ {T} f \ right) = J ^ {T} f&quot;">  لها هسي <img src="https://habrastorage.org/getpro/habr/post_images/9da/93e/f0a/9da93ef0ae8eda326c977d890c97beac.gif" title="&quot;H = J ^ {T} J + G&quot;">  حيث <img src="https://habrastorage.org/getpro/habr/post_images/c7a/314/465/c7a31446512540e721403b61686e91ba.gif" title="&quot;J_ {ij} = \ dfrac {\ جزئية f_ {i}} {\ جزئية x_ {j}} ، G_ {ij} = \ sum_ {k = 1} ^ {M} \ dfrac {\ جزئي ^ {2} f_ {i}} {\ جزئية x_ {j} \ جزئية x_ {k}} f_ {k} &quot;">  .  استبدل واحصل على النظام التالي الذي يحدد اتجاه البحث <br><br><img src="https://habrastorage.org/getpro/habr/post_images/148/b56/06f/148b5606f695c8a52b629f69f8c167c5.gif" title="&quot;\ left (J ^ {T} J + G + \ lambda B \ right) p = -J ^ {T} f&quot;">  . <br><br>  هذا أمر مقبول تمامًا ، لكن حساب المشتقات الثانية لدالة المتجه يمكن أن يكون مكلفًا للغاية.  اقترح ماركوارت استخدام الوظيفة نفسها لتجاوز هذه المشكلة. <img src="https://habrastorage.org/getpro/habr/post_images/188/ee6/44e/188ee644e8202aad30eac11166858841.gif" title="&quot;F&quot;">  ، وتقريبه الخطي <img src="https://habrastorage.org/getpro/habr/post_images/205/c97/755/205c97755529c6a19a04851f7ec3d7f7.gif" title="&quot;\ bar {f} (x) = f (x_ {0}) + J (x_ {0}) (x-x_ {0})&quot;">  التي المصفوفة <img src="https://habrastorage.org/getpro/habr/post_images/338/ec0/451/338ec0451e1b4b7e7decd0b4443a8828.gif" title="&quot;G&quot;">  يتحول إلى الصفر.  إذا الآن كما <img src="https://habrastorage.org/getpro/habr/post_images/dab/ea9/01c/dabea901c4b1a4079aa96d47bcee4e75.gif" title="&quot;B&quot;">  خذ مصفوفة الهوية <img src="https://habrastorage.org/getpro/habr/post_images/809/326/43e/80932643e100c59ad091cdf4d90a2bd5.gif" title="&quot;I&quot;">  ، ثم نحصل على النموذج القياسي لطريقة Levenberg-Marquardt لحل مشكلة المربعات الصغرى: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3e/6e4/48a/d3e6e448ae5465d70cded093a02fdb69.gif" title="&quot;\ left (J ^ {T} J + \ lambda I \ right) p = -J ^ {T} f&quot;">  . <br><br>  لهذه الطريقة لتحديد اتجاه النزول ، أثبت ماركواردت النظرية التي تطلع <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  لاتجاه اللانهاية <img src="https://habrastorage.org/getpro/habr/post_images/4b2/8c1/3d5/4b28c13d5f5d658adb7478fbc9efc923.gif" title="&quot;P&quot;">  يميل إلى مكافحة التدرج.  يمكن للقارئ المهتم العثور على دليل صارم في المقال الأساسي ، لكنني آمل أن يصبح هذا البيان نفسه واضحًا تمامًا من منطق هذه الطريقة.  إلى حد ما ، فإنه يبرر الإشارة في كل مكان إلى حقيقة أنه مع زيادة لامدا (والتي لسبب ما أسميه في كثير من الأحيان المعلمة التنظيم) نحصل على النسب التدرج.  في الواقع ، لا شيء من هذا القبيل - فسنحصل عليه فقط في الحد الأقصى ، حيث يكون طول الخطوة يميل إلى الصفر.  الأهم من ذلك أنه مع وجود قيمة كبيرة للغاية بما فيه الكفاية ، سيكون الاتجاه الذي نحصل عليه هو <i>اتجاه الهبوط</i> ، مما يعني أننا نحصل على <i>التقارب العالمي لهذه الطريقة</i> .  وهنا الجزء الثاني من البيان أنه عندما تميل لامدا إلى الصفر نحصل على طريقة نيوتن ، هذا صحيح بشكل واضح ، لكن فقط إذا قبلنا بدلاً من ذلك <img src="https://habrastorage.org/getpro/habr/post_images/188/ee6/44e/188ee644e8202aad30eac11166858841.gif" title="&quot;F&quot;">  تقريبه الخطي <img src="https://habrastorage.org/getpro/habr/post_images/9dc/1fa/a9c/9dc1faa9cf4e8d569afaf161ac627568.gif" title="&quot;\ bar {f}&quot;">  . <br><br>  يبدو أن كل شيء.  نقوم بتقليل قاعدة وظيفة المتجه في القياس الإهليلجي - نستخدم Levenberg-Marquardt.  نحن نتعامل مع دالة ذات شكل عام ولدينا القدرة على حساب مصفوفة المشتقات الثانية - بالنسبة للآبار ، استخدم طريقة منطقة ثقة المنطقة العامة.  ولكن هناك منحرفين ... <br><br>  في بعض الأحيان طريقة Levenberg-Marquardt لتقليل الوظيفة <img src="https://habrastorage.org/getpro/habr/post_images/188/ee6/44e/188ee644e8202aad30eac11166858841.gif" title="&quot;F&quot;">  يسمونه تعبير مثل هذا: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/438/a2f/22b/438a2f22ba381c85087a26d2125d1dac.gif" title="&quot;\ left (H ^ {T} H + \ lambda I \ right) p = -H ^ {T} \ bigtriangledown f&quot;">  . <br><br>  يبدو أن كل شيء هو نفسه ، ولكن هنا <img src="https://habrastorage.org/getpro/habr/post_images/bc8/190/17b/bc819017bab0b9f9d995f262f3f76a42.gif" title="&quot;H&quot;">  - مصفوفة الثانية!  وظائف مشتقة <img src="https://habrastorage.org/getpro/habr/post_images/188/ee6/44e/188ee644e8202aad30eac11166858841.gif" title="&quot;F&quot;">  .  رسميا ، هذا له الحق في الوجود ، لكنه تحريف.  وهنا السبب.  واقترح نفس ماركوارت في مقاله طريقة لحل نظام المعادلات <img src="https://habrastorage.org/getpro/habr/post_images/0a0/ec7/804/0a0ec780406efe57ca6444290ccfde09.gif" title="&quot;F (x) = 0&quot;">  عن طريق تقليل الوظيفة <img src="https://habrastorage.org/getpro/habr/post_images/128/aa6/0b3/128aa60b3bc0593a797bd9ebd308b402.gif" title="&quot;\ parallel F (x) \ parallel_ {2} ^ {2}&quot;">  الطريقة الموصوفة.  إذا ك <img src="https://habrastorage.org/getpro/habr/post_images/59b/464/0f5/59b4640f5bad6b14066d718cf44e9f9c.gif" title="&quot;F (x)&quot;">  خذ التدرج اللوني للوظيفة الموضوعية ، ثم نحصل حقًا على التعبير المخفض.  والانحراف هو بسبب <br><br>  <i>يتم حل مشكلة التقليل الناتجة عن نظام المعادلات غير الخطية الناتجة عن مشكلة التقليل</i> . <br><br>  ضربة مزدوجة.  مثل هذا التعبير ، على الأقل ، ليس أفضل من المعادلة الأولى لمنطقة الثقة الكروية ، ولكن بشكل عام هو أسوأ بكثير من وجهة نظر الإنتاجية (عمليات الضرب غير الضرورية ، والتطبيقات العادية - التثبيط) ، ومن وجهة نظر استقرار الطريقة (تضاعف المصفوفة في حد ذاته يزداد سوءًا) تكييفها).  في بعض الأحيان يعترض على ذلك <img src="https://habrastorage.org/getpro/habr/post_images/e98/c6b/bd7/e98c6bbd7a088cd46c2ed68aac4943ba.gif" title="&quot;H ^ {T} H&quot;">  مضمون تعريف إيجابي ، ولكن في هذه الحالة لا يهم.  دعونا نلقي نظرة على طريقة ليفنبرغ ماركوارت من منظور طريقة النسب المتسلسل.  في هذه الحالة ، اتضح أننا نريد استخدام المصفوفة كمقياس <img src="https://habrastorage.org/getpro/habr/post_images/64b/dbe/dcb/64bdbedcbd61e0741f92025fb7c4a1f8.gif" title="&quot;H (x) + \ lambda B&quot;">  ، بحيث يمكنها أن تتصرف بهذه الصفة ، المعنى <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  يجب التأكد من اليقين الإيجابي.  بالنظر إلى ذلك <img src="https://habrastorage.org/getpro/habr/post_images/dab/ea9/01c/dabea901c4b1a4079aa96d47bcee4e75.gif" title="&quot;B&quot;">  قيمة محددة إيجابية <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  يمكن دائما العثور عليها - وبالتالي لا حاجة للطلب من <img src="https://habrastorage.org/getpro/habr/post_images/bc8/190/17b/bc819017bab0b9f9d995f262f3f76a42.gif" title="&quot;H&quot;">  اليقين الإيجابي لا يلاحظ. <br><br>  كمصفوفة <img src="https://habrastorage.org/getpro/habr/post_images/dab/ea9/01c/dabea901c4b1a4079aa96d47bcee4e75.gif" title="&quot;B&quot;">  ليس من الضروري اتخاذ نموذج واحد ، ولكن بالنسبة للنموذج التربيعي للوظيفة الهدفية ، لم يعد تحديد منطقة ثقة كافية أمرًا بسيطًا تمامًا مثل النموذج الخطي.  إذا أخذنا المنطقة الإهليلجية التي يسببها الهسه ، فإن الطريقة تتحول إلى طريقة نيوتن (جيدًا ، تقريبًا) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f31/f2c/82f/f31f2c82f904fd2c95ab33daa112168b.gif" title="&quot;\ left (J ^ {T} J + \ lambda J ^ {T} J \ right) p = \ left (1+ \ lambda \ right) J ^ {T} Jp = -J ^ {T} f \ approx \ left (1+ \ lambda \ right) Hp = - \ bigtriangledown \ left (\ dfrac {1} {2} f ^ {T} f \ right). &quot;"><br><br>  ما لم يكن ، بطبيعة الحال ، مصفوفة هسه محددة إيجابية.  إذا لم يكن الأمر كذلك ، فكما كان الحال من قبل ، يمكنك استخدام Hessian المصححة كمقياس ، أو بعض المصفوفات القريبة منه إلى حد ما.  هناك أيضًا توصية لاستخدام مصفوفة كمقياس <img src="https://habrastorage.org/getpro/habr/post_images/e83/ae4/134/e83ae41347e08ce41ff17ee556a7e06b.gif" title="&quot;diag (J ^ {T} J)&quot;">  ، والتي من خلال البناء ويضمن أن تكون إيجابية محددة.  لسوء الحظ ، لا أعرف على الأقل أي مبرر صارم لهذا الخيار ، لكن يتم ذكره في كثير من الأحيان كتوصية عملية. <br><br>  كتوضيح ، دعونا نرى كيف تتصرف الطريقة على نفس وظيفة Rosenbrock ، وسننظر فيها في شكلين - كدالة بسيطة مكتوبة في النموذج <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b78/272/e1a/b78272e1a4bce3b65e55a7737fd2a1ee.gif" title="&quot;f (x، y) = (1-x) ^ {2} +100 (y-x ^ {2}) ^ {2} \ rightarrow \ min&quot;">  . <br><br>  وكمشكلة الأقل الساحات <br><br><img src="https://habrastorage.org/getpro/habr/post_images/05c/c5a/49e/05cc5a49e94d86e2929c86264cd76f6f.gif" title="&quot;\\ f (x، y) = \ left \ Vert \ start {array} {c} 1-x \\ 100 (yx ^ {2}) \ end {array} \ right \ Vert _ {2} ^ { 2} \ rightarrow \ min &quot;"><br><br><img src="https://habrastorage.org/webt/0d/bo/bo/0dbobokk7lwzjkd69j9d-wmotks.gif" width="600"><br>  هذه هي الطريقة التي تتصرف بها منطقة الثقة الكروية. <br><img src="https://habrastorage.org/webt/l9/57/xb/l957xbscmthhqno0yneburansf4.gif" width="600"><br>  لذلك تتصرف نفس الطريقة إذا تم إعطاء شكل منطقة الثقة بمصفوفة تم إنشاؤها وفقًا لقانون دافيدون فليتشر باول.  هناك تأثير على التقارب ، ولكن أكثر تواضعا مما كان عليه في الحالة المماثلة عند استخدام النموذج الخطي للدالة الموضوعية. <br><img src="https://habrastorage.org/webt/rn/n2/uz/rnn2uzvfkpd7fdrxa26qvdlkcfs.gif" width="600"><br>  وهذا هو سلوك الأسلوب المطبق على مشكلة المربعات الصغرى.  يتقارب في 5 تكرارات.  فقط من فضلك ، <i>لا تستخلص من هذا الاستنتاج أن الصيغة الثانية للوظائف من هذا النوع هي دائما أفضل من الأولى</i> .  هذا ليس كذلك ، لقد حدث فقط في هذه الحالة بالذات. <br><br><h2 style=";text-align:right;direction:rtl">  استنتاج </h2><br>  إن طريقة Levenberg-Marquardt هي ، حسب علمي ، الطريقة الأولى القائمة على فكرة منطقة الثقة.  لقد أظهر نفسه جيدًا في الممارسة عند حل مشكلة المربعات الصغرى.  تتقارب الطريقة في معظم الحالات (التي أراها أنا) بسرعة كبيرة (قلت ما إذا كانت جيدة أو سيئة في مقال سابق).  ومع ذلك ، مع تقليل الوظائف العامة إلى الحد الأدنى ، فإنه لا يكاد يكون الخيار الأفضل لاختيار مجال كمنطقة ثقة.  بالإضافة إلى ذلك ، هناك عيب كبير في الطريقة (في صيغتها الأساسية ، والتي تم وصفها هنا) هو أن حجم منطقة الثقة تم تحديده ضمنيًا.  العيب هو أن معرفة المعنى <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  يمكننا ، بالطبع ، الاعتماد في الوقت الحالي <img src="https://habrastorage.org/getpro/habr/post_images/a2b/068/6ad/a2b0686adbc103ad9f96be85cca5d418.gif" title="&quot;\ دلتا&quot;">  مجرد حساب طول الخطوة <img src="https://habrastorage.org/getpro/habr/post_images/4b2/8c1/3d5/4b28c13d5f5d658adb7478fbc9efc923.gif" title="&quot;P&quot;">  .  ومع ذلك ، عندما ننتقل إلى نقطة جديدة ، نفس القيمة <img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="&quot;\ لامدا&quot;">  قيمة مختلفة تماما من منطقة الثقة تتوافق بالفعل.  وبالتالي ، فإننا نفقد القدرة على تحديد حجم "سمة المهمة" لمنطقة الثقة ونضطر إلى تحديد حجمها بطريقة جديدة في كل نقطة جديدة.  قد يكون هذا مهمًا عندما يكون هناك عدد كبير بما فيه الكفاية من التكرار مطلوبًا للتقارب ، ويكون حساب قيمة دالة مكلفًا.  يتم حل مشكلات مماثلة بطرق أكثر تقدمًا استنادًا إلى فكرة منطقة الثقة. <br><br>  لكن هذه قصة مختلفة تماما. <br><br><h2 style=";text-align:right;direction:rtl">  إضافة </h2><br>  بفضل التعليقات القيمة لـ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=" class="user_link">Dark_Daiver ،</a> قررت إضافة ما ذكر أعلاه إلى الملاحظة التالية.  بالطبع ، يمكن للمرء أن يصل إلى طريقة ليفنبرغ ماركوارت بطريقة مختلفة تجريبية بحتة.  وهي ، دعونا نعود إلى مخطط أسلوب النسب المتسلسل الموضح في المقالة السابقة ونطرح مرة أخرى على أنفسنا مسألة بناء مقياس مناسب للنموذج الخطي للدالة الهدفية. <br>  لنفترض أن مصفوفة Hessian في النقطة الحالية في مساحة البحث ليست محددة بشكل إيجابي ولا يمكن استخدامها كمقياس (علاوة على ذلك ، للتحقق مما إذا كان الأمر كذلك ، ليس لدينا القدرة ولا الرغبة).  دلالة بواسطة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/f06/ee0/4fd/f06ee04fdb8676c6297784f2cc24291b.gif" title="\ lambda _ {\ min}"></a>  أصغر قيمة لها.  ثم يمكننا تصحيح هسه ببساطة عن طريق تحويل جميع القيم الذاتية بها <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/0b6/187/138/0b61871385159f5f8dff9d81de5171b5.gif" title="\ lambda> - \ lambda _ {\ min}"></a>  .  للقيام بذلك ، ما عليك سوى إضافة المصفوفة إلى Hessian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/09f/c07/1d5/09fc071d5e509fe24bd70ca553a899cf.gif" title="\ لامدا الأول"></a>  .  ثم المعادلة التي تحدد اتجاه النزول سوف تأخذ الشكل <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/3a7/b20/19b/3a7b2019b8c7a99b85121b3512c3fa19.gif" title="\\ (H (x) + \ lambda I) p = - \ bigtriangledown f (x) \\ \ lambda> - \ lambda _ {\ min}"></a> <br><br>  إذا كان لدينا درجة أقل جيدة ل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/f06/ee0/4fd/f06ee04fdb8676c6297784f2cc24291b.gif" title="\ lambda _ {\ min}"></a>  ، ثم يمكننا أن نفعل كل ما تم في طرق النسب المتسلسل.  ومع ذلك ، إذا لم يكن لدينا مثل هذا التقدير ، ثم أخذ ذلك في الاعتبار مع زيادة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="\ امدا"></a>  سوف ينخفض ​​طول <i>p</i> ، يمكننا أن نقول بثقة أن هناك مثل هذا كبير بما فيه الكفاية <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/99d/394/e7d/99d394e7d0b74248114405067e0ffd51.gif" title="\ امدا"></a>  هذا في نفس الوقت <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/cc1/d36/8a7/cc1d368a7e0d0614441998db48983d70.gif" title="H (x) + \ lambda I"></a>  إيجابي واضح و <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/553/80b/dc5/55380bdc5a434366df6d181078d6a8b7.gif" title="g (p) <g (0)"></a>  . <br><br>  لماذا اعتبر هذا الاستنتاج للطريقة غير ناجح للغاية.  أولاً ، ليس واضحًا على الإطلاق أن المقياس المصمم بهذه الطريقة مناسب للاستخدام العملي.  بالطبع ، يستخدم معلومات حول المشتقات الثانية ، لكنه لا يتبع من أي مكان أن تحويل القيم الذاتية بقيمة معينة لن يجعلها غير قابلة للاستخدام.  كما لاحظ الزميل في التعليقات ، يبدو من الواضح أن إضافة مصفوفة هوية متدرجة إلى مصفوفة هسي تؤدي إلى حقيقة أن منطقة الثقة الإهليلجية سوف تميل إلى كروية وهنا مرة أخرى (كما يبدو) مشاكل التشويش في الوادي وغيرها من المسرات ذات النسب المتدرجة والأقارب له طرق.  ولكن في الممارسة العملية هذا لا يحدث.  على أي حال ، لم أتمكن مطلقًا من ملاحظة أمثلة توضح مثل هذا السلوك.  في هذه الحالة ، يطرح السؤال: <i>ولكن في الواقع ، لماذا</i> ؟ <br><br>  لكن مثل هذا السؤال لا ينشأ إذا نظرنا إلى هذه الطريقة ليس كحالة خاصة لأساليب النزول ، ولكن كطريقة لمنطقة الثقة مع نموذج تربيعي للوظيفة الهدفية ، نظرًا لأن الإجابة واضحة: عندما يزداد اللمدا ، نضغط فقط على المجال - منطقة الثقة لنموذجنا.  لا تذهب المعلومات حول الانحناء إلى أي مكان ولا يتم التخلص منها بأي شيء - علينا فقط اختيار حجم المنطقة التي يصف فيها النموذج التربيعي الوظيفة الهدف بشكل مناسب.  ويترتب على ذلك أنه بالكاد يستحق توقع تأثير كبير من تغيير في المقياس ، أي شكل منطقة الثقة ، نظرًا لأن كل المعلومات التي لدينا عن الوظيفة الموضوعية قد تم أخذها بالفعل في الاعتبار في نموذجها. <br><br>  وثانياً ، عند النظر في طريقة ما ، من المهم أن نفهم الفكرة الرئيسية التي قادت Marquardt إلى هذه الطريقة ، وهي فكرة منطقة الثقة.  في الواقع ، في التحليل النهائي ، فقط فهم خصوصيات وعموميات الطريقة العددية سيسمح لنا أن نفهم لماذا يعمل ، والأهم من ذلك ، لماذا قد لا تعمل. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar470181/">https://habr.com/ru/post/ar470181/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar470167/index.html">مؤتمر للمهتمين بالعلم قبل أن يصبح التيار الرئيسي</a></li>
<li><a href="../ar470169/index.html">كيف تمنع الفكرة من الموت وتجميع فريق لن يقتلها</a></li>
<li><a href="../ar470171/index.html">Habr Weekly # 21 / Dobroshrift ، technodom لقط ، والحق في إصلاح الأجهزة المنزلية ، والاتحاد الأوروبي وملفات تعريف الارتباط "الشفافة"</a></li>
<li><a href="../ar470173/index.html">منصة التكامل كخدمة</a></li>
<li><a href="../ar470179/index.html">PDDM - خوارزمية التعلم المعززة الجديدة المعتمدة على النموذج مع برنامج جدولة متقدم</a></li>
<li><a href="../ar470187/index.html">النطاق السعري لتصميم وتصميم الخدمة عبر الإنترنت هو من 100 ألف إلى 5 ملايين روبل. أسباب</a></li>
<li><a href="../ar470189/index.html">إرسال رسائل نظير إلى نظير مع PeerJS</a></li>
<li><a href="../ar470191/index.html">على شبكة الإنترنت. حل المشكلات باستخدام r0ot-mi. الجزء 1</a></li>
<li><a href="../ar470193/index.html">حماية عالمية ضد هجمات xss وحقن sql</a></li>
<li><a href="../ar470195/index.html">F # 4: Let / Use / Do</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>