<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“¼ ğŸ“® ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ ä½¿ç”¨åŠ¨æ€æ•°ç»„å’Œè‡ªå®šä¹‰é›†åˆç±»çš„è§„åˆ™ ğŸ˜˜ ğŸŠ ğŸ¯</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä½¿ç”¨åŠ¨æ€æ•°ç»„å’Œè‡ªå®šä¹‰é›†åˆç±»çš„è§„åˆ™ 
 è¿™æ˜¯æˆ‘åœ¨ä½¿ç”¨åŠ¨æ€æ•°ç»„æ—¶è¦éµå®ˆçš„è§„åˆ™ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯è®¾è®¡æ•°ç»„çš„æŒ‡å—ï¼Œä½†æ˜¯æˆ‘ä¸æƒ³å°†å…¶æ”¾åœ¨è®¾è®¡å¯¹è±¡çš„æŒ‡å—ä¸­ï¼Œå› ä¸ºå¹¶éæ¯ç§é¢å‘å¯¹è±¡çš„è¯­è¨€éƒ½å…·æœ‰åŠ¨æ€æ•°ç»„ã€‚ è¿™äº›ç¤ºä¾‹æ˜¯ç”¨PHPç¼–å†™çš„ï¼Œå› ä¸ºå®ƒç±»ä¼¼äºJavaï¼ˆæ‚¨å¯èƒ½å·²ç»ç†Ÿæ‚‰ï¼‰ï¼Œä½†æ˜¯ä½¿ç”¨åŠ¨æ€æ•°ç»„è€Œä¸æ˜¯å†…ç½®çš„é›†åˆç±»å’Œæ¥å£ã€‚ 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨åŠ¨æ€æ•°ç»„å’Œè‡ªå®šä¹‰é›†åˆç±»çš„è§„åˆ™</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/484336/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/qy/hx/3d/qyhx3dbaepmsxkx2azb_tmi9dee.jpeg"></div><br><br> ä½¿ç”¨åŠ¨æ€æ•°ç»„å’Œè‡ªå®šä¹‰é›†åˆç±»çš„è§„åˆ™ <br> è¿™æ˜¯æˆ‘åœ¨ä½¿ç”¨åŠ¨æ€æ•°ç»„æ—¶è¦éµå®ˆçš„è§„åˆ™ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯è®¾è®¡æ•°ç»„çš„æŒ‡å—ï¼Œä½†æ˜¯æˆ‘ä¸æƒ³å°†å…¶æ”¾åœ¨è®¾è®¡å¯¹è±¡çš„æŒ‡å—ä¸­ï¼Œå› ä¸ºå¹¶éæ¯ç§é¢å‘å¯¹è±¡çš„è¯­è¨€éƒ½å…·æœ‰åŠ¨æ€æ•°ç»„ã€‚ è¿™äº›ç¤ºä¾‹æ˜¯ç”¨PHPç¼–å†™çš„ï¼Œå› ä¸ºå®ƒç±»ä¼¼äºJavaï¼ˆæ‚¨å¯èƒ½å·²ç»ç†Ÿæ‚‰ï¼‰ï¼Œä½†æ˜¯ä½¿ç”¨åŠ¨æ€æ•°ç»„è€Œä¸æ˜¯å†…ç½®çš„é›†åˆç±»å’Œæ¥å£ã€‚ <br><a name="habracut"></a><br><h2> ä½¿ç”¨æ•°ç»„ä½œä¸ºåˆ—è¡¨ </h2><br><h4> æ‰€æœ‰é¡¹ç›®éƒ½å¿…é¡»æ˜¯åŒä¸€ç±»å‹ã€‚ </h4><br> å¦‚æœå°†æ•°ç»„ç”¨ä½œåˆ—è¡¨ï¼ˆæŒ‰ä¸€å®šé¡ºåºæ’åˆ—çš„å€¼çš„é›†åˆï¼‰ï¼Œåˆ™æ‰€æœ‰å€¼éƒ½å¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼š <br><br><pre><code class="php hljs">$goodList = [ <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span> ]; $badList = [ <span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ];</code> </pre> <br> å¸¸è§çš„åˆ—è¡¨ç±»å‹æ³¨é‡Šæ ·å¼ä¸ºï¼š <code>@var array&lt;TypeOfElment&gt;</code> ã€‚ ç¡®ä¿ä¸æ·»åŠ ç´¢å¼•ç±»å‹ï¼Œå®ƒåº”è¯¥å§‹ç»ˆä¸º<code>int</code> ã€‚ <br><br><h4> éœ€è¦å¿½ç•¥æ¯ä¸ªé¡¹ç›®çš„ç´¢å¼• </h4><br>  PHPå°†ä¸ºæ¯ä¸ªåˆ—è¡¨é¡¹ï¼ˆ0ã€1ã€2ç­‰ï¼‰è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°ç´¢å¼•ã€‚ ä½†æ˜¯ï¼Œæ‚¨æ—¢ä¸åº”ä¾èµ–è¿™äº›ç´¢å¼•ï¼Œä¹Ÿä¸åº”ç›´æ¥ä½¿ç”¨å®ƒä»¬ã€‚ å®¢æˆ·åªèƒ½ä¾é <code>iterable</code>å’Œ<code>countable</code> ã€‚ <br><br> å› æ­¤ï¼Œæ‚¨å¯ä»¥è‡ªç”±ä½¿ç”¨<code>foreach</code>å’Œ<code>count()</code> ï¼Œä½†ä¸è¦ä½¿ç”¨<code>for</code>åœ¨åˆ—è¡¨é¡¹ä¹‹é—´å¾ªç¯ï¼š <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// Good loop: foreach ($list as $element) { } // Bad loop (exposes the index of each element): foreach ($list as $index =&gt; $element) { } // Also bad loop (the index of each element should not be used): for ($i = 0; $i &lt; count($list); $i++) { }</span></span></code> </pre> <br> åœ¨PHPä¸­ï¼Œå¦‚æœåˆ—è¡¨ä¸­æ²¡æœ‰ç´¢å¼•ï¼Œæˆ–è€…ç´¢å¼•æ•°å¤§äºå…ƒç´ æ•°ï¼Œåˆ™<code>for</code>å¾ªç¯å¯èƒ½æ ¹æœ¬æ— æ³•å·¥ä½œã€‚ <br><br><h4> ä½¿ç”¨è¿‡æ»¤å™¨è€Œä¸æ˜¯åˆ é™¤é¡¹ç›® </h4><br> æ‚¨å¯èƒ½å¸Œæœ›æŒ‰ç´¢å¼•ï¼ˆ <code>unset()</code> ï¼‰åˆ é™¤é¡¹ç›®ï¼Œä½†æ˜¯ä¸å…¶åˆ é™¤ï¼Œä¸å¦‚ä½¿ç”¨<code>array_filter()</code>åˆ›å»ºä¸€ä¸ªæ²¡æœ‰å¤šä½™å…ƒç´ çš„æ–°åˆ—è¡¨æ›´å¥½ã€‚ <br><br> åŒæ ·ï¼Œä¸åº”ä¾èµ–å…ƒç´ ç´¢å¼•ã€‚ å› æ­¤ï¼Œåœ¨ä½¿ç”¨<code>array_filter()</code>è¯·å‹¿ä½¿ç”¨<a href="https://www.php.net/manual/en/function.array-filter.php">flagå‚æ•°</a>æ¥æŒ‰ç´¢å¼•ç”šè‡³æŒ‰å…ƒç´ å’Œç´¢å¼•è¿‡æ»¤æ‰å…ƒç´ ã€‚ <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// Good filter: array_filter( $list, function (string $element): bool { return strlen($element) &gt; 2; } ); // Bad filter (uses the index to filter elements as well) array_filter( $list, function (int $index): bool { return $index &gt; 3; }, ARRAY_FILTER_USE_KEY ); // Bad filter (uses both the index and the element to filter elements) array_filter( $list, function (string $element, int $index): bool { return $index &gt; 3 || $element === 'Include'; }, ARRAY_FILTER_USE_BOTH );</span></span></code> </pre><br><h2> å°†æ•°ç»„ç”¨ä½œå…³è”æ•°ç»„ </h2><br> å¦‚æœé”®æ˜¯ç›¸å…³çš„è€Œä¸æ˜¯ç´¢å¼•ï¼ˆ0ã€1ã€2ç­‰ï¼‰ï¼Œåˆ™å¯ä»¥è‡ªç”±ä½¿ç”¨å…³è”æ•°ç»„ï¼ˆå¯ä»¥é€šè¿‡é”®çš„å”¯ä¸€é”®ä»ä¸­æå–å€¼çš„é›†åˆï¼‰ã€‚ <br><br><h4> æ‰€æœ‰å¯†é’¥å¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»å‹ã€‚ </h4><br> ä½¿ç”¨å…³è”æ•°ç»„çš„ç¬¬ä¸€æ¡è§„åˆ™ï¼šæ‰€æœ‰é”®å¿…é¡»å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼ˆæœ€å¸¸è§çš„æ˜¯<code>string</code> ï¼‰ã€‚ <br><br><pre> <code class="php hljs">$goodMap = [ <span class="hljs-string"><span class="hljs-string">'foo'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'bar'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'baz'</span></span> ]; <span class="hljs-comment"><span class="hljs-comment">// Bad (uses different types of keys) $badMap = [ 'foo' =&gt; 'bar', 1 =&gt; 'baz' ];</span></span></code> </pre><br><h3> æ‰€æœ‰å€¼éƒ½å¿…é¡»æ˜¯åŒä¸€ç±»å‹ã€‚ </h3><br> å€¼åŒæ ·é€‚ç”¨ï¼šå®ƒä»¬å¿…é¡»æ˜¯åŒä¸€ç±»å‹ã€‚ <br><br><pre> <code class="php hljs">$goodMap = [ <span class="hljs-string"><span class="hljs-string">'foo'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'bar'</span></span>, <span class="hljs-string"><span class="hljs-string">'bar'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'baz'</span></span> ]; <span class="hljs-comment"><span class="hljs-comment">// Bad (uses different types of values) $badMap = [ 'foo' =&gt; 'bar', 'bar' =&gt; 1 ];</span></span></code> </pre> <br> æ³¨é‡Šç±»å‹çš„å¸¸è§æ ·å¼æ˜¯ï¼š <code>@var array&lt;TypeOfKy, TypeOfValue&gt;</code> ã€‚ <br><br><h4> å…³è”æ•°ç»„å¿…é¡»ä¿æŒç§æœ‰ </h4><br> åˆ—è¡¨ç”±äºå…¶ç‰¹æ€§çš„ç®€å•æ€§ï¼Œå¯ä»¥å®‰å…¨åœ°ä»ä¸€ä¸ªå¯¹è±¡è½¬ç§»åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚ å³ä½¿åˆ—è¡¨ä¸ºç©ºï¼Œä»»ä½•å®¢æˆ·ç«¯éƒ½å¯ä»¥å¾ªç¯æµè§ˆå…ƒç´ æˆ–å¯¹å…¶è¿›è¡Œè®¡æ•°ã€‚ ç”±äºå®¢æˆ·å¯ä»¥ä¾èµ–ä¸ä»»ä½•å€¼éƒ½ä¸åŒ¹é…çš„é”®ï¼Œå› æ­¤ä½¿ç”¨Mapæ›´åŠ å›°éš¾ã€‚ è¿™æ„å‘³ç€å…³è”æ•°ç»„é€šå¸¸åº”ç›¸å¯¹äºç®¡ç†å®ƒä»¬çš„å¯¹è±¡ä¿æŒç§æœ‰ã€‚ è€Œä¸æ˜¯è®©å®¢æˆ·ç«¯ç›´æ¥è®¿é—®å†…éƒ¨æ˜ å°„ï¼Œè€Œæ˜¯è®©getterï¼ˆå¯èƒ½è¿˜æœ‰setterï¼‰æ£€ç´¢å€¼ã€‚ å¦‚æœè¯·æ±‚çš„é”®æ²¡æœ‰å€¼ï¼Œåˆ™å¼•å‘å¼‚å¸¸ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨å¯ä»¥å°†åœ°å›¾åŠå…¶å€¼å®Œå…¨è®¾ä¸ºç§æœ‰ï¼Œè¯·æ‰§è¡Œæ­¤æ“ä½œã€‚ <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// Exposing a list is fine /** * @return array&lt;User&gt; */ public function allUsers(): array { // ... } // Exposing a map may be troublesome /** * @return array&lt;string, User&gt; */ public function usersById(): array { // ... } // Instead, offer a method to retrieve a value by its key /** * @throws UserNotFound */ public function userById(string $id): User { // ... }</span></span></code> </pre><br><h2> å°†å¯¹è±¡ç”¨ä½œå…·æœ‰å¤šç§ç±»å‹å€¼çš„å…³è”æ•°ç»„ </h2><br> å¦‚æœè¦ä½¿ç”¨å…³è”æ•°ç»„ï¼Œä½†è¦åœ¨å…¶ä¸­å­˜å‚¨ä¸åŒç±»å‹çš„å€¼ï¼Œè¯·ä½¿ç”¨å¯¹è±¡ã€‚ å®šä¹‰ä¸€ä¸ªç±»ï¼Œæ·»åŠ å…¬å…±ç±»å‹å±æ€§ï¼Œæˆ–æ·»åŠ ä¸€ä¸ªæ„é€ å‡½æ•°å’Œè·å–æ–¹æ³•ã€‚ è¿™äº›å¯¹è±¡åŒ…æ‹¬é…ç½®æˆ–å‘½ä»¤å¯¹è±¡ï¼š <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SillyRegisterUserCommand</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string $username; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> string $plainTextPassword; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool $wantsToReceiveSpam; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> int $answerToIAmNotARobotQuestion; }</code> </pre><br><h4> è§„åˆ™ä¾‹å¤– </h4><br> åº“å’Œæ¡†æ¶æœ‰æ—¶éœ€è¦æ›´åŠ¨æ€åœ°ä½¿ç”¨æ•°ç»„ã€‚ è¿™æ ·å°±ä¸å¯èƒ½ï¼ˆä¹Ÿä¸å¸Œæœ›ï¼‰éµå¾ªä»¥å‰çš„è§„åˆ™ã€‚ ç¤ºä¾‹åŒ…æ‹¬å­˜å‚¨åœ¨æ•°æ®åº“è¡¨ä¸­<a href="https://matthiasnoback.nl/2018/03/ormless-a-memento-like-pattern-for-object-persistence/">çš„æ•°æ®æ•°ç»„ä»¥åŠ</a> Symfonyä¸­<a href="https://symfony.com/doc/current/forms.html">çš„è¡¨å•é…ç½®</a> ã€‚ <br><br><h2> è‡ªå®šä¹‰é›†åˆç±» </h2><br> è‡ªå®šä¹‰é›†åˆç±»å¯èƒ½æ˜¯ä¸<code>Iterator</code> ï¼Œ <code>ArrayAccess</code>å’Œå…¶ä»–å®ä½“ä¸€èµ·ä½¿ç”¨çš„å¥½å·¥å…·ï¼Œä½†æ˜¯æˆ‘å‘ç°ä»£ç å¸¸å¸¸ä»¤äººå›°æƒ‘ã€‚ åˆæ¬¡çœ‹ä»£ç çš„ä»»ä½•äººéƒ½å¿…é¡»æŸ¥é˜…PHPæ‰‹å†Œï¼Œå³ä½¿ä»–æ˜¯ä¸€ä½ç»éªŒä¸°å¯Œçš„å¼€å‘äººå‘˜ã€‚ æ­¤å¤–ï¼Œæ‚¨å°†ä¸å¾—ä¸ç¼–å†™æ›´å¤šä»£ç è¿›è¡Œç»´æŠ¤ï¼ˆæµ‹è¯•ï¼Œè°ƒè¯•ç­‰ï¼‰ã€‚ å› æ­¤ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå…·æœ‰æ­£ç¡®ç±»å‹æ³¨é‡Šçš„ç®€å•æ•°ç»„å°±è¶³å¤Ÿäº†ã€‚ <br><br> ä»€ä¹ˆè¡¨æ˜æ‚¨éœ€è¦å°†æ•°ç»„åŒ…è£…åœ¨è‡ªå®šä¹‰é›†åˆå¯¹è±¡ä¸­ï¼Ÿ <br><br><ul><li> ä¸æ•°ç»„æœ‰å…³çš„é€»è¾‘é‡å¤ã€‚ <br></li><li> å®¢æˆ·å¿…é¡»å¤„ç†æœ‰å…³æ•°ç»„å†…å®¹çš„å¤ªå¤šç»†èŠ‚ã€‚ <br></li></ul><br><h4> ä½¿ç”¨è‡ªå®šä¹‰é›†åˆç±»æ¥é˜²æ­¢é‡å¤é€»è¾‘ã€‚ </h4><br> å¦‚æœä½¿ç”¨åŒä¸€é˜µåˆ—çš„å¤šä¸ªå®¢æˆ·ç«¯æ‰§è¡Œç›¸åŒçš„ä»»åŠ¡ï¼ˆä¾‹å¦‚ï¼Œè¿‡æ»¤ï¼Œæ¯”è¾ƒï¼Œå‡å°‘ï¼Œè®¡æ•°ï¼‰ï¼Œåˆ™å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰é›†åˆç±»åˆ é™¤é‡å¤é¡¹ã€‚ å°†é‡å¤çš„é€»è¾‘è½¬ç§»åˆ°é›†åˆç±»æ–¹æ³•å¯ä»¥ä½¿ä»»ä½•å®¢æˆ·ç«¯ä»…é€šè¿‡è°ƒç”¨é›†åˆæ–¹æ³•å³å¯æ‰§è¡Œç›¸åŒçš„ä»»åŠ¡ï¼š <br><br><pre> <code class="php hljs">$names = [<span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// Found in several places: $shortNames = array_filter( $names, function (string $element): bool { return strlen($element) &lt; 5; } ); // Turned into a custom collection class: use Assert\Assert; final class Names { /** * @var array&lt;string&gt; */ private array $names; public function __construct(array $names) { Assert::that()-&gt;allIsString($names); $this-&gt;names = $names; } public function shortNames(): self { return new self( array_filter( $this-&gt;names, function (string $element): bool { return strlen($element) &lt; 5; } ) ); } } $names = new Names([/* ... */]); $shortNames = $names-&gt;shortNames();</span></span></code> </pre> <br> ä½¿ç”¨æ–¹æ³•è½¬æ¢é›†åˆçš„ä¼˜ç‚¹æ˜¯ï¼Œå‘½åäº†æ­¤è½¬æ¢ã€‚ æ‚¨å¯ä»¥ä¸ºè°ƒç”¨<code>array_filter()</code>æ·»åŠ ä¸€ä¸ªç®€çŸ­çš„ä¿¡æ¯æ€§åç§°ï¼Œå¦åˆ™å¾ˆéš¾æ‰¾åˆ°ã€‚ <br><br><h4> å–æ¶ˆå®¢æˆ·ä¸è‡ªå®šä¹‰é›†åˆç±»çš„ç»‘å®š </h4><br> å¦‚æœå®¢æˆ·ç«¯éå†æ•°ç»„ï¼Œä»æ‰€é€‰å…ƒç´ ä¸­è·å–éƒ¨åˆ†æ•°æ®å¹¶å¯¹å®ƒä»¬æ‰§è¡ŒæŸäº›æ“ä½œï¼Œåˆ™è¯¥å®¢æˆ·ç«¯å°†ä¸æ‰€æœ‰ç›¸åº”ç±»å‹ç´§å¯†ç›¸å…³ï¼šæ•°ç»„ï¼Œå…ƒç´ ï¼Œæ£€ç´¢åˆ°çš„å€¼ï¼Œé€‰æ‹©å™¨æ–¹æ³•ç­‰ã€‚ç”±äºå­˜åœ¨å¦‚æ­¤æ·±çš„ç»‘å®šï¼Œæ‚¨åœ¨ä¸ç ´åå®¢æˆ·ç«¯çš„æƒ…å†µä¸‹æ›´æ”¹ä¸è¿™äº›ç±»å‹ç›¸å…³çš„ä»»ä½•å†…å®¹å°†å˜å¾—æ›´åŠ å›°éš¾ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨è¿˜å¯ä»¥å°†æ•°ç»„åŒ…è£…åœ¨è‡ªå®šä¹‰é›†åˆç±»ä¸­ï¼Œå¹¶ç»™å‡ºæ­£ç¡®çš„ç­”æ¡ˆï¼Œåœ¨å†…éƒ¨æ‰§è¡Œå¿…è¦çš„è®¡ç®—ï¼Œç„¶åæ”¾æ¾å®¢æˆ·å¯¹é›†åˆçš„ç»‘å®šã€‚ <br><br><pre> <code class="php hljs">$lines = []; $sum = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($lines <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $line) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($line-&gt;isComment()) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } $sum += $line-&gt;quantity(); } <span class="hljs-comment"><span class="hljs-comment">// Turned into a custom collection class: final class Lines { public function totalQuantity(): int { $sum = 0; foreach ($lines as $line) { if ($line-&gt;isComment()) { continue; } $sum += $line-&gt;quantity(); } return $sum; } }</span></span></code> </pre><br><h2> è‡ªå®šä¹‰é›†åˆç±»çš„ä¸€äº›è§„åˆ™ </h2><br><h4> ä½¿å®ƒä»¬ä¸å˜ </h4><br> æ‰§è¡Œæ­¤ç±»è½¬æ¢æ—¶ï¼Œå¯¹é›†åˆå®ä¾‹çš„ç°æœ‰å¼•ç”¨ä¸åº”å—åˆ°å½±å“ã€‚ å› æ­¤ï¼Œä»»ä½•æ‰§è¡Œæ­¤è½¬æ¢çš„æ–¹æ³•éƒ½åº”è¿”å›è¯¥ç±»çš„æ–°å®ä¾‹ï¼Œå¦‚ä¸Šä¾‹æ‰€ç¤ºï¼š <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Names</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> array&lt;string&gt; */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> $names; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $names)</span></span></span><span class="hljs-function"> </span></span>{ Assert::that()-&gt;allIsString($names); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;names = $names; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shortNames</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">self</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>( <span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span> ); } }</code> </pre> <br> å½“ç„¶ï¼Œå¦‚æœè½¬æ¢å†…éƒ¨æ•°ç»„ï¼Œåˆ™å¯ä»¥è½¬æ¢ä¸ºå…¶ä»–ç±»å‹çš„é›†åˆæˆ–ç®€å•æ•°ç»„ã€‚ ä¸å¾€å¸¸ä¸€æ ·ï¼Œè¯·ç¡®ä¿è¿”å›æ­£ç¡®çš„ç±»å‹ã€‚ <br><br><h4> åªæä¾›å®¢æˆ·çœŸæ­£éœ€è¦çš„è¡Œä¸º </h4><br> ä»…å®ç°æ‚¨çœŸæ­£éœ€è¦çš„ï¼Œè€Œä¸æ˜¯ä»å…·æœ‰é€šç”¨é›†åˆçš„åº“ä¸­æ‰©å±•ç±»ï¼Œæˆ–è€…å®ç°é€šç”¨è¿‡æ»¤å™¨æˆ–æ˜ å°„ï¼Œä»¥åŠä¸ºæ¯ä¸ªè‡ªå®šä¹‰é›†åˆç±»è¿›è¡Œç¼©å‡ï¼Œè€Œä¸å¿…å®ç°ã€‚ å¦‚æœåœ¨æŸä¸ªæ—¶å€™åœæ­¢ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œåˆ™å°†å…¶åˆ é™¤ã€‚ <br><br><h4> ä½¿ç”¨IteratorAggregateå’ŒArrayIteratorè¿›è¡Œè¿­ä»£ </h4><br> å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯PHPï¼Œåˆ™ä¸è¦å®ç°<code>Iterator</code>æ¥å£çš„æ‰€æœ‰æ–¹æ³•ï¼ˆä¿å­˜å†…éƒ¨æŒ‡é’ˆç­‰ï¼‰ï¼Œè€Œæ˜¯ä»…å®ç°<code>IteratorAggregate</code>æ¥å£ï¼Œå¹¶ä½¿å…¶åŸºäºå†…éƒ¨æ•°ç»„è¿”å›<code>ArrayIterator</code>å®ä¾‹ï¼š <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Names</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IteratorAggregate</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> array&lt;string&gt; */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span> $names; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $names)</span></span></span><span class="hljs-function"> </span></span>{ Assert::that()-&gt;allIsString($names); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;names = $names; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIterator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Iterator</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayIterator(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;names); } } $names = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Names([<span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($names <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $name) { <span class="hljs-comment"><span class="hljs-comment">// ... }</span></span></code> </pre><br><h4> å¦¥å </h4><br> ç”±äºæ‚¨æ­£åœ¨ä¸ºè‡ªå®šä¹‰é›†åˆç±»ç¼–å†™æ›´å¤šä»£ç ï¼Œå› æ­¤å®¢æˆ·ç«¯åº”è¯¥æ›´è½»æ¾åœ°ä½¿ç”¨æ­¤é›†åˆï¼ˆè€Œä¸ä»…ä»…æ˜¯æ•°ç»„ï¼‰ã€‚ å¦‚æœå®¢æˆ·ç«¯ä»£ç å˜å¾—æ›´åŠ æ¸…æ™°ï¼Œå¦‚æœé›†åˆæä¾›äº†æœ‰ç”¨çš„è¡Œä¸ºï¼Œé‚£ä¹ˆè¿™è¯æ˜äº†ç»´æŠ¤è‡ªå®šä¹‰é›†åˆç±»çš„é¢å¤–åŠªåŠ›æ˜¯åˆç†çš„ã€‚ ä½†æ˜¯ç”±äºä½¿ç”¨åŠ¨æ€æ•°ç»„éå¸¸å®¹æ˜“ï¼ˆä¸»è¦æ˜¯å› ä¸ºæ‚¨ä¸éœ€è¦æŒ‡å®šä½¿ç”¨çš„ç±»å‹ï¼‰ï¼Œæ‰€ä»¥æˆ‘å¾ˆå°‘ä½¿ç”¨é›†åˆç±»ã€‚ ä½†æ˜¯ï¼Œä¸€äº›å¼€å‘äººå‘˜æ­£åœ¨ç§¯æä½¿ç”¨å®ƒä»¬ï¼Œå› æ­¤ï¼Œæˆ‘ä¸€å®šä¼šç»§ç»­å¯»æ‰¾å¯èƒ½çš„ç”¨ä¾‹ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN484336/">https://habr.com/ru/post/zh-CN484336/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN484320/index.html">åœ¨Quarkusï¼ŒKotlinå’ŒGradleä¸Šåˆ›å»ºå¾®æœåŠ¡</a></li>
<li><a href="../zh-CN484326/index.html">è·³è½¬åˆ°ä¼¦æ•¦æˆ–åœ¨è·³è½¬è´¸æ˜“å…¬å¸å®ä¹ </a></li>
<li><a href="../zh-CN484328/index.html">ä¿ç½—Â·æ ¼é›·å„å§†ï¼ˆPaul Grahamï¼‰å®£å¸ƒæ–°çš„Belç¼–ç¨‹è¯­è¨€</a></li>
<li><a href="../zh-CN484330/index.html">[Nginx]å¦‚ä½•å‡»è´¥response_status = 0</a></li>
<li><a href="../zh-CN484332/index.html">ä¸“æ³¨äºä»»åŠ¡ç®¡ç†ã€‚ æˆ‘ä»¬å¦‚ä½•åšæˆ‘ä»¬çš„ç®¡ç†ç³»ç»Ÿ</a></li>
<li><a href="../zh-CN484338/index.html">ä¸‰æ˜Ÿçš„éœ“è™¹ç¯é¡¹ç›®ï¼šæ•°å­—é“¶è¡Œå®¶ï¼Œç”µè§†èŠ‚ç›®ä¸»æŒäººï¼ŒåŒä¼´</a></li>
<li><a href="../zh-CN484340/index.html">1æœˆ17æ—¥çš„Javaæ‘˜è¦ã€‚ æ–°å¹´çš„å‰ä¸¤å‘¨</a></li>
<li><a href="../zh-CN484342/index.html">åŸºäºEclipseå’ŒGTK +çš„å·¥å…·åŒ…ï¼Œç”¨äºâ€œ Toradex Colibri T20ï¼ˆLinuxï¼‰â€</a></li>
<li><a href="../zh-CN484344/index.html">Kubernetesä¸­è‡ªåŠ¨ç¼©æ”¾çš„ä¸‰ä¸ªçº§åˆ«ï¼šå¦‚ä½•æœ‰æ•ˆä½¿ç”¨å®ƒä»¬</a></li>
<li><a href="../zh-CN484356/index.html">ä¸€ä¸ªå‹å¥½çš„å›¢é˜Ÿä¸­ä¸€ä¸ªæœ‰è¶£çš„é¡¹ç›®ï¼Œæˆ–è€…åˆé€‚çš„å‘˜å·¥è¦èŠ±å¤šå°‘é’±ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>