<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéûÔ∏è üë®üèΩ‚Äçüé® üè¥ Un editor de texto no es su mejor matem√°tica, aqu√≠ debe pensar üë©üèø‚Äçü§ù‚Äçüë®üèº üë©üèΩ‚Äçüíª ü•Å</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los editores de texto modernos no solo pueden emitir pitidos y no abandonar el programa. Resulta que un metabolismo muy complejo hierve dentro de ello...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un editor de texto no es su mejor matem√°tica, aqu√≠ debe pensar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/424763/">  Los editores de texto modernos no solo pueden emitir pitidos y no abandonar el programa.  Resulta que un metabolismo muy complejo hierve dentro de ellos.  Desea saber qu√© trucos se est√°n haciendo para recalcular r√°pidamente las coordenadas, c√≥mo se adjuntan los estilos, los pliegues y los softwraps al texto y c√≥mo se actualiza todo, qu√© tiene que ver con la estructura de datos funcional y la cola de prioridad, y c√≥mo enga√±ar al usuario: ¬°bienvenido al gato! <br><br><img src="https://habrastorage.org/webt/sr/i0/vg/sri0vg3jog_-mc16jc5zz-wjxw0.jpeg"><br><br>  El art√≠culo se basa en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe de</a> Alexei Kudryavtsev con Joker 2017. Alexei ha estado escribiendo Intellij IDEA en JetBrains durante aproximadamente 10 a√±os.  Debajo del corte, encontrar√° la transcripci√≥n de video y texto del informe. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YzWr9CN6cGQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h1>  Estructuras de datos dentro de editores de texto </h1><br>  Para entender c√≥mo funciona el editor, escrib√°moslo. <br><br><img src="https://habrastorage.org/webt/q9/nb/-n/q9nb-nr675yuu19v6loydkq3nrm.png"><br><br>  Eso es todo, nuestro editor m√°s simple est√° listo. <br><br>  Dentro del editor, el texto es m√°s f√°cil de almacenar en una variedad de caracteres o, lo que es lo mismo (en t√©rminos de organizaci√≥n de la memoria), en la clase Java StringBuffer.  Para obtener algunos caracteres por desplazamiento, llamamos al m√©todo StringBuffer.charAt (i).  Y para insertar en √©l el car√°cter que escribimos en el teclado, llamamos al m√©todo StringBuffer.insert (), que inserta el car√°cter en alg√∫n lugar en el medio. <br><br>  Lo m√°s interesante, a pesar de toda la simplicidad e idiotez de este editor, es la mejor idea que puede inventar.  Es a la vez simple y casi siempre r√°pido. <br><br>  Desafortunadamente, surge un problema de escala con este editor.  Imagine que imprimimos mucho texto en √©l y vamos a insertar otra letra en el medio.  Lo siguiente suceder√°.  Necesitamos urgentemente liberar algo de espacio para esta letra moviendo todas las otras letras un car√°cter hacia adelante.  Para hacer esto, cambiamos esta letra por una posici√≥n, luego la siguiente y as√≠ sucesivamente, hasta el final del texto. <br><br>  As√≠ es como se ver√≠a en la memoria: <br><br><img src="https://habrastorage.org/webt/ec/uk/r4/ecukr4oxdmj0tlxojojwuf9k8i4.gif"><br><br>  Cambiar todos estos megabytes no es muy bueno: es lento.  Por supuesto, para una computadora moderna, este es un asunto insignificante: alg√∫n tipo de megabytes pat√©ticos para moverse de un lado a otro.  Pero para un cambio de texto muy activo, esto puede ser notable. <br><br>  Para resolver este problema de insertar un personaje en el medio, hace mucho tiempo surgi√≥ una soluci√≥n llamada "Gap Buffer". <br><br><h3>  Gap buffer </h3><br>  La brecha es la brecha.  El b√∫fer es, como te puedes imaginar, un b√∫fer.  La estructura de datos de Gap Buffer es un buffer tan vac√≠o que mantenemos en el medio de nuestro texto, por si acaso.  Si necesit√°ramos imprimir algo, utilizamos este peque√±o buffer de texto para escribir r√°pidamente. <br><br><img src="https://habrastorage.org/webt/vc/ca/v4/vccav4jbt0zboaf_fuo985dzerc.png"><br><br>  La estructura de datos ha cambiado un poco: la matriz se ha mantenido en su lugar, pero han aparecido dos punteros: al principio del b√∫fer y al final.  Para tomar un car√°cter del editor en alg√∫n desplazamiento, necesitamos entender si est√° antes o despu√©s de este b√∫fer y corregir ligeramente el desplazamiento.  Y para insertar un personaje, primero debemos mover el Gap Buffer a este lugar y llenarlo con estos personajes.  Y, por supuesto, si fuimos m√°s all√° de nuestro b√∫fer, recrearlo de alguna manera.  As√≠ es como se ve en la imagen. <br><br><img src="https://habrastorage.org/webt/bu/4a/gs/bu4ags_jk9vobq_9rxegbww01nw.gif"><br><br>  Como puede ver, primero nos movemos durante mucho tiempo en un peque√±o espacio intermedio (rect√°ngulo azul) a la ubicaci√≥n de edici√≥n (simplemente intercambiando los caracteres de sus bordes izquierdo y derecho a su vez).  Luego usamos este b√∫fer, escribiendo caracteres all√≠. <br><br>  Como puede ver, no hay movimiento de megabytes de caracteres, el inserto es muy r√°pido, por un tiempo constante, y parece que todos est√°n contentos.  Todo parece estar bien, pero si nuestro procesador es muy lento, se desperdicia un tiempo bastante notable moviendo el espacio intermedio y el texto de un lado a otro.  Esto fue especialmente notable en el momento de megahercios muy peque√±os. <br><br><h3>  Mesa de piezas </h3><br>  Justo en ese momento, una corporaci√≥n llamada Microsoft escribi√≥ un editor de texto Word.  Decidieron aplicar otra idea para acelerar la edici√≥n llamada "Tabla de piezas", es decir, "Tabla de piezas".  Y propusieron guardar el texto del editor en el mismo conjunto de caracteres m√°s simple, que no cambiar√°, y colocar todos sus cambios en una tabla separada de estas piezas muy editadas. <br><br><img src="https://habrastorage.org/webt/gf/gt/gu/gfgtgutww7ymm-bx-4v7tytyjt4.png"><br><br>  Por lo tanto, si necesitamos encontrar alg√∫n car√°cter por desplazamiento, necesitamos encontrar esta pieza que hemos editado y extraer este car√°cter, y si no est√° all√≠, vaya al texto original.  Insertar un s√≠mbolo se vuelve m√°s f√°cil, solo necesitamos crear y agregar esta nueva pieza a la tabla.  As√≠ es como se ve en la imagen: <br><br><img src="https://habrastorage.org/webt/94/8w/3u/948w3uylg_cuxh8mywws-owxs_i.gif"><br><br>  Aqu√≠ quer√≠amos eliminar el espacio en el desplazamiento 5. Para hacer esto, agregamos dos piezas nuevas a la tabla de sectores: una indica el primer fragmento ("Bummer") y la segunda indica el fragmento despu√©s de la edici√≥n ("oveja").  Resulta que la brecha de ellos desaparece, estas dos piezas se pegan y obtenemos un nuevo texto sin espacio: "Oblomovtsy".  Luego agregamos el nuevo texto ("sufriendo de Oblomovismo") hasta el final.  Use un b√∫fer adicional y agregue una nueva divisi√≥n a la tabla de piezas que apunte a este nuevo texto agregado. <br><br>  Como puede ver, no hay movimiento de ida y vuelta, todo el texto permanece en su lugar.  La mala noticia es que cada vez es m√°s dif√≠cil llegar al s√≠mbolo, porque clasificar todas estas piezas es bastante dif√≠cil. <br><br>  Para resumir. <br><br>  Lo bueno de <b>Piece Table</b> : <br><br><ul><li>  Incrustar r√°pidamente; </li><li>  F√°cil de deshacer; </li><li>  Solo anexar. </li></ul><br>  Lo que es malo: <br><br><ul><li>  Es terriblemente dif√≠cil acceder a un documento; </li><li>  Es terriblemente dif√≠cil de implementar. </li></ul><br>  Veamos a qui√©n usamos generalmente para qu√©. <br><br>  NetBeans, Eclipse y Emacs usan Gap Buffer - ¬°bien hecho!  Vi no molesta y usa solo una lista de l√≠neas.  Word usa la Tabla de piezas (recientemente presentaron sus g√©neros antiguos y all√≠ incluso puedes entender algo). <br><br>  Atom es m√°s interesante.  Hasta hace poco, no se molestaban y usaban una lista de l√≠neas de JavaScript.  Y luego decidieron reescribir todo en C ++ y acumularon una estructura bastante complicada, que parece ser similar a la Tabla de piezas.  Pero estas piezas no se almacenan en la lista, sino en el √°rbol, y en el llamado √°rbol de separaci√≥n: este es un √°rbol que se autoajusta cuando se inserta en √©l, de modo que las inserciones recientes son m√°s r√°pidas.  Hicieron algo muy complicado. <br><br>  ¬øQu√© usa Intellij IDEA? <br>  No, no gap-buffer.  No, tambi√©n te equivocas, no una mesa de piezas. <br>  S√≠, muy bien, tu propia bicicleta. <br><br>  El hecho es que los requisitos del IDE para almacenar texto son ligeramente diferentes a los de un editor de texto normal.  El IDE necesita soporte para varias cosas dif√≠ciles como la competitividad, es decir, el acceso paralelo al texto desde el editor.  Por ejemplo, para que muchos productos horneados diferentes puedan leerlo y hacer algo.  (La inspecci√≥n es un peque√±o fragmento de c√≥digo que analiza el programa de una forma u otra, por ejemplo, buscando lugares que arrojen una NullPointerException).  IDE tambi√©n necesita soporte de versi√≥n de texto editable.  Varias versiones est√°n simult√°neamente en la memoria mientras trabaja con un documento para que estos largos procesos contin√∫en analizando la versi√≥n anterior. <br><br><h1>  Los problemas </h1><br><h3>  Competitividad / Versionado </h3><br>  Para mantener el paralelismo, las operaciones de texto generalmente se envuelven en "sincronizado" o en bloqueos de lectura / escritura.  Desafortunadamente, esto no escala muy bien.  Otro enfoque es el texto inmutable, es decir, un repositorio de texto inmutable. <br><br><img src="https://habrastorage.org/webt/ov/ia/sa/oviasaeniuwmhiaebpsic_mxm88.png"><br><br>  As√≠ es como se ve un editor con un documento inmutable como estructura de datos de soporte. <br><br>  ¬øC√≥mo funciona la estructura de datos? <br><br>  En lugar de una matriz de caracteres, tendremos un nuevo objeto de tipo ImmutableText, que almacena texto en forma de √°rbol, donde se almacenan peque√±as subcadenas en las hojas.  Cuando accede a alg√∫n desplazamiento, intenta alcanzar la hoja inferior de este √°rbol, y ya se le preguntar√° el s√≠mbolo al que nos refer√≠amos.  Y cuando inserta texto, crea un nuevo √°rbol y lo guarda en el lugar anterior. <br><br><img src="https://habrastorage.org/webt/_2/xx/rh/_2xxrh9kohjwodn3ub-gyt2z8la.gif"><br><br>  Por ejemplo, tenemos un documento con el texto "Sin calor√≠as".  Se implementa como un √°rbol con dos hojas de sustituciones "Demonio" y "alto en calor√≠as".  Cuando queremos insertar la l√≠nea "bonita" en el medio, se crea una nueva versi√≥n de nuestro documento.  Y precisamente, se crea una nueva ra√≠z, a la que ya se adjuntan tres hojas: "Demonio", "suficiente" y "alto en calor√≠as".  Adem√°s, dos de estas nuevas hojas pueden referirse a la primera versi√≥n de nuestro documento.  Y para la hoja en la que insertamos la l√≠nea "bonita", se asigna un nuevo v√©rtice.  Aqu√≠, tanto la primera versi√≥n como la segunda versi√≥n est√°n disponibles al mismo tiempo y todas son inmutables, inmutables.  Todo se ve bien. <br><br>  ¬øQui√©n usa qu√© estructuras dif√≠ciles? <br><br><img src="https://habrastorage.org/webt/yf/mt/eh/yfmtehxbzlale_95bblpk2msh2k.jpeg"><br><br>  Por ejemplo, en GNOME, algunos de sus widgets est√°ndar usan una estructura llamada Rope.  Xi-Editor, el nuevo y brillante editor de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Raf Levien</a> , usa Persistent Rope.  E Intellij IDEA usa este √°rbol inmutable.  Detr√°s de todos estos nombres, de hecho, hay m√°s o menos la misma estructura de datos con una representaci√≥n del texto en forma de √°rbol.  Excepto que GtkTextBuffer usa una cuerda mutable, es decir, un √°rbol con v√©rtices mutables, e Intellij IDEA y Xi-Editor - Inmutable. <br><br>  Lo siguiente a considerar al desarrollar un repositorio de caracteres en IDEs modernos se llama multicats.  Esta caracter√≠stica le permite imprimir en varios lugares a la vez, utilizando varios carros. <br><br><img src="https://habrastorage.org/webt/qb/ak/9t/qbak9tqjnu7v_iiciaouw-qqeug.gif"><br><br>  Podemos imprimir algo y, al mismo tiempo, en varios lugares del documento, insertamos lo que imprimimos all√≠.  Si observamos c√≥mo nuestras estructuras de datos, que examinamos, reaccionan a los multicarets, veremos algo interesante. <br><br><img src="https://habrastorage.org/webt/ty/4p/8k/ty4p8kuqs1rgeanxr9y3n9i8wz4.jpeg"><br><br>  Si insertamos un personaje en nuestro primer editor primitivo, naturalmente tomar√° una cantidad lineal de tiempo mover un mont√≥n de caracteres de un lado a otro.  Esto se escribe como O (N).  Para el editor basado en Gap Buffer, a su vez, se requiere tiempo constante, para lo cual fue acu√±ado. <br><br>  Para un √°rbol inmutable, el tiempo depende logar√≠tmicamente del tama√±o, porque primero debe ir desde la parte superior del √°rbol hasta su hoja, este es el logaritmo, y luego, para todos los v√©rtices en el camino, crear nuevos v√©rtices para el nuevo √°rbol, este es nuevamente el logaritmo.  La tabla de piezas tambi√©n requiere una constante. <br>  Pero todo cambia un poco si intentamos medir el tiempo de inserci√≥n de un personaje en un editor con carros m√∫ltiples, es decir, insertar simult√°neamente en varios lugares.  A primera vista, el tiempo parece aumentar proporcionalmente por un factor de C: el n√∫mero de lugares donde se inserta el s√≠mbolo.  Esto es exactamente lo que sucede, con la excepci√≥n de Gap Buffer.  En su caso, el tiempo, en lugar de C veces, aumenta inesperadamente algunas veces C * L incomprensibles, donde L es la distancia promedio entre los carros.  ¬øPor qu√© est√° pasando esto? <br><br>  Imagine que necesitamos insertar la l√≠nea ", en" en dos lugares en nuestro documento. <br><br><img src="https://habrastorage.org/webt/ec/n3/jd/ecn3jdpnsvqscfbvjxivopbs5uq.gif"><br><br>  Esto es lo que sucede en el editor en este momento. <br><br><ul><li>  Cree un espacio intermedio en el editor (un peque√±o rect√°ngulo azul en la imagen); </li><li>  Comenzamos dos carruajes (l√≠neas verticales negras en negrita); </li><li>  Estamos intentando imprimir; </li><li>  Inserte una coma en nuestro Gap Buffer; </li><li>  Ahora debe insertarlo en el lugar del segundo carro; </li><li>  Para hacer esto, necesitamos mover nuestro Gap Buffer a la posici√≥n del pr√≥ximo carro; </li><li>  Imprima una coma en segundo lugar; </li><li>  Ahora debe insertar el siguiente car√°cter en la posici√≥n del primer carro; </li><li>  Y tenemos que empujar nuestro Gap Buffer hacia atr√°s; </li><li>  Inserte la letra "n"; </li><li>  Y trasladamos nuestro tamp√≥n sufrido al lugar del segundo carro; </li><li>  Insertamos nuestra "n" all√≠; </li><li>  Mueva el b√∫fer hacia atr√°s para insertar el siguiente car√°cter. </li></ul><br>  ¬øSientes a d√≥nde va todo? <br><br>  S√≠, resulta que debido a estos numerosos movimientos del b√∫fer de ida y vuelta, nuestro tiempo total aumenta.  Honestamente, no es que est√© directamente horrorizado a medida que ha aumentado: mover megabytes pat√©ticos, gigabytes de un lado a otro para una computadora moderna no es un problema, pero es interesante que esta estructura de datos funcione de manera radicalmente diferente en el caso de multicats. <br><br><h3>  ¬øDemasiadas l√≠neas?  LineSet! </h3><br>  ¬øQu√© otros problemas hay en un editor de texto normal?  El problema m√°s dif√≠cil es desplazarse, es decir, volver a dibujar el editor mientras se mueve el carro a la siguiente l√≠nea. <br><br><img src="https://habrastorage.org/webt/yt/0d/rn/yt0drnu1rsxyciwb4pruefmufyu.gif"><br><br>  Cuando el editor se desplaza, necesitamos entender desde qu√© l√≠nea, desde qu√© s√≠mbolo necesitamos comenzar a dibujar el texto en nuestra peque√±a ventana.  Para hacer esto, necesitamos entender r√°pidamente qu√© l√≠nea corresponde a qu√© desplazamiento. <br><br><img src="https://habrastorage.org/webt/kn/ak/gm/knakgm1aq7-wnjwbruefxeyouh0.png"><br><br>  Hay una interfaz obvia para esto, cuando necesitamos entender su desplazamiento en el texto por n√∫mero de l√≠nea.  Y viceversa, por el desplazamiento en el texto para entender en qu√© l√≠nea se encuentra.  ¬øC√≥mo se puede hacer esto r√°pidamente? <br><br>  Por ejemplo, as√≠: <br><br>  Organice estas l√≠neas en un √°rbol y marque cada v√©rtice de este √°rbol cambiando el comienzo de la l√≠nea y el final de la l√≠nea.  Y luego, para entender por el desplazamiento en qu√© l√≠nea se encuentra, solo necesita ejecutar una b√∫squeda logar√≠tmica en este √°rbol y encontrarlo. <br><br><img src="https://habrastorage.org/webt/x1/jq/3w/x1jq3w1gwiytzsrdytznnltc_l0.png"><br><br>  Otra forma es a√∫n m√°s f√°cil. <br><br>  Escriba en la tabla el desplazamiento del principio de las l√≠neas y el final de las l√≠neas.  Y luego, para encontrar el desplazamiento del principio y el final por el n√∫mero de l√≠nea, deber√° acceder al √≠ndice. <br><br><img src="https://habrastorage.org/webt/wq/ls/wy/wqlswyl-k5brg4fsbgoxaqxkj1u.png"><br><br>  Curiosamente, en el mundo real, se utilizan ambos m√©todos. <br><br><img src="https://habrastorage.org/webt/ii/w6/qu/iiw6quo2j0clh8xnovh0mfn5ow0.jpeg"><br><br>  Por ejemplo, Eclipse utiliza una estructura de madera que, como puede ver, funciona en un tiempo logar√≠tmico tanto para leer como para actualizar.  E IDEA usa una estructura de tabla, para la cual la lectura es una constante r√°pida, es una inversi√≥n de √≠ndice en una tabla, pero la reconstrucci√≥n es bastante lenta, porque necesita reconstruir toda la tabla al cambiar la longitud de una fila. <br><br><h3>  Todav√≠a demasiadas l√≠neas?  Plegamientos! </h3><br>  ¬øQu√© otra cosa es mala que tropieza con los editores de texto?  Por ejemplo, pliegues.  Estos son fragmentos de texto que puede "colapsar" y mostrar algo m√°s en su lugar. <br><br><img src="https://habrastorage.org/webt/tp/g1/fc/tpg1fcoak4ahpzd1mbf9wex_jvi.png"><br><br>  Estos puntos sobre un fondo verde en la imagen ocultan muchos s√≠mbolos detr√°s de nosotros, pero si no estamos interesados ‚Äã‚Äãen mirarlos (como en el caso de, por ejemplo, los documentos Java m√°s aburridos o las listas de importaci√≥n), los ocultamos, los colapsamos puntos suspensivos <br><br>  Y aqu√≠, nuevamente, debe comprender cu√°ndo termina y cu√°ndo comienza la regi√≥n que debemos mostrar, y c√≥mo actualizar todo r√°pidamente.  C√≥mo se organiza esto, lo contar√© un poco m√°s tarde. <br><br><h3>  ¬øDemasiadas colas?  Envoltura suave! </h3><br><img src="https://habrastorage.org/webt/yu/lb/hg/yulbhgos7wf3ilx0gqtxg2lrkpq.jpeg"><br><br>  Adem√°s, los editores modernos no pueden vivir sin Soft wrap.  La imagen muestra que el desarrollador abri√≥ el archivo JavaScript despu√©s de la minimizaci√≥n e inmediatamente lo lament√≥.  Esta enorme l√≠nea de JavaScript, cuando intentamos mostrarla en el editor, no cabe en ninguna pantalla.  Por lo tanto, una envoltura suave lo rompe a la fuerza en varias l√≠neas y lo empuja hacia la pantalla. <br>  C√≥mo est√° organizado, m√°s tarde. <br><br><h3>  Muy poca belleza </h3><br><img src="https://habrastorage.org/webt/md/yh/d0/mdyhd06genl8kiaehxjectze9g4.jpeg"><br><br>  Y finalmente, tambi√©n quiero aportar belleza a los editores de texto.  Por ejemplo, resalte algunas palabras.  En la imagen de arriba, las palabras clave se resaltan en negrita azul, algunos m√©todos est√°ticos en cursiva, algunas anotaciones, tambi√©n en un color diferente. <br><br>  Entonces, ¬øc√≥mo almacena y procesa los pliegues, envolturas suaves y reflejos? <br>  Resulta que todo esto, en principio, es una y la misma tarea. <br><br><h3>  ¬øMuy poca belleza?  Marcadores de rango! </h3><br><img src="https://habrastorage.org/webt/jj/rl/t7/jjrlt7sisz9curcqa5lotpzjfya.jpeg"><br><br>  Para admitir todas estas caracter√≠sticas, todo lo que debemos poder hacer es pegar algunos atributos de texto en un desplazamiento dado en el texto, por ejemplo, color, fuente o texto para plegar.  Adem√°s, estos atributos de texto deben actualizarse todo el tiempo en este lugar para que sobrevivan a todo tipo de inserciones y eliminaciones. <br><br>  ¬øC√≥mo se implementa esto generalmente?  Naturalmente, en forma de √°rbol. <br><br><h3>  Problema: ¬ødemasiada belleza?  √Årbol de intervalos! </h3><br><img src="https://habrastorage.org/webt/0e/ux/le/0euxleajuom5pdsa02kwxuudyny.jpeg"><br><br>  Por ejemplo, aqu√≠ tenemos varios resaltados amarillos que queremos mantener en el texto.  Agregamos los intervalos de estos aspectos destacados en un √°rbol de b√∫squeda, el llamado √°rbol de intervalos.  Este es el mismo √°rbol de b√∫squeda, pero un poco m√°s complicado porque necesitamos almacenar intervalos en lugar de n√∫meros. <br><br>  Y dado que hay intervalos saludables y peque√±os, c√≥mo clasificarlos, compararlos entre s√≠ y ponerlos en un √°rbol es una tarea bastante trivial.  Aunque muy conocido en inform√°tica.  Luego, mire de alguna manera c√≥mo funciona.  Entonces, tomamos y ponemos todos nuestros intervalos en un √°rbol, y luego cada cambio en el texto en alg√∫n lugar en el medio conduce a un cambio logar√≠tmico en este √°rbol.  Por ejemplo, insertar un car√°cter deber√≠a resultar en la actualizaci√≥n de todos los intervalos a la derecha de ese car√°cter.  Para hacer esto, encontramos todos los v√©rtices dominantes para este s√≠mbolo e indicamos que todos sus v√©rtices deben moverse un s√≠mbolo a la derecha. <br><br><h3>  ¬øA√∫n quieres belleza?  Ligaduras! </h3><br><img src="https://habrastorage.org/webt/iv/j-/tb/ivj-tb9_w2ata-tiwclrmqfjs_a.jpeg"><br><br>  Todav√≠a hay algo tan terrible: las ligaduras, que tambi√©n me gustar√≠a apoyar.  Estas son bellezas diferentes, como el signo "! =" Se dibuja en forma de un glifo grande "no igual" y as√≠ sucesivamente.  Afortunadamente, aqu√≠ contamos con un mecanismo de oscilaci√≥n para soportar estas ligaduras.  Y, seg√∫n nuestra experiencia, aparentemente trabaja de la manera m√°s simple.  Dentro de la fuente, se almacena una lista de todos estos pares de caracteres que, cuando se combinan, forman alg√∫n tipo de ligadura complicada.  Luego, al dibujar la l√≠nea, Swing simplemente itera sobre todos estos pares, encuentra los necesarios y los dibuja en consecuencia.  Si tiene muchas ligaduras en la fuente, al parecer, mostrarla disminuir√° proporcionalmente. <br><br><h3>  Frenos de vuelco </h3><br>    ‚Äî   ,  ,     ‚Äî   ,  ,      . <br><br><img src="https://habrastorage.org/webt/fq/yb/wi/fqybwipttxn9pvl3phzc5qts6_k.jpeg"><br><br>    Intellij IDEA  ,     - ,   , ,  : <br><br><ul><li>      ,      completion popup',     completion',  , ,  - ¬´Enter¬ª. </li><li>  ,     -    ,  Perforce,    -    . </li><li> ,   -    ,    ,  -  . </li><li>    ,   ,   ,    . </li><li>  injected-,      ,       ,   -  . </li><li>     auto popup handler,    , ,       . </li><li>   info  ,     ,    .     selection remove,    selection  ,   .    selection ,    . </li><li>     typed handler,       ,      . </li><li>    . </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ejecute deshacer, cuente espacios virtuales y ejecute la acci√≥n de escritura. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Finalmente, inserte el personaje en nuestro documento. </font></font></li></ul><br>  ¬°Hurra! <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demonios no, eso no es todo. </font><font style="vertical-align: inherit;">Eliminar el car√°cter si nuestro b√∫fer est√° lleno. </font><font style="vertical-align: inherit;">Por ejemplo, en la consola, llame al oyente para que todos sepan que algo ha cambiado. </font><font style="vertical-align: inherit;">Vista del editor de desplazamiento. </font><font style="vertical-align: inherit;">Llama a otros oyentes est√∫pidos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øY qu√© sucede en el editor ahora cuando descubre que el documento ha cambiado y se llama a DocumentListener? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En Editor.documentChanged (), esto es lo que sucede:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Actualizar raya de error; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vuelva a calcular el tama√±o de la canaleta, vuelva a dibujar; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vuelva a calcular el tama√±o del componente del editor, env√≠e eventos al cambiar; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cuente las l√≠neas cambiadas y sus coordenadas; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recalcular la envoltura suave si el cambio lo afecta; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Llamar a repintar (). </font></font></li></ul><br>  repaint() ‚Äî     Swing,        .   ,   Repaint     Swing. <br><br>   -       ,   repaint   ,    : <br><br><img src="https://habrastorage.org/webt/je/qh/cy/jeqhcytdxkun3ft_r7azwrby2eu.jpeg"><br><br>    paint-,   ,        . <br><br>  , ,   ? <br><br><img src="https://habrastorage.org/webt/sm/mo/xq/smmoxqrmfayyfodciwe75svwdzw.jpeg"><br><br>  ,  ,  .    Intellij IDEA   . <br><br><img src="https://habrastorage.org/webt/5u/x8/as/5ux8ashfsenwboudd_u07ubtjmk.jpeg"><br><br>    ,  -   - ,    ,         ,    .  !  ,    ,    ,   -  ‚Äî !      ,  -    .    .      ¬´Zero latency typing¬ª. <br><br><h1>   </h1><br>      ‚Äî    . <br><br>  Que es esto       ,  ‚Äî  ,        Google Docs -    -  . <br><br>  : <br><br><ul><li>  ; </li><li>  . </li></ul><br>   ,        ,          . <br><br>  -          .    ,  ,     .   .   ‚Äî   , ¬´intention preservation¬ª.  ,   -  ,          ,     ,   .    ‚Äî .  ,            -       ,   . <br><br><h3> Operation transformation </h3><br><img src="https://habrastorage.org/webt/h9/e8/pq/h9e8pqu3ljnoh4y70_759peizn0.jpeg"><br><br>  ,       ,  ¬´operation transformation¬ª.   .    , - :     ,     .  Operation transformation       .   ,    ,   ,    - . ,        .    ,    -         .  ,      ,    . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando comenzaron a aparecer las primeras implementaciones de este marco, los desarrolladores asombrados descubrieron que existe un ejemplo universal que lo rompe todo. Este desafortunado ejemplo se llam√≥ "rompecabezas TP2". </font></font><br><br><img src="https://habrastorage.org/webt/c1/5i/cs/c15icsdnqbjqykloe_pfbxahz-e.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un usuario dibuja algunos caracteres al comienzo de la l√≠nea, otro elimina todo esto y el tercero dibuja al final. Despu√©s de que toda esta transformaci√≥n de la Operaci√≥n intente fusionarse en la misma cosa, entonces, en teor√≠a, esta l√≠nea ("DANA") deber√≠a resultar. Sin embargo, algunas implementaciones hicieron esto ("NADA"). Porque no est√° claro d√≥nde insertarlo. En la imagen de arriba puedes ver en qu√© nivel se encuentra toda esta ciencia sobre la transformaci√≥n de la Operaci√≥n, si todo se ha roto debido a un ejemplo tan primitivo.</font></font><br><br>          ,  Google Docs, Google Wave  -   Etherpad.   Operation transformation    . <br><br><h3> Conflict-free replicated data type </h3><br>      : ¬´  ,  OT!¬ª     ,      ,  . ,  ,    ,              ,      100%         .   ¬´CRDT¬ª (Conflict-free replicated data type). <br><br><img src="https://habrastorage.org/webt/kn/82/9n/kn829n91st7gpykcp905spuy_ki.jpeg"><br><br>   ,    ,          . ,     , ,   .   ,       . -            (  ),  ()      (  ). <br><br><img src="https://habrastorage.org/webt/vs/9-/i7/vs9-i7bdfpjonh_z1cgie6qj4kk.jpeg"><br><br>           ? <br><br>  Si ,     G-counter',   ,   .      ,       .        ¬´+1¬ª  ,  ¬´+1¬ª  , ,       ‚Äî   ¬´2¬ª.  ,          ,     .      G-counter,     ,       .       G-counter,    .    ,     ,       .       .    ‚Äî   . ,       CRDT. ,   . <br><br><h3> Conflict-free replicated inserts </h3><br><img src="https://habrastorage.org/webt/pz/bg/ta/pzbgta8bteajr0embilmbnpxifc.jpeg"><br><br> ,     ,      ,    . , ,        . <br><br>   ,     ,     -  - , ,  ,  ,        .   ,      ,     ,     ,     . , ,  ,     ,     2    ¬´¬ª,    ,    ¬´¬ª   ¬´¬ª   ¬´¬ª. <br><br><h3> Conflict-free replicated deletes </h3><br><img src="https://habrastorage.org/webt/jt/w1/fb/jtw1fbphe5mjcyhbye4ua-mjf7s.jpeg"><br><br>      .        ,    ,     ,  - .   ,       ,     .  ,       ,        ,    . <br>  ,      . <br><br><h3> Conflict-free replicated edits </h3><br> ,   , CRDT  - , ,  Xi-Editor,          Fuchsia.  ,     ,    . <br><br><h1> Zipper </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambi√©n me gustar√≠a hablar sobre lo que se usa en este nuevo mundo inmutable llamado "Cremallera". Despu√©s de que hicimos nuestras estructuras inmutables, aparecieron algunos matices de trabajar con ellas. Aqu√≠, por ejemplo, tenemos nuestro √°rbol inmutable con texto. Queremos cambiarlo (por "cambiar" aqu√≠, como entiendes, quiero decir "crear una nueva versi√≥n"). Adem√°s, queremos cambiarlo en alg√∫n lugar espec√≠fico y de forma bastante activa. En los editores, esto es bastante com√∫n cuando en la ubicaci√≥n del cursor imprimimos, pegamos y eliminamos algo constantemente. Para hacer esto, a los funcionarios se les ocurri√≥ una estructura llamada Zipper. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tiene el concepto de un supuesto cursor o lugar actual para la edici√≥n, mientras se mantiene la inmutabilidad total. Aqu√≠ te explicamos c√≥mo hacerlo.</font></font><br><br><img src="https://habrastorage.org/webt/ap/ne/p2/apnep2miklsburr5xhtqgcwbzri.gif"><br><br>  Zipper   ,      (¬´  ¬ª).     Zipper'       .    ‚Äî     .       (),   ,          . ,    Zipper,   -        ,   .  ,     ,   ,   ( ).      ,        ( ).   ,                .    ,        . <br><br>  ,        . <br><br>       ? -,   ,    ,    ,    .  ,       ,   .  -,    ,      .     .  Gracias <br><br> ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> <br> ‚Üí <a href=""></a> <br><br><h1>  Referencias </h1><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Zipper data structure</a> <br> <a href="">  CRDT in Xi Editor</a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">       </a> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">   </a> <br><br>     ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> Visual Studio Code editor  Piece Table</a> . <br>  ,   -   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> . <br><br><blockquote> ¬øDesea informes a√∫n m√°s potentes, incluido Java 11?  Entonces te esperamos en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Joker 2018</a> .  Oradores este a√±o: Josh Long, John McClean, Marcus Hirth, Robert Scholte y otros oradores igualmente geniales.  Quedan 17 d√≠as antes de la conferencia.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Entradas</a> en el sitio. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es424763/">https://habr.com/ru/post/es424763/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es424751/index.html">C√≥mo funciona el sistema biom√©trico unificado</a></li>
<li><a href="../es424753/index.html">Novedades de YouTrack 2018.3</a></li>
<li><a href="../es424755/index.html">El dinero ama la factura: c√≥mo los autos clasifican las facturas</a></li>
<li><a href="../es424757/index.html">El resumen de eventos para profesionales de recursos humanos en el campo de TI en octubre de 2018</a></li>
<li><a href="../es424761/index.html">Introducci√≥n a los procesos de arranque y arranque del kernel de Linux</a></li>
<li><a href="../es424765/index.html">Gesti√≥n del estado en aplicaciones Flutter</a></li>
<li><a href="../es424767/index.html">Hacemos un pastel de Habr. De nuevo</a></li>
<li><a href="../es424771/index.html">Experiencia personal: de una idea y una hoja en blanco a una versi√≥n borrador de un sitio</a></li>
<li><a href="../es424773/index.html">Biofarma y modelaci√≥n num√©rica: experiencia y pr√°ctica de Amgen</a></li>
<li><a href="../es424777/index.html">Uso del c√≥nsul para escalar servicios con estado</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>