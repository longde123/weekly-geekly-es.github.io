<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฎ โ ๐ธ ุจุนุถ ููุฒุงุช PowerShell ุนูุฏ ุงุณุชุฎุฏุงู ุญุณุงุจุงุช ุงููุณุชุฎุฏููู ๐๐ผ ๐๏ธ ๐คณ๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุงุนุชูุฏุช ุฃููู ุฌูุฏ ุฌุฏูุง ูู powershell ุ ููู ูู ููู ุนููู ุฃุจุฏูุง ุงูุนูู ูุน ุจูุงูุงุช ุงุนุชูุงุฏ ุงููุณุชุฎุฏู. ููุน ุฐูู ุ ุฃูุง ุงูุขู ูู ุจุญุซ ุนู ูุธููุฉ ุ ููู ุฅุญุฏู ุงูููุงุจูุงุช ุ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุจุนุถ ููุฒุงุช PowerShell ุนูุฏ ุงุณุชุฎุฏุงู ุญุณุงุจุงุช ุงููุณุชุฎุฏููู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418859/" style=";text-align:right;direction:rtl">  ุงุนุชูุฏุช ุฃููู ุฌูุฏ ุฌุฏูุง ูู powershell ุ ููู ูู ููู ุนููู ุฃุจุฏูุง ุงูุนูู ูุน ุจูุงูุงุช ุงุนุชูุงุฏ ุงููุณุชุฎุฏู.  ููุน ุฐูู ุ ุฃูุง ุงูุขู ูู ุจุญุซ ุนู ูุธููุฉ ุ ููู ุฅุญุฏู ุงูููุงุจูุงุช ุ ุชู ุชููููู ุจูููุฉ ุงุฎุชุจุงุฑ ููุชุงุจุฉ ูุต ูู ุงูููุชุฑุถ ุฃู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญูู ูู ุชููุฑ ูุญุงูุฉ (ุชูููู / ุชุนุทูู) ุญุณุงุจ ุงููุณุชุฎุฏู. </li><li style=";text-align:right;direction:rtl">  ุชุญูู ููุง ุฅุฐุง ูุงู ุงูุญุณุงุจ ูุถูููุง ูู ูุฌููุนุฉ ุงููุณุคูููู </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ููู ููุงู ุญุณุงุจ ุ ููู ุจุฅูุดุงุก ุญุณุงุจ ูุฅุถุงูุชู ุฅูู ูุฌููุนุฉ ุงููุณุคูููู ุ ูุญุฏุฏ ุงููุฑุจุนูู "ููุน ุชุบููุฑ ูููุฉ ูุฑูุฑ ุงููุณุชุฎุฏู" ู "ูููุฉ ุงููุฑูุฑ ุบูุฑ ููุชููุฉ ุงูุตูุงุญูุฉ" </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุงูุญุณุงุจ ููุฌูุฏูุง ุ ูููู ุชู ุชุนุทููู ุฃู ูู ูุชู ุชุถูููู ูู ูุฌููุนุฉ ุงููุณุคูููู ุ ููู ุจุชูููู ุงูุญุณุงุจ ูุฅุถุงูุชู ุฅูู ูุฌููุนุฉ ุงููุณุคูููู ุ ูุญุฏุฏ ุงููุฑุจุนุงุช ุจุฌูุงุฑ "ุฑูุถ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ุจูุงุณุทุฉ ุงููุณุชุฎุฏู" ู "ูููุฉ ุงููุฑูุฑ ุบูุฑ ููุชููุฉ ุงูุตูุงุญูุฉ" </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃูุง ูุนุชูุฏ ุงูุจุฑูุงูุฌ ุงููุตู ุนูู ูุบุฉ ูุธุงู ุงูุชุดุบูู. </li></ol><br><a name="habracut"></a><br>  ุงุนุชูุฏุช ุฃูู ูุง ููุฌุฏ ุดูุก ูุนูุฏ ุ ูุฃูู ุดูุก ูุฑุฑุช ุงูุชุญูู ููู ูู ูุณุชุฎุฏู ุงููุณุคูู ุนูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงูุฎุงุต ุจู.  ุฏูู ุงูุชูููุฑ ูุฑุชูู ุ ูุฏุช ุฃูุฑูุง: <br><br><pre style=";text-align:right;direction:rtl"><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-<span class="hljs-keyword"><span class="hljs-keyword">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span></code> </pre> <br>  ุซู ุญุตูุช ุนูู ุฎุทุฃ <br><br> <font color="#ff0000"><code>Get-User :  "Get-User"     , ,     .</code></font> <br> <br>  ููุฌุฆุช ููููุงู ูุฃููู ูู ุฃุชุนุฑู ุนูู ูุซู ูุฐุง ุงูุฃูุฑ ุงููููุฏ ููุฌุฏุช ุฃู ุงูุฃูุฑ <b>Get-User</b> ูุนูู ููุท ูู ูุญุฏุฉ ุชุญูู Powershell ูู Exchange.  ููุนูู ูุน ุงููุณุชุฎุฏููู ุงููุญูููู ุ ูุฌุจ ุนููู ุงุณุชุฎุฏุงู <b>Get-Localuser ูููุณุชุฎุฏูู</b> ุงููุฌุงู <b>Get-Aduser</b> .  ุฃุฏุฑูุช ุฎุทุฆู ุ ูุฏุช ูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-Localuser <span class="hljs-keyword"><span class="hljs-keyword">admin</span></span></code> </pre> <br>  ูุญุตูุช ุนูู ุฅุฌุงุจุฉ <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">Name</span></span> Enabled Description <span class="hljs-comment"><span class="hljs-comment">---- ------- ----------- Admin True     /</span></span></code> </pre> <br>  ุญุณููุง ุ ุงูุขู ููุณ ูู ุงูุตุนุจ ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ููุฌูุฏูุง ุฃู ูุง ุ ูููู ููุง ูุฑุฉ ุฃุฎุฑู ููุช ูู ุงูุชุธุงุฑ ุงูุชูุงุท ุขุฎุฑ.  ุฅู ุงุณุชุฎุฏุงู ุงูุดุฑุท ุฅุฐุง ูู ููู ุงูุฃูุฑ ุณููุงู. <br><br>  ูุงูุญูููุฉ ูู ุฃูู ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูู ุงููุธุงู ุ ูุฅู ุงููุงุชุฌ ููุณ ุงููููุฉ ุงูุญููููุฉ ุ ูููู ูุฌููุนุฉ ูุงููุฉ ูู ุงูุจูุงูุงุช ุ ูุน ุงุณู ุงููุณุชุฎุฏู ููุตูู ุ ูุชู ุชูููู ูุฐุง ุงูุญุณุงุจ ุฃู ูุง.  ูุฅุฐุง ูู ููู ููุงู ูุณุชุฎุฏู ุ ูุฅู powerhell ูููู ุฎุทุฃ.  ุจุนุฏ ุงูุชุฌูู ูู ุงูุฅูุชุฑูุช ุ ูุฌุฏุช ุฃูู ูู ุงูุฃูุถู ููุฐู ุงูุฃุบุฑุงุถ ุงุณุชุฎุฏุงู ุนุงูู ุงุณุชุฎุฏุงู <b>try</b> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$user</span></span> = <span class="hljs-string"><span class="hljs-string">'admin'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">Get-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-ErrorAction</span></span> Stop | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>  <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">Catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>  <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Red }</code> </pre> <br>  ุฃุถูุช ูุชุบูุฑ ุงููุณุชุฎุฏู $ ูุชุณููู ุชุบููุฑ ุฃุณูุงุก ุงููุณุชุฎุฏููู ูู ุงูุจุฑูุงูุฌ ุงููุตู ุจุฃูููู.  ErrorAction Stop ุถุฑูุฑู ุญุชู ูุง ููุงุทุน ุงูุจุฑูุงูุฌ ุงููุตู ูู ูุฐู ุงูุฎุทูุฉ ุจุณุจุจ ุฎุทุฃ.  ุชุณุฌูู |  ููุตู ุฎุทูุงุช ุฎุท ุงูุฃูุงุจูุจ ุ ูุณูุฎูู Out-Null ุฅุฎุฑุงุฌ ูุต ุงูุฎุทุฃ.  ุฃุถูุช ุฃูุถูุง ุฅุฎุฑุงุฌ ุงููุต ูุน ุงูุชูููุฒ ุ ูุชุณููู ุงูุชุญูู ูู ุงูุจุฑูุงูุฌ ุงููุตู. <br><br>  ุจุนุฏ ุฐูู ุ ุฃุฑุฏุช ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงูุญุณุงุจ ููููููุง ุฃู ูุนุทูุงู.  ููุง ููุช ุ ููุชุฌ ุนู ุงูุฃูุฑ Get-LocalUser ูุฌููุนุฉ ูุงููุฉ ูู ุงูุจูุงูุงุช ูููุชุญูู ุ ููุช ุจุญุงุฌุฉ ุฅูู ุชุญุฏูุฏ ูุนููุฉ ูููููุฉ ูุงุญุฏุฉ ููุท ุจูููุฉ ุตูุงุจ ุฃู ุฎุทุฃ.  ููููุงู ุจุฐูู ุ ุงุณุชุฎุฏูุช ุงูุฃูุฑ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">(<span class="hljs-built_in"><span class="hljs-built_in">Get-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span>).enabled</code> </pre> <br>  ุจุนุฏ ุงูุชุฃูุฏ ูู ุฃูู ูุนูู ุ ููุช ุจุฅุฌุฑุงุก ุงููุญุต ุงูุชุงูู ูุฃุถูุช ุฃูุฑ ุชูููู ุงููุณุชุฎุฏู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$user</span></span> = <span class="hljs-string"><span class="hljs-string">'admin'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-built_in"><span class="hljs-built_in">Get-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span>).enabled <span class="hljs-operator"><span class="hljs-operator">-eq</span></span> <span class="hljs-string"><span class="hljs-string">"True"</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>    <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>    <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Red <span class="hljs-built_in"><span class="hljs-built_in">Enable-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>    <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green }</code> </pre> <br>  ูุชูููู ุงููุณุชุฎุฏู ุ ูู ุงูุถุฑูุฑู ุจุดูู ุทุจูุนู ุชุดุบูู ูุญุฏุฉ ุงูุชุญูู ุจููุฌุจ ุญููู ุงููุณุคูู. <br><br>  ูู ุงูููุฑุฉ ุงูุซุงููุฉ ูู ุงููููุฉ ุ ูุงู ูู ุงูุถุฑูุฑู ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ุนุถููุง ูู ูุฌููุนุฉ ุงููุณุคูููู.  ููุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูู ูุฌููุนุฉ ูุนููุฉ ุ ููุงู ุฃูุฑ Get-LocalGroupMember.  ููุน ุฐูู ุ ูุฎุชูู ุงุณู ูุฌููุนุฉ ุงููุณุคูููู ุนู ูุบุฉ ูุธุงู ุงูุชุดุบูู.  ูุฐูู ุ ูุงู ุนูู ุงุณุชุฎุฏุงู ูุนูุงุฑ SID S-1-5-32-544.  ุฑุงุฌุนุช ุฃูุถุง ูู ุฎูุงู ูุญุงููุฉ ุงูุตูุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$user</span></span> = <span class="hljs-string"><span class="hljs-string">'admin'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">Get-LocalGroupMember</span></span> <span class="hljs-literal"><span class="hljs-literal">-SID</span></span> S<span class="hljs-literal"><span class="hljs-literal">-1</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-32</span></span><span class="hljs-literal"><span class="hljs-literal">-544</span></span> <span class="hljs-literal"><span class="hljs-literal">-Member</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-ErrorAction</span></span> Stop | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>     <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">Catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>      <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Red <span class="hljs-built_in"><span class="hljs-built_in">Add-LocalGroupMember</span></span> <span class="hljs-literal"><span class="hljs-literal">-SID</span></span> S<span class="hljs-literal"><span class="hljs-literal">-1</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-32</span></span><span class="hljs-literal"><span class="hljs-literal">-544</span></span> <span class="hljs-literal"><span class="hljs-literal">-Member</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>     <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green }</code> </pre> <br>  ุฅุฐุง ูู ููู ุงููุณุชุฎุฏู ุนุถููุง ูู ุงููุฌููุนุฉ ุ ูุณุชุชู ุฅุถุงูุฉ ุงููุณุคูููู ุฅูููุง. <br>  ูู ุงููุฑุญูุฉ ุงูุชุงููุฉ ุ ูุงูุช ูุฏู ูููุฉ ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุฏูู ุฅุนุฏุงุฏ ุชุบููุฑ ูููุฉ ุงููุฑูุฑ ูุนุทูุงู ุฃู ูุง.  ุซู ุตุงุฏูุช ูุทุจุงุช ุฃุฎุฑู.  ูุงูุญูููุฉ ูู ุฃูู ุฅุฐุง ูุงู ูุฏู ุงููุณุชุฎุฏู ูููุฉ ูุฑูุฑ ุบูุฑ ูุญุฏูุฏุฉ ุ ูุฅู ูุนููุฉ PasswordExpires ูุง ุชูุฑุฌุน ุฃู ููู.  ูุฅุฐุง ุชู ุชุนุทูู ูุฑุจุน ุงูุงุฎุชูุงุฑ ูุฐุง ุ ูุณูููู ูุฏู ุงููุณุชุฎุฏููู ุงููุฎุชูููู ุชุงุฑูุฎ ูุฎุชูู ูุชุบููุฑ ูููุฉ ุงููุฑูุฑ.  ูุง ุฒูุช ุฃุชูุตู ุฅูู ูุฎุฑุฌ ูู ูุฐุง ุงููููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-built_in"><span class="hljs-built_in">Get-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span>).PasswordExpires <span class="hljs-operator"><span class="hljs-operator">-eq</span></span> <span class="hljs-variable"><span class="hljs-variable">$null</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>      <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>     <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Red <span class="hljs-built_in"><span class="hljs-built_in">set-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-PasswordNeverExpires</span></span>:<span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>      <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green }</code> </pre> <br>  ุจุนุฏ ุฐูู ุ ุงุญุชุฌุช ุฅูู ุฅูุดุงุก ูุณุชุฎุฏู.  ูู ุฃูู ุฃุชููุน ุฃู ููุชุธุฑูู ุตูุฏ ููุง ุฃูุถูุง.  ุนูุฏ ุฅูุดุงุก ูุณุชุฎุฏู ุจุงูุฃูุฑ <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-built_in"><span class="hljs-built_in">new-LocalUser</span></span> <span class="hljs-literal"><span class="hljs-literal">-User</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-password</span></span> P@ssW0rD!</code> </pre> <br>  ุชู ุฅุฑุฌุงุน ุงูุฎุทุฃ: <br><br> <font color="#ff0000"><code>    "Password".     "P@ssW0rD!"  "System.String"   "System.Security.SecureString".</code></font> <br> <br>  ุงูุญูููุฉ ูู ุฃู ุงููุนููุฉ -password ูุฌุจ ุฃู ุชุณุชุฎุฏู SecureString ุ ุจุฏูุงู ูู ุงูุณูุณูุฉ ุงููุตูุฉ ุงููุนุชุงุฏุฉ.  ููููุงู ุจุฐูู ุ ููุช ุจุนูู ุงููุชุบูุฑ password password ูููุช ุจุชุญูููู ุฅูู securestring. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$password</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">convertto-securestring</span></span> <span class="hljs-string"><span class="hljs-string">"P@ssW0rD!"</span></span> <span class="hljs-literal"><span class="hljs-literal">-asplaintext</span></span> <span class="hljs-literal"><span class="hljs-literal">-force</span></span></code> </pre> <br>  ูุงูุจุฑูุงูุฌ ุงููุตู ููุณู ูุฅูุดุงุก ูุณุชุฎุฏู ูุฅุถุงูุชู ุฅูู ูุฌููุนุฉ ุงููุณุคูููู <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-built_in"><span class="hljs-built_in">new-LocalUser</span></span> <span class="hljs-literal"><span class="hljs-literal">-User</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-password</span></span> <span class="hljs-variable"><span class="hljs-variable">$password</span></span> <span class="hljs-literal"><span class="hljs-literal">-PasswordNeverExpires</span></span>:<span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-literal"><span class="hljs-literal">-AccountNeverExpires</span></span>:<span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Add-LocalGroupMember</span></span> <span class="hljs-literal"><span class="hljs-literal">-SID</span></span> S<span class="hljs-literal"><span class="hljs-literal">-1</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-32</span></span><span class="hljs-literal"><span class="hljs-literal">-544</span></span> <span class="hljs-literal"><span class="hljs-literal">-Member</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span></code> </pre> <br>  ุงููุต ุงูููุงุฆู ุงูุฐู ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุฌููุน ุงูุดุฑูุท ุงูุชู ุญุตูุช ุนูููุง ุจูุฐู ุงูุทุฑููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$user</span></span> = <span class="hljs-string"><span class="hljs-string">'admin'</span></span> <span class="hljs-variable"><span class="hljs-variable">$password</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">convertto-securestring</span></span> <span class="hljs-string"><span class="hljs-string">"P@ssW0rD!"</span></span> <span class="hljs-literal"><span class="hljs-literal">-asplaintext</span></span> <span class="hljs-literal"><span class="hljs-literal">-force</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">Get-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-ErrorAction</span></span> Stop | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> cls <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>  <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-built_in"><span class="hljs-built_in">Get-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span>).enabled <span class="hljs-operator"><span class="hljs-operator">-eq</span></span> <span class="hljs-string"><span class="hljs-string">"True"</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>    <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>    <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Red <span class="hljs-built_in"><span class="hljs-built_in">Enable-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>    <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((<span class="hljs-built_in"><span class="hljs-built_in">Get-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span>).PasswordExpires <span class="hljs-operator"><span class="hljs-operator">-eq</span></span> <span class="hljs-variable"><span class="hljs-variable">$null</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>      <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>     <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Red <span class="hljs-built_in"><span class="hljs-built_in">set-LocalUser</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-PasswordNeverExpires</span></span>:<span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>      <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">Get-LocalGroupMember</span></span> <span class="hljs-literal"><span class="hljs-literal">-SID</span></span> S<span class="hljs-literal"><span class="hljs-literal">-1</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-32</span></span><span class="hljs-literal"><span class="hljs-literal">-544</span></span> <span class="hljs-literal"><span class="hljs-literal">-Member</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-ErrorAction</span></span> Stop | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>     <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } <span class="hljs-keyword"><span class="hljs-keyword">Catch</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>      <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Red <span class="hljs-built_in"><span class="hljs-built_in">Add-LocalGroupMember</span></span> <span class="hljs-literal"><span class="hljs-literal">-SID</span></span> S<span class="hljs-literal"><span class="hljs-literal">-1</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-32</span></span><span class="hljs-literal"><span class="hljs-literal">-544</span></span> <span class="hljs-literal"><span class="hljs-literal">-Member</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>     <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green } } <span class="hljs-keyword"><span class="hljs-keyword">Catch</span></span> { cls <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>  <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Red <span class="hljs-built_in"><span class="hljs-built_in">new-LocalUser</span></span> <span class="hljs-literal"><span class="hljs-literal">-User</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-password</span></span> <span class="hljs-variable"><span class="hljs-variable">$password</span></span> <span class="hljs-literal"><span class="hljs-literal">-PasswordNeverExpires</span></span>:<span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-literal"><span class="hljs-literal">-AccountNeverExpires</span></span>:<span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Add-LocalGroupMember</span></span> <span class="hljs-literal"><span class="hljs-literal">-SID</span></span> S<span class="hljs-literal"><span class="hljs-literal">-1</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-32</span></span><span class="hljs-literal"><span class="hljs-literal">-544</span></span> <span class="hljs-literal"><span class="hljs-literal">-Member</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-built_in"><span class="hljs-built_in">write-host</span></span>  <span class="hljs-variable"><span class="hljs-variable">$user</span></span>       <span class="hljs-literal"><span class="hljs-literal">-foregroundcolor</span></span> Green }</code> </pre> <br>  ุจุนุฏ ุงูุจุฑูุงูุฌ ุงููุตู <br><br>  ููุน ุฐูู ุ ูุฅู ุชุฎุฒูู ูููุฉ ูุฑูุฑ ุงููุณุคูู ูู ุจุฑูุงูุฌ ูุตู ููุณ ุฃูุถู ููุงุฑุณุงุช ุงูุฃูุงู.  ููููุงู ุจุฐูู ุ ููููู ุงุณุชุฎุฏุงู ุชุฌุฒุฆุฉ ูููุฉ ุงููุฑูุฑ ุ ูููุณ ูููุฉ ุงููุฑูุฑ ููุณูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$user</span></span> = <span class="hljs-string"><span class="hljs-string">'admin1'</span></span> <span class="hljs-variable"><span class="hljs-variable">$hash</span></span> = <span class="hljs-string"><span class="hljs-string">"01000000d08c9ddf0115d1118c7a00c04fc297eb0100000048baf1b47a72d845b4eeda8659da9fd70000000002000000000010660000000100002000000004d2a3bf03aac92c2e172dc002d1fe8759da4655850462aface5c25f52921e05000000000e8000000002000020000000bfa652b6f7cc6845e3cee1831b54ab93dc272d0b2203024c3de8bc4789a2698a10000000923fb50dcf01125913534d0c1ba6d827400000002757df7d8a8b39c8e84b81323acff1d72419580a0022cf610926e5f081a2e895320088d482eb407f8157aad82f091abee7427b357e871d12238a8f74131238e7"</span></span> <span class="hljs-variable"><span class="hljs-variable">$hash</span></span> <span class="hljs-variable"><span class="hljs-variable">$password</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">ConvertTo-SecureString</span></span> <span class="hljs-literal"><span class="hljs-literal">-String</span></span> <span class="hljs-variable"><span class="hljs-variable">$hash</span></span> <span class="hljs-variable"><span class="hljs-variable">$password</span></span> <span class="hljs-built_in"><span class="hljs-built_in">new-LocalUser</span></span> <span class="hljs-literal"><span class="hljs-literal">-User</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span> <span class="hljs-literal"><span class="hljs-literal">-password</span></span> <span class="hljs-variable"><span class="hljs-variable">$password</span></span> <span class="hljs-literal"><span class="hljs-literal">-PasswordNeverExpires</span></span>:<span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-literal"><span class="hljs-literal">-AccountNeverExpires</span></span>:<span class="hljs-variable"><span class="hljs-variable">$true</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Add-LocalGroupMember</span></span> <span class="hljs-literal"><span class="hljs-literal">-SID</span></span> S<span class="hljs-literal"><span class="hljs-literal">-1</span></span><span class="hljs-literal"><span class="hljs-literal">-5</span></span><span class="hljs-literal"><span class="hljs-literal">-32</span></span><span class="hljs-literal"><span class="hljs-literal">-544</span></span> <span class="hljs-literal"><span class="hljs-literal">-Member</span></span> <span class="hljs-variable"><span class="hljs-variable">$user</span></span></code> </pre><br>  ููุญุตูู ุนูู ุชุฌุฒุฆุฉ ูููุฉ ุงููุฑูุฑ ุ ููููู ุงุณุชุฎุฏุงู ุงูุจุฑูุงูุฌ ุงููุตู ุงูุชุงูู <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$Secure</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">Read-Host</span></span> <span class="hljs-literal"><span class="hljs-literal">-AsSecureString</span></span> <span class="hljs-variable"><span class="hljs-variable">$Secure</span></span> <span class="hljs-variable"><span class="hljs-variable">$hash</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">ConvertFrom-SecureString</span></span> <span class="hljs-literal"><span class="hljs-literal">-SecureString</span></span> <span class="hljs-variable"><span class="hljs-variable">$Secure</span></span> <span class="hljs-variable"><span class="hljs-variable">$hash</span></span></code> </pre> <br>  ุงูุฐู ูุทูุจ ูููุฉ ูุฑูุฑ ูู ููุญุฉ ุงูููุงุชูุญ. <br><br>  ูููุงูุฃุฉ ุตุบูุฑุฉ ูุนุฑุถ ุฌููุน ุงูุณุฌูุงุช ุงููุนุทูุฉ <br><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell"><span class="hljs-built_in"><span class="hljs-built_in">Get-LocalUser</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Where-Object</span></span> {<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.enabled <span class="hljs-operator"><span class="hljs-operator">-eq</span></span> <span class="hljs-variable"><span class="hljs-variable">$false</span></span>}</code> </pre> <br>  ุขูู ุฃู ูุณุงุนุฏ ุงูููุช ุงูุฐู ูุถูุชู ุดุฎุตูุง ูู ุนููู.  ููู ุงููููุฏ ูู ุฃูุง ุชูุณู ูุฐู ุงูุชุฌุฑุจุฉ ุงูุชู ูุง ุชูุฏุฑ ุจุซูู. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar418859/">https://habr.com/ru/post/ar418859/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar418849/index.html">ููุฎุต ุงูุฃุญุฏุงุซ ููุญุชุฑูู ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ูู ูุฌุงู ุชูููููุฌูุง ุงููุนูููุงุช ูุดูุฑ ุฃุบุณุทุณ 2018</a></li>
<li><a href="../ar418851/index.html">ููููุฉ ุดุฑุงุก ููู ุงูุฃูุงู ูู ุดูู ุณุงุนุงุช ุฐููุฉ ููุฃุทูุงู</a></li>
<li><a href="../ar418853/index.html">ุชูุงุตูู ุญูู ุชุญุฏูุซ Segregated Witness ููุชุงุฆุฌ ุงุนุชูุงุฏู ูู Bitcoin</a></li>
<li><a href="../ar418855/index.html">ูุชุญ ูุฏูุฉ ุนุจุฑ ุงูุฅูุชุฑูุช "ุฅูุดุงุก ุชุทุจูู ุนูู Webpack + React + Express"</a></li>
<li><a href="../ar418857/index.html">ุชุญุถูุฑ ุดูุงุฏุงุช SSL ููุชุซุจูุช</a></li>
<li><a href="../ar418861/index.html">ูุจุฏุฃ ReactOS ุงูุขู ุจูุณู BTRFS</a></li>
<li><a href="../ar418863/index.html">ููู ุงูุฏุนุงุฆู ุชูุฏูู ูุน ูุซุงู</a></li>
<li><a href="../ar418867/index.html">ุงูุจุฑูุฌุฉ ุงูุฏููุงููููุฉ ูู ูุดุงูู ุงูุฃูููุจูุงุฏ</a></li>
<li><a href="../ar418869/index.html">ุฃุณูู ููุง ูุจุฏู. ุงููุตูู 9-10</a></li>
<li><a href="../ar418871/index.html">Kegel Elvie Smart Trainer ูุชูููุฉ ุงูุนุถูุงุช ุงูุญูููุฉ - ููุงุฐุง ุชุญุชุงุฌูุง</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>