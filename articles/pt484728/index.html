<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèª‚Äç‚öñÔ∏è üëÉüèø üíÑ Cliente misterioso do CityMobile üé° ü§∫ üéé</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Oi Meu nome √© Narek Markosyan e sou desenvolvedor de back-end no Citimobil. Quero falar sobre o nosso bot fechado do Telegram "Mystery shopper" . 

 P...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cliente misterioso do CityMobile</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/citymobil/blog/484728/">  Oi  Meu nome √© Narek Markosyan e sou desenvolvedor de back-end no Citimobil.  Quero falar sobre o nosso <b>bot</b> fechado do <b>Telegram "Mystery shopper"</b> . <br><br><h2>  Pr√≥logo </h2><br>  Ningu√©m usa √≥culos cor de rosa no CityMobile, entendemos bem que nosso servi√ßo n√£o √© perfeito, portanto, estamos sempre trabalhando para melhor√°-lo.  Os problemas do cliente podem estar associados ao aplicativo, ao c√°lculo do pre√ßo, mas na maioria das vezes ao motorista. <br><br>  Adoramos nossos motoristas e tentamos tornar seu trabalho mais agrad√°vel e lucrativo, mas por causa de um motorista inescrupuloso, podemos perder v√°rios clientes e, assim, privar motoristas que honestamente fazem seu trabalho. <br><br>  Por esse motivo, decidimos desenvolver uma ferramenta para responder rapidamente √†s reclama√ß√µes relacionadas aos motoristas. <br><a name="habracut"></a><br><h2>  Por que precisamos de um bot </h2><br>  Absolutamente todas as reclama√ß√µes de nossos clientes s√£o consideradas pelos funcion√°rios do departamento de suporte, mas n√£o podemos confiar totalmente nas estat√≠sticas recebidas dos clientes por v√°rios motivos: <br><br><ul><li>  <b>nem todos os clientes</b> deixam feedback se algo der errado; </li><li>  nem sempre podemos ter certeza da <b>objetividade dos</b> clientes; </li><li>  n√£o queremos e n√£o podemos oferecer aos clientes um monte de <b>perguntas esclarecedoras</b> para obter uma vis√£o completa. </li></ul><br>  Ent√£o o que fazer?  Pe√ßa aos nossos colegas para ajudar! <br><br><ul><li>  Os funcion√°rios provavelmente <b>n√£o se esquecer√£o</b> de relatar um problema; </li><li>  Os funcion√°rios s√£o mais <b>objetivos</b> .  N√£o at√© o fim, mas ainda :) </li><li>  Voc√™ pode ir a um colega e descobrir todos os detalhes necess√°rios. </li></ul><br>  Obviamente, quando surgem problemas, voc√™ sempre pode ligar para a sala de expedi√ß√£o e passar sem intermedi√°rios, mas o bot ajuda a executar duas tarefas importantes: <b>lembra</b> o que voc√™ precisa prestar aten√ß√£o e permite que voc√™ relate um problema com o clique de <b>um bot√£o</b> . <br><br><h2>  Como o bot funciona? </h2><br><img src="https://drive.google.com/uc?export=view&amp;id=1FkPW2NhEdc8Mi1c_n-Oxcjf2a7I46QEL" alt="imagem"><br><br>  O comprador misterioso √© muito simples.  Consiste em apenas dois manipuladores: <br><br>  O primeiro manipulador realiza as viagens da API que foram conclu√≠das recentemente ou est√£o com o status "Em tr√¢nsito" e envia a pergunta da primeira viagem ao chat. <br><br>  O segundo manipulador acessa a API do Telegram e capta mensagens n√£o lidas, passa por cada mensagem sucessivamente e envia uma resposta ao bate-papo. <br><br>  Obviamente, era poss√≠vel fazer com que nosso servidor enviasse automaticamente mensagens para o bot da viagem e as respostas dos usu√°rios do Telegram n√£o chegavam em lotes, mas no momento do envio, mas ap√≥s discuss√µes, decidimos fazer o mecanismo descrito acima.  Havia v√°rias raz√µes para isso: <br><br><ul><li>  com esta implementa√ß√£o, o servi√ßo √© <b>completamente fechado</b> para solicita√ß√µes de entrada em todas as portas; portanto, n√£o podemos ter medo de tentativas de hackers ou ataques DDOS; </li><li>  se muitas mensagens vierem de usu√°rios ao mesmo tempo, o Telegram n√£o <b>nos bombardear√° com solicita√ß√µes</b> ; </li><li>  se o bot ficar sem gra√ßa, <b>n√£o afetar√°</b> o servidor principal e nem os processos de neg√≥cios. </li></ul><br>  Escolhemos o MySQL como base para o bot.  Qualquer banco de dados seria adequado para n√≥s, mesmo noSQL, mas escolhemos o MySQL para tornar mais f√°cil para o departamento de an√°lise processar os dados necess√°rios. <br><br>  Quanto √† linguagem, aqui escolhemos entre PHP e GoLang.  Paramos no PHP, porque "por que n√£o".  Com a implementa√ß√£o que temos, n√£o usar√≠amos as principais vantagens do Go, mas complicaria o desenvolvimento - nem todos os desenvolvedores escrevem no Go.  Se voc√™ tem uma id√©ia do que seria melhor que o PHP nesta implementa√ß√£o do Go, ficarei feliz em ler os coment√°rios. <br><br><h2>  Aprimoramentos </h2><br>  N√£o houve muitas melhorias desde a primeira vers√£o.  Ap√≥s o lan√ßamento oficial, come√ßamos a coletar feedback e, como resultado, encontramos apenas dois problemas. <br><br>  <b>O primeiro problema √© a falta de mem√≥ria</b> .  Na primeira implementa√ß√£o, o bot come√ßou a questionar o funcion√°rio 5 minutos ap√≥s a viagem.  Verificou-se que, durante esse per√≠odo, o passageiro conseguiu esquecer alguns detalhes, por exemplo, o n√∫mero de matr√≠cula do carro.  Ap√≥s o refinamento, o bot come√ßou a pesquisa um minuto depois que o passageiro entrou no carro.  O bot fez perguntas, cuja resposta j√° √© conhecida com certeza (limpeza do carro, se o carro tem os n√∫meros corretos, etc.)  Ap√≥s a viagem, o bot retornou com outro pacote de perguntas, cujas respostas ficam claras apenas durante a viagem. <br><br>  <b>O segundo problema √© que tudo est√° quase sempre bem conosco</b> .  N√£o importa o qu√£o estranho possa parecer, mas do ponto de vista do bot, isso se tornou um problema.  Nossos colegas est√£o cansados ‚Äã‚Äãap√≥s cada viagem 10 vezes para responder "est√° tudo bem".  Resolvemos esse problema agrupando perguntas: combinamos todas as perguntas feitas durante a viagem e todas as perguntas depois em duas perguntas id√™nticas: ‚ÄúEst√° tudo bem?‚Äù Com um conjunto diferente de respostas. <br><br><img src="https://drive.google.com/uc?export=view&amp;id=1qi1ZO7J0HmygCH_lFMaBR_zKCfdSd-0q" alt="imagem"><br><br>  Em um futuro pr√≥ximo, planejamos aumentar o n√∫mero de clientes confi√°veis ‚Äã‚Äãe, assim, tornar o bot mais eficiente.  Para fazer isso, voc√™ precisar√° refazer a autoriza√ß√£o e adicionar monitoramento aos eventos cr√≠ticos.  Se houver mudan√ßas interessantes, escreverei um artigo separado sobre elas ... </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt484728/">https://habr.com/ru/post/pt484728/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt484716/index.html">Pare de chamar tudo de AI</a></li>
<li><a href="../pt484718/index.html">As modernas impressoras HP se recusam a trabalhar sem assinatura de tinta</a></li>
<li><a href="../pt484720/index.html">Concerto para uma cidade com uma orquestra: quem e por que grava os sons da vida cotidiana</a></li>
<li><a href="../pt484722/index.html">Quais ferramentas de desenvolvimento do Ruby on Rails se adequam ao seu projeto: Principais j√≥ias do Ruby on Rails para 2020</a></li>
<li><a href="../pt484724/index.html">Not√≠cias do mundo do OpenStreetMap n¬∫ 494 (31.12.2019-06.01.2020)</a></li>
<li><a href="../pt484730/index.html">Dell Inspiron 7490: laptop de metal leve para todos os dias com excelente autonomia</a></li>
<li><a href="../pt484732/index.html">O que √© o VMware e por que √© importante a compatibilidade com SSDs?</a></li>
<li><a href="../pt484734/index.html">O que poderia ter sido apresentado na CES nos s√©culos XIX e XX</a></li>
<li><a href="../pt484736/index.html">Linux: removendo o conjunto de bloqueios / dev / random</a></li>
<li><a href="../pt484738/index.html">Passo a passo de integra√ß√£o cont√≠nua para o Laravel 6 no Google Cloud Run</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>