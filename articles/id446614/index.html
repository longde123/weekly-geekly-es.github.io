<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👱🏿 💫 🌙 Sistem file virtual Linux: mengapa mereka diperlukan dan bagaimana cara kerjanya? Bagian 1 👨🏻‍🔧 🙅🏻 ⛴️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya! Kami terus meluncurkan utas baru di kursus yang sudah Anda sukai dan sedang terburu-buru untuk memberi tahu Anda bahwa kami sedang memu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sistem file virtual Linux: mengapa mereka diperlukan dan bagaimana cara kerjanya? Bagian 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/446614/"> Halo semuanya!  Kami terus meluncurkan utas baru di kursus yang sudah Anda sukai dan sedang terburu-buru untuk memberi tahu Anda bahwa kami sedang memulai set baru di kursus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Administrator Linux</a> , yang akan dimulai pada akhir April.  Publikasi baru akan bertepatan dengan acara ini.  Bahan aslinya dapat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ditemukan di sini</a> . <br><br>  Sistem file virtual bertindak sebagai semacam abstraksi magis yang memungkinkan filosofi Linux untuk mengatakan bahwa "semuanya adalah file". <br><br><img src="https://habrastorage.org/webt/1h/lh/nr/1hlhnrso0yod92zfqzfyhefs408.png"><br><br>  Apa itu sistem file?  Berdasarkan kata-kata dari salah satu kontributor dan penulis Linux pertama, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Robert Love</a> , "Sistem file adalah gudang data hierarkis, dirakit sesuai dengan struktur tertentu."  Bagaimanapun, definisi ini sama-sama cocok untuk VFAT (Tabel Alokasi File Virtual), Git, dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Cassandra</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Database NoSQL</a> ).  Jadi apa sebenarnya yang mendefinisikan konsep seperti "sistem file"? <a name="habracut"></a><br><br>  <b>Dasar-dasar Sistem File</b> <br><br>  Kernel Linux memiliki persyaratan khusus untuk suatu entitas yang dapat dianggap sebagai sistem file.  Ini harus mengimplementasikan metode <code>open()</code> , <code>read()</code> dan <code>write()</code> untuk objek persisten yang memiliki nama.  Dari sudut pandang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pemrograman</a> berorientasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">objek</a> , kernel mendefinisikan sistem file generik (generic filesystem) sebagai antarmuka abstrak, dan ketiga fungsi besar ini dianggap "virtual" dan tidak memiliki definisi khusus.  Dengan demikian, implementasi standar sistem file disebut sistem file virtual (VFS). <br><br><img src="https://habrastorage.org/webt/ns/mz/m5/nsmzm5hv4xu6bkfuzdklmmhoxyq.png"><br><br>  Jika kita dapat membuka, membaca, dan menulis ke suatu entitas, maka entitas ini dianggap sebagai file, seperti yang kita lihat dari contoh di konsol di atas. <br>  Fenomena VFS hanya menggarisbawahi karakteristik pengamatan sistem mirip Unix, yang menyatakan bahwa "semuanya adalah file."  Pikirkan betapa anehnya bahwa contoh kecil di atas dengan / dev / console menunjukkan cara kerja konsol sebenarnya.  Gambar menunjukkan sesi Bash interaktif.  Mengirim string ke konsol (perangkat konsol virtual) menampilkannya di layar virtual.  VFS memiliki properti lain yang bahkan lebih aneh.  Misalnya, memungkinkan untuk mencari melalui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mereka</a> . <br><br>  Sistem yang familier seperti ext4, NFS, dan / proc memiliki tiga fungsi penting dalam struktur data C yang disebut <a href="">operasi file_</a> .  Selain itu, sistem file tertentu memperluas dan mendefinisikan kembali fungsi VFS dengan cara yang akrab, berorientasi objek.  Seperti yang dicatat oleh Robert Love, abstraksi VFS memungkinkan pengguna Linux untuk menyalin file ke atau dari sistem operasi pihak ketiga atau entitas abstrak seperti pipa, tanpa khawatir tentang format data internal mereka.  Di sisi pengguna (userspace), menggunakan panggilan sistem, suatu proses dapat menyalin dari file ke struktur data kernel menggunakan metode <code>read()</code> dari satu sistem file, dan kemudian menggunakan metode <code>write()</code> dari sistem file lain untuk menghasilkan data. <br><br>  Definisi fungsi yang termasuk dalam tipe VFS dasar ditemukan dalam file <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">fs / *. C dari</a> sumber kernel, sedangkan <code>fs/</code> subdirektori berisi sistem file tertentu.  Kernel juga berisi entitas, seperti <code>cgroups</code> , <code>/dev</code> dan <code>tmpfs</code> , yang diperlukan selama proses boot dan oleh karena itu didefinisikan dalam subdirektori <code>init/</code> kernel.  Perhatikan bahwa <code>cgroups</code> , <code>/dev</code> dan <code>tmpfs</code> tidak memanggil fungsi Tiga Besar operasi <code>file_operations</code> , tetapi langsung membaca dan menulis ke memori. <br>  Diagram di bawah ini menunjukkan bagaimana userspace mengakses berbagai jenis sistem file yang biasanya dipasang pada sistem Linux.  Konstruksi seperti <code>pipes</code> , <code>POSIX clocks</code> <code>dmesg</code> dan <code>POSIX clocks</code> , yang juga menerapkan struktur <code>file_operations</code> , akses yang melewati lapisan VFS, tidak ditampilkan. <br><br><img src="https://habrastorage.org/webt/bv/el/yh/bvelyh39bsgh1uqiwdb-1xgcjco.png"><br><br>  VFS adalah "lapisan shell" antara panggilan sistem dan implementasi <code>procfs</code> tertentu, seperti <code>ext4</code> dan <code>procfs</code> .  Fungsi <code>file_operations</code> dapat berinteraksi dengan driver perangkat atau perangkat akses memori.  <code>tmpfs</code> , <code>devtmpfs</code> , dan <code>cgroups</code> tidak menggunakan <code>cgroups</code> , tetapi mengakses memori secara langsung. <br>  Keberadaan VFS menyediakan kemampuan untuk menggunakan kembali kode, karena metode dasar yang terkait dengan sistem file tidak perlu diimplementasikan kembali oleh setiap jenis sistem file.  Menggunakan kembali kode adalah praktik yang diterima secara luas untuk insinyur perangkat lunak!  Namun, jika kode yang dapat digunakan kembali berisi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kesalahan serius</a> , semua implementasi yang mewarisi metode umum menderita karenanya. <br><br>  <b>/ tmp: Petunjuk sederhana</b> <br><br>  Cara mudah untuk mendeteksi bahwa VFS hadir pada sistem adalah dengan memasukkan <code>mount | grep -v sd | grep -v :/</code> <code>mount | grep -v sd | grep -v :/</code>  <code>mount | grep -v sd | grep -v :/</code> , yang akan menampilkan semua sistem file yang dipasang yang tidak ada pada disk dan bukan NFS, yang berlaku pada sebagian besar komputer.  Salah satu mount VFS yang tercantum di atas tidak diragukan lagi adalah <code>/tmp</code> , kan? <br><br><img src="https://habrastorage.org/webt/ib/ez/dl/ibezdlxu4njb2snyofrp24n7wte.jpeg"><br><br>  Semua orang tahu bahwa menyimpan <code>/tmp</code> pada media fisik itu gila!  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sumber</a> <br><br>  Mengapa menyimpan <code>/tmp</code> di media fisik tidak diinginkan?  Karena file di <code>/tmp</code> bersifat sementara dan perangkat penyimpanan lebih lambat daripada memori tempat tmpfs dibuat.  Selain itu, media fisik lebih rentan untuk menimpa keausan daripada memori.  Akhirnya, file-file di / tmp mungkin berisi informasi sensitif, sehingga hilangnya mereka dengan setiap reboot adalah fungsi yang tidak terpisahkan. <br><br>  Sayangnya, beberapa skrip instalasi distribusi Linux membuat / tmp pada perangkat penyimpanan default.  Jangan putus asa jika ini terjadi pada sistem Anda.  Ikuti beberapa instruksi sederhana dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Arch Wiki</a> untuk memperbaikinya, dan ingat bahwa memori yang dialokasikan untuk <code>tmpfs</code> menjadi tidak dapat diakses untuk keperluan lain.  Dengan kata lain, sistem dengan tmpfs raksasa dan file besar di dalamnya dapat kehabisan memori dan crash.  Petunjuk lain: saat mengedit file <code>/etc/fstab</code> , ingat bahwa itu harus diakhiri dengan baris baru, jika tidak, sistem Anda tidak akan boot. <br><br>  <b>/ proc dan / sys</b> <br><br>  Selain <code>/tmp</code> , VFS (sistem file virtual) yang paling dikenal pengguna Linux adalah <code>/proc</code> dan <code>/sys</code> .  ( <code>/dev</code> terletak di memori bersama dan tidak memiliki <code>file_operations</code> ).  Mengapa persis dua komponen ini?  Mari kita bahas masalah ini. <br><br>  <code>procfs</code> mengambil snapshot dari kernel dan proses yang <code>procfs</code> untuk <code>userspace</code> .  Di <code>/proc</code> kernel menampilkan informasi tentang alat apa yang dimilikinya, misalnya, interupsi, memori virtual, dan penjadwal.  Selain itu, <code>/proc/sys</code> adalah tempat di mana opsi yang dikonfigurasikan dengan perintah <code>sysctl</code> tersedia untuk <code>userspace</code> .  Status dan statistik masing-masing proses ditampilkan di direktori <code>/proc/</code> . <br><br><img src="https://habrastorage.org/webt/sp/7w/mx/sp7wmxs9kjfbvegtdm-_b6nbuby.png"><br><br>  Di sini <code>/proc/meminfo</code> adalah file kosong yang tetap mengandung informasi berharga. <br><br>  Perilaku file <code>/proc</code> menunjukkan bagaimana sistem file disk VFS berbeda.  Di satu sisi, <code>/proc/meminfo</code> berisi informasi yang dapat dilihat dengan perintah <code>free</code> .  Di sisi lain, itu kosong di sana!  Bagaimana itu?  Situasinya menyerupai sebuah artikel terkenal yang berjudul, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Apakah bulan ada ketika tidak ada yang melihatnya?"</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Teori Realitas dan Kuantum, ”</a> ditulis oleh profesor fisika Universitas Cornell David Mermin pada tahun 1985.  Faktanya adalah bahwa kernel mengumpulkan statistik memori ketika permintaan dibuat ke <code>/proc</code> , dan pada kenyataannya tidak ada dalam file <code>/proc</code> ketika tidak ada yang melihat ke sana.  Seperti yang dikatakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mermin</a> , "Doktrin kuantum mendasar menyatakan bahwa pengukuran, sebagai suatu peraturan, tidak mengungkapkan nilai yang sudah ada sebelumnya dari properti yang diukur."  (Pikirkan pertanyaan bulan sebagai pekerjaan rumah!) <br>  Kekosongan yang tampak dari akal masuk akal, karena informasi di sana dinamis.  Situasi yang sedikit berbeda dengan <code>sysfs</code> .  Mari kita bandingkan berapa banyak file setidaknya satu byte di <code>/proc</code> dan <code>/sys</code> . <br><br><img src="https://habrastorage.org/webt/fe/zl/5o/fezl5owtzovd8qn8hevakizumfw.png"><br><br>  <code>Procfs</code> memiliki satu file, yaitu konfigurasi kernel yang diekspor, yang merupakan pengecualian karena hanya perlu dihasilkan satu kali per boot.  <code>/sys</code> di sisi lain, mengandung lebih banyak file yang banyak, banyak di antaranya menempati seluruh halaman memori.  Biasanya, file <code>sysfs</code> persis mengandung satu angka atau baris, tidak seperti tabel informasi yang diperoleh dengan membaca file seperti <code>/proc/meminfo</code> . <br><br>  Tujuan dari <code>sysfs</code> adalah untuk menyediakan properti yang <code>«kobjects»</code> dibaca dan <code>«kobjects»</code> dari apa yang disebut kernel <code>«kobjects»</code> di userspace.  Satu-satunya tujuan <code>kobjects</code> adalah untuk menghitung tautan: ketika tautan terakhir ke kobject dihapus, sistem akan mengembalikan sumber daya yang terkait dengannya.  Namun, <code>/sys</code> membuat sebagian besar kernel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"stable ABI for userspace" yang terkenal</a> , yang tidak dapat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dipecahkan</a> oleh siapa pun, dalam keadaan apa pun.  Ini tidak berarti bahwa file dalam sysfs adalah statis, yang akan bertentangan dengan penghitungan tautan ke objek yang tidak stabil. <br>  Antarmuka aplikasi kernel yang stabil (ABI stable kernel) membatasi apa yang mungkin muncul di <code>/sys</code> , bukan apa yang sebenarnya ada pada saat ini.  Mendaftarkan izin file di sysfs memberikan pemahaman tentang bagaimana pengaturan yang dapat dikonfigurasi untuk perangkat, modul, sistem file, dll.  dapat disesuaikan atau dibaca.  Kami menyimpulkan bahwa procfs juga merupakan bagian dari kernel ABI yang stabil, meskipun ini tidak secara eksplisit dinyatakan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> . <br><br><img src="https://habrastorage.org/webt/oq/js/dw/oqjsdwzan-wogzel_1galwiof4q.png"><br><br>  File dalam <code>sysfs</code> menggambarkan satu properti spesifik untuk setiap entitas dan dapat dibaca, ditulis ulang, atau keduanya sekaligus.  "0" dalam file menunjukkan bahwa SSD tidak dapat dihapus. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kami</a> memulai bagian <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kedua dari</a> terjemahan dengan cara mengamati VFS menggunakan alat eBPF dan bcc, dan sekarang kami menunggu komentar Anda dan secara tradisional mengundang Anda ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">webinar terbuka</a> , yang akan diadakan oleh guru kami <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Vladimir Drozdetsky</a> pada 9 April. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian kedua.</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446614/">https://habr.com/ru/post/id446614/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446602/index.html">Maksimum Arus DC Melalui Transistor Efek Bidang</a></li>
<li><a href="../id446604/index.html">ESET: Skema Pengiriman Backdoor OceanLotus Cybergroup Baru</a></li>
<li><a href="../id446606/index.html">Periksa seberapa baik Anda dalam teknologi aditif</a></li>
<li><a href="../id446608/index.html">Mengatasi Hukum Ketiga Gravitasi Organisasi</a></li>
<li><a href="../id446612/index.html">Saat kami mulai percaya pada inovasi</a></li>
<li><a href="../id446616/index.html">Bagaimana kami melakukan cloud FaaS di dalam Kubernetes dan menang di Tinkoff Hackathon</a></li>
<li><a href="../id446620/index.html">DataGrip 2019.1: dukungan untuk database baru, skrip inisialisasi, inspeksi baru dan banyak lagi</a></li>
<li><a href="../id446622/index.html">Berita di 11</a></li>
<li><a href="../id446624/index.html">Indeks dalam PostgreSQL - 6 (SP-GiST)</a></li>
<li><a href="../id446626/index.html">Kaspersky Mobile Talks # 1. Multi-modularitas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>