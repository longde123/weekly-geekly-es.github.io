<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖌️ 🦂 💇🏾 交通图为何“撒谎” ™️ 🕙 😙</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="致力于防御DDoS攻击  它会在客户端站点上启动，以进行负载测试，防御测试并帮助抵御攻击。 通常，您会观察到不同系统中的图在相同流量上有所不同的情况。 简要解释“不同思维”并不能激发信心。 因此，他在另一篇文章中描述了原因。 本文对于从网络运营开始的工程师以及那些必须处理计划的人员将很有用。 

 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>交通图为何“撒谎”</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441694/"> 致力于防御DDoS攻击 <img src="https://habrastorage.org/webt/gk/gq/zh/gkgqzhzw83sguowwwuo2dx9sdfk.png" alt="基于相同数据的不同图形" width="350" align="right"> 它会在客户端站点上启动，以进行负载测试，防御测试并帮助抵御攻击。 通常，您会观察到不同系统中的图在相同流量上有所不同的情况。 简要解释“不同思维”并不能激发信心。 因此，他在另一篇文章中描述了原因。 本文对于从网络运营开始的工程师以及那些必须处理计划的人员将很有用。 <br><br> 证词不一致的原因分为三组： <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">1.计数</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2.收集和储存</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">3.显示</a> <br><a name="habracut"></a><br><a name="1"></a><h2>  <font color="#38a5d3">1.计数</font> </h2><br> 我将从出现差异的主要原因开始，而这是最常被忽略的原因。 <br><br>  1.工程师通常认为最小的“数据包”大小为64字节。 <br>  2.网络设备以不同的方式考虑传输的信息量。 <br><br><img src="https://habrastorage.org/webt/fz/td/yt/fztdyt2phekpdkjlhpxcjnic84i.png"> 错误和答案的来源在此图中。 <br><br><a name="2"></a><h3>  <font color="#38a5d3">1.1 RTFM</font> </h3><br> 调出<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">以太网头结构</a> <br><br><img src="https://habrastorage.org/webt/yy/s0/qi/yys0qi7tlv5y9mhtdsgwvdtjnh8.png"><br><br> 例如，我们将计算10 GbE。 通过10 GbE接口，最多可以传递<b>1,000,000,000</b>位（10 ^ 10）。 <br><br> 将标头的大小从八位字节转换为位 <br><table><tbody><tr><th></th><th> 个字节 </th><th> 位 </th></tr><tr><td>  L1标题大小 </td><td>  20 </td><td>  160 </td></tr><tr><td>  L2 MAC报头大小 </td><td>  14 </td><td>  112 </td></tr><tr><td>  L2 FCS尺寸 </td><td>  4 </td><td>  32 </td></tr><tr><td>  L2 VLAN大小 </td><td>  4 </td><td>  32 </td></tr><tr><td> 有效载荷最小值 </td><td>  46 </td><td>  368 </td></tr><tr><td> 最大有效载荷 </td><td>  1500 </td><td>  12000 </td></tr><tr><td>  <b>合计</b> </td></tr><tr><td> 无VLAN的最小有效负载 </td><td>  <b>84</b> </td><td>  <b>672</b> </td></tr><tr><td> 最小有效负载w VLAN </td><td>  88 </td><td>  704 </td></tr><tr><td> 不带VLAN的最大有效负载 </td><td>  <b>1538</b> </td><td>  <b>12304</b> </td></tr><tr><td> 最大有效负载w VLAN </td><td>  1542 </td><td>  12336 </td></tr></tbody></table><br>  *在传输网络上使用覆盖技术会影响<abbr title="协议数据单元">PDU</abbr>的初始大小，从而降低最大pps。 <br>  **以VLAN为例。 在网络接口上处理带有VLAN ID的帧可能会有所不同。 有些增加了MTU，另一些减少了允许的最大有效负载大小。 <br><br> 我们通过完全利用接口（线速）来计算每秒<abbr title="协议数据单元">PDU中</abbr>的最大和最小速度 <br><br><table><tbody><tr><td> 最大pps </td><td>  <b>14880952</b> .38 </td></tr><tr><td>  VLAN的最大pps </td><td>  14204545.45 </td></tr><tr><td> 最低pps </td><td>  <b>812743</b> .8231 </td></tr><tr><td>  VLAN的最低pps </td><td>  810635.5383 </td></tr></tbody></table><br><br> 即 通过10 GbE接口，最大传输速率约为14.88 Mpps。 为了便于记忆，我们将其称为zigapack。 <br><br> 我还提请注意以下事实：最大pps和最小pps相差<b>18倍以上</b> 。 因此，在考虑antiDDoS解决方案时，您需要注意以Mpps为单位的性能。 通常，供应商声称以Gbps表示性能，而以数据包表示静音。 评估保护系统性能的方法的描述是另一篇大文章的主题。 <br><br><a name="3"></a><h3>  <font color="#38a5d3">1.2 PDU大小计数的功能</font> </h3><br><img src="https://habrastorage.org/webt/fz/td/yt/fztdyt2phekpdkjlhpxcjnic84i.png"><br> 网络设备可以读取不同级别的<abbr title="协议数据单元">PDU</abbr>大小，并将字段从计数中排除。 频繁计数的字段集： <br><br><ul><li>  L2数据或IP数据包len </li><li>  L2数据+ MAC头 </li><li>  L2数据+ MAC头+ <abbr title="帧检查顺序">FCS</abbr> （CRC校验和） </li></ul><br> 现在，在不使用和使用vlan的情况下，以线速攻击TCP SYN Flood时，我们将计算图表上的读数。 <br><br><table><tbody><tr><th rowspan="2"></th><th rowspan="2">  PDU大小 <br>  （字节） </th><th colspan="2">  Gbps乘法器 </th></tr><tr><th>  10 <sup>9</sup> </th><th>  2 <sup>30</sup> </th></tr><tr><td> 不带vlan的Pps = 14880952.38 </td><td></td><td></td><td></td></tr><tr><td>  L1 </td><td>  84 </td><td>  10 </td><td>  9.313225746 </td></tr><tr><td>  L2 </td><td>  64 </td><td>  <b>7.6190</b> 47619 </td><td>  7.095791045 </td></tr><tr><td>  L2不带FCS </td><td>  60 </td><td>  <b>7.1428</b> 57143 </td><td>  6.652304104 </td></tr><tr><td>  L2数据（IP + TCP） </td><td>  40 </td><td>  4.761904762 </td><td>  4.434869403 </td></tr><tr><td>  VLAN的Pps = 14204545.45 </td><td></td><td></td><td></td></tr><tr><td>  L1 </td><td>  88 </td><td>  10 </td><td>  9.313225746 </td></tr><tr><td>  L2 </td><td>  68 </td><td>  7.727272727 </td><td>  7.196583531 </td></tr><tr><td>  L2不带FCS </td><td>  64 </td><td>  7.272727273 </td><td>  6.773255088 </td></tr><tr><td>  L2数据（IP + TCP） </td><td>  40 </td><td>  4.545454545 </td><td>  4.23328443 </td></tr></tbody></table><br> 因此，充分利用图表中的10 GbE接口，您可以观察到4.43 Gbps的速度。 <br><br> 因此，在不同系统中比较速度值时，您需要了解如何考虑PDU的大小。 为了简化比较，我们为自己制作了一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">计算器</a> ，显示了计算不同标头时的速度。 <br><br> 以下其他两组原因会影响峰值平滑，并且适用于所有速度曲线图。 <br><br><a name="4"></a><h2>  <font color="#38a5d3">2.收集和储存</font> </h2><br><a name="5"></a><h3>  <font color="#38a5d3">2.1计数器轮询频率</font> </h3><br> 通常轮询的计数器显示已处理的字节和数据包的绝对值。 要显示速度，您需要计算导数。 <br><br> 图形的准确性高度取决于轮询计数器的频率。 次数越少，平均数越大。 例如，操作员习惯每五分钟取一次值。 因此，使用Pulse Wave DDoS攻击，监视系统和过滤系统中的图形配置文件将非常不同。 <br><br><a name="6"></a><h3>  <font color="#38a5d3">2.2数据合并（保留策略）</font> </h3><br> 通常，循环数据库（rrd）方法用于存储计数器值。 为了节省资源，不同时期的数据以不同的精度存储。 越远，值越稀疏，平均越大。 <br><br> 不同的系统可能具有不同的保留策略，因此，回顾图表，您可以观察到不同的值。 <br><br><a name="7"></a><h2>  <font color="#38a5d3">3.显示</font> </h2><br><a name="8"></a><h3>  <font color="#38a5d3">3.1图表上的点数</font> </h3><br> 通常，图表上显示的点数是有限制的。 如果在请求的期间内还有更多积分，则在显示积分时将对其进行合并。 大多数情况下，相邻点合并为一个平均值。 该平均使峰值平滑。 <br><br> 说明性示例： <br><br><img src="https://habrastorage.org/webt/lm/ku/-v/lmku-vsnnsqaayqo8fa-y-pobj0.gif"><br><br><a name="9"></a><h3>  <font color="#38a5d3">3.2二进制控制台</font> </h3><br> 图表绘制工具增加了读数中的其他差异。 对于位图，它们可以使用不同的度来显示相同​​的前缀。 您可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">en.wikipedia.org/wiki/上</a>了解更多信息。 <br><br><a name="10"></a><h3>  <font color="#38a5d3">3.3学分</font> </h3><br> 基本上，网络设备上的计数器以字节为单位显示已处理信息的数量。 如果未转换，则该图将以Bps（每秒字节）为单位显示速度，而不是以bps（每秒位数）为单位显示速度。 <br><br><a name="11"></a><h2>  <font color="#38a5d3">结论</font> </h2><br> 图表是有用且信息丰富的工具。 通过查看正确的图形集，您可以快速找到许多问题的答案。 但是在使用图表时，您需要了解细微差别，尤其是在关联来自不同系统的图表时。 因此，第一次查看图表时，请找出： <br><br><ul><li> 发生了什么以及如何 </li><li> 它如何存储； </li><li> 如图所示。 </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN441694/">https://habr.com/ru/post/zh-CN441694/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN441684/index.html">预测：云将在2019年改变</a></li>
<li><a href="../zh-CN441686/index.html">我们如何在Tarantool数据库上实现缓存</a></li>
<li><a href="../zh-CN441688/index.html">游戏改变了世界：地狱之刃如何吸引人们关注精神疾病患者的问题</a></li>
<li><a href="../zh-CN441690/index.html">您不需要区块链：八个众所周知的用例以及它们为什么不起作用</a></li>
<li><a href="../zh-CN441692/index.html">如何覆盖区块链上的轨道？ 我们的交易混合器概念</a></li>
<li><a href="../zh-CN441696/index.html">西里尔文LiveJournal的历史：俄罗斯管理如何压制俄语博客的兴起</a></li>
<li><a href="../zh-CN441698/index.html">断开连接：退出Facebook后会发生什么？</a></li>
<li><a href="../zh-CN441700/index.html">儿童难题如何帮助揭示磁性的秘密</a></li>
<li><a href="../zh-CN441702/index.html">关于个人数据，Roskomnadzor和交友网站的存储</a></li>
<li><a href="../zh-CN441704/index.html">为什么你不应该等待机器人的道德表现</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>