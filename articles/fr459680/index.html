<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õπÔ∏è ‚è≥ üè≥Ô∏è‚Äçüåà Suite √† Highload ++ Siberia 2019 - 8 t√¢ches Oracle üñåÔ∏è üõÄüèæ üñ≤Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut 

 Du 24 au 25 juin, la conf√©rence Highload ++ Siberia 2019 s'est tenue √† Novossibirsk. Nos gars √©taient √©galement pr√©sents sur le rapport "Orac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Suite √† Highload ++ Siberia 2019 - 8 t√¢ches Oracle</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sportmaster_lab/blog/459680/">  Salut <br><br>  Du 24 au 25 juin, la conf√©rence Highload ++ Siberia 2019 s'est tenue √† Novossibirsk. Nos gars √©taient √©galement pr√©sents <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le rapport</a> "Oracle Container Bases (CDB / PDB) et leur utilisation pratique pour le d√©veloppement de logiciels", nous publierons une version texte un peu plus tard.  C'√©tait cool, merci <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">olegbunin</a> pour l'organisation, ainsi que tous ceux qui sont venus. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-7/k4/u1/-7k4u1btcjxquu515qeoyxnxigu.jpeg" width="350"></div><br>  Dans cet article, nous aimerions partager avec vous les t√¢ches qui √©taient sur notre stand afin que vous puissiez tester vos connaissances dans Oracle.  Sous la coupe - 8 t√¢ches, options de r√©ponse et explication. <br><a name="habracut"></a><br><h3>  Quelle est la valeur maximale de la s√©quence que nous verrons √† la suite du script suivant? </h3><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sequence</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> s.currval, s.nextval, s.currval, s.nextval, s.currval <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dual <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">5</span></span>;</code> </pre> <br><ul><li>  1 </li><li>  5 </li><li>  10 </li><li>  25 </li><li>  Non, il y aura une erreur </li></ul><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  Selon la documentation Oracle (cit√©e du 8.1.6): <br>  Dans une seule instruction SQL, Oracle n'incr√©mentera la s√©quence qu'une seule fois par ligne.  Si une instruction contient plusieurs r√©f√©rences √† NEXTVAL pour une s√©quence, Oracle incr√©mente la s√©quence une fois et renvoie la m√™me valeur pour toutes les occurrences de NEXTVAL.  Si une instruction contient des r√©f√©rences √† la fois √† CURRVAL et √† NEXTVAL, Oracle incr√©mente la s√©quence et renvoie la m√™me valeur √† la fois pour CURRVAL et NEXTVAL quelle que soit leur ordre dans l'instruction. <br><br>  Ainsi, la <b>valeur maximale correspondra au nombre de lignes, soit 5</b> . <br></div></div><br><h3>  Combien de lignes y aura-t-il √† la suite du script suivant? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t(i <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> (i &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">procedure</span></span> p(p_from <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>, p_to <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> p_from .. p_to <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (i); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">loop</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; / exec p(1, 3); exec p(4, 6); exec p(7, 9);</code> </pre> <br><ul><li>  0 </li><li>  3 </li><li>  4 </li><li>  5 </li><li>  6 </li><li>  9 </li></ul><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  Selon la documentation Oracle (cit√©e √† partir de 11.2): <br><br>  Avant d'ex√©cuter une instruction SQL, Oracle marque un point de sauvegarde implicite (non disponible pour vous).  Ensuite, si l'instruction √©choue, Oracle la restaure automatiquement et renvoie le code d'erreur applicable √† SQLCODE dans le SQLCA.  Par exemple, si une instruction INSERT provoque une erreur en essayant d'ins√©rer une valeur en double dans un index unique, l'instruction est annul√©e. <br><br>  Un appel du client est √©galement consid√©r√© et trait√© comme une seule d√©claration.  Ainsi, le premier appel √† HP se termine avec succ√®s en ins√©rant trois enregistrements;  le deuxi√®me appel √† HP se termine par une erreur et annule le quatri√®me enregistrement, que j'ai r√©ussi √† ins√©rer;  le troisi√®me appel √©choue <b>et trois entr√©es apparaissent dans le tableau</b> . <br></div></div><br><h3>  Combien de lignes y aura-t-il √† la suite du script suivant? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t(i <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">constraint</span></span> i_ch <span class="hljs-keyword"><span class="hljs-keyword">check</span></span> (i &lt; <span class="hljs-number"><span class="hljs-number">3</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-literal"><span class="hljs-literal">null</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">5</span></span>); exception when others then dbms_output.put_line('Oops!'); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; /</code> </pre> <br><ul><li>  1 </li><li>  2 </li><li>  3 </li><li>  4 </li><li>  5 </li><li>  6 </li><li>  7 </li></ul><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  Selon la documentation Oracle (cit√©e √† partir de 11.2): <br><br>  Une contrainte de v√©rification vous permet de sp√©cifier une condition √† laquelle chaque ligne du tableau doit satisfaire.  Pour satisfaire la contrainte, chaque ligne du tableau doit rendre la condition TRUE ou inconnue (en raison d'une valeur null).  Lorsqu'Oracle √©value une condition de contrainte de v√©rification pour une ligne particuli√®re, tous les noms de colonne de la condition font r√©f√©rence aux valeurs de colonne de cette ligne. <br><br>  Ainsi, la valeur nulle passera le test et le bloc anonyme sera ex√©cut√© avec succ√®s jusqu'√† la tentative d'insertion de la valeur 3. Apr√®s cela, le bloc de traitement d'erreur l√®vera une exception, la restauration ne se produira pas et <b>la table aura quatre lignes</b> avec les valeurs 1, null, 2 et null √† nouveau. <br></div></div><br><h3>  Quelles paires de valeurs occuperont la m√™me quantit√© d'espace dans le bloc? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t ( a <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), b <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), c <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), i <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>), j <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">14</span></span>), k <span class="hljs-built_in"><span class="hljs-built_in">number</span></span>(<span class="hljs-number"><span class="hljs-number">24</span></span>), x varchar2(<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), y varchar2(<span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), z varchar2(<span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t (a, b, i, j, x, y) <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-string"><span class="hljs-string">'Y'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>);</code> </pre><br><ul><li>  A et X </li><li>  B et Y </li><li>  C et K </li><li>  C et Z </li><li>  K et Z </li><li>  I et J </li><li>  J et X </li><li>  Tous list√©s </li></ul><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  Voici des extraits de la documentation (12.1.0.2) pour stocker diff√©rents types de donn√©es dans Oracle. <br><br>  <b>Type de donn√©es char</b> <br>  Le type de donn√©es CHAR sp√©cifie une cha√Æne de caract√®res de longueur fixe dans le jeu de caract√®res de la base de donn√©es.  Vous sp√©cifiez le jeu de caract√®res de la base de donn√©es lorsque vous cr√©ez votre base de donn√©es.  Oracle s'assure que toutes les valeurs stock√©es dans une colonne CHAR ont la longueur sp√©cifi√©e par taille dans la s√©mantique de longueur s√©lectionn√©e.  Si vous ins√©rez une valeur plus courte que la longueur de la colonne, Oracle vide la valeur √† la longueur de la colonne. <br><br>  <b>Type de donn√©es VARCHAR2</b> <br>  Le type de donn√©es VARCHAR2 sp√©cifie une cha√Æne de caract√®res de longueur variable dans le jeu de caract√®res de la base de donn√©es.  Vous sp√©cifiez le jeu de caract√®res de la base de donn√©es lorsque vous cr√©ez votre base de donn√©es.  Oracle stocke une valeur de caract√®re dans une colonne VARCHAR2 exactement comme vous la sp√©cifiez, sans aucun remplissage blanc, √† condition que la valeur ne d√©passe pas la longueur de la colonne. <br><br>  <b>NUMBER Type de donn√©es</b> <br>  Le type de donn√©es NUMBER stocke z√©ro ainsi que des nombres fixes positifs et n√©gatifs avec des valeurs absolues de 1,0 x 10-130 √† 1,0 X 10126, mais non compris. Si vous sp√©cifiez une expression arithm√©tique dont la valeur a une valeur absolue sup√©rieure ou √©gale √† 1,0 x 10126, puis Oracle renvoie une erreur.  Chaque valeur NUMBER n√©cessite de 1 √† 22 octets.  En tenant compte de cela, la taille de la colonne en octets pour une valeur num√©rique donn√©e NUMBER (p), o√π p est la pr√©cision d'une valeur donn√©e, peut √™tre calcul√©e √† l'aide de la formule suivante: <i>ROUND ((longueur (p) + s) / 2)) + 1</i> o√π s est √©gal √† z√©ro si le nombre est positif et s est √©gal √† 1 si le nombre est n√©gatif. <br><br>  De plus, nous prenons un extrait de la documentation sur le stockage des valeurs Null. <br><br>  Un null est l'absence d'une valeur dans une colonne.  Les valeurs nulles indiquent des donn√©es manquantes, inconnues ou inapplicables.  Les valeurs nulles sont stock√©es dans la base de donn√©es si elles tombent entre des colonnes avec des valeurs de donn√©es.  Dans ces cas, ils n√©cessitent 1 octet pour stocker la longueur de la colonne (z√©ro).  Les null √† la fin d'une ligne ne n√©cessitent aucun stockage car un nouvel en-t√™te de ligne signale que les colonnes restantes de la ligne pr√©c√©dente sont nulles.  Par exemple, si les trois derni√®res colonnes d'une table sont nulles, aucune donn√©e n'est stock√©e pour ces colonnes. <br><br>  Sur la base de ces donn√©es, nous construisons un raisonnement.  Nous pensons que la base de donn√©es utilise le codage AL32UTF8.  Dans cet encodage, les lettres russes occuperont 2 octets. <br><br>  1) A et X, la valeur du champ a 'Y' est de 1 octet, la valeur du champ x 'D' est de 2 octets <br>  2) B et Y, 'Vasya' en valeur b sera compl√©t√© par des espaces jusqu'√† 10 caract√®res et occupera 14 octets, 'Vasya' en d - prendra 8 octets. <br>  3) C et K. Les deux champs sont NULS, apr√®s eux il y a des champs significatifs, donc ils occupent 1 octet. <br>  4) C et Z. Les deux champs sont NULS, mais le champ Z est le dernier de la table, donc il ne prend pas d'espace (0 octet).  Le champ C occupe 1 octet. <br>  5) K et Z. Similaire au cas pr√©c√©dent.  La valeur dans le champ K est de 1 octet, en Z - 0. <br>  6) I et J. Selon la documentation, les deux valeurs prendront chacune 2 octets.  Nous consid√©rons la longueur selon la formule tir√©e de la documentation: round ((1 + 0) / 2) +1 = 1 + 1 = 2. <br>  7) J et X. La valeur dans le champ J prendra 2 octets, la valeur dans le champ X prendra 2 octets. <br><br>  <b>Au total, les options correctes sont: C et K, I et J, J et X.</b> <br></div></div><br><br><h3>  Quel sera le facteur de regroupement de l'indice T_I approximativement? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t (i <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">rownum</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dual <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> &lt;= <span class="hljs-number"><span class="hljs-number">10000</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> t_i <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> t(i);</code> </pre><br><ul><li>  Des dizaines </li><li>  Environ des centaines </li><li>  De l'ordre de milliers </li><li>  De l'ordre de dizaines de milliers </li></ul><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  Selon la documentation Oracle (cit√©e de 12.1): <br><br>  Pour un index B-tree, le facteur de regroupement d'index mesure le regroupement physique des lignes par rapport √† une valeur d'index. <br><br>  Le facteur de regroupement d'index aide l'optimiseur √† d√©cider si une analyse d'index ou une analyse de table compl√®te est plus efficace pour certaines requ√™tes).  Un facteur de regroupement faible indique un balayage d'index efficace. <br><br>  Un facteur de regroupement proche du nombre de blocs dans une table indique que les lignes sont physiquement ordonn√©es dans les blocs de la table par la cl√© d'index.  Si la base de donn√©es effectue une analyse compl√®te de la table, la base de donn√©es a tendance √† r√©cup√©rer les lignes lorsqu'elles sont stock√©es sur le disque tri√©es par la cl√© d'index.  Un facteur de regroupement proche du nombre de lignes indique que les lignes sont dispers√©es de mani√®re al√©atoire sur les blocs de base de donn√©es par rapport √† la cl√© d'index.  Si la base de donn√©es effectue une analyse compl√®te de la table, la base de donn√©es ne r√©cup√©rera pas les lignes dans aucun ordre tri√© par cette cl√© d'index. <br><br>  Dans ce cas, les donn√©es sont id√©alement tri√©es, donc le facteur de regroupement sera √©gal ou proche du nombre de blocs occup√©s dans la table.  Pour une taille de bloc standard de 8 kilo-octets, vous pouvez vous attendre √† ce qu‚Äôenviron mille valeurs de nombres √©troits tiennent dans un bloc, de sorte que le nombre de blocs, et par cons√©quent le facteur de regroupement, sera de l‚Äô <b>ordre de dizaines</b> . <br></div></div><br><h3>  √Ä quelles valeurs de N le script suivant sera ex√©cut√© avec succ√®s dans une base de donn√©es standard avec des param√®tres standard? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t ( a varchar2(N <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), b varchar2(N <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), c varchar2(N <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>), d varchar2(N <span class="hljs-built_in"><span class="hljs-built_in">char</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">index</span></span> t_i <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> t (a, b, c, d);</code> </pre><br><ul><li>  100 </li><li>  200 </li><li>  400 </li><li>  800 </li><li>  1600 </li><li>  3200 </li><li>  6400 </li></ul><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  Selon la documentation Oracle (cit√©e √† partir de 11.2): <br><br>  Limites de la base de donn√©es logique <br><br><div class="scrollable-table"><table><thead><tr><td>  <strong>Objet</strong> </td><td>  <strong>Type de limite</strong> </td><td>  <strong>Valeur limite</strong> </td></tr></thead><tbody><tr><td>  Index </td><td>  Taille totale de la colonne index√©e </td><td>  75% de la taille du bloc de base de donn√©es moins certains frais g√©n√©raux </td></tr></tbody></table></div><br>  Ainsi, la taille totale des colonnes index√©es ne doit pas d√©passer 6 Ko.  D√©pend en outre de la base de codage s√©lectionn√©e.  Pour le codage AL32UTF8, un caract√®re peut occuper un maximum de 4 octets, donc dans le pire des cas, 6 kilo-octets conviendront √† environ 1 500 caract√®res.  Par cons√©quent, Oracle interdira la cr√©ation d'index √† N = 400 (lorsque la longueur de cl√© dans le pire des cas est de 1600 caract√®res * 4 octets + longueur de rowid), tandis <b>qu'√† N = 200 (ou moins)</b> , la cr√©ation d'index fonctionnera sans probl√®me. <br></div></div><br><h3>  L'instruction INSERT avec l'indicateur APPEND est con√ßue pour charger des donn√©es en mode direct.  Que se passe-t-il s'il est appliqu√© √† la table sur laquelle le d√©clencheur est suspendu? </h3><br><ul><li>  Les donn√©es seront charg√©es en mode direct, le d√©clencheur fonctionnera comme il se doit </li><li>  Les donn√©es seront charg√©es en mode direct, mais le d√©clencheur ne sera pas ex√©cut√© </li><li>  Les donn√©es seront charg√©es en mode conventionnel, le d√©clencheur fonctionnera comme il se doit </li><li>  Les donn√©es seront charg√©es en mode conventionnel, mais le d√©clencheur ne sera pas ex√©cut√© </li><li>  Les donn√©es ne seront pas t√©l√©charg√©es, l'erreur sera corrig√©e </li></ul><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  En principe, c'est plus une question de logique.  Pour trouver la bonne r√©ponse, je sugg√®re le mod√®le de raisonnement suivant: <br><br><ol><li>  L'insertion en mode direct est effectu√©e par la formation directe d'un bloc de donn√©es, pass√© le moteur SQL, ce qui garantit une vitesse √©lev√©e.  Ainsi, assurer l'ex√©cution du d√©clencheur est tr√®s difficile, si possible, et cela n'a aucun sens, car cela ralentira de toute fa√ßon consid√©rablement l'insertion. </li><li>  Le non-d√©clenchement entra√Ænera le fait que, avec les m√™mes donn√©es dans la table, l'√©tat de la base de donn√©es dans son ensemble (des autres tables) d√©pendra du mode dans lequel les donn√©es sont ins√©r√©es.  Cela d√©truira √©videmment l'int√©grit√© des donn√©es et ne peut pas √™tre appliqu√© comme solution en production. </li><li>  L'incapacit√© √† effectuer l'op√©ration demand√©e est g√©n√©ralement trait√©e comme une erreur.  Mais ici, il faut se rappeler que APPEND est un indice, et la logique g√©n√©rale des indices est qu'ils sont pris en compte si possible, sinon, l'op√©rateur est ex√©cut√© sans tenir compte de l'indice. </li></ol><br>  Ainsi, la r√©ponse attendue est que les <b>donn√©es seront charg√©es en mode normal (SQL), le d√©clencheur se d√©clenchera.</b> <br><br>  Selon la documentation Oracle (cit√©e de 8.04): <br><br>  Les violations des restrictions entra√Æneront l'ex√©cution de l'instruction en s√©rie, en utilisant le chemin d'insertion conventionnel, sans avertissement ni message d'erreur.  Une exception est la restriction des instructions acc√©dant √† la m√™me table plusieurs fois dans une transaction, ce qui peut provoquer des messages d'erreur. <br>  Par exemple, si des d√©clencheurs ou l'int√©grit√© r√©f√©rentielle sont pr√©sents sur la table, le conseil APPEND sera ignor√© lorsque vous essayez d'utiliser INSERT √† chargement direct (s√©rie ou parall√®le), ainsi que le conseil ou la clause PARALLEL, le cas √©ch√©ant. </div></div><br><h3>  Que se passe-t-il lors de l'ex√©cution du script suivant? </h3><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> t(i <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>, j <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> <span class="hljs-keyword"><span class="hljs-keyword">references</span></span> t); <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">trigger</span></span> t_a_i <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">each</span></span> <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> <span class="hljs-keyword"><span class="hljs-keyword">declare</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pragma</span></span> autonomous_transaction; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (:new.i + <span class="hljs-number"><span class="hljs-number">1</span></span>, :new.i); <span class="hljs-keyword"><span class="hljs-keyword">commit</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; / <span class="hljs-keyword"><span class="hljs-keyword">insert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">into</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">values</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre><br><ul><li>  Ex√©cution r√©ussie </li><li>  √âchec de l'erreur de syntaxe </li><li>  Erreur de transaction hors ligne non valide </li><li>  Erreur li√©e au d√©passement de l'imbrication d'appel maximale </li><li>  Erreur de violation de cl√© √©trang√®re </li><li>  Erreur de verrouillage </li></ul><br><div class="spoiler">  <b class="spoiler_title">La r√©ponse</b> <div class="spoiler_text">  La table et le d√©clencheur sont cr√©√©s correctement et cette op√©ration ne devrait pas entra√Æner de probl√®mes.  Les transactions autonomes dans le d√©clencheur sont √©galement autoris√©es, sinon il serait impossible, par exemple, la journalisation. <br><br>  Apr√®s avoir ins√©r√© la premi√®re ligne, un d√©clencheur r√©ussi entra√Ænerait l'insertion de la deuxi√®me ligne, dans le cadre de laquelle le d√©clencheur fonctionnerait √† nouveau, ins√©rer la troisi√®me ligne, et ainsi de suite jusqu'√† ce que l'instruction tombe en raison du d√©passement de l'imbrication maximale des appels.  Cependant, un autre point subtil est d√©clench√©.  Au moment o√π le d√©clencheur est ex√©cut√©, la validation n'est pas encore ex√©cut√©e pour le premier enregistrement ins√©r√©.  Par cons√©quent, un d√©clencheur fonctionnant dans une transaction autonome tente d'ins√©rer une ligne dans la table qui fait r√©f√©rence par une cl√© √©trang√®re √† un enregistrement qui n'a pas encore √©t√© valid√©.  Cela conduit √† une attente (une transaction autonome attend que le commit principal comprenne s'il est possible d'ins√©rer des donn√©es) et en m√™me temps la transaction principale attend que le commit autonome continue de fonctionner apr√®s le d√©clencheur.  <b>Un blocage se produit et, par cons√©quent, une transaction autonome est renvoy√©e pour la raison associ√©e aux verrous</b> . <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr459680/">https://habr.com/ru/post/fr459680/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr459662/index.html">PVS-Studio voulait, mais n'a pas pu trouver de bogues dans robots.txt</a></li>
<li><a href="../fr459668/index.html">Comment reconna√Ætre le texte d'une photo: nouvelles fonctionnalit√©s du cadre Vision</a></li>
<li><a href="../fr459670/index.html">Aller √† Amsterdam</a></li>
<li><a href="../fr459672/index.html">Souligner en Python</a></li>
<li><a href="../fr459674/index.html">Threat Intelligence Epic Saga</a></li>
<li><a href="../fr459682/index.html">Qualit√© des donn√©es en stockage</a></li>
<li><a href="../fr459684/index.html">Carte du m√©tro de Moscou et du monde entier pour Android</a></li>
<li><a href="../fr459688/index.html">L'urbanisme en Chine: moins de hipsters, plus de science et d'informatique</a></li>
<li><a href="../fr459692/index.html">Comment nous avons d√©couvert des modifications mat√©rielles qui contredisent les principes chimiques √©tablis</a></li>
<li><a href="../fr459694/index.html">Museum DataArt. D√©ballez et lancez Radio 86RK</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>