<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฌ๏ธ โฌ๏ธ ๐ ุจุฑุงูุฌ ุฃูุงู ุฅุถุงููุฉ ูู NAS ๐ฅ ๐คฒ ๐ฏ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุณูุณูุฉ ุงูููุงูุงุช ุจุนููุงู ุจูุงุก ูุงุณ ุขูู . ูุฐูู ุ ุณุชูุธุฑ ูุฐู ุงูููุงูุฉ ูู ุฒูุงุฏุฉ ูุณุชูู ุงูุฃูุงู. ุฃูุถุง ุ ุณูุชู ูุตู ุชูู ุงูุฃุฏูุงุช ุงูุชู ูู ุฃุณุชุฎุฏููุง ุ ูููู ูู ุงููููู ุชุทุจ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุจุฑุงูุฌ ุฃูุงู ุฅุถุงููุฉ ูู NAS</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421279/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/39/ch/xl/39chxldtklziggqygx3wgmom0ky.png"></p><br><p style=";text-align:right;direction:rtl">  ุณูุณูุฉ ุงูููุงูุงุช ุจุนููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจูุงุก ูุงุณ ุขูู</a> .  ูุฐูู ุ ุณุชูุธุฑ ูุฐู ุงูููุงูุฉ ูู ุฒูุงุฏุฉ ูุณุชูู ุงูุฃูุงู.  ุฃูุถุง ุ ุณูุชู ูุตู ุชูู ุงูุฃุฏูุงุช ุงูุชู ูู ุฃุณุชุฎุฏููุง ุ ูููู ูู ุงููููู ุชุทุจูููุง. </p><a name="habracut"></a><br><h2 id="kto-i-kak" style=";text-align:right;direction:rtl">  ูู ููููุ </h2><br><p style=";text-align:right;direction:rtl">  ูู ุณููุงุฌู ุงููุธุงู ูููู ุณููุนู ุฐููุ </p><br><p style=";text-align:right;direction:rtl">  ุนุงุฏุฉ ูุง ูููู ูุฐุง ูู ุงูุณุคุงู ุงูุฃูู ุงูุฐู ูุฌุจ ุงูุฅุฌุงุจุฉ ุนููู ูุจู ุงูุญุฏูุซ ุนู ุงูุฃูู. <br>  ุนูู ุงูุฃูู ูู ุญุงูุฉ ูุงุณ ุ ูุซู ูุฐู ุงูุฅุฌุงุจุฉ ุถูููุฉ ุจุงููุนู.  ูููู ูู ุฃุฌู ุงูุฅุฌุงุจุฉ ุงููุงููุฉ ุนูู ูุฐุง ุงูุณุคุงู ุ ูุชู ุจูุงุก ูููุฐุฌ ุงูุชูุฏูุฏ ููููุฐุฌ ุงูุฏุฎูู. </p><br><p style=";text-align:right;direction:rtl">  ุชุดุฑุน ุงูุดุฑูุงุช ูู ูุฑุญูุฉ ููุฐุฌุฉ ุงูุชูุฏูุฏ ูู ุฏูุฑุงุช ุชุทููุฑูุง. <br>  ูุงููุฑูุณููุช ูุฏููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SDL</a> ูุฐูู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฏู</a> ุงููุงุณ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฐุฌ ุฃุฎุฑู</a> . </p><br><p style=";text-align:right;direction:rtl">  ุฅููุง ุชุนูู ุงุณุชุฎุฏุงู ุชูููุงุช ูุนููุฉ ุ ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">STRIDE</a> ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">DREAD</a> (ูุง ุชุฒุงู STRIDE ุฃูุซุฑ ุนููููุฉ ููุฏุนููุฉ ุจุดูู ุฌูุฏ ุจุดูู ูุนุงู). </p><br><p style=";text-align:right;direction:rtl">  ูู STRIDE ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุชู ุจูุงุก ุงููููุฐุฌ ุนูู ุชุฏููุงุช ุงูุจูุงูุงุช ูุนุงุฏุฉ ูุง ูููู ูุจูุฑูุง ูุซููููุง ูุบูุฑ ููููู ุฌูุฏูุง.  ููุน ุฐูู ุ ุชููุฑ ุงูุฃุฏุงุฉ ูุงุฆูุฉ ุจุงูุชูุฏูุฏุงุช ุงููุญุชููุฉ ุ ููุง ูุณูู ุงููุธุฑ ูููุง. </p><br><p style=";text-align:right;direction:rtl">  ูููุฐุฌ ุงูุชูุฏูุฏ ูู ูุนูููุงุช ุณุฑูุฉ ูุฃูู ูุณูู ุนูู ุงูููุงุฌู ุชุญููู ุงููุธุงู ูุงูุนุซูุฑ ุนูู ููุงุท ุงูุถุนู.  ุฅุฐุง ุญุตู ุนูู ูููุฐุฌ ุ ููู ูุถุทุฑ ุฅูู ุจูุงุฆู ุจููุฑุฏู ุ ูุฃู ุงููุญูููู ูุฏ ุงุนุชููุง ุจุงููุนู ุจูู ุดูุก. </p><br><p style=";text-align:right;direction:rtl">  <strong>ูุงูุช ุฏูููุฉ ูู ุงูุฏุนุงูุฉ.</strong> </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/w4/ye/cz/w4yeczwns0wzroeq-ufxttf9yhm.jpeg"></p><br><p style=";text-align:right;direction:rtl">  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ุชุจูู ุจูุง ุงูุดุฑูุงุช ุงูุฌุงุฏุฉ ุงููููุฐุฌ.  ูุฅุฐุง ูุงู ูุฐุง ูุซูุฑูุง ููุงูุชูุงู ุ ูููููู ูุตูู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ูู ููุงูุฉ ูููุตูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุง ุณุฃุตู ูุง ูุณูู ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"ุงูุชุตูุจ"</a> ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ูุณุฃุชุนุงูู ูุน ุงูุนููุจ ุงูุฃูููุฉ ุงูุชู ุญุฏุซุช ุฃุซูุงุก ุจูุงุก ุงููุธุงู. </p><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุฃุณุงุณู ุ ูุชู ุงูุญูุงุธ ุนูู ุงูุฃูุงู ุนูุฏ ูุฐุง ุงููุณุชูู ุนู ุทุฑูู ุฅุบูุงู ุซุบุฑุงุช ุงููุธุงู ุงููุนุฑููุฉ ููุฑุงูุจุชูุง ูุงูุชุญูู ูููุง ุจุดูู ุฏูุฑู. </p><br><h2 id="literatura-po-teme" style=";text-align:right;direction:rtl">  ุงูุฃุฏุจ ุฐู ุงูุตูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ูุงุฐุง ุชูุฑุฃ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงูุฌุฏูุฑ ุงูุจุฏุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจูุดุฑูุน Linux Hardened</a> ุ ุญูุซ ุณูุฌุฏ ุงูุฌููุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซูุฑ ูู ุงูุฃุดูุงุก ุงููููุฏุฉ</a> . </li><li style=";text-align:right;direction:rtl">  ุชุญุชูู ุงูุญุฒูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุชุดุฏุฏุฉ</a> ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏููู ุฏูุจูุงู ุงููุคูู</a> ุงููุฏูู ูู ุนุงู 2012 ุ ููู ุงูุฌุฑู ูุง ูุชุนุงุฑุถ ูุน ููู ุงููุดููุฉ. </li><li style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุงูุฑุฃ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌููุฉ ุฏุจูุงู</a> ุงููุตูุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Hardening</a> ุงููุตูุฑุฉ. </li><li style=";text-align:right;direction:rtl">  ูุฃุฎูุฑูุง ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏููู ุตุบูุฑ ูุญุฒู Hardening deb</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดูุฑุฉ C / C ++</a> ุงูุชู ูู ุชุญุชุงุฌูุง ุนูู ุงูุฃุฑุฌุญ. </li></ul><br><h2 id="snapshoty-i-doker" style=";text-align:right;direction:rtl">  ููุทุงุช ู Docker </h2><br><p style=";text-align:right;direction:rtl">  ูู ุงูุณุงุจู ุ ุชู ุชุซุจูุช zfs-autosnapshot.  ููุฏ ุณุงุนุฏูู ูุฑุงุฑุง ุ ูุฃูู  ูููููู ุงุณุชุนุงุฏุฉ ุงูุชููููุงุช ุงูุชุงููุฉ (ูู Nextcloud ุ ุนูู ุณุจูู ุงููุซุงู) ูู ุงูููุทุงุช. <br>  ููุน ุฐูู ุ ูุน ูุฑูุฑ ุงูููุช ุ ุจุฏุฃ ุงููุธุงู ูู ุงูุชุจุงุทุค ุ ูุชูุงุซุฑุช ุนุฏุฉ ุขูุงู ูู ุงูููุทุงุช. </p><br><p style=";text-align:right;direction:rtl"> <code>com.sun:auto-snapshot=false</code> ุฃูู ุนูุฏ ุฅูุดุงุก ูุธุงู ุงููููุงุช ุงูุฑุฆูุณู ููุญุงููุงุช ุ ูุณูุช ุชุนููู ุงูุนูู <code>com.sun:auto-snapshot=false</code> . </p><br><p style=";text-align:right;direction:rtl">  ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงูุฉ ุงูุฃุตููุฉ ุ</a> ุชู ุฅุตูุงุญ ูุฐู ุงููุดููุฉ ุจุงููุนู ุ ููุง ุณุฃูุถุญ ููููุฉ ุงูุชุฎูุต ูู ุงูููุทุงุช ุงูุฅุถุงููุฉ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุงุตูู ุญูู ููููุฉ ุฅุตูุงุญ ุงูุฎุทุฃ.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ูู ุจุฅููุงู ุชุดุบูู zfs-auto-snapshot ุนูู ูุธุงู ุงููููุงุช ุงูุฑุฆูุณู ููุงุตูุฉ ุงูููุงูุฆ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">zfs set com.sun:auto-snapshot=false tank0/docker/lib</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูู ุจุฅุฒุงูุฉ ุงูุญุงููุงุช ูุงูุตูุฑ ุบูุฑ ุงููุณุชุฎุฏูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">docker container prune docker image prune</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญุฐู ุงูููุทุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">zfs list -t snapshot -o name -S creation | grep -e ".*docker/lib.*@zfs-auto-snap" | tail -n +1500 | xargs -n 1 zfs destroy -vr</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููู ุจุฅููุงู ุชุดุบูููุง ุนูู ุฌููุน ุฃูุธูุฉ ูููุงุช ุงูุตูุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">zfs list -t filesystem -o name -S creation | grep -e "tank0/docker/lib" | xargs -n 1 zfs set com.sun:auto-snapshot=false</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ูุฑุงุกุฉ ุงููุฒูุฏ ูู ุงูุชูุงุตูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . </p></div></div><br><h2 id="ldap" style=";text-align:right;direction:rtl">  LDAP </h2><br><p style=";text-align:right;direction:rtl">  ุขุฎุฑ ูุฑุฉ ุ ุชู ุฅูุดุงุก ูุณุชุฎุฏู LDAP ูุงุญุฏ ููุท ูู ุฏูุฑ ูุณุคูู. </p><br><p style=";text-align:right;direction:rtl">  ูููู ูุนุธู ุงูุฎุฏูุงุช ูุง ุชุญุชุงุฌ ุฅูู ุชุบููุฑ ุฃู ุดูุก ูู ูุงุนุฏุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู.  ูุฐูู ุ ุณูููู ูู ุงูุฌูุฏ ุฅุถุงูุฉ ูุณุชุฎุฏู ูููุฑุงุกุฉ ููุท.  ูู ุฃุฌู ุนุฏู ุฅูุดุงุก ุงูุฃุฏูุงุฑ ูุฏูููุง ุ ูู ุงููููู ุงุณุชุฎุฏุงู ุจุฑูุงูุฌ ูุตู ูุชููุฆุฉ ุงูุญุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ุฃุถู ุงูุฅุนุฏุงุฏุงุช ูู <code>docker-compose.yml</code> ูุชูููู ุงููุณุชุฎุฏู ูููุฑุงุกุฉ ููุท: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">- "LDAP_READONLY_USER=true" - "LDAP_READONLY_USER_USERNAME=readonly" - "LDAP_READONLY_USER_PASSWORD=READONLY_PASSWORD"</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููู ูุงูู ุชุญุช ุงูููุณุฏ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนุงูู ูููุงุก ุฏููุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">version: "2" networks: ldap: docker0: external: name: docker0 services: open-ldap: image: "osixia/openldap" hostname: "open-ldap" restart: always environment: - "LDAP_ORGANISATION=NAS" - "LDAP_DOMAIN=nas.nas" - "LDAP_ADMIN_PASSWORD=ADMIN_PASSWORD" - "LDAP_CONFIG_PASSWORD=CONFIG_PASSWORD" - "LDAP_READONLY_USER=true" - "LDAP_READONLY_USER_USERNAME=readonly" - "LDAP_READONLY_USER_PASSWORD=READONLY_PASSWORD" - "LDAP_TLS=true" - "LDAP_TLS_ENFORCE=false" - "LDAP_TLS_CRT_FILENAME=ldap_server.crt" - "LDAP_TLS_KEY_FILENAME=ldap_server.key" - "LDAP_TLS_CA_CRT_FILENAME=ldap_server.crt" volumes: - ./certs:/container/service/slapd/assets/certs - ./ldap_data/var/lib:/var/lib/ldap - ./ldap_data/etc/ldap/slapd.d:/etc/ldap/slapd.d networks: - ldap ports: - 172.21.0.1:389:389 - 172.21.0.1:636:636 phpldapadmin: image: "osixia/phpldapadmin:0.7.1" hostname: "nas.nas" restart: always networks: - ldap - docker0 expose: - 443 links: - open-ldap:open-ldap-server volumes: - ./certs:/container/service/phpldapadmin/assets/apache2/certs environment: - VIRTUAL_HOST=ldap.* - VIRTUAL_PORT=443 - VIRTUAL_PROTO=https - CERT_NAME=NAS.cloudns.cc - "PHPLDAPADMIN_LDAP_HOSTS=open-ldap-server" #- "PHPLDAPADMIN_HTTPS=false" - "PHPLDAPADMIN_HTTPS_CRT_FILENAME=certs/ldap_server.crt" - "PHPLDAPADMIN_HTTPS_KEY_FILENAME=private/ldap_server.key" - "PHPLDAPADMIN_HTTPS_CA_CRT_FILENAME=certs/ldap_server.crt" - "PHPLDAPADMIN_LDAP_CLIENT_TLS_REQCERT=allow" ldap-ssp: image: openfrontier/ldap-ssp:https volumes: - /etc/ssl/certs/ssl-cert-snakeoil.pem:/etc/ssl/certs/ssl-cert-snakeoil.pem - /etc/ssl/private/ssl-cert-snakeoil.key:/etc/ssl/private/ssl-cert-snakeoil.key restart: always networks: - ldap - docker0 expose: - 80 links: - open-ldap:open-ldap-server environment: - VIRTUAL_HOST=ssp.* - VIRTUAL_PORT=80 - VIRTUAL_PROTO=http - CERT_NAME=NAS.cloudns.cc - "LDAP_URL=ldap://open-ldap-server:389" - "LDAP_BINDDN=cn=admin,dc=nas,dc=nas" - "LDAP_BINDPW=ADMIN_PASSWORD" - "LDAP_BASE=ou=users,dc=nas,dc=nas" - "MAIL_FROM=admin@nas.nas" - "PWD_MIN_LENGTH=8" - "PWD_MIN_LOWER=3" - "PWD_MIN_DIGIT=2" - "SMTP_HOST=" - "SMTP_USER=" - "SMTP_PASS="</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุซู ุ ุชุญุชุงุฌ ุฅูู ุชูุฑูุบ ูุญุฐู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ cd /tank0/docker/services/ldap $ tar czf ~/ldap_backup.tgz . $ ldapsearch -Wx -D "cn=admin,dc=nas,dc=nas" -b "dc=nas,dc=nas" -H ldap://172.21.0.1 -LLL &gt; ldap_dump.ldif $ docker-compose down $ rm -rf ldap_data $ docker-compose up -d</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููุน ุงูุฎุงุฏู ูู ุงูุชุนุงูู ูู ุงูุชูุฑูุบ ูู ุงูุนูุงุตุฑ ุงูููุฑุฑุฉ ุ ุงุญุฐู ุงูุฃุณุทุฑ ูู ุงูููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">dn: dc=nas,dc=nas objectClass: top objectClass: dcObject objectClass: organization o: NAS dc: nas dn: cn=admin,dc=nas,dc=nas objectClass: simpleSecurityObject objectClass: organizationalRole cn: admin description: LDAP administrator userPassword:: PASSWORD_BASE64</code> </pre><br><p style=";text-align:right;direction:rtl">  ูุงุณุชุนุงุฏุฉ ุงููุณุชุฎุฏููู ูุงููุฌููุนุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ ldapadd -Wx -D "cn=admin,dc=nas,dc=nas" -H ldap://172.21.0.1 -f ldap_dump.ldif</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุธูุฑ ูุฐุง ุงููุญุด ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">dn: cn=readonly,dc=nas,dc=nas cn: readonly objectClass: simpleSecurityObject objectClass: organizationalRole userPassword:: PASSWORD_BASE64 description: LDAP read only user</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุชู ุฅูุดุงุก ุงูุฃุฏูุงุฑ ูู ุชููุฆุฉ ุฎุงุฏู LDAP ูู ุฎูุงู ุงูุญุงููุฉ. <br>  ูู ุจุฅุฌุฑุงุก ุนูููุงุช ุงูุชุญูู ุจุนุฏ ุงูุงุณุชุฑุฏุงุฏ ูุญุฐู ุงููุณุฎ ุงูุงุญุชูุงุทู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">$ rm ~/ldap_backup.tgz</code> </pre> <br><h3 id="dobavlenie-grupp-v-ldap" style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ ูุฌููุนุงุช ุฅูู LDAP </h3><br><p style=";text-align:right;direction:rtl">  ููุงุฆู ูู ูุตู ูุณุชุฎุฏูู LDAP ุฅูู ูุฌููุนุงุช ูุดุงุจูุฉ ููุฌููุนุงุช POSIX ุนูู Linux. <br>  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงููููู ุฅูุดุงุก ูุฌููุนุงุช ูููู ููุณุชุฎุฏูููุง ุงููุตูู ุฅูู ุงููุณุชูุฏุนุงุช ุฃู ุงููุตูู ุฅูู ุงูุณุญุงุจุฉ ุฃู ุงููุตูู ุฅูู ุงูููุชุจุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุชุชู ุฅุถุงูุฉ ุงููุฌููุนุงุช ุจุณูููุฉ ุฅูู phpLDAPAdmin ุ ููู ุฃุฑูุฒ ุนูู ุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุงุญุธ ูุง ููู ููุท: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุฅูุดุงุก ุงููุฌููุนุฉ ูู ุงููููุฐุฌ "ุงูุงูุชุฑุงุถู".  ูุฐู <strong>ููุณุช</strong> ูุฌููุนุฉ <strong>POSIX</strong> ุ ุจู ูุฌููุนุฉ ูู ุงูุฃุณูุงุก. </li><li style=";text-align:right;direction:rtl">  ููููุง ูุฐูู ุ ุชุญุชูู ุงููุฌููุนุฉ ุนูู ุณูุฉ <code>objectClass</code> ุชุชุถูู ูููุฉ <code>groupOfUniqueNames</code> . </li></ul><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/tx/i8/yj/txi8yjxxtbvlzynr1yttkn-ddgc.png" alt="ุฅุถุงูุฉ ูุฌููุนุฉ ุฅูู phpLDAPAdmin"></a> </p><br><h2 id="docker" style=";text-align:right;direction:rtl">  ุนุงูู ูููุงุก </h2><br><p style=";text-align:right;direction:rtl">  ูู Docker ุ ุชู ุนูู ูู ุดูุก ุชูุฑูุจูุง ูู ุฃุฌูู. <br>  ุจุดูู ุงูุชุฑุงุถู ุ ูุณุชุฎุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูููุฏ ุงุณุชุฏุนุงุก ุงููุธุงู</a> ุ ูุงูุฐู ูุชู ุชุถูููู ูู ููุงุฉ OMV: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># grep SECCOMP /boot/config-4.16.0-0.bpo.2-amd64 CONFIG_HAVE_ARCH_SECCOMP_FILTER=y CONFIG_SECCOMP_FILTER=y CONFIG_SECCOMP=y</code> </pre> <br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง ููููู</a> ุฃู ุชูุฑุฃ ุนู ููุงุนุฏ ุฃูุงู Docker ุงูุฃุณุงุณูุฉ ุจูุฒูุฏ ูู ุงูุชูุตูู. <br>  ุฃูุถูุง ุ ุฅุฐุง ุชู ุชูููู AppArmor ุ ูููู ูู Docker ุงูุชูุงูู ูุนู ูุฅุนุงุฏุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุฌูู ูููุงุช ุชุนุฑููู ุฅูู ุงูุญุงููุฉ</a> . </p><br><h2 id="set" style=";text-align:right;direction:rtl">  ุดุจูุฉ </h2><br><h3 id="ustranenie-vozmozhnosti-obnaruzheniya-os" style=";text-align:right;direction:rtl">  ุงููุถุงุก ุนูู ุงูุชุดุงู ูุธุงู ุงูุชุดุบูู </h3><br><p style=";text-align:right;direction:rtl">  ุชูุน ุงูุดุจูุฉ ุฎูู ุฌูุงุฒ ุงูุชูุฌูู ุ ูููู ูู ุงููููู ุงูููุงู ุจุชูุฑูู ุบุฑูุจ ุนู ุทุฑูู ุชุบููุฑ ุจุนุถ ูุนููุงุช ููุฏุณ ุงูุดุจูุฉ ุจุญูุซ ูุง ูููู ุชุญุฏูุฏ ูุธุงู ุงูุชุดุบูู ูู ุฎูุงู ุงูุฅุฌุงุจุงุช. <br>  ููุงู ูุงุฆุฏุฉ ุญููููุฉ ููููุฉ ูู ูุฐุง ุ ูุฃู ุงูููุงุฌู ุณูุฏุฑุณ ูุงูุชุงุช ุงูุฎุฏูุฉ ููุง ูุฒุงู ูููู ูุง ูู ูุธุงู ุงูุชุดุบูู ุงูุฐู ุชุณุชุฎุฏูู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุนุฑุถ Nmap ูุธุงู ุงูุชุดุบูู ุงูุฐู ูุนูู ุนูู ุงูุฌูุงุฒ.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># nmap -O localhost Starting Nmap 7.40 ( https://nmap.org ) at 2018-08-26 14:39 MSK Nmap scan report for localhost (127.0.0.1) Host is up (0.000015s latency). Other addresses for localhost (not scanned): ::1 Not shown: 992 closed ports PORT STATE SERVICE 53/tcp open domain 80/tcp open http 443/tcp open https 5432/tcp open postgresql Device type: general purpose Running: Linux 3.X|4.X OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4 OS details: Linux 3.8 - 4.6 Network Distance: 0 hops OS detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 4.07 seconds</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุชูุฒูู ุงูุฅุนุฏุงุฏุงุช ูู sysctl.conf: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># sysctl -p /etc/sysctl.conf net.ipv4.conf.all.accept_redirects = 0 net.ipv6.conf.all.accept_redirects = 0 net.ipv4.conf.all.send_redirects = 0 net.ipv4.conf.all.accept_source_route = 0 net.ipv6.conf.all.accept_source_route = 0 net.ipv4.tcp_rfc1337 = 1 net.ipv4.ip_default_ttl = 128 net.ipv4.icmp_ratelimit = 900 net.ipv4.tcp_synack_retries = 7 net.ipv4.tcp_syn_retries = 7 net.ipv4.tcp_window_scaling = 1 net.ipv4.tcp_timestamps = 1</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููุฐุง ... </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุง ูููู ูู Nmap ุชุญุฏูุฏ ูุธุงู ุงูุชุดุบูู.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># nmap -O localhost Starting Nmap 7.40 ( https://nmap.org ) at 2018-08-26 14:40 MSK Nmap scan report for localhost (127.0.0.1) Host is up (0.000026s latency). Other addresses for localhost (not scanned): ::1 Not shown: 992 closed ports PORT STATE SERVICE 53/tcp open domain 80/tcp open http 443/tcp open https 5432/tcp open postgresql No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ). TCP/IP fingerprint: OS:SCAN(V=7.40%E=4%D=8/26%OT=53%CT=1%CU=43022%PV=N%DS=0%DC=L%G=Y%TM=5B8291C OS:3%P=x86_64-pc-linux-gnu)SEQ(SP=FA%GCD=1%ISR=105%TI=Z%CI=I%TS=8)OPS(O1=MF OS:FD7ST11NW7%O2=MFFD7ST11NW7%O3=MFFD7NNT11NW7%O4=MFFD7ST11NW7%O5=MFFD7ST11 OS:NW7%O6=MFFD7ST11)WIN(W1=AAAA%W2=AAAA%W3=AAAA%W4=AAAA%W5=AAAA%W6=AAAA)ECN OS:(R=Y%DF=Y%T=80%W=AAAA%O=MFFD7NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=80%S=O%A=S+%F= OS:AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=80%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5( OS:R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=80%W=0%S=A%A=Z% OS:F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=80%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N OS:%T=80%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=80%C OS:D=S) Network Distance: 0 hops OS detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 19.52 seconds</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ูุชุงุจุฉ ูุฐู ุงูุฅุนุฏุงุฏุงุช ูู <code>/etc/sysctl.conf</code> ุ ุซู ุณูุชู ูุฑุงุกุชูุง ุชููุงุฆููุง ุนูุฏ ูู ุนูููุฉ ุฅุนุงุฏุฉ ุชุดุบูู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Full /etc/sysctl.conf</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">################################################################### # Additional settings - these settings can improve the network # security of the host and prevent against some network attacks # including spoofing attacks and man in the middle attacks through # redirection. Some network environments, however, require that these # settings are disabled so review and enable them as needed. # # Do not accept ICMP redirects (prevent MITM attacks) net.ipv4.conf.default.accept_redirects = 0 net.ipv6.conf.default.accept_redirects = 0 net.ipv4.conf.all.accept_redirects = 0 net.ipv6.conf.all.accept_redirects = 0 # _or_ # Accept ICMP redirects only for gateways listed in our default # gateway list (enabled by default) # net.ipv4.conf.all.secure_redirects = 1 # # Do not send ICMP redirects (we are not a router) net.ipv4.conf.all.send_redirects = 0 # # Do not accept IP source route packets (we are not a router) net.ipv4.conf.all.accept_source_route = 0 net.ipv6.conf.all.accept_source_route = 0 ## protect against tcp time-wait assassination hazards ## drop RST packets for sockets in the time-wait state ## (not widely supported outside of linux, but conforms to RFC) net.ipv4.tcp_rfc1337 = 1 # # Log Martian Packets #net.ipv4.conf.all.log_martians = 1 # ################################################################### # Magic system request Key # 0=disable, 1=enable all # Debian kernels have this set to 0 (disable the key) # See https://www.kernel.org/doc/Documentation/sysrq.txt # for what other values do #kernel.sysrq=1 ################################################################### # Protected links # # Protects against creating or following links under certain conditions # Debian kernels have both set to 1 (restricted) # See https://www.kernel.org/doc/Documentation/sysctl/fs.txt #fs.protected_hardlinks=0 #fs.protected_symlinks=0 vm.overcommit_memory = 1 vm.swappiness = 10 ################################################################### # Anti-fingerprinting. # # Def: 64. net.ipv4.ip_default_ttl = 128 #   ICMP  (  1000) net.ipv4.icmp_ratelimit = 900 #    ,     . # Def: 5. net.ipv4.tcp_synack_retries = 7 # Def: 5. net.ipv4.tcp_syn_retries = 7 #   TCP window  timespamp    1323. net.ipv4.tcp_window_scaling = 1 net.ipv4.tcp_timestamps = 1 # Redis requirement. net.core.somaxconn = 511</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุชุนุชุจุฑ ุงูุญูุงูุฉ ูู ุชุญุฏูุฏ ุฅุตุฏุงุฑุงุช ุงูุฎุฏูุฉ ุฃูุซุฑ ูุงุฆุฏุฉ ุ ุญูุซ ูููู ููููุงุฌู ุฃูุถูุง ุงุณุชุฎุฏุงู Nmap: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># nmap -sV -sR --allports --version-trace 127.0.0.1</code> </pre> <br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุงููุชูุฌุฉ ููุณุช ุฌูุฏุฉ ููุบุงูุฉ ุจุงููุณุจุฉ ูููุธุงู.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Not shown: 991 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4p1 Debian 10+deb9u3 (protocol 2.0) 25/tcp open smtp Postfix smtpd 80/tcp open http nginx 1.13.12 111/tcp open rpcbind 2-4 (RPC #100000) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 443/tcp open ssl/http nginx 1.13.12 445/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 3493/tcp open nut Network UPS Tools upsd 8000/tcp open http Icecast streaming media server 2.4.2 Service Info: Hosts: nas.localdomain, NAS; OS: Linux; CPE: cpe:/o:linux:linux_kernel Final times for host: srtt: 22 rttvar: 1 to: 100000</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูููู ูุน ุชูููู ุงูุฎุฏูุงุช ุ ููุณ ูู ุดูุก ุณูุณูุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููู ุฎุฏูุฉ ุ ููุงู ุญุงุฌุฉ ุฅูู ููุฌ ูุฑุฏู ููุง. </li><li style=";text-align:right;direction:rtl">  ูุง ุชุชููุฑ ุฏุงุฆููุง ุฅููุงููุฉ ุฅุฒุงูุฉ ุงูุฅุตุฏุงุฑ. </li></ul><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ูู SSH ุ ูู ุงููููู ุฅุถุงูุฉ ุฎูุงุฑ <code>DebianBanner no</code> ุฅูู <code>/etc/ssh/sshd_confg</code> . </p><br><p style=";text-align:right;direction:rtl">  ูุชูุฌุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">22/tcp open ssh OpenSSH 7.4p1 (protocol 2.0)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃูุถู ุ ููุฃุณู ุ ูู ุชุนูู: ูุชู ุงุณุชุฎุฏุงู ุงูุฅุตุฏุงุฑ ูู ูุจู SSH ูุชุญุฏูุฏ ุงูููุฒุงุช ุงููุฏุนููุฉ ุ ููุง ูููู ุชุบููุฑู ุฅูุง ูู ุฎูุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุตุญูุญ ุงูุฎุงุฏู</a> . </p><br><h3 id="port-knocking" style=";text-align:right;direction:rtl">  ุทุฑู ุงููููุงุก </h3><br><p style=";text-align:right;direction:rtl">  ููุณุช ุชูููุฉ ุงูุฃูุงู ุงูุฃูุซุฑ ุดูุฑุฉ ุ ููุง ูุณูุญ ูููุณุชุฎุฏู ุงูุจุนูุฏ ุงูุฐู ูุนุฑู ุงูุณุฑ ุจุงูุงุชุตุงู ุจูููุฐ ูุบูู. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดุจู ุงูุนูู ููู ุงูุดูุฑุฉ</a> : ูุนูู ุงูุฌููุน ุฃู ุดูุงุทูู ุงูุฎุฏูุฉ ุชุนูู ุนูู ุงูุฎุงุฏู ุ ูููููุง "ููุณุช ููุฌูุฏุฉ" ุญุชู ูุชู ุทูุจ ุงูุฑูุฒ. <br>  ุนูู ุณุจูู ุงููุซุงู ุ ููุงุชุตุงู ุจุฎุงุฏู SSH ุ ูุญุชุงุฌ ุงููุณุชุฎุฏู ููุทุฑู ุนูู ููุงูุฐ UDP 7000 ู TCP 7007 ู UDP 7777. <br>  ุจุนุฏ ุฐูู ุ ูุน IP ุงูุฎุงุต ุจู ุ ุณูุจุฏุฃ ุชุดุบูู ุฌุฏุงุฑ ุงูุญูุงูุฉ ุนูู ูููุฐ TCP <strong>ูุบูู</strong> 22. </p><br><p style=";text-align:right;direction:rtl">  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุญูู ููููุฉ ุนูู ูุฐุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> .  ููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏููู ุฏูุจูุงู</a> . </p><br><p style=";text-align:right;direction:rtl">  ุฃูุง ูุง ุฃูุตู ุจุงุณุชุฎุฏุงู ุ ูุซู  fail2ban ูุงููุฉ ุนุงุฏุฉ. </p><br><h3 id="fayrvoll" style=";text-align:right;direction:rtl">  ุฌุฏุงุฑ ุงูุญูุงูุฉ </h3><br><p style=";text-align:right;direction:rtl">  ุฃููู ุจุชููุฆุฉ ุฌุฏุงุฑ ุงูุญูุงูุฉ ูู ุฎูุงู WebMI OpenMediaVault ุงูุฐู ุฃูุตู ุจู ูู. </p><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/cv/a9/eo/cva9eoxcbu4h8ut8cwrwczkjop8.png"></a> </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุญ ุงูููุงูุฐ ุงูุถุฑูุฑูุฉ ูุซู 443 ู 22 ูุงูุจุงูู ุญุณุจ ุงูุฐูู.  ูู ุงููุณุชุญุณู ุฃูุถูุง ุชูููู ุชุณุฌูู ุงูุญุฒู ุงููุณูุทุฉ. </p><br><h3 id="ssh" style=";text-align:right;direction:rtl">  Ssh </h3><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅุฐุง ุชู ุชุนููู SSH ุนูู ุงููููุฐ 22 ุ ููู ููุชูุญ ุนูู ุงูุฅูุชุฑูุช ุ ูุณุชุชููู ุงูุนุฏูุฏ ูู ุงูุฑุณุงุฆู ุงููุซูุฑุฉ ููุงูุชูุงู ...</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># grep "invalid user" /var/log/auth.log|head Aug 26 00:07:57 nas sshd[29786]: input_userauth_request: invalid user test [preauth] Aug 26 00:07:59 nas sshd[29786]: Failed password for invalid user test from 185.143.160.137 port 51268 ssh2 Aug 26 00:11:01 nas sshd[5641]: input_userauth_request: invalid user 0 [preauth] Aug 26 00:11:01 nas sshd[5641]: Failed none for invalid user 0 from 5.188.10.180 port 49025 ssh2 Aug 26 00:11:04 nas sshd[5644]: input_userauth_request: invalid user 0101 [preauth] Aug 26 00:11:06 nas sshd[5644]: Failed password for invalid user 0101 from 5.188.10.180 port 59867 ssh2 Aug 26 00:32:55 nas sshd[20367]: input_userauth_request: invalid user ftp [preauth] Aug 26 00:32:56 nas sshd[20367]: Failed password for invalid user ftp from 5.188.10.144 port 47981 ssh2 Aug 26 00:32:57 nas sshd[20495]: input_userauth_request: invalid user guest [preauth] Aug 26 00:32:59 nas sshd[20495]: Failed password for invalid user guest from 5.188.10.144 port 34202 ssh2</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูู ุฎุทุฑ ุงูุธููุฑ ุจูุธูุฑ ุชุงูู ุ ูุง ุฒูุช ุฃุฐูุฑ ุฃูู ูุทููุจ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููุน ุชุณุฌูู ุฏุฎูู ุงูุฌุฐุฑ ุชูุงููุง. </li><li style=";text-align:right;direction:rtl">  ูุตุฑ ุชุณุฌูู ุงูุฏุฎูู ุนูู ูุณุชุฎุฏููู ูุญุฏุฏูู ููุท. </li><li style=";text-align:right;direction:rtl">  ุชุบููุฑ ุงููููุฐ ุฅูู ุบูุฑ ููุงุณู. </li><li style=";text-align:right;direction:rtl">  ูู ุงููุณุชุญุณู ุชุนุทูู ูุตุงุฏูุฉ ูููุฉ ุงููุฑูุฑ ุ ูุน ุชุฑู ุงูููุชุงุญ ููุท. </li></ul><br><p style=";text-align:right;direction:rtl">  ุงูุฑุฃ ุงููุฒูุฏ ูููู ุ ุนูู ุณุจูู ุงููุซุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ูุชู ุจุณูููุฉ ูู ูุงุฌูุฉ OpenMediaVault ูู ุฎูุงู ูุงุฆูุฉ "ุงูุฎุฏูุงุช -&gt; SSH". <br>  ุจุงุณุชุซูุงุก ุฃููู ูู ุฃุบูุฑ ุงููููุฐ ุฅูู ุบูุฑ ููุงุณู ุ ูุชุฑู 22 ุนูู ุงูุดุจูุฉ ุงููุญููุฉ ูุจุจุณุงุทุฉ ุงุณุชุจุฏุงู ุงููููุฐ ูู ุฌูุงุฒ ุงูุชูุฌูู NAT. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฅููู ูุงุฆูุฉ ูุซูุฑุฉ ููุงูุชูุงู ูู ุงูุญุณุงุจุงุช ุงูุชู ุญุงููุช ุชุฌููุนูุง ุ ุญุชู ููุช ุจุชุบููุฑ ูููุฐ SSHD ุฅูู ุขุฎุฑ ูุฎุชูู ูู 22.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># grep "invalid user" /var/log/auth.log|sed 's/.*invalid user \([^ ]*\) .*/\1/'|sort|uniq 0 0101 1234 22 admin ADMIN administrateur administrator admins alfred amanda amber Anonymous apache avahi backup@network bcnas benjamin bin cacti callcenter camera cang castis charlotte clamav client cristina cron CSG cvsuser cyrus david db2inst1 debian debug default denis elvira erik fabio fax ftp ftpuser gary gast GEN2 guest I2b2workdata2 incoming jboss john juan matilda max mia miner muhammad mysql nagios nginx noc office oliver operator oracle osmc pavel pi pmd postgres PROCAL prueba RSCS sales sales1 scaner selena student07 sunos support sybase sysadmin teamspeak telecomadmin test test1 test2 test3 test7 tirocu token tomcat tplink ubnt ubuntu user1 vagrant victor volition www-data xghwzp xxx zabbix zimbra</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุจูุฌุฑุฏ ุงูููุงู ุจุฐูู ุ ุณูุชู ุฅุฌุฑุงุก ูุญุงููุงุช ุชุณุฌูู ุงูุฏุฎูู ุบูุฑ ุงููุตุฑุญ ุจูุง ุจุดูู ุฃูู ุชูุฑุงุฑูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุชุญุณูู ุงููุถุน ุจุดูู ุฃูุจุฑ ุ ูู ุงููููู ููุน ุงูููุงุฌููู ูู ุจุนุถ ุนูุงููู IP ุจุนุฏ ุนุฏุฉ ูุญุงููุงุช ุชุณุฌูู ุฏุฎูู. </p><br><p style=";text-align:right;direction:rtl">  ูุง ูููู ุงุณุชุฎุฏุงูู ูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Fail2ban</a> .  ุฃุฏุงุฉ ุดุนุจูุฉ ูุง ุชุนูู ููุท ูุน SSH ุ ูููู ุฃูุถูุง ููุนุฏูุฏ ูู ุงูุชุทุจููุงุช ุงูุฃุฎุฑู. </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Denyhosts</a>  ูุจุฏู ุงููุดู 2. </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Sshguard</a> ุ ุฅุฐุง ููุช ุชุฑุบุจ ุ ููููู ูุญุงููุฉ ุงุณุชุฎุฏุงูู ุ ูููู ูู ุฃูู ููุชููุง ุจุงูุชูุตูู. </li></ul><br><p style=";text-align:right;direction:rtl">  ุฃูุง ุฃุณุชุฎุฏู fail2ban.  ุณูุฑุงูุจ ุงูุณุฌูุงุช ููุฎุชูู ุงูุฅุฌุฑุงุกุงุช ุบูุฑ ุงููุฑุบูุจ ูููุง ูู ุฌุงูุจ ุจุนุถ ุนูุงููู IP ุ ููุญุธุฑูุง ุฅุฐุง ุชู ุชุฌุงูุฒ ุนุฏุฏ ุงูุฑุฏูุฏ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">/var/log/fail2ban.log.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">2018-08-29 21:17:25,351 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.144 2018-08-29 21:17:25,473 fail2ban.actions [8650]: NOTICE [sshd] Ban 5.188.10.144 2018-08-29 21:17:27,359 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.144 2018-08-29 21:28:13,128 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:13,132 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:15,137 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:20,145 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:25,153 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.176 2018-08-29 21:28:25,421 fail2ban.actions [8650]: NOTICE [sshd] Ban 5.188.10.176 2018-08-29 21:30:05,272 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:05,274 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:13,285 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:13,286 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:15,289 fail2ban.filter [8650]: INFO [sshd] Found 5.188.10.180 2018-08-29 21:30:15,803 fail2ban.actions [8650]: NOTICE [sshd] Ban 5.188.10.180</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุชู ุญุธุฑ ุจุฅุถุงูุฉ ูุงุนุฏุฉ ุฌุฏุงุฑ ุงูุญูุงูุฉ.  ุจุนุฏ ููุช ูุญุฏุฏ ุ ูุชู ุญุฐู ุงููุงุนุฏุฉ ุ ููููู ูููุณุชุฎุฏู ูุญุงููุฉ ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุจุฏุงูุฉ ุ ูุชู ุชุดุบูู SSH ููุท ุ ูููู ูู ุงููููู ุชูููู ุงูุชุญูู ูู ุณุฌูุงุช ุฎุงุฏู ุงูููุจ ูุงูุฎุฏูุงุช ุงูุฃุฎุฑู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนูู ุงูุฃูู ูู ููุณ OMV</a> . <br>  ูุฃูุถูุง ุ ุฃุฎุฑุฌ ุงูุณุฌูุงุช ูู ุงูุญุงููุงุช ููู ุจุชุนููู fail2ban ุนูููุง ุฃูุถูุง. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุตู ุจุฅุถุงูุฉ ุฎุฏูุงุช ุญุณุจ ุงูุฐูู. <br>  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุญูู ุงูุชูููู ุ ุนูู ุณุจูู ุงููุซุงู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ุฃู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููู ุงูุฃุตูู</a> . </p><br><h2 id="logi" style=";text-align:right;direction:rtl">  ุณุฌูุงุช </h2><br><h3 id="lwatchhttpspackagesdebianorgstretchadminlwatch" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชุด</a> </h3><br><p style=";text-align:right;direction:rtl">  ุฃุฏุงุฉ ุตุบูุฑุฉ ูุฌุจ ุชุซุจูุชูุง ููุฑุงุญุฉ.  ุณูู ูุจุฑุฒ ุงูุณุฌูุงุช ููุธูุฑูุง ูู ุดูู ุฌููู. <br>  ูู ุงููููู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃู ุฃุฏุงุฉ ูู ูุฐุง ุงููุจูู</a> ุ ูุงูุดูุก ุงูุฑุฆูุณู ูู ุฃู ูุชู ุชูููุฒ ุงูุฃุฎุทุงุก ููุฌุงูุงุช ุงููุดุงูู ูู ุงูุณุฌูุงุช ุจุญูุซ ูุชู ุชุณููู ุชุญููููุง ุงูุจุตุฑู. </p><br><h3 id="logcheckhttplogcheckorg" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุณุฌูู ุงูุฏุฎูู</a> </h3><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฌุฏูุฑ ุชุซุจูุช ูุชูููู ูุญุต ุงูุณุฌู ุจุจุณุงุทุฉ ุญุชู ุนูุฏูุง ุชุญุฏุฏ ูุดุงูู ุงูุชูููู ุงูุชู ุชู ุงูุฅุจูุงุบ ุนููุง ูู ุงูุณุฌูุงุช ุ ุณุชุฑู ุฐูู ุนูู ุงูููุฑ ูู ุงูุจุฑูุฏ. <br>  ุฅูู ูุณุงุนุฏ ูุซูุฑูุง ุนูู ุฑุคูุฉ ุงูุฎุทุฃ ุงูุฐู ูุญุฏุซ ุ ุนูู ุงูุฑุบู ูู ุฃูู ูุชุทูุจ ุงูุถุจุท. </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุซุจูุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># apt-get install logcheck</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุจุงุดุฑุฉ ุจุนุฏ ุงูุชุซุจูุช ุ ุณูุชู ุฅุฑุณุงู ุงูุชูุงุฑูุฑ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุฑูุฑ ูุซุงู.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">System Events =-=-=-=-=-=-= Oct 2 02:02:15 nas kernel: [793847.981226] [DROPPED] IN=br-ce OUT= PHYSIN=veth6c2a68e MAC=ff:ff:ff:ff:ff:ff: SRC=172.22.0.11 DST=255.255.255.255 LEN=29 TOS=0x00 PREC=0x00 TTL=64 ID=40170 DF PROTO=UDP SPT=35623 DPT=35622 LEN=9 Oct 2 02:02:20 nas hddtemp[13791]: /dev/sdh: Micron_1100 N #020ะ: 32 C Oct 2 02:02:37 nas kernel: [793869.247128] [DROPPED] IN=br-7ba OUT= MAC= SRC=172.31.0.1 DST=172.31.255.255 LEN=239 TOS=0x00 PREC=0x00 TTL=128 ID=23017 DF PROTO=UDP SPT=138 DPT=138 LEN=219 Oct 2 02:02:37 nas kernel: [793869.247174] [DROPPED] IN=br-7ba OUT= MAC= SRC=172.31.0.1 DST=172.31.255.255 LEN=232 TOS=0x00 PREC=0x00 TTL=128 ID=23018 DF PROTO=UDP SPT=138 DPT=138 LEN=212 Oct 2 02:02:37 nas kernel: [793869.247195] [DROPPED] IN=br-673 OUT= MAC= SRC=192.168.224.1 DST=192.168.239.255 LEN=239 TOS=0x00 PREC=0x00 TTL=128 ID=8959 DF PROTO=UDP SPT=138 DPT=138 LEN=219 Oct 2 02:02:37 nas kernel: [793869.247203] [DROPPED] IN=br-673 OUT= MAC= SRC=192.168.224.1 DST=192.168.239.255 LEN=232 TOS=0x00 PREC=0x00 TTL=128 ID=8960 DF PROTO=UDP SPT=138 DPT=138 LEN=212 Oct 2 02:02:50 nas hddtemp[13791]: /dev/sdh: Micron_1100 N #020ะ: 32 C</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูููู ููุงุญุธุฉ ุฃู ููุงู ุงููุซูุฑ ูู ุงููุงุฆุถ ุ ูุณูุคุฏู ุงููุฒูุฏ ูู ุงูุถุจุท ุฅูู ุชุฑุดูุญูุง. </p><br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ูู ุจุฅููุงู ุชุดุบูู hddtemp ุ ุงูุฐู ูุง ูุนูู ุจุดูู ุตุญูุญ ุจุณุจุจ ุฃุญุฑู ุบูุฑ ASCII ูู ุงุณู SSD. <br>  ุจุนุฏ ุฅุตูุงุญ ููู hddtemp ุ ุชูููุช ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">/etc/logcheck/ignore.d.server/hddtemp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">^\w{3} [ :0-9]{11} [._[:alnum:]-]+ hddtemp\[[0-9]+\]: /dev/([hs]d[az]|sg[0-9]):.*[0-9]+.*[CF] ^\w{3} [ :0-9]{11} [._[:alnum:]-]+ hddtemp\[[0-9]+\]: /dev/([hs]d[az]|sg[0-9]):.*drive is sleeping</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ูู ุงููููู ุฑุคูุฉ ูุง ููููู ุณุฌู ุงูุชุญูู ุฃูู ูุญุธุฑ ุญุฑูุฉ ูุฑูุฑ ุงูุจุซ ุจูุงุณุทุฉ ุฌุฏุงุฑ ุงูุญูุงูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">[793869.247128] [DROPPED] IN=br-7ba OUT= MAC= SRC=172.31.0.1 DST=172.31.255.255 LEN=239 TOS=0x00 PREC=0x00 TTL=128 ID=23017 DF PROTO=UDP SPT=138 DPT=138 LEN=219</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุชุญุชุงุฌ ุฅูู ุชูููู ุญุฑูุฉ ูุฑูุฑ ุงูุจุซ ูู ุฌูุงุฒ ุงูุชูุฌูู ูุงูุญุงููุงุช: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููููุฐ 35622 ูู ุงูุญุงููุฉ ูุน urbackup. </li><li style=";text-align:right;direction:rtl">  ุงููููุฐ 5678 ูู ุฌูุงุฒ ุงูุชูุฌูู ูู ุงูุชุดุงู ุฌูุงุฑ RouterOS.  ูููู ุชุนุทููู ุนูู ุฌูุงุฒ ุงูุชูุฌูู. </li><li style=";text-align:right;direction:rtl">  ุงููููุฐ 5353 ููุนุงูุฌุฉ 224.0.0.251 ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">mDNS</a> . </li></ul><br><p style=";text-align:right;direction:rtl">  ุชุญูู ูู ุงูุงุฎุชูุงุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">sudo -u logcheck logcheck -t -d</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฃุฎูุฑูุง ุ ุชุตุจุญ ุงููุดุงูู ูุฑุฆูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Oct 21 21:58:18 nas systemd[1]: Removed slice User Slice of user. Oct 21 21:58:31 nas systemd[1]: smbd.service: Unit cannot be reloaded because it is inactive. Oct 21 21:58:31 nas root: /etc/dhcp/dhclient-enter-hooks.d/samba returned non-zero exit status 1</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงุชุถุญ ุฃู ุณุงูุจุง ูุง ูุจุฏุฃ.  ูู ุงููุงูุน ุ ุฃุธูุฑ ุงูุชุญููู ุฃููู ุฃุฎููุชู ูู ุฎูุงู systemctl ุ ููุงูุช OMV ุชุญุงูู ุชุดุบููู. </p><br><p style=";text-align:right;direction:rtl">  ุณูู ูุง ูุฒุงู Logcheck ุบูุฑ ูุฑุบูุจ ููู ูุน ุฑุณุงุฆู ูุฎุชููุฉ. <br>  ููุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ุชูุฑูุฑ zfs-auto-snapshot: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Oct 21 22:00:57 nas zfs-auto-snap: @zfs-auto-snap_frequent-2018-10-21-1900, 16 created, 16 destroyed, 0 warnings.</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุชุฌุงูู: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">/etc/logcheck/ignore.d.server/zfs-auto-snapshot</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">^\w{3} [ :0-9]{11} [._[:alnum:]-]+ zfs-auto-snap: \@zfs-auto-snap_[[:alnum:]-]+, [0-9]+ created, [0-9]+ destroyed, 0 warnings.$</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุชู ุชุฌุงูู rrdcached ุฃูุถูุง: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">/etc/logcheck/ignore.d.server/rrdcached</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ rrdcached\[[0-9]+\]: flushing old values$ ^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ rrdcached\[[0-9]+\]: rotating journals$ ^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ rrdcached\[[0-9]+\]: started new journal [./[:alnum:]]+$ ^\w{3} [ :[:digit:]]{11} [._[:alnum:]-]+ rrdcached\[[0-9]+\]: removing old journal [./[:alnum:]]+$</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุฃูุถูุง ุ ูููุตุญ ุจุฅุฒุงูุฉ ุฒูุฏ ุฅุฐุง ูู ูุชู ุฅุฒุงูุชู ุจุนุฏ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">/etc/logcheck/ignore.d.server/zed</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">^\w{3} [ :0-9]{11} [._[:alnum:]-]+ (/usr/bin/)?zed: .*$ ^\w{3} [ :0-9]{11} [._[:alnum:]-]+ (/usr/bin/)?zed\[[0-9]+\]: .*$</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุญุณูุง ูููู ุฌุฑุง.  ูุนุชูุฏ ุงููุซูุฑ ูู ุงููุงุณ ุฃู ุชุณุฌูู ุงูุฏุฎูู ุฃุฏุงุฉ ูููุฏุฉ ุฌุฏูุง. <br>  ูุฐุง ุตุญูุญ ุฅุฐุง ููุช ุชุณุชุฎุฏูู ูุดูุก ููุช ุจุชุนูููู ููุณูุงูู. </p><br><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ุฅุฐุง ูููุช ุฃู ูุญุต ุงูุณุฌู ูู ูุฌุฑุฏ ุนุงูู ุชุตููุฉ ุณุฌู ูุฎุตุต ุ ุจุฏูู ุงูุงุณุชุฏูุงู ุ ูุงูุณุญุฑ ุ ูุงูุฎูุงุฑุฒููุงุช ุงูุชููููุฉ ุ ููู ููุทุฑุญ ุณุคุงู ุถุฑูุฑุฉ ุฐูู.  ุจุดูู ูุชูุฑุฑ ุ ุชุญููู ูุง ูุฑุณู ุ ูุฅูุง ุจุฅุถุงูุชู ูุชุฌุงููู ุฃู ุชุตุญูุญู ุ ูู ุงููููู ุชุฏุฑูุฌูุงู ุงูุญุตูู ุนูู ุชูุงุฑูุฑ ุฅุนูุงููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏุงู ุฃุฏุงุฉ ุขููุฉ ููุชุญููู ุฃูุถู ุจูุซูุฑ ูู ุชุดุบูู ุงูุณุฌูุงุช ูู ุฎูุงู ููุณ ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ุจูุฏูู ุ ูุบุงูุจูุง ุฃูุถู ูู ุงุณุชุฎุฏุงู ูุธุงู ุชุญููู ุจูุงูุงุช ูุงูู ูุซู Splunk. </p><br><p style=";text-align:right;direction:rtl">  ูููู ูุฑุงุกุฉ Logcheck ูุชููููู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Wiki Gentoo</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุง</a> . </p><br><h2 id="ids-urovnya-uzla" style=";text-align:right;direction:rtl">  ูุนุฑูุงุช ูุณุชูู ุงูุนูุฏุฉ </h2><br><p style=";text-align:right;direction:rtl">  ููุง ุณูู ุฃุดูุฑ ุฅูู ููุงูุชู ุงูุฎุงุตุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"ุชุญููู ููุฌุฒ ููุญููู ูู ูุฌุงู ุดุฑูุฉ ููุท ุงูุฌููุจ ูุชุทููุฑ ุฌูุงุฒ ูุดู ุงูุดุฐูุฐ ููุดุจูุฉ ุงูุนุตุจูุฉ ูู ุดุจูุงุช ููู ุงูุจูุงูุงุช"</a> ุ ุญูุซ ุชูุฌุฏ ุนุฏุฉ ุฃูุซูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุงุกุฉ</a> ูุฑุงุฌุนุฉ ูููุงุฑูุฉ ุฃูุซุฑ ุงูุชูุงูุงู ููุนุฑูุงุช IDS ููุงุซูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนูู Wiki</a> . </p><br><h3 id="stig-4httpswwwstigviewercomstigred_hat_enterprise_linux_6" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">STIG-4</a> </h3><br><p style=";text-align:right;direction:rtl">  ูุต ูุนูุฏ ููุจูุฑ ููุชุญููู ุงูุซุงุจุช ูููุฌูุงุช ุงููุนุฑููุฉ ูู RedHat. <br>  ููุฌุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุฐู ูู ุฏุจูุงู</a> ุ ูุงูุฐู ุฃูุตู ุจุชูุฒููู ูุชุดุบููู ูุฑุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุซุงู ุนูููุฉ STIG-4</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"># cd root@nas:~# git clone https://github.com/hardenedlinux/STIG-4-Debian Cloning into 'STIG-4-Debian'... remote: Enumerating objects: 572, done. remote: Total 572 (delta 0), reused 0 (delta 0), pack-reused 572 Receiving objects: 100% (572/572), 634.37 KiB | 0 bytes/s, done. Resolving deltas: 100% (316/316), done. root@nas:~# cd STIG-4-Debian/ root@nas:~/STIG-4-Debian# bash stig-4-debian.sh -H Script Run: Mon Nov 12 23:58:34 MSK 2018 Start checking process... [ FAIL ] The cryptographic hash of system files and commands must match vendor values. ... Pass Count: 54 Failed Count: 137</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุนูููุฉ ุงูุนูู ูุน ูุฐุง ุงูุจุฑูุงูุฌ ุงููุตู ูู ุชูุฑูุจูุง ูุง ููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฎูุต ูู ุงูุจุฑูุงูุฌ ุงููุตู. </li><li style=";text-align:right;direction:rtl">  ุงุจุญุซ ูู ุงูุฅูุชุฑูุช ูู ูู ุณุทุฑ ุจุงุณุชุฎุฏุงู <code>[ FAIL ]</code> . </li><li style=";text-align:right;direction:rtl">  ููุงุนุฏุฉ ุ ุณูุชู ุงูุนุซูุฑ ุนูู ุฑุงุจุท ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช STIG ุนุจุฑ ุงูุฅูุชุฑูุช. </li><li style=";text-align:right;direction:rtl">  ุตุญูุญ ุ ุจุงุชุจุงุน ุงูุชุนูููุงุช ุงููุงุฑุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ุฅุฌุฑุงุก ุฎุตู ุนูู ุญูููุฉ ุฃูู ุฏุจูุงู. </li><li style=";text-align:right;direction:rtl">  ูู ุจุชุดุบูู ุงูุจุฑูุงูุฌ ุงููุตู ูุฑุฉ ุฃุฎุฑู. </li></ul><br><h3 id="rkhunterhttprkhuntersourceforgenet" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุฎููุชุฑ</a> </h3><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏ</a> ูุชุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซูุฑ</a> ุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RkHunter</a> . <br>  ุชุณุชุฎุฏู ููุชุฑุฉ ุทูููุฉ ุ ุนูู ูุทุงู ูุงุณุน ุ ูุง ุชุฒุงู ุชุชุทูุฑ.  ููุฌุฏ ูุณุชูุฏุน ุฏุจูุงู. </p><br><h3 id="tigerhttpswwwnongnuorgtiger" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฑ</a> </h3><br><p style=";text-align:right;direction:rtl">  ูุต ุจุฑูุฌู ูุนูุงุฑู ูููู ุจุชุฏููู ุงููุธุงู ูุงูุชุดุงู ุงูุงุฎุชุฑุงู. <br>  ููู ุชุดุจู ุฅูู ุญุฏ ูุง STIG-4. <br>  ููููู ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงูุทุฑู ุงูุซุงูุซ ูุชุญููู ุงูุณุฌูุงุช ุ ูููุดู ุนู ุงูุชูุงูุงุช ุงููุฌููุน ุงูุงุฎุชุจุงุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูุชููู ูู ุนุฏุฏ ูุจูุฑ ูู ุงููุญุฏุงุช ุงููุฎุชููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ููุงู ูุญุฏุฉ ููุทูุฉ ุชูุดู ุนู ุงูุฎุฏูุงุช ุงูุชู ุชุณุชุฎุฏู ุงููููุงุช ุงููุญุฐููุฉ ุ ูุงูุชู ุชุญุฏุซ ุนูุฏูุง ูุชู ุชุบููุฑ ุงูููุชุจุงุช ุงูุชู ุชุณุชุฎุฏููุง ุงูุฎุฏูุฉ ุฃุซูุงุก ุนูููุฉ ุชุฑููุฉ ุงููุธุงู ุ ูููู ูู ูุชู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ ูุณุจุจ ูุง. </p><br><p style=";text-align:right;direction:rtl">  ููุงู ูุญุฏุงุช ููุจุญุซ ุนู ูุณุชุฎุฏูู ุงูุฎุฏูุฉ ุงูุชู ูู ุชุนุฏ ูุณุชุฎุฏูุฉ ุ ูุงูุชุญูู ูู ุงููุธุงู ูุนุฏู ูุฌูุฏ ุชุตุญูุญุงุช ุฃูุงู ุ ููุญุต Umask ุ ููุง ุฅูู ุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ูุฒูุฏ ูู ุงูุชูุงุตูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุงูุฑุฌู</a> . </p><br><p style=";text-align:right;direction:rtl">  ูู ูุชู ุชุทููุฑู ููุฏุฉ 10 ุณููุงุช (ูุนู ุ ูุณุช ุงููุญูุฏ ุงูุฐู ุชุฎูู ุนู ุงูุจุฑูุงูุฌ). </p><br><h3 id="samhainhttpswwwla-samhnadesamhain" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Samhain</a> </h3><br><p style=";text-align:right;direction:rtl">  HIDS ูููุฐุฌู ูููู ุฃู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญูู ูู ุณูุงูุฉ ุงููุธุงู ุจุฃูููู ูู ุฎูุงู ุชุฌุฒุฆุงุช ุงูุชุดููุฑ. </li><li style=";text-align:right;direction:rtl">  ุงุจุญุซ ุนู ุงููููุงุช ุงูุชูููุฐูุฉ ุงููุชููุนุฉ ุจุงุณุชุฎุฏุงู SUID ุงููุซุจุช ุ ูุงูุฐู ูุง ูุฌุจ ุชุซุจูุชู. </li><li style=";text-align:right;direction:rtl">  ูุดู ุงูุนูููุงุช ุงูุฎููุฉ. </li><li style=";text-align:right;direction:rtl">  ุชุณุฌูู ุงูุณุฌูุงุช ูููุงุนุฏ ุงูุจูุงูุงุช. </li></ul><br><p style=";text-align:right;direction:rtl">  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุฏููุง ูุฑุงูุจุฉ ูุฑูุฒูุฉ ูุน ูุงุฌูุฉ ููุจ ูุฅุฑุณุงู ูุฑูุฒู ููุณุฌูุงุช ุฅูู ุงูุฎุงุฏู. <br>       ,        . <br>       . </p><br><p style=";text-align:right;direction:rtl"> ,  ,           . ,  ,    ,    ,         . </p><br><p style=";text-align:right;direction:rtl"> -     HIDS:        . <br>     Samhain,      . </p><br><h3 id="tripwirehttpssourceforgenetprojectstripwire" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Tripwire</a> </h3><br><p style=";text-align:right;direction:rtl">   ,   Samhain,  Tripwire โ    . <br>    ,   . </p><br><h3 id="lynishttpscisofycomlynis" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Lynis</a> </h3><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  RkHunter</a> . </p><br><p style=";text-align:right;direction:rtl">  ,    . <br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a>     . <br>   Tiger       ,     ,  . <br>   ,  .    ,       , Lynix    Tripwire. </p><br><h3 id="chkrootkithttpwwwchkrootkitorg" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Chkrootkit</a> </h3><br><p style=";text-align:right;direction:rtl">     .    . <br> : </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">   ,  . </li><li style=";text-align:right;direction:rtl">       . </li><li style=";text-align:right;direction:rtl"> ,     latslog, wtmp  utmp. </li><li style=";text-align:right;direction:rtl">     ,   ,     . </li></ul><br><p style=";text-align:right;direction:rtl">      . </p><br><h3 id="ninjahttpforkbomborgninja" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ninja</a> </h3><br><p style=";text-align:right;direction:rtl">        Linux. </p><br><p style=";text-align:right;direction:rtl">      ninja-build. </p><br><p style=";text-align:right;direction:rtl"> ,      .      UID/GID, Ninja      ,         ,    (,     , ). <br>          (, su). <br>   ,     . </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  Ubuntu</a> ,     Debian. </p><br><h2 id="skanery-bezopasnosti" style=";text-align:right;direction:rtl">   </h2><br><p style=";text-align:right;direction:rtl">       .   .    ,    ,    ,   . <br>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Nmap</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">W3af</a>  Web-. </p><br><h2 id="sistemy-alternativnyh-modeley-bezopasnosti" style=";text-align:right;direction:rtl">     </h2><br><p style=";text-align:right;direction:rtl">  Linux  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> (  )  </a> . <br>      .  ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> . </p><br><p style=";text-align:right;direction:rtl">   ,  ,   ,    . </p><br><p style=";text-align:right;direction:rtl">        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  " Linux"  IBM</a> . </p><br><p style=";text-align:right;direction:rtl">  NAS        ,    AppArmor. <br>  ,       ,     . <br> ,          ,          ,         . </p><br><h3 id="access-control-listshttpsdocsoraclecomcde19253-01820-0836ftyxiindexhtml" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Access Control Lists</a> </h3><br><p style=";text-align:right;direction:rtl">     ,     . <br>  , ZFS       . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">   ACL  ZFS.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">       . </li><li style=";text-align:right;direction:rtl">      . </li><li style=";text-align:right;direction:rtl">    . </li><li style=";text-align:right;direction:rtl">        . </li><li style=";text-align:right;direction:rtl">         . </li><li style=";text-align:right;direction:rtl">     . </li><li style=";text-align:right;direction:rtl">     ACL ( ls). </li><li style=";text-align:right;direction:rtl">       (   ACL,     "stat"). </li><li style=";text-align:right;direction:rtl">     . </li><li style=";text-align:right;direction:rtl">             . </li><li style=";text-align:right;direction:rtl">           . </li><li style=";text-align:right;direction:rtl">       . </li><li style=";text-align:right;direction:rtl">      ,     ,   . </li><li style=";text-align:right;direction:rtl">       ACL    chmod. </li><li style=";text-align:right;direction:rtl">        .        chown  chgrp . </li><li style=";text-align:right;direction:rtl">           ,     .               PRIV_FILE_CHOWN. </li><li style=";text-align:right;direction:rtl">      ACL   . </li><li style=";text-align:right;direction:rtl">   ACL      . </li><li style=";text-align:right;direction:rtl">   ACL   ,         ,     .     ACL    file_inherit,  dir_inherit   . </li><li style=";text-align:right;direction:rtl">   ACL       ,      . </li></ul></div></div><br><p style=";text-align:right;direction:rtl">  ACL    , ,     ,   .         . </p><br><p style=";text-align:right;direction:rtl">    EXT ,  ZFS  ACL      <code>setfacl/getfacl</code> ,    <code>chmod</code>  <code>ls</code> . </p><br><h3 id="apparmorhttpsgitlabcomapparmorapparmorwikishome" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">AppArmor</a> </h3><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/p2/yt/br/p2ytbr0l4cq_ujt9sh_njrh1t7k.jpeg"></p><br><p style=";text-align:right;direction:rtl">         . </p><br><p style=";text-align:right;direction:rtl"> ,         ,     <code>exec</code> ,  ,      <code>open</code> , <code>exec</code>  . <br>      ,     . <br> AppArmor ,       . <br>  ,      . <br>     capabilites. </p><br><p style=";text-align:right;direction:rtl">     ,    .       ,   ,      ,   . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">     ping.</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">#include &lt;tunables/global&gt; profile ping /{usr/,}bin/ping flags=(complain) { #include &lt;abstractions/base&gt; #include &lt;abstractions/consoles&gt; #include &lt;abstractions/nameservice&gt; capability net_raw, capability setuid, network inet raw, network inet6 raw, /{,usr/}bin/ping mixr, /etc/modules.conf r, # Site-specific additions and overrides. See local/README for details. #include &lt;local/bin.ping&gt; }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl"> ,       , ..     . ,  ,           ( <code>local/bin.ping</code> ),    ,     . </p><br><p style=";text-align:right;direction:rtl">     deb-based . <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  firejail</a> ,    . </p><br><p style=";text-align:right;direction:rtl">      ,   ,      . </p><br><p style=";text-align:right;direction:rtl">    Debian, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a> . </p><br><h3 id="selinuxhttpselinuxprojectorgpagemain_page" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SELinux</a> </h3><br><p style=";text-align:right;direction:rtl"> <a href=""><img src="https://habrastorage.org/webt/uk/8e/_4/uk8e_4yzmie_mnhkeak2sxxztem.png" alt=" SELinux"></a> </p><br><p style=";text-align:right;direction:rtl">    . <br>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">NSA</a> ,      Debian   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a> . </p><br><p style=";text-align:right;direction:rtl">   SELinux   " " (type enforcement). </p><br><p style=";text-align:right;direction:rtl">  , , ,      SELinux .      "". </p><br><p style=";text-align:right;direction:rtl"> ,    ,   <code>firefox_t</code> . <br> SELinux         ,     . </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">allow firefox_t user_home_t : file { read write };</code> </pre> <br><p style=";text-align:right;direction:rtl">     , ,  <code>firefox_t</code>         , ,  <code>user_home_t</code> . </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">allow user_t user_home_t:file { create read write unlink };</code> </pre> <br><p style=";text-align:right;direction:rtl">    <code>user_t</code>  , ,       <code>user_home_t</code> .  <code>user_t</code> ,  ,  . </p><br><p style=";text-align:right;direction:rtl"> ,      . </p><br><p style=";text-align:right;direction:rtl">     AppArmor -,  ,   ,        . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">     SELinux   .</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <strong></strong>  SELinux     Linux.     su  sudo,  SELinux  .   Linux    SELinux ,     1:1,     root. </li><li style=";text-align:right;direction:rtl"> <strong></strong> ,   ,   .  " ", "Web-", " ".     ,     <code>object_r</code> . <br>      ,  . </li><li style=";text-align:right;direction:rtl"> <strong></strong>  <strong></strong>      .  โ    ,  . </li><li style=";text-align:right;direction:rtl"> <strong></strong>  <strong></strong>     .  ,   ,        . ,     <code>user_u:user_r:user_t</code> ,        <code>user_u:object_r:user_home_t</code> .     : </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">user:role:type:range</code> </pre> <br><p style=";text-align:right;direction:rtl">   โ SELinux user.    โ   , .  โ   MLS . </p><br><p style=";text-align:right;direction:rtl"> ,     ,  ,  <code>user_home_t.</code> <code>user_home_t</code> โ  ,         ,     . </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <strong> </strong>  <strong> </strong> ,   <code>dir</code>    <code>file</code>     ,    ,    .      ,     . , <code>file</code>     (create),  (read),  (write)   (unlink),   <code>unix_stream_socket object</code> ( UNIX)     (create),   (connect),    (sendto). </li></ul></div></div><br><p style=";text-align:right;direction:rtl">     ,        . <br>     . ,    (,     ),    . </p><br><p style=";text-align:right;direction:rtl"> ,   AppArmor,  permissive ,       ,    . <br>       . <br>   ,       ,    AppArmor       . </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">   SELinux</a>   . <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  </a> . <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  IBM</a> . </p><br><h3 id="grsecurityhttpswwwgrsecuritynet" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GrSecurity</a> </h3><br><p style=";text-align:right;direction:rtl">    Debian -  .  ,    ,   . <br> ,   (     ), โ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> Gentoo</a> .     : hardening <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  </a> . </p><br><p style=";text-align:right;direction:rtl"> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">   </a> . </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  Debian</a>  ,    GrSecurity  PaX. </p><br><h3 id="tomoyohttptomoyoosdnjp" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Tomoyo</a> </h3><br><p style=";text-align:right;direction:rtl"> Tomoyo  Debian   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a> . </p><br><p style=";text-align:right;direction:rtl">        .   AppArmor,   .   2003 . <br>   ,    ,  . <br>    ,    AppArmor,     . </p><br><h2 id="melochi" style=";text-align:right;direction:rtl">  </h2><br><p style=";text-align:right;direction:rtl">        <code>/etc/securetty</code>  ,  root       ( ),        . </p><br><p style=";text-align:right;direction:rtl">       PAM,       <code>/etc/security</code> . </p><br><p style=";text-align:right;direction:rtl">    ,  Samhain  Tripwire,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">debsums</a> ,      . </p><br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงูุฎูุงุตุฉ </h2><br><p style=";text-align:right;direction:rtl">    .     ,      . </p><br><p style=";text-align:right;direction:rtl">  ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> Github </a> ,   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar421279/">https://habr.com/ru/post/ar421279/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar421267/index.html">ุชุจุฑูุฏ PSU ููููุจููุชุฑ ุดุจู ุงูุณูุจู</a></li>
<li><a href="../ar421269/index.html">ุณุงุนุฏ ูุธุงู ุงูุชุนุฑู ุนูู ุงููุฌูู ุงููุซุจุช ูู ุงููุทุงุฑ ุงูุฃูุฑููู ูู ุงููุจุถ ุนูู ุงูููุงุฌู</a></li>
<li><a href="../ar421271/index.html">ูุฌููุนุฉ ูุฎุชุงุฑุฉ ูู ุงูููุงุฏ ุงููููุฏุฉ ูู Azure. ุงูุฌุฒุก 2 - ุงูุฏูุฑุงุช</a></li>
<li><a href="../ar421275/index.html">ูุง ูููุชู ุจุนุฏ ุจูุน ุดุฑูุชูู ูุงุดุฆุชูู ูู 12 ุดูุฑูุง</a></li>
<li><a href="../ar421277/index.html">ุชุฌุฒุฆุฉ ุตูุฑ ุงูุฃููุงุฑ ุงูุตูุงุนูุฉ ุจุงุณุชุฎุฏุงู ุงูุชุนุฑู ุนูู ุงูุฃุดุฌุงุฑ ููุซุงู</a></li>
<li><a href="../ar421281/index.html">ุฅุฌุงุจุงุช ุฏุนู ุชูููุฉ 3CX: ุชุซุจูุช ุดุนุงุฑู ุงูุฎุงุต ุนูู ุดุงุดุฉ ูุงุชู IP</a></li>
<li><a href="../ar421283/index.html">ูุชุงุจ "ููุฑุฉ" ุนู ุญุจุฑู. ุงููุตู ุงูุฃูู: ุนุงูู ุงูุญุงุฑุณ</a></li>
<li><a href="../ar421285/index.html">ุฃุฌูุฒุฉ ุชุชุจุน ุจุตุฑูุฉ: ASEF ู MOSSE</a></li>
<li><a href="../ar421287/index.html">ุทูุจ ุงูููุฑ ูู ูุฑู ุดูุณู</a></li>
<li><a href="../ar421289/index.html">ุงุฑุชูุน ุนุฏุฏ ุงูุณูุงุฑุงุช ุงูููุฑุจุงุฆูุฉ ูู ุฑูุณูุง ูู 920 ุฅูู 2500 ูู ุนุงู ููุตู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>