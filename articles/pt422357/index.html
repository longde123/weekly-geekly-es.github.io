<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéÖüèæ ‚õàÔ∏è üßìüèø Aprendizado profundo para determinar o estilo e o g√™nero das pinturas üöÉ ü§¶üèø üë®‚Äçüë®‚Äçüëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! 


 Hoje eu quero falar sobre a segunda parte do projeto de servi√ßo para a identifica√ß√£o e classifica√ß√£o de obras de arte. Deixe-me lembr√°-l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendizado profundo para determinar o estilo e o g√™nero das pinturas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/singularis/blog/422357/"><p>  Ol√° Habr! </p><br><p>  Hoje eu quero falar sobre a segunda parte do projeto de servi√ßo para a identifica√ß√£o e classifica√ß√£o de obras de arte.  Deixe-me lembr√°-lo de que resolvemos duas tarefas principais: </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">procure uma foto no banco de dados a partir de uma fotografia tirada por um telefone celular;</a> </li><li>  determina√ß√£o do estilo e g√™nero de uma imagem que n√£o est√° no banco de dados. </li></ol><br><p>  Hoje vamos considerar o uso de uma rede neural convolucional para classificar imagens por estilo e g√™nero. </p><br><img src="https://habrastorage.org/webt/r3/ef/sj/r3efsjaeruoyzjzbsxzcprq7owk.jpeg"><br><p>  Ajuda o Dasha a entender a arte contempor√¢nea? </p><a name="habracut"></a><br><h2>  Determinando o estilo das pinturas </h2><br><p> Das quase 250.000 pinturas no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">banco de dados</a> da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arthive,</a> menos de 20% √© atribu√≠do a um g√™nero, estilo ou t√©cnica, geralmente as classes exibidas no banco de dados n√£o correspondem aos valores reais, muitas classes contendo poucas imagens.  Parece que existem at√© classes contendo unidades de imagens.  Aparentemente, alguns autores consideram necess√°rio criar um nome para seu pr√≥prio estilo. <br><br>  No total, cerca de 75 estilos foram alocados no banco de dados; no entanto, para o nosso trabalho, o cliente selecionou 27 estilos obrigat√≥rios (aos quais outro foi posteriormente adicionado), que o sistema deve reconhecer. <br><br>  Para eles, a distribui√ß√£o do recheio acabou sendo muito desigual. </p><br><table><thead><tr><th>  Estilo </th><th>  qtde </th><th>  Estilo </th><th>  qtde </th></tr></thead><tbody><tr><td>  Realismo </td><td>  19594 </td><td>  Primitivismo </td><td>  1234 </td></tr><tr><td>  Impressionismo </td><td>  15864 </td><td>  Art D√©co </td><td>  1092 </td></tr><tr><td>  Romantismo </td><td>  8963 </td><td>  Renascen√ßa do Norte </td><td>  921 </td></tr><tr><td>  Barroco </td><td>  7726 </td><td>  Cubismo </td><td>  902 </td></tr><tr><td>  Moderno </td><td>  4882 </td><td>  Academicism </td><td>  707 </td></tr><tr><td>  Surrealismo </td><td>  4793 </td><td>  G√≥tico </td><td>  608 </td></tr><tr><td>  Renascimento </td><td>  4709 </td><td>  Modernismo </td><td>  539 </td></tr><tr><td>  Expressionismo </td><td>  4329 </td><td>  Realismo socialista </td><td>  481 </td></tr><tr><td>  Simbolismo </td><td>  4321 </td><td>  Arte pop </td><td>  475 </td></tr><tr><td>  P√≥s-impressionismo </td><td>  3951 </td><td>  Pontilhismo </td><td>  275 </td></tr><tr><td>  Arte abstrata </td><td>  3664 </td><td>  Fauvismo </td><td>  217 </td></tr><tr><td>  Ukiyo-e </td><td>  3136 </td><td>  Vanguard </td><td>  174 </td></tr><tr><td>  Classicismo </td><td>  1730 </td><td>  Hiperrealismo </td><td>  13 </td></tr><tr><td>  Rococ√≥ </td><td>  1600 </td><td>  Fantasia </td><td>  8 </td></tr><tr><td></td><td></td><td>  <strong><em>Total</em></strong> </td><td>  96908 </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">Todos os estilos</b> <div class="spoiler_text"><table><thead><tr><th>  Estilo </th><th>  qtde </th><th>  Estilo </th><th>  qtde </th><th>  Estilo </th><th>  qtde </th></tr></thead><tbody><tr><td>  <strong>Realismo</strong> </td><td>  19594 </td><td>  <strong>Arte pop</strong> </td><td>  475 </td><td>  Decorativeism </td><td>  66. </td></tr><tr><td>  <strong>Impressionismo</strong> </td><td>  15864 </td><td>  Biedermeier </td><td>  471 </td><td>  Minimalismo </td><td>  66. </td></tr><tr><td>  <strong>Romantismo</strong> </td><td>  8963 </td><td>  Realismo fant√°stico </td><td>  386 </td><td>  Sentimentalismo </td><td>  66. </td></tr><tr><td>  <strong>Barroco</strong> </td><td>  7726 </td><td>  Expressionismo abstrato </td><td>  358 </td><td>  Cloisonismo </td><td>  60 </td></tr><tr><td>  <strong>Moderno</strong> </td><td>  4882 </td><td>  Nabis </td><td>  339 </td><td>  Pintura metaf√≠sica </td><td>  56. </td></tr><tr><td>  <strong>Surrealismo</strong> </td><td>  4793 </td><td>  <strong>Pontilhismo</strong> </td><td>  275 </td><td>  Machiaioli </td><td>  52 </td></tr><tr><td>  <strong>Renascimento</strong> </td><td>  4709 </td><td>  Suprematismo </td><td>  273 </td><td>  Orphism </td><td>  51 </td></tr><tr><td>  <strong>Expressionismo</strong> </td><td>  4329 </td><td>  Pr√©-rafaelitas </td><td>  252 </td><td>  Dada </td><td>  50. </td></tr><tr><td>  <strong>Simbolismo</strong> </td><td>  4321 </td><td>  Realismo m√°gico </td><td>  248 </td><td>  Neo-impressionismo </td><td>  49. </td></tr><tr><td>  <strong>P√≥s-impressionismo</strong> </td><td>  3951 </td><td>  Renascen√ßa </td><td>  232 </td><td>  Luminismo </td><td>  41. </td></tr><tr><td>  <strong>Arte abstrata</strong> </td><td>  3664 </td><td>  Neo-expressionismo </td><td>  230 </td><td>  Proto-renascimento </td><td>  39. </td></tr><tr><td>  A Era de Ouro da Holanda </td><td>  3292 </td><td>  <strong>Fauvismo</strong> </td><td>  217 </td><td>  Plantanismo </td><td>  37. </td></tr><tr><td>  <strong>Ukiyo-e</strong> </td><td>  3136 </td><td>  P√≥s-modernismo </td><td>  192 </td><td>  Tenebrizm </td><td>  35 </td></tr><tr><td>  <strong>Classicismo</strong> </td><td>  1730 </td><td>  <strong>Vanguard</strong> </td><td>  174 </td><td>  Impressionismo abstrato </td><td>  34 </td></tr><tr><td>  <strong>Rococ√≥</strong> </td><td>  1600 </td><td>  Arte contempor√¢nea </td><td>  149 </td><td>  Conceitualismo </td><td>  29 </td></tr><tr><td>  <strong>Primitivismo</strong> </td><td>  1234 </td><td>  Precis√£o </td><td>  138 </td><td>  Japanism </td><td>  24 </td></tr><tr><td>  <strong>Art D√©co</strong> </td><td>  1092 </td><td>  Cubofuturismo </td><td>  108 </td><td>  P√≥s-moderno </td><td>  24 </td></tr><tr><td>  <strong>Renascen√ßa do Norte</strong> </td><td>  921 </td><td>  Construtivismo </td><td>  104 </td><td>  Luchism </td><td>  24 </td></tr><tr><td>  <strong>Cubismo</strong> </td><td>  902 </td><td>  Tonalismo </td><td>  103 </td><td>  Bizantino </td><td>  20 </td></tr><tr><td>  <strong>Academicism</strong> </td><td>  707 </td><td>  Orphism </td><td>  94 </td><td>  Realismo rom√¢ntico </td><td>  19 </td></tr><tr><td>  <strong>G√≥tico</strong> </td><td>  608 </td><td>  Regionalismo </td><td>  93 </td><td>  <strong>Hiperrealismo</strong> </td><td>  13 </td></tr><tr><td>  Neoclassicismo </td><td>  601 </td><td>  Realismo anal√≠tico </td><td>  89 </td><td>  Verism </td><td>  11 </td></tr><tr><td>  Maneirismo </td><td>  544 </td><td>  Naturalismo </td><td>  73 </td><td>  Neo-primitivismo </td><td>  10 </td></tr><tr><td>  <strong>Modernismo</strong> </td><td>  539 </td><td>  Neo-modernismo </td><td>  70 </td><td>  <strong>Fantasia</strong> </td><td>  8 </td></tr><tr><td>  <strong>Realismo socialista</strong> </td><td>  481 </td><td>  Futurismo </td><td>  67 </td><td>  Metarealismo </td><td>  7 </td></tr><tr><td></td><td></td><td></td><td></td><td>  <strong><em>Total</em></strong> </td><td>  106284 </td></tr></tbody></table><br></div></div><br><p>  Somos confrontados com a tarefa de classificar imagens, mas n√£o podemos selecionar nenhum recurso simples manualmente.  Portanto, usaremos o profundo aprendizado de m√°quina, no qual esses recursos complexos s√£o identificados automaticamente no processo de aprendizado. </p><br><br><h1>  Transfer√™ncia de aprendizado </h1><br><p>  Considere a rede v3 inicial. </p><br><br><img src="https://habrastorage.org/webt/f3/pe/md/f3pemdvtfg6ryjjok5v1tr3ae6m.png" alt="Arquitetura geral com sa√≠das intermedi√°rias"><br><br><p>  Em sua arquitetura (e em qualquer outra rede profunda), dois componentes principais podem ser distinguidos condicionalmente - Feature Extractor e Predictor. <br><br>  O Extrator de recursos mapeia a imagem colorida de entrada em um espa√ßo de recursos multidimensional (mapa de recursos multicanais).  O mapa de recursos armazena informa√ß√µes espaciais - ou seja, √© um tensor tridimensional com dimens√µes em largura, altura e n√∫mero de canais de recursos; o pool final ainda n√£o foi aplicado aqui, o que elimina completamente as informa√ß√µes sobre a posi√ß√£o relativa dos recursos na imagem original.  A rede Extractor de recursos v3 da Inicia√ß√£o recebe 299 imagens de entrada <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.054ex" height="1.455ex" viewBox="0 -520.7 2606.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-7A" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-65" x="1670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-73" x="2137" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ vezes </script>  299 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.054ex" height="1.455ex" viewBox="0 -520.7 2606.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-7A" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-65" x="1670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-73" x="2137" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ vezes </script>  3, e na sa√≠da forma um mapa de sinais de tamanho 17 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.054ex" height="1.455ex" viewBox="0 -520.7 2606.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-7A" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-65" x="1670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-73" x="2137" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> \ vezes </script>  17 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.054ex" height="1.455ex" viewBox="0 -520.7 2606.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-7A" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-65" x="1670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/422357/&amp;usg=ALkJrhjYYCv7yzB-EwQjoGOIhIRrX6qMtQ#MJMATHI-73" x="2137" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>e</mi><mi>z</mi><mi>e</mi><mi>s</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ vezes </script>  2048. O tamanho da entrada pode variar, o que levar√° a altera√ß√µes no tamanho do mapa de recursos e pode ser √∫til para reduzir os custos computacionais ao trabalhar com a rede. <br><br>  O Predictor √© uma rede que gera sa√≠da com base em um mapa de recursos gerado pelo Feature Extractor.  Como regra, para a tarefa de classifica√ß√£o, o Predictor √© uma camada de neur√¥nios totalmente conectada, cujo n√∫mero de sa√≠das coincide com o n√∫mero de classes do problema. <br><br>  O aprendizado de transfer√™ncia cl√°ssica pressup√µe que tomamos uma rede treinada, separamos o Extrator de recursos e o complementamos com um novo preditor com o n√∫mero de classes de que precisamos.  A rede resultante √© treinada em baixa velocidade com pesos parcialmente ou completamente congelados das camadas do Feature Extractor. </p><br><p>  Aplicamos o aprendizado de transfer√™ncia para classificar estilos.  Pegue a rede Inception-v3 treinada em um conjunto de dados imagenet e substitua a camada de sa√≠da de neur√¥nios nela, que classifica as imagens de entrada no n√∫mero de estilos selecionados.  Treinamos a rede em imagens de diferentes estilos, congelando o treinamento de todas as camadas, exceto a √∫ltima. </p><br><p>  Para an√°lise dos dados, exibimos a distribui√ß√£o da valida√ß√£o definida por classe. <br><br><img src="https://habrastorage.org/webt/dj/rq/-9/djrq-9odlvd6uudi_9eofw7ufl4.jpeg"><br><br>  Cada linha corresponde a uma classe do conjunto de valida√ß√£o.  O brilho dos quadrados na linha √© proporcional ao n√∫mero de imagens que caem na classe correspondente √† coluna. <br><br>  Para melhor clareza, exclu√≠mos a diagonal principal e normalizamos novamente os valores de cada linha. <br><br><img src="https://habrastorage.org/webt/tf/ch/oz/tfchozlbdfigafnapiq7dtbs53u.jpeg"><br><br>  Al√©m disso, tentaremos mapear a distribui√ß√£o de estilos para o espa√ßo bidimensional usando o TSNE. <br><br><img src="https://habrastorage.org/webt/v1/dq/bt/v1dqbtf7whkh1occcwdxp_cprcu.png"></p><br><p>  Pode-se observar que muitos erros s√£o observados, por exemplo, na classifica√ß√£o de pinturas no estilo fauvismo - uma parte significativa delas se refere ao expressionismo pela rede.  O Renascimento do Norte e o G√≥tico s√£o freq√ºentemente chamados de reavivamento.  Muitas imagens do estilo rococ√≥ e do classicismo est√£o relacionadas ao realismo.  Modernismo e modernidade geralmente se enquadram em muitos estilos. </p><br><p>  Depois de lan√ßar um script simples que analisou o banco de dados de treinamento em pastas de acordo com o estilo definido pela rede, realizamos uma an√°lise r√°pida dos erros.  Descobriu-se que a marca√ß√£o do banco de dados pelo menos levanta quest√µes. <br><br>  Muitas imagens no estilo do modernismo (que, embora tenham sido marcadas pelo cliente como obrigat√≥rias, mas em geral n√£o s√£o um estilo, e sim uma tend√™ncia na arte como um todo) foram na verdade duplicadas em outros estilos, especialmente no modernismo (mas isso j√° √© um estilo). </p><br><p>  No estilo do realismo socialista, imagens abstratas estavam presentes, por exemplo, nas obras de Lissitzky.  Provavelmente, eles chegaram l√° gra√ßas ao trabalho de Lissitzky no p√¥ster sovi√©tico, que tem uma rela√ß√£o muito indireta com o realismo socialista. </p><br><p>  De muitas maneiras, esses s√£o realmente erros, mas √†s vezes a raz√£o √© a debatibilidade da quest√£o de destacar alguns estilos, especialmente modernos.  Vale a pena considerar que o banco de dados √© preenchido com v√°rios usu√°rios e, entre eles, √†s vezes n√£o h√° consenso. <br><br>  Erros nos dados levam a erros correspondentes na classifica√ß√£o de imagens pela rede.  No processo de limpeza da base, tanto por n√≥s quanto pelo especialista em arte, por parte do cliente, a marca√ß√£o para a amostra de treinamento foi significativamente aprimorada. </p><br><p>  No entanto, a maior parte dos erros de classifica√ß√£o da rede (no total) refere-se a estilos mais ou menos bem estabelecidos, como rococ√≥, classicismo, realismo.  A atribui√ß√£o de obras a esses estilos, em regra, ocorre com base em uma √©poca ou autoria e, ao que parece, n√£o causa d√∫vidas e disputas.  Por que a rede n√£o consegue distinguir seu estilo?  O principal motivo est√° no uso de uma rede pr√©-treinada para extrair caracter√≠sticas. </p><br><p>  O fato √© que essa rede foi treinada para classificar objetos, determinar exatamente o que √© representado, enquanto descarta informa√ß√µes que n√£o s√£o essenciais para a tarefa sobre como √© representada.  Por exemplo, do ponto de vista da rede, em todas as imagens no in√≠cio do artigo, em geral, uma pessoa √© retratada. </p><br><p>  Para resolver esse problema, criamos uma rede com sa√≠das intermedi√°rias - acredita-se que os sinais se tornam mais dif√≠ceis √† medida que se movem ao longo da rede, e informa√ß√µes n√£o essenciais desaparecem gradualmente.  Vamos tentar extrair das camadas intermedi√°rias o que n√£o era essencial para a classifica√ß√£o da imagenet. </p><br><br><img src="https://habrastorage.org/webt/yl/iw/ut/yliwutsxjouveu2g4k8ojxk7qwg.png" alt="Arquitetura geral com sa√≠das intermedi√°rias"><br><p>  H√° outro problema - gr√°ficos, impress√µes, esbo√ßos.  Na imagenet, na qual a rede inicial foi pr√©-treinada, simplesmente n√£o h√° nada como isso, respectivamente, e os recursos destacados pela rede n√£o s√£o adequados para classificar essas imagens. </p><br><br><table><tbody><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/hk/5c/sf/hk5csf3ivfa2yc8cperdjnrk50u.jpeg"><br></a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/1u/4b/ng/1u4bngyrvbacxvb-ue-7shvhkky.jpeg"><br></a> <br></td></tr><tr><td align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Realismo, impressionismo.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Camille Carot, Hagar e o anjo</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a> <br></td><td align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Barroco</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rembrandt Harmenszoon Van Rijn, Hagar e o Anjo</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a> <br></td></tr></tbody></table><br><p>  Por outro lado, pinturas no estilo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ukiyo-e</a> , uma esp√©cie de gravura que se espalhou pelo Jap√£o desde o s√©culo XVII, foram lindamente penduradas em uma nuvem separada.  Embora inicialmente eles n√£o estivessem em nossa lista obrigat√≥ria, n√≥s os adicionamos l√°. </p><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/ub/xz/fq/ubxzfqqe_iut0ljlbu1uab_0mey.jpeg" alt="Campos de Arroz de Asakusa e Torinomachi Festival"><br></a> <br><br><p>  Ap√≥s trabalhar com os dados, foi alcan√ßada uma melhor distribui√ß√£o entre as classes. </p><br><h2>  Lidamos com g√™neros </h2><br><p>  Do n√∫mero total de g√™neros, 13 foram selecionados (destacados em negrito) </p><br><table><thead><tr><th>  G√©nero </th><th>  qtde </th></tr></thead><tbody><tr><td>  Cena aleg√≥rica </td><td>  2500 </td></tr><tr><td>  <strong>Retrato</strong> </td><td>  2308 </td></tr><tr><td>  <strong>Paisagem</strong> </td><td>  2213 </td></tr><tr><td>  Fantasia </td><td>  2191 </td></tr><tr><td>  Cena liter√°ria </td><td>  2096 </td></tr><tr><td>  <strong>Paisagem da cidade</strong> </td><td>  2048 </td></tr><tr><td>  <strong>Nude</strong> </td><td>  1981 </td></tr><tr><td>  <strong>Ainda vida</strong> </td><td>  1932 </td></tr><tr><td>  <strong>Cena de g√™nero</strong> </td><td>  1736 </td></tr><tr><td>  <strong>Animalism</strong> </td><td>  1587 </td></tr><tr><td>  Cena religiosa </td><td>  1417 </td></tr><tr><td>  Cena mitol√≥gica </td><td>  1368 </td></tr><tr><td>  <strong>Marina</strong> </td><td>  1210 </td></tr><tr><td>  Arquitetura </td><td>  958 </td></tr><tr><td>  <strong>O interior</strong> </td><td>  635 </td></tr><tr><td>  Cena hist√≥rica </td><td>  534 </td></tr><tr><td>  <strong>Cena de batalha</strong> </td><td>  201 </td></tr><tr><td>  <strong>Zakli</strong> </td><td>  180 </td></tr><tr><td>  <strong>Veduta</strong> </td><td>  124 </td></tr><tr><td>  Paisagem urbana </td><td>  16 </td></tr><tr><td>  <strong><em>Total</em></strong> </td><td>  27235 </td></tr></tbody></table><br><p>  Basicamente, a redu√ß√£o no n√∫mero de g√™neros foi alcan√ßada reduzindo os g√™neros de v√°rias cenas - "religiosa", "mitol√≥gica", "aleg√≥rica", "liter√°ria" e combinando-as sob o nome geral de "cena de g√™nero".  Chegamos √† conclus√£o de que a separa√ß√£o desses g√™neros dificilmente pode ser realizada com precis√£o suficiente sem an√°lise cultural significativa. <br><br>  Por exemplo, para uma cena aleg√≥rica, por defini√ß√£o, sup√µe-se que exista um significado oculto na imagem, o uso de significados figurativos nos objetos representados.  Tamb√©m h√° uma dificuldade com a "cena religiosa": √© muito prov√°vel que uma rede treinada para emitir tal classe tamb√©m as chame de imagens de caricatura (por exemplo, parodiando a √öltima Ceia de Da Vinci), e isso pode ofender algu√©m . </p><br><p>  A marca√ß√£o de dados por g√™nero inicialmente parece boa, exceto por v√°rios g√™neros para os quais existem poucas imagens no banco de dados.  Ao pesquisar na Internet, conseguimos expandir um pouco o n√∫mero de imagens em g√™neros (principalmente a cena da batalha, gar√ßas e vedutas). <br>  Depois de combinar g√™neros dif√≠ceis em uma ‚Äúcena de g√™nero‚Äù comum, tentamos imediatamente treinar a rede ‚Äúna testa‚Äù usando o in√≠cio das redes de aprendizado por transfer√™ncia. </p><br><p><img src="https://habrastorage.org/webt/tk/af/n4/tkafn43bprvet-oqzwi-2sg4t60.jpeg" alt="G√™neros, resultado 1"></p><br><p>  Pode-se ver que os pontos correspondentes a imagens de diferentes g√™neros s√£o misturados.  Para essas imagens, a rede fornece altos valores das probabilidades de pertencer a v√°rios g√™neros ao mesmo tempo, e o g√™nero com maior probabilidade √© determinado quase por acidente.  Aparentemente, a raz√£o √© que os g√™neros, diferentemente dos estilos, t√™m uma hierarquia mais pronunciada.  Tentamos entender essas conex√µes, temos um mapa de g√™neros: </p><br><p> <a href=""><br><img src="https://habrastorage.org/webt/wj/up/d4/wjupd4h-6mczoz_zo39rqscslpe.jpeg" alt="Hierarquia de g√™neros"></a> </p><br><p>  Os g√™neros de hierarquia subsidi√°ria e parental geralmente t√™m caracter√≠sticas comuns do ponto de vista da rede (e tamb√©m do nosso ponto de vista).  Por exemplo, a cena da batalha em terra como um todo tem as mesmas caracter√≠sticas da paisagem usual - a imagem de uma grande √°rea aberta ou cidade, e a cena da batalha no mar √© mais parecida com o g√™nero da marina.  Portanto, dividimos o g√™nero da cena da batalha em dois - em terra e no mar.  Outro exemplo: retratos, uma cena de g√™nero e imagens de nus do ponto de vista de uma rede pr√©-treinada t√™m um sinal comum - a presen√ßa de pessoas. </p><br><p>  No banco de dados, imagens com conte√∫do semelhante geralmente se referem ao filho ou ao g√™nero pai, dependendo de onde foi determinado pelo especialista que trouxe as fotos para o banco de dados.  Nesse sentido, foi realizada uma limpeza e reparti√ß√£o em larga escala da base, levando em considera√ß√£o a poss√≠vel hierarquia de g√™neros, o que exigiu muito esfor√ßo (conseguimos automatiz√°-la, mas n√£o muito). </p><br><p>  A fim de transferir a hierarquia de g√™neros para a rede, abandonamos o envio em um s√≥ lugar e configuramos a unidade para imagens n√£o apenas em um g√™nero, mas tamb√©m em seu pai, se houver, e tamb√©m substitu√≠mos a fun√ß√£o de destino do processo de aprendizado e a fun√ß√£o de ativar a camada de sa√≠da .  Assim, a tarefa passou a ser a classifica√ß√£o Multilabel (a imagem de entrada pode pertencer a v√°rias classes). </p><br><p><img src="https://habrastorage.org/webt/0k/k9/fo/0kk9foqusebcdte0pcmm11nw0ya.jpeg"></p><br><p>  Parece-nos que outro g√™nero est√° faltando aqui - abstra√ß√£o.  A rigor, esse n√£o √© um g√™nero.  Pelo menos especialistas insistiram que n√£o havia esse g√™nero.  Para impedir a rede de dar respostas aleat√≥rias a imagens abstratas, mais uma foi adicionada √† divis√£o geral de g√™neros sob o nome "n√£o foi poss√≠vel determinar", incluindo imagens abstratas e controversas. </p><br><h2>  Em vez de uma conclus√£o </h2><br><p>  Em geral, foi poss√≠vel obter uma precis√£o satisfat√≥ria na classifica√ß√£o de estilos e g√™neros de imagens, mas h√° muito a melhorar. </p><br><p>  Infelizmente, a classifica√ß√£o de estilos e t√©cnicas n√£o foi finalizada - o suporte n√£o foi implementado no servi√ßo. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt422357/">https://habr.com/ru/post/pt422357/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt422339/index.html">"Acho que o JavaScript n√£o √© adequado para a web." 10 perguntas ao programador, 4 release (de Berlim)</a></li>
<li><a href="../pt422341/index.html">IoT - promova enquanto outros pensam</a></li>
<li><a href="../pt422345/index.html">Servidor nas nuvens: Resumo do Projeto</a></li>
<li><a href="../pt422347/index.html">Migrando um Aplicativo Real do MySQL Independente para o Percona XtraDB Cluster</a></li>
<li><a href="../pt422355/index.html">Jogos ao longo do tempo: acelerando o aplicativo no n√≠vel de percep√ß√£o</a></li>
<li><a href="../pt422361/index.html">S√≠ndrome corporativa</a></li>
<li><a href="../pt422363/index.html">Confer√™ncia PyCon Russia 2018: v√≠deo de todos os relat√≥rios e apresenta√ß√µes</a></li>
<li><a href="../pt422365/index.html">A Yandex apresentou uma queixa contra uma decis√£o judicial para remover links para conte√∫do pirata</a></li>
<li><a href="../pt422367/index.html">Como restaurar v√≠deos do Full Throttle Remastered. Parte 2</a></li>
<li><a href="../pt422369/index.html">Projetando pain√©is para o site de com√©rcio eletr√¥nico de an√°lise da web. Parte 2: Boletins por e-mail. Painel estrat√©gico</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>