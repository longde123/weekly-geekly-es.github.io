<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçú üçö ‚ùÑÔ∏è Transactions et m√©canismes de contr√¥le üö∂üèª ‚õ∏Ô∏è üëá</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les transactions 
 Une transaction est une s√©quence d'op√©rations sur des donn√©es qui a un d√©but et une fin. 
 Une transaction est une op√©ration s√©quen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Transactions et m√©canismes de contr√¥le</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446662/"><h2>  Les transactions </h2><br><h4>  Une transaction est une s√©quence d'op√©rations sur des donn√©es qui a un d√©but et une fin. </h4><br>  Une transaction est une op√©ration s√©quentielle de lecture et d'√©criture.  La fin d'une transaction peut √™tre soit l'enregistrement des modifications (validation, validation) ou l'annulation des modifications (restauration, restauration).  En ce qui concerne la base de donn√©es, une transaction est une s√©rie de requ√™tes, qui sont trait√©es comme une requ√™te unique. <br><br><h4>  Les transactions doivent satisfaire les propri√©t√©s ACID </h4><br>  Atomicit√©.  Une transaction est soit enti√®rement ex√©cut√©e, soit pas ex√©cut√©e du tout. <br><br>  Coh√©rence.  √Ä la fin de la transaction, les restrictions impos√©es aux donn√©es (par exemple, les contraintes dans la base de donn√©es) ne doivent pas √™tre viol√©es.  La coh√©rence implique que le syst√®me sera transf√©r√© d'un √©tat correct √† un autre √©tat correct. <br><br>  Isolement.  Les transactions ex√©cut√©es simultan√©ment ne doivent pas s‚Äôaffecter mutuellement, par exemple en modifiant les donn√©es utilis√©es par une autre transaction.  Le r√©sultat des transactions parall√®les doit √™tre comme si les transactions √©taient ex√©cut√©es s√©quentiellement. <br><br>  Durabilit√©.  Une fois valid√©s, les changements ne doivent pas √™tre perdus. <br><a name="habracut"></a><br><h2>  Journal des transactions </h2><br><h4>  Le journal stocke les modifications apport√©es par les transactions, garantit l'atomicit√© et la stabilit√© des donn√©es en cas de d√©faillance du syst√®me </h4><br>  Le journal contient les valeurs que les donn√©es avaient avant et apr√®s leur modification par la transaction.  La strat√©gie de journal √† √©criture anticip√©e n√©cessite que vous ajoutiez au journal un enregistrement des valeurs pr√©c√©dentes avant le d√©but et des valeurs finales une fois la transaction termin√©e.  En cas d'arr√™t brutal du syst√®me, la base de donn√©es lit le journal dans l'ordre inverse et annule les modifications apport√©es par les transactions.  Apr√®s avoir rencontr√© une transaction interrompue, la base de donn√©es l'ex√©cute et y apporte des modifications dans le journal.  √âtant en √©tat au moment de l'√©chec, la base de donn√©es lit le journal dans l'ordre direct et renvoie les modifications apport√©es par les transactions.  Ainsi, la stabilit√© des transactions d√©j√† engag√©es et l'atomicit√© de la transaction interrompue sont pr√©serv√©es. <br><br>  Il ne suffit pas de r√©ex√©cuter des transactions erron√©es pour r√©cup√©rer. <br><br>  <i>Un exemple.</i>  <i>L'utilisateur dispose de 500 $ dans le compte et l'utilisateur d√©cide de les retirer via un guichet automatique.</i>  <i>Deux transactions sont effectu√©es.</i>  <i>Le premier lit la valeur du solde et s'il y a suffisamment de fonds sur le solde, il donne de l'argent √† l'utilisateur.</i>  <i>Le second soustrait le montant requis du solde.</i>  <i>Supposons qu'un syst√®me se bloque et que la premi√®re op√©ration √©choue et que la seconde √©choue.</i>  <i>Dans ce cas, nous ne pouvons pas r√©√©mettre de l'argent √† l'utilisateur sans remettre le syst√®me √† son √©tat d'origine avec un solde positif.</i> <br><br><h2>  Niveaux d'isolement </h2><br><h4>  Lire Engag√© </h4><br>  Le probl√®me avec une lecture incorrecte est qu'une transaction peut lire le r√©sultat interm√©diaire d'une autre transaction. <br><br>  <i>Un exemple.</i>  <i>La valeur initiale du solde est de 0 $.</i>  <i>T1 ajoute 50 $ au solde.</i>  <i>T2 lit la valeur du solde (50 $).</i>  <i>T1 annule les modifications et se termine.</i>  <i>T2 continue l'ex√©cution avec des donn√©es de solde incorrectes.</i> <br><br>  La solution est Read Committed, qui interdit la lecture des donn√©es modifi√©es par une transaction.  Si la transaction A a modifi√© un ensemble de donn√©es, la transaction B, lors de l'acc√®s √† ces donn√©es, est oblig√©e d'attendre la transaction A. <br><br><h4>  Lecture r√©p√©table </h4><br>  Le probl√®me des modifications perdues (Lost Updates).  T1 enregistre les modifications par rapport aux modifications apport√©es √† T2. <br><br>  <i>Un exemple.</i>  <i>La valeur du solde initial est de 0 $ et deux transactions reconstituent simultan√©ment le solde.</i>  <i>T1 et T2 lisent un solde de 0 $.</i>  <i>Ensuite, T2 ajoute 200 $ √† 0 $ et enregistre le r√©sultat.</i>  <i>T1 ajoute 100 $ √† 0 $ et enregistre le r√©sultat.</i>  <i>Le r√©sultat total est de 100 $ au lieu de 300 $.</i> <br><br>  Probl√®me de lecture irrempla√ßable.  La lecture r√©p√©t√©e des m√™mes donn√©es renvoie des valeurs diff√©rentes. <br><br>  <i>Un exemple.</i>  <i>T1 lit une valeur de solde de 0 $.</i>  <i>Ensuite, T2 ajoute 50 $ au solde et se termine.</i>  <i>T1 relit les donn√©es et d√©tecte un √©cart avec le r√©sultat pr√©c√©dent.</i> <br><br>  La lecture r√©p√©table garantit que la lecture r√©p√©t√©e donnera le m√™me r√©sultat.  Il est interdit de modifier les donn√©es lues par une transaction dans d'autres jusqu'√† ce que la transaction soit termin√©e.  Si la transaction A a lu un ensemble de donn√©es, la transaction B, lors de l'acc√®s √† ces donn√©es, est oblig√©e d'attendre la transaction A. <br><br><h4>  Lecture ordonn√©e (s√©rialisable) </h4><br>  Lectures fant√¥mes  Deux requ√™tes qui s√©lectionnent des donn√©es par une condition renvoient des valeurs diff√©rentes. <br><br>  <i>Un exemple.</i>  <i>T1 demande le nombre de tous les utilisateurs dont le solde est sup√©rieur √† 0 $ mais inf√©rieur √† 100 $.</i>  <i>T2 soustrait 1 $ d'un utilisateur avec un solde de 101 $.</i>  <i>T1 r√©ex√©cute la demande.</i> <br><br>  Lecture ordonn√©e (s√©rialisable).  Les transactions sont effectu√©es de mani√®re compl√®tement s√©quentielle.  Il est interdit de mettre √† jour et d'ajouter des enregistrements soumis aux conditions de la demande.  Si la transaction A a demand√© des donn√©es √† l'ensemble de la table, la table enti√®re est gel√©e pour le reste des transactions jusqu'√† la transaction A. <br><br><h2>  Planificateur </h2><br><h4>  D√©finit l'ordre dans lequel les op√©rations doivent √™tre effectu√©es dans les transactions parall√®les </h4><br>  Fournit un niveau d'isolement sp√©cifi√©.  Si le r√©sultat des op√©rations ne d√©pend pas de leur ordre, ces op√©rations sont commutables (permutables).  Les commandes sont lues et les op√©rations sur diff√©rentes donn√©es.  Les op√©rations de lecture-√©criture et d'√©criture-√©criture ne sont pas commutatives.  L'ordonnanceur a pour t√¢che d'alterner les op√©rations effectu√©es par des transactions parall√®les afin que le r√©sultat de l'ex√©cution soit √©quivalent √† l'ex√©cution s√©quentielle des transactions. <br><br><h2>  M√©canismes de contr√¥le des acc√®s concurrents </h2><br><h4>  Optimiste bas√© sur la d√©tection et la r√©solution des conflits, pessimiste bas√© sur la pr√©vention des conflits </h4><br>  Avec une approche optimiste, plusieurs utilisateurs ont √† leur disposition des copies des donn√©es.  Le premier qui a termin√© l'√©dition enregistre les modifications, les autres doivent fusionner les modifications.  Un algorithme optimiste permet √† un conflit de se produire, mais le syst√®me doit se remettre du conflit. <br><br>  Avec une approche pessimiste, le premier utilisateur √† capturer des donn√©es emp√™che les autres de recevoir des donn√©es.  Si les conflits sont rares, il est sage de choisir une strat√©gie optimiste, car elle offre un niveau de parall√©lisme plus √©lev√©. <br><br><h2>  Verrouillage </h2><br><h4>  Si une transaction a bloqu√© des donn√©es, le reste de la transaction doit acc√©der aux donn√©es lors de l'acc√®s aux donn√©es. </h4><br>  Un bloc peut √™tre superpos√© √† une base de donn√©es, une table, une ligne ou un attribut.  Le verrouillage partag√© (verrou partag√©) peut √™tre impos√© aux m√™mes donn√©es par plusieurs transactions, permet la lecture de toutes les transactions (y compris impos√©es), interdit la modification et la capture exclusive.  Le verrouillage exclusif peut √™tre impos√© par une seule transaction, autorise toutes les actions de la transaction impos√©e, interdit toutes les actions par les autres. <br><br><h4>  Un blocage est une situation o√π les transactions sont en mode veille, d'une dur√©e ind√©finie </h4><br>  <i>Un exemple.</i>  <i>La premi√®re transaction attend la lib√©ration des donn√©es captur√©es par la seconde, tandis que la seconde attend la lib√©ration des donn√©es captur√©es par la premi√®re.</i> <br><br><h4>  Une solution optimiste au probl√®me de blocage permet un blocage, mais restaure ensuite le syst√®me en annulant l'une des transactions impliqu√©es dans le blocage. </h4><br>  Avec une certaine fr√©quence, une recherche de blocages est effectu√©e.  L'une des m√©thodes de d√©tection est dans le temps, c'est-√†-dire de consid√©rer qu'un blocage s'est produit si la transaction prend trop de temps.  Lorsqu'un blocage est d√©tect√©, l'une des transactions est annul√©e, ce qui permet aux autres transactions impliqu√©es dans le blocage de se terminer.  Le choix de la victime peut √™tre bas√© sur la valeur des transactions ou leur anciennet√© (syst√®mes Wait-Die et Wound-Wait). <br><br>  Chaque transaction <b>T se voit</b> attribuer un horodatage <b>TS</b> contenant l'heure de d√©but de la transaction. <br><br>  Wait-Die <br><br>  <u>Si <b>TS (Ti)</b> &lt; <b>TS (Tj)</b> , alors <b>Ti</b> attend, sinon <b>Ti</b> annule et recommence avec le m√™me horodatage.</u> <br><br>  Si une transaction jeune a captur√© une ressource et qu'une ancienne demande la m√™me ressource, alors une transaction plus ancienne est autoris√©e.  Si une transaction plus ancienne a captur√© une ressource, une transaction jeune demandant cette ressource sera annul√©e. <br><br>  Attends une blessure. <br><br>  <u>Si <b>TS (Ti)</b> &lt; <b>TS (Tj)</b> , alors <b>Tj</b> revient en arri√®re et recommence avec le m√™me horodatage, sinon <b>Ti</b> attend.</u> <br><br>  Si une transaction plus r√©cente a captur√© une ressource et qu'une transaction plus ancienne demande la m√™me ressource, la transaction jeune sera annul√©e.  Si une transaction plus ancienne a captur√© la ressource, une transaction plus r√©cente demandant cette ressource est autoris√©e √† attendre.  La s√©lection de la victime en fonction de l'anciennet√© √©vite les blocages, mais annule les transactions qui ne sont pas dans un √©tat de verrouillage.  Le probl√®me est que les transactions peuvent √™tre annul√©es plusieurs fois car  Une transaction plus ancienne peut contenir une ressource pendant longtemps. <br><br><h4>  Une solution pessimiste au probl√®me des blocages ne permet pas √† la transaction de d√©marrer son ex√©cution en cas de risque de blocage </h4><br>  Pour d√©tecter les interblocages, un graphique est construit (un graphique d'attente, un graphique en attente), dont les sommets sont des transactions, et les bords sont dirig√©s depuis les transactions qui attendent que des donn√©es soient lib√©r√©es vers la transaction qui a captur√© ces donn√©es.  On pense qu'un blocage s'est produit si le graphique est boucl√©.  La construction d'un graphique d'attente, en particulier dans les bases de donn√©es distribu√©es, est une proc√©dure co√ªteuse. <br><br><h4>  Verrouillage en deux phases - √©vitant les blocages en capturant toutes les ressources utilis√©es par la transaction au d√©but de la transaction et en les lib√©rant √† la fin </h4><br>  Toutes les op√©rations de blocage doivent pr√©c√©der le premier d√©verrouillage.  Il comporte deux phases - la phase de croissance au cours de laquelle la capture des grappins a lieu et la phase de r√©tr√©cissement au cours de laquelle la lib√©ration des grappins se produit.  S'il est impossible de capturer l'une des ressources, la transaction recommence.  Il est possible qu'une transaction ne puisse pas capturer les ressources requises, par exemple, si plusieurs transactions sont en concurrence pour les m√™mes ressources. <br><br><h4>  La validation en deux phases garantit que la validation est ex√©cut√©e sur toutes les r√©pliques de base de donn√©es </h4><br>  Chaque base de donn√©es fournit des informations sur les donn√©es qui seront modifi√©es dans le journal et correspond au coordinateur OK (phase de vote).  Apr√®s que tout le monde a r√©pondu OK, le coordinateur envoie un signal obligeant tout le monde √† s'engager.  Apr√®s avoir valid√© le serveur, ils r√©pondent OK, si au moins un n'a pas r√©pondu OK, le coordinateur envoie un signal pour annuler les modifications sur tous les serveurs (phase d'ach√®vement). <br><br><h2>  M√©thode d'horodatage </h2><br><h4>  Une transaction plus ancienne annule lorsque vous essayez d'acc√©der aux donn√©es impliqu√©es dans une transaction plus r√©cente </h4><br>  Chaque transaction se voit attribuer un horodatage <b>TS</b> correspondant √† l'heure de d√©but de l'ex√©cution.  Si <b>Ti est</b> plus ancien que <b>Tj</b> , alors <b>TS (Ti)</b> &lt; <b>TS (Tj)</b> . <br><br>  Lorsqu'une transaction est annul√©e, un nouvel horodatage lui est attribu√©.  Chaque objet de donn√©es <b>Q</b> impliqu√© dans la transaction est marqu√© de deux √©tiquettes.  <b>W-TS (Q)</b> est l'horodatage de la transaction la plus r√©cente qui a r√©ussi √† √©crire √† <b>Q.</b>  <b>R-TS (Q)</b> est l'horodatage de la transaction la plus r√©cente qui a termin√© un enregistrement de lecture sur <b>Q.</b> <br><br>  Lorsque la transaction <b>T</b> demande de lire les donn√©es <b>Q</b> , deux options sont possibles. <br><br>  <u>Si <b>TS (T)</b> &lt; <b>W-TS (Q)</b> , c'est-√†-dire que les donn√©es ont √©t√© mises √† jour par une transaction plus r√©cente, la transaction <b>T est</b> annul√©e.</u> <br><br>  <u>Si <b>TS (T)</b> &gt; = <b>W-TS (Q)</b> , alors la lecture est effectu√©e et <b>R-TS (Q)</b> devient <b>MAX (R-TS (Q), TS (T))</b> .</u> <br><br>  Lorsque la transaction <b>T</b> demande une modification des donn√©es <b>Q</b> , deux options sont possibles. <br><br>  <u>Si <b>TS (T)</b> &lt; <b>R-TS (Q)</b> , c'est-√†-dire que les donn√©es ont d√©j√† √©t√© lues par une transaction plus r√©cente et si un changement est effectu√©, alors un conflit se produira.</u>  <u>La transaction <b>T</b> annule.</u> <br><br>  <u>Si <b>TS (T)</b> &lt; <b>W-TS (Q)</b> , c'est-√†-dire que la transaction essaie d'√©craser la valeur la plus r√©cente, la transaction T annule.</u>  <u>Dans d'autres cas, le changement est effectu√© et <b>W-TS (Q)</b> devient √©gal √† <b>TS (T)</b> .</u> <br><br>  Aucune construction co√ªteuse de graphique d'attente n'est requise.  Les transactions plus anciennes d√©pendent des plus r√©centes, il n'y a donc pas de boucles dans la colonne d'attente.  Il n'y a pas de blocage, car les transactions ne sont pas attendues, mais sont imm√©diatement annul√©es.  Des pots-de-vin en cascade sont possibles.  Si <b>Ti</b> annule et que <b>Tj</b> lit les donn√©es que <b>Ti a</b> modifi√©es, alors <b>Tj</b> doit √©galement revenir en arri√®re.  Si dans ce cas <b>Tj</b> a d√©j√† √©t√© communiqu√©, il y aura alors violation du principe de stabilit√©. <br><br>  Une solution aux annulations en cascade.  Une transaction effectue toutes les op√©rations d'√©criture √† la fin, et les transactions restantes doivent attendre la fin de cette op√©ration.  Les transactions attendent un commit avant d'√™tre lues. <br><br><h4>  R√®gle d'√©criture Thomas - une variante de la m√©thode d'horodatage dans laquelle les donn√©es mises √† jour par une transaction plus r√©cente ne peuvent pas √™tre √©cras√©es par une plus ancienne </h4><br>  La transaction <b>T</b> demande une modification des donn√©es <b>Q.</b>  Si <b>TS (T)</b> &lt; <b>W-TS (Q)</b> , c'est-√†-dire que la transaction essaie d'√©craser une valeur plus r√©cente, la transaction T n'est pas annul√©e comme dans la m√©thode d'horodatage. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr446662/">https://habr.com/ru/post/fr446662/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr446648/index.html">D√©veloppement d'op√©rateurs Kubernetes avec Operator Framework</a></li>
<li><a href="../fr446650/index.html">Combien co√ªtent les testeurs et de quoi d√©pendent leurs salaires? Construire le portrait d'un sp√©cialiste en AQ performant</a></li>
<li><a href="../fr446652/index.html">MVCC-4. Instantan√©s de donn√©es</a></li>
<li><a href="../fr446656/index.html">Codage de la parole √† 1600 bits / s avec vocodeur neuronal LPCNet</a></li>
<li><a href="../fr446658/index.html">Entretien avec Andrei Stankevich sur la programmation sportive</a></li>
<li><a href="../fr446666/index.html">Tirez le meilleur parti des calculatrices graphiques: jeux sur la TI-83</a></li>
<li><a href="../fr446668/index.html">Python pour le web: ce qu'un junior doit savoir pour travailler et grandir</a></li>
<li><a href="../fr446674/index.html">Nous mod√©lisons l'algorithme MUSIC pour d√©terminer la direction d'arriv√©e d'une onde √©lectromagn√©tique</a></li>
<li><a href="../fr446676/index.html">Cr√©ation de touches manquantes pour le clavier en caoutchouc Commodore 116</a></li>
<li><a href="../fr446678/index.html">Live Battle: Porto ICPC Finals</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>