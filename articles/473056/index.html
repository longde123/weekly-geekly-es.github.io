<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§±üèª üç≥ üèáüèª C√≥mo Alicia reconoce pa√≠ses a partir de fotograf√≠as. Investigaci√≥n Yandex üë®‚Äçüë®‚Äçüëß‚Äçüë¶ üõ≥Ô∏è üßíüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola Mi nombre es Evgeny Kashin y trabajo en el laboratorio de inteligencia de m√°quinas Yandex. Recientemente lanzamos un juego en el que los usuarios...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo Alicia reconoce pa√≠ses a partir de fotograf√≠as. Investigaci√≥n Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/473056/"> Hola  Mi nombre es Evgeny Kashin y trabajo en el laboratorio de inteligencia de m√°quinas Yandex.  Recientemente lanzamos un juego en el que los usuarios compiten con Alice para adivinar los pa√≠ses a partir de fotograf√≠as. <br><br>  Es comprensible c√≥mo act√∫an las personas: reconocen los lugares que han visto en viajes o en pel√≠culas, conf√≠an en la erudici√≥n y el sentido com√∫n.  La red neuronal no tiene nada de esto.  Nos preguntamos qu√© detalles en las fotos le dan la respuesta.  Realizamos un estudio, cuyos resultados hoy compartiremos con Habr. <br><br>  Esta publicaci√≥n ser√° interesante tanto para los especialistas en el campo de la visi√≥n por computadora, como para todos los que deseen mirar dentro de la "inteligencia artificial" y comprender la l√≥gica de su trabajo. <br><br><img src="https://habrastorage.org/webt/yr/_o/ww/yr_oww7tnonz-ow4eos1dil0eom.png"><br><a name="habracut"></a><br>  Algunas palabras sobre el juego " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Adivina el pa√≠s por foto</a> ".  En resumen, tomamos fotos de Yandex.Maps y las dividimos en dos grupos.  El primer grupo fue mostrado por redes neuronales, diciendo d√≥nde se tom√≥ cada disparo.  Despu√©s de revisar miles de fotograf√≠as, la red neuronal hizo una idea de cada pa√≠s, es decir, identific√≥ de forma independiente combinaciones de signos por los cuales se puede reconocer.  Usamos el segundo grupo de im√°genes en el juego, Alice no las vio y no las recuerda durante el juego.  Alice juega bien, pero la gente tiene una ventaja: no entrenamos la red neuronal para reconocer n√∫meros de m√°quina, textos de signos y signos, banderas de estados. <br><br><img src="https://habrastorage.org/webt/wl/ch/1k/wlch1kqg7uzoapthamc-pwtvatc.jpeg"><br><br>  Para el juego, entrenamos al modelo para predecir el pa√≠s a partir de una fotograf√≠a.  Tomamos un modelo de visi√≥n por computadora <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SE-ResNeXt-101</a> , previamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">capacitado</a> en muchas tareas.  Los signos obtenidos de la imagen usando esta red neuronal convolucional son bastante universales, por lo que para el clasificador de pa√≠s fue necesario agregar solo unas pocas capas adicionales (la llamada cabeza).  Se utilizaron datos Yandex.Mart para el entrenamiento: aproximadamente 2.5 millones de fotos.  Muchas im√°genes no se ajustaban al juego seg√∫n el criterio de belleza y se filtraron.  La belleza se entiende como una combinaci√≥n de factores: la calidad de la foto, la presencia de personas, texto, bosque, mar.  Se eliminaron im√°genes similares del mismo lugar para que el modelo no recordara vistas espec√≠ficas.  Despu√©s de todo el filtrado, quedaban aproximadamente 1 mill√≥n de fotos.  Habiendo entrenado el modelo en estos datos, obtuvimos un clasificador bastante preciso, que determina el pa√≠s solo por foto, sin usar informaci√≥n adicional. <br><br>  Dado que la clasificaci√≥n se lleva a cabo utilizando una red neuronal, no podemos obtener f√°cilmente una interpretaci√≥n de las predicciones, en contraste con modelos lineales m√°s simples o √°rboles de decisi√≥n.  Pero quer√≠amos descubrir c√≥mo una red neuronal determina a partir de una fotograf√≠a regular de una calle o una casa de qu√© pa√≠s es.  Y los casos m√°s interesantes son sin atracciones en el marco. <br><br>  Para hacer esto, entrenamos la red neuronal desde cero, aliment√°ndola no con im√°genes enteras, sino solo peque√±os trozos de recorte (para que el modelo no recuerde lugares espec√≠ficos u objetos grandes). <br><br>  Por lo tanto, la tarea para el modelo se ha vuelto notablemente m√°s dif√≠cil (intente adivinar el pa√≠s por un pedazo de cielo), la precisi√≥n del reconocimiento ha disminuido considerablemente.  Pero, por otro lado, la red neuronal tuvo que prestar m√°s atenci√≥n a los peque√±os detalles: mamposter√≠a inusual, patrones espec√≠ficos, tipo de techo, plantas.  El tama√±o del cultivo aplicado al modelo cambi√≥, y se obtuvieron varios modelos que observaron la foto en diferentes niveles de abstracci√≥n: cuanto m√°s peque√±o es el cultivo, m√°s dif√≠cil es la tarea y m√°s atento al modelo. <br><br><img src="https://habrastorage.org/webt/-l/mq/og/-lmqognmqibnu46jxgyptkcojpk.jpeg"><br><br>  Los algoritmos para interpretar predicciones se pueden aplicar a modelos que fueron entrenados en tama√±os de cultivos de diferentes tama√±os.  Me gustar√≠a interpretar las predicciones en las fotograf√≠as fuente.  La mayor√≠a de las redes de convoluci√≥n modernas usan la <a href="">Agrupaci√≥n promedio global</a> (GAP) antes de la √∫ltima capa, esto permite entrenar la red en un tama√±o y aplicarlo en otro.  Esto se debe al hecho de que antes de la √∫ltima capa, las entidades espaciales, distribuidas en ancho y alto, se promedian en un n√∫mero para cada canal (mapa de entidades).  Por lo tanto, los modelos entrenados en recorte (por ejemplo, 160 √ó 160 p√≠xeles) se pueden usar en las im√°genes grandes originales (800 √ó 800). <br><br>  De hecho, la capa GAP es necesaria no solo para usar el modelo a diferentes resoluciones o para la regularizaci√≥n.  Tambi√©n ayuda a la red neuronal a almacenar informaci√≥n sobre la posici√≥n de los objetos hasta la √∫ltima capa (justo lo que necesitamos). <br><br>  El primer m√©todo que probamos es el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mapeo de activaci√≥n de clase</a> (CAM). <br><br><img src="https://habrastorage.org/webt/5e/_j/_x/5e_j_xaziz1xmlvkerszzc2xjxm.jpeg"><br><br>  Cuando la imagen se alimenta a la entrada de la red neuronal, luego en la pen√∫ltima capa, se obtiene una "imagen" reducida (en realidad el tensor de activaci√≥n) con los signos m√°s importantes para cada clase predicha.  Usando el m√©todo CAM, puede cambiar las √∫ltimas capas para que la salida sea la probabilidad de cada clase en cada regi√≥n.  Por ejemplo, si desea predecir 60 clases (pa√≠ses), para una imagen de entrada de 800 √ó 800, la imagen final consistir√° en 60 tarjetas de activaci√≥n de 25 √ó 25 de tama√±o. Esto se ilustra bien en la publicaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">original</a> . <br><br>  El diagrama anterior muestra el modelo habitual con GAP: las caracter√≠sticas espaciales se comprimen a un n√∫mero para cada canal (mapa de caracter√≠sticas), despu√©s de lo cual hay una capa completamente conectada que predice las clases que encuentran los pesos √≥ptimos para cada canal.  A continuaci√≥n se muestra c√≥mo cambiar la arquitectura para obtener el m√©todo CAM: se elimina la capa GAP y los pesos de la √∫ltima capa completamente conectada obtenida durante el entrenamiento con GAP (arriba en el diagrama) se utilizan para cada canal en cada punto.  Para cada imagen, se obtienen N mapas de activaci√≥n para todas las clases predichas.  Para cada pa√≠s, cuanto m√°s brillante sea el √°rea en el "mapa", mayor ser√° la contribuci√≥n de esta secci√≥n de la imagen a la decisi√≥n de elegir un determinado pa√≠s.  Lo que es interesante: si despu√©s de esta operaci√≥n promediamos cada mapa de activaci√≥n (en esencia, aplicamos GAP), entonces obtenemos solo la predicci√≥n inicial para cada clase. <br><br><img src="https://habrastorage.org/webt/i5/21/-i/i521-iavyhhn6bxnf_xpbfwjkvy.png"><br><br>  En la imagen, ver√° un mapa de activaci√≥n para la clase m√°s probable (seg√∫n el modelo).  Se obtuvo estirando el mapa de activaci√≥n 25 √ó 25 al tama√±o de la imagen original 800 √ó 800. <br><br><div class="spoiler">  <b class="spoiler_title">Otros ejemplos</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gy/7l/aq/gy7laq5f399atjwit-doxjarj_8.png"><br><img src="https://habrastorage.org/webt/s4/t1/hq/s4t1hqhmregz0f8xjgpsg6n721m.png"><br><img src="https://habrastorage.org/webt/_6/hz/h1/_6hzh1z6clmb7grbi5eesyo3_4k.png"><br><img src="https://habrastorage.org/webt/v0/zd/fd/v0zdfdpxpluft88d08hgmda2v7e.png"><br><img src="https://habrastorage.org/webt/sy/sf/on/sysfonqdv39cdp63ptmxv0w1_f4.png"><br><img src="https://habrastorage.org/webt/v-/o2/b3/v-o2b39ub3svzr504y0h57wos94.png"><br><img src="https://habrastorage.org/webt/on/09/cg/on09cgziwxi6ppgdxbtheoxehd4.png"><br><img src="https://habrastorage.org/webt/ti/8g/ki/ti8gkignbirkrsctvruho9-tl3g.png"><br></div></div><br>  Habiendo recibido un mapa para cada imagen, podemos agregar el cultivo m√°s importante para pa√≠ses de diferentes im√°genes.  Esto le permite ver la colecci√≥n de cultivos, describiendo el pa√≠s de la mejor manera. <br><br>  El segundo m√©todo, con el que decidimos comparar el primero, es una b√∫squeda exhaustiva simple.  ¬øQu√© sucede si tomamos un modelo entrenado en cultivos peque√±os (por ejemplo, 160 √ó 160 p√≠xeles) y predecimos cada pieza en una imagen grande de 800 √ó 800?  Al pasar una ventana deslizante que superpone cada √°rea de la imagen, obtenemos otra versi√≥n del mapa de activaci√≥n, que muestra la probabilidad de que cada parte de la imagen pertenezca a la clase del pa√≠s predicho. <br><br><img src="https://habrastorage.org/webt/vr/d0/ig/vrd0igxkijgsltioftiqregvjhw.png"><br><br>  La imagen se corta en peque√±os cropes con una superposici√≥n de 160 √ó 160. Para cada recorte, la red neuronal hace predicciones, el n√∫mero por encima del recorte es la probabilidad de pertenecer a la clase que el modelo finalmente predijo. <br><br><div class="spoiler">  <b class="spoiler_title">M√°s ejemplos</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/aj/zw/nd/ajzwndf0duu_djxkacgbx5fffbg.png"><br><img src="https://habrastorage.org/webt/_j/vk/ma/_jvkma67rsgmxjcgh_ht4t26u0e.png"><br><img src="https://habrastorage.org/webt/q5/uf/kj/q5ufkjpvlcut51tjvonfvz8oc-a.png"><br><img src="https://habrastorage.org/webt/be/al/av/bealavhehhhen23lv_gc-3nz3vi.png"><br></div></div><br>  Como en el primer m√©todo, nuevamente podemos elegir las piezas m√°s probables para cada pa√≠s.  Pero las im√°genes obtenidas por ambos m√©todos para el pa√≠s pueden ser uniformes (por ejemplo, un edificio desde diferentes √°ngulos o una versi√≥n de la textura).  Por lo tanto, la mejor cosecha para el pa√≠s se agrupa adicionalmente, luego la mayor√≠a de las im√°genes similares se reunir√°n en un grupo.  Despu√©s de eso, ser√° suficiente tomar una foto de cada grupo con la m√°xima probabilidad: para cada pa√≠s habr√° tantas im√°genes como grupos especificados.  Hicimos clustering basado en las caracter√≠sticas obtenidas de la √∫ltima capa de clasificador.  La agrupaci√≥n aglomerativa en nuestro caso result√≥ ser la mejor. <br><br><img src="https://habrastorage.org/webt/01/bl/dt/01bldtbu2pk2tlegwiahkrfbyls.png"><br><br><div class="spoiler">  <b class="spoiler_title">China</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/0j/3t/e1/0j3te1fos-feivrx72damea3rdu.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Italia</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/tp/xa/hy/tpxahykascxpynkfngesl3mojsc.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Alemania</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q4/na/3e/q4na3ea9i6t_cm2kchkvst9yass.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Mexico</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jv/zc/hg/jvzchgdvxyigsmgujk8ydmqo4v4.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Los eeuu</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hy/t2/pb/hyt2pbota0isw955unsxnpn8wym.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Pavo</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/47/nk/mk/47nkmkhl0didrcmsimstecwo1ye.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Australia</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/z3/kg/br/z3kgbr5eqy6rfxbf23f-rcwljyo.png"><br></div></div><br>  Despu√©s de haber recibido una canalizaci√≥n bastante similar para los dos m√©todos, puede iterar sobre los par√°metros de los algoritmos para encontrar la combinaci√≥n √≥ptima.  Por ejemplo, seleccionamos el tama√±o del cultivo y nos decidimos por dos opciones: 160 y 256 p√≠xeles.  Los cultivos de menos de 160 dieron signos demasiado peque√±os, seg√∫n los cuales una persona a menudo no entiende lo que se representa.  Y recortar m√°s de 256 a veces conten√≠a varios objetos a la vez.  Es necesario seleccionar varios par√°metros en la etapa de agrupaci√≥n: la elecci√≥n del algoritmo principal, as√≠ como las caracter√≠sticas por las cuales se realiza la agrupaci√≥n.  Para muchas combinaciones de par√°metros, qued√≥ claro de inmediato que dan un cultivo insuficientemente "interesante".  Pero para seleccionar el algoritmo final, realizamos experimentos paralelos en Tolok para comprender qu√© opci√≥n, seg√∫n las personas, describe el pa√≠s espec√≠fico de manera m√°s "apropiada". <br><br>  Result√≥ ser poco intuitivo que un m√©todo m√°s simple para encontrar un recorte en la imagen (b√∫squeda normal) encuentra m√°s objetos "interesantes".  Esto puede deberse al hecho de que en el segundo m√©todo (enumeraci√≥n) la red neuronal no ve la parte vecina de la imagen, y en el m√©todo CAM, el entorno del punto afecta el resultado.  Como resultado, recibimos una visualizaci√≥n de las caracter√≠sticas de cada pa√≠s en modo autom√°tico. <br><br>  Entonces, ahora sabemos qu√© partes del marco son de importancia decisiva para la red neuronal, y podemos ver qu√© cay√≥ sobre ellas.  Por ejemplo, los Pa√≠ses Bajos reconocen una red neuronal por la combinaci√≥n de paredes de ladrillo oscuro y contornos de ventanas blancas, los Emiratos √Årabes Unidos, por rascacielos espec√≠ficos contra el fondo de palmeras e Ir√°n, por los arcos y adornos caracter√≠sticos en las fachadas. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/473056/">https://habr.com/ru/post/473056/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../473042/index.html">Pros y contras de Django</a></li>
<li><a href="../473044/index.html">C√≥mo crear capturas de pantalla efectivas para una aplicaci√≥n en App Store</a></li>
<li><a href="../473046/index.html">Olas, viento y fuerza de voluntad: c√≥mo la tableta resistente de Dell ayuda a los rusos a ganar regatas internacionales</a></li>
<li><a href="../473050/index.html">AMD obliga a Intel a reducir los precios no solo en los nuevos modelos de CPU, sino tambi√©n en los m√°s antiguos. Este es el comienzo de otra guerra de precios.</a></li>
<li><a href="../473054/index.html">WorldSkills final, desarrollo de soluciones de TI para empresas: qu√© es, c√≥mo fue y por qu√© los programadores de 1C ganaron all√≠</a></li>
<li><a href="../473058/index.html">Sergey Sinitsyn: ‚ÄúOSM es m√°s que solo dibujar casas o pistas. ¬°Estas son m√°s historias!</a></li>
<li><a href="../473062/index.html">User.js subjetivo para Mozilla Firefox y no solo</a></li>
<li><a href="../473064/index.html">L√°grimas b√°tavas, autos y Gorilla Glass: sobre algunos tipos de vidrio reforzado</a></li>
<li><a href="../473066/index.html">√Årboles de cuadrante y reconocimiento de colisi√≥n</a></li>
<li><a href="../473070/index.html">Redux - ¬°No es necesario! ¬øReemplazar con useContext y useReducer en React?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>