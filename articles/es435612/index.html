<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì¨ üñêüèæ ü§∂üèΩ ¬øConf√≠a en Codd o en sus instalaciones? üïù üë©üèæ‚Äçü§ù‚Äçüë©üèº üßì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Objetos almacenados sin dolor de cabeza: un ejemplo simple de trabajo con objetos Cach√© en ObjectScript y Python 

 Castillo Neuschwanstein 

 En juni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øConf√≠a en Codd o en sus instalaciones?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435612/"><h2>  Objetos almacenados sin dolor de cabeza: un ejemplo simple de trabajo con objetos Cach√© en ObjectScript y Python </h2><br><img src="https://habrastorage.org/webt/jb/ba/sp/jbbaspnh-olgr2ot_f2peelsifc.jpeg"><br>  <i>Castillo Neuschwanstein</i> <br><br>  En junio de 2020, exactamente 50 a√±os de almacenes de datos tabulares o, formalmente, un modelo de datos relacionales.  Aqu√≠ hay un documento oficial, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ese mismo art√≠culo famoso</a> .  Por lo cual le agradecemos al Dr. Edgar Frank Codd.  Y, por cierto, el modelo de datos relacionales est√° en la lista de Forbes de las innovaciones globales m√°s importantes de los √∫ltimos 100 a√±os. <br><br>  Por otro lado, curiosamente, Codd consider√≥ las bases de datos relacionales y el lenguaje SQL como una implementaci√≥n distorsionada de su teor√≠a.  Como gu√≠a, incluso desarroll√≥ 12 reglas que todo sistema de gesti√≥n de bases de datos relacionales debe cumplir (de hecho, son 13 reglas).  Y, en verdad, hoy, en el mundo, no puede encontrar DBMS que satisfagan al menos la "Regla 0" de Codd y, por lo tanto, nadie puede llamar a su DBMS 100% relacional :) Tal vez hay excepciones, ¬ødime? <br><a name="habracut"></a><br>  El modelo relacional no es muy complejo y se estudia a lo largo y ancho.  Incluso puede ser demasiado estudiado.  Mientras tanto, en este a√±o de 2019, tambi√©n celebraremos otro aniversario: exactamente hace 10 a√±os, el hashtag #NoSQL m√°s tarde sobre "no solo SQL" apareci√≥ en Twitter y comenz√≥ su r√°pida penetraci√≥n en la pr√°ctica de desarrollar modelos de bases de datos. <br><br>  ¬øPor qu√© una presentaci√≥n tan larga?  El hecho de que el universo de programaci√≥n consta de datos (y algoritmos, por supuesto), y la posici√≥n de monopolio del modelo relacional conduce, como es m√°s cort√©s decir, una conciencia dividida del programador.  Debido a que los objetos de trabajo en la cabeza del desarrollador (OOP tambi√©n es total, ¬øverdad?), Todas estas listas, colas, √°rboles, montones, diccionarios, hilos, etc., no son tablas. <br><br>  ¬øY si contin√∫a y recuerda la arquitectura de almacenamiento en el DBMS moderno?  Digamos directamente, nadie en su sano juicio almacena datos en forma de tablas.  Los desarrolladores de DBMS utilizan con mayor frecuencia variedades del √°rbol B (por ejemplo, en PostrgeSQL) o, mucho menos a menudo, almacenamiento basado en diccionario.  Por otro lado, las barricadas, desarrolladores que usan DBMS para almacenar, tambi√©n operan en mesas que no son.  Y esto obliga a los programadores a cerrar constantemente la brecha sem√°ntica con una torpe capa de datos intermedios.  Y, por lo tanto, causa tensi√≥n dicot√≥mica interna, molestias sist√©micas e insomnio de depuraci√≥n. <br><br>  Es decir, en resumen, hay una contradicci√≥n: empaquetamos los datos en objetos adecuados para la tarea, y al guardarlos debemos ocuparnos de algunas tablas. <br><br>  Desesperanza?  No :) Pero, ¬øqu√© pasa con el mapeo objeto-relacional, est√° en la gente com√∫n de ORM?  Dejemos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta guerra santa a Yegor Bugaenko</a> con sus camaradas.  Y toda esta historia del siglo pasado, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">seg√∫n el t√≠o Bob, no deber√≠a preocuparnos</a> . <br><br>  Por supuesto, vale la pena mencionar que la "bolsa con bytes" (Robert Martin "Pure Architecture") se puede serializar y soltar en un archivo o insertar en otra secuencia adecuada.  Pero, en primer lugar, nos limitar√° inmediatamente en el idioma, y ‚Äã‚Äãen segundo lugar, ahora solo nos preocuparemos por almacenarlos en el DBMS. <br><br>  Hay una agradable excepci√≥n a estos altibajos con las bolsas de bytes: el DBMS Intersystems Cach√© (y ahora la plataforma de datos InterSystems IRIS).  Este es probablemente el √∫nico DBMS en el mundo que no oculta lo obvio del desarrollador e incluso va m√°s all√°: lo libera a uno de pensar "c√≥mo almacenarlo todo correctamente".  Es suficiente decir que la clase contin√∫a con el g√©nero Persistente y el punto est√° en el sombrero, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">es decir, en los globales</a> (¬°no debe confundirse con las variables globales!). <br><br>  Se pueden almacenar todos los tipos de datos, incluidos los flujos de caracteres y binarios.  Aqu√≠ hay un ejemplo simple: <br><br><pre><code class="plaintext hljs">//       - // :      ,     ,     , ,   Class FW.Events Extends %Persistent { Property "My name" As %String; } //      //   ¬´¬ª  set haJS = ##class(FW.Events).%New() //   write haJS.%Id()</code> </pre> <br>  Adem√°s, y esto es maravilloso, puede comunicarse con objetos almacenados no solo en ObjectScript, nativo de Cach√©, sino tambi√©n en recuperarlos y guardarlos directamente en Python, Java, JavaScript, C ++, C #, Perl.  E incluso, oh horror :).  Tambi√©n es posible obtener informaci√≥n de los mismos objetos directamente a trav√©s de consultas SQL, y tambi√©n es posible llamar a sus propios m√©todos en los objetos.  M√°s precisamente, los m√©todos en este caso por s√≠ mismos (y la palabra m√°gica SqlProc) se convierten en procedimientos almacenados.  Toda la magia ya est√° bajo el cap√≥ del Cach√© DBMS. <br><blockquote>  ¬øC√≥mo obtener acceso de prueba gratuito a Intersystems Cach√© DBMS? <br>  ¬°Esto es absolutamente real, no importa lo que digan los idiomas malvados!  :) Puede descargar e instalar la versi√≥n completa de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cach√© para un</a> solo usuario <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> (deber√° registrarse de forma gratuita).  Las compilaciones est√°n disponibles para MacOS, Windows y Linux. </blockquote>  Es m√°s conveniente trabajar con c√≥digo ObjectScript y acceder directamente al servidor Cach√© DBMS (y tambi√©n a la plataforma InterSystems IRIS) utilizando el Atelier IDE, que est√° basado en Eclipse.  Todas las instrucciones de <a href="">descarga e instalaci√≥n</a> est√°n <a href="">aqu√≠</a> . <br><br>  Para quienes es m√°s conveniente y familiar, puede usar el c√≥digo Visual Studio c√≥modo y simple, que lo complementa con el complemento ObjectScript desarrollado por la comunidad. <br><br>  Y ahora algunos ejemplos pr√°cticos.  Intentemos crear un par de objetos relacionados y trabajar con ellos en ObjectScript y Python.  La integraci√≥n con otros idiomas se implementa de manera muy similar.  Python se elige por razones de "m√°xima afinidad" con ObjectScript: ambos lenguajes son programables, admiten OOP y no tienen una escritura fuerte :) <br><br>  Para obtener ideas a modo de ejemplo, recurrimos a los vigorosos proyectos de Khabarovsk (¬°no confundir con Khabrovsk!) Del "Marco de reuni√≥n".  El c√≥digo fuente ideol√≥gico se encuentra en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">github.com/Hajsru/framework-weekend</a> y nuestro c√≥digo fuente es m√°s bajo en el texto. <br><blockquote>  Un matiz importante para los usuarios de macOS.  Al iniciar los m√≥dulos de soporte para Python, debe recordar que debe especificar la ruta DYLD_LIBRARY_PATH al directorio donde instal√≥ Cach√©.  Por ejemplo, as√≠: <br>  export DYLD_LIBRARY_PATH = / application / Cache / bin: $ DYLD_LIBRARY_PATH <br>  Esto <a href="">se indica espec√≠ficamente</a> en la documentaci√≥n. </blockquote><h3>  Creamos clases almacenadas en ObjectScript </h3><br>  Entonces vamos.  Las clases en Cach√© ser√°n muy simples.  Puede prescindir de un IDE: copie el c√≥digo de clase directamente a trav√©s del portal de su instancia de la plataforma Cach√© (s√≠, Cach√© DBMS est√° lejos de ser solo un DBMS): Navegador del sistema&gt; Clases&gt; Importar (USUARIO del espacio de nombres). <br><br>  Despu√©s de guardar, los objetos aparecer√°n en los globos con nombres que coinciden con los nombres de las clases correspondientes.  Tambi√©n busque en el portal de administraci√≥n de Cach√©: Navegador del sistema&gt; Globals (USUARIO del espacio de nombres). <br><br><pre> <code class="plaintext hljs">//    , ,      Class FW.Event Extends %Persistent { Property title as %String; Property description as %String; Property date as %Date; Property visitors as list of FW.Attendee; } //    / Class FW.Attendee Extends %Persistent { Property name As %String; }</code> </pre><br><h3>  Acceso a objetos en Cach√© desde Python </h3><br>  Primero, con√©ctese a la base de datos Cach√© DBMS.  Repetimos como <a href="">en la documentaci√≥n</a> . <br><blockquote>  Solo un hecho √∫til para trabajar.  Gratis, tambi√©n es una versi√≥n de entrenamiento del Cach√© DBMS, que le permitir√° hacer todo lo que est√° disponible en la versi√≥n totalmente funcional, pero solo permite dos conexiones activas.  Por lo tanto, al mismo tiempo, no ser√° posible mantener una conexi√≥n desde el IDE e intentar ejecutar otro c√≥digo para interactuar con el servidor.  La soluci√≥n m√°s simple que se encuentra es cerrar el IDE mientras se ejecuta el c√≥digo Python. </blockquote><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   Cach√©    Python3 import intersys.pythonbind3 #    conn = intersys.pythonbind3.connection() conn.connect_now("localhost[1972]:USER","_SYSTEM","SYS", None) #    print ("conn = %d " % conn.handle) #     database = intersys.pythonbind3.database(conn)</span></span></code> </pre> <br>  Y ahora crearemos una base de datos de objetos de eventos de TI y sus participantes.  Muy muy simple.  El primero es crear una clase para registrar y almacenar informaci√≥n sobre el participante del evento.  Para simplificar la clase, solo el nombre del miembro. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#         class Attendee: #        def __init__ (self): self.att = database.create_new("FW.Attendee", None) #             id def new (self, name): self.att.set("name", name) self.att.run_obj_method("%Save",[]) #    id     def use (self, id): self.att = database.openid("FW.Attendee",str(id),-1,-1) #       def clean (self): id = self.att.run_obj_method("%Id",[]) self.att.run_obj_method("%DeleteId", [id])</span></span></code> </pre><br>  Como puede ver, utilizamos funciones de contenedor listas para usar para m√©todos de acceso a los campos de objetos en Cach√©: set y en los par√°metros pasamos el nombre de la propiedad entre comillas y openid con el nombre del paquete y la clase.  Acerca de una funci√≥n get similar, hay ejemplos a continuaci√≥n.  Para acceder a cualquier otro m√©todo, incluidos los heredados por la clase de sus antepasados, use la funci√≥n run_obj_method () con el nombre del m√©todo y los par√°metros de llamada, si es necesario. <br><br>  La magia m√°s importante en la l√≠nea: self.att.run_obj_method ("% Save", []) <br>  As√≠ es como tenemos la capacidad de guardar objetos con referencia directa y sin la necesidad de usar bibliotecas y marcos adicionales, como los ORM ubicuos y desagradables. <br><br>  Adem√°s, dada la naturaleza orientada a objetos de ObjectScript, junto con los m√©todos de su clase (en nuestro ejemplo, no los hicimos), obtenemos una bonificaci√≥n del acceso de Python a todo el conjunto de m√©todos heredados de la clase Persistente y sus antepasados.  <a href="">Aqu√≠ est√° la lista completa</a> , si eso. <br><br>  Crea el primer miembro: <br><br><pre> <code class="python hljs">att = Attendee() att.new(<span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre><br>  Despu√©s de ejecutar este c√≥digo, aparecer√° un global en la base de datos con el nombre FW.AttendeeD y el contenido del objeto reci√©n guardado como en la captura de pantalla: <br><br><img src="https://habrastorage.org/webt/pg/rz/ck/pgrzckyjglh-k4knyfjbchwl_6y.png"><br><br>  Despu√©s de guardar, este objeto tiene su propia identificaci√≥n (con el n√∫mero 1).  Por lo tanto, puede cargarlo en nuestro programa usando esta identificaci√≥n: <br><br><pre> <code class="python hljs">att = Attendee() att.use(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (att.att.get(<span class="hljs-string"><span class="hljs-string">"name"</span></span>))</code> </pre><br>  Y ahora, nuevamente conociendo la identificaci√≥n, si es necesario, puede eliminar el objeto de la base de datos de participantes: <br><br><pre> <code class="python hljs">att = Attendee() att.use(<span class="hljs-number"><span class="hljs-number">1</span></span>) att.clean()</code> </pre><br>  Compruebe, despu√©s de ejecutar este ejemplo, el registro sobre el objeto debe desaparecer en el global.  Aunque los datos descargados a√∫n permanecen "en la memoria" de su objeto hasta que el programa finalice. <br><br>  Vamos a dar el siguiente paso.  Crea los registros de eventos reales. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        class Event: #        def __init__ (self): self.event = database.create_new("FW.Event", None) #            id def new (self, title, desc, date): self.event.set("title", title) self.event.set("description", desc) self.event.set("date", date) self.event.run_obj_method("%Save",[]) #    id    def use (self, id): self.event = database.openid("FW.Event",str(id),-1,-1) #       def addAttendee (self, att): eventAtt = self.event.get("visitors") eventAtt.run_obj_method("Insert", [att]) self.event.set("visitors", eventAtt) self.event.run_obj_method("%Save",[]) #      def clean (self): id = self.event.run_obj_method("%Id",[]) self.event.run_obj_method("%DeleteId", [id])</span></span></code> </pre><br>  La estructura de la clase es casi la misma que la anterior para el miembro de la clase.  Lo m√°s importante, ha aparecido un m√©todo para agregar participantes a la lista de participantes para este evento addAttendee (att). <br><br>  Intentamos crear un registro de objeto sobre un nuevo evento y guardarlo en la base de datos: <br><br><pre> <code class="python hljs">haJS = Event() haJS.new(<span class="hljs-string"><span class="hljs-string">"haJS"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"2019-01-19"</span></span>)</code> </pre><br>  Deber√≠a resultar algo como esto (tenga en cuenta que la fecha se convierte autom√°ticamente al formato ObjectScript y cuando se vuelve a cargar en el objeto Python, volver√° al formato original): <br><br><img src="https://habrastorage.org/webt/yk/vt/xh/ykvtxherbupxqtus54bsoz19exy.png"><br><br>  Queda por agregar al participante al evento: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     haJS = Event() haJS.use(1) #    att = Attendee() att.new("") #      haJS.addAttendee(att.att)</span></span></code> </pre><br>  Entonces, estos ejemplos muestran que no es necesario pensar al mismo tiempo sobre su modelo de datos y su esquema de almacenamiento tabular.  Puede usar herramientas m√°s obvias para sus tareas. <br><br>  Las instrucciones detalladas para conectar y usar Cach√© con Python y otros idiomas est√°n siempre <a href="">disponibles para usted en la documentaci√≥n</a> y en el portal de la comunidad de desarrolladores de InterSystems; esto no es menos de 5,000 miembros de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">community.intersystems.com</a> <br><blockquote>  Ayuda: InterSystems Cach√© multimodel DBMS sigue siendo el l√≠der mundial permanente en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bases de datos de objetos</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/webt/dg/zf/p_/dgzfp_-rxolw5x9zlt95sqip64q.png"></a> <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es435612/">https://habr.com/ru/post/es435612/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es435602/index.html">Preparaci√≥n del examen de Azure</a></li>
<li><a href="../es435604/index.html">BlaBlaCar se convirti√≥ en lo que no estaba destinado</a></li>
<li><a href="../es435606/index.html">¬øC√≥mo escribir pruebas unitarias para actores? Enfoque de SObjectizer</a></li>
<li><a href="../es435608/index.html">Pantallas de bricolaje</a></li>
<li><a href="../es435610/index.html">Huevos de Pascua para ZX Spectrum - en el √°lbum de m√∫sica y pel√≠cula</a></li>
<li><a href="../es435614/index.html">Rust News # 4 (diciembre de 2018)</a></li>
<li><a href="../es435616/index.html">C√≥mo la zonificaci√≥n entre pares simplific√≥ nuestras vidas y ayud√≥ a equilibrar la carga de EMC VPLEX</a></li>
<li><a href="../es435618/index.html">Mi experiencia de preparaci√≥n para el empleo en Google</a></li>
<li><a href="../es435620/index.html">Las ideas de futur√≥logos que se hicieron realidad</a></li>
<li><a href="../es435624/index.html">Una selecci√≥n de informes interesantes de la Conferencia 35C3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>