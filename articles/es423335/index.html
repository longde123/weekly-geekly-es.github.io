<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∑üèº üõçÔ∏è ‚úäüèΩ C√≥mo superar el clic en Y. Direct y AdWords por 600 mil rublos al mes üâë üè¶ ü¶ñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En los √∫ltimos seis meses, hemos logrado derrotar el "clic" de nuestra publicidad contextual con un presupuesto de 1 mill√≥n de rublos por mes. 

 La c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo superar el clic en Y. Direct y AdWords por 600 mil rublos al mes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423335/">  En los √∫ltimos seis meses, hemos logrado derrotar el "clic" de nuestra publicidad contextual con un presupuesto de 1 mill√≥n de rublos por mes. <br><br>  La clave para derrotar el fraude fue el monitoreo por minuto del tr√°fico con notificaciones de cambios anormales y la desactivaci√≥n de anuncios problem√°ticos por API, y una serie de informes que reflejan la situaci√≥n en tiempo real. <br><br><img src="https://habrastorage.org/webt/ss/cg/tk/sscgtkndx4m1wahkipwk1ozgxwk.png"><br>  <font color="#7c8792">Figura 1. Gr√°fico del n√∫mero de visitantes por palabras clave por decaminas</font> <br><br><h2>  <font color="#3e6c9a">¬øC√≥mo sabes que est√°s siendo atacado?</font> </h2><br>  <b>Una de las primeras se√±ales de un "clic" de publicidad ser√° un aumento en el porcentaje de reembolsos por fraude en Yandex.Direct y AdWords.</b> <br><blockquote>  ‚ÄúEn Yandex Direct, los gastos por fraude se devuelven autom√°ticamente al saldo de la campa√±a publicitaria.  El n√∫mero de clics eliminados por el sistema antifraude se muestra en los informes "estad√≠sticas diarias" "estad√≠sticas generales" en la l√≠nea "clics no v√°lidos para todo el per√≠odo seleccionado". </blockquote>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ayuda J. Dirija "clics no v√°lidos"</a> . <br><br>  En AdWords, se puede habilitar la visualizaci√≥n del nivel de "clics no v√°lidos" en la pesta√±a "columnas": <br><br><img src="https://habrastorage.org/webt/kf/0y/sp/kf0ysp3nbfkov-ypcrfcc1sbmgw.png"><br>  <font color="#7c8792">Figura 2. Columnas personalizadas con un nivel de "clic no v√°lido" en AdWords</font> <br><br>  En nuestro caso, con un nivel promedio de " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clics no v√°lidos</a> " en Yandex. Directo ‚âà 10%, Yandex de repente comenz√≥ a devolver el 40% del presupuesto publicitario y, despu√©s de un mes, el 54%. <br><a name="habracut"></a><br>  <b>La siguiente se√±al de fraude es un aumento irrazonable en el n√∫mero de transiciones y cambios fuertes en los indicadores de comportamiento para varios grupos de anuncios.</b> <br><br>  Notamos que, para varias palabras clave que nunca tuvieron m√°s de 200 visitantes al d√≠a, aparecieron repentinamente picos de hasta 3.000 visitantes.  De hecho, el presupuesto, en los d√≠as de tales actividades, podr√≠a destinarse a una campa√±a publicitaria si no se deten√≠a a tiempo. <br><br><img src="https://habrastorage.org/webt/dy/dj/37/dydj375imemm0ytnqa6ttkesya8.png"><br>  <font color="#7c8792">Figura 3. Crecimiento de tr√°fico irrazonable para un grupo de anuncios en particular en Direct</font> <br><br><h2>  <font color="#3e6c9a">Yandex y Google no protegen contra el fraude</font> </h2><br>  Es suficiente leer la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">discusi√≥n sobre el nivel de fraude en la publicidad contextual</a> en el Direct Club oficial para asegurarse de que muchos anunciantes pierdan dinero debido al fraude. <br><br>  Google reconoce oficialmente los errores de su sistema de seguridad y proporciona a los anunciantes "Reclamaciones de reembolso" (retorno del presupuesto).  Seg√∫n las estad√≠sticas del servicio ClickSease, Google Ads devuelve un promedio del 12% del presupuesto publicitario. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥mo reembolsar parte del dinero por un clic a trav√©s de AdWords</b> <div class="spoiler_text">  Debe enviar una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">queja sobre "clics no v√°lidos"</a> a Adwords, despu√©s de lo cual se le reembolsar√° con ‚âà 12% del dinero gastado.  Adem√°s, el servicio ClickSease env√≠a autom√°ticamente a Google solicitudes similares de reembolso cada 2 meses. <br><br>  En nuestro caso, Google AdWords reconoci√≥ por primera vez el 18% de nuestro tr√°fico como " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">no v√°lido</a> " y devolvi√≥ el dinero por ellos, y cuando enviamos la queja de "reclamos de reembolso", Google reembols√≥ otro 13% del presupuesto. <br></div></div><br>  Yandex no reconoce la vulnerabilidad de sus propios filtros de protecci√≥n y las quejas sobre casos de fraude obvios, env√≠a una respuesta de plantilla de que el problema radica en el anunciante y su sitio. <br><br>  En nuestro caso, el porcentaje de "clics no v√°lidos" en el informe de Y. Direct nunca aument√≥ por encima del codiciado 50% para ninguna de las campa√±as publicitarias, incluso en los d√≠as de los arrebatos m√°s violentos, cuando el 80% del presupuesto "se fusion√≥" en el grupo de anuncios generalmente poco popular sin llamadas y aplicaciones. <br><br><img src="https://habrastorage.org/webt/6h/4u/ef/6h4uefov0nkyjh0n3wpuii9qb0q.png"><br>  <font color="#7c8792">Figura 4. El nivel de "clics no v√°lidos" en una de las campa√±as en Direct</font> <br><br><h2>  <font color="#3e6c9a">¬øQu√© nivel de ataque encontramos?</font> </h2><br>  El tr√°fico fraudulento se dirigi√≥ a cuatro l√≠neas comerciales en dos ciudades.  Cuando se conectan nuevas campa√±as publicitarias o se inician campa√±as detenidas, en unas pocas horas tambi√©n se les redistribuy√≥ el "clic". <br><br>  Click Fraud no estuvo vinculado al tiempo, y la redistribuci√≥n del presupuesto, por ejemplo, por la noche, no tuvo ning√∫n efecto: todav√≠a obtuvimos nuestro volumen de tr√°fico restante.  "Hacer clic" fue igualmente activo en el YAN, en la b√∫squeda de Yandex y en la Red de Display de Google. <br><br>  En el sitio, los robots simularon el comportamiento del usuario, navegaron a trav√©s de secciones del sitio, seleccionaron el texto, naturalmente desplazaron y movieron el cursor. <br><br><h2>  <font color="#3e6c9a">¬øHay remedios ya hechos?</font> </h2><br>  Todos los servicios de protecci√≥n contra el fraude de clics tienen solo una herramienta de lucha directa: esto es bloquear direcciones IP sospechosas o sitios de ubicaci√≥n en las campa√±as de Ya.Direct y AdWords. <br><br>  En caso de que se usen IP din√°micas en su contra, cualquier servicio de control de fraude de clics siempre estar√° un paso por detr√°s de los estafadores para bloquearlos por IP: el bot ya har√° varios clics en su anuncio cuando el servicio ponga en la lista negra esta IP y deja de mostrar anuncios en √©l.  Adem√°s, despu√©s de que el software fraudulento no pueda ver sus anuncios, simplemente cambiar√° la direcci√≥n IP, el ID de hardware y continuar√° sus acciones. <br><br>  Al atacar anuncios en la Red de Display de Google o en YAN, generalmente se utilizan varias ubicaciones, y los sistemas de protecci√≥n autom√°tica no pueden detectar sitios sospechosos para el bloqueo. <br><br>  Volvamos al bloqueo de IP: aqu√≠ llegamos a la parte m√°s interesante: si AdWords le permite bloquear hasta 500 direcciones IP, entonces <u>Yandex Direct puede bloquear solo 25 direcciones IP √∫nicas</u> por campa√±a publicitaria.  Esta peque√±a lista negra de direcciones IP ya no es relevante, ya que ahora puede comprar 500 direcciones IPv4 de forma segura por 10 mil rublos y eludir esta limitaci√≥n. <br><br>  Hay dos formas de protegerse de los "clics" de alto nivel: <br><br><ol><li>  aprenda a no mostrar anuncios a usuarios o bots fraudulentos, para lo cual necesita encontrar ciertos "patrones" en su comportamiento y caracter√≠sticas; <br></li><li>  detener temporalmente grupos de anuncios espec√≠ficos y palabras clave que se est√°n orientando. <br></li></ol><br><h2>  <font color="#3e6c9a">Cortar parte de la audiencia para salvar la mayor parte</font> </h2><br>  Si aprende a no mostrar publicidad de clics a bots o usuarios fraudulentos, entonces no podr√°n da√±ar. <br><br>  Siempre puede rastrear patrones similares de comportamiento y patrones, por ejemplo, que el fraude generalmente se ejecuta en Windows 7 de 5:00 a 9:00 en Mosc√∫, y establecer un ajuste de la oferta de -100% para un p√∫blico similar en todas las campa√±as publicitarias atacadas.  La funcionalidad de los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ajustes</a> de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">oferta en AdWords es</a> bastante extensa, lo que no se puede decir sobre los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ajustes en Yandex Direct</a> . <br><br><h3>  Estamos buscando patrones de fraude a trav√©s de los servicios de seguridad. </h3><br>  Para tener una idea de c√≥mo nos est√°n atacando exactamente y rastrear manualmente patrones en tr√°fico fraudulento, conectamos el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">servicio</a> antifraude ruso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ClickFrog</a> .  El producto ha sido conocido por todos desde hace mucho tiempo, popular en el entorno de CPA, etc. <br><br>  ClickFrog demostr√≥ r√°pidamente una discapacidad completa: <br><br><ol><li>  por d√≠a asignado no m√°s de 40 direcciones IP sospechosas, con tr√°fico de Direct a 3.000 mil clics por d√≠a e, incluso reconocido por Yandex, 1300 clics "izquierdos" por d√≠a; <br></li><li>  la herramienta principal para proteger el servicio es el bloqueo por direcci√≥n IP, cuyo comando se env√≠a a trav√©s de API a J. Direct, sin embargo, tan pronto como se complete la lista negra de 25 direcciones IP, debe eliminar manualmente las √∫ltimas IP en cada campa√±a publicitaria y esperar a que se complete la siguiente lista, y Entonces en un c√≠rculo. <br></li></ol><br>  Luego, instalamos el c√≥digo para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ClickSease</a> , un servicio estadounidense dirigido a AdWords y que a√∫n no funciona con Yandex.Direct.  El servicio, por cierto, tiene, a diferencia de ClickFrog, un per√≠odo de prueba gratuito de 2 semanas. <br><br>  ClickSease result√≥ ser m√°s √∫til: comenz√≥ a capturar 300-400 IP fraudulentas √∫nicas por d√≠a.  Para cada servicio de IP bloqueado da estad√≠sticas: <br><br><ul><li>  Proveedor de servicios de internet </li><li>  la plataforma desde la cual ocurri√≥ la transici√≥n; </li><li>  sistema operativo </li><li>  ID de dispositivo √∫nico </li><li>  tiempo de la primera y √∫ltima transici√≥n; </li><li>  regi√≥n </li></ul><br>  Del informe ClickSease, pudimos identificar patrones en el fraude: <br><ul><li>  en el 81% de los casos, el dispositivo simula un sistema operativo m√≥vil: Android o iOS; </li><li>  En el 59% de los casos, la geolocalizaci√≥n de la direcci√≥n IP no se aplica a Mosc√∫, con fraude dirigido a Mosc√∫. </li></ul><br><h3>  Buscando patrones en fraude manualmente </h3><br>  Sin embargo, incluso estos patrones obvios no fueron suficientes para reducir el da√±o causado por el fraude, y no quer√≠a desactivar los anuncios m√≥viles.  Los servicios generalmente solo pueden dar ideas para identificar patrones similares en fraude, y luego debe detectar el fraude en Metric (en caso de un ataque directo) y seleccionarlo en un segmento separado de Yandex Audience para su posterior an√°lisis y bloqueo. <br><br><img src="https://habrastorage.org/webt/p3/op/ya/p3opya9dpzuhirhhz0_wfdeywf8.png"><br>  <font color="#7c8792">Figura 5. Un ejemplo de an√°lisis de tr√°fico por grupos de edad en la m√©trica para buscar patrones de fraude</font> <br><br>  Tramos de tr√°fico para ayudar a identificar patrones de fraude: <br><ul><li>  din√°mica de audiencia por grupos de edad; </li><li>  din√°mica de los intereses a largo plazo de los usuarios; </li><li>  dispositivo y din√°mica del sistema operativo. </li></ul><br>  <b>En el caso de AdWords, la mec√°nica de la acci√≥n contraria es clara:</b> <br><br><ol><li>  definimos un segmento de audiencia "infectado" con fraude; </li><li>  Establecemos ajustes de la oferta de -100% para el segmento seleccionado; </li><li>  Monitoreamos los cambios en los indicadores: conversi√≥n, tiempo en el sitio, profundidad de visualizaci√≥n, tasa de rebote. </li></ol><br>  <b>En Yandex Direct, la mec√°nica de la lucha es m√°s compleja y se divide en dos opciones:</b> <br><br>  a) logr√≥ encontrar un patr√≥n de fraude obvio relacionado con el g√©nero, la edad o la movilidad: <br><br><ol><li>  establecemos un ajuste de la oferta de -50% o -100% para el segmento seleccionado; </li><li>  Monitoreamos el cambio en los indicadores clave. </li></ol><br>  b) no se encontraron patrones obvios: <br><br><ol><li>  seleccionamos tr√°fico fraudulento en un segmento separado de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Yandex.Audience</a> (por ejemplo, sab√≠a que del 1 de octubre al 20 de octubre no pod√≠a haber 5,000 clics en un grupo de anuncios, que siempre ten√≠a no m√°s de 30 visitas por d√≠a) </li><li>  A trav√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de Yandex,</a> creamos un segmento de usuarios similar a nuestro fraude; </li><li>  establecer un ajuste de la oferta de -100% para un segmento de audiencia creado manualmente; </li><li>  Probamos cuidadosamente la reducci√≥n en las tarifas publicitarias para los segmentos creados por Yandex. </li></ol><br><h2>  <font color="#3e6c9a">Cree gr√°ficos que muestren fraude</font> </h2><br>  <b>El fraude siempre genera focos y picos obvios</b> , ya sea software abstruso con una imitaci√≥n del comportamiento de un usuario real o de un grupo de aut√≥nomos que realizan la tarea t√©cnica. <br><br><img src="https://habrastorage.org/webt/go/o2/al/goo2alj10gtzlycltq5rje0hoji.png"><br>  <font color="#7c8792">Figura 6. Gr√°fico del n√∫mero de visitantes por palabras clave por decaminas</font> <br><br>  El fraude ocurre de manera desigual por varias razones: <br><ul><li>  Para "suavizar" el ataque, debe tener informaci√≥n confidencial y saber qui√©n, cu√°ndo y cu√°ntos clics hacen sus anuncios; </li><li>  el software act√∫a de manera brusca, y en el minuto, 10 minutos y, a veces, en el gr√°fico horario, sus acciones ser√°n sorprendentes; </li><li>  incluso si los "escolares" trabajan en su contra desde los tableros de anuncios, entonces act√∫an en una tarea espec√≠fica con un algoritmo, y las anomal√≠as generadas por ellos ser√°n f√°ciles de rastrear. </li></ul><br>  Si aprende a encontrar y eliminar r√°pidamente los focos, puede reducir significativamente el da√±o del fraude.  En nuestro caso, un signo obvio fue un aumento anormal en el n√∫mero de clics en publicidad contextual en 10 minutos espec√≠ficos o un minuto para algunas palabras clave. <br><br>  Para la visualizaci√≥n, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Google Data Studio es el</a> m√°s adecuado, ya que solo Analytics puede recopilar correctamente los datos desglosados ‚Äã‚Äãen el tiempo en 1 y 10 minutos, y Metrika, al generar informes sobre dekomints, proporciona indicadores incorrectos. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥mo construir gr√°ficos en 10 minutos, no por hora, en Google Data Studio</b> <div class="spoiler_text">  De forma predeterminada, en Analytics o Data Studio, no puede crear gr√°ficos por minuto o durante 10 minutos, pero esto se puede hacer de la siguiente manera en Date Studio: <br><br>  Paso 1. Edici√≥n de campo abierto <br><br><img src="https://habrastorage.org/webt/sy/y2/1v/syy21vr-evstitegmwu-ivqreh8.png"><br><br>  Paso 2. Cree copias de los siguientes campos: A√±o, Mes del a√±o, D√≠a del mes, Hora, Minuto y as√≠gneles un nombre, por ejemplo, A√±o (d√≠a), Mes del a√±o (d√≠a), etc.  Tambi√©n en los campos copiados, debe cambiar el Tipo del formato de hora y fecha a "n√∫mero" como se muestra en la figura. <br><br><img src="https://habrastorage.org/webt/zj/3a/a6/zj3aa66qqh0eq42cyc-ajbujxzm.png"><br>  <font color="#7c8792">Paso 2. Cambie el tipo del campo copiado de "fecha" a "n√∫mero"</font> <br><br>  Paso 3. Cree un nuevo campo en el que escribamos la siguiente f√≥rmula: A√±o (d√≠a) * 10000000 + Mes del a√±o (d√≠a) * 100000 + D√≠a del mes (d√≠a) * 1000 + Hora (d√≠a) * 10 + PISO (Minuto (d√≠a) / 10) <br><br><img src="https://habrastorage.org/webt/ud/mm/8o/udmm8oej5cb9ysefk3zpmka2rvs.png"><br>  <font color="#7c8792">Paso 3. Cree un campo calculado "Tiempo para 10 minutos"</font> <br><br>  Paso 4. Guardamos el campo creado, luego volvemos a la lista de todos los campos y encontramos nuestro nuevo campo "Tiempo por 10 minutos (decamenut)".  Es necesario cambiar su tipo de "N√∫mero" a "Fecha y hora" como se muestra en la figura, y luego asignar el tipo "N√∫mero" a este campo. <br><br><img src="https://habrastorage.org/webt/7f/bi/hh/7fbihh4hc4yss02cqsfra1ljfta.png"><br>  <font color="#7c8792">Paso 4. Cree un campo calculado "Tiempo para 10 minutos"</font> <br><br>  Paso 5. Cree un "Gr√°fico combinado" y configure nuestro nuevo campo "Tiempo para 10 minutos" como par√°metro, como se muestra en la figura.  Listo <br><br><img src="https://habrastorage.org/webt/rq/o5/hy/rqo5hybxbnptkakzlyrs4rclzqu.png"><br>  <font color="#7c8792">Paso 5. Crea un "cuadro combinado"</font> <br></div></div><br><br><h2>  <font color="#3e6c9a">Configurar notificaciones sobre los brotes de fraude</font> </h2><br>  Para no seguir todos los casos de fraude manualmente, hice un informe en Google Sheets, que actualiza los datos cada minuto y notifica el inicio del fraude. <br><br>  Hojas de c√°lculo de Google admite la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">API de informes principales</a> , a la que se puede acceder a trav√©s del Editor de secuencias de comandos en Hojas de c√°lculo. <br><br>  Paso 1. Vaya al editor de script para acceder a Analytics <br><br><img src="https://habrastorage.org/webt/fe/6t/r-/fe6tr-kjvklwxovqwutpmuvbvcc.png"><br>  <font color="#7c8792">Figura 7. Editor de scripts para acceder a la API de informes de Analytics Core a trav√©s de Google Tables</font> <br><br>  Paso 2. Escribimos una solicitud de API a Analytics para recibir datos sobre los indicadores necesarios (por ejemplo, el n√∫mero de usuarios que hicieron clic en publicidad paga en cada minuto del d√≠a, como en nuestro caso). <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de Google Script para solicitar datos de Analytics en Hojas de c√°lculo de Google</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runDemo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstProfile = getFirstProfile(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> results = getReportDataForProfile(firstProfile); outputToSpreadsheet(results); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error) { Browser.msgBox(error.message); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFirstProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> accounts = Analytics.Management.Accounts.list(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (accounts.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstAccountId = accounts.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>].getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> webProperties = Analytics.Management.Webproperties.list(firstAccountId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (webProperties.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstWebPropertyId = webProperties.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>].getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profiles = Analytics.Management.Profiles.list(firstAccountId, firstWebPropertyId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (profiles.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstProfile = profiles.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> firstProfile; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No views (profiles) found.'</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No webproperties found.'</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No accounts found.'</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReportDataForProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">firstProfile</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profileId = firstProfile.getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tableId = <span class="hljs-string"><span class="hljs-string">'ga:'</span></span> + profileId; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startDate = <span class="hljs-string"><span class="hljs-string">"today"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// getLastNdays(14)  2 weeks (a fortnight) ago. var endDate = "today"; //getLastNdays(0)  Today. var optArgs = { 'dimensions': 'ga:date,ga:hour,ga:minute,ga:sourceMedium', // Comma separated list of dimensions. 'sort': 'ga:date,ga:hour,ga:minute', // Sort by sessions descending, then keyword. //'segment': 'dynamic::ga:isMobile==Yes', // Process only mobile traffic. 'filters': 'ga:sourceMedium==yandex / cpc', 'start-index': '1', 'max-results': '10000' // Display the first 250 results. }; // Make a request to the API. var results = Analytics.Data.Ga.get( tableId, // Table id (format ga:xxxxxx). startDate, // Start-date (format yyyy-MM-dd). endDate, // End-date (format yyyy-MM-dd). 'ga:users', // Comma seperated list of metrics. optArgs); if (results.getRows()) { return results; } else { throw new Error('No views (profiles) found'); } } function getLastNdays(nDaysAgo) { var today = new Date(); var before = new Date(); before.setDate(today.getDate() - nDaysAgo); return Utilities.formatDate(before, 'GMT', 'yyyy-MM-dd'); } function outputToSpreadsheet(results) { var sheets = SpreadsheetApp.getActiveSpreadsheet(); var sheet = sheets.getSheetByName("coeff1"); var range = sheet.getRange('A:E'); range.clear(); // Print the headers. var headerNames = []; for (var i = 0, header; header = results.getColumnHeaders()[i]; ++i) { headerNames.push(header.getName()); } sheet.getRange(1, 1, 1, headerNames.length) .setValues([headerNames]); // Print the rows of data. sheet.getRange(2, 1, results.getRows().length, headerNames.length) .setValues(results.getRows()); }</span></span></code> </pre> <br></div></div><br><br>  Paso 3. Configuramos el disparador para actualizar los datos cada minuto: <br><br><img src="https://habrastorage.org/webt/bu/-f/lq/bu-flq0ftubu0wa1lcqxw1uilz0.png"><br>  <font color="#7c8792">Figura 8. Solicitamos nuevos datos cada minuto para una respuesta r√°pida al fraude</font> <br><br>  Paso 4. Creamos una tabla din√°mica a partir de la hoja actualizada con los datos necesarios una vez por minuto, y analizamos estos indicadores para configurar disparadores para notificaciones por correo electr√≥nico o deshabilitar grupos de anuncios utilizando la API Yandex.Direct o AdWords. <br><br><img src="https://habrastorage.org/webt/ha/ba/-g/haba-goptrqk9xjgxrge_wjqqjs.png" alt="imagen">  <font color="#7c8792">Figura 9. Un ejemplo de configuraci√≥n de f√≥rmulas para notificaciones de anomal√≠as</font> <br><br><div class="spoiler">  <b class="spoiler_title">Un ejemplo de mi c√≥digo de Google Script para enviar notificaciones por correo electr√≥nico</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ss = SpreadsheetApp.getActiveSpreadsheet(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sheet = ss.getSheetByName(<span class="hljs-string"><span class="hljs-string">"notification"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = sheet.getRange(<span class="hljs-string"><span class="hljs-string">"D2:E4"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// The row and column here are relative to the range // getCell(1,1) in this code returns the cell at B2, B2 var cell = range.getCell(1, 2); Logger.log(cell.getValue()); if (cell.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell.getValue(), "Check me "+range.getCell(1, 1).getValue()); } else { } var cell2 = range.getCell(2, 2); Logger.log(cell2.getValue()); if (cell2.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell2.getValue(), "Check me "+range.getCell(2, 1).getValue()); } else { } var cell3 = range.getCell(3, 2); Logger.log(cell3.getValue()); if (cell3.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell3.getValue(), "Check me "+range.getCell(3, 1).getValue()); } else { } }</span></span></code> </pre> <br></div></div><br><h2>  <font color="#3e6c9a">En pocas palabras: c√≥mo vencer el clic</font> </h2><br>  La lucha contra el fraude de clics se puede dividir en tres grupos: <br><br>  a) Acciones proactivas: <br><ul><li>  cierre de "sitios contaminados"; </li><li>  Deshabilitar la publicidad para una audiencia con se√±ales de fraude para usted, por ejemplo, para personas que usan tabletas de San Petersburgo (se pueden usar par√°metros m√°s complejos para el bloqueo a trav√©s de listas de AdWords y segmentos m√©tricos); </li><li>  ajuste de la oferta para segmentos de audiencia similares a los segmentos de fraude (los segmentos "similares" se crean en Y. Audiencias y listas de Google); </li><li>  bloquee el fraude por las m√°scaras de red IP (disponible solo en AdWords). </li></ul><br>  b) Acciones preventivas: <br><ul><li>  Informar reembolsos de presupuesto a AdWords y Direct </li><li>  la investigaci√≥n de "qui√©n orden√≥ el ataque contra usted"; </li><li>  agrupaci√≥n de grupos de anuncios sospechosos y frecuentemente atacados en una sola campa√±a publicitaria; </li><li>  Las "trampas" para los bots m√°s simples, es decir, los botones ocultos en el sitio que solo son visibles para el bot y cuando se hace clic, se incluyen en la lista. </li></ul><br>  c) Acciones "Post factum": <br><ul><li>  bloqueo por direcciones IP; </li><li>  desconexi√≥n r√°pida de los centros de clics: palabras clave, grupos de anuncios, campa√±as publicitarias, segmentos de audiencia. </li></ul><br><img src="https://habrastorage.org/webt/lh/kt/qu/lhktquoljkgpshxr78ig6mspa4q.png" alt="imagen"><br>  <font color="#7c8792">Figura 10. Protecci√≥n contra el fraude de clics</font> <br><br>  <b>Enlaces utiles:</b> <b><br></b> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Biblioteca de</a> API de informes principales </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Explorador de consultas</a> para comandos de API de prueba convenientes; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Escribimos guiones para automatizar el trabajo con aplicaciones de Google</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Automatizar hojas de c√°lculo de Google</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Analytics Intelligence</a> , para preguntarle al bot de Analytics: - "¬øPero ha habido alguna anomal√≠a en el tr√°fico pagado durante el a√±o pasado?"  - y obtenga una respuesta clara. </li></ul><br><div class="spoiler">  <b class="spoiler_title">C√≥mo averiguar qui√©n orden√≥ el ataque a su anuncio</b> <div class="spoiler_text">  Cualquier competidor adecuado minimizar√° su da√±o al atacar a otros: <br><br><ol><li>  en primer lugar, el atacante intentar√° no mostrar su anuncio en las direcciones en que se est√° llevando a cabo el ataque en este momento, para no fusionar su CTR y aumentar su CPC; <br></li><li>  en segundo lugar, un competidor sin escr√∫pulos seleccionar√° tales palabras clave para el ataque, seg√∫n el cual puede dejar de mostrar sus anuncios sin causar mucho da√±o a s√≠ mismo. <br></li></ol><br>  En nuestro caso, el competidor tambi√©n comenz√≥ a hacer clic en fraude en 4 direcciones en dos ciudades, por lo que no fue dif√≠cil calcularlo. <br><br>  Para facilitar el an√°lisis de los competidores con los que se cruza, puede ver todos los anuncios de competidores incluidos para cada palabra clave en la interfaz Yandex.Direct: <br><br><img src="https://habrastorage.org/webt/w2/_t/4p/w2_t4p4zpj0imyxdogo7saha0sg.png"><br>  <font color="#7c8792">Figura 9. Todos los anuncios de la competencia por palabra clave</font> <br></div></div><br><br>  <b>Quien tambi√©n se enfrent√≥ al clic publicitario contextual: escriba en los comentarios, ¬°trataremos de ayudarnos mutuamente!</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es423335/">https://habr.com/ru/post/es423335/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es423317/index.html">¬øPor qu√© hombre Scala?</a></li>
<li><a href="../es423319/index.html">Integraci√≥n de c√≥digo Vivaldi. Nuestros desarrolladores cuentan</a></li>
<li><a href="../es423321/index.html">Proteger los repositorios de GitHub de confirmaciones maliciosas</a></li>
<li><a href="../es423323/index.html">"Necesitas ser flojo para convertirte en un buen probador".</a></li>
<li><a href="../es423329/index.html">Prepar√°ndose para una entrevista con una empresa Big Five</a></li>
<li><a href="../es423337/index.html">¬øC√≥mo hacer amigos PHPstorm, xDebug y ramas remotas compiladas a trav√©s de Docker? Demasiado simple ...</a></li>
<li><a href="../es423339/index.html">¬øHay vida bajo Windows 98, primera parte? Sobre hardware</a></li>
<li><a href="../es423341/index.html">Bajo presi√≥n p√∫blica, Sony admiti√≥ que las obras de Bach no le pertenecen.</a></li>
<li><a href="../es423343/index.html">Los valores culturales hechos de pl√°stico comienzan a decaer</a></li>
<li><a href="../es423345/index.html">Soga de miedo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>