<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐พโ๐คโ๐จ๐ฝ ๐ฐ๏ธ ๐ ุฌุฑููุงู ุจูุชูุฑุด ๐ด๐พ ๐ต๐พ ๐คช</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ูุง ูุจุฑ! 

 ูุฏููุง ูุจู ุทูุจ ูุชุงุจ ุทุงู ุงูุชุธุงุฑู ุญูู ููุชุจุฉ PyTorch . 



 ูุธุฑูุง ูุฃูู ุณุชุชุนูู ูู ุงูููุงุฏ ุงูุฃุณุงุณูุฉ ุงูุถุฑูุฑูุฉ ุญูู PyTorch ูู ูุฐุง ุงููุชุงุจ ุ ูุฅู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฌุฑููุงู ุจูุชูุฑุด</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/471228/" style=";text-align:right;direction:rtl"> ูุฑุญุจุง ูุง ูุจุฑ! <br><br>  ูุฏููุง ูุจู ุทูุจ ูุชุงุจ ุทุงู ุงูุชุธุงุฑู ุญูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุชุจุฉ PyTorch</a> . <br><br><img src="https://habrastorage.org/webt/bt/am/vl/btamvlvzqw01qwk-_2mq08t-sh4.jpeg"><br><br>  ูุธุฑูุง ูุฃูู ุณุชุชุนูู ูู ุงูููุงุฏ ุงูุฃุณุงุณูุฉ ุงูุถุฑูุฑูุฉ ุญูู PyTorch ูู ูุฐุง ุงููุชุงุจ ุ ูุฅููุง ูุฐูุฑู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจููุงุฆุฏ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนูููุฉ</a> ุชุณูู "grokking" ุฃู "ุงูููู ุงููุชุนูู" ููููุถูุน ุงูุฐู ุชุฑูุฏ ุชุนููู.  ูู ููุดูุฑ ุงูููู ุ ุณูุฎุจุฑู ููู ุงูุชูุฏ ูุงู ุฃุฑูููููุงุฑุงู PyTorch (ุจุฏูู ุตูุฑุฉ).  ูุฑุญุจุง ุจูู ูู ุงููุท. <br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PyTorch</a> ูู ุฅุทุงุฑ ุชุนูู ุนููู ููุฑู ูููุฒ ุชููุงุฆููุง ุจูู ุงููุงุฆูุงุช ุงูุชู ุชุณุชุฎุฏู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุฏููุงููููุฉ (ุฃู ุ ุงูุดุจูุงุช ุงูุชู ุชุณุชุฎุฏู ุงูุชุญูู ุงูุฏููุงูููู ูู ุงูุชุฏูู ุ ูุซู <code>if</code> ู <code>if</code> <code>while</code> ุญููุงุช).  ุชุฏุนู PyTorch ุชุณุฑูุน GPU <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุชุฏุฑูุจ ุงูููุฒุน</a> ูุฃููุงุน ูุฎุชููุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชุญุณูู</a> ูุงูุนุฏูุฏ ูู ุงูููุฒุงุช ุงูุฑุงุฆุนุฉ ุงูุฃุฎุฑู.  ุฃูุง ููุง ุทุฑุญุช ุจุนุถ ุงูุฃููุงุฑ ุญูู ููููุฉ ุงุณุชุฎุฏุงู PyTorch ูู ุฑุฃูู ุ  ูุง ุชุชู ุชุบุทูุฉ ุฌููุน ุฌูุงูุจ ุงูููุชุจุฉ ูุงูููุงุฑุณุงุช ุงูููุตู ุจูุง ููุง ุ ููููู ุขูู ุฃู ูููู ูุฐุง ุงููุต ูููุฏูุง ูู. <br><br>  ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูู ูุฆุฉ ูุฑุนูุฉ ูู ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุญุณุงุจูุฉ.  ุชุณุชูุจู ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุญุงุณูุจูุฉ ุงูุจูุงูุงุช ููุฏุฎูุงุช ุ ุซู ูุชู ุชูุฌูู ูุฐู ุงูุจูุงูุงุช (ููููู ุชุญููููุง) ูู ุงูุนูุฏ ุญูุซ ุชุชู ูุนุงูุฌุชูุง.  ูู ุงูุชุนูู ุงูุนููู ุ ุชููู ุงูุนุตุจ (ุงูุนูุฏ) ุนุงุฏุฉู ุจุชุญููู ุงูุจูุงูุงุช ุนู ุทุฑูู ุชุทุจูู ุงููุนููุงุช ูุงููุธุงุฆู ุงููุงุจูุฉ ููุชูููุฒ ุนูููุง ุ ุจุญูุซ ูููู ุชุญุณูู ุงููุนููุงุช ูุชูููู ุงูุฎุณุงุฆุฑ ูู ุฎูุงู ุทุฑููุฉ ุงููุณุจ ุงูุชุฏุฑุฌ.  ุจูุนูู ุฃูุณุน ุ ุฃูุงุญุธ ุฃู ุงูุฏูุงู ูููู ุฃู ุชููู ุนุดูุงุฆูุฉ ูุฏููุงููููุฉ ููุฑุณู ุงูุจูุงูู.  ูุจุงูุชุงูู ุ ุจูููุง ุชุชูุงูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุจุดูู ุฌูุฏ ูุน ูููุฐุฌ ุจุฑูุฌุฉ ุชุฏูู ุงูุจูุงูุงุช ุ ูุฑูุฒ PyTorch API ุนูู ูููุฐุฌ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุจุฑูุฌุฉ ุงูุถุฑูุฑู</a> ุ ููุฐู ุงูุทุฑููุฉ ูู ุชูุณูุฑ ุงูุจุฑุงูุฌ ุงูุชู ูุชู ุฅูุดุงุคูุง ูู ุฃูุซุฑ ุฏุฑุงูุฉ ุจูุซูุฑ.  ูุฐุง ูู ุงูุณุจุจ ูู ุฃู ููุฏ PyTorch ุฃุณูู ูู ุงููุฑุงุกุฉ ุ ููุง ุฃูู ูู ุงูุฃุณูู ุงูุญูู ุนูู ุชุตููู ุงูุจุฑุงูุฌ ุงููุนูุฏุฉ ุ ูุงูุชู ุ ูุน ุฐูู ุ ูุง ุชุชุทูุจ ุญู ูุณุท ุฎุทูุฑ ุนูู ุงูุฃุฏุงุก: ูู ุงููุงูุน ุ PyTorch ุณุฑูุนุฉ ุจูุง ููู ุงูููุงูุฉ ูุชููุฑ ุงูุนุฏูุฏ ูู ุงูุชุญุณููุงุช ุงูุชู ูุง ููููู ุ ููุณุชุฎุฏู ููุงุฆู ุ ุฃู ุชููู ุนูู ุงูุฅุทูุงู (ููุน ุฐูู ุ ุฅุฐุง ููุช ููุชููุง ุจูุง ุญููุง ุ ูููููู ุงูุจุญุซ ุจุนูู ุฃูุจุฑ ูุงูุชุนุฑู ุนูููุง). <br><br>  ูุง ุชุจูู ูู ูุฐู ุงูููุงูุฉ ูู ุชุญููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููุซุงู ุงูุฑุณูู ุนูู ูุฌููุนุฉ ุงูุจูุงูุงุช MNIST</a> .  ูุญู ููุง <i>ููุนุจ</i> PyTorch ุ ูุฐูู ุฃูุตู ุจููู ุงูููุงู ููุท ุจุนุฏ ุงูุชุนุฑู ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุฏูุฉ ุงููุจุชุฏุฆูู ุงูุฑุณููุฉ</a> .  ููุฑุงุญุฉ ุ ูุชู ุชูุฏูู ุงูุฑูุฒ ูู ุดูู ุฃุฌุฒุงุก ุตุบูุฑุฉ ูุฌูุฒุฉ ุจุงูุชุนูููุงุช ุ ุฃู ุฃูู ูุง ูุชู ุชูุฒูุนู ูู ูุธุงุฆู / ูููุงุช ูููุตูุฉ ุงุนุชุฏุช ุนูู ุฑุคูุชูุง ูู ููุฏ ูุนูุงุฑู ุฎุงูุต. <br><br><h4 style=";text-align:right;direction:rtl">  ูุงุฑุฏุงุช </h4><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">import argparse import os import torch from torch import nn, optim from torch.nn import functional as F from torch.utils.data import DataLoader from torchvision import datasets, transforms</code> </pre> <br>  ูู ูุฐู ูุงุฑุฏุงุช ููุงุณูุฉ ุชูุงููุง ุ ุจุงุณุชุซูุงุก ูุญุฏุงุช <code>torchvision</code> ุ ูุงูุชู ุชุณุชุฎุฏู ุจูุนุงููุฉ ุฎุงุตุฉ ูุญู ุงูููุงู ุงููุชุนููุฉ ุจุฑุคูุฉ ุงูููุจููุชุฑ. <br><br><h4 style=";text-align:right;direction:rtl">  ุชุนุฏูู </h4><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">parser = argparse.ArgumentParser(description=<span class="hljs-string"><span class="hljs-string">'PyTorch MNIST Example'</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--batch-size'</span></span>, type=int, default=<span class="hljs-number"><span class="hljs-number">64</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">'N'</span></span>, help=<span class="hljs-string"><span class="hljs-string">'input batch size for training (default: 64)'</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--epochs'</span></span>, type=int, default=<span class="hljs-number"><span class="hljs-number">10</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">'N'</span></span>, help=<span class="hljs-string"><span class="hljs-string">'number of epochs to train (default: 10)'</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--lr'</span></span>, type=float, default=<span class="hljs-number"><span class="hljs-number">0.01</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">'LR'</span></span>, help=<span class="hljs-string"><span class="hljs-string">'learning rate (default: 0.01)'</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--momentum'</span></span>, type=float, default=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">'M'</span></span>, help=<span class="hljs-string"><span class="hljs-string">'SGD momentum (default: 0.5)'</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--no-cuda'</span></span>, action=<span class="hljs-string"><span class="hljs-string">'store_true'</span></span>, default=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, help=<span class="hljs-string"><span class="hljs-string">'disables CUDA training'</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--seed'</span></span>, type=int, default=<span class="hljs-number"><span class="hljs-number">1</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">'S'</span></span>, help=<span class="hljs-string"><span class="hljs-string">'random seed (default: 1)'</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--save-interval'</span></span>, type=int, default=<span class="hljs-number"><span class="hljs-number">10</span></span>, metavar=<span class="hljs-string"><span class="hljs-string">'N'</span></span>, help=<span class="hljs-string"><span class="hljs-string">'how many batches to wait before checkpointing'</span></span>) parser.add_argument(<span class="hljs-string"><span class="hljs-string">'--resume'</span></span>, action=<span class="hljs-string"><span class="hljs-string">'store_true'</span></span>, default=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, help=<span class="hljs-string"><span class="hljs-string">'resume training from checkpoint'</span></span>) args = parser.parse_args() use_cuda = torch.cuda.is_available() <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> args.no_cuda device = torch.device(<span class="hljs-string"><span class="hljs-string">'cuda'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> use_cuda <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-string"><span class="hljs-string">'cpu'</span></span>) torch.manual_seed(args.seed) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> use_cuda: torch.cuda.manual_seed(args.seed)</code> </pre> <br>  <code>argparse</code> ูู ุงูุทุฑููุฉ ุงูููุงุณูุฉ ููุชุนุงูู ูุน ูุณูุทุงุช ุณุทุฑ ุงูุฃูุงูุฑ ูู Python. <br><br>  ุฅุฐุง ููุช ุจุญุงุฌุฉ ุฅูู ูุชุงุจุฉ ุชุนูููุงุช ุจุฑูุฌูุฉ ูุตููุฉ ููุนูู ุนูู ุฃุฌูุฒุฉ ูุฎุชููุฉ (ุจุงุณุชุฎุฏุงู ุชุณุฑูุน GPU ุ ุนูุฏ ุชููุฑูุง ุ ูููู ุฅุฐุง ูู ูุชู ุฅุฑุฌุงุนูุง ุฅูู ุงูุญูุณุจุฉ ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ) ุ ูุญุฏุฏ ูุญูุธ <code>torch.device</code> ุงูููุงุณุจ ุ ุญูุซ ููููู ุชุญุฏูุฏ ุงูููุงู ุงูุฐู ูุฌุจ ุนููู ูุชู ุชุฎุฒูู ุงูุชูุณูุฑุงุช.  ููุฒูุฏ ูู ุงููุนูููุงุช ุญูู ุฅูุดุงุก ูุซู ูุฐุง ุงูุฑูุฒ ุ ุฑุงุฌุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> .  ุชุชูุซู ุทุฑููุฉ PyTorch ูู ุฌูุจ ุงุฎุชูุงุฑ ุงูุฃุฌูุฒุฉ ุฅูู ุชุญูู ุงููุณุชุฎุฏู ุ ุงูุฃูุฑ ุงูุฐู ูุฏ ูุจุฏู ุบูุฑ ูุฑุบูุจ ููู ูู ุฃูุซูุฉ ุจุณูุทุฉ.  ููุน ุฐูู ุ ูุฅู ูุฐุง ุงูููุฌ ูุจุณุท ุงูุนูู ุฅูู ุญุฏ ูุจูุฑ ุนูุฏูุง ุชุถุทุฑ ุฅูู ุงูุชุนุงูู ูุน ุงูุชูุณูุฑุงุช ุ ูุงูุชู ุฃ) ููุงุฆูุฉ ููุชุตุญูุญ ุจ) ุชุชูุญ ูู ุงุณุชุฎุฏุงู ุงูุฃุฌูุฒุฉ ุจุดูู ูุนุงู ูุฏูููุง. <br><br>  ูู ุฃุฌู ุงุณุชูุณุงุฎ ุงูุชุฌุงุฑุจ ุ ุชุญุชุงุฌ ุฅูู ุชุนููู ููู ุฃูููุฉ ุนุดูุงุฆูุฉ ูุฌููุน ุงูููููุงุช ุงูุชู ุชุณุชุฎุฏู ุชูููุฏ ุงูุฃุฑูุงู ุงูุนุดูุงุฆูุฉ (ุจูุง ูู ุฐูู <code>random</code> ุฃู <code>numpy</code> ุ ุฅุฐุง ููุช ุชุณุชุฎุฏููุง <code>numpy</code> ).  ูุฑุฌู ููุงุญุธุฉ: ูุณุชุฎุฏู cuDNN ุฎูุงุฑุฒููุงุช ุบูุฑ ุญุชููุฉ ููุชู ุชุนุทููู ุงุฎุชูุงุฑููุง ุจุงุณุชุฎุฏุงู <code>torch.backends.cudnn.enabled = False</code> . <br><br><h4 style=";text-align:right;direction:rtl">  ูุนุทูุงุช </h4><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">data_path = os.path.join(os.path.expanduser(<span class="hljs-string"><span class="hljs-string">'~'</span></span>), <span class="hljs-string"><span class="hljs-string">'.torch'</span></span>, <span class="hljs-string"><span class="hljs-string">'datasets'</span></span>, <span class="hljs-string"><span class="hljs-string">'mnist'</span></span>) train_data = datasets.MNIST(data_path, train=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, download=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, transform=transforms.Compose([ transforms.ToTensor(), transforms.Normalize((<span class="hljs-number"><span class="hljs-number">0.1307</span></span>,), (<span class="hljs-number"><span class="hljs-number">0.3081</span></span>,))])) test_data = datasets.MNIST(data_path, train=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, transform=transforms.Compose([ transforms.ToTensor(), transforms.Normalize((<span class="hljs-number"><span class="hljs-number">0.1307</span></span>,), (<span class="hljs-number"><span class="hljs-number">0.3081</span></span>,))])) train_loader = DataLoader(train_data, batch_size=args.batch_size, shuffle=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, num_workers=<span class="hljs-number"><span class="hljs-number">4</span></span>, pin_memory=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) test_loader = DataLoader(test_data, batch_size=args.batch_size, num_workers=<span class="hljs-number"><span class="hljs-number">4</span></span>, pin_memory=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><br>  ูุธุฑูุง ูุฃู ููุงุฐุฌ <code>torchvision</code> ุชุฎุฒูููุง ุชุญุช <code>~/.torch/models/</code> ุ ุฃูุถู ุชุฎุฒูู <code>torchvision</code> torchvision ุชุญุช <code>~/.torch/datasets</code> .  ูุฐู ุงุชูุงููุฉ ุญููู ุงูุทุจุน ูุงููุดุฑ ุงูุฎุงุตุฉ ุจู ุ ููููุง ููุงุฆูุฉ ุฌุฏูุง ููุงุณุชุฎุฏุงู ูู ุงููุดุฑูุนุงุช ุงูุชู ุชู ุชุทููุฑูุง ุนูู ุฃุณุงุณ MNIST ู CIFAR-10 ุ ุฅูุฎ.  ุจุดูู ุนุงู ุ ูุฌุจ ุชุฎุฒูู ูุฌููุนุงุช ุงูุจูุงูุงุช ุจุดูู ูููุตู ุนู ุงูุฑูุฒ ุฅุฐุง ููุช ุชููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ูุฌููุนุงุช ุจูุงูุงุช ูุชุนุฏุฏุฉ. <br><br>  ูุญุชูู <code>torchvision.transforms</code> ุนูู ุงูุนุฏูุฏ ูู ุฎูุงุฑุงุช ุงูุชุญููู ุงููุฑูุญุฉ ููุตูุฑ ุงููุฑุฏูุฉ ุ ูุซู ุงูุงูุชุตุงุต ูุงูุชุทุจูุน. <br><br>  ููุงู ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุงุช ูู <code>batch_size</code> ุ ูููู ุจุงูุฅุถุงูุฉ ุฅูู <code>batch_size</code> ู <code>shuffle</code> ุ ูุฌุจ ุนููู ุฃูุถูุง ุฃู ุชุถุน ูู ุงูุงุนุชุจุงุฑ <code>num_workers</code> ู <code>pin_memory</code> ุ ููู ุชุณุงุนุฏ ูู ุฒูุงุฏุฉ ุงูููุงุกุฉ.  ูุณุชุฎุฏู <code>num_workers &gt; 0</code> ูุชุญููู ุงูุจูุงูุงุช ุบูุฑ ุงููุชุฒุงูู ุ ููุง ูููุน ุงูุนูููุฉ ุงูุฑุฆูุณูุฉ ููุฐุง.  ุญุงูุฉ ุงูุงุณุชุฎุฏุงู ุงููููุฐุฌู ูู ุชุญููู ุงูุจูุงูุงุช (ุนูู ุณุจูู ุงููุซุงู ุ ุงูุตูุฑ) ูู ุงููุฑุต ุ ูุฑุจูุง ุชุญููููุง ุ  ูู ูุฐุง ูููู ุงูููุงู ุจู ุจุงูุชูุงุฒู ุ ุฌูุจุง ุฅูู ุฌูุจ ูุน ูุนุงูุฌุฉ ุจูุงูุงุช ุงูุดุจูุฉ.  ูุฏ ููุฒู ุถุจุท ุฏุฑุฌุฉ ุงููุนุงูุฌุฉ ูู ุฃุฌู (ุฃ) ุชูููู ุนุฏุฏ ุงูุนูุงู ุ ูุจุงูุชุงูู ุ ูุฅู ูููุฉ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ูุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุงููุณุชุฎุฏูุฉ (ูููู ูู ุนุงูู ุจุชุญููู ูุฌููุนุฉ ูููุตูุฉ ุ ุจุฏูุงู ูู ุงูุนููุงุช ุงููุฑุฏูุฉ ุงููุฏุฑุฌุฉ ูู ุงููุฌููุนุฉ) ุจ) ุชูููู ุทูู ุงูููุช ุงูุฐู ุชูุชุธุฑู ุงูุจูุงูุงุช ุนูู ุงูุดุจูุฉ.  ูุณุชุฎุฏู <code>pin_memory</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฐุงูุฑุฉ ุงููุซุจุชุฉ</a> (ุจุฏูุงู ูู ุงูุตูุญุงุช) ูุชุณุฑูุน ุฃู ุนูููุงุช ููู ุจูุงูุงุช ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู ุฅูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช (ููุง ุชูุนู ุดูุฆูุง ูุน ุฑูุฒ ุฎุงุต ุจูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ). <br><br><h4 style=";text-align:right;direction:rtl">  ูููุฐุฌ </h4><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Net</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(nn.Module)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super(Net, self).__init__() self.conv1 = nn.Conv2d(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, kernel_size=<span class="hljs-number"><span class="hljs-number">5</span></span>) self.conv2 = nn.Conv2d(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, kernel_size=<span class="hljs-number"><span class="hljs-number">5</span></span>) self.conv2_drop = nn.Dropout2d() self.fc1 = nn.Linear(<span class="hljs-number"><span class="hljs-number">320</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>) self.fc2 = nn.Linear(<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x)</span></span></span><span class="hljs-function">:</span></span> x = F.relu(F.max_pool2d(self.conv1(x), <span class="hljs-number"><span class="hljs-number">2</span></span>)) x = F.relu(F.max_pool2d(self.conv2_drop(self.conv2(x)), <span class="hljs-number"><span class="hljs-number">2</span></span>)) x = x.view(<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">320</span></span>) x = F.relu(self.fc1(x)) x = self.fc2(x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> F.log_softmax(x, dim=<span class="hljs-number"><span class="hljs-number">1</span></span>) model = Net().to(device) optimiser = optim.SGD(model.parameters(), lr=args.lr, momentum=args.momentum) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> args.resume: model.load_state_dict(torch.load(<span class="hljs-string"><span class="hljs-string">'model.pth'</span></span>)) optimiser.load_state_dict(torch.load(<span class="hljs-string"><span class="hljs-string">'optimiser.pth'</span></span>))</code> </pre> <br>  ุชูุชุฏ ุชููุฆุฉ ุงูุดุจูุฉ ุนุงุฏุฉู ุฅูู ูุชุบูุฑุงุช ุงูุฃุนุถุงุก ุ ูุงูุทุจูุงุช ุงูุชู ุชุญุชูู ุนูู ูุนููุงุช ุงูุชุนูู ุ ูุฑุจูุง ูุนููุงุช ุงูุชุนูู ุงููุฑุฏูุฉ ูุงููุฎุงุฒู ุงููุคูุชุฉ ุบูุฑ ุงููุฏุฑุจุฉ.  ุจุนุฏ ุฐูู ุ ุจุงุณุชุฎุฏุงู ููุฑ ูุจุงุดุฑ ุ ูุชู ุงุณุชุฎุฏุงููุง ูุน ูุธุงุฆู ูู <code>F</code> ูุธูููุฉ ุจุญุชุฉ ููุง ุชุญุชูู ุนูู ูุนููุงุช.  ูุญุจ ุจุนุถ ุงูุฃุดุฎุงุต ุงูุนูู ูุน ุงูุดุจูุงุช ุงููุธูููุฉ ุงูุจุญุชุฉ (ูุซู ุงูุงุญุชูุงุธ ุจุงููุนููุงุช ูุงุณุชุฎุฏุงู <code>F.conv2d</code> ุจุฏูุงู ูู <code>nn.Conv2d</code> ) ุฃู ุงูุดุจูุงุช ุงูุชู ุชุชููู ุชูุงููุง ูู ุทุจูุงุช (ูุซู <code>nn.ReLU</code> ุจุฏูุงู ูู <code>F.relu</code> ). <br><br>  <code>.to(device)</code> ูู ูุณููุฉ ููุงุฆูุฉ ูุฅุฑุณุงู ูุนููุงุช ุงูุฌูุงุฒ (ูุงููุฎุงุฒู ุงููุคูุชุฉ) ุฅูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช ุฅุฐุง <code>device</code> ุถุจุท <code>device</code> ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช ุ ูุฃูู ุจุฎูุงู ุฐูู (ุฅุฐุง ุชู ุถุจุท ุงูุฌูุงุฒ ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ) ุ ููู ูุชู ุชูููุฐ ุฃู ุดูุก.  ูู ุงูููู ููู ุงููุนููุงุช ุงูุฌูุงุฒ ุฅูู ุงูุฌูุงุฒ ุงูููุงุณุจ ูุจู ุชูุฑูุฑูุง ุฅูู ูุญุณู.  ุฎูุงู ุฐูู ุ ูุฅู ุงููุญุณู ูู ูููู ูุงุฏุฑุง ุนูู ุชุชุจุน ุงููุนููุงุช ุจุดูู ุตุญูุญ! <br><br>  ูููู ููู ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ( <code>nn.Module</code> ) <code>nn.Module</code> ( <code>optim.Optimizer</code> ) ุญูุธ ูุชุญููู ุญุงูุชููุง ุงูุฏุงุฎููุฉ ุ ููู ุงููุณุชุญุณู ุงูููุงู ุจุฐูู ูุน <code>.load_state_dict(state_dict)</code> - ูู ุงูุถุฑูุฑู ุฅุนุงุฏุฉ ุชุญููู ุญุงูุฉ ูููููุง ูู ุฃุฌู ุงุณุชุฆูุงู ุงูุชุฏุฑูุจ ุงุณุชูุงุฏูุง ุฅูู ุงูููุงููุณ ุงููุญููุธุฉ ูุณุจููุง ุงูุฏูู.  ูุฏ ูููู ุญูุธ ุงููุงุฆู ุจุฃูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญููููุง ุจุงูุฃุฎุทุงุก</a> .  ุฅุฐุง ููุช ุจุญูุธ ุงูุชูุณูุฑุงุช ุนูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช ูุชุฑุบุจ ูู ุชุญููููุง ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุฃู ูุญุฏุฉ ูุนุงูุฌุฉ GPU ุฃุฎุฑู ุ ูุฅู ุฃุณูู ุทุฑููุฉ ูู ุชุญููููุง ูุจุงุดุฑุฉ ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎูุงุฑ</a> <code>map_location</code> ุ ูุซู <code>torch.load('model.pth'</code> ุ <code>map_location='cpu'</code> ). <br><br>  ูููุง ููู ุจุนุถ ุงูููุงุท ุงูุฃุฎุฑู ุงูุชู ูุง ุชุธูุฑ ููุง ุ ูููู ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ููููู ุงุณุชุฎุฏุงู ุชุฏูู ุงูุชุญูู ุจุชูุฑูุฑ ูุจุงุดุฑ (ุนูู ุณุจูู ุงููุซุงู ุ ูุฏ ูุนุชูุฏ ุชูููุฐ <code>if</code> ุนูู ูุชุบูุฑ ุงูุนุถู ุฃู ุนูู ุงูุจูุงูุงุช ููุณูุง. ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ุงูููุจูู ุชูุงููุง ุงูุฅุฎุฑุงุฌ ูู ููุชุตู ุงูุนูููุฉ ( <code>print</code> ) ุงูุชูุณูุฑุงุช ุ ููุง ูุจุณุท ุนูููุฉ ุงูุชุตุญูุญ ุฅูู ุญุฏ ูุจูุฑ. ุฃุฎูุฑูุง ุ ุจุงุณุชุฎุฏุงู ุชูุฑูุฑ ูุจุงุดุฑ ุ ูููู ุงุณุชุฎุฏุงู ุงููุซูุฑ ูู ุงูุญุฌุฌ. ุณุฃูุถุญ ูุฐู ุงูููุทุฉ ูู ุฎูุงู ูุงุฆูุฉ ูุฎุชุตุฑุฉ ูุง ุชุฑุชุจุท ุจุฃู ููุฑุฉ ูุนููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forward</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, hx, drop=False)</span></span></span><span class="hljs-function">:</span></span> hx2 = self.rnn(x, hx) print(hx.mean().item(), hx.var().item()) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> hx.max.item() &gt; <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> self.can_drop <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> drop: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hx <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> hx2</code> </pre> <br><h4 style=";text-align:right;direction:rtl">  ุชุฏุฑูุจ </h4><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.train() train_losses = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, (data, target) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(train_loader): data = data.to(device=device, non_blocking=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) target = target.to(device=device, non_blocking=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) optimiser.zero_grad() output = model(data) loss = F.nll_loss(output, target) loss.backward() train_losses.append(loss.item()) optimiser.step() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> i % <span class="hljs-number"><span class="hljs-number">10</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span>: print(i, loss.item()) torch.save(model.state_dict(), <span class="hljs-string"><span class="hljs-string">'model.pth'</span></span>) torch.save(optimiser.state_dict(), <span class="hljs-string"><span class="hljs-string">'optimiser.pth'</span></span>) torch.save(train_losses, <span class="hljs-string"><span class="hljs-string">'train_losses.pth'</span></span>)</code> </pre> <br>  ูุชู ูุถุน ูุญุฏุงุช ุงูุดุจูุฉ ูู ูุถุน ุงูุชุฏุฑูุจ ุจุดูู ุงูุชุฑุงุถู - ููุง ูุคุซุฑ ุฅูู ุญุฏ ูุง ุนูู ุชุดุบูู ุงููุญุฏุงุช ุ ูุงูุฃูู ูู ุฐูู ููู - ุชุฑูู ูุชุทุจูุน ุงูุฏููุนุฉ.  ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุ ูู ุงูุฃูุถู ุชุนููู ูุซู ูุฐู ุงูุฃุดูุงุก ูุฏูููุง ุจุงุณุชุฎุฏุงู <code>.train()</code> ุ ูุงูุชู ุชููู ุจุชุตููุฉ ุนูุงูุฉ "ุงูุชุฏุฑูุจ" ุนูู ุฌููุน ุงููุญุฏุงุช ุงูุชุงุจุนุฉ. <br><br>  ููุง ุ ูุง ุชูุจู ุทุฑููุฉ <code>non_blocking=True</code> <code>.to()</code> ุงูุฌูุงุฒ ูุญุณุจ ุ ุจู ุชููู ุฃูุถูุง ุจุชุนููู <code>non_blocking=True</code> ุ ููุง ูุถูู ุงููุณุฎ ุบูุฑ ุงููุชุฒุงูู ููุจูุงูุงุช ุฅูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช ูู ุงูุฐุงูุฑุฉ ุงูููุชุฒูุฉ ุ ููุง ูุณูุญ ููุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุจุงูุจูุงุก ุฌุงูุฒุฉ ููุนูู ุฃุซูุงุก ููู ุงูุจูุงูุงุช ุ  ุฎูุงู ุฐูู ุ <code>non_blocking=True</code> ุจุจุณุงุทุฉ ููุณ ุฎูุงุฑูุง. <br><br>  ูุจู ุฅูุดุงุก ูุฌููุนุฉ ุฌุฏูุฏุฉ ูู ุงูุชุฏุฑุฌุงุช ุจุงุณุชุฎุฏุงู <code>loss.backward()</code> <code>optimiser.step()</code> ุจุงุณุชุฎุฏุงู <code>optimiser.step()</code> ุ ูุฌุจ ุฅุนุงุฏุฉ ุชุนููู ุชุฏุฑุฌุงุช ุงููุนููุงุช ูุฏูููุง ุฅูู ุงูุฃูุซููุฉ ุจุงุณุชุฎุฏุงู <code>optimiser.zero_grad()</code> .  ุจุดูู ุงูุชุฑุงุถู ุ ูููู PyTorch ุจุชุฌููุน ุงูุชุฏุฑุฌุงุช ุ ููู ููุงุณุจ ุฌุฏูุง ุฅุฐุง ูู ููู ูุฏูู ููุงุฑุฏ ูุงููุฉ ูุญุณุงุจ ุฌููุน ุงูุชุฏุฑุฌุงุช ุงูุชู ุชุญุชุงุฌูุง ูู ูุณุงุฑ ูุงุญุฏ. <br><br>  ูุณุชุฎุฏู PyTorch ูุธุงู "ุดุฑูุท" ูู ุงูุชุฏุฑุฌุงุช ุงูุชููุงุฆูุฉ - ููู ูุฌูุน ูุนูููุงุช ุญูู ุงูุนูููุงุช ูุจุฃู ุชุฑุชูุจ ุชู ุฅุฌุฑุงุคู ุนูู ุงูุชูุณูุฑุงุช ุ ุซู ูููู ุจุชุดุบูููุง ูู ุงูุงุชุฌุงู ุงููุนุงูุณ ูุฅุฌุฑุงุก ุชูุงูุฒ ุจุงูุชุฑุชูุจ ุงูุนูุณู (ุชูุงูุฒ ุงููุถุน ุงูุนูุณู).  ูุฐุง ูู ุงูุณุจุจ ูู ุฃููุง ูุงุฆูุฉ ุงููุฑููุฉ ูุชุชูุญ ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุญุณุงุจูุฉ ุงูุชุนุณููุฉ.  ุฅุฐุง ูู ููู ุฃู ูู ูุฐู ุงูุชูุณูุฑุงุช ูุชุทูุจ ุชุฏุฑุฌุงุช (ูุฌุจ ุนููู ุชุนููู <code>requires_grad=True</code> ุ ูุฅูุดุงุก ููุชุฑ ููุฐุง ุงูุบุฑุถ) ุ ููู ูุชู ุญูุธ ุฃู ุฑุณู ุจูุงูู!  ููุน ุฐูู ุ ุนุงุฏุฉ ูุง ุชุญุชูู ุงูุดุจูุงุช ุนูู ูุนููุงุช ุชุชุทูุจ ุชุฏุฑุฌุงุช ุ ูุฐูู ุณูุชู ุชุฎุฒูู ุฃู ุญุณุงุจุงุช ูุชู ุฅุฌุฑุงุคูุง ุนูู ุฃุณุงุณ ุฅุฎุฑุงุฌ ุงูุดุจูุฉ ูู ุงูุฑุณู ุงูุจูุงูู.  ูุฐูู ุ ุฅุฐุง ููุช ุชุฑุบุจ ูู ุญูุธ ุงูุจูุงูุงุช ุงููุงุชุฌุฉ ุนู ูุฐู ุงูุฎุทูุฉ ุ ูุณุชุญุชุงุฌ ุฅูู ุชุนุทูู ุงูุชุฏุฑุฌุงุช ูุฏูููุง ุฃู (ุทุฑููุฉ ุฃูุซุฑ ุดููุนูุง) ุ ูุญูุธ ูุฐู ุงููุนูููุงุช ูุฑูู Python (ุจุงุณุชุฎุฏุงู <code>.item()</code> ูู ุนุฏุฏ PyTorch) ุฃู ุตููู <code>numpy</code> .  ุงูุฑุฃ ุงููุฒูุฏ ุนู <code>autograd</code> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> . <br><br>  ุชุชูุซู ุฅุญุฏู ุทุฑู ุงุฎุชุตุงุฑ ุงูุฑุณู ุงูุจูุงูู ุงูุญุณุงุจู ูู ุงุณุชุฎุฏุงู <code>.detach()</code> ุนูุฏูุง ูุชู ุชูุฑูุฑ ุงูุญุงูุฉ ุงููุฎููุฉ ุนูุฏ ุชุนูู RNN ุจุฅุตุฏุงุฑ ููุชุทุน ูู backpropagation-through-time.  ููุง ุฃูู ููุงุณุจ ุนูุฏ ุงูุชูููุฒ ุจูู ุงูุฎุณุงุฆุฑ ุ ุนูุฏูุง ูููู ุฃุญุฏ ุงูููููุงุช ูู ุฅุฎุฑุงุฌ ุดุจูุฉ ุฃุฎุฑู ุ ูููู ูุง ููุจุบู ุชุญุณูู ูุฐู ุงูุดุจูุฉ ุงูุฃุฎุฑู ูููุง ูุชุนูู ุจุงูุฎุณุงุฆุฑ.  ุนูู ุณุจูู ุงููุซุงู ุ ุณุฃุฏุฑุณ ุงูุฌุฒุก ุงูุชูููุฒู ุนูู ุชูููุฏ ุงูููุงุฏ ุงููุงุชุฌุฉ ุนูุฏ ุงูุนูู ูุน GAN ุ ุฃู ุงูุชุฏุฑูุจ ุนูู ุงูุณูุงุณุฉ ูู ุฎูุงุฑุฒููุฉ ุงูููุซู ุงููุงูุฏ ุจุงุณุชุฎุฏุงู ุงููุธููุฉ ุงูููุถูุนูุฉ ูุฏุงูุฉ ุฃุณุงุณูุฉ (ุนูู ุณุจูู ุงููุซุงู ุ A2C).  ููุงู ุทุฑููุฉ ุฃุฎุฑู ุชููุน ุญุณุงุจ ุงูุชุฏุฑุฌุงุช ุ ููู ูุนุงูุฉ ูู ุชุฏุฑูุจ GAN (ุชุฏุฑูุจ ุงูุฌุฒุก <code>param.requires_grad = False</code> ุนูู ุงููุงุฏุฉ ุงูุชูููุฒูุฉ) ููููุฐุฌูุฉ ูู ุงูุถุจุท ุงูุฏููู ูู ุงูุชุนุฏุงุฏ ุงูุฏูุฑู ููุนููุงุช ุงูุดุจูุฉ ุงูุชู <code>param.requires_grad = False</code> . <br><br>  ูู ุงูููู ููุณ ููุท ุชุณุฌูู ุงููุชุงุฆุฌ ูู ููู ูุญุฏุฉ ุงูุชุญูู / ุงูุณุฌู ุ ูููู ุฃูุถูุง ุชุนููู ููุงุท ุงูุชุญูู ูู ูุนููุงุช ุงููููุฐุฌ (ูุญุงูุฉ ุงูููุญุณููู) ููุท ูู ุญุงูุฉ.  ููููู ุฃูุถูุง ุงุณุชุฎุฏุงู <code>torch.save()</code> ูุญูุธ ูุงุฆูุงุช Python ุงูุนุงุฏูุฉ ุ ุฃู ุงุณุชุฎุฏุงู ุญู ููุงุณู ุขุฎุฑ - <code>pickle</code> ุงููุฏูุฌ. <br><br><h4 style=";text-align:right;direction:rtl">  ุชุฌุฑูุจ </h4><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.eval() test_loss, correct = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> torch.no_grad(): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> data, target <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> test_loader: data = data.to(device=device, non_blocking=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) target = target.to(device=device, non_blocking=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) output = model(data) test_loss += F.nll_loss(output, target, reduction=<span class="hljs-string"><span class="hljs-string">'sum'</span></span>).item() pred = output.argmax(<span class="hljs-number"><span class="hljs-number">1</span></span>, keepdim=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) correct += pred.eq(target.view_as(pred)).sum().item() test_loss /= len(test_data) acc = correct / len(test_data) print(acc, test_loss)</code> </pre> <br>  ุงุณุชุฌุงุจุฉ ุฅูู <code>.train()</code> ูุฌุจ ูุถุน ุงูุดุจูุงุช ุจุดูู ุตุฑูุญ ูู ูุถุน ุงูุชูููู ุจุงุณุชุฎุฏุงู <code>.eval()</code> . <br><br>  ููุง ุฐูุฑ ุฃุนูุงู ุ ุนูุฏ ุงุณุชุฎุฏุงู ุดุจูุฉ ุ ูุชู ุชุฌููุน ุงูุฑุณู ุงูุจูุงูู ุงูุญุณุงุจู ุนุงุฏุฉ.  ูููุน ูุฐุง ุ ุงุณุชุฎุฏู <code>no_grad</code> ุงูุณูุงู <code>with torch.no_grad()</code> . <br><br><h4 style=";text-align:right;direction:rtl">  ุจุนุถ ุฃูุซุฑ </h4><br>  ูุฐุง ูุณู ุฅุถุงูู ุ ุตูุนุช ููู ุญูุฑูุงุช ุฃูุซุฑ ูุงุฆุฏุฉ. <br>  ุฅููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ ุงูุชู</a> ุชูุถุญ ููููุฉ ุงูุนูู ูุน ุงูุฐุงูุฑุฉ. <br><br>  ุฃุฎุทุงุก ููุฏุงุ  ูู ุงูุตุนุจ ุฅุตูุงุญูุง ุ ูุนุงุฏุฉู ูุง ุชููู ูุชุตูุงู ุจุชูุงูุถุงุช ููุทููุฉ ุ ุญูุซ ูุชู ุนุฑุถ ุฑุณุงุฆู ุฎุทุฃ ุฃูุซุฑ ููุทููุฉ ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ูู ูุญุฏุฉ ูุนุงูุฌุฉ ุงูุฑุณููุงุช.  ุฃูุถู ุดูุก ุ ุฅุฐุง ููุช ุชุฎุทุท ููุนูู ูุน GPU ุ ูููููู ุงูุชุจุฏูู ุจุณุฑุนุฉ ุจูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ู GPU.  ูุตูุญุฉ ุชุทููุฑ ุฃูุซุฑ ุนููููุฉ ูู ุชูุธูู ุงูููุฏ ุจุญูุซ ูููู ุงูุชุญูู ููู ุจุณุฑุนุฉ ูุจู ุจุฏุก ูููุฉ ูุงููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูู ุจุฅุนุฏุงุฏ ูุฌููุนุฉ ุจูุงูุงุช ุตุบูุฑุฉ ุฃู ุงุตุทูุงุนูุฉ ุ ููู ุจุฅุฌุฑุงุก ุงุฎุชุจุงุฑ ูุทุงุฑ + ุญูุจุฉ ูุงุญุฏุฉ ุ ุฅูุฎ.  ุฅุฐุง ูุงูุช ุงููุณุฃูุฉ ุฎุทุฃ CUDA ุ ุฃู ูุง ููููู ุงูุชุจุฏูู ุฅูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุนูู ุงูุฅุทูุงู ุ ูุงุถุจุท CUDA_LAUNCH_BLOCKING = 1.  ูุฐุง ุณูุฌุนู ููุงุฉ CUDA ุชุทูู ูุชุฒุงูู ุ ูุณุชุชููู ุฑุณุงุฆู ุฎุทุฃ ุฃูุซุฑ ุฏูุฉ. <br><br>  ููุงุญุธุฉ ุนูู <code>torch.multiprocessing</code> ุฃู ูุฌุฑุฏ ุชุดุบูู ูุตูุต PyTorch ูุชุนุฏุฏุฉ ูู ููุณ ุงูููุช.  ูุฃู PyTorch ูุณุชุฎุฏู ููุชุจุงุช BLAS ูุชุนุฏุฏุฉ ุงูุฎููุท ูุชุณุฑูุน ุญุณุงุจุงุช ุงูุฌุจุฑ ุงูุฎุทูุฉ ุนูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ ูุนุงุฏุฉ ูุง ุชุดุงุฑู ุงูุนุฏูุฏ ูู ุงูููู.  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงูููุงู ุจุนุฏุฉ ุฃุดูุงุก ูู ููุณ ุงูููุช ุ ุจุงุณุชุฎุฏุงู ุงููุนุงูุฌุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท ุฃู ุงูุนุฏูุฏ ูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ุ ููุฏ ูููู ูู ุงููุณุชุญุณู ุชูููู ุนุฏุฏูุง ูุฏูููุง ุนู ุทุฑูู ุชุนููู ูุชุบูุฑ ุงูุจูุฆุฉ <code>OMP_NUM_THREADS</code> ุฅูู 1 ุฃู ูููุฉ ููุฎูุถุฉ ุฃุฎุฑู.  ูุจุงูุชุงูู ุ ูุชู ุชูููู ุงุญุชูุงู ุงูุงูุฒูุงู ุงููุนุงูุฌ.  ุชุญุชูู ุงููุซุงุฆู ุงูุฑุณููุฉ ุนูู ุชุนูููุงุช ุฃุฎุฑู ุจุฎุตูุต ุงููุนุงูุฌุฉ ูุชุนุฏุฏุฉ ูุคุดุฑุงุช ุงูุชุฑุงุจุท. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar471228/">https://habr.com/ru/post/ar471228/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar471212/index.html">10 ูุตุงุฆุญ ูุญูู ููุณุงุนุฏุชู ุนูู ุฃู ุชุตุจุญ ุฃูุถู ูุทูุฑ ุนูู VueJS</a></li>
<li><a href="../ar471216/index.html">ุงูุชุงุฑูุฎ ุงูุทููู ููุฏููู - ููู ูุชุจุช ุฎุฏูุฉ ููุณุงุฑุงุช ุงููุดู ููุณุงูุงุช ุทูููุฉ ุงูุฐููุฉ ููุฏุฉ 5 ุณููุงุช</a></li>
<li><a href="../ar471220/index.html">ููุฑุฉ ุงูููุงุฏุฉ - ุชุจุณูุท ุงูููุงู ุงูุฅุฏุงุฑูุฉ ุงููููุฐุฌูุฉ ูู ููููุณ ูู ุฎูุงู ูุงุฌูุฉ ููุจ ูุฑูุญุฉ</a></li>
<li><a href="../ar471222/index.html">ุฅู ููู ุณูุงุณุงุช ุฎุตูุตูุฉ ุงูุชุทุจูู ูุงูุฎุฏูุฉ ุณูู ูุณุงุนุฏ ุงูุดุจูุงุช ุงูุนุตุจูุฉ</a></li>
<li><a href="../ar471226/index.html">ูุฏู Linux ุงูุนุฏูุฏ ูู ุงููุฌูู: ููููุฉ ุงูุนูู ุนูู ุฃู ุชูุฒูุน</a></li>
<li><a href="../ar471232/index.html">ุชุฌุฑุจุชู ูู ุฑุจุท LPS331AP ุจุฃูููุบุง Onion2</a></li>
<li><a href="../ar471236/index.html">ุงูุฌุฑุนุงุช ู Seryozha. ุงูุฌุฒุก ุงูุซุงูุซ. ูููุงุณ ุงูุฅุดุนุงุน ุงููุทูู</a></li>
<li><a href="../ar471240/index.html">"ุจูุชุดู ุจูุชู" ููุงุฌูุงุช ุงูุตูุช ุงูุญุฏูุซุฉ: ููุงุฐุง ูุชุญุฏุซูู ุจุตูุช ุงูุฃูุซูุ</a></li>
<li><a href="../ar471242/index.html">ููุฏูุฉ ูุจุงุด ุดู</a></li>
<li><a href="../ar471244/index.html">ููุฏ Rosetta: ูู ุจููุงุณ ุทูู ุงูููุฏ ูู ุนุฏุฏ ูุจูุฑ ูู ูุบุงุช ุงูุจุฑูุฌุฉ ุ ูุฏุฑุณ ูุฏู ูุฑุจ ุงููุบุงุช ูู ุจุนุถูุง ุงูุจุนุถ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>