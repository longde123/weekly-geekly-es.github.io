<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⛹🏾 ⬜️ 👩🏼‍🔬 Anwendung auf TSD und Kommunikation mit 1C: Enterprise 8.3 über HTTP-Service. Teil 1 (Auswahl einer Austauschmethode. Beschreibung der API) 🐘 👨‍👧‍👦 👩🏻‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Die Wahl der Austauschmethode. API-Beschreibung. 
2. API-Implementierung auf der 1C-Seite. 
3. BroadcastReceiver Wir erhalten einen Barcode am Beis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Anwendung auf TSD und Kommunikation mit 1C: Enterprise 8.3 über HTTP-Service. Teil 1 (Auswahl einer Austauschmethode. Beschreibung der API)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473500/"><ol><li>  Die Wahl der Austauschmethode.  API-Beschreibung. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">API-Implementierung auf der 1C-Seite.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">BroadcastReceiver</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wir erhalten einen Barcode am Beispiel von ATOL Smart.Lite.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OnKeyUp.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Holen Sie sich einen Barcode von einem Scanner mit Tastaturemulation</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Menü, Begleitobjekt</a> </li><li>  Wir realisieren den Datenaustausch und die Speicherung.  Wir verwenden Retrofit 2, Room, Coroutines. </li><li>  Benutzeroberfläche  LiveData, PagedList. </li></ol><a name="habracut"></a><br><h3>  Für wen </h3><br>  Die ersten beiden Kapitel sind ein Versuch, die Erfahrung der Integration von 1C in andere Anwendungen und Webdienste zu strukturieren.  Ich denke, der Zyklus selbst wird für 1C-Programmierer interessant sein, die versuchen, über die Plattform hinauszugehen und etwas Neues auszuprobieren.  Entwickler von Android-Anwendungen werden nichts Neues für sich selbst lernen, aber vielleicht werden sie daran interessiert sein, wie es auf der 1C-Seite aussieht.  Ab dem vierten Teil wird versucht, mehrere verstreute Artikel aus dem Internet über die Nutzung von Bibliotheken zu kombinieren und Daten darüber zu aktualisieren.  Der Zyklus wurde als Lehrbuch konzipiert, das die Erfahrung bei der Entwicklung einer realen Anwendung beschreibt.  Ich selbst bin kein Android-Entwickler.  Aber bis zum Ende der Serie hoffe ich, einer zu werden. <br><br><h3>  2. Die Wahl der Austauschmethode.  API-Beschreibung </h3><br>  In der aktuellen Form kann 1C auf tausendfache Weise kontaktiert werden.  Betrachten Sie mehrere Optionen und warum ich sie nicht verwendet habe. <br><br><ul><li>  <b>Native Komponente</b> - Zum größten Teil ist es gut, sie für die Offline-Freigabe zu verwenden.  Für Online ist es schlecht angepasst.  Es wurde noch schlimmer, als 1C begann, seine Standards für den Austausch mit kommerziellen Geräten umzusetzen.  Und auch diese Komponente wird auf der 1C-Seite aufgerufen.  Passt nicht zu mir. </li><li>  <b>WEB Services</b> - Mehr für den Austausch zwischen Anwendungen, die verschiedene Teams entwickeln.  Schwergewicht, verwenden Sie XML.  Persönlich fällt es mir sehr schwer, mich zu entwickeln.  Und noch schwieriger in JavaScript, Golang usw. zu integrieren.  Ungeeignet. </li><li>  <b>HTTP-Dienste</b> - Fast das Gleiche wie WEB-Dienste, aber wir beschreiben die Logik der Arbeit und tauschen Protokolle vollständig selbst aus.  Hier beschränken wir uns nicht nur auf die Erfindung unseres eigenen Fahrrads.  Aus diesem Grund wurde dieser spezielle Austauschmechanismus gewählt. </li></ul><br>  Die Aufgaben, die unsere Anwendung löst.  "Alles, was auf der TSD getan werden kann, muss auf der TSD getan werden."  Nun, als Standard-Set: Akzeptanz, Inventar, Etiketten, Preisschilder. <br><br><div class="spoiler">  <b class="spoiler_title">Vollständige Liste der Aufgaben</b> <div class="spoiler_text"><ul><li>  <b>Arbeiten mit Waren:</b> Drucken von Etiketten und Preisschildern, Zuweisen eines Barcodes (Barcode), Überprüfen des Barcodes, Entfernen des Barcodes, Anzeigen von Preisen und Mengen in Lagern. </li><li>  <b>Inventar</b> - Tatsächlich Inventar führen. </li><li>  <b>Empfang</b> - Annahme von Waren auf der Rechnung, Drucken von Unstimmigkeiten, Drucken interner Dokumente, Rechnungsstatus. </li><li>  <b>Abholung von Waren, Realisierung (Einzelhandel)</b> - Die Idee ist, dass Verkäufer nicht an der Kasse sind, sondern mit dem Käufer gehen oder Waren auf Anfrage usw. abholen.  Es ist nur eine Person am Kassenschalter, ein Bereitschaftsscheck wird von der TSD gesendet.  Der Käufer bezahlt nur die Ware. </li><li>  <b>Abholung von Waren, Realisierung (Großhandel)</b> - Wir sammeln Waren auf dem Konto.  Wir prüfen, was verfügbar ist.  Wir bilden eine Sendung (mit einem Paket der notwendigen Unterlagen).  Vergessen Sie nicht, die Möglichkeit des Versands an die Gegenpartei zu prüfen. </li><li>  <b>Warenabholung, Versandvorbereitung</b> - Wir holen Waren auf Anfrage ab, legen sie auf eine Palette, drucken Dokumente: Packliste usw. </li><li>  <b>Umzug</b> - Wir sammeln Waren für den Umzug, wir geben in Lieferung. </li><li>  <b>Warensammlung, eine beliebige Liste</b> - Wird für Neubewertungen, Aktualisierung von Preisschildern, Etiketten und ähnlichen Vorgängen benötigt. </li></ul><br></div></div><br>  Zurück zur API-Struktur.  Der Austausch zwischen TSD und 1C erfolgt im JSON-Format.  In der Antwort haben wir nur zwei Objekte <b>{Ergebnis, Nutzlast}</b> : das <b>Ergebnis</b> und die <b>Nutzlast</b> .  Als Ergebnis geben wir zwei Felder zurück <b>{code, msg}</b> .  Und wir werden immer mit HTTP-Code 200 antworten. So wird es für uns auf der Clientseite einfacher sein, die Antwortstruktur zu analysieren.  Alle anderen Antworten werden als Zeichenfolge angezeigt.  1C erlaubt es uns nicht, Antworten außerhalb der Plattform anzupassen. <br><br><div class="spoiler">  <b class="spoiler_title">Warum es einfacher ist, 200 zu geben</b> <div class="spoiler_text">  Die meisten Bibliotheken für die Arbeit mit Daten (einschließlich Nachrüstung) analysieren das Ergebnis nicht, wenn sie anderen Code als 200 empfangen.  Und wir müssen es mit Stiften „analysieren“. <br></div></div><br>  Jetzt erhalten wir das folgende Diagramm.  Wenn die Antwort 200 ist, haben unsere Verfahren in 1C gut funktioniert.  Wenn eine andere Antwort vorliegt, haben wir unten ein Problem.  Hier können wir nicht tief gehen, was schief gelaufen ist, sondern dem Benutzer sofort zeigen, welcher Fehler und seine Beschreibung.  Jemand kann sagen, dass Fehler ohne Benutzereingriff verarbeitet werden müssen, aber wir können zwei Situationen haben: 1 - Der Server hat einen Fehler zurückgegeben.  2 - kitschig keine Verbindung.  Im ersten Fall wissen wir möglicherweise nicht einmal, dass etwas kaputt ist (Beispiel: Fehler 404: Die Anwendung hat eine nicht vorhandene Methode angefordert. 500: Die Plattform ist mit einer Ausnahme abgestürzt).  Im zweiten Fall können wir das Ergebnis zur Analyse nicht auf den Server übertragen.  Daher zeigen wir einen Fehler und freuen uns auf weitere Benutzeraktionen. <br><br>  Die Nutzdaten enthalten verschiedene Objekte.  Dies kann eine Warenliste sein, eine Liste von Dokumenten, eine Liste von Aktionen wird dort übertragen.  Auf der Anwendungsseite werden wir sie mit Modellen beschreiben und sie sorgfältig in die Datenbank einbinden.  Wir werden die Liste der auszuführenden Aktionen starten und die Ergebnisse sorgfältig zur Datenbank hinzufügen. <br><br>  Der Austauschzyklus mit der TSD wird wie folgt sein: <br><br><ol><li>  Die Anwendung auf Befehl sendet eine Anfrage an 1C. </li><li>  1C bildet eine Antwort und gibt eine Struktur mit dem Ergebnis und den Daten zurück.  In 1C akkumulieren Informationsregister geänderte Daten im Kontext von TSD (Webdienst). </li><li>  Auf Anfrage der Anwendung wird eine Liste der aufzurufenden Methoden gesendet. </li></ol><br>  Ein solches Schema wurde gewählt, weil die TSD aus, aus dem Netzwerk usw. ausgeschaltet werden kann.  Nichts hindert uns jedoch daran, 1C abzuschließen, sodass Sie beim Ändern von Daten eine andere Anwendung (Webdienst) darüber benachrichtigen müssen.  Mit diesem Austausch informieren wir, dass es neue Daten gibt.  Die Anwendung fragt, welche Daten vorhanden sind, und die Schleife wird wiederholt.  Ein Beispiel für einen Austausch ist im Diagramm dargestellt. <br><br><img src="https://habrastorage.org/webt/ph/so/te/phsotej3s3qxqdfrglopxduetl8.png"><br><br>  Das ist alles  Wenn Sie Fragen, Kommentare, Vorschläge haben, schreiben Sie bitte in die Kommentare. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de473500/">https://habr.com/ru/post/de473500/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de473478/index.html">Überprüfen des OpenCvSharp Wrapper auf OpenCV mit PVS-Studio</a></li>
<li><a href="../de473482/index.html">Die Erfolge der saudischen Kampagne, Halloween-PR und ein bisschen über Werbekampagnen von Japan Airlines</a></li>
<li><a href="../de473484/index.html">C ++ - Kurs im CS Center, zweiter Teil</a></li>
<li><a href="../de473488/index.html">Plattformübergreifende Navigation: Warum NavController Angular / Router in Ionic 4 besiegt hat</a></li>
<li><a href="../de473490/index.html">Warum Spitzenphysiker die Stringtheorie lieben</a></li>
<li><a href="../de473502/index.html">Hat Linux kommerzielles Unix getötet?</a></li>
<li><a href="../de473510/index.html">Wir schreiben ein Programm für eine Kamera mit Gesichtserkennung</a></li>
<li><a href="../de473512/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 482 (08/10/2019 - 10/10/2019)</a></li>
<li><a href="../de473514/index.html">Schreiben eines Microservice-Blogs - Teil 1 „Allgemeine Beschreibung“</a></li>
<li><a href="../de473516/index.html">Schreiben eines Microservice-Blogs - Teil 2 von API Gateway</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>