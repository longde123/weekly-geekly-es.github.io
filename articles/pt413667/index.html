<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Ç üë®üèΩ‚Äçüéì üë©üèΩ‚Äçüî¨ Kaggle: Amazon from Space - truques e hacks para treinar redes neurais „äóÔ∏è üõ≥Ô∏è ‚û∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No ver√£o passado, terminou a competi√ß√£o no site kaggle, dedicada √† classifica√ß√£o de imagens de sat√©lite das florestas amaz√¥nicas. Nossa equipe ficou e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kaggle: Amazon from Space - truques e hacks para treinar redes neurais</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/413667/"><img src="https://habrastorage.org/webt/os/ad/nr/osadnrglchljzop2xeerf65s0n0.png"><br><br>  No ver√£o passado, terminou a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">competi√ß√£o</a> no site kaggle, dedicada √† classifica√ß√£o de imagens de sat√©lite das florestas amaz√¥nicas.  Nossa equipe ficou em 7¬∫ lugar entre mais de 900 participantes.  Apesar de a competi√ß√£o ter terminado h√° muito tempo, quase todos os m√©todos de nossa solu√ß√£o ainda s√£o aplic√°veis, e n√£o apenas para competi√ß√µes, mas tamb√©m para o treinamento de redes neurais √† venda.  Para detalhes em cat. <br><a name="habracut"></a><br>  <b>tldr.py</b> <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> kaggle <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ods <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> albu, alno, kostia, n01z3, nizhib, romul, ternaus <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dataset <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> x_train, y_train, x_test oof_train, oof_test = [], [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> member <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [albu, alno, kostia, n01z3, nizhib, romul, ternaus]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> member.models: model.fit_10folds(x_train, y_train, config=member.fit_config) oof_train.append(model.predict_oof_tta(x_train, config=member.tta_config)) oof_test.append(model.predict_oof_tta(x_test, config=member.tta_config)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> albu.second_level: model.fit(oof_train) y_test = model.predict_proba(oof_test) y_test = kostia.bayes_f2_opt(y_test) kaggle.submit(y_test)</code> </pre> <br>  Descri√ß√£o da tarefa <br><br>  A Planet preparou um conjunto de imagens de sat√©lite em dois formatos: <br><br><ol><li>  TIF - 16 bits RGB + N, onde N - Pr√≥ximo ao infravermelho </li><li>  JPG - RGB de 8 bits, derivados do TIF e fornecidos para reduzir o limite de entrada na tarefa e para simplificar a visualiza√ß√£o.  Na competi√ß√£o anterior do Kaggle, era necess√°rio trabalhar com imagens multiespectrais.  n√£o visual, isto √©, infravermelho, bem como canais com comprimento de onda maior, melhorou bastante a qualidade da previs√£o, tanto na rede quanto nos m√©todos n√£o supervisionados. </li></ol><br>  Geograficamente, foram coletados dados do territ√≥rio da bacia amaz√¥nica e dos territ√≥rios dos pa√≠ses do Brasil, Peru, Uruguai, Col√¥mbia, Venezuela, Guiana, Bol√≠via e Equador, nos quais foram selecionadas √°reas de superf√≠cie interessantes, cujas fotos foram oferecidas aos participantes. <br><br>  Depois de criar jpg a partir de tif, todas as cenas foram cortadas em pequenos peda√ßos de tamanho 256x256.  E de acordo com o jpg recebido pelos funcion√°rios da Planet nos escrit√≥rios de Berlim e San Francisco, bem como atrav√©s da plataforma Crowd Flower, a marca√ß√£o foi realizada. <br><br>  Os participantes foram incumbidos de prever, para cada bloco de 256x256, uma das marcas meteorol√≥gicas mutuamente exclusivas: <br><br>  Nublado, Parcialmente nublado, Nublado, Nublado <br><br>  E tamb√©m 0 ou mais intemp√©ries: Agricultura, Prim√°rio, Extra√ß√£o Seletiva, Habita√ß√£o, √Ågua, Estradas, Cultivo de Mudan√ßa, Floresc√™ncia, Minera√ß√£o Convencional <br><br>  Um total de 4 condi√ß√µes clim√°ticas e 13 condi√ß√µes n√£o clim√°ticas, clima mutuamente exclusivo, mas sem clima, mas se a imagem estiver nublada, n√£o haver√° outras tags. <br><br><img src="https://habrastorage.org/webt/me/ng/-t/meng-tzona5dhecl1r56eggbt1u.jpeg"><br><br>  A precis√£o do modelo foi estimada pela m√©trica F2: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">a</span><span class="MJXp-mrow" id="MJXp-Span-8"><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;">√ß</span></span><span class="MJXp-mrow" id="MJXp-Span-10"><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0em;">√£</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">o</span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-15">1</span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-17">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">t</span><span class="MJXp-msubsup" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-23" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-25">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">c</span><span class="MJXp-mrow" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32">r</span></span><span class="MJXp-mrow" id="MJXp-Span-33"><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-35">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">t</span><span class="MJXp-msubsup" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-41" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">p</span><span class="MJXp-mo" id="MJXp-Span-43" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">r</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.327ex" height="3.021ex" viewBox="0 -987.6 19515.5 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-6F" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-6E" x="1237" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-74" x="1837" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-75" x="2199" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-61" x="2771" y="0"></use><g transform="translate(3301,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√ß</text></g><g transform="translate(3669,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√£</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-6F" x="4084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-3D" x="4848" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-28" x="5904" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-31" x="6293" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-2B" x="7016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-62" x="8267" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-65" x="8696" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-74" x="9163" y="0"></use><g transform="translate(9524,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-32" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-29" x="10508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-66" x="11147" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-72" x="11698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-61" x="12149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-63" x="12679" y="0"></use><g transform="translate(13112,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-72" x="503" y="0"></use></g><g transform="translate(14067,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-62" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-65" x="1069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-74" x="1535" y="0"></use><g transform="translate(1897,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-32" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-70" x="2880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-2B" x="3606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-72" x="4606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-29" x="5058" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> Pontua√ß√£o = (1+ \ beta ^ 2) \ frac {pr} {(\ beta ^ 2p + r)} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-46"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47">p</span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-49">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">c</span><span class="MJXp-mrow" id="MJXp-Span-54"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">p</span></span><span class="MJXp-mrow" id="MJXp-Span-57"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59">p</span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62">p</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.808ex" height="2.419ex" viewBox="-38.5 -780.1 8098 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-3D" x="781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-72" x="2638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-61" x="3089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-63" x="3619" y="0"></use><g transform="translate(4052,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-70" x="361" y="0"></use></g><g transform="translate(4917,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-70" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-2B" x="1087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-70" x="2638" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> p = \ frac {tp} {tp + fp} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">r</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-66">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70">c</span><span class="MJXp-mrow" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73">p</span></span><span class="MJXp-mrow" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">p</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79">n</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.823ex" height="2.419ex" viewBox="0 -780.1 8104.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-3D" x="729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-66" x="2035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-72" x="2586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-61" x="3037" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-63" x="3567" y="0"></use><g transform="translate(4000,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-70" x="361" y="0"></use></g><g transform="translate(4865,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-70" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-2B" x="1087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-6E" x="2638" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> r = \ frac {tp} {tp + fn} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-80"><span class="MJXp-mtext" id="MJXp-Span-81">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">a</span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-87">2</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.992ex" height="2.057ex" viewBox="0 -780.1 3871.6 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMATHI-61" x="1507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-3D" x="2314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhOXa55w2AAvQsmtBUdAiEn17ssuQ#MJMAIN-32" x="3371" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ beta = 2 </script></p><br>  Al√©m disso, todos os r√≥tulos tinham o mesmo peso e o primeiro F2 foi calculado para cada foto e, em seguida, houve uma m√©dia geral.  Geralmente eles fazem isso de maneira um pouco diferente, ou seja, uma determinada m√©trica √© calculada para cada classe e, em seguida, calculada a m√©dia.  A l√≥gica √© que a √∫ltima op√ß√£o √© mais interpret√°vel, pois permite responder √† pergunta de como o modelo se comporta em cada classe espec√≠fica.  Nesse caso, os organizadores foram de acordo com a primeira op√ß√£o, que, aparentemente, est√° relacionada √†s especificidades de seus neg√≥cios. <br><br>  Existem 40 mil amostras no trem.  No teste de 40k.  Devido ao tamanho pequeno do conjunto de dados, mas ao tamanho grande das imagens, podemos dizer que este √© "MNIST em ester√≥ides" <br><br>  <b>Digress√£o l√≠rica</b> <br><br>  Como voc√™ pode ver na descri√ß√£o, a tarefa √© bastante compreens√≠vel e a solu√ß√£o n√£o √© do tipo foguete: voc√™ s√≥ precisa arquivar a grade.  E, levando em conta as especificidades da maca, voc√™ tamb√©m pode empilhar v√°rios modelos por cima.  No entanto, para obter uma medalha de ouro, voc√™ n√£o precisa apenas treinar, de alguma forma, v√°rios modelos.  √â imperativo ter muitos modelos b√°sicos diversos, cada um dos quais mostra um resultado not√°vel.  E j√° em cima desses modelos, voc√™ pode acabar empilhando e outros hacks. <br><table><tbody><tr><th>  membro </th><th>  net </th><th>  1crop </th><th>  Tta </th><th>  diff,% </th></tr><tr><td>  alno </td><td>  densenet121 </td><td>  0,9278 </td><td>  0,9294 </td><td>  0,1736 </td></tr><tr><td>  nizhib </td><td>  densenet169 </td><td>  0,9243 </td><td>  0,9277 </td><td>  0,3733 </td></tr><tr><td>  romul </td><td>  vgg16 </td><td>  0,9266 </td><td>  0,9267 </td><td>  0,0186 </td></tr><tr><td>  ternaus </td><td>  densenet121 </td><td>  0,9232 </td><td>  0,9241 </td><td>  0,0921 </td></tr><tr><td>  albu </td><td>  densenet121 </td><td>  0,9294 </td><td>  0,9312 </td><td>  0,1933 </td></tr><tr><td>  kostia </td><td>  resnet50 </td><td>  0,9262 </td><td>  0,9271 </td><td>  0,0907 </td></tr><tr><td>  n01z3 </td><td>  resnext50 </td><td>  0,9281 </td><td>  0,9298 </td><td>  0,1896 </td></tr></tbody></table><br>  A tabela mostra os modelos de pontua√ß√£o F2 de todos os participantes para uma cultura e TTA.  Como voc√™ pode ver, a diferen√ßa √© pequena para uso real, mas √© importante para o modo de competi√ß√£o. <br><br>  <b>Intera√ß√£o da equipe</b> <br><br>  Alexander Buslaev <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">albu</a></i> <br>  No momento da participa√ß√£o na competi√ß√£o, ele liderou toda a dire√ß√£o da ml no Geoscan.  Mas, desde ent√£o, ele organizou v√°rias competi√ß√µes, tornou-se o pai de todos os ODS na segmenta√ß√£o sem√¢ntica e partiu para Minsk, remando no Mapbox, sobre o qual o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> foi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">publicado.</a> <br><br>  Alexey Noskov <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">alno</a></i> <br>  Lutador universal de ml.  Trabalhou no Evil Marciano.  Agora rolou para o Yandex. <br><br>  Konstantin Lopukhin <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">kostialopuhin</a></i> <br>  Trabalhou e continua a trabalhar na Scrapinghub.  Desde ent√£o, Kostya conseguiu mais algumas medalhas e, sem 5 minutos, Kaggle Grandmaster <br><br>  Arthur Primo <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">n01z3</a></i> <br>  No momento da participa√ß√£o nessa competi√ß√£o, eu trabalhava na Avito.  Mas por volta do ano novo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a</a> startup Lead Data Scientist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">da Dbrain</a> passou para a blockchain.  Espero que em breve encantemos a comunidade com nossas competi√ß√µes com estivadores e marca√ß√µes de l√¢mpadas. <br><br>  Evgeny Nizhibitsky <i>@nizhib</i> <br>  Cientista de Dados L√≠der na Rambler &amp; Co.  A partir dessa competi√ß√£o, Eugene descobriu a capacidade secreta de encontrar rostos em competi√ß√µes de imagens.  O que o ajudou a arrastar algumas competi√ß√µes na plataforma Topcoder.  Eu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">falei</a> sobre um deles. <br><br>  Ruslan <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Baykulov romul</a></i> <br>  Envolvido no rastreamento de eventos esportivos em Constanta. <br><br>  Vladimir Iglovikov <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">ternaus</a></i> <br>  Voc√™ poderia ser lembrado por um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> cheio de a√ß√£o sobre ass√©dio da intelig√™ncia brit√¢nica.  Ele trabalhou na TrueAccord, mas depois ingressou na juventude Lyft.  Onde o Computer Vision funciona para carros aut√¥nomos?  Continua a arrastar competi√ß√µes e recentemente recebeu o Kaggle Grandmaster. <br><br>  Nossa associa√ß√£o e formato de participa√ß√£o podem ser chamados de t√≠picos.  A decis√£o de nos unir deveu-se ao fato de todos termos resultados pr√≥ximos na tabela de classifica√ß√£o.  E cada um de n√≥s viu nosso pr√≥prio pipeline independente, que era uma solu√ß√£o completamente aut√¥noma do come√ßo ao fim.  Al√©m disso, ap√≥s a fus√£o, v√°rios participantes estavam envolvidos no empilhamento. <br><br>  A primeira coisa que fizemos foi compartilhar dobras.  Garantimos que a distribui√ß√£o de classes em cada dobra fosse a mesma que em todo o conjunto de dados.  Para isso, a classe mais rara foi escolhida pela primeira vez, estratificada por ela, porque as fotos restantes foram estratificadas pela segunda classe mais popular, e assim por diante at√© que n√£o houvesse mais imagens. <br><br>  Histograma das classes de dobra: <br><br><img src="https://habrastorage.org/webt/bh/wb/so/bhwbsoqk5acztwrsigxg0iwqpau.png"><br><br>  Tamb√©m t√≠nhamos um reposit√≥rio comum, onde cada membro da equipe tinha sua pr√≥pria pasta, dentro da qual ele organizou o c√≥digo como queria. <br><br>  E tamb√©m concordamos com o formato das previs√µes, porque esse era o √∫nico ponto de intera√ß√£o para combinar nossos modelos. <br><br>  <b>Treinamento em redes neurais</b> <br><br>  Como cada um de n√≥s tinha um canal independente, √©ramos uma amostra da grade do processo ideal de aprendizado paralelizado pelas pessoas. <br><br>  <b>Abordagem geral</b> <br><br><img src="https://habrastorage.org/webt/fw/jo/bf/fwjobff3h_7__qvkhjmzi3fqhke.png"><br>  Imagem de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github.com/tornadomeet/ResNet</a> <br><br>  Um processo de aprendizado t√≠pico √© apresentado no cronograma de treinamento das redes neurais da Resnet na imagenet.  Eles come√ßam com pesos inicializados aleatoriamente com SGD (lr 0,1 Nesterov Momentum 0,0001 WD 0,9) e depois de 30 apagamentos, diminua a taxa de aprendizado em 10 vezes. <br><br>  Conceitualmente, cada um de n√≥s usou a mesma abordagem, no entanto, para n√£o envelhecer enquanto aprendia cada rede, a diminui√ß√£o da LR ocorria se a valida√ß√£o n√£o reduzisse a perda por 3-5 eras seguidas.  Ou, alguns participantes simplesmente reduziram o n√∫mero de eras em cada dano de RL e diminu√≠ram de acordo com o cronograma. <br><br>  <b>Aumento</b> <br><br>  Escolher os aumentos certos √© muito importante ao treinar redes neurais.  Aumentos devem refletir a variabilidade da natureza dos dados.  Convencionalmente, os aumentos podem ser divididos em dois tipos: aqueles que introduzem vi√©s nos dados e aqueles que n√£o.  Por vi√©s, pode-se entender v√°rias estat√≠sticas de baixo n√≠vel, como histogramas de cores ou tamanho das caracter√≠sticas.  Nesse sentido, digamos, os aumentos e escalas do HSV introduzem um deslocamento, mas uma colheita aleat√≥ria n√£o. <br><br>  Nos primeiros est√°gios do treinamento da rede, voc√™ pode ir longe demais com aprimoramentos e usar um conjunto muito dif√≠cil.  No entanto, no final do treinamento, voc√™ deve desativar os aprimoramentos ou deixar apenas aqueles que n√£o apresentam vi√©s.  Isso permite que a rede neural se ajuste demais um pouco sob o trem e mostre um resultado um pouco melhor na valida√ß√£o. <br><br>  <b>Congelamento de camadas</b> <br><br>  Na grande maioria das tarefas, n√£o faz sentido treinar uma rede neural do zero, √© muito mais eficiente mexer com redes pr√©-treinadas, digamos com a Imagenet.  No entanto, voc√™ pode ir al√©m e n√£o apenas alterar a camada totalmente conectada sob a camada com o n√∫mero desejado de classes, mas primeiro trein√°-la com o congelamento de todas as convolu√ß√µes.  Se voc√™ n√£o congelar as convolu√ß√µes e treinar imediatamente toda a rede com pesos inicializados aleatoriamente de uma camada totalmente conectada, os pesos das convolu√ß√µes ser√£o corrompidos e o desempenho final da rede neural ser√° menor.  Nesta tarefa, isso foi especialmente not√°vel devido ao pequeno tamanho da amostra de treinamento.  Em outras competi√ß√µes com uma grande quantidade de dados, como o desconto no CD, n√£o foi poss√≠vel congelar toda a rede neural, mas grupos de convolu√ß√µes a partir do final.  Dessa maneira, o treinamento poderia ser bastante acelerado, pois os gradientes n√£o eram considerados para as camadas congeladas. <br><br>  <b>Recozimento c√≠clico</b> <br><br>  Esse processo se parece com isso.  Ap√≥s a conclus√£o do processo b√°sico de treinamento da rede neural, os melhores pesos s√£o obtidos e o processo de treinamento √© repetido.  Mas come√ßa com uma taxa de aprendizado mais baixa e ocorre em um curto per√≠odo de tempo, digamos 3-5 eras.  Isso permite que a rede neural diminua para um m√≠nimo local mais baixo e mostre um melhor desempenho.  Esta campanha est√°vel melhora o resultado em um n√∫mero bastante amplo de concursos. <br><br>  Mais detalhadamente sobre duas recep√ß√µes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> <br><br>  <b>Aumentos do tempo de teste</b> <br><br>  Como se trata de uma competi√ß√£o e n√£o temos uma restri√ß√£o formal ao tempo de infer√™ncia, voc√™ pode usar aprimoramentos durante o teste.  Parece que a imagem est√° distorcida da mesma maneira que aconteceu durante o treinamento.  Digamos, ele √© refletido verticalmente, horizontalmente, girado por um √¢ngulo etc.  Cada aumento fornece uma nova imagem a partir da qual obtemos previs√µes.  Em seguida, as previs√µes de tais distor√ß√µes de uma imagem s√£o calculadas como m√©dia (em regra por meios geom√©tricos).  Tamb√©m d√° lucro.  Em outras competi√ß√µes, tamb√©m experimentei aumentos aleat√≥rios.  Digamos, voc√™ pode aplicar n√£o um de cada vez, mas simplesmente reduzir a amplitude para curvas aleat√≥rias, contrastes e aumento de cores pela metade, fixar a semente e fazer v√°rias imagens distorcidas aleatoriamente.  Isso tamb√©m deu um aumento. <br><br>  <b>Conjunto de instant√¢neos (TTA de pontos de verifica√ß√£o m√∫ltiplos)</b> <br><br>  A id√©ia de recozimento pode ser desenvolvida ainda mais.  Em cada est√°gio do recozimento, a rede neural voa para m√≠nimos locais ligeiramente diferentes.  E isso significa que esses s√£o modelos essencialmente ligeiramente diferentes que podem ser calculados em m√©dia.  Assim, durante as previs√µes do teste, voc√™ pode fazer os tr√™s melhores pontos de verifica√ß√£o e calcular a m√©dia de suas previs√µes.  Eu tamb√©m tentei pegar n√£o os tr√™s melhores, mas os tr√™s mais diversos dos 10 melhores - era pior.  Bem, para a produ√ß√£o, esse truque n√£o √© aplic√°vel e tentei calcular o peso dos modelos.  Isso deu um aumento muito insignificante, mas constante. <br><br><img src="https://habrastorage.org/webt/ad/_l/po/ad_lposcfqtrpo67wc3abmzvxq0.png"><br><br>  <b>Abordagens de cada membro da equipe</b> <br><br>  Assim, em um grau ou outro, cada membro de nossa equipe usou uma combina√ß√£o diferente das t√©cnicas acima. <br><table><tbody><tr><th>  <nobr>nick</nobr> </th><th>  <nobr>Congelar conv,</nobr> <br>  √©poca </th><th>  <nobr>Optimizer</nobr> </th><th>  <nobr>Estrat√©gia</nobr> </th><th>  <nobr>Agosto</nobr> </th><th>  <nobr>Tta</nobr> </th></tr><tr><th>  albu </th><td>  3 </td><td>  SGD </td><td>  Decad√™ncia LR de 15 √©pocas, <br>  C√≠rculo 13 √©pocas </td><td>  D4, <br>  Escala, <br>  Deslocamento <br>  Distor√ß√£o <br>  Contraste <br>  Desfocar </td><td>  D4 </td></tr><tr><th>  alno </th><td>  3 </td><td>  SGD </td><td>  Lr decad√™ncia </td><td>  D4, <br>  Escala, <br>  Deslocamento <br>  Distor√ß√£o <br>  Contraste <br>  Desfocar <br>  Cisalhamento <br>  Multiplicador de canal </td><td>  D4 </td></tr><tr><th>  n01z3 </th><td>  2 </td><td>  SGD </td><td>  Drop LR, paciente 10 </td><td>  D4, <br>  Escala, <br>  Distor√ß√£o <br>  Contraste <br>  Desfocar </td><td>  D4, 3 pontos de verifica√ß√£o </td></tr><tr><th>  <nobr>ternaus</nobr> </th><td>  - </td><td>  Adam </td><td>  LR c√≠clico (1e-3: 1e-6) </td><td>  D4, <br>  Escala, <br>  Adi√ß√£o de canal <br>  Contraste </td><td>  D4, <br>  colheita aleat√≥ria </td></tr><tr><th>  nizhib </th><td>  - </td><td>  Adam </td><td>  StepLR, 60 √©pocas, 20 por decaimento </td><td>  D4, <br>  RandomSizedCrop </td><td>  D4, <br>  4 cantos, <br>  centro <br>  escala </td></tr><tr><th>  kostia </th><td>  1 </td><td>  Adam </td><td></td><td>  D4, <br>  Escala, <br>  Distor√ß√£o <br>  Contraste <br>  Desfocar </td><td>  D4 </td></tr><tr><th>  romul </th><td>  - </td><td>  SGD </td><td>  base_lr: 0,01 - 0,02 <br>  lr = base_lr * (0,33 ** (√©poca / 30)) <br>  √âpoca: 50 </td><td>  D4, Escala </td><td>  D4, recorte central, <br>  Culturas de canto </td></tr></tbody></table><br>  <b>Empilhamento e hacks</b> <br><br>  N√≥s treinamos cada modelo com cada conjunto de par√¢metros em 10 dobras.  E ent√£o, nas previs√µes fora da dobra (OOF), treinamos modelos de segundo n√≠vel: √Årvores Extra, Regress√£o Linear, Rede Neural e simplesmente modelos de m√©dia. <br><br>  E j√° na OOF, as previs√µes dos modelos de segundo n√≠vel pegaram peso na mistura.  Voc√™ pode ler mais sobre empilhamento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br><br>  Na produ√ß√£o real, curiosamente, essa abordagem tamb√©m ocorre.  Por exemplo, quando h√° dados multimodais (figuras, texto, categorias etc.) e voc√™ deseja combinar as previs√µes dos modelos.  Voc√™ pode simplesmente calcular a m√©dia das probabilidades, mas o treinamento de um modelo de segundo n√≠vel fornece o melhor resultado. <br><br>  <b>Otimiza√ß√£o de Baes F2</b> <br><br>  Al√©m disso, as previs√µes finais se ajustaram um pouco usando a otimiza√ß√£o bayesiana.  Suponha que tenhamos probabilidades ideais e, em seguida, F2 com o melhor tapete de expectativas (ou seja, do tipo ideal) seja obtido pela seguinte f√≥rmula: <br><br><img src="https://habrastorage.org/webt/gx/dh/ff/gxdhff8q1dgrym6n2t7nzna144e.png"><br><br>  O que isso significa?  Precisamos classificar todas as combina√ß√µes (ou seja, para cada r√≥tulo 0 e 1), calcular a probabilidade de cada combina√ß√£o e multiplicar por F2 - obtemos o F2 esperado.  Para qual combina√ß√£o √© melhor e fornecer√° o F2 ideal.  As probabilidades foram consideradas simplesmente uma multiplica√ß√£o das probabilidades de r√≥tulos individuais (se o r√≥tulo for 0, pegamos 1 - p) e, para n√£o classificar 2 em 17 op√ß√µes, apenas r√≥tulos com probabilidade de 0,05 a 0,5 foram escalonados - havia 3-7 deles seguidos, portanto, as op√ß√µes um pouco (a submiss√£o foi feita em alguns minutos).  Em teoria, seria legal obter a probabilidade de uma combina√ß√£o de r√≥tulos, n√£o apenas multiplicando probabilidades individuais (porque os r√≥tulos n√£o s√£o independentes), mas n√£o funcionou. <br><br>  o que deu?  quando os modelos se tornaram bons, a sele√ß√£o de limites ap√≥s o conjunto parou de funcionar, e isso deu um aumento pequeno, mas est√°vel, na valida√ß√£o e em p√∫blico / privado. <br><br>  <b>Posf√°cio</b> <br><br>  Como resultado, treinamos 48 modelos diferentes, cada um com 10 dobras, ou seja,  480 modelos do primeiro n√≠vel.  Tal igreja humana da grade me permitiu experimentar diferentes t√©cnicas ao treinar redes neurais convolucionais profundas, que ainda uso no trabalho e nas competi√ß√µes. <br><br>  Foi poss√≠vel treinar menos modelos e obter o mesmo ou melhor resultado?  Sim, bastante.  Nossos compatriotas do 3¬∫ lugar, Stanislav <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">stasg7</a> Semenov e Roman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ZFTurbo</a> Soloviev, custam um n√∫mero menor de modelos de primeiro n√≠vel e compensam mais de 250 modelos de segundo n√≠vel.  Sobre a solu√ß√£o, voc√™ pode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ver a</a> an√°lise e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ler a</a> postagem. <br><br>  O primeiro lugar foi para o misterioso melhor ajuste.  Em geral, esse cara √© muito legal, e agora ele se tornou o top1 do Keggle, tendo participado de muitas competi√ß√µes de fotos.  Ele permaneceu an√¥nimo por um longo tempo, at√© que a Nvidia quebrou a capa ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">entrevist√°-</a> lo.  No qual ele admitiu que 200 subordinados se reportariam a ele ... H√° tamb√©m um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">post</a> sobre a decis√£o. <br><br>  Outro interessante: amplamente conhecido em c√≠rculos estreitos, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Jeremy Howard</a> , pai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fastai</a> terminou 22m.  E se voc√™ pensou que ele acabou de enviar algumas submiss√µes para o f√£ dele, n√£o adivinhou.  Ele participou da equipe e enviou 111 encomendas. <br><br>  Al√©m disso, os estudantes de p√≥s-gradua√ß√£o de Stanford que estavam fazendo o lend√°rio curso CS231n na √©poca e que tinham permiss√£o para usar essa tarefa como projeto de curso terminaram toda a equipe no meio da tabela de classifica√ß√£o. <br><br>  Como b√¥nus, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">falei</a> no Mail.ru com o material deste post e aqui est√° outra <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">apresenta√ß√£o de</a> Vladimir Iglovikov de uma reuni√£o no Vale. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt413667/">https://habr.com/ru/post/pt413667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt413655/index.html">Quais textos para p√°ginas de destino eles realmente vendem?</a></li>
<li><a href="../pt413657/index.html">A rede neural da Uber reconhece os usu√°rios em um estado "incomum"</a></li>
<li><a href="../pt413661/index.html">Saga de servi√ßos eletr√¥nicos e suas localiza√ß√µes. Parte 1. Servi√ßo Eletr√¥nico</a></li>
<li><a href="../pt413663/index.html">Hist√≥rias de back-end MeetUp</a></li>
<li><a href="../pt413665/index.html">Como determinar o volume dos seus logs?</a></li>
<li><a href="../pt413669/index.html">Samsung IT School: ensinando os alunos a desenvolver aplicativos m√≥veis</a></li>
<li><a href="../pt413673/index.html">Sobre a quest√£o do desempenho de vers√µes antigas e novas de um n√≥</a></li>
<li><a href="../pt413675/index.html">Coringa 2018: Clube de desenvolvedores Java an√¥nimos</a></li>
<li><a href="../pt413677/index.html">Lan√ßamento do ROS no rob√¥ de auto balanceamento EduMIP</a></li>
<li><a href="../pt413679/index.html">Angular6. PWA. M√≥dulos de carregamento pregui√ßosos. Implantar automaticamente no Firebase</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>