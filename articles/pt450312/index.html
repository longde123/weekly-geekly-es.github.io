<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍🤝‍👩🏻 🧟 🎩 Guia de iniciação do Docker Compose 🐵 🌌 🥞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O autor do artigo, cuja tradução estamos publicando hoje, diz que ele é destinado aos desenvolvedores que desejam aprender o Docker Compose e criarão ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Guia de iniciação do Docker Compose</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/450312/">  O autor do artigo, cuja tradução estamos publicando hoje, diz que ele é destinado aos desenvolvedores que desejam aprender o Docker Compose e criarão seu primeiro aplicativo cliente-servidor usando o Docker.  O leitor deve estar familiarizado com o básico do Docker.  Se não for esse o caso, você pode dar uma olhada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nesta</a> série de materiais, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nesta</a> publicação, onde os conceitos básicos do Docker são discutidos juntamente com os conceitos básicos do Kubernetes e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">este</a> artigo para iniciantes. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/b4c/71f/be9/b4c71fbe9634709b3e33a72eabca59af.png" alt="imagem"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">O que é o Docker Compose?</font> </h2><br>  O Docker Compose é uma ferramenta incluída no Docker.  Ele foi projetado para resolver os problemas associados à implantação de projetos. <br><br>  Estudando o básico do Docker, você pode ter encontrado a criação de aplicativos simples que funcionam de forma autônoma, independentemente de, por exemplo, fontes de dados externas ou determinados serviços.  Na prática, essas aplicações são raras.  Projetos reais geralmente incluem todo um conjunto de aplicativos colaborativos. <br><br>  Como você sabe se precisa usar o Docker Compose ao implantar um projeto?  De fato - muito simples.  Se vários serviços forem usados ​​para garantir o funcionamento deste projeto, o Docker Compose poderá ser útil.  Por exemplo, em uma situação em que eles criam um site que, para autenticar usuários, precisa se conectar ao banco de dados.  Um projeto semelhante pode consistir em dois serviços - um que fornece o site e outro responsável pela manutenção do banco de dados. <br><br>  A tecnologia Docker Compose, se descrita de forma simplista, permite, com um único comando, iniciar muitos serviços. <br><br><h2>  <font color="#3AC1EF">Diferença entre o Docker e o Docker Compose</font> </h2><br>  O Docker é usado para gerenciar os contêineres (serviços) individuais que compõem o aplicativo. <br><br>  O Docker Compose é usado para gerenciar simultaneamente vários contêineres que compõem o aplicativo.  Essa ferramenta oferece os mesmos recursos do Docker, mas permite trabalhar com aplicativos mais complexos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/859/489/407/85948940715022ca196b8ad6f1e810d0.png"></div><br>  <i><font color="#999999">Docker (contêiner único) e Docker Compose (vários contêineres)</font></i> <br><br><h2>  <font color="#3AC1EF">Caso de uso típico do Docker Compose</font> </h2><br>  O Docker Compose é, na mão direita, uma ferramenta muito poderosa que permite implantar rapidamente aplicativos com uma arquitetura complexa.  Agora, veremos um exemplo do uso prático do Docker Compose, cuja análise permitirá avaliar as vantagens que você terá ao usar o Docker Compose. <br><br>  Imagine que você é um desenvolvedor de um projeto da web.  Este projeto inclui dois sites.  O primeiro permite que as pessoas nos negócios criem, com apenas alguns cliques, lojas online.  O segundo é voltado para o suporte ao cliente.  Esses dois sites interagem com o mesmo banco de dados. <br><br>  Seu projeto está se tornando mais popular e acontece que o poder do servidor no qual ele trabalha não é mais suficiente.  Como resultado, você decide transferir o projeto inteiro para outra máquina. <br><br>  Infelizmente, você não usou algo como o Docker Compose.  Portanto, você terá que transferir e reconfigurar os serviços, um de cada vez, esperando que, no processo deste trabalho, não esqueça nada. <br><br>  Se você usa o Docker Compose, a transferência do seu projeto para um novo servidor é uma questão que pode ser resolvida executando vários comandos.  Para concluir a transferência do projeto para um novo local, você só precisa executar algumas configurações e fazer upload de uma cópia de backup do banco de dados no novo servidor. <br><br><h2>  <font color="#3AC1EF">Desenvolvendo um aplicativo cliente-servidor usando o Docker Compose</font> </h2><br>  Agora que você sabe para o que usaremos o Docker Compose, é hora de criar seu primeiro aplicativo cliente-servidor usando essa ferramenta.  Ou seja, estamos falando sobre o desenvolvimento de um pequeno site (servidor) em Python, que pode produzir um arquivo com um fragmento de texto.  Este arquivo é solicitado ao servidor por um programa (cliente), também escrito em Python.  Após receber o arquivo do servidor, o programa exibe o texto armazenado na tela. <br><br>  Observe que esperamos que você seja o proprietário do básico do Docker e que você já tenha a plataforma Docker instalada. <br><br>  Vamos trabalhar no projeto. <br><br><h3>  <font color="#3AC1EF">▍1</font>  <font color="#3AC1EF">Criação de projeto</font> </h3><br>  Para criar seu primeiro aplicativo cliente-servidor, sugiro começar com a criação de uma pasta do projeto.  Ele deve conter os seguintes arquivos e pastas: <br><br><ul><li> <code>docker-compose.yml</code> .  Este é um arquivo do Docker Compose que conterá as instruções necessárias para iniciar e configurar serviços. </li><li>  Pasta do <code>server</code> .  Ele conterá os arquivos necessários para garantir a operação do servidor. </li><li>  <code>client</code> pasta.  Aqui estão os arquivos do aplicativo cliente. </li></ul><br>  Como resultado, o conteúdo da pasta principal do seu projeto deve ficar assim: <br><br><pre> <code class="plaintext hljs">. ├── client/ ├── docker-compose.yml └── server/ 2 directories, 1 file</code> </pre> <br><h3>  <font color="#3AC1EF">§ 2</font>  <font color="#3AC1EF">Criação de servidor</font> </h3><br>  Aqui, no processo de criação do servidor, abordaremos algumas coisas básicas sobre o Docker. <br><br><h4>  2a  Criação de arquivo </h4><br>  Vá para a pasta do <code>server</code> e crie os seguintes arquivos nela: <br><br><ul><li>  Arquivo <code>server.py</code> .  Ele conterá o código do servidor. </li><li>  Arquivo <code>index.html</code> .  Este arquivo conterá um pedaço de texto que o aplicativo cliente deve exibir. </li><li>  Arquivo <code>Dockerfile</code> .  Este é um arquivo do Docker que conterá as instruções necessárias para criar um ambiente de servidor. </li></ul><br>  É assim que deve ser o conteúdo do seu <code>server/</code> pasta: <br><br><pre> <code class="plaintext hljs">. ├── Dockerfile ├── index.html └── server.py 0 directories, 3 files</code> </pre> <br><h4>  2b.  Editando um arquivo Python. </h4><br>  Adicione o seguinte código ao arquivo <code>server.py</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python3 #    python. #       -. #     - ,      Python. import http.server import socketserver #         . handler = http.server.SimpleHTTPRequestHandler #   ,        1234. #    ,        ,    docker-compose. with socketserver.TCPServer(("", 1234), handler) as httpd:   #       ,    .  httpd.serve_forever()</span></span></code> </pre> <br>  Este código permite criar um servidor web simples.  Ele fornecerá aos clientes o arquivo <code>index.html</code> , cujo conteúdo será exibido posteriormente na página da web. <br><br><h4>  2c.  Edição de arquivo HTML </h4><br>  Adicione o seguinte texto ao arquivo <code>index.html</code> : <br><br><pre> <code class="plaintext hljs">Docker-Compose is magic!</code> </pre> <br>  Este texto será transmitido ao cliente. <br><br><h4>  2d.  Editando o Dockerfile </h4><br>  Agora, criaremos um <code>Dockerfile</code> simples, que será responsável por organizar o tempo de execução do servidor Python.  Usaremos a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">imagem oficial</a> destinada à execução de programas escritos em Python como base da imagem criada.  Aqui está o conteúdo do Dockerfile: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ,  Dockerfile       . #      'FROM'. #      python ( DockerHub). #   ,    ,  'python',     - 'latest'. FROM python:latest #       ,   Python,     'server.py'  'index.html'. #     ,     'ADD'. #  , 'server.py',    ,   . #  , '/server/',  ,        . #        '/server/'. ADD server.py /server/ ADD index.html /server/ #     'WORKDIR', ,   . #      . #    ,      ,   '/server/'. WORKDIR /server/</span></span></code> </pre> <br>  Agora vamos trabalhar no cliente. <br><br><h3>  <font color="#3AC1EF">▍3</font>  <font color="#3AC1EF">Criação de Clientes</font> </h3><br>  Criando a parte do cliente do nosso projeto, recordaremos simultaneamente alguns dos conceitos básicos do Docker. <br><br><h4>  3a.  Criação de arquivo </h4><br>  Vá para a pasta do seu projeto do <code>client</code> e crie os seguintes arquivos nela: <br><br><ul><li>  O arquivo <code>client.py</code> .  Este será o código do cliente. </li><li>  Arquivo <code>Dockerfile</code> .  Este arquivo desempenha a mesma função que um arquivo semelhante na pasta do servidor.  Nomeadamente, contém instruções que descrevem a criação de um ambiente para executar o código do cliente. </li></ul><br>  Como resultado, seu <code>client/</code> pasta nesta fase do trabalho deve ficar assim: <br><br><pre> <code class="plaintext hljs">. ├── client.py └── Dockerfile 0 directories, 2 files</code> </pre> <br><h4>  3b  Edição de arquivos Python </h4><br>  Adicione o seguinte código ao arquivo <code>client.py</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python3 #    Python. #      'index.html'  . #     ,      Python. import urllib.request #      'http://localhost:1234/'. # ,      ,   'http://localhost:1234'. # localhost   ,      . # 1234 -   ,        . fp = urllib.request.urlopen("http://localhost:1234/") # 'encodedContent'     ('index.html'). # 'decodedContent'     (  ,      ). encodedContent = fp.read() decodedContent = encodedContent.decode("utf8") #   ,    ('index.html'). print(decodedContent) #    . fp.close()</span></span></code> </pre> <br>  Graças a esse código, o aplicativo cliente pode baixar dados do servidor e exibi-los na tela. <br><br><h4>  3c.  Editando o Dockerfile </h4><br>  Como no caso do servidor, criamos um <code>Dockerfile</code> simples para o cliente, responsável por criar o ambiente em que o aplicativo Python do cliente funcionará.  Aqui está o código do <code>Dockerfile</code> do cliente: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   ,     Dockerfile. FROM python:latest #  'client.py'   '/client/'. ADD client.py /client/ #      '/client/'. WORKDIR /client/</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍4</font>  <font color="#3AC1EF">Docker compor</font> </h3><br>  Como você deve ter notado, criamos dois projetos diferentes: o servidor e o cliente.  Cada um deles tem seu próprio <code>Dockerfile</code> .  Até agora, tudo o que acontece não vai além do básico de trabalhar com o Docker.  Agora estamos começando com o Docker Compose.  Para fazer isso, recorremos ao arquivo <code>docker-compose.yml</code> localizado na pasta raiz do projeto. <br><br>  Observe que aqui não estamos tentando considerar absolutamente todos os comandos que podem ser usados ​​no <code>docker-compose.yml</code> .  Nosso principal objetivo é fornecer um exemplo prático que fornece conhecimentos básicos sobre o Docker Compose. <br><br>  Aqui está o código para colocar no <code>docker-compose.yml</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  docker-compose     . #   "3"    -        . version: "3" #  ,  docker-composes   . # 1  = 1 . #    , ,   ... # ,     ,   'services'. services: #    ,       . #  ,     . #   (): . #    ,   . #       . #  ,    ,    'server'. server:   #   "build"     #    Dockerfile,      ,   #    .   #  'server/'     ,   #    Dockerfile.   build: server/   # ,      .   #     "python ./server.py".   command: python ./server.py   #   ,      'server/server.py'   1234.   #          (   ),   #         .   #       'ports'.   #      : [ ]:[ ]   #        1234         # 1234  (         #   ).   ports:     - 1234:1234 #   (): . #    'client'. client:   #  'client/    ,     #  Dockerfile    .   build: client/   # ,      .   #     "python ./client.py".   command: python ./client.py   #   'network_mode'     .   #    ,      'localhost' .   network_mode: host   #   'depends_on'  ,   ,   #   , ,       .   #  ,   'client'       'server'.   depends_on:     - server</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">▍5.</font>  <font color="#3AC1EF">Montagem do projeto</font> </h3><br>  Depois que todas as instruções necessárias estiverem incluídas no <code>docker-compose.yml</code> , o projeto precisará ser montado.  Esta etapa do nosso trabalho se assemelha ao uso do <code>docker build</code> , mas o comando correspondente está relacionado a vários serviços: <br><br><pre> <code class="plaintext hljs">$ docker-compose build</code> </pre> <br><h3>  <font color="#3AC1EF">§ 6</font>  <font color="#3AC1EF">Lançamento do projeto</font> </h3><br>  Agora que o projeto está concluído, é hora de iniciá-lo.  Esta etapa do nosso trabalho corresponde à etapa na qual, ao trabalhar com contêineres individuais, o comando <code>docker run</code> é executado: <br><br><pre> <code class="plaintext hljs">$ docker-compose up</code> </pre> <br>  Após executar este comando, o terminal deve exibir o texto baixado pelo cliente no servidor: <code>Docker-Compose is magic!</code>  . <br><br>  Como já mencionado, o servidor usa a porta <code>1234</code> do computador para atender às solicitações do cliente.  Portanto, se você acessar o navegador em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http: // localhost: 1234 /</a> , uma página com o texto <code>Docker-Compose is magic!</code> será exibida nela <code>Docker-Compose is magic!</code>  . <br><br><h2>  <font color="#3AC1EF">Comandos úteis</font> </h2><br>  Vejamos alguns dos comandos que você pode achar úteis ao trabalhar com o Docker Compose. <br><br>  Este comando permite parar e excluir contêineres e outros recursos criados pelo <code>docker-compose up</code> : <br><br><pre> <code class="plaintext hljs">$ docker-compose down</code> </pre> <br>  Este comando exibe os logs de serviço: <br><br><pre> <code class="plaintext hljs">$ docker-compose logs -f [service name]</code> </pre> <br>  Por exemplo, em nosso projeto, ele pode ser usado da seguinte forma: <code>$ docker-compose logs -f [service name]</code> . <br><br>  Usando este comando, você pode listar os contêineres: <br><br><pre> <code class="plaintext hljs">$ docker-compose ps</code> </pre> <br>  Este comando permite executar um comando em um contêiner em execução: <br><br><pre> <code class="plaintext hljs">$ docker-compose exec [service name] [command]</code> </pre> <br>  Por exemplo, pode ficar assim: <code>docker-compose exec server ls</code> . <br><br>  Este comando permite exibir uma lista de imagens: <br><br><pre> <code class="plaintext hljs">$ docker-compose images</code> </pre> <br><h2>  <font color="#3AC1EF">Sumário</font> </h2><br>  Examinamos os conceitos básicos do trabalho com a tecnologia Docker Compose, cujo conhecimento permitirá que você use essa tecnologia e, se desejar, inicie um estudo mais aprofundado.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui está o</a> repositório com o código do projeto que analisamos aqui. <br><br>  <b>Caros leitores!</b>  Você usa o Docker Compose em seus projetos? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt450312/">https://habr.com/ru/post/pt450312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt450300/index.html">Pare de discutir sobre programação funcional e POO</a></li>
<li><a href="../pt450302/index.html">Amateur Radio Technology: fabricação de protótipos de placas de circuito em uma fábrica chinesa</a></li>
<li><a href="../pt450304/index.html">Carapuzik montando uma formiga: 100 milhões de anos de mirmecofilia</a></li>
<li><a href="../pt450308/index.html">Rastreamento de GPU Ray no Unity - Parte 3</a></li>
<li><a href="../pt450310/index.html">Como o Philips VideoWRITER funciona. Primeiras fotos de ferro, depois um pouco de tédio</a></li>
<li><a href="../pt450314/index.html">TensorFlow para iniciantes. Parte 1: informações gerais, instalando a biblioteca</a></li>
<li><a href="../pt450316/index.html">TDD: uma metodologia de desenvolvimento que mudou minha vida</a></li>
<li><a href="../pt450318/index.html">Padrões de design no desenvolvimento moderno de JavaScript</a></li>
<li><a href="../pt450320/index.html">Jogos quânticos simples revelam a complexidade final do universo</a></li>
<li><a href="../pt450322/index.html">Por que precisamos de tantos mensageiros?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>