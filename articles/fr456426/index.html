<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåÑ ü¶å üïµüèæ BASS - un cadre pour la synth√®se automatique des signatures antivirus üë∂üèæ üîî üèä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous. Il reste moins de dix jours avant le d√©but du cours "Reverse Engineering" . A cet √©gard, nous souhaitons partager une autre traduction...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BASS - un cadre pour la synth√®se automatique des signatures antivirus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/456426/">  Bonjour √† tous.  Il reste moins de dix jours avant le d√©but du cours <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Reverse Engineering"</a> . A cet √©gard, nous souhaitons partager une autre traduction int√©ressante sur le sujet.  C'est parti! <br><br><img src="https://habrastorage.org/webt/ff/sk/na/ffsknagvtnwxc02g9xpjlu-0p1i.png"><br><br><h2>  Br√®ve revue </h2><br><img src="https://habrastorage.org/webt/hi/fs/gs/hifsgsy2jdczl7lk9n3zj1luisy.png"><br><br>  L'image des menaces √©volue rapidement - de nouvelles cyberattaques apparaissent constamment et les anciennes deviennent de plus en plus sophistiqu√©es.  Dans ces circonstances, les professionnels de la s√©curit√© sont confront√©s √† des d√©fis de plus en plus complexes.  Chaque jour, ils doivent traiter et analyser des millions d'√©chantillons de logiciels malveillants inconnus et compl√®tement nouveaux, d√©velopper des signatures antivirus efficaces pour d√©crire des familles enti√®res de programmes malveillants et assurer l'√©volutivit√© des outils √† mesure que le nombre d'√©chantillons √† analyser augmente.  Dans le m√™me temps, il est n√©cessaire de prendre en compte les ressources limit√©es pour les outils d'automatisation de l'analyse des logiciels malveillants.  Pour aider les professionnels de l'informatique √† relever ces diff√©rents d√©fis, Talos propose une nouvelle plateforme open source appel√©e BASS. <a name="habracut"></a><br><br>  BASS (lu comme ¬´basse¬ª) est un cadre pour g√©n√©rer automatiquement des signatures antivirus bas√©es sur des √©chantillons de clusters de code malveillant pr√©c√©demment form√©s.  Il vise √† r√©duire la consommation de ressources par le noyau ClamAV en augmentant la proportion de signatures bas√©es sur des mod√®les par rapport aux signatures de hachage, et √† simplifier le travail des analystes d√©veloppant des signatures bas√©es sur des mod√®les.  Avec la prise en charge du conteneur Docker, le cadre √©volue bien. <br><br>  Il convient de noter que jusqu'√† pr√©sent, seule la version alpha de BASS est disponible et qu'il reste beaucoup √† finaliser.  Ce projet a du code open source, et nous y travaillons activement, nous serons donc ravis de tout commentaire de la communaut√© et des recommandations pour son am√©lioration.  Le code source de BASS est disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Le projet BASS a √©t√© annonc√© en 2017 lors de la conf√©rence <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">REcon</a> √† Montr√©al, Canada. <br><br><h2>  Pertinence </h2><br>  Les sp√©cialistes Talos re√ßoivent quotidiennement plus de 1,5 million d'√©chantillons uniques.  Pour la plupart, ils concernent des menaces connues et sont imm√©diatement √©limin√©s par un scanner de malware (ClamAV).  Cependant, apr√®s la num√©risation, de nombreux fichiers n√©cessitent encore une analyse plus approfondie.  Nous les ex√©cutons dans le bac √† sable et effectuons une analyse dynamique, ce qui nous permet de les s√©parer en fichiers malveillants et s√ªrs.  Nous traitons les √©chantillons de logiciels malveillants s√©lectionn√©s √† ce stade afin de cr√©er des signatures ClamAV bas√©es sur eux, ce qui aidera √† filtrer davantage ces menaces √† un stade plus pr√©coce, lors de l'analyse. <br><br><img src="https://habrastorage.org/webt/5f/oh/6o/5foh6op04xmtrj7-7wuhy0ifkfm.jpeg"><br><br>  Pendant trois mois, de f√©vrier √† avril 2017, 560 000 nouvelles signatures ont √©t√© ajout√©es √† la base de donn√©es ClamAV, soit une augmentation de 9 500 signatures par jour.  Nous en avons re√ßu une partie importante sous forme de signatures de hachage.  De telles signatures ont un inconv√©nient important par rapport aux signatures de mod√®le ou de bytecode (ce sont deux autres types pris en charge par le noyau ClamAV): une signature de hachage correspond √† un seul fichier.  De plus, une augmentation du nombre de signatures de hachage conduit au fait que la base de donn√©es ClamAV occupe plus de m√©moire.  C'est pourquoi nous pr√©f√©rons les signatures bas√©es sur des mod√®les.  Ils sont beaucoup plus simples et plus rapides √† g√©rer que le bytecode, et en m√™me temps ils vous permettent de d√©crire des clusters de fichiers entiers. <br><br><h2>  Basse </h2><br>  Le cadre BASS est con√ßu pour faciliter la cr√©ation de mod√®les bas√©s sur la signature ClamAV.  Il les g√©n√®re automatiquement, traitant des segments de code ex√©cutable binaire. <br><br><img src="https://habrastorage.org/webt/ce/jt/ew/cejtew2tpxdzibmmqztxp88tija.jpeg"><br><br>  BASS prend comme base des clusters de code malveillant, mais n'inclut pas les moyens de les cr√©er.  Pour cette raison, la technologie reste pratique et flexible.  Nous avons intentionnellement rendu l'interface d'entr√©e universelle afin qu'elle soit facile √† adapter aux nouvelles sources de clusters.  Nous utilisons maintenant plusieurs de ces sources, y compris des clusters bas√©s sur des indicateurs de compromis (IoC) de notre bac √† sable, le hachage structurel (lorsque nous avons un fichier ex√©cutable sciemment malveillant et que nous recherchons des √©chantillons suppl√©mentaires qui sont de structure similaire) et les logiciels malveillants re√ßus des campagnes de spam. <br><br>  √Ä la premi√®re √©tape, les instances malveillantes passent par les d√©compresseurs du noyau ClamAV.  Il peut d√©compresser des archives de diff√©rents formats et des fichiers ex√©cutables compress√©s (par exemple, UPX), et √©galement extraire des objets incorpor√©s (tels que des fichiers EXE dans des documents Word).  Les artefacts re√ßus sont soigneusement analys√©s, des informations sont collect√©es.  Maintenant, pour la prochaine √©tape, le filtrage, nous utilisons leurs tailles et la cha√Æne magique UNIX. <br><br>  Ensuite, le cluster de code malveillant est filtr√©.  Si les fichiers ne r√©pondent pas aux exigences BASS (alors que la plate-forme ne fonctionne qu'avec des fichiers ex√©cutables PE, mais qu'il n'est pas difficile d'ajouter la prise en charge des fichiers binaires ELF et MACH-O), ils sont supprim√©s du cluster ou, s'il reste trop peu d'objets, le cluster est compl√®tement rejet√©. <br><br>  Le cluster filtr√© passe √† la phase de g√©n√©ration de signature.  Tout d'abord, les fichiers binaires sont d√©sassembl√©s.  Pour ce faire, nous utilisons IDA Pro, mais il peut √™tre facilement remplac√© par un autre d√©sassembleur aux capacit√©s similaires, par exemple, radare2. <br><br><img src="https://habrastorage.org/webt/cz/ah/gl/czahglwn1x_oflib8pokrduqeso.jpeg"><br><br>  Apr√®s d√©montage, il est n√©cessaire d'identifier un code commun dans les √©chantillons afin de g√©n√©rer des signatures sur sa base.  Cette √©tape est importante pour deux raisons.  Premi√®rement, l'algorithme de g√©n√©ration de signature n√©cessite des ressources de calcul importantes et fonctionne mieux avec des segments de code courts.  Deuxi√®mement, il est pr√©f√©rable d'obtenir des signatures d'√©chantillons de code similaires non seulement syntaxiquement, mais √©galement s√©mantiquement.  Pour comparer le code, nous utilisons l'utilitaire BinDiff.  Encore une fois, il est √©galement facile √† remplacer, et √† l'avenir, nous pourrons int√©grer d'autres utilitaires dans le cadre de comparaison. <br><br>  Si le cluster est petit, BinDiff compare chaque ex√©cutable avec tous les autres.  Sinon, la port√©e de la comparaison est r√©duite, sinon le processus peut √™tre trop long.  Sur la base des r√©sultats obtenus, un graphique est construit o√π les sommets d√©signent les fonctions et les ar√™tes indiquent leur similitude.  Pour trouver une bonne fonction g√©n√©rale, il suffit de trouver un sous-graphe connect√© avec un indice de similarit√© global √©lev√©. <br><br><img src="https://habrastorage.org/webt/uz/tk/nt/uztkntwexposekzfrzoskpmfotq.jpeg"><br><br>  Le sous-graphique ∆í1, ∆í2, ∆í4, ∆í6 avec des indicateurs de similarit√© de sommet √©lev√©s (voir la figure ci-dessus) est un excellent candidat pour le r√¥le d'une fonction commune. <br><br>  D√®s que plusieurs de ces candidats sont recrut√©s, nous les comparons avec la liste blanche pour √©viter de cr√©er des signatures bas√©es sur les fonctions ordinaires des biblioth√®ques associ√©es statiquement √† l'√©chantillon.  Pour ce faire, les fonctions sont envoy√©es √† l'instance <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kam1n0</a> , dont nous avons pr√©c√©demment rempli les fonctions √† partir d'√©chantillons √©videmment purs.  Si un clone d'une fonction est d√©tect√©, la proc√©dure de s√©lection de sous-graphe est r√©p√©t√©e afin de s√©lectionner la plus appropri√©e des autres.  Si la v√©rification ne r√©v√®le rien, l'ensemble des fonctions est pass√© √† l'√©tape suivante. <br><br>  La g√©n√©ration de la signature commence alors directement.  Les signatures ClamAV bas√©es sur un mod√®le sont con√ßues pour d√©tecter les sous-s√©quences dans les donn√©es binaires.  Par cons√©quent, nous appliquons √† toutes les fonctions extraites l'algorithme de recherche de la plus grande sous-s√©quence commune (LCS, Longest Common Subsequence). <br><br>  D'un point de vue informatique, cet algorithme est assez cher m√™me pour deux √©chantillons et est nettement plus difficile pour plusieurs, nous utilisons donc sa vari√©t√© heuristique, d√©crite par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Christian Blichmann</a> .  Le r√©sultat pourrait ressembler √† ceci: <br><br><img src="https://habrastorage.org/webt/zb/9_/il/zb9_ilfd2g0rcqw1nw1h5iblsi4.jpeg"><br><br>  Enfin, vous devez le tester avant de publier la signature.  Nous v√©rifions automatiquement la signature √† l'aide de notre suite de tests pour les faux positifs.  Pour plus de fiabilit√©, nous utilisons Sigalyzer, une nouvelle fonctionnalit√© de notre plug-in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CASC IDA Pro ClamAV pour g√©n√©rer et analyser des signatures</a> (il sera mis √† jour plus tard).  Sigalyzer marque les sections du binaire qui correspondent √† la signature ClamAV qui a fonctionn√© pour lui.  Ainsi, une repr√©sentation visuelle visuelle de la signature est form√©e. <br><br><h2>  L'architecture </h2><br>  BASS est impl√©ment√© comme un cluster de conteneurs Docker.  Le framework est √©crit en Python et interagit avec tous les outils n√©cessaires via des services web.  L'architecture a √©t√© cr√©√©e par analogie avec le projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VxClass</a> , qui a √©galement g√©n√©r√© des signatures ClamAV en utilisant IDA Pro et BinDiff, mais sera plus tard ferm√©e et, contrairement √† BASS, inaccessible au grand public. <br><br><img src="https://habrastorage.org/webt/wg/ma/x2/wgmax2n6nevnscpmjx_lijw9kmq.jpeg"><br><br><h2>  Limitations </h2><br>  BASS fonctionne exclusivement avec des ex√©cutables binaires, car la signature est g√©n√©r√©e √† partir de l'exemple de code.  De plus, il analyse uniquement les ex√©cutables x86 et x86_64.  La prise en charge d'autres architectures pourrait appara√Ætre √† l'avenir. <br><br>  Jusqu'√† pr√©sent, BASS ne g√®re pas bien les virus de fichiers, qui int√®grent des extraits de code petits et tr√®s diff√©rents dans les objets infect√©s, et les backdoors, principalement constitu√©s de code binaire inoffensif (souvent vol√©), qui sont compl√©t√©s par des fonctions malveillantes.  Nous luttons contre ces lacunes en travaillant √† optimiser la phase de clustering. <br><br>  Et encore une fois, nous voulons vous rappeler que BASS est au stade des tests alpha et que, jusqu'√† pr√©sent, tout ne fonctionne pas correctement.  Mais nous esp√©rons que nous profiterons √† la communaut√© en d√©veloppant ce cadre en tant que projet open source, et nous serons heureux de toutes les id√©es et critiques. <br><br><h2>  App </h2><br>  <i>La diff√©rence entre la plus grande sous-cha√Æne commune et la plus grande sous-s√©quence commune</i> <br><br>  L'illustration suivante montre la diff√©rence entre la plus grande sous-cha√Æne commune et la plus grande sous-s√©quence commune.  La plus grande sous-s√©quence commune est indiqu√©e dans notre publication par l'acronyme anglais LCS. <br><br><img src="https://habrastorage.org/webt/ul/ww/a8/ulwwa8nqjhgoblgtzgq_kkaygfc.jpeg"><br><br>  C‚Äôest tout.  Et d√©j√† le 20 juin, il sera possible de se familiariser en d√©tail avec le programme de cours lors de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la journ√©e portes ouvertes</a> , qui se tiendra en mode webinaire. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456426/">https://habr.com/ru/post/fr456426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456414/index.html">Protection contre les incendies dans les centres de donn√©es ou comment les donn√©es sont stock√©es</a></li>
<li><a href="../fr456416/index.html">Agile for All Book</a></li>
<li><a href="../fr456418/index.html">Une br√®ve histoire de la triche sur les jeux vid√©o</a></li>
<li><a href="../fr456422/index.html">Annonce d'une nouvelle version de Styled Components v5: Animal Grin</a></li>
<li><a href="../fr456424/index.html">Utreexo: compresser beaucoup de Bitcoin UTXO</a></li>
<li><a href="../fr456430/index.html">L'√©ternelle question de la dette technique</a></li>
<li><a href="../fr456432/index.html">Security Week 25: vuln√©rabilit√© d'Evernote et des centaines de boutiques en ligne pirat√©es</a></li>
<li><a href="../fr456434/index.html">Professions du futur: ¬´Qui travaillerez-vous sur Mars?¬ª</a></li>
<li><a href="../fr456436/index.html">T√¢che JS courte pour lundi</a></li>
<li><a href="../fr456440/index.html">Les aventures des Malvari insaisissables, partie I</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>