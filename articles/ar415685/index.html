<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ค๐ฟ ๐ด ๐ ุงููุดู ุนู ุงูุฐุงูุฑุฉ ููููุงุฉ ูู ูุธุงู ุงูุชุดุบูู ุงูุญุฏูุซ โ๐ฝ ๐ค ๐ฉ๐ปโ๐ณ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฌุฏ ุชุญุช ุงููุงุทุน ุชุฑุฌูุฉ ุงูุฌุฒุก ุงูุงูุชุชุงุญู ูู ุงููุณุชูุฏ " ุงููุดู ุนู ุฐุงูุฑุฉ Kernel Disclosure ูุน x86 Emulation and Taint Tracking ( Article Project Zero )" ุจูุงุณ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงููุดู ุนู ุงูุฐุงูุฑุฉ ููููุงุฉ ูู ูุธุงู ุงูุชุดุบูู ุงูุญุฏูุซ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415685/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> ููุฌุฏ ุชุญุช ุงููุงุทุน ุชุฑุฌูุฉ <strong>ุงูุฌุฒุก ุงูุงูุชุชุงุญู ูู</strong> ุงููุณุชูุฏ " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุดู ุนู ุฐุงูุฑุฉ Kernel Disclosure ูุน x86 Emulation and Taint Tracking</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Article Project Zero</a> )" ุจูุงุณุทุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Mateusz Jurczyk</a> . </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฌุฒุก ุงููุชุฑุฌู ูู ุงููุซููุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูุงุตูู ูุบุฉ ุงูุจุฑูุฌุฉ C (ูุฌุฒุก ูู ูุดููุฉ ุชูุณูุน ุงูุฐุงูุฑุฉ) </li><li style=";text-align:right;direction:rtl">  ุชูุงุตูู ุชุดุบูู ููุงุฉ Windows ู Linux (ูุฌุฒุก ูู ูุดููุฉ ุชูุณูุน ุงูุฐุงูุฑุฉ) </li><li style=";text-align:right;direction:rtl">  ุฃูููุฉ ุงููุดู ุนู ุฐุงูุฑุฉ kernel ูุชุฃุซูุฑู ุนูู ุฃูุงู ูุธุงู ุงูุชุดุบูู </li><li style=";text-align:right;direction:rtl">  ุงูุฃุณุงููุจ ูุงูุชูููุงุช ุงูููุฌูุฏุฉ ูุงูุชุดุงู ูููุงููุฉ ุงููุดู ุนู ุฐุงูุฑุฉ ุงูููุงุฉ </li></ul><br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุฑุบู ูู ุฃู ุงููุณุชูุฏ ูุฑูุฒ ุนูู ุขููุงุช ุงูุงุชุตุงู ุจูู kernel ุงููุชููุฒ ููุธุงู ุงูุชุดุบูู ูุชุทุจููุงุช ุงููุณุชุฎุฏู ุ ุฅูุง ุฃูู ูููู ุชุนููู ุฌููุฑ ุงููุดููุฉ ูุฃู ููู ููุจูุงูุงุช ุจูู ูุฌุงูุงุช ุงูุฃูุงู ุงููุฎุชููุฉ: ุจุฑูุงูุฌ hypervisor ูู ุฌูุงุฒ ุถูู ุ ูุฎุฏูุฉ ูุธุงู ูููุฒ (daemon) ูู ุชุทุจูู GUI ุ ุนููู ุงูุดุจูุฉ ูู ุฎุงุฏู ุ ุฅูุฎ. . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ne/uy/1q/neuy1q8npc2ba-y3vcaycx9kqxe.jpeg" alt="KDPV"></p><a name="habracut"></a><br><h2 id="vvedenie" style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ุชุชูุซู ุฅุญุฏู ููุงู ุฃูุธูุฉ ุงูุชุดุบูู ุงูุญุฏูุซุฉ ูู ุถูุงู ูุตู ุงูุงูุชูุงุฒุงุช ุจูู ุชุทุจููุงุช ุงููุณุชุฎุฏู ูููุงุฉ ูุธุงู ุงูุชุดุบูู.  ุฃููุงู ุ ูุชุถูู ุฐูู ุญูููุฉ ุฃู ุชุฃุซูุฑ ูู ุจุฑูุงูุฌ ุนูู ููุช ุงูุชุดุบูู ูุฌุจ ุฃู ูููู ูุญุฏูุฏูุง ุจุณูุงุณุฉ ุฃูููุฉ ูุนููุฉ ุ ูุซุงูููุง ุ ุฃูู ูููู ููุจุฑุงูุฌ ุงููุตูู ููุท ุฅูู ุงููุนูููุงุช ุงูุชู ููุณูุญ ููุง ุจูุฑุงุกุชูุง.  ูุงูุซุงูู ูู ุงูุตุนุจ ุชูููุฑู ุ ูุธุฑูุง ูุฎุตุงุฆุต ุงููุบุฉ C (ูุบุฉ ุงูุจุฑูุฌุฉ ุงูุฑุฆูุณูุฉ ุงููุณุชุฎุฏูุฉ ูู ุชุทููุฑ ุงูููุงุฉ) ุ ููุง ูุฌุนู ูู ุงูุตุนุจ ููุบุงูุฉ ููู ุงูุจูุงูุงุช ุจุฃูุงู ุจูู ูุฌุงูุงุช ุงูุฃูุงู ุงููุฎุชููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุธูุฉ ุงูุชุดุบูู ุงูุญุฏูุซุฉ ุงูุชู ุชุนูู ุนูู ููุตุงุช x86 / x86-64 ูุชุนุฏุฏุฉ ุงูุฎููุท ูุชุณุชุฎุฏู ูููุฐุฌ ุฎุงุฏู ุนููู ูุชู ููู ุชูููุฐ ุชุทุจููุงุช ูุถุน ุงููุณุชุฎุฏู (ุงูุนููุงุก) ุจุดูู ูุณุชูู ูุงุณุชุฏุนุงุก ููุงุฉ ูุธุงู ุงูุชุดุบูู (ุงูุฎุงุฏู) ุจูุตุฏ ุงูุนูู ูุน ููุฑุฏ ูุฏูุฑู ุงููุธุงู.  ุชูุณูู ุงูุขููุฉ ุงููุณุชุฎุฏูุฉ ูู ูุจู ุฑูุฒ ูุถุน ุงููุณุชุฎุฏู ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุญููุฉ 3</a> ) ูุงุณุชุฏุนุงุก ูุฌููุนุฉ ูุญุฏุฏุฉ ูุณุจููุง ูู ูุธุงุฆู kernel (ุงูุญููุฉ 0) ููุงููุงุช ุงููุธุงู ุฃู (ุฌูุณุงุช ููุฌุฒุฉ).  ูุธูุฑ ุงุณุชุฏุนุงุก ูุธุงู ูููุฐุฌู ูู ุงูุดูู 1: <br><img src="https://habrastorage.org/webt/dh/p3/hr/dhp3hruaqmh7onhd0mweycvv4bg.png" alt="ุงูุดูู 1: ุงุณุชุฏุนุงุก ุงููุธุงู"><br>  <em>ุงูุดูู 1: ุฏูุฑุฉ ุญูุงุฉ ุงุณุชุฏุนุงุก ุงููุธุงู.</em> </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููู ุฌุฏูุง ุชุฌูุจ ุชุณุฑูุจ ูุญุชููุงุช ุฐุงูุฑุฉ kernel ุนู ุบูุฑ ูุตุฏ ุนูุฏ ุงูุชูุงุนู ูุน ุจุฑุงูุฌ ูุถุน ุงููุณุชุฎุฏู.  ููุงู ุฎุทุฑ ูุจูุฑ ูู ุงููุดู ุนู ุจูุงูุงุช ุงูููุงุฉ ุงูุญุณุงุณุฉ.  ูููู ุฅุฑุณุงู ุงูุจูุงูุงุช ุจุดูู ุถููู ูู ูุนููุงุช ุงูุฅุฎุฑุงุฌ ูููุงููุงุช ุงููุธุงู ุงูุขููุฉ (ูู ูุฌูุงุช ูุธุฑ ุฃุฎุฑู). </p><br><p style=";text-align:right;direction:rtl">  ูุญุฏุซ ุงููุดู ุนู ุฐุงูุฑุฉ ุงููุธุงู ุงููููุฒุฉ ุนูุฏูุง ุชููู ููุงุฉ ูุธุงู ุงูุชุดุบูู ุจุฅุฑุฌุงุน ููุทูุฉ ูู ุงูุฐุงูุฑุฉ ุฃูุจุฑ (ุฃูุจุฑ) ููุง ูู ุถุฑูุฑู ูุชุฎุฒูู ุงููุนูููุงุช ุงูููุงุจูุฉ (ุงูููุฌูุฏุฉ ูู ุงูุฏุงุฎู).  ุบุงูุจูุง ูุง ุชุญุชูู ูุญุฏุงุช ุงูุจุงูุช ุงูุฒุงุฆุฏุฉ ุนูู ุจูุงูุงุช ุชู ููุคูุง ูู ุณูุงู ูุฎุชูู ุ ุซู ูู ูุชู ุชููุฆุฉ ุงูุฐุงูุฑุฉ ูุณุจููุง ุ ููุง ูููุน ุงูุชุดุงุฑ ุงููุนูููุงุช ูู ููุงูู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ. </p><br><h2 id="specifika-yazyka-programmirovaniya-c" style=";text-align:right;direction:rtl">  ุฎุตุงุฆุต ูุบุฉ ุงูุจุฑูุฌุฉ C </h2><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงููุณู ุ ูููู ูุธุฑุฉ ุนูู ุงูุนุฏูุฏ ูู ุฌูุงูุจ ุงููุบุฉ C ุงูุฃูุซุฑ ุฃูููุฉ ููุดููุฉ ุชูุณูุน ุงูุฐุงูุฑุฉ. </p><br><h4 id="neopredelennoe-sostoyanie-neinicializirovannyh-peremennyh" style=";text-align:right;direction:rtl">  ุญุงูุฉ ุบูุฑ ูุญุฏุฏุฉ ูู ุงููุชุบูุฑุงุช ุบูุฑ ุงููููุฃุฉ </h4><br><p style=";text-align:right;direction:rtl">  ุชุจูู ุงููุชุบูุฑุงุช ุงููุฑุฏูุฉ ูู ุงูุฃููุงุน ุงูุจุณูุทุฉ (ูุซู char ุฃู int) ุ ููุฐูู ุฃุนุถุงุก ููุงูู ุงูุจูุงูุงุช (ุงููุตูููุงุช ุ ูุงูุจูู ุ ูุงูุงุชุญุงุฏุงุช) ูู ุญุงูุฉ ุบูุฑ ูุญุฏุฏุฉ ุญุชู ุงูุชููุฆุฉ ุงูุฃููู (ุจุบุถ ุงููุธุฑ ุนูุง ุฅุฐุง ูุงูุช ููุถูุนุฉ ุนูู ุงูููุฏุณ ุฃู ูู ูููุฉ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ).  ุงูุชุจุงุณุงุช ุฐุงุช ุตูุฉ ูู ููุงุตูุงุช C11 (ISO / IEC 9899: ูุณูุฏุฉ ุงููุฌูุฉ 201x N1570 ุ ุฃุจุฑูู 2011): </p><br><blockquote style=";text-align:right;direction:rtl">  6.7.9 ุงูุชููุฆุฉ <br>  ... <br>  10 ุฅุฐุง ูู ุชุชู ุชููุฆุฉ ูุงุฆู ูู ูุฏุฉ ุชุฎุฒูู ุชููุงุฆูุฉ ุจุดูู ุตุฑูุญ ุ <u>ูุฅู ูููุชู ุบูุฑ ูุญุฏุฏุฉ</u> . <br><br>  7.22.3.4 ูุธููุฉ malloc <br>  ... <br>  2 ุชููู ุฏุงูุฉ malloc ุจุชุฎุตูุต ูุณุงุญุฉ ููุงุฆู ูุญุฏุฏ ุญุฌูู ุญุณุจ ุงูุญุฌู <u>ููููุชู ุบูุฑ ูุญุฏุฏุฉ</u> . <br><br>  7.22.3.5 ูุธููุฉ realloc <br>  ... <br>  2 ุชููู ุฏุงูุฉ realloc ุจุฅูุบุงุก ุชุฎุตูุต ุงููุงุฆู ุงููุฏูู ุงููุดุงุฑ ุฅููู ุจูุงุณุทุฉ ptr ูุฅุฑุฌุงุน ุงููุคุดุฑ ุฅูู ูุงุฆู ุฌุฏูุฏ ุจุญุฌู ูุญุฏุฏ ุญุณุจ ุงูุญุฌู.  ูุฌุจ ุฃู ุชููู ูุญุชููุงุช ุงูุดูุก ุงูุฌุฏูุฏ ููุงุซูุฉ ูุชูู ุงูููุฌูุฏุฉ ูู ุงููุงุฆู ุงููุฏูู ูุจู ุงูุชุฎุตูุต ุญุชู ุงูุญุฌู ุงูุฃุตุบุฑ ูุงููุฏูู.  ุฃู ุจุงูุช ูู ุงููุงุฆู ุงูุฌุฏูุฏ ูุชุฌุงูุฒ ุญุฌู ุงููุงุฆู ุงููุฏูู <u>ููุง ููู ุบูุฑ ูุญุฏุฏุฉ</u> . </blockquote><p style=";text-align:right;direction:rtl">  ุงูุฌุฒุก ุงูุฐู ููุทุจู ุนูู ุฑูุฒ ุงููุธุงู ูู ุงูุฃูุซุฑ ุตูุฉ ุจุงููุงุฆูุงุช ุงูููุฌูุฏุฉ ุนูู ุงูููุฏุณ ุ ุญูุซ ุฃู ููุงุฉ ูุธุงู ุงูุชุดุบูู ุนุงุฏุฉ ูุง ุชุญุชูู ุนูู ูุงุฌูุงุช ุชุฎุตูุต ุฏููุงููููุฉ ูุน ุฏูุงูุงุชูุง ุงูุฎุงุตุฉ (ูุง ุชุชูุงูู ุจุงูุถุฑูุฑุฉ ูุน ููุชุจุฉ C ุงูููุงุณูุฉ ุ ููุง ุณูุชู ูุตูู ูุงุญููุง). </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุญุฏ ุนูููุง ุ ูุง ููุฌุฏ ุฃู ูู ุซูุงุซุฉ ูุชุฑุฌููู C ุงูุฃูุซุฑ ุดููุนูุง ููุธุงูู ุงูุชุดุบูู Windows ู Linux (ูุชุฑุฌู Microsoft C / C ++ ุ gcc ุ LLVM) ููุดุฆ ุฑูุฒูุง ูููุฆ ูุณุจููุง ุงููุชุบูุฑุงุช ุบูุฑ ุงููุจุฑูุฌุฉ ูููุจุฑูุฌ ูู ุงูููุฏุณ ูู ูุถุน ุงูุจูุงุก (ุฃู ูุง ูุนุงุฏูู).  ููุงู ุฎูุงุฑุงุช ุงููุชุฑุฌู ููุถุน ุนูุงูุงุช ุนูู ุฅุทุงุฑุงุช ุงูููุฏุณ ูุน ูุญุฏุงุช ุจุงูุช - ุนูุงูุงุช ุฎุงุตุฉ (/ RTCs ูู Microsoft Visual Studio ุ ุนูู ุณุจูู ุงููุซุงู) ูููู ูุง ูุชู ุงุณุชุฎุฏุงููุง ูู ุฅุตุฏุงุฑุงุช ุงูุฅุตุฏุงุฑ ูุฃุณุจุงุจ ุชุชุนูู ุจุงูุฃุฏุงุก.  ููุชูุฌุฉ ูุฐูู ุ <em>ุชุฑุซ</em> ุงููุชุบูุฑุงุช ุบูุฑ ุงููููุฃุฉ ุนูู ุงูููุฏุณ ุงูููู ุงููุฏููุฉ ูููุงุทู ุงูุฐุงูุฑุฉ ุงูููุงุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุถุน ูู ุงุนุชุจุงุฑู ูุซุงูุงู ุนูู ุงูุชูููุฐ ุงูููุงุณู ูููุงููุฉ ูุธุงู Windows ุงูููููุฉ ุงูุชู ุชุถุงุนู ุนุฏุฏูุง ุตุญูุญูุง ููุฅุฏุฎุงู ุจููุฏุงุฑ ุงุซููู ูุชุนุฑุถ ูุชูุฌุฉ ุงูุถุฑุจ (ุงููุงุฆูุฉ 1).  ูู ุงููุงุถุญ ุฃูู ูู ุงูุญุงูุฉ ุงูุฎุงุตุฉ (InputValue == 0) ุ ูุธู OutputValue ุบูุฑ ูููุฃ ููุชู ูุณุฎู ูุฑุฉ ุฃุฎุฑู ุฅูู ุงูุนููู.  ูุณูุญ ูู ูุฐุง ุงูุฎุทุฃ ุจูุชุญ ุฃุฑุจุนุฉ ุจุงูุช ูู ุฐุงูุฑุฉ ููุฏุณ kernel ููู ููุงููุฉ. </p><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">NTSTATUS NTAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NtMultiplyByTwo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DWORD InputValue, LPDWORD OutputPointer)</span></span></span><span class="hljs-function"> </span></span>{ DWORD OutputValue; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (InputValue != <span class="hljs-number"><span class="hljs-number">0</span></span>) { OutputValue = InputValue * <span class="hljs-number"><span class="hljs-number">2</span></span>; } *OutputPointer = OutputValue; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STATUS_SUCCESS; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ุณุฑุฏ ุงูุฑูุฒ 1: ุชูุณูุน ุงูุฐุงูุฑุฉ ูู ุฎูุงู ูุชุบูุฑ ูุญูู ุบูุฑ ูููุฃ.</em> </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุณุฑุจ ูู ุฎูุงู ูุชุบูุฑ ูุญูู ุบูุฑ ูููุฃ ููุณ ุดุงุฆุนูุง ุฌุฏูุง ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ: ูู ูุงุญูุฉ ุ ุบุงูุจูุง ูุง ููุชุดู ุงููุชุฑุฌููู ุงูุญุฏูุซูู ููุญุฐุฑูู ูู ูุซู ูุฐู ุงููุดุงูู ุ ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุซู ูุฐู ุงูุชุณุฑูุจุงุช ูู ุฃุฎุทุงุก ูุธูููุฉ ูููู ุงูุชุดุงููุง ุฃุซูุงุก ุงูุชุทููุฑ ุฃู ุงูุงุฎุชุจุงุฑ.  ููุน ุฐูู ุ ููุถุญ ุงููุซุงู ุงูุซุงูู (ูู ุงููุงุฆูุฉ 2) ุฃูู ูููู ุฃู ูุญุฏุซ ุชุณุฑุจ ุฃูุถูุง ูู ุฎูุงู ุญูู ุงููููู. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐู ุงูุญุงูุฉ ุ ูุง ูุชู ุงุณุชุฎุฏุงู ุญูู ุงูุจููุฉ ุงููุญุฌูุฒุฉ ุจุดูู ุตุฑูุญ ูุทูููุง ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ูููู ูุง ูุฒุงู ูุชู ูุณุฎู ูุฑุฉ ุฃุฎุฑู ุฅูู ูุถุน ุงููุณุชุฎุฏู ุ ูุจุงูุชุงูู ุ ูุนุฑุถ ุฃูุถูุง ุฃุฑุจุนุฉ ุจุงูุช ูู ุฐุงูุฑุฉ kernel ุฅูู ุฑูุฒ ุงูุงุณุชุฏุนุงุก.  ููุถุญ ูุฐุง ุงููุซุงู ุจูุถูุญ ุฃู ุชููุฆุฉ ูู ุญูู ูู ูู ุจููุฉ ูุชู ุฅุฑุฌุงุนูุง ุฅูู ุงูุนููู ูุฌููุน ูุฑูุน ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ููุณุช ูููุฉ ุณููุฉ.  ูู ูุซูุฑ ูู ุงูุญุงูุงุช ุ ุชุจุฏู ุงูุชููุฆุฉ ุงููุณุฑูุฉ ุบูุฑ ููุทููุฉ ุ ุฎุงุตุฉ ุฅุฐุง ูุงู ูุฐุง ุงููุฌุงู ูุง ููุนุจ ุฃู ุฏูุฑ ุนููู.  ูููู ุงูุญูููุฉ ูู ุฃู ูุชุบูุฑูุง ุบูุฑ ูููุฃ (ุฃู ุญูู ุจููุฉ) ุนูู ุงูููุฏุณ (ุฃู ุนูู ุงููููุฉ) ููุจู ูุญุชููุงุช ุงูุจูุงูุงุช ุงููุฎุฒูุฉ ุณุงุจููุง ูู ููุทูุฉ ุงูุฐุงูุฑุฉ ูุฐู (ูู ุณูุงู ุนูููุฉ ุฃุฎุฑู) ุ ููุน ูู ููุจ ูุดููุฉ ุชูุณูุน ุฐุงูุฑุฉ kernel. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SYSCALL_OUTPUT</span></span></span><span class="hljs-class"> {</span></span> DWORD Sum; DWORD Product; DWORD Reserved; } SYSCALL_OUTPUT, *PSYSCALL_OUTPUT; <span class="hljs-function"><span class="hljs-function">NTSTATUS NTAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NtArithOperations</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DWORD InputValue, PSYSCALL_OUTPUT OutputPointer )</span></span></span><span class="hljs-function"> </span></span>{ SYSCALL_OUTPUT OutputStruct; OutputStruct.Sum = InputValue + <span class="hljs-number"><span class="hljs-number">2</span></span>; OutputStruct.Product = InputValue * <span class="hljs-number"><span class="hljs-number">2</span></span>; RtlCopyMemory(OutputPointer, &amp;OutputStruct, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(SYSCALL_OUTPUT)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STATUS_SUCCESS; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ูุงุฆูุฉ 2: ุชูุณูุน ุงูุฐุงูุฑุฉ ูู ุฎูุงู ูุฌุงู ูููู ูุญุฌูุฒ.</em> </p><br><h4 id="vyravnivanie-struktur-i-zapolnyayuschie-padding-bayty" style=";text-align:right;direction:rtl">  ูุญุงุฐุงุฉ ุงูููุงูู ูุงูุจุงูุชุงุช ุงูุญุดู </h4><br><p style=";text-align:right;direction:rtl">  ุชุนุชุจุฑ ุชููุฆุฉ ุฌููุน ุญููู ุจููุฉ ุงูุฅุฎุฑุงุฌ ุจุฏุงูุฉ ุฌูุฏุฉ ูุชุฌูุจ ุชูุณูุน ุงูุฐุงูุฑุฉ.  ูููู ูุฐุง ูุง ูููู ูุถูุงู ุนุฏู ูุฌูุฏ ูุญุฏุงุช ุจุงูุช ุบูุฑ ูุญุฏุฏุฉ ูู ุงูุชูุซูู ุฐู ุงููุณุชูู ุงูููุฎูุถ.  ุฏุนูุง ูุนูุฏ ุฅูู ููุงุตูุงุช C11: </p><br><blockquote style=";text-align:right;direction:rtl">  6.5.3.4 ุญุฌู ูุดุบูู ู Alignof <br>  ... <br>  4 [...] ุนูุฏ ุชุทุจููู ุนูู ููุนุงูู ูู ุจููุฉ ุฃู ููุน ุงุชุญุงุฏ ุ ุชููู ุงููุชูุฌุฉ ูู ุฅุฌูุงูู ุนุฏุฏ ูุญุฏุงุช ุงูุจุงูุช ูู ูุฐุง ุงููุงุฆู ุ <u>ุจูุง ูู ุฐูู ุงููุณุงุญุฉ ุงููุชุฑููุฉ ุงูุฏุงุฎููุฉ ูุงููุงุญูุฉ</u> . <br><br>  6.2.8 ูุญุงุฐุงุฉ ุงูุฃุดูุงุก <br>  1 ุฃููุงุน ุงููุงุฆูุงุช ุงููุงููุฉ ููุง ูุชุทูุจุงุช ูุญุงุฐุงุฉ ุชุถุน <u>ูููุฏูุง ุนูู ุงูุนูุงููู ุงูุชู ูููู ุชุฎุตูุต ูุงุฆูุงุช ูู ูุฐุง ุงูููุน ููุง</u> .  ุงููุญุงุฐุงุฉ ูู ูููุฉ ุนุฏุฏูุฉ ูุชูุงููุฉ ูุญุฏุฏุฉ ูู ูุจู ุงูุชูููุฐ ุชูุซู ุนุฏุฏ ุงูุจุงูุชุงุช ุจูู ุงูุนูุงููู ุงููุชุชุงููุฉ ุงูุชู ูููู ุชุฎุตูุต ูุงุฆู ูุนูู ุนูุฏูุง.  [...] <br><br>  6/7/2/1 ูุญุฏุฏุงุช ุงููููู ูุงูููุงุจุงุช <br>  ... <br>  17 <u>ูุฏ ูููู ููุงู ุญุดู ุบูุฑ ูุณูู ูู ููุงูุฉ ูููู ุฃู ุงุชุญุงุฏ</u> . </blockquote><p style=";text-align:right;direction:rtl">  ุฃู ุฃู ุฌุงูุนู ูุบุฉ C ูุจููุงุช x86 (-64) ูุณุชุฎุฏููู ุงููุญุงุฐุงุฉ ุงูุทุจูุนูุฉ ูุญููู ุงูููุงูู (ุงูุชู ููุง ููุน ุจุฏุงุฆู): ูู ุญูู ูู ูุฐุง ุงููุจูู ูุชู ูุญุงุฐุงุชู ุจูุงุณุทุฉ N ุจุงูุช ุ ุญูุซ N ูู ุญุฌู ุงูุญูู.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุชู ุฃูุถูุง ูุญุงุฐุงุฉ ุงูููุงูู ูุงูุตูุงุช ุจุงููุงูู ุนูุฏูุง ูุชู ุงูุฅุนูุงู ุนููุง ูู ุตููู ุ ููุชู ุงุณุชููุงุก ูุชุทูุจุงุช ูุญุงุฐุงุฉ ุงูุญููู ุงููุชุฏุงุฎูุฉ.  ูุถูุงู ุงููุญุงุฐุงุฉ ุ ูุชู ุฅุฏุฑุงุฌ ูุญุฏุงุช ุจุงูุช ุงูุญุดู ุงูุถูููุฉ ูู ุงูููุงูู ุนูุฏ ุงูุถุฑูุฑุฉ.  ุนูู ุงูุฑุบู ูู ุฃูู ูุง ูููู ุงููุตูู ุฅูููุง ูุจุงุดุฑุฉ ูู ุดูุฑุฉ ุงููุตุฏุฑ ุ ุฅูุง ุฃู ูุฐู ุงูุจุงูุช ุชุฑุซ ุฃูุถูุง ุงูููู ุงููุฏููุฉ ูู ููุงุทู ุงูุฐุงูุฑุฉ ููููููุง ููู ุงููุนูููุงุช ุฅูู ูุถุน ุงููุณุชุฎุฏู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุซุงู ุงูููุฌูุฏ ูู ุงููุงุฆูุฉ 3 ุ ูุชู ุฅุฑุฌุงุน ุจููุฉ SYSCALL_OUTPUT ุฅูู ุฑูุฒ ุงูุงุณุชุฏุนุงุก.  ูุญุชูู ุนูู 4 ู 8 ุญููู ุจุงูุช ุ ููุตููุฉ ุจู 4 ุจุงูุช ุญุดู ุ ุถุฑูุฑูุฉ ูุนููุงู ุญูู LargeSum ููุตุจุญ ูุถุงุนููุง ูู 8.  ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ููุง ุงูุญูููู ุชูุช ุชููุฆุชููุง ุจุดูู ุตุญูุญ ุ ุฅูุง ุฃูู ูู ูุชู ุชุนููู ุจุงูุชุงุช ุงูุญุดู ุจุดูู ุตุฑูุญ ุ ููุง ูุคุฏู ูุฑุฉ ุฃุฎุฑู ุฅูู ุชูุณูุน ุฐุงูุฑุฉ ููุฏุณ ุงูููุงุฉ.  ููุถุญ ุงูุดูู 2 ุงููููุน ุงููุญุฏุฏ ูููููู ูู ุงูุฐุงูุฑุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SYSCALL_OUTPUT</span></span></span><span class="hljs-class"> {</span></span> DWORD Sum; QWORD LargeSum; } SYSCALL_OUTPUT, *PSYSCALL_OUTPUT; <span class="hljs-function"><span class="hljs-function">NTSTATUS NTAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NtSmallSum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DWORD InputValue, PSYSCALL_OUTPUT OutputPointer )</span></span></span><span class="hljs-function"> </span></span>{ SYSCALL_OUTPUT OutputStruct; OutputStruct.Sum = InputValue + <span class="hljs-number"><span class="hljs-number">2</span></span>; OutputStruct.LargeSum = <span class="hljs-number"><span class="hljs-number">0</span></span>; RtlCopyMemory(OutputPointer, &amp;OutputStruct, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(SYSCALL_OUTPUT)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STATUS_SUCCESS; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ูุงุฆูุฉ 3: ุชูุณูุน ุงูุฐุงูุฑุฉ ุนู ุทุฑูู ูุญุงุฐุงุฉ ุงููููู.</em> </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/pw/i1/1a/pwi11anmkjf_ujlkogv2bjmbsuo.png" alt="ุงูุดูู 2: ูุญุงุฐุงุฉ ุงููููู"><br>  ุงูุดูู 2: ุชูุซูู ุงูุจููุฉ ูู ุงูุฐุงูุฑุฉ ูุน ูุถุน ุงููุญุงุฐุงุฉ ูู ุงูุงุนุชุจุงุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุชุณุฑูุจุงุช ูู ุฎูุงู ุงููุญุงุฐุงุฉ ุดุงุฆุนุฉ ูุณุจููุง ุ ูุธุฑูุง ูุฃู ุงูุนุฏูุฏ ูู ูุนููุงุช ุงูุฅุฎุฑุงุฌ ูููุงููุงุช ุงููุธุงู ูุชู ุชูุซูููุง ุจูุงุณุทุฉ ุงูููุงูู.  ุชููู ุงููุดููุฉ ุญุงุฏุฉ ุจุดูู ุฎุงุต ูููุตุงุช 64 ุจุช ุ ุญูุซ ูุฒูุฏ ุญุฌู ุงููุคุดุฑุงุช ุ ู size_t ุ ูุงูุฃููุงุน ุงูููุงุซูุฉ ูู 4 ุฅูู 8 ุจุงูุช ุ ููุง ูุคุฏู ุฅูู ุธููุฑ ุงูุญุดู ุงูุถุฑูุฑู ููุญุงุฐุงุฉ ุญููู ูุฐู ุงูููุงูู. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃูู ูุง ูููู ูุนุงูุฌุฉ ูุญุฏุงุช ุจุงูุช ุงูุญุดู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุตุฏุฑ ุ ููู ุงูุถุฑูุฑู ุงุณุชุฎุฏุงู memset ุฃู ูุธููุฉ ูุดุงุจูุฉ ูุฅุนุงุฏุฉ ุชุนููู ููุทูุฉ ุงูุฐุงูุฑุฉ ุจุงููุงูู ูููููู ูุจู ุชููุฆุฉ ุฃู ูู ุญููููุง ููุณุฎูุง ุฅูู ูุถุน ุงููุณุชุฎุฏู ุ ุนูู ุณุจูู ุงููุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(&amp;OutputStruct, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(OutputStruct));</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ูุฅู Seacord RC ูู ูุชุงุจูุง "ูุนูุงุฑ CERT C Coding Standard ุ ุงูุฅุตุฏุงุฑ ุงูุซุงูู: 98 ููุงุนุฏ ูุชุทููุฑ ุฃูุธูุฉ ุขููุฉ ูููุซููุฉ ูุขููุฉ. Addison-Wesley Professional" 2014 ููุต ุนูู ุฃู ูุฐุง ููุณ ุญูุงู ูุซุงูููุง ูุฃู ุญุดู ุงูุจุงูุชุงุช ) ูุฏ ูุง ุชุฒุงู <em>ุชุฑุณูุชูุง</em> ุจุนุฏ ุงุณุชุฏุนุงุก memset ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุฃุซุฑ ุฌุงูุจู ููุนูููุงุช ูุน ุงูุญููู ุงููุฌุงูุฑุฉ.  ูููู ุชุจุฑูุฑ ุงูููู ูู ุฎูุงู ุงูุจูุงู ุงูุชุงูู ูู ุงูููุงุตูุงุช C: </p><br><blockquote style=";text-align:right;direction:rtl">  6.2.6 ุชูุซููุงุช ุงูุฃููุงุน <br>  6.2.6.1 ุนุงู <br>  ... <br>  6 <u>ุนูุฏูุง ูุชู ุชุฎุฒูู ุงููููุฉ ูู ูุงุฆู ูู ุงูุจููุฉ ุฃู ููุน ุงูุงุชุญุงุฏ</u> ุ ุจูุง ูู ุฐูู ูู ูุงุฆู ุนุถู ุ ูุฅู ูุญุฏุงุช ุจุงูุช ุชูุซูู ุงููุงุฆู ุงูุชู ุชุชูุงูู ูุน <u>ุฃู ุจุงูุชุงุช ุญุดู ุชุฃุฎุฐ ููููุง ุบูุฑ ูุญุฏุฏุฉ</u> .  [...] </blockquote><p style=";text-align:right;direction:rtl">  ููุน ุฐูู ุ ูู ุงููุงุญูุฉ ุงูุนูููุฉ ุ ูู ููู ุฃู ูู ุงููุชุฑุฌููู C ุงูุฐูู ูููุง ุจุงุฎุชุจุงุฑูู ุจูุฑุงุกุชู ุฃู ูุชุงุจุชู ุฎุงุฑุฌ ููุงุทู ุงูุฐุงูุฑุฉ ููุญููู ุงููุนููุฉ ุจุดูู ุตุฑูุญ.  ูุจุฏู ุฃู ูุฐุง ุงูุฑุฃู ูุดุงุฑูู ูุทูุฑู ุฃูุธูุฉ ุงูุชุดุบูู ุงูุชู ุชุณุชุฎุฏู memset. </p><br><h4 id="obedineniya-unions-i-polya-raznogo-razmera" style=";text-align:right;direction:rtl">  ุงูููุงุจุงุช ูุงููุฌุงูุงุช ุจุฃุญุฌุงู ูุฎุชููุฉ </h4><br><p style=";text-align:right;direction:rtl">  ุงูุตูุงุช ูู ุจููุฉ ูุบุฉ C ูุนูุฏุฉ ุฃุฎุฑู ูู ุณูุงู ุงูุงุชุตุงู ุจุฑูุฒ ุงุชุตุงู ุฃูู ุงูุชูุงุฒูุง.  ุถุน ูู ุงุนุชุจุงุฑู ููู ุชุตู ููุงุตูุงุช C11 ุชูุซูู ุงูููุงุจุงุช ูู ุงูุฐุงูุฑุฉ: </p><br><blockquote style=";text-align:right;direction:rtl">  6.2.5 ุงูุฃููุงุน <br>  ... <br>  20 ูููู ุฅูุดุงุก ุฃู ุนุฏุฏ ูู ุงูุฃููุงุน ุงููุดุชูุฉ ูู ุฃููุงุน ุงููุงุฆูุงุช ูุงููุธุงุฆู ุ ุนูู ุงููุญู ุงูุชุงูู: [...] <u>ูุตู ููุน ุงูุงุชุญุงุฏ ูุฌููุนุฉ ุบูุฑ ูุชุฏุงุฎูุฉ ูู ูุงุฆูุงุช ุงูุฃุนุถุงุก</u> ุ ููู ูููุง ุงุณู ูุญุฏุฏ ุงุฎุชูุงุฑููุง ูุฑุจูุง ููุนูุง ูููุฒูุง. <br><br>  6/7/2/1 ูุญุฏุฏุงุช ุงููููู ูุงูููุงุจุงุช <br>  ... <br>  6 ููุง ูููุด ูู 6.2.5 ุ ุงููููู ูู ููุน ูุชููู ูู ุชุณูุณู ูู ุงูุฃุนุถุงุก ุ ูุชู ุชุฎุตูุต ุชุฎุฒููู ูู ุชุณูุณู ูุฑุชุจ ุ <u>ูุงูุงุชุญุงุฏ ูู ููุน ูุชููู ูู ุชุณูุณู ูู ุงูุฃุนุถุงุก ุงูุฐูู ูุชุฏุงุฎู ุชุฎุฒูููู</u> . <br>  ... <br>  16 <u>ุญุฌู ุงูุงุชุญุงุฏ ูููู ูุงุญุชูุงุก ุฃูุจุฑ ุนุฏุฏ ูู ุฃุนุถุงุฆู</u> .  ูููู ุชุฎุฒูู ูููุฉ ุนุถู ูุงุญุฏ ุนูู ุงูุฃูุซุฑ ูู ูุงุฆู ููุงุจู ูู ุฃู ููุช. </blockquote><p style=";text-align:right;direction:rtl">  ุชููู ุงููุดููุฉ ูู ุฃูู ุฅุฐุง ูุงู ุงูุงุชุญุงุฏ ูุชููู ูู ุนุฏุฉ ุญููู ุฐุงุช ุฃุญุฌุงู ูุฎุชููุฉ ูุชู ุชููุฆุฉ ุญูู ูุงุญุฏ ููุท ุจุญุฌู ุฃุตุบุฑ ุจุดูู ุตุฑูุญ ุ ูุฅู ูุญุฏุงุช ุงูุจุงูุช ุงููุชุจููุฉ ุงููุฎุตุตุฉ ูุงุณุชูุนุงุจ ุงูุญููู ุงููุจูุฑุฉ ุชุธู ุบูุฑ ูููุฃุฉ.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ูุซุงู ููุนุงูุฌ ุงุณุชุฏุนุงุก ุงููุธุงู ุงูุงูุชุฑุงุถู ุ ููุง ูู ููุถุญ ูู ุงููุงุฆูุฉ 4 ุ ุฅูู ุฌุงูุจ ุชุฎุตูุต ุฐุงูุฑุฉ ุงุชุญุงุฏ SYSCALL_OUTPUT ุงูููุถุญุฉ ูู ุงูุดูู 3. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> _SYSCALL_OUTPUT { DWORD Sum; QWORD LargeSum; } SYSCALL_OUTPUT, *PSYSCALL_OUTPUT; <span class="hljs-function"><span class="hljs-function">NTSTATUS NTAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NtSmallSum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( DWORD InputValue, PSYSCALL_OUTPUT OutputPointer )</span></span></span><span class="hljs-function"> </span></span>{ SYSCALL_OUTPUT OutputStruct; OutputStruct.Sum = InputValue + <span class="hljs-number"><span class="hljs-number">2</span></span>; RtlCopyMemory(OutputPointer, &amp;OutputStruct, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(SYSCALL_OUTPUT)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STATUS_SUCCESS; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ูุงุฆูุฉ ุงูุฑูุฒ 4: ุชูุณูุน ุงูุฐุงูุฑุฉ ุนู ุทุฑูู ุงูุชููุฆุฉ ุงูุฌุฒุฆูุฉ ููููุงุจุฉ.</em> </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/pa/8y/ck/pa8yckhciassiwm9yc19nssczwo.png" alt="ุงูุดูู 3: ูุญุงุฐุงุฉ ุตูุฉ"><br>  <em>ุงูุดูู 3: ุชูุซูู ุงูุงุชุญุงุฏ ูู ุงูุฐุงูุฑุฉ ูุน ุงููุญุงุฐุงุฉ.</em> </p><br><p style=";text-align:right;direction:rtl">  ุงุชุถุญ ุฃู ุงูุญุฌู ุงูุฅุฌูุงูู ูุงุชุญุงุฏ SYSCALL_OUTPUT ูู 8 ุจุงูุช (ุจุณุจุจ ุญุฌู ุญูู LargeSum ุงูุฃูุจุฑ).  ููุน ุฐูู ุ ุชููู ุงูุฏุงูุฉ ุจุชุนููู ูููุฉ ุงูุญูู ุงูุฃุตุบุฑ ููุท ุ ุชุงุฑูุฉ 4 ุจุงูุชุงุช ุฒุงุฆุฏุฉ ุบูุฑ ูููุฃุฉ ุ ููุง ูุคุฏู ูุงุญููุง ุฅูู ุญุฏูุซ ุชุณุฑุจ ูุชุทุจูู ุงูุนููู ุงูุฎุงุต ุจูู. </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู ุงูุชุทุจูู ุงูุขูู ุจุชุนููู ุญูู Sum ููุท ูู ูุณุงุญุฉ ุนููุงู ุงููุณุชุฎุฏู ุ ูุนุฏู ูุณุฎ ุงููุงุฆู ุจุงููุงูู ูุน ููุงุทู ุฐุงูุฑุฉ ูุญุชูู ุฃู ุชููู ุบูุฑ ูุณุชุฎุฏูุฉ.  ุฅุตูุงุญ ุนูู ุขุฎุฑ ูู ุงุณุชุฏุนุงุก ูุธููุฉ memset ูุฅูุบุงุก ูุณุฎุฉ ูู ุงูุงุชุญุงุฏ ูู ุฐุงูุฑุฉ kernel ูุจู ุชุนููู ุฃู ูู ุญููููุง ูููููุง ุฅูู ูุถุน ุงููุณุชุฎุฏู. </p><br><h4 id="nebezopasnyy-sizeof" style=";text-align:right;direction:rtl">  ุญุฌู ุบูุฑ ุขูู </h4><br><p style=";text-align:right;direction:rtl">  ููุง ูู ููุถุญ ูู ุงููุณููู ุงูุณุงุจููู ุ ูุฅู ุงุณุชุฎุฏุงู ุนุงูู ุงูุชุดุบูู sizeof ูููู ุฃู ูุณุงูู ุจุดูู ูุจุงุดุฑ ุฃู ุบูุฑ ูุจุงุดุฑ ูู ุงููุดู ุนู ุฐุงูุฑุฉ kernel ุ ููุง ูุชุณุจุจ ูู ูุณุฎ ุจูุงูุงุช ุฃูุซุฑ ูู ุงูุชููุฆุฉ ุงูุณุงุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุง ููุชูู C ุงูุฌูุงุฒ ุงูุถุฑูุฑู ูููู ุงูุจูุงูุงุช ุจุฃูุงู ูู ุงูููุงุฉ ุฅูู ูุณุงุญุฉ ุงููุณุชุฎุฏู - ุฃู ุจุดูู ุฃุนู ุจูู ุฃู ุณูุงูุงุช ุฃูููุฉ ูุฎุชููุฉ.  ูุง ุชุญุชูู ุงููุบุฉ ุนูู ุจูุงูุงุช ุชุนุฑูู ููุช ุงูุชุดุบูู ุงูุชู ูููู ุฃู ุชุดูุฑ ุตุฑุงุญุฉู ุฅูู ูุญุฏุงุช ุงูุจุงูุช ุงูุชู ุชู ุชุนููููุง ูู ูู ุจููุฉ ุจูุงูุงุช ูุชู ุงุณุชุฎุฏุงููุง ููุชูุงุนู ูุน ููุงุฉ ูุธุงู ุงูุชุดุบูู.  ููุชูุฌุฉ ูุฐูู ุ ุชูุน ุงููุณุคูููุฉ ุนูู ุงููุจุฑูุฌ ุ ุงูุฐู ูุฌุจ ุนููู ุชุญุฏูุฏ ุฃุฌุฒุงุก ูู ูุงุฆู ูุฌุจ ุชูุฑูุฑูุง ุฅูู ุฑูุฒ ุงูุงุณุชุฏุนุงุก.  ุฅุฐุง ุชู ุฐูู ุจุดูู ุตุญูุญ ุ ูุณุชุญุชุงุฌ ุฅูู ูุชุงุจุฉ ูุธููุฉ ูุณุฎ ุขููุฉ ูููุตูุฉ ููู ุจููุฉ ุฅุฎุฑุงุฌ ูุณุชุฎุฏูุฉ ูู ููุงููุงุช ุงููุธุงู.  ููุฐุง ุจุฏูุฑู ุณูุคุฏู ุฅูู ุงูุชูุงุฎ ูู ุญุฌู ุงูููุฏ ุ ูุชุฏููุฑ ูู ุณูููุฉ ูุฑุงุกุชู ุ ูุจุดูู ุนุงู ุณูููู ูููุฉ ุดุงูุฉ ููุณุชูููุฉ ููููุช. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูู ุงูุณูู ูุงูุจุณูุท ูุณุฎ ููุทูุฉ ุงูุฐุงูุฑุฉ ุจุงููุงูู ููููุงุฉ ุจููุงููุฉ memcpy ูุงุญุฏุฉ ููุณูุท sizeof ุ ูุงูุณูุงุญ ููุนููู ุจุชุญุฏูุฏ ุฃุฌุฒุงุก ุงูุฅุฎุฑุงุฌ ุงูุชู ุณูุชู ุงุณุชุฎุฏุงููุง.  ุงุชุถุญ ุฃู ูุฐุง ุงูููุฌ ูุณุชุฎุฏู ุงูููู ูู ูุธุงูู ุงูุชุดุบูู Windows ู Linux.  ูุนูุฏูุง ูุชู ุงููุดู ุนู ุญุงูุฉ ูุนููุฉ ูู ุชุณุฑุจ ุงููุนูููุงุช ุ ูุชู ุชูููุฑ ุงูุชุตุญูุญ ูุน ููุงููุฉ memset ุนูู ุงูููุฑ ูุชูุฒูุนู ูู ูุจู ุงูุดุฑูุฉ ุงููุตูุนุฉ ููุธุงู ุงูุชุดุบูู.  ูุณูุก ุงูุญุธ ุ ูุฐุง ูุง ูุญู ุงููุดููุฉ ูู ุงูุญุงูุฉ ุงูุนุงูุฉ. </p><br><h2 id="specifika-konkretnyh-os" style=";text-align:right;direction:rtl">  ุชูุงุตูู ูุธุงู ุงูุชุดุบูู </h2><br><p style=";text-align:right;direction:rtl">  ููุงู ุจุนุถ ุญููู ุชุตููู kernel ูุทุฑู ุงูุจุฑูุฌุฉ ูุฃููุงุท ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ุชุคุซุฑ ุนูู ูุฏู ุชุนุฑุถ ูุธุงู ุงูุชุดุบูู ูููุงุท ุงูุถุนู ูู ุชูุณูุน ุงูุฐุงูุฑุฉ.  ูุชู ุชูุงูููุง ูู ุงูุฃูุณุงู ุงููุฑุนูุฉ ุงูุชุงููุฉ. </p><br><h4 id="pereispolzovanie-dinamicheskoy-pamyati" style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ ุงูุฏููุงููููุฉ </h4><br><p style=";text-align:right;direction:rtl">  ุชู ุชุญุณูู ุงูููุฒุนูู ุงูุญุงูููู ููุฐุงูุฑุฉ ุงูุฏููุงููููุฉ (ูู ูู ูู ูุถุน ุงููุณุชุฎุฏู ููุถุน kernel) ุฅูู ุญุฏ ูุจูุฑ ุ ูุฃู ุฃุฏุงุฆูู ูุคุซุฑ ุจุดูู ูุจูุฑ ุนูู ุฃุฏุงุก ุงููุธุงู ุจุฃูููู.  ูุงุญุฏุฉ ูู ุฃูู ุงูุชุญุณููุงุช ูู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ: ุนูุฏ ุชุญุฑูุฑูุง ุ ูุงุฏุฑูุง ูุง ูุชู ุงูุชุฎูุต ูู ุงูุฐุงูุฑุฉ ุงูููุงุจูุฉ ุชูุงููุง ุ ุจุฏูุงู ูู ุฐูู ุ ูุชู ุญูุธูุง ูู ูุงุฆูุฉ ุงูููุงุทู ุงูุฌุงูุฒุฉ ููุฅุฑุฌุงุน ูู ุงููุฑุฉ ุงูุชุงููุฉ ุงูุชู ูุชู ุชุฎุตูุตูุง ูููุง.  ูุญูุธ ุฏูุฑุงุช ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุ ูุง ูุชู ูุณุญ ููุงุทู ุงูุฐุงูุฑุฉ ุงูุงูุชุฑุงุถูุฉ ุจูู ุงูุชุฎุตูุต ูุงูุชุฎุตูุต ุงูุฌุฏูุฏ.  ููุชูุฌุฉ ูุฐูู ุ ุงุชุถุญ ุฃู ุฌุฒุฃูู ุบูุฑ ูุชุตููู ูู ุงูููุงุฉ ูุนููุงู ูุน ููุณ ูุทุงู ุงูุฐุงูุฑุฉ ููุชุฑุฉ ูุตูุฑุฉ.  ูุฐุง ูุนูู ุฃู ุชุณุฑุจ ูุญุชููุงุช ุงูุฐุงูุฑุฉ ุงูุฏููุงููููุฉ ููููุงุฉ ูุณูุญ ูู ุจุงููุดู ุนู ุจูุงูุงุช ููููุงุช ูุธุงู ุงูุชุดุบูู ุงููุฎุชููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุฑุงุช ุงูุชุงููุฉ ุ ููุฏู ูุธุฑุฉ ุนุงูุฉ ููุฌุฒุฉ ุนู ุงูููุฒุนูู ุงููุณุชุฎุฏููู ูู ููุงุฉ Windows ู Linux ุ ูุฎุตุงุฆุตูู ุงูุฃูุซุฑ ุฃูููุฉ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ููุงูุฐ</strong> <br>  ุงููุธููุฉ ุงูุฑุฆูุณูุฉ ููุฏูุฑ ุชุฌูุน Windows kernel ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ExAllocatePoolWithTag</a> ุ ูุงูุชู ูููู ุงุณุชุฏุนุงุคูุง ูุจุงุดุฑุฉ ุฃู ูู ุฎูุงู ุฃุญุฏ ุงูุฃุตุฏุงู ุงููุชุงุญุฉ: ExAllocatePool {โุ Exุ WithQuotaTagุ WithTagPriority}.  ูุง ุชููู ุฃู ูู ูุฐู ุงููุธุงุฆู ุจูุณุญ ูุญุชููุงุช ุงูุฐุงูุฑุฉ ุงูุชู ุชู ุฅุฑุฌุงุนูุง ุ ุฅูุง ุจุดูู ุงูุชุฑุงุถู ุฃู ูู ุฎูุงู ุฃู ุฅุดุงุฑุงุช ุฅุฏุฎุงู.  ุนูู ุงูุนูุณ ูู ุฐูู ุ ูุฏููู ุฌููุนูุง ุงูุชุญุฐูุฑ ุงูุชุงูู ูู ูุซุงุฆู MSDN ุงูุฎุงุตุฉ ุจูู: </p><br><blockquote style=";text-align:right;direction:rtl">  ููุงุญุธุฉ ุงูุฐุงูุฑุฉ ุงูุชู ุชุฎุตุตูุง ุงูุฏุงูุฉ ุบูุฑ ูููุฃุฉ.  ูุฌุจ ุฃู ูููู ุจุฑูุงูุฌ ุชุดุบูู ูุถุน kernel ุฃูู ุตูุฑ ูู ูุฐู ุงูุฐุงูุฑุฉ ุฅุฐุง ูุงู ุณูุฌุนููุง ูุฑุฆูุฉ ูุจุฑูุงูุฌ ูุถุน ุงููุณุชุฎุฏู (ูุชุฌูุจ ุชุณุฑูุจ ูุญุชููุงุช ุฐุงุช ุงูุชูุงุฒุงุช ูุญุชููุฉ). </blockquote><p style=";text-align:right;direction:rtl">  ูููู ุฃู ูุญุฏุฏ ุฑูุฒ ุงูุงุชุตุงู ุฃุญุฏ ุงูุฃููุงุน ุงูุณุชุฉ ุงูุฑุฆูุณูุฉ ููุชุฌูุนุงุช: NonPagedPool ู NonPagedPoolNx ู NonPagedPoolSession ู NonPagedPoolSessionNx ู PagedPool ู PagedPoolSession.  ููู ูููุง ููุทูุฉ ูููุตูุฉ ูู ูุณุงุญุฉ ุงูุนููุงู ุงูุธุงูุฑู ุ ูุจุงูุชุงูู ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ููุงุทู ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ููุท ุฏุงุฎู ููุณ ููุน ุงูุชุฌูุน.  ูุนุฏ ุชูุฑุงุฑ ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุฃุฌุฒุงุก ุงูุฐุงูุฑุฉ ูุฑุชูุนูุง ุฌุฏูุง ุ ูุนุงุฏุฉู ูุง ูุชู ุฅุฑุฌุงุน ุงูููุงุทู ุงูุชู ุชุญุชูู ุนูู ุตูุฑ ููุท ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนูู ุณุฌู ููุงุณุจ ูู ููุงุฆู lookaside ุ ุฃู ูุงู ุงูุทูุจ ูุจูุฑูุง ุฌุฏูุง ุจุญูุซ ุชุชุทูุจ ุตูุญุงุช ุฌุฏูุฏุฉ ูู ุงูุฐุงูุฑุฉ.  ูุจุนุจุงุฑุฉ ุฃุฎุฑู ุ ูุง ุชูุฌุฏ ุญุงูููุง ุฃู ุนูุงูู ุชููุน ุงููุดู ุนู ุฐุงูุฑุฉ ุงูุชุฌูุน ูู Windows ุ ููููู ุงุณุชุฎุฏุงู ูู ูุฐุง ุงูุฎุทุฃ ุชูุฑูุจูุง ูุชุณุฑูุจ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูู ุฃุฌุฒุงุก ูุฎุชููุฉ ูู ุงูููุงุฉ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ููููุณ</strong> <br>  ูุญุชูู ููุงุฉ Linux ุนูู ุซูุงุซ ูุงุฌูุงุช ุฑุฆูุณูุฉ ูุชุฎุตูุต ุงูุฐุงูุฑุฉ ุฏููุงูููููุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>kmalloc</strong> - ูุธููุฉ ุดุงุฆุนุฉ ุชุณุชุฎุฏู ูุชุฎุตูุต ูุชู ุงูุฐุงูุฑุฉ ุฐุงุช ุงูุญุฌู ุงูุชุนุณูู (ุงููุณุชูุฑ ูู ูู ูู ูุณุงุญุฉ ุงูุนููุงู ุงูุธุงูุฑูุฉ ูุงููุงุฏูุฉ) ุ ุชุณุชุฎุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฎุตูุต ุฐุงูุฑุฉ ุงูุจูุงุทุฉ</a> . </li><li style=";text-align:right;direction:rtl">  <strong>kmem_cache_create</strong> ู <strong>kmem_cache_alloc</strong> - ุขููุฉ ูุชุฎุตุตุฉ ูุชุฎุตูุต ูุงุฆูุงุช ุฐุงุช ุญุฌู ุซุงุจุช (ุงูููุงูู ุ ุนูู ุณุจูู ุงููุซุงู) ุ ุชุณุชุฎุฏู ุฃูุถูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฎุตูุต ุฐุงูุฑุฉ ุงูุจูุงุทุฉ</a> . </li><li style=";text-align:right;direction:rtl">  <strong>vmalloc</strong> ูู ูุธููุฉ ุชุฎุตูุต ูุงุฏุฑุงู ูุง ุชูุณุชุฎุฏู ุชูุฑุฌุน ููุงุทู ูุง ุชููู ุงุณุชูุฑุงุฑูุชูุง ูุถูููุฉ ุนูู ูุณุชูู ุงูุฐุงูุฑุฉ ุงููุนููุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุฐู ุงููุธุงุฆู (ูู ุญุฏ ุฐุงุชูุง) ูุง ุชุถูู ุฃู ุงูููุงุทู ุงููุญุฏุฏุฉ ูู ุชุญุชูู ุนูู ุจูุงูุงุช ูุฏููุฉ (ูุญุชูู ุฃู ุชููู ุณุฑูุฉ) ุ ููุง ูุฌุนู ูู ุงููููู ูุชุญ ุฐุงูุฑุฉ ูููุฉ kernel.  ููุน ุฐูู ุ ููุงู ุนุฏุฉ ุทุฑู ูููู ูุฑูุฒ ุงูุงุชุตุงู ูู ุฎูุงููุง ุทูุจ ุฐุงูุฑุฉ ููุบุงุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>ุชุญุชูู</strong> ูุธููุฉ <strong>kmalloc</strong> ุนูู <strong>ูุธูุฑ</strong> ูู <strong>kzalloc</strong> ุ ููุง ูุถูู ูุณุญ ุงูุฐุงูุฑุฉ ุงูุชู ุชู ุฅุฑุฌุงุนูุง. </li><li style=";text-align:right;direction:rtl">  ูููู ุชูุฑูุฑ ุนูุงูุฉ __GFP_ZERO ุงูุงุฎุชูุงุฑูุฉ ุฅูู <strong>kmalloc</strong> ู <strong>kmem_cache_alloc</strong> ูุจุนุถ ุงููุธุงุฆู ุงูุฃุฎุฑู ูุชุญููู ููุณ ุงููุชูุฌุฉ. </li><li style=";text-align:right;direction:rtl">  ููุจู <strong>kmem_cache_create</strong> ูุคุดุฑูุง ุฅูู ูุธููุฉ ูููุดุฆ ุงุฎุชูุงุฑู ูุชู ุงุณุชุฏุนุงุคูุง ูุชููุฆุฉ ูู ูุงุฆู ูุณุจููุง ูุจู ุฅุนุงุฏุชู ุฅูู ุฑูุฒ ุงูุงุณุชุฏุนุงุก.  ูููู ุชูููุฐ ุงููููุดุฆ ูุบูุงู ุญูู memset ูุฅุฎุฑุงุฌ ููุทูุฉ ุฐุงูุฑุฉ ูุนููุฉ. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุฑู ุชููุฑ ูุฐู ุงูุฎูุงุฑุงุช ูุดุฑูุท ููุงุชูุฉ ูุฃูุงู kernel ุ ุญูุซ ูุดุฌุนูู ุงููุทูุฑูู ุนูู ุงุชุฎุงุฐ ูุฑุงุฑุงุช ูุณุชููุฑุฉ ููุณูุญูู ููู ุจุจุณุงุทุฉ ุจุงูุนูู ูุน ูุธุงุฆู ุชุฎุตูุต ุงูุฐุงูุฑุฉ ุงูุญุงููุฉ ุจุฏูุงู ูู ุฅุถุงูุฉ ููุงููุงุช memset ุฅุถุงููุฉ ุจุนุฏ ูู ุชุฎุตูุต ููุฐุงูุฑุฉ ุงูุฏููุงููููุฉ. </p><br><h4 id="massivy-fiksirovannogo-razmera" style=";text-align:right;direction:rtl">  ุตูุงุฆู ุญุฌู ุซุงุจุช </h4><br><p style=";text-align:right;direction:rtl">  ูููู ุงููุตูู ุฅูู ุนุฏุฏ ูู ููุงุฑุฏ ูุธุงู ุงูุชุดุบูู ูู ุฎูุงู ุฃุณูุงุก ุงูุงุฎุชุจุงุฑ ุงูุฎุงุตุฉ ุจูู.  ูุฌููุนุฉ ูุชููุนุฉ ูู ุงูููุงุฑุฏ ุงููุณูุงุฉ ูู Windows ูุจูุฑุฉ ุฌุฏูุง ุ ุนูู ุณุจูู ุงููุซุงู: ุงููููุงุช ูุงูุฃุฏูุฉ ูููุงุชูุญ ูููู ููุงุชูุญ ุงูุชุณุฌูู ูุงูููุงูุฐ ูุงูุฎุทูุท ูุงููุฒูุฏ.  ุจุงููุณุจุฉ ูุจุนุถูุง ุ ูููู ุทูู ุงูุงุณู ูุญุฏูุฏูุง ููุชู ุงูุชุนุจูุฑ ุนูู ุจูุงุณุทุฉ ุซุงุจุช ุ ูุซู MAX_PATH (260) ุฃู LF_FACESIZE (32).  ูู ูุซู ูุฐู ุงูุญุงูุงุช ุ ุบุงูุจูุง ูุง ูุจุณุท ูุทูุฑู kernel ุงูุดูุฑุฉ ูู ุฎูุงู ุงูุฅุนูุงู ุนู ุงูุญุฏ ุงูุฃูุตู ูุญุฌู ุงููุฎุงุฒู ุงููุคูุชุฉ ููุณุฎูุง ููู (ุนูู ุณุจูู ุงููุซุงู ุ ุจุงุณุชุฎุฏุงู sizeof ุงููููุฉ ุงูุฃุณุงุณูุฉ) ุจุฏูุงู ูู ุงูุนูู ููุท ูุน ุงูุฌุฒุก ุงูููุงุจู ูู ุงูุณุทุฑ.  ูุฐุง ูููุฏ ุจุดูู ุฎุงุต ุฅุฐุง ูุงูุช ุงูุณูุงุณู ุฃุนุถุงุก ูู ููุงูู ุฃูุจุฑ.  ูููู ููู ูุฐู ุงูุฃุดูุงุก ุจุญุฑูุฉ ูู ุงูุฐุงูุฑุฉ ุฏูู ุงูููู ุจุดุฃู ุฅุฏุงุฑุฉ ุงููุคุดุฑุงุช ุฅูู ุงูุฐุงูุฑุฉ ุงูุฏููุงููููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุง ุชุชููุน ุ ูุงุฏุฑูุง ูุง ูุชู ุงุณุชุฎุฏุงู ุงููุฎุงุฒู ุงููุคูุชุฉ ุงููุจูุฑุฉ ุจุงููุงูู ุ ูุบุงูุจูุง ูุง ูุง ูุชู ูุณุญ ูุณุงุญุฉ ุงูุชุฎุฒูู ุงููุชุจููุฉ.  ูุฐุง ูููู ุฃู ูุคุฏู ุฅูู ุชุณุฑุจุงุช ุดุฏูุฏุฉ ุจุดูู ุฎุงุต ูู ุงูููุงุทู ุงูุทูููุฉ ุงููุชุฌุงูุฑุฉ ูู ุฐุงูุฑุฉ ุงูููุงุฉ.  ูู ุงููุซุงู ุงูููุฌูุฏ ูู ุงููุงุฆูุฉ 5 ุ ูุณุชุฎุฏู ุงุณุชุฏุนุงุก ุงููุธุงู ุฏุงูุฉ RtlGetSystemPath ูุชุญููู ูุณุงุฑ ุงููุธุงู ูู ุงููุฎุฒู ุงููุคูุช ุงููุญูู ุ ููู ุญุงูุฉ ูุฌุงุญ ุงูููุงููุฉ ุ ูุชู ุชูุฑูุฑ 260 ุจุงูุช ุฅูู ุงููุชุตู ุจุบุถ ุงููุธุฑ ุนู ุทูู ุงูุฎุท ุงููุนูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">NTSTATUS NTAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NtGetSystemPath</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PCHAR OutputPath)</span></span></span><span class="hljs-function"> </span></span>{ CHAR SystemPath[MAX_PATH]; NTSTATUS Status; Status = RtlGetSystemPath(SystemPath, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(SystemPath)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (NT_SUCCESS(Status)) { RtlCopyMemory(OutputPath, SystemPath, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(SystemPath)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Status; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ุณุฑุฏ 5: ุชูุณูุน ุงูุฐุงูุฑุฉ ุนู ุทุฑูู ุชููุฆุฉ ุงููุฎุฒู ุงููุคูุช ููุณูุณูุฉ ุฌุฒุฆูุง.</em> </p><br><p style=";text-align:right;direction:rtl">  ูุชู ุนุฑุถ ููุทูุฉ ุงูุฐุงูุฑุฉ ุงูุชู ุชู ูุณุฎูุง ุฅูู ูุณุงุญุฉ ุงููุณุชุฎุฏู ูู ูุฐุง ุงููุซุงู ูู ุงูุดูู 4. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ki/8j/5z/ki8j5zyo73i5k4o12grlolwsrhk.png" alt="ุงูุดูู 4: ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุณูุณูุฉ ุงูุชู ุชูุช ุชููุฆุชูุง ุฌุฒุฆููุง"><br>  <em>ุงูุดูู 4: ุฐุงูุฑุฉ ุงููุฎุฒู ุงููุคูุช ููุฎุท ุงูุฐู ุชูุช ุชููุฆุชู ุฌุฒุฆููุง.</em> </p><br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ููุฑุฌุน ุงูุชูููุฐ ุงูุขูู ุงููุณุงุฑ ุงููุทููุจ ููุท ุ ูููุณ ุงููุฎุฒู ุงููุคูุช ุจุฃูููู ุงููุณุชุฎุฏู ููุชุฎุฒูู.  ููุถุญ ูุฐุง ุงููุซุงู ูุฑุฉ ุฃุฎุฑู ููู ูููู ุฃู ูููู ุชูุฏูุฑ ุญุฌู ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุนุงูู ุงูุชุดุบูู sizeof (ุงููุณุชุฎุฏู ููุนููุฉ ูู RtlCopyMemory) ุบูุฑ ุตุญูุญ ุชูุงููุง ูููุง ูุชุนูู ุจุงูููุฏุงุฑ ุงููุนูู ููุจูุงูุงุช ุงูุชู ูุฌุจ ุฃู ุชูุฑุฑูุง ุงูููุงุฉ ุฅูู ููุทูุฉ ุงููุณุชุฎุฏู. </p><br><h4 id="proizvolnyy-razmer-vyhodnyh-dannyh-sistemnogo-vyzova" style=";text-align:right;direction:rtl">  ุญุฌู ุฅุฎุฑุงุฌ ุงุณุชุฏุนุงุก ุงููุธุงู ุงูุชุนุณูู </h4><br><p style=";text-align:right;direction:rtl">  ุชูุจู ูุนุธู ููุงููุงุช ุงููุธุงู ุงููุคุดุฑุงุช ุฅูู ุฅุฎุฑุงุฌ ูุถุน ุงููุณุชุฎุฏู ุฅูู ุฌุงูุจ ุญุฌู ุงููุฎุฒู ุงููุคูุช.  ูู ูุนุธู ุงูุญุงูุงุช ุ ูุฌุจ ุงุณุชุฎุฏุงู ูุนูููุงุช ุงูุญุฌู ููุท ูุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุงููุฎุฒู ุงููุคูุช ุงููุชููุฑ ูุงูู ูุชููู ุฅุฎุฑุงุฌ ุงุณุชุฏุนุงุก ุงููุธุงู.  ูุง ุชุณุชุฎุฏู ุงูุญุฌู ุงููุงูู ูุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ููุฅุฎุฑุงุฌ ุงููุชููุฑุฉ ูุชุญุฏูุฏ ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงููุฑุงุฏ ูุณุฎูุง.  ููุน ุฐูู ุ ูุฑู ุญุงูุงุช ุญูุซ ุณุชุญุงูู ุงูููุงุฉ ุงุณุชุฎุฏุงู ูู ุจุงูุช ูู ุงููุฎุฒู ุงููุคูุช ููุฅุฎุฑุงุฌ ูููุณุชุฎุฏู ุ ุฏูู ุงุญุชุณุงุจ ูููุฉ ุงูุจูุงูุงุช ุงููุนููุฉ ุงูุชู ุชุญุชุงุฌ ุฅูู ูุณุฎูุง.  ูุธูุฑ ูุซุงู ุนูู ูุฐุง ุงูุณููู ูู ุงููุงุฆูุฉ 6. </p><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">NTSTATUS NTAPI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NtMagicValues</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(LPDWORD OutputPointer, DWORD OutputLength)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OutputLength &lt; <span class="hljs-number"><span class="hljs-number">3</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(DWORD)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STATUS_BUFFER_TOO_SMALL; } LPDWORD KernelBuffer = Allocate(OutputLength); KernelBuffer[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0xdeadbeef</span></span>; KernelBuffer[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0xbadc0ffe</span></span>; KernelBuffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">0xcafed00d</span></span>; RtlCopyMemory(OutputPointer, KernelBuffer, OutputLength); Free(KernelBuffer); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> STATUS_SUCCESS; }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ุงูุฅุฏุฑุงุฌ 6: ุชูุณูุน ุงูุฐุงูุฑุฉ ูู ุฎูุงู ุงููุฎุฒู ุงููุคูุช ููุฅุฎุฑุงุฌ ูู ุญุฌู ุนุดูุงุฆู.</em> </p><br><p style=";text-align:right;direction:rtl">  ุงูุบุฑุถ ูู ุงุณุชุฏุนุงุก ุงููุธุงู ูู ุชุฒููุฏ ุฑูุฒ ุงูุงุชุตุงู ุจุซูุงุซ ููู ุฎุงุตุฉ 32 ุจุช ุ ุชุญุชู ูุง ูุฌููุนู 12 ุจุงูุช.  ุนูู ุงูุฑุบู ูู ุตุญุฉ ุงูุชุญูู ูู ุญุฌู ุงููุฎุฒู ุงููุคูุช ุงูุตุญูุญ ูู ุจุฏุงูุฉ ุงูุฏุงูุฉ ุ ูุฌุจ ุฃู ููุชูู ุงุณุชุฎุฏุงู ูุณูุทุฉ OutputLength ุนูุฏ ูุฐุง ุงูุญุฏ.  ูุน ุงูุนูู ุฃู ุงููุฎุฒู ุงููุคูุช ููุฅุฎุฑุงุฌ ูุจูุฑ ุจูุง ูููู ูุญูุธ ุงููุชูุฌุฉ ุ ูููู ููููุงุฉ ุชุฎุตูุต 12 ุจุงูุช ูู ุงูุฐุงูุฑุฉ ุ ูููุฆูุง ุ ููุณุฎ ุงููุญุชููุงุช ูุฑุฉ ุฃุฎุฑู ุฅูู ุงููุฎุฒู ุงููุคูุช ููุถุน ุงููุณุชุฎุฏู ุงูููุฏู.  ุจุฏูุงู ูู ุฐูู ุ ูููู ุงุณุชุฏุนุงุก ุงููุธุงู ุจุชุฎุตูุต ูุชูุฉ ุชุฌูุน (ุนูุงูุฉ ุนูู ุฐูู ุ ุจุทูู ูุชุญูู ููู ุงููุณุชุฎุฏู) ููุณุฎ ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ุจุงููุงูู ุฅูู ูุณุงุญุฉ ุงููุณุชุฎุฏู.  ุงุชุถุญ ุฃู ุฌููุน ุงูุจุงูุชุงุช ุ ุจุงุณุชุซูุงุก ุงูู 12 ุงูุฃููู ุ ุบูุฑ ูููุฃุฉ ูููุชูุญุฉ ุฎุทุฃ ูููุณุชุฎุฏู ุ ููุง ูู ููุถุญ ูู ุงูุดูู 5. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/m7/hy/dj/m7hydjfgkhaqgizxuhr2xcmv8jw.png" alt="ุงูุดูู 5: ุงูุฐุงูุฑุฉ ุงูุนุงุฒูุฉ ุงูุชุนุณููุฉ"><br>  <em>ุงูุดูู 5: ุฐุงูุฑุฉ ุนุงุฒูุฉ ุฐุงุช ุญุฌู ุชุนุณูู.</em> </p><br><p style=";text-align:right;direction:rtl">  ุงููุฎุทุท ุงูุฐู ุชูุช ููุงูุดุชู ูู ูุฐุง ุงููุณู ุดุงุฆุน ุจุดูู ุฎุงุต ููุธุงู Windows.  ูููู ุฃู ูููุฑ ุฎุทุฃ ููุงุซู ููููุงุฌู ุจุฏุงุฆูุฉ ูููุฏุฉ ููุบุงูุฉ ูุชูุณูุน ุงูุฐุงูุฑุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุญุณูู ุงููุณุชุฎุฏู ุบุงูุจูุง ูู ููุงููุงุช ูุธุงู Windows ูู ุงุณุชุฎุฏุงู ุงููุฎุงุฒู ุงููุคูุชุฉ ุงููุงุฆูุฉ ุนูู ุงูููุฏุณ ููุฃุญุฌุงู ุงูุตุบูุฑุฉ ูุชุฎุตูุต ุงูุฐุงูุฑุฉ ูู ุงูุชุฌูุนุงุช ููุฃุญุฌุงู ุงูุฃูุจุฑ. </font><font style="vertical-align: inherit;">ุฅูู ุฌุงูุจ ุงูุชุณุฑุจ ุงูููุงุซู ุ ูููู ุฃู ูุณูู ูุฐุง ุชูุณูุน ูููุฉ kernel ูุงููุณุจุญ ูุน ุซุบุฑุฉ ูุงุญุฏุฉ.</font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุฏุฑุฉ ุนูู ุงูุชุญูู ูู ุญุฌู ุงูุจูุงูุงุช ุงูุชู ุชู ุงููุดู ุนููุง ูู ุงูุชุฌูุน ุชููุญ ุงูููุงุฌู ุงููุฏุฑุฉ ุนูู ุงูุชุญูู ูู ููุน ุงููุนูููุงุช ุงูุณุฑูุฉ. </font><font style="vertical-align: inherit;">ูุตุจุญ ูุฐุง ูููููุง ุ ูุธุฑูุง ูุขููุงุช ุชุฎุตูุต ุงูุฐุงูุฑุฉ ุงูุญุฏูุซุฉ ุ ูุงูุชู ุชููู ุฅูู ุชุฎุฒูู ููุงุทู ุงูุฐุงูุฑุฉ ูุคูุชูุง ูุทูุจุงุช ุชุฎุตูุต ุงูุฐุงูุฑุฉ ุงููุงุญูุฉ ุจููุณ ุญุฌู ุงููุฎุฒู ุงููุคูุช. </font><font style="vertical-align: inherit;">ููุฐุง ูุฌุนู ูู ุงููููู ูุฑุงุกุฉ ุจูุงูุงุช ูุญุฏุฏุฉ ุชู ุฅุตุฏุงุฑูุง ูุคุฎุฑูุง ุจูุงุณุทุฉ ูููู ููุงุฉ ุขุฎุฑ (ูู ุงูุญุงูุฉ ุงูุนุงูุฉ - ุบูุฑ ุฐู ุตูุฉ).</font></font></li></ul><br><p style=";text-align:right;direction:rtl">  ,        .      ,     ,       . </p><br><h2 id="faktory-sposobstvuyuschie-poyavleniyu-oshibok-raskrytiya-pamyati" style=";text-align:right;direction:rtl"> ,      </h2><br><p style=";text-align:right;direction:rtl">     ,           .         ,          Windows    . </p><br><p style=";text-align:right;direction:rtl"> <strong>  </strong> <br>  ,       ,   .        ,      : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">AddressSanitizer</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PageHeap</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Special Pool</a> .  , ,   -          .         ,         .   ,         ,       ,           ,        ,       .       <em></em>     ,      (   ). </p><br><p style=";text-align:right;direction:rtl">  ,             ,  ,       .               ,                  . </p><br><p style=";text-align:right;direction:rtl"> <strong>,    API</strong> <br>           API,   Windows (Win32/User32 API). API         ,   ,          ,     .     ,  ,        , ,      .              <em></em>  . </p><br><h2 id="znachimost-i-vliyanie-na-bezopasnost-sistemy" style=";text-align:right;direction:rtl">       </h2><br><p style=";text-align:right;direction:rtl">   ,             .          ,            .      ,     <em></em>       ,       ,      .        ,         ,    . </p><br><p style=";text-align:right;direction:rtl">  ,      ,          .     ,       KASLR (Kernel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Address Space Layout Randomization</a> ),                .  :   Windows,    Hacking Team   2015  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Juan Vazquez. Revisiting an Info Leak</a> )         (derandomize)     win32k.sys,       . ,         Matt Tait'  Google Project Zero ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Kernel-mode ASLR leak via uninitialized memory returned to usermode by NtGdiGetTextMetrics</a> )     MS15-080 (CVE-2015-2433). </p><br><p style=";text-align:right;direction:rtl"> <strong></strong> <br>       (/)   ,      ,      (control ๏ฌow),  :   ,   ,   ,   ,   StackGuard  Linux  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">/GS  Windows</a> .    ,             .        ,   ,            . </p><br><p style=";text-align:right;direction:rtl"> <strong>  (/)</strong> <br>    (/)    ,    ,      ,    :  ,   ,  ,     .               ,     ,      .         .  ,         ( ,    )   ,  ,      . </p><br><h2 id="drugie-suschestvuyuschie-issledovaniya" style=";text-align:right;direction:rtl">    </h2><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wp/ky/ap/wpkyap5uiyz52hrghshrxxve1v0.jpeg" alt="KDPV # 2"></p><br><h4 id="microsoft-windows" style=";text-align:right;direction:rtl"> Microsoft Windows </h4><br><p style=";text-align:right;direction:rtl"> <strong></strong> <br>  2015            Windows.   2015  Matt Tait           win32k!NtGdiGetTextMetrics.          Windows   Hacking Team.   ,      ,       ,    0-day       Windows. </p><br><p style=";text-align:right;direction:rtl">    2015, WanderingGlitch (HP Zero Day Initiative)          ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Acknowledgments โ 2015</a> ).           Ruxcon 2016 (  )    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Leaking Windows Kernel Pointers"</a> . </p><br><p style=";text-align:right;direction:rtl">  ,   2017 fanxiaocao  pjf  IceSword Lab (Qihoo 360)   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Automatically Discovering Windows Kernel Information Leak Vulnerabilities"</a> ,    ,      14   2017  (8      ).        Bochspwn Reloaded,             ,            .        VMware     (Bochs)         .   ,  Bochspwn Reloaded,                . </p><br><p style=";text-align:right;direction:rtl">         ,  ,    2010-2011          ,     win32k: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Challenge: On 32bit Windows7, explain where the upper 16bits of eax come from after a call to NtUserRegisterClassExWOW()"</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Subtle information disclosure in WIN32K.SYS syscall return values"</a> .          Windows 8,   2015  Matt Tait ,           : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Google Project Zero Bug Tracker</a> . </p><br><p style=";text-align:right;direction:rtl"> <strong></strong> <br>       (   ),  ,    2017   - Windows        -,   : Joseph Bialek โ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"Anyone notice my change to the Windows IO Manager to generically kill a class of info disclosure? Bu๏ฌeredIO output bu๏ฌer is always zero'd"</a> .      ,  IOCTL-          . </p><br><p style=";text-align:right;direction:rtl">        ,   Visual Studio 15.5   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">POD-</a> ,       "= {0}",   .       ,      padding- ()   . </p><br><h4 id="linux" style=";text-align:right;direction:rtl"> Linux </h4><br><p style=";text-align:right;direction:rtl">    Windows,   Linux        ,         2010 .        ,             (  )   (    ) .  ,        Windows  Linux         ,        โ ,    . </p><br><p style=";text-align:right;direction:rtl"> <strong></strong> <br>    ,   Linux       .   "Linux kernel vulnerabilities: State-of-the-art defenses and open problems"   2010    2011   28    .   2017-  "Securing software systems by preventing information leaks" Lu K.    59  ,    2013-   2016-.          . : Rosenberg  Oberheide    25 ,     Linux  2009-2010 ,     .          Linux c <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">grsecurity</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PaX-hardened</a> . Vasiliy Kulikov   25   2010-2011 ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">   Coccinelle</a> .  , Mathias Krause <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">   21      2013 </a>   50      . </p><br><p style=";text-align:right;direction:rtl">    ,      ,           Linux.     โ   -Wuninitialized (  gcc,   LLVM),          .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">  kmemcheck</a> ,      Valgrind'   .        ,        .         ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">KernelAddressSANitizer</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">KernelMemorySANitizer</a> .      KMSAN    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">syzkaller</a> (   ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> 19    </a> ,        . </p><br><p style=";text-align:right;direction:rtl">               Linux.  2014 โ 2016  Peirยดo      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Coccinelle</a>     ,      Linux  3.12: "Detecting stack based kernel information leaks" International Joint Conference SOCO14-CISIS14-ICEUTE14, pages 321โ331 (Springer, 2014)  "An analysis on the impact and detection of kernel stack infoleaks" Logic Journal of the IGPL.         ,          .  2016- Lu       UniSan โ   ,    ,                 :   ,   .            ,        20%     (350   1800),      19     Linux  Android. </p><br><p style=";text-align:right;direction:rtl">             โ    (multi-variant program execution),            ,      .           ,             .     ,  KASLR,   -,         .         ,  2006    DieHard: probabilistic memory safety for unsafe languages,   2017  โ BUDDY: Securing software systems by preventing information leaks.     John North   "Identifying Memory Address Disclosures" 2015- . ,  SafeInit (Comprehensive and Practical Mitigation of Uninitialized Read Vulnerabilities)  ,          ,            .       , ,   ,        Linux. </p><br><p style=";text-align:right;direction:rtl"> <strong></strong> <br>                  ,   .      ,       :     ,        .     ,  , -    ,             .                   . </p><br><p style=";text-align:right;direction:rtl">        CONFIG_PAGE_POISONING  CONFIG_DEBUG_SLAB,       -.       -,      .        , ,  ,       Linux. </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">grsecurity</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PaX</a>    .  ,   PAX_MEMORY_SANITIZE   ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">slab</a> ,    (        โ   ).  ,  PAX_MEMORY_STRUCTLEAK     ,    (  ),       .         padding- (),          100% .  ,      โ PAX_MEMORY_STACKLEAK,            .      ,      ,        .       (Kernel Self Protection Project)   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> STACKLEAK</a>   . </p><br><p style=";text-align:right;direction:rtl">               Linux: </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">Secure deallocation, Chow  , 2005</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> Chow, Jim and Pfa๏ฌ, Ben and Gar๏ฌnkel, Tal and Rosenblum, Mendel. Shredding Your Garbage: Reducing Data Lifetime Through Secure Deallocation. In USENIX Security Symposium, pages 22โ22, 2005. </p></div></div><br><p style=";text-align:right;direction:rtl">  ,       ,          ( )  .         Linux     . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">Split Kernel, Kurmus  Zippel, 2014</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> Kurmus, Anil and Zippel, Robby. A tale of two kernels: Towards ending kernel hardening wars with split kernel. In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security, pages 1366โ1377. ACM, 2014. </p></div></div><br><p style=";text-align:right;direction:rtl">      ,           . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">SafeInit, Milburn  , 2017</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> Milburn, Alyssa and Bos, Herbert and Giu๏ฌrida, Cristiano. SafeInit: Comprehensive and Practical Mitigation of Uninitialized Read Vulnerabilities. In Proceedings of the 2017 Annual Network and Distributed System Security Symposium (NDSS)(San Diego, CA), 2017. </p></div></div><br><p style=";text-align:right;direction:rtl">         ,      ,         . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title">UniSan, Lu  , 2016</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"> Lu, Kangjie and Song, Chengyu and Kim, Taesoo and Lee, Wenke. UniSan: Proactive kernel memory initialization to eliminate data leakages. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security, pages 920โ932. ACM, 2016. </p></div></div><br><p style=";text-align:right;direction:rtl">    SafeInit         ,  ,       ,      ,      . </p><br><p style=";text-align:right;direction:rtl">       ,  Linux             . </p><br><h2 id="vmesto-epiloga-ot-perevodchika" style=";text-align:right;direction:rtl">   ( ) </h2><br><p style=";text-align:right;direction:rtl">        ,    ,          (      ).  :  (),     , ,    ,   ( - )     .   ,          . , ,        . </p><br><p style=";text-align:right;direction:rtl">     ,             : </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> Bochspwn Reloaded โ detection with software x86 emulation </li><li style=";text-align:right;direction:rtl"> Windows bug reproduction techniques </li><li style=";text-align:right;direction:rtl"> Alternative detection methods </li><li style=";text-align:right;direction:rtl"> Other data sinks </li><li style=";text-align:right;direction:rtl"> Future work </li><li style=";text-align:right;direction:rtl"> Other system instrumentation schemes </li></ul><br><p style=";text-align:right;direction:rtl">  ,     :)          ,       . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar415685/">https://habr.com/ru/post/ar415685/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar415675/index.html">ููุฎุต ุฃุฎุจุงุฑ PostgreSQL. ุงูุนุฏุฏ 8</a></li>
<li><a href="../ar415677/index.html">ุชูุงุฌู ุงููุฏู ุงููุงููุฉ ุตุนูุจุฉ ูู ุชุญุฑูู ุงูุฌูุงููุฑ ุนููุฏูุง ูุนูู ุงูุณุทุญ</a></li>
<li><a href="../ar415679/index.html">ููุงุฐุง ููุธูุฑ ุงูุฃุทูุงู ุงูุฃุบููุงุก ูุชุงุฆุฌ ุฌูุฏุฉ ูู ุชุฌุฑุจุฉ ุงูุฎุทูู</a></li>
<li><a href="../ar415681/index.html">ูุตุฉ ุฅูุดุงุก ูุชุฑุฌู ูุบุฉ ุงูุฅุดุงุฑุฉ</a></li>
<li><a href="../ar415683/index.html">ุฌุฑุจ ููุณู ูู ุจุฑูุฌุฉ Q #</a></li>
<li><a href="../ar415687/index.html">Fintech Digest: ูููุฒู ุงูุจูู ุงููุฑูุฒู ุงูุจููู ุจูุญุต ุฃุฌูุฒุฉ ุงูุนููุงุก ุงูุชู ูุชู ุชุญููู ุงูุฃููุงู ูููุง</a></li>
<li><a href="../ar415689/index.html">ููุนุจ ูุนุฑูุฉ ุจุญุฑูุฉ ุนูู BGP</a></li>
<li><a href="../ar415691/index.html">ููุงุฑูุฉ ูุฑุฒ ุงูุชุจุงุฏู</a></li>
<li><a href="../ar415693/index.html">ุฃูููููุง. ูุตู ุ ูุญูุฑ ุ ุทุงุฑ (ููู ูุนุฏ ุจุงูุนูุฏุฉ). ูุฃุญุฏ ูุฐู ุงูุฃูุงู ุญูุฑุฉ ูุฑุฉ ุฃุฎุฑู</a></li>
<li><a href="../ar415695/index.html">ุงุนุชุฑูุช Google ุจุฃููุง ุชุฑูุฏ ุฃูุถูุง ุดุฑุงุก GitHub</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>