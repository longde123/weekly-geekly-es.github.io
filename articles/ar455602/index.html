<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📩 ♠️ 🏎️ إثارة المتصفح تعطل مع الغموض السلوكي 🐴 👩🏿‍🚀 👨🏿‍🤝‍👨🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="في هذه المقالة ، سوف أخبرك كيف اعتدت على الغموض للعثور على عدة حوادث في Firefox. عادةً ما يكون الغرض من الدمج هو العثور على فشل يشير إلى تلف الذاكرة ،...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>إثارة المتصفح تعطل مع الغموض السلوكي</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/vds/blog/455602/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/de5/60c/9c4/de560c9c4bd1bb90f65f35ecacdbc310.jpg" alt="صورة"><br><br>  في هذه المقالة ، سوف أخبرك كيف اعتدت على الغموض للعثور على عدة حوادث في Firefox.  عادةً ما يكون الغرض من الدمج هو العثور على فشل يشير إلى تلف الذاكرة ، لكن هدفي مختلف: أريد اكتشاف رد فعل غير متوقع للمستعرض.  يمكن أن تكون هذه أحرفًا تفتح أو تغلق علامة غير عادية ، أو ربما أحرف يتم تجاهلها بواسطة محلل JavaScript.  غالبًا ما يمكن استخدام رد الفعل غير المتوقع للقيام بهجمات XSS وتجاوز عوامل تصفية الأمان وتجنب وضع جافا سكريبت JavaScript. <a name="habracut"></a><br><br>  الخطأ الأول الذي أريد التحدث عنه هو كيفية إغلاق تعليق HTML بطريقة مختلفة.  إذا قرأت مواصفات HTML ، فأنت تعلم أنه يمكن إغلاق التعليق باستخدام -&gt; أو -!&gt;.  ولكن كيف نفعل ذلك بشكل مختلف؟  سؤال كبير لبدء الغمغمة!  تحتاج فقط إلى إنشاء الكود الذي سيعطي الجواب. <br><br>  مرة أخرى في عام 2008 ، عندما قمت بتجميع <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Shazzer لتحجيم</a> سلوك المتصفح ، اقتصرت على ما يقرب من 10000 اتجاه لكل صفحة.  اليوم ، في عام 2019 ، كل شيء يعمل بشكل أسرع ، حتى نتمكن من الغموض في كثير من الأحيان.  بالإضافة إلى ذلك ، يؤدي استخدام DOM إلى تسريع عملية الدمج لأنك لم تعد بحاجة إلى إضافة كل اتجاه إلى المستند الحالي.  تجدر الإشارة إلى أن هذا النهج غير موثوق به ، حيث يمكنك الحصول على نتائج مختلفة.  في الواقع ، لقد وجدت حالات حيث يسمح DOM بقيم خالية في وسائط السمة مثل href ، لكن محلل HTML لا يسمح بذلك.  لا تزال هذه الإخفاقات غير حرجة ، ولكن لا يمكنك الوثوق دائمًا بالنتائج للحصول على صورة كاملة لما سيقوم به محلل HTML.  ومع ذلك ، يعمل في معظم الحالات ، وهو أسرع بكثير من إخراج HTML من جانب الخادم. <br><br>  لقد تم بالفعل اتخاذ الخطوة الأولى - لدينا سؤال: "ما الأحرف التي يمكنها إغلاق تعليق HTML؟".  للإجابة عليه ، نحتاج إلى استخدام الأحرف الموجودة التي ستغلق تعليق HTML والأحرف المزيفة التي لا نعرفها.  والخطوة التالية هي استخدام برنامج مدمج مناسب.  في حالتي ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أستخدم</a> أداة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Hackvertor الخاصة</a> بي ، لكن باستخدام خادم الويب المحلي يمكنني تحقيق نفس النتائج.  فكرة هذه الأداة هي وضع الإدخال في حقل الإدخال ، وتحويل العلامات قليلاً ، والقيام بشيء ما مع الإخراج.  نظرًا لأنه لا يوجد لدينا شيء يمكن تحويله ، يمكننا وضع الشفرة الخاصة بنا مباشرةً في حقل الإخراج.  لذلك ، انقر فوق منطقة إخراج النص وقم بإنشاء مصفوفة لتخزين الأحرف الغامضة وعنصر div لاختبار HTML: <br><br><pre style=";text-align:right;direction:rtl"><code class="javascript hljs">log = []; div=<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'div'</span></span>);</code> </pre> <br>  ثم نحتاج إلى إزالة أكثر من 1،000،000 حرف من رموز Unicode أو بدقة أكبر 0x10ffff.  بسيطة للحلقة هي كل ما نحتاجه: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;=<span class="hljs-number"><span class="hljs-number">0x10ffff</span></span>;i++){</code> </pre> <br>  ثم نعيد استخدام عنصر div الذي أنشأناه لكل حرف.  في هذه الحالة ، أختبر الموضع بعد! حتى يتم إدخال الحرف بعد! .. ثم استخدم عنصر img لمعرفة ما إذا كان الاندماج ناجحًا.  إذا كان هذا العنصر موجودًا ، فسيتم إغلاق تعليق HTML ، ولدينا بعض الشخصيات المثيرة للاهتمام! <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">div.innerHTML = <span class="hljs-string"><span class="hljs-string">'&lt;!-- --!'</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCodePoint(i)+<span class="hljs-string"><span class="hljs-string">'&gt;&lt;img&gt;--&gt;'</span></span>;</code> </pre> <br>  أخيرًا ، مع querySelector نتحقق مما إذا كان img موجودًا ونضيف أحرفًا إلى السجلات.  ثم أغلق العبارة if و for loop.  أخيرًا ، أدخِل النتائج في حقل الإدخال على اليسار: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(div.querySelector(<span class="hljs-string"><span class="hljs-string">'img'</span></span>)){ log.push(i); } } input.value=log</code> </pre> <br>  هنا هو <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">النسخة الكاملة من</a> الكود.  تحتاج إلى فتح عنوان URL في Firefox ، ثم وضع أحرف الإدخال في حقل الإخراج والنقر فوق الزر "Execute JS" لإدماج الأحرف.  بعد الانتهاء من الدمج ، يجب أن تشاهد الأرقام في حقل الإدخال ، فهي تتوافق مع رموز الأحرف التي نجحت.  في وقت كتابة هذا التقرير ، كان Firefox (الإصدار 67) لا يزال يسمح لشخصيات السطر الجديد - \ n و \ r - بعد! بإغلاق التعليق.  تم إخباري أن هذا تم إصلاحه في الإصدارات المستقبلية من Firefox.  لذا ، فإن المرحلة الأخيرة من التشويش هي بناء الحمولة الصافية الخاصة بك ، إنها بسيطة جدًا.  تحتاج إلى استبدال رمز الحرف بالحرف وإضافة حمولة XSS: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">&lt;!-- --! &gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">img</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">1</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onerror</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">alert(1)</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> --&gt;</span></span></code> </pre> <br>  يمكنك استخدام Hackvertor مرة أخرى لاختبار عملها من خلال لصق ما سبق في حقل الإخراج ثم النقر فوق "اختبار HTML".  يجب أن تظهر نافذة تحذير لأن Firefox (الإصدار 67) يحل السطر الجديد كجزء من التعليق النهائي. <br><br>  لذا سمح لنا ذلك بالعثور على خطأ غير حاسم في محلل Firefox HTML.  دعونا نجد واحدة أخرى!  نحتاج إلى سؤال جديد: "ما هي الشخصيات التي يمكنها فتح تعليق HTML؟".  بدلاً من تجاوز تعليق HTML الموجود ، سنستخدم الآن تعليق HTML لتجاوز سمة HTML الموجودة.  كما أنا متأكد ، تعلمون جميعًا أنه يمكنك فتح تعليق HTML باستخدام &lt;!  -  هل هذا صحيح؟  سوف نستخدم نفس الكود مرة أخرى ، لكن هذه المرة غيّر المقصود من innerHTML للتحقق مما إذا كان التعليق مفتوحًا: <br><br><img src="https://habrastorage.org/webt/nb/ji/du/nbjidu5mobde5mgiiojvfnumiwi.png"><br><br>  وبالتالي ، فإن الرمز الذي نشربه سيكون بعد الواصلة الأولى.  إذا نجحت الشخصية في إنشاء تعليق HTML مفتوح ، فسوف تقوم بالتعليق على عنصر div وبالتالي الخروج من سمة العنوان.  هذه المرة ، عندما نقوم بتشغيل "Execute JS" ، نحصل على نتيجتين في Firefox (الإصدار 67): "0.45".  رمز 45 متوقع لأنه واصلة ، ولكن 0 حرف NULL!  هذا يعني أن Firefox يفسر التسلسل &lt;! - NULL- كتعليق مفتوح.  نوع من اللعبة!  (أعتقد أن مزودي المتصفح يحتاجون إلى المزيد من التشويش السلوكي =)).  لإنهاء حالة الاختبار هذه ، نحتاج الآن إلى إنشاء اتجاهنا.  دعونا نفعل الشيء نفسه: مرة أخرى ، استبدل الدالة String.fromCodePoint برمز NULL و XSS بالاتجاه: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.innerHTML = <span class="hljs-string"><span class="hljs-string">'&lt;!-\x00- &gt;&lt;div title="--&gt;&lt;img src=1 onerror=alert(1)&gt;"&gt;&lt;/div&gt;'</span></span>;</code> </pre> <br>  دعنا ننتقل إلى JavaScript بدلاً من HTML.  لقد اختبرت كل مستعرض وأنا آسف Mozilla ، لكن Firefox يقوم ببعض الألعاب مرة أخرى.  لقد استلهمت من حقيقة أن التداخل من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">tweet</a> jinmo123 يستخدم ميزات ES6 جديدة ومثيرة للاهتمام للاتصال بوظائف دون أقواس.  كان السؤال الذي طرحته للتعبير هو: "ما هي الشخصيات المسموح بها بعد المشغلين في أو مثيل؟"  ثم ننشئ الرمز مرة أخرى في Hackvertor ، وهو يتبع نمطًا مشابهًا ، لكن هذه المرة لا يستخدم DOM.  أولاً ، قم بإنشاء صفيف و حلقة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">log = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;=<span class="hljs-number"><span class="hljs-number">0x10ffff</span></span>;i++){</code> </pre><br>  ثم سنستخدم eval بدلاً من innerHTML لإخفاء قيمنا.  أولاً ، نحتاج إلى استخدام كتلة try catch للكشف عن أي استثناءات تسببها أحرف غير صالحة. <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">"/a/"</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCodePoint(i)+<span class="hljs-string"><span class="hljs-string">"instanceof function(){}"</span></span>);</code> </pre> <br>  يتم استخدام وظيفة eval لمعرفة ما إذا كانت JavaScript صالحة أم لا.  إذا كان الأمر كذلك ، فسيتم الانتقال إلى السطر التالي ؛ وإذا لم يكن الأمر كذلك ، فسوف يلقي استثناءً سيتم ملاحظته ، ثم ينتقل إلى الحرف التالي.  يسجل السطر التالي ببساطة الحرف ، ثم يغلق كتلة try catch و for for loop.  تعرض الوظيفة النتائج في حقل الإدخال. <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">log.push(i); }<span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(e){} } input.value=log</code> </pre> <br>  إذا قمت بتشغيل هذا الرمز باستخدام "Execute JS" ، فستحصل على مجموعة من النتائج!  يتجاهل Firefox العديد من الشخصيات.  إذا جربت الشفرة على Chrome ، فستحصل على المزيد من النتائج المعقولة.  ابحث عن رمز الحرف في حقل الإدخال الذي تريد استخدامه ، في حالتي كان "1114110" أو "0x10fffe" بالسداسي عشرية.  الآن سنقوم بإنشاء متجه JavaScript: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">"1337"</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCodePoint(<span class="hljs-number"><span class="hljs-number">1114110</span></span>)+<span class="hljs-string"><span class="hljs-string">"in"</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.fromCodePoint(<span class="hljs-number"><span class="hljs-number">1114110</span></span>)+<span class="hljs-string"><span class="hljs-string">"alert(1337)"</span></span>);</code> </pre> <br>  يمكنك أيضًا تخيل ذلك داخل برنامج SVG نصي: <br><br><img src="https://habrastorage.org/webt/hv/92/k2/hv92k2ivxpvq3-2faoms6akr9hg.png"><br><br>  تتوفر أحدث تكوينات المعالج المزدوج للخوادم المخصصة مع معالجات Intel Scalable 2019 على <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>DEDIC.SH</b></a> : <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  2x زيون سيلفر 4214 - ما مجموعه 24 النوى </li><li style=";text-align:right;direction:rtl">  2x زيون الذهب 5218 - ما مجموعه 32 النوى </li><li style=";text-align:right;direction:rtl">  2x زيون الذهب 6240 - التكوين مع 36 النوى. </li></ul><br>  تكلفة الخادم مع اثنين من زيون سيلفر 4214 - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><b>من 15210 روبل / شهر</b></a> <br>  نحن مستعدون أيضًا لجمع <b>أي تكوين من</b> أجلك - <b><a href="">اكتب لنا</a></b> ! <br><br>  إذا لم تكن هناك حاجة لقوى كبيرة من خادم مخصص - <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">VDS من 150 روبل / شهر</a></b> هو ما تحتاجه! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar455602/">https://habr.com/ru/post/ar455602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar455592/index.html">الفيروسات التي تهاجم المنشآت الصناعية كتهديد للأمن المادي</a></li>
<li><a href="../ar455594/index.html">Microsoft Edge من CVE إلى RCE على نظام التشغيل Windows 10</a></li>
<li><a href="../ar455596/index.html">DevConfX :: الإدارة - تقارير المديرين بكلمات بسيطة</a></li>
<li><a href="../ar455598/index.html">ترقية عاجل Exim إلى 4.92 - هناك عدوى نشطة</a></li>
<li><a href="../ar455600/index.html">منصة 3DEXPERIENCE تساعد في إنشاء وسائل نقل عام للمستقبل</a></li>
<li><a href="../ar455604/index.html">Ansible لإدارة تكوين ويندوز. قصة نجاح</a></li>
<li><a href="../ar455606/index.html">التعلم الآلي وتحليل البيانات: برنامج الماجستير في المدرسة العليا للاقتصاد في سان بطرسبرغ</a></li>
<li><a href="../ar455608/index.html">فهارس الصورة النقطية في Go: سرعة بحث لا تصدق</a></li>
<li><a href="../ar455610/index.html">Intel Core i7-2600K الأسطوري: اختبار Sandy Bridge في عام 2019 (الجزء الأول)</a></li>
<li><a href="../ar455612/index.html">نفكر من خلال شخصيات الألعاب والحوارات بناءً على نصيحة الكتاب وعلى مثال مؤيدي نظرية الأرض المسطحة</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>