<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëπ üò¨ ü¶ã An√°lisis de vulnerabilidades de Evil Parcel üè∏ ü§æüèª üï∑Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduccion 
 A mediados de abril, publicamos noticias sobre el troyano Android.InfectionAds.1 , que explot√≥ varias vulnerabilidades cr√≠ticas en Andr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>An√°lisis de vulnerabilidades de Evil Parcel</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/drweb/blog/457610/"><h3>  Introduccion </h3><br>  A mediados de abril, <b>publicamos</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">noticias</a> sobre el troyano <b>Android.InfectionAds.1</b> , que explot√≥ varias vulnerabilidades cr√≠ticas en Android.  Uno de ellos, CVE-2017-13156 (tambi√©n conocido como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Janus</a> ), permite que el malware infecte archivos APK sin da√±ar la firma digital.  El otro es CVE-2017-13315.  Otorga privilegios extendidos al troyano, para que pueda instalar y desinstalar aplicaciones independientemente del usuario.  Un an√°lisis detallado de <b>Android.InfectionAds.1</b> est√° disponible en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nuestra biblioteca de virus</a> ;  Mientras estamos aqu√≠, abordaremos la vulnerabilidad CVE-2017-13315 y veremos qu√© hace. <br><a name="habracut"></a><br>  CVE-2017-13315 pertenece al grupo de vulnerabilidades denominado EvilParcel.  Se encuentran en varias clases de sistema Android.  Los errores en estas clases permiten sustituir informaci√≥n durante el intercambio de datos entre aplicaciones y el sistema.  Por lo tanto, el malware que explota las vulnerabilidades de EvilParcel recibe privilegios m√°s altos y se vuelve capaz de lo siguiente: <br><br><ul><li>  instalar y eliminar aplicaciones con cualquier permiso sin la confirmaci√≥n de los usuarios; </li><li>  infectar el software instalado en el dispositivo y reemplazar los originales limpios con copias infectadas cuando se usa junto con otras vulnerabilidades; </li><li>  restablecer el PIN de la pantalla de bloqueo en dispositivos Android. </li></ul><br>  A partir de ahora, conocemos 7 vulnerabilidades de este tipo: <br><ul><li>  CVE-2017-0806 (error en la clase GateKeeperResponse), publicado en octubre de 2017; </li><li>  CVE-2017-13286 (error en la clase OutputConfiguration, publicado en abril de 2018; </li><li>  CVE-2017-13287 (error en la clase VerifyCredentialResponse), publicado en abril de 2018; </li><li>  CVE-2017-13288 (error en la clase PeriodicAdvertizingReport), publicado en abril de 2018; </li><li>  CVE-2017-13289 (error en la clase ParcelableRttResults), publicado en abril de 2018; </li><li>  CVE-2017-13311 (error en la clase SparseMappingTable), publicado en mayo de 2018; </li><li>  CVE-2017-13315 (error en la clase DcParamObject), publicado en mayo de 2018. </li></ul><br>  Todos ellos representan una amenaza para los dispositivos que ejecutan Android 5.0 - 8.1 sin la actualizaci√≥n de seguridad de mayo de 2018 (o posterior) instalada. <br><br><h3>  Requisitos previos para las vulnerabilidades de EvilParcel </h3><br>  Veamos c√≥mo pueden aparecer las vulnerabilidades de EvilParcel.  En primer lugar, debemos analizar algunas caracter√≠sticas de las aplicaciones de Android.  Todos los programas de Android interact√∫an entre s√≠, as√≠ como con el sistema operativo, enviando y recibiendo objetos Intent.  Estos objetos pueden contener un n√∫mero arbitrario de pares clave-valor dentro de un objeto Bundle. <br><br>  Al transferir una Intenci√≥n, un objeto Bundle se convierte (serializa) en una matriz de bytes envuelta en Parcel y luego se deserializa autom√°ticamente despu√©s de leer las claves y los valores de un Bundle serializado. <br><br>  En el paquete, la clave es la cadena, y el valor puede ser casi cualquier cosa.  Por ejemplo, puede ser un tipo primitivo, una cadena o un contenedor con tipos o cadenas primitivas.  Tambi√©n puede ser un objeto parcelable. <br><br>  Por lo tanto, el paquete puede contener un objeto de cualquier tipo que implemente la interfaz Parcelable.  Para esto, necesitamos implementar los m√©todos writeToParcel () y createFromParcel () para serializar y deserializar el objeto. <br><br>  Para ilustrar nuestro punto, creemos un paquete serializado simple.  Escribiremos un c√≥digo que ponga tres pares clave-valor en el paquete y lo serialice: <br><br><img src="https://habrastorage.org/webt/pf/-9/2j/pf-92jsexpyrb7p2dvi8oj3-vbs.png"><br>  Figura 1. Estructura de un objeto de paquete serializado <br><br>  Tenga en cuenta las caracter√≠sticas espec√≠ficas de la serializaci√≥n de paquetes: <br><br><ul><li>  todos los pares clave-valor se escriben secuencialmente; </li><li>  el tipo de valor se indica antes de cada valor (13 para la matriz de bytes, 1 para el entero, 0 para la cadena, etc.); </li><li>  el tama√±o de datos de longitud variable se indica antes de los datos (longitud de la cadena, n√∫mero de bytes para la matriz); </li><li>  Todos los valores est√°n alineados en 4 bytes. </li></ul><br><br>  Todas las claves y valores se escriben en el paquete secuencialmente para que al acceder a cualquier clave o valor de un objeto Bundle serializado, este √∫ltimo se deserialice por completo, tambi√©n inicializando todos los objetos Parcelable contenidos. <br><br>  Entonces, ¬øcu√°l podr√≠a ser el problema?  El problema es que algunas clases de sistema que implementan Parcelable pueden contener errores en los m√©todos createFromParcel () y writeToParcel ().  En estas clases, el n√∫mero de bytes le√≠dos en createFromParcel () diferir√° del n√∫mero de bytes escritos en writeToParcel ().  Si coloca un objeto de esta clase dentro de un paquete, los l√≠mites del objeto dentro del paquete cambiar√°n despu√©s de la reserializaci√≥n.  Esto crea las condiciones para explotar una vulnerabilidad EvilParcel. <br><br>  Veamos un ejemplo de una clase que contiene este error: <br><br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Demo</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Parcelable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] data; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Demo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">0</span></span>]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Demo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Parcel in)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> length = in.readInt(); data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[length]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { in.readByteArray(data); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Creator&lt;Demo&gt; CREATOR = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Creator&lt;Demo&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Demo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createFromParcel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Parcel in)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Demo(in); } }; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">writeToParcel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Parcel parcel, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ parcel.writeInt(data.length); parcel.writeByteArray(data); } }</code> </pre> <br>  Si el tama√±o de la matriz de datos es 0, al crear un objeto, se leer√° un int (4 bytes) en createFromParcel () y dos int (8 bytes) se escribir√°n en writeToParcel ().  El primer int se escribir√° llamando expl√≠citamente writeInt.  El segundo int se escribir√° al llamar a writeByteArray (), ya que la longitud de la matriz siempre se escribe antes que la matriz en Parcel (consulte la Figura 1). <br><br>  Las situaciones en las que el tama√±o de la matriz de datos es igual a 0 son bastante raras.  Pero incluso cuando esto sucede, el programa sigue funcionando, si solo transmite un objeto serializado a la vez (en nuestro ejemplo, el objeto Demo).  Por lo tanto, tales errores tienden a pasar desapercibidos. <br><br>  Ahora intentaremos colocar un objeto de demostraci√≥n con longitud de matriz cero en el paquete: <br><br><img src="https://habrastorage.org/webt/2y/2v/i0/2y2vi0ftdkartg9i01cc-b858g0.png"><br>  Figura 2. El resultado de agregar un objeto de demostraci√≥n de longitud cero al paquete <br><br>  Nosotros serializamos el objeto: <br><br><img src="https://habrastorage.org/webt/hv/tw/if/hvtwifj9curkc7ip6jplbdlk-yc.png"><br>  Figura 3. El objeto Bundle despu√©s de la serializaci√≥n <br><br>  Ahora intentemos deserializarlo: <br><br><img src="https://habrastorage.org/webt/_u/a1/k4/_ua1k4hp34wknsvnppv8zla0jei.png"><br>  Figura 4. El objeto Bundle despu√©s de la deserializaci√≥n <br><br>  ¬øQu√© obtenemos?  Echemos un vistazo al fragmento de paquete: <br><br><img src="https://habrastorage.org/webt/tf/qa/fn/tfqafnxzmsfujmq2xyo-kwvbc2g.png"><br>  Figura 5. Estructura del paquete despu√©s de la deserializaci√≥n del paquete <br><br>  En las Figuras 4 y 5, vemos que en lugar de dos int, se ley√≥ uno int en el m√©todo createFromParcel durante la deserializaci√≥n.  Por lo tanto, todos los valores posteriores del paquete se leyeron incorrectamente.  El valor 0x0 en 0x60 se ley√≥ como la longitud de la siguiente clave.  El valor 0x1 en 0x64 se ley√≥ como una clave.  El valor 0x31 en 0x68 se ley√≥ como un tipo de valor.  La parcela no tiene valores con el tipo 0x31, por lo tanto, readFromParcel () informa minuciosamente una excepci√≥n. <br><br>  ¬øC√≥mo se puede usar esto en la vida real y convertirse en una vulnerabilidad?  A ver!  El error anterior en las clases del sistema Parcelable permite la creaci√≥n de paquetes que pueden diferir durante la primera y repetidas deserializaciones.  Para demostrar esto, modificaremos el ejemplo anterior: <br><br><pre> <code class="java hljs">Parcel data = Parcel.obtain(); data.writeInt(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// 3 entries data.writeString("vuln_class"); data.writeInt(4); // value is Parcelable data.writeString("com.drweb.testbundlemismatch.Demo"); data.writeInt(0); // data.length data.writeInt(1); // key length -&gt; key value data.writeInt(6); // key value -&gt; value is long data.writeInt(0xD); // value is bytearray -&gt; low(long) data.writeInt(-1); // bytearray length dummy -&gt; high(long) int startPos = data.dataPosition(); data.writeString("hidden"); // bytearray data -&gt; hidden key data.writeInt(0); // value is string data.writeString("Hi there"); // hidden value int endPos = data.dataPosition(); int triggerLen = endPos - startPos; data.setDataPosition(startPos - 4); data.writeInt(triggerLen); // overwrite dummy value with the real value data.setDataPosition(endPos); data.writeString("A padding"); data.writeInt(0); // value is string data.writeString("to match pair count"); int length = data.dataSize(); Parcel bndl = Parcel.obtain(); bndl.writeInt(length); bndl.writeInt(0x4C444E42); // bundle magic bndl.appendFrom(data, 0, length); bndl.setDataPosition(0);</span></span></code> </pre> <br>  Este c√≥digo crea un paquete serializado que contiene una clase vulnerable.  Ahora veamos qu√© obtenemos despu√©s de ejecutar este c√≥digo: <br><br><img src="https://habrastorage.org/webt/tc/ke/wf/tckewffnaop28wllxnrt7pagdvs.png"><br>  Figura 6. Crear un paquete con una clase vulnerable <br><br>  Despu√©s de la primera deserializaci√≥n, este paquete contendr√° las siguientes claves: <br><br><img src="https://habrastorage.org/webt/cj/si/l0/cjsil0--g_jsoew8ht-oxely1u4.png"><br>  Figura 7. Despu√©s de la deserializaci√≥n de un paquete con una clase vulnerable <br><br>  Ahora serializaremos el paquete nuevamente, luego lo deserializaremos nuevamente y miraremos la lista de claves: <br><br><img src="https://habrastorage.org/webt/uw/e1/mj/uwe1mjdtywr59oyshaah2q1gkus.png"><br>  Figura 8. Resultado de la reserializaci√≥n y deserializaci√≥n de un paquete con una clase vulnerable <br><br>  Que vemos  El paquete ahora contiene la clave oculta (con el valor de cadena "¬°Hola!"), Que no estaba all√≠ antes.  Veamos el fragmento de paquete de este paquete para ver por qu√© sucedi√≥ esto: <br><br><img src="https://habrastorage.org/webt/i8/up/j1/i8upj1jif-_d41drqii19gw2nce.png"><br>  Figura 9. Estructura de parcela de un objeto Bundle con una clase vulnerable despu√©s de dos ciclos de serializaci√≥n y deserializaci√≥n <br><br>  Aqu√≠ es donde podemos ver todo el punto de las vulnerabilidades de EvilParcel.  Podemos crear espec√≠ficamente un paquete que contendr√° una clase vulnerable.  Cambiar los l√≠mites de esta clase permitir√° la colocaci√≥n de cualquier objeto en este paquete;  por ejemplo, una Intenci√≥n, que solo aparecer√° en el Paquete despu√©s de la segunda deserializaci√≥n.  Esto ayuda a ocultar una intenci√≥n de los mecanismos de seguridad del sistema operativo. <br><br><h3>  Explotando EvilParcel </h3><br>  <b>Android.InfectionAds.1</b> explot√≥ CVE-2017-13315 para instalar y eliminar software independientemente de los propietarios del dispositivo.  Pero como? <br><br>  En 2013, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">se descubri√≥</a> el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">error 7699048</a> , tambi√©n conocido como Launch AnyWhere.  Permiti√≥ que aplicaciones de terceros iniciaran actividades arbitrarias en nombre de un usuario del sistema m√°s privilegiado.  Vea el diagrama a continuaci√≥n para el mecanismo de acci√≥n: <br><br><img src="https://habrastorage.org/webt/in/d8/-m/ind8-mnyp5urfsndbkycy3l42f8.png"><br>  Figura 10. Operaci√≥n del error 7699048 <br><br>  Una aplicaci√≥n explotadora puede usar esta vulnerabilidad para implementar el servicio Autenticador de cuenta, dise√±ado para agregar nuevas cuentas al sistema operativo.  El error 7699048 ayuda a las actividades de inicio de explotaci√≥n para instalar, eliminar, reemplazar aplicaciones, as√≠ como restablecer el PIN o el Bloqueo de patr√≥n y causar muchos m√°s problemas. <br><br>  Google Inc.  ha eliminado esta violaci√≥n al prohibir el lanzamiento de actividades arbitrarias desde AccountManager.  Ahora, AccountManager solo permite el lanzamiento de actividades que se originan en la misma aplicaci√≥n.  Para este prop√≥sito, verifica y compara la firma digital del software que inici√≥ la actividad con la firma de la aplicaci√≥n donde se encuentra la actividad.  Se ve as√≠: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; (intent = result.getParcelable(AccountManager.KEY_INTENT)) != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/* * The Authenticator API allows third party authenticators to * supply arbitrary intents to other apps that they can run, * this can be very bad when those apps are in the system like * the System Settings. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> authenticatorUid = Binder.getCallingUid(); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> bid = Binder.clearCallingIdentity(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { PackageManager pm = mContext.getPackageManager(); ResolveInfo resolveInfo = pm.resolveActivityAsUser(intent, <span class="hljs-number"><span class="hljs-number">0</span></span>, mAccounts.userId); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> targetUid = resolveInfo.activityInfo.applicationInfo.uid; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (PackageManager.SIGNATURE_MATCH != pm.checkSignatures(authenticatorUid, targetUid)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecurityException( <span class="hljs-string"><span class="hljs-string">"Activity to be started with KEY_INTENT must "</span></span> + <span class="hljs-string"><span class="hljs-string">"share Authenticator's signatures"</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { Binder.restoreCallingIdentity(bid); } }</code> </pre><br>  Parece que el problema se ha resuelto, pero no es tan f√°cil como todo eso.  Result√≥ que la conocida vulnerabilidad, EvilParcel CVE-2017-13315, ofrece una soluci√≥n alternativa.  Como ya sabemos, despu√©s de arreglar Launch AnyWhere, el sistema verifica la firma digital de la aplicaci√≥n.  Si se verifica con √©xito, el paquete se transfiere a IAccountManagerResponse.onResult ().  Al mismo tiempo, onResult () se llama a trav√©s del mecanismo IPC, por lo que el Bundle se serializa nuevamente.  Al implementar onResult (), sucede lo siguiente: <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** Handles the responses from the AccountManager */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Response</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IAccountManagerResponse</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Stub</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResult</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle bundle)</span></span></span><span class="hljs-function"> </span></span>{ Intent intent = bundle.getParcelable(KEY_INTENT); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (intent != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; mActivity != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// since the user provided an Activity we will silently start intents // that we see mActivity.startActivity(intent); // leave the Future running to wait for the real response to this request } //&lt;.....&gt; } //&lt;.....&gt; }</span></span></code> </pre><br>  Luego, el paquete extrae la clave de intenci√≥n y la actividad se inicia sin ninguna verificaci√≥n. <br>  Por lo tanto, para iniciar una actividad arbitraria con privilegios del sistema, solo necesita crear un Paquete con el campo Intenci√≥n oculto en la primera deserializaci√≥n y que aparece durante la deserializaci√≥n repetida. <br>  Como ya sabemos, las vulnerabilidades de EvilParcel realmente pueden realizar esta tarea. <br><br>  Por el momento, todas las vulnerabilidades conocidas de este tipo se han corregido dentro de las clases vulnerables Parcelable.  Sin embargo, pueden aparecer nuevas clases vulnerables en el futuro.  La implementaci√≥n del paquete y el mecanismo para agregar nuevas cuentas siguen siendo los mismos que antes.  Todav√≠a nos permiten crear este exploit exacto al detectar clases parcelables vulnerables viejas o nuevas.  Adem√°s, estas clases todav√≠a se implementan manualmente, y el programador debe asegurarse de que la longitud del objeto Parcelable serializado permanezca igual, lo cual es un factor humano con todo lo que implica.  Sin embargo, esperamos que haya la menor cantidad de errores posibles y que las vulnerabilidades de EvilParcel no sean una amenaza para los usuarios de Android. <br><br>  Puede verificar las vulnerabilidades de EvilParcel en su dispositivo m√≥vil utilizando nuestro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Dr.Web Security Space</a> para Android.  El Auditor de seguridad incorporado informar√° los problemas detectados y recomendar√° formas de eliminarlos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/457610/">https://habr.com/ru/post/457610/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457596/index.html">OSDay 19 o por qu√© el lenguaje C sigue vivo</a></li>
<li><a href="../457600/index.html">Descripci√≥n general de los auriculares Snom A150, Snom A100M y D</a></li>
<li><a href="../457602/index.html">Investigar el rendimiento de DBMS MS SQL Server Developer 2016 y PostgreSQL 10.5 para 1C</a></li>
<li><a href="../457606/index.html">Alan Kay: ¬øQu√© se puede llamar lo m√°s sorprendente que las computadoras hicieron posible?</a></li>
<li><a href="../457608/index.html">C√≥mo visualizar datos en una historia convincente</a></li>
<li><a href="../457612/index.html">¬øC√≥mo acelerar la descompresi√≥n de LZ4 en ClickHouse?</a></li>
<li><a href="../457614/index.html">Secretos de encontrar un trabajo en el extranjero de un cazatalentos en ejercicio</a></li>
<li><a href="../457616/index.html">Mi "¬°Guau, no lo sab√≠a!" momentos con broma</a></li>
<li><a href="../457618/index.html">Ser un desarrollador moderno de pila completa</a></li>
<li><a href="../457622/index.html">Medici√≥n del rendimiento de Qt</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>