<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÑ üïö üë©üèø‚Äçü§ù‚Äçüë©üèº Almacenamiento en cach√© de disco de √°rboles de computaci√≥n diferida üí∑ üßïüèø üêÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="No vale la pena hablar en detalle del concepto de computaci√≥n diferida. La idea de hacer lo mismo con menos frecuencia, especialmente si es larga y pe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Almacenamiento en cach√© de disco de √°rboles de computaci√≥n diferida</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422937/"><p>  No vale la pena hablar en detalle del concepto de computaci√≥n diferida.  La idea de hacer lo mismo con menos frecuencia, especialmente si es larga y pesada, es tan antigua como el mundo.  Porque inmediatamente al grano. </p><br><p>  Seg√∫n el autor de este texto, un lenificador normal deber√≠a: </p><br><ol><li>  Guardar c√°lculos entre llamadas de programa. </li><li>  Rastree los cambios en el √°rbol de c√°lculo. </li><li>  Tener una sintaxis moderadamente transparente. </li></ol><br><p><img src="https://habrastorage.org/webt/de/dw/ec/dedwectoekaqhwzkercd2dgnk1u.jpeg" alt="√Årbol perezoso"></p><a name="habracut"></a><br><h2 id="koncepciya">  Concepto </h2><br><p>  En orden: </p><br><ol><li> Guardar c√°lculos entre llamadas de programa: <br>  De hecho, si llamamos al mismo script varias decenas y cientos de veces al d√≠a, ¬øpor qu√© deber√≠amos volver a calcular el mismo cada vez que se llama al script, si es posible almacenar el objeto de resultado en un archivo?  Es mejor extraer un objeto del disco, pero ... debemos estar seguros de su relevancia.  De repente, el gui√≥n se reescribe y el objeto guardado est√° desactualizado.  En base a esto, no podemos simplemente cargar el objeto cuando existe un archivo.  El segundo punto se sigue de esto. </li><li>  Rastree los cambios en el √°rbol de c√°lculo: <br>  La necesidad de actualizar el objeto debe calcularse sobre la base de los datos sobre los argumentos de la funci√≥n que lo genera.  Entonces nos aseguraremos de que el objeto cargado sea v√°lido.  De hecho, para una funci√≥n pura, el valor de retorno depende solo de los argumentos.  Esto significa que mientras almacenamos en cach√© los resultados de las funciones puras y monitoreamos los cambios en los argumentos, podemos estar tranquilos sobre la relevancia de la memoria cach√©.  Al mismo tiempo, si el objeto calculado depende de otro objeto en cach√© (perezoso), que a su vez depende de otro, debe resolver correctamente los cambios en estos objetos, actualizando a tiempo los nodos de la cadena que ya no son relevantes.  Por otro lado, ser√≠a bueno tener en cuenta que no siempre necesitamos cargar los datos de toda la cadena de c√°lculo.  A menudo, cargar solo el objeto del resultado final es suficiente. </li><li>  Tener una sintaxis moderadamente transparente: <br>  Este punto es claro.  Si para reescribir la secuencia de comandos a c√°lculos diferidos es necesario cambiar todo el c√≥digo, esta es una soluci√≥n regular.  Los cambios deben hacerse al m√≠nimo. </li></ol><br><p>  Esta l√≠nea de razonamiento condujo a una soluci√≥n t√©cnica, dise√±ada en python por la biblioteca evalcache (enlaces al final del art√≠culo). </p><br><h2 id="sintaksicheskoe-reshenie-i-mehanizm-raboty">  Soluci√≥n de sintaxis y mecanismo de trabajo </h2><br><div class="spoiler">  <b class="spoiler_title">Ejemplo simple</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> evalcache <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> hashlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> shelve lazy = evalcache.Lazy(cache = shelve.open(<span class="hljs-string"><span class="hljs-string">".cache"</span></span>), algo = hashlib.sha256) @lazy <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">summ</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a,b,c)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b + c @lazy <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a * a a = <span class="hljs-number"><span class="hljs-number">1</span></span> b = sqr(<span class="hljs-number"><span class="hljs-number">2</span></span>) c = lazy(<span class="hljs-number"><span class="hljs-number">3</span></span>) lazyresult = summ(a, b, c) result = lazyresult.unlazy() print(lazyresult) <span class="hljs-comment"><span class="hljs-comment">#f8a871cd8c85850f6bf2ec96b223de2d302dd7f38c749867c2851deb0b24315c print(result) #8</span></span></code> </pre> </div></div><br><p>  Como funciona </p><br><p>  Lo primero que llama la atenci√≥n aqu√≠ es la creaci√≥n del decorador perezoso.  Tal soluci√≥n sint√°ctica es bastante est√°ndar para las pitones Python.  Al decorador perezoso se le pasa un objeto de cach√© en el que el lenificador almacenar√° los resultados de los c√°lculos.  Los requisitos de la interfaz tipo dict se superponen en el tipo de cach√©.  En otras palabras, podemos almacenar en cach√© todo lo que implemente la misma interfaz que el tipo dict.  Para demostrar en el ejemplo anterior, utilizamos el diccionario de la biblioteca de estanter√≠as. </p><br><p>  Al decorador tambi√©n se le env√≠a un protocolo hash que usar√° para construir claves hash de objetos y algunas opciones adicionales (permiso de escritura, permiso de lectura, salida de depuraci√≥n), que se pueden encontrar en la documentaci√≥n o el c√≥digo. </p><br><p>  El decorador se puede aplicar tanto a funciones como a objetos de otros tipos.  En este momento, un objeto vago se construye sobre la base de una clave hash calculada sobre la base de la representaci√≥n (o utilizando una funci√≥n hash especialmente definida para este tipo de funci√≥n). </p><br><p>  Una caracter√≠stica clave de la biblioteca es que un objeto perezoso puede generar otros objetos perezosos, y la clave hash del padre (o padres) se mezclar√° con la clave hash del descendiente.  Para objetos perezosos, se permite el uso de la operaci√≥n de tomar un atributo, el uso de llamadas ( <code>__call__</code> ) de objetos y el uso de operadores. </p><br><p>  Al pasar por un script, de hecho, no se realizan c√°lculos.  Para b el cuadrado no se calcula, y para el resultado diferido no se considera la suma de los argumentos.  En cambio, se construye un √°rbol de operaciones y se calculan las claves hash de los objetos perezosos. </p><br><p>  Los c√°lculos reales (si el resultado no se coloc√≥ previamente en la memoria cach√©) se realizar√°n solo en la l√≠nea: <code>result = lazyresult.unlazy()</code> </p><br><p>  Si el objeto se calcul√≥ previamente, se cargar√° desde el archivo. <br>  Puedes visualizar el √°rbol de construcci√≥n: </p><br><div class="spoiler">  <b class="spoiler_title">Construir visualizaci√≥n de √°rbol</b> <div class="spoiler_text"><pre> <code class="python hljs">evalcache.print_tree(lazyresult) ... generic: &lt;function summ at <span class="hljs-number"><span class="hljs-number">0x7f1cfc0d5048</span></span>&gt; args: <span class="hljs-number"><span class="hljs-number">1</span></span> generic: &lt;function sqr at <span class="hljs-number"><span class="hljs-number">0x7f1cf9af29d8</span></span>&gt; args: <span class="hljs-number"><span class="hljs-number">2</span></span> ------- <span class="hljs-number"><span class="hljs-number">3</span></span> -------</code> </pre> </div></div><br><p>  Dado que los hashes de los objetos se construyen sobre la base de los datos sobre los argumentos que generan estos objetos, cuando el argumento cambia, el hash del objeto cambia y con √©l los hashes de toda la cadena dependiendo de √©l.  Esto le permite mantener los datos de cach√© actualizados haciendo actualizaciones a tiempo. </p><br><p>  Los objetos perezosos se alinean en un √°rbol.  Si realizamos una operaci√≥n lenta en uno de los objetos, se cargar√°n y contar√°n exactamente tantos objetos como sea necesario para obtener un resultado v√°lido.  Idealmente, el objeto necesario simplemente se cargar√°.  En este caso, el algoritmo no extraer√° los objetos en formaci√≥n en la memoria. </p><br><h2 id="v-deystvii">  En acci√≥n </h2><br><p>  Lo anterior fue un ejemplo simple que muestra la sintaxis pero no demuestra el poder computacional del enfoque. <br>  Aqu√≠ hay un ejemplo un poco m√°s cercano a la vida real (usado por sympy). </p><br><div class="spoiler">  <b class="spoiler_title">Ejemplo usando sympy y numpy</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3.5 from sympy import * import numpy as np import math import evalcache lazy = evalcache.Lazy(evalcache.DirCache(".evalcache"), diag = True) pj1, psi, y0, gamma, gr= symbols("pj1 psi y0 gamma gr") ###################### Construct sympy expression ##################### F = 2500 xright = 625 re = 625 y0 = 1650 gr = 2*math.pi / 360 #gamma = pi / 2 xj1q = xright + re * (1 - cos(psi)) yj1q = (xright + re) * tan(psi) - re * sin(psi) #+ y0 pj1 = sqrt(xj1q**2 + yj1q**2) pj2 = pj1 + y0 * sin(psi) zj2 = (pj2**2)/4/F asqrt = sqrt(pj2**2 + 4*F**2) xp2 = 2*F / asqrt yp2 = pj2 / asqrt xp3 = yp2 yp3 = -xp2 xmpsi = 1295 gmpsi = 106 * gr aepsi = 600 bepsi = 125 b = 0.5*(1-cos(pi * gamma / gmpsi)) p1 = ( (gamma * xmpsi / gmpsi * xp2) * (1-b) + (aepsi * xp2 * sin(gamma) + bepsi * yp2 * (1-cos(gamma)))*b + pj1 ) ####################################################################### #First lazy node. Simplify is long operation. #Sympy has very good representations for expressions print("Expression:", repr(p1)) print() p1 = lazy(simplify)(p1) ######################################################################################### ## Really don't need to lazify fast operations Na = 200 angles = [t * 2 * math.pi / 360 / Na * 106 for t in range(0,Na+1)] N = int(200) a = (np.arange(0,N+1) - N/2) * 90/360*2*math.pi/N ######################################################################################### @lazy def genarray(angles, a, p1): points = [] for i in range(0, len(angles)): ex = p1.subs(gamma, angles[i]) func = lambdify(psi, ex, 'numpy') # returns a numpy-ready function rads = func(a) xs = rads*np.cos(a) ys = rads*np.sin(a) arr = np.column_stack((xs,ys,[i*2]*len(xs))) points.append(arr) return points #Second lazy node. arr = genarray(angles, a, p1).unlazy() print("\nResult list:", arr.__class__, len(arr))</span></span></code> </pre> </div></div><br><p>  Las operaciones para simplificar las expresiones simb√≥licas son extremadamente costosas y literalmente piden lenificaci√≥n.  La construcci√≥n adicional de una gran matriz lleva a√∫n m√°s tiempo, pero gracias a la lenificaci√≥n, los resultados se extraer√°n del cach√©.  Tenga en cuenta que si se cambia alg√∫n coeficiente en la parte superior del script donde se genera la expresi√≥n sympy, los resultados se volver√°n a calcular porque la clave hash del objeto vago cambiar√° (gracias a las interesantes declaraciones <code>__repr__</code> ). </p><br><p>  Muy a menudo, una situaci√≥n ocurre cuando un investigador realiza experimentos computacionales en un objeto generado desde hace mucho tiempo.  Puede usar varios scripts para separar la generaci√≥n y el uso del objeto, lo que puede causar problemas con la actualizaci√≥n prematura de datos.  El enfoque propuesto puede facilitar este caso. </p><br><h2 id="radi-chego-vsyo-zatevalos">  ¬øDe qu√© se trata todo esto? </h2><br><p>  evalcache es parte del proyecto zencad.  Este es un peque√±o script cadic, inspirado y que explota las mismas ideas que openscad.  A diferencia de openscad orientado a la malla, zencad que se ejecuta en el n√∫cleo de opencascade utiliza una representaci√≥n breve de objetos y los scripts se escriben en python. </p><br><p>  Las operaciones geom√©tricas a menudo se realizan durante mucho tiempo.  La desventaja de los sistemas de secuencias de comandos cad es que cada vez que ejecuta la secuencia de comandos, el producto se vuelve a contar por completo.  Adem√°s, con el crecimiento y la complicaci√≥n del modelo, los costos generales no crecen linealmente.  Esto lleva al hecho de que puede trabajar c√≥modamente solo con modelos extremadamente peque√±os. </p><br><p>  La tarea de evalcache era suavizar este problema.  En zencad, todas las operaciones se declaran perezosas. </p><br><p>  Ejemplos: </p><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de construcci√≥n modelo</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 #coding: utf-8 from zencad import * xgate = 14.65 ygate = 11.6 zgate = 11 t = (xgate - 11.7) / 2 ear_r = 8.6/2 ear_w = 7.8 - ear_r ear_z = 3 hx_h = 2.0 bx = xgate + ear_w by = 2 bz = ear_z+1 gate = ( box(xgate, ygate, t).up(zgate - t) + box(t, ygate, zgate) + box(t, ygate, zgate).right(xgate - t) ) gate = gate.fillet(1, [5, 23,29, 76]) gate = gate.left(xgate/2) ear = (box(ear_w, ear_r * 2, ear_z) + cylinder(r = ear_r, h = ear_z).forw(ear_r).right(ear_w)).right(xgate/2 - t) hx = linear_extrude( ngon(r = 2.5, n = 6).rotateZ(deg(90)).forw(ear_r), hx_h ).up(ear_z - hx_h).right(xgate/2 -t + ear_w) m = ( gate + ear + ear.mirrorYZ() - hx - hx.mirrorYZ() - box(xgate-2*t, ygate, zgate, center = True).forw(ygate/2) - box(bx, by, bz, center = True).forw(ear_r).up(bz/2) - cylinder(r = 2/2, h = 100, center = True).right(xgate/2-t+ear_w).forw(ear_r) - cylinder(r = 2/2, h = 100, center = True).left(xgate/2-t+ear_w).forw(ear_r) ) display(m) show()</span></span></code> </pre> <br><p>  Este script genera el siguiente modelo: <br><img src="https://habrastorage.org/webt/np/4i/go/np4igo9nth8jdmuplhz6pd2o9mg.png"><br>  Tenga en cuenta que no hay llamadas evalcache en el script.  El truco es que la lenificaci√≥n est√° incrustada en la propia biblioteca zencad y ni siquiera es visible a primera vista, aunque todo el trabajo aqu√≠ est√° trabajando con objetos perezosos, y el c√°lculo directo se realiza solo en la funci√≥n 'mostrar'.  Por supuesto, si se cambia alg√∫n par√°metro del modelo, el modelo se volver√° a contar desde el lugar donde cambi√≥ la primera clave hash. </p></div></div><br><div class="spoiler">  <b class="spoiler_title">Modelos de computaci√≥n voluminosa</b> <div class="spoiler_text"><p>  Aqu√≠ hay otro ejemplo.  Esta vez nos limitaremos a las im√°genes: <br><img src="https://habrastorage.org/webt/go/3f/zu/go3fzuma_btpyqlvqsb8zxnc6qc.png"><br>  El c√°lculo de una superficie roscada no es una tarea f√°cil.  En mi computadora, este tornillo est√° construido en el orden de diez segundos ... Editar un modelo con hilos es mucho m√°s agradable usando el almacenamiento en cach√©. </p><br><p>  Y ahora esto es un milagro: <br><img src="https://habrastorage.org/webt/ux/qs/kc/uxqskci0b_u_3cfdghkpdliygou.png"><br>  Cruzar superficies roscadas es una tarea computacional compleja.  Valor pr√°ctico, sin embargo, nada menos que comprobar las matem√°ticas.  El c√°lculo lleva un minuto y medio.  Un objetivo digno para la lenificaci√≥n. </p></div></div><br><h2 id="problemy">  Los problemas </h2><br><p>  Es posible que el cach√© no funcione seg√∫n lo previsto. <br>  Los errores de cach√© se pueden dividir en <strong>falso positivo</strong> y <strong>falso negativo</strong> . </p><br><h3 id="lozhnootricatelnye-oshibki">  Errores falsos negativos </h3><br><p>  Los falsos errores negativos son situaciones en las que el resultado del c√°lculo est√° en la memoria cach√©, pero el sistema no lo encontr√≥. <br>  Esto sucede si el algoritmo de clave hash utilizado por evalcache por alguna raz√≥n produjo una clave diferente para el rec√°lculo.  Si la funci√≥n hash no se reemplaza para el objeto del tipo en cach√©, evalcache usa la <code>__repr__</code> objeto para construir la clave. <br>  Se produce un error, por ejemplo, si la clase que se alquila no anula el <code>object.__repr__</code> est√°ndar <code>object.__repr__</code> , que cambia de principio a inicio.  O, si el <code>__repr__</code> reemplazado, de alguna manera depende de insignificante para el c√°lculo de los datos cambiantes (como la direcci√≥n del objeto o la marca de tiempo). </p><br><p>  Malo: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.i = <span class="hljs-number"><span class="hljs-number">3</span></span> A_lazy = lazy(A) A_lazy().unlazy() <span class="hljs-comment"><span class="hljs-comment">#        -  __repr__.</span></span></code> </pre> <br><p>  Bueno </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.i = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__repr__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"A({})"</span></span>.format(self.i) A_lazy = lazy(A) A_lazy().unlazy() <span class="hljs-comment"><span class="hljs-comment">#     .</span></span></code> </pre> <br><p>  Los falsos errores negativos conducen al hecho de que la lenificaci√≥n no funciona.  El objeto ser√° contado en cada nueva ejecuci√≥n de script. </p><br><h3 id="lozhnopolozhitelnye-oshibki">  Errores falsos positivos </h3><br><p>  Este es un tipo de error m√°s vil, ya que conduce a errores en el objeto final de c√°lculo: <br>  Puede suceder por dos razones. </p><br><ul><li>  Incre√≠ble: <br>  Se produjo una colisi√≥n de clave hash en el cach√©.  Para el algoritmo sha256 que tiene un espacio de 115792089237316195423570985008687907853269984665640564039457584007913129639936 claves posibles, la probabilidad de una colisi√≥n es insignificante. </li><li>  Probable: <br>  Una representaci√≥n de un objeto (o una funci√≥n hash anulada) no lo describe completamente o coincide con una representaci√≥n de un objeto de otro tipo. </li></ul><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">A</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.i = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__repr__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"({})"</span></span>.format(self.i) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">B</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.i = <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__repr__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"({})"</span></span>.format(self.i) A_lazy = lazy(A) B_lazy = lazy(B) a = A_lazy().unlazy() b = B_lazy().unlazy() <span class="hljs-comment"><span class="hljs-comment">#.     B,        A.</span></span></code> </pre> <br><p>  Ambos problemas est√°n relacionados con un objeto <code>__repr__</code> incompatible.  Si por alguna raz√≥n es imposible sobrescribir el tipo de objeto <code>__repr__</code> , la biblioteca le permite establecer una funci√≥n hash especial para el tipo de usuario. </p><br><h2 id="ob-analogah">  Sobre an√°logos </h2><br><p>  Existen muchas bibliotecas de lenificaci√≥n que b√°sicamente consideran suficiente ejecutar un c√°lculo no m√°s de una vez por llamada de script. </p><br><p>  Hay muchas bibliotecas de almacenamiento en cach√© de disco que, a petici√≥n suya, guardar√°n un objeto con la clave necesaria para usted. </p><br><p>  Pero todav√≠a no pude encontrar bibliotecas que permitieran el almacenamiento en cach√© de resultados en el √°rbol de ejecuci√≥n.  Si hay alguno, por favor, inseguro. </p><br><p>  Referencias </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Proyecto Github</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Proyecto Pypi</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422937/">https://habr.com/ru/post/es422937/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422923/index.html">C√≥mo marcar el d√≠a del programador sin decorar los ficus de oficina con ceros y unos</a></li>
<li><a href="../es422925/index.html">Entrevista con el orador de la conferencia RubyRussia Godfrey Chan</a></li>
<li><a href="../es422929/index.html">Yandex Mail [estuvo] no disponible durante aproximadamente una hora a las 12:16 hora de Mosc√∫</a></li>
<li><a href="../es422931/index.html">Analizamos las herramientas para monitorear aplicaciones distribuidas</a></li>
<li><a href="../es422935/index.html">2GIS est√° a tu alcance. C√≥mo agregamos un mapa al Apple Watch</a></li>
<li><a href="../es422939/index.html">El libro "Kali Linux de los desarrolladores"</a></li>
<li><a href="../es422941/index.html">"Tres en un bote, pobreza y perros", o c√≥mo el antiplagiarismo busca par√°frasis</a></li>
<li><a href="../es422943/index.html">Un poco sobre miner√≠a industrial</a></li>
<li><a href="../es422945/index.html">27 de septiembre, Mosc√∫ - Mitap QIWI SERVER PARTY 3.0</a></li>
<li><a href="../es422947/index.html">C√≥mo configurar el archivado de las copias de seguridad de Veeam en Microsoft Azure Blob Storage con StarWind VTL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>