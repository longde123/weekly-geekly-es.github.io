<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯд╛ЁЯП╝ ЁЯРД ЁЯМ╗ рдПрд░реНрд▓рд╛рдВрдЧ рдореЗрдВ рдореЛрдирд╛рдбреНрд╕ ЁЯО▓ ЁЯзЪЁЯП╝ ЁЯШа</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Habr├й рдкрд░, рдЖрдк рдХрдИ рдкреНрд░рдХрд╛рд╢рдиреЛрдВ рдХреЛ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рджреЛрдиреЛрдВ рд╕рд╛рдзреБрдУрдВ рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдФрд░ рдЙрдирдХреЗ рдЖрд╡реЗрджрди рдХреЗ рдЕрднреНрдпрд╛рд╕ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддреЗ рд╣реИрдВред рдЗрдирдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рд▓реЗрдЦ рд╣рд╛рд╕реНрдХреЗрд▓ рдХреЗ рдмрд╛рд░реЗ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрд░реНрд▓рд╛рдВрдЧ рдореЗрдВ рдореЛрдирд╛рдбреНрд╕</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466697/"><p><img src="https://habrastorage.org/webt/uu/-w/xm/uu-wxmn1samfdcrveqdv27zpvvm.jpeg"></p><br><p>  Habr├й рдкрд░, рдЖрдк рдХрдИ рдкреНрд░рдХрд╛рд╢рдиреЛрдВ рдХреЛ рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рджреЛрдиреЛрдВ рд╕рд╛рдзреБрдУрдВ рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрдд рдФрд░ рдЙрдирдХреЗ рдЖрд╡реЗрджрди рдХреЗ рдЕрднреНрдпрд╛рд╕ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддреЗ рд╣реИрдВред  рдЗрдирдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рд▓реЗрдЦ рд╣рд╛рд╕реНрдХреЗрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИрдВред  рдореИрдВ nth рд╕рдордп рдХреЗ рд▓рд┐рдП рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЛ рдлрд┐рд░ рд╕реЗ рдирд╣реАрдВ рд▓рд┐рдЦреВрдВрдЧрд╛ред  рдЖрдЬ рд╣рдо рдХреБрдЫ Erlang рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реЗрдВрдЧреЗ, рдЙрдиреНрд╣реЗрдВ рд╕рд╛рдзреБрдУрдВ рдХреЗ рд╕рд╛рде рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ, рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдЖрдВрд╢рд┐рдХ рдЙрдкрдпреЛрдЧ рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">erlando</a> рд╕реЗ рд╡рд╛рдХреНрдпрдЧрдд рдЪреАрдиреА - RabbitMQ рдЯреАрдо рд╕реЗ рдПрдХ рд╢рд╛рдВрдд рдкреБрд╕реНрддрдХрд╛рд▓рдпред </p><a name="habracut"></a><br><h2 id="vvedenie">  рдкрд░рд┐рдЪрдп </h2><br><p>  рдПрд░реНрд▓реИрдВрдЧ рдореЗрдВ рдЕрд╕реНрдерд┐рд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЛрдИ рд╕рдиреНрдпрд╛рд╕реА рдирд╣реАрдВред  рд▓реЗрдХрд┐рди рднрд╛рд╖рд╛ рдореЗрдВ parse_transform рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдФрд░ erlando рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдЕрднреА рднреА рдЗрд░рдбрд╛рдВрдЧ рдореЗрдВ рдордареЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред </p><br><p>  рдХрд╣рд╛рдиреА рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдкреНрд░рддрд┐рд░рдХреНрд╖рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ, рдореИрдВрдиреЗ рд╕рдВрдпреЛрдЧ рд╕реЗ рдмрд╛рдд рдирд╣реАрдВ рдХреАред  рдЗрдореНрдпреВрдирд┐рдЯреА рд▓рдЧрднрдЧ рд╣рд░ рдЬрдЧрд╣ рдФрд░ рд╣рдореЗрд╢рд╛ рд╣реЛрддреА рд╣реИ - рдПрд░реНрд▓реИрдВрдЧ рдХреЗ рдореБрдЦреНрдп рд╡рд┐рдЪрд╛рд░реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХред  рдХрд╛рд░реНрдпреЛрдВ рдХреА рдкреНрд░рддрд┐рд░рдХреНрд╖рд╛ рдФрд░ рд╢реБрджреНрдзрддрд╛ рдЖрдкрдХреЛ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╡рд┐рдХрд╛рд╕ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдиреЗ рдФрд░ рд╕рд╛рдЗрдб рдЗрдлреЗрдХреНрдЯ рд╕реЗ рдбрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддреА рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрд╛рд╡рд╛ рдпрд╛ рдкрд╛рдЗрдерди рд╕реЗ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдПрд░рд▓реИрдВрдЧ рдХреЗ рдирдП рд▓реЛрдЧ, рдПрд░реНрд▓реИрдВрдЧ рдХреЗ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рд╕рдордЭрдирд╛ рдФрд░ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рдирд╛ рдХрд╛рдлреА рдореБрд╢реНрдХрд┐рд▓ рд╣реИред  рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдпрджрд┐ рдЖрдк рдПрд░рд▓рдВрдЧ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХреЛ рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВред  рдЬрд┐рди рд▓реЛрдЧреЛрдВ рдиреЗ рдПрд░рд▓рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреА, рдЙрдиреНрд╣реЛрдВрдиреЗ рд╢рд╛рдпрдж рдЗрд╕рдХреА рдЕрд╕рд╛рдорд╛рдиреНрдпрддрд╛ рдФрд░ рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рдкрд░ рдзреНрдпрд╛рди рджрд┐рдпрд╛ред  рдХрд┐рд╕реА рднреА рдорд╛рдорд▓реЗ рдореЗрдВ, рдореИрдВрдиреЗ рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рд╕реЗ рдмрд╣реБрдд рдЕрдзрд┐рдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдПрдХрддреНрд░ рдХреА рд╣реИ рдФрд░ "рдЕрдЬреАрдм" рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рд░реЗрдЯрд┐рдВрдЧ рдХрд╛ рдиреЗрддреГрддреНрд╡ рдХрд░рддрд╛ рд╣реИред </p><br><h2 id="erlando">  Erlando </h2><br><p>  рдПрд░реНрд▓реИрдВрдбреЛ рдПрдХ рдПрд░рд▓реИрдВрдЧ рдПрдХреНрд╕рдЯреЗрдВрд╢рди рд╕реЗрдЯ рд╣реИ рдЬреЛ рд╣рдореЗрдВ рджреЗ рд░рд╣рд╛ рд╣реИ: </p><br><ul><li>  рдпреЛрдЬрдирд╛ рдЬреИрд╕реЗ рдХрдЯреМрддреА рдХреЗ рд╕рд╛рде рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЖрдВрд╢рд┐рдХ рдЙрдкрдпреЛрдЧ / рдХрд░реА </li><li>  рд╣рд╛рд╕реНрдХреЗрд▓ рдЬреИрд╕реА рдзрд╛рд░рдгрд╛рдПрдБ </li><li>  import-as - рдЕрдиреНрдп рдореЙрдбреНрдпреВрд▓ рд╕реЗ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЛ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд┐рдВрдЯреИрдХреНрдЯрд┐рдХ рд╢реБрдЧрд░ред </li></ul><br><p>  <strong>рдиреЛрдЯ:</strong> рдореИрдВрдиреЗ рдореИрдереНрдпреВ рд╕реИрдХрдореИрди рдХреА рдкреНрд░рд╕реНрддреБрддрд┐ рд╕реЗ рдПрд░рд▓реИрдВрдбреЛ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рд▓рд┐рдпрд╛, рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдореЗрд░реЗ рдХреЛрдб рдФрд░ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреЗ рд╕рд╛рде рдкрддрд▓рд╛ рдХрд┐рдпрд╛ред </p><br><h2 id="abstrakciya-cut">  рд╕рд╛рд░ рдХрдЯ </h2><br><p>  рд╕реАрдзреЗ рдмрд┐рдВрджреБ рдкрд░ рдЬрд╛рдПрдВред  рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рд╕реЗ рдХрдИ рдХрд╛рд░реНрдпреЛрдВ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: </p><br><pre><code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">info_all</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(VHostPath, Items)</span></span></span><span class="hljs-function"> -&gt;</span></span> map(VHostPath, <span class="hljs-keyword"><span class="hljs-keyword">fun</span></span> (Q) -&gt; info(Q, Items) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>). backing_queue_timeout(State = #q{ backing_queue = BQ }) -&gt; run_backing_queue( BQ, <span class="hljs-keyword"><span class="hljs-keyword">fun</span></span> (M, BQS) -&gt; M:timeout(BQS) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, State). reset_msg_expiry_fun(TTL) -&gt; <span class="hljs-keyword"><span class="hljs-keyword">fun</span></span> (MsgProps) -&gt; MsgProps #message_properties{ expiry = calculate_msg_expiry(TTL)} <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br><p>  рдЗрди рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕рд░рд▓ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдореЗрдВ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдПрдХ рдЖрдВрд╢рд┐рдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреЙрд▓ рд╕реЗ рдкрд╣рд▓реЗ рдХреБрдЫ рдорд╛рдкрджрдВрдбреЛрдВ рдХрд╛ рдкрддрд╛ рдирд╣реАрдВ рдЪрд▓реЗрдЧрд╛ред  рд▓рдЪреАрд▓реЗрдкрди рдХреЗ рд╕рд╛рде, рдпреЗ рд╡рд┐рд╢реЗрд╖рддрд╛рдПрдВ рд╣рдорд╛рд░реЗ рдХреЛрдб рдореЗрдВ рд╢реЛрд░ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред  рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рдХреЛ рдереЛрдбрд╝рд╛ рдмрджрд▓рдХрд░ - рдХрдЯ рджрд░реНрдЬ рдХрд░рдХреЗ - рдЖрдк рд╕реНрдерд┐рддрд┐ рдХреЛ рд╕реБрдзрд╛рд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><h3 id="znachenie-_">  рдорд╛рди _ </h3><br><ul><li>  _ рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рдореЗрдВ рдЗрд╕реНрддреЗрдорд╛рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </li><li>  рдХрдЯ рдЖрдкрдХреЛ рдмрд╛рд╣рд░ рдХреЗ рдкреИрдЯрд░реНрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рджреЗрддрд╛ рд╣реИ </li><li>  рдпрджрд┐ рдпрд╣ <em>рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЗ рдмрд╛рд╣рд░ рд╣реИ, рддреЛ рдпрд╣</em> рдЙрд╕ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдмрди рдЬрд╛рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рд╕реНрдерд┐рдд рд╣реИ </li><li>  рдПрдХ рд╣реА рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХреЗ рднреАрддрд░ _ рдХреЗ рдХрдИ рдЙрдкрдпреЛрдЧ рдЗрд╕ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдореЗрдВ рдХрдИ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдХреА рдУрд░ рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ </li><li>  рдХрдЯ рдХреНрд▓реЛрдЬрд░ (рдлрди) рдХреЗ рд▓рд┐рдП рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди рдирд╣реАрдВ рд╣реИ </li><li>  рдХрдЯ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдкрд╣рд▓реЗ рддрд░реНрдХ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ul><br><p>  рдПрдмреНрд╕рдЯреНрд░реИрдХреНрд╢рди рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдпрд╣ рдЗрдВрдЧрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдЯ рдЗрди _ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдХрдЯ рдХреЗрд╡рд▓ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдореЗрдВ рдирд┐рдХрдЯрддрдо рд╕реНрддрд░ рдХреЛ рд▓рдкреЗрдЯрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдиреЗрд╕реНрдЯреЗрдб рдХрдЯ рдирд┐рд╖рд┐рджреНрдз рдирд╣реАрдВ рд╣реИред <br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП <code>list_to_binary([1, 2, math:pow(2, _)]).</code>  <code>list_to_binary([1, 2, fun (X) -&gt; math:pow(2, X) end]).</code> рд╣реИ <code>list_to_binary([1, 2, fun (X) -&gt; math:pow(2, X) end]).</code>  рд▓реЗрдХрд┐рди <code>fun (X) -&gt; list_to_binary([1, 2, math:pow(2, X)]) end.</code>  ред </p><br><p>  рдпрд╣ рдереЛрдбрд╝рд╛ рднреНрд░рдорд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд▓рдЧрддрд╛ рд╣реИ, рдЪрд▓реЛ рдХрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдКрдкрд░ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦреЗрдВ: </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">info_all</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(VHostPath, Items)</span></span></span><span class="hljs-function"> -&gt;</span></span> map(VHostPath, <span class="hljs-keyword"><span class="hljs-keyword">fun</span></span> (Q) -&gt; info(Q, Items) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>). info_all(VHostPath, Items) -&gt; map(VHostPath, info(_, Items)).</code> </pre> <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">backing_queue_timeout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(State = #q{ backing_queue = BQ })</span></span></span><span class="hljs-function"> -&gt;</span></span> run_backing_queue( BQ, <span class="hljs-keyword"><span class="hljs-keyword">fun</span></span> (M, BQS) -&gt; M:timeout(BQS) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, State). backing_queue_timeout(State = #q{backing_queue = BQ}) -&gt; run_backing_queue(BQ, _:timeout(_), State).</code> </pre> <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reset_msg_expiry_fun</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TTL)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fun</span></span> (MsgProps) -&gt; MsgProps #message_properties { expiry = calculate_msg_expiry(TTL) } <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>. reset_msg_expiry_fun(TTL) -&gt; _ #message_properties { expiry = calculate_msg_expiry(TTL) }.</code> </pre> <br><h3 id="poryadok-vychisleniya-argumentov">  рддрд░реНрдХ рдЧрдгрдирд╛ рдЖрджреЗрд╢ </h3><br><p>  рдЙрд╕ рдХреНрд░рдо рдХреЛ рд╕рдордЭрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рд╕рдореЗрдВ рддрд░реНрдХреЛрдВ рдХреА рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_, _)</span></span></span><span class="hljs-function"> -&gt;</span></span> io:format(<span class="hljs-string"><span class="hljs-string">"in f1~n"</span></span>). test() -&gt; F = f1(io:format(<span class="hljs-string"><span class="hljs-string">"test line 1~n"</span></span>), _), F(io:format(<span class="hljs-string"><span class="hljs-string">"test line 2~n"</span></span>)).</code> </pre> <br><p>  рдЪреВрдВрдХрд┐ рдХрдЯ рдлрд╝рдВрдХреНрд╢рди рд╕реЗ рдкрд╣рд▓реЗ рддрд░реНрдХреЛрдВ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ: </p><br><pre> <code class="plaintext hljs">test line 2 test line 1 in f1</code> </pre> <br><h3 id="abstrakciya-cut-v-razlichnyh-tipah-i-shablonah-koda">  рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдФрд░ рдХреЛрдб рдХреЗ рдкреИрдЯрд░реНрди рдореЗрдВ рдЕрдореВрд░реНрддрддрд╛ рдХрд╛рдЯреЗрдВ </h3><br><ul><li>  tuples <br><pre> <code class="erlang hljs">F = {_, <span class="hljs-number"><span class="hljs-number">3</span></span>}, {a, <span class="hljs-number"><span class="hljs-number">3</span></span>} = F(a).</code> </pre> </li><li>  рд╕реВрдЪрд┐рдпрд╛рдБ <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dbl_cons</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List)</span></span></span><span class="hljs-function"> -&gt;</span></span> [_, _ | List]. test() -&gt; F = dbl_cons([<span class="hljs-number"><span class="hljs-number">33</span></span>]), [<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">33</span></span>] = F(<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>).</code> </pre> </li><li>  рдЕрднрд┐рд▓реЗрдЦ <br><pre> <code class="erlang hljs"><span class="hljs-keyword"><span class="hljs-keyword">-record</span></span><span class="hljs-params"><span class="hljs-params">(vector, { x, y, z })</span></span>. test() -&gt; GetZ = _#vector.z, <span class="hljs-number"><span class="hljs-number">7</span></span> = GetZ(#vector { z = <span class="hljs-number"><span class="hljs-number">7</span></span> }), SetX = _#vector{x = _}, V = #vector{ x = <span class="hljs-number"><span class="hljs-number">5</span></span>, y = <span class="hljs-number"><span class="hljs-number">4</span></span> } = SetX(#vector{ y = <span class="hljs-number"><span class="hljs-number">4</span></span> }, <span class="hljs-number"><span class="hljs-number">5</span></span>).</code> </pre> </li><li>  рдорд╛рдорд▓реЗ <br><pre> <code class="erlang hljs">F = <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> N <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> is_integer(N) -&gt; N + N; N -&gt; N <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span> = F(<span class="hljs-number"><span class="hljs-number">5</span></span>), ok = F(ok).</code> </pre> </li><li>  рдореИрдкреНрд╕ <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> GetZ = maps:get(z, _), <span class="hljs-number"><span class="hljs-number">7</span></span> = GetZ(#{ z =&gt; <span class="hljs-number"><span class="hljs-number">7</span></span> }), SetX = _#{x =&gt; _}, V = #{ x := <span class="hljs-number"><span class="hljs-number">5</span></span>, y := <span class="hljs-number"><span class="hljs-number">4</span></span> } = SetX(#{ y =&gt; <span class="hljs-number"><span class="hljs-number">4</span></span> }, <span class="hljs-number"><span class="hljs-number">5</span></span>).</code> </pre> </li><li>  рдорд┐рд▓рд╛рди рд╕реВрдЪреА рдФрд░ рдмрд╛рдЗрдирд░реА рдбреЗрдЯрд╛ рдХрд╛ рдирд┐рд░реНрдорд╛рдг <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test_cut_comprehensions</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> F = &lt;&lt; &lt;&lt;(<span class="hljs-number"><span class="hljs-number">1</span></span> + (X*<span class="hljs-number"><span class="hljs-number">2</span></span>))&gt;&gt; || _ &lt;- _, X &lt;- _ &gt;&gt;, <span class="hljs-comment"><span class="hljs-comment">%% Note, this'll only be a /2 ! &lt;&lt;"AAA"&gt;&gt; = F([a,b,c], [32]), F1 = [ {X, Y, Z} || X &lt;- _, Y &lt;- _, Z &lt;- _, math:pow(X,2) + math:pow(Y,2) == math:pow(Z,2) ], [{3,4,5}, {4,3,5}, {6,8,10}, {8,6,10}] = lists:usort(F1(lists:seq(1,10), lists:seq(1,10), lists:seq(1,10))).</span></span></code> </pre> </li></ul><br><p>  <strong>рдкреЗрд╢реЗрд╡рд░реЛрдВ</strong> </p><br><ul><li>  рдХреЛрдб рдЫреЛрдЯрд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕реЗ рдмрдирд╛рдП рд░рдЦрдирд╛ рдЖрд╕рд╛рди рд╣реИред </li><li>  рдХреЛрдб рд╕рд░рд▓ рдФрд░ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЧрдпрд╛ рд╣реИред </li><li>  рдорд╕реНрддреА рд╕реЗ рд╢реЛрд░ рдордЪ рдЧрдпрд╛ред </li><li>  Erlang рдореЗрдВ рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП, Get / Set рдлрд╝рдВрдХреНрд╢рди рд▓рд┐рдЦрдирд╛ рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред </li></ul><br><p>  <strong>рд╡рд┐рдкрдХреНрд╖</strong> </p><br><ul><li>  рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╡реЗрд╢ рд╕реАрдорд╛ рдХреЛ рдХрдо рдХрд░рддреЗ рд╣реБрдП, рдЕрдиреБрднрд╡реА рдПрд░реНрд▓рд╛рдВрдЧ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╡реЗрд╢ рд╕реАрдорд╛ рдмрдврд╝рд╛ рджреА рдЧрдИ рд╣реИред  рдЕрдм рдЯреАрдо рдХреЛ рдХрдЯреМрддреА рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рдПрдХ рдФрд░ рд╡рд╛рдХреНрдп рд░рдЪрдирд╛ рдХреЛ рдЬрд╛рдирдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </li></ul><br><h2 id="do-notaciya">  рд╕рдВрдХреЗрддрди </h2><br><p>  рд╢реАрддрд▓ рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдо рдПрдХ рд╕рдВрдЧрдгрдирд╛ рдмрдВрдзрди рд╣реИред  Erlang рдореЗрдВ рдЖрд▓рд╕реА рдЧрдгрдирд╛ рдореЙрдбрд▓ рдирд╣реАрдВ рд╣реИред  рдЖрдЗрдП рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдХрд┐ рдпрджрд┐ рдПрд░реНрд▓реИрдВрдЧ рд╣рд╛рд╕реНрдХреЗрд▓ рдХреА рддрд░рд╣ рдЖрд▓рд╕реА рдереЗ рддреЛ рдХреНрдпрд╛ рд╣реЛрдЧрд╛ </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">my_function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> A = foo(), B = bar(A, dog), ok.</code> </pre> <br><p>  рдирд┐рд╖реНрдкрд╛рджрди рдЖрджреЗрд╢ рдХреА рдЧрд╛рд░рдВрдЯреА рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдо рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдХреЗ рдЧрдгрдирд╛рдУрдВ рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдЬреЛрдбрд╝рдирд╛ рд╣реЛрдЧрд╛ред </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">my_function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> A = foo(), comma(), B = bar(A, dog), comma(), ok.</code> </pre> <br><p>  рд░реВрдкрд╛рдВрддрд░рдг рдЬрд╛рд░реА рд░рдЦреЗрдВ: </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">my_function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> comma(foo(), <span class="hljs-keyword"><span class="hljs-keyword">fun</span></span> (A) -&gt; comma(bar(A, dog), <span class="hljs-keyword"><span class="hljs-keyword">fun</span></span> (B) -&gt; ok <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>)).</code> </pre> <br><p>  рдирд┐рд╖реНрдХрд░реНрд╖ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдо / 2 рдПрдХ рдореБрд╣рд╛рд╡рд░реЗрджрд╛рд░ рдХрд╛рд░реНрдп рд╣реИ <code>&gt;&gt;=/2</code> ред  рд╕рдиреНрдпрд╛рд╕реА рдХреЛ рдХреЗрд╡рд▓ рддреАрди рдХрд╛рд░реНрдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ: <code>&gt;&gt;=/2</code> , <code>return/1</code> рдФрд░ <code>fail/1</code> ред <br>  рд╕рдмрдХреБрдЫ рдареАрдХ рд╣реЛ рдЬрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рд╕рд┐рд░реНрдл рднрдпрд╛рдирдХ рд╣реИред  рд╣рдо <code>erlando</code> рд╕реЗ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВред </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([Monad || A &lt;- foo(), B &lt;- bar(A, dog), ok])</span></span></span><span class="hljs-function">.</span></span></code> </pre> <br><h2 id="tipy-monad">  рдореЛрдирд╛рдбреНрд╕ рдХреЗ рдкреНрд░рдХрд╛рд░ </h2><br><p>  рдЪреВрдВрдХрд┐ рдбреЛ-рдмреНрд▓реЙрдХ рдХреЛ рдорд╛рдирдХреАрдХреГрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рд╡рд┐рднрд┐рдиреНрди рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдбреЛ-рдмреНрд▓реЙрдХ рдХреЗ рдЕрдВрджрд░, рдХреЙрд▓ <code>return/1</code> рдФрд░ <code>fail/1</code> рдХреЛ <code>Monad:return/1</code> рдФрд░ <code>Monad:fail/1</code> рдХреНрд░рдорд╢рдГ рдкрд░рд┐рдирд┐рдпреЛрдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><ul><li><p>  рдкрд╣рдЪрд╛рди-рдЗрдХрд╛рдИред <br>  рд╕рдорд╛рди рдореЛрдирд╛рдб рд╕рдмрд╕реЗ рд╕рд░рд▓ рдореЛрдирд╛рдб рд╣реИ рдЬреЛ рдореВрд▓реНрдпреЛрдВ рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЛ рдирд╣реАрдВ рдмрджрд▓рддрд╛ рд╣реИ рдФрд░ рдЧрдгрдирд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдирд┐рдпрдВрддреНрд░рдг рдореЗрдВ рднрд╛рдЧ рдирд╣реАрдВ рд▓реЗрддрд╛ рд╣реИред  рдЗрд╕реЗ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдХреЗ рд╕рд╛рде рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд▓рд┐рдВрдХрд┐рдВрдЧ рдПрдХреНрд╕рдкреНрд░реЗрд╢рди рдХрд░рддрд╛ рд╣реИ - рдКрдкрд░ рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рдХреЙрдорд╛ред </p><br></li><li><p>  рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐-рдЗрдХрд╛рдИред <br>  рд▓рд╛рдкрддрд╛ рдореВрд▓реНрдпреЛрдВ рдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде рдЧрдгрдирд╛ рдХрд╛ рдореЛрдирд╛рдбред  рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдПрдХ рдкрд░рд┐рдХрд▓рд┐рдд рдЧрдгрдирд╛ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рдирд╛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдЧрдгрдирд╛ рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд╣реИ, рдПрдХ рдЕрдиреБрдкрд╕реНрдерд┐рдд рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдЧрдИ рдЧрдгрдирд╛ рд╕реЗ рдЬреЛрдбрд╝рдирд╛ рдПрдХ рдЕрдиреБрдкрд╕реНрдерд┐рдд рдкрд░рд┐рдгрд╛рдо рд╣реИред <br>  рд╢рд╛рдпрдж_рдо рдХреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if_safe_div_zero</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(X, Y, Fun)</span></span></span><span class="hljs-function"> -&gt;</span></span> do([maybe_m || Result &lt;- <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Y == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> -&gt; fail(<span class="hljs-string"><span class="hljs-string">"Cannot divide by zero"</span></span>); <span class="hljs-literal"><span class="hljs-literal">false</span></span> -&gt; return(X / Y) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, return(Fun(Result))]).</code> </pre> <br><p>  рдпрджрд┐ рдХреБрдЫ рднреА рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рддреЛ рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рд░реБрдХ рдЬрд╛рддрд╛ рд╣реИред </p><br><pre> <code class="erlang hljs">{just, <span class="hljs-number"><span class="hljs-number">6</span></span>} = if_safe_div_zero(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, _+<span class="hljs-number"><span class="hljs-number">4</span></span>) ## <span class="hljs-number"><span class="hljs-number">10</span></span>/<span class="hljs-number"><span class="hljs-number">5</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">2</span></span>+<span class="hljs-number"><span class="hljs-number">4</span></span> -&gt; <span class="hljs-number"><span class="hljs-number">6</span></span> nothing = if_safe_div_zero(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, _+<span class="hljs-number"><span class="hljs-number">4</span></span>)</code> </pre> <br></li><li><p>  рддреНрд░реБрдЯрд┐-рдЗрдХрд╛рдИред <br>  IF_m рдХреЗ рд╕рдорд╛рди, рдХреЗрд╡рд▓ рддреНрд░реБрдЯрд┐ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд╕рд╛рдеред  рдХрднреА-рдХрднреА рдЗрд╕реЗ рджреБрд░реНрдШрдЯрдирд╛ рд╕рд┐рджреНрдзрд╛рдВрдд рдХреЛ рд▓рд╛рдЧреВ рдирд╣реАрдВ рдХрд░рдиреЗ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рдЙрд╕ рд╕рдордп рд╣реЛрдиреЗ рд╡рд╛рд▓реА рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдХреЗрд╕ рд╕реЗ рд╕реАрдврд╝рд┐рдпрд╛рдВ рдЕрдХреНрд╕рд░ рдХреЛрдб рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗрддреА рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпреЗ: </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Path, Data, Modes)</span></span></span><span class="hljs-function"> -&gt;</span></span> Modes1 = [binary, write | (Modes -- [binary, write])], <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> make_binary(Data) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> Bin <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> is_binary(Bin) -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> file:open(Path, Modes1) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> {ok, Hdl} -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> file:write(Hdl, Bin) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ok -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> file:sync(Hdl) <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ok -&gt; file:close(Hdl); {error, _} = E -&gt; file:close(Hdl), E <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; {error, _} = E -&gt; file:close(Hdl), E <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; {error, _} = E -&gt; E <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; {error, _} = E -&gt; E <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">make_binary</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bin)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">when</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">is_binary</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bin)</span></span></span><span class="hljs-function"> -&gt;</span></span> Bin; make_binary(List) -&gt; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> iolist_to_binary(List) <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> error:Reason -&gt; {error, Reason} <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br></li></ul><br><p>  рдпрд╣ рдкрдврд╝рдирд╛ рдЕрдкреНрд░рд┐рдп рд╣реИ, рдЬреЗрдПрд╕ рдореЗрдВ рдХреЙрд▓рдмреИрдХ рдиреВрдбрд▓реНрд╕ рдЬреИрд╕рд╛ рджрд┐рдЦрддрд╛ рд╣реИред  Error_m рдмрдЪрд╛рд╡ рдХреЗ рд▓рд┐рдП рдЖрддрд╛ рд╣реИ: </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Path, Data, Modes)</span></span></span><span class="hljs-function"> -&gt;</span></span> Modes1 = [binary, write | (Modes -- [binary, write])], do([error_m || Bin &lt;- make_binary(Data), Hdl &lt;- file:open(Path, Modes1), Result &lt;- return(do([error_m || file:write(Hdl, Bin), file:sync(Hdl)])), file:close(Hdl), Result]). make_binary(Bin) <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> is_binary(Bin) -&gt; error_m:return(Bin); make_binary(List) -&gt; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> error_m:return(iolist_to_binary(List)) <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> error:Reason -&gt; error_m:fail(Reason) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br><ul><li>  рд╕реВрдЪреА-рдЗрдХрд╛рдИред <br>  рдорд╛рди рдПрдХ рд╕реВрдЪреА рдХреА рдПрдХ рд╕рдВрднрд╛рд╡рд┐рдд рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреА рдЬрд╛ рд╕рдХрдиреЗ рд╡рд╛рд▓реА рд╕реВрдЪреА рд╣реИред  рдпрджрд┐ рдПрдХ рдЧрдгрдирд╛ рджреВрд╕рд░реЗ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ, рддреЛ рджреВрд╕рд░реА рдЧрдгрдирд╛ рдкрд╣рд▓реЗ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдкрд░рд┐рдгрд╛рдо рдХреЗ рд▓рд┐рдП рдХреА рдЬрд╛рддреА рд╣реИ, рдФрд░ рдкрд░рд┐рдгрд╛рдо (рджреВрд╕рд░реА рдЧрдгрдирд╛) рдХреЛ рдПрдХ рд╕реВрдЪреА рдореЗрдВ рдПрдХрддреНрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br>  рдХреНрд▓рд╛рд╕рд┐рдХ рдкрд╛рдпрдерд╛рдЧреЙрд░рд┐рдпрди рдЯреНрд░рд╛рдЗрдПрд▓реНрд╕ рдХреЗ рд╕рд╛рде рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред  рд╣рдо рдЙрдиреНрд╣реЗрдВ рдмрд┐рдирд╛ рдореЛрдирд╛рдб рдХреЗ рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ: <br><pre> <code class="erlang hljs">P = [{X, Y, Z} || Z &lt;- lists:seq(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>), X &lt;- lists:seq(<span class="hljs-number"><span class="hljs-number">1</span></span>,Z), Y &lt;- lists:seq(X,Z), math:pow(X,<span class="hljs-number"><span class="hljs-number">2</span></span>) + math:pow(Y,<span class="hljs-number"><span class="hljs-number">2</span></span>) == math:pow(Z,<span class="hljs-number"><span class="hljs-number">2</span></span>)].</code> </pre> </li></ul><br><p>  рдХреЗрд╡рд▓ list_m рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рдЪреАрдЬрд╝: </p><br><pre> <code class="erlang hljs">P = do([list_m || Z &lt;- lists:seq(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>), X &lt;- lists:seq(<span class="hljs-number"><span class="hljs-number">1</span></span>,Z), Y &lt;- lists:seq(X,Z), monad_plus:guard(list_m, math:pow(X,<span class="hljs-number"><span class="hljs-number">2</span></span>) + math:pow(Y,<span class="hljs-number"><span class="hljs-number">2</span></span>) == math:pow(Z,<span class="hljs-number"><span class="hljs-number">2</span></span>)), return({X,Y,Z})]).</code> </pre> <br><ul><li>  рд░рд╛рдЬреНрдп рдЗрдХрд╛рдИред <br>  рд╕реНрдЯреЗрдЯрдлреБрд▓ рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рдХрд╛ рдореЛрдирд╛рдбред <br>  рд▓реЗрдЦ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ, рд╣рдордиреЗ рдЪрд░ рд░рд╛рдЬреНрдп рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддреЗ рд╕рдордп рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреА рдХрдард┐рдирд╛рдЗрдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХреАред  рдЕрдХреНрд╕рд░ рдХреЛрдб рдХреБрдЫ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: <br><pre> <code class="erlang hljs">State1 = init(Dimensions), State2 = plant_seeds(SeedCount, State1), {DidFlood, State3} = pour_on_water(WaterVolume, State2), State4 = apply_sunlight(Time, State3), {DidFlood2, State5} = pour_on_water(WaterVolume, State4), {Crop, State6} = harvest(State5), ...</code> </pre> </li></ul><br><p>  рдПрдХ рдЯреНрд░рд╛рдВрд╕рдлрд╛рд░реНрдорд░ рдФрд░ рдХрдЯ-рдиреЛрдЯреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рдЗрд╕ рдХреЛрдб рдХреЛ рдЕрдзрд┐рдХ рдХреЙрдореНрдкреИрдХреНрдЯ рдФрд░ рдкрдардиреАрдп рд░реВрдк рдореЗрдВ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><pre> <code class="erlang hljs">StateT = state_t:new(identity_m), SM = StateT:modify(_), SMR = StateT:modify_and_return(_), StateT:exec( do([StateT || StateT:put(init(Dimensions)), SM(plant_seeds(SeedCount, _)), DidFlood &lt;- SMR(pour_on_water(WaterVolume, _)), SM(apply_sunlight(Time, _)), DidFlood2 &lt;- SMR(pour_on_water(WaterVolume, _)), Crop &lt;- SMR(harvest(_)), ... ]), undefined).</code> </pre> <br><ul><li>  рдУрдореЗрдЧрд╛ рдЗрдХрд╛рдИред <br>  List_m monad рдХреЗ рд╕рдорд╛рдиред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдорд╛рд░реНрдЧ рддрд┐рд░рдЫреЗ рдмрдирд╛ рд╣реИред </li></ul><br><h3 id="skrytaya-obrabotka-oshibok">  рдЫрд┐рдкреА рддреНрд░реБрдЯрд┐ рд╕реЗ рдирд┐рдкрдЯрдиреЗ </h3><br><p>  рд╢рд╛рдпрдж <code>error_m</code> рдХреА рдореЗрд░реА рдкрд╕рдВрджреАрджрд╛ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХред  рдХреЛрдИ рдлрд░реНрдХ рдирд╣реАрдВ рдкрдбрд╝рддрд╛ рдХрд┐ рддреНрд░реБрдЯрд┐ рдХрд╣рд╛рдВ рд╣реЛрддреА рд╣реИ, рдореЛрдирдб рд╣рдореЗрд╢рд╛ <code>{ok, Result}</code> рдпрд╛ <code>{error, Reason}</code> ред  рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рджрд░реНрд╢рд╛рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг: </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">do</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">([error_m || Hdl &lt;- file:open(Path, Modes), Data &lt;- file:read(Hdl, BytesToRead), file:write(Hdl, DataToWrite), file:sync(Hdl), file:close(Hdl), file:rename(Path, Path2), file:delete(Path), return(Data)])</span></span></span><span class="hljs-function">.</span></span></code> </pre> <br><h2 id="import_as">  Import_as </h2><br><p>  рдирд╛рд╢реНрддреЗ рдХреЗ рд▓рд┐рдП рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╕рд┐рдВрдЯреИрдХреНрд╕ import_as рдЪреАрдиреА рд╣реИред  -Import / 2 рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдЖрдкрдХреЛ рд╕реНрдерд╛рдиреАрдп рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рджреВрд╕рд░реЛрдВ рд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣ рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рдЖрдкрдХреЛ рдЖрдпрд╛рддрд┐рдд рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рд╡реИрдХрд▓реНрдкрд┐рдХ рдирд╛рдо рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред  Import_as рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="erlang hljs">-import_as<span class="hljs-params"><span class="hljs-params">({my_mod, [{size/</span><span class="hljs-number"><span class="hljs-params"><span class="hljs-number">1</span></span></span><span class="hljs-params">, m_size}]})</span></span> -import_as<span class="hljs-params"><span class="hljs-params">({my_other_mod, [{size/</span><span class="hljs-number"><span class="hljs-params"><span class="hljs-number">1</span></span></span><span class="hljs-params">, o_size}]})</span></span></code> </pre> <br><p>  рдЗрди рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐рдпреЛрдВ рдХреЛ рдХреНрд░рдорд╢рдГ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдерд╛рдиреАрдп рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><pre> <code class="erlang hljs"><span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m_size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(A)</span></span></span><span class="hljs-function"> -&gt;</span></span> my_mod:size(A). o_size(A) -&gt; my_other_mod:size(A).</code> </pre> <br><h2 id="zaklyuchenie">  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><p>  рдмреЗрд╢рдХ, рдореЛрдирдбреНрд╕ рдЖрдкрдХреЛ рдЕрдзрд┐рдХ рдЕрднрд┐рд╡реНрдпрдВрдЬрдХ рд╡рд┐рдзрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЧрдгрдирд╛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ, рдЗрд╕рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдФрд░ рд╕рдордп рдмрдЪрд╛рддреЗ рд╣реИрдВред  рджреВрд╕рд░реА рдУрд░, рд╡реЗ рдЕрдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдЯреАрдо рдХреЗ рд╕рджрд╕реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрдЯрд┐рд▓рддрд╛ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред </p><br><p>  <strong>*</strong> - рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдПрд░реНрд▓рд╛рдВрдЧ рдореЛрдирд╛рдб рдореЗрдВ рдПрд░рд▓реИрдВрдбреЛ рдХреЗ рдмрд┐рдирд╛ рдореМрдЬреВрдж рд╣реИрдВред  рдПрдХ рдЕрд▓реНрдкрд╡рд┐рд░рд╛рдо рдХреЛ рдЕрд▓рдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рднрд╛рд╡ рд░реЗрдЦрд╛рдВрдХрди рдФрд░ рд╕рдВрдЧрдгрдирд╛ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рд╣реИред </p><br><p>  рдкреБрдирд╢реНрдЪ рд╣рд╛рд▓ рд╣реА рдореЗрдВ, рдПрд░рд▓реИрдВрдбреЛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рд▓реЗрдЦрдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрднрд┐рд▓реЗрдЦреАрдп рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд┐рд╣реНрдирд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рдореИрдВрдиреЗ рдпрд╣ рд▓реЗрдЦ рдПрдХ рд╕рд╛рд▓ рдкрд╣рд▓реЗ рд▓рд┐рдЦрд╛ рдерд╛ред  рдлрд┐рд░, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдм рдХреЗ рд░реВрдк рдореЗрдВ, Habr├й рдкрд░ Erlang рдореЗрдВ рднрд┐рдХреНрд╖реБрдУрдВ рдкрд░ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рдереАред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЛ рджреВрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВ рдпрд╣ рд▓реЗрдЦ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░ рд░рд╣рд╛ рд╣реВрдБ, рднрд▓реЗ рд╣реА рдпрд╣ рд▓реЗрдЦ рдХрд┐рддрдирд╛ рднреА рдЕрдЪреНрдЫрд╛ рдХреНрдпреЛрдВ рди рд╣реЛред <br>  Erlang&gt; = 22 рдореЗрдВ erlando рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рдЕрдкрдЪрд┐рдд erlang: get_stacktrace / 0 рдХреЗ рд╕рд╛рде рд╕рдорд╕реНрдпрд╛ рдХреЛ рдареАрдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдлрд┐рдХреНрд╕ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдореЗрд░реЗ рдХрд╛рдВрдЯреЗ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://github.com/Vonmo/erlando/commit/52e23ecedd2b8c13707a11c7f0f14496b5a19c2c2</a> </p><br><p>  рдЖрдкрдХреЗ рд╕рдордп рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi466697/">https://habr.com/ru/post/hi466697/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi466683/index.html">рдореЙрд╕реНрдХреЛ рдореЗрдВ 9-15 рд╕рд┐рддрдВрдмрд░ рдХреЛ рдбрд┐рдЬрд┐рдЯрд▓ рдХрд╛рд░реНрдпрдХреНрд░рдо</a></li>
<li><a href="../hi466685/index.html">рдкреИрд╕реЗ рджреЗрдЦрдХрд░</a></li>
<li><a href="../hi466689/index.html">рдореЛрдмрд╛рдЗрд▓ MMO рдПрдХреНрд╢рди рдореЗрдВ рдЪрд░рд┐рддреНрд░ рдХрдХреНрд╖рд╛рдПрдВ рдХреИрд╕реЗ рдмрдирд╛рдПрдВ</a></li>
<li><a href="../hi466691/index.html">рддреЛ рд╕рднреА рдПрдХ рд╣реА RAML рдпрд╛ OAS (рд╕реНрд╡реИрдЧрд░)?</a></li>
<li><a href="../hi466693/index.html">рдпрджрд┐ рдЖрдк IT рдореЗрдВ рджрд░реНрдЬ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi466699/index.html">рдЯреИрдорд┐рдВрдЧ рдЯреНрд░рд╕реНрдЯ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ - рдЗрдВрдЯрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╕рд╛рде OAuth рдкреНрд░рдорд╛рдгреАрдХрд░рдг IRIS</a></li>
<li><a href="../hi466701/index.html">рдЖрдЗрдП Encrypt рдбреЛрдореЗрди рдХреЗ рд▓рдЧрднрдЧ 30% рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi466705/index.html">Android рдХреЗ рд▓рд┐рдП Vivaldi рдмреАрдЯрд╛ - рд░рд┐рдпрд▓ рдмреНрд░рд╛рдЙрдЬрд╝рд░</a></li>
<li><a href="../hi466709/index.html">рдПрдХ рдЕрдЦрдВрдб рдпреВрдирд┐рдХреНрд╕ рдЬреИрд╕рд╛ рдУрдПрд╕ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ - рд╕реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА (2)</a></li>
<li><a href="../hi466711/index.html">рднреЗрджреНрдпрддрд╛ DaOffice рдиреЗ рдХрд┐рд╕реА рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕реЛрд╢рд▓ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рд╣рдЯрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреА</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>