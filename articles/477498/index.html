<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§æüèø ü¶Å ü•ö Recopilamos registros de Nginx usando nginx-clickhouse, los enviamos a Clickhouse y los mostramos en Grafana üéΩ üê© üÖæÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Soy de Luxoft Este art√≠culo discutir√° el proyecto nginx-clickhouse , que leer√° los registros nginx y los enviar√° a clickhouse. Para ver las estad√≠stic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Recopilamos registros de Nginx usando nginx-clickhouse, los enviamos a Clickhouse y los mostramos en Grafana</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/477498/"><p>  Soy de Luxoft  Este art√≠culo discutir√° el <a href="https://github.com/mintance/nginx-clickhouse" rel="nofollow">proyecto nginx-clickhouse</a> , que leer√° los registros nginx y los enviar√° a clickhouse.  Para ver las estad√≠sticas de registro, hay un panel de control para Grafana. </p><a name="habracut"></a><br><p>  Instale nginx, clickhouse, grafana de la manera est√°ndar. </p><br><p>  Todos los paquetes est√°n instalados en el mismo servidor. </p><br><p>  <a href="https://github.com/mintance/nginx-clickhouse" rel="nofollow">P√°gina de Nginx-clickhouse en github</a> </p><br><p>  Instale el paquete rpm nginx-clickhouse </p><br><pre><code class="bash hljs">yum -y install yum-plugin-copr yum copr <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> antonpatsev/nginx-clickhouse-rpm yum -y install nginx-clickhouse systemctl start nginx-clickhouse</code> </pre> <br><p>  Como emulador del servicio HTTP usamos mockify. </p><br><p>  Instale el paquete rpm mockify </p><br><pre> <code class="bash hljs">yum -y install yum-plugin-copr yum copr <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> antonpatsev/mockify-rpm yum -y install mockify systemctl start mockify</code> </pre> <br><p>  Para nginx-clickhouse, log_format tiene el siguiente formulario. </p><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">log_format</span></span> main <span class="hljs-string"><span class="hljs-string">'</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$remote_addr</span></span></span><span class="hljs-string"> - </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$remote_user</span></span></span><span class="hljs-string"> [</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time_local</span></span></span><span class="hljs-string">] "</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$request</span></span></span><span class="hljs-string">" </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$status</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$bytes_sent</span></span></span><span class="hljs-string"> "</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_referer</span></span></span><span class="hljs-string">" "</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_user_agent</span></span></span><span class="hljs-string">"'</span></span>;</code> </pre> <br><p>  Configuraci√≥n general de nginx: </p><br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">user</span></span> nginx; <span class="hljs-attribute"><span class="hljs-attribute">worker_processes</span></span> auto; <span class="hljs-attribute"><span class="hljs-attribute">worker_rlimit_nofile</span></span> <span class="hljs-number"><span class="hljs-number">40960</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">error_log</span></span> /var/log/nginx/error.log <span class="hljs-literal"><span class="hljs-literal">warn</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">pid</span></span> /var/run/nginx.pid; <span class="hljs-section"><span class="hljs-section">events</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">use</span></span> <span class="hljs-literal"><span class="hljs-literal">epoll</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">worker_connections</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">multi_accept</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span>; } <span class="hljs-section"><span class="hljs-section">http</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">include</span></span> /etc/nginx/mime.types; <span class="hljs-attribute"><span class="hljs-attribute">default_type</span></span> application/octet-stream; <span class="hljs-attribute"><span class="hljs-attribute">log_format</span></span> main <span class="hljs-string"><span class="hljs-string">'</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$remote_addr</span></span></span><span class="hljs-string"> - </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$remote_user</span></span></span><span class="hljs-string"> [</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$time_local</span></span></span><span class="hljs-string">] "</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$request</span></span></span><span class="hljs-string">" </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$status</span></span></span><span class="hljs-string"> </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$bytes_sent</span></span></span><span class="hljs-string"> "</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_referer</span></span></span><span class="hljs-string">" "</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_user_agent</span></span></span><span class="hljs-string">"'</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">access_log</span></span> /var/log/nginx/access.log main; <span class="hljs-attribute"><span class="hljs-attribute">sendfile</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">tcp_nodelay</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">tcp_nopush</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">keepalive_timeout</span></span> <span class="hljs-number"><span class="hljs-number">65</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">include</span></span> /etc/nginx/conf.d/<span class="hljs-regexp"><span class="hljs-regexp">*.conf</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">open_file_cache</span></span> max=<span class="hljs-number"><span class="hljs-number">200000</span></span> inactive=<span class="hljs-number"><span class="hljs-number">20s</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">open_file_cache_valid</span></span> <span class="hljs-number"><span class="hljs-number">30s</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">open_file_cache_min_uses</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">open_file_cache_errors</span></span> <span class="hljs-literal"><span class="hljs-literal">on</span></span>; }</code> </pre> <br><p>  Configuraciones de host virtual: </p><br><p>  vhost1.conf: </p><br><pre> <code class="plaintext hljs">server { listen 80; server_name vhost1; location / { proxy_pass http://127.0.0.1:8001/200; } }</code> </pre> <br><p>  vhost2.conf: </p><br><pre> <code class="plaintext hljs">server { listen 80; server_name vhost2; location / { proxy_pass http://127.0.0.1:8001/200; } }</code> </pre> <br><p>  vhost3.conf: </p><br><pre> <code class="plaintext hljs">server { listen 80; server_name vhost3; location / { proxy_pass http://localhost:8001/304; } }</code> </pre> <br><p>  vhost4.conf: </p><br><pre> <code class="plaintext hljs">server { listen 80; server_name vhost4; location / { proxy_pass http://localhost:8001/401; } }</code> </pre> <br><p>  vhost5.conf: </p><br><pre> <code class="plaintext hljs">server { listen 80; server_name vhost5; location / { proxy_pass http://localhost:8001/500; } }</code> </pre> <br><p>  Agregue hosts virtuales al archivo de hosts: </p><br><pre> <code class="bash hljs">cat /etc/hosts 127.0.0.1 vhost1 127.0.0.1 vhost2 127.0.0.1 vhost3 127.0.0.1 vhost4 127.0.0.1 vhost5</code> </pre> <br><p>  La configuraci√≥n de nginx-clickhouse por defecto es </p><br><pre> <code class="plaintext hljs">/etc/nginx-clickhouse/config/config.yml</code> </pre> <br><p>  La ruta al registro se puede cambiar en la configuraci√≥n en el par√°metro: <code>log_path:</code> </p><br><p>  En clickhouse necesita crear una base de datos de m√©tricas: </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> metrics</code> </pre> <br><p>  Y necesitas crear una tabla nginx: </p><br><pre> <code class="plaintext hljs">CREATE TABLE metrics.nginx ( RemoteAddr String, RemoteUser String, TimeLocal DateTime, Date Date DEFAULT toDate(TimeLocal), Request String, RequestMethod String, Status Int32, BytesSent Int64, HttpReferer String, HttpUserAgent String, RequestTime Float32, UpstreamConnectTime Float32, UpstreamHeaderTime Float32, UpstreamResponseTime Float32, Https FixedString(2), ConnectionsWaiting Int64, ConnectionsActive Int64 ) ENGINE = MergeTree(Date, (Status, Date), 8192)</code> </pre> <br><p>  En Grafana, al crear un origen de datos para Clickhouse, as√≠gnele el nombre <code>ClickHouse Main Server</code> , porque  en el tablero original de Grafana, as√≠ se llama. </p><br><p>  Tambi√©n debe crear una variable de tabla con el contenido de <code>metrics.nginx</code> . <br><img src="https://habrastorage.org/getpro/habr/post_images/418/708/ec3/418708ec3125ab0c910ec1ed2ced1d1e.png" alt="imagen"></p><br><p>  En el sitio web oficial de Grafana no encontrar√° un tablero de instrumentos.  Es en este <a href="https://github.com/mintance/nginx-clickhouse/issues/2" rel="nofollow">tema</a> cerrado: </p><br><p>  Aqu√≠ est√° mi tablero ligeramente corregido: </p><br><div class="spoiler">  <b class="spoiler_title">Encabezado de spoiler</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"editable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gnetId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"graphTooltip"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hideControls"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"refresh"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rows"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"collapse"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"height"</span></span>: <span class="hljs-string"><span class="hljs-string">"250px"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"panels"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"aliasColors"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"bars"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dashLength"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dashes"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fill"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"legend"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"avg"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"current"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"total"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"values"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"lines"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"linewidth"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"nullPointMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"percentage"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pointradius"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"points"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"renderer"</span></span>: <span class="hljs-string"><span class="hljs-string">"flot"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"seriesOverrides"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"spaceLength"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-attr"><span class="hljs-attr">"stack"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"steppedLine"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkcyan\"&gt;$columns&lt;/font&gt;(Status, &lt;font color=\"navajowhite\"&gt;count&lt;/font&gt;(&lt;font color=\"yellow\"&gt;*&lt;/font&gt;) &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; c) &lt;font color=\"darkorange\"&gt;from&lt;/font&gt; metrics&lt;font color=\"yellow\"&gt;.&lt;/font&gt;nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hide"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interval"</span></span>: <span class="hljs-string"><span class="hljs-string">"15s"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"$columns(Status, count(*) as c) from metrics.nginx"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT t, groupArray((Status, c)) as groupArr FROM ( SELECT (intDiv(toUInt32(TimeLocal), 15) * 15) * 1000 as t, Status, count(*) as c from metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t, Status ORDER BY t) GROUP BY t ORDER BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"timeFrom"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timeShift"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Streaming API Requests &amp; Response"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tooltip"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"shared"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sort"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"individual"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"graph"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"xaxis"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"buckets"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"values"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"yaxes"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"decimals"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"short"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"label"</span></span>: <span class="hljs-string"><span class="hljs-string">"Requests"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logBase"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"short"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"label"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logBase"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } ] } ], <span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"repeatIteration"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"repeatRowId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"showTitle"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Dashboard Row"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"titleSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"h6"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"collapse"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">399</span></span>, <span class="hljs-attr"><span class="hljs-attr">"panels"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"columns"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"100%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"pageSize"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"scroll"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"showHeader"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sort"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"col"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"desc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"styles"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"Time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"YYYY-MM-DD HH:mm:ss"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pattern"</span></span>: <span class="hljs-string"><span class="hljs-string">"Time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"date"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorMode"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"decimals"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pattern"</span></span>: <span class="hljs-string"><span class="hljs-string">"/.*/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"number"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"unit"</span></span>: <span class="hljs-string"><span class="hljs-string">"short"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkcyan\"&gt;$columns&lt;/font&gt;(Status, &lt;font color=\"navajowhite\"&gt;count&lt;/font&gt;(&lt;font color=\"yellow\"&gt;*&lt;/font&gt;) &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; c) &lt;font color=\"darkorange\"&gt;from&lt;/font&gt; metrics&lt;font color=\"yellow\"&gt;.&lt;/font&gt;nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hide"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interval"</span></span>: <span class="hljs-string"><span class="hljs-string">"3600s"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"$columns(Status, count(*) as c) from metrics.nginx"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT t, groupArray((Status, c)) as groupArr FROM ( SELECT (intDiv(toUInt32(TimeLocal), 3600) * 3600) * 1000 as t, Status, count(*) as c from metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t, Status ORDER BY t) GROUP BY t ORDER BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Requests Stats Table"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"transform"</span></span>: <span class="hljs-string"><span class="hljs-string">"timeseries_to_columns"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"table"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"aliasColors"</span></span>: {}, <span class="hljs-attr"><span class="hljs-attr">"bars"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dashLength"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dashes"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fill"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">"legend"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"avg"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"current"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"total"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"values"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"lines"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"linewidth"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"nullPointMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"percentage"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pointradius"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"points"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"renderer"</span></span>: <span class="hljs-string"><span class="hljs-string">"flot"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"seriesOverrides"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"spaceLength"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"stack"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"steppedLine"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkcyan\"&gt;$rate&lt;/font&gt;(&lt;font color=\"navajowhite\"&gt;avg&lt;/font&gt;(RequestTime) &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; RequestTime) &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; metrics&lt;font color=\"yellow\"&gt;.&lt;/font&gt;nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hide"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"$rate(avg(RequestTime) as RequestTime) FROM metrics.nginx"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT t, RequestTime/runningDifference(t/1000) RequestTimeRate FROM ( SELECT (intDiv(toUInt32(TimeLocal), 120) * 120) * 1000 as t, avg(RequestTime) as RequestTime FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t ORDER BY t)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkcyan\"&gt;$rate&lt;/font&gt;(&lt;font color=\"navajowhite\"&gt;avg&lt;/font&gt;(UpstreamResponseTime) &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; UpstreamResponseTime) &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; metrics&lt;font color=\"yellow\"&gt;.&lt;/font&gt;nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hide"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"$rate(avg(UpstreamResponseTime) as UpstreamResponseTime) FROM metrics.nginx"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT t, UpstreamResponseTime/runningDifference(t/1000) UpstreamResponseTimeRate FROM ( SELECT (intDiv(toUInt32(TimeLocal), 120) * 120) * 1000 as t, avg(UpstreamResponseTime) as UpstreamResponseTime FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t ORDER BY t)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"B"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkcyan\"&gt;$rate&lt;/font&gt;(&lt;font color=\"navajowhite\"&gt;avg&lt;/font&gt;(UpstreamConnectTime) &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; UpstreamConnectTime) &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; metrics&lt;font color=\"yellow\"&gt;.&lt;/font&gt;nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hide"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"$rate(avg(UpstreamConnectTime) as UpstreamConnectTime) FROM metrics.nginx"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT t, UpstreamConnectTime/runningDifference(t/1000) UpstreamConnectTimeRate FROM ( SELECT (intDiv(toUInt32(TimeLocal), 120) * 120) * 1000 as t, avg(UpstreamConnectTime) as UpstreamConnectTime FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t ORDER BY t)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"C"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"timeFrom"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"timeShift"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Response Timing"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tooltip"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"shared"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sort"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value_type"</span></span>: <span class="hljs-string"><span class="hljs-string">"individual"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"graph"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"xaxis"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"buckets"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mode"</span></span>: <span class="hljs-string"><span class="hljs-string">"time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"values"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"yaxes"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"short"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"label"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logBase"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"short"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"label"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logBase"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"max"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"min"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } ] } ], <span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"repeatIteration"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"repeatRowId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"showTitle"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Dashboard Row"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"titleSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"h6"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"collapse"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"height"</span></span>: <span class="hljs-number"><span class="hljs-number">250</span></span>, <span class="hljs-attr"><span class="hljs-attr">"panels"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"cacheTimeout"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorBackground"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"none"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gauge"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"maxValue"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"minValue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdLabels"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdMarkers"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interval"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"mappingType"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mappingTypes"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"value to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"range to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"maxDataPoints"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullPointMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"connected"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rangeMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sparkline"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"fillColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgba(31, 118, 189, 0.18)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lineColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgb(31, 120, 193)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"tableColumn"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkorange\"&gt;SELECT&lt;/font&gt;&lt;br /&gt; &lt;font color=\"cornflowerblue\"&gt;1&lt;/font&gt; &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; t,&lt;br /&gt; &lt;font color=\"navajowhite\"&gt;count&lt;/font&gt;(&lt;font color=\"yellow\"&gt;*&lt;/font&gt;) &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; c&lt;br /&gt; &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$table&lt;/font&gt;&lt;br /&gt; &lt;font color=\"darkorange\"&gt;WHERE&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$timeFilter&lt;/font&gt; &lt;font color=\"darkorange\"&gt;GROUP BY&lt;/font&gt; t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT\n 1 as t,\n count(*) as c\n FROM $table\n WHERE $timeFilter GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT 1 as t, count(*) as c FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Total Requests"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"singlestat"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"80%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"op"</span></span>: <span class="hljs-string"><span class="hljs-string">"="</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"valueName"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"cacheTimeout"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorBackground"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"ops"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gauge"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"maxValue"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"minValue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdLabels"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdMarkers"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interval"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"mappingType"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mappingTypes"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"value to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"range to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"maxDataPoints"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullPointMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"connected"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rangeMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sparkline"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"fillColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgba(31, 118, 189, 0.18)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lineColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgb(31, 120, 193)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"tableColumn"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkorange\"&gt;SELECT&lt;/font&gt;&lt;br /&gt; &lt;font color=\"cornflowerblue\"&gt;1&lt;/font&gt; &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; t,&lt;br /&gt; &lt;font color=\"navajowhite\"&gt;count&lt;/font&gt;(&lt;font color=\"yellow\"&gt;*&lt;/font&gt;) &lt;font color=\"yellow\"&gt;/&lt;/font&gt; &lt;font color=\"cornflowerblue\"&gt;3600&lt;/font&gt;&lt;font color=\"yellow\"&gt;*&lt;/font&gt;&lt;font color=\"cornflowerblue\"&gt;24&lt;/font&gt; &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; c&lt;br /&gt; &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$table&lt;/font&gt;&lt;br /&gt; &lt;font color=\"darkorange\"&gt;WHERE&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$timeFilter&lt;/font&gt; &lt;font color=\"darkorange\"&gt;GROUP BY&lt;/font&gt; t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT\n 1 as t,\n count(*) / 3600*24 as c\n FROM $table\n WHERE $timeFilter GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT 1 as t, count(*) / 3600*24 as c FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"RPS"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"singlestat"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"80%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"op"</span></span>: <span class="hljs-string"><span class="hljs-string">"="</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"valueName"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"cacheTimeout"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorBackground"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"none"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gauge"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"maxValue"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"minValue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdLabels"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdMarkers"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interval"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"mappingType"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mappingTypes"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"value to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"range to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"maxDataPoints"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullPointMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"connected"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rangeMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sparkline"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"fillColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgba(31, 118, 189, 0.18)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lineColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgb(31, 120, 193)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"tableColumn"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkorange\"&gt;SELECT&lt;/font&gt;&lt;br /&gt; &lt;font color=\"cornflowerblue\"&gt;1&lt;/font&gt; &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; t,&lt;br /&gt; &lt;font color=\"navajowhite\"&gt;count&lt;/font&gt;(&lt;font color=\"yellow\"&gt;*&lt;/font&gt;) &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; c&lt;br /&gt; &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$table&lt;/font&gt;&lt;br /&gt; &lt;font color=\"darkorange\"&gt;WHERE&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$timeFilter&lt;/font&gt; &lt;font color=\"yellow\"&gt;AND&lt;/font&gt; Status &lt;font color=\"darkorange\"&gt;NOT&lt;/font&gt; &lt;font color=\"darkorange\"&gt;IN&lt;/font&gt; (&lt;font color=\"cornflowerblue\"&gt;200&lt;/font&gt;, &lt;font color=\"cornflowerblue\"&gt;201&lt;/font&gt;, &lt;font color=\"cornflowerblue\"&gt;401&lt;/font&gt;) &lt;font color=\"darkorange\"&gt;GROUP BY&lt;/font&gt; t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT\n 1 as t,\n count(*) as c\n FROM $table\n WHERE $timeFilter AND Status NOT IN (200, 201, 401) GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT 1 as t, count(*) as c FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) AND Status NOT IN (200, 201, 401) GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: <span class="hljs-string"><span class="hljs-string">"10,20,50"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Failed Requests"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"singlestat"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"80%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"op"</span></span>: <span class="hljs-string"><span class="hljs-string">"="</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"valueName"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"cacheTimeout"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorBackground"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"decimals"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"none"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gauge"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"maxValue"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"minValue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdLabels"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdMarkers"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interval"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"mappingType"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mappingTypes"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"value to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"range to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"maxDataPoints"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullPointMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"connected"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfix"</span></span>: <span class="hljs-string"><span class="hljs-string">"%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"80%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rangeMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sparkline"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"fillColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgba(31, 118, 189, 0.18)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lineColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgb(31, 120, 193)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"tableColumn"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkorange\"&gt;SELECT&lt;/font&gt;&lt;br /&gt; &lt;font color=\"cornflowerblue\"&gt;1&lt;/font&gt; &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; t, (&lt;font color=\"navajowhite\"&gt;sum&lt;/font&gt;(Status &lt;font color=\"yellow\"&gt;=&lt;/font&gt; &lt;font color=\"cornflowerblue\"&gt;500&lt;/font&gt; &lt;font color=\"yellow\"&gt;or&lt;/font&gt; Status &lt;font color=\"yellow\"&gt;=&lt;/font&gt; &lt;font color=\"cornflowerblue\"&gt;499&lt;/font&gt;)&lt;font color=\"yellow\"&gt;/&lt;/font&gt;&lt;font color=\"navajowhite\"&gt;sum&lt;/font&gt;(Status &lt;font color=\"yellow\"&gt;=&lt;/font&gt; &lt;font color=\"cornflowerblue\"&gt;200&lt;/font&gt; &lt;font color=\"yellow\"&gt;or&lt;/font&gt; Status &lt;font color=\"yellow\"&gt;=&lt;/font&gt; &lt;font color=\"cornflowerblue\"&gt;201&lt;/font&gt; &lt;font color=\"yellow\"&gt;or&lt;/font&gt; Status &lt;font color=\"yellow\"&gt;=&lt;/font&gt; &lt;font color=\"cornflowerblue\"&gt;401&lt;/font&gt;))&lt;font color=\"yellow\"&gt;*&lt;/font&gt;&lt;font color=\"cornflowerblue\"&gt;100&lt;/font&gt; &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$table&lt;/font&gt;&lt;br /&gt; &lt;font color=\"darkorange\"&gt;WHERE&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$timeFilter&lt;/font&gt; &lt;font color=\"darkorange\"&gt;GROUP BY&lt;/font&gt; t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT\n 1 as t, (sum(Status = 500 or Status = 499)/sum(Status = 200 or Status = 201 or Status = 401))*100 FROM $table\n WHERE $timeFilter GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT 1 as t, (sum(Status = 500 or Status = 499)/sum(Status = 200 or Status = 201 or Status = 401))*100 FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: <span class="hljs-string"><span class="hljs-string">"1,5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Failing Prcent"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"singlestat"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"80%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"op"</span></span>: <span class="hljs-string"><span class="hljs-string">"="</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"valueName"</span></span>: <span class="hljs-string"><span class="hljs-string">"current"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"cacheTimeout"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorBackground"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"s"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gauge"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"maxValue"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"minValue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdLabels"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdMarkers"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interval"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"mappingType"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mappingTypes"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"value to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"range to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"maxDataPoints"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullPointMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"connected"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rangeMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sparkline"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"fillColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgba(31, 118, 189, 0.18)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lineColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgb(31, 120, 193)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"tableColumn"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkorange\"&gt;SELECT&lt;/font&gt;&lt;br /&gt; &lt;font color=\"cornflowerblue\"&gt;1&lt;/font&gt;, &lt;font color=\"navajowhite\"&gt;avg&lt;/font&gt;(RequestTime) &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$table&lt;/font&gt;&lt;br /&gt; &lt;font color=\"darkorange\"&gt;WHERE&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$timeFilter&lt;/font&gt; &lt;font color=\"darkorange\"&gt;GROUP BY&lt;/font&gt; &lt;font color=\"cornflowerblue\"&gt;1&lt;/font&gt;"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT\n 1, avg(RequestTime) FROM $table\n WHERE $timeFilter GROUP BY 1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT 1, avg(RequestTime) FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY 1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.02,0.05,0.1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Avg Response Time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"singlestat"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"80%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"op"</span></span>: <span class="hljs-string"><span class="hljs-string">"="</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"valueName"</span></span>: <span class="hljs-string"><span class="hljs-string">"avg"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"cacheTimeout"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorBackground"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorValue"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"decimals"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"format"</span></span>: <span class="hljs-string"><span class="hljs-string">"s"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"gauge"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"maxValue"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"minValue"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdLabels"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholdMarkers"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-attr"><span class="hljs-attr">"interval"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"mappingType"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"mappingTypes"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"value to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"range to text"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"maxDataPoints"</span></span>: <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullPointMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"connected"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nullText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"postfixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"70%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefix"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"prefixFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"50%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rangeMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sparkline"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"fillColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgba(31, 118, 189, 0.18)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"full"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lineColor"</span></span>: <span class="hljs-string"><span class="hljs-string">"rgb(31, 120, 193)"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"show"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"tableColumn"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"&lt;font color=\"darkorange\"&gt;SELECT&lt;/font&gt;&lt;br /&gt; &lt;font color=\"cornflowerblue\"&gt;1&lt;/font&gt; &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; t, &lt;font color=\"navajowhite\"&gt;max&lt;/font&gt;(RequestTime) &lt;font color=\"darkorange\"&gt;as&lt;/font&gt; c&lt;br /&gt; &lt;font color=\"darkorange\"&gt;FROM&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$table&lt;/font&gt;&lt;br /&gt; &lt;font color=\"darkorange\"&gt;WHERE&lt;/font&gt; &lt;font color=\"darkcyan\"&gt;$timeFilter&lt;/font&gt; &lt;font color=\"darkorange\"&gt;GROUP BY&lt;/font&gt; t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT\n 1 as t, max(RequestTime) as c\n FROM $table\n WHERE $timeFilter GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT 1 as t, max(RequestTime) as c FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) GROUP BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: <span class="hljs-string"><span class="hljs-string">"0.2,0.5,1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Max Response Time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"singlestat"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueFontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"80%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"valueMaps"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"op"</span></span>: <span class="hljs-string"><span class="hljs-string">"="</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">"N/A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-string"><span class="hljs-string">"null"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"valueName"</span></span>: <span class="hljs-string"><span class="hljs-string">"current"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"repeatIteration"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"repeatRowId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"showTitle"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Dashboard Row"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"titleSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"h6"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"collapse"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"height"</span></span>: <span class="hljs-string"><span class="hljs-string">"450"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"panels"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"columns"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"datasource"</span></span>: <span class="hljs-string"><span class="hljs-string">"ClickHouse Main Server"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fontSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"100%"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-attr"><span class="hljs-attr">"links"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"pageSize"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"scroll"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"showHeader"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"sort"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"col"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"desc"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"span"</span></span>: <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-attr"><span class="hljs-attr">"styles"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"Time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"HH:mm:ss"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pattern"</span></span>: <span class="hljs-string"><span class="hljs-string">"Time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"date"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorMode"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"dateFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"YYYY-MM-DD HH:mm:ss"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"decimals"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pattern"</span></span>: <span class="hljs-string"><span class="hljs-string">"Status"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"number"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"unit"</span></span>: <span class="hljs-string"><span class="hljs-string">"none"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"Response Time"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorMode"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"dateFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"YYYY-MM-DD HH:mm:ss"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"decimals"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pattern"</span></span>: <span class="hljs-string"><span class="hljs-string">"RequestTime"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"50"</span></span>, <span class="hljs-string"><span class="hljs-string">"70"</span></span>, <span class="hljs-string"><span class="hljs-string">"100"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"number"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"unit"</span></span>: <span class="hljs-string"><span class="hljs-string">"dtdurations"</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colorMode"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"colors"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"rgba(245, 54, 54, 0.9)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(237, 129, 40, 0.89)"</span></span>, <span class="hljs-string"><span class="hljs-string">"rgba(50, 172, 45, 0.97)"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"decimals"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pattern"</span></span>: <span class="hljs-string"><span class="hljs-string">"/.*/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"thresholds"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"number"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"unit"</span></span>: <span class="hljs-string"><span class="hljs-string">"short"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"database"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"Date"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"dateTimeColDataType"</span></span>: <span class="hljs-string"><span class="hljs-string">"TimeLocal"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"datetimeLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"formattedQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT TimeLocal as t, Status, RequestMethod, splitByChar(' ', Request)[2] as Request, RequestTime FROM $table WHERE $timeFilter AND Status NOT IN (200, 201) AND RequestMethod != 'OPTIONS' ORDER BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"intervalFactor"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"query"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT TimeLocal as t, Status, RequestMethod, splitByChar(' ', Request)[2] as Request, RequestTime FROM $table WHERE $timeFilter AND Status NOT IN (200, 201) AND RequestMethod != 'OPTIONS' ORDER BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"rawQuery"</span></span>: <span class="hljs-string"><span class="hljs-string">"SELECT TimeLocal as t, Status, RequestMethod, splitByChar(' ', Request)[2] as Request, RequestTime FROM metrics.nginx WHERE Date &gt;= toDate(1539358595) AND TimeLocal &gt;= toDateTime(1539358595) AND Status NOT IN (200, 201) AND RequestMethod != 'OPTIONS' ORDER BY t"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"refId"</span></span>: <span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"resultFormat"</span></span>: <span class="hljs-string"><span class="hljs-string">"time_series"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"table"</span></span>: <span class="hljs-string"><span class="hljs-string">"nginx_streaming"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tableLoading"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Error Requests"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"transform"</span></span>: <span class="hljs-string"><span class="hljs-string">"timeseries_to_columns"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"table"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"repeat"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"repeatIteration"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"repeatRowId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"showTitle"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Dashboard Row"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"titleSize"</span></span>: <span class="hljs-string"><span class="hljs-string">"h6"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"schemaVersion"</span></span>: <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-attr"><span class="hljs-attr">"style"</span></span>: <span class="hljs-string"><span class="hljs-string">"dark"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tags"</span></span>: [], <span class="hljs-attr"><span class="hljs-attr">"templating"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"list"</span></span>: [] }, <span class="hljs-attr"><span class="hljs-attr">"time"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"from"</span></span>: <span class="hljs-string"><span class="hljs-string">"now-24h"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"now"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"timepicker"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"refresh_intervals"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"5s"</span></span>, <span class="hljs-string"><span class="hljs-string">"10s"</span></span>, <span class="hljs-string"><span class="hljs-string">"30s"</span></span>, <span class="hljs-string"><span class="hljs-string">"1m"</span></span>, <span class="hljs-string"><span class="hljs-string">"5m"</span></span>, <span class="hljs-string"><span class="hljs-string">"15m"</span></span>, <span class="hljs-string"><span class="hljs-string">"30m"</span></span>, <span class="hljs-string"><span class="hljs-string">"1h"</span></span>, <span class="hljs-string"><span class="hljs-string">"2h"</span></span>, <span class="hljs-string"><span class="hljs-string">"1d"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"time_options"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"5m"</span></span>, <span class="hljs-string"><span class="hljs-string">"15m"</span></span>, <span class="hljs-string"><span class="hljs-string">"1h"</span></span>, <span class="hljs-string"><span class="hljs-string">"6h"</span></span>, <span class="hljs-string"><span class="hljs-string">"12h"</span></span>, <span class="hljs-string"><span class="hljs-string">"24h"</span></span>, <span class="hljs-string"><span class="hljs-string">"2d"</span></span>, <span class="hljs-string"><span class="hljs-string">"7d"</span></span>, <span class="hljs-string"><span class="hljs-string">"30d"</span></span> ] }, <span class="hljs-attr"><span class="hljs-attr">"timezone"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"Streaming API"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-number"><span class="hljs-number">17</span></span> }</code> </pre> </div></div><br><p>  Pruebas realizadas con el benchmark Apache. </p><br><p>  Instalarlo: </p><br><pre> <code class="bash hljs">yum install -y httpd-tools</code> </pre> <br><p>  Comenzamos a probar usando el benchmark Apache en diferentes consolas: </p><br><pre> <code class="plaintext hljs">while true; do ab -c 1 -n 1 -t 1 http://vhost1/; sleep 2; done while true; do ab -c 1 -n 1 -t 1 http://vhost2/; sleep 2; done while true; do ab -c 1 -n 1 -t 1 http://vhost3/; sleep 2; done while true; do ab -c 1 -n 1 -t 1 http://vhost4/; sleep 2; done while true; do ab -c 1 -n 1 -t 1 http://vhost5/; sleep 2; done</code> </pre> <br><p>  Capturas de pantalla </p><br><p><img src="https://habrastorage.org/webt/3m/l7/bv/3ml7bvqt_5yyi8ozwczvn6rjbro.png"></p><br><p><img src="https://habrastorage.org/webt/27/fp/ld/27fpld_mwyyqlo0f7-zjaw__h6m.png"></p><br><p>  Captura de pantalla del desarrollador de github: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/950/f98/afe/950f98afe48bd0855a3bf416e004bfda.png"></p><br><p>  Conclusi√≥n </p><br><p>  Espero un mayor desarrollo del proyecto.  Mientras el proyecto est√° inactivo. </p><br><p>  Si va a armar el proyecto a mano, preste atenci√≥n a este <a href="https://github.com/mintance/nginx-clickhouse/issues/6" rel="nofollow">problema</a> . </p><br><p>  Canales de telegramas: <br>  <a href="https://t.me/clickhouse_ru" rel="nofollow">Clickhouse</a> <br>  <a href="https://t.me/nginx_ru" rel="nofollow">Nginx</a> <br>  <a href="https://t.me/metrics_ru" rel="nofollow">M√©tricas de la iglesia</a> </p><br><p>  Pregunta para los lectores: si almacena m√©tricas en clickhouse, ¬øqu√© utilidades / proyectos autohospedados obtiene m√©tricas por c√≥digos de estado y hosts virtuales con Nginx? </p><br><p>  ACTUALIZACI√ìN: El autor del proyecto acept√≥ mi solicitud de extracci√≥n: <br>  <a href="https://github.com/mintance/nginx-clickhouse/pull/9" rel="nofollow">https://github.com/mintance/nginx-clickhouse/pull/9</a> <br>  <a href="https://github.com/mintance/nginx-clickhouse/pull/10" rel="nofollow">https://github.com/mintance/nginx-clickhouse/pull/10</a> <br>  <a href="https://github.com/mintance/nginx-clickhouse/pull/11" rel="nofollow">https://github.com/mintance/nginx-clickhouse/pull/11</a> <br>  Adem√°s, el autor comenz√≥ a responder en el n√∫mero: <br>  <a href="https://github.com/mintance/nginx-clickhouse/issues/7" rel="nofollow">https://github.com/mintance/nginx-clickhouse/issues/7</a> <br>  <a href="https://github.com/mintance/nginx-clickhouse/issues/8" rel="nofollow">https://github.com/mintance/nginx-clickhouse/issues/8</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/477498/">https://habr.com/ru/post/477498/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../477488/index.html">Neungers: las especias deben fluir</a></li>
<li><a href="../477490/index.html">Kitchen Robotics Parte 2 u otro avatar de Blynk</a></li>
<li><a href="../477492/index.html">¬øQu√© quedar√° en la sala del servidor?</a></li>
<li><a href="../477494/index.html">1. An√°lisis de malware mediante el an√°lisis forense de Check Point. Red de chorro de arena</a></li>
<li><a href="../477496/index.html">M√°scara de vidrio agrietado: ¬øes una RP planificada?</a></li>
<li><a href="../477500/index.html">Modelo de aplicaci√≥n (Avalanche: marco de aplicaci√≥n para Java)</a></li>
<li><a href="../477502/index.html">Trabajo remoto de un empleador saludable</a></li>
<li><a href="../477504/index.html">Las mejores pr√°cticas de desarrollo de aplicaciones a seguir en 2020</a></li>
<li><a href="../477506/index.html">Desarrollo de una aplicaci√≥n m√≥vil sin servidor.</a></li>
<li><a href="../477508/index.html">Detectores de radar: algunas palabras m√°s sobre √©tica y muchas palabras sobre leyes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>