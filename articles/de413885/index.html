<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛄 🚍 ☁️ Cavium ThunderX2-Evaluierung: Der Arm Server-Traum wird wahr (Teil 1, Einführung) 👰🏽 👩🏾‍✈️ 👘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vor weniger als zwei Jahren haben wir den ersten Arm SoC-Server untersucht, der theoretisch mit dem Intel Xeon E5s - Cavium ThunderX - konkurrieren kö...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cavium ThunderX2-Evaluierung: Der Arm Server-Traum wird wahr (Teil 1, Einführung)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/413885/">  Vor weniger als zwei Jahren haben wir den ersten Arm SoC-Server untersucht, der theoretisch mit dem Intel Xeon E5s - Cavium ThunderX - konkurrieren könnte.  Der SoC-Server zeigte alles, was angekündigt wurde. Aufgrund der geringen Single-Thread-Leistung und der Schwierigkeiten bei der Optimierung der Energieeigenschaften wurde der 48-Kern-SoC jedoch Nischenmärkten zugeordnet.  Infolgedessen konnte der erste Cavium SoC-Server nie mit Intels Xeon mithalten. <br><br><img src="https://habrastorage.org/webt/x6/z7/5j/x6z75jaf9myymohvcozvis4hahg.jpeg"><br><br>  Cavium gab jedoch aus offensichtlichen Gründen nicht auf: Derzeit ist der Servermarkt attraktiver als je zuvor.  Rechenzentren des globalen Riesen Intel erwirtschaften einen Umsatz von rund 20 Milliarden US-Dollar (!) Pro Jahr.  Darüber hinaus beträgt die Rentabilität 50%.  In Bezug auf Gewinn und Geldumsatz ist der Servermarkt um ein Vielfaches größer als jeder andere Gerätemarkt.  Nach dem Start von ThunderX versprach Cavium daher, eine zweite Iteration zu veröffentlichen: verbesserte Energieverwaltung, verbesserte Single-Thread-Leistung und noch mehr Kerne (54). <br><a name="habracut"></a><br>  Was Cavium nicht in die Hände spielt, ist, dass der Benutzer, wenn er einen Server benötigt, einfach einen debuggten und zuverlässigen Intel-Computer nehmen kann.  In der Tat sind laute Versprechen von Arm, Calxeda, Broadcom und AppliedMicro in den letzten 5 Jahren Versprechen geblieben, was zu einer ernsthaften Welle von Skepsis und Misstrauen und der Entstehung neuer SoCs Arm Server geführt hat. <br><br>  Dennoch verdient die neue Kreation eines Außenseiters Cavium Aufmerksamkeit.  Es wurden eine Reihe von Änderungen vorgenommen, nicht nur die Hinzufügung der Nummer „2“ zum Namen: Cavium kaufte das vulkanische Design von Avago.  Vulcan ist ein ziemlich ehrgeiziges Prozessordesign, das ursprünglich vom SoC Broadcom-Team des Arm-Servers entwickelt wurde und ein viel größeres Erbe als das ursprüngliche ThunderX hat.  Aufgrund seiner Erfahrungen mit ThunderX konnte Cavium außerdem einige mikroarchitektonische Verbesserungen am Vulcan-Design vornehmen und dessen Leistung und Leistung verbessern. <br><br>  Infolgedessen stellte sich heraus, dass ThunderX2 ein ausgefeilterer Kern ist als die vorherige Generation.  Der ThunderX-Kern hatte eine sehr kurze Pipeline und hielt wahrscheinlich nicht zwei Anweisungen pro Zyklus aus, aber der Vulcan-Kern ist für 8 Abrufe ausgelegt und führt bis zu 4 Anweisungen pro Zyklus aus.  Und noch mehr: Alle 4 Streams (SMT4) können gleichzeitig aktiv sein und sorgen für ein konstantes Back-End-Laden.  Der neue ThunderX2 SoC32 verfügt über 32 solcher Kerne mit einer Frequenz von bis zu 2,5 GHz. <br><br><img src="https://habrastorage.org/webt/nt/nl/7a/ntnl7apffv6jkwh6k1v_aoqptae.png"><br><br>  Mit bis zu 128 Threads und mindestens acht DDR4-Controllern sollte diese CPU bei allen Serverlasten eine gute Leistung erbringen.  Mit anderen Worten, im Gegensatz zu ThunderX (1) ist ThunderX2 der erste Arm-Serverprozessor und hat jede Chance, das Gleichgewicht auf dem Servermarkt zu erschüttern. <br><br><h2>  Wer hat mehr: Spezifikationen </h2><br>  Zweiunddreißig hohe IPC-Kerne in einem Paket scheinen vielversprechend.  Aber wie sieht der neue ThunderX2 im Vergleich zu AMD-, Qualcomm- und Intel-Produkten aus?  In der folgenden Tabelle vergleichen wir die Spezifikationen mehrerer Top-End-Server-SKUs. <br><br><img src="https://habrastorage.org/webt/p3/hv/fx/p3hvfxp0iatr1ockmnjx9xm8xp8.png"><br><br>  Erfahrene Leser werden sofort feststellen, dass das Xeon Platinum 8180 die Spitze der Intel-Prozessorreihe ist. Diese SKU mit 205 W TDP und einem Preis von mehr als 10.000 US-Dollar ist jedoch im Allgemeinen mit keinem Prozessor auf der Liste vergleichbar.  Wir haben die Grenze der Vernunft bereits fast überschritten, einschließlich 8176, das, wie es uns scheint, gemäß den Parametern der maximalen SKU der Kernel / Thread-Blöcke in diese Liste fällt.  Tatsächlich positioniert Cavium das Cavium 9980 als „vergleichbar“ mit dem Xeon Platinum 8164 (und Intel spielt diese Rolle 8176), jedoch mit etwas niedrigeren Frequenzen. <br><br>  In Bezug auf die Leistung für den Dollar vergleicht Cavium sein Flaggschiff 9980 jedoch mit Intel Xeon Gold 6148, und in diesem Fall sieht der Preis des Cavium-Prozessors recht appetitlich aus.  Laut den Testergebnissen liegt der schnellste ThunderX2 30-40% vor dem Xeon 6148, während das Angebot von Cavium 1.300 US-Dollar billiger ist.  Diese aggressive Preisgestaltung erklärt die Gerüchte, dass Qualcomm nicht in den Servermarkt eintreten wird. <br><br>  Die Daten in der obigen Tabelle zeigen wichtige Unterschiede zwischen den Konkurrenten.  Intel scheint die fortschrittlichste Kerntopologie und die höchste Turbogeschwindigkeit zu haben.  Qualcomm sieht in Bezug auf die Leistung pro Watt attraktiver aus. <br><br><img src="https://habrastorage.org/webt/no/2u/7-/no2u7-_oyjv6ol2vd6vqiartfks.png"><br><br>  Wie der EPYC von AMD dürfte auch der ThunderX2 von Cavium auf dem Markt für Hochleistungscomputer glänzen (33% höherer Durchsatz, höhere Kerne / Threads).  Wie beim AMD-Design ist der EPYC L3-Cache langsam, wenn Sie Daten benötigen, die sich nicht im lokalen 8-MB-Cache-Steckplatz befinden.  ThunderX2 ist viel komplexer - mit einer Dual-Ring-Architektur ähnlich der Xeon v4-Ring-Architektur (Broadwell-EP).  Nach Informationen von Cavium kann ihre nicht blockierende Ringarchitektur Durchsätze von bis zu 6 TB / s liefern. <br><br>  Diese Ringarchitektur ist mit dem Coherent Processor Interconnect (CCPI2 - oben in der Abbildung) von Cavium verbunden, der mit einer Geschwindigkeit von 600 Gbit / s arbeitet.  Diese Verbindung verbindet zwei Socket / NUMA-Knoten.  56 Spuren von PCIe 3.0 SoC sind mit dem Ring verbunden, den Cavium unter 14 PCIe-Controllern gefunden hat.  Diese 14 Controller können wiederum wie unten gezeigt zu x4 oder x1 verzweigen. <br><br><img src="https://habrastorage.org/webt/yw/e3/r8/ywe3r8nlwh9n0sjcobksmoeqf58.png"><br><br>  Außerdem unterstützt es SR-IOV, was für die E / A-Virtualisierung (Xen und KVM) so wichtig ist. <br><br><h2>  ThunderX: Von einfach zu komplex </h2><br>  <b>Kurzes Briefing.</b>  Das ursprüngliche ThunderX war eine verbesserte Version von Octeon III: eine CPU mit der Fähigkeit, zwei Anweisungen (Dual-Issue-Core) mit zwei kurzen Pipelines gleichzeitig auszuführen. <br><br><img src="https://habrastorage.org/webt/s_/vu/na/s_vunadz47iappsidwdpeuyjmhw.png"><br><br>  Ein Vorteil des ursprünglichen ThunderX-Designs ist seine hohe Energieeffizienz, insbesondere für Workloads mit niedrigem ILP (Parallelität auf Befehlsebene).  Natürlich stellt ein derart kurzer Förderer ernsthafte Einschränkungen für die Erhöhung der Taktfrequenz dar, und ein einfaches Design garantiert eine niedrige Single-Threaded-Leistung bei mittleren und hohen ILP-Lasten, während fortschrittlichere Prozessoren außerhalb der Reihenfolge so viel „versteckte Parallelität“ wie möglich extrahieren können. ". <br><br><h3>  Der „neue“ Kern des Cavium: Vulcan </h3><br><img src="https://habrastorage.org/webt/20/1j/9c/201j9c0fk3jebmf5cwxryqdxkva.png"><br><br>  Im Vergleich zum ursprünglichen ThunderX ist der Kern des Vulcan ThunderX2 ein völlig anderes Tier.  Vulcan wurde 2014 von Broadcom angekündigt und ist ein relativ großer Kern, der 4 gleichzeitige Threads (SMT4) steuert.  Daher sollte das Back-End auch bei Serverlasten mit niedrigem ILP gut geladen sein. <br><br>  Um die Stabilität von 4 SMT-Streams zu gewährleisten, kann das ThunderX2-Front-End bis zu 64 Byte aus einem assoziativen 8-Wege-32-KB-Anweisungscache extrahieren, der mit einem einfachen Prefetcher für die nächste Zeile ausgestattet ist.  Die Auswahl von 8 Befehlen ist jedoch nur möglich, wenn diese 64 Bytes nicht verzweigt sind.  Andernfalls wird die Auswahl an der Gabel unterbrochen. <br><br>  Dies bedeutet, dass der Fetcher bei intensiv verzweigtem Code (Datenbanken, AI ...) durchschnittlich ± 5 Anweisungen pro Zyklus erhält, da eine der 5 Anweisungen eine Verzweigung ist.  Die ausgewählten Anweisungen werden dann an den Glättungspuffer gesendet - einen Puffer, in dem die gespeicherten Anweisungen zum Decodieren gespeichert werden. <br><br><img src="https://habrastorage.org/webt/lt/4e/q4/lt4eq4bh57wresbzuf84layrak8.png"><br><br>  Dann arbeitet der Decoder mit einem Paket von 4 Anweisungen.  Zwischen dem Decoder und der Umbenennungsphase hat jeder Stream einen "Slip Buffer", der aus 8 Packs besteht.  Mit 4 Threads können jederzeit bis zu 32 Pakete (128 Anweisungen) gepuffert werden. <br><br>  Diese 4 Anweisungen - das Paket - bewegen sich entlang der Pipeline, bis eine einzelne Nachrichtenwarteschlange für den Scheduler erreicht ist.  Wie Intels Loop Stream Detector (funktioniert wie ein kleiner Cache) verfügt er auch über einen Loop-Puffer und einen Prädiktor.  Dieser Schleifenpuffer eliminiert falsche Verzweigungsvorhersagen und enthält decodierte μops, die die Pipeline „verkürzen“ und die für die Decodierung verwendete Energie reduzieren. <br><br>  Es können bis zu 6 Anweisungen gleichzeitig ausgeführt werden.  Die Implementierung umfasst 2 ALU / FP / NEON-Steckplätze, 1 ALU / Tap-Steckplatz, 2 Lade- / Speichersteckplätze (16 Byte) und 1 sauberen Speichersteckplatz, der 16 Byte an den D-Cache sendet.  Es gibt einen kleinen (Cavium gibt nicht bekannt, wie viel) L1-TLB zum Umschalten ohne Verzögerung von virtuellen zu physischen Adressen.  Es gibt keinen Hardware-Prefetcher für den L1 D1-Cache, aber der L2-Cache verfügt über einen ziemlich ausgeklügelten Hardware-Prefetcher, der Muster erkennen kann (er kann Schritt für Schritt arbeiten oder die nächste Zeile abrufen). <br><br>  Dies reicht völlig aus, um das Back-End zu "füttern", das 4 Anweisungen pro Zyklus von 4 verschiedenen Threads unterstützen kann. <br><br><h3>  Unterschiede in der Mikroarchitektur </h3><br>  Cavium hat eine begrenzte Menge an Informationen zu den ThunderX2-Kernen veröffentlicht.  Einige Hauptmerkmale verschiedener Prozessorarchitekturen sind nachstehend zusammengefasst. <br><br><img src="https://habrastorage.org/webt/ud/di/rc/uddircouggaghevqdm5rtzgfrry.png"><br><br>  Eine detaillierte Analyse würde den Rahmen dieses Artikels sprengen.  Sie können jedoch Johan De Gelas Analysen zur Architektur von Falkor, Skylake und Zen in AnandTech lesen.  Wir beschränken uns auf die offensichtlichsten Unterschiede. <br><br>  Es ist ziemlich offensichtlich, dass die Single-Threaded-Leistung von Intel unübertroffen bleibt: Der Skylake-Kern ist der Kern, der die meisten Anweisungen im laufenden Betrieb ausführt und vor allem mit einer höheren Taktrate ausgeführt wird.  Der Kern von ThunderX2 unterscheidet sich darin, dass er maximal Anweisungen pro Zyklus extrahiert und ständig 4 Threads unterstützt.  Der Abrufer erfasst 8 Teams aus einem Thread, dann 8 aus dem zweiten Thread und wechselt weiter zwischen den Threads.  Dies bedeutet, dass eine schlechte Vorhersage die Leistung eines einzelnen Threads erheblich verringern kann. <br><br><h2>  Die ThunderX2-SKUs: 16 bis 32 Kerne </h2><br>  Die für die Tests verwendete SKU ist ThunderX2 CN9980 2.2.  Dies ist die Top-End-SKU, die 32 Kerne mit einer Frequenz von 2,2 GHz enthält und bis zu 2,5 GHz anheben kann. <br><br><img src="https://habrastorage.org/webt/bs/p0/cz/bsp0czxkrsx9_oxyoavedet_lje.png"><br><br>  Wenn Sie den Plänen von Cavium glauben, wird es in den kommenden Monaten viel mehr SKUs geben.  Cavium behauptet, dass der CN9980 bald mit einer Frequenz von 2,5 GHz und einem Turbo von bis zu 3 GHz erhältlich sein wird. <br><br>  Cavium listete alle geplanten SKUs zusammen mit vergleichbaren Intel-SKUs auf.  Nach Caviums Definition ist eine vergleichbare Intel-SKU ein Chip, der unter gcc die gleiche SPECInRate (2017) wie die Cavium-SKU erzielt. <br><br><img src="https://habrastorage.org/webt/nz/yd/7m/nzyd7mn7vi6azmttjyosotv51ma.png"><br><br>  Cavium glaubt, dass der CN9880 2.2, den wir bekommen haben, mit dem viel teureren 8164 vergleichbar ist. Für unsere Tests vergleichen wir ihn mit 8176 (Intel SKU steht uns zur Verfügung).  Nicht, dass es darauf ankommt: 8176 hat nur 3% höhere Taktrate und 2 zusätzliche Kerne (+ 7%) im Vergleich zu 8164. Beachten Sie jedoch, dass der ThunderX2 Cavium zwar wirklich mit den angegebenen Intel-SKUs konkurrieren kann, diese jedoch bieten die gleiche Leistung für ein Drittel der Intel SKU-Kosten. <br><br>  Im nächsten Teil: <br><br><ul><li>  Testkonfiguration und Methodik </li><li>  Speichersubsystem: Bandbreite </li><li>  Single-Threaded-Leistung: SPEC CPU2006 </li><li>  SPEC CPU2006 Cont: Kernbasierte Leistung mit SMT </li></ul><br>  Vielen Dank für Ihren Aufenthalt bei uns.  Gefällt dir unser Artikel?  Möchten Sie weitere interessante Materialien sehen?  Unterstützen Sie uns, indem Sie eine Bestellung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgeben</a> oder Ihren Freunden empfehlen, einen <b>Rabatt von 30% für Habr-Benutzer auf ein einzigartiges Analogon von Einstiegsservern, das wir für Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit über VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s von $ 20 oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). <br><br>  <b>Dell R730xd 2 mal günstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 GB DDR4 6 x 480 GB SSD 1 Gbit / s 100 TV von 249 US-Dollar</a> in den Niederlanden und den USA!</b>  Lesen Sie mehr über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Aufbau eines Infrastrukturgebäudes.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern für 9.000 Euro für einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413885/">https://habr.com/ru/post/de413885/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413873/index.html">Die wiederhergestellten Daten aus der Apollo-Mission haben dazu beigetragen, das Rätsel der „Erwärmung des Mondes“ zu lösen.</a></li>
<li><a href="../de413875/index.html">SpaceX wird ein "Weltraumzentrum der Zukunft" entwickeln</a></li>
<li><a href="../de413877/index.html">Sie geben nur einen Grund an. Oder unter welchem ​​Vorwand können sie dich jetzt ausrauben?</a></li>
<li><a href="../de413879/index.html">Ein Pferd lernen (Teil 4)</a></li>
<li><a href="../de413881/index.html">5,94 Meter Docker-Bild mit Telegramm MTProxy</a></li>
<li><a href="../de413889/index.html">Verpasste Frist oder warum mehr als die Hälfte der Unternehmen nicht für die DSGVO bereit waren</a></li>
<li><a href="../de413891/index.html">Wie ist das einheitliche staatliche Register der juristischen Personen - ein einheitliches staatliches Register der juristischen Personen?</a></li>
<li><a href="../de413893/index.html">Ein Loch als Sicherheitswerkzeug - 2 oder wie man APT "lebende Köder" fängt</a></li>
<li><a href="../de413895/index.html">Ein billiges Fitness-Armband hacken</a></li>
<li><a href="../de413897/index.html">Unity3D ECS und Job System</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>