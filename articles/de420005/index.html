<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äç‚öïÔ∏è üõãÔ∏è ‚úçÔ∏è Die unprofessionelle Video√ºberwachung der Wohnung ist unterhaltsam und kosteng√ºnstig üë©üèø üôÖüèΩ üßëüèæ‚Äçü§ù‚ÄçüßëüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Von dem Moment an, als ich ein GSM-Alarmsystem in meiner Wohnung auf der Hut hatte, kam mir die Idee, dass es sch√∂n w√§re, in meiner Abwesenheit ‚ÄûAugen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Die unprofessionelle Video√ºberwachung der Wohnung ist unterhaltsam und kosteng√ºnstig</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420005/"><img align="left" src="https://habrastorage.org/webt/af/kl/ma/afklma2ivyuyigiy4x2qvej-tjc.jpeg">  Von dem Moment an, als ich ein GSM-Alarmsystem in meiner Wohnung auf der Hut hatte, kam mir die Idee, dass es sch√∂n w√§re, in meiner Abwesenheit ‚ÄûAugen‚Äú in der Wohnung zu haben, wenn die Alarmsensoren ausgel√∂st w√ºrden (oder ist der Alarm m√∂glicherweise falsch?).  Da ich Ingenieur auf dem Gebiet der Informationstechnologie bin, gab es keine Frage einer professionellen L√∂sung in Form eines Registrars und einer Reihe von Kameras - nur alles selbst, mit meinen eigenen H√§nden.  Es wurde auch beschlossen, das Budget sofort zu begrenzen und bei Erfolg des Projekts bereits √ºber seine weitere Verbesserung und Modernisierung nachzudenken. <br><a name="habracut"></a><br><h4>  Eisen </h4><br>  Zun√§chst w√§hlen wir das Eisen aus.  "Augen" bedeutet eine Kamera, es kommt kein Weg.  Dann stellt sich die Frage, was mit dem empfangenen Bild zu tun ist - es zu speichern, irgendwo zu √ºbertragen usw.  Also dachte ich an einen Router, der √ºber eine USV mit einem 4G-Modem f√ºr einen stabilen Internetkanal verbunden ist, der einem potenziellen Einbrecher nur schwer zug√§nglich ist. <br><br>  Bei der Arbeit setzen wir seit mehreren Jahren erfolgreich Router mit ZyXel Keenetic USB-Anschl√ºssen ein (insbesondere mein bereits veraltetes Giga2-Modell).  Nachdem die Entwickler der Firmware so etwas wie OPKG (Paketmanager) ‚Äûvermasselt‚Äú hatten, wurde es m√∂glich, meinen Router in einen PC mit Linux mit den weitesten M√∂glichkeiten zu verwandeln, den ich f√ºr meinen Zweck verwenden wollte.  Insgesamt fehlte mir, da ich bereits einen Computer-Router mit angeschlossenem 4G-Modem zu Hause hatte, nur die ‚ÄûAugen‚Äú - eine USB-Kamera.  Ich erinnere mich, dass ich vor drei oder vier Jahren eine logitech C270-Webcam f√ºr meine Eltern gekauft habe, um mit Verwandten √ºber Skype auf einem Computer zu kommunizieren, und dass sie jetzt bereits √ºber ein Tablet kommunizieren - ich habe die Kamera von ihnen angefordert.  √úbrigens befindet sich auf der Vorderseite der Kamera eine LED, die anzeigt, ob die Kamera funktioniert oder nicht - sp√§ter erwies es sich als sehr praktisch, um den Betrieb des Video√ºberwachungssystems visuell zu bestimmen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jc/mn/7h/jcmn7hy7culoiu4yxzchbbrhpzo.jpeg"></div><br><h4>  Koppeln und konfigurieren Sie das B√ºgeleisen </h4><br>  Es gibt also Eisen.  Und was kann sich nur freuen - solange wir im Budget sind. <br>  Mein Router verf√ºgt √ºber zwei USB-Anschl√ºsse, von denen einer bereits von einem 4G-USB-Modem belegt war.  Wir werden die zweite verwenden, indem wir die logitech C270-Kamera dort anbringen.  Damit der Router mit der Kamera funktioniert, m√ºssen Sie zuerst die OPKG-Komponente auf dem Router installieren (in dieser Komponente setzen Sie alle H√§kchen au√üer ‚ÄûKernelmodule zur Unterst√ºtzung von USB-DVB-Tunern‚Äú).  Aber es gibt einen Haken: Damit OPKG im Router funktioniert, ben√∂tigen Sie Speicherplatz (ein Gigabyte reicht f√ºr die Augen), aber wo kann ich ihn bekommen, da beide USB-Anschl√ºsse am Router bereits belegt sind?  Es gab zwei m√∂gliche L√∂sungen - entweder einen USB-Hub mit einem USB-Flash-Laufwerk (das erste, was mir sofort einf√§llt) oder die Tatsache, dass Sie eine microSD-Karte in mein 4G-USB-Modem stecken k√∂nnen.  Und die alte langsame microSD-Karte mit 8 Gigabyte, die zu Hause gefunden wurde, ging sofort an das Modem.  Belassen Sie das Dateisystem auf einer NTFS-Karte (obwohl EXT2 oder EXT3 dringend empfohlen wird).  Erstellen Sie den Installationsordner und laden Sie das gew√ºnschte Entware-Image hoch. <br><br>  Dann gehen wir zum Admin-Bereich des Routers, der Registerkarte OPKG, w√§hlen unsere Speicherkarte aus, in der Zeile "initrc script" schreiben <br><br><pre><code class="hljs swift">/opt/etc/<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>.d/rc.unslung</code> </pre> <br>  und klicken Sie auf <i>√úbernehmen</i> . <br>  Nach der Installation von OPKG klammert sich der SSH-Client (ich verwende das Putty-Programm auf meinem Laptop mit Windows) an den Router und f√ºhrt die folgenden Befehle aus, um OPKG zu aktualisieren: <br><br><pre> <code class="hljs sql">opkg <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> opkg <span class="hljs-keyword"><span class="hljs-keyword">upgrade</span></span></code> </pre> <br>  Bei SSH ist das <i>Root-</i> Passwort <i>standardm√§√üig scharf</i> (oder <i>zyxel</i> , abh√§ngig von der Firmware-Version).  Es wird dringend empfohlen, das Kennwort mit dem Befehl <i>passwd zu</i> √§ndern. <br><br><h4>  Software </h4><br>  Installieren Sie als N√§chstes das Bewegungsprogramm. <br><br><pre> <code class="hljs sql">opkg <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> motion</code> </pre> <br>  Sie wird mit unserer Kamera arbeiten, die √Ñnderung im Bild analysieren und den Router anweisen, wohin das empfangene Bild gesendet werden soll.  Die Einstellungsdatei f√ºr das Bewegungsprogramm lautet \ etc \ motion \ motion.conf. Wenn Sie sie bearbeiten, √§ndern Sie die erforderlichen Einstellungen.  Zun√§chst stellte ich die von der Kamera unterst√ºtzte maximale Aufl√∂sung auf 1280 x 720 ein, drehte sie um 180 Grad (es war f√ºr mich bequemer, die Kamera auf den Kopf zu stellen) und zeichnete 2 Bilder pro Sekunde auf. <br><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">rotate</span></span> <span class="hljs-number"><span class="hljs-number">180</span></span> width <span class="hljs-number"><span class="hljs-number">1280</span></span> height <span class="hljs-number"><span class="hljs-number">720</span></span> framerate <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br>  Ich sah nicht die Notwendigkeit, den gesamten Videostream aufzuzeichnen und ins Internet zu senden, daher habe ich die Bewegung so eingestellt, dass Videos nur dann aufgezeichnet und √ºbertragen werden, wenn sich das Bild √§ndert.  Bei der Konfiguration der Bewegung wurde deutlich, dass der MJPEG-Modus mit meiner Kamera nicht unterst√ºtzt wird, sondern nur der YUYV-Modus. Daher ist das Ergebnis der Arbeit keine Videosequenz, sondern nur eine Folge von JPEG-Fotos. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">v4l2_palette</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span></code> </pre> <br>  Ich habe Motion auch so konfiguriert, dass eine Kopie der Fotos auf einen externen FTP-Server kopiert wird. <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">on_picture_save</span></span> wput ftp://login:pass<span class="hljs-variable"><span class="hljs-variable">@XX</span></span>.29.136.XX %f</code> </pre> <br>  F√ºr den Fall, dass ein Router mit einer Speicherkarte aus der Wohnung genommen wird, besteht weiterhin die M√∂glichkeit zu sehen, wie genau dies geschehen ist. <br><br>  Es wird dringend empfohlen, das Anmeldekennwort zu √§ndern, um eine Verbindung zu Ihrer Kamera herzustellen. <br><br><pre> <code class="hljs pgsql">stream_authentication <span class="hljs-keyword"><span class="hljs-keyword">login</span></span>:pass</code> </pre> <br>  Suchen Sie nach allen Einstellungen im Browser nach dem Ergebnis unter: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">IP</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:8081</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b4/xd/wk/b4xdwknikb-elwngaufq3z8setg.jpeg"></div><br>  Achtung!  Wenn Sie im Browser kein Bild gesehen haben, sollten Sie auf Ihre Keenetic-Firmware-Version achten.  Vermutlich ab der Firmware-Version 2.11.A.4.0-1 werden Videomodule nicht standardm√§√üig geladen. Sie m√ºssen sie daher in ‚ÄûSSH‚Äú -Stifte laden oder zum Startskript hinzuf√ºgen: <br><br><pre> <code class="hljs powershell">/opt/sbin/insmod /lib/modules/<span class="hljs-number"><span class="hljs-number">3.4</span></span>.<span class="hljs-number"><span class="hljs-number">113</span></span>/i2c<span class="hljs-literal"><span class="hljs-literal">-core</span></span>.ko /opt/sbin/insmod /lib/modules/<span class="hljs-number"><span class="hljs-number">3.4</span></span>.<span class="hljs-number"><span class="hljs-number">113</span></span>/i2c<span class="hljs-literal"><span class="hljs-literal">-dev</span></span>.ko /opt/sbin/insmod /lib/modules/<span class="hljs-number"><span class="hljs-number">3.4</span></span>.<span class="hljs-number"><span class="hljs-number">113</span></span>/videodev.ko /opt/sbin/insmod /lib/modules/<span class="hljs-number"><span class="hljs-number">3.4</span></span>.<span class="hljs-number"><span class="hljs-number">113</span></span>/videobuf2<span class="hljs-literal"><span class="hljs-literal">-core</span></span>.ko /opt/sbin/insmod /lib/modules/<span class="hljs-number"><span class="hljs-number">3.4</span></span>.<span class="hljs-number"><span class="hljs-number">113</span></span>/videobuf2<span class="hljs-literal"><span class="hljs-literal">-memops</span></span>.ko /opt/sbin/insmod /lib/modules/<span class="hljs-number"><span class="hljs-number">3.4</span></span>.<span class="hljs-number"><span class="hljs-number">113</span></span>/videobuf2<span class="hljs-literal"><span class="hljs-literal">-vmalloc</span></span>.ko /opt/sbin/insmod /lib/modules/<span class="hljs-number"><span class="hljs-number">3.4</span></span>.<span class="hljs-number"><span class="hljs-number">113</span></span>/v4l2<span class="hljs-literal"><span class="hljs-literal">-common</span></span>.ko /opt/sbin/insmod /lib/modules/<span class="hljs-number"><span class="hljs-number">3.4</span></span>.<span class="hljs-number"><span class="hljs-number">113</span></span>/uvcvideo.ko</code> </pre> <br>  Wenn das Bild auch danach nicht angezeigt wurde, sehen wir uns zun√§chst die Keenetic-Protokolle an. Was passiert, wenn die Kamera angeschlossen ist?  Wird die Kamera als Videoger√§t usw. erkannt? <br><br><h4>  Management </h4><br>  Nachdem wir all diese Arbeit erledigt hatten, kam die Idee auf, dass wir das irgendwie schaffen m√ºssen, d.h.  Ein- und Ausschalten zum richtigen Zeitpunkt (und meistens aus der Ferne).  Ich habe das Problem gel√∂st, indem ich den SSH-Client auf meinem Android-Smartphone installiert habe.  Nach der Auswahl von SSH entschieden sich Clients f√ºr ScriptKitty.  Durch Dr√ºcken von zwei oder drei Tasten auf einem Smartphone k√∂nnen Sie Bewegungen schnell ein- oder ausschalten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/0r/dj/to/0rdjtofm6gsjlzfjxq_dkrk6zgo.jpeg"></div><br>  Laufende Bewegung durch SSH: <br><br><pre> <code class="hljs swift">/opt/etc/<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>.d/<span class="hljs-type"><span class="hljs-type">K99motion</span></span> restart</code> </pre> <br>  Bewegung durch SSH abschlie√üen: <br><br><pre> <code class="hljs swift">/opt/etc/<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>.d/<span class="hljs-type"><span class="hljs-type">K99motion</span></span> stop</code> </pre> <br>  Aber es gab noch einen Haken: eine "graue" IP-Adresse auf meinem 4G-Modem.  Wenn Sie √ºber WLAN eine Verbindung zum Router herstellen, k√∂nnen Sie die Bewegung problemlos aus- oder einschalten.  Aber was ist, wenn Sie sich au√üerhalb des WLANs Ihres Routers befinden und Ihr Router eine "graue" IP hat?  Ich fand die Rettung in Form eines VPN.  Das Schema ist wie folgt: Mit meinem Heimrouter klammere ich mich bei der Arbeit mit einer statischen IP √ºber einen PPTP-Client an den Router (ein PPTP-Server wird bei der Arbeit auf dem Router installiert).  Nachdem ich den SSH-Port vom Arbeitsrouter an den Heimrouter weitergeleitet habe, kann ich meine Kamera endlich fernsteuern, indem ich von meinem Smartphone aus auf die statische Adresse des Routers bei der Arbeit zugreife. <br><br>  Ich habe auch versucht, die Steuerung mithilfe des Tasker-Automatisierungstools zu automatisieren (es verf√ºgt √ºber einen eigenen SSH-Client), um die Verbindung des Smartphones zum WLAN-Router zu √ºberwachen und die Bewegung abh√§ngig davon ein- oder auszuschalten.  Die Logik hier ist folgende: Das Smartphone ist mit dem WLAN-Router verbunden - ich bin also zu Hause -, um die Kamera auszuschalten.  Das Smartphone ist nicht mit dem WLAN-Router verbunden - ich bin also nicht zu Hause - schalten Sie die Kamera ein.  Aber nach dem Experimentieren lehnte er diese Option ab - es gibt zu viele Fehlalarme.  Ich bin zum Beispiel zu Hause, das Smartphone ist eingeschlafen, der Router hat das Smartphone verloren, die Kamera ist eingeschaltet - na ja usw.  Derzeit verwende ich nur die manuelle Methode. <br><br><h4>  Fazit </h4><br>  Im Prinzip wollte ich von dem Projekt, was ich bekam.  Ich kann die Wohnung ‚Äûsehen‚Äú, wann immer ich m√∂chte, und im Falle eines GSM-Alarms kann ich bereits entscheiden, was als n√§chstes zu tun ist.  W√§hrend des Umsetzungsprozesses habe ich eine Reihe von Problemen gel√∂st, aber ihre L√∂sung hat durch das erworbene Wissen und die Umsetzung des Plans einen gewissen Nervenkitzel ausgel√∂st. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/av/fa/ux/avfauxqtn-lu_v2vmvijmrrd1em.jpeg"></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de420005/">https://habr.com/ru/post/de420005/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de419995/index.html">Eine Studie von Ivy, dem neuen Angular-Compiler</a></li>
<li><a href="../de419997/index.html">Analysieren des Musters "Modul" in JavaScript</a></li>
<li><a href="../de419999/index.html">Freigabe der Yii1 / yii2-Authentifizierung</a></li>
<li><a href="../de420001/index.html">Einf√ºhrung in 3CX v15.5 Update 6 BETA und WebRTC Browser Softphone</a></li>
<li><a href="../de420003/index.html">Fenster mit Schaltfl√§chen in JavaFX:</a></li>
<li><a href="../de420007/index.html">FidgetPen, seltsame Lampen- und Splitterw√ºrfel: Allocacoc kennenlernen</a></li>
<li><a href="../de420009/index.html">Die Feinheiten des Produktdesigns</a></li>
<li><a href="../de420011/index.html">So w√§hlen Sie einen 3D-Drucker aus: Ein Leitfaden f√ºr Anf√§nger</a></li>
<li><a href="../de420013/index.html">MAC-Adressensuche auf Juniper-Switches</a></li>
<li><a href="../de420015/index.html">So messen Sie die Geschwindigkeit des Internetkanals richtig und sehen in den Augen Ihres Anbieters nicht mehr wie ein Idiot aus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>