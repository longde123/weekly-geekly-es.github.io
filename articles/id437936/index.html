<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙄 👴🏽 👩🏽‍✈️ Platform videonya adalah ffmpeg dan kualitas encoding video. Bagian 2 🈚️ 🤸🏽 🌵</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lenna sangat suka berpenampilan bagus - seorang model fesyen. Ada legenda yang menambahkannya ke judul artikel yang terkait dengan pemrosesan data vis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Platform videonya adalah ffmpeg dan kualitas encoding video. Bagian 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437936/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/-s/ru/54/-sru54pmvf-usmpvhvzgo1wxwyw.png"></div><br>  <sub>Lenna sangat suka berpenampilan bagus - seorang model fesyen.</sub>  <sub>Ada legenda yang menambahkannya ke judul artikel yang terkait dengan pemrosesan data visual memberi peluang +5 untuk plus.</sub> <br><br>  Saya terus mengungkapkan fitur layanan video.  Hari ini mencatat tentang opsi pengkodean dan pilihannya. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Bagian pertama</a> <br><br>  Sebagian besar codec menawarkan nilai default yang cukup seimbang, memungkinkan Anda untuk mendapatkan hasil normal tanpa banyak pilihan parameter.  Namun, ketika datang ke arsip besar materi video, batasan bitrate, pertimbangan kompatibilitas dengan peralatan klien dan keinginan yang masuk akal untuk menjaga kualitas aslinya, semuanya menjadi lebih menarik. <br><br>  Sayangnya, tombol ajaib "penyandian sangat baik" tidak disediakan.  Seperti analog <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">caniuse</a> untuk parameter enkode.  Harus mengerti fitur dari codec. <br><a name="habracut"></a><br><h3>  Pendahuluan: Profil </h3><br>  Ada begitu banyak pengaturan dan parameter untuk H264 sehingga pengembang sendiri, agar tidak bingung, memutuskan untuk membuat daftar profil - konfigurasi "baik" untuk tujuan yang berbeda.  Profil standar banyak diidentifikasi;  Selain itu, dengan mengatur parameter pengodean Anda sendiri, Anda, pada kenyataannya, membuat profil Anda sendiri, membingungkan semua orang sepenuhnya.  Jadi, sayangnya, ternyata seperti biasa. <br><br><img src="https://habrastorage.org/storage3/ffa/c72/7fd/ffac727fd7f9547d36657745fe7ea3a1.png"><br><br>  Pada awalnya, profil dibuat untuk menentukan apakah video final akan diputar pada jenis perangkat yang diinginkan, tetapi sekarang tidak ada pemisahan pemain yang jelas berdasarkan jenis perangkat dan profil. <br><br>  Dalam praktiknya, saya akan memilih, dengan tingkat intensitas sumber daya decoding, tiga kelompok parameter: <br><br><ul><li>  dengan CABAC dinonaktifkan;  profil utama dan baseline bersyarat.  Mereka masih dapat digunakan untuk streaming sensitif terhadap penundaan; </li><li>  dengan CABAC diaktifkan;  profil yang relatif tinggi.  Untuk semuanya.  Kebanyakan peralatan modern (dan tidak demikian) dapat memainkan hal seperti itu.  Peningkatan efisiensi dibandingkan dengan utama - 20% +; </li><li>  dengan dukungan untuk pengambilan sampel sepuluh-bit dan parameter lanjutan lainnya.  Kondisional Hi10P.  Masalah dengan profil tersebut adalah hampir tidak adanya dukungan perangkat keras dan peningkatan persyaratan untuk peralatan decoding;  Ponsel, bahkan yang top-end, tidak dapat mengatasi file seperti itu.  Ini dapat digunakan untuk perpustakaan pribadi jika Anda yakin dengan peralatan Anda.  Peningkatan efisiensi 10-20% lainnya. </li></ul><br>  Konsep profil untuk codec lain tidak dikembangkan seperti pada H264.  Bagi mereka, kita dapat mengasumsikan bahwa jika codec didukung, maka sepenuhnya didukung, dan pembatasan selama pemutaran hanya dapat bitrate terlalu tinggi, atau parameter lain yang jelas dibesar-besarkan.  Namun, dengan menjamurnya decoder perangkat keras VP8 dan VP9, ​​situasinya dapat berubah. <br><br>  Sekarang ke parameter individual. <br><br><h3>  Ruang warna </h3><br>  Pilihan ruang warna hampir tidak berpengaruh pada efisiensi pengkodean;  parameter ini dapat diserahkan kepada pilihan codec (penting ketika memproses data mentah, tidak dikodekan) jika itu bukan untuk satu fitur: banyak pemain memproses informasi ruang warna dengan sangat khusus, sehingga bagi sebagian besar pengguna video dapat ditampilkan dengan distorsi warna (dalam kebanyakan hijau). <br><br>  Untuk mempertahankan warna bagi sebagian besar pemain, video H264 yang berbeda perlu dikodekan dalam ruang yang berbeda: <br><br><ul><li>  untuk SD (lebar &lt;1280) - BT.601 </li><li>  untuk HD (lebar&gt; = 1280) - BT.709 </li></ul><br>  Ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">studi yang</a> sangat baik dari 2012.  tentang hal ini.  Sayangnya, situasi dengan bug seperti itu berubah sangat lambat, dan meskipun beberapa hasil tes dari artikel itu tidak lagi relevan, fitur seperti itu masih perlu diperhitungkan.  Ada kemungkinan Anda menonton video dengan warna yang salah selama ini - dan ternyata ini bukan keputusan sutradara. <br>  Masalahnya dikenal untuk decoder H264; format lain mungkin tidak memiliki masalah ini. <br><br><h3>  Frame rate </h3><br>  Jika sumber Anda bukan aliran game atau video aksi, maka masuk akal untuk membatasi frame rate atas menjadi 25-30 frame - semakin sedikit, semakin banyak data yang menggambarkan frame tunggal.  Lebih baik mengurangi nilai ini dengan faktor - sehingga frame skip seragam, jika tidak, video dapat mengalami pelambatan. <br><br>  Ada yang namanya frame rate variabel.  Bekerja dengan VFR tidak nyaman karena dua alasan: pertama, ia memberikan puncak bitrate di area frekuensi tinggi yang langsung mengosongkan buffer;  kedua, VFR mempersulit persiapan rencana konversi, memaksa penggunaan parameter-Q (saya menulis tentang mereka di artikel pertama). <br><br><h3>  Ukuran Gop </h3><br>  Grup gambar adalah blok di mana beberapa gambar dapat merujuk ke data orang lain.  Peningkatan ukuran GOP meningkatkan kinerja codec dengan imbalan peningkatan kebutuhan memori.  Nilai yang lebih besar sangat efektif untuk file dengan jenis gerakan siklis yang sama (Anda tahu maksud saya).  Juga, dengan nilai besar, mungkin ada masalah dengan memutar ulang video, karena  lebih banyak data perlu dipulihkan. <br>  Nama parameter, serta unit pengukuran, mungkin berbeda dari codec ke codec - lihat dokumentasi. <br><br><h3>  Irisan </h3><br>  Untuk mempercepat decoding (dan encoding), video dapat dibagi menjadi beberapa bagian dengan resolusi lebih rendah.  Idenya adalah bahwa memproses empat video dengan resolusi, misalnya, 1280x720 lebih mudah dari satu, tetapi 2560x1440.  Masuk akal pada resolusi yang lebih tinggi dari FHD.  Semakin banyak bagian, semakin rendah efisiensi codec.  Juga, penggunaan pemisahan ini menyederhanakan pemrosesan multi-utas. <br><br><h3>  Pixel anamorphic </h3><br>  Piksel persegi panjang muncul ketika rasio aspek dan rasio lebar piksel terhadap tinggi berbeda - DVD layar lebar, di mana video 16: 9 memiliki resolusi 704 × 480 (3: 2 dengan PPN analog dan dikoreksi angin).  Memutar video semacam itu tidak akan menimbulkan masalah, namun, ketika menyandikan, Anda harus mempertimbangkan resolusi dan rasio aspek, jika tidak mudah untuk mengubah anamorphic menjadi piksel persegi standar dengan kehilangan efisiensi (hingga ~ 35%!), Atau bahkan mendapatkan sesuatu yang rata secara horizontal. <br><br><h3>  Kontrol Bitrate </h3><br>  Ada tiga mode utama codec yang terkait dengan bitrate: <br><br><ul><li>  bitrate konstan, CBR, ketika kualitas turun sebanding dengan kompleksitas adegan; </li><li>  kualitas konstan, const Q VBR, ketika bitrate meningkat sebanding dengan kompleksitas adegan; </li><li>  bitrate dan kualitas terbatas - VBR klasik. </li></ul><br>  Perlu dicatat bahwa sebagian besar penyandi (termasuk ffmpeg) tidak mengatur codec ke mode CBR ketika mengatur bitrate - file dibuat oleh VBR, dengan batasan yang tidak selalu ditentukan dalam dokumentasi (mode CBR diaktifkan, biasanya dengan mengatur minrate dan maxrate yang sama). <br><br>  Untuk pemutaran online (dan untuk streaming) VBR terbatas sangat cocok.  itu memberikan kualitas yang lebih baik daripada CBR dan memungkinkan Anda menyesuaikan aliran ke saluran Internet. <br><br>  Pilihan maxrate / minrate tergantung pada saluran klien, penyebaran lebih dari 20% lebih baik tidak dilakukan. <br><br><h3>  Pengodean multi lulus </h3><br>  Sulit untuk memprediksi distribusi data pada file dalam mode VBR, codec harus menebak apa yang terjadi tidak selalu.  Dalam mode multi-pass, codec pertama memetakan laju bit yang diperlukan, dan kemudian mengkodekan.  Dengan cara ini, kualitas video dalam adegan yang kompleks dan dinamis ditingkatkan ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">misalnya</a> . Perhatikan jumlah elemen "moiré" dan jumlah transisi di antara adegan).  Karena pada pass pertama codec hanya menganalisis file sumber, bertentangan dengan kepercayaan populer, pemrosesan dalam mode ini tidak memerlukan waktu lebih dari dua kali lipat, tetapi hanya 10-15%. <br><br><h3>  -Tune </h3><br>  Untuk berbagai jenis bahan sumber, beberapa preset telah disiapkan yang menyempurnakan beberapa parameter pengkodean dasar - seperti level filter deblocking, parameter optimasi psiko-visual.  Menggunakan preset ini meningkatkan persepsi video dan bekerja dengan baik jika Anda mengetahui jenis sumbernya di muka, atau jika Anda memiliki seperangkat video terstruktur (dalam hal pemrosesan massal). <br><br>  Preset: <br><br><ul><li>  film - untuk film dan semuanya dengan struktur bingkai yang kompleks.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ini</a> jelas sebuah film; </li><li>  animasi - untuk video dengan area padat yang besar.  Artinya, lebih baik untuk kode dengan preset animasi, dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> adalah film, terlepas dari kenyataan bahwa animasi; </li><li>  stillimage - untuk video di mana hampir tidak ada gerakan;  optimisasi yang baik untuk lagu-lagu dalam format mp4, di mana sampul album adalah seluruh latar belakang video (seseorang, beri tahu mereka bahwa bahkan flac tidak dapat menimbang 300MB selama 10 menit!); </li><li>  grain - untuk mengkodekan sumber "berisik", seperti kamera pengintai; </li><li>  psnr / ssim - untuk mengevaluasi efektivitas parameter yang tersisa dari codec; </li><li>  fastdecode - profil utama paksa untuk perangkat yang lemah; </li><li>  zerolatency - seperti namanya, untuk streaming latensi rendah. </li></ul><br><h3>  Format piksel </h3><br>  Format dan bitness sangat memengaruhi bagaimana file dikompresi dan tidak dikompres, dalam kualitas form apa yang hilang.  Parameter utama yang dijelaskan oleh format piksel adalah: <br><br><ul><li>  cara penguraian warna menjadi komponen - YUV, RGB; </li><li>  parameter subsampling warna (oh bagaimana! chroma subsampling lebih akrab) ketika beberapa komponen warna disimpan dengan resolusi lebih rendah; </li><li>  kedalaman komponen warna dalam bit. </li></ul><br>  Pilihan sadar dari format piksel memerlukan analisis terpisah, kumpulan bahan dan sangat tergantung pada jenis bahan sumber. <br><br>  Secara singkat: <br><br><ul><li>  tidak semua codec (dan, yang paling penting, decoder) mendukung format yang mungkin; </li><li>  bekerja dengan beberapa format lebih menuntut pada sumber daya - Hi10P berbeda dari hanya profil tinggi dalam hal ini; </li><li>  bekerja dengan format sub-sampel dapat memberikan peningkatan nyata dalam efisiensi kompresi, tetapi lebih sulit untuk mengontrol kehilangan kualitas. </li></ul><br><h3>  Interlacing </h3><br>  Interlacing diciptakan untuk menggandakan frame rate yang dirasakan dengan biaya minimum - bitrate dan resolusi adalah sama, tetapi frekuensinya lebih tinggi.  Namun, dengan gerakan cepat, gigi menjadi terlihat - garis-garis bingkai sebelumnya.  Anda dapat menyingkirkan efek tanpa menjatuhkan bingkai dan tidak mengurangi resolusi vertikal dengan filter, tetapi mereka akan mengurangi kejelasan.  Jika video akan diputar di browser, lebih baik untuk menyaring interlacing selama encoding, seperti  pemfilteran waktu-nyata pada klien tidak akan memberikan hasil visual terbaik. <br><br><h3>  Menyatukan semuanya </h3><br>  Contoh untuk x264: <br><br><pre><code class="bash hljs">ffmpeg -i [] -c:v libx264 -b:v [bitrate] <span class="hljs-comment"><span class="hljs-comment">#  -maxrate [bitrate] #   -r [framerate] -g [size] #GOP   -aspect [,  16:9] #   -profile high #    CABAC -color_primaries bt709 #   ,     -color_trc bt709 -colorspace bt709 -slices 4 #     -threads 4 -tune [value] -map_metadata:g -1 # ,      -map_metadata:s:v -1 -map_metadata:s:a -1 -map_chapters -1 -pass [1|2] #   -passlogfile [file] #    #-map ... -a:c ... -ac ... -a:b ..., ,  -   []</span></span></code> </pre> <br>  Tentu saja, dalam satu artikel itu tidak mungkin untuk mencakup semuanya, tetapi saya yakin materi ini akan cukup untuk meningkatkan kualitas banyak video. <br><br>  Baca dokumentasi dan eksperimen. <br><br>  Bahan: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ffmpeg.org/ffmpeg-all.html</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">en.wikipedia.org/wiki/H.264/MPEG-4_AVC#Profile</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">en.wikipedia.org/wiki/Chroma_subsampling</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">en.wikipedia.org/wiki/Color_space</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">en.wikipedia.org/wiki/YUV</a> <br><br>  Selain <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">contoh</a> dari artikel terakhir, saya belajar tentang pemasangan kode saya yang lain - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">klik</a> .  Saya mencoba mengambil contoh dalam artikel dari situs-situs ini, tetapi meskipun demikian: <br>  <sub>* Saya tidak memiliki hubungan langsung dengan penulis situs yang disebutkan dan tidak boleh berbagi pandangan dan pendapat mereka.</sub>  <sub>Saya tidak dapat mengomentari keputusan tentang siapa dan bagaimana akses ke kode diberikan.</sub> <br><br>  Siap menjawab pertanyaan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id437936/">https://habr.com/ru/post/id437936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id437926/index.html">Panduan resmi untuk Blockchain Sharding</a></li>
<li><a href="../id437928/index.html">Cara belajar bahasa Inggris</a></li>
<li><a href="../id437930/index.html">Perlengkapan pencahayaan Combo</a></li>
<li><a href="../id437932/index.html">Intel Optane Memory H10: Optane Cache + QLC 3D NAND</a></li>
<li><a href="../id437934/index.html">Manajemen waktu dalam kehidupan nyata</a></li>
<li><a href="../id437938/index.html">Dua Belas Cara untuk Memahami Bahwa Anda Berada dalam Realitas Virtual</a></li>
<li><a href="../id437940/index.html">GitHub lain: Repositori pada Ilmu Data, Visualisasi Data dan Pembelajaran Jauh</a></li>
<li><a href="../id437942/index.html">Apa yang baru di Swift 5?</a></li>
<li><a href="../id437944/index.html">Matematika kulit: epidermis tumbuh berdasarkan pemodelan matematika</a></li>
<li><a href="../id437946/index.html">Akun Admin@kremlin.ru ditemukan di ribuan database MongoDB</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>