<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõåüèæ ‚õ≤Ô∏è üë©üèº 1. An√°lisis de registro de Check Point: la aplicaci√≥n oficial de Check Point para Splunk üñïüèæ üë®‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë® üñïüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cuando se trabaja con las puertas de enlace de seguridad de Check Point, con frecuencia surge la tarea de analizar registros para detectar y analizar ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>1. An√°lisis de registro de Check Point: la aplicaci√≥n oficial de Check Point para Splunk</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/431146/"><img src="https://habrastorage.org/webt/bq/gl/8f/bqgl8fhc3r4o-hr5aox1vkwq-ou.png"><br><br>  Cuando se trabaja con las puertas de enlace de seguridad de Check Point, con frecuencia surge la tarea de analizar registros para detectar y analizar incidentes de seguridad de la informaci√≥n.  Por lo general, las organizaciones ya tienen alg√∫n tipo de sistema de registro, y la tarea es transportar registros desde el servidor de administraci√≥n de Check Point y luego configurar filtros para registros, elaborar paneles, calendarios, etc.  En este curso, consideraremos varias opciones para analizar los registros de Check Point utilizando la funcionalidad interna y las aplicaciones de terceros, consideraremos qu√© informaci√≥n √∫til podemos extraer y c√≥mo ayudar√° a configurar el firewall. <br><a name="habracut"></a><br>  Como parte de los productos de Check Point, la funcionalidad SmartEvent es responsable de esto, lo que generar√° informes sobre plantillas. Tambi√©n puede configurar un conjunto limitado de acciones autom√°ticas, pero no se trata de eso ahora, volveremos a este problema m√°s adelante.  Tambi√©n hay otras soluciones a este problema, que se discutieron en nuestros otros art√≠culos: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Splunk + Check Point, un ejemplo de an√°lisis de los registros de su firewall</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Punto de verificaci√≥n Evento inteligente.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mini guia</a> </li></ul><br>  La configuraci√≥n de todas las soluciones anteriores requiere una cierta calificaci√≥n y mucho tiempo para la implementaci√≥n.  ¬øQu√© pasa si necesita una soluci√≥n aqu√≠ y ahora?  Check Point lanz√≥ recientemente una aplicaci√≥n que es ideal para este caso: la aplicaci√≥n Check Point para Splunk, para la cual los datos se env√≠an a trav√©s de syslog utilizando la herramienta de exportaci√≥n de registros en tiempo real al sistema de registro Splunk.  En este art√≠culo, consideraremos en detalle esta soluci√≥n, instalaci√≥n y la informaci√≥n que obtenemos en el resultado. <br><br><h3>  <b>Requisitos de instalaci√≥n</b> </h3><br>  El servidor de administraci√≥n de Check Point requiere la herramienta instalada Exportador de registros para enviar registros utilizando el protocolo syslog.  En la versi√≥n GAIA R80.20, Log Exporter se instala de manera predeterminada, pero para admitir el formato de registro Splunk, debe instalar Jumbo Hotfix, en otras versiones, antes de instalar Log Exporter, primero debe instalarlo para admitir Jumbo Hotfix. <br>  Todos los requisitos para la versi√≥n de la revisi√≥n se indican a continuaci√≥n: <br><br><ol><li>  R80.20 - Jumbo Hotfix Take 5 o superior; </li><li>  R80.10 - Jumbo Hotfix Take 56 o superior; </li><li>  R77.30 - Jumbo Hotfix Tome 292 o superior. </li></ol><br>  Para que la aplicaci√≥n funcione, la versi√≥n m√≠nima del sistema debe ser al menos Splunk 6.5, tambi√©n se debe instalar el paquete del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Modelo de informaci√≥n com√∫n (CIM) de Splunk</a> . <br><br><h3>  <b>Instalaci√≥n y lanzamiento</b> </h3><br>  El proceso de instalaci√≥n es bastante trivial, primero instalamos Log Exporter, luego la aplicaci√≥n en Splunk, configuramos el proceso de env√≠o de registros al servidor de administraci√≥n y el proceso de aceptaci√≥n en el sistema de registro, y para el punto final comenzamos el env√≠o de registros, verificamos que todo funcione como se esperaba.  Considere todos los puntos con m√°s detalle. <br><br>  <b>1.Instalaci√≥n de Jumbo Hotfix seg√∫n sea necesario.</b> <br>  Entramos al portal GAIA en un navegador web, en el men√∫ de la izquierda Actualizaciones (CPUSE), Estado y Acciones, seleccionamos el paquete de Hotfix Jumbo recomendado, que obviamente ser√° m√°s alto que el umbral inferior en requisitos, o buscamos la versi√≥n deseada en Agregar Hotfix desde la nube, instalar , el proceso requerir√° un reinicio del servidor de administraci√≥n. <br><br>  <b>2. Instale Log Exporter si su versi√≥n de Check Point es inferior a R80.20.</b> <br>  Para instalar Log Exporter en la administraci√≥n, primero descargue el archivo del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">portal Check Point</a> . <br><br><img src="https://habrastorage.org/webt/14/xo/xv/14xoxvdmuob7dmrpeyh-g6ro7om.png"><br><br>  Luego, nuevamente, vaya al men√∫ CPUSE-&gt; Estado y acciones, seleccione Importar paquete, especifique la ruta al archivo, importe.  Despu√©s de eso, cambie la visualizaci√≥n de los paquetes de Mostrar paquetes recomendados a Mostrar todos los paquetes, seleccione el archivo importado e inst√°lelo. <br><br>  <b>3. Instale CIM si no se instal√≥ antes.</b> <br>  Vaya a Splunk WebUI, busque el paquete CIM en Administrar aplicaciones -&gt; Buscar m√°s aplicaciones, inst√°lelo. <br><br><img src="https://habrastorage.org/webt/rq/qm/kf/rqqmkfbyxpzo2mwjjajbsohngre.png"><br><br>  <b>4.Instale la aplicaci√≥n Check Point para Splunk</b> <br>  Descargue el archivo del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">portal</a> , luego vaya a Splunk WebUI, Administre aplicaciones, Instale la aplicaci√≥n desde el archivo, seleccione el archivo deseado, haga clic en cargar.  Estamos esperando la notificaci√≥n de la operaci√≥n exitosa, aseg√∫rese de que la aplicaci√≥n est√© ahora visible en la lista de aplicaciones. <br><br><img src="https://habrastorage.org/webt/t7/dd/vo/t7ddvo5g4c5dqzuunqyyxwm0w8a.png"><br><br>  Esto deber√≠a parecerse a la aplicaci√≥n instalada, por supuesto, entre otras aplicaciones: <br><br><img src="https://habrastorage.org/webt/hs/iy/y0/hsiyy0qqcvjxqhqss9pg96pi7a4.png"><br><br>  Para enviar registros a trav√©s de syslog, primero debe crear el proceso Exportador de registros, luego configurar la entrada de datos en Splunk e iniciar el proceso creado en el servidor de administraci√≥n de Check Point. <br><br>  <b>5. Configurar el exportador de registros</b> <br>  En el servidor de administraci√≥n de Check Point en la CLI, en el modo experto, ejecute el comando: <br>  cp_log_export add name [servidor de dominio &lt;servidor de dominio&gt;] servidor de destino &lt;servidor de destino&gt; puerto de destino &lt;puerto de destino&gt; protocolo &lt;tcp |  udp&gt; formato splunk read-mode &lt;raw |  semi-unificado&gt; <br>  donde es el nombre de la configuraci√≥n, &lt;target-server&gt; es la direcci√≥n IP del sistema Splunk al que enviamos los datos, &lt;target-port&gt; es el puerto al que enviamos los datos. <br>  Ejemplo: cp_log_export add name check_point_syslog target-server 10.10.1.159 target-port 9000 protocol tcp format splunk read-mode semi-unified <br><br>  <b>6. Configurar la entrada de datos en Splunk</b> <br>  Vaya a Splunk WebUI, seleccione Configuraci√≥n en el men√∫, seleccione Entradas de datos en la secci√≥n Datos. <br><img src="https://habrastorage.org/webt/9j/-g/do/9j-gdoyfjdfes3plbidjrupnzmw.png"><br>  Seleccionamos el protocolo por el cual los datos ir√°n a Splunk, en este ejemplo tcp, seleccione + Agregar nuevo. <br><br><img src="https://habrastorage.org/webt/je/99/gt/je99gt6ztojek43mp95-soczzx4.png"><br><br>  Luego, ingrese el puerto &lt;target-port&gt;, que se especific√≥ en Log Exporter, en este caso 9000, puede especificar adicionalmente desde qu√© direcci√≥n IP aceptar conexiones, luego espere el bot√≥n Siguiente. <br><br><img src="https://habrastorage.org/webt/ah/5r/vq/ah5rvqiqseck0vnig3k0qgq2u_u.png"><br><br>  En el tipo de fuente, especifique cp_log, m√©todo: IP, el √≠ndice se puede dejar como predeterminado, todos los datos ir√°n a index = Main y si tiene otros datos para este √≠ndice, el tiempo de b√∫squeda puede aumentar significativamente, puede especificar un √≠ndice diferente o crear uno nuevo, y luego en la propia aplicaci√≥n, debe especificar directamente en qu√© √≠ndice realizar las operaciones de b√∫squeda. <br><img src="https://habrastorage.org/webt/vk/50/9b/vk509b8nlj3bzibmhei3ypbe1g8.png"><br>  Despu√©s de hacer clic en Revisar, veremos que todas las configuraciones son verdaderas, seleccione Enviar, la configuraci√≥n de Entradas de datos est√° completa, solo necesita enviar los registros desde el servidor de administraci√≥n de Check Point. <br><br>  <b>7. Comenzamos el proceso de subir registros a Splunk</b> <br>  En el modo experto, ingrese el comando: <br>  nombre de reinicio de cp_log_export, donde est√° el nombre de configuraci√≥n creado en el primer paso <br>  Ejemplo: cp_log_export restart reiniciar check_point_syslog <br>  La configuraci√≥n ha finalizado, despu√©s de eso solo queda asegurarse de que los registros se env√≠en a Splunk, utilizando los mecanismos de consulta de b√∫squeda est√°ndar para Splunk. <br><br><img src="https://habrastorage.org/webt/ma/jo/sb/majosbg53muvbjt5m3hskshscaa.png"><br><br>  Ahora puede pasar a analizar el funcionamiento de la aplicaci√≥n en s√≠, qu√© paneles e informes contiene, qu√© informaci√≥n importante se puede obtener y qu√© conclusiones se pueden extraer. <br><br><h3>  <b>An√°lisis de registro</b> </h3><br>  La aplicaci√≥n se divide en 2 secciones: Descripci√≥n general y Protecci√≥n de prevenci√≥n de amenazas, que a su vez se divide en Descripci√≥n general de ataque cibern√©tico, Protecci√≥n contra chorro de arena y Eventos adicionales de prevenci√≥n de amenazas.  Consideramos cada secci√≥n por separado. <br><br>  <b>Resumen general</b> <br><br><img src="https://habrastorage.org/webt/lh/qx/dt/lhqxdtflctlgbgvjr__psy5lj7c.png"><br><br>  La p√°gina principal de la aplicaci√≥n presenta varias tablas, estad√≠sticas y gr√°ficos.  Parte de la informaci√≥n en este caso es b√°sica, como la cantidad de puertas de enlace y servidores de administraci√≥n, o la cantidad de registros en los blades, lo m√°s probable es que no aprenda nada nuevo y, seg√∫n esta informaci√≥n, se pueden sacar conclusiones que tendr√°n un efecto positivo. <br>  Desde mi punto de vista, los elementos m√°s interesantes aqu√≠ son Tipos de ataque cr√≠tico, Ataques cr√≠ticos permitidos por la pol√≠tica, Hosts infectados, Aplicaciones permitidas de alto riesgo, explicar√© por qu√©. <br>  Seg√∫n los tipos de ataque cr√≠tico, los ataques cr√≠ticos permitidos por la pol√≠tica pueden mejorar la pol√≠tica de seguridad de prevenci√≥n de amenazas (al mover acciones de detecci√≥n para prevenir mediante firmas espec√≠ficas o al aumentar el nivel de respuesta), lo que aumenta el nivel de seguridad para proteger contra amenazas de virus, intentos de introducir y piratear su computadora. infraestructura  Hosts infectados indica aquellos usuarios que pueden estar infectados y, en consecuencia, deben ser verificados por separado por antivirus o aislados de la red, evitando que el virus pase a trav√©s de la red de la organizaci√≥n.  Seg√∫n el diagrama de aplicaciones permitidas de alto riesgo, puede bloquear las aplicaciones potencialmente peligrosas m√°s visitadas que actualmente est√°n permitidas para que los usuarios bloqueen. <br>  Los diagramas Aplicaciones y filtrado de URL por riesgo, incidentes de seguridad por gravedad y acciones de ataque por pol√≠tica son de naturaleza sistem√°tica e indican si el estado de seguridad en su organizaci√≥n mejora con el tiempo, es decir, si los cambios realizados en la pol√≠tica de seguridad ayudaron a proteger m√°s la infraestructura. <br><br>  <b>Descripci√≥n general del ataque cibern√©tico</b> <br><br><img src="https://habrastorage.org/webt/al/qz/kj/alqzkjrz65gjhfsekfnrfew0pde.png"><br><br><img src="https://habrastorage.org/webt/34/vd/ae/34vdae6rpbgtnp6sg6vmjh5tzuk.png"><br><br><img src="https://habrastorage.org/webt/mi/-d/rt/mi-drtnm-zab4dofjx240gyaaua.png"><br><br>  Este panel muestra informaci√≥n m√°s detallada sobre hosts infectados y sobre usuarios que descargan virus.  Es muy conveniente separar por archivos infectados descargados y por mensajes infectados, puede identificar amenazas y crear una pol√≠tica de seguridad de Prevenci√≥n de amenazas para servicios individuales, un perfil de seguridad para tr√°fico smtp y otro perfil para http y https.  SandBlast Protection proporciona informaci√≥n m√°s detallada sobre archivos infectados, puede ver la gravedad e identificar las deficiencias de su perfil de seguridad en Prevenci√≥n de amenazas. <br><br><h3>  <b>Conclusi√≥n</b> </h3><br>  Gracias a esta aplicaci√≥n, es muy r√°pido y conveniente obtener informaci√≥n sobre puntos d√©biles en su pol√≠tica de seguridad, configurar la aplicaci√≥n lleva un poco de tiempo y no requiere mucha habilidad en estas soluciones.  Es decir, si duda de su configuraci√≥n de seguridad y necesita un an√°lisis sin mucho tiempo, entonces esta es una soluci√≥n muy conveniente.  Sin embargo, est√° claro que la aplicaci√≥n a√∫n necesita serias mejoras, no hay estad√≠sticas sobre los usuarios, es muy interesante ver una lista de las aplicaciones m√°s utilizadas y la cantidad de tr√°fico que va all√≠, etc.  Como esta es solo la primera versi√≥n, la aplicaci√≥n se actualizar√°, y lo m√°s probable es que sea una muy buena soluci√≥n de an√°lisis con el tiempo, pero ahora si consideramos esta aplicaci√≥n solo como un an√°lisis de registro, entonces es muy inferior a otras soluciones.  En art√≠culos posteriores, consideraremos y compararemos las capacidades de SmartEvent y otras aplicaciones de Splunk para analizar los registros de Check Point, incluida la aplicaci√≥n creada por nuestros ingenieros. <br><br>  Si no ha probado Splunk para analizar los registros de Check Point, entonces es hora de comenzar.  Si tiene preguntas o problemas con Splunk o Check Point, puede preguntarnos y le ayudaremos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es431146/">https://habr.com/ru/post/es431146/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es431136/index.html">Terabytes sin peso en el bolsillo: ¬øest√° el futuro aqu√≠? Explorando las caracter√≠sticas de HyperX SAVAGE EXO</a></li>
<li><a href="../es431138/index.html">Biometr√≠a con la clave Rostelecom: c√≥mo el FSB lanz√≥ por primera vez la criptograf√≠a rusa en las tiendas de aplicaciones</a></li>
<li><a href="../es431140/index.html">Informe de la metapa de Go in Production: video, fotos, presentaciones</a></li>
<li><a href="../es431142/index.html">¬øC√≥mo ejecutar SQL Profiler Trace en la noche, a una hora espec√≠fica?</a></li>
<li><a href="../es431144/index.html">Micr√≥fono Far Fields (matriz de micr√≥fonos): h√©roe discreto en una columna inteligente</a></li>
<li><a href="../es431148/index.html">El nuevo iOS Mobile Enterprise. Parte # 1: Generaci√≥n de c√≥digo para recursos</a></li>
<li><a href="../es431152/index.html">Metro 4 es un viaje de 6 a√±os. Una breve historia de Metro UI CSS</a></li>
<li><a href="../es431154/index.html">Las deficiencias en las misiones de Fallout 76 permitieron a los jugadores hacer un infierno nuclear</a></li>
<li><a href="../es431156/index.html">SHOCK! Nuevo software de phishing gana segundo factor</a></li>
<li><a href="../es431158/index.html">M√°s caf√©, menos cafe√≠na: Intel 9th ‚Äã‚ÄãGen (parte 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>