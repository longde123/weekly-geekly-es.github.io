<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🚀 👐🏻 💑 搜索的工作方式 👂🏼 👩🏽‍🤝‍👨🏿 🛌🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="嗨，用户名！ 每天我们都面临着各种数据的搜索。 现在，几乎每个包含大量信息的网站都可以进行搜索。 搜索可以在家用计算机，手机，各种软件中进行。 当然，如果您向任何开发人员询问技术方面的搜索，elasticsearch，lucene或sphinx都会立即浮现。 今天，我想与您一起进行全文搜索的“内幕”...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>搜索的工作方式</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hh/blog/413261/"> 嗨，用户名！ 每天我们都面临着各种数据的搜索。 现在，几乎每个包含大量信息的网站都可以进行搜索。 搜索可以在家用计算机，手机，各种软件中进行。 当然，如果您向任何开发人员询问技术方面的搜索，elasticsearch，lucene或sphinx都会立即浮现。 今天，我想与您一起进行全文搜索的“内幕”，并使用hh.ru的示例找出其工作原理的第一近似值。 <br><br><img src="https://habrastorage.org/webt/pn/cf/l7/pncfl7qsqbg5otgxyayrynymija.png" alt="图片"><br><a name="habracut"></a><br>  <i>免责声明：本文并不是唯一的真实观点，并且仅作为介绍文本搜索工作以及实现其各个部分的一些选择的入门点。</i> <br><br> 如果您查看搜索的详细信息，那么除了搜索字符串形式中的明显部分之外，您还可以看到更多内容： <br><br><ul><li> 提示（她建议） </li><li> 搜索结果计数器（counter）， </li><li> 各种类型的排序（sort）， </li><li> 构面-文档的分组特征，例如空缺所在的地铁，还执行过滤器（过滤器）的功能， </li><li> 同义词 </li><li> 分页 </li><li>摘录（snippet）-发行中文档的简短描述， </li><li> 等 </li></ul><br><img src="https://habrastorage.org/webt/bl/hy/so/blhyso9n80pgxke6lh-rggoft74.jpeg" alt="图片"><br><br> 而所有这一切都有一个目的-满足用户对尽快找到正确信息的需求。 例如，过滤对于缩小搜索结果的范围很重要，在我们的情况下，它可能是按候选人的经历，位置或职业进行过滤的过滤条件。 构面有助于显示每个薪金范围中的职位空缺。 用同义词补充查询和文档也很重要，这样，在“ java开发人员”的请求下，他们可以找到“ java开发人员”文档。 <br><br> 除了搜索本身之外，总是有很多组件可以使用户的生活变得更轻松：负责纠正错误的监护人，或者与搜索栏交互时会提示更合适查询的最敏感的人。 在某些情况下，重新制定请求很重要。 例如，将请求的一部分移至过滤器：可以从城市中将“莫斯科程序员”请求中的莫斯科取出到过滤器中。 <br><br><h3>  1.基本 </h3><br> 现在到了重点。 搜索本身分为两个大阶段： <br><br><ul><li> 索引（处理文档并根据特殊的索引结构对其进行布局，以便您随后可以快速执行搜索本身）， </li><li> 搜索（应用过滤器，布尔搜索，排名等）。 </li></ul><br><h3>  1.1。 索引编制 </h3><br> 轻微的抒情偏离。 此外，我将介绍术语的概念-因为习惯上称呼索引和查询的最小单位。 这是将存储在索引字典中的单位。 它可以是简化为正常单词形式或基数，数字，电子邮件，字母n-gram或其他形式的单词。 通常，术语包括对其进行索引或在其中进行搜索的字段。 <br><br> 首先，您需要将输入文档变成一组术语并过滤掉停用词。 它们就像是经常出现的单词-介词，连词，感叹词和其他事物，例如我们不想搜索的特殊字符。 为了使搜索使用不同的单词形式，在索引过程中，我们通常会将所有单词带入某种基本状态。 通常使用以下两种程序之一：词干-隔离单词基础的过程（开发-&gt;开发），或词根化-将单词恢复为正常形式的过程（技能-&gt;技能）。 <br><br><h3>  1.2索引结构 </h3><br> 表示索引的最流行方法是倒排索引。 实际上，这是一种哈希表，其中的键是术语，而值是其中存在该术语的文档列表（通常是称为发帖列表的文档ID列表）。 通常，倒排索引由两部分组成-词典（术语词典）和每个术语的文档列表（发布列表）： <br><br><img src="https://habrastorage.org/webt/k1/zf/te/k1zftetx905m-wguaytcovdbx-i.png" alt="图片"><br><br> 此外，索引可能包含有关文档中术语位置的信息（位置索引），当在一定距离（尤其是短语查询）中搜索术语时，这对术语频率很有用，这将有助于排名和构建查询计划。 但是下面有更多内容。 <br><br><h3>  1.2.1术语词典 </h3><br> 该词典存储索引中存在的所有术语，旨在快速查找到文档列表的链接。 有几种存储词典的选项： <br><br><ul><li> 哈希表，其中术语是关键字，值是指向该术语文档列表的链接。 </li><li> 您可以通过二进制搜索进行搜索的有序列表。 </li><li> 前缀树（trie）。 </li></ul><br> 最佳方法是最后一个选择，因为 它有几个优点。 首先，在大量术语上，前缀树将占用更少的内存，因为前缀的重复部分将仅存储一次。 其次，我们立即有机会提出前缀请求。 第三，可以通过组合非分支部分来压缩这样的树。 <br><br><img src="https://habrastorage.org/webt/lx/zn/1z/lxzn1zanyrwmc_cxbwvl6qv3bie.png" alt="图片"><br><br> 当然，前缀树可能不是唯一的用于在索引中存储术语的结构。 例如，后缀树也可能在附近，这反过来对于具有小丑的查询（形式为po * sql的查询）将更为最佳。 <br><br><h3>  1.2.2发布清单 </h3><br> 文档列表是文档标识符的有序列表，允许对其进行一些优化。 通常，它不仅自身存储该词出现的文档列表，而且还存储该词出现的位置（张贴）。 这可以立即解决多个问题：我们立即知道一个单词在文档中出现了多少次，我们可以在术语之间以一定距离进行短语和查询，一次越过多个文档列表并查看术语的位置。 <br><br><img src="https://habrastorage.org/webt/7-/1v/lv/7-1vlvh3ycm7xm6kxlcu-stygos.png" alt="图片"><br><br> 例如，在该列表中， <b>标题</b>为第6个文档中的术语<b>scala</b> ，该单词出现4次，分别位于位置2、15、18和25。 <br><br><h3>  1.2.3具有多个字段的文档 </h3><br> 大多数文档至少由文档名称及其主体组成，由多个字段组成。 这在搜索文档的各个部分时以及排序时该术语显着时（例如，可以将标题中出现的术语视为更重要）会有所帮助。 <br><br> 另外，在索引中，通常不仅可以存储文本字段，还可以存储文档的符号，一些数值等，索引中的存储通常采用{field-term}的形式。 <br><br><img src="https://habrastorage.org/webt/hk/zt/kq/hkztkq81x0tcc_twzuj_93qha34.png" alt="图片"><br><br> 例如，如果您有空缺，那么它将同时具有多个字段：名称，描述，公司，薪资，城市和必要的经验。 这是必要的，以便用户不仅可以方便地按公司的名称和文字进行搜索，还可以按薪水和工作经验进行过滤，查看所在城市和邻近城市有多少空缺职位，甚至可以搜索特定公司的空缺职位。 <br><br><h3>  1.3索引压缩与优化 </h3><br> 工作速度对于搜索很重要，因此，大多数索引搜索操作通常在RAM中执行。 为此，对索引进行多种优化非常重要，这将使其适合有限的内存大小。 除此之外，通常还会应用许多优化，这些优化使您可以在搜索时以更高的速度移动索引，从而跳过不必要的部分。 <br><br><h3>  1.3.1增量压缩 </h3><br> 由于我们记得按术语排列的文档列表（也称为发布列表）是有序的，因此如何压缩它的第一个想法是制作一个ID偏移量的列表，而不是相对于先前文档具有ID的列表。 在6个标识符的特定列表上，它看起来像这样： <br><br><img src="https://habrastorage.org/webt/xo/oe/ww/xooewwppo3g9vpm8wj3wxnmudyw.png" alt="图片"><br><br> 因此，在列表中移动时，我们将始终根据先前获得的值来计算当前标识符。 例如，对于第二个偏移量3，我们将第一个值2加到ID 5，将第三个值4加5，得到9依此类推。 对于大量文档，此方法非常有效，特别是与另一种压缩方法（记录可变格式数字）结合使用时。 <br><br><h3>  1.3.2 VarByte和VarInt </h3><br> 这是一种将每个单独的列表项存储在内存中的方法，以便占用最少的空间。 例如，如果前三个偏移量仅适合1个字节，则无需占用更多空间。 考虑到我们的列表不包含id文档，而是delta，压缩将非常有效。 在此数字表示中，每个字节的第一位是标志，指示当前数字的表示是否在此字节上结束。 <br><br><img src="https://habrastorage.org/webt/xv/xq/xy/xvxqxy_wswvxsehxyy3heca4csg.png" alt="图片"><br><br> 如果字节0的第一位是数字的最后一个字节，如果1不是。 <br><br><h3>  1.3.3跳转列表/跳转表 </h3><br> 跳过列表是一种用于快速浏览特定术语的文档列表，跳过列表中不必要部分的结构之一。 这个想法是在列表本身的前面在磁盘上存储到列表中远方元素的链接，因为压缩后我们无法说出100或200文档的确切位置。 例如，当查询两个词时，这很方便，其中一个词经常出现，而第二个词则很少，相反，文件列表仅以第200个文件ID开头。 然后，如果在第一个列表中有一个带有通行证的列表，我们可以节省移动时间并立即跳过不必要的标识符块。 <br><br><img src="https://habrastorage.org/webt/59/8w/cf/598wcfm9ouioywtepy1tueyern8.png" alt="图片"><br><br><h3>  1.4要求 </h3><br><h3>  1.4.0词条查询 </h3><br> 最简单的请求类型，我们只需要查找适当的文档列表并按排名排序即可发布文档。 <br> 例如，通过这种方式，我们找到了<b>java</b>的职位列表： <br><br><img src="https://habrastorage.org/webt/fv/uv/l7/fvuvl7xxpopw0klzphutaijdbje.png" alt="图片"><br><br><h3>  1.4.1布尔查询（与非） </h3><br> 在我们到处可见的信息检索中，布尔搜索是最重要的部分之一。 整个布尔搜索基于AND，OR和NOT的组合。 例如，当我们用两个词搜索查询： <b>java android时</b> ，实际上，通过简单的搜索，它将转换为<b>java AND android</b> 。 这意味着我们要查找包含两个单词的所有文档。 <br><br> 值得一提的是您如何在文档列表中移动。 由于每个术语的文档列表都是经过排序的，因此通常有两种方法可以遍历列表：依次遍历文档，逐个传递文档或直接移至特定文档，跳过不需要的文档（例如，当第一个列表小得多时） ，我们不需要浏览第二个列表中的大量文档）。 在这种情况下，我们首先使用第二个列表的跳过指针中的指针，使其尽可能靠近所需的文档ID，然后线性移动。 <br><br> 在搜索时，会发生以下情况：在java和android术语的索引中是文档列表，然后在它们上进行交集-也就是说，我们找到包含这两个术语的文档。 通过此搜索，可以使用两种遍历列表的方法来更快地穿越。 <br><br><img src="https://habrastorage.org/webt/ug/jl/rf/ugjlrfbdm4vo7bv0xxsfx7nuapg.png" alt="图片"><br><br> 对于形式为Java OR scala的OR查询，我们需要查找包含至少一个术语的所有文档，情况就有所不同-在这里，我们不需要将该术语一次出现在所有文档列表中。 但是有些查询带有多个OR运算符，那么可能会出现最小匹配数的条件，例如，可能存在一个Java OR scala OR cotlin OR clojure查询，其中至少有两个匹配项，然后我们应该显示所有包含至少两个查询词的文档。 <br><br> 在这种情况下，堆的工作效率最高。 我们可以在其中存储指向每个列表的迭代器的链接，并获取恒定时间的最小元素。 取最小元素之后，我们从堆中删除迭代器，向前迈出一步，然后将其再次添加到堆中。 您可以分别存储要添加到结果和计数器中的当前候选者，他满足的次数以及当候选者与堆中的最小元素不同的那一刻，看看是否在操作中忽略了最小匹配项。 然后将其添加到结果的最终列表中，或者丢弃该文档。 <br><br><img src="https://habrastorage.org/webt/mn/o9/px/mno9pxfv5n91v7ilooaln719_s0.png" alt="图片"><br><br><h3>  1.4.2前缀/小丑 </h3><br> 有时我们想查找所有包含以特定前缀开头的单词的文档。 在这种情况下，前缀请求将为我们提供帮助，其外观类似于<b>jav *</b> 。 当在前缀树上实现字典时，前缀请求非常有效，然后我们进入前缀的嵌套并接受下面的所有术语。 <br><br><h3>  1.4.3短语查询和接近查询 </h3><br> 有时候，您需要查找整个短语，例如“ java developer”，或者找到两个单词之间的单词，例如“ java”和“ developer”，而两个单词之间的单词不超过两个，以便您可以找到包含java android kotlin开发人员的文档。 为此，另外使用每个文档中的单词位置列表。 <br><br><img src="https://habrastorage.org/webt/s_/aa/x8/s_aax8ar79jyhyk87misztsg57s.png" alt="图片"><br><br> 跨越文档列表时，所有操作都与AND操作相同。 但是，在两个列表中都找到该文档之后，还要进行另一次检查-根据位置（位置）的差异，这些术语彼此之间的距离正确。 <br><br><h3>  1.4.4请求计划 </h3><br> 通常，在执行请求本身之前，先构建其计划。 发生这种情况是为了优化请求的执行并进行优化，例如省略文档列表的列表起作用。 <br><br> 优化查询的最简单方法是按照文件大小的增加顺序遍历文档列表。 因此，我们不会浪费大量文档，而不是浪费在较小列表中。 <br><br> 例如，让我们解析<b>android AND java AND sql query</b> 。 假设android列表中有10个文档，在sql-20和java-100中。在这种情况下，最好先越过最小的列表，并且优化后的查询将看起来像<b>（android AND sql）AND java</b> 。 <br><br> 对于OR，最简单的方法是将相交处的文档数计算为两个可能相交的列表的总和。 <br><br><h3>  1.4.5查询扩展-同义词 </h3><br> 除了用户在搜索栏中输入的内容外，通常搜索还会尝试扩展查询本身以查找更多相关文档。 可以使用很多来扩展搜索：用户的查询历史记录，有关他的一些个性化数据等等。 但是除此之外，还有一种扩展请求的通用方法-同义词。 <br><br> 在这种情况下，将文档写入索引时，该术语在同义词词典中被替换为“链接”： <br><br><img src="https://habrastorage.org/webt/ej/cy/_m/ejcy_m-mukw_j8qjmnqoy-qreb8.png" alt="图片"><br><br> 转换请求时也会发生同样的事情。 例如，当我们请求<b>销售经理时</b> ，请求实际上看起来像： <br><br><img src="https://habrastorage.org/webt/_z/pp/oo/_zppoo52_gvvdyytz3bsxldxmrc.png" alt="图片"><br><br> 因此，在回复中，我们不仅会收到包含销售经理的文档，还会收到包含销售代理和销售的文档。 <br><br><h3>  1.5过滤 </h3><br><h3>  1.5.1快速范围滤波器 </h3><br> 有时我们希望通过一系列值来过滤某些内容，例如，根据多年的经验。 假设我们想找到所有需要3到11年经验的职位空缺。 第一个决定是使用范围内的所有选项发出请求，并通过OR进行组合。 但是问题在于可能有太多的值。 解决此问题的一种方法是一次以多种精度记录值： <br><br><img src="https://habrastorage.org/webt/ti/2j/nm/ti2jnmqh8bvj2xoq6by86agw2-q.png" alt="图片"><br><br> 在这种情况下，我们将存储5个精度值：一年（我们将其视为初始值），两个，四个，八个和十六个。 <br><br> 然后，在记录时将发生以下情况：例如，当记录需要6年经验的文档时，我们会立即以所有准确性记录该值： <br><br><img src="https://habrastorage.org/webt/g8/so/l0/g8sol0rss7iadolb1-xqxy2e7pm.png" alt="图片"><br><br> 当过滤“从3年到11年”时，会发生以下情况：我们仅选择所需精度的值，而只得到3个值而不是8个值，并得到查询<b>（实际值== 3）OR（精度4 == 4）OR（精度4 == 8）</b> <br><br><img src="https://habrastorage.org/webt/4v/7u/bq/4v7ubqnlcqa9scgl7tq17m7b8ai.png" alt="图片"><br><br><h3>  1.5.2位掩码 </h3><br> 位掩码是索引的组成部分。 最重要的用途是过滤已删除的文档。 当您从索引中删除文档时，不会立即发生物理删除。 索引旁边写有一个特殊的结构，其中每个位都表示索引中文档的ID，删除后，该位将升高一个位，并且在搜索时，这些文档将被过滤且不会落入输出。 <br><br> 您还可以使用位掩码为每个用户设置某些文档的权限，并缓存各个常用的过滤器。 然后，通常将位掩码与索引分开存储。 <br><br> 例如，我们有流行的过滤条件：莫斯科市，只有部分时间，没有工作经验。 然后，在请求之前，我们可以为这些文档获取已保存的位掩码，添加它们，并获得最终的位掩码-哪些文档经过所有这三个过滤器，从而节省了过滤时间。 <br><br><img src="https://habrastorage.org/webt/cg/g7/cm/cgg7cmb42j_ugjkcna4fqyi2bqu.png" alt="图片"><br><br><h3>  2.排名 </h3><br> 我们记得，搜索的主要任务是在最短的时间内获得最相关的信息。 在此之后，通过文本查询过滤文档并应用了必要的过滤器和权限后，我们将获得文档排名的帮助。 <br><br> 最简单，最便宜的排名方法是按日期对文档进行排序。 在某些系统中，这是以前进行的，例如在新闻或房地产公告中，因此首先向用户显示了最新文档。 <br><br> 有时，可以使用基于文档中找到的单词数的排名模型，例如，在文档数量不多的情况下，并且我们希望查找其中至少找到一个查询单词的所有文档。 在这种情况下，那些找到查询中所有单词或更多单词的文档将更加相关。 <br><br> 当然，目前，这些方法已经无关紧要，它们很可能归因于问题的历史。 <br><br><h3>  2.1 TF-IDF </h3><br>  TF-IDF（术语频率-文档反向频率）是最基本和最常用的排名公式之一。 公式的本质是减少在各处使用的术语（例如介词和插入词），并制作更有意义的稀有术语，从而从查询中显示带有稀有和有意义的术语的第一份文档。 现在让我们将公式分成几部分： <br><br>  <b>TF（术语频率）</b>是文档中出现的术语的频率。 它的计算很简单： <br><br>  <i>TF术语“ java” =文档中术语“ java”的数量/文档中所有术语的数量</i> <i><br></i> <br>  <b>IDF（反文档频率）</b> -单词在文档集合中出现的频率的倒数。 帮助减轻常用单词的权重。 <br><br>  <i>IDF（`java`）=日志（集合中的文档数/出现Java术语的文档数）</i> <br><br> 此外，要获得术语java的TF-IDF，我们只需要将获得的TF和IDF值相乘即可。    ,     ,          .     , ,  developer       ,     ,    java developer       . <br><br><h3> 2.2   </h3><br>      ,      ,    .        ,     ,    ,     . <br><br><h3> 2.3 BM25  BM* </h3><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BM25</a> (Okapi best match 25)      TF-IDF         .     BM25F,             (    ). <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>B</mi><mi mathvariant=&quot;normal&quot;>M</mi><mn>25</mn></mrow><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>w</mi></munderover><mfrac><mrow><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x22C5;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>T</mi><mi mathvariant=&quot;normal&quot;>F</mi></mrow><mi>i</mi></msub><mo>&amp;#x22C5;</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>D</mi><mi mathvariant=&quot;normal&quot;>F</mi></mrow><mi>i</mi></msub></mrow><mrow><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>T</mi><mi mathvariant=&quot;normal&quot;>F</mi></mrow><mi>i</mi></msub><mo>+</mo><mi>k</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>b</mi><mo>+</mo><mi>b</mi><mfrac><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>D</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow><mrow><mi>a</mi><mi>v</mi><mi>g</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>D</mi><mi mathvariant=&quot;normal&quot;>L</mi></mrow></mrow></mfrac><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac><mspace linebreak=&quot;newline&quot; /><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>I</mi><mi mathvariant=&quot;normal&quot;>D</mi><mi mathvariant=&quot;normal&quot;>F</mi></mrow><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>g</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mfrac><mrow><mi>N</mi><mo>&amp;#x2212;</mo><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></mfrac><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;normal&quot;>l</mi><mi mathvariant=&quot;normal&quot;>o</mi><mi mathvariant=&quot;normal&quot;>g</mi></mrow><mi>N</mi></mrow></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="14.467ex" viewBox="0 -1662 33095.6 6228.9" role="img" focusable="false" style="vertical-align: -10.607ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(8356,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-42" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-4D" x="708" y="0"></use><g transform="translate(1626,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-32"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-35" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-3D" x="2904" y="0"></use><g transform="translate(3961,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJSZ2-2211" x="0" y="0"></use><g transform="translate(147,-1090)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-31" x="1124" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-77" x="663" y="1627"></use></g><g transform="translate(5405,0)"><g transform="translate(286,0)"><rect stroke="none" width="10569" height="60" x="0" y="220"></rect><g transform="translate(1127,720)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-2B" x="1112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-6B" x="2112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-29" x="2634" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-22C5" x="3246" y="0"></use><g transform="translate(3746,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-46" x="722" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-69" x="1945" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-22C5" x="5689" y="0"></use><g transform="translate(6190,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-44" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-46" x="1126" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-69" x="2516" y="-213"></use></g></g><g transform="translate(60,-862)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-54" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-46" x="722" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-69" x="1945" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-2B" x="1942" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-6B" x="2943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-28" x="3464" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-31" x="3854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-2212" x="4576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-62" x="5577" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-2B" x="6229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-62" x="7230" y="0"></use><g transform="translate(7659,0)"><g transform="translate(120,0)"><rect stroke="none" width="2160" height="60" x="0" y="220"></rect><g transform="translate(588,407)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-4C" x="764" y="0"></use></g><g transform="translate(59,-391)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-76" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-67" x="1014" y="0"></use><g transform="translate(1057,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-44" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-4C" x="764" y="0"></use></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-29" x="10059" y="0"></use></g></g></g></g><g transform="translate(12175,-3602)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-44" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-46" x="1126" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-69" x="2516" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-3D" x="2401" y="0"></use><g transform="translate(3180,0)"><g transform="translate(397,0)"><rect stroke="none" width="5046" height="60" x="0" y="220"></rect><g transform="translate(60,823)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-67" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-28" x="1279" y="0"></use><g transform="translate(1669,0)"><g transform="translate(120,0)"><rect stroke="none" width="2627" height="60" x="0" y="220"></rect><g transform="translate(60,465)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-6E" x="1667" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-2B" x="2267" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-31" x="3046" y="0"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-6E" x="1557" y="-488"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-29" x="4536" y="0"></use></g><g transform="translate(1439,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-6F" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMAIN-67" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/hh/blog/413261/&amp;usg=ALkJrhgidLcVZuMYt8omwlsTHENV2niCAA#MJMATHI-4E" x="1279" y="0"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">B</mi><mi mathvariant="normal">M</mi><mn>25</mn></mrow><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>w</mi></munderover><mfrac><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>k</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">T</mi><mi mathvariant="normal">F</mi></mrow><mi>i</mi></msub><mo>⋅</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">I</mi><mi mathvariant="normal">D</mi><mi mathvariant="normal">F</mi></mrow><mi>i</mi></msub></mrow><mrow><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">T</mi><mi mathvariant="normal">F</mi></mrow><mi>i</mi></msub><mo>+</mo><mi>k</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>b</mi><mo>+</mo><mi>b</mi><mfrac><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">D</mi><mi mathvariant="normal">L</mi></mrow><mrow><mi>a</mi><mi>v</mi><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">D</mi><mi mathvariant="normal">L</mi></mrow></mrow></mfrac><mo stretchy="false">)</mo></mrow></mfrac><mspace linebreak="newline"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">I</mi><mi mathvariant="normal">D</mi><mi mathvariant="normal">F</mi></mrow><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi></mrow><mo stretchy="false">(</mo><mfrac><mrow><mi>N</mi><mo>−</mo><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mi>n</mi></mfrac><mo stretchy="false">)</mo></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi></mrow><mi>N</mi></mrow></mfrac></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1">\mathrm{BM25} = \sum_{i=1}^w \frac{(1 + k) \cdot \mathrm{TF}_i \cdot \mathrm{IDF}_i}{\mathrm{TF}_i + k(1 - b + b \frac{\mathrm{DL}}{avg\mathrm{DL}})} \\ \mathrm{IDF}_i = \frac{\mathrm{log} (\frac{N - n + 1}{n})}{\mathrm{log} N}</script></p><br><br><h3> 2.4    </h3><br>       , : <br><br><ul><li> DFR (divergence from randomness), </li><li> IBS (information-based models), </li><li> LM Dirichlet, </li><li> Jelinek-Mercer. </li></ul><br><h3> 2.5    </h3><br>          ,   ,        .              ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>    . <br><br><h3> 2.6 Top k    </h3><br>            ,   .    ,       ,         . <br><br>     ,            .          <b>top k</b> . <br><br>       —  .    k,  k  <b>  *   </b> .           heap.       n*log(n)    k. <br><br>           . ,        ,          ,   10    12,    score    10        score  .        ,      n — (n*page size)  . <br><br><h3> 3.    </h3><br><h3> 3.1  </h3><br>        —   .         , . <br><br>      ,        :    ,        ,       .  ,    .             .     (     ,        ).            (merge). <br><br>         ,     ,       : <br><br><img src="https://habrastorage.org/webt/2c/ec/gx/2cecgxgu5eyuhtaffs50anmywoa.png" alt="图片"><br><br>       .            ,       ,   , -     . <br><br><h3> 3.2   (megre) </h3><br>        —  .         «» —      .      ,      ,        (    ). <br><br><img src="https://habrastorage.org/webt/ey/yv/n9/eyyvn9msvqryhqm3lh_rh9o4vv8.png" alt="图片"><br><br>     ,    ,   ,       .      : <br><br><ul><li>     , </li><li>      (,           2 ), </li><li>      (,        ). </li></ul><br><h3> 4.   </h3><br>         ,    ,           .         ,  -     (,            . .).   ,      ,       ,    . <br><br><img src="https://habrastorage.org/webt/m0/jy/od/m0jyodvmhfv6vz093nofc5axnmk.png" alt="图片"><br><br><h3> 4.1    </h3><br>           (,  hh     ,   ),     .        . <br><br>    ,        ,    . -,     ,          . -,     ,          ,         . <br><br><h3> 4.2   </h3><br>           ,       .        ,            . <br><br>    ,       hh,  <i> </i> ,        ,   -    : <br><br><img src="https://habrastorage.org/webt/bq/mo/cb/bqmocbqmz-t3kuyhddye_d04iy0.png" alt="图片"><br><br><h3> 5.  …    </h3><br>    ,      ,         ,    .   ,     :   , , ,      ,     ,         (highlight),   .      ,    ,        ,   top k . <br><br>     : <br><br><ul><li>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Introduction to Information Retrieval</a>     </li><li>         lucene ( elasticsearch)  sphinx </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看报告安德烈阿克赛诺夫，如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font></a> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hh程序员学校学习</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并听有关搜索的讲座:)</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 就是这样，谢谢大家的关注，很高兴听到您的评论和问题。 </font></font><br><br><h3> 聚苯乙烯 </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我要感谢</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gdanschin</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">帮助</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link"><font style="vertical-align: inherit;">我</font></a><font style="vertical-align: inherit;">写这篇文章。</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN413261/">https://habr.com/ru/post/zh-CN413261/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN413247/index.html">为什么要监视存储系统？</a></li>
<li><a href="../zh-CN413249/index.html">编写Linux内核模块：I2C</a></li>
<li><a href="../zh-CN413251/index.html">聚合酶链反应和符拉迪沃斯托克（海参div）</a></li>
<li><a href="../zh-CN413253/index.html">理查德·汉明（Richard Hamming）：第21章。</a></li>
<li><a href="../zh-CN413255/index.html">理查德·汉明（Richard Hamming）：第27章。无效数据</a></li>
<li><a href="../zh-CN413265/index.html">带IT去澡堂</a></li>
<li><a href="../zh-CN413267/index.html">新手产品经理要注意的10项必备素质</a></li>
<li><a href="../zh-CN413269/index.html">机器如何分析大数据：聚类算法简介</a></li>
<li><a href="../zh-CN413271/index.html">没有密码：分布式注册表上的身份验证系统如何工作</a></li>
<li><a href="../zh-CN413273/index.html">在公司内部管理IT产品需求</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>