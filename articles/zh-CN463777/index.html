<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤™ğŸ¾ ğŸ¤³ğŸ¼ ğŸ‘©ğŸ»â€ğŸš’ Powershellä¸»æœºå¯ç”¨æ€§ç›‘è§† ğŸ™ŒğŸ¼ ğŸ ğŸ’‡ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç¥æ‚¨æœ‰ç¾å¥½çš„ä¸€å¤©ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€æ¡ç®€å•çš„è¯´æ˜ï¼šâ€œå¦‚ä½•åœæ­¢æ‰‹åŠ¨å¯¹åå‡ å°ä¸»æœºæ‰§è¡Œpingæ“ä½œã€‚ æ²¡æœ‰æ³¨å†Œå’ŒçŸ­ä¿¡ï¼â€ 

 æ¥è‡ªäº’è”ç½‘ 

 é‡è¦è¯´æ˜ ï¼šæˆ‘ä¸æ˜¯ç¨‹åºå‘˜æˆ–ç³»ç»Ÿç®¡ç†å‘˜ï¼Œä½†æ˜¯æˆ‘å¿…é¡»åŒæ—¶ä½¿ç”¨å¤§é‡æœåŠ¡å™¨å’ŒæœåŠ¡ï¼Œå¹¶ä¸”ä¸ºè‡ªå·±æ–¹ä¾¿èµ·è§ç¼–å†™äº†æ­¤è„šæœ¬ã€‚ 

 æˆ‘æƒ³å¯¹æ‰€æœ‰å¯èƒ½è§‰å¾—è¿™å¾ˆæœ‰ç”¨ï¼Œå¥½å¥‡çš„äººé—®ã€‚ 

 ä¸ºä»€ä¹ˆ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Powershellä¸»æœºå¯ç”¨æ€§ç›‘è§†</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/463777/"> ç¥æ‚¨æœ‰ç¾å¥½çš„ä¸€å¤©ï¼Œæˆ‘æƒ³åˆ†äº«ä¸€æ¡ç®€å•çš„è¯´æ˜ï¼šâ€œå¦‚ä½•åœæ­¢æ‰‹åŠ¨å¯¹åå‡ å°ä¸»æœºæ‰§è¡Œpingæ“ä½œã€‚ æ²¡æœ‰æ³¨å†Œå’ŒçŸ­ä¿¡ï¼â€ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2p/il/za/2pilzao3cmanplkez6dtrphvotg.jpeg"></div>  <i>æ¥è‡ªäº’è”ç½‘</i> <br><br>  <b>é‡è¦è¯´æ˜</b> ï¼šæˆ‘ä¸æ˜¯ç¨‹åºå‘˜æˆ–ç³»ç»Ÿç®¡ç†å‘˜ï¼Œä½†æ˜¯æˆ‘å¿…é¡»åŒæ—¶ä½¿ç”¨å¤§é‡æœåŠ¡å™¨å’ŒæœåŠ¡ï¼Œå¹¶ä¸”ä¸ºè‡ªå·±æ–¹ä¾¿èµ·è§ç¼–å†™äº†æ­¤è„šæœ¬ã€‚ <br><br> æˆ‘æƒ³å¯¹æ‰€æœ‰å¯èƒ½è§‰å¾—è¿™<s>å¾ˆæœ‰ç”¨ï¼Œ</s>å¥½å¥‡çš„äººé—®ã€‚ <br><hr><a name="habracut"></a><br><div class="spoiler"> <b class="spoiler_title">ä¸ºä»€ä¹ˆé€‰æ‹©Powershell</b> <div class="spoiler_text">  <i>æˆ‘æœ‰ç¼–å†™ç®€å•çš„Pythonç¨‹åºçš„ç»éªŒï¼Œä½†æ˜¯å®ƒéœ€è¦å®‰è£…çš„è§£é‡Šå™¨æˆ–è¿è¡Œ.exeçš„æƒé™ï¼Œè¿™åœ¨æˆ‘çš„å·¥ä½œä¸­å¹¶ä¸æ€»æ˜¯å¯èƒ½çš„ã€‚</i>  <i>ä½†æ˜¯Powershellè„šæœ¬é€šå¸¸å…·æœ‰è¿è¡Œèƒ½åŠ›ã€‚</i> <br></div></div><br><h3> å¹¶éæ¯ä¸ªäººéƒ½å–œæ¬¢æ§åˆ¶å°/ç»ˆç«¯ </h3><br>  <i>æˆ‘è®¤ä¸ºè¿™ä¸æ˜¯çŸ›ç›¾ï¼Œå¦åˆ™æ¯ä¸ªäººä»ç„¶ä¼šä½¿ç”¨æ§åˆ¶å°é‚®ä»¶å®¢æˆ·ç«¯ï¼Œè€ŒGUIä¸ä¼šå‡ºç°åœ¨* nixç³»ç»Ÿä¸­ã€‚</i> <br><br> å› ä¸ºåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­æˆ‘å¿…é¡»ç›¸å½“åŸå§‹åœ°ä½¿ç”¨Powershellï¼Œæ‰€ä»¥ä»ä¸€å¼€å§‹æˆ‘å°±è¯•å›¾äº†è§£æ˜¯å¦å¯ä»¥å°†GUIå›ºå®šåœ¨å®ƒä¸Šé¢ã€‚ äº‹å®è¯æ˜æ‚¨å¯ä»¥åšåˆ°ï¼Œç”šè‡³å¾ˆç®€å•ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pf/h3/d-/pfh3d-h85oekprcwuu0dzdesxfu.png"></div><br><pre><code class="plaintext hljs">Add-Type -assembly System.Windows.Forms #  $main_form = New-Object System.Windows.Forms.Form #    "" #    $main_form.Text ='Links up' #   $main_form.Width = 300 #  $main_form.Height = 200 #  $main_form.AutoSize = $true #     ,   $main_form.ShowDialog() # ""</code> </pre> <br> å‘å…¶æ·»åŠ è¾“å‡ºå…ƒç´ å¹¶è·å¾—åŸºæœ¬çš„Windwows <s>é‡è¨€å¼</s>çª—å£<s>ï¼Ÿ</s>  ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/66/md/en/66mdenqsxhgccqee_sxl1zx7bb0.png"></div><br><pre> <code class="plaintext hljs">Add-Type -assembly System.Windows.Forms #  $main_form = New-Object System.Windows.Forms.Form #    "" #      $main_form.Text ='Links up' #   $main_form.Width = 300 #  $main_form.Height = 200 #  $main_form.AutoSize = $true #     ,   $Label = New-Object System.Windows.Forms.Label #      ,     ,      Powershell $Label.Text = "!   Windows-,    ?" #  $Label.Location = New-Object System.Drawing.Point(10,65) #        (x,y) $Label.AutoSize = $true $main_form.Controls.Add($Label) #    ,        $main_form.ShowDialog() #   </code> </pre> <br><h3> æ·»åŠ å‘è¨€äºº </h3><br> å› æ­¤ï¼Œæˆ‘ç”¨æ¥â€œ ping Yandexâ€å¹¶å®‰è£…* .isoçš„å·¥å…·å…·æœ‰å•ç‹¬çš„GUIï¼Œä½†è¿™è¿˜ä¸å¤Ÿã€‚ åŒæ ·ï¼Œæ‚¨å¯ä»¥æ˜¾ç¤ºå¯è®¿é—®æ€§ä¿¡æ¯ï¼Œä½†æ˜¯ä¸ºäº†è¿›è¡Œç›‘è§†ï¼Œæ‚¨æ¯æ¬¡éƒ½å¿…é¡»é‡æ–°å¯åŠ¨è„šæœ¬ã€‚ <br><br> é¦–å…ˆï¼Œç»˜åˆ¶ä¸¤ä¸ªå›¾æ ‡å¹¶æ·»åŠ æ˜¾ç¤ºå›¾åƒçš„åŠŸèƒ½ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sh/40/xh/sh40xhgqonwm5nvdqqh0jtinzmu.png"></div><br><pre> <code class="plaintext hljs">$PictureBox = New-Object system.Windows.Forms.PictureBox #       $PictureBox.width = 10 $PictureBox.height = 10 $PictureBox.location = New-Object System.Drawing.Point(178,12) #                #&lt;b&gt;test-connection&lt;/b&gt;, : #-Count -  -  #-computer - IP      #-quiet -       Boolean  if ((test-connection -Count 1 -computer ya.ru -quiet) -eq $True) { $PictureBox.imageLocation = "C:\Test\yes.png" #     } Else { $PictureBox.imageLocation = "C:\Test\no.png" #     } $PictureBox.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom $main_form.Controls.Add($PictureBox)</code> </pre><br>  <s><i>åŒæ ·ï¼Œæˆ‘ä»¬çš„DNSæ˜µç§°å¾ˆé¡½çš®...</i></s> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m2/ij/-f/m2ij-fy3dqgd-s31avukhhzky6e.png"></div><br> å¹¶æ·»åŠ ä¸€ä¸ªæŒ‰é’®ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥æ›´æ–°è¯»æ•°ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hu/90/_-/hu90_-mdwepm_j3ckujjlre1xo8.png"></div><br><pre> <code class="plaintext hljs">$Button = New-Object System.Windows.Forms.Button $Button.Location = New-Object System.Drawing.Size(100,150) $Button.Size = New-Object System.Drawing.Size(80,30) $Button.Text = "Reload" #        PictureBox     $Button.Add_Click({ if ((Test-Connection -Count 1 -computer ya.ru -quiet) -eq $True) {$PictureBox.imageLocation = "C:\Test\yes.png"} Else {$PictureBox.imageLocation = "C:\Test\no.png"} if ((Test-Connection -Count 1 -computer 8.8.8.8 -quiet) -eq $True) {$PictureBox1.imageLocation = "C:\Test\yes.png"} Else {$PictureBox1.imageLocation = "C:\Test\no.png"} }) $main_form.Controls.Add($Button)</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k_/7q/_l/k_7q_lipmrun-isgcadlcfpi2ue.gif"></div><br><h3> å¤ªå¥½äº†ï¼Œç°åœ¨æŠ•å…¥ç”Ÿäº§ï¼  <s>ï¼Ÿ</s> </h3><br> æ‰‹åŠ¨è§„å®šäº†å¤§çº¦å…­å°ä¸»æœºåï¼Œæˆ‘çªç„¶æ„è¯†åˆ°ä¸€ä»¶äº‹-ä½†æ˜¯è¯¥é¡¹ç›®å°†ç»“æŸï¼Œä¸»æœºå°†æ›´æ”¹ï¼Œæˆ‘æ¯æ¬¡éƒ½å¿…é¡»ç¼–è¾‘è„šæœ¬ã€‚ ä¸€æ–¹é¢ï¼Œè¿™æ²¡å…³ç³»ï¼Œè¿™æ˜¯æ‚¨è‡ªå·±çš„å†³å®šã€‚ å¦ä¸€æ–¹é¢ï¼Œ <s>è¿™æ˜¯ä¸€ä¸ªä¸ºè‡ªå·±æ‰€çˆ±çš„å†³å®šï¼Œ</s>çœ‹çœ‹å‘ç”Ÿäº†ä»€ä¹ˆï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å¥‡è§‚ä¸é€‚åˆèƒ†å°çš„äºº</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Add-Type -assembly System.Windows.Forms #  $main_form = New-Object System.Windows.Forms.Form #    "" #      $main_form.Text ='Links up' #   $main_form.Width = 300 #  $main_form.Height = 200 #  $main_form.AutoSize = $true #     ,   $Label = New-Object System.Windows.Forms.Label #      ,     ,      Powershell $Label.Text = "ya.ru ............................" #  $Label.Location = New-Object System.Drawing.Point(15,10) #        (x,y) $Label.AutoSize = $true $Label1 = New-Object System.Windows.Forms.Label #      ,     ,      Powershell $Label1.Text = "8.8.8.8 ............................" #  googl- DNS- $Label1.Location = New-Object System.Drawing.Point(15,30) #        (x,y) $Label1.AutoSize = $true $Label2 = New-Object System.Windows.Forms.Label $Label2.Text = "192.168.xx ............................" $Label2.Location = New-Object System.Drawing.Point(15,50) $Label2.AutoSize = $true $Label3 = New-Object System.Windows.Forms.Label $Label3.Text = "192.168.xx ............................" $Label3.Location = New-Object System.Drawing.Point(15,70) $Label3.AutoSize = $true $Label4 = New-Object System.Windows.Forms.Label $Label4.Text = "10.0.xx ............................" $Label4.Location = New-Object System.Drawing.Point(15,90) $Label4.AutoSize = $true $Label5 = New-Object System.Windows.Forms.Label $Label5.Text = "162.102.xx ............................" $Label5.Location = New-Object System.Drawing.Point(15,110) $Label5.AutoSize = $true $PictureBox = New-Object system.Windows.Forms.PictureBox #       $PictureBox.width = 10 $PictureBox.height = 10 #                #&lt;b&gt;test-connection&lt;/b&gt;, : #-Count -  -  #-computer - IP      #-quiet -       Boolean  $PictureBox.location = New-Object System.Drawing.Point(235,12) if ((test-connection -Count 1 -computer ya.ru -quiet) -eq $True) { $PictureBox.imageLocation = "C:\Test\yes.png" #     } Else { $PictureBox.imageLocation = "C:\Test\no.png" #     } $PictureBox.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom $PictureBox1 = New-Object system.Windows.Forms.PictureBox #       $PictureBox1.width = 10 $PictureBox1.height = 10 $PictureBox1.location = New-Object System.Drawing.Point(235,32) if ((test-connection -Count 1 -computer 8.8.8.8 -quiet) -eq $True) { $PictureBox1.imageLocation = "C:\Test\yes.png" #     } Else { $PictureBox1.imageLocation = "C:\Test\no.png" #     } $PictureBox1.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom $PictureBox2 = New-Object system.Windows.Forms.PictureBox #       $PictureBox2.width = 10 $PictureBox2.height = 10 $PictureBox2.location = New-Object System.Drawing.Point(235,52) if ((test-connection -Count 1 -computer 192.168.xx -quiet) -eq $True) { $PictureBox2.imageLocation = "C:\Test\yes.png" #     } Else { $PictureBox2.imageLocation = "C:\Test\no.png" #     } $PictureBox2.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom $PictureBox3 = New-Object system.Windows.Forms.PictureBox #       $PictureBox3.width = 10 $PictureBox3.height = 10 $PictureBox3.location = New-Object System.Drawing.Point(235,72) if ((test-connection -Count 1 -computer 192.168.xx -quiet) -eq $True) { $PictureBox3.imageLocation = "C:\Test\yes.png" #     } Else { $PictureBox3.imageLocation = "C:\Test\no.png" #     } $PictureBox3.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom $PictureBox4 = New-Object system.Windows.Forms.PictureBox #       $PictureBox4.width = 10 $PictureBox4.height = 10 $PictureBox4.location = New-Object System.Drawing.Point(235,92) if ((test-connection -Count 1 -computer 10.0.xx -quiet) -eq $True) { $PictureBox4.imageLocation = "C:\Test\yes.png" #     } Else { $PictureBox4.imageLocation = "C:\Test\no.png" #     } $PictureBox1.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom $PictureBox5 = New-Object system.Windows.Forms.PictureBox #       $PictureBox5.width = 10 $PictureBox5.height = 10 $PictureBox5.location = New-Object System.Drawing.Point(235,112) if ((test-connection -Count 1 -computer 162.102.xx -quiet) -eq $True) { $PictureBox5.imageLocation = "C:\Test\yes.png" #     } Else { $PictureBox5.imageLocation = "C:\Test\no.png" #     } $PictureBox5.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom $Button = New-Object System.Windows.Forms.Button $Button.Location = New-Object System.Drawing.Size(100,150) $Button.Size = New-Object System.Drawing.Size(80,30) $Button.Text = "Reload" #        PictureBox     $Button.Add_Click({ if ((Test-Connection -Count 1 -computer ya.ru -quiet) -eq $True) {$PictureBox.imageLocation = "C:\Test\yes.png"} Else {$PictureBox.imageLocation = "C:\Test\no.png"} if ((Test-Connection -Count 1 -computer 8.8.8.8 -quiet) -eq $True) {$PictureBox1.imageLocation = "C:\Test\yes.png"} Else {$PictureBox1.imageLocation = "C:\Test\no.png"} if ((Test-Connection -Count 1 -computer 192.168.xx -quiet) -eq $True) {$PictureBox2.imageLocation = "C:\Test\yes.png"} Else {$PictureBox2.imageLocation = "C:\Test\no.png"} if ((Test-Connection -Count 1 -computer 192.168.xx -quiet) -eq $True) {$PictureBox3.imageLocation = "C:\Test\yes.png"} Else {$PictureBox3.imageLocation = "C:\Test\no.png"} if ((Test-Connection -Count 1 -computer 10.0.xx -quiet) -eq $True) {$PictureBox4.imageLocation = "C:\Test\yes.png"} Else {$PictureBox4.imageLocation = "C:\Test\no.png"} if ((Test-Connection -Count 1 -computer 162.102.xx -quiet) -eq $True) {$PictureBox5.imageLocation = "C:\Test\yes.png"} Else {$PictureBox5.imageLocation = "C:\Test\no.png"} }) $main_form.Controls.Add($Label) #    ,        $main_form.Controls.Add($Label1) $main_form.Controls.Add($Label2) $main_form.Controls.Add($Label3) $main_form.Controls.Add($Label4) $main_form.Controls.Add($Label5) $main_form.Controls.Add($PictureBox) $main_form.Controls.Add($PictureBox1) $main_form.Controls.Add($PictureBox2) $main_form.Controls.Add($PictureBox3) $main_form.Controls.Add($PictureBox4) $main_form.Controls.Add($PictureBox5) $main_form.Controls.Add($Button) $main_form.ShowDialog() #   </code> </pre></div></div><br> å³ä½¿æ‚¨è§‚å¯Ÿæ¸…æ´åº¦å¹¶åšæŒç»“æ„ï¼Œå®šæœŸç¼–è¾‘ä¹Ÿä¸ä¼šäº§ç”Ÿæœ€ä»¤äººæ„‰æ‚¦çš„æ„Ÿè§‰ã€‚ <br><br> é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨å•ç‹¬çš„å‡½æ•°ä¸­è¿›è¡Œå¯ç”¨æ€§æ£€æŸ¥ï¼Œå¹¶åœ¨å•ç‹¬çš„å˜é‡ä¸­è¿›è¡Œç›®å½•è·¯å¾„çš„æ£€æŸ¥ï¼š <br><br><pre> <code class="plaintext hljs">$script_path = "C:\Test\PS ping" #      PictureBox  IP-   . #     . function get_status($PictureBox,$path_ip) { if ((Test-Connection -Count 1 -computer $path_ip -quiet) -eq $True) {$PictureBox.imageLocation = $script_path + "\yes.png"} Else {$PictureBox.imageLocation = $script_path + "\no.png"} }</code> </pre><br> æˆ‘ä»¬å°†ä¸»æœºæ•°æ®ä¼ è¾“åˆ°ä¸€ä¸ªå¤–éƒ¨path.txtæ–‡ä»¶ä¸­ï¼Œå¹¶ä»¥â€œ ip / host-functional-name /â€çš„å½¢å¼ç¼–å†™ï¼Œåœ¨æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬å°†å®ƒä»¬åˆ†æˆæ•°ç»„ã€‚ æˆ‘ä»¬è¿˜ä½¿Yä½ç½®çš„è®¡ç®—æ›´åŠ è‡ªåŠ¨åŒ–ã€‚ æ‰€æœ‰è¿™äº›ä½¿æˆ‘ä»¬æœ‰æœºä¼šé€šè¿‡è°ƒç”¨ä»¥ä¸‹å‡½æ•°æ¥åˆ›å»ºæ ‡ç­¾å’Œå¤é€‰æ¡†ï¼š <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ob/bq/f3/obbqf3swvwgscx0u1rfnck1enpo.png"></div><br><pre> <code class="plaintext hljs">#  ,   :  Label, IP-,      Y Function Create_line($label,$path_ip,$caption, $top){ $label.Location = New-Object System.Drawing.Point(1, $top) $label.text = $path_ip+$caption $label.font = $font $Label.AutoSize = $true } #    ,   :  PictureBox, IP-     Y Function Create_link($PictureBox,$path_ip, $top){ $PictureBox.width = 10 $PictureBox.height = 10 $PictureBox.location = New-Object System.Drawing.Point(210,$top) get_status -PictureBox $PictureBox -path_ip $path_ip $PictureBox.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom } $line = Get-content -LiteralPath $script_path"\path.txt" #     $len = $line.Length # ,       $i = 0 #      $ip = @() # ip $capt = @() #  $Labels =@() # Label $PictureBoxs =@() # PictureBox while($i -lt $len){ $f = $line[$i].IndexOf("/") #    $l = $line[$i].LastIndexOf("/") #    $ip += $line[$i].Substring(0,$f) # ip $capt += $line[$i].Substring($f+1,$l-$f-1) #  #  Label Create_line -label ($label_obj = New-Object System.Windows.Forms.Label) -path_ip $ip[$i] -caption $capt[$i] -top $label_from_top #  PictureBox Create_link -PictureBox ($PictureBox_obj = New-Object system.Windows.Forms.PictureBox) -path_ip $ip[$i] -top $label_from_top $label_from_top += 15 # ""   Y $Labels += $label_obj #  Label    $PictureBoxs += $PictureBox_obj #  PictureBox    $main_form.Controls.Add($Labels[$i]) $main_form.Controls.Add($PictureBoxs[$i]) $i +=1 }</code> </pre><br> å› ä¸ºæ–¹ä¾¿ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªä½ç½®æ¥æ˜¾ç¤ºä¸Šæ¬¡æ£€æŸ¥çš„æ—¶é—´ï¼Œå¹¶ä¸”å½“æ‚¨å•å‡»æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬å°†ç¨å¾®æ·»åŠ ä¸€ä¸ªæ“ä½œã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7c/zt/0v/7czt0vf-_y2yp7fdtd5gpwhejss.png"></div><br><pre> <code class="plaintext hljs">$Label0 = New-Object System.Windows.Forms.Label $Label0.Text = Get-Date $Label0.Location = New-Object System.Drawing.Point(80,180) $Label0.AutoSize = $true $main_form.Controls.Add($Label0) $Button.Add_Click({ while($i -lt $len){ get_status -PictureBox $PictureBoxs[$i] -path_ip $ip[$i] $i +=1 } $Label0.Text = Get-Date })</code> </pre><br> æ­¤å¤–ï¼Œæˆ‘è¿˜é™„åŠ äº†ä¸€ä¸ªå°åŠŸèƒ½ï¼Œè€Œ<s>ä¸æ˜¯é”™è¯¯</s> ï¼Œå½“æ£€æµ‹åˆ°æ— æ³•è®¿é—®çš„ä¸»æœºæ—¶ï¼Œè¯¥<s>é”™è¯¯</s>ä¸ä»…æŠ¥å‘Šäº†æŒ‡ç¤ºå™¨çš„å˜åŒ–ï¼Œè€Œä¸”è¿˜å¼•èµ·äº†æ‰¬å£°å™¨çš„å°–å«ã€‚ <br><br><pre> <code class="plaintext hljs">Add-Type -AssemblyName System.Speech $voice = New-Object System.Speech.Synthesis.SpeechSynthesizer $voice.Rate = 5 $voice.Speak("! !    !")</code> </pre><br> å› æ­¤ï¼Œç»è¿‡ä¸€äº›ä¿®é¥°å¹¶ä¸ºæˆ‘æä¾›äº†æ˜“äºé˜…è¯»çš„å¤–è§‚ï¼Œç»“æœæ˜¯è¿™æ ·çš„ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å®Œæ•´çš„è„šæœ¬ä»£ç </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Add-Type -AssemblyName System.Speech Add-Type -assembly System.Windows.Forms $script_path = "C:\PS ping" $label_from_top = 10 $voice = New-Object System.Speech.Synthesis.SpeechSynthesizer $voice.Rate = 5 #      PictureBox  IP-   . #     . function get_status($PictureBox,$path_ip) { if ((Test-Connection -Count 1 -computer $path_ip -quiet) -eq $True) { $PictureBox.imageLocation = $script_path + "\yes.png" } Else { $PictureBox.imageLocation = $script_path + "\no.png" $voice.Speak("!  " + $path_ip + ", !") } } #  ,   :  Label, IP-,      Y Function Create_line($label,$path_ip,$caption, $top){ $label.Location = New-Object System.Drawing.Point(1, $top) $label.text = $path_ip+$caption $label.font = $font $Label.AutoSize = $true } #    ,   :  PictureBox, IP-     Y Function Create_link($PictureBox,$path_ip, $top){ $PictureBox.width = 10 $PictureBox.height = 10 $PictureBox.location = New-Object System.Drawing.Point(210,$top) get_status -PictureBox $PictureBox -path_ip $path_ip $PictureBox.SizeMode = [System.Windows.Forms.PictureBoxSizeMode]::zoom } $main_form = New-Object System.Windows.Forms.Form $main_form.Text ='Links up' #   $main_form.Width = 300 #  $main_form.Height = 200 #  $main_form.AutoSize = $true #     ,   $main_form.TopMost = $true #   ,        $line = Get-content -LiteralPath $script_path"\path.txt" #     $len = $line.Length # ,       $i = 0 #      $ip = @() # ip $capt = @() #  $Labels =@() # Label $PictureBoxs =@() # PictureBox while($i -lt $len){ $f = $line[$i].IndexOf("/") #    $l = $line[$i].LastIndexOf("/") #    $ip += $line[$i].Substring(0,$f) # ip $capt += $line[$i].Substring($f+1,$l-$f-1) #  #  Label Create_line -label ($label_obj = New-Object System.Windows.Forms.Label) -path_ip $ip[$i] -caption $capt[$i] -top $label_from_top #  PictureBox Create_link -PictureBox ($PictureBox_obj = New-Object system.Windows.Forms.PictureBox) -path_ip $ip[$i] -top $label_from_top $label_from_top += 15 # ""   Y $Labels += $label_obj #  Label    $PictureBoxs += $PictureBox_obj #  PictureBox    $main_form.Controls.Add($Labels[$i]) $main_form.Controls.Add($PictureBoxs[$i]) $i +=1 } #      $Label0 = New-Object System.Windows.Forms.Label $Label0.Text = Get-Date $Label0.Location = New-Object System.Drawing.Point(80,180) $Label0.AutoSize = $true #        PictureBox     $Button = New-Object System.Windows.Forms.Button $Button.Location = New-Object System.Drawing.Size(100,200) $Button.Size = New-Object System.Drawing.Size(80,30) $Button.Text = "Reload" $Button.Add_Click({ while($i -lt $len){ get_status -PictureBox $PictureBoxs[$i] -path_ip $ip[$i] $i +=1 } $i = 0 $Label0.Text = Get-Date }) $main_form.Controls.Add($Button) $main_form.Controls.Add($Label0) $main_form.ShowDialog()</code> </pre><br></div></div><br><h3> åè®° </h3><br> æˆ‘å¸Œæœ›æœ‰äººä¼šè§‰å¾—æœ¬æ•™ç¨‹æœ‰ç”¨ã€‚ å¦‚æœæ‚¨å‡ ä¹ä»æ‘‡ç¯®ä¸­åšåˆ°äº†è¿™ä¸€ç‚¹ï¼Œé‚£ä¹ˆæ­å–œï¼Œæˆ‘æ²¡æœ‰ã€‚ ä½†æˆ‘å‡†å¤‡å¬å¬æ‚¨çš„æ„è§å’Œå»ºè®®ã€‚ <br><br> å¯¹æˆ‘æ¥è¯´ï¼Œå¾ˆé«˜å…´èƒ½åœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­æŒ–æ˜å¹¶æ”¶é›†è¿™ä¹ˆå°çš„ä½†æœ‰ç”¨çš„å®ç”¨ç¨‹åºã€‚ è¯¥è®¡åˆ’ä»ç„¶å¿…é¡»å®ç°ä»GUIä¸Šæ·»åŠ å’Œåˆ é™¤èŠ‚ç‚¹çš„åŠŸèƒ½ï¼Œä»¥åŠ<s>æ‰§è¡ŒåŸæœ¬åº”è¯¥</s>è‡ªåŠ¨è¿›è¡ŒçŠ¶æ€æ›´æ–°çš„åŠŸèƒ½ï¼Œè€Œæ— éœ€â€œæ‹¨åŠ¨â€è¯¥æŒ‰é’®ï¼Œä»è€Œä¸ä¼šæŒ‚èµ·â€œ powershell.exeâ€ã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHubä¸Š</a>è„šæœ¬çš„æœ€æ–°ç‰ˆæœ¬ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN463777/">https://habr.com/ru/post/zh-CN463777/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN463765/index.html">Slurm DevOpsï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸è®¨è®ºDevOpsçš„åŸç†ä»¥åŠå°†ä¼šå‘ç”Ÿä»€ä¹ˆ</a></li>
<li><a href="../zh-CN463769/index.html">Mitap Netologiiâ€œæ•°æ®ç§‘å­¦èŒä¸šï¼šä»åˆå­¦è€…åˆ°ä¸­çº§â€</a></li>
<li><a href="../zh-CN463771/index.html">[Peter]ä¸Sebastian Dashnerä¼šé¢JUG.ru-ä½¿ç¼–å†™ä¼ä¸šæµ‹è¯•æ›´åŠ æ„‰å¿«</a></li>
<li><a href="../zh-CN463773/index.html">ä¿æŠ¤å„¿ç«¥å…å—ä¿¡æ¯ä¾µå®³çš„æ–¹å¼æ˜¯å¦‚ä½•å®‰æ’çš„-ä»¥åŠå…³äºå®ƒæœ€åˆæ¥è‡ªä½•å¤„çš„è¿·äººæ•…äº‹ï¼ˆ18å²ä»¥ä¸Šï¼‰</a></li>
<li><a href="../zh-CN463775/index.html">è°ä½¿ç”¨SAML 2.0èº«ä»½éªŒè¯åè®®</a></li>
<li><a href="../zh-CN463781/index.html">Androidä½“ç³»ç»“æ„ä¸­çš„Zenéš”ç¦»ç»„ä»¶</a></li>
<li><a href="../zh-CN463785/index.html">ç»ˆç«¯ä»¿çœŸå™¨æ¦‚è¿°</a></li>
<li><a href="../zh-CN463787/index.html">æƒ æ™®çš„å¤§æƒŠå–œ</a></li>
<li><a href="../zh-CN463789/index.html">Swiftä¸­æ³›å‹çš„åŠ›é‡ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN463791/index.html">é“æŠ“åœ°åŠ›ï¼šå–å†³äºå‡ ä½•å½¢çŠ¶å’Œè¡¨é¢çº¹ç†çš„é¸Ÿç±»ç€é™†è¿åŠ¨å­¦</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>