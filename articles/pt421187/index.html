<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍥 🤜🏼 🎠 Aprendizado profundo para identificar pinturas 👩‍👩‍👧 👎🏿 ⏰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Olá Habr! Hoje eu quero falar sobre como o aprendizado profundo nos ajuda a entender melhor a arte. O artigo é dividido em partes de acordo com as tar...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendizado profundo para identificar pinturas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/singularis/blog/421187/"><p>  Olá Habr!  Hoje eu quero falar sobre como o aprendizado profundo nos ajuda a entender melhor a arte.  O artigo é dividido em partes de acordo com as tarefas que resolvemos: </p><br><ol><li>  procure uma foto no banco de dados a partir de uma fotografia tirada por um telefone celular; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">determinação do estilo e gênero de uma imagem que não está no banco de dados.</a> </li></ol><br><p>  Tudo isso passou a fazer parte do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">serviço de banco de dados Arthive</a> e de seus aplicativos móveis. </p><br><p>  A tarefa de identificar as pinturas era encontrar a imagem correspondente da imagem proveniente do aplicativo móvel no banco de dados, gastando menos de um segundo nisso.  O processamento inteiramente no dispositivo móvel foi excluído na fase de estudo pré-design.  Além disso, descobriu-se que é <s>impossível</s> realizar com segurança em um dispositivo móvel a separação da imagem do fundo em condições reais de fotografia.  Portanto, decidimos que nosso serviço aceitará a foto inteira do celular como uma entrada, com todas as distorções, ruídos e possível sobreposição parcial. </p><br><img src="https://habrastorage.org/webt/cn/if/2y/cnif2ycyblx3ytn1e66pngunngq.jpeg"><br><p>  Ajudaremos o Dasha a encontrar essas pinturas em um banco de dados com mais de 200.000 imagens? </p><a name="habracut"></a><br><p>  A <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">base</a> artística da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arthive</a> inclui quase 250.000 imagens, além de vários metadados.  A base é constantemente atualizada - de dezenas a centenas de imagens por dia.  Mesmo com uma resolução limitada (não mais que 1400 pixels na maioria dos lados), as imagens ocupam mais de 80 gigabytes.  Infelizmente, o banco de dados está "sujo": há arquivos quebrados ou muito pequenos, imagens desalinhadas e não processadas, imagens duplicadas.  No entanto, no geral, são bons dados. </p><br><h2>  Comparação de pinturas </h2><br><p>  Vamos ver como são as imagens no banco de dados: <br></p><table><tbody><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/sz/1q/rz/sz1qrz48kric62h7miqopl9lj1u.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mark Rothko</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Laranja, vermelho, amarelo</a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/2s/2j/fi/2s2jfinlqycohujkfvv9khkcv2q.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ilya Repin</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Freira</a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/9l/ri/v0/9lriv0ga3emv589y3yrsbkxzwji.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">David Burliuk</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mulheres dos trópicos</a> <br></td></tr></tbody></table><br><p>  Basicamente, as imagens no banco de dados são alinhadas, cortadas nas bordas da tela, as cores são preservadas. </p><br><p>  E aqui está a aparência das solicitações de dispositivos móveis: </p><br><p><img src="https://habrastorage.org/webt/1p/iv/ej/1pivejjuiwsrqmhrh1yjonxeu-c.jpeg"></p><br><p>  As cores são quase sempre distorcidas - é encontrada iluminação complexa, brilho presente, até reflexos de outras pinturas no vidro.  As imagens em si são distorcidas em perspectiva, podem ser cortadas parcialmente ou, pelo contrário, ocupam menos da metade da imagem, podem ser parcialmente fechadas, por exemplo, por pessoas. </p><br><p>  Para identificar imagens, você precisa comparar imagens de consultas com imagens no banco de dados. </p><br><p>  Para comparar imagens propensas a distorção de perspectiva e distorção de cores, usamos a correspondência de pontos principais.  Para fazer isso, encontramos pontos-chave com descritores nas imagens, encontramos sua correspondência e, em seguida, exibimos homograficamente os pontos correspondentes usando o método RANSAC.  Isso geralmente é feito da mesma maneira descrita no exemplo do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenCV</a> .  Se o número de pontos “inlier” encontrados pelo RANSAC for grande o suficiente e a transformação homográfica encontrada parecer plausível (não possui escala ou rotações fortes), podemos assumir que as imagens desejadas são uma e a mesma imagem sujeitas a distorções de perspectiva . </p><br><p>  Um exemplo de mapeamento de pontos principais: </p><br><p><img src="https://habrastorage.org/webt/jg/vq/df/jgvqdfnkcmhe9-ohvbubeyajiua.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">Exemplo de correspondência negativa</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q_/8b/yz/q_8byzpsh8rizjhgsol2z1nye4g.jpeg"></div></div><br><div class="spoiler">  <b class="spoiler_title">Comparação de pinturas do exemplo acima</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/df/qb/ff/dfqbffq4ibpvjz1qh4_xhjhejvm.jpeg"><br><img src="https://habrastorage.org/webt/l4/b9/5a/l4b95adleete923jqu8leqc_gr4.jpeg"><br><img src="https://habrastorage.org/webt/sw/zc/os/swzcosr49hcjkuqc98lux5cwces.jpeg"><br><img src="https://habrastorage.org/webt/cn/hi/rr/cnhirrksz5srhe81bc3i0mc1exc.jpeg"><br><img src="https://habrastorage.org/webt/4r/y5/uf/4ry5ufekvsefkbba9allszpesro.jpeg"><br><img src="https://habrastorage.org/webt/70/oj/jy/70ojjy-ovr6eouymbnx7h0jel9i.jpeg"></div></div><br><p>  Obviamente, a busca por pontos-chave geralmente é um processo bastante lento, mas, para pesquisar no banco de dados, você pode encontrar os pontos-chave de todas as imagens com antecedência e salvar algumas delas.  Em nossas experiências, chegamos à conclusão de que menos de 1000 pontos são suficientes para uma pesquisa confiável de pinturas.  Ao usar 64 bytes por ponto (coordenadas + descritor AKAZE) para armazenar 1024 pontos, 64 kbytes por imagem ou cerca de 15 GB por base são suficientes. </p><br><p>  A comparação de imagens por pontos-chave no nosso caso levou cerca de 15 ms, ou seja, para uma enumeração completa de um banco de dados de 250.000 fotos, leva cerca de 1 hora.  Isso é muito. </p><br><p>  Por outro lado, se aprendermos a selecionar rapidamente do banco de dados inteiro vários (digamos, 100) dos candidatos mais prováveis, atingiremos o tempo alvo de 1 segundo por solicitação. </p><br><h2>  Classificação de similaridade </h2><br><p>  As redes de convolução profunda se estabeleceram como uma boa maneira de procurar imagens semelhantes.  A rede é usada para extrair características e calcular com base em um descritor que possua a propriedade de que a distância (euclidiana, cosseno ou outra) entre os descritores de imagens semelhantes será menor do que para imagens diferentes. </p><br><p>  Você pode treinar a rede de forma que, para a imagem da imagem da base e sua imagem distorcida da foto, produz descritores próximos e para imagens diferentes - mais distantes.  Além disso, essa rede é usada para calcular descritores de todas as imagens no banco de dados e descritores de fotos em solicitações.  Você pode selecionar rapidamente as imagens mais próximas e organizá-las de acordo com a distância entre os descritores. <br></p><p>  A maneira básica de treinar uma rede para calcular um descritor é usar uma rede siamesa. </p><br><p><img src="https://habrastorage.org/webt/eh/1l/xi/eh1lxi3gh88kjrqucs6kc2a4lpq.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.261ex" height="2.419ex" viewBox="0 -780.1 1404.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-62" x="974" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> a, b </script>  - imagens de entrada <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.416ex" height="2.298ex" viewBox="0 -728.2 2332.1 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-31" x="1831" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2"> y = 1 </script>  se <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.455ex" viewBox="0 -520.7 529.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> a </script>  e <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> b </script>  - uma aula <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-30" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-5"> 0 </script>  se diferente <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mi>D</mi><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>m</mi><msup><mi>R</mi><mi>d</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.922ex" height="2.901ex" viewBox="0 -935.7 7716.3 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="1469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="1859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-66" x="2304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="2854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-62" x="3244" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="3673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-44" x="4063" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-65" x="5141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6D" x="5608" y="0"></use><g transform="translate(6486,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="1074" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mi>D</mi><mtext>&nbsp;</mtext><mi>e</mi><mi>m</mi><msup><mi>R</mi><mi>d</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-6"> f (a), f (b) D \ em R ^ d </script>  - descritores de imagem <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.847ex" height="2.66ex" viewBox="0 -832 9406.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="1442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-62" x="1887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="2317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-3D" x="2984" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="4040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="4564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-66" x="4953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="5504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="5893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="6423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="6812" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-66" x="7257" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="7808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-62" x="8197" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="8627" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="9016" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>,</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> d (a, b) = d (f (a), f (b)) </script>  - distância entre um par de vetores de recursos <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mi>e</mi><mi>r</mi><mi>d</mi><mi>a</mi><mo>=</mo><mi>y</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>&amp;#x2212;</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>m</mi><mo>&amp;#x2212;</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="62.018ex" height="2.66ex" viewBox="-38.5 -832 26701.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-65" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-72" x="970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="1421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="1945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-3D" x="2752" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-79" x="3808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-63" x="4556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="4989" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6F" x="5513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-74" x="5998" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="6360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="6883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="7273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="7802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-62" x="8247" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="8677" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2B" x="9288" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="10289" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-31" x="10679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2212" x="11401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-79" x="12402" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="12900" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-63" x="13539" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="13973" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6F" x="14496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-74" x="14982" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6D" x="15343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="16222" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-78" x="16751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="17324" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-30" x="17713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="18214" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6D" x="18659" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="19537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-72" x="20067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-67" x="20518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-65" x="20999" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6D" x="21465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2212" x="22566" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="23567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="24090" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="24480" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="25009" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-62" x="25454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="25884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="26273" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>e</mi><mi>r</mi><mi>d</mi><mi>a</mi><mo>=</mo><mi>y</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>m</mi><mo>−</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> perda = y \ cdot d (a, b) + (1 - y) \ cdot max (0, margem - d (a, b)) </script>  - função objetiva </p><br><p>  Para construir essa arquitetura, uma rede que calcula um descritor (Feature Extractor) é usada no modelo 2 vezes com pesos comuns.  Algumas imagens são alimentadas na entrada da rede.  A rede Extrator de recursos calcula os descritores de imagem e, em seguida, a rede calcula a distância de acordo com a métrica especificada (geralmente é usada a distância euclidiana ou cosseno).  A função alvo do treinamento em rede é construída de tal maneira que, para pares positivos (imagens de uma foto), a distância diminui e, para negativos (imagens de fotos diferentes), aumenta.  Para reduzir a influência de pares negativos, a distância entre eles é limitada pelo valor da margem. </p><br><p>  Assim, podemos dizer que, no processo de treinamento, a rede procura computar descritores de imagens semelhantes dentro de uma hiperesfera com um raio de margem e descritores de diferentes - para sair dessa esfera. </p><br><p>  Por exemplo, isso pode parecer como treinar um descritor bidimensional usando a rede siamesa no conjunto de dados MNIST. </p><br><p><img src="https://habrastorage.org/webt/vs/5y/7n/vs5y7nggt4cvqls3ohka9v8qmqi.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">Animação de treinamento</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hl/-u/fv/hl-ufvknsfliuuxpfvaqrynkusm.gif"></div></div><br><p>  Para treinar a rede siamesa, é necessário inserir pares de imagens e um rótulo igual a 1 se as imagens pertencerem à mesma classe ou 0 se diferente.  Existe o problema de escolher a proporção de pares positivos e negativos.  Idealmente, é claro, seria necessário submeter à rede o treinamento de todas as combinações possíveis de pares do conjunto de treinamento, mas isso é tecnicamente impossível.  E o número de pares negativos nesse caso excede significativamente o número de pares positivos, o que também não terá um efeito muito bom no processo de aprendizagem. </p><br><p>  Parte do problema com a escolha da proporção de pares para treinamento é resolvida usando a arquitetura tripla. </p><br><p><img src="https://habrastorage.org/webt/u4/a5/yz/u4a5yzgvxnum6zlvbugpj9japvm.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.862ex" height="1.817ex" viewBox="0 -520.7 2523.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-70" x="974" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="1478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6E" x="1923" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>p</mi><mo>,</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> a, p, n </script>  - imagens de entrada: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mo>,</mo><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.433ex" height="1.817ex" viewBox="0 -520.7 1478.2 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-70" x="974" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo>,</mo><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> a, p </script>  - uma foto, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> n </script>  - outro <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>p</mi><mi>e</mi><mi>r</mi><mi>d</mi><mi>a</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>a</mi><mo>,</mo><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>m</mi><mo>,</mo><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.018ex" height="2.66ex" viewBox="-38.5 -832 18951.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-65" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-72" x="970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="1421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="1945" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-3D" x="2752" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6D" x="3808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="4687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-78" x="5216" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="5789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="6178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="6702" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="7091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="7621" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-70" x="8066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="8569" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2212" x="9181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-64" x="10182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-28" x="10705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="11095" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="11624" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6E" x="12069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-29" x="12670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2B" x="13282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6D" x="14282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-61" x="15161" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-72" x="15690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-67" x="16142" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-65" x="16622" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMATHI-6D" x="17089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-2C" x="17967" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhh74MCLGXn2RUxIhdiK7TTu2klV1A#MJMAIN-30" x="18412" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mi>e</mi><mi>r</mi><mi>d</mi><mi>a</mi><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>−</mo><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo>,</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>m</mi><mo>,</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-12"> perda = max (d (a, p) - d (a, n) + margem, 0</script>  - função objetiva </p><br><p>  Na entrada dessa rede, três figuras são imediatamente formadas, formando um par positivo e negativo. </p><p></p><p>  Além disso, quase todos os pesquisadores concordam que a escolha de pares negativos é fundamental para o aprendizado em rede.  A função objetivo para muitas amostras (pares para siameses, triplos para trigêmeos) acaba sendo 0 se não violarem o limite de margem; portanto, essas amostras não participam do treinamento da rede.  Com o tempo, o processo de aprendizado diminui ainda mais, pois há cada vez menos amostras com um valor diferente de zero da função objetivo.  Para resolver esse problema, pares negativos são escolhidos não por acaso, mas procurando por mineração de casos difíceis.  Na prática, vários candidatos negativos são selecionados para isso, para cada um dos quais um descritor é calculado usando a versão mais recente dos pesos de rede (de uma era anterior ou mesmo da atual).  Com um descritor, é possível selecionar um negativo em cada três, de modo a produzir uma perda diferente de zero conhecida. </p><br><p>  Para procurar imagens semelhantes, o Extrator de recursos é separado da rede e usado para calcular descritores.  Para imagens no banco de dados, os descritores são calculados previamente quando adicionados.  Portanto, a tarefa de encontrar imagens semelhantes é calcular o descritor de imagens na consulta e procurar os descritores mais próximos da métrica especificada no banco de dados. </p><br><p>  Nosso Extrator de recursos de rede é baseado na arquitetura Inception v3.  Uma das camadas intermediárias foi selecionada experimentalmente, com base na saída da qual é calculado um descritor de 512 números reais. </p><br><p><img src="https://habrastorage.org/webt/0q/w2/mz/0qw2mzgdztu_zyr9fxxsijznzrw.png"></p><br><h2>  Aumento de Dados </h2><br><p>  Seria bom se pudéssemos colocar cada foto em quadros diferentes, em paredes diferentes e tirar fotos a cada vez de um ângulo diferente em telefones diferentes.  Na prática, isso, é claro, é impossível.  Portanto, é necessário gerar dados de treinamento. </p><br><p>  Para gerar dados, foram coletadas cerca de 500 fotografias de várias pinturas com diferentes origens sob diferentes condições de iluminação.  Para cada foto, foram selecionados 4 pontos correspondentes aos cantos da tela da imagem.  Por quatro pontos, podemos ajustar arbitrariamente qualquer imagem no quadro, substituindo a imagem e obtendo uma distorção de perspectiva quase aleatória da imagem no banco de dados.  Complementando esse processo com corte aleatório, distorção de ruído e cor, temos a oportunidade de gerar imagens completamente adequadas que imitam fotografias de pinturas. </p><br><p><img src="https://habrastorage.org/webt/fi/ad/wg/fiadwgwcbv0bqqgbfiphnthicm8.jpeg" alt="Artificação"></p><br><h2>  Separação de uma imagem de um plano de fundo </h2><br><p>  A qualidade do trabalho e modelos para identificar pinturas e modelos para classificar gêneros / estilos depende em grande parte de quão bem a imagem é separada do plano de fundo.  Idealmente, antes de alimentar uma imagem em um modelo, você precisa encontrar os 4 cantos da tela e exibir a perspectiva em um quadrado.  Na prática, acabou sendo muito difícil implementar um algoritmo que garantisse isso.  Por um lado, há uma variedade significativa de planos de fundo, quadros e objetos que podem cair dentro do quadro próximo à imagem.  Por outro lado, há pinturas dentro das quais existem contornos bastante visíveis de formas retangulares (janelas, fachadas de edifícios, imagem em imagem).  Como resultado, muitas vezes é muito difícil dizer onde a imagem termina e seu ambiente começa. </p><br><p>  No final, decidimos por uma implementação simples, baseada em métodos clássicos de visão computacional (detecção de bordas + filtragem morfológica + análise de componentes conectados), o que permite cortar confiantemente fundos monofônicos, mas não perder parte da imagem. </p><br><h2>  Velocidade de trabalho </h2><br><p>  O algoritmo de processamento de consultas consiste nas seguintes etapas principais: </p><br><ol><li>  preparação - de fato, um simples detector da imagem é implementado, o que funciona bem se a imagem contiver um plano de fundo simples; </li><li>  calcular um descritor de imagem usando uma rede profunda; </li><li>  classificação das imagens por distância aos descritores no banco de dados; </li><li>  procure pontos-chave na imagem; </li><li>  verificação de candidatos em ordem de classificação. </li></ol><br><p>  Testamos a velocidade da rede em 200 solicitações, o seguinte tempo de processamento para cada um dos estágios foi obtido (tempo em segundos): <br></p><table><thead><tr><th>  estágio </th><th>  min </th><th>  max </th><th>  média </th></tr></thead><tbody><tr><td>  Preparação (pesquisa de imagens) </td><td>  0,008 </td><td>  0,011 </td><td>  0,016 </td></tr><tr><td>  Cálculo do descritor (GPU) </td><td>  0,082 </td><td>  0,092 </td><td>  0,088 </td></tr><tr><td>  KNN (k &lt;500, CPU, força bruta) </td><td>  0,199 </td><td>  <strong>0.820</strong> </td><td>  0,394 </td></tr><tr><td>  Pesquisa de ponto principal </td><td>  0,031 </td><td>  0,432 </td><td>  0,156 </td></tr><tr><td>  Verifique os principais pontos </td><td>  0,007 </td><td>  <strong>9,844</strong> </td><td>  2.585 </td></tr><tr><td>  <strong>Tempo total de solicitação</strong> </td><td>  0,358 </td><td>  10,386 </td><td>  3,239 </td></tr></tbody></table><br><p>  Como a verificação dos candidatos para imediatamente, como a imagem é encontrada com confiança suficiente, podemos assumir que o tempo mínimo de processamento das solicitações corresponde às fotos encontradas entre os primeiros candidatos.  O tempo máximo de solicitação é obtido para pinturas que não foram encontradas - a verificação é interrompida após 500 candidatos. </p><br><p>  Pode-se observar que a maior parte do tempo é gasta na seleção de candidatos e sua verificação.  Vale ressaltar que a implementação dessas etapas foi feita de maneira não ideal e com grande potencial de aceleração. </p><br><h2>  Pesquisa duplicada </h2><br><p>  Tendo construído o índice completo da base de pinturas, foi utilizado para procurar duplicatas no banco de dados.  Após aproximadamente 3 horas de visualização do banco de dados, verificou-se que pelo menos 13657 imagens são repetidas no banco de dados duas vezes (e cerca de três). </p><br><p>  Além disso, foram encontrados casos muito interessantes que não são duplicados. </p><br><img src="https://habrastorage.org/webt/hj/nh/kr/hjnhkregrx0th9cdshhzvf79b9y.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dois</a>  Parece que essas são duas etapas do mesmo trabalho. <br><br><img src="https://habrastorage.org/webt/eo/0o/qd/eo0oqdq2yip70qungxv6gttad3k.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dois dois</a>  Não preste atenção ao nome - todas as três fotos são diferentes. <br><br>  Bem como um exemplo de identificação de falso positivo por pontos-chave. <br><br><img src="https://habrastorage.org/webt/5t/gr/cr/5tgrcrmewazx_lqxd_po9cqd5v4.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dois</a> <br><br><div class="spoiler">  <b class="spoiler_title">mapeamento de pontos-chave</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/y1/ug/7i/y1ug7idfof7szcvsbmsbr64h7fy.jpeg"></div></div><br><h2>  Em vez de uma conclusão </h2><br><p>  Em geral, estamos satisfeitos com o resultado do serviço. </p><br><p>  Nos conjuntos de teste, é alcançada uma precisão de identificação acima de 80%.  Na prática, geralmente acontece que, se a imagem não for encontrada pela primeira vez, basta fotografá-la de um ângulo diferente e ela estará localizada.  Erros quando a imagem errada é encontrada quase nunca ocorrem. </p><br><p>  No total, a solução foi acondicionada em um contêiner e entregue ao cliente.  Agora, a identificação de pinturas por fotos está disponível em aplicativos usando o serviço Arthive, por exemplo, o Museu Pushkin, disponível no Play Market (no entanto, destaca a pintura do fundo, exigindo que o fundo seja claro, o que às vezes dificulta a fotografia). </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt421187/">https://habr.com/ru/post/pt421187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt421173/index.html">Visualização personalizada da Pesquisa do Google</a></li>
<li><a href="../pt421175/index.html">Monitorando o cluster Kubernetes com o Prometheus</a></li>
<li><a href="../pt421177/index.html">Como atrair um especialista em análise de dados quando sua empresa nem sequer tem um site</a></li>
<li><a href="../pt421179/index.html">HashMap interno em Java</a></li>
<li><a href="../pt421183/index.html">A IBM patenteia drones que distinguem emoções e trazem café às pessoas. E sobre o que mais escrever na sexta-feira?</a></li>
<li><a href="../pt421189/index.html">Migrando um banco de dados para uma versão mais antiga do MS SQL Server</a></li>
<li><a href="../pt421191/index.html">Como é fácil para um artesão sonhar com um núcleo 3D</a></li>
<li><a href="../pt421193/index.html">Audi PB18 e-tron</a></li>
<li><a href="../pt421195/index.html">Inteligência Artificial</a></li>
<li><a href="../pt421197/index.html">Na Rússia, um neuro-fone de ouvido está sendo desenvolvido para pessoas com problemas de fala e motores</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>