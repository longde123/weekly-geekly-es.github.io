<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∂üèæ ü§ôüèº üë®‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë® O que voc√™ √© Como distinguimos a par√≥dia da humana - e at√© ganhamos üí™ ü§≤üèΩ üêó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recentemente, foi realizado o Desafio de Antiespofamento por Voz ID R&D , cuja principal tarefa era criar um algoritmo capaz de distinguir uma voz hum...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O que voc√™ √© Como distinguimos a par√≥dia da humana - e at√© ganhamos</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475480/">  Recentemente, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">foi realizado</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Desafio de Antiespofamento por Voz ID R&amp;D</a> , cuja principal tarefa era criar um algoritmo capaz de distinguir uma voz humana de um registro sintetizado (spoof).  Sou Pesquisador ML no Dasha AI e trabalho muito em reconhecimento de fala, ent√£o decidi participar.  Juntamente com a equipe, conquistamos o primeiro lugar.  Sob o corte, vou falar sobre novas abordagens legais para o processamento de som, bem como sobre as dificuldades e esquisitices que tivemos que enfrentar. <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vc/wa/bq/vcwabqvrqyxbvpfonedne8br_yu.jpeg"></div><a name="habracut"></a><br>  98 pessoas participaram da competi√ß√£o - s√£o poucas as pessoas porque essa √© uma competi√ß√£o para processamento de som, em uma plataforma russa e at√© em uma docker.  Eu estava em uma equipe com Dmitry Danevsky, mestre do Kaggle, com quem nos conhecemos e concordamos em participar enquanto discut√≠amos abordagens em outra competi√ß√£o. <br><br><h2>  Desafio </h2><br>  Recebemos 5 GB de arquivos de √°udio, divididos em classes falsas / humanas, e tivemos que prever a probabilidade da classe, envolv√™-la em uma janela de encaixe e envi√°-la ao servidor.  A solu√ß√£o deveria funcionar em 30 minutos e pesar menos de 100 MB.  De acordo com informa√ß√µes oficiais, era necess√°rio distinguir entre a voz de uma pessoa e a gerada automaticamente - embora pessoalmente me parecesse que a classe de spoof tamb√©m inclu√≠a casos em que o som era gerado segurando o alto-falante no microfone (como os atacantes roubam uma grava√ß√£o da voz de outra pessoa para identifica√ß√£o). <br><br>  A m√©trica era <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">EER</a> : <br><br><img src="https://habrastorage.org/webt/44/pq/gy/44pqgyp_eu6f7rmwvov7f6wgtts.jpeg"><br><br>  Pegamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">primeiro c√≥digo que veio</a> da rede, porque o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo dos organizadores</a> parecia sobrecarregado. <br><br><h2>  Concorr√™ncia </h2><br>  Os organizadores forneceram a linha de base e, ao mesmo tempo, o principal enigma da competi√ß√£o.  Era simples: pegamos arquivos de √°udio, contamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">espectrogramas de giz</a> , treinamos o MobileNetV2 e nos encontramos em algum lugar em torno do 12¬∫ lugar ou menos.  Por causa disso, muitos pensariam que uma d√∫zia de pessoas participasse da competi√ß√£o, mas n√£o foi assim.  Durante toda a primeira etapa da competi√ß√£o, nossa equipe n√£o conseguiu quebrar essa linha de base.  O c√≥digo idealmente id√™ntico deu o resultado muito pior e quaisquer melhorias (como substituir por grades mais pesadas e previs√µes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OOF</a> ) ajudaram, mas n√£o o aproximaram da linha de base. <br><br>  E ent√£o o inesperado aconteceu: cerca de uma semana antes do final da competi√ß√£o, verificou-se que a implementa√ß√£o da contagem das m√©tricas dos organizadores continha um erro e dependia da ordem das previs√µes.  Na mesma √©poca, constatou-se que, nos cont√™ineres do docker, os organizadores n√£o desligaram a Internet com gentileza; muitos fizeram o download da amostra de teste.  Em seguida, o concurso foi congelado por 4 dias, corrigiu a m√©trica, atualizou os dados, desligou a Internet e recome√ßou por mais 2 semanas.  Ap√≥s a recontagem, est√°vamos no s√©timo lugar com uma de nossas primeiras inscri√ß√µes.  Isso serviu como uma forte motiva√ß√£o para continuar participando da competi√ß√£o. <br><br><h2>  Falando em modelo </h2><br>  Usamos uma grade de convolu√ß√£o do tipo resnet treinada sobre espectrogramas de giz. <br><br><ol><li>  No total, havia 5 desses blocos.Depois de cada bloco, fizemos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uma supervis√£o profunda</a> e aumentamos o n√∫mero de filtros uma vez e meia. </li><li>  Durante a competi√ß√£o, passamos de uma classifica√ß√£o bin√°ria para uma multi-classe, a fim de utilizar com mais efici√™ncia a t√©cnica de mixagem, na qual misturamos dois sons e resumimos seus r√≥tulos de classe.  Al√©m disso, ap√≥s essa transi√ß√£o, conseguimos aumentar artificialmente a probabilidade da classe de falsifica√ß√£o, multiplicando-a por 1,3.  Isso nos ajudou, pois havia uma suposi√ß√£o de que o saldo de classes na amostra de teste pode ser diferente da amostra de treinamento e, portanto, melhoramos a qualidade dos modelos. </li><li>  Modelos dobrados foram treinados e as previs√µes de v√°rios modelos foram calculadas como m√©dia. </li><li>  A t√©cnica de codifica√ß√£o de frequ√™ncia tamb√©m foi √∫til.  A linha inferior √©: as convolu√ß√µes 2D s√£o invariantes √† posi√ß√£o e, nos espectrogramas, os valores ao longo do eixo vertical t√™m significados f√≠sicos muito diferentes; portanto, gostar√≠amos de transferir essas informa√ß√µes para o modelo.  Para isso, concatenamos o espectrograma e a matriz, consistindo em n√∫meros em um segmento de -1 a 1 de baixo para cima. <br><br>  Para maior clareza, darei o c√≥digo: <br><br><pre><code class="plaintext hljs">n, d, h, w = x.size()         vertical = torch.linspace(-1, 1, h).view(1, 1, -1, 1)         vertical = vertical.repeat(n, 1, 1, w)         x = torch.cat([x, vertical], dim=1)</code> </pre> </li><li>  Treinamos tudo isso, inclusive em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dados pseudo-rotulados</a> da amostra de teste vazada do primeiro est√°gio. </li></ol><br><h2>  Valida√ß√£o </h2><br>  Desde o in√≠cio da competi√ß√£o, todos os participantes foram atormentados pela pergunta: por que a valida√ß√£o local fornece EER 0,01 e menor, e leaderboard 0,1 e n√£o se correlaciona particularmente?  Tivemos duas hip√≥teses: ou havia duplicatas nos dados ou os dados de treinamento foram coletados em um conjunto de palestrantes e dados de teste em outro. <br><br>  A verdade estava em algum lugar no meio.  Nos dados de treinamento, cerca de 5% dos dados acabaram sendo duplicados, e isso conta apenas duplicatas completas dos hashes (a prop√≥sito, tamb√©m pode conter recortes diferentes do mesmo arquivo, mas n√£o √© t√£o f√°cil de verificar - √© por isso que n√£o fizemos). <br><br>  Para testar a segunda hip√≥tese, treinamos uma grade de identifica√ß√£o de alto-falante, recebemos combina√ß√µes para cada alto-falante, agrupamos tudo com k-m√©dias e as estratificamos.  Nomeadamente, treinamos em palestrantes de um cluster e palestrantes previstos de outros.  Este m√©todo de valida√ß√£o j√° come√ßou a se correlacionar com a tabela de classifica√ß√£o, embora tenha mostrado uma pontua√ß√£o 3-4 vezes melhor.  Como alternativa, tentamos validar apenas as previs√µes nas quais o modelo era pelo menos um pouco inseguro, ou seja, a diferen√ßa entre a previs√£o e o r√≥tulo da classe era&gt; 10 ** - 4 (0,0001), mas esse esquema n√£o trouxe resultados. <br><br><h2>  E o que n√£o deu certo? </h2><br>  Na Internet, basta encontrar milhares de horas de fala humana.  Al√©m disso, uma competi√ß√£o semelhante j√° foi realizada h√° v√°rios anos.  Portanto, parecia uma id√©ia √≥bvia baixar muitos dados (baixamos ~ 300 GB) e treinar o classificador nisso.  Em alguns casos, o treinamento nesses dados provou ser um pouco se ensin√°ssemos dados adicionais e de treinamento antes de atingirmos um plat√¥ e depois trein√°ssemos apenas os dados de treinamento.  Mas com esse esquema, o modelo convergiu em cerca de 2 dias, o que significou 10 dias para todas as dobras.  Portanto, abandonamos essa ideia. <br><br>  Al√©m disso, muitos participantes notaram uma correla√ß√£o entre o tamanho do arquivo e a turma; essa correla√ß√£o n√£o foi observada na amostra de teste.  Grades de imagem comuns como resnext, nasnet-mobile, mobileNetV3 n√£o se mostraram muito bem. <br><br><h2>  Posf√°cio </h2><br>  N√£o foi f√°cil e √†s vezes estranho, mas ainda assim tivemos uma experi√™ncia interessante e sa√≠mos por cima.  Por tentativa e erro, percebi quais abordagens est√£o funcionando e quais n√£o s√£o muito boas.  Agora vou usar essas informa√ß√µes conosco ao processar o som.  Eu trabalho duro para levar a IA de conversa√ß√£o a um n√≠vel indistingu√≠vel do humano e, portanto, sempre na busca de tarefas e chips interessantes.  Espero que voc√™ tamb√©m tenha aprendido algo novo. <br><br>  Bem, finalmente, eu publico o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nosso c√≥digo</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt475480/">https://habr.com/ru/post/pt475480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt475468/index.html">O que h√° de errado com o experimento da Microsoft sobre uma semana de 4 dias ou n√£o perco a cabe√ßa ao ver 40% de efici√™ncia</a></li>
<li><a href="../pt475472/index.html">Por que o gelo √© escorregadio: uma resposta cient√≠fica a uma pergunta infantil</a></li>
<li><a href="../pt475474/index.html">XML quase sempre √© mal aplicado</a></li>
<li><a href="../pt475476/index.html">Data Mesh: como trabalhar com dados sem um mon√≥lito</a></li>
<li><a href="../pt475478/index.html">Experi√™ncia Netflix: Netflix Inside</a></li>
<li><a href="../pt475482/index.html">Como a tarefa de teste se tornou uma biblioteca de produ√ß√£o</a></li>
<li><a href="../pt475486/index.html">AR-criadores: o surgimento de uma nova profiss√£o</a></li>
<li><a href="../pt475488/index.html">Apresentando o PyTorch: Deep Learning em processamento de linguagem natural</a></li>
<li><a href="../pt475490/index.html">Trabalhar sob press√£o</a></li>
<li><a href="../pt475494/index.html">‚ÄúExiste vida depois do signor?‚Äù Ou sobre o que falaremos na SECR-2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>