<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐ปโ๐ ๐ ๐ฝ ุชุณุฑูุน ุงูุถุฑุจ ุงูุนุงุฆู 4x4 ูุน ูุตูููุฉ SIMD ๐ฐ๐พ ๐ง๐ฟ ๐ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏ ูุฑุช ุณููุงุช ุนุฏูุฏุฉ ููุฐ ุฃู ุชุนุฑูุช ุนูู ุงูุชุนูููุงุช MMX ู SSE ู AVX ุงููุงุญูุฉ ุนูู ูุนุงูุฌุงุช Intel. ูู ููุช ูู ุงูุฃููุงุช ุ ุจุฏูุง ููุฃููู ููุน ูู ุงูุณุญุฑ ุนูู ุฎูููุฉ ูุฌููุน...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุณุฑูุน ุงูุถุฑุจ ุงูุนุงุฆู 4x4 ูุน ูุตูููุฉ SIMD</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418247/" style=";text-align:right;direction:rtl">  ููุฏ ูุฑุช ุณููุงุช ุนุฏูุฏุฉ ููุฐ ุฃู ุชุนุฑูุช ุนูู ุงูุชุนูููุงุช MMX ู SSE ู AVX ุงููุงุญูุฉ ุนูู ูุนุงูุฌุงุช Intel.  ูู ููุช ูู ุงูุฃููุงุช ุ ุจุฏูุง ููุฃููู ููุน ูู ุงูุณุญุฑ ุนูู ุฎูููุฉ ูุฌููุน x86 ุ ุงูุฐู ูุงู ุดูุฆูุง ุฏูููููุง ููุฐ ูุชุฑุฉ ุทูููุฉ.  ููุฏ ุฑุจุทููู ูุซูุฑูุง ูุจู ุจุถุน ุณููุงุช ูุงู ูุฏู ููุฑุฉ ุฃู ุฃูุชุจ ุจุฑูุงูุฌ ุนุฑุถ ุงูุจุฑุงูุฌ ุงูุฎุงุต ุจู ููุนุจุฉ ูุงุญุฏุฉ ูุดููุฑุฉ.  ุงูุดูุก ุงูุฐู ูุนุฏ ุจูุฐู ุงูุชุนูููุงุช ูุนุฏูู ุจุฐูู.  ูู ูุฑุญูุฉ ูุง ุ ููุฑุช ุญุชู ูู ูุชุงุจุชูุง.  ููู ุงุชุถุญ ุฃู ูุชุงุจุฉ ุงููุต ุฃูุซุฑ ุชุนููุฏูุง ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ. <br><br>  ูู ุฐูู ุงูููุช ุ ููุช ุฃุฑุบุจ ูู ุชุฌูุจ ุงููุดุงูู ูุน ุฏุนู ุงููุนุงูุฌุงุช ุงููุฎุชููุฉ.  ุฃุฑุฏุช ุฃู ุฃุชููู ูู ุงูุชุญูู ูู ุงูุนุงุฑุถ ุงูุฎุงุต ุจู ุนูู ุฃูุตู ูุจูุบ ูุชุงุญ.  ูุง ูุฒุงู ูุฏู ุฃุตุฏูุงุก ูุน ูุนุงูุฌุงุช AMD ุงููุฏููุฉ ุ ููุงู ุณูููู SSE3.  ูุฐูู ุ ูู ุฐูู ุงูููุช ูุฑุฑุช ุฃู ุฃูุชุตุฑ ุนูู SSE3 ูุญุฏ ุฃูุตู.  ูุฐูู ูุงูุช ููุงู ููุชุจุฉ ุฑูุงุถูุฉ ูุชุฌูุฉ ุ ุฃูู ููููุงู ูู ุชูููุฐูุง ุจุงููุงูู ุนูู SSE ุ ูุน ุฅุฏุฑุงุฌ ูุงุฏุฑ ูุจู SSE3.  ููุน ุฐูู ุ ูู ูุฑุญูุฉ ูุง ุ ุชุณุงุกูุช ุนู ุงูุญุฏ ุงูุฃูุตู ููุฃุฏุงุก ุงูุฐู ูููููู ุงูุญุตูู ุนููู ูู ุงููุนุงูุฌ ูุนุฏุฏ ูู ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุงูุญุณุงุจูุฉ.  ุฅุญุฏู ูุฐู ุงูุนูููุงุช ูู ูุถุงุนูุฉ 4 ูุตูููุงุช ูู 4. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kg/ii/cq/kgiicqemuc5agmypikedjioaogc.jpeg"></div><a name="habracut"></a><br>  ูู ุงููุงูุน ุ ูุฑุฑุช ุฃู ุฃููู ุจูุฐุง ุงูุนูู ุฃูุซุฑ ูู ุฃุฌู ุงูุชุฑููู.  ููุฏ ูุชุจุช ุจุงููุนู ูููุช ุฃุณุชุฎุฏู ุถุฑุจ ุงููุตูููุงุช ูุนุฑุถ ุจุฑูุงูุฌู ุนูู SSE ููุจุฏู ุฃูู ูุงูู ุจุงููุณุจุฉ ูู.  ูููู ุจุนุฏ ุฐูู ูุฑุฑุช ุฃู ุฃุฑู ุนุฏุฏ ุงูุชุฏุงุจูุฑ ุงูุชู ูููููู ุงูุถุบุท ุนูููุง ูู ุญูุซ ุงููุจุฏุฃ ูู ุฎูุงู ุถุฑุจ ูุตูููุชูู ุนุดุฑูุชูู 4 ร 4.  ูู SSE ุงูุญุงูู ุ ูุฐู 16 ุฏูุฑุฉ ุณุงุนุฉ.  ุตุญูุญ ุฃู ุงูุชุญูู ุงูุฃุฎูุฑ ุฅูู <abbr title="ูุญูู ุฅูุชู ููุฏ ุงูุนูุงุฑุฉ">IACA</abbr> 3 ุจุฏุฃ ูู ุฅุธูุงุฑ 19 ุ ุญูุซ ุจุฏุฃุช ูู ูุชุงุจุฉ 1 * ูุจุนุถ ุงูุชุนูููุงุช ุจุฏูุงู ูู 0 *.  ูุจุฏู ุฃูู ูู ููุช ุณุงุจู ูุงู ูุฌุฑุฏ ุฎูู ูู ุงููุญูู. <br><br><h3 style=";text-align:right;direction:rtl">  ููุชุฑุฉ ูุฌูุฒุฉ ุญูู ุงููุฑุงูู ุงููุณุชุฎุฏูุฉ </h3><br>  ูุชุญููู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุ ุงุณุชุฎุฏูุช ุฃุฏุงุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Intel Code Code Analyzer</a> ุงูุดููุฑุฉ.  ููุชุญููู ุ ุงุณุชุฎุฏู ุจููุฉ Haswell (HSW) ุ ูุญุฏ ุฃุฏูู ูุน ุฏุนู AVX2.  ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุฃูุถูุง ูุฑูุญุฉ ุฌุฏูุง ููุงุณุชุฎุฏุงู: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏููู ุฅูุชู ุฅูุชุฑุณูุณ ูุฏููู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุญุณูู ุฅูุชู</a> . <br><br>  ููุชุฌููุน ุ ุฃุณุชุฎุฏู ูุฌุชูุน MSVS 2017 ูู ูุญุฏุฉ ุงูุชุญูู.  ุฃูุชุจ ุงูุฑูุฒ ูู ุงูุฅุตุฏุงุฑ ูุน ุงูุฌููุฑ.  ุชูุชุจ ูุฑุฉ ูุงุญุฏุฉ ุ ูุนุงุฏุฉ ูุง ุชุนูู ุนูู ุงูููุฑ ุนูู ููุตุงุช ูุฎุชููุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุง ูุฏุนู ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู x64 VC ++ ุฃุฏุงุฉ ุงูุชุฌููุน ุงููุถููุฉ ุ ููููู ุฃุฑูุฏ ุฃู ูุนูู ุชุญุช x64 ุฃูุถูุง. <br><br>  ูุธุฑูุง ูุฃู ูุฐู ุงูููุงูุฉ ุชุชุฌุงูุฒ ุฅูู ุญุฏ ูุง ูุณุชูู ุงููุจุชุฏุฆูู ูู ุจุฑูุฌุฉ SIMD ุ ููู ุฃุตู ุงูุชุณุฌููุงุช ุฃู ุงูุชุนูููุงุช ุฃู ุฑุณู (ุฃู ุญูุงูุฉ) ุตูุฑ ุฌูููุฉ ููุญุงููุฉ ุชุนูู ุงูุจุฑูุฌุฉ ุจุงุณุชุฎุฏุงู ุชุนูููุงุช SIMD.  ูููุน ุฅูุชู ูููุก ุจุงููุซุงุฆู ุงูููุชุงุฒุฉ ูุงููุงุถุญุฉ ูุงูููุตูุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุฃุฑุฏุช ุฃู ุฃุฌุนู ูู ุดูุก ุฃุณูู ... ูููู ุงุชุถุญ ููุง ูู ุงูุญุงู ุฏุงุฆููุง </h2><br>  ูุฐุง ูู ุงูููุงู ุงูุฐู ุชุจุฏุฃ ููู ุงููุญุธุฉ ุ ููุง ูุนูุฏ ุงููุซูุฑ ูู ุงูุชูููุฐ ูุงูููุงู.  ูุฐูู ุ ุณูู ุฃุชุทุฑู ุฅูู ุฐูู ููููุงู.  ููุณ ูู ุงููุซูุฑ ููุงูุชูุงู ุจุงููุณุจุฉ ูู ุฃู ุฃูุชุจ ุถุฑุจ ุงููุตูููุฉ ูุน ุชุฎุทูุท ุตู ููุงุณู ูู ุงูุนูุงุตุฑ.  ูู ุงุญุชุงุฌ ูุฐูู ุ ูุฏุฑุณูุง ูู ุงูุฌุงูุนุงุช ุฃู ุจููุฑุฏูู.  ูุฏููุง ูู ุงูุฅูุชุงุฌูุฉ.  ุฃููุงู ุ ููุฏ ุชุญููุช ุฅูู ุชุฎุทูุท ุงูุนููุฏ ููุฐ ูุชุฑุฉ ุทูููุฉ.  ูุณุชูุฏ ุนุงุฑุถ ุงูุจุฑุงูุฌ ุงูุฎุงุต ุจู ุฅูู OpenGL API ุ ูุจุงูุชุงูู ุ ูุชุฌูุจ ุนูููุงุช ุงูููู ุบูุฑ ุงูุถุฑูุฑูุฉ ุ ุจุฏุฃุช ูู ุชุฎุฒูู ุงูุนูุงุตุฑ ูู ุฃุนูุฏุฉ.  ูุฐุง ููู ุฃูุถูุง ูุฃู ุถุฑุจ ุงููุตูููุงุช ููุณ ุจุงูุบ ุงูุฃูููุฉ.  ุถุฑุจ ุงููุตูููุงุช 2-5-10 ุฌูุฏุง.  ูุฐุง ูู ูุง ูู ุงูุฃูุฑ.  ุซู ูุถุฑุจ ุงููุตูููุฉ ุงูููุงุฆูุฉ ุจุขูุงู ุฃู ููุงููู ุงูููู.  ููุฐู ุงูุนูููุฉ ุฃูุซุฑ ุฃูููุฉ.  ููููู ุ ุจุงูุทุจุน ุ ุชุจุฏูู ูู ูุฑุฉ.  ูููู ููุงุฐุง ุ ุฅุฐุง ูุงู ูู ุงููููู ุชุฌูุจ ุฐูู. <br><br>  ูููู ูุนูุฏ ุฅูู ุงููุตูููุงุช ุญุตุฑูุง.  ุญุฏุฏูุง ุงูุชุฎุฒูู ูู ุงูุฃุนูุฏุฉ.  ููุน ุฐูู ุ ูููู ุฃู ูููู ุฃูุซุฑ ุชุนููุฏูุง.  ูู ุงูุฃูุณุจ ุจุงููุณุจุฉ ูู ุชุฎุฒูู ุงูุนูุงุตุฑ ุงูุฃูุฏู ูููุชุฌูุงุช ูุตููู ุงููุตูููุฉ ูู ุณุฌูุงุช SIMD ุจุญูุซ ูููู <strong>x</strong> ูู ุฃุนูู ุชุนููู (ุงูููุฑุณ 3) ุ ู <strong>w</strong> ูู ุงููุงุตุฑ (ุงูููุฑุณ 0).  ููุง ุ ุนูู ูุง ูุจุฏู ุ ุณูุชุนูู ุนูููุง ุงูุชุฑุงุฌุน ูุฑุฉ ุฃุฎุฑู ุนู ุงูุณุจุจ. <br><br>  ุงูุดูุก ูู ุฃูู ูู ุนุงุฑุถ ุงูุจุฑุงูุฌ ูู ูุชุฌู ุ ูุฌุจ ุนููู ูุนุงูุฌุฉ ุงููููู <strong>w ูู</strong> ูุซูุฑ ูู ุงูุฃุญูุงู (ูุชู ุชุฎุฒูู <strong>1 / z</strong> ููุงู) ุ ููู ููุงุฆู ุฌุฏูุง ููููุงู ุจุฐูู ูู ุฎูุงู ุฅุตุฏุงุฑ <strong>_ss</strong> ูู ุงูุนูููุฉ (ุงูุนูููุงุช ุญุตุฑููุง ูุน ุงููููู ูู ุงูุนูุงูุฉ ุงูุณูููุฉ <em>ูุณุฌู xmm</em> ) ุ ุฏูู ููุณ <strong><nobr>x ุ y ุ ุถ</nobr></strong> .  ูุฐูู ุ ูู ุณุฌู SSE ุ ูุชู ุชุฎุฒูู ุงููุชุฌู ูู ุชุฑุชูุจ ูููููุฉ <strong><nobr>x ุ y ุ z ุ w</nobr></strong> ุ ูุฐุงูุฑุฉ ูู ุงูุงุชุฌุงู ุงููุนุงูุณ <strong><nobr>w ุ z ุ y ุ x</nobr></strong> . <br><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ูุชู ุชูููุฐ ุฌููุน ุฎูุงุฑุงุช ุงูุถุฑุจ ุฃูุถูุง ูู ุฎูุงู ุงููุธุงุฆู ุงููุฑุฏูุฉ.  ูุชู ุฐูู ูุฃููู ุฃุณุชุฎุฏููุง ูุงุณุชุจุฏุงู ุงูุฎูุงุฑ ุงููุทููุจ ุงุนุชูุงุฏูุง ุนูู ููุน ุงูุชุนูููุงุช ุงููุฏุนููุฉ.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุตู ุฌูุฏ ููุง.</a> <br><br><h2 style=";text-align:right;direction:rtl">  ูููู ุจุชุทุจูู ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ </h2><br><h3 style=";text-align:right;direction:rtl">  ุงูุถุฑุจ ูุน ุงูุญููุงุช ุ ุชุฑุชูุจ ุงูุตู </h3><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฎูุงุฑ ุชุฎุทูุท ุฎุท ุงูุนูุงุตุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++j) { r[i][j] = <span class="hljs-number"><span class="hljs-number">0.f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k = <span class="hljs-number"><span class="hljs-number">0</span></span>; k &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++k) { r[i][j] += m[i][k] * n[k][j]; } } }</code> </pre> <br></div></div><br>  ูู ุดูุก ุจุณูุท ููุงุถุญ ููุง.  ููู ุนูุตุฑ ูููู ุจู 4 ุถุฑุจุงุช ู 3 ุฅุถุงูุงุช.  ูู ุงููุฌููุน ุ ูุฐู 64 ูุถุงุนูุงุช ู 48 ุฅุถุงูุงุช.  ููุฐุง ุฏูู ุงูุฃุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ูุฑุงุกุฉ ุนูุงุตุฑ ุงูุณุฌู. <br><br>  ูู ุดูุก ุญุฒูู ุ ุจุงุฎุชุตุงุฑ.  ุจุงููุณุจุฉ ููุฐุง ุงูุฎูุงุฑ ุ ุจุงููุณุจุฉ ููุฏูุฑุฉ ุงูุฏุงุฎููุฉ ุ ุฃุตุฏุฑุช IACA: <em>3.65 ุฏูุฑุงุช ุณุงุนุฉ ูุชุฌููุน x86 ู 2.97 ุณุงุนุงุช ูุชุฌููุน x64</em> .  ูุง ุชุณุฃู ููุงุฐุง ุงูุฃุฑูุงู ุงููุณุฑูุฉ.  ูุง ุงุนุฑู.  IACA 2.1 ูู ูุนุงูู ูู ูุฐุง.  ุนูู ุฃู ุญุงู ุ ูุฌุจ ุถุฑุจ ูุฐู ุงูุฃุฑูุงู ุจุญูุงูู 4 * 4 * 4 = 64. ุญุชู ุฅุฐุง ููุช ุชุฃุฎุฐ x64 ุ ุชููู ุงููุชูุฌุฉ ุญูุงูู 192 ูููุงุณูุง.  ูู ุงููุงุถุญ ุฃู ูุฐุง ุชูุฏูุฑ ุชูุฑูุจู.  ูุง ุฃุฑู ูุงุฆุฏุฉ ูู ุชูููู ุงูุฃุฏุงุก ุจุดูู ุฃูุซุฑ ุฏูุฉ ููุฐุง ุงูุฎูุงุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  ุชูููุฐ ุงูุญููุงุช ุ ุฃูุฑ ุงูุนููุฏ </h3><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุตูููุฉ ุงููููููุฉ ุ ุฅุนุงุฏุฉ ุชุฑุชูุจ ูุคุดุฑุงุช ุงูุตู ูุงูุนููุฏ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++j) { r[j][i] = <span class="hljs-number"><span class="hljs-number">0.f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k = <span class="hljs-number"><span class="hljs-number">0</span></span>; k &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++k) { r[j][i] += m[k][i] * n[j][k]; } } }</code> </pre><br></div></div><br><h3 style=";text-align:right;direction:rtl">  ุฏูุฑุฉ ุงูุถุฑุจ ุ ุชุฎุฒูู ููุฌู SIMD </h3><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุถุงู ุชุฎุฒูู ุงูุฎุทูุท ุจุงูุชุฑุชูุจ ุงูุนูุณู ูู ุงูุฐุงูุฑุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++j) { r[j][<span class="hljs-number"><span class="hljs-number">3</span></span>-i] = <span class="hljs-number"><span class="hljs-number">0.f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k = <span class="hljs-number"><span class="hljs-number">0</span></span>; k &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++k) { r[j][<span class="hljs-number"><span class="hljs-number">3</span></span>-i] += m[k][<span class="hljs-number"><span class="hljs-number">3</span></span>-i] * n[j][<span class="hljs-number"><span class="hljs-number">3</span></span>-k]; } } }</code> </pre><br></div></div><br>  ูุจุณุท ูุฐุง ุงูุชูููุฐ ุฅูู ุญุฏ ูุง ููู ูุง ูุญุฏุซ ูู ุงูุฏุงุฎู ุ ูููู ูู ุงููุงุถุญ ุฃูู ุบูุฑ ูุงูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุฏุฑูุณ ุงููุณุงุนุฏ </h3><br>  ูู ุฃุฌู ุฑุงุญุฉ ููู ููุชุงุจุฉ ุงููุฑุฌุน ูููุฏ ุงูุชุตุญูุญ ุ ูู ุงูููุงุฆู ุชูููุฐ ูุฆุชูู ุฅุถุงููุชูู.  ูุง ุดูุก ุฃูุซุฑ ูู ุฐูู ุ ูู ุดูุก ูู ููุท ูู ุฃุฌู ุงูููู.  ุฃูุงุญุธ ุฃู ุชูููุฐ ูุฆุงุช ุงููุชุฌูุงุช ูุงููุตูููุฉ ุงููุงููุฉ ูู ุณุคุงู ุตุนุจ ูููุตู ุ ููุง ูุชู ุชุถูููู ูู ููุถูุน ูุฐู ุงูููุงูุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฆุงุช ุงููุชุฌูุงุช ูุงููุตูููุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">struct </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">alignas</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">sizeof</span></span></span></span><span class="hljs-function"><span class="hljs-params">(__m128))</span></span></span><span class="hljs-function"> vec4 </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> { <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> w, z, y, x; }; __m128 fmm; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> arr[<span class="hljs-number"><span class="hljs-number">4</span></span>]; }; vec4() {} vec4(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> a, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> b, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> c, <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> d) : w(d), z(c), y(b), x(a) {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equ</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> t = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">.00001</span></span></span></span><span class="hljs-function"><span class="hljs-params">f)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">fabs</span></span>(ab) &lt; t; } <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> == (vec4 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>&amp; v) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> equ(x, vx) &amp;&amp; equ(y, vy) &amp;&amp; equ(z, vz) &amp;&amp; equ(w, vw); } }; <span class="hljs-function"><span class="hljs-function">struct </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">alignas</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">sizeof</span></span></span></span><span class="hljs-function"><span class="hljs-params">(__m256))</span></span></span><span class="hljs-function"> mtx4 </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//           union { struct { float _30, _20, _10, _00, _31, _21, _11, _01, _32, _22, _12, _02, _33, _23, _13, _03; }; __m128 r[4]; __m256 s[2]; vec4 v[4]; }; //    mtx4() {} mtx4( float i00, float i01, float i02, float i03, float i10, float i11, float i12, float i13, float i20, float i21, float i22, float i23, float i30, float i31, float i32, float i33) : _00(i00), _01(i01), _02(i02), _03(i03) , _10(i10), _11(i11), _12(i12), _13(i13) , _20(i20), _21(i21), _22(i22), _23(i23) , _30(i30), _31(i31), _32(i32), _33(i33) {} //      operator __m128 const* () const { return r; } operator __m128* () { return r; } //   bool operator == (mtx4 const&amp; m) const { return v[0]==mv[0] &amp;&amp; v[1]==mv[1] &amp;&amp; v[2]==mv[2] &amp;&amp; v[3]==mv[3]; } //  static mtx4 identity() { return mtx4( 1.f, 0.f, 0.f, 0.f, 0.f, 1.f, 0.f, 0.f, 0.f, 0.f, 1.f, 0.f, 0.f, 0.f, 0.f, 1.f); } static mtx4 zero() { return mtx4( 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f, 0.f); } };</span></span></code> </pre><br></div></div><br><h3 style=";text-align:right;direction:rtl">  ุงููุธููุฉ ุงููุฑุฌุนูุฉ ููุงุฎุชุจุงุฑุงุช </h3><br>  ูุธุฑูุง ูุฃู ุงูุชุฑุชูุจ ุงูููุจูู ููุนูุงุตุฑ ูู ุงููุตูููุฉ ูุนูุฏ ุงูููู ูุซูุฑูุง ุ ููู ูุชุถุงูู ุฃูุถูุง ูู ุงููุธููุฉ ุงููุฑุฌุนูุฉ ุงููุงุจูุฉ <em>ููููู</em> ุ ูุงูุชู ุณุชุธูุฑ ูู ุนูููุงุช ุงูุชูููุฐ ุงููุณุชูุจููุฉ ุฃู ูู ุดูุก ูุนูู ุจุดูู ุตุญูุญ.  ุณูููู ุจููุงุฑูุฉ ุงููุชุงุฆุฌ ุงููุงุญูุฉ ูุนูุง. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฅูุดุงุฆู ุ ูุง ุนููู ุณูู ุฃุฎุฐ ุงูุฏูุฑุฉ ูุชูุณูุนูุง</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_unroll</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> _r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> _m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> _n)</span></span></span><span class="hljs-function"> </span></span>{ mtx4 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>&amp; m = **<span class="hljs-keyword"><span class="hljs-keyword">reinterpret_cast</span></span>&lt;mtx4 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>*&gt;(&amp;_m); mtx4 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>&amp; n = **<span class="hljs-keyword"><span class="hljs-keyword">reinterpret_cast</span></span>&lt;mtx4 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>* <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>*&gt;(&amp;_n); mtx4&amp; r = **<span class="hljs-keyword"><span class="hljs-keyword">reinterpret_cast</span></span>&lt;mtx4* <span class="hljs-keyword"><span class="hljs-keyword">const</span></span>*&gt;(&amp;_r); r._00 = m._00*n._00 + m._01*n._10 + m._02*n._20 + m._03*n._30; r._01 = m._00*n._01 + m._01*n._11 + m._02*n._21 + m._03*n._31; r._02 = m._00*n._02 + m._01*n._12 + m._02*n._22 + m._03*n._32; r._03 = m._00*n._03 + m._01*n._13 + m._02*n._23 + m._03*n._33; r._10 = m._10*n._00 + m._11*n._10 + m._12*n._20 + m._13*n._30; r._11 = m._10*n._01 + m._11*n._11 + m._12*n._21 + m._13*n._31; r._12 = m._10*n._02 + m._11*n._12 + m._12*n._22 + m._13*n._32; r._13 = m._10*n._03 + m._11*n._13 + m._12*n._23 + m._13*n._33; r._20 = m._20*n._00 + m._21*n._10 + m._22*n._20 + m._23*n._30; r._21 = m._20*n._01 + m._21*n._11 + m._22*n._21 + m._23*n._31; r._22 = m._20*n._02 + m._21*n._12 + m._22*n._22 + m._23*n._32; r._23 = m._20*n._03 + m._21*n._13 + m._22*n._23 + m._23*n._33; r._30 = m._30*n._00 + m._31*n._10 + m._32*n._20 + m._33*n._30; r._31 = m._30*n._01 + m._31*n._11 + m._32*n._21 + m._33*n._31; r._32 = m._30*n._02 + m._31*n._12 + m._32*n._22 + m._33*n._32; r._33 = m._30*n._03 + m._31*n._13 + m._32*n._23 + m._33*n._33; }</code> </pre><br></div></div><br>  ุชู ุฑุณู ุงูุฎูุงุฑุฒููุฉ ุงูููุงุณูููุฉ ุจูุถูุญ ููุง ุ ูู ุงูุตุนุจ ุงุฑุชูุงุจ ุฎุทุฃ (ูููู ููููู :-)).  ุนูู ุฐูู ุ ุฃุตุฏุฑุช IACA: <em>ุชุฏุงุจูุฑ x86 - 69.95 ุ x64 - 64 ุชุฏุงุจูุฑ</em> .  ููุง ุญูุงูู 64 ุฏูุฑุฉ ูุณููุธุฑ ูู ุชุณุฑูุน ูุฐู ุงูุนูููุฉ ูู ุงููุณุชูุจู. <br><br><h2 style=";text-align:right;direction:rtl">  ุชูููุฐ SSE </h2><br><h3 style=";text-align:right;direction:rtl">  ุฎูุงุฑุฒููุฉ SSE ุงูููุงุณูููุฉ </h3><br>  ููุงุฐุง ุงูููุงุณูููุฉุ  ูุฃูู ููุฐ ูุชุฑุฉ ุทูููุฉ ูู ุชูููุฐ <em>FVec</em> ูุฌุฒุก ูู MSVS.  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุณููุชุจ ููู ููุฏู ุนูุงุตุฑ ุงููุตูููุฉ ูู ุณุฌูุงุช SSE.  ูุจุฏู ุจุงููุนู ุฃุจุณุท ููุง.  ูุฌุฑุฏ ูุตูููุฉ ูููููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">//     00, 10, 20, 30 // m[0] -  SIMD /   01, 11, 21, 31 // m[1] 02, 12, 22, 32 // m[2] 03, 13, 23, 33 // m[3]</code> </pre><br>  ูุฃุฎุฐ ุฑูุฒ <em>ุฅูุบุงุก ุงูุชุณุฌูู</em> ูู ุงููุชุบูุฑ ุฃุนูุงู.  ุจุทุฑููุฉ ูุง ูู ุบูุฑ ูุฏู ูู SSE.  ุชุชููู ุฃูู ูุฌููุนุฉ ูู ุงูุตููู ูู ูุชุงุฆุฌ ุนููุฏ ุงููุตูููุฉ ุงููุงุชุฌุฉ: <em><nobr>r._00 ุ r._01 ุ r._02 ุ r._03</nobr></em> .  ูุฏููุง ูุฐุง ุงูุนููุฏ ุ ููููุง ุจุญุงุฌุฉ ุฅูู ุตู.  ูุนู ุ ู <strong>m</strong> ุ <strong>n</strong> ุชุจุฏู ุบูุฑ ููุงุฆูุฉ ููุญุณุงุจุงุช.  ูุฐูู ุ ูุนูุฏ ุชุฑุชูุจ ุฎุทูุท ุงูุฎูุงุฑุฒููุฉ ุจุญูุซ ุชููู ุงููุชูุฌุฉ <strong>r</strong> ุญูููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">//  ,     r[0] r00 = m00*n00 + m01*n10 + m02*n20 + m03*n30; r10 = m10*n00 + m11*n10 + m12*n20 + m13*n30; r20 = m20*n00 + m21*n10 + m22*n20 + m23*n30; r30 = m30*n00 + m31*n10 + m32*n20 + m33*n30; //  ,     r[1] r01 = m00*n01 + m01*n11 + m02*n21 + m03*n31; r11 = m10*n01 + m11*n11 + m12*n21 + m13*n31; r21 = m20*n01 + m21*n11 + m22*n21 + m23*n31; r31 = m30*n01 + m31*n11 + m32*n21 + m33*n31; //  ,     r[2] r02 = m00*n02 + m01*n12 + m02*n22 + m03*n32; r12 = m10*n02 + m11*n12 + m12*n22 + m13*n32; r22 = m20*n02 + m21*n12 + m22*n22 + m23*n32; r32 = m30*n02 + m31*n12 + m32*n22 + m33*n32; //  ,     r[3] r03 = m00*n03 + m01*n13 + m02*n23 + m03*n33; r13 = m10*n03 + m11*n13 + m12*n23 + m13*n33; r23 = m20*n03 + m21*n13 + m22*n23 + m23*n33; r33 = m30*n03 + m31*n13 + m32*n23 + m33*n33;</code> </pre><br>  ููู ูุฐุง ุจุงููุนู ุฃูุถู ุจูุซูุฑ.  ูุง ุงูุฐู ูุฑุงู ูู ุงููุงูุนุ  ููููุง ูุฃุนูุฏุฉ ุงูุฎูุงุฑุฒููุฉ ูู ูู ูุฌููุนุฉ ุ ูุฏููุง ุตููู ุงููุตูููุฉ <strong>m</strong> ุงููุนููุฉ: <br><pre style=";text-align:right;direction:rtl"> ู [0] = {00ุ10ุ20ุ30} ุ ู [1] = {01ุ11ุ21ุ31} ุ ู [2] = {02ุ12ุ22ุ32} ุ ู [3] = {03ุ13ุ23ุ33} ุ
</pre>  ุงูุชู ูุชู ุถุฑุจูุง ูู ููุณ ุนูุตุฑ ุงููุตูููุฉ <strong>n</strong> .  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ูููุฌููุนุฉ ุงูุฃููู ููู: <em>n._00ุ n._10ุ n._20ุ n._30</em> .  ูุนูุงุตุฑ ุงููุตูููุฉ <strong>n</strong> ููู ูุฌููุนุฉ ูู ุตููู ุงูุฎูุงุฑุฒููุฉ ุชููู ูุฑุฉ ุฃุฎุฑู ูู ุตู ูุงุญุฏ ูู ุงููุตูููุฉ. <br><br>  ุซู ูู ุดูุก ุจุณูุท: ูุฃุฎุฐ ุจุจุณุงุทุฉ ุตููู ุงููุตูููุฉ <strong>m</strong> ุญุณุจ ุงูููุฑุณ ุ ุฃูุง ุจุงููุณุจุฉ ููุนูุงุตุฑ <strong>n</strong> ุ ููุญู ูุฃุฎุฐ ุตููุง ููููู <em>ุจุชุจุฏูููุง</em> ุนุจุฑ ุฌููุน ุนูุงุตุฑ ุงูุณุฌู ุงูุฃุฑุจุนุฉ ูู ุฎูุงู ุชุนูููุงุช <em>ุงูุชุจุฏูู</em> ุ ููุถุฑุจ ูู ุตู ุงููุตูููุฉ <strong>m</strong> ูู ุงูุณุฌู.  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ููุนูุตุฑ <em>n._00</em> (ุชุฐูุฑ ุฃู ุชุญููู ูู ุงูุณุฌู ูู ููุฑุณ 3) ุ ูุณูููู: <pre style=";text-align:right;direction:rtl">  _mm_shuffle_ps (n [0]ุ n [0]ุ _MM_SHUFFLE (3ุ3ุ3ุ3)) </pre><br>  ูู ุดูู ูุจุณุท ุ ุชุจุฏู ุงูุฎูุงุฑุฒููุฉ ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">//   n[0]={00,10,20,30} r[0] = m[0] * n00 + m[1] * n10 + m[2] * n20 + m[3] * n30; //   n[1]={01,11,21,31} r[1] = m[0] * n01 + m[1] * n11 + m[2] * n21 + m[3] * n31; //   n[2]={02,12,22,32} r[2] = m[0] * n02 + m[1] * n12 + m[2] * n22 + m[3] * n32; //   n[3]={03,13,23,33} r[3] = m[0] * n03 + m[1] * n13 + m[2] * n23 + m[3] * n33;</code> </pre><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชุทุจูู SSE ุงูุฃุณุงุณู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_sse_v1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ r[<span class="hljs-number"><span class="hljs-number">0</span></span>] = _mm_add_ps( _mm_add_ps( _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">0</span></span>], n[<span class="hljs-number"><span class="hljs-number">0</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>))), _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">1</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">0</span></span>], n[<span class="hljs-number"><span class="hljs-number">0</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)))), _mm_add_ps( _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">0</span></span>], n[<span class="hljs-number"><span class="hljs-number">0</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>))), _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">3</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">0</span></span>], n[<span class="hljs-number"><span class="hljs-number">0</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>))))); r[<span class="hljs-number"><span class="hljs-number">1</span></span>] = _mm_add_ps( _mm_add_ps( _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">1</span></span>], n[<span class="hljs-number"><span class="hljs-number">1</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>))), _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">1</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">1</span></span>], n[<span class="hljs-number"><span class="hljs-number">1</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)))), _mm_add_ps( _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">1</span></span>], n[<span class="hljs-number"><span class="hljs-number">1</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>))), _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">3</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">1</span></span>], n[<span class="hljs-number"><span class="hljs-number">1</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>))))); r[<span class="hljs-number"><span class="hljs-number">2</span></span>] = _mm_add_ps( _mm_add_ps( _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">2</span></span>], n[<span class="hljs-number"><span class="hljs-number">2</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>))), _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">1</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">2</span></span>], n[<span class="hljs-number"><span class="hljs-number">2</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)))), _mm_add_ps( _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">2</span></span>], n[<span class="hljs-number"><span class="hljs-number">2</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>))), _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">3</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">2</span></span>], n[<span class="hljs-number"><span class="hljs-number">2</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>))))); r[<span class="hljs-number"><span class="hljs-number">3</span></span>] = _mm_add_ps( _mm_add_ps( _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">3</span></span>], n[<span class="hljs-number"><span class="hljs-number">3</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>))), _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">1</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">3</span></span>], n[<span class="hljs-number"><span class="hljs-number">3</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>)))), _mm_add_ps( _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">3</span></span>], n[<span class="hljs-number"><span class="hljs-number">3</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>))), _mm_mul_ps(m[<span class="hljs-number"><span class="hljs-number">3</span></span>], _mm_shuffle_ps(n[<span class="hljs-number"><span class="hljs-number">3</span></span>], n[<span class="hljs-number"><span class="hljs-number">3</span></span>], _MM_SHUFFLE(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>))))); }</code> </pre><br></div></div><br>  ุงูุขู ูุบูุฑ ุงูุนูุงุตุฑ <strong>n</strong> ูู ุงูุฎูุงุฑุฒููุฉ ุฅูู <em>ุงููุฑุงูุบุฉ</em> ุงูููุงุจูุฉ ุ ุงูุถุฑุจ ูู <em>_mm_mul_ps</em> ุ ุงููุฌููุน ุจููุฏุงุฑ <em>_mm_add_ps</em> ุ <em>ูุจุฐูู</em> ุชููู ูุฏ ุงูุชููุช.  ูุนูู.  ููู ุงูููุฏ ูุจุฏู ุฃุณูุฃ ุจูุซูุฑ ูู ุงูุฎูุงุฑุฒููุฉ ููุณูุง.  ุฅูู ูุฐุง ุงูุฑูุฒ ุ ุฃุตุฏุฑุช IACA: <em>x86 - 18.89 ุ x64 - 16 ุฏูุฑุฉ</em> .  ูุฐุง ูู 4 ูุฑุงุช ุฃุณุฑุน ูู ุณุงุจูุชูุง.  ูู SSE ุชุณุฌูู ุชุนููู 4th.  ุนูุงูุฉ ุฎุทูุฉ ุชูุฑูุจุง. <br><br><h4 style=";text-align:right;direction:rtl">  ุชุฒููู ุชูููุฐ SSE </h4><br>  ูุง ูุฒุงู ุ ูู ุงููุงููู ูุจุฏู ูุธูุนุง.  ุณูุญุงูู ุชุญุณูู ูุฐุง ุนู ุทุฑูู ูุชุงุจุฉ ุงููููู ูู ุงูุณูุฑ ุงููุญูู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุนูุงูู ุงูุชุดุบูู ูุงููุญุณูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//        ( -    namespace) __m128 operator + (__m128 const a, __m128 const b) { return _mm_add_ps(a, b); } __m128 operator - (__m128 const a, __m128 const b) { return _mm_sub_ps(a, b); } __m128 operator * (__m128 const a, __m128 const b) { return _mm_mul_ps(a, b); } __m128 operator / (__m128 const a, __m128 const b) { return _mm_div_ps(a, b); } //_mm_shuffle_ps(u, v, _MM_SHUFFLE(3,2,1,0))   shuf&lt;3,2,1,0&gt;(u, v) template &lt;int a, int b, int c, int d&gt; __m128 shuf(__m128 const u, __m128 const v) { return _mm_shuffle_ps(u, v, _MM_SHUFFLE(a, b, c, d)); } template &lt;int a, int b, int c, int d&gt; __m128 shuf(__m128 const v) { return _mm_shuffle_ps(v, v, _MM_SHUFFLE(a, b, c, d)); } //    template &lt;int i&gt; __m128 shuf(__m128 const u, __m128 const v) { return _mm_shuffle_ps(u, v, _MM_SHUFFLE(i, i, i, i)); } template &lt;int i&gt; __m128 shuf(__m128 const v) { return _mm_shuffle_ps(v, v, _MM_SHUFFLE(i, i, i, i)); } //  float       , //    ,    template &lt;int a, int b, int c, int d&gt; __m128 shufd(__m128 const v) { return _mm_castsi128_ps(_mm_shuffle_epi32(_mm_castps_si128(v), _MM_SHUFFLE(a, b, c, d))); } template &lt;int i&gt; __m128 shufd(__m128 const v) { return _mm_castsi128_ps(_mm_shuffle_epi32(_mm_castps_si128(v), _MM_SHUFFLE(i, i, i, i))); }</span></span></code> </pre><br></div></div><br>  ูููู ูููุชุฑุฌู ุฃู ูุฏูุฌ ูุฐู ุงููุธุงุฆู ุจุดูู ูุซุงูู (ุนูู ุงูุฑุบู ูู ุนุฏู ูุฌูุฏ __forceinline ุจุฃู ุดูู ูู ุงูุฃุดูุงู). <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฐุง ูุฅู ุงูููุฏ ูุชุญูู ...</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_sse_v2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ r[<span class="hljs-number"><span class="hljs-number">0</span></span>] = m[<span class="hljs-number"><span class="hljs-number">0</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">2</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]); r[<span class="hljs-number"><span class="hljs-number">1</span></span>] = m[<span class="hljs-number"><span class="hljs-number">0</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">2</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]); r[<span class="hljs-number"><span class="hljs-number">2</span></span>] = m[<span class="hljs-number"><span class="hljs-number">0</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">2</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]); r[<span class="hljs-number"><span class="hljs-number">3</span></span>] = m[<span class="hljs-number"><span class="hljs-number">0</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">2</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]) + m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]); }</code> </pre><br></div></div><br>  ููู ุจุงููุนู ุฃูุถู ุจูุซูุฑ ูุฃูุซุฑ ูุงุจููุฉ ูููุฑุงุกุฉ.  ุฅูู ุฐูู ุ ุฃูุชุฌุช IACA ุงููุชูุฌุฉ ุงููุชููุนุฉ ุชูุฑูุจูุง: <em>x86 - 19 (ูููุงุฐุง ูุง ุชููู ูุณุฑูุฉุ) ุ X64 - 16</em> .  ูู ุงููุงูุน ุ ูู ูุชุบูุฑ ุงูุฃุฏุงุก ุ ููู ุงูููุฏ ุฃูุซุฑ ุฌูุงูุง ููููููุง. <br><br><h4 style=";text-align:right;direction:rtl">  ูุณุงููุฉ ุถุฆููุฉ ูู ุงูุชุญุณูู ูู ุงููุณุชูุจู </h4><br>  ุฏุนููุง ููุฏู ุชุญุณูููุง ุขุฎุฑ ุนูู ูุณุชูู ุงููุธููุฉ ุงูุชู ุธูุฑุช ูุคุฎุฑูุง ูู ุงูุฅุตุฏุงุฑ ุงูุญุฏูุฏู.  ุนูููุฉ <em>ุงูุฅุถุงูุฉ ุงููุชุนุฏุฏุฉ (fma)</em> .  <em><nobr>fma (aุ bุ c) = a * b + c</nobr></em> . <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูููุฐ ุฅุถุงูุฉ ูุชุนุฏุฏุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">m128 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm_add_ps(_mm_mul_ps(a, b), c); }</code> </pre><br></div></div><br>  ููุงุฐุง ูุฐุง ุถุฑูุฑูุ  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ููุชุญุณูู ูู ุงููุณุชูุจู.  ุนูู ุณุจูู ุงููุซุงู ุ ููููู ุจุจุณุงุทุฉ ุงุณุชุจุฏุงู <em>mad</em> <em>fma</em> ูู ุงูุฑูุฒ ุงูููุงุฆู ูู ุฎูุงู ููุณ ูุญุฏุงุช ุงููุงูุฑู ุงูุชู ุชุฑูุฏูุง.  ููููุง ุณูุถุน ุงูุฃุณุงุณ ููุชุญุณูู ุงูุขู: <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุจุฏูู ูุน ุฅุถุงูุฉ ูุชุนุฏุฏุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_sse_v3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ r[<span class="hljs-number"><span class="hljs-number">0</span></span>] = mad(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]), m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>])) + mad(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]), m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>])); r[<span class="hljs-number"><span class="hljs-number">1</span></span>] = mad(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]), m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]) + mad(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]), m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>])); r[<span class="hljs-number"><span class="hljs-number">2</span></span>] = mad(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]), m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>])) + mad(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]), m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>])); r[<span class="hljs-number"><span class="hljs-number">3</span></span>] = mad(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]), m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>])) + mad(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]), m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>])); }</code> </pre><br></div></div><br>  IACA: <em>x86 - 18.89 ุ x64 - 16</em> .  ูุณุฑู ูุฑุฉ ุฃุฎุฑู.  ูุน ุฐูู ุ ููุชุฌ IACA ุฃุญูุงููุง ูุชุงุฆุฌ ุบุฑูุจุฉ.  ูู ูุชุบูุฑ ุงูุฑูุฒ ูุซูุฑุง.  ุฑุจูุง ุฃุณูุฃ ููููุง.  ููู ุงูุชุญุณูู ูุชุทูุจ ุฃุญูุงููุง ูุซู ูุฐู ุงูุชุถุญูุงุช. <br><br><h4 style=";text-align:right;direction:rtl">  ูุญู ููุฑ ุฅูู ุงูุญูุธ ูู ุฎูุงู _mm_stream </h4><br>  ุชูุตู ุฃุฏูุฉ ุงูุชุญุณูู ุงููุฎุชููุฉ ูุฑุฉ ุฃุฎุฑู ุจุนุฏู ุณุญุจ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุนูููุงุช ุงูุญูุธ ุงูุฌูุงุนู.  ุนุงุฏุฉ ูุง ูููู ูุฐุง ูุจุฑุฑูุง ุนูุฏูุง ุชููู ุจูุนุงูุฌุฉ ุงูููู ุงูุชู ุชุจูุบ ุขูุงู ุฃู ุฃูุซุฑ.  ูููู ุจุงููุณุจุฉ ูููุตูููุงุช ุ ุฑุจูุง ูุง ูููู ูุฐุง ููููุง.  ููุน ุฐูู ุ ุณุฃุถููู ุนูู ุฃู ุญุงู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุฎูุงุฑ ุญูุธ ุงูุฏูู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_sse_v4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ _mm_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">0</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], mad(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]), m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>])) + mad(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]), m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">0</span></span>]))); _mm_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">1</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], mad(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]), m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>])) + mad(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]), m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">1</span></span>]))); _mm_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">2</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], mad(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]), m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>])) + mad(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]), m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">2</span></span>]))); _mm_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">3</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], mad(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]), m[<span class="hljs-number"><span class="hljs-number">1</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>])) + mad(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], shuf&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]), m[<span class="hljs-number"><span class="hljs-number">3</span></span>]*shuf&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n[<span class="hljs-number"><span class="hljs-number">3</span></span>]))); }</code> </pre><br></div></div><br>  ูู ูุชุบูุฑ ุดูุก ูู ุงูููุช ุงูููุงุณุจ ููุง ุ ูู ุงููููุฉ ุนูู ุงูุฅุทูุงู.  ูููู ุ ููููุง ููุชูุตูุงุช ุ ูุง ูููุณ ุงูุขู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุฑุฉ ุฃุฎุฑู. <br><br><h2 style=";text-align:right;direction:rtl">  ุชูููุฐ AVX </h2><br><h3 style=";text-align:right;direction:rtl">  ุฎูุงุฑ AVX ุงูุฃุณุงุณู </h3><br><img src="https://habrastorage.org/webt/8d/l-/1r/8dl-1rgisfl2sqr0dhzmizkmawg.jpeg" align="right"><br>  ุจุนุฏ ุฐูู ุ ููุชูู ุฅูู ุงููุฑุญูุฉ ุงูุชุงููุฉ ูู ุงูุชุญุณูู.  ูุชู ุชุถููู ุงูุนูุงูุฉ ุงูุฑุงุจุนุฉ ูู ุณุฌู SSE ุ ููู AVX ูุจูุบ ุจุงููุนู 8. ุฃู ุ ููุงู ูุฑุตุฉ ูุธุฑูุฉ ูุชูููู ุนุฏุฏ ุงูุนูููุงุช ุงูุชู ูุชู ุฅุฌุฑุงุคูุง ุ ูุฒูุงุฏุฉ ุงูุฅูุชุงุฌูุฉ ุฅู ูู ููู ุจููุฏุงุฑ ุงููุตู ุ ุซู 1.5 ูุฑุฉ ุนูู ุงูุฃูู.  ููู ุดูุฆูุง ูุฎุจุฑูู ุฃูู ูู ูููู ูู ุดูุก ุจูุฐู ุงูุจุณุงุทุฉ ูุน ุงูุงูุชูุงู ุฅูู AVX.  ูู ูููููุง ุงูุญุตูู ุนูู ุงูุจูุงูุงุช ุงููุงุฒูุฉ ูู ุงูุณุฌูุงุช ุงููุฒุฏูุฌุฉุ <br><br>  ุฏุนููุง ูุญุงูู ูุนุฑูุฉ ุฐูู.  ูุฑุฉ ุฃุฎุฑู ุ ููุชุจ ุฎูุงุฑุฒููุฉ ุงูุถุฑุจ ุงููุณุชุฎุฏูุฉ ุฃุนูุงู.  ูุง ููููู ุงูููุงู ุจุฐูู ุ ูููู ูู ุงูุฃุณูู ุงูุชุนุงูู ูุน ุงูุฑูุฒ ุนูุฏูุง ูููู ูู ุดูุก ูุฑูุจูุง ููุง ูุชุนูู ุนููู ุงูุชูุฑูุฑ ูุฃุนูู ูุตู ุงูุตูุญุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">//    : 00, 10, 20, 30, 01, 11, 21, 31, 02, 12, 22, 32, 03, 13, 23, 33 //   SSE: r0 = m0*n00 + m1*n10 + m2*n20 + m3*n30 r1 = m0*n01 + m1*n11 + m2*n21 + m3*n31 r2 = m0*n02 + m1*n12 + m2*n22 + m3*n32 r3 = m0*n03 + m1*n13 + m2*n23 + m3*n33</code> </pre><br>  ุนูุฏ ุงูุฅุฎุฑุงุฌ ุ ูุชููุน ุงูุญุตูู ุนูู ุงููุชูุฌุฉ ูู <em><nobr>ymm = {r0: r1}</nobr></em> ู <em><nobr>ymm = {r2: r3}</nobr></em> .  ุฅุฐุง ูุงู ุฅุตุฏุงุฑ ุฎูุงุฑุฒููุงุชูุง ูู ุฅุตุฏุงุฑ SSE ูุนูููุง ููุฃุนูุฏุฉ ุ ูุณูุญุชุงุฌ ุงูุขู ุฅูู ุชุนููููุง ุนูู ุงูุตููู.  ูุฐุง ูุฅู ุงูุชุตุฑู ููุง ูู ุญุงูุฉ ุฎูุงุฑ SSE ูู ูุนูู. <br><br>  ุฅุฐุง ุฃุฎุฐูุง ุงููุตูููุฉ <strong>m</strong> ูู ุงูุชุณุฌููุงุช <em>ymm</em> ุ ูุญุตู ุนูู <em><nobr>ymm = {m0: m1}</nobr></em> ู <em><nobr>ymm = {m2: m3}</nobr></em> ุนูู ุงูุชูุงูู.  ูู ุงูุณุงุจู ุ ูุงู ูุฏููุง ุฃุนูุฏุฉ ูุตูููุฉ ููุท ูู ุงูุณุฌู ุ ูุงูุขู ุงูุฃุนูุฏุฉ ูุงูุตููู. <br><br>  ุฅุฐุง ุญุงููุช ุงูุชุตุฑู ููุง ูุงู ูู ูุจู ุ ููุฌุจ ุนููู ุถุฑุจ <em><nobr>ymm = {m0: m1}</nobr></em> ูู ุงูุชุณุฌูู <em><nobr>ymm = {n00ุ n00ุ n00ุ n00}: {n10ุ n10ุ n10ุ n10}</nobr></em> .  ูุธุฑูุง ูุฃู <em>n00</em> ู <em>n01 ููุฌูุฏุงู</em> ูู ููุณ ุงูุตู ูู ุงููุตูููุฉ <strong>n</strong> ุ ุจูุงุกู ุนูู ุงููุฌููุนุฉ ุงููุชุงุญุฉ ูู ุชุนูููุงุช AVX ุ ูุฅู <em>ุชูุงุซุฑูุง</em> ุจูุงุณุทุฉ <em>ymm</em> ุณูููู ูููููุง.  ูุนูู ูู ูู <em>ุงูุฎูุท ูุงูุชุจุฏูู</em> ุจุดูู ูููุตู ููู ูู ุฃุฑุจุน <em>ุนูุงูุงุช</em> (ุงุฑุชูุงุน ูููุฎูุถ <em>xmm</em> ) ุฏุงุฎู ุณุฌูุงุช <em>ymm</em> . <br><br>  ุฅุฐุง ุฃุฎุฐูุง <em>ymm</em> ูู ุงููุตูููุฉ <strong>n</strong> ุ ูุญุตู ุนูู ููุง ุงูุนูุตุฑูู <em>n00</em> ู <em>n10</em> ุจุฃุนูู 2 <em>xmm</em> ุฏุงุฎู ุณุฌู <em>ymm</em> .  <em><nobr>{n00ุ n10ุ n20ุ n30}: {n01ุ n11ุ n21ุ n31}</nobr></em> .  ุนุงุฏุฉ ุ ูููู ูุคุดุฑ ุงูุชุนูููุงุช ุงูููุฌูุฏุฉ ูู 0 ุฅูู 3. ููุชูุงูู ุงูุนูุงููู ุงูุนุงุฆูุฉ ุฏุงุฎู ุชุณุฌูู <em>xmm</em> ูุงุญุฏ ููุท ูู ุงุซููู ูู ุชุณุฌูู <em>ymm</em> ุงูุฏุงุฎูู.  ูุง ูููู ููู <em>n10</em> ูู <em>xmm</em> ุงูุฃูุจุฑ ุณูุงู ุฅูู ุงูุฃุตุบุฑ ุณูุงู.  ุซู ูุฌุจ ุชูุฑุงุฑ ูุฐุง ุงูุชุฑููุฒ ุนุฏุฉ ูุฑุงุช.  ูุง ูููููุง ุชุญูู ูุฐู ุงูุฎุณุงุฑุฉ ูู ุงูุชุฏุงุจูุฑ.  ูู ุงูุถุฑูุฑู ุงูุฎุฑูุฌ ุจุดูุก ุขุฎุฑ. <br><br>  ุงุนุชุฏูุง ุนูู ุชุนููู ุงูุฃุนูุฏุฉ ุ ูููู ุงูุขู ุงูุตููู.  ูุฐูู ุ ุณูุญุงูู ุงูุฐูุงุจ ุจุทุฑููุฉ ูุฎุชููุฉ ููููุงู.  ูุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ุงููุชูุฌุฉ ูู <em>{r0: r1}</em> .  ูุฐุง ูุนูู ุฃูู ูุฌุจ ุชุญุณูู ุงูุฎูุงุฑุฒููุฉ ููุณ ูู ุฎุทูุท ูููุตูุฉ ูู ุงูุฎูุงุฑุฒููุฉ ุ ูููู ูู ุฎุทูู ูู ููุช ูุงุญุฏ.  ูููุง ุ ูุง ูุงู ูุงูุตูุง ูู <em>ุฎูุท ูุฑู ุงููุนุจ</em> ุณูููู ุฅุถุงูุฉ ููุง.  ููุธุฑ ุฅูู ูุง ุณูููู ูุฏููุง ูู ุชุณุฌููุงุช <em>ymm</em> ุนูุฏูุง ูุนุชุจุฑ ุงููุตูููุฉ <strong>n</strong> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">n0n1 = {00, 10, 20, 30} : {01, 11, 21, 31} n2n3 = {02, 12, 22, 32} : {03, 13, 23, 33}</code> </pre><br>  ูุนู ุ ููุงุญุธ ุฃูู ูู ุฃุฌุฒุงุก <em>xmm</em> ูุฎุชููุฉ ูู ุชุณุฌูู <em>ymm</em> ูุฏููุง ุนูุงุตุฑ <em>00</em> ู <em>01</em> .  ูููู ูุถุงุนูุฉ ุงูุญุงูุฉ ุจุงูุชุณุฌูู ูู ุฎูุงู ุงูุฃูุฑ <em><nobr>permute</nobr></em> ูู <em><nobr>{_00 ุ _00 ุ _00 ุ _00}: {_ 01 ุ _01 ุ _01 ุ _01}</nobr></em> ุ ูุน ุงูุฅุดุงุฑุฉ ุฅูู ููุฑุณ ูุงุญุฏ ููุท ููู ูู ุฃุฌุฒุงุก <em>xmm</em> .  ูุฐุง ูู ุจุงูุถุจุท ูุง ูุญุชุงุฌู.  ูู ุงููุงูุน ุ ูุชู ุงุณุชุฎุฏุงู ุงููุนุงููุงุช ุฃูุถูุง ูู ุฎุทูุท ูุฎุชููุฉ.  ุงูุขู ููุท ูู ุชุณุฌูู <em>ymm</em> ุงูููุงุจู ููุถุฑุจ ุณูููู ูู ุงูุถุฑูุฑู ุงูุงุญุชูุงุธ ุจู <em>{m0: m0}</em> ุ ุฃู ุงูุตู ุงูุฃูู ุงูููุฑุฑ ูู ุงููุตูููุฉ <strong>m</strong> . <br><br>  ูุฐุง ุ ูุฑุณู ุงูุฎูุงุฑุฒููุฉ ุจูุฒูุฏ ูู ุงูุชูุงุตูู.  ููุฑุฃ ุงูุตููู ุงููุฒุฏูุฌุฉ ูููุตูููุฉ <strong>m</strong> ูู ุชุณุฌููุงุช <em>ymm</em> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">mm[0] = {m0:m0} mm[1] = {m1:m1} mm[2] = {m2:m2} mm[3] = {m3:m3}</code> </pre><br>  ุซู ุณูุญุณุจ ุงูุถุฑุจ ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">r0r1 = mm[0] * {n00,n00,n00,n00:n01,n01,n01,n01} + // permute&lt;3,3,3,3&gt;(n0n1) mm[1] * {n10,n10,n10,n10:n11,n11,n11,n11} + // permute&lt;2,2,2,2&gt;(n0n1) mm[2] * {n20,n20,n20,n20:n21,n21,n21,n21} + // permute&lt;1,1,1,1&gt;(n0n1) mm[3] * {n30,n30,n30,n30:n31,n31,n31,n31} // permute&lt;0,0,0,0&gt;(n0n1) r2r3 = mm[0] * {n02,n02,n02,n02:n03,n03,n03,n03} + // permute&lt;3,3,3,3&gt;(n2n3) mm[1] * {n12,n12,n12,n12:n13,n13,n13,n13} + // permute&lt;2,2,2,2&gt;(n2n3) mm[2] * {n22,n22,n22,n22:n23,n23,n23,n23} + // permute&lt;1,1,1,1&gt;(n2n3) mm[3] * {n32,n32,n32,n32:n33,n33,n33,n33} // permute&lt;0,0,0,0&gt;(n2n3)</code> </pre><br>  ูุนูุฏ ูุชุงุจุฉ ุฃูุซุฑ ูุถูุญุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">r0r1 = mm[0]*n0n1&lt;3,3,3,3&gt;+mm[1]*n0n1&lt;2,2,2,2&gt;+mm[2]*n0n1&lt;1,1,1,1&gt;+mm[3]*n0n1&lt;0,0,0,0&gt; r2r3 = mm[0]*n2n3&lt;3,3,3,3&gt;+mm[1]*n2n3&lt;2,2,2,2&gt;+mm[2]*n2n3&lt;1,1,1,1&gt;+mm[3]*n2n3&lt;0,0,0,0&gt;</code> </pre><br>  ุฃู ุจุดูู ูุจุณุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">r0r1 = mm[0]*n0n1&lt;3&gt; + mm[1]*n0n1&lt;2&gt; + mm[2]*n0n1&lt;1&gt; + mm[3]*n0n1&lt;0&gt; r2r3 = mm[0]*n2n3&lt;3&gt; + mm[1]*n2n3&lt;2&gt; + mm[2]*n2n3&lt;1&gt; + mm[3]*n2n3&lt;0&gt;</code> </pre><br>  ูุจุฏู ุฃู ูู ุดูุก ูุงุถุญ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุจูู ููุท ููุชุงุจุฉ ุงูุชูููุฐ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_avx_v1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ __m256 mm0 = _mm256_set_m128(m[<span class="hljs-number"><span class="hljs-number">0</span></span>], m[<span class="hljs-number"><span class="hljs-number">0</span></span>]); __m256 mm1 = _mm256_set_m128(m[<span class="hljs-number"><span class="hljs-number">1</span></span>], m[<span class="hljs-number"><span class="hljs-number">1</span></span>]); __m256 mm2 = _mm256_set_m128(m[<span class="hljs-number"><span class="hljs-number">2</span></span>], m[<span class="hljs-number"><span class="hljs-number">2</span></span>]); __m256 mm3 = _mm256_set_m128(m[<span class="hljs-number"><span class="hljs-number">3</span></span>], m[<span class="hljs-number"><span class="hljs-number">3</span></span>]); __m256 n0n1 = _mm256_load_ps(&amp;n[<span class="hljs-number"><span class="hljs-number">0</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>]); __m256 y1 = _mm256_permute_ps(n0n1, <span class="hljs-number"><span class="hljs-number">0xFF</span></span>);<span class="hljs-comment"><span class="hljs-comment">//3,3,3,3 __m256 y2 = _mm256_permute_ps(n0n1, 0xAA);//2,2,2,2 __m256 y3 = _mm256_permute_ps(n0n1, 0x55);//1,1,1,1 __m256 y4 = _mm256_permute_ps(n0n1, 0x00);//0,0,0,0 y1 = _mm256_mul_ps(y1, mm0); y2 = _mm256_mul_ps(y2, mm1); y3 = _mm256_mul_ps(y3, mm2); y4 = _mm256_mul_ps(y4, mm3); y1 = _mm256_add_ps(y1, y2); y3 = _mm256_add_ps(y3, y4); y1 = _mm256_add_ps(y1, y3); __m256 n2n3 = _mm256_load_ps(&amp;n[2].m128_f32[0]); __m256 y5 = _mm256_permute_ps(n2n3, 0xFF); __m256 y6 = _mm256_permute_ps(n2n3, 0xAA); __m256 y7 = _mm256_permute_ps(n2n3, 0x55); __m256 y8 = _mm256_permute_ps(n2n3, 0x00); y5 = _mm256_mul_ps(y5, mm0); y6 = _mm256_mul_ps(y6, mm1); y7 = _mm256_mul_ps(y7, mm2); y8 = _mm256_mul_ps(y8, mm3); y5 = _mm256_add_ps(y5, y6); y7 = _mm256_add_ps(y7, y8); y5 = _mm256_add_ps(y5, y7); _mm256_stream_ps(&amp;r[0].m128_f32[0], y1); _mm256_stream_ps(&amp;r[2].m128_f32[0], y5); }</span></span></code> </pre><br></div></div><br>  ูููุง ููู ุงูุฃุฑูุงู ุงููุซูุฑุฉ ููุงูุชูุงู ูู IACA: <em>x86 - 12.53 ุ x64 - 12</em> .  ุนูู ุงูุฑุบู ุ ุจุงูุทุจุน ุ ุฃุฑุฏุช ุฃูุถู.  ุบุงุจ ุนู ุดูุก. <br><br><h3 style=";text-align:right;direction:rtl">  AVX ุงูุฃูุซู ุจุงูุฅุถุงูุฉ ุฅูู ุงูุณูุฑ ุงููุญูู </h3><br>  ูุจุฏู ุฃูู ูู ุงูููุฏ ุฃุนูุงู ุ ูู ูุชู ุงุณุชุฎุฏุงู AVX ุจูุงูู ุทุงูุชู.  ูุฌุฏ ุฃูู ุจุฏูุงู ูู ุชุนููู ุณุทุฑูู ูุชุทุงุจููู ูู ุชุณุฌูู <strong>ymm</strong> ุ ูููููุง ุงุณุชุฎุฏุงู <em>ุงูุจุซ</em> ุ ูุงูุฐู ูููู ุฃู ูููุฃ ุชุณุฌูู <em>ymm</em> ุจููู <em>xmm</em> ูุชุทุงุจูุฉ.  ุฃูุถุง ุ ุนูู ุทูู ุงูุทุฑูู ุ ุฅุถุงูุฉ ุจุนุถ "ุงูุณูุฑ ุงููุญูู" ููุธุงุฆู AVX. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูููุฐ AVX ุงููุญุณู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">__m256 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> + (__m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a, __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_add_ps(a, b); } __m256 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> - (__m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a, __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_sub_ps(a, b); } __m256 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> * (__m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a, __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_mul_ps(a, b); } __m256 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> / (__m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a, __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_div_ps(a, b); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i&gt; __<span class="hljs-function"><span class="hljs-function">m256 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">perm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_permute_ps(v, _MM_SHUFFLE(i, i, i, i)); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> d&gt; __<span class="hljs-function"><span class="hljs-function">m256 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">perm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_permute_ps(v, _MM_SHUFFLE(a, b, c, d)); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j&gt; __<span class="hljs-function"><span class="hljs-function">m256 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">perm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_permutevar_ps(v, _mm256_set_epi32(i, i, i, i, j, j, j, j)); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> d, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> e, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> f, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> g, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> h&gt; __<span class="hljs-function"><span class="hljs-function">m256 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">perm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_permutevar_ps(v, _mm256_set_epi32(a, b, c, d, e, f, g, h)); } __<span class="hljs-function"><span class="hljs-function">m256 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, __m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b, __m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_add_ps(_mm256_mul_ps(a, b), c); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_avx_v2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mm[] { _mm256_broadcast_ps(m+<span class="hljs-number"><span class="hljs-number">0</span></span>), _mm256_broadcast_ps(m+<span class="hljs-number"><span class="hljs-number">1</span></span>), _mm256_broadcast_ps(m+<span class="hljs-number"><span class="hljs-number">2</span></span>), _mm256_broadcast_ps(m+<span class="hljs-number"><span class="hljs-number">3</span></span>) }; __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> n0n1 = _mm256_load_ps(&amp;n[<span class="hljs-number"><span class="hljs-number">0</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>]); _mm256_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">0</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], mad(perm&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n0n1), mm[<span class="hljs-number"><span class="hljs-number">0</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n0n1)*mm[<span class="hljs-number"><span class="hljs-number">1</span></span>])+ mad(perm&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n0n1), mm[<span class="hljs-number"><span class="hljs-number">2</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n0n1)*mm[<span class="hljs-number"><span class="hljs-number">3</span></span>])); __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> n2n3 = _mm256_load_ps(&amp;n[<span class="hljs-number"><span class="hljs-number">2</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>]); _mm256_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">2</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], mad(perm&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n2n3), mm[<span class="hljs-number"><span class="hljs-number">0</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n2n3)*mm[<span class="hljs-number"><span class="hljs-number">1</span></span>])+ mad(perm&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n2n3), mm[<span class="hljs-number"><span class="hljs-number">2</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n2n3)*mm[<span class="hljs-number"><span class="hljs-number">3</span></span>])); }</code> </pre><br></div></div><br>  ูููุง ุชููู ุงููุชุงุฆุฌ ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู.  ุชูุชุฌ IACA ุฃุฑูุงููุง: <em>x86 - 10 ุ x64 - 8.58</em> ุ ูุงูุชู ุชุจุฏู ุฃูุถู ุจูุซูุฑ ุ ูููู ูุง ุชุฒุงู ุบูุฑ ูุฑุชูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุฎูุงุฑ AVX + FMA (ููุงุฆู) </h3><br>  ูููู ุจูุญุงููุฉ ุฃุฎุฑู.  ุงูุขู ุณูููู ูู ุงูููุทูู ุงุณุชุฏุนุงุก ูุฌููุนุฉ ุชุนูููุงุช FMA ูุฑุฉ ุฃุฎุฑู ุ ุญูุซ ุชูุช ุฅุถุงูุชูุง ุฅูู ุงููุนุงูุฌุงุช ุจุนุฏ AVX.  ููุท ูู ุจุชุบููุฑ <em>ููู</em> ูุฑุฏู <em>+ ุฃุถู</em> ูุนูููุฉ ูุงุญุฏุฉ.  ุนูู ุงูุฑุบู ูู ุฃููุง ูุง ุฒููุง ูุณุชุฎุฏู ุชุนูููุงุช ุงูุถุฑุจ ูุฅุนุทุงุก ุงููุชุฑุฌู ุงููุฒูุฏ ูู ุงููุฑุต ููุชุญุณูู ุ ูุงููุนุงูุฌ ููุชูููุฐ ุงููุชูุงุฒู ูููุถุงุนูุงุช.  ุนุงุฏุฉู ูุง ุฃููู ูุธุฑุฉ ุนูู ุงูุฑูุฒ ุงูุฐู ุชู ุฅูุดุงุคู ูู ุฃุฏุงุฉ ุงูุชุฌููุน ููุชุฃูุฏ ูู ุงูุฎูุงุฑ ุงูุฃูุถู. <br><br>  ูู ูุฐู ุงูุญุงูุฉ ุ ูุญุชุงุฌ ุฅูู ุญุณุงุจ <em><nobr>a * b + c * d + e * f + g * h</nobr></em> .  ููููู ุงูููุงู ุจูุฐุง ุงูุฌุจูู: <em><nobr>fma (aุ bุ fma (cุ dุ fma (eุ fุ g * h)))</nobr></em> .  ูููู ุ ููุง ูุฑู ุ ูู ุงููุณุชุญูู ุฅุฌุฑุงุก ุนูููุฉ ูุงุญุฏุฉ ููุง ุฏูู ุฅููุงู ุงูุนูููุฉ ุงูุณุงุจูุฉ.  ููุฐุง ูุนูู ุฃููุง ูู ูููู ูุงุฏุฑูู ุนูู ุงุณุชุฎุฏุงู ุงููุฏุฑุฉ ุนูู ุงูููุงู ุจุงููุถุงุนูุงุช ุงููุฒุฏูุฌุฉ ุ ููุง ูุณูุญ ููุง ุฎุท ุฃูุงุจูุจ SIMD ุจุฐูู.  ุฅุฐุง ูููุง ุจุชุญููู ุงูุญุณุงุจุงุช <em><nobr>fma ููููุงู (aุ bุ c * d) + fma (eุ fุ g * h)</nobr></em> ุ ูุณูู ูุฑู ุฃูู ูููููุง ููุงุฒุงุฉ ุงูุญุณุงุจุงุช.  ุฃููุงู ูู ุจุนูู <em>ูุถุงุนูุชูู</em> ูุณุชููุชูู ุ ุซู ุนูููุชู <em>fma</em> ูุณุชููุชูู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูููุฐ AVX + FMA</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">m256 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fma</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, __m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b, __m256 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm256_fmadd_ps(a, b, c); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_avx_fma</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span><span class="hljs-function"> </span></span>{ __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mm[]{ _mm256_broadcast_ps(m + <span class="hljs-number"><span class="hljs-number">0</span></span>), _mm256_broadcast_ps(m + <span class="hljs-number"><span class="hljs-number">1</span></span>), _mm256_broadcast_ps(m + <span class="hljs-number"><span class="hljs-number">2</span></span>), _mm256_broadcast_ps(m + <span class="hljs-number"><span class="hljs-number">3</span></span>) }; __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> n0n1 = _mm256_load_ps(&amp;n[<span class="hljs-number"><span class="hljs-number">0</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>]); _mm256_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">0</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], fma(perm&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n0n1), mm[<span class="hljs-number"><span class="hljs-number">0</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n0n1)*mm[<span class="hljs-number"><span class="hljs-number">1</span></span>])+ fma(perm&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n0n1), mm[<span class="hljs-number"><span class="hljs-number">2</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n0n1)*mm[<span class="hljs-number"><span class="hljs-number">3</span></span>])); __m256 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> n2n3 = _mm256_load_ps(&amp;n[<span class="hljs-number"><span class="hljs-number">2</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>]); _mm256_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">2</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], fma(perm&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n2n3), mm[<span class="hljs-number"><span class="hljs-number">0</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n2n3)*mm[<span class="hljs-number"><span class="hljs-number">1</span></span>])+ fma(perm&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n2n3), mm[<span class="hljs-number"><span class="hljs-number">2</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n2n3)*mm[<span class="hljs-number"><span class="hljs-number">3</span></span>])); }</code> </pre><br></div></div><br>  IACA: <em>x86 - 9.21 ุ x64 - 8</em> .  ุงูุขู ุฌูุฏ ุฌุฏูุง.  ุฑุจูุง ุณูููู ุดุฎุต ูุง ูุง ูููู ุงูููุงู ุจู ุจุดูู ุฃูุถู ุ ูููู ูุง ุฃุนุฑู ููู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงููุนุงููุฑ </h2><br>  ุฃูุงุญุธ ุนูู ุงูููุฑ ุฃู ูุฐู ุงูุฃุฑูุงู ูุง ููุจุบู ุงุนุชุจุงุฑูุง ุงูุญูููุฉ ุงููุทููุฉ.  ุญุชู ูุน ุงุฎุชุจุงุฑ ุซุงุจุช ุ ูุณุจุญูู ูู ุญุฏูุฏ ูุนููุฉ.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจู ูุฃูุซุฑ ูู ุฐูู ูุชุตุฑููู ุจุดูู ูุฎุชูู ุนูู ููุตุงุช ูุฎุชููุฉ. </font><font style="vertical-align: inherit;">ูุน ุฃู ุชุญุณูู ุ ุฎุฐ ููุงุณุงุช ุฎุงุตุฉ ูุญุงูุชู.</font></font><br><br><h4 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฌุฏูู ุงููุญุชููุงุช </font></font></h4><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุธููุฉ: ุงุณู ุงููุธููุฉ. </font><font style="vertical-align: inherit;">ุชุนูู ุงูููุงูุฉ ุนูู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ูุน ุฏูู ุ ุญุฑูุฉ ุนุงุฏูุฉ ูุฎุชููุฉ (ุจุฏูู ุฏูู). </font><font style="vertical-align: inherit;">ุฃุถููุช ูููุถูุญ ุ ูุฃู ูุฐุง ููู ุจูุง ููู ุงูููุงูุฉ.</font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฏูุฑุงุช IACA: ุนุฏุฏ ุนูุงูุงุช ุงูุชุฌุฒุฆุฉ ููู ูุธููุฉ ูุญุณูุจุฉ ุจูุงุณุทุฉ IACA </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฏูุฑุงุช ุงูููุงุณุฉ: ุนุฏุฏ ุงูููุงููุณ ุงูููุงุณุฉ (ุฃูู ูู ุฃูุซุฑ) </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุณุฑูุน IACA: ุนุฏุฏ ุงูููุงุณุงุช ูู ุฎุท ุตูุฑู / ุนุฏุฏ ุงูููุงุณุงุช ูู ุฎุท </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุชุณุงุฑุน ุงูููุงุณ: ุนุฏุฏ ุงูููุงุณุงุช ูู ุฎุท ุงูุตูุฑ / ุนุฏุฏ ุงูููุงุณุงุช ูู ุงูุฎุท (ูููุง ูุงู ุฐูู ุฃูุถู) </font></font></li></ul><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ุฅูู loop_m ุ ุชู ุถุฑุจ ุงููุฑุงุฏ ูู ุงูููุงูุฉ ูู 64. ุฃู ุฃู ูุฐู ูููุฉ ุชูุฑูุจูุฉ ุฌุฏูุง. </font><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ุงุชุถุญ ุฐูู.</font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i3-3770: </font></font></h3><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ร 86</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><th> Function </th><th> IACA cycles </th><th> Measured cycles </th><th> IACA speedup </th><th> Measured speedup </th></tr><tr><th> unroll_m </th><th> 70.00 </th><th> 50.75 </th><th> 1.00 </th><th> 1.00 </th></tr><tr><th> loop_m </th><th> 233.60 </th><th> 119.21 </th><th> 0.30 </th><th> 0.43 </th></tr><tr><th> sse_v1m </th><th> 18.89 </th><th> 27.51 </th><th> 3.70 </th><th> 1.84 </th></tr><tr><th> sse_v2m </th><th> 19.00 </th><th> 27.61 </th><th> 3.68 </th><th> 1.84 </th></tr><tr><th> sse_v3m </th><th> 18.89 </th><th> 27.22 </th><th> 3.70 </th><th> 1.86 </th></tr><tr><th> sse_v4s </th><th> 18.89 </th><th> 27.18 </th><th> 3.70 </th><th> 1.87 </th></tr><tr><th> avx_v1m </th><th> 13.00 </th><th> 19.21 </th><th> 5.38 </th><th> 2.64 </th></tr><tr><th> avx_v1s </th><th> 13.00 </th><th> 20.03 </th><th> 5.38 </th><th> 2.53 </th></tr><tr><th> avx_v2m </th><th> 10.00 </th><th> 12.91 </th><th> 6.99 </th><th> 3.93 </th></tr><tr><th> avx_v2s </th><th> 10.00 </th><th> 17.34 </th><th> 6.99 </th><th> 2.93 </th></tr></tbody></table></div></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู x64</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><th> Function </th><th> IACA cycles </th><th> Measured cycles </th><th> IACA speedup </th><th> Measured speedup </th></tr><tr><th> unroll_m </th><th>  70 </th><th> 68.60 </th><th> 1.00 </th><th> 1.00 </th></tr><tr><th> loop_m </th><th> 233.60 </th><th> 119.37 </th><th> 0.30 </th><th> 0.57 </th></tr><tr><th> sse_v1m </th><th> 18.89 </th><th> 21.98 </th><th> 3.70 </th><th> 3.12 </th></tr><tr><th> sse_v2m </th><th> 19.00 </th><th> 21.09 </th><th> 3.68 </th><th> 3.25 </th></tr><tr><th> sse_v3m </th><th> 18.89 </th><th> 22.19 </th><th> 3.70 </th><th> 3.09 </th></tr><tr><th> sse_v4s </th><th> 18.89 </th><th> 22.39 </th><th> 3.70 </th><th> 3.06 </th></tr><tr><th> avx_v1m </th><th> 13.00 </th><th> 9.61 </th><th> 5.38 </th><th> 7.13 </th></tr><tr><th> avx_v1s </th><th> 13.00 </th><th> 16.90 </th><th> 5.38 </th><th> 4.06 </th></tr><tr><th> avx_v2m </th><th> 10.00 </th><th> 9.20 </th><th> 6.99 </th><th> 7.45 </th></tr><tr><th> avx_v2s </th><th> 10.00 </th><th> 14.64 </th><th> 6.99 </th><th> 4.68 </th></tr></tbody></table></div></div></div><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> i7-8700 ู: </font></font></h3><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ร 86</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><th> Function </th><th> IACA cycles </th><th> Measured cycles </th><th> IACA speedup </th><th> Measured speedup </th></tr><tr><th> unroll_m </th><th> 69.95 </th><th> 40.25 </th><th> 1.00 </th><th> 1.00 </th></tr><tr><th> loop_m </th><th> 233.60 </th><th> 79.49 </th><th> 0.30 </th><th> 0.51 </th></tr><tr><th> sse_v1m </th><th> 18.89 </th><th> 19.31 </th><th> 3.70 </th><th> 2.09 </th></tr><tr><th> sse_v2m </th><th> 19.00 </th><th> 19.98 </th><th> 3.68 </th><th> 2.01 </th></tr><tr><th> sse_v3m </th><th> 18.89 </th><th> 19.69 </th><th> 3.70 </th><th> 2.04 </th></tr><tr><th> sse_v4s </th><th> 18.89 </th><th> 19.67 </th><th> 3.70 </th><th> 2.05 </th></tr><tr><th> avx_v1m </th><th> 13.00 </th><th> 14.22 </th><th> 5.38 </th><th> 2.83 </th></tr><tr><th> avx_v1s </th><th> 13.00 </th><th> 14.13 </th><th> 5.38 </th><th> 2.85 </th></tr><tr><th> avx_v2m </th><th> 10.00 </th><th> 11.73 </th><th> 6.99 </th><th> 3.43 </th></tr><tr><th> avx_v2s </th><th> 10.00 </th><th> 11.81 </th><th> 6.99 </th><th> 3.41 </th></tr><tr><th> AVX+FMAm </th><th> 9.21 </th><th> 10.38 </th><th> 7.60 </th><th> 3.88 </th></tr><tr><th> AVX+FMAs </th><th> 9.21 </th><th> 10.32 </th><th> 7.60 </th><th> 3.90 </th></tr></tbody></table></div></div></div><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู x64</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><th> Function </th><th> IACA cycles </th><th> Measured cycles </th><th> IACA speedup </th><th> Measured speedup </th></tr><tr><th> unroll_m </th><th> 69.95 </th><th> 57.11 </th><th> 1.00 </th><th> 1.00 </th></tr><tr><th> loop_m </th><th> 233.60 </th><th> 75.73 </th><th> 0.30 </th><th> 0.75 </th></tr><tr><th> sse_v1m </th><th> 18.89 </th><th> 15.83 </th><th> 3.70 </th><th> 3.61 </th></tr><tr><th> sse_v2m </th><th> 19.00 </th><th> 17.22 </th><th> 3.68 </th><th> 3.32 </th></tr><tr><th> sse_v3m </th><th> 18.89 </th><th> 15.92 </th><th> 3.70 </th><th> 3.59 </th></tr><tr><th> sse_v4s </th><th> 18.89 </th><th> 16.18 </th><th> 3.70 </th><th> 3.53 </th></tr><tr><th> avx_v1m </th><th> 13.00 </th><th> 7.03 </th><th> 5.38 </th><th> 8.12 </th></tr><tr><th> avx_v1s </th><th> 13.00 </th><th> 12.98 </th><th> 5.38 </th><th> 4.40 </th></tr><tr><th> avx_v2m </th><th> 10.00 </th><th> 5.40 </th><th> 6.99 </th><th> 10.57 </th></tr><tr><th> avx_v2s </th><th> 10.00 </th><th> 11.39 </th><th> 6.99 </th><th> 5.01 </th></tr><tr><th> AVX+FMAm </th><th> 9.21 </th><th> 9.73 </th><th> 7.60 </th><th> 5.87 </th></tr><tr><th> AVX+FMAs </th><th> 9.21 </th><th> 9.81 </th><th> 7.60 </th><th> 5.82 </th></tr></tbody></table></div></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุฏ ุงูุงุฎุชุจุงุฑ ูู ุงููุตุฏุฑ. </font><font style="vertical-align: inherit;">ุฅุฐุง ูุงูุช ููุงู ุงูุชุฑุงุญุงุช ูุนูููุฉ ุญูู ููููุฉ ุชุญุณูููุง ุ ูุงูุชุจ ูู ุงูุชุนูููุงุช.</font></font><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุงูุฃุฉ ูู ุนุงูู ุงูุฎูุงู </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ุฅูู ูู ุนุงูู ุงูุฎูุงู ูุฃูู ุฅุฐุง ุฑุฃูุช ูุนุงูุฌุงุช ุชุฏุนู AVX512 ุ ูุฑุจูุง ูู ุงูุตูุฑ. </font><font style="vertical-align: inherit;">ููุน ุฐูู ุ ุญุงููุช ุชูููุฐ ุงูุฎูุงุฑุฒููุฉ. </font><font style="vertical-align: inherit;">ููุง ูู ุฃุดุฑุญ ุฃู ุดูุก ุ ุชุดุจูููุง ูุงููุงู ูุน AVX + FMA. </font><font style="vertical-align: inherit;">ุงูุฎูุงุฑุฒููุฉ ูู ููุณูุง ุ ุนูููุงุช ุฃูู ููุท.</font></font><br><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง ูููููู ุ ุณุฃุชุฑู ุงูุฃูุฑ ููุง</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">__m512 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> + (__m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a, __m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm512_add_ps(a, b); } __m512 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> - (__m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a, __m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm512_sub_ps(a, b); } __m512 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> * (__m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a, __m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm512_mul_ps(a, b); } __m512 <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> / (__m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a, __m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm512_div_ps(a, b); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i&gt; __<span class="hljs-function"><span class="hljs-function">m512 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">perm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m512 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm512_permute_ps(v, _MM_SHUFFLE(i, i, i, i)); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> d&gt; __<span class="hljs-function"><span class="hljs-function">m512 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">perm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m512 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> v)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm512_permute_ps(v, _MM_SHUFFLE(a, b, c, d)); } __<span class="hljs-function"><span class="hljs-function">m512 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fma</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m512 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a, __m512 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> b, __m512 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> c)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _mm512_fmadd_ps(a, b, c); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mul_mtx4_mtx4_avx512</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(__m128* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, __m128 </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> _n)</span></span></span><span class="hljs-function"> </span></span>{ __m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> mm[]{ _mm512_broadcast_f32x4(m[<span class="hljs-number"><span class="hljs-number">0</span></span>]), _mm512_broadcast_f32x4(m[<span class="hljs-number"><span class="hljs-number">1</span></span>]), _mm512_broadcast_f32x4(m[<span class="hljs-number"><span class="hljs-number">2</span></span>]), _mm512_broadcast_f32x4(m[<span class="hljs-number"><span class="hljs-number">3</span></span>]) }; __m512 <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> n = _mm512_load_ps(&amp;_n[<span class="hljs-number"><span class="hljs-number">0</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>]); _mm512_stream_ps(&amp;r[<span class="hljs-number"><span class="hljs-number">0</span></span>].m128_f32[<span class="hljs-number"><span class="hljs-number">0</span></span>], fma(perm&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;(n), mm[<span class="hljs-number"><span class="hljs-number">0</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;(n)*mm[<span class="hljs-number"><span class="hljs-number">1</span></span>])+ fma(perm&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;(n), mm[<span class="hljs-number"><span class="hljs-number">2</span></span>], perm&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;(n)*mm[<span class="hljs-number"><span class="hljs-number">3</span></span>])); }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุฑูุงู ุฑุงุฆุนุฉ: </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x86 - 4.79 ุ x64 - 5.42</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (IACA ูุน ุจููุฉ SKX). </font><font style="vertical-align: inherit;">ูุฐุง ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ุงูุฎูุงุฑุฒููุฉ ูุฏููุง 64 ูุถุงุนูุงุช ู 48 ุฅุถุงูุงุช.</font></font><br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฏ PS ูู ุงูููุงูุฉ </font></font></h2><br><div class="oembed" style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://github.com/truthfinder/mul_m4_m4</font></font></a> </div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐู ุชุฌุฑุจุชู ุงูุฃููู ูู ูุชุงุจุฉ ููุงู. </font><font style="vertical-align: inherit;">ุดูุฑุง ููู ุฌููุนุง ุนูู ุชุนูููุงุชูู. </font><font style="vertical-align: inherit;">ูุณุงุนุฏูู ูู ุฌุนู ุงูุดูุฑุฉ ูุงูููุงู ุฃูุถู.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar418247/">https://habr.com/ru/post/ar418247/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar418237/index.html">ุชุทููุฑ ุชุทุจููุงุช ูุชุนุฏุฏุฉ ุงููุณุชุฃุฌุฑูู ุนูู SAP Cloud Platform ูู Neo ุ ุงูุฌุฒุก 2: ุงูุชูููุถ ูุงููุตุงุฏูุฉ</a></li>
<li><a href="../ar418239/index.html">48 ููุฌุงุจูุณู ูููุงุชู ุงูุฐูู</a></li>
<li><a href="../ar418241/index.html">ููุงุฐุง ุบุงูุณุ (100 ุทุฑููุฉ ูุญู ูุธุงู ุงููุนุงุฏูุงุช)</a></li>
<li><a href="../ar418243/index.html">ุงูุชุงุฑูุฎ ุงูุดุนุจู ูุนูู ุงูููู ุฎุทุฃ</a></li>
<li><a href="../ar418245/index.html">ููููุฉ ุนุฏู ุชุทููุฑ ูุดุฑูุน ุนูู Bitrix</a></li>
<li><a href="../ar418249/index.html">ุตูุฑ ุฌุฏูุฏุฉ ููุญุฑู Google Compute Engine ููุชุนูู ุงูุนููู</a></li>
<li><a href="../ar418251/index.html">ุฑุคูุฉ ุงูููุจููุชุฑ: ููู ุชุฑุงูุจูุง ููุธูุฉ ุงูุนูู ุงูุฏูููุฉ</a></li>
<li><a href="../ar418253/index.html">ูููู ุฃู ูููู ููููุฑ ุงููุจูุฑ ุงููุงุก ูุงูุฌู ูุงูุญูุงุฉ</a></li>
<li><a href="../ar418255/index.html">ููููุฉ ุฅุนุงุฏุฉ ุจูุน ุงูุชุจุงุฏู ุงููุฑูุฑู ููุชุตูุญ ุงูุชููุงุฆู ูุฃูู ุชุฃุชู ููุงููู ุงูุฑูุจูุชุงุช ุนุจุฑ ุงูุฅูุชุฑูุช</a></li>
<li><a href="../ar418257/index.html">ูุฑูุถ Github.com ุงุณุชุฎุฏุงู jQuery ูุงูุชุจุฏูู ุฅูู JavaScript ุฎุงูุต</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>