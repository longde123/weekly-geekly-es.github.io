<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåì üìµ üÜñ La participation a √©chou√©: nous amenons AgentTesla √† l'eau potable. 2e partie üôà üë©üèº‚Äç‚úàÔ∏è üöú</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous continuons une s√©rie d'articles sur l'analyse des logiciels malveillants. Dans la premi√®re partie, nous avons expliqu√© comment Ilya Pomerantsev, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La participation a √©chou√©: nous amenons AgentTesla √† l'eau potable. 2e partie</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/479120/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vz/an/r5/vzanr5kxitvhd3zqrcdh1qhctjm.png"></div><br>  Nous continuons une s√©rie d'articles sur l'analyse des logiciels malveillants.  Dans la <a href="https://habr.com/ru/company/group-ib/blog/478176/">premi√®re</a> partie, nous avons expliqu√© comment Ilya Pomerantsev, experte en analyse de codes malveillants au CERT Group-IB, a effectu√© une analyse d√©taill√©e d'un fichier re√ßu par courrier d'une des soci√©t√©s europ√©ennes et y a trouv√© des <b>logiciels espions AgentTesla</b> .  Dans cet article, Ilya pr√©sente les r√©sultats d'une analyse en plusieurs phases du module <b>AgentTesla</b> principal. <br><a name="habracut"></a><br><blockquote> Agent Tesla est un logiciel d'espionnage modulaire distribu√© sous forme de malware en tant que service sous le couvert d'un produit enregistreur de frappe l√©gal.  L'agent Tesla est capable d'extraire et de transmettre les informations d'identification des utilisateurs des navigateurs, des clients de messagerie et des clients FTP au serveur pour les attaquants, d'enregistrer les donn√©es du presse-papiers et de capturer l'√©cran de l'appareil.  Au moment de l'analyse, le site officiel des d√©veloppeurs n'√©tait pas disponible. <br></blockquote><br><h2>  Fichier de configuration </h2><br>  Le tableau ci-dessous r√©pertorie les fonctionnalit√©s utilis√©es dans l'exemple utilis√©: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>La description</strong> <br></td><td>  <strong>Valeur</strong> <br></td></tr><tr><td>  Indicateur d'utilisation de KeyLogger <br></td><td>  vrai <br></td></tr><tr><td>  Indicateur d'utilisation de ScreenLogger <br></td><td>  faux <br></td></tr><tr><td>  Intervalle d'envoi du journal KeyLogger en minutes <br></td><td>  20 <br></td></tr><tr><td>  Intervalle d'envoi du journal ScreenLogger en minutes <br></td><td>  20 <br></td></tr><tr><td>  Indicateur pour le traitement de la touche de retour arri√®re.  Faux - journalisation uniquement.  Vrai - efface la cl√© pr√©c√©dente <br></td><td>  faux <br></td></tr><tr><td>  Tapez CnC.  Options: smtp, panneau Web, ftp <br></td><td>  smtp <br></td></tr><tr><td>  Drapeau d'activation du thread pour terminer les processus de la liste "% filter_list%" <br></td><td>  faux <br></td></tr><tr><td>  Drapeau de d√©sactivation UAC <br></td><td>  faux <br></td></tr><tr><td>  D√©sactiver l'indicateur du gestionnaire de t√¢ches <br></td><td>  faux <br></td></tr><tr><td>  Indicateur de d√©sactivation CMD <br></td><td>  faux <br></td></tr><tr><td>  Indicateur de d√©sactivation de la fen√™tre d'ex√©cution <br></td><td>  faux <br></td></tr><tr><td>  D√©sactiver l'indicateur du visualiseur de registre <br></td><td>  faux <br></td></tr><tr><td>  D√©sactiver les points de restauration du syst√®me <br></td><td>  vrai <br></td></tr><tr><td>  Indicateur de d√©sactivation du panneau de commande <br></td><td>  faux <br></td></tr><tr><td>  Indicateur de d√©sactivation MSCONFIG <br></td><td>  faux <br></td></tr><tr><td>  Drapeau de d√©sactivation du menu contextuel de l'explorateur <br></td><td>  faux <br></td></tr><tr><td>  Indicateur de broche syst√®me <br></td><td>  faux <br></td></tr><tr><td>  Chemin pour copier le module principal lors de l'amarrage dans le syst√®me <br></td><td>  % startupfolder% \\% insfolder% \\% insname% <br></td></tr><tr><td>  Indicateur de d√©finition des attributs ¬´Syst√®me¬ª et ¬´Secret¬ª pour le module principal fix√© dans le syst√®me <br></td><td>  faux <br></td></tr><tr><td>  Red√©marrer l'indicateur d'ex√©cution lors de la fixation sur le syst√®me <br></td><td>  faux <br></td></tr><tr><td>  Indicateur de d√©placement du module principal vers un dossier temporaire <br></td><td>  faux <br></td></tr><tr><td>  Drapeau UAC Bypass Run <br></td><td>  faux <br></td></tr><tr><td>  Format de date et d'heure pour l'enregistrement <br></td><td>  aaaa-MM-jj HH: mm: ss <br></td></tr><tr><td>  Indicateur pour utiliser le filtre de programme pour KeyLogger <br></td><td>  vrai <br></td></tr><tr><td>  Type de filtrage de programme. <br>  1 - le nom du programme est recherch√© dans les en-t√™tes de fen√™tre <br>  2 - le nom du programme est recherch√© dans le nom du processus de la fen√™tre <br></td><td>  1 <br></td></tr><tr><td>  Filtre de programme <br></td><td>  Facebook <br>  Twitter <br>  Gmail <br>  Instagram <br>  "Film", <br>  Skype <br>  "Porno", <br>  Hack <br>  Whatsapp <br>  Discorde <br></td></tr></tbody></table></div><br><h2>  Fixation du module principal dans le syst√®me </h2><br>  Si l'indicateur correspondant est d√©fini, le module principal est copi√© le long du chemin sp√©cifi√© dans la configuration comme chemin de fixation dans le syst√®me. <br><br>  Selon la valeur de la configuration, le fichier re√ßoit les attributs ¬´Hidden¬ª et ¬´System¬ª. <br>  Le d√©marrage automatique est fourni par deux branches de registre: <br><br><ul><li>  <b>HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \% insregname%</b> </li><li>  <b>HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupApproved \ Run \% insregname%</b> </li></ul><br>  √âtant donn√© que le chargeur de d√©marrage s'injecte dans le processus <b>RegAsm</b> , la d√©finition de l'indicateur persistant pour le module principal entra√Æne des cons√©quences assez int√©ressantes.  Au lieu de se copier, le malware a s√©curis√© le fichier <b>RegAsm.exe d'</b> origine dans le syst√®me, au cours duquel l'injection a √©t√© effectu√©e. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/mx/in/a8mxinpopuoixolt4r7tiwulc70.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9p/-f/ui/9p-fui42mv7y06i5ivacsyh2zqm.png"></div><br><h2>  Interaction avec C&amp;C </h2><br>  Quelle que soit la m√©thode utilis√©e, l'interaction r√©seau commence par l'obtention de l'adresse IP externe de la victime √† l'aide du <b><a href="http://checkip/">checkip</a> [.] Amazonaws [.] Com /</b> ressource. <br>  Ce qui suit d√©crit les m√©thodes de mise en r√©seau pr√©sent√©es dans le logiciel malveillant. <br><br><h3>  panneau Web </h3><br>  L'interaction se fait via le protocole HTTP.  Le malware ex√©cute une requ√™te POST avec les en-t√™tes suivants: <br><br><ul><li>  <b>User-Agent: Mozilla / 5.0 (Windows U Windows NT 6.1 ru rv: 1.9.2.3) Gecko / 20100401 Firefox / 4.0 (.NET CLR 3.5.30729)</b> </li><li>  <b>Connexion: Keep-Alive</b> </li><li>  <b>Type de contenu: application / x-www-form-urlencoded</b> </li></ul><br>  L'adresse du serveur est d√©finie sur <b>% PostURL%</b> .  Le message chiffr√© est transmis dans le param√®tre <b>"p"</b> .  Le m√©canisme de cryptage est d√©crit dans la section <b>¬´Algorithmes de cryptage¬ª (m√©thode 2)</b> . <br><br>  Le message transmis est le suivant: <br><br>  <b>type = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nclient = {8} \ nlink = {9} \ nusername = {10} \ npassword = {11} \ nscreen_link = {12}</b> <br><br>  Le param√®tre <b>type</b> indique le type de message: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lc/5l/yr/lc5lyrzbeie0jr9z-6dpzpylaze.jpeg"></div><br>  <b>hwid</b> - un hachage MD5 est √©crit √† partir des valeurs du num√©ro de s√©rie de la carte m√®re et de l'ID du processeur.  Tr√®s probablement utilis√© comme ID utilisateur. <br>  <b>heure</b> - sert √† transmettre l'heure et la date actuelles. <br>  <b>pcname</b> - d√©fini comme <b>&lt;Username&gt; / &lt;Computer Name&gt;</b> . <br>  <b>logdata</b> - journal des donn√©es. <br><br>  Lors de la transmission des mots de passe, le message ressemble √†: <br><br>  <b>type = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nscreen_link = {8} \ n [mots de passe]</b> <br><br>  Les descriptions suivantes <b>d√©crivent</b> les donn√©es vol√©es au format <b>\ nclient [] = {0} \ nlink [] = {1} \ nusername [] = {2} \ npassword [] = {3}</b> . <br><br><h3>  smtp </h3><br>  L'interaction se fait via le protocole SMTP.  Le message transmis est au format HTML.  Le param√®tre <b>BODY</b> est: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/vg/np/ghvgnpycvdbcsyyakmwjvfppnw4.png"></div><br>  Le titre de la lettre a la forme g√©n√©rale: <b>&lt;NOM UTILISATEUR&gt; / &lt;NOM ORDINATEUR&gt; &lt;TYPE DE CONTENU&gt;</b> .  Le contenu de la lettre, ainsi que ses pi√®ces jointes, ne sont pas crypt√©s. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x5/7c/5o/x57c5ojnqhgfpnec0jnsqix931c.jpeg"></div><br>  L'interaction se fait via le protocole ftp.  Un fichier nomm√© <b>&lt;CONTENT TYPE&gt; _ &lt;USER NAME&gt; - &lt;COMPUTER NAME&gt; _ &lt;DATE AND TIME&gt; .html</b> est transf√©r√© vers le serveur sp√©cifi√©.  Le contenu du fichier n'est pas crypt√©. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/r-/2n/wr/r-2nwryzwnv7voneopya8y5aazq.jpeg"></div><br><h2>  Algorithmes de chiffrement </h2><br>  Les m√©thodes de chiffrement suivantes sont utilis√©es dans ce cas: <br><br><h3>  M√©thode 1 </h3><br>  Cette m√©thode est utilis√©e pour crypter les cha√Ænes dans le module principal.  Pour le chiffrement, l'algorithme <b>AES</b> est <b>utilis√©</b> . <br><br>  L'entr√©e est un nombre d√©cimal √† six chiffres.  La transformation suivante est effectu√©e dessus: <br><br>  <b>f (x) = (((x &gt;&gt; 2 - 31059) ^ 6380) - 1363) &gt;&gt; 3</b> <br><br>  La valeur r√©sultante est l'index du tableau de donn√©es incorpor√©. <br><br>  Chaque √©l√©ment du tableau est une s√©quence <b>DWORD</b> .  Lors de la combinaison de <b>DWORD,</b> un tableau d'octets est obtenu: les 32 premiers octets sont la cl√© de chiffrement, suivis de 16 octets du vecteur d'initialisation, et les octets restants sont les donn√©es chiffr√©es. <br><br><h3>  M√©thode 2 </h3><br>  L'algorithme <b>3DES</b> est utilis√© en <b>mode ECB</b> avec un remplissage en octets entiers ( <b>PKCS7</b> ). <br><br>  La cl√© est sp√©cifi√©e par le param√®tre <b>% urlkey%</b> , mais son hachage MD5 est utilis√© pour le chiffrement. <br><br><h2>  Fonctionnalit√© malveillante </h2><br>  L'√©chantillon √† l'√©tude utilise les programmes suivants pour impl√©menter sa fonction malveillante: <br><br><h3>  Enregistreur de frappe </h3><br>  S'il existe un indicateur VPO correspondant utilisant la fonction WinAPI, <b>SetWindowsHookEx</b> affecte son propre gestionnaire pour les √©v√©nements de frappe de clavier.  La fonction de gestionnaire commence par obtenir le titre de la fen√™tre active. <br><br>  Si l'indicateur pour effectuer le filtrage d'application est d√©fini, le filtrage est effectu√© en fonction du type sp√©cifi√©: <br><br><ol><li>  le nom du programme est recherch√© dans les en-t√™tes de fen√™tre </li><li>  le nom du programme est recherch√© dans le nom du processus de la fen√™tre </li></ol><br>  Ensuite, un enregistrement est ajout√© au journal avec des informations sur la fen√™tre active au format: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bx/r0/cj/bxr0cj1srz9us2a4il4rwjfpoqo.png"></div><br>  Ensuite, des informations sur la touche enfonc√©e sont enregistr√©es: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Cl√©</strong> <br></td><td>  <strong>Record</strong> <br></td></tr><tr><td>  Retour arri√®re <br></td><td>  Selon l'indicateur de traitement de la cl√© de retour arri√®re: Faux - <font color="#008000">{RETOUR}</font> <br>  Vrai - efface la cl√© pr√©c√©dente <br></td></tr><tr><td>  CAPSLOCK <br></td><td>  <font color="#008000">{CAPSLOCK}</font> <br></td></tr><tr><td>  √âchap <br></td><td>  <font color="#008000">{ESC}</font> <br></td></tr><tr><td>  PageUp <br></td><td>  <font color="#008000">{PageUp}</font> <br></td></tr><tr><td>  Vers le bas <br></td><td>  <font color="#008000">? darr;</font> <br></td></tr><tr><td>  SUPPRIMER <br></td><td>  <font color="#008000">{DEL}</font> <br></td></tr><tr><td>  " <br></td><td>  &amp; quot; <br></td></tr><tr><td>  F5 <br></td><td>  <font color="#008000">{F5}</font> <br></td></tr><tr><td>  &amp; <br></td><td>  &amp; amp; <br></td></tr><tr><td>  F10 <br></td><td>  <font color="#008000">{F10}</font> <br></td></tr><tr><td>  Onglet <br></td><td>  <font color="#008000">{TAB}</font> <br></td></tr><tr><td>  &lt; <br></td><td>  &amp; lt; <br></td></tr><tr><td>  &gt; <br></td><td>  &amp; gt; <br></td></tr><tr><td>  Barre d'espace <br></td><td></td></tr><tr><td>  F8 <br></td><td>  <font color="#008000">{F8}</font> <br></td></tr><tr><td>  F12 <br></td><td>  <font color="#008000">{F12}</font> <br></td></tr><tr><td>  F9 <br></td><td>  <font color="#008000">{F9}</font> <br></td></tr><tr><td>  ALT + TAB <br></td><td>  <font color="#008000">{ALT + TAB}</font> <br></td></tr><tr><td>  Fin <br></td><td>  <font color="#008000">{END}</font> <br></td></tr><tr><td>  F4 <br></td><td>  <font color="#008000">{F4}</font> <br></td></tr><tr><td>  F2 <br></td><td>  <font color="#008000">{F2}</font> <br></td></tr><tr><td>  CTRL <br></td><td>  <font color="#008000">{CTRL}</font> <br></td></tr><tr><td>  F6 <br></td><td>  <font color="#008000">{F6}</font> <br></td></tr><tr><td>  √Ä droite <br></td><td>  <font color="#008000">? rarr;</font> <br></td></tr><tr><td>  En haut <br></td><td>  <font color="#008000">&amp; uarr;</font> <br></td></tr><tr><td>  F1 <br></td><td>  <font color="#008000">{F1}</font> <br></td></tr><tr><td>  Gauche <br></td><td>  <font color="#008000">&amp; larr;</font> <br></td></tr><tr><td>  Pagedown <br></td><td>  <font color="#008000">{PageDown}</font> <br></td></tr><tr><td>  Ins√©rer <br></td><td>  <font color="#008000">{Ins√©rer}</font> <br></td></tr><tr><td>  Gagner <br></td><td>  <font color="#008000">{Win}</font> <br></td></tr><tr><td>  Numlock <br></td><td>  <font color="#008000">{NumLock}</font> <br></td></tr><tr><td>  F11 <br></td><td>  <font color="#008000">{F11}</font> <br></td></tr><tr><td>  F3 <br></td><td>  <font color="#008000">{F3}</font> <br></td></tr><tr><td>  Accueil <br></td><td>  <font color="#008000">{ACCUEIL}</font> <br></td></tr><tr><td>  ENTRER <br></td><td>  <font color="#008000">{ENTRER}</font> <br></td></tr><tr><td>  ALT + F4 <br></td><td>  <font color="#008000">{ALT + F4}</font> <br></td></tr><tr><td>  F7 <br></td><td>  <font color="#008000">{F7}</font> <br></td></tr><tr><td>  Une autre cl√© <br></td><td>  Caract√®re en majuscule ou en minuscule selon la position des touches CapsLock et Shift <br></td></tr></tbody></table></div><br>  Avec une fr√©quence donn√©e, le journal collect√© est envoy√© au serveur.  Si le transfert a √©chou√©, le journal est enregistr√© dans le fichier <b>% TEMP% \\ log.tmp</b> au format: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xn/pz/eb/xnpzeba3_y7ulwz0wesksvlspkg.png"></div><br>  Lorsque la minuterie se d√©clenche, le fichier sera transf√©r√© sur le serveur. <br><br><h3>  Enregistreur d'√©cran </h3><br>  √Ä la fr√©quence sp√©cifi√©e, le logiciel malveillant cr√©e une capture d'√©cran au format <b>Jpeg</b> avec une valeur de qualit√© de 50 et l'enregistre dans le fichier <b>% APPDATA% \\ &lt;S√©quence arbitraire de 10 caract√®res&gt; .jpg</b> .  Apr√®s le transfert, le fichier est supprim√©. <br><br><h3>  Clipboardlogger </h3><br>  Si l'indicateur correspondant est d√©fini, les remplacements sont effectu√©s dans le texte intercept√© conform√©ment au tableau ci-dessous. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xh/wc/y7/xhwcy7r4g5duormggz-texkxemi.jpeg"></div><br>  Apr√®s cela, le texte est ins√©r√© dans le journal: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/6l/2p/ft6l2pmpzecwtkh0hhgbblet30q.png"></div><br><h3>  PasswordStealer </h3><br>  Les logiciels malveillants peuvent t√©l√©charger des mots de passe √† partir des applications suivantes: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Navigateurs</strong> <br></td><td>  <strong>Clients de messagerie</strong> <br></td><td>  <strong>Clients FTP</strong> <br></td></tr><tr><td>  Chrome <br></td><td>  Perspectives <br></td><td>  Filezilla <br></td></tr><tr><td>  Firefox <br></td><td>  Thunderbird <br></td><td>  WS_FTP <br></td></tr><tr><td>  IE / Edge <br></td><td>  Foxmail <br></td><td>  Winscp <br></td></tr><tr><td>  Safari <br></td><td>  Opera Mail <br></td><td>  Coreftp <br></td></tr><tr><td>  Navigateur Opera <br></td><td>  IncrediMail <br></td><td>  Navigateur FTP <br></td></tr><tr><td>  Yandex <br></td><td>  Pocomail <br></td><td>  Flashfxp <br></td></tr><tr><td>  Comodo <br></td><td>  Eudora <br></td><td>  Smartftp <br></td></tr><tr><td>  Chromeplus <br></td><td>  Thebat <br></td><td>  FTPCommander <br></td></tr><tr><td>  Chrome <br></td><td>  Bo√Æte aux lettres <br></td><td></td></tr><tr><td>  Torche <br></td><td>  Clawsmail <br></td><td></td></tr><tr><td>  7Star <br></td><td></td><td></td></tr><tr><td>  Amigo <br></td><td></td><td></td></tr><tr><td>  Bravesoftware <br></td><td>  <strong>Clients Jabber</strong> <br></td><td>  <strong>Clients VPN</strong> <br></td></tr><tr><td>  Centbrowser <br></td><td>  Psi / psi + <br></td><td>  VPN ouvert <br></td></tr><tr><td>  Chedot <br></td><td></td><td></td></tr><tr><td>  Coccoc <br></td><td></td><td></td></tr><tr><td>  Navigateur d'√©l√©ments <br></td><td>  <strong>Gestionnaires de t√©l√©chargement</strong> <br></td><td></td></tr><tr><td>  Navigateur de confidentialit√© Epic <br></td><td>  Gestionnaire de t√©l√©chargement Internet <br></td><td></td></tr><tr><td>  Kometa <br></td><td>  Jdownloader <br></td><td></td></tr><tr><td>  Orbitum <br></td><td></td><td></td></tr><tr><td>  Spoutnik <br></td><td></td><td></td></tr><tr><td>  uCozMedia <br></td><td></td><td></td></tr><tr><td>  Vivaldi <br></td><td></td><td></td></tr><tr><td>  Seamonkey <br></td><td></td><td></td></tr><tr><td>  Navigateur Flock <br></td><td></td><td></td></tr><tr><td>  Navigateur Uc <br></td><td></td><td></td></tr><tr><td>  Blackhawk <br></td><td></td><td></td></tr><tr><td>  Cyberfox <br></td><td></td><td></td></tr><tr><td>  K-meleon <br></td><td></td><td></td></tr><tr><td>  Icecat <br></td><td></td><td></td></tr><tr><td>  Icedragon <br></td><td></td><td></td></tr><tr><td>  Palemoon <br></td><td></td><td></td></tr><tr><td>  Waterfox <br></td><td></td><td></td></tr><tr><td>  Navigateur Falkon <br></td><td></td><td></td></tr></tbody></table></div><br><br><h2>  Contrer l'analyse dynamique <br></h2><br><ul><li>  Utilisation de la fonction <b>Veille</b> .  Permet de contourner certains bacs √† sable par timeout </li><li>  D√©truire le flux <b>Zone.Identifier</b> .  Permet de masquer le fait de t√©l√©charger un fichier depuis Internet </li><li>  Le param√®tre <b>% filter_list%</b> d√©finit la liste des processus que le malware terminera avec un intervalle d'une seconde </li><li>  D√©sactiver l' <b>UAC</b> </li><li>  D√©sactiver le Gestionnaire des t√¢ches </li><li>  D√©sactiver <b>CMD</b> </li><li>  D√©sactiver la fen√™tre <b>Ex√©cuter</b> </li><li>  D√©sactiver le panneau de configuration </li><li>  D√©sactiver l' <b>outil RegEdit</b> </li><li>  D√©sactivation des points de restauration du syst√®me </li><li>  D√©sactiver le menu contextuel dans l'Explorateur </li><li>  D√©sactiver <b>msconfig</b> </li><li>  Contournement <b>UAC</b> : <br></li></ul><br><h2>  Fonctions inactives du module principal </h2><br>  Lors de l'analyse du module principal, les fonctions responsables de la diffusion sur le r√©seau et du suivi de la position de la souris ont √©t√© identifi√©es. <br><br><h3>  Ver </h3><br>  Dans un flux s√©par√©, les √©v√©nements de connexion au support amovible sont surveill√©s.  Lorsqu'il est connect√© √† la racine du syst√®me de fichiers, le <b>malware est</b> copi√© avec le nom <b>scr.exe</b> , apr√®s quoi il recherche les fichiers avec l'extension <b>lnk</b> .  Chaque <b>commande lnk</b> devient <b>cmd.exe / c start scr.exe &amp; start &lt;original command&gt; &amp; exit</b> . <br><br>  Chaque r√©pertoire √† la racine du support re√ßoit l'attribut <b>Hidden</b> et un fichier avec l'extension <b>lnk</b> est <b>cr√©√©</b> avec le nom du r√©pertoire cach√© et la commande <b>cmd.exe / c start scr.exe &amp; explorer / root, \ "% CD% &lt;NOM DE R√âPERTOIRE&gt; \" &amp; exit</b> . <br><br><h3>  Mousetracker </h3><br>  La m√©thode d'interception est similaire √† celle utilis√©e pour le clavier.  Cette fonctionnalit√© est toujours en cours de d√©veloppement. <br><br><h2>  Activit√© de fichier </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Le chemin</strong> <br></td><td>  <strong>La description</strong> <br></td></tr><tr><td>  % Temp% \ temp.tmp <br></td><td>  Contient un compteur de tentatives de contournement de l'UAC <br></td></tr><tr><td>  % startupfolder% \% insfolder% \% insname% <br></td><td>  Fa√ßon de consolider dans le syst√®me HPE <br></td></tr><tr><td>  % Temp% \ tmpG \ {Heure actuelle en millisecondes} .tmp <br></td><td>  Le chemin pour la sauvegarde du module principal <br></td></tr><tr><td>  % Temp% \ log.tmp <br></td><td>  Fichier journal <br></td></tr><tr><td>  % AppData% \ {S√©quence arbitraire de 10 caract√®res} .jpeg <br></td><td>  Captures d'√©cran <br></td></tr><tr><td>  C: \ Users \ Public \ {S√©quence arbitraire de 10 caract√®res} .vbs <br></td><td>  Chemin d'acc√®s au fichier vbs que le chargeur de d√©marrage peut utiliser pour fermer le syst√®me <br></td></tr><tr><td>  % Temp% \ {Nom de dossier arbitraire} \ {Nom de fichier} <br></td><td>  Chemin utilis√© par le chargeur de d√©marrage pour se connecter au syst√®me <br></td></tr></tbody></table></div><br><h2>  Profil d'intrus </h2><br>  Gr√¢ce aux donn√©es d'authentification ¬´filaire¬ª, nous avons pu acc√©der au centre de commande. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/q0/eb/nqq0ebtlfljriwj4m-97hm7-aww.png"></div><br>  Cela nous a permis d'identifier le courrier final des attaquants: <br><br>  <b>junaid [.] dans *** @ gmail [.] com</b> . <br><br>  Le nom de domaine du centre de commande est enregistr√© sur <b>sg *** @ gmail [.] Com</b> . <br><br><h2>  Conclusion </h2><br>  Au cours d'une analyse d√©taill√©e du malware utilis√© dans l'attaque, nous avons pu √©tablir sa fonctionnalit√© et obtenir la liste la plus compl√®te d'indicateurs de compromis pertinents pour ce cas.  La compr√©hension des m√©canismes d'interaction r√©seau de malvari a permis de donner des recommandations sur l'ajustement du fonctionnement des outils de protection des informations, ainsi que d'√©crire des r√®gles IDS stables. <br><br>  Le principal danger d' <b>AgentTesla en</b> tant que DataStealer est que pour effectuer ses t√¢ches, il n'a pas besoin de faire une fixation dans le syst√®me ou d'attendre une commande de contr√¥le.  Une fois sur la machine, il commence imm√©diatement √† collecter des informations priv√©es et les transmet √† CnC.  Un tel comportement agressif est quelque peu similaire au comportement des cryptographes, √† la seule diff√©rence que ces derniers ne n√©cessitent m√™me pas de connexion r√©seau.  En cas de collision avec cette famille apr√®s avoir nettoy√© le syst√®me infect√© du malware lui-m√™me, il est obligatoire de changer tous les mots de passe qui pourraient au moins th√©oriquement √™tre stock√©s dans l'une des applications ci-dessus. <br><br>  Pour l'avenir, disons que les attaquants qui envoient <b>AgentTesla changent</b> tr√®s souvent le chargeur de d√©marrage initial.  Cela vous permet de passer inaper√ßu par les scanners statiques et les analyseurs heuristiques au moment de l'attaque.  Et la tendance de cette famille √† commencer imm√©diatement son activit√© rend les moniteurs syst√®me inutiles.  La meilleure fa√ßon de traiter avec AgentTesla est une analyse pr√©liminaire dans le bac √† sable. <br><br>  Dans le troisi√®me article de cette s√©rie, nous examinerons les autres chargeurs de d√©marrage utilis√©s par <b>AgentTesla</b> et nous en apprendrons √©galement sur le processus de leur d√©ballage semi-automatique.  Ne le manquez pas! <br><br><h2>  Hash </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>SHA1</strong> <br></td></tr><tr><td>  A8C2765B3D655BA23886D663D22BDD8EF6E8E894 <br></td></tr><tr><td>  8010CC2AF398F9F951555F7D481CE13DF60BBECF <br></td></tr><tr><td>  79B445DE923C92BF378B19D12A309C0E9C5851BF <br></td></tr><tr><td>  15839B7AB0417FA35F2858722F0BD47BDF840D62 <br></td></tr><tr><td>  1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD <br></td></tr></tbody></table></div><br><h2>  C&amp;C </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>URL</strong> <br></td></tr><tr><td>  sina-c0m [.] icu <br></td></tr><tr><td>  smtp [.] sina-c0m [.] icu <br></td></tr></tbody></table></div><br><br><h2>  Regkey </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Registre</strong> <br></td></tr><tr><td>  HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ {Script Name} <br></td></tr><tr><td>  HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \% insregname% <br></td></tr><tr><td>  HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupApproved \ Run \% insregname% <br></td></tr></tbody></table></div><br><h3>  Mutex </h3><br>  Aucun indicateur. <br><br><h3>  Fichiers </h3><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Activit√© de fichier</strong> <br></td></tr><tr><td>  % Temp% \ temp.tmp <br></td></tr><tr><td>  % startupfolder% \% insfolder% \% insname% <br></td></tr><tr><td>  % Temp% \ tmpG \ {Heure actuelle en millisecondes} .tmp <br></td></tr><tr><td>  % Temp% \ log.tmp <br></td></tr><tr><td>  % AppData% \ {S√©quence arbitraire de 10 caract√®res} .jpeg <br></td></tr><tr><td>  C: \ Users \ Public \ {S√©quence arbitraire de 10 caract√®res} .vbs <br></td></tr><tr><td>  % Temp% \ {Nom de dossier arbitraire} \ {Nom de fichier} <br></td></tr></tbody></table></div><br><h2>  Informations sur les √©chantillons </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Nom</strong> <br></td><td>  Inconnu <br></td></tr><tr><td>  <strong>MD5</strong> <br></td><td>  F7722DD8660B261EA13B710062B59C43 <br></td></tr><tr><td>  <strong>SHA1</strong> <br></td><td>  15839B7AB0417FA35F2858722F0BD47BDF840D62 <br></td></tr><tr><td>  <strong>SHA256</strong> <br></td><td>  41DC0D5459F25E2FDCF8797948A7B315D3CB0753 <br>  98D808D1772CACCC726AF6E9 <br></td></tr><tr><td>  <strong>Tapez</strong> <br></td><td>  PE (.NET) <br></td></tr><tr><td>  <strong>La taille</strong> <br></td><td>  327680 <br></td></tr><tr><td>  <strong>Nom d'origine</strong> <br></td><td>  AZZRIDKGGSLTYFUBCCRRCUMRKTOXFVPDKGAGPUZI_20190701133545943.exe <br></td></tr><tr><td>  <strong>Horodatage</strong> <br></td><td>  07/01/2019 <br></td></tr><tr><td>  <strong>Compilateur</strong> <br></td><td>  Vb.net <br></td></tr></tbody></table></div><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Nom</strong> <br></td><td>  IELibrary.dll <br></td></tr><tr><td>  <strong>MD5</strong> <br></td><td>  BFB160A89F4A607A60464631ED3ED9FD <br></td></tr><tr><td>  <strong>SHA1</strong> <br></td><td>  1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD <br></td></tr><tr><td>  <strong>SHA256</strong> <br></td><td>  D55800A825792F55999ABDAD199DFA54F3184417 <br>  215A298910F2C12CD9CC31EE <br></td></tr><tr><td>  <strong>Tapez</strong> <br></td><td>  PE (DLL .NET) <br></td></tr><tr><td>  <strong>La taille</strong> <br></td><td>  16896 <br></td></tr><tr><td>  <strong>Nom d'origine</strong> <br></td><td>  IELibrary.dll <br></td></tr><tr><td>  <strong>Horodatage</strong> <br></td><td>  10/11/2016 <br></td></tr><tr><td>  <strong>Compilateur</strong> <br></td><td>  Microsoft Linker (48.0 *) <br></td></tr></tbody></table></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr479120/">https://habr.com/ru/post/fr479120/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr479098/index.html">D√©velopper sur .NET Core? Guo dans Ubuntu, j'ai cr√©√©</a></li>
<li><a href="../fr479100/index.html">Dojo frontal: projets de formation aux comp√©tences des d√©veloppeurs (5 nouveaux + 43 anciens)</a></li>
<li><a href="../fr479106/index.html">Combien co√ªtent les tours de magie</a></li>
<li><a href="../fr479108/index.html">La vie de chevalier - Arena en ligne avec des √©l√©ments RPG</a></li>
<li><a href="../fr479116/index.html">Impressions sur la recherche Y. Direct: pourquoi vous payez 1,5 fois plus par clic</a></li>
<li><a href="../fr479122/index.html">Comment d√©marrer un projet pour animaux de compagnie et ne pas obtenir d'avantages</a></li>
<li><a href="../fr479124/index.html">[Infographie] L'intelligence artificielle en science-fiction</a></li>
<li><a href="../fr479126/index.html">Python dans le d√©veloppement mobile</a></li>
<li><a href="../fr479128/index.html">Comment fonctionne le service m√©dical de l'a√©roport</a></li>
<li><a href="../fr479132/index.html">Composant externe pour la plate-forme mobile 1C (BroadcastReceiver)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>