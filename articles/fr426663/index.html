<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöª ‚úåüèª üì≥ Ruby Developer Cookbook: Domain Driven Design Recipes (Part 1, Scope) üÖæÔ∏è üòù üë∂üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√©sentation 


 Je voudrais parler de l'exp√©rience de l'application des pratiques DDD √† un projet Ruby on Rails existant. Au d√©part, nous avions un m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ruby Developer Cookbook: Domain Driven Design Recipes (Part 1, Scope)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426663/"><h1 id="vvedenie">  Pr√©sentation </h1><br><p>  Je voudrais parler de l'exp√©rience de l'application des pratiques DDD √† un projet Ruby on Rails existant.  Au d√©part, nous avions un monolithe √©crit pendant 10 ans.  La principale difficult√© du projet r√©sidait dans des processus assez complexes et une connectivit√© √©lev√©e.  Nous avons r√©ussi non seulement √† d√©composer l'application en services s√©par√©s, mais aussi √† augmenter consid√©rablement la lisibilit√© du code, √† rendre les processus d√©crits transparents. </p><br><p>  La r√©solution de probl√®mes au sein du syst√®me est devenue pr√©visible, nous avons cess√© de travailler avec la bo√Æte noire et, finalement, le syst√®me lui-m√™me a commenc√© √† nous proposer des solutions. </p><br><p>  Pour faciliter √† la fois la perception et l'√©criture, une histoire sur les approches utilis√©es sera pr√©sent√©e sous forme d'une s√©rie d'articles.  Cette approche n'est pas une ¬´solution miracle¬ª, je voudrais donc souligner tout d'abord le segment de projets auquel cette solution peut r√©pondre.  De plus, je parlerai plus en d√©tail de la m√©thodologie DDD et de l'impl√©mentation de microservices de ce mod√®le, je d√©crirai les combinaisons possibles des mod√®les appliqu√©s en tenant compte de leur impl√©mentation et, finalement, je donnerai un exemple d'impl√©mentation sp√©cifique d'un petit service. </p><a name="habracut"></a><br><h2 id="tezaurus">  Th√©saurus </h2><br><blockquote>  Le th√©saurus est un glossaire de termes utilis√©s pour d√©crire un domaine sp√©cifique. </blockquote><p>  Toutes les d√©finitions qui seront introduites ci-dessous sont correctes dans le cadre de cet article.  Vous pouvez les appliquer √† votre sujet s'ils le d√©crivent assez bien. </p><br><h2 id="zadacha-reshaemaya-v-ramkah-dannogo-podhoda">  Le probl√®me r√©solu dans le cadre de cette approche </h2><br><p>  L'approche d√©crite ci-dessous a une sp√©cialisation assez √©troite et vise avant tout √† r√©soudre un probl√®me sp√©cifique.  N√©anmoins, cela n'exclut pas l'int√©r√™t possible de sp√©cialistes dans des domaines connexes.  Donc, nous avons la t√¢che: </p><br><p>  <strong>Vous devez r√©√©crire et g√©rer un projet avec une logique m√©tier complexe √©crite en Ruby on Rails, avec des ressources suffisantes.</strong> </p><br><p>  √âcrivons cette t√¢che plus en d√©tail. </p><br><h2 id="pochemu-voznikaet-neobhodimost-perepisyvat-proekt">  Pourquoi est-il n√©cessaire de r√©√©crire le projet? </h2><br><p>  Je pense que chaque d√©veloppeur peut r√©pondre √† cette question.  Il est plus difficile de r√©pondre pour que cette r√©ponse r√©ponde aux besoins de votre entreprise. </p><br><p>  Nous utilisons la d√©finition de l' <em>entreprise</em> , telle qu'elle est g√©n√©ralement accept√©e, bien que nous investissions dans ce terme un concept plus large - une entreprise (quelque chose entrepris par un groupe de personnes), une occupation (occup√©e). </p><br><blockquote>  <em>L'entreprise</em> est l'effort d'une entreprise de personnes, exprim√©e par des actions visant √† obtenir des avantages pour un large √©ventail de personnes. </blockquote><p>  Par exemple: </p><br><ul><li>  L'entreprise fabrique un produit pour les consommateurs ou fournit un service. </li><li>  Le laboratoire d√©veloppe un nouveau m√©dicament. </li><li>  L'√©cole est engag√©e dans la formation. </li><li>  Les archives de la ville fournissent des informations aux citoyens. </li><li>  Lera fait plaisir √† ses fans avec une excellente figure sur le r√©seau social. </li></ul><br><p>  Dans le cas de masse, une entreprise se construit autour de l'id√©e de r√©aliser un profit en satisfaisant les besoins de ses clients.  Afin d'augmenter le profit, il est n√©cessaire de satisfaire les <em>besoins</em> r√©els <em>du</em> client avec un grand nombre de solutions de qualit√©.  Cette id√©e est d√©crite comme le premier principe du manifeste Agile, bien que l'id√©e ne soit pas nouvelle.  Le fait que les besoins sous-tendent notre soci√©t√© a √©t√© soutenu par de nombreux philosophes.  Par exemple, Platon a essay√© de rationaliser les besoins, de cr√©er leur classification.  C'est lui qui nomme les principales formes de besoins √©conomiques: nourriture, habillement, logement.  "Le d√©fi des entreprises" est de satisfaire les besoins.  Et les solutions appliqu√©es devraient accro√Ætre la comp√©titivit√© de l'entreprise. </p><br><blockquote>  <em>Comp√©titivit√©</em> - L'avantage d'une entreprise sur une autre. </blockquote><p>  Le manifeste Agile nous donne √©galement une indication que la flexibilit√© du projet est renforc√©e par son excellence technique et sa qualit√© de conception. </p><br><p><img src="https://habrastorage.org/webt/gy/_r/gu/gy_rguosbft-sbjnedvtczrnfyi.png" alt="Gafik 1: projet typique"></p><br><p>  Consid√©rons la cha√Æne d'approvisionnement des valeurs sur l'exemple d'un ¬´projet Web typique¬ª </p><br><ul><li>  t <sub>0</sub> - nous avons une id√©e. </li><li>  t <sub>1</sub> nous avons impl√©ment√© <em>MVP</em> .  Ici, nous nous √©loignons un peu: <br><blockquote>  Produit viable minimum MVP - un produit qui a les fonctions minimales, mais suffisantes pour satisfaire les premiers consommateurs.  La t√¢che principale est d'obtenir un retour d'information pour la formation d'hypoth√®ses pour le d√©veloppement futur du produit. <br></blockquote></li></ul><br><p>  Le terme a √©t√© popularis√© par Steve Blank et Eric Rees.  MVP est un outil efficace pour tester votre id√©e d'entreprise et r√©pondre √† la question principale "D√©coller - ne d√©collera pas?" </p><br><div class="spoiler">  <b class="spoiler_title">Bonne r√©ponse</b> <div class="spoiler_text"><p>  <em>42</em> </p></div></div><br><ul><li>  t <sub>2</sub> - Retour au planning.  L'id√©e a √©t√© couronn√©e de succ√®s, nous avons re√ßu des commentaires positifs et avons pu satisfaire un grand nombre de besoins des clients au moment indiqu√©. </li><li>  t <sub>3</sub> - Cette fois, la satisfaction est venue dans une moindre mesure.  Nous avons augment√© le personnel. </li><li>  t <sub>4</sub> - Nous avons livr√© encore moins de valeurs. </li><li>  t <sub>5</sub> - Si nous n'avons pas commenc√© le refactoring, alors √† ce stade, l'entreprise cesse d'√™tre comp√©titive. </li></ul><br><p>  Pourquoi cela se produit-il?  Au fil du temps, notre projet accumule un haut niveau d'entropie en raison de sa connectivit√© √©lev√©e.  Supposons que nous ayons une ¬´entreprise type¬ª compos√©e d'un service de marketing, d'analyse, de logistique, de vente et de gestion.  Pour le moment, le projet est le suivant: </p><br><p><img src="https://habrastorage.org/webt/ol/wo/zd/olwozdacs-c-x9c2o7wbxudwxmq.jpeg" alt="Graphique 2 - Projet hautement li√©"></p><br><p>  Je voudrais imm√©diatement faire une r√©servation que la connectivit√© n'est pas toujours la cause de l'entropie, mais elle survient si un syst√®me avec un grand nombre de processus m√©tier complexes est mis en ≈ìuvre. </p><br><p>  L'entropie dans le code se produira toujours si les processus commerciaux de l'entreprise ne sont pas correctement form√©s.  Ce qui peut √™tre caract√©ristique des deux jeunes entreprises, qui sont au d√©but de leur parcours, l'est aussi des grandes entreprises, o√π il est impossible de tout syst√©matiser √† la fois.  C'est un processus naturel et nous ne devons pas nous opposer √† lui, mais l'accepter et l'utiliser.  Revenons au premier graphique et regardons-le de l'autre c√¥t√©: </p><br><p><img src="https://habrastorage.org/webt/zx/3g/p_/zx3gp_win5krdl9kwcczp-s9g0e.png" alt="Graphique 3 - Argent"></p><br><p>  L'int√©grale (la zone sous la ligne) sera l'argent gagn√©.  La vraie application (Real app) gagnera plus que ¬´l'id√©al¬ª (Academin app), au moins jusqu'au d√©but de l'entropie - t <sub>4</sub> .  Cela sonne bien et c'est ce que vous devez faire. </p><br><p>  Mais que faire √† l'avenir?  R√©p√©ter le refactoring √† l'infini est impossible.  √Ä un moment donn√©, le volume de la base de code atteindra un niveau tel qu'il sera difficile de r√©√©crire ¬´tout √† la fois¬ª.  Et t√¥t ou tard, il est n√©cessaire de diviser le projet en composants s√©par√©s: </p><br><p><img src="https://habrastorage.org/webt/ru/ie/8l/ruie8llglblqgebbdxyvmfjbokk.jpeg" alt="Graphique 4 - Projet faiblement li√©"></p><br><p>  Une approche pour la mise en ≈ìuvre de syst√®mes complexes est DDD: </p><br><blockquote>  La conception pilot√©e par domaine (DDD) est une approche du d√©veloppement de logiciels pour la satisfaction complexe des besoins, en liant √©troitement la mise en ≈ìuvre avec les principaux mod√®les commerciaux qui sont en constante √©volution. </blockquote><p>  DDD est une s√©rie de pratiques et de d√©finitions qui seront d√©crites plus en d√©tail dans le prochain article.  Le mod√®le central de cette approche est le <em>contexte d√©limit√©</em> , dont l'essence est que chaque sujet se compose de plusieurs ensembles de mod√®les qui ne devraient pas communiquer avec le monde ext√©rieur, ainsi que de mod√®les utilis√©s dans le monde ext√©rieur en conjonction avec d'autres contextes limit√©s.  Chaque contexte limit√© a une interface clairement d√©finie o√π il d√©cide quels mod√®les utiliser en conjonction avec d'autres contextes. </p><br><p>  Ce mod√®le peut √™tre impl√©ment√© via un espace de noms (espace de noms) et via des microservices.  Nous utiliserons ces deux impl√©mentations, selon le niveau de connectivit√© au contexte.  Ce qui conduit finalement √† la cr√©ation d'une application d√©compos√©e et segment√©e. </p><br><p><img src="https://habrastorage.org/webt/xk/ai/xh/xkaixhv_dsgkt4nztswdqovwply.png" alt="Graphique 5 - Projet segment√©"></p><br><p>  Il est peu probable que les graphiques ci-dessus refl√®tent l'image r√©elle, mais vous permettent de comparer diff√©rentes approches entre elles. </p><br><h2 id="podderzhka-proekta">  Support de projet </h2><br><p>  √Ä l'appui du projet, un certain nombre de choses doivent √™tre fournies. </p><br><ul><li>  <strong>Livraison de valeur</strong> : Scrum, Agile, service client, livraison continue. </li><li>  <strong>R√©duction d'entropie</strong> : DDD, Micro-service comme l'un des moyens de s√©parer les contextes, documentation. </li><li>  <strong>Qualit√© du code</strong> : conception au niveau du domaine, TDD, BDD. </li><li>  <strong>Qualit√© du produit</strong> : test manuel et automatis√©, suivi des bogues, journalisation. </li><li>  <strong>Disponibilit√© du produit</strong> : syst√®mes de duplication. </li><li>  <strong>Vitesse du produit</strong> : mise √† l'√©chelle horizontale. </li><li>  <strong>R√©tention de l'√©quipe de d√©veloppement</strong> : syst√®me de motivation, ouverture, honn√™tet√©. </li></ul><br><p>  Comme vous pouvez le voir, la maintenance d'un syst√®me complexe n√©cessite une grande quantit√© de ressources.  Tout d'abord, un personnel hautement qualifi√©.  Avant d'utiliser telle ou telle technologie, demandez-vous si vous avez la possibilit√© d'apporter son soutien au bon niveau. </p><br><p>  Il ne faut pas oublier que le seuil d'entr√©e dans un syst√®me complexe est assez √©lev√©, il est donc important de former le personnel.  De plus, si nous voulons travailler sans √©checs, nous ne devons pas avoir de sp√©cialistes "irrempla√ßables", et il est donc n√©cessaire d'assurer l'interchangeabilit√© totale de tous les r√¥les.  Si vous avez un ¬´sp√©cialiste de la livraison continue¬ª qui sort de l'√©quipe, vous devez le remplacer.  Si le remplacement ne peut pas √™tre fourni, il ne vaut pas la peine d'introduire la pile technologique dans la ¬´production¬ª sans fournir un soutien suffisant. </p><br><p>  Il ne s'agit pas de sp√©cialistes du m√™me niveau.  Laissez-vous avoir un leader DevOps et un certain d√©veloppeur pour qui ce sujet est int√©ressant (le soi-disant "multiclasse").  Pour lui, comme pour le "second violon", il est important de bien comprendre o√π et comment trouver les outils pour r√©soudre le probl√®me.  Pour cela, au moins un quart du volume total des t√¢ches entrantes li√©es √† la nouvelle sp√©cialit√© devrait lui √™tre distribu√©.  Ces t√¢ches seront effectu√©es lentement, les co√ªts augmenteront, mais √† l'avenir, cela √©vitera le risque d'interruption de la fourniture de valeurs en raison de p√©nuries de personnel. </p><br><p>  De telles choses sont d√©crites dans les exigences de Scrum, je ne voudrais pas m'y attarder.  La seule chose sur laquelle je voudrais attirer votre attention, ce √† quoi vous devez vous pr√©parer, ce sont les co√ªts importants qui seront d√©pens√©s pour soutenir votre projet.  Si votre entreprise n'est pas pr√™te pour cela et que vous avez commenc√© √† utiliser de nombreux outils co√ªteux, vous ruinerez l'entreprise. </p><br><h3 id="kratko">  Bri√®vement </h3><br><ul><li>  Si vous devez impl√©menter <em>MVP</em> , commencez par Ruby On Rails. </li><li>  Si le <em>MVP</em> a d√©coll√© et que l'id√©e est justifi√©e, faites le premier refactoring, ¬´all√©gez¬ª vos mod√®les avec des services, des d√©corateurs, supprimez la couche de validation et de base de donn√©es des mod√®les dans des pr√©occupations distinctes.  R√©diger des tests, de la documentation. </li><li>  Si vous n'avez pas un projet aussi complexe et que vous pouvez supprimer l'entropie en optimisant les mod√®les - faites-le. </li><li>  Si vous avez un projet logique et lisible, et que vous devez augmenter sa productivit√©, alors qu'il peut √™tre divis√©, par exemple, par les utilisateurs, alors utilisez la mise √† l'√©chelle.  Mais n'essayez pas de diviser le projet en services par domaine. </li><li>  Si vous avez une entreprise ¬´complexe¬ª et que vous recherchez un outil pour vous connecter √† Internet (pourquoi ne l'avez-vous pas encore fait?!) - envisagez √©galement des ¬´solutions d'entreprise¬ª pr√™tes √† l'emploi, par exemple, en java ou .NET.  Les pratiques d√©crites proviennent de ces solutions et elles disposent d'un riche ensemble d'outils pr√™ts √† l'emploi, ce qui vous fera √©conomiser de l'argent. </li><li>  Si votre projet est sur ruby, vous avez une √©quipe de programmeurs ruby, le projet contient une logique m√©tier complexe, se pr√©pare au chargement ou est d√©j√† charg√©, et l'entropie a tellement augment√© qu'il est tr√®s, tr√®s difficile √† r√©√©crire, alors vous devriez envisager d'utiliser l'approche DDD et Microservices. </li></ul><br><hr><br><p>  La prochaine fois, je voudrais examiner plus en d√©tail l'essence de l'approche DDD et sa mise en ≈ìuvre de microservices. </p><br><hr><br><p>  Sources d'inspiration: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://habr.com/post/351242/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://www.startuplessonslearned.com/2009/08/minimum-viable-product-guide.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://agilemanifesto.org/iso/en/principles.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://dddcommunity.org/learning-ddd/what_is_ddd/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://martinfowler.com/bliki/BoundedContext.html</a> </li><li>  Cr√©ation de microservices par Sam Newman </li><li>  Guide de l'auto-stoppeur de la galaxie, Douglas Adams </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr426663/">https://habr.com/ru/post/fr426663/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr426649/index.html">Brainfuck de bas niveau. Suite ...</a></li>
<li><a href="../fr426651/index.html">MongoDB change sa licence Open Source</a></li>
<li><a href="../fr426657/index.html">Exploration de donn√©es et Twitter</a></li>
<li><a href="../fr426659/index.html">DJI Phantom 4 RTK - cartographie nouvelle g√©n√©ration</a></li>
<li><a href="../fr426661/index.html">Comment entrer dans une magistrature ou une √©cole doctorale sans examens: une nouvelle piste - ¬´Robotique¬ª aux Jeux Olympiques ¬´Je suis un professionnel¬ª</a></li>
<li><a href="../fr426665/index.html">D√©briefing de Paul Graham: Viaweb juin 1998</a></li>
<li><a href="../fr426667/index.html">Seymour Papert: ¬´L'ordinateur comme pr√©servatif¬ª</a></li>
<li><a href="../fr426671/index.html">Le chef de Google a comment√© le lancement d'un moteur de recherche avec censure en Chine</a></li>
<li><a href="../fr426675/index.html">Suivi de ligne bas√© sur OpenCV</a></li>
<li><a href="../fr426677/index.html">Il y a eu un √©chec de pr√®s de deux heures dans le travail des services YouTube, maintenant le service est devenu op√©rationnel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>