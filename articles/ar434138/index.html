<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คฉ โ๏ธ โ๐ป ููุชุจ ุขูุฉ ุงูุชุฑุงุถูุฉ ุฎุงุตุฉ ุจูุง ๐ ๐ฉ๐ฝโโ๏ธ ๐ด</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุ ุณุฃูุถุญ ูู ููููุฉ ูุชุงุจุฉ ุฌูุงุฒู ุงูุธุงูุฑู (VM) ุงูุฐู ููููู ุชุดุบูู ุจุฑุงูุฌ ุงููุฌููุน ูุซู 2048 (ุตุฏููู) ุฃู Roguelike (ุฎุงุตุชู). ุฅุฐุง ููุช ุชุนุฑู ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุชุจ ุขูุฉ ุงูุชุฑุงุถูุฉ ุฎุงุตุฉ ุจูุง</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434138/" style=";text-align:right;direction:rtl"> ูู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณุฃูุถุญ</a> ูู ููููุฉ ูุชุงุจุฉ ุฌูุงุฒู ุงูุธุงูุฑู (VM) ุงูุฐู ููููู ุชุดุบูู ุจุฑุงูุฌ ุงููุฌููุน ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">2048</a> (ุตุฏููู) ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Roguelike</a> (ุฎุงุตุชู).  ุฅุฐุง ููุช ุชุนุฑู ููููุฉ ุงูุจุฑูุฌุฉ ุ ููููู ุชุฑูุฏ ุฃู ุชููู ุจุดูู ุฃูุถู ูุง ูุญุฏุซ ุฏุงุฎู ุงูููุจููุชุฑ ูููู ุชุนูู ูุบุงุช ุงูุจุฑูุฌุฉ ุ ููุฐุง ุงููุดุฑูุน ููุงุณุจ ูู.  ูุฏ ุชุจุฏู ูุชุงุจุฉ ุงูุฌูุงุฒ ุงูุงูุชุฑุงุถู ุงูุฎุงุต ุจู ูุฎููุฉ ุจุนุถ ุงูุดูุก ุ ููููู ุฃุนุฏู ุฃู ุงูููุถูุน ุจุณูุท ููููุฏ ุจุดูู ูุฏูุด. <br><br>  <a href="">ุงูููุฏ ุงูุฃุฎูุฑ</a> ูู ุญูุงูู 250 ุณุทุฑูุง ูู C. ูููู ุฃู ุชุนุฑู ุฃุณุงุณูุงุช C ุฃู C ++ ููุท ุ ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุญุณุงุจ ุงูุซูุงุฆู</a> .  ุฃู ูุธุงู ูููููุณ (ุจูุง ูู ุฐูู ูุงู) ููุงุณุจ ููุจูุงุก ูุงูุชุดุบูู.  ุชูุณุชุฎุฏู ุนุฏุฉ ูุงุฌูุงุช ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูู Unix ูุชููุฆุฉ ุฅุฏุฎุงู ูุญุฏุฉ ุงูุชุญูู ูุนุฑุถูุง ุ ูููููุง ููุณุช ุถุฑูุฑูุฉ ูู ุงูููุฏ ุงูุฑุฆูุณู.  (ุชูููุฐ ุฏุนู ูููุฏูุฒ ูู ููุถุน ุชูุฏูุฑ). <br><br><blockquote style=";text-align:right;direction:rtl">  <b>ููุงุญุธุฉ:</b> ูุฐุง VM ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฑูุงูุฌ ุงููุฎุชุตุฉ</a> .  ูุฐุง ูู ุ ููุช ุชูุฑุฃ ุจุงููุนู ุดูุฑุฉ ุงููุตุฏุฑ ุงูุฎุงุตุฉ ุจู ุงูุขู!  ุณูุชู ุนุฑุถ ูู ุฌุฒุก ูู ุงูุดูุฑุฉ ูุดุฑุญู ุจุงูุชูุตูู ุ ุจุญูุซ ููููู ุงูุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุดูุก ููููุฏ.  ูุชู ุฅูุดุงุก ุฑูุฒ ุงูููุงุฆู ุจูุงุณุทุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุถููุฑุฉ</a> ูู ูุชู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ.  ูุณุชูุฏุน ุงููุดุฑูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> . </blockquote><a name="habracut"></a><br><a name="1"></a><h1 style=";text-align:right;direction:rtl">  1. ุงููุญุชููุงุช </h1><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌุฏูู ุงููุญุชููุงุช</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฏูุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุนูุงุฑุฉ LC-3</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃูุซูุฉ ุงููุฌููุน</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูููุฐ ุงูุจุฑูุงูุฌ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูููุฐ ุงูุชุนูููุงุช</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุนูููุงุช ุงูุบุด ูุฑูุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุฌุฑุงุกุงุช ูุนุงูุฌุฉ ุงูููุงุทุนุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑูุฉ ุงูุบุด ูุฑูุชูู ุงูููุงุทุนุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุญููู ุงูุจุฑูุงูุฌ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณุฌูุงุช ุงูุฐุงูุฑุฉ ุงููุนููุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุฒุงุช ุงููุธุงู ุงูุฃุณุงุณู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฏุก ุชุดุบูู ุงูุฌูุงุฒ ุงูุธุงูุฑู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุทุฑููุฉ ุจุฏููุฉ ูู C ++</a> </li></ol><br><a name="2"></a><h1 style=";text-align:right;direction:rtl">  2. ููุฏูุฉ </h1><br><h3 style=";text-align:right;direction:rtl">  ูุง ูู ุงูุฌูุงุฒ ุงูุธุงูุฑูุ </h3><br>  ุงูุฌูุงุฒ ุงูุธุงูุฑู ูู ุจุฑูุงูุฌ ูุนูู ูุซู ุงูููุจููุชุฑ.  ุฅูู ูุญุงูู ูุนุงูุฌูุง ูุน ุงูุนุฏูุฏ ูู ููููุงุช ุงูุฃุฌูุฒุฉ ุงูุฃุฎุฑู ุ ููุง ูุณูุญ ูู ุจุฅุฌุฑุงุก ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ูุงููุฑุงุกุฉ ูู ุงูุฐุงูุฑุฉ ูุงููุชุงุจุฉ ุฅูููุง ูุงูุชูุงุนู ูุน ุฃุฌูุฒุฉ ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุ ูุซู ุฌูุงุฒ ููุจููุชุฑ ูุนูู ุญูููู.  ุงูุฃูู ูู ุฐูู ุ ูููู VM ูุบุฉ ุงูุขูุฉ ุงูุชู ููููู ุงุณุชุฎุฏุงููุง ููุจุฑูุฌุฉ. <br><br>  ูุนุชูุฏ ููุฏุงุฑ ุงูุฃุฌูุฒุฉ ุงูุชู ูุญุงูููุง ุฌูุงุฒ VM ุนูู ุงูุบุฑุถ ูููุง.  ุจุนุถ VMs ุฅูุชุงุฌ ุณููู ููุจููุชุฑ ูุนูู.  ูู ูุนุฏ ุงูุฃุดุฎุงุต ูุฏููู NES ุ ูููู ูุง ูุฒุงู ุจุฅููุงููุง ูุนุจ ุฃูุนุงุจ NES ูู ุฎูุงู ูุญุงูุงุฉ ุงูุฃุฌูุฒุฉ ุนูู ูุณุชูู ุงูุจุฑูุงูุฌ.  ูุฌุจ ุนูู ูุฐู ุงููุญุงููุงุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุนุงุฏุฉ ุฅูุดุงุก</a> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชูุงุตูู</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฏูุฉ</a> ููู ูููู ุฑุฆูุณู ูู ููููุงุช ุงูุฌูุงุฒ ุงูุฃุตูู. <br><br>  ุฃุฌูุฒุฉ VM ุงูุฃุฎุฑู ูุง ุชุชูุงูู ูุน ุฃู ููุจููุชุฑ ูุนูู ุ ูููููุง ุชุชูุงูู ุฌุฒุฆููุง ูุน ุนุฏุฉ ุฃุฌูุฒุฉ ูู ููุช ูุงุญุฏ!  ููุชู ุฐูู ูู ุงูููุงู ุงูุฃูู ูุชุณููู ุชุทููุฑ ุงูุจุฑูุฌูุงุช.  ุชุฎูู ุฃูู ุชุฑูุฏ ุฅูุดุงุก ุจุฑูุงูุฌ ูุนูู ุนูู ุจููุงุช ููุจููุชุฑ ูุชุนุฏุฏุฉ.  ูููุฑ ุงูุฌูุงุฒ ุงูุธุงูุฑู ููุตุฉ ููุงุณูุฉ ุชููุฑ ุฅููุงููุฉ ุงูููู.  ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ูุชุงุจุฉ ุงูุจุฑูุงูุฌ ูู ููุฌุงุช ูุฎุชููุฉ ูู ุงููุฌูุน ููู ููุฏุณุฉ.  ูููู ุนูู ุฌูุงุฒ VM ุตุบูุฑ ูู ูู ูุบุฉ.  ุจุนุฏ ุฐูู ุ ูููู ูุชุงุจุฉ ุฃู ุจุฑูุงูุฌ ูุฑุฉ ูุงุญุฏุฉ ููุท ุจูุบุฉ ุงูุชุฌููุน ูุฌูุงุฒ ุธุงูุฑู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/572/1a2/c0d/5721a2c0d11e8ea27357239f7104558b.gif"></div><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/235/42d/699/23542d699e7f9717c0e631faebb38454.gif"></div><br><blockquote style=";text-align:right;direction:rtl">  <b>ููุงุญุธุฉ: ูููู ุจุฑูุงูุฌ</b> ุงูุชุญููู ุงูุจุฑูุฌู ุจุญู ูุซู ูุฐู ุงููุดููุงุช ุนู ุทุฑูู ุชุฌููุน <i>ูุบุฉ</i> ููุงุณูุฉ <i>ุนุงููุฉ ุงููุณุชูู ูุฃุจููุฉ</i> ุงููุนุงูุฌ ุงููุฎุชููุฉ.  ูููู VM ุจุฅูุดุงุก <i>ุจููุฉ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ</i> ุงูููุงุณูุฉ ุงูุชู ูุชู ูุญุงูุงุฉูุง ุนูู ุฃุฌูุฒุฉ ูุฎุชููุฉ.  ุฅุญุฏู ูุฒุงูุง ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู ูู ุฃูู ูุง ููุฌุฏ ุญูู ููุช ุงูุชุดุบูู ูุซู VM.  ุนูู ุงูุฑุบู ูู ุฃู ุจุฑูุงูุฌ ุงูุชุญููู ุงูุจุฑูุฌู ูุนูู ุจุดูู ุฌูุฏ ุ ุฅูุง ุฃู ูุชุงุจุฉ ูุชุฑุฌู ุฌุฏูุฏ ููุนุฏูุฏ ูู ุงูููุตุงุช ุฃูุฑ ุตุนุจ ููุบุงูุฉ ุ ูุฐูู ูุง ุชุฒุงู ุฃุฏูุงุช VM ูููุฏุฉ.  ูู ุงููุงูุน ุ ุนูู ูุณุชููุงุช ูุฎุชููุฉ ุ ูุชู ุงุณุชุฎุฏุงู ูู ูู VM ู compilers ูุนุง. </blockquote><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุนุฏ Java Virtual Machine (JVM)</a> ูุซุงููุง ูุงุฌุญูุง ููุบุงูุฉ.  JVM ููุณูุง ูุชูุณุทุฉ ุงูุญุฌู ูุณุจููุง ุ ููู ุตุบูุฑุฉ ุจูุง ูููู ูููู ุงููุจุฑูุฌ.  ูุชูุญ ูู ูุฐุง ูุชุงุจุฉ ุฑูุฒ ูุขูุงู ุงูุฃุฌูุฒุฉ ุงููุฎุชููุฉ ุ ุจูุง ูู ุฐูู ุงูููุงุชู.  ุจุนุฏ ุชุทุจูู JVM ุนูู ุงูุฌูุงุฒ ุงูุฌุฏูุฏ ุ ูููู ูุฃู ุจุฑูุงูุฌ ููุชูุจ ุจูุบุฉ Java ุฃู Kotlin ุฃู Clojure ุงูุนูู ุนููู ุฏูู ุชุบููุฑุงุช.  ุงูุชูุงููู ุงููุญูุฏุฉ ุณุชููู ููุท ุงููููุงุช ุงูุนุงูุฉ ูุฌูุงุฒ VM ููุณู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงูุงุณุชุฎูุงุต ุงูุฅุถุงูู</a> ูู ูุณุชูู ุงููุงูููุฉ.  ูุฐุง ูู ุนุงุฏุฉ ุญู ูุณุท ุฌูุฏ. <br><br>  ูุง ูุฌุจ ุฃู ุชููู VM ูุจูุฑุฉ ุฃู ูุงุณุนุฉ ุงูุงูุชุดุงุฑ ูุชูููุฑ ููุงุฆุฏ ููุงุซูุฉ.  ุบุงูุจูุง ูุง ุชุณุชุฎุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃูุนุงุจ ุงูููุฏูู</a> ุงูุฃูุฏู VMs ุงูุตุบูุฑุฉ ูุฅูุดุงุก <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃูุธูุฉ ูุตูุฉ</a> ุจุณูุทุฉ. <br><br>  VMs ูููุฏุฉ ุฃูุถูุง ูุนุฒู ุงูุจุฑุงูุฌ ุจุฃูุงู.  ุชุทุจูู ูุงุญุฏ ูู ุฌูุน ุงูููุงูุฉ.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุง ุชูุฌุฏ ุทุฑููุฉ ุจุณูุทุฉ</a> ูุชูููุฐ ุชุฌููุน ุงูุจูุงูุงุช ุงูููููุฉ ุชููุงุฆููุง ุฃุนูู C ุฃู C ++ ุ ูุธุฑูุง ูุฃู ุงูุจุฑูุงูุฌ ูุง ููููู ุฑุคูุฉ ููุฏุณู ุฃู ูุชุบูุฑุงุชู ุงูุฎุงุตุฉ.  ููุน ุฐูู ุ ูุฅู VM ูู "ุฎุงุฑุฌ" ุงูุจุฑูุงูุฌ ููุฏ ุงูุชุดุบูู ูููููู ูุฑุงูุจุฉ ุฌููุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฅุดุงุฑุงุช ุฅูู ุฎูุงูุง ุงูุฐุงูุฑุฉ</a> ุนูู ุงูููุฏุณ. <br><br>  ูุชู ุชูุถูุญ ูุซุงู ุขุฎุฑ ุนูู ูุฐุง ุงูุณููู ูู ุฎูุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนููุฏ Ethereum ุงูุฐููุฉ</a> .  ุงูุนููุฏ ุงูุฐููุฉ ูู ุจุฑุงูุฌ ุตุบูุฑุฉ ูุชู ุชูููุฐูุง ุจูุงุณุทุฉ ูู ุนูุฏุฉ ุชุญูู ูู blockchain.  ุฃู ุฃู ุงููุดุบููู ูุณูุญูู ุจุชูููุฐ ุฃู ุจุฑุงูุฌ ููุชูุจุฉ ุจูุงุณุทุฉ ุบุฑุจุงุก ุชูุงููุง ุนูู ุฃุฌูุฒุชูู ุ ุฏูู ุฃู ูุฑุตุฉ ูุฏุฑุงุณุชูุง ููุฏููุง.  ูููุน ุงูุฅุฌุฑุงุกุงุช ุงูุถุงุฑุฉ ุ ูุชู ุชูููุฐูุง ุนูู ุฌูุงุฒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">VM</a> ููุณ ูู ุญู ุงููุตูู ุฅูู ูุธุงู ุงููููุงุช ุฃู ุงูุดุจูุฉ ุฃู ุงููุฑุต ุ ุฅูุฎ.  Ethereum ูู ุฃูุถุง ูุซุงู ุฌูุฏ ุนูู ูุงุจููุฉ.  ุจูุถู VM ุ ููููู ูุชุงุจุฉ ุนููุฏ ุฐููุฉ ุฏูู ูุฑุงุนุงุฉ ููุฒุงุช ุงูุนุฏูุฏ ูู ุงูููุตุงุช. <br><br><a name="3"></a><h1 style=";text-align:right;direction:rtl">  3. ุงูุนูุงุฑุฉ LC-3 </h1><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/yb/bd/fj/ybbdfjiz00coalgzvcg24hxbqea.png"></div><br><br>  ุณูููู ุฌูุงุฒ VM ุจูุญุงูุงุฉ ุฌูุงุฒ ููุจููุชุฑ ุฎูุงูู ูุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">LC-3</a> .  ุฃููุง ุชุญุธู ุจุดุนุจูุฉ ูุชุนููู ุงูุทูุงุจ ุงููุฌูุน.  ููุง ุ ูุฌููุนุฉ ูุจุณุทุฉ ูู ุงูุฃูุงูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฑูุฉ ุจู x86</a> ุ ูููููุง ุชุญุชูุธ ุจุฌููุน ุงูููุงููู ุงูุฃุณุงุณูุฉ ุงููุณุชุฎุฏูุฉ ูู ูุญุฏุงุช ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุงูุญุฏูุซุฉ. <br><br>  ุฃููุงู ุ ุชุญุชุงุฌ ุฅูู ูุญุงูุงุฉ ููููุงุช ุงูุฃุฌูุฒุฉ ุงูุถุฑูุฑูุฉ.  ุญุงูู ุฃู ุชููู ูุงููุฉ ูู ูููู ุ ููู ูุง ุชููู ุฅุฐุง ูู ุชูู ูุชุฃูุฏูุง ูู ููุงุกูุชู ููุตูุฑุฉ ุงููุจูุฑุฉ.  ููุจุฏุฃ ุจุฅูุดุงุก ููู ูู C. ูุฌุจ ูุถุน ูู ุฌุฒุก ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ูุฐุง ุงููุณู ูู ุงููุทุงู ุงูุนุงููู ููุฐุง ุงูููู. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุฐุงูุฑุฉ </h3><br>  ูุญุชูู LC-3 ุนูู 65ุ536 ุฎููุฉ ุฐุงูุฑุฉ (2 <sup>16</sup> ) ุ ุชุญุชูู ูู ูููุง ุนูู ูููุฉ 16 ุจุช.  ูุฐุง ูุนูู ุฃูู ูููู ููุท ุชุฎุฒูู 128 ูููู ุจุงูุช - ุฃูู ุจูุซูุฑ ููุง ุงุนุชุฏุช ุนููู!  ูู ุจุฑูุงูุฌูุง ุ ูุชู ุชุฎุฒูู ูุฐู ุงูุฐุงูุฑุฉ ูู ูุฌููุนุฉ ุจุณูุทุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* 65536 locations */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> memory[UINT16_MAX];</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุณุฌูุงุช </h3><br>  ุงูุณุฌู ุนุจุงุฑุฉ ุนู ูุชุญุฉ ูุชุฎุฒูู ูููุฉ ูุงุญุฏุฉ ูู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ.  ุงูุณุฌูุงุช ูุซู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ "ุทุงููุฉ ุงูุนูู".  ุญุชู ุชุชููู ูู ุงูุนูู ูุน ุฌุฒุก ูู ุงูุจูุงูุงุช ุ ูุฌุจ ุฃู ุชููู ูู ุฃุญุฏ ุงูุณุฌูุงุช.  ูููู ูุธุฑูุง ููุฌูุฏ ุนุฏุฏ ูููู ููุท ูู ุงูุณุฌูุงุช ุ ูููู ุชูุฒูู ูุฏุฑ ุถุฆูู ููุท ูู ุงูุจูุงูุงุช ูู ุฃู ููุช.  ุชุนูู ุงูุจุฑุงูุฌ ุญูู ูุฐู ุงููุดููุฉ ุนู ุทุฑูู ุชุญููู ุงูููู ูู ุงูุฐุงูุฑุฉ ุฅูู ุณุฌูุงุช ุ ูุญุณุงุจ ุงูููู ูู ุณุฌูุงุช ุฃุฎุฑู ุ ุซู ุชุฎุฒูู ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ ูุฑุฉ ุฃุฎุฑู ูู ุงูุฐุงูุฑุฉ. <br><br>  ูุง ููุฌุฏ ุณูู 10 ุณุฌูุงุช ูู LC-3 ุ ูููู ูููุง 16 ุจุช.  ูุนุธููู ููุฃุบุฑุงุถ ุงูุนุงูุฉ ุ ูููู ุงูุจุนุถ ูููู ุฃุฏูุงุฑ ูุญุฏุฏุฉ. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  8 ุณุฌูุงุช ููุฃุบุฑุงุถ ุงูุนุงูุฉ ( <code>R0-R7</code> ) </li><li style=";text-align:right;direction:rtl">  ุณุฌู ูุงุญุฏ ูู ุนุฏุงุฏ ุงููุฑู ( <code>PC</code> ) </li><li style=";text-align:right;direction:rtl">  ุณุฌู ุนูู ุดุฑุท ูุงุญุฏ ( <code>COND</code> ) </li></ul><br>  ูููู ุงุณุชุฎุฏุงู ุณุฌูุงุช ุงูุฃุบุฑุงุถ ุงูุนุงูุฉ ูุฅุฌุฑุงุก ุฃู ุญุณุงุจุงุช ุจุฑุงูุฌูุฉ.  ุนุฏุงุฏ ุงูุชุนูููุงุช ูู ุนุฏุฏ ุตุญูุญ ุบูุฑ ููููุน ููู ุนููุงู ุฐุงูุฑุฉ ุงูุชุนูููุฉ ุงูุชุงููุฉ ููุชูููุฐ.  ุชุฎุจุฑูุง ุนูุงูุงุช ุงูุญุงูุฉ ุจูุนูููุงุช ุญูู ุงูุญุณุงุจ ุงูุณุงุจู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { R_R0 = <span class="hljs-number"><span class="hljs-number">0</span></span>, R_R1, R_R2, R_R3, R_R4, R_R5, R_R6, R_R7, R_PC, <span class="hljs-comment"><span class="hljs-comment">/* program counter */</span></span> R_COND, R_COUNT };</code> </pre> <br>  ูุซู ุงูุฐุงูุฑุฉ ุ ุณูุฎุฒู ุงูุณุฌูุงุช ูู ุตููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> reg[R_COUNT];</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ูุฌููุนุฉ ุงูุชุนูููุงุช </h3><br>  ุงูุชุนูููุงุช ูู ุฃูุฑ ูุฎุจุฑ ุงููุนุงูุฌ ุจุฅุฌุฑุงุก ููุน ูู ุงูููุงู ุงูุฃุณุงุณูุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ุจุฅุถุงูุฉ ุฑูููู.  ูุญุชูู ุงูุชุนูููุฉ ุนูู <b>ุดูุฑุฉ ุชุดุบูู</b> (ุฑูุฒ ุงูุนูููุฉ) ุชุดูุฑ ุฅูู ููุน ุงููููุฉ ุงูุชู ูุชู ุชูููุฐูุง ุ ุจุงูุฅุถุงูุฉ ุฅูู ูุฌููุนุฉ ูู <b>ุงููุนููุงุช</b> ุงูุชู ุชููุฑ ูุฏุฎูุงุช ูููููุฉ ุงูุชู ูุชู ุชูููุฐูุง. <br><br>  ููุซู ูู <b>ุดูุฑุฉ ุชุดุบูู</b> ูููุฉ ูุงุญุฏุฉ "ูุนุฑู" ุงููุนุงูุฌ ุชูููุฐูุง.  ููุงู 16 ุดูุฑุฉ ุชุดุบูู ูู LC-3.  ูููู ููููุจููุชุฑ ุญุณุงุจ ุชุณูุณู ูุฐู ุงูุชุนูููุงุช ุงูุจุณูุทุฉ ููุท.  ูุจูุบ ุทูู ูู ุชุนูููุฉ 16 ุจุช ุ ุจูููุง ุชุฎุฒู 4 ุจุชุงุช ุงูุฃูุณุฑ ุฑูุฒ ุงูุนูููุฉ.  ูุชู ุงุณุชุฎุฏุงู ุงูุจุงูู ูุชุฎุฒูู ุงููุนููุงุช. <br><br>  ูู ููุช ูุงุญู ุณููุงูุด ุจุงูุชูุตูู ูุง ููุนูู ูู ุชุนููู.  ุญุฏุฏ ุดูุฑุฉ ุงูุชุดุบูู ุงูุชุงููุฉ ูู ุงูููุช ุงูุญุงูู.  ุชุฃูุฏ ูู ุงูุงุญุชูุงุธ ุจูุฐุง ุงูุชุฑุชูุจ ููุญุตูู ุนูู ูููุฉ ุงูุชุนุฏุงุฏ ุงูุตุญูุญุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { OP_BR = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* branch */</span></span> OP_ADD, <span class="hljs-comment"><span class="hljs-comment">/* add */</span></span> OP_LD, <span class="hljs-comment"><span class="hljs-comment">/* load */</span></span> OP_ST, <span class="hljs-comment"><span class="hljs-comment">/* store */</span></span> OP_JSR, <span class="hljs-comment"><span class="hljs-comment">/* jump register */</span></span> OP_AND, <span class="hljs-comment"><span class="hljs-comment">/* bitwise and */</span></span> OP_LDR, <span class="hljs-comment"><span class="hljs-comment">/* load register */</span></span> OP_STR, <span class="hljs-comment"><span class="hljs-comment">/* store register */</span></span> OP_RTI, <span class="hljs-comment"><span class="hljs-comment">/* unused */</span></span> OP_NOT, <span class="hljs-comment"><span class="hljs-comment">/* bitwise not */</span></span> OP_LDI, <span class="hljs-comment"><span class="hljs-comment">/* load indirect */</span></span> OP_STI, <span class="hljs-comment"><span class="hljs-comment">/* store indirect */</span></span> OP_JMP, <span class="hljs-comment"><span class="hljs-comment">/* jump */</span></span> OP_RES, <span class="hljs-comment"><span class="hljs-comment">/* reserved (unused) */</span></span> OP_LEA, <span class="hljs-comment"><span class="hljs-comment">/* load effective address */</span></span> OP_TRAP <span class="hljs-comment"><span class="hljs-comment">/* execute trap */</span></span> };</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  <b>ููุงุญุธุฉ:</b> ุชุญุชูู ุจููุฉ Intel x86 ุนูู ูุฆุงุช ุงูุฅุฑุดุงุฏุงุช ุ ูู ุญูู ุฃู ุจููุงุช ุฃุฎุฑู ูุซู ARM ู LC-3 ููููุฉ ููุบุงูุฉ.  ุชุณูู ูุฌููุนุงุช ุงูุชุนูููุงุช ุงูุตุบูุฑุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RISC</a> ุ ุจูููุง ุชุณูู ุงููุฌููุนุงุช ุงูุฃูุจุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CISC</a> .  ูุฌููุนุงุช ุงูุชุนูููุงุช ุงููุจูุฑุฉ ุ ููุงุนุฏุฉ ุนุงูุฉ ุ ูุง ุชููุฑ ููุฒุงุช ุฌุฏูุฏุฉ ุจุดูู ุฃุณุงุณู ุ ูููููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุบุงูุจูุง ูุง ุชุจุณุท ูุชุงุจุฉ ุฑูุฒ ุงููุฌููุน</a> .  ูููู ุฃู ูุญู ุฃุญุฏ ุชุนูููุงุช CISC ูุญู ุงูุนุฏูุฏ ูู ุฅุฑุดุงุฏุงุช RISC.  ููุน ุฐูู ุ ูุฅู ูุนุงูุฌุงุช CISC ุฃูุซุฑ ุชุนููุฏูุง ูููููุฉ ููุชุตููู ูุงูุชุตููุน.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุง ุชุณูุญ</a> ูุฐู ุงูููุงูุถุงุช ูุบูุฑูุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุงุณุชุฏุนุงุก ุงูุชุตููู "ุงูุฃูุซู"</a> . </blockquote><br><h3 style=";text-align:right;direction:rtl">  ุญุงูุฉ ุงูุฃุนูุงู </h3><br>  ูููู ุณุฌู <code>R_COND</code> ุจุชุฎุฒูู ุฅุดุงุฑุงุช ุงูุญุงูุฉ ุงูุชู ุชููุฑ ูุนูููุงุช ุญูู ุขุฎุฑ ุญุณุงุจ ุชู ุชูููุฐู.  ูุณูุญ ูุฐุง ููุจุฑุงูุฌ ุจุงูุชุญูู ูู ุงูุดุฑูุท ุงูููุทููุฉ ุ ูุซู <code>if (x &gt; 0) { ... }</code> . <br><br>  ูุญุชูู ูู ูุนุงูุฌ ุนูู ุงูุนุฏูุฏ ูู ุนูุงูุงุช ุงูุญุงูุฉ ููุฅุดุงุฑุฉ ุฅูู ุงูููุงูู ุงููุฎุชููุฉ.  ูุณุชุฎุฏู LC-3 ุซูุงุซ ุนูุงูุงุช ุดุฑุท ููุท ุชูุธูุฑ ุนูุงูุฉ ุงูุญุณุงุจ ุงูุณุงุจู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { FL_POS = <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* P */</span></span> FL_ZRO = <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* Z */</span></span> FL_NEG = <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* N */</span></span> };</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  <b>ููุงุญุธุฉ:</b> (ููุทูู ุนูู ุงูุญุฑู <code>&lt;&lt;</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนุงูู ุงูุชุดุบูู ูููุณุงุฑ ุงูุฃูุณุฑ</a> <code>(n &lt;&lt; k)</code> ูููู ุงูุจุชุงุช <code>n</code> ุงููุณุงุฑ ูู ุงูุฃูุงูู <code>k</code> . ูููุฐุง ุ <code>1 &lt;&lt; 2</code> ุชุณุงูู <code>4</code> ุงูุฑุฃ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ุฅุฐุง ูู ุชูู ูุนุชุงุฏูุง ุนูู ุงูููููู. ุณูููู ูุฐุง ููููุง ุฌุฏูุง). </blockquote><br>  ููุฏ ุงูุชูููุง ูู ุชูููู ููููุงุช ุงูุฃุฌูุฒุฉ ูู ุงูุฌูุงุฒ ุงูุธุงูุฑู ูุฏููุง!  ุจุนุฏ ุฅุถุงูุฉ ุงูุงุฏุฑุงุฌ ุงูููุงุณูุฉ (ุงูุธุฑ ุงูุฑุงุจุท ุฃุนูุงู) ุ ูุฌุจ ุฃู ูุจุฏู ุงูููู ุงูุฎุงุต ุจู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{Includes, <span class="hljs-number"><span class="hljs-number">12</span></span>} {Registers, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Opcodes, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Condition Flags, <span class="hljs-number"><span class="hljs-number">3</span></span>}</code> </pre>  <font color="gray">ูููุง ููู ุงุฑุชุจุงุทุงุช ุฅูู ุฃูุณุงู ุฐุงุช ุชุนุฏุงุฏ ุฑููู ูู ุงูููุงูุฉ ุ ุญูุซ ุชุฃุชู ุฃุฌุฒุงุก ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงููุทุงุจูุฉ ูู.</font>  <font color="gray">ููุญุตูู ุนูู ูุงุฆูุฉ ูุงููุฉ ุ ุงูุธุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฑูุงูุฌ ุงูุนูู</a> - ุชูุฑูุจุง.</font>  <font color="gray">ุงูุนุงุจุฑุฉ</font> <br><br><a name="4"></a><h1 style=";text-align:right;direction:rtl">  4. ุฃูุซูุฉ ุงููุฌูุน </h1><br>  ุงูุขู ุ ุฏุนููุง ููุธุฑ ุฅูู ุจุฑูุงูุฌ ุงููุฌููุน LC-3 ููุญุตูู ุนูู ููุฑุฉ ุนูุง ููุนูู ุงูุฌูุงุฒ ุงูุธุงูุฑู ูุนูููุง.  ูุง ุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ููููุฉ ุงูุจุฑูุฌุฉ ูู ุงููุฌูุน ุ ุฃู ููู ูู ุดูุก ููุง.  ูุฌุฑุฏ ูุญุงููุฉ ููุญุตูู ุนูู ููุฑุฉ ุนุงูุฉ ุนูุง ูุญุฏุซ.  ููุง ุนุจุงุฑุฉ ุจุณูุทุฉ ุนู "Hello World": <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">.ORIG x3000 ; this is the address in memory where the program will be loaded LEA R0, HELLO_STR ; load the address of the HELLO_STR string into R0 PUTs ; output the string pointed to by R0 to the console HALT ; halt the program HELLO_STR .STRINGZ "Hello World!" ; store this string here in the program .END ; mark the end of the file</code> </pre> <br>  ููุง ูู C ุ ูููุฐ ุงูุจุฑูุงูุฌ ุนุจุงุฑุฉ ูุงุญุฏุฉ ูู ุฃุนูู ุฅูู ุฃุณูู.  ูููู ุนูู ุนูุณ C ุ ูุง ุชูุฌุฏ ููุงุทู ูุชุฏุงุฎูุฉ <code>{}</code> ุฃู ููุงูู ุชุญูู ูุซู <code>if</code> ุฃู <code>while</code> ุ  ูุฌุฑุฏ ูุงุฆูุฉ ุจุณูุทุฉ ูู ุงููุดุบููู.  ูุฐูู ุ ููู ุงูุฃุณูู ุฃุฏุงุก. <br><br>  ูุฑุฌู ููุงุญุธุฉ ุฃู ุฃุณูุงุก ุจุนุถ ุงููุดุบููู ุชุชูุงูู ูุน ุฑููุฒ ุงูุชุดุบูู ุงูุชู ุญุฏุฏูุงูุง ุณุงุจููุง.  ูุนูู ุฃู ุงูุชุนูููุงุช ูู 16 ุจุช ุ ููู ูุจุฏู ุฃู ูู ุณุทุฑ ููุง ูู ูุงู ูุน ุนุฏุฏ ูุฎุชูู ูู ุงูุฃุญุฑู.  ููู ูููู ูุฐุง ุงูุชุทุงุจู ูููููุงุ <br><br>  ูุฐุง ูุฃู ุงูููุฏ ุงูุฐู ููุฑุฃู ููุชูุจ <b>ุจูุบุฉ ุงูุชุฌููุน</b> - ูู ุดูู ูุต ุนุงุฏู ุ ูุงุจู ูููุฑุงุกุฉ ููุงุจู ูููุชุงุจุฉ.  ุชููู ุฃุฏุงุฉ ุชุณูู <b>ุงููุฌููุน</b> ุจุชุญููู ูู ุณุทุฑ ูู ุงููุต ุฅูู ุชุนูููุฉ ุซูุงุฆูุฉ 16 ุจุช ูููููุง ุงูุฌูุงุฒ ุงูุธุงูุฑู.  ููุทูู ุนูู ูุฐุง ุงููููุฐุฌ ุงูุซูุงุฆู ุ ุงูุฐู ูุนุฏ ุฃุณุงุณูุง ูุฌููุนุฉ ูู ุงูุฅุฑุดุงุฏุงุช 16 ุจุช ุ <b>ุฑูุฒ ุงูุฌูุงุฒ</b> ููุชู ุชูููุฐู ุจุงููุนู ุจูุงุณุทุฉ ุฌูุงุฒ ุงูุชุฑุงุถู. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2a7/832/c48/2a7832c4840636fbba310c9e7095ee4d.gif"></div><br><blockquote style=";text-align:right;direction:rtl">  <b>ููุงุญุธุฉ:</b> ุนูู ุงูุฑุบู ูู ุฃู ุงููุฌูุน ูุงููุฌูุน ููุนุจุงู ุฏูุฑูุง ูุดุงุจููุง ูู ุงูุชุทููุฑ ุ ุฅูุง ุฃูููุง ููุณุง ูุชูุงุซููู.  ูููู ุงููุฌููุน ุจุจุณุงุทุฉ ุจุชุดููุฑ ูุง ูุชุจู ุงููุจุฑูุฌ ูู ุงููุต ุ ูุงุณุชุจุฏุงู ุงูุฃุญุฑู ุจุชูุซูููุง ุงูุซูุงุฆู ูุชุนุจุฆุชูุง ูู ุงูุชุนูููุงุช. </blockquote><br>  ูุจุฏู <code>.ORIG</code> ู. <code>.STRINGZ</code> ุชุนูููุงุช ุ ููู ูุง.  ูุฐู ูู ุชูุฌููุงุช ุงููุฌููุน ุงูุชู ุชูุดุฆ ุฌุฒุกูุง ูู ุงูููุฏ ุฃู ุงูุจูุงูุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฏุฑุงุฌ <code>.STRINGZ</code> ุณูุณูุฉ ูู ุงูุฃุญุฑู ูู ูููุน ูุญุฏุฏ ูู ุจุฑูุงูุฌ ุซูุงุฆู. <br><br>  ูุชู ุชูููุฐ ุงูุญููุงุช ูุงูุดุฑูุท ุจุงุณุชุฎุฏุงู ุนุจุงุฑุฉ ุชุดุจู goto.  ููุง ูุซุงู ุขุฎุฑ ูุตู ุฅูู 10. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">AND R0, R0, 0 ; clear R0 LOOP ; label at the top of our loop ADD R0, R0, 1 ; add 1 to R0 and store back in R0 ADD R1, R0, -10 ; subtract 10 from R0 and store back in R1 BRn LOOP ; go back to LOOP if the result was negative ... ; R0 is now 10!</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  <b>ููุงุญุธุฉ:</b> ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ูุง ูุฌุจ ุฃู ูุชุนูู ุงูุชุฌููุน.  ูููู ุฅุฐุง ููุช ููุชููุง ุ ูููููู ูุชุงุจุฉ ูุจูุงุก ุจุฑุงูุฌ LC-3 ุงูุฎุงุตุฉ ุจู ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุฏูุงุช LC-3</a> . </blockquote><br><a name="5"></a><h1 style=";text-align:right;direction:rtl">  5. ุชูููุฐ ุงูุจุฑูุงูุฌ </h1><br>  ูุฑุฉ ุฃุฎุฑู ุ ุชุนุทู ุงูุฃูุซูุฉ ุงูุณุงุจูุฉ ูุฌุฑุฏ ููุฑุฉ ุนูุง ููุนูู VM.  ููุชุงุจุฉ VM ุ ูุง ุชุญุชุงุฌ ุฅูู ููู ูุงูู ูููุฌูุน.  ุทุงููุง ุงุชุจุนุช ุงูุฅุฌุฑุงุก ุงูููุงุณุจ ููุฑุงุกุฉ ุงูุชุนูููุงุช ูุชูููุฐูุง ุ ูุฅู <i>ุฃู ุจุฑูุงูุฌ</i> LC-3 ุณูุนูู ุจุดูู ุตุญูุญ ุ ุจุบุถ ุงููุธุฑ ุนู ุชุนููุฏู.  ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุ ูููู ูู VM ุชุดุบูู ูุชุตูุญ ุฃู ูุธุงู ุชุดุบูู ูุซู Linux! <br><br>  ุฅุฐุง ููุช ุชููุฑ ุจุนูู ุ ููุฐู ููุฑุฉ ุฑุงุฆุนุฉ ูู ุงููุงุญูุฉ ุงูููุณููุฉ.  ูููู ุฃู ุชูุชุฌ ุงูุจุฑุงูุฌ ููุณูุง ุฅุฌุฑุงุกุงุช ูุนูุฏุฉ ุจุดูู ุชุนุณูู ูู ูุชููุนูุง ูุทูููุง ููุฏ ูุง ูุณุชุทูุน ููููุง.  ูููู ูู ุงูููุช ููุณู ุ ุชูุชุตุฑ ุฌููุน ูุธุงุฆููุง ุนูู ุฑูุฒ ุจุณูุท ุ ูุงูุฐู ุณููุชุจู!  ูู ุงูููุช ููุณู ุ ูุง ูุนุฑู ูู ุดูุก ููุง ุดูุก ุนู ููููุฉ ุนูู ูู ุจุฑูุงูุฌ.  ุฐูุฑ ุชูุฑููุฌ ูุฐู ุงูููุฑุฉ ุงูุฑุงุฆุนุฉ: <br><br><blockquote style=";text-align:right;direction:rtl">  ุฃุนุชูุฏ ุฃู ุงูุฑุฃู ุงููุงุฆู ุจุฃู ุงูุขูุงุช ูุง ูููู ุฃู ุชูุงุฌุฆ ุฃู ุดุฎุต ุจุฃู ุดูุก ูุณุชูุฏ ุฅูู ุฎุทุฃ ูุงุญุฏ ุ ููู ูุง ูุนุชุจุฑ ุนููุงุก ุงูุฑูุงุถูุงุช ูุงูููุงุณูุฉ ุนุฑุถุฉ ูู ุจุดูู ุฎุงุต.  ุฃูุตุฏ ุงูุงูุชุฑุงุถ ุจุฃูู ูุธุฑูุง ูุฃู ุจุนุถ ุงูุญูุงุฆู ุฃุตุจุญุช ููููุง ููุนูู ุ ูุฅู ุฌููุน ุนูุงูุจ ูุฐู ุงูุญูููุฉ ุณุชุตุจุญ ุนูู ุงูููุฑ ููููุง ููุนูู ".  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุขูุงู ู. ุชูุฑูุฌ</a> </blockquote><br><h3 style=";text-align:right;direction:rtl">  ุงูุฅุฌุฑุงุก </h3><br>  ูููุง ููู ุงููุตู ุงูุฏููู ููุฅุฌุฑุงุก ุงููุฑุงุฏ ูุชุงุจุชู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุจุชูุฒูู ุชุนูููุฉ ูุงุญุฏุฉ ูู ุงูุฐุงูุฑุฉ ุนูู ุนููุงู ุณุฌู <code>PC</code> . </li><li style=";text-align:right;direction:rtl">  ุฒูุงุฏุฉ ุณุฌู <code>PC</code> . </li><li style=";text-align:right;direction:rtl">  ุนุฑุถ ุดูุฑุฉ ุงูุชุดุบูู ูุชุญุฏูุฏ ููุน ุงูุชุนูููุงุช ุงูุชู ูุฌุจ ุงุชุจุงุนูุง. </li><li style=";text-align:right;direction:rtl">  ุงุชุจุน ุงูุชุนูููุงุช ุจุงุณุชุฎุฏุงู ุงููุนููุงุช. </li><li style=";text-align:right;direction:rtl">  ุงูุนูุฏุฉ ุฅูู ุงูุฎุทูุฉ 1. </li></ol><br>  ูุฏ ุชุทุฑุญ ุงูุณุคุงู ุงูุชุงูู: "ููู ุฅุฐุง ุงุณุชูุฑุช ุงูุญููุฉ ูู ุฒูุงุฏุฉ ุงูุนุฏุงุฏ ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ ุฃู <code>if</code> ุ ูู ุณุชูุชูู ุงูุฅุฑุดุงุฏุงุชุ"  ุงูุฌูุงุจ ูู ูุง.  ููุง ุฐูุฑูุง ุณุงุจููุง ุ ูุฅู ุจุนุถ ุงูุฅุฑุดุงุฏุงุช ุงููุดุงุจูุฉ goto ุชุบูุฑ ุชุฏูู ุงูุชูููุฐ ุนู ุทุฑูู ุงูููุฒ ุญูู <code>PC</code> . <br><br>  ูุจุฏุฃ ุฏุฑุงุณุฉ ูุฐู ุงูุนูููุฉ ููุซุงู ููุฏูุฑุฉ ุงูุฑุฆูุณูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* argv[])</span></span></span><span class="hljs-function"> </span></span>{ {Load Arguments, <span class="hljs-number"><span class="hljs-number">12</span></span>} {Setup, <span class="hljs-number"><span class="hljs-number">12</span></span>} <span class="hljs-comment"><span class="hljs-comment">/* set the PC to starting position */</span></span> <span class="hljs-comment"><span class="hljs-comment">/* 0x3000 is the default */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { PC_START = <span class="hljs-number"><span class="hljs-number">0x3000</span></span> }; reg[R_PC] = PC_START; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> running = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (running) { <span class="hljs-comment"><span class="hljs-comment">/* FETCH */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> instr = mem_read(reg[R_PC]++); <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> op = instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (op) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_ADD: {ADD, <span class="hljs-number"><span class="hljs-number">6</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_AND: {AND, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_NOT: {NOT, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_BR: {BR, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_JMP: {JMP, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_JSR: {JSR, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_LD: {LD, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_LDI: {LDI, <span class="hljs-number"><span class="hljs-number">6</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_LDR: {LDR, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_LEA: {LEA, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_ST: {ST, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_STI: {STI, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_STR: {STR, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_TRAP: {TRAP, <span class="hljs-number"><span class="hljs-number">8</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_RES: <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> OP_RTI: <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: {BAD OPCODE, <span class="hljs-number"><span class="hljs-number">7</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } {Shutdown, <span class="hljs-number"><span class="hljs-number">12</span></span>} }</code> </pre> <br><a name="6"></a><h1 style=";text-align:right;direction:rtl">  6. ุชูููุฐ ุงูุชุนูููุงุช </h1><br>  ูููุชู ุงูุขู ูู ุฌุนู ุงูุชูููุฐ ุงูุตุญูุญ ููู ุดูุฑุฉ ุชุดุบูู.  ููุฑุฏ ูุตู ููุตู ููู ุชุนูููุงุช ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงุฆู ุงููุดุฑูุน</a> .  ูู ุงูููุงุตูุงุช ุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ููููุฉ ุนูู ูู ุชุนูููุงุช ููุชุงุจุฉ ุงูุชูููุฐ.  ูุฐุง ุฃุณูู ููุง ูุจุฏู.  ููุง ุณุฃูุถุญ ููููุฉ ุชูููุฐ ุงุซููู ูููู.  ูููู ุงูุนุซูุฑ ุนูู ุฑูุฒ ุงูุจุงูู ูู ุงููุณู ุงูุชุงูู. <br><br><h3 style=";text-align:right;direction:rtl">  ุฃุถู </h3><br>  ูุฃุฎุฐ ุชุนูููุฉ <code>ADD</code> ุฑูููู ุ ููุถูููู ููุฎุฒู ุงููุชูุฌุฉ ูู ุงูุณุฌู.  ุงูููุงุตูุงุช ููุฌูุฏุฉ ูู ุงููุซุงุฆู ูู ุงูุตูุญุฉ 526. ูู ุชุนูููุฉ <code>ADD</code> ูู ููุง ููู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/68a/676/f4e/68a676f4ed10acf22a34a088e6a2edc7.gif"></div><br><br>  ููุฌุฏ ุณุทุฑูู ูู ุงููุฎุทุท ุ ูุฃู ููุงู "ูุถุนูู" ูุฎุชูููู ููุฐู ุงูุชุนูููุงุช.  ูุจู ุฃู ุฃุดุฑุญ ุงูุฃูุถุงุน ุ ุฏุนููุง ูุญุงูู ุฅูุฌุงุฏ ุฃูุฌู ุงูุชุดุงุจู ุจููููุง.  ููุงููุง ูุจุฏุฃ ุจุฃุฑุจุนุฉ ุจุชุงุช ูุชุทุงุจูุฉ <code>0001</code> .  ูุฐู ูู ูููุฉ ุดูุฑุฉ ุงูุชุดุบูู ูู <code>OP_ADD</code> .  ูุชู ูุถุน ุนูุงูุฉ ุนูู ุงูุจุชุงุช ุงูุซูุงุซุฉ ุงูุชุงููุฉ ูู ุณุฌู ุงูุฅุฎุฑุงุฌ.  ุณุฌู ุงูุฅุฎุฑุงุฌ ูู ุงูููุงู ุงูุฐู ูุชู ููู ุชุฎุฒูู ุงููุจูุบ.  ุงูุจุชุงุช ุงูุซูุงุซุฉ ุงูุชุงููุฉ ูู: <code>SR1</code> .  ูุฐุง ุณุฌู ูุญุชูู ุนูู ุงูุฑูู ุงูุฃูู ุงููุฑุงุฏ ุฅุถุงูุชู. <br><br>  ูุจุงูุชุงูู ุ ูุญู ูุนุฑู ููุงู ุญูุธ ุงููุชูุฌุฉ ุ ููุนุฑู ุงูุฑูู ุงูุฃูู ุงูุฐู ูุฌุจ ุฅุถุงูุชู.  ูุจูู ููุท ููุนุฑูุฉ ุงูุฑูู ุงูุซุงูู ููุฅุถุงูุฉ.  ููุง ูุจุฏุฃ ุงูุฎุทุงู ูู ุงูุงุฎุชูุงู.  ูุงุญุธ ุฃู ุงูุจุช 5 ูุณุงูู 0 ูู ุงูุฃุนูู ูุฃู 1. ููุฌูุฏ ูู ุงูุฃุณูู ุ ููุฐุง ุงูุฌุฒุก ูุชูุงูู ูุน <i>ุงููุถุน ุงููุจุงุดุฑ</i> ุฃู <i>ูุถุน ุงูุชุณุฌูู</i> .  ูู ูุถุน ุงูุชุณุฌูู ุ ูุชู ุชุฎุฒูู ุงูุฑูู ุงูุซุงูู ูู ุงูุณุฌู ุ ูุซู ุงูุฃูู.  ุชู ูุถุน ุนูุงูุฉ ุนูู ุฃูู <code>SR2</code> ููู ููุฌูุฏ ูู ุงูุจุชุงุช ูู ุงูุซุงูู ุฅูู ุงูุตูุฑ.  ูุง ูุชู ุงุณุชุฎุฏุงู ุงูุจุชุงุช 3 ู 4.  ูู ุงููุฌูุน ุ ุณูุชู ูุชุงุจุฉ ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">ADD R2 R0 R1 ; add the contents of R0 to R1 and store in R2.</code> </pre> <br>  ูู ุงููุถุน ุงูููุฑู ุ ุจุฏูุงู ูู ุฅุถุงูุฉ ูุญุชููุงุช ุงูุณุฌู ุ ูุชู ุชุถููู ุงููููุฉ ุงูููุฑูุฉ ูู ุงูุชุนูููุงุช ููุณูุง.  ูุฐุง ููุงุณุจ ูุฃู ุงูุจุฑูุงูุฌ ูุง ูุญุชุงุฌ ุฅูู ุชุนูููุงุช ุฅุถุงููุฉ ูุชุญููู ูุฐุง ุงูุฑูู ูู ุงูุณุฌู ูู ุงูุฐุงูุฑุฉ.  ุจุฏูุงู ูู ุฐูู ุ ูู ุจุงููุนู ุฏุงุฎู ุงูุชุนูููุงุช ุนูุฏูุง ูุญุชุงุฌ ุฅูููุง.  ุงูููุงุถูุฉ ูู ุฃูู ูููู ุชุฎุฒูู ุงูุฃุฑูุงู ุงูุตุบูุฑุฉ ููุท ููุงู.  ุนูู ูุฌู ุงูุฏูุฉ ุ ุจุญุฏ ุฃูุตู 2 <sup>5</sup> = 32.  ูุฐุง ูููุฏ ููุบุงูุฉ ูุฒูุงุฏุฉ ุงูุนุฏุงุฏุงุช ุฃู ุงูููู.  ูู ุงููุฌูุน ุ ููููู ูุชุงุจุฉ ูุซู ูุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">ADD R0 R0 1 ; add 1 to R0 and store back in R0</code> </pre> <br>  ููุง ููุชุทู ูู ุงูููุงุตูุงุช: <br><br><blockquote style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ูููุฉ ุงูุจุช [5] ุชุณุงูู 0 ุ ูุณูุชู ุงูุญุตูู ุนูู ุงููุนุงูู ุงููุตุฏุฑ ุงูุซุงูู ูู SR2.  ุฅุฐุง ูุงูุช ุงูุจุชุฉ [5] 1 ุ ูุณูุชู ุงูุญุตูู ุนูู ุงููุนุงูู ุงููุตุฏุฑ ุงูุซุงูู ุนู ุทุฑูู ุชูุณูุน imm5 ุฅูู 16 ุจุช.  ูู ููุชุง ุงูุญุงูุชูู ุ ุชุชู ุฅุถุงูุฉ ุงููุนุงูู ุงููุตุฏุฑ ุงูุซุงูู ุฅูู ูุญุชููุงุช SR1 ุ ููุชู ุชุฎุฒูู ุงููุชูุฌุฉ ูู DR.  (ุต 526) </blockquote><br>  ูุฐุง ูุดุงุจู ููุง ูุงูุดูุงู.  ูููู ูุง ูู "ุงูุชุฏุงุฏ ุงููุนูู"ุ  ุนูู ุงูุฑุบู ูู ุฃู ุงููููุฉ ุงููุจุงุดุฑุฉ ูู ุงููุถุน ุงููุจุงุดุฑ ูุง ุชุญุชูู ุฅูุง ุนูู 5 ุจุชุงุช ุ ุฅูุง ุฃูู ูุฌุจ ุฅุถุงูุชูุง ุจุฑูู 16 ุจุช.  ูุฌุจ ุชูุณูุน ูุฐู ุงูุจุชุงุช 5 ุฅูู 16 ูุชุชูุงูู ูุน ุฑูู ุขุฎุฑ.  ุจุงููุณุจุฉ ููุฃุฑูุงู ุงูููุฌุจุฉ ุ ูููููุง ููุก ุงูุจุชุงุช ุงูููููุฏุฉ ุจุงูุฃุตูุงุฑ ูุงูุญุตูู ุนูู ููุณ ุงููููุฉ.  ููุน ุฐูู ุ ุจุงููุณุจุฉ ููุฃุนุฏุงุฏ ุงูุณุงูุจุฉ ูุง ูุนูู ูุฐุง.  ุนูู ุณุจูู ุงููุซุงู ุ โ1 ูู ุฎูุณ ุจุชุงุช ูู <code>1 1111</code> .  ุฅุฐุง ููุฃุชู ุจุงูุฃุตูุงุฑ ุ ูุณูุญุตู ุนูู <code>0000 0000 0001 1111</code> ุ ููู 32!  ุชูุณูุน ุงููููุฉ ูููุน ูุฐู ุงููุดููุฉ ุนู ุทุฑูู ููุก ุงูุจุชุงุช ุจุงูุฃุตูุงุฑ ููุฃุฑูุงู ุงูููุฌุจุฉ ูุงูุฃุฑูุงู ุงูุณุงูุจุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> sign_extend(<span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> x, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bit_count) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((x &gt;&gt; (bit_count - <span class="hljs-number"><span class="hljs-number">1</span></span>)) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) { x |= (<span class="hljs-number"><span class="hljs-number">0xFFFF</span></span> &lt;&lt; bit_count); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x; }</code> </pre> <br><blockquote style=";text-align:right;direction:rtl">  <b>ููุงุญุธุฉ:</b> ุฅุฐุง ููุช ููุชููุง ุจุงูุฃุฑูุงู ุงูุณุงูุจุฉ ุงูุซูุงุฆูุฉ ุ ูููููู ุงููุฑุงุกุฉ ุนู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุฏ ุงูุฅุถุงูู</a> .  ูููู ูุฐุง ููุณ ุถุฑูุฑูุง.  ูุง ุนููู ุณูู ูุณุฎ ุงูุฑูุฒ ุฃุนูุงู ูุงุณุชุฎุฏุงูู ุนูุฏูุง ุชููู ุงูููุงุตูุงุช ูุชูุณูุน ุงููููุฉ. </blockquote><br>  ุงูููุงุตูุงุช ูุฏููุง ุงูุฌููุฉ ุงูุฃุฎูุฑุฉ: <br><br><blockquote style=";text-align:right;direction:rtl">  ูุชู ุชุนููู ุฑููุฒ ุงูุญุงูุฉ ููููุง ููุง ุฅุฐุง ูุงูุช ุงููุชูุฌุฉ ุณุงูุจุฉ ุฃู ุตูุฑ ุฃู ููุฌุจุฉ.  (ุต 526) </blockquote><br>  ูู ููุช ุณุงุจู ุญุฏุฏูุง ุดุฑุท ุชุนุฏุงุฏ ุงูุนูุงูุงุช ุ ูุงูุขู ุญุงู ุงูููุช ูุงุณุชุฎุฏุงู ูุฐู ุงูุนูุงูุงุช.  ูู ูู ูุฑุฉ ูุชู ูููุง ูุชุงุจุฉ ูููุฉ ุฅูู ุงูุณุฌู ุ ูุญุชุงุฌ ุฅูู ุชุญุฏูุซ ุงูุฃุนูุงู ููุฅุดุงุฑุฉ ุฅูู ุนูุงูุฉ.  ููุชุจ ูุธููุฉ ูุฅุนุงุฏุฉ ุงูุงุณุชุฎุฏุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update_flags</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reg[r] == <span class="hljs-number"><span class="hljs-number">0</span></span>) { reg[R_COND] = FL_ZRO; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (reg[r] &gt;&gt; <span class="hljs-number"><span class="hljs-number">15</span></span>) <span class="hljs-comment"><span class="hljs-comment">/* a 1 in the left-most bit indicates negative */</span></span> { reg[R_COND] = FL_NEG; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { reg[R_COND] = FL_POS; } }</code> </pre> <br>  ูุญู ุงูุขู ุนูู ุงุณุชุนุฏุงุฏ ููุชุงุจุฉ ุฑูุฒ <code>ADD</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-comment"><span class="hljs-comment">/* destination register (DR) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* first operand (SR1) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r1 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* whether we are in immediate mode */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> imm_flag = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imm_flag) { <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> imm5 = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); reg[r0] = reg[r1] + imm5; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r2 = instr &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; reg[r0] = reg[r1] + reg[r2]; } update_flags(r0); }</code> </pre> <br>  ูุญุชูู ูุฐุง ุงููุณู ุนูู ุงููุซูุฑ ูู ุงููุนูููุงุช ุ ูุฐูู ุฏุนููุง ููุฎุต. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฃุฎุฐ <code>ADD</code> ูููุชูู ููุฎุฒูููุง ูู ุณุฌู. </li><li style=";text-align:right;direction:rtl">  ูู ูุถุน ุงูุชุณุฌูู ุ ุงููููุฉ ุงูุซุงููุฉ ุงููุฑุงุฏ ุฅุถุงูุชูุง ูู ูู ุงูุณุฌู. </li><li style=";text-align:right;direction:rtl">  ูู ุงููุถุน ุงููุจุงุดุฑ ุ ูุชู ุชุถููู ุงููููุฉ ุงูุซุงููุฉ ูู 5 ุจุชุงุช ุงูุตุญูุญุฉ ูู ุงูุชุนูููุงุช. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุชูุณูุน ุงูููู ุงูุชู ุชูู ุนู 16 ุจุช. </li><li style=";text-align:right;direction:rtl">  ูู ูู ูุฑุฉ ูุชู ูููุง ุชุบููุฑ ุงูุชุนูููุงุช ุ ูุฌุจ ุชุญุฏูุซ ุนูุงูุงุช ุงูุญุงูุฉ. </li></ul><br>  ูุฏ ุชุทุบู ุนููู ุจูุชุงุจุฉ 15 ุชุนูููุงุช ุฃุฎุฑู.  ููุน ุฐูู ุ ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงููุนูููุงุช ุงูุชู ุชู ุงูุญุตูู ุนูููุง ููุง.  ุชุณุชุฎุฏู ูุนุธู ุงูุฅุฑุดุงุฏุงุช ูุฌููุนุฉ ูู ุชูุณูุน ุงููููุฉ ุ ูุงูุฃููุงุท ุงููุฎุชููุฉ ุ ูุชุญุฏูุซุงุช ุงูุนูู. <br><br><h3 style=";text-align:right;direction:rtl">  LDI </h3><br>  LDI ุชุนูู ุงูุชุญููู "ุบูุฑ ุงููุจุงุดุฑ" ุฃู "ุบูุฑ ุงููุจุงุดุฑ" (ุงูุชุญููู ุบูุฑ ุงููุจุงุดุฑ).  ูุณุชุฎุฏู ูุฐุง ุงูุฅุฑุดุงุฏุงุช ูุชุญููู ุงูููู ูู ูููุน ุงูุฐุงูุฑุฉ ูู ุงูุณุฌู.  ููุงุตูุงุช ุนูู ุงูุตูุญุฉ 532. <br><br>  ุฅููู ูุง ูุจุฏู ุนููู ุงูุดูู ุงูุซูุงุฆู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/dba/efe/0d9/dbaefe0d919cac5489178d7707c1fe0e.gif"></div><br><br>  ุนูู ุนูุณ <code>ADD</code> ุ ูุง ุชูุฌุฏ ุฃูุถุงุน ูุนุฏุฏ ุฃูู ูู ุงููุนููุงุช.  ูุฐู ุงููุฑุฉ ุ ุฑูุฒ ุงูุนูููุฉ ูู <code>1010</code> ุ ูุงูุฐู ูุชูุงูู ูุน ูููุฉ ุงูุชุนุฏุงุฏ <code>OP_LDI</code> .  ูุฑุฉ ุฃุฎุฑู ุ ูุฑู <code>DR</code> ุซูุงุซุฉ ุจุชุงุช (ุณุฌู ุงูุฅุฎุฑุงุฌ) ูุชุฎุฒูู ุงููููุฉ ุงููุญููุฉ.  ูุชู ุชูููุฒ ุงูุจุชุงุช ุงููุชุจููุฉ ุนูู ุฃููุง <code>PCoffset9</code> .  ูุฐู ูู ุงููููุฉ ุงููุจุงุดุฑุฉ ุงููุถููุฉ ูู ุงูุชุนูููุงุช (ุนูู ุบุฑุงุฑ <code>imm5</code> ).  ูุธุฑูุง ูุฃู ุงูุชุนูููุฉ ูุชู ุชุญููููุง ูู ุงูุฐุงูุฑุฉ ุ ููููููุง ุชุฎููู ุฃู ูุฐุง ุงูุฑูู ูู ููุน ูู ุงูุนููุงู ููุถุญ ููุงู ุชุญููู ุงููููุฉ ููู.  ุชุดุฑุญ ุงูููุงุตูุงุช ุจูุฒูุฏ ูู ุงูุชูุงุตูู: <br><br><blockquote style=";text-align:right;direction:rtl">  ูุชู ุญุณุงุจ ุงูุนููุงู ุนู ุทุฑูู ุชูุณูุน ุจุชุงุช ุงููููุฉ <code>[8:0]</code> ุฅูู 16 ุจุช ูุฅุถุงูุฉ ูุฐู ุงููููุฉ ุฅูู <code>PC</code> ุงูููุณุน.  ูุง ูุชู ุชุฎุฒููู ูู ุงูุฐุงูุฑุฉ ุนูู ูุฐุง ุงูุนููุงู ูู ุนููุงู ุงูุจูุงูุงุช ุงูุชู ุณูุชู ุชุญููููุง ูู <code>DR</code> .  (ุต 532) </blockquote><br>  ููุง ูู ุงูุณุงุจู ุ ุชุญุชุงุฌ ุฅูู ุชูุณูุน ูุฐู ุงููููุฉ ุฐุงุช 9 ุจุช ุ ููู ูุฐู ุงููุฑุฉ ุฃุถููุง ุฅูู <code>PC</code> ุงูุญุงูู.  (ุฅุฐุง ูุธุฑุช ุฅูู ุฏูุฑุฉ ุงูุชูููุฐ ุ ุฒุงุฏ <code>PC</code> ูุจุงุดุฑุฉ ุจุนุฏ ุชุญููู ูุฐู ุงูุชุนูููุงุช).  ุงููุฌููุน ุงููุงุชุฌ ูู ุนููุงู ุงููููุน ูู ุงูุฐุงูุฑุฉ ุ ููุฐุง ุงูุนููุงู <i>ูุญุชูู ุนูู</i> ูููุฉ <i>ุฃุฎุฑู</i> ุ ููู ุนููุงู ูููุฉ ุงูุชุญููู. <br><br>  ูุฏ ูุจุฏู ูุฐุง ูุทุฑููุฉ ููุชููุฉ ูููุฑุงุกุฉ ูู ุงูุฐุงูุฑุฉ ุ ููู ูุฐุง ุถุฑูุฑู.  ููุชุตุฑ ุชุนูููุฉ <code>LD</code> ุนูู ุฅุฒุงุญุฉ ุนููุงู ููููุฉ ูู 9 ุจุชุงุช ุ ุจูููุง ุชุชุทูุจ ุงูุฐุงูุฑุฉ ุนููุงููุง 16 ุจุช.  ููุนุฏ <code>LDI</code> ูููุฏูุง ูุชุญููู ุงูููู ุงููุฎุฒูุฉ ูู ููุงู ูุง ุฎุงุฑุฌ ุงูููุจููุชุฑ ุงูุญุงูู ุ ูููู ูุงุณุชุฎุฏุงููุง ุ ูุฌุจ ุชุฎุฒูู ุนููุงู ุงููููุน ุงูููุงุฆู ูู ููุงู ูุฑูุจ.  ููููู ุงูุชูููุฑ ูู ุงูุฃูุฑ ููุชุบูุฑ ูุญูู ูู C ุ ููู ูุคุดุฑ ูุจุนุถ ุงูุจูุงูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// the value of far_data is an address // of course far_data itself (the location in memory containing the address) has an address char* far_data = "apple"; // In memory it may be layed out like this: // Address Label Value // 0x123: far_data = 0x456 // ... // 0x456: string = 'a' // if PC was at 0x100 // LDI R0 0x023 // would load 'a' into R0</span></span></code> </pre> <br>  ููุง ูุงู ูู ูุจู ุ ุจุนุฏ ูุชุงุจุฉ ุงููููุฉ ุฅูู <code>DR</code> ุ ูุฌุจ ุชุญุฏูุซ ุงูุนูุงูุงุช: <br><br><blockquote style=";text-align:right;direction:rtl">  ูุชู ุชุนููู ุฑููุฒ ุงูุญุงูุฉ ููููุง ููุง ุฅุฐุง ูุงูุช ุงููุชูุฌุฉ ุณุงูุจุฉ ุฃู ุตูุฑ ุฃู ููุฌุจุฉ.  (ุต 532) </blockquote><br>  ุฅููู ุฑูุฒ ูุฐู ุงูุญุงูุฉ: ( <code>mem_read</code> ููุงูุดุฉ <code>mem_read</code> ูู ุงููุณู ุงูุชุงูู): <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-comment"><span class="hljs-comment">/* destination register (DR) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* PCoffset 9*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> pc_offset = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x1ff</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* add pc_offset to the current PC, look at that memory location to get the final address */</span></span> reg[r0] = mem_read(mem_read(reg[R_PC] + pc_offset)); update_flags(r0); }</code> </pre> <br>  ููุง ููุช ุ ูู ูุฐุง ุงูุฅุฑุดุงุฏุงุช ุ ุงุณุชุฎุฏููุง ุฌุฒุกูุง ูุจูุฑูุง ูู ุงูุดูุฑุฉ ูุงููุนุฑูุฉ ุงูููุชุณุจุฉ ุณุงุจููุง ุนูุฏ ูุชุงุจุฉ <code>ADD</code> .  ุงูุดูุก ููุณู ูุน ุจููุฉ ุงูุชุนูููุงุช. <br><br>  ุงูุขู ุชุญุชุงุฌ ุฅูู ุชูููุฐ ุจููุฉ ุงูุชุนูููุงุช.  ุงุชุจุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูููุงุตูุงุช</a> ูุงุณุชุฎุฏู ุงูููุฏ ุงูููุชูุจ ุจุงููุนู.  ููุฑุฏ ุฑูุฒ ูุฌููุน ุงูุชุนูููุงุช ูู ููุงูุฉ ุงูููุงู.  ูู ุชููู ููุงู ุญุงุฌุฉ ุฅูู <code>OP_RTI</code> <code>OP_RES</code> ุงููุฐููุฑุฉ ุณุงุจููุง: <code>OP_RTI</code> ู <code>OP_RES</code> .  ููููู ุชุฌุงูููู ุฃู ุฅุนุทุงุก ุฎุทุฃ ุฅุฐุง ุชู ุงุณุชุฏุนุงุฆูู.  ุนูุฏ ุงูุงูุชูุงุก ุ ูููู ุงุนุชุจุงุฑ ุงูุฌุฒุก ุงูุฃูุจุฑ ูู ุฌูุงุฒ VM ูุงููุงู! <br><br><a name="7"></a><h1 style=";text-align:right;direction:rtl">  7. ุณุฑูุฑ ูููุง ููุชุนูููุงุช </h1><br>  ูุญุชูู ูุฐุง ุงููุณู ุนูู ุชุทุจููุงุช ูุงููุฉ ููุชุนูููุงุช ุงููุชุจููุฉ ุฅุฐุง ููุช ุนุงูููุง. <br><br><h3 style=";text-align:right;direction:rtl">  RTI &amp; RES </h3><br>  (ุบูุฑ ูุณุชุฎุฏู) <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">abort</span></span>();</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุช "ู"</a> </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r1 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> imm_flag = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (imm_flag) { <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> imm5 = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); reg[r0] = reg[r1] &amp; imm5; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r2 = instr &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; reg[r0] = reg[r1] &amp; reg[r2]; } update_flags(r0); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุง</a> </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r1 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; reg[r0] = ~reg[r1]; update_flags(r0); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ูุฑุน </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> pc_offset = sign_extend((instr) &amp; <span class="hljs-number"><span class="hljs-number">0x1ff</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> cond_flag = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cond_flag &amp; reg[R_COND]) { reg[R_PC] += pc_offset; } }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุงูููุฒ </h3><br>  ูุดุงุฑ ุฅูู <code>RET</code> ูููุตูุฉ ูู ุงูููุงุตูุงุช ุ ูุฃู ูุฐุง ุฃูุฑ ุขุฎุฑ ูู ุงููุฌูุน.  ูุฐุง ูู ูู ุงููุงูุน ุญุงูุฉ ุฎุงุตุฉ ูู <code>JMP</code> .  ูุญุฏุซ <code>RET</code> ูููุง ูุงูุช <code>R1</code> 7. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-comment"><span class="hljs-comment">/* Also handles RET */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r1 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; reg[R_PC] = reg[r1]; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุณุฌู ุงูููุฒ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r1 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> long_pc_offset = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> long_flag = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>; reg[R_R7] = reg[R_PC]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (long_flag) { reg[R_PC] += long_pc_offset; <span class="hljs-comment"><span class="hljs-comment">/* JSR */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { reg[R_PC] = reg[r1]; <span class="hljs-comment"><span class="hljs-comment">/* JSRR */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุชุญููู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> pc_offset = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x1ff</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>); reg[r0] = mem_read(reg[R_PC] + pc_offset); update_flags(r0); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุณุฌู ุงูุชุญููู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r1 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> offset = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x3F</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); reg[r0] = mem_read(reg[r1] + offset); update_flags(r0); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุนููุงู ุงูุชุญููู ุงููุนุงู </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> pc_offset = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x1ff</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>); reg[r0] = reg[R_PC] + pc_offset; update_flags(r0); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ูุชุฌุฑ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> pc_offset = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x1ff</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>); mem_write(reg[R_PC] + pc_offset, reg[r0]); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ูุชุฌุฑ ุบูุฑ ูุจุงุดุฑ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> pc_offset = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x1ff</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>); mem_write(mem_read(reg[R_PC] + pc_offset), reg[r0]); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl">  ุณุฌู ุงููุชุฌุฑ </h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r1 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> offset = sign_extend(instr &amp; <span class="hljs-number"><span class="hljs-number">0x3F</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); mem_write(reg[r1] + offset, reg[r0]); }</code> </pre> <br><a name="8"></a><h1 style=";text-align:right;direction:rtl">  8. ููุงุทุนุฉ ุฅุฌุฑุงุกุงุช ุงูููุงููุฉ </h1><br>  ูููุฑ LC-3 ุงูุนุฏูุฏ ูู ุงูุฅุฌุฑุงุกุงุช ุงููุญุฏุฏุฉ ูุณุจููุง ูุฃุฏุงุก ุงูููุงู ุงูุดุงุฆุนุฉ ูุงูุชูุงุนู ูุน ุฃุฌูุฒุฉ ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ.  ุนูู ุณุจูู ุงููุซุงู ุ ููุงู ุฅุฌุฑุงุกุงุช ูุชููู ุฎุทูุท ุฅุฏุฎุงู ูุฅุฎุฑุงุฌ ููุญุฉ ุงูููุงุชูุญ ุฅูู ูุญุฏุฉ ุงูุชุญูู.  ูุทูู ุนูููุง ุฅุฌุฑุงุกุงุช ุงูุงุนุชุฑุงุถ ุ ูุงูุชู ููููู ุงูุชูููุฑ ุจูุง ููุธุงู ุชุดุบูู ุฃู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูู LC-3.  ูุชู ุชุนููู ุฑูุฒ ููุงุทุนุฉ (ุฑูุฒ ูุฎ) ููู ุจุฑูุงูุฌ ูุฑุนู (ูุดุจู ุดูุฑุฉ ุงูุชุดุบูู) ููู ุจุฑูุงูุฌ ูุฑุนู.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชูููุฐู ุ ูุชู ุงุณุชุฏุนุงุก </font></font><code>TRAP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูููุฉ ุจุฑูุฒ ุงูุจุฑูุงูุฌ ุงููุฑุนู ุงููุทููุจ.</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/208/93c/77c/20893c77cbe50ab9dfb7996ea3ce51b1.gif"></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุจุชุนููู ุงูุชุนุฏุงุฏ ููู ุฑูุฒ ุงูููุงุทุนุฉ: </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { TRAP_GETC = <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* get character from keyboard */</span></span> TRAP_OUT = <span class="hljs-number"><span class="hljs-number">0x21</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* output a character */</span></span> TRAP_PUTS = <span class="hljs-number"><span class="hljs-number">0x22</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* output a word string */</span></span> TRAP_IN = <span class="hljs-number"><span class="hljs-number">0x23</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* input a string */</span></span> TRAP_PUTSP = <span class="hljs-number"><span class="hljs-number">0x24</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* output a byte string */</span></span> TRAP_HALT = <span class="hljs-number"><span class="hljs-number">0x25</span></span> <span class="hljs-comment"><span class="hljs-comment">/* halt the program */</span></span> };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฏ ุชุชุณุงุกู ุนู ุณุจุจ ุนุฏู ุชุถููู ุฑููุฒ ุงูููุงุทุนุฉ ูู ุงูุชุนูููุงุช. </font><font style="vertical-align: inherit;">ูุฐุง ูุฃููู ูู ุงููุงูุน ูุง ูุถูููู LC-3 ุฃู ูุธุงุฆู ุฌุฏูุฏุฉ ุ ููููู ูููุฑูู ููุท ูุณููุฉ ููุงุฆูุฉ ูุฅููุงู ุงููููุฉ (ูุซู ูุธุงุฆู ุงููุธุงู ูู C). </font><font style="vertical-align: inherit;">ูู ูุญุงูู LC-3 ุงูุฑุณูู ุ </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุชู ูุชุงุจุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฑููุฒ ุงูููุงุทุนุฉ </font><a href=""><font style="vertical-align: inherit;">ูู ุงููุฌูุน</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุนูุฏ ุงุณุชุฏุนุงุก ุฑูุฒ ุงูููุงุทุนุฉ ุ ููุชูู ุงูููุจููุชุฑ ุฅูู ุนููุงู ูุฐุง ุงูุฑูุฒ. </font><font style="vertical-align: inherit;">ุชููู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ ุจุชูููุฐ ุชุนูููุงุช ุงูุฅุฌุฑุงุก ุ ูุนูุฏ ุงูุงูุชูุงุก ุ ุชุชู </font></font><code>PC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุนุงุฏุฉ ุถุจุทูุง ุฅูู ุงููููุน ุงูุฐู ุชู ุชุดุบูู ุงูููุงุทุนุฉ ููู.</font></font><br><br><blockquote style=";text-align:right;direction:rtl"> <b>:</b>       <code>0x3000</code>  <code>0x0</code> .    ,        . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุง ุชูุฌุฏ ููุงุตูุงุช ุญูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชูููุฐ ุฅุฌุฑุงุกุงุช ุงูููุงุทุนุฉ: ููุท ูุง ูุฌุจ ุงูููุงู ุจู. ูู VM ุงูุฎุงุต ุจูุง ุ ุณูู ูุชุตุฑู ุจุดูู ูุฎุชูู ุจุนุถ ุงูุดูุก ุนู ุทุฑูู ูุชุงุจุชูุง ูู C. ุนูุฏูุง ูุชู ุงุณุชุฏุนุงุก ุฑูุฒ ุงูููุงุทุนุฉ ุ ุณูุชู ุงุณุชุฏุนุงุก ุงูุฏุงูุฉ C. ุ ูุจุนุฏ ุชุดุบูููุง ุ ุณูู ุชุณุชูุฑ ุงูุชุนูููุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃูู ูููู ูุชุงุจุฉ ุงูุฅุฌุฑุงุกุงุช ูู ุงููุฌููุน ูุณูู ูููู ุงูููุจููุชุฑ ุงููุนูู LC-3 ูุฐูู ุ ูุฅู ูุฐุง ููุณ ูู ุงูุฎูุงุฑ ุงูุฃูุถู ููุธุงู VM. ุจุฏูุงู ูู ูุชุงุจุฉ ุฅุฌุฑุงุกุงุช ุงูุฅุฏุฎุงู ูุงูุฅุฎุฑุงุฌ ุงูุจุฏุงุฆูุฉ ุงูุฎุงุตุฉ ุจู ุ ููููู ุงุณุชุฎุฏุงู ุงูุฅุฌุฑุงุกุงุช ุงููุชุงุญุฉ ุนูู ูุธุงู ุงูุชุดุบูู ุงูุฎุงุต ุจูุง. ุณูุคุฏู ุฐูู ุฅูู ุชุญุณูู ุงูุฌูุงุฒ ุงูุธุงูุฑู ุนูู ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ูุฏููุง ุ ูุชุจุณูุท ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุชูููุฑ ูุณุชูู ุฃุนูู ูู ุงูุชุฌุฑูุฏ ููุงุจููุฉ ุงูุญูู.</font></font><br><br><blockquote style=";text-align:right;direction:rtl"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุซุงู ูุญุฏุฏ ูู ุฅุฏุฎุงู ููุญุฉ ุงูููุงุชูุญ. </font><font style="vertical-align: inherit;">ูุณุชุฎุฏู ุฅุตุฏุงุฑ ุงููุฌููุน ุญููุฉ ููุชุญูู ุจุงุณุชูุฑุงุฑ ูู ุฅุฏุฎุงู ููุญุฉ ุงูููุงุชูุญ. </font><font style="vertical-align: inherit;">ูููู ุงููุซูุฑ ูู ููุช ุงููุนุงูุฌ ูุถูุน! </font><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู ูุธููุฉ ูุธุงู ุงูุชุดุบูู ุงูููุงุณุจุฉ ุ ูููู ููุจุฑูุงูุฌ ุงูููู ุจุณูุงู ูุจู ุฅุดุงุฑุฉ ุงูุฅุฏุฎุงู.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุดุบู ูุชุนุฏุฏ ุงูุฎูุงุฑุงุช ูุจุฑูุงูุฌ ุดูุฑุฉ ุงูุชุดุบูู ุ </font></font><code>TRAP</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถู ููุชุงุญูุง ุขุฎุฑ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (instr &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TRAP_GETC: {TRAP GETC, <span class="hljs-number"><span class="hljs-number">9</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TRAP_OUT: {TRAP OUT, <span class="hljs-number"><span class="hljs-number">9</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TRAP_PUTS: {TRAP PUTS, <span class="hljs-number"><span class="hljs-number">8</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TRAP_IN: {TRAP IN, <span class="hljs-number"><span class="hljs-number">9</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TRAP_PUTSP: {TRAP PUTSP, <span class="hljs-number"><span class="hljs-number">9</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TRAP_HALT: {TRAP HALT, <span class="hljs-number"><span class="hljs-number">9</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุง ูู ุงูุญุงู ูุน ุงูุชุนูููุงุช ุ ุณุฃูุถุญ ูู ููููุฉ ุชูููุฐ ุฅุฌุฑุงุก ูุงุญุฏ ุ ูุงูููุงู ุจุงูุจุงูู ุจููุณู. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจูุชุณ </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุชู </font></font><code>PUTS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุฎุฏุงู </font><font style="vertical-align: inherit;">ุฑูุฒ ุงูููุงุทุนุฉ </font><font style="vertical-align: inherit;">ูุฅุฑุฌุงุน ุณูุณูุฉ ูุน ุตูุฑ ุฅููุงุก (ุจุงููุซู </font></font><code>printf</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู C). </font><font style="vertical-align: inherit;">ุงูููุงุตูุงุช ูู ุงูุตูุญุฉ 543. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุนุฑุถ ุณูุณูุฉ ุ ูุฌุจ ุฃู ูุนุทู ุฑูุชูู ุงูููุงุทุนุฉ ุณูุณูุฉ ูุนุฑุถูุง. </font><font style="vertical-align: inherit;">ูุชู ุฐูู ุนู ุทุฑูู ุชุฎุฒูู ุนููุงู ุงูุญุฑู ุงูุฃูู </font></font><code>R0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจู ุจุฏุก ุงููุนุงูุฌุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูููุงุตูุงุช:</font></font><br><br><blockquote style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนุฑุถ ุณูุณูุฉ ุฃุญุฑู ASCII ูู ุนุฑุถ ูุญุฏุฉ ุงูุชุญูู. </font><font style="vertical-align: inherit;">ูุชู ุงุญุชูุงุก ุงูุฃุญุฑู ูู ุฎูุงูุง ุฐุงูุฑุฉ ูุชุนุงูุจุฉ ุ ุญุฑู ูุงุญุฏ ููู ุฎููุฉ ุ ุจุฏุกูุง ูู ุงูุนููุงู ุงููุญุฏุฏ ูู </font></font><code>R0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ููุชูู ุงูุฅุฎุฑุงุฌ ุนูุฏ ููุงุฌูุฉ ูููุฉ ูู ุงูุฐุงูุฑุฉ </font></font><code>x0000</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">(ุต 543)</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุญุธ ุฃูู ุนูู ุนูุณ ุงูุณูุงุณู C ุ ููุง ูุชู ุชุฎุฒูู ุงูุฃุญุฑู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณ ูู ุจุงูุช ูุงุญุฏ ุ ูููู ูู ูููุน ูุงุญุฏ ูู ุงูุฐุงูุฑุฉ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูููุน ุฐุงูุฑุฉ LC-3 ูู 16 ุจุช ุ ูุฐูู ูู ุญุฑู ูู ุงูุณูุณูุฉ ูู 16 ุจุช. </font><font style="vertical-align: inherit;">ูุนุฑุถ ูุฐุง ูู ูุธููุฉ C ุ ุชุญุชุงุฌ ุฅูู ุชุญููู ูู ูููุฉ ุฅูู ุญุฑู ูุทุจุงุนุชูุง ุจุดูู ูููุตู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-comment"><span class="hljs-comment">/* one char per word */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span>* c = memory + reg[R_R0]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (*c) { putc((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)*c, <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>); ++c; } fflush(<span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุณ ููุงู ูุง ูู ูุทููุจ ููุฐุง ุงูุฅุฌุฑุงุก. </font><font style="vertical-align: inherit;">ุฅุฌุฑุงุกุงุช ุงูููุงุทุนุฉ ูุงุถุญุฉ ุฅูู ุญุฏ ูุง ุฅุฐุง ููุช ุชุนุฑู C. ุงูุขู ุนุฏ ุฅูู ุงูููุงุตูุงุช ููู ุจุชูููุฐ ุงูุจุงูู. </font><font style="vertical-align: inherit;">ููุง ูู ุงูุญุงู ูุน ุงูุชุนูููุงุช ุ ูููู ุงูุนุซูุฑ ุนูู ุงูุฑูุฒ ุงููุงูู ูู ููุงูุฉ ูุฐุง ุงูุฏููู.</font></font><br><br><a name="9"></a><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9. ูุฑูุฉ ุงูุบุด ูุฑูุชูู ุงูููุงุทุนุฉ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุญุชูู ูุฐุง ุงููุณู ุนูู ุชุทุจููุงุช ูุงููุฉ ูุฅุฌุฑุงุกุงุช ุงูููุงุทุนุฉ ุงููุชุจููุฉ. </font></font><br><br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฏุฎุงู ุงูุญุฑู </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">/* read a single ASCII char */</span></span> reg[R_R0] = (<span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span>)getchar();</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅุฎุฑุงุฌ ุงูุญุฑู </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">putc((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>)reg[R_R0], <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>); fflush(<span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>);</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุทูุจ ุฅุฏุฎุงู ุงูุญุฑู </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"Enter a character: "</span></span>); reg[R_R0] = (<span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span>)getchar();</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฎุท ุงูุงูุชุงุฌ </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{ <span class="hljs-comment"><span class="hljs-comment">/* one char per byte (two bytes per word) here we need to swap back to big endian format */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span>* c = memory + reg[R_R0]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (*c) { <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> char1 = (*c) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>; putc(char1, <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> char2 = (*c) &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (char2) putc(char2, <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>); ++c; } fflush(<span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>); }</code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅููุงุก ุงูุจุฑูุงูุฌ </font></font></h3><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">puts</span></span>(<span class="hljs-string"><span class="hljs-string">"HALT"</span></span>); fflush(<span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span>); running = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre> <br><a name="10"></a><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 10. ุชูุฒูู ุงูุจุฑุงูุฌ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญุฏุซูุง ูุซูุฑูุง ุนู ุชุญููู ูุชูููุฐ ุงูุชุนูููุงุช ูู ุงูุฐุงูุฑุฉ ุ ูููู ููู ุชุฏุฎู ุงูุชุนูููุงุช ูู ุงูุฐุงูุฑุฉ ุจุดูู ุนุงูุ </font><font style="vertical-align: inherit;">ุนูุฏ ุชุญููู ุจุฑูุงูุฌ ุงููุฌููุน ุฅูู ุฑูุฒ ุงูุฌูุงุฒ ุ ุชููู ุงููุชูุฌุฉ ููููุง ูุญุชูู ุนูู ูุฌููุนุฉ ูู ุงูุชุนูููุงุช ูุงูุจูุงูุงุช. </font><font style="vertical-align: inherit;">ูููู ุชูุฒููู ุจุจุณุงุทุฉ ุนู ุทุฑูู ูุณุฎ ุงููุญุชููุงุช ูุจุงุดุฑุฉ ุฅูู ุนููุงู ูู ุงูุฐุงูุฑุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุดูุฑ ุฃูู 16 ุจุช ูู ููู ุงูุจุฑูุงูุฌ ุฅูู ุงูุนููุงู ูู ุงูุฐุงูุฑุฉ ุญูุซ ูุฌุจ ุฃู ูุจุฏุฃ ุงูุจุฑูุงูุฌ. </font><font style="vertical-align: inherit;">ูุฐุง ุงูุนููุงู ูุณูู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฃุตู</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ูุฌุจ ูุฑุงุกุชูุง ุฃููุงู ุ ูุจุนุฏูุง ุชุชู ูุฑุงุกุฉ ุจููุฉ ุงูุจูุงูุงุช ูู ุงูุฐุงูุฑุฉ ูู ุงูููู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุง ููู ุงูุฑูุฒ ูุชุญููู ุงูุจุฑูุงูุฌ ูู ุฐุงูุฑุฉ LC-3:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_image_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(FILE* file)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/* the origin tells us where in memory to place the image */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> origin; fread(&amp;origin, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(origin), <span class="hljs-number"><span class="hljs-number">1</span></span>, file); origin = swap16(origin); <span class="hljs-comment"><span class="hljs-comment">/* we know the maximum file size so we only need one fread */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> max_read = UINT16_MAX - origin; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span>* p = memory + origin; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> read = fread(p, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span>), max_read, file); <span class="hljs-comment"><span class="hljs-comment">/* swap to little endian */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (read-- &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { *p = swap16(*p); ++p; } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุญุธ ุฃู ููู ูููุฉ ุชุญููู ูุณูู </font></font><code>swap16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุชุชู ูุชุงุจุฉ ุจุฑุงูุฌ LC-3 ุจุชุฑุชูุจ ุจุงูุช ูุจุงุดุฑ ุ ููู ูุนุธู ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุงูุญุฏูุซุฉ ุชุณุชุฎุฏู ุงูุชุฑุชูุจ ุงูุนูุณู. </font><font style="vertical-align: inherit;">ูุชูุฌุฉ ูุฐูู ุ ูุญุชุงุฌ ุฅูู ููุจ ูู ูุงุญุฏุฉ ูุญููุฉ </font></font><code>uint16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">(ุฅุฐุง ุงุณุชุฎุฏูุช ุจุทุฑูู ุงูุฎุทุฃ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฌูุงุฒ ููุจููุชุฑ ุบุฑูุจ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุซู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PPC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุ ููู ูุญุชุงุฌ ุฅูู ุชุบููุฑ).</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> swap16(<span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> x) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (x &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | (x &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>); }</code> </pre> <br><blockquote style=";text-align:right;direction:rtl"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ:</font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุดูุฑ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑุชูุจ ุงูุจุงูุช</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฅูู ููููุฉ ุชุฑุฌูุฉ ุจุงูุช ุนุฏุฏ ุตุญูุญ. </font><font style="vertical-align: inherit;">ุจุงูุชุฑุชูุจ ุงูุนูุณู ุ ุงูุจุงูุช ุงูุฃูู ูู ุงูุฑูู ุงูุฃูู ุฃูููุฉ ุ ููู ุงูุชุฑุชูุจ ุงูุนูุณู ุ ุจุงูุนูุณ. </font><font style="vertical-align: inherit;">ุจูุฏุฑ ูุง ุฃุนุฑู ุ ูุฅู ุงููุฑุงุฑ </font><font style="vertical-align: inherit;">ุชุนุณูู ูู </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุบุงูุจ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุงุชุฎุฐุช ุดุฑูุงุช ูุฎุชููุฉ ูุฑุงุฑุงุช ูุฎุชููุฉ ุ ูุฐูู ูุฏููุง ุงูุขู ุชุทุจููุงุช ูุฎุชููุฉ. </font><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ููุฐุง ุงููุดุฑูุน ุ ูู ุชุนุฏ ุจุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ุฃู ุดูุก ุนู ุชุฑุชูุจ ุงูุจุงูุช.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุถู ุฃูุถูุง ูุธููุฉ ููุงุฆูุฉ ูู </font></font><code>read_image_file</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุงูุชู ุชุฃุฎุฐ ูุณุงุฑ ุงูุณูุณูุฉ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* image_path)</span></span></span><span class="hljs-function"> </span></span>{ FILE* file = fopen(image_path, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!file) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }; read_image_file(file); fclose(file); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br><a name="11"></a><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 11. ุงูุณุฌูุงุช ุงููุนููุฉ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุนุถ ุงูุณุฌูุงุช ุงูุฎุงุตุฉ ุบูุฑ ูุชููุฑุฉ ูู ุฌุฏูู ุงูุชุณุฌูู ุงูุนุงุฏู. ุจุฏูุงู ูู ุฐูู ุ ูุชู ุญุฌุฒ ุนููุงู ุฎุงุต ููู ูู ุงูุฐุงูุฑุฉ. ููุฑุงุกุฉ ูุฐู ุงูุณุฌูุงุช ูุงููุชุงุจุฉ ุฅูููุง ุ ููููู ุจุจุณุงุทุฉ ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ ุฅูู ุฐุงูุฑุชูู. ูุทูู ุนูููู </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุฌูุงุช ุงูุฐุงูุฑุฉ ุงููุนููุฉ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . ุนุงุฏุฉ ูุง ูุชู ุงุณุชุฎุฏุงููุง ููุชูุงุนู ูุน ุฃุฌูุฒุฉ ุฎุงุตุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงููุณุจุฉ ุฅูู LC-3 ูุฏููุง ุ ูุญุชุงุฌ ุฅูู ุชูููุฐ ุณุฌููู ูุงุจููู ููุชุทุจูู. ูุฐุง ูู ุณุฌู ุญุงูุฉ ููุญุฉ ุงูููุงุชูุญ ( </font></font><code>KBSR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) ูุณุฌู ุจูุงูุงุช ููุญุฉ ุงูููุงุชูุญ ( </font></font><code>KBDR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). ูุดูุฑ ุงูุฃูู ุฅูู ูุง ุฅุฐุง ูุงู ุงูููุชุงุญ ูุฏ ุชู ุถุบุทู ุ ุจูููุง ูุญุฏุฏ ุงูุซุงูู ุงูููุชุงุญ ุงูุฐู ุชู ุงูุถุบุท ุนููู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนูู ุงูุฑุบู ูู ุฃูู ูููู ุทูุจ ุฅุฏุฎุงู ููุญุฉ ุงูููุงุชูุญ ุจุงุณุชุฎุฏุงู </font></font><code>GETC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฅูู ูููุน ุงูุชูููุฐ ุญุชู ูุชู ุชููู ุงูุฅุฏุฎุงู. </font></font><code>KBSR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>KBDR</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุณูุญ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุญูู ูู ุญุงูุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฌูุงุฒ ูุน ุงูุงุณุชูุฑุงุฑ ูู ุชุดุบูู ุงูุจุฑูุงูุฌ ุ ุจุญูุซ ูุธู ูุชุฌุงูุจูุง ุฃุซูุงุก ุงูุชุธุงุฑ ุงูุฅุฏุฎุงู.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { MR_KBSR = <span class="hljs-number"><span class="hljs-number">0xFE00</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* keyboard status */</span></span> MR_KBDR = <span class="hljs-number"><span class="hljs-number">0xFE02</span></span> <span class="hljs-comment"><span class="hljs-comment">/* keyboard data */</span></span> };</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุณุฌูุงุช ุงููุนููุฉ ุชุนูุฏ ุงููุตูู ุฅูู ุงูุฐุงูุฑุฉ ููููุงู. </font><font style="vertical-align: inherit;">ูุง ูููููุง ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ ุฅูู ุตููู ุงูุฐุงูุฑุฉ ูุจุงุดุฑุฉ ุ ูููู ุจุฏูุงู ูู ุฐูู ูุฌุจ ุงุณุชุฏุนุงุก ูุธุงุฆู ุฎุงุตุฉ - ูุงุถุนุฉ ู getter. </font><font style="vertical-align: inherit;">ุจุนุฏ ูุฑุงุกุฉ ุงูุฐุงูุฑุฉ ูู ุณุฌู KBSR ุ ูุชุญูู getter ูู ููุญุฉ ุงูููุงุชูุญ ููููู ุจุชุญุฏูุซ ููุง ุงููููุนูู ูู ุงูุฐุงูุฑุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mem_write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> address, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> val)</span></span></span><span class="hljs-function"> </span></span>{ memory[address] = val; } <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> mem_read(<span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> address) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (address == MR_KBSR) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (check_key()) { memory[MR_KBSR] = (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">15</span></span>); memory[MR_KBDR] = getchar(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { memory[MR_KBSR] = <span class="hljs-number"><span class="hljs-number">0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> memory[address]; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฐุง ูู ุงูุนูุตุฑ ุงูุฃุฎูุฑ ูู ุงูุฌูุงุฒ ุงูุธุงูุฑู! </font><font style="vertical-align: inherit;">ุฅุฐุง ููุช ูุฏ ููุฐุช ุจููุฉ ุฅุฌุฑุงุกุงุช ุงูููุงุทุนุฉ ูุฅุฑุดุงุฏุงุชูุง ุ ูุฃูุช ุนูู ุงุณุชุนุฏุงุฏ ุชูุฑูุจูุง ูุชุฌุฑุจุชูุง! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุจ ุฅุถุงูุฉ ูู ุดูุก ููุชูุจ ุฅูู ููู C ุจุงูุชุฑุชูุจ ุงูุชุงูู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{Memory Mapped Registers, <span class="hljs-number"><span class="hljs-number">11</span></span>} {TRAP Codes, <span class="hljs-number"><span class="hljs-number">8</span></span>} {Memory Storage, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Register Storage, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Functions, <span class="hljs-number"><span class="hljs-number">12</span></span>} {Main Loop, <span class="hljs-number"><span class="hljs-number">5</span></span>}</code> </pre> <br><a name="12"></a><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 12. ููุตุฉ ุงูููุฒุงุช </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุชูู ูุฐุง ุงููุณู ุนูู ุจุนุถ ุงูุชูุงุตูู ุงููููุฉ ุงููุงุฒูุฉ ูููุตูู ุฅูู ููุญุฉ ุงูููุงุชูุญ ูุงูุนูู ุจุดูู ุตุญูุญ. </font><font style="vertical-align: inherit;">ูุง ููุฌุฏ ุดูุก ูุซูุฑ ููุงูุชูุงู ุฃู ุจุงููุนูููุงุช ุญูู ุชุดุบูู ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ. </font><font style="vertical-align: inherit;">ูุง ุชุชุฑุฏุฏ ูุณุฎุฉ ูุนุฌูู! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ููุช ุชุญุงูู ุจุฏุก ุชุดุบูู VM ูู ูุธุงู ุชุดุบูู ุจุฎูุงู ูุธุงู ุงูุชุดุบูู Unix ุ ูุซู Windows ุ ููุฌุจ ุงุณุชุจุฏุงู ูุฐู ุงููุธุงุฆู ุจูุธุงุฆู Windows ุงูููุงุธุฑุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> check_key() { fd_set readfds; FD_ZERO(&amp;readfds); FD_SET(STDIN_FILENO, &amp;readfds); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeval</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">timeout</span></span></span><span class="hljs-class">;</span></span> timeout.tv_sec = <span class="hljs-number"><span class="hljs-number">0</span></span>; timeout.tv_usec = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> select(<span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;readfds, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, &amp;timeout) != <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฑูุฒ ูุงุณุชุฎุฑุงุฌ ุงููุณุงุฑ ูู ูุณูุทุงุช ุงูุจุฑูุงูุฌ ูุฅุฎุฑุงุฌ ูุซุงู ููุงุณุชุฎุฏุงู ุฅุฐุง ูุงูุช ููููุฏุฉ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (argc &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-comment"><span class="hljs-comment">/* show usage string */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"lc3 [image-file1] ...\n"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j = <span class="hljs-number"><span class="hljs-number">1</span></span>; j &lt; argc; ++j) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!read_image(argv[j])) { <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"failed to load image: %s\n"</span></span>, argv[j]); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>); } }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููููุณ ูุญุฏุฏุฉ ูุญุทุฉ ุงูุชูููู ุฑูุฒ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">termios</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">original_tio</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">disable_input_buffering</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ tcgetattr(STDIN_FILENO, &amp;original_tio); <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">termios</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new_tio</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">original_tio</span></span></span><span class="hljs-class">;</span></span> new_tio.c_lflag &amp;= ~ICANON &amp; ~ECHO; tcsetattr(STDIN_FILENO, TCSANOW, &amp;new_tio); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">restore_input_buffering</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ tcsetattr(STDIN_FILENO, TCSANOW, &amp;original_tio); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูุฏ ููุงุทุนุฉ ุงูุจุฑูุงูุฌ ุ ูุฑูุฏ ุฅุนุงุฏุฉ ูุญุฏุฉ ุงูุชุญูู ุฅูู ุฅุนุฏุงุฏุงุชูุง ุงูุนุงุฏูุฉ. </font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handle_interrupt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> signal)</span></span></span><span class="hljs-function"> </span></span>{ restore_input_buffering(); <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">-2</span></span>); }</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">signal(SIGINT, handle_interrupt); disable_input_buffering();</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">restore_input_buffering();</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{Sign Extend, <span class="hljs-number"><span class="hljs-number">6</span></span>} {Swap, <span class="hljs-number"><span class="hljs-number">10</span></span>} {Update Flags, <span class="hljs-number"><span class="hljs-number">6</span></span>} {Read Image File, <span class="hljs-number"><span class="hljs-number">10</span></span>} {Read Image, <span class="hljs-number"><span class="hljs-number">10</span></span>} {Check Key, <span class="hljs-number"><span class="hljs-number">12</span></span>} {Memory Access, <span class="hljs-number"><span class="hljs-number">11</span></span>} {Input Buffering, <span class="hljs-number"><span class="hljs-number">12</span></span>} {Handle Interrupt, <span class="hljs-number"><span class="hljs-number">12</span></span>}</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;stdint.h&gt; #include &lt;string.h&gt; #include &lt;signal.h&gt; #include &lt;unistd.h&gt; #include &lt;fcntl.h&gt; #include &lt;sys/time.h&gt; #include &lt;sys/types.h&gt; #include &lt;sys/termios.h&gt; #include &lt;sys/mman.h&gt;</span></span></span></span></code> </pre> <br><a name="13"></a><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุฏุก ุชุดุบูู ุงูุฌูุงุฒ ุงูุธุงูุฑู </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุขู ููููู ุฅูุดุงุก ูุชุดุบูู ุงูุฌูุงุฒ ุงูุธุงูุฑู LC-3! </font></font><br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุฑุฌูุฉ </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุจุฑูุงูุฌ ูุน</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุชุฑุฌู ุงูููุถูุฉ ูุฏูู.</font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุจุชูุฒูู ุงููุณุฎุฉ ุงููุชุฑุฌูุฉ ูู </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2048</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃู </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rogue</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุจุชุดุบูู ุงูุจุฑูุงูุฌ ุจุงุณุชุฎุฏุงู ููู obj ููุณูุทุฉ: </font></font><br> <code>lc3-vm path/to/2048.obj</code> </li> <li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุนุจ ูู 2048! </font></font></li></ol><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">Control the game <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> WASD keys. <span class="hljs-function"><span class="hljs-function">Are you on an ANSI </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">terminal</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(y/n)</span></span></span><span class="hljs-function">? y +--------------------------+ | | | | | | | 2 | | | | 2 | | | | | | | +--------------------------+</span></span></code> </pre> <br><h3 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุชุตุญูุญ ุงูุฃุฎุทุงุก </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูู ูุนูู ุงูุจุฑูุงูุฌ ุจุดูู ุตุญูุญ ุ ููู ุงููุญุชูู ุฃูู ููุช ุจุชุฑููุฒ ููุน ูู ุงูุชุนูููุงุช ุจุดูู ุบูุฑ ุตุญูุญ. </font><font style="vertical-align: inherit;">ูููู ุฃู ูููู ูู ุงูุตุนุจ ุชุตุญูุญ. </font><font style="vertical-align: inherit;">ุฃูุตู ุจุฃู ุชูุฑุฃ ุฑูุฒ ุงูุชุฌููุน ููุจุฑูุงูุฌ ูู ููุณ ุงูููุช - ูุจูุณุงุนุฏุฉ ูุตุญุญ ุงูุฃุฎุทุงุก ุฎุทูุฉ ุจุฎุทูุฉ ุงุชุจุน ุฅุฑุดุงุฏุงุช ุงูุฌูุงุฒ ุงูุธุงูุฑู ูุงุญุฏุฉ ูู ูู ูุฑุฉ. </font><font style="vertical-align: inherit;">ุนูุฏ ูุฑุงุกุฉ ุงูููุฏ ุ ุชุฃูุฏ ูู ุฃู VM ูุฐูุจ ุฅูู ุงูุชุนูููุงุช ุงูููุตูุฏุฉ. </font><font style="vertical-align: inherit;">ูู ุญุงูุฉ ุญุฏูุซ ุนุฏู ุชุทุงุจู ุ ุณุชุนุฑู ุนูู ุงูุฅุฑุดุงุฏุงุช ุงูุชู ุชุณุจุจุช ูู ุงููุดููุฉ. </font><font style="vertical-align: inherit;">ุฃุนุฏ ูุฑุงุกุฉ ุงูููุงุตูุงุช ูุฃุนุฏ ุงูุชุญูู ูู ุงูููุฏ.</font></font><br><br><a name="14"></a><h1 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14. ุทุฑููุฉ ุจุฏููุฉ ูู C ++ </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅููู ุทุฑููุฉ ูุชูุฏูุฉ ูุชูููุฐ ุงูุฅุฑุดุงุฏุงุช ุงูุชู ุชููู ุจุดูู ูุจูุฑ ูู ุญุฌู ุงูุฑูุฒ. ูุฐุง ูู ูุณู ุงุฎุชูุงุฑู ุชูุงูุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุธุฑูุง ูุฃู C ++ ูุฏุนู ุงููุฑุงุซุฉ ุงููููุฉ ุฃุซูุงุก ุนูููุฉ ุงูุชุญููู ุงูุจุฑูุฌู ุ ูููููุง ุฅูุดุงุก ุฃุฌุฒุงุก ูู ุงูุชุนูููุงุช ุจุงุณุชุฎุฏุงู ุงููุชุฑุฌู. ุชุนูู ูุฐู ุงูุทุฑููุฉ ุนูู ุชูููู ุงูุงุฒุฏูุงุฌูุฉ ูู ุงูููุฏ ููู ูู ุงููุงูุน ุฃูุฑุจ ุฅูู ูุณุชูู ุฃุฌูุฒุฉ ุงูููุจููุชุฑ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฑุฉ ูู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงูุฎุทูุงุช ุงูุดุงุฆุนุฉ ููู ุชุนูููุงุช. ุนูู ุณุจูู ุงููุซุงู ุ ุชุณุชุฎุฏู ุจุนุถ ุงูุฅุฑุดุงุฏุงุช ุนูููุฉ ุฃู ุงูุชุฏุงุฏ ุบูุฑ ูุจุงุดุฑ ููููุฉ ูุง ูุฅุถุงูุชูุง ุฅูู ุงููููุฉ ุงูุญุงููุฉ </font></font><code>PC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุชูุงูู ุ ุณูููู ูู ุงูุฌููู ุฃู ุชูุชุจ ูุฐุง ุงูุฑูุฒ ูุฑุฉ ูุงุญุฏุฉ ูุฌููุน ุงูุชุนูููุงุชุ</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงููุธุฑ ุฅูู ุงูุชุนูููุงุช ูุณูุณูุฉ ูู ุงูุฎุทูุงุช ุ ูุฑู ุฃู ูู ุชุนูููุฉ ูู ูุฌุฑุฏ ุฅุนุงุฏุฉ ุชุฑุชูุจ ูุนุฏุฉ ุฎุทูุงุช ุฃุตุบุฑ. </font><font style="vertical-align: inherit;">ุณูุณุชุฎุฏู ุฅุดุงุฑุงุช ุงูุจุช ููุฅุดุงุฑุฉ ุฅูู ุงูุฎุทูุงุช ุงูุชู ูุฌุจ ุงุชุจุงุนูุง ููู ุชุนูููุงุช. </font><font style="vertical-align: inherit;">ุชุดูุฑ ุงููููุฉ </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูููุฌูุฏุฉ ูู ุฑูู ุชุนูููุฉ bit ุฅูู ุฃูู ูู ูุฐู ุงูุฅุฑุดุงุฏุงุช ุ ูุฌุจ ุฃู ูุชุถูู ุงููุญูู ุงูุจุฑูุฌู ูุฐุง ุงููุณู ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ.</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> op&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ins</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> instr)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> r0, r1, r2, imm5, imm_flag; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> pc_plus_off, base_plus_off; <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> opbit = (<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; op); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">0x4EEE</span></span> &amp; opbit) { r0 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">0x12E3</span></span> &amp; opbit) { r1 = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">0x0022</span></span> &amp; opbit) { r2 = instr &amp; <span class="hljs-number"><span class="hljs-number">0x7</span></span>; imm_flag = (instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1</span></span>; imm5 = sign_extend((instr) &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-number"><span class="hljs-number">0x00C0</span></span> &amp; opbit) { <span class="hljs-comment"><span class="hljs-comment">// Base + offset base_plus_off = reg[r1] + sign_extend(instr &amp; 0x3f, 6); } if (0x4C0D &amp; opbit) { // Indirect address pc_plus_off = reg[R_PC] + sign_extend(instr &amp; 0x1ff, 9); } if (0x0001 &amp; opbit) { // BR uint16_t cond = (instr &gt;&gt; 9) &amp; 0x7; if (cond &amp; reg[R_COND]) { reg[R_PC] = pc_plus_off; } } if (0x0002 &amp; opbit) // ADD { if (imm_flag) { reg[r0] = reg[r1] + imm5; } else { reg[r0] = reg[r1] + reg[r2]; } } if (0x0020 &amp; opbit) // AND { if (imm_flag) { reg[r0] = reg[r1] &amp; imm5; } else { reg[r0] = reg[r1] &amp; reg[r2]; } } if (0x0200 &amp; opbit) { reg[r0] = ~reg[r1]; } // NOT if (0x1000 &amp; opbit) { reg[R_PC] = reg[r1]; } // JMP if (0x0010 &amp; opbit) // JSR { uint16_t long_flag = (instr &gt;&gt; 11) &amp; 1; pc_plus_off = reg[R_PC] + sign_extend(instr &amp; 0x7ff, 11); reg[R_R7] = reg[R_PC]; if (long_flag) { reg[R_PC] = pc_plus_off; } else { reg[R_PC] = reg[r1]; } } if (0x0004 &amp; opbit) { reg[r0] = mem_read(pc_plus_off); } // LD if (0x0400 &amp; opbit) { reg[r0] = mem_read(mem_read(pc_plus_off)); } // LDI if (0x0040 &amp; opbit) { reg[r0] = mem_read(base_plus_off); } // LDR if (0x4000 &amp; opbit) { reg[r0] = pc_plus_off; } // LEA if (0x0008 &amp; opbit) { mem_write(pc_plus_off, reg[r0]); } // ST if (0x0800 &amp; opbit) { mem_write(mem_read(pc_plus_off), reg[r0]); } // STI if (0x0080 &amp; opbit) { mem_write(base_plus_off, reg[r0]); } // STR if (0x8000 &amp; opbit) // TRAP { {TRAP, 8} } //if (0x0100 &amp; opbit) { } // RTI if (0x4666 &amp; opbit) { update_flags(r0); } }</span></span></code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(*op_table[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">16</span></span></span></span><span class="hljs-function"><span class="hljs-params">])</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint16_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>= { ins&lt;<span class="hljs-number"><span class="hljs-number">0</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">1</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">3</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">4</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">5</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">6</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">7</span></span>&gt;, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ins&lt;<span class="hljs-number"><span class="hljs-number">9</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">11</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">12</span></span>&gt;, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ins&lt;<span class="hljs-number"><span class="hljs-number">14</span></span>&gt;, ins&lt;<span class="hljs-number"><span class="hljs-number">15</span></span>&gt; };</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุญุธุฉ:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุฏ ุชุนููุช ุนู ูุฐู ุงูุชูููุฉ ูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญุงูู NES ุงูุชู ุทูุฑุชูุง ุจูุณูููุช</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุฅุฐุง ููุช ููุชููุง ุจูุถุงูุงุฉ ุฃู NES ุ ูุฅููู ุฃูุตู ุจุดุฏุฉ ุจููุงุทุน ุงูููุฏูู ุงูุชุงุจุนุฉ ููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุณุชุฎุฏู ุฅุตุฏุงุฑุงุช ุฃุฎุฑู ูู C ++ ุงูุฑูุฒ ุงูููุชูุจ ุจุงููุนู. </font><font style="vertical-align: inherit;">ุงููุณุฎุฉ ุงููุงููุฉ </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">{Includes, <span class="hljs-number"><span class="hljs-number">12</span></span>} {Registers, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Condition Flags, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Opcodes, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Memory Mapped Registers, <span class="hljs-number"><span class="hljs-number">11</span></span>} {TRAP Codes, <span class="hljs-number"><span class="hljs-number">8</span></span>} {Memory Storage, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Register Storage, <span class="hljs-number"><span class="hljs-number">3</span></span>} {Functions, <span class="hljs-number"><span class="hljs-number">12</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> running = <span class="hljs-number"><span class="hljs-number">1</span></span>; {Instruction C++, <span class="hljs-number"><span class="hljs-number">14</span></span>} {Op Table, <span class="hljs-number"><span class="hljs-number">14</span></span>} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argc, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params">* argv[])</span></span></span><span class="hljs-function"> </span></span>{ {Load Arguments, <span class="hljs-number"><span class="hljs-number">12</span></span>} {Setup, <span class="hljs-number"><span class="hljs-number">12</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> { PC_START = <span class="hljs-number"><span class="hljs-number">0x3000</span></span> }; reg[R_PC] = PC_START; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (running) { <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> instr = mem_read(reg[R_PC]++); <span class="hljs-keyword"><span class="hljs-keyword">uint16_t</span></span> op = instr &gt;&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>; op_table[op](instr); } {Shutdown, <span class="hljs-number"><span class="hljs-number">12</span></span>} }</code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar434138/">https://habr.com/ru/post/ar434138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar434126/index.html">ูู ุจุชุดุบูู ุงููุณุงุฆุท ุจุงุณุชุฎุฏุงู ููุชุจุฉ VLCj</a></li>
<li><a href="../ar434128/index.html">PHP Digest No. 146 (ูู 10 ุฅูู 24 ุฏูุณูุจุฑ 2018) + 2018 ุงููุชุงุฆุฌ</a></li>
<li><a href="../ar434130/index.html">ูุงุฌูุฉ ุฑุฏ ุงููุนู. ูุญุงุถุฑุฉ ุฃุฑุชูู ุจูููู ูู FrontTalks 2018</a></li>
<li><a href="../ar434132/index.html">ุดุฑุงุก ุฌูุงุฒ ุชููุฒููู ูููู: ุชุฎุทุท LG ูุจุฏุก ุจูุน ุฃุฌูุฒุฉ ุชููุฒููู ูุฑูุฉ ูู ุงูุนุงู ุงูููุจู</a></li>
<li><a href="../ar434134/index.html">ุชุญููู ูุชุงุฆุฌ ูุณุญ 2018 Kaggle ML & DS</a></li>
<li><a href="../ar434140/index.html">ุชุงุฑูุฎ ููุฌุฒ ูููุฒุงุช Javascript ุบูุฑ ุงููุชุฒุงููุฉ</a></li>
<li><a href="../ar434142/index.html">ุญุฏุฏ ูุฑูู QRL ูููุฉ ุฒูููุฉ ุตุงุฑูุฉ ูููุฌุฑุฉ ุงูุฑูุฒูุฉ</a></li>
<li><a href="../ar434146/index.html">ุฃูุถู 10 ุฃููุงู ุชูููููุฌูุง ุงููุนูููุงุช</a></li>
<li><a href="../ar434150/index.html">ููุฒุงุช ุงูุจุญุซ ุนู ูุธููุฉ ูู ุฃูุฑูุจุง</a></li>
<li><a href="../ar434154/index.html">ูุฌููุนุฉ ุจูุงูุงุช ุงูุณูุฉ ุงูุฌุฏูุฏุฉ 2018: ุฏูุงูุงุช ููุชูุญุฉ ููุบุฉ ุงูุฑูุณูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>