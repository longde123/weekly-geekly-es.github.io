<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>тЬЛЁЯП╜ ЁЯСМЁЯП╛ ЁЯСитАНЁЯФм MicroPython v.1.12 рдкрд░ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрд╕рд┐рдВрдХреЛрдпреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ ЁЯРЬ ЁЯШо тЪФя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЕрдкрдиреЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдорд╛рдЗрдХреНрд░реЛрдкрд╛рдпрдереЙрди рдХреА рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рддреЗ рд╣реБрдП, рдореИрдВ рдПрд╕рд┐рдВрдХреЛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рд╕реЗ рдПрдХ рдЖрдпрд╛ рдФрд░, рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд▓реЗрдЦрдХ, рдкрд┐рдЯрд░ рд╣рд┐...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MicroPython v.1.12 рдкрд░ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдПрд╕рд┐рдВрдХреЛрдпреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484472/"> <i>рдЕрдкрдиреЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП <b>рдорд╛рдЗрдХреНрд░реЛрдкрд╛рдпрдереЙрди</b> рдХреА рд╕рдВрднрд╛рд╡рдирд╛рдУрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░рддреЗ рд╣реБрдП, рдореИрдВ <b>рдПрд╕рд┐рдВрдХреЛ</b> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рд╕реЗ рдПрдХ рдЖрдпрд╛ рдФрд░, рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ рд▓реЗрдЦрдХ, <b>рдкрд┐рдЯрд░ рд╣рд┐рдВрдЪ рдХреЗ</b> рд╕рд╛рде рдПрдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдкрддреНрд░рд╛рдЪрд╛рд░ рдХреЗ рдмрд╛рдж, рдореБрдЭреЗ рдПрд╣рд╕рд╛рд╕ рд╣реБрдЖ рдХрд┐ рдореБрдЭреЗ рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ, рдмреБрдирд┐рдпрд╛рджреА рдЕрд╡рдзрд╛рд░рдгрд╛рдУрдВ рдФрд░ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЛ рд╕рдордЭрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред</i>  <i>рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╢реБрд░реБрдЖрддреА рдХреЗ рд▓рд┐рдП рдЕрдиреБрднрд╛рдЧ рд╕рд┐рд░реНрдл рдореЗрд░реЗ рд▓рд┐рдП рд╣реИред</i> <br><br>  рдпрд╣ рдЧрд╛рдЗрдб <i><b>asyncio рдХреЗ</b></i> рд╕рд╛рде рдЕрдиреБрднрд╡ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╕реНрддрд░реЛрдВ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЦрдВрдб рднреА рд╢рд╛рдорд┐рд▓ рд╣реИред <br><a name="habracut"></a><br>  <b>рд╕рд╛рдордЧреНрд░реА</b> <br>  <b>0. рдкрд░рд┐рдЪрдп</b> <br>  0.1 .___ рдЦрд╛рд▓реА рдбрд┐рд╡рд╛рдЗрд╕ (рд╣рд╛рд░реНрдбрд╡реЗрдпрд░) рдкрд░ <i><b>uasyncio</b></i> рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░рдирд╛ <br>  <b>1. рд╕рдВрдпреБрдХреНрдд рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдпреЛрдЬрдирд╛</b> <br>  1.1 .___ рдореЙрдбреНрдпреВрд▓ <br>  <b>2. <i>uasyncio</i> рдкреБрд╕реНрддрдХрд╛рд▓рдп</b> <br>  2.1 .___ рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рдВрд░рдЪрдирд╛: рдШрдЯрдирд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдЪрдХреНрд░ <br>  реи.реи <br>  <i>рдпреЛрдЬрдирд╛ рдореЗрдВ рднрд╛рдЧ рд▓реЗрдиреЗ рдХреЗ рд▓рд┐рдП</i> 2.2.1 <br>  2.2.2 .______ <i>рдлрд╝рдВрдХреНрд╢рди <i>рдХреЙрд▓рдмреИрдХ</i> ( <i>рдХреЙрд▓рдмреИрдХ</i> ) рд╢реБрд░реВ рдХрд░рдирд╛</i> <br>  2.2.3 .______ <i>рдиреЛрдЯ: рд╕рдВрдмрдВрдзрд┐рдд рддрд░реАрдХреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдХреЛрд░рдЯрд╛рдЗрдиред</i>  <i>рд╡рд╛рдкрд╕реА рдХрд╛ рдорд╛рдиред</i> <br>  2.3 .___ рд╡рд┐рд▓рдВрдм <br>  <b>3. рддреБрд▓реНрдпрдХрд╛рд▓рди рдФрд░ рдЗрд╕рдХреА рдХрдХреНрд╖рд╛рдПрдВ</b> <br>  3.1 .___ рд▓реЙрдХ <i><b>рд▓реЙрдХ</b></i> <br>  3.1.1 .______ <i>рд▓реЙрдХ рдФрд░ рдЯрд╛рдЗрдордЖрдЙрдЯ</i> <br>  3.2 .___ <i><b>рдШрдЯрдирд╛</b></i> <br>  3.2.1 .______ рдШрдЯрдирд╛ <i>рдореВрд▓реНрдп</i> <br>  рей.рей .___ рдмреИрд░рд┐рдпрд░ <i><b>рдмреИрд░рд┐рдпрд░</b></i> <br>  рей.рек .___ <i><b>рд╕реЗрдордлреЛрд░</b></i> <br>  рей.рек.рез.______ <i>рд▓рд┐рдорд┐рдЯреЗрдб рд╕реЗрдорд╛рдлреЛрд░</i> <br>  3.5 .___ рдХрддрд╛рд░ рд╕реЗ <i><b>рдХрддрд╛рд░</b></i> <br>  3.6 .___ рдЕрдиреНрдп рд╕рд┐рдВрдХ рдХреНрд▓рд╛рд╕реЗрд╕ <br>  <b>4. рд╡рд░реНрдЧ рд╡рд┐рдХрд╛рд╕ <i>asyncio рдХреЗ рд▓рд┐рдП</i></b> <br>  4.1 .___ рд╡реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реА рдХрдХреНрд╖рд╛рдПрдВ <br>  4.1.1 .______ <i>рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ</i> <br>  4.1.2 .______ <i>рдХреЛрд░рдЯрд╛рдЗрди рдореЗрдВ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░реЗрдВ</i> <br>  4.2 .___ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ Iterators <br>  4.3 .___ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдкреНрд░рд╕рдВрдЧ рдкреНрд░рдмрдВрдзрдХ <br>  <b>5. рдЯрд╛рдЗрдордЖрдЙрдЯ рдФрд░ рдХрд╛рд░реНрдп рд░рджреНрдж рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг рдЕрдкрд╡рд╛рдж</b> <br>  5.1 .___ рдЕрдкрд╡рд╛рдж <br>  5.2 .___ рд╕рдордп рд╕рдорд╛рдкреНрддрд┐ рдХреЗ рдХрд╛рд░рдг рдЕрдкрд╡рд╛рдж рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд░рджреНрдж рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг <br>  5.2.1 .______ <i>рдХрд╛рд░реНрдп рд░рджреНрдж рдХрд░реЗрдВ</i> <br>  5.2.2 .______ <i>рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЗ рд╕рд╛рде рдХреЛрд░рд╛рдЯрд╛рдЗрди</i> <br>  <b>6. рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде рд╕рд╣рднрд╛рдЧрд┐рддрд╛</b> <br>  6.1 .___ рд╕рд┐рдВрдХ рд╕рдорд╕реНрдпрд╛рдПрдВ <br>  6.2 .___ рдорддрджрд╛рди рдЙрдкрдХрд░рдг рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рд╕рд╛рде <br>  6.3 .___ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдЗрдВрдЬрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ <br>  6.3.1 .______ <i>UART рдбреНрд░рд╛рдЗрд╡рд░ рдЙрджрд╛рд╣рд░рдг</i> <br>  6.4 .___ рдбреНрд░рд╛рдЗрд╡рд░ рд╡рд┐рдХрд╛рд╕ рдПрдХ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд▓рд┐рдП <br>  6.5 .___ рдкреВрд░реНрдг рдЙрджрд╛рд╣рд░рдг: IR рд░рд┐рдореЛрдЯ рдХрдВрдЯреНрд░реЛрд▓ рд░рд┐рд╕реАрд╡рд░ рдХреЗ рд▓рд┐рдП <i>aremote.py</i> рдбреНрд░рд╛рдЗрд╡рд░ред <br>  6.6 .___ рддрд╛рдкрдорд╛рди рдФрд░ рдЖрд░реНрджреНрд░рддрд╛ рд╕реЗрдВрд╕рд░ HTU21D рдХреЗ рд▓рд┐рдП рдбреНрд░рд╛рдЗрд╡рд░ред <br>  <b>7. рдЯрд┐рдкреНрд╕ рдФрд░ рдЯреНрд░рд┐рдХреНрд╕</b> <br>  7.1 .___ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдлреНрд░реАрдЬ <br>  7.2 .___ <b><i>uasyncio</i></b> рд░рд╛рдЬреНрдп рдмрдЪрд╛рддрд╛ рд╣реИ <br>  7.3 .___ рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣ <br>  7.4 .___ рдкрд░реАрдХреНрд╖рдг <br>  7.5 .___ рд╕рд╛рдорд╛рдиреНрдп рддреНрд░реБрдЯрд┐ред  рдЗрд╕реЗ рдЦреЛрдЬрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред <br>  7.6 .___ рд╕реЙрдХреЗрдЯ ( <i>рд╕реЙрдХреЗрдЯ</i> ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХрд░рдирд╛ <br>  7.6.1 .______ <i>WiFi рд╕рдорд╕реНрдпрд╛рдПрдБ</i> <br>  7.7 .___ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЗ рддрд░реНрдХ <br>  <b>8. рд╢реБрд░реБрдЖрддреА рдХреЗ рд▓рд┐рдП рдиреЛрдЯреНрд╕</b> <br>  8.1 .___ рд╕рдорд╕реНрдпрд╛ 1: рдЗрд╡реЗрдВрдЯ рд▓реВрдкреНрд╕ <br>  8.2 .___ рд╕рдорд╕реНрдпрд╛ 2: рд▓реЙрдХрд┐рдВрдЧ рд╡рд┐рдзрд┐рдпрд╛рдБ <br>  8.3 .___ <b><i>uasyncio</i></b> рджреГрд╖реНрдЯрд┐рдХреЛрдг <br>  8.4 .___ <b><i>uasyncio</i></b> рдореЗрдВ рдпреЛрдЬрдирд╛ <br>  8.5 .___ рд╕рд╣рдпреЛрдЧреА, рдереНрд░реЗрдб-рдЖрдзрд╛рд░рд┐рдд рд╢реЗрдбреНрдпреВрд▓рд┐рдВрдЧ ( <i>_рдереНрд░реЗрдб</i> ) рдХреНрдпреЛрдВ рдирд╣реАрдВ? <br>  8.6 .___ рд╕рд╣рднрд╛рдЧрд┐рддрд╛ <br>  8.7 .___ <i>рдорддрджрд╛рди</i> <br><br>  <b>0. рдкрд░рд┐рдЪрдп</b> <br><br>  рдЗрд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдХреБрдЫ рдкрд░рд┐рдЪрд┐рдд рд╣реИрдВред  рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП, рдПрдХ рдкрд░рд┐рдЪрдп рдзрд╛рд░рд╛ 7 рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  <i><b>MicroPython рдХреЗ</b></i> рд▓рд┐рдП <i><b>uasyncio</b></i> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ <b><i>asyncio</i></b> <b>Python</b> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рд╕рдмрд╕реЗрдЯ рд╢рд╛рдорд┐рд▓ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдорд╛рдЗрдХреНрд░реЛрдХрдВрдЯреНрд░реЛрд▓рд░реНрд╕ рдкрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЬреИрд╕реЗ, рдпрд╣ рд░реИрдо рдХреА рдПрдХ рдЫреЛрдЯреА рд░рд╛рд╢рд┐ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рд╢реВрдиреНрдп рд░реИрдо рдЖрд╡рдВрдЯрди рдХреЗ рд╕рд╛рде рд╕рдВрджрд░реНрднреЛрдВ рдХреЛ рдЬрд▓реНрджреА рд╕реЗ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br>  рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдбреНрд░рд╛рдЗрд╡рд░ рдмрдирд╛рдиреЗ рдкрд░ рдЬреЛрд░ рджреЗрдиреЗ рдХреЗ рд╕рд╛рде <i><b>рдЙрд╕реНрд╕рд┐рдирд╕рд┐рдпреЛ</b></i> рдХреЗ рдЙрдкрдпреЛрдЧ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИред <br><br>  рд▓рдХреНрд╖реНрдп рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рдбрд┐рдЬрд╛рдЗрди рдХрд░рдирд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛рдо рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦреЗ, рдЬрдмрдХрд┐ рдбреНрд░рд╛рдЗрд╡рд░ рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИред  рдЗрд╕реА рд╕рдордп, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдиреНрдп рдШрдЯрдирд╛рдУрдВ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд░рд╣рддрд╛ рд╣реИред <br><br>  <b><i>Asyncio</i></b> рдХреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХрд╛ рдПрдХ рдЕрдиреНрдп рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХреНрд╖реЗрддреНрд░ рдиреЗрдЯрд╡рд░реНрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рд╣реИ: рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЖрдк рдЗрд╕ рд╡рд┐рд╖рдп рдкрд░ рдкрд░реНрдпрд╛рдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ <b>MicroPython</b> рдиреНрдпреВрдирддрдо <b>рдкрд╛рдпрдерди 3.5</b> рдРрдб-рдСрди рдХреЗ рд╕рд╛рде <b>рдкрд╛рдпрдерди 3.4</b> рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред  рдиреАрдЪреЗ рдХреЗ рд░реВрдк рдореЗрдВ рдЫреЛрдбрд╝рдХрд░, 3.4 рд╕реЗ рдЕрдзрд┐рдХ рдкреБрд░рд╛рдиреЗ <b><i>asyncio</i></b> рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдЗрд╕ рд╕рдмрд╕реЗрдЯ рдореЗрдВ рд╕рдорд░реНрдерд┐рдд рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред <br><br>  рдЗрд╕ рдЧрд╛рдЗрдб рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп <b>CPython V3.5</b> рдФрд░ рдЙрдЪреНрдЪрддрд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рд╢реИрд▓реА рдкреЗрд╢ рдХрд░рдирд╛ рд╣реИред <br><br>  <b>0.1 рдПрдХ рдЦрд╛рд▓реА рдбрд┐рд╡рд╛рдЗрд╕ (рд╣рд╛рд░реНрдбрд╡реЗрдпрд░) рдкрд░ <b><i>uasyncio</i></b> рд╕реНрдерд╛рдкрд┐рдд рдХрд░реЗрдВ</b> <br><br>  рдпрд╣ рдлрд░реНрдорд╡реЗрдпрд░ <b>MicroPython V1.11</b> рдпрд╛ рдмрд╛рдж рдХреЗ <b>рд╕рдВрд╕реНрдХрд░рдг</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╢рдВрд╕рд┐рдд рд╣реИред  рдХрдИ рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдкрд░, рд╕реНрдерд╛рдкрдирд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдореЗрдВ <b><i>uasyncio</i></b> рдкрд╣рд▓реЗ <b><i>рд╕реЗ</i></b> рд╣реА рд╕рдВрдХрд▓рд┐рдд рд╣реИред  рдЬрд╛рдБрдЪ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЗрд╡рд▓ REPL рдореЗрдВ рдЯрд╛рдЗрдк рдХрд░реЗрдВ <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio</code> </pre> <br>  рдирд┐рдореНрди рдирд┐рд░реНрджреЗрд╢ рдорд╛рдорд▓реЛрдВ рдХреЛ рдХрд╡рд░ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рдореЙрдбреНрдпреВрд▓ рдкреВрд░реНрд╡-рд╕реНрдерд╛рдкрд┐рдд рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред  <b><i>рдХрддрд╛рд░реЛрдВ</i></b> рдФрд░ <b><i>рд╕рд┐рдВрдХреНрд░реЛ</i></b> рдореЙрдбреНрдпреВрд▓ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдВ рджрд┐рдП рдЧрдП рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред <br><br>  <b>рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдЬреБрдбрд╝реА рдбрд┐рд╡рд╛рдЗрд╕</b> <br><br>  рдЗрдВрдЯрд░рдиреЗрдЯ рд╕реЗ рдЬреБрдбрд╝реЗ рдЙрдкрдХрд░рдг рдФрд░ рдлрд░реНрдорд╡реЗрдпрд░ V1.11 рдпрд╛ рдмрд╛рдж рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░, рдЖрдк рдмрд┐рд▓реНрдЯ- <i>рдЕрдк рдЕрдк</i> рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдХрд┐ рдбрд┐рд╡рд╛рдЗрд╕ рдЖрдкрдХреЗ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рдЬреБрдбрд╝рд╛ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> upip upip.install ( <span class="hljs-string"><span class="hljs-string">'micropython-uasyncio'</span></span> ) upip.install ( <span class="hljs-string"><span class="hljs-string">'micropython-uasyncio.synchro'</span></span> ) upip.install ( <span class="hljs-string"><span class="hljs-string">'micropython-uasyncio.queues'</span></span> )</code> </pre><br>  <i>Upip</i> рд╕реЗ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ рдмрд╣реБрдд рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ <i>рд╣реИрдВ</i> ред  рдпрджрд┐ рдЖрдкрдХреЛ рдХреЛрдИ рдЕрдпреЛрдЧреНрдп рддреНрд░реБрдЯрд┐ рдорд┐рд▓рддреА рд╣реИ, рддреЛ рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдлрд┐рд░ рд╕реЗ рдЬрд╛рдВрдЪреЗрдВред <br><br>  <b>рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдХреЗ рдмрд┐рдирд╛ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ ( <i>micropip</i> )</b> <br><br>  рдпрджрд┐ рдЖрдкрдХреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдирд╣реАрдВ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <b>Pyboard V1.x</b> ), рддреЛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк рдЕрдкрдиреА рдкрд╕рдВрдж рдХреА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рд▓рд┐рдП рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ <i>micropip.py</i> рдХреА рд╕реНрдерд╛рдкрдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдореА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рд▓рдХреНрд╖реНрдп рдбрд┐рд╡рд╛рдЗрд╕ рдореЗрдВ рдХреЙрдкреА рдХрд░реЗрдВред  <i>Micropip.py</i> рдЙрдкрдпреЛрдЧрд┐рддрд╛ <b>рдкрд╛рдпрдерди 3.2</b> рдпрд╛ рдмрд╛рдж рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдФрд░ рд▓рд┐рдирдХреНрд╕, рд╡рд┐рдВрдбреЛрдЬ, рдФрд░ OSX рдкрд░ рдЪрд▓рддреА рд╣реИред  рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА <a href="https://github.com/peterhinch/micropython-samples/tree/master/micropip" rel="nofollow">рдпрд╣рд╛рдВ</a> рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА <a href="https://github.com/peterhinch/micropython-samples/tree/master/micropip" rel="nofollow">рд╣реИ</a> ред <br><br>  рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЙрд▓: <br><br><pre> <code class="python hljs">$ micropip.py install -p ~/rats micropython-uasyncio $ micropip.py install -p ~/rats micropython-uasyncio.synchro $ micropip.py install -p ~/rats micropython-uasyncio.queues</code> </pre><br>  <b>рдЗрдВрдЯрд░рдиреЗрдЯ рдХрдиреЗрдХреНрд╢рди рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдЙрдкрдХрд░рдг (рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рд╕реНрд░реЛрдд)</b> <br><br>  рдпрджрд┐ рдЖрдк <i>micropip.py рдХрд╛</i> рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рд╕реНрд░реЛрдд рд╕реЗ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдирд┐рдореНрди рдирд┐рд░реНрджреЗрд╢ рд╡рд░реНрдгрди рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рд▓рдХреНрд╖реНрдп рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдиреНрдпреВрдирддрдо рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдХреИрд╕реЗ <b><i>рдмрдирд╛рдИ</i></b> рдЬрд╛рдП, рд╕рд╛рде рд╣реА рдорд╛рдорд▓рд╛ рдЬрдм <b><i>uasyncio</i></b> рдХреЛ рдХрдмреНрдЬреЗ рд╡рд╛рд▓реА рдЬрдЧрд╣ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рдЗрдЯ рдХреЛрдб рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдВрдХрд▓рд┐рдд рд╡рд┐рдзрд╛рдирд╕рднрд╛ рдореЗрдВ рд╕рдВрдХреБрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдлрд░реНрдорд╡реЗрдпрд░ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рдирд╡реАрдирддрдо рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП, рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ <a href="http://github.com/micropython/micropython-lib" rel="nofollow">рдорд╛рдЗрдХреНрд░реЛрдкреНрд░реЛрдереЗрди-рд▓рд┐рдмрд╕рд╛рдЗрдЯ</a> рд╕реЗ рдХреЙрдкреА рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдХрдВрдкреНрдпреВрдЯрд░ рдкрд░ рдХреНрд▓реЛрди рдХрд░реЗрдВ <br><br><pre> <code class="python hljs">$ git clone https://github.com/micropython/micropython-lib.git</code> </pre><br>  рдЯрд╛рд░рдЧреЗрдЯ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░, <b><i>uasyncio</i></b> рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА ( <b><i>рд▓рд┐рдмрд╛рд╕</i></b> рдбрд╛рдпрд░реЗрдХреНрдЯрд░реА рдореЗрдВ рд╡реИрдХрд▓реНрдкрд┐рдХ) рдмрдирд╛рдПрдВ рдФрд░ рдЙрд╕рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдХреЙрдкреА рдХрд░реЗрдВ: <br><br>  <b>тАв uasyncio / uasyncio / __ init__.py</b> <b><br></b>  <b>тАв uasyncio.core / uasyncio / core.py</b> <b><br></b>  <b>тАв uasyncio.synchro / uasyncio / synchro.py</b> <b><br></b>  <b>тАв uasyncio.queues / uasyncio / queues.py</b> <b><br></b> <br><br>  рдЗрди <b><i>uasyncio</i></b> рдореЙрдбреНрдпреВрд▓ рдХреЛ <b><i>utecyncio</i></b> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдФрд░ рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ <i>рдореЙрдбреНрдпреВрд▓</i> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЗ рдмрдВрджрд░рдЧрд╛рд╣ рдореЗрдВ рд░рдЦрдХрд░ рдФрд░ рд╕рд╛рдордЧреНрд░реА рдХреЛ <b><i>рдлрд┐рд░</i></b> рд╕реЗ <b><i>рдЬрдорд╛</i></b> рдХрд░рдХреЗ <b><i>рдмрд╛рдЗрдЯреЗрдХреЛрдб</i></b> рдореЗрдВ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  <b>1. рд╕рдВрдпреБрдХреНрдд рдпреЛрдЬрдирд╛</b> <br><br>  рдХрдИ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╕рдВрдпреБрдХреНрдд рдирд┐рд╖реНрдкрд╛рджрди рдХреА рддрдХрдиреАрдХ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдПрдореНрдмреЗрдбреЗрдб рд╕рд┐рд╕реНрдЯрдо рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ, рдЬреЛ рдереНрд░реЗрдбрд┐рдВрдЧ ( <b>_рдереНрд░реЗрдб</b> ) рд╢реЗрдбреНрдпреВрд▓рд┐рдВрдЧ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрдо рдУрд╡рд░рд╣реЗрдб рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдзрд╛рдЧреЗ рд╕реЗ рдЬреБрдбрд╝реЗ рдХрдИ рдиреБрдХрд╕рд╛рдиреЛрдВ рд╕реЗ <b>рдмрдЪрддреА рд╣реИ</b> ред <br><br>  <b>1.1 рдореЙрдбреНрдпреВрд▓</b> <br><br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдореЙрдбреНрдпреВрд▓ рдХреА рдПрдХ рд╕реВрдЪреА рд╣реИ рдЬреЛ рд▓рдХреНрд╖реНрдп рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдЪрд▓ рд╕рдХрддреА рд╣реИред <br><br>  <b><u>рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ</u></b> <br><br>  1. <b><i>asyn.py</i></b> <i><b>рд▓реЙрдХ, рдИрд╡реЗрдВрдЯ, рдмреИрд░рд┐рдпрд░, рд╕реЗрдорд╛рдлреЛрд░, рдмрд╛рдЙрдВрдбреЗрдбрд╕реЗрдорд╛рдлреЛрд░, рдХрдВрдбреАрд╢рди</b></i> рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ <i><b>,</b></i> рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рдкреНрд░рд╛рдЗрдореЗрдЯрд┐рд╡ <i><b>рдЗрдХрдЯреНрдард╛ рдХрд░рддрд╛ рд╣реИ</b></i> ред  <i><b>NamedTask</b></i> рдФрд░ <i><b>рд░рджреНрдж рдХрд░рдиреЗ рдпреЛрдЧреНрдп</b></i> рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд░рджреНрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред <br><br>  2. <b><i>aswitch.py</i></b> рд╕реНрд╡рд┐рдЪ рдФрд░ рдмрдЯрди <b><i>рдмрд╛рдБрдзрдиреЗ рдХреЗ</i></b> рд▓рд┐рдП рдХрдХреНрд╖рд╛рдУрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдмрд╛рд░-рдмрд╛рд░ рджреЗрд░реА рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдСрдмреНрдЬреЗрдХреНрдЯред  рдмрдЯрди рд╕реНрд╡рд┐рдЪ рдХрд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдпреАрдХрд░рдг рд╣реИ рдЬреЛ рднреМрддрд┐рдХ рд╕реНрдерд┐рддрд┐ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рддрд╛рд░реНрдХрд┐рдХ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдШрдЯрдирд╛рдУрдВ рдХреЛ рдПрдХ рдбрдмрд▓ рдФрд░ рд▓рдВрдмреЗ рдкреНрд░реЗрд╕ рджреНрд╡рд╛рд░рд╛ рдЯреНрд░рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  <b>рдбреЗрдореЛ рдХрд╛рд░реНрдпрдХреНрд░рдо</b> <br><br>  рдкрд╣рд▓реЗ рджреЛ рд╕рдмрд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реЛрддреЗ рд╣реИрдВ рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ <b>Pyboard рд╣рд╛рд░реНрдбрд╡реЗрдпрд░</b> рддрдХ рдкрд╣реБрдБрдЪрддреЗ рд╕рдордп рджреГрд╢реНрдпрдорд╛рди рдкрд░рд┐рдгрд╛рдо рджреЗрддреЗ рд╣реИрдВред <br><br><ol><li>  <b><i>aledflash.py</i></b> рдЪрд╛рд░ <b>рдкрд╛рдпрдмреЛрд░реНрдб</b> рд╕рдВрдХреЗрддрдХ 10 рд╕реЗрдХрдВрдб рдХреЗ рд▓рд┐рдП рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд░реВрдк рд╕реЗ <b>рдЪрдордХрддрд╛ рд╣реИ</b> ред  <b>Uasyncio</b> рдХрд╛ рд╕рдмрд╕реЗ рд╕рд░рд▓ рдкреНрд░рджрд░реНрд╢рдиред  рдЗрд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдпрд╛рдд рдХрд░реЗрдВред </li><li>  <b><i>apoll.py рдбрд┐рд╡рд╛рдЗрд╕</i></b> рдбреНрд░рд╛рдЗрд╡рд░ <b>Pyboard</b> рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ рдХреЗ рд▓рд┐рдПред  рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред  20 рдПрд╕ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рдЗрд╕реЗ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдпрд╛рдд рдХрд░реЗрдВред  <b>Pyboard V1.x рдХреА</b> рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </li><li>  <b><i>рдПрд╕реНрдЯреНрд░рд┐рдЪ</i></b> рдореЙрдбреНрдпреВрд▓ рдХреЗ рд▓рд┐рдП <b><i>astests.py</i></b> рдЯреЗрд╕реНрдЯ / рдбреЗрдореЛ рдкреНрд░реЛрдЧреНрд░рд╛рдоред </li><li>  <b><i>asyn_demos.py</i></b> рдХрд╛рд░реНрдп рдХреЛ рд░рджреНрдж рдХрд░рдиреЗ рдХрд╛ рд╕рд░рд▓ рдбреЗрдореЛред </li><li>  <b><i>roundrobin.py</i></b> рдкрд░рд┐рдкрддреНрд░ рдпреЛрдЬрдирд╛ рдХрд╛ рдкреНрд░рджрд░реНрд╢рдиред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдкреНрд░рджрд░реНрд╢рди рдХреА рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдмреЗрдВрдЪрдорд╛рд░реНрдХред </li><li>  рдкреНрд░рддреАрдХреНрд╖рд╛ рдХреЗ рд╕рд╛рде рд╡рд░реНрдЧ рдХрд╛ рдкреНрд░рджрд░реНрд╢рдиред  рдПрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИ рдЬреЛ рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рдкреЛрд▓ рдХрд░рддрд╛ рд╣реИред </li><li>  <b><i>рдЪреЗрдирд╣реЛрдо</i></b> <b>рдкрд╛рдЗрдерди</b> рдкреНрд░рд▓реЗрдЦрди рд╕реЗ рдирдХрд▓ рдХреА рдЧрдИред  Coroutine рд╢реНрд░реГрдВрдЦрд▓рд╛ рдкреНрд░рджрд░реНрд╢рдиред </li><li>  <b><i>aqtest.py</i></b> <i><b>uasyncio</b></i> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА <b><i>рдХрддрд╛рд░</i></b> рд╡рд░реНрдЧ рдХрд╛ рдкреНрд░рджрд░реНрд╢рдиред </li><li>  NEC IR рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд▓рд┐рдП <b><i>aremote.py</i></b> рдЙрджрд╛рд╣рд░рдг рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ред </li><li>  <b><i>auart.py,</i></b> <b>Pyboard UART рдХреЗ</b> рдорд╛рдзреНрдпрдо рд╕реЗ рдЗрдирдкреБрдЯ-рдЖрдЙрдЯрдкреБрдЯ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдХрд╛ рдкреНрд░рджрд░реНрд╢рдиред </li><li>  <b><i>auart_hd.py</i></b> рдЖрдзреЗ-рджреНрд╡реИрдз рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрд╡рд╛рдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <b>Pyboard UART</b> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред  рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдЯреА рдореЙрдбреЗрдо рдХрдорд╛рдВрдб рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред </li><li>  I / O рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд░реАрдбрд░ / рд▓реЗрдЦрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ <b><i>iorw.py</i></b> рдкреНрд░рджрд░реНрд╢рдиред </li></ol><br>  <b>рдкрд░реАрдХреНрд╖рдг рдХрд╛рд░реНрдпрдХреНрд░рдо</b> <br><br><ol><li>  <b><i>asyntest.py</i></b> рдЯреЗрд╕реНрдЯ рдХреЗ рд▓рд┐рдП рд╕рд┐рдВрдХреНрд░реЛрдирд╛рдЗрдЬрд╝реЗрд╢рди рдХреНрд▓рд╛рд╕реЗрд╕ <b><i>asyn.py.</i></b> </li><li>  <b><i>cantest.py</i></b> рдиреМрдХрд░реА рд░рджреНрдж рдХрд░рдиреЗ рдХрд╛ рдкрд░реАрдХреНрд╖рдгред </li></ol><br>  <b>рдЙрдкрдпреЛрдЧрд┐рддрд╛</b> <br><br>  1. <b><i>check_async_code.py</i></b> рдЙрдкрдпреЛрдЧрд┐рддрд╛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЛрдбрд┐рдВрдЧ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП <b>Python3</b> рдореЗрдВ рд▓рд┐рдЦреА рдЧрдИ рд╣реИ рдЬрд┐рд╕реЗ рдЦреЛрдЬрдирд╛ рдореБрд╢реНрдХрд┐рд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдЦрдВрдб 7.5 рджреЗрдЦреЗрдВред <br><br>  <b>рдирд┐рдпрдВрддреНрд░рдг</b> <br><br>  <a href="" rel="nofollow"><i>рдмреЗрдВрдЪрдорд╛рд░реНрдХ</i></a> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ <i><b>uasyncio рдЕрдиреБрд╕реВрдЪрдХ рдХреА</b></i> рдЬрд╛рдБрдЪ рдФрд░ рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд▓рд┐рдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред <br><br><cut></cut><br>  <b>2. <i>uasyncio</i> рдкреБрд╕реНрддрдХрд╛рд▓рдп</b> <br><br>  <i>Asyncio</i> рдЕрд╡рдзрд╛рд░рдгрд╛ рдХрдИ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╕рдВрдпреБрдХреНрдд рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдирд┐рдпреЛрдЬрди рдХреЗ рд╕рдВрдЧрдарди рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ, рдЬрд┐рд╕реЗ рдЗрд╕ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдореЗрдВ <b>рдХреЙрд░рдЖрдЙрдЯ</b> рдХрд╣рд╛ рдЬрд╛рддрд╛ <b>рд╣реИ</b> ред <br><br>  <b>2.1 рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рдВрд░рдЪрдирд╛: рдИрд╡реЗрдВрдЯ рд▓реВрдк</b> <br><br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bar</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> : count + = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> ( count ) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep ( <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-comment"><span class="hljs-comment">#  1 loop = asyncio.get_event_loop () loop.create_task ( bar ()) #     loop.run_forever ()</span></span></code> </pre><br>  рдХрд╛рд░реНрдпрдХреНрд░рдо рдирд┐рд╖реНрдкрд╛рджрди рддрдм рддрдХ рдЬрд╛рд░реА рд░рд╣рддрд╛ рд╣реИ, рдЬрдм рддрдХ <i>рд▓реВрдк .run_forever рдирд╣реАрдВ рдХрд╣рд▓рд╛рддрд╛</i> ред  рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдЕрдиреБрд╕реВрдЪрдХ рджреНрд╡рд╛рд░рд╛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  <i>Loop.run_forever рдХреЗ</i> рдмрд╛рдж рдХреА рд▓рд╛рдЗрди рдХрднреА рднреА рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧреАред  рд╢реЗрдбреНрдпреВрд▓рд░ <i>рдмрд╛рд░</i> рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕реЗ <i>рд▓реВрдк</i> рдореЗрдВ рдкрдВрдХреНрддрд┐рдмрджреНрдз рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЗрд╕ рддреБрдЪреНрдЫ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рдХреЗрд╡рд▓ рдПрдХ coroutine <i>рдмрд╛рд░ рд╣реИ</i> ред  рдпрджрд┐ рдХреЛрдИ рдЕрдиреНрдп рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рд╢реЗрдбреНрдпреВрд▓рд░ рдЙрдиреНрд╣реЗрдВ рдЙрд╕ рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛ рдЬрдм <i>рдмрд╛рд░</i> рдХреЛ рд░реЛрдХ рджрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br>  рдЕрдзрд┐рдХрд╛рдВрд╢ рдПрдореНрдмреЗрдбреЗрдб рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдПрдХ рдирд┐рд░рдВрддрд░ рдИрд╡реЗрдВрдЯ рд▓реВрдк рд╣реЛрддрд╛ рд╣реИред  рдПрдХ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рднреА рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ <i>run_until_complete</i> рдЗрд╡реЗрдВрдЯ рд▓реВрдк рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ;  рдпрд╣ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдкрд░реАрдХреНрд╖рдг рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг <a href="https://github.com/peterhinch/micropython-async/blob/master/astests.py" rel="nofollow"><b><i>astests.py</i></b></a> рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдкрд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдЖрд╡реГрддреНрддрд┐ рдПрдХ рдПрдХрд▓ рдСрдмреНрдЬреЗрдХреНрдЯ рд╣реИ рдЬрд┐рд╕реЗ рдкрд╣рд▓реА рдХреЙрд▓ <i>asyncio.get_event_loop ()</i> рджреНрд╡рд╛рд░рд╛ рджреЛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдкреВрд░реНрдгрд╛рдВрдХ рддрд░реНрдХреЛрдВ рдХреЗ рд╕рд╛рде рджреЛ <i>рдХрддрд╛рд░реЛрдВ рдореЗрдВ рдХреЛрд░рдЖрдЙрдЯ</i> рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ - рдкреНрд░рд╛рд░рдВрдн рдФрд░ рдкреНрд░рддреАрдХреНрд╖рд╛ред  рдЖрдорддреМрд░ рдкрд░, рджреЛрдиреЛрдВ рддрд░реНрдХреЛрдВ рдХрд╛ рдПрдХ рд╣реА рдореВрд▓реНрдп рд╣реЛрдЧрд╛, рдХрдо рд╕реЗ рдХрдо рдЖрд╡реЗрджрди рдореЗрдВ рдПрдХ рд╕рд╛рде рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХреЛрд░рд╛рдЙрдЯреАрди рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдмрд░рд╛рдмрд░ред  рдЖрдорддреМрд░ рдкрд░, 16 рдХрд╛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рдЧреИрд░-рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рдиреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдИрд╡реЗрдВрдЯ рд▓реВрдк рдирд┐рд░реНрдорд╛рдг (рдЦрдВрдб 7.7) рдХреЗ рддрд░реНрдХ рджреЗрдЦреЗрдВред <br><br>  рдпрджрд┐ coroutine рдХреЛ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рд╡рд┐рдзрд┐ (рдЖрдорддреМрд░ рдкрд░ <i>create_task</i> ) рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рддреЛ <i>asyncio.get_event_loop ()</i> (рддрд░реНрдХреЛрдВ рдХреЗ рдмрд┐рдирд╛) рдкреНрд░рднрд╛рд╡реА рд░реВрдк рд╕реЗ рдЗрд╕реЗ рд╡рд╛рдкрд╕ рдХрд░ рджреЗрдЧрд╛ред <br><br>  <b>реи.реи рдХрд░реМрдЯреЗ</b> <br><br>  рдПрдХ coroutine рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдмрдирд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( delay_secs )</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep ( delay_secs ) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> ( <span class="hljs-string"><span class="hljs-string">'Hello'</span></span> )</code> </pre><br>  рдПрдХ coroutine рдЕрдиреНрдп coroutines рдХреЛ рд╡реЗрдЯ рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддрд╛ рд╣реИред  рдПрдХ coroutine рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ <i>рдкреНрд░рддреАрдХреНрд╖рд┐рдд</i> рдХрдерди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рдХреЛрд░рд╛рдЙрдЯрд╛рдЗрди рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ, рдирд┐рд╖реНрдкрд╛рджрди рд╕реЗ рдкрд╣рд▓реЗ рдЕрдЧрд▓реЗ рд╡рд┐рд╡рд░рдг рддрдХред  рдПрдХ рдЙрджрд╛рд╣рд░рдг рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep ( delay_secs ) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep ( <span class="hljs-number"><span class="hljs-number">0</span></span> )</code> </pre><br>  рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рдореЗрдВ рдХреЛрдб рдХреЛ рд╡рд┐рд▓рдВрдм рд╕рдордп рдХреЗ рд▓рд┐рдП рд░реБрдХрдиреЗ рдХрд╛ рдХрд╛рд░рдг рдмрдирддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдЕрдиреНрдп рдХреЛрд░рдЯрд╛рдЗрди рдЕрдкрдиреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдЗрд╕ рд╕рдордп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  0 рдХреА рджреЗрд░реА рд╕реЗ рд╕рднреА рд▓рдВрдмрд┐рдд рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рдЪрдХреНрд░реАрдп рдХреНрд░рдо рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдЕрдЧрд▓реА рдкрдВрдХреНрддрд┐ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред  <i><b>Roundrobin.py</b></i> рдХрд╛ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦреЗрдВред <br><br>  <b>2.2.1ред</b>  <b>рдПрдХ coroutine рдХреА рдпреЛрдЬрдирд╛ рдХреЗ рд▓рд┐рдП рдХрддрд╛рд░</b> <br><br><ul><li>  <i>EventLoop.create_task</i> рддрд░реНрдХ: рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП Coroutineред  рд╢реЗрдбреНрдпреВрд▓рд░ рдЬрд▓реНрдж рд╕реЗ рдЬрд▓реНрдж рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рдХрддрд╛рд░ рдореЗрдВ рдЦрдбрд╝рд╛ рдХрд░рддрд╛ рд╣реИред  <i>Create_task</i> рдХреЙрд▓ рддреБрд░рдВрдд рд▓реМрдЯрд╛рддрд╛ рд╣реИред  рддрд░реНрдХ рдореЗрдВ coroutine рдЖрд╡рд╢реНрдпрдХ рддрд░реНрдХреЛрдВ рдХреЗ рд╕рд╛рде рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреЗ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </li><li>  <i>EventLoop.run_until_complete</i> рддрд░реНрдХ: рджреМрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП Coroutineред  рд╢реЗрдбреНрдпреВрд▓рд░ рдЬрд▓реНрдж рд╕реЗ рдЬрд▓реНрдж рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рдХрддрд╛рд░ рдореЗрдВ рдЦрдбрд╝рд╛ рдХрд░рддрд╛ рд╣реИред  рддрд░реНрдХ рдореЗрдВ coroutine рдЖрд╡рд╢реНрдпрдХ рддрд░реНрдХреЛрдВ рдХреЗ рд╕рд╛рде рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреЗ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рдЬрдм coroutine рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИ рддреЛ <i>un_until_complete</i> рдХреЙрд▓ рд░рд┐рдЯрд░реНрди: рдпрд╣ рд╡рд┐рдзрд┐ рдЕрдиреБрд╕реВрдЪрдХ рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред </li><li>  <i>рдкреНрд░рддреАрдХреНрд╖рд╛рд░рдд</i> рддрд░реНрдХ: рдПрдХ рдХреЙрд▓рдЖрдЙрдЯ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рдпрд╛ рдЧрдпрд╛ред  рдЬрд┐рддрдиреА рдЬрд▓реНрджреА рд╣реЛ рд╕рдХреЗ рдПрдХ coroutine рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред  рдЬрдм рддрдХ рдЕрдкреЗрдХреНрд╖рд┐рдд рдХреЛрд░рдЖрдЙрдЯ рдореЗрдВ рд╕реЗ рдХреЛрдИ рдПрдХ рдкреВрд░рд╛ рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддрдм рддрдХ рд▓рдВрдмрд┐рдд рдХреЛрд░рдЖрдЙрдЯ рдЕрд╡рд░реБрджреНрдз рд╣реЛрддрд╛ рд╣реИред </li></ul><br>  рдКрдкрд░ <b>CPython</b> рдХреЗ рд╕рд╛рде рд╕рдВрдЧрдд рд╣реИред  рдЕрддрд┐рд░рд┐рдХреНрдд <b><i>uasyncio</i></b> рд╡рд┐рдзрд┐рдпреЛрдВ <b><i>рдХреА</i></b> рдЪрд░реНрдЪрд╛ рдиреЛрдЯреНрд╕ (рдзрд╛рд░рд╛ 2.2.3) рдореЗрдВ рдХреА рдЧрдИ рд╣реИред <br><br>  <b>2.2.2 рдХреЙрд▓рдмреИрдХ рдлрд╝рдВрдХреНрд╢рди рд╢реБрд░реВ рдХрд░рдирд╛</b> <br><br>  рдХреЙрд▓рдмреИрдХ рдХрдо рд╕рдордп рдореЗрдВ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП <b>рдкрд╛рдпрдерди</b> рдХрд╛рд░реНрдп рд╣реЛрдиреЗ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдкреВрд░реЗ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рджреМрд░рд╛рди рдХреЛрд░рд╛рдЙрдЯрд┐рди рдХрд╛рдо рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдВрдЧреЗред <br><br>  рдирд┐рдореНрди <b><i>EventLoop</i></b> рд╡рд░реНрдЧ <b><i>рд╡рд┐рдзрд┐рдпреЛрдВ</i></b> рдХреЙрд▓рдмреИрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ: <br><br><ol><li>  <i>call_soon</i> - рдЬрд┐рддрдиреА рдЬрд▓реНрджреА рд╣реЛ рд╕рдХреЗ рдХреЙрд▓ рдХрд░реЗрдВред  рдЖрд░реНрдЧреНрд╕: <i>рдХреЙрд▓рдмреИрдХ</i> рдХреЙрд▓рдмреИрдХ рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <i>*</i> рдХрд┐рд╕реА рднреА рд╕реНрдерд┐рддрд┐ рд╕рдВрдмрдВрдзреА рддрд░реНрдХ рдХреЛ рдХреЙрдорд╛ рджреНрд╡рд╛рд░рд╛ рдкреАрдЫрд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </li><li>  <i>call_later</i> - рд╕реЗрдХрдВрдб рдореЗрдВ рджреЗрд░реА рдХреЗ рдмрд╛рдж рдХреЙрд▓ рдХрд░реЗрдВред  рдЖрд░реНрдЧреНрд╕: <i>рджреЗрд░реА, рдХреЙрд▓рдмреИрдХ, *</i> рдЖрд░реНрдЧреНрд╕ </li><li>  <i>call_later_ms</i> - ms рдореЗрдВ рджреЗрд░реА рдХреЗ рдмрд╛рдж рдХреЙрд▓ рдХрд░реЗрдВред  рдЖрд░реНрдЧреНрд╕: <i>рджреЗрд░реА, рдХреЙрд▓рдмреИрдХ, *</i> рдЖрд░реНрдЧреНрд╕ред </li></ol><br><pre> <code class="python hljs">loop = asyncio.get_event_loop () loop.call_soon ( foo , <span class="hljs-number"><span class="hljs-number">5</span></span> ) <span class="hljs-comment"><span class="hljs-comment">#    'foo'      5. loop.call_later ( 2 , foo , 5 ) #   2 . loop.call_later_ms ( 50 , foo , 5 ) #   50 . loop.run_forever ()</span></span></code> </pre><br>  <b>реи.реи.рей рдиреЛрдЯ</b> <br><br>  рдПрдХ coroutine рдореЗрдВ рдордирдорд╛рдирд╛ рд░рд┐рдЯрд░реНрди рдорд╛рди рдХреЗ рд╕рд╛рде <i>рд░рд┐рдЯрд░реНрди</i> рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕ рдорд╛рди рдХреЛ рдкрд╛рдиреЗ рдХреЗ рд▓рд┐рдП: <br><br><pre> <code class="python hljs">result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> my_coro ()</code> </pre><br>  рдПрдХ coroutine рд╡рд┐рдзрд┐рдпреЛрдВ рджреНрд╡рд╛рд░рд╛ рд╕реАрдорд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЗрд╕рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ <i>рдкреНрд░рддреАрдХреНрд╖рд┐рдд</i> рдХрдерди рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  <b>реи.рей рджреЗрд░реА</b> <br><br>  рдХреЛрд░рдЯрд╛рдЗрди рдореЗрдВ рджреЗрд░реА рдХреЗ рдЖрдпреЛрдЬрди рдХреЗ рд▓рд┐рдП рджреЛ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВред  рджреЗрд░реА рдХреЗ рд▓рд┐рдП рдФрд░ рдРрд╕реЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЬрд╣рд╛рдВ рдЕрд╡рдзрд┐ рдХреЛ рд╕рдЯреАрдХ рд╣реЛрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( delay_secs , delay_ms )</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep ( delay_secs ) <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> ( <span class="hljs-string"><span class="hljs-string">'Hello'</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep_ms ( delay_ms )</code> </pre><br>  рдЗрд╕ рддрд░рд╣ рдХреА рджреЗрд░реА рдХреЗ рджреМрд░рд╛рди, рд╢реЗрдбреНрдпреВрд▓рд░ рдЕрдиреНрдп рдХреЛрд░рдЖрдЙрдЯреНрд╕ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░реЗрдЧрд╛ред  рдпрд╣ рд╕рдордп рдЕрдирд┐рд╢реНрдЪрд┐рддрддрд╛ рдХрд╛ рдкрд░рд┐рдЪрдп рджреЗ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХреЙрд▓рд┐рдВрдЧ рдХреЙрдЗрди рдХреЗрд╡рд▓ рддрднреА рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм рд╡рд╣ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдЬрд┐рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд╡рд┐рд▓рдВрдм рдХреА рдорд╛рддреНрд░рд╛ рдЖрд╡реЗрджрди рдбреЗрд╡рд▓рдкрд░ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдВрднрд╡рддрдГ рджрд╕рд┐рдпреЛрдВ рдпрд╛ рд╕реИрдХрдбрд╝реЛрдВ рдПрдордПрд╕ рдХреЗ рдЖрджреЗрд╢ рдкрд░ рд╣реЛрдЧреА;  рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдбрд┐рд╡рд╛рдЗрд╕реЗрд╕ (рдЕрдиреБрднрд╛рдЧ 6) рдХреЗ рд╕рд╛рде рд╕рд╣рднрд╛рдЧрд┐рддрд╛ рдореЗрдВ рдЗрд╕ рдкрд░ рдЖрдЧреЗ рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣реИред <br><br>  <i>рдиреАрдВрдж</i> рдХрд╛рд░реНрдпреЛрдВ рдФрд░ <i>рдиреАрдВрдж_рд╕реБрдмрд╣</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╣реБрдд рд╕рдЯреАрдХ рджреЗрд░реА рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред  рд╡реЗ рдЫреЛрдЯреА рджреЗрд░реА рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЙрдкрдпреБрдХреНрдд рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐ рд╢реЗрдбреНрдпреВрд▓рд░ рдЕрдиреНрдп рдХреЛрд░рдЖрдЙрдЯ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдЬрдмрдХрд┐ рд╡рд┐рд▓рдВрдм рдкреНрд░рдЧрддрд┐ рдкрд░ рд╣реИред <br><br>  <b>3.Sinhronizatsiya</b> <br><br>  рдЕрдХреНрд╕рд░ рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рдмреАрдЪ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЙрджрд╛рд╣рд░рдг рддрдерд╛рдХрдерд┐рдд "рджреМрдбрд╝ рдХреА рд╕реНрдерд┐рддрд┐" рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ рдЬрдм рдПрдХ рд╕рд╛рде рдХрдИ рдХреЙрд░рдЖрдЙрдЯ рдХреЛ рдПрдХ рд╣реА рд╕рдВрд╕рд╛рдзрди рддрдХ рдкрд╣реБрдВрдЪ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдПрдХ рдЙрджрд╛рд╣рд░рдг <b><i>astests.py</i></b> рдореЗрдВ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ <b><i>рдЧрдпрд╛ рд╣реИ</i></b> рдФрд░ <a href="" rel="nofollow">рдкреНрд░рд▓реЗрдЦрди</a> рдореЗрдВ рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣реИред  рдПрдХ рдФрд░ рдЦрддрд░рд╛ "рдореМрдд рдХреЛ рдЧрд▓реЗ рд▓рдЧрд╛рдирд╛" рд╣реИ, рдЬрдм рдкреНрд░рддреНрдпреЗрдХ рдХреЛрд░рдЯрд╛рдЗрди рджреВрд╕рд░реЗ рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддрд╛ рд╣реИред <br><br>  рд╕рд░рд▓ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ, рд╡реИрд╢реНрд╡рд┐рдХ рдЭрдВрдбреЗ рдпрд╛ рд╕рдВрдмрдВрдзрд┐рдд рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдПрдХ рдЕрдзрд┐рдХ рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рдХрдХреНрд╖рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред  <b><i>Asyn.py</i></b> рдореЙрдбреНрдпреВрд▓ <i><b>рдЗрд╡реЗрдВрдЯ, рдмреИрд░рд┐рдпрд░, рд╕реЗрдорд╛рдлреЛрд░</b></i> рдФрд░ <b><i>рдХреЙрдиреНрдбрд┐рдЯреАрдпреЛрд╕</i></b> рд╡рд░реНрдЧреЛрдВ рдХреЗ "рдорд╛рдЗрдХреНрд░реЛ" рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рдкреЗрд╢рдХрд╢ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдХреЗрд╡рд▓ <b><i>рдПрд╕рд┐рдВрдХреЛ рдХреЗ</i></b> рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред  рд╡реЗ рдереНрд░реЗрдб-рдУрд░рд┐рдПрдВрдЯреЗрдб рдирд╣реАрдВ рд╣реИрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ <b><i>_thread</i></b> рдореЙрдбреНрдпреВрд▓ рдпрд╛ рдЗрдВрдЯрд░рдкреНрдЯ рд╣реИрдВрдбрд▓рд░ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрдм рддрдХ рдХрд┐ рдЕрдиреНрдпрдерд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рди рд╣реЛред  <i><b>рд▓реЙрдХ</b></i> рдХреНрд▓рд╛рд╕ рдХреЛ рднреА рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ рдПрдХ рд╡рд┐рдХрд▓реНрдк рд╣реИред <br><br>  рдПрдХ рдФрд░ рддреБрд▓реНрдпрдХрд╛рд▓рди рд╕рдорд╕реНрдпрд╛ рдХреЙрд░рдЯреАрди-рдЙрддреНрдкрд╛рджрдХреЛрдВ рдФрд░ рдХреЛрд░рдЯрд╛рдЗрди-рдЙрдкрднреЛрдХреНрддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИред  рдПрдХ coroutine рдЙрддреНрдкрд╛рджрдХ рдбреЗрдЯрд╛ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдПрдХ coroutine рдЙрдкрднреЛрдХреНрддрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <b><i>asyncio</i></b> <i><b>рдХрддрд╛рд░</b></i> рд╡рд░реНрдЧ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдХреЛрд░рдЯрд╛рдЗрди-рдирд┐рд░реНрдорд╛рддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдХрддрд╛рд░ рдореЗрдВ рд░рдЦрддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдХреЛрд░рдЯрд╛рдЗрди-рдЙрдкрднреЛрдХреНрддрд╛ рдЗрд╕рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд░рд╣рд╛ рд╣реИ (рд╕рдордп рдкрд░ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╕рд╛рде)ред  <i><b>рдХрддрд╛рд░</b></i> рд╡рд░реНрдЧ рдЙрди рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЧрд╛рд░рдВрдЯреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрд┐рдирдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдЖрдк <i><b>рдмреИрд░рд┐рдпрд░</b></i> рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрджрд┐ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЛрд░рдЖрдЙрдЯ рдХреЛ рддрдм рддрдХ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрдм рддрдХ рдХрд┐ рдЙрдкрднреЛрдХреНрддрд╛ рдХреЛрд░рдЖрдЙрдЯ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рди рд╣реЛред <br><br>  рдХрдХреНрд╖рд╛рдУрдВ рдХрд╛ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╡рд┐рд╡рд░рдг рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  <a href="" rel="nofollow">рдкреВрд░реНрдг рдкреНрд░рд▓реЗрдЦрди</a> рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реАред <br><br>  <b>3.1 <a href="" rel="nofollow"><i>рддрд╛рд▓рд╛</i></a></b> <br><br>  рд╕рд╛рдЭрд╛ рд╕рдВрд╕рд╛рдзрди рдХреЗ рд▓рд┐рдП <i><b>рд▓реЙрдХ</b></i> рдЕрджреНрд╡рд┐рддреАрдп рдкрд╣реБрдБрдЪ рдХреА рдЧрд╛рд░рдВрдЯреА рджреЗрддрд╛ рд╣реИред  рдирд┐рдореНрди рдХреЛрдб рдЙрджрд╛рд╣рд░рдг <i>рд▓реЙрдХ</i> рдХреНрд▓рд╛рд╕ <b><i>рд▓реЙрдХ</i></b> рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рдЙрди рд╕рднреА рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд╕рд╛рдЭрд╛ рд╕рдВрд╕рд╛рдзрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред  рдЬрдм рддрдХ рдпрд╣ рд╕рдлрд▓ рди рд╣реЛ рдЬрд╛рдП, рддрдм рддрдХ рдкреНрд░рддреНрдпреЗрдХ рдХреЙрд░рдЯреАрди рд▓реЙрдХ рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд░реЛрдХ рджреЗрддрд╛ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> uasyncio.synchro <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Lock <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">task</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(i, lock)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> lock.acquire() print(<span class="hljs-string"><span class="hljs-string">"Acquired lock in task"</span></span>, i) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">0.5</span></span>) lock.release() <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">killer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">10</span></span>) loop = asyncio.get_event_loop() lock = Lock() <span class="hljs-comment"><span class="hljs-comment"># The global Lock instance loop.create_task(task(1, lock)) loop.create_task(task(2, lock)) loop.create_task(task(3, lock)) loop.run_until_complete(killer()) #  10s</span></span></code> </pre><br>  <b>рей.рез.рез.рд▓реЙрдХ рдФрд░ рдЯрд╛рдЗрдордЖрдЙрдЯ</b> <br><br>  рд▓реЗрдЦрди рдХреЗ рд╕рдордп (5 рдЬрдирд╡рд░реА, 2018), <i><b>рдпреВрд╕реАрд╕рд┐рдпреЛ</b></i> <i>рд▓реЙрдХ</i> рд╡рд░реНрдЧ рдХрд╛ рд╡рд┐рдХрд╛рд╕ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рддреМрд░ рдкрд░ рдкреВрд░рд╛ рдирд╣реАрдВ рд╣реБрдЖ рд╣реИред  рдпрджрд┐ рдХреЛрд░рдЖрдЙрдЯ рдПрдХ <u>рдЯрд╛рдЗрдордЖрдЙрдЯ (рдЦрдВрдб 5.2.2) рд╣реИ</u> , рдЬрдм рдЯреНрд░рд┐рдЧрд░ рд╣реЛрдиреЗ рдкрд░ рд▓реЙрдХ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИ, рддреЛ рдЯрд╛рдЗрдордЖрдЙрдЯ рдЕрдкреНрд░рднрд╛рд╡реА рд╣реЛрдЧрд╛ред  рдпрд╣ <i>рд▓реЙрдХрдЖрдЙрдЯ рдорд┐рд▓рдиреЗ</i> рддрдХ <i>TimeoutError</i> рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред  рдПрдХ рдХрд╛рд░реНрдп рдХреЛ рд░рджреНрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рднреА рдпрд╣реА рдмрд╛рдд рд▓рд╛рдЧреВ рд╣реЛрддреА рд╣реИред <br><br>  <b><i>Asyn.py</i></b> рдореЙрдбреНрдпреВрд▓ <a href="" rel="nofollow"><b><i>рд▓реЙрдХ</i></b></a> рдХреНрд▓рд╛рд╕ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЗрди рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рд╡рд░реНрдЧ рдХрд╛ рдпрд╣ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╡рд░реНрдЧ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдХрдо рдХреБрд╢рд▓ рд╣реИ, рд▓реЗрдХрд┐рди <b>рд╕реАрдкреАрдереЙрди</b> рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдЗрдВрдЯрд░рдлреЗрд╕ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рднреА рд╢рд╛рдорд┐рд▓ рд╣реИред <br><br>  <b>3.2 рдШрдЯрдирд╛</b> <br><br>  <b><i>рдЗрд╡реЗрдВрдЯ</i></b> рдПрдХ рдпрд╛ рдХрдИ рдХреЙрд░рдЖрдЙрдЯреНрд╕ рдХреЛ рдерд╛рдордиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рдкреИрджрд╛ рдХрд░рддрд╛ рд╣реИ, рдЬрдмрдХрд┐ рджреВрд╕рд░рд╛ рдЙрдирдХреЗ рдЬрд╛рд░реА рд░рд╣рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рдВрдХреЗрдд рджреЗрддрд╛ рд╣реИред  <b>рдЗрд╡реЗрдВрдЯ</b> рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╕рднреА рдХреЙрд░рдЖрдЙрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╣реИ рдЬреЛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> asyn event = asyn.Event ()</code> </pre><br>  рдПрдХ <i>рдХреЛрд░рдЖрдЙрдЯ</i> рдПрдХ <i>рдкреНрд░рддреАрдХреНрд╖рд╛ рдХреА</i> рдШреЛрд╖рдгрд╛ рдХрд░рдХреЗ рдПрдХ <i>рдШрдЯрдирд╛ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ</i> , рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдирд┐рд╖реНрдкрд╛рджрди рддрдм рддрдХ рд░реБрдХрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдЕрдиреНрдп coroutines <i>рдШрдЯрдирд╛ рдХреА</i> рдШреЛрд╖рдгрд╛ рдирд╣реАрдВ рдХрд░ <i>рджреЗрддреЗ</i> ред <i>()</i> ред  <a href="" rel="nofollow">рдкреВрд░реА рдЬрд╛рдирдХрд╛рд░реА</a> ред <br><br>  рдПрдХ рд╕рдорд╕реНрдпрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛ рд╕рдХрддреА рд╣реИ рдпрджрд┐ <i>рдЗрд╡реЗрдВрдЯ.рд╕реЗрдЯ ()</i> рд▓реВрдкрд┐рдВрдЧ рдирд┐рд░реНрдорд╛рдг рдореЗрдВ рдЬрд╛рд░реА рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ;  рдХреЛрдб рдХреЛ рддрдм рддрдХ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрдм рддрдХ рдХрд┐ рд╕рднреА рд▓рдВрдмрд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдШрдЯрдирд╛ рддрдХ рдкрд╣реБрдВрдЪ рди рд╣реЛред  рдорд╛рдорд▓реЗ рдореЗрдВ рдЬрдм рдХреЛрдИ <b>рдХреЛрд░реЛ</b> рдХрд┐рд╕реА рдШрдЯрдирд╛ рдХреА рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ <b>рдХреЛрд░реЛ</b> рдШрдЯрдирд╛ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eventwait</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( event )</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> event event.clear()</code> </pre><br>  рдИрд╡реЗрдВрдЯ рдЯреНрд░рд┐рдЧрд░ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрд░рдЖрдЙрдЯ рдХреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рд╕реЗрд╡рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( event )</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> : <span class="hljs-comment"><span class="hljs-comment">#   - while event.is_set (): await asyncio.sleep ( 1 ) # ,  coro   event.set ()</span></span></code> </pre><br>  рдорд╛рдорд▓реЗ рдореЗрдВ рдЬрдм рдХрдИ <b>рдХреЛрд░</b> рдПрдХ рдШрдЯрдирд╛ рдХреЗ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдкреБрд╖реНрдЯрд┐рдХрд░рдг рдШрдЯрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдкреНрд░рддреНрдпреЗрдХ <b>рдХреЛрд░реЛ</b> рдХреЛ рдПрдХ рдЕрд▓рдЧ рдШрдЯрдирд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eventwait</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(  , ack_event )</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> event ack_event.set ()</code> </pre><br>  рдЗрд╕рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг <i>asyntest.py</i> рдореЗрдВ <i>event_test</i> рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ <i><b>рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ</b></i> ред  рдпрд╣ рдмреЛрдЭрд┐рд▓ рд╣реИ рдЬреНрдпрд╛рджрд╛рддрд░ рдорд╛рдорд▓реЛрдВ рдореЗрдВ - рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдПрдХ рдкреНрд░рддреАрдХреНрд╖рд╛ <b>рдХреЛрд░реЛ рдХреЗ рд╕рд╛рде</b> - <b>рдмреИрд░рд┐рдпрд░</b> рд╡рд░реНрдЧ, рдиреАрдЪреЗ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдПрдХ рд╕рд░рд▓ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред <br>  рдПрдХ рдШрдЯрдирд╛ рднреА рдмрд╛рдзрд╛ рд╣реИрдВрдбрд▓рд░ рдФрд░ <b>рдХреЛрд░реЛ рдХреЗ</b> рдмреАрдЪ рд╕рдВрдЪрд╛рд░ рдХрд╛ рд╕рд╛рдзрди рдкреНрд░рджрд╛рди рдХрд░ рд╕рдХрддреА рд╣реИред  рд╣реИрдВрдбрд▓рд░ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдХреЛ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ рдФрд░ рдИрд╡реЗрдВрдЯ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕рд╛рдорд╛рдиреНрдп рдореЛрдб рдореЗрдВ <b>рдХреЛрд░реЛ</b> рджреНрд╡рд╛рд░рд╛ рдЬрд╛рдВрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  <b>3.2.1 рдШрдЯрдирд╛ рдорд╛рди</b> <br><br>  <i>рдИрд╡реЗрдВрдЯ .рд╕реЗрдЯ ()</i> рд╡рд┐рдзрд┐ рдХрд┐рд╕реА рднреА рдкреНрд░рдХрд╛рд░ рдХрд╛ рд╡реИрдХрд▓реНрдкрд┐рдХ рдбреЗрдЯрд╛ рдорд╛рди рд▓реЗ рд╕рдХрддреА рд╣реИред  <b>рдХреЛрд░реЛ</b> , рдПрдХ рдШрдЯрдирд╛ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИ, рдЗрд╕реЗ <i>event.value () рдХреЗ</i> рд╕рд╛рде рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ <i>event.clear ()</i> рдХреЛрдИ рднреА рд╕реЗрдЯ <i>рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛</i> ред  рдШрдЯрдирд╛ рдХреЛ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдХрд╛ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧ рдИрд╡реЗрдВрдЯ рдХреЛ рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред <i>(utime.ticks_ms ())</i> ред  рдХрд┐рд╕реА рднреА рдШрдЯрдирд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдХреЛрдИ <b>рдХреЛрд░реЛ</b> рд╡рд┐рд▓рдВрдм рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕рдХреЗ рд▓рд┐рдП рдХреНрд╖рддрд┐рдкреВрд░реНрддрд┐ рдХрд░рдирд╛ред <br><br>  <b>рей.рей <a href="" rel="nofollow"><i>рдмрд╛рдзрд╛</i></a></b> <br><br>  <b><i>рдмреИрд░рд┐рдпрд░</i></b> рд╡рд░реНрдЧ рдХреЗ рд▓рд┐рдП рджреЛ рдЙрдкрдпреЛрдЧ рд╣реИрдВред <br><br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдпрд╣ рдПрдХ coroutine рдХреЛ рдирд┐рд▓рдВрдмрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдПрдХ рдпрд╛ рдХрдИ рдЕрдиреНрдп coroutines рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддреЗред <br><br>  рджреВрд╕рд░реЗ, рдпрд╣ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдмрд┐рдВрджреБ рдкрд░ рдХрдИ рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдирд┐рд░реНрдорд╛рддрд╛ рдФрд░ рдПрдХ рдЙрдкрднреЛрдХреНрддрд╛ рдЙрд╕ рдмрд┐рдВрджреБ рдкрд░ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЗ рдкрд╛рд╕ рдбреЗрдЯрд╛ рд╣реИ, рдФрд░ рдЙрдкрднреЛрдХреНрддрд╛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реИред  рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рдордп, <b>рдмреИрд░рд┐рдпрд░</b> рдХреЛ рд╣рдЯрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ <b>рдмреИрд░рд┐рдпрд░</b> рдЕрддрд┐рд░рд┐рдХреНрдд рдХреЙрд▓рдмреИрдХ рдЬрд╛рд░реА рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕рднреА рд▓рдВрдмрд┐рдд рдШрдЯрдирд╛рдПрдВ рдЬрд╛рд░реА рд░рд╣ рд╕рдХрддреА рд╣реИрдВред <br><br>  рдХреЙрд▓рдмреИрдХ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдпрд╛ рдХреЛрд░рдЯрд╛рдЗрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдЕрдзрд┐рдХрд╛рдВрд╢ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ, рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: рдпрд╣ рдмрд╛рдзрд╛ рд╣рдЯрд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрдиреЗ рдХреА рдЧрд╛рд░рдВрдЯреА рджреА рдЬрд╛ рд╕рдХрддреА рд╣реИред <br><br>  рдПрдХ рдЙрджрд╛рд╣рд░рдг <i>asyntest.py</i> рдореЗрдВ <i><b>рдмрд╛рдзрд╛_</b></i> <i>test</i> рдлрд╝рдВрдХреНрд╢рди рд╣реИред  рдЗрд╕ рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдХреЛрдб рд╕реНрдирд┐рдкреЗрдЯ рдореЗрдВ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> asyn <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(text)</span></span></span><span class="hljs-function">:</span></span> print(text) barrier = asyn.Barrier(<span class="hljs-number"><span class="hljs-number">3</span></span>, callback, (<span class="hljs-string"><span class="hljs-string">'Synch'</span></span>,)) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">report</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">5</span></span>): print(<span class="hljs-string"><span class="hljs-string">'{} '</span></span>.format(i), end=<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> barrier</code> </pre> <br>  <i>рд░рд┐рдкреЛрд░реНрдЯ рдХреЗ</i> рдХрдИ рдЙрджрд╛рд╣рд░рдг coroutine рдЕрдкрдирд╛ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд┐рдВрдЯ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рддрдм рддрдХ рд░реЛрдХрддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рдЕрдиреНрдп рдЙрджрд╛рд╣рд░рдг рднреА рдкреВрд░реЗ рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ <b>рдмрд╛рдзрд╛</b> рдЬрд╛рд░реА рд░рд╣рдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕ рдмрд┐рдВрджреБ рдкрд░, рдПрдХ рдХреЙрд▓рдмреИрдХ рдмрдирд╛рдпрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИред  рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░, рдореВрд▓ рдХреЛрд░рдЯрд╛рдЗрди рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИред <br><br>  <b>рей.рек рд╕реЗрдорд╛рдлреЛрд░</b> <br><br>  рд╕реЗрдорд╛рдлреЛрд░ рдХреЛрд░рдЖрдЙрдЯ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕рдВрд╕рд╛рдзрди рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдХреЛрд░рдЖрдЙрдЯ рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╕рд╛рде рдЪрд▓ рд╕рдХрддреЗ рд╣реИрдВред  рдпрд╣ рдПрдХ рдПрдХреНрд╕реЗрд╕ рдХрд╛рдЙрдВрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдЖрд░рдВрднреАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╣рд░ рдмрд╛рд░ рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рдПрдХ рд╕реЗрдореАрдлреЛрд░ рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред <br><br>  рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХ рдореЗрдВ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рддрд░реАрдХрд╛: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> asyn sema = asyn.Semaphore(<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sema)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> sema: <span class="hljs-comment"><span class="hljs-comment">#   </span></span></code> </pre><br>  рдПрдХ рдЙрджрд╛рд╣рд░рдг <i><b>asyntest.py</b></i> рдореЗрдВ <i>semaphore_test</i> рдлрд╝рдВрдХреНрд╢рди рд╣реИред <br><br>  <b>3.4.1 ( <a href="" rel="nofollow"><i>рд╕реАрдорд┐рдд</i></a> ) рд╕реЗрдорд╛рдлреЛрд░</b> <br><br>  рдпрд╣ <i><b>рд╕реЗрдорд╛рдлреЛрд░</b></i> рд╡рд░реНрдЧ рдХреЗ рд╕рдорд╛рди рд╣реА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд╕рд┐рд╡рд╛рдп рдЗрд╕рдХреЗ рдХрд┐ рдпрджрд┐ <i>рд░рд┐рд▓реАрдЬрд╝</i> рд╡рд┐рдзрд┐ рдПрдХреНрд╕реЗрд╕ рдХрд╛рдЙрдВрдЯрд░ рдХреЛ рдЗрд╕рдХреЗ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдорд╛рди рд╕реЗ рдЕрдзрд┐рдХ рдХрд╛ рдХрд╛рд░рдг рдмрдирд╛рддреА рд╣реИ, рддреЛ рдПрдХ <i>ValueError</i> рд╕реЗрдЯ рд╣реИред <br><br>  <b>3.5 рдХрддрд╛рд░</b> <br><br>  <i><b>рдХреНрдпреВ</b></i> рдХреНрд▓рд╛рд╕ рдХреЛ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ <i><b>uasycio</b></i> рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдП рд░рдЦрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ <i><b>aqtest.py</b></i> рдирдореВрдирд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЗрд╕рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред  рдХрддрд╛рд░ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдмрдирд╛рдИ рдЧрдИ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> uasyncio.queues <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Queue q = Queue ()</code> </pre><br>  рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдирд┐рд░реНрдорд╛рддрд╛ рдХреЛрд░рдЯрд╛рдЗрди рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">producer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(q)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> slow_process() <span class="hljs-comment"><span class="hljs-comment">#       await q.put(result) #  ,       </span></span></code> </pre><br>  рдФрд░ рдЙрдкрднреЛрдХреНрддрд╛ coroutine рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдХрд╛рдо рдХрд░ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">consumer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(q)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span>(q.get()) <span class="hljs-comment"><span class="hljs-comment"># ,  q  print('Result was {}'.format(result))</span></span></code> </pre><br>  <i><b>рдХрддрд╛рд░</b></i> рд╡рд░реНрдЧ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдЕрддрд┐рд░рд┐рдХреНрдд рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬрдм рдХрддрд╛рд░реЛрдВ рдХрд╛ рдЖрдХрд╛рд░ рд╕реАрдорд┐рдд рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рд╕реНрдерд┐рддрд┐ рдХреЛ рдкреНрд░рджреВрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдПрдХ рдЦрд╛рд▓реА рдХрддрд╛рд░ рдХреЗ рд╕рд╛рде рд╡реНрдпрд╡рд╣рд╛рд░ (рдпрджрд┐ рдЖрдХрд╛рд░ рд╕реАрдорд┐рдд рд╣реИ) рдФрд░ рдПрдХ рдкреВрд░реНрдг рдХрддрд╛рд░ рдХреЗ рд╕рд╛рде рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдкреНрд░рд▓реЗрдЦрди рдХреЛрдб рдореЗрдВ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3.6 рдЕрдиреНрдп рд╡рд░реНрдЧреЛрдВ рд╕рд┐рдВрдХ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд╛рдЗрдмреНрд░реЗрд░реА </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyn.py</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ "рдорд╛рдЗрдХреНрд░реЛ" рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЬрд┐рд╕рдореЗрдВ рдХреБрдЫ рд╕реБрд╡рд┐рдзрд╛рдПрдВ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPython</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><a href="" rel="nofollow"><b><i><font style="vertical-align: inherit;">рд╣рд╛рд▓рдд</font></i></b></a></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд░реНрдЧ </font><font style="vertical-align: inherit;">рдПрдХ coroutine рдХреЛ рдПрдХ рдмрдВрдж рд╕рдВрд╕рд╛рдзрди рдкрд░ рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рдЕрдиреНрдп coroutines рдХреЛ рд╕реВрдЪрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЕрдзрд┐рд╕реВрдЪрдирд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╡реЗ рд╕рдВрд╕рд╛рдзрди рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВрдЧреЗ рдФрд░ рдмрджрд▓реЗ рдореЗрдВ рдЕрдирд▓реЙрдХ рдХрд░реЗрдВрдЧреЗред рдПрдХ рд╕реВрдЪрдирд╛ рдХреЛрд░рдЖрдЙрдЯ рдХреЛ рдЕрдзрд┐рд╕реВрдЪрд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрд░рдЖрдЙрдЯ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╕реАрдорд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред </font><a href="" rel="nofollow"><b><i><font style="vertical-align: inherit;">Gather</font></i></b></a><font style="vertical-align: inherit;"> рд╡рд░реНрдЧ </font><font style="vertical-align: inherit;">рдЖрдкрдХреЛ coroutines рдХреА рдПрдХ рд╕реВрдЪреА рдЪрд▓рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред рдЙрддреНрддрд░рд╛рд░реНрджреНрдз рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдкрд░, рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧреАред рдпрд╣ "рдорд╛рдЗрдХреНрд░реЛ" рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдПрдХ рдЕрд▓рдЧ рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред рдЯрд╛рдЗрдордЖрдЙрдЯ рдХрд┐рд╕реА рднреА рдХреЛрд░рдЖрдЙрдЯ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</font></font><a href="" rel="nofollow"><b><i><font style="vertical-align: inherit;"></font></i></b></a><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><a href="" rel="nofollow"><b><i><font style="vertical-align: inherit;"></font></i></b></a><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio рдХреЗ</font></font></i></b> <font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;"> рд▓рд┐рдП рдХрдХреНрд╖рд╛рдПрдВ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛</font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдХрд╛рд╕рд╢реАрд▓ рдбрд┐рд╡рд╛рдЗрд╕ рдЪрд╛рд▓рдХреЛрдВ рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ, рд▓рдХреНрд╖реНрдп рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реИ рдХрд┐ рд╡реЗ рдЧреИрд░-рдЕрд╡рд░реБрджреНрдз рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред рдПрдХ coroutine рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЕрдиреНрдп coroutines рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реИрдВ рдЬрдмрдХрд┐ рдбреНрд░рд╛рдЗрд╡рд░ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд╕рдВрдЪрд╛рд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, UART рдореЗрдВ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдпрд╛ рдмрдЯрди рджрдмрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдХрд╛рд░реНрдп рдЕрдиреНрдп рдИрд╡реЗрдВрдЯ рдХреЛ рддрдм рддрдХ рд╢реЗрдбреНрдпреВрд▓ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдИрд╡реЗрдВрдЯ рди рд╣реЛ рдЬрд╛рдПред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдореНрдореАрджреЛрдВ рдХреЗ рд╕рд╛рде 4.1 рд╡рд░реНрдЧ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛ рдЗрдВрддрдЬрд╛рд░</font></font></i></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coroutine рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдирд┐рд▓рдВрдмрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд╡рд╕реНрддреБ рдХреЗ рд▓рд┐рдП рдЗрдВрддрдЬрд╝рд╛рд░ рдХрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awaitable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPython рдХреЗ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрд╣рдд </font><b><font style="vertical-align: inherit;">, рдПрдХ</font></b><font style="vertical-align: inherit;"> рдХрд╕реНрдЯрдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХреНрд╖рд╛ рдпреЛрдЧреНрдп</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд░реНрдЧ </font><font style="vertical-align: inherit;">рд╡рд┐рд╢реЗрд╖ </font><i><font style="vertical-align: inherit;">__await__</font></i><font style="vertical-align: inherit;"> рдкрджреНрдзрддрд┐ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬреЗрдирд░реЗрдЯрд░ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдирд┐рдореНрди </font><font style="vertical-align: inherit;">рд╢реНрд░реЗрдгреА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__await__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">5</span></span>): print(<span class="hljs-string"><span class="hljs-string">'__await__ called'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment">#     return 42 __iter__ = __await__ # .   async def bar(): foo = Foo() # Foo - awaitable  print('waiting for foo') res = await foo #   print('done', res) loop = asyncio.get_event_loop() loop.run_until_complete(bar())</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди рдореЗрдВ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroPython</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__await__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href="http://github.com/micropython/micropython/issues/2678" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореБрджреНрджрд╛ # 2678</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдФрд░ рд╕рдорд╛рдзрд╛рди рдХреЗ рд▓рд┐рдП рдкреНрд░рдпреЛрдЧ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__iter__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░рд┐рдВрдЧ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__iter__ = __await__ </font></font></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPython</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroPython рдХреЗ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмреАрдЪ рдкреЛрд░реНрдЯреЗрдмрд┐рд▓рд┐рдЯреА рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдХреЛрдб рдЙрджрд╛рд╣рд░рдг, рд╡рд░реНрдЧреЛрдВ рдХреЛ рджреЗрдЦрдиреЗ рдХреЗ </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╡реЗрдВрдЯ, рдмреИрд░рд┐рдпрд░, рд░рджреНрдж рдХрд░рдиреЗ рдпреЛрдЧреНрдп, рд╕реНрдерд┐рддрд┐</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyn.py</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.1.1 рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдкреЗрдХреНрд╖рд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╕рдордХрд╛рд▓рд┐рдХ рдпрд╛ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЗ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╡рд╛рдХреНрдп рд░рдЪрдирд╛:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> awaitable <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> a: <span class="hljs-comment"><span class="hljs-comment">#  'as'   #    async with awaitable as a: #    (.) #  -</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__await__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрдирд░реЗрдЯрд░ рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрд╡</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд╛рдкрд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ </font><font style="vertical-align: inherit;">ред рдЗрд╕реЗ рдХрд┐рд╕реА рднреА рд╡реИрд░рд┐рдПрдмрд▓ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрд▓реЙрдЬ </font><font style="vertical-align: inherit;">рдореЗрдВ рдкрд╛рд╕ рдХрд┐рдпрд╛ </font><i><font style="vertical-align: inherit;">рдЬрд╛рддрд╛</font></i><font style="vertical-align: inherit;"> рд╣реИ, рдФрд░ рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЛрдВ рдХреЛ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рднреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asyn.Condition</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyntest.condition_test</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреЗрдЦреЗрдВ, </font><font style="vertical-align: inherit;">рдЬрд╣рд╛рдВ </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рд▓рдд</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд░реНрдЧ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХреНрд╖рд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ </font><i><font style="vertical-align: inherit;">рдХрд░рддрд╛ рд╣реИ</font></i><font style="vertical-align: inherit;"> рдФрд░ рдПрдХ рддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрдВ 4.1.2 рдХрд╛ рдЗрдВрддрдЬрд╛рд░ coroutine</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рднрд╛рд╖рд╛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдЬрдЧрд░</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__await__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрдирд░реЗрдЯрд░ рд╕рдорд╛рд░реЛрд╣ рдерд╛ред рдореЗрдВ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroPython</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрдирд░реЗрдЯрд░ рдФрд░ coroutines, рд╕рдорд╛рди рд╣реИрдВ рддреЛ рд╕рдорд╛рдзрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Coro рд╕реЗ рдЙрдкрдЬ рдмрдпрд╛рди (args)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдЧрд╛рдЗрдб рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдХреЛрдб рдХреА рдкреЗрд╢рдХрд╢ рдХрд░рдирд╛ рд╣реИ рдЬреЛ рдХрд┐ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реАрдкреАрдереЙрди 3.5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ рдмрд╛рдж рдореЗрдВ </font><font style="vertical-align: inherit;">рдкреЛрд░реНрдЯреЗрдмрд▓ рд╣реИ </font><font style="vertical-align: inherit;">ред рдореЗрдВ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPython</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрдирд░реЗрдЯрд░ рдФрд░ coroutines рдЕрд░реНрде рдореЗрдВ рдЕрд▓рдЧ рд╣реИрдВред рдореЗрдВ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPython</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coroutine рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__await__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рд╢реЗрд╖ рд╡рд┐рдзрд┐ рд╣реИ, рдЬреЛ рдЬрдирд░реЗрдЯрд░ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИред рдпрд╣ рдкреЛрд░реНрдЯреЗрдмрд▓ рд╣реИ:</font></font><br><br><pre> <code class="python hljs">up = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-comment"><span class="hljs-comment">#   MicroPython? try: import uasyncio as asyncio up = True #    sys.implementation.name except ImportError: import asyncio async def times_two(n): # Coro   await asyncio.sleep(1) return 2 * n class Foo(): def __await__(self): res = 1 for n in range(5): print('__await__ called') if up: # MicroPython res = yield from times_two(res) else: # CPython res = yield from times_two(res).__await__() return res __iter__ = __await__ async def bar(): foo = Foo() # foo is awaitable print('waiting for foo') res = await foo #   print('done', res) loop = asyncio.get_event_loop() loop.run_until_complete(bar())</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__await__, asyncio.sleep (1) рд╕реЗ рдЙрдкрдЬ </font></font></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CPython</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрдордд рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдореБрдЭреЗ рдЕрднреА рддрдХ рд╕рдордЭ рдирд╣реАрдВ рдЖрдпрд╛ рдХрд┐ рдпрд╣ рдХреИрд╕реЗ рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.2 рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдкреБрдирд░рд╛рд╡реГрддреНрдд</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпрд╛рдБ рдПрдХ рд╕реАрдорд┐рдд рдпрд╛ рдЕрдирдВрдд рдорд╛рдиреЛрдВ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░рдиреЗ рдХрд╛ рд╕рд╛рдзрди рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЬрдм рд╡реЗ рдХреЗрд╡рд▓-рдкрдврд╝рдиреЗ рдХреЗ рдЙрдкрдХрд░рдг рд╕реЗ рдЖрддреЗ рд╣реИрдВ, рддреЛ рдЕрдиреБрдХреНрд░рдорд┐рдХ рдбреЗрдЯрд╛ рддрддреНрд╡реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд╕рд╛рдзрди рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рдкреБрдирд░рд╛рд╡рд░реНрддрдХ рдЕрдкрдиреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдЧрд▓реЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрд░реАрдХреЗ рдореЗрдВ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рдХреЛрдб рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рд╡рд░реНрдЧ рдХреЛ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдиреНрд╣реЛрдВрдиреЗ рдХрд╣рд╛ рдХрд┐ рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__aiter__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдореЗрдВ рдкрд░рд┐рднрд╛рд╖рд┐рдд </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">async рдбреАрдИрдПрдлрд╝</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рдПрдХ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ iterator рджреЗрддрд╛ рд╣реИред</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреА рдПрдХ рд╡рд┐рдзрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__anext__ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬреЛ рдХрд┐ рд╕реНрд╡рдпрдВ рдПрдХ coroutine рд╣реИ - рдЕрд░реНрдерд╛рдд, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">async def рдХреЗ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рдзреНрдпрдо рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рдФрд░ рдЬрд┐рд╕рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХреНрд╖рд┐рдд</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрдерди рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдкреБрдирд░рд╛рд╡реГрддрд┐ рдХреЛ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StopAsyncIteration</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдкрд╡рд╛рдж </font><font style="vertical-align: inherit;">рдЙрдард╛рдирд╛ рд╣реЛрдЧрд╛ </font><font style="vertical-align: inherit;">ред</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреАрдЪреЗ рджрд┐рдЦрд╛рдП рдЧрдП рдЕрдиреБрд╕рд╛рд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">async</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реАрд░рд┐рдпрд▓ рд╡реИрд▓реНрдпреВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд </font><font style="vertical-align: inherit;">рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AsyncIterable</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.data = (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>) self.index = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__aiter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__anext__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> self.fetch_data() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> data: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> StopAsyncIteration <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetch_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">0.1</span></span>) <span class="hljs-comment"><span class="hljs-comment">#     if self.index &gt;= len(self.data): return None x = self.data[self.index] self.index += 1 return x async def run(): ai = AsyncIterable() async for x in ai: print(x)</span></span></code> </pre><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4.3 рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрдХреНрд╖рд╛рдПрдВ рд╕рд╣-рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рдкреНрд░рд╡реЗрд╢ рдФрд░ рдирд┐рдХрд╛рд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рд╡рд╛рд▓реЗ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИрдВред рдПрдХ рдЙрджрд╛рд╣рд░рдг </font><font style="vertical-align: inherit;">рдКрдкрд░ рд╡рд░реНрдгрд┐рдд </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЙрдХ</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрд▓рд╛рд╕ </font><font style="vertical-align: inherit;">рд╣реИред рдЗрд╕рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__aenter__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coroutine рд╣реИ </font><font style="vertical-align: inherit;">, рдЬрд┐рд╕реЗ рддрд╛рд░реНрдХрд┐рдХ рд░реВрдк рд╕реЗ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдСрдкрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИред рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХ рдХреЗ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЗрд╕рдХреА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__aexit__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ рднреА рдПрдХ coroutine рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдП, рдЬреЛ рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio.sleep (0) рдХреЛ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╢рд╛рдорд┐рд▓ рдХрд░рдХреЗ рд╣рд╛рд╕рд┐рд▓ рдХреА рдЧрдИ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЗрд╕ рддрд░рд╣ рдХреА рдХрдХреНрд╖рд╛рдПрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд┐рдВрдЯреИрдХреНрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рдХреЛрд░рдЖрдЙрдЯ рд╕реЗ рд╕реБрд▓рдн рд╣реИрдВ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bar</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( lock )</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> lock: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> ( ┬л bar ┬╗ )</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рдпрдорд┐рдд рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХреЛрдВ рдХреЗ рд╕рд╛рде рдХреЗ рд░реВрдк рдореЗрдВ, рдмрд╛рд╣рд░ рдирд┐рдХрд▓рдиреЗ рдХреА рд╡рд┐рдзрд┐ рдХреЛ рдЧрд╛рд░рдВрдЯреА рджреА рдЬрд╛рддреА рд╣реИ рдЬрдм рд╕рдВрджрд░реНрдн рдкреНрд░рдмрдВрдзрдХ рдЕрдкрдирд╛ рдХрд╛рдо рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИ, рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, рдФрд░ рдПрдХ рдЕрдкрд╡рд╛рдж рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗред рдЗрд╕ рд▓рдХреНрд╖реНрдп рдХреЛ рд╣рд╛рд╕рд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рд╡рд┐рд╢реЗрд╖ рддрдХрдиреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__aenter__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__aexit__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , coroutines рд░реВрдк рдореЗрдВ рдкрд╣рдЪрд╛рдирд╛ рдЬрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдФрд░ coroutine рдпрд╛ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">awaitable</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд╕реНрддреБред рдпрд╣ рдЙрджрд╛рд╣рд░рдг </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓реЙрдХ</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрд▓рд╛рд╕ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__aenter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> self.acquire() <span class="hljs-comment"><span class="hljs-comment"># a coro    async def return self async def __aexit__(self, *args): self.release() #   await asyncio.sleep_ms(0)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">async рдХреЗ рд╕рд╛рде </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЦрдВрдб рдХреЗ </font><i><font style="vertical-align: inherit;">рд░реВрдк</font></i><font style="vertical-align: inherit;"> рдореЗрдВ рд╣реЛрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рддреЛ рдЪрд░ рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__aenter__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреНрд╡рд╛рд░рд╛ рд▓реМрдЯрд╛рдпрд╛ рдЧрдпрд╛ рдорд╛рди </font><i><font style="vertical-align: inherit;">рдорд┐рд▓рддрд╛ рд╣реИ</font></i><font style="vertical-align: inherit;"> ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╣реА рд╡реНрдпрд╡рд╣рд╛рд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдлрд░реНрдорд╡реЗрдпрд░ V1.9.10 рдпрд╛ рдмрд╛рдж рдХрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреЗ рдЕрдкрд╡рд╛рдж рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд░рджреНрдж рдХрд░рдиреЗ рдХреЗ рдХрд╛рд░рдг</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпреЗ рд╡рд┐рд╖рдп рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд░рджреНрдж рдХрд░рдирд╛ рдФрд░ рдХрд┐рд╕реА рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдЯрд╛рдЗрдордЖрдЙрдЯ рд▓рд╛рдЧреВ рдХрд░рдирд╛, рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рд░реНрдп рдХреЗ рдЕрдкрд╡рд╛рдж рдХреЛ рдлреЗрдВрдХрдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.1 рдЕрдкрд╡рд╛рдж</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдПрдХ рдХреЛрд░рдЯрд╛рдЗрди рдореЗрдВ рдПрдХ рдПрдХреНрд╕рд╛рдИрд╢рди рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдЗрд╕ рдХреЛрд░рдЖрдЙрдЯ рдореЗрдВ рдпрд╛ рдЗрд╕рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдореЗрдВ рдПрдХ рдХреЛрд░рдЖрдЙрдЯ рдореЗрдВ рд╕рдВрд╕рд╛рдзрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЕрдкрд╡рд╛рдж рд╢реЗрдбреНрдпреВрд▓рд░ рдкрд░ рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рдпрджрд┐ рдХреЛрдИ рдЕрдкрд╡рд╛рдж рд╣реЛрддрд╛ рд╣реИ, рддреЛ рд╢реЗрдбреНрдпреВрд▓рд░ рдЙрд╕ рдХреЛрдб рдХреЗ рдЕрдкрд╡рд╛рдж рдХреЛ рдкрд╛рд╕ рдХрд░рдХреЗ рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрдЧрд╛ рдЬреЛ рд╢реЗрдбреНрдпреВрд▓рд░ рдиреЗ рдкреНрд░рд╛рд░рдВрдн рдХрд┐рдпрд╛ рдерд╛ред рдЗрд╕рд▓рд┐рдП, рдЕрдиреБрд╕реВрдЪрдХ рдХреЛ рд░реЛрдХрдиреЗ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП, coroutine рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loop.create_task () рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╛рде рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрд┐рд╕реЗ </font><font style="vertical-align: inherit;">рдХрд┐рд╕реА рднреА рдЕрдкрд╡рд╛рдж рдХреЛ рдкрдХрдбрд╝рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдПрдХ coroutine рдореЗрдВ рдПрдХ рдЕрдкрд╡рд╛рдж рдХреЛ </font><i><font style="vertical-align: inherit;">рдлреЗрдВрдХрдиреЗ </font></i><i><font style="vertical-align: inherit;">рдХреЗ</font></i><font style="vertical-align: inherit;"> рд▓рд┐рдП </font><i><font style="vertical-align: inherit;">рдлреЗрдВрдХ</font></i><font style="vertical-align: inherit;"> рдпрд╛ </font><i><font style="vertical-align: inherit;">рдмрдВрдж</font></i></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ </font><font style="vertical-align: inherit;">рдЕрдиреБрдЪрд┐рдд рд╣реИред рдпрд╣ </font><b><font style="vertical-align: inherit;">рдпреВрд╕рд┐рдВрд╕реАрдУ</font></b><font style="vertical-align: inherit;"> рдХреЛ рдирд╖реНрдЯ рдХрд░ рджреЗрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рдЬрд┐рд╕рд╕реЗ </font><b><font style="vertical-align: inherit;">рдХреЛрд░рдЯрд╛рдЗрди</font></b><font style="vertical-align: inherit;"> рд╢реБрд░реВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рд╕рдВрднрд╡рддрдГ </font><b><font style="vertical-align: inherit;">рдмрд╛рд╣рд░ рдирд┐рдХрд▓ рдЬрд╛рддрд╛ рд╣реИ</font></b><font style="vertical-align: inherit;"> рдЬрдм рдпрд╣ рдЕрднреА рднреА рдирд┐рд╖реНрдкрд╛рджрди рдХрддрд╛рд░ рдореЗрдВ рд╣реИред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрд░реЛрдХреНрдд рдЙрджрд╛рд╣рд░рдг рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред рдЕрдЧрд░ рдЕрдВрдд рддрдХ рдХрд╛рдо рдХрд░рдиреЗ рджрд┐рдпрд╛ рдЬрд╛рдП рддреЛ рдпрд╣ рдЙрдореНрдореАрдж рдХреЗ рдореБрддрд╛рдмрд┐рдХ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">3</span></span>) print(<span class="hljs-string"><span class="hljs-string">'About to throw exception.'</span></span>) <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> foo() <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> ZeroDivisionError: print(<span class="hljs-string"><span class="hljs-string">'foo  -   0'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># ! raise #     . except KeyboardInterrupt: print('foo was interrupted by ctrl-c') #   ! raise async def shutdown(): print('Shutdown is running.') #     await asyncio.sleep(1) print('done') loop = asyncio.get_event_loop() try: loop.run_until_complete(bar()) except ZeroDivisionError: loop.run_until_complete(shutdown()) except KeyboardInterrupt: print('Keyboard interrupt at loop level.') loop.run_until_complete(shutdown())</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдХреАрдмреЛрд░реНрдб рдЗрдВрдЯрд░рдкреНрдЯ рдЬрд╛рд░реА рдХрд░рдиреЗ рд╕реЗ рдЕрдкрд╡рд╛рдж рдШрдЯрдирд╛ рдкрд╛рд╢ рдореЗрдВ рдЬрд╛рддрд╛ рд╣реИред рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реИ рдХреНрдпреЛрдВрдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio.sleep</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ </font><font style="vertical-align: inherit;">рдирд┐рд╖реНрдкрд╛рджрди </font><font style="vertical-align: inherit;">рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреЛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕рд▓рд┐рдП, рдЬрд┐рди рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рдХреАрдмреЛрд░реНрдб рд╡реНрдпрд╡рдзрд╛рди рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдПрдХ рд╕реНрдкрд╖реНрдЯ рдХреЛрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЙрдиреНрд╣реЗрдВ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рд╕реНрддрд░ рдкрд░ рдЕрдкрд╡рд╛рдж рдХреЛ рдкрдХрдбрд╝рдирд╛ рдЪрд╛рд╣рд┐рдПред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2 рд░рджреНрдж рдХрд░реЗрдВ рдФрд░ рд╕рдордпрдмрд╛рд╣реНрдп</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдпреЗ рдлрд╝рдВрдХреНрд╢рди рд╡рд┐рд╢реЗрд╖ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдЗрдХреНрд░реЛрдкрд╛рдпрдереЙрди</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">coroutine </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pend_throw</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдЕрдкрд╡рд╛рдж рдмрдврд╝рд╛рдХрд░ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдпрд╣ рд╕рдВрд╕реНрдХрд░рдг рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рдЖрдзрд┐рдХрд╛рд░рд┐рдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio v.2.0 рдореЗрдВ, рдПрдХ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдкрд╡рд╛рдж рдХреЛ рдЕрдЧрд▓реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рддрдХ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрджрд┐ рдХрд╛рд░реНрдп </font><i><font style="vertical-align: inherit;">рдиреАрдВрдж рдХреА</font></i><font style="vertical-align: inherit;"> рдЙрдореНрдореАрдж рдХрд░рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рджреЗрд░реА рдХрд░рддрд╛ рд╣реИ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдирдкреБрдЯ-рдЖрдЙрдЯрдкреБрдЯред </font><font style="vertical-align: inherit;">рд╕рдордпрд╛рд╡рдзрд┐ рдЙрдирдХреЗ рдирд╛рдордорд╛рддреНрд░ рдЕрд╡рдзрд┐ рд╕реЗ рдЖрдЧреЗ рдмрдврд╝ рд╕рдХрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдкреВрд░реНрд╡рд╡рдд рдХрд╛рд░реНрдп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрдм рдкреВрд░реНрд╡рд╡рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдПрдХ рд╡рд░реНрдХрдЕрд░рд╛рдЙрдВрдб рдФрд░ рджреЛ рд╕рдорд╛рдзрд╛рди рд╣реИрдВред</font></font><br><br><ul><li><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрдХрдЕрд░рд╛рдЙрдВрдб</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;">рдПрд╕рд╛рдЗрди</font></b><font style="vertical-align: inherit;"> рд▓рд╛рдЗрдмреНрд░реЗрд░реА </font><font style="vertical-align: inherit;">рдХрд╛рд░реНрдпреЛрдВ рдпрд╛ рдХрд╛рд░реНрдп рд╕рдореВрд╣реЛрдВ рдХреЛ рд░рджреНрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХрд╛ рд╕рд╛рдзрди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ рдиреМрдХрд░реА рд░рджреНрдж рдХрд░реЗрдВ (рдЦрдВрдб 5.2.1) рджреЗрдЦреЗрдВред</font></font></li><li> <a href="http://github.com/pfalcon/pycopy-lib" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреЙрд▓ рд╕реЛрдХреЛрд▓реЛрд╡реНрд╕реНрдХреА рдкреБрд╕реНрддрдХрд╛рд▓рдп </font></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio v2.4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рд▓рд┐рдП рдЗрд╕рдХреА </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pycopy</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд░реНрдорд╡реЗрдпрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font></li><li> <a href="" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fast_io</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд╛рдЗрдмреНрд░реЗрд░реА</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> uasyncio </font></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдпрдерди</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рддреА рд╣реИ</font><font style="vertical-align: inherit;">(рдХрдо рд╕реБрд░реБрдЪрд┐рдкреВрд░реНрдг рддрд░реАрдХреЗ рд╕реЗ) рдФрд░ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рдлрд░реНрдорд╡реЗрдпрд░ рдкрд░ рдЪрд▓рддреА рд╣реИред</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдЕрдкрд╡рд╛рджреЛрдВ рдХрд╛ рдкрджрд╛рдиреБрдХреНрд░рдо </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдкрд╡рд╛рдж-рд░рджреНрдж-рдирд┐рд╖реНрдкрд╛рджрд┐рдд-рд╕рдордп-рд╕рдордп рдкрд░ рд╣реИ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2.1 рдПрдХ рдиреМрдХрд░реА рд░рджреНрдж рдХрд░рдирд╛ </font></font></b> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рджреНрдж (рдХреЛрд░реЛ)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдпрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pend_throw</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coroutine рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрд╡рд╛рдж рдлреЗрдВрдХрдХрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдпрд╣ рдиреЗрд╕реНрдЯреЗрдб рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рд╕рд╛рде рднреА рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред рдЙрдкрдпреЛрдЧ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-comment"><span class="hljs-comment">#  -  10 secs await asyncio.sleep(10) async def bar(loop): foo_instance = foo() #   coro loop.create_task(foo_instance) # code omitted asyncio.cancel(foo_instance)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдпрд╣ рдЙрджрд╛рд╣рд░рдг </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio v2.0 рдХреЗ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрд╣рдд рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рддреЛ рдЬрдм </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╛рд░ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореБрджреНрджреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рджреНрдж</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣реЛ рдЬрд╛рддреЗ </font><font style="vertical-align: inherit;">рд╣реИрдВ </font><font style="vertical-align: inherit;">рддреЛ </font><font style="vertical-align: inherit;">рдпрд╣ рдЕрдЧрд▓реЗ рдЕрдиреБрд╕реВрдЪрд┐рдд </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрдХ рдкреНрд░рднрд╛рд╡реА рдирд╣реАрдВ рд╣реЛрдЧрд╛ </font><i><font style="vertical-align: inherit;">,</font></i><font style="vertical-align: inherit;"> рдФрд░ рдЬрдм </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рджреНрдж </font><font style="vertical-align: inherit;">рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рддреЛ </font><font style="vertical-align: inherit;">10 рд╕реЗрдХрдВрдб рддрдХ рдХреА рджреЗрд░реА рд╣реЛ рд╕рдХрддреА </font><i><font style="vertical-align: inherit;">рд╣реИ</font></i><font style="vertical-align: inherit;"> ред рджреЗрд░реА рдХрд╛ рдПрдХ рдЕрдиреНрдп рд╕реНрд░реЛрдд рддрдм рд╣реЛрдЧрд╛ рдЬрдм </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I / O рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИред рдЬрд╣рд╛рдВ рднреА рд╡рд┐рд▓рдВрдм рд╣реЛрддрд╛ рд╣реИ, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрд╛рд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рджреНрдж </font><i><font style="vertical-align: inherit;">рдХрд░</font></i><font style="vertical-align: inherit;"> рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ рдХреБрдЫ рдЙрдкрдпреЛрдЧ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдорд╛рдпрдиреЗ рд░рдЦрддрд╛ рд╣реИред </font><b><font style="vertical-align: inherit;">рдкреЙрд▓ рд╕реЛрдХреЛрд▓реЛрд╡реНрд╕реНрдХреА</font></b><font style="vertical-align: inherit;"> рдпрд╛ </font><b><font style="vertical-align: inherit;">fast_io рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ</font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп </font><b><font style="vertical-align: inherit;">, рдпрд╣</font></b><font style="vertical-align: inherit;"> рдиреАрдВрдж рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ (0):</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-comment"><span class="hljs-comment">#  -  10 secs await asyncio.sleep(10) async def bar(loop): foo_instance = foo() #   coro loop.create_task(foo_instance) #    asyncio.cancel(foo_instance) await asyncio.sleep(0) #   </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio v2.0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рднреА рдХрд╛рдо рдХрд░реЗрдЧрд╛ </font><font style="vertical-align: inherit;">рдЕрдЧрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (рдФрд░ рдХрд┐рд╕реА рднреА рд▓рдВрдмрд┐рдд </font><b><font style="vertical-align: inherit;">рдХреЛрд░рдЯрд╛рдЗрди </font></b></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдХрднреА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреАрдВрдж</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд╣реАрдВ </font><font style="vertical-align: inherit;">рд▓реМрдЯреА рдФрд░ I / O рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдирд╣реАрдВ рдХрд┐рдпрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпрд╡рд╣рд╛рд░ рдЬреЛ рдХрд┐ рд▓рд╛рдкрд░рд╡рд╛рд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рддрдм рд╣реЛрддрд╛ рд╣реИ рдЬрдм рдПрдХ coroutine рдЬреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">create_task</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреНрд╡рд╛рд░рд╛ рдЪрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ </font><font style="vertical-align: inherit;">рд╣реИ рдФрд░ рд╕реНрдЯреИрдВрдбрдмрд╛рдп рдореЛрдб рдореЗрдВ </font><font style="vertical-align: inherit;">рд╣реЛрддрд╛ рд╣реИ, рдЙрд╕реЗ рд░рджреНрдж рдХрд░рдиреЗ рдХреА рдЙрдореНрдореАрдж рдХреА рдЬрд╛рддреА рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдЗрд╕ рд╕реНрдирд┐рдкреЗрдЯ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-comment"><span class="hljs-comment">#  -  10 secs await asyncio.sleep(10) async def foo_runner(foo_instance): await foo_instance print('   ') async def bar(loop): foo_instance = foo() loop.create_task(foo_runner(foo_instance)) #    asyncio.cancel(foo_instance)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд░рджреНрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдЕрдиреБрд╕реВрдЪрдХ рдХрддрд╛рд░ рд╕реЗ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ; </font><font style="vertical-align: inherit;">рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд┐рдЯрд░реНрди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ </font><font style="vertical-align: inherit;">рдХрд╛ рдЕрднрд╛рд╡ рд╣реИ </font><font style="vertical-align: inherit;">, рдЗрд╕рд▓рд┐рдП рдХреЙрд▓рд┐рдВрдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo_runner</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрднреА рднреА рд╢реБрд░реВ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпрд╣ рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЖрдк рд╣рдореЗрд╢рд╛ рдкреВрд░реНрд╡рд╡рдд рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рдмрд╕реЗ рдмрд╛рд╣рд░реА рджрд╛рдпрд░реЗ рдореЗрдВ рдЕрдкрд╡рд╛рдж рдХреЛ рдкрдХрдбрд╝реЗрдВ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> my_coro <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> asyncio.CancelledError: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">my_coro</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рдЕрдкрд╡рд╛рдж рдХреЛ рдкрдХрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдХреЙрд▓рд┐рдВрдЧ рдЪреИрдирд▓ рдХреЛ рдкреНрд░рдЪрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рд╡рд╣рд╛рдВ рдХрдмреНрдЬрд╛ рдХрд░ рд▓рд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред</font></font><br><br>  рдиреЛрдЯред<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рдХреЛрд░реНрдпреБрдЯрд┐рди рдХреЛ рдЕрдиреБрд╕реВрдЪрдХ рдХреЗ рдмрд╛рд╣рд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХреЙрдЙрдЯрдЖрдЙрдЯ рдХреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░реАрдмреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреЗрдВрдХрдиреЗ рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрд░реАрдХреЛрдВ рдХрд╛ </font><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдордирд╛ </font><font style="vertical-align: inherit;">рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рд╢реЗрдбреНрдпреВрд▓рд░ рдХреЛ рдХрдордЬрд╝реЛрд░ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рдХреЛрдб рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рднрд▓реЗ рд╣реА рд╡рд╣ рдЕрдиреБрд╕реВрдЪрд┐рдд рди рд╣реЛред рдЗрд╕рдХреЗ рдЕрд╡рд╛рдВрдЫрдиреАрдп рдкрд░рд┐рдгрд╛рдо рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.2.2</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдордпрдмрд╛рд╣реНрдп рдХреЗ </font><b><font style="vertical-align: inherit;">рд╕рд╛рде </font></b></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрдЖрдЙрдЯрдЖрдЙрдЯ uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐рдпреЛрдВ </font><font style="vertical-align: inherit;">рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдпрд╛ </font><b><font style="vertical-align: inherit;">рдЬрд╛рддрд╛</font></b><font style="vertical-align: inherit;"> рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.wait_for ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.wait_for_ms ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рд╡реЗ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ, рдХреНрд░рдорд╢рдГ рд╕реЗрдХрдВрдб рдпрд╛ рдПрдордПрд╕ рдореЗрдВ рдХреЛрд░рдЯрд╛рдЗрди рдФрд░ рд╡рд┐рд▓рдВрдмрддрд╛ рд▓реЗрддреЗ рд╣реИрдВред рдпрджрд┐ рд╕рдордп рд╕рдорд╛рдкреНрддрд┐ рдХреА рд╕рдордп рд╕реАрдорд╛ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддреЛ рдПрдХ рдЯрд╛рдЗрдордЖрдЙрдЯ </font><i><font style="vertical-align: inherit;">Error рдХреЛ pend_throw</font></i><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ </font><i><font style="vertical-align: inherit;">рдХреЙрд░рдЖрдЙрдЯ</font></i><font style="vertical-align: inherit;"> рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреЗрдВрдХ рджрд┐рдпрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд╛рдПрдЧрд╛</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдпрд╣ рдЕрдкрд╡рд╛рдж рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдпрд╛ рдХреЙрд▓рд░ рджреНрд╡рд╛рд░рд╛ рдкрдХрдбрд╝рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </font><font style="vertical-align: inherit;">рдпрд╣ рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рдХрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ: рдпрджрд┐ рд╕рдордп рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рд░рджреНрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдЬрдм рддрдХ рддреНрд░реБрдЯрд┐ рдХреЛ рдкрдХрдбрд╝рд╛ рдФрд░ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддрдм рддрдХ рдХреЙрд▓рд░ рдХреЛ рдЬрд╛рд░реА рд░рдЦрдиреЗ рдХрд╛ рдПрдХрдорд╛рддреНрд░ рддрд░реАрдХрд╛ рдЕрдкрд╡рд╛рдж рдХреЛ рдкрдХрдбрд╝рдирд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд╣рд╛рдВ рдЕрдкрд╡рд╛рдж рдХреЛ рдХреЛрд░рдЯрд╛рдЗрди рджреНрд╡рд╛рд░рд╛ рдкрдХрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛, рдореБрдЭреЗ рд╕реНрдкрд╖реНрдЯ рд╡рд┐рдлрд▓рддрд╛ рдирд╣реАрдВ рдереА рдЕрдЧрд░ рдмрд╛рд╣рд░реА рджрд╛рдпрд░реЗ рдореЗрдВ рдЕрдкрд╡рд╛рдж рдХреЛ рдирд╣реАрдВ рдкрдХрдбрд╝рд╛ рдЧрдпрд╛ рдерд╛, рдЬреИрд╕рд╛ рдХрд┐ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forever</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: print(<span class="hljs-string"><span class="hljs-string">'Starting'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep_ms(<span class="hljs-number"><span class="hljs-number">300</span></span>) print(<span class="hljs-string"><span class="hljs-string">'Got here'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> asyncio.TimeoutError: print(<span class="hljs-string"><span class="hljs-string">'Got timeout'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># And return async def foo(): await asyncio.wait_for(forever(), 5) await asyncio.sleep(2) loop = asyncio.get_event_loop() loop.run_until_complete(foo())</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдЖрдк рдХреЙрд▓рд┐рдВрдЧ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">forever</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">'Starting'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep_ms(<span class="hljs-number"><span class="hljs-number">300</span></span>) print(<span class="hljs-string"><span class="hljs-string">'Got here'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.wait_for(forever(), <span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> asyncio.TimeoutError: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> print(<span class="hljs-string"><span class="hljs-string">'Timeout elapsed.'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>) loop = asyncio.get_event_loop() loop.run_until_complete(foo())</code> </pre><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uasyncio v2.0 рдХреЗ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдП рдзреНрдпрд╛рди рджреЗрдВ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреЙрд▓ рд╕реЛрдХреЛрд▓реЛрд╡реНрд╕реНрдХреА</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fast_io рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдкрд░</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд╛рдЧреВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреЛрд░рдЯрд╛рдЗрди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рдВрдмреЗ рд╕рдордп рддрдХ рджреЗрд░реА рдХреЗ рд╕рд╛рде </font><i><font style="vertical-align: inherit;">asyncio.sleep (t) рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛</font></i><font style="vertical-align: inherit;"> рд╢реБрд░реВ рдХрд░ рджреЗрддрд╛ </font><font style="vertical-align: inherit;">рд╣реИ, рддреЛ coroutine рддрдм рддрдХ рдкреБрдирд░рд╛рд░рдВрдн рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдЬрдм рддрдХ рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ </font><font style="vertical-align: inherit;">ред рдпрджрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреАрдВрдж</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╕рдордп рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рддреЛ рдПрдХ рд╕рдордп </font><font style="vertical-align: inherit;">рд╕рдорд╛рдкреНрдд </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╣реЛ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд╛рдПрдЧрд╛, </font><font style="vertical-align: inherit;">рдЬрдм рдХреЛрд░рдЖрдЙрдЯ рдкреБрдирдГ рд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ - рдЕрд░реНрдерд╛рдд рдЬрдм </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд╛рдкреНрдд рд╣реЛ рд░рд╣рд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рдФрд░ рдХреЙрд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЗ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ, рдЙрд╕рдХреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ </font><font style="vertical-align: inherit;">рджреЗрд░реА рд╣реЛрдЧреАред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрджрд┐ рдпрд╣ рдЖрд╡реЗрджрди рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рддреЛ рд▓реВрдк рдореЗрдВ рдХрдо рд╕рдордп рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддреЗ рд╣реБрдП рдПрдХ рд▓рдВрдмреА рджреЗрд░реА рдмрдирд╛рдПрдВред coroutine</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyn.sleep рдЗрд╕рдХрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд╕рд╛рде</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╣рднрд╛рдЧрд┐рддрд╛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ рдмрд╛рд╣рд░реА рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдШрдЯрдирд╛рдУрдВ рдХреЗ </font><font style="vertical-align: inherit;">рдмреАрдЪ рдмрд╛рддрдЪреАрдд рдХрд╛ рдЖрдзрд╛рд░ </font><font style="vertical-align: inherit;">рдорддрджрд╛рди рд╣реИред рддреНрд╡рд░рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╡рд╛рд▓реЗ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдПрдХ рд░реБрдХрд╛рд╡рдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд▓реЗрдХрд┐рди рдЗрдВрдЯрд░рдкреНрдЯ рд░реБрдЯреАрди (ISR) рдФрд░ рдпреВрдЬрд░ рдХреЛрд░рдЖрдЙрдЯ рдХреЗ рдмреАрдЪ рдХреА рдмрд╛рддрдЪреАрдд рдЪреБрдирд╛рд╡ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реЛрдЧреАред рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ ISR </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдИрд╡реЗрдВрдЯ</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рдпрд╛ рдПрдХ рд╡реИрд╢реНрд╡рд┐рдХ рдзреНрд╡рдЬ рд╕реЗрдЯ </font><font style="vertical-align: inherit;">рдХрд░ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рдЬрдмрдХрд┐ рдПрдХ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдХрд░ рд░рд╣рд╛ рдПрдХ рдХреЛрд░ рд╣рд░ рдмрд╛рд░ рдПрдХ рдЕрдиреБрд░реЛрдз рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреВрдЫрддрд╛рдЫ рджреЛ рддрд░реАрдХреЛрдВ рд╕реЗ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ, рд╕реНрдкрд╖реНрдЯ рдпрд╛ рдирд┐рд╣рд┐рддред рдЙрддреНрддрд░рд╛рд░реНрджреНрдз </font><i><font style="vertical-align: inherit;">рдзрд╛рд░рд╛ I / O</font></i><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рддрдВрддреНрд░, рдЬреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UART</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЙрдХреЗрдЯ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреИрд╕реЗ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕рд┐рд╕реНрдЯрдо рд╣реИ </font><font style="vertical-align: inherit;">ред рд╕рд░рд▓рддрдо рд╕реНрдкрд╖реНрдЯ рд╕рд░реНрд╡реЗрдХреНрд╖рдг рдореЗрдВ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛрдб рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">poll_my_device</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> my_flag <span class="hljs-comment"><span class="hljs-comment">#   ISR while True: if my_flag: my_flag = False # service the device await asyncio.sleep(0)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдПрдХ рдЙрджрд╛рд╣рд░рдг рдЪрд░ рдХреЗ рд▓рд┐рдП рд╡реИрд╢реНрд╡рд┐рдХ рдзреНрд╡рдЬ, рддреЛ рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдШрдЯрдирд╛</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдВрддрдЬрд╛рд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдПрдХ рд╕реНрдкрд╖реНрдЯ рд╕рд░реНрд╡реЗрдХреНрд╖рдг рдиреАрдЪреЗ рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рд╣рд┐рдд рдорддрджрд╛рди рдореЗрдВ рдПрдХ рдЪрд╛рд▓рдХ рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ рдЬреЛ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ I / O рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░реЗрдЧрд╛, рдЬреИрд╕реЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UART</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font><i><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдо I / O </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЙрдХреЗрдЯ</font></font></i> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬреЛ </font><i><font style="vertical-align: inherit;">select.poll </font></i><b><font style="vertical-align: inherit;">рдкрд╛рдпрдерди</font></b><font style="vertical-align: inherit;"> рд╕рд┐рд╕реНрдЯрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ </font><font style="vertical-align: inherit;">рдорддрджрд╛рди рдХрд░рддрд╛ рд╣реИ: рдЪреВрдВрдХрд┐ C рдореЗрдВ рдорддрджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рддреЗрдЬреА рд╕реЗ рдФрд░ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИред рд╕реНрдкрд╖реНрдЯ рдорддрджрд╛рдиред рдзрд╛рд░рд╛ I / O рдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рдЪрд░реНрдЪрд╛ рдЦрдВрдб 6.3 рдореЗрдВ рдХреА рдЧрдИ рд╣реИред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i> <b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХреА рдкреНрд░рднрд╛рд╡рд╢реАрд▓рддрд╛ рдХреЗ рдХрд╛рд░рдг, рдирд┐рд╣рд┐рдд рдорддрджрд╛рди рд╕рдмрд╕реЗ рддреЗрдЬрд╝ I / O рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рдПрдХ рдлрд╛рдпрджрд╛ рджреЗрддрд╛ рд╣реИ: рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рдХрдИ рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдорддреМрд░ рдкрд░ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдирд╣реАрдВ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред рдЗрд╕ рдкрд░ рдЦрдВрдб 6.4 рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.1 рд╕рд┐рдВрдХ рдореБрджреНрджреЗ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЛрдиреЛрдВ рд╕реНрдкрд╖реНрдЯ рдФрд░ рдирд┐рд╣рд┐рдд рдЪреБрдирд╛рд╡ рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдЪрдХреНрд░реАрдп рдпреЛрдЬрдирд╛ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИрдВред рдорд╛рди рд▓реАрдЬрд┐рдП рдХрд┐ I / O рдПрдХ рд╕рд╛рде рдПрди рдХрд╕реНрдЯрдо рдХреЛрд░рдЖрдЙрдЯреНрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рд╢реВрдиреНрдп рд╡рд┐рд▓рдВрдм рд╕реЗ рдЪрд▓рддрд╛ рд╣реИред рдЬрдм I / O рдкрд░реЛрд╕рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рд╕рднреА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрдЪрд╛рд▓рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реЛрддреЗ рд╣реА рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рдорддрджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдбрд┐рдЬрд╛рдЗрди рдХрд░рддреЗ рд╕рдордп рдЕрдиреБрдорд╛рдирд┐рдд рджреЗрд░реА рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред рдореБрдЭреЗ / рдУ рдЪреИрдирд▓реЛрдВ рдХреЛ рдмрдлрд╝рд░рд┐рдВрдЧ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЖрдИрдПрд╕рдЖрд░ рд╕рд░реНрд╡рд┐рд╕рд┐рдВрдЧ рдЙрдкрдХрд░рдг рдХреЗ рд╕рд╛рде рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдореЗрдВ рдмрдлрд╝рд░ рдФрд░ рдХреЛрд░рдЯрд╛рдЗрди рд╕реЗ, рднрд░рд╛рд╡ рд╕рдордп рдкрд░ рдмрдлрд╝рд░ рднрд░рдиреЗ рдпрд╛ рдореБрдХреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд░реЗ рдЬрд╛рдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛ рднреА рдЖрд╡рд╢реНрдпрдХ рд╣реИ: рдпрд╣ рд╡рд╣ рд╕реНрдерд┐рддрд┐ рд╣реИ рдЬрдм рдХреЛрд░рдЯрд╛рдЗрди рджреНрд╡рд╛рд░рд╛ рдкреВрдЫрддрд╛рдЫ рдХреА рдЬрд╛рдиреЗ рд╡рд╛рд▓реА рдЪреАрдЬ рдХреЛ рдХреЛрд░рдЯрд╛рдЗрди рджреНрд╡рд╛рд░рд╛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпреЛрдЬрдирд╛рдмрджреНрдз рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рд╣реЛрддрд╛ рд╣реИред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдФрд░ рд╕рдордп рдореБрджреНрджрд╛ рд╡рд┐рд▓рдВрдмрддрд╛ рд╕рдЯреАрдХрддрд╛ рд╣реИред рдЕрдЧрд░ рдХреЛрд░рдЯрд╛рдЗрди рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИ</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep_ms ( t ) <span class="hljs-comment"><span class="hljs-comment">#  </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реЗрдбреНрдпреВрд▓рд░ рдЧрд╛рд░рдВрдЯреА рджреЗрддрд╛ рд╣реИ рдХрд┐ рдирд┐рд╖реНрдкрд╛рджрди рдХрдо рд╕реЗ рдХрдо t ms рдХреЗ рд▓рд┐рдП рдирд┐рд▓рдВрдмрд┐рдд рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╡рд┐рд▓рдВрдм рдЯреА рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рд╡рд░реНрддрдорд╛рди рд╕рд┐рд╕реНрдЯрдо рд▓реЛрдб рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред рдпрджрд┐ рдЗрд╕ рд╕рдордп рдЕрдиреНрдп рдХреЛрд░рд╛рдЙрдЯреАрди рдЧреИрд░-рд╢реВрдиреНрдп рджреЗрд░реА рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ, рддреЛ рдЕрдЧрд▓реА рдкрдВрдХреНрддрд┐ рдХреЛ рддреБрд░рдВрдд рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдЕрдиреНрдп рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рднреА рдирд┐рд╖реНрдкрд╛рджрди рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рд╣реИ (рдпрд╛ рддреЛ рдХреНрдпреЛрдВрдХрд┐ рдЙрдиреНрд╣реЛрдВрдиреЗ рд╢реВрдиреНрдп рджреЗрд░реА рд╕реЗ рдЙрддреНрд╕рд░реНрдЬрди рдХрд┐рдпрд╛, рдпрд╛ рдХреНрдпреЛрдВрдХрд┐ рдЙрдирдХрд╛ рд╕рдордп рднреА рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛ рд╣реИ), рд╡реЗ рдкрд╣рд▓реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреАрдВрдж ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sleep_ms ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛рд░реНрдпреЛрдВ </font><font style="vertical-align: inherit;">рдореЗрдВ рд╕рд┐рдВрдХреНрд░рдирд╛рдЗрдЬрд╝реЗрд╢рди рдЕрдирд┐рд╢реНрдЪрд┐рддрддрд╛ рдХрд╛ рдкрд░рд┐рдЪрдп рджреЗрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЗрд╕ рдЕрддрд┐рдкреНрд░рд╡рд╛рд╣ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рдореВрд▓реНрдп рдХреА рдЧрдгрдирд╛ рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕рднреА рдХреЛрд░рд╛рдЙрдЯреАрди рдХреЗ рд░рдирдЯрд╛рдЗрдо рдореВрд▓реНрдпреЛрдВ рдХреЛ рд╕рдорд╛рдкрдХ рджреНрд╡рд╛рд░рд╛ рд╕рдмрд╕реЗ рдЦрд░рд╛рдм рд╕реНрдерд┐рддрд┐ рд╕рдВрдЪрд░рдг рд╕рдордп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fast_io</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрд╕реНрдХрд░рдг </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рдЗрд╕ рд╕рдВрджрд░реНрдн рдПрдХ рддрд░реАрдХрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рд╣реИ рдХрд┐ рдзрд╛рд░рд╛ рдЖрдИ / рдУ рдЕрдиреБрд╕реВрдЪрдХ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдпрд╛рддреНрд░рд╛ рдкрд░ рдкрд░рд╛рдорд░реНрд╢ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд┐рдпрдд рд╕рдордп рдореЗрдВ рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рд╕рдВрд╢реЛрдзрдиреЛрдВ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░реЗрдВрдЧреЗред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.2 рдХреЛрд░рдЯрд╛рдЗрдиреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЙрдкрдХрд░рдгреЛрдВ рд╕реЗ рдкреВрдЫрддрд╛рдЫ рдХрд░рдирд╛</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╣ рдПрдХ рд╕рд░рд▓ рддрд░реАрдХрд╛ рд╣реИ рдЬреЛ рдЙрди рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЙрдкрдпреБрдХреНрдд рд╣реИ рдЬрд┐рдиреНрд╣реЗрдВ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдХрдо рдЧрддрд┐ рд╕реЗ рдкреВрдЫрддрд╛рдЫ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИред рдпрд╣ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдПрдХ рдЫреЛрдЯреЗ (рдпрд╛ рд╢реВрдиреНрдп) рдорддрджрд╛рди рдЕрдВрддрд░рд╛рд▓ рдХреЗ рд╕рд╛рде рдорддрджрд╛рди рдЗрд╕ рддрдереНрдп рдХреЛ рдЬрдиреНрдо рджреЗ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреЛрд░рдЯрд╛рдЙрди рдЕрдВрддрд░рд╛рд▓ рдореЗрдВ рдЧрд┐рд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдкреНрд░реЛрд╕реЗрд╕рд░ рд╕рдордп рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд╛рдВрдЫрдиреАрдп рд╣реИред </font><i><b><font style="vertical-align: inherit;">Apoll.py</font></b></i></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрджрд╛рд╣рд░рдг </font><b><font style="vertical-align: inherit;">Pyboard</font></b><font style="vertical-align: inherit;"> рдПрдХреНрд╕реЗрд▓реЗрд░реЛрдореАрдЯрд░ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдХреЗ рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд </font><b><font style="vertical-align: inherit;">рдХрд░рддрд╛</font></b><font style="vertical-align: inherit;"> рд╣реИ</font></font><i><b><font style="vertical-align: inherit;"></font></b></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100 рдПрдордПрд╕ рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдХреЗ рд╕рд╛рдеред рдпрд╣ рд╢реЛрд░ рдХреЛ рдЕрдирджреЗрдЦрд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд░рд▓ рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рд╣рд░ рджреЛ рд╕реЗрдХрдВрдб рдореЗрдВ рдПрдХ рд╕рдВрджреЗрд╢ рдкреНрд░рд┐рдВрдЯ рдХрд░рддрд╛ рд╣реИ рдпрджрд┐ рдХреЛрдИ рдЖрдВрджреЛрд▓рди рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред </font><i><b><font style="vertical-align: inherit;">Aswitch.py</font></b></i></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрджрд╛рд╣рд░рдг </font><font style="vertical-align: inherit;">рд╕реНрд╡рд┐рдЪ рдФрд░ рдмрдЯрди рдЙрдкрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдбреНрд░рд╛рдЗрд╡рд░ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд▓рд┐рдП рдПрдХ рдЙрджрд╛рд╣рд░рдг рдбреНрд░рд╛рдЗрд╡рд░ рдиреАрдЪреЗ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкрд░реАрдХреНрд╖рдг рдореЗрдВ рдЖрд╕рд╛рдиреА рдХреЗ рд▓рд┐рдП, </font><b><font style="vertical-align: inherit;">Pyboard</font></b><font style="vertical-align: inherit;"> UART 4 тАЛтАЛрдПрдХ рд╕рд╢рд░реНрдд рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИред рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ </font><b><i><font style="vertical-align: inherit;">RecordOrientedUart</font></i></b><font style="vertical-align: inherit;"> рд╡рд░реНрдЧ</font></font><i><b><font style="vertical-align: inherit;"></font></b></i><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><i><font style="vertical-align: inherit;"></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрд┐рд╕рдореЗрдВ рдмрд╛рдЗрдЯ рдЙрджрд╛рд╣рд░рдгреЛрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдЪрд░-рд▓рдВрдмрд╛рдИ рдХреЗ рд░рд┐рдХреЙрд░реНрдб рдореЗрдВ рдбреЗрдЯрд╛ рдХреА рдЖрдкреВрд░реНрддрд┐ рдХреА рдЬрд╛рддреА рд╣реИред рдСрдмреНрдЬреЗрдХреНрдЯ рднреЗрдЬрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдПрдХ рд╕реАрдорд╛рдВрдХрдХ рдЬреЛрдбрд╝рддрд╛ рд╣реИ рдФрд░ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдбреЗрдЯрд╛ рдХреЛ рдмрдлрд╝рд░ рдХрд░рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рдПрдХ рдЬреЛрдбрд╝рд╛ рд╕реАрдорд╛рдВрдХрдХ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ UART рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╕рд┐рд░реНрдл рдПрдХ рдбреЗрдореЛ рдФрд░ рдПрдХ рдЕрдХреНрд╖рдо рддрд░реАрдХрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЙрддреНрд╕рд░реНрдЬрд┐рдд рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕рддреНрдпрд╛рдкрди рдХрд╛ рдПрдХ рд╕рд╛рдзрди рд╣реИ рдХрд┐ рд╣рд╕реНрддрд╛рдВрддрд░рдг рдкреВрд░рд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЖрд╡реЗрджрди рдХреЛ рд╣рдореЗрдВ рдЗрдВрддрдЬрд╛рд░ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рдХреЛрдИ рднреА рдзрд╛рд░рдгрд╛ рд╕рд╣реА рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЛрдб </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio.sleep (0.1) рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд░рдХреЗ рдЗрд╕реЗ рдирдХрд▓реА рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pyboard</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> X1 рдФрд░ X2 (UART Txd рдФрд░ Rxd) </font><font style="vertical-align: inherit;">рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХрдиреЗрдХреНрдЯ рдХрд░рдирд╛ рди рднреВрд▓реЗрдВ</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyb <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UART <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RecordOrientedUart</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> DELIMITER = <span class="hljs-string"><span class="hljs-string">b'\0'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.uart = UART(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9600</span></span>) self.data = <span class="hljs-string"><span class="hljs-string">b''</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Not __await__ issue #2678 data = b'' while not data.endswith(self.DELIMITER): yield from asyncio.sleep(0) # ,  : while not self.uart.any(): yield from asyncio.sleep(0) # timing may mean this is never called data = b''.join((data, self.uart.read(self.uart.any()))) self.data = data async def send_record(self, data): data = b''.join((data, self.DELIMITER)) self.uart.write(data) await self._send_complete() #          #        await asyncio.sleep(0) async def _send_complete(self): await asyncio.sleep(0.1) def read_record(self): # Synchronous: await the object before calling return self.data[0:-1] # Discard delimiter async def run(): foo = RecordOrientedUart() rx_data = b'' await foo.send_record(b'A line of text.') for _ in range(20): await foo #  coros       foo rx_data = foo.read_record() print('Got: {}'.format(rx_data)) await foo.send_record(rx_data) rx_data = b'' loop = asyncio.get_event_loop() loop.run_until_complete(run())</span></span></code> </pre><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.3 рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рддрдВрддреНрд░ ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрджрд╛рд╣рд░рдг </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pyboard</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рдЗрдХреНрд░реЛрдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рдПрдХ UART рдкрд░ рдПрдХ рд╕рд╛рде рдЗрдирдкреБрдЯ-рдЖрдЙрдЯрдкреБрдЯ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pyboard</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> X1 рдФрд░ X2 (UART Txd рдФрд░ Rxd) </font><font style="vertical-align: inherit;">рдХреЗ рдЖрдЙрдЯрдкреБрдЯ рдХрдиреЗрдХреНрдЯ рдХрд░реЗрдВ</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyb <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UART uart = UART(<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">9600</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sender</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> swriter = asyncio.StreamWriter(uart, {}) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> swriter.awrite(<span class="hljs-string"><span class="hljs-string">'Hello uart\n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">receiver</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> sreader = asyncio.StreamReader(uart) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: res = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> sreader.readline() print(<span class="hljs-string"><span class="hljs-string">'Received'</span></span>, res) loop = asyncio.get_event_loop() loop.create_task(sender()) loop.create_task(receiver()) loop.run_forever()</code> </pre><br><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">Uasyncio</font></b><font style="vertical-align: inherit;"> рд▓рд╛рдЗрдмреНрд░реЗрд░реА </font><font style="vertical-align: inherit;">рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__init__.py</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ </font><font style="vertical-align: inherit;">рд╕рдкреЛрд░реНрдЯрд┐рдВрдЧ рдХреЛрдб рдорд┐рд▓ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рддрдВрддреНрд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ ( </font><b><font style="vertical-align: inherit;">C</font></b><font style="vertical-align: inherit;"> рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ </font><font style="vertical-align: inherit;">) рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ: </font><i><font style="vertical-align: inherit;">ioctl, read, readline</font></i><font style="vertical-align: inherit;"> рдФрд░ </font><i><font style="vertical-align: inherit;">write</font></i><font style="vertical-align: inherit;"> ред </font><font style="vertical-align: inherit;">рдзрд╛рд░рд╛ 6.4: рдПрдХ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рд▓рд┐рдЦрдиреЗ рд╕реЗ рдпрд╣ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдРрд╕реЗ рдбреНрд░рд╛рдЗрд╡рд░ </font><b><font style="vertical-align: inherit;">рдкрд╛рдпрдерди</font></b><font style="vertical-align: inherit;"> рдореЗрдВ рдХреИрд╕реЗ рд▓рд┐рдЦреЗ рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UART рдХрд┐рд╕реА рднреА рд╕рдордп рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред рдЬрдм рднреА рд╢реЗрдбреНрдпреВрд▓рд░ рд▓рд╛рдн рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдиреЗ рд╡рд╛рд▓реЗ рд▓рдВрдмрд┐рдд рд╡рд░реНрдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ I / O рддрдВрддреНрд░ рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИред рдЬрдм рдХреЛрд░рд╛рдЙрдЯрд┐рди рдЪрд▓ рд░рд╣рд╛ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдмрд╛рдзрд┐рдд рджрд┐рдирдЪрд░реНрдпрд╛ рдмрдлрд╝рд░ рдЖрдиреЗ рд╡рд╛рд▓реЗ рдкрд╛рддреНрд░реЛрдВ; рдЬрдм рдХреЛрд░рд╛рдЙрдЯ рдЕрдиреБрд╕реВрдЪрдХ рдХреЛ рд░рд╛рд╕реНрддрд╛ рджреЗрддрд╛ рд╣реИ рддреЛ рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдЗрд╕рд▓рд┐рдП, UART рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рддрд╛рдХрд┐ рдХреЙрдЙрдЯрд░ рдмрдлрд░ рд╢реЗрдбреНрдпреВрд▓ рдФрд░ рдбреЗрдЯрд╛ рд╣рд╛рдирд┐ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд╕реВрдЪрдХ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рдХреЗ рдмреАрдЪ рдХреЗ рд╕рдордп рдХреЛ рдХрдо рдХрд░ рджреЗрдВред рдпрд╣ рдПрдХ рдмрдбрд╝реЗ UART рд░реАрдб рдмрдлрд░, рдпрд╛ рдХрдо рдбреЗрдЯрд╛ рджрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдзрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдкреНрд░рд╡рд╛рд╣ рдирд┐рдпрдВрддреНрд░рдг рдПрдХ рд╕рдорд╛рдзрд╛рди рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ рдпрджрд┐ рдбреЗрдЯрд╛ рд╕реНрд░реЛрдд рдЗрд╕рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.3.1 UART рдХреЗ рдбреНрд░рд╛рдЗрд╡рд░ рдХрд╛ рдЙрджрд╛рд╣рд░рдг</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛рд░реНрдпрдХреНрд░рдо </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">auart_hd.py</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдЖрдзрд╛-рджреНрд╡реИрдз рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рд╡рд┐рдзрд┐ рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдПрдЯреА рдореЙрдбреЗрдо рдХрдорд╛рдВрдб рд╕реЗрдЯ рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдиреЗ рд╡рд╛рд▓рд╛ рдЙрдкрдХрд░рдгред рд╣рд╛рдл рдбреБрдкреНрд▓реЗрдХреНрд╕ рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдбрд┐рд╡рд╛рдЗрд╕ рдХрднреА рднреА рдЕрд╡рд╛рдВрдЫрд┐рдд рдбреЗрдЯрд╛ рдирд╣реАрдВ рднреЗрдЬрддрд╛ рд╣реИ: рдЗрд╕рдХреЗ рд╕реНрдерд╛рдирд╛рдВрддрд░рдг рд╣рдореЗрд╢рд╛ рдорд╛рд╕реНрдЯрд░ рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдЖрджреЗрд╢ рдХреЗ рдЬрд╡рд╛рдм рдореЗрдВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рджреЛ рд╡рд╛рдпрд░реНрдб рдХрдиреЗрдХреНрд╢рдиреЛрдВ рдХреЗ рд╕рд╛рде </font><b><font style="vertical-align: inherit;">рдкрд╛рдЗрдмреЛрд░реНрдб</font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкрд░ рдПрдХ рдкрд░реАрдХреНрд╖рдг рдЪрд▓рд╛рдХрд░ рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">(рдмрд╣реБрдд рд╣реА рд╕рд░рд▓реАрдХреГрдд) рдЙрддреНрд╕рд░реНрдЬрд┐рдд рдбрд┐рд╡рд╛рдЗрд╕ рдзреАрдореА рдХрдорд╛рдВрдб рдХреЛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рдмреАрдЪ рдард╣рд░рд╛рд╡ рдХреЗ рд╕рд╛рде рдбреЗрдЯрд╛ рдХреА рдЪрд╛рд░ рд▓рд╛рдЗрдиреЗрдВ рднреЗрдЬрдХрд░ рдХрд┐рд╕реА рднреА рдЖрджреЗрд╢ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИред</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд┐рдЬрд╝рд╛рд░реНрдб рдПрдХ рдХрдорд╛рдВрдб рднреЗрдЬрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдкрд╣рд▓реЗ рд╕реЗ рдкрддрд╛ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдбреЗрдЯрд╛ рдХреА рдХрд┐рддрдиреА рдкрдВрдХреНрддрд┐рдпреЛрдВ рдХреЛ рд╡рд╛рдкрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ рдПрдХ рдкреБрдирд░рд╛рд░рдВрдн рдЯрд╛рдЗрдорд░ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╣рд░ рдмрд╛рд░ рдПрдХ рдкрдВрдХреНрддрд┐ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рдкрд░ рдкреБрдирд░рд╛рд░рдВрдн рд╣реЛрддрд╛ рд╣реИред рдЬрдм рдЯрд╛рдЗрдорд░ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдбрд┐рд╡рд╛рдЗрд╕ рдиреЗ рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди рдкреВрд░рд╛ рдХрд░ рд▓рд┐рдпрд╛ рд╣реИ рдФрд░ рдкреНрд░рд╛рдкреНрдд рд▓рд╛рдЗрдиреЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рд╡рд╛рдкрд╕ рдЖ рдЧрдИ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдЙрдкрдХрд░рдг рд╡рд┐рдлрд▓рддрд╛ рдХрд╛ рдорд╛рдорд▓рд╛ рднреА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЯреНрд░рд╛рдВрд╕рдорд┐рд╢рди рдХреЛ рд╕реНрдХрд┐рдк рдХрд░рдХреЗ рд╣рд╛рд╕рд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред рд╕рдордп рд╕рдорд╛рдкреНрдд рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж, рдПрдХ рдЦрд╛рд▓реА рд╕реВрдЪреА рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рддреА рд╣реИред рдЕрдзрд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдХреЛрдб рдЯрд┐рдкреНрдкрдгрд┐рдпрд╛рдВ рджреЗрдЦреЗрдВред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдХреЗ 6.4 рд╡рд┐рдХрд╛рд╕ (рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдо</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) рдЗрдХрд╛рдИ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдзрд╛рд░рд╛ рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рддрдВрддреНрд░ ( </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдИ / рдУ рд╕реНрдЯреНрд░реАрдо</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП) рдореИрдВ / рдЗрд╕ рддрд░рд╣ рдХреЗ UART рдФрд░ рд╕реЙрдХреЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЗ рдЙрдкрдХрд░рдгреЛрдВ ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЙрдХреЗрдЯ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)ред рддрдВрддреНрд░ рдХрд┐рд╕реА рднреА рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдорддрджрд╛рди рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ </font><font style="vertical-align: inherit;">рдХрддрд╛рд░ рдореЗрдВ рдХрд┐рд╕реА рднреА рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рддрддреНрдкрд░рддрд╛ рдХреЛ рдорддрджрд╛рди </font><font style="vertical-align: inherit;">рдХрд╛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрдпрди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд░рддреЗ рд╣реБрдП рд╢реЗрдбреНрдпреВрд▓рд░ рдХреЛ рд╕реМрдВрдкрдХрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдпрд╣ рдХрдИ coroutine рд╕рдВрдЪрд╛рд▓рди рдХрд░рдиреЗ рд╕реЗ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдкреЛрд▓ рдХрд░рддрд╛ рд╣реИ, рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдХреНрдпреЛрдВрдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЪрдпрди </font></font></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ </font><b><font style="vertical-align: inherit;">рд╣реИ</font></b><font style="vertical-align: inherit;"> , рдФрд░ рдпрд╣ рднреА рдХреНрдпреЛрдВрдХрд┐ рдорддрджрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдХреЛрд░рдЖрдЙрдЯ рдХреЛ рд╡рд┐рд▓рдВрдмрд┐рдд рд╕реНрдерд┐рддрд┐ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдореЗрдВ рджреЗрд░реА рд╣реЛрддреА рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рддрдВрддреНрд░ рдХреЛ рд╕рд░реНрд╡рд┐рд╕ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдПрдХ рдбрд┐рд╡рд╛рдЗрд╕ рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ рдмреЗрд╣рддрд░ рддрд░реАрдХреЗ рд╕реЗ </font><i><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдорд░рд╛рдЗрдбрд░, рд╕реНрдЯреНрд░реАрдорд╡рд┐рдЯрд░ рдХрд╛</font></i><font style="vertical-align: inherit;"> рд╕рдорд░реНрдерди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рдПрдХ рдкрдардиреАрдп рдбрд┐рд╡рд╛рдЗрд╕ рдХреЛ рдХрдо рд╕реЗ рдХрдо рдПрдХ рд╡рд┐рдзрд┐ рдкреНрд░рджрд╛рди рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпреЗ рд╕рдордХрд╛рд▓рд┐рдХ рддрд░реАрдХреЗ рд╣реИрдВред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ioctl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">(рдиреАрдЪреЗ рджреЗрдЦреЗрдВ) рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдЙрдиреНрд╣реЗрдВ рдХреЗрд╡рд▓ рдбреЗрдЯрд╛ рдЙрдкрд▓рдмреНрдз рд╣реЛрдиреЗ рдкрд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдирд╛ рдбреЗрдЯрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рдЬрд┐рддрдиреА рдЬрд▓реНрджреА рд╣реЛ рд╕рдХреЗ рд╡рд╛рдкрд╕ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">readline ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд┐рддрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЙрддрдиреЗ рд╡рд░реНрдг рд▓реМрдЯрд╛рдПрдВ, рдХрд┐рд╕реА рднреА newline рд╡рд░реНрдг рддрдХред рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StreamReader.readline () </font></font></i> <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрдврд╝реЗ (n)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдзрд┐рдХ рд╕реЗ рдЕрдзрд┐рдХ рд╡рд░реНрдг рд▓реМрдЯрд╛рдПрдВ, рд▓реЗрдХрд┐рди </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЗ рдЕрдзрд┐рдХ рдирд╣реАрдВ </font><font style="vertical-align: inherit;">ред рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рддреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">StreamReader.read ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font><i><font style="vertical-align: inherit;">StreamReader.readexactly ()</font></i><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░</font></font><i><font style="vertical-align: inherit;"></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрдирд╛рдП рдЧрдП рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ рддрддреНрдХрд╛рд▓ рд░рд┐рдЯрд░реНрди рдХреЗ рд╕рд╛рде рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд╡рд┐рдзрд┐ рдкреНрд░рджрд╛рди рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП: </font><font style="vertical-align: inherit;">рддрд░реНрдХреЛрдВ рдХреЗ рд╕рд╛рде </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рд┐рдЦрдирд╛ </font></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, рдмрдВрдж рдХрд░рдирд╛, sz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╣рд╛рдВ: </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buf</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдмрдлрд░ рд╣реИред </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмрдВрдж</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рдЪрд░рд┐рддреНрд░ рдХреЗ рдмрдлрд░ рдкрд░ рдСрдлрд╕реЗрдЯред </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sz</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд░реНрдгреЛрдВ рдХреА рдЕрдиреБрд░реЛрдзрд┐рдд рд╕рдВрдЦреНрдпрд╛ред </font></font><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рд┐рдЯрд░реНрди рд╡реИрд▓реНрдпреВ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рд╡рд░реНрдгреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рд╣реИ (рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдбрд┐рд╡рд╛рдЗрд╕ рдзреАрдорд╛ рд╣реЛрдиреЗ рдкрд░ 1)ред </font><i><font style="vertical-align: inherit;">Ioctl</font></i></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ </font><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдпрд╣ рдХреЗрд╡рд▓ рддрднреА рдХрд╣рд╛ рдЬрд╛рдПрдЧрд╛ рдЬрдм рдбрд┐рд╡рд╛рдЗрд╕ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рд╣реЛред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><cut></cut><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рднреА рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioctl</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ рдкреНрд░рджрд╛рди рдХрд░рдиреА рдЪрд╛рд╣рд┐рдП </font><font style="vertical-align: inherit;">рдЬреЛ рдЗрд╕рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рдорддрджрд╛рди рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдкрдврд╝рдиреЗ / рд▓рд┐рдЦрдиреЗ рд╡рд╛рд▓реЗ рдбреНрд░рд╛рдЗрд╡рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрджрд╛рд╣рд░рдг:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io MP_STREAM_POLL_RD = const(<span class="hljs-number"><span class="hljs-number">1</span></span>) MP_STREAM_POLL_WR = const(<span class="hljs-number"><span class="hljs-number">4</span></span>) MP_STREAM_POLL = const(<span class="hljs-number"><span class="hljs-number">3</span></span>) MP_STREAM_ERROR = const(<span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyIO</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(io.IOBase)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    def ioctl(self, req, arg): # see ports/stm32/uart.c ret = MP_STREAM_ERROR if req == MP_STREAM_POLL: ret = 0 if arg &amp; MP_STREAM_POLL_RD: if hardware_has_at_least_one_char_to_read: ret |= MP_STREAM_POLL_RD if arg &amp; MP_STREAM_POLL_WR: if hardware_can_accept_at_least_one_write_character: ret |= MP_STREAM_POLL_WR return ret</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд </font></font><b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд┐рд▓рд┐рд╕рдЯреЗрдХрдорд░</font></font></i></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрд▓рд╛рд╕ </font><font style="vertical-align: inherit;">рд╡реЗрдЯрд┐рдВрдЧ рджреЗрд░реА </font><font style="vertical-align: inherit;">рдХрд╛ рд╡рд┐рд╡рд░рдг рд╣реИ </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> utime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io MP_STREAM_POLL_RD = const(<span class="hljs-number"><span class="hljs-number">1</span></span>) MP_STREAM_POLL = const(<span class="hljs-number"><span class="hljs-number">3</span></span>) MP_STREAM_ERROR = const(<span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MillisecTimer</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(io.IOBase)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.end = <span class="hljs-number"><span class="hljs-number">0</span></span> self.sreader = asyncio.StreamReader(self) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> self.sreader.readline() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, ms)</span></span></span><span class="hljs-function">:</span></span> self.end = utime.ticks_add(utime.ticks_ms(), ms) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readline</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">b'\n'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ioctl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, req, arg)</span></span></span><span class="hljs-function">:</span></span> ret = MP_STREAM_ERROR <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> req == MP_STREAM_POLL: ret = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> arg &amp; MP_STREAM_POLL_RD: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> utime.ticks_diff(utime.ticks_ms(), self.end) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>: ret |= MP_STREAM_POLL_RD <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">timer_test</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( n )</span></span></span><span class="hljs-function">:</span></span> timer = ms_timer.MillisecTimer () <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> timer ( <span class="hljs-number"><span class="hljs-number">30</span></span> ) <span class="hljs-comment"><span class="hljs-comment">#  30 </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдзрд┐рдХрд╛рд░рд┐рдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio рдХреА</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддреБрд▓рдирд╛ рдореЗрдВ </font><b><font style="vertical-align: inherit;">, </font></b></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio.sleep_ms ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ </font><i><font style="vertical-align: inherit;">рдЗрдВрддрдЬрд╛рд░</font></i><font style="vertical-align: inherit;"> рдХрд░рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕реЗ рдХреЛрдИ рд▓рд╛рдн рдирд╣реАрдВ рдорд┐рд▓рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fast_io</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ </font><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рдЙрдкрдпреЛрдЧ рдкреИрдЯрд░реНрди рдореЗрдВ рдХрд╛рдлреА рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд╡рд┐рд▓рдВрдм рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрдм рдХреЛрд░рдЯрд╛рдЗрди рд╢реВрдиреНрдп рд╡рд┐рд▓рдВрдм рдХреА рдЙрдореНрдореАрдж рдХрд░рддреЗ рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдк рдХреЙрд▓рдмреИрдХ рдХреЗ рд╕рд╛рде рдХрд┐рд╕реА рдИрд╡реЗрдВрдЯ рдХреЛ рд╕рдВрдмрджреНрдз рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП I / O рд╢реЗрдбреНрдпреВрд▓рд┐рдВрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рдпрд╣ рдорддрджрд╛рди рдЪрдХреНрд░ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ioctl рдХреЗ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддреИрдпрд╛рд░ </font><font style="vertical-align: inherit;">рд╣реЛрдиреЗ рддрдХ рдорддрджрд╛рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЕрдЧрд▓рд╛, рдХреЙрд▓рдмреИрдХ рд╕реНрдерд┐рддрд┐ рдмрджрд▓рдиреЗ рдкрд░ рдХреЙрд▓рдмреИрдХ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рд╣реЛрддрд╛ рд╣реИред</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io MP_STREAM_POLL_RD = const(<span class="hljs-number"><span class="hljs-number">1</span></span>) MP_STREAM_POLL = const(<span class="hljs-number"><span class="hljs-number">3</span></span>) MP_STREAM_ERROR = const(<span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PinCall</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(io.IOBase)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, pin, *, cb_rise=None, cbr_args=</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span><span class="hljs-function"><span class="hljs-params">, cb_fall=None, cbf_args=</span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"><span class="hljs-params">()</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.pin = pin self.cb_rise = cb_rise self.cbr_args = cbr_args self.cb_fall = cb_fall self.cbf_args = cbf_args self.pinval = pin.value() self.sreader = asyncio.StreamReader(self) loop = asyncio.get_event_loop() loop.create_task(self.run()) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> self.sreader.read(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, _)</span></span></span><span class="hljs-function">:</span></span> v = self.pinval <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> self.cb_rise <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: self.cb_rise(*self.cbr_args) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">b'\n'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> v <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> self.cb_fall <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: self.cb_fall(*self.cbf_args) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">b'\n'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ioctl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, req, arg)</span></span></span><span class="hljs-function">:</span></span> ret = MP_STREAM_ERROR <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> req == MP_STREAM_POLL: ret = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> arg &amp; MP_STREAM_POLL_RD: v = self.pin.value() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> v != self.pinval: self.pinval = v ret = MP_STREAM_POLL_RD <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ret</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдФрд░ рдлрд┐рд░ рд╕реЗ - рдЖрдзрд┐рдХрд╛рд░рд┐рдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio рдкрд░,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреЗрд░реА рдЕрдзрд┐рдХ рд╣реЛ рд╕рдХрддреА рд╣реИред рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдбрд┐рдЬрд╝рд╛рдЗрди рдХреЗ рдЖрдзрд╛рд░ рдкрд░, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fast_io</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рдВрд╕реНрдХрд░рдг </font><font style="vertical-align: inherit;">рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рджрд░реНрд╢рди рдХрд╛рд░реНрдпрдХреНрд░рдо </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iorw.py</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╢реЛ рдкреВрд░реНрдг рдЙрджрд╛рд╣рд░рдгред рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ рд▓реЗрдЦ рд▓рд┐рдЦрдиреЗ рдХреЗ рд╕рдордп </font><font style="vertical-align: inherit;">рдПрдХ рддреНрд░реБрдЯрд┐ рд╣реИ рдЬрд┐рд╕рдХреЗ рдХрд╛рд░рдг рдпрд╣ </font></font><a href="http://github.com/micropython/pull/3836" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рджреЛ рдЙрдкрд╛рдп рд╣реИрдВред рд╡рд░реНрдХрдЕрд░рд╛рдЙрдВрдб рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдбреНрд░рд╛рдЗрд╡рд░реЛрдВ рдХреЛ рд▓рд┐рдЦрдирд╛ рд╣реИ, рдПрдХ рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдФрд░ рдПрдХ рдХреЗрд╡рд▓ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИред рджреВрд╕рд░рд╛ рд╣реИ </font></font><a href="" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fast_io</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ </font><a href="" rel="nofollow"><b><font style="vertical-align: inherit;">рдХрд░рдирд╛</font></b></a><font style="vertical-align: inherit;"> , рдЬреЛ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрдзрд┐рдХрд╛рд░рд┐рдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio рдореЗрдВ,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрдирдкреБрдЯ / рдЖрдЙрдЯрдкреБрдЯ рдХреА рдпреЛрдЬрдирд╛ рдХрд╛рдлреА </font></font><a href="http://github.com/micropython/micropython/issues/2664" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреБрд░реНрд▓рдн рд╣реИ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6.5 рдкреВрд░реНрдг рдЙрджрд╛рд╣рд░рдг: aremote.py</font></font></b> <br><br> <a href="" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреНрд░рд╛рдЗрд╡рд░ рдХреЛ</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рдЕрд╡рд░рдХреНрдд рд░рд┐рдореЛрдЯ рдХрдВрдЯреНрд░реЛрд▓ рд╕реЗ рд╕рд┐рдЧреНрдирд▓ рдкреНрд░рд╛рдкреНрдд / рдбрд┐рдХреЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред</font></font><a href="http://github.com/peterhinch/micropython-async/blob/master/nec_ir/aremote.py" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aremote.py</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдбреНрд░рд╛рдЗрд╡рд░</font><a href="http://github.com/peterhinch/micropython-async/blob/master/nec_ir/aremote.py" rel="nofollow"><b><font style="vertical-align: inherit;"> рд╣реА</font></b></a><font style="vertical-align: inherit;"> ред рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдиреЛрдЯ</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрд╕рд┐рдВрдХреЛ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИрдВ</font><font style="vertical-align: inherit;">ред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдВрдкрд░реНрдХ рдореЗрдВ рд╡реНрдпрд╡рдзрд╛рди рд░рд╛рдЬреНрдп рдкрд░рд┐рд╡рд░реНрддрди (рдорд╛рдЗрдХреНрд░реЛрд╕реЗрдХрдВрдб рдореЗрдВ) рдХрд╛ рд╕рдордп рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ рдФрд░ рдШрдЯрдирд╛ рдХреЛ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдЙрд╕ рд╕рдордп рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИ рдЬрдм рдкрд╣рд▓рд╛ рд░рд╛рдЬреНрдп рдкрд░рд┐рд╡рд░реНрддрди рд╣реЛрддрд╛ рд╣реИред рдХреЛрд░рдЖрдЙрдЯ рдПрдХ рдШрдЯрдирд╛ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ, рдбреЗрдЯрд╛ рдкреИрдХреЗрдЯ рдХреА рдЕрд╡рдзрд┐ рдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд░рддрд╛ рд╣реИ, рдлрд┐рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХреЙрд▓рдмреИрдХ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдбреЗрдЯрд╛ рдХреЛ рдбреАрдХреЛрдб рдХрд░рддрд╛ рд╣реИред</font><i><b><font style="vertical-align: inherit;"> рдИрд╡реЗрдВрдЯ рдХреЗ</font></b></i></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рд╕рдордп рдмреАрддрдиреЗ рд╕реЗ,</font><b><font style="vertical-align: inherit;"> рдХреЛрд░реЛрдЗрди</font></b><font style="vertical-align: inherit;"> рдХреЛ рд╡рд┐рд▓рдВрдм рдХреА рдЕрд╡рдзрд┐ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╕рдордп</font><font style="vertical-align: inherit;">рдХрд┐рд╕реА рднреА</font><b><font style="vertical-align: inherit;"> рдПрд╕рд┐рдВрд╕реАрдУ</font></b><font style="vertical-align: inherit;"> рджреЗрд░реА рдХреЗ</font><font style="vertical-align: inherit;">рд▓рд┐рдП рдХреНрд╖рддрд┐рдкреВрд░реНрддрд┐ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐</font><b><font style="vertical-align: inherit;"> рдорд┐рд▓рддреА рд╣реИ</font></b><font style="vertical-align: inherit;"> ред</font><b><font style="vertical-align: inherit;"> 6.6 HTU21D рдкрд░реНрдпрд╛рд╡рд░рдг рд╕реЗрдВрд╕рд░</font></b></font><i><b><font style="vertical-align: inherit;"></font></b></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br> <b><font style="vertical-align: inherit;"></font></b> <br><br> <a href="http://github.com/peterhinch/micropython-async/blob/master/nec_ir/aremote.py" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреНрд░рд╛рдЗрд╡рд░</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HTU21D рдЪрд┐рдк рддрд╛рдкрдорд╛рди рдФрд░ рдЖрд░реНрджреНрд░рддрд╛ рдХреА рд╕рд╣реА рдорд╛рдк рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреЛрдиреЛрдВ рдбреЗрдЯрд╛ рддрддреНрд╡реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд┐рдк рдХреЛ рд▓рдЧрднрдЧ 120 рдПрдордПрд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдбреНрд░рд╛рдЗрд╡рд░ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рд░реВрдк рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ,</font><font style="vertical-align: inherit;">рдбреЗрдЯрд╛ рдкрдврд╝рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> asyncio.sleep (t)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреА рдкреНрд░рд╛рдкреНрддрд┐ рдФрд░ рдЙрдкрдпреЛрдЧ рдХреА рдкрд╣рд▓ рдХрд░рддрд╛ рд╣реИ,</font><font style="vertical-align: inherit;">рддрд╛рдкрдорд╛рди рдФрд░ рдЖрд░реНрджреНрд░рддрд╛ рдЪрд░ рдХреЛ рдЕрджреНрдпрддрди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдХрд┐рд╕реА рднреА рд╕рдордп рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдЬреЛ рдЪрд┐рдк рдЪрд╛рд▓рдХ рдХреЗ рдЪрд▓рдиреЗ рдХреЗ рджреМрд░рд╛рди рдЕрдиреНрдп рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 7.Tips рдФрд░ рдЯреНрд░рд┐рдХреНрд╕ </font></font></b> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.1 рдХрд╛рд░реНрдпрдХреНрд░рдо рдлреНрд░реАрдЬ рд╣реЛ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд╛рддрд╛ рд╣реИ</font><b><font style="vertical-align: inherit;"> рдлреНрд░реАрдЬ</font></b><font style="vertical-align: inherit;"> рдЖрдорддреМрд░ рдкрд░ рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдХрд╛рд░реНрдп рд░рд┐рдпрд╛рдпрдд рдХреЗ рдмрд┐рдирд╛ рдЕрд╡рд░реБрджреНрдз рд╣реИ: рдпрд╣ рдкреВрд░реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЛ рдлреНрд░реАрдЬ рдХрд░ рджреЗрдЧрд╛ред рд╡рд┐рдХрд╕рд┐рдд рдХрд░рддреЗ рд╕рдордп, рдПрдХ рдХреЛрд░реЛрдЯреАрди рд╣реЛрдирд╛ рдЙрдкрдпреЛрдЧреА рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рд╕рдордп-рд╕рдордп рдкрд░ рдирд┐рд░реНрдорд┐рдд рдПрд▓рдИрдбреА рдореЗрдВ рдмрджрд▓ рдЬрд╛рддрд╛ рд╣реИред рдпрд╣ рдкреБрд╖реНрдЯрд┐ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рд╢реЗрдбреНрдпреВрд▓рд░ рдЕрднреА рднреА рдЪрд▓ рд░рд╣рд╛ рд╣реИред</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.2 uasyncio рд░рд╛рдЬреНрдп рдХреЛ рдмрдЪрд╛рддрд╛ рд╣реИ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрдм </font><font style="vertical-align: inherit;">REPL рдореЗрдВ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╢реБрд░реВ </font><font style="vertical-align: inherit;">рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╢реБрд░реВ рдХреЗ рдмреАрдЪ рдПрдХ рдирд░рдо рд░реАрд╕реЗрдЯ (ctrl-D) рдХрд░реЗрдВред рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рдХрд┐ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░рд╛рд░рдВрдн рдХреЗ рдмреАрдЪ рд╕реНрдерд┐рддрд┐ рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ, рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдЕрдЧрд▓реА рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.3 рдХрдЪрд░рд╛ рд╕рдВрдЧреНрд░рд╣</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрдк </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓реЗ рдЖрдпрд╛рдд рдЬреАрд╕реА</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдПрдХ рдХреЛрд░рдЯрд╛рдЗрди рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="python hljs">gc.collect () gc.treshold ( gc.mem_free () // <span class="hljs-number"><span class="hljs-number">4</span></span> + gc.mem_alloc ())</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп </font></font><a href="http://docs.micropython.org/en/latest/reference/constrained.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдвреЗрд░ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ </font><font style="vertical-align: inherit;">рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ </font><a href="http://docs.micropython.org/en/latest/reference/constrained.html" rel="nofollow"><font style="vertical-align: inherit;">рд╣реИ</font></a><font style="vertical-align: inherit;"> ред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.4 рдкрд░реАрдХреНрд╖рдг</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдирд╛ рдЙрдЪрд┐рдд рд╣реИ рдХрд┐ рдбрд┐рд╡рд╛рдЗрд╕ рдЪрд╛рд▓рдХ рдЖрд╡рд╢реНрдпрдХ рд╣реЛрдиреЗ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ, рдЬреЛ рдХрд╛рд▓реНрдкрдирд┐рдХ рдХреЛрд░рдЯрд╛рдЗрди рдХреА рдПрдХ рдпрд╛ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рдкреНрд░рддрд┐рдпреЛрдВ рдХреЛ рдЪрд▓рд╛рдХрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рд╕рдВрджреЗрд╢ рдореБрджреНрд░рдг рдЪрдХреНрд░ рдХреЛ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЬрд╛рдВрдЪрддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдЪрд▓рддрд╛ рд╣реИ рдЬрдм рдЪрд╛рд▓рдХ рд╕реНрдЯреИрдВрдбрдмрд╛рдп рдореЛрдб рдореЗрдВ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: print(<span class="hljs-string"><span class="hljs-string">'Roundrobin '</span></span>, n) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрд░реЛрдХреНрдд рдкреНрд░рдХрд╛рд░ рдХреЗ рдЦрддрд░реЗ рдХреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ, рдЙрдкрд░реЛрдХреНрдд рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RecordOrientedUart </font></font></i> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__await__</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ рдХреЛ рдореВрд▓ рд░реВрдк рд╕реЗ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рдерд╛:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__await__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> data = <span class="hljs-string"><span class="hljs-string">b''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> data.endswith(self.DELIMITER): <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.uart.any(): <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">0</span></span>) data = <span class="hljs-string"><span class="hljs-string">b''</span></span>.join((data, self.uart.read(self.uart.any()))) self.data = data</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирддреАрдЬрддрди, рдирд┐рд╖реНрдкрд╛рджрди рдкреВрд░реЗ рд░рд┐рдХреЙрд░реНрдб рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рддрдХ рдмрдврд╝рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рд╕рд╛рде рдпрд╣ рддрдереНрдп рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uart.any ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╣рдореЗрд╢рд╛ рдкреНрд░рд╛рдкреНрдд рд╡рд░реНрдгреЛрдВ рдХреА рдПрдХ рдЧреИрд░-рд╕рдВрдЦреНрдпрд╛ рдХреЛ рд╡рд╛рдкрд╕ рдХрд░ рджреЗрддрд╛ рд╣реИред рдХреЙрд▓ рдХреЗ рд╕рдордп рддрдХ, рд╕рднреА рд╡рд░реНрдг рдкрд╣рд▓реЗ рд╣реА рдкреНрд░рд╛рдкреНрдд рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдмрд╛рд╣рд░реА рд▓реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__await__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> data = <span class="hljs-string"><span class="hljs-string">b''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> data.endswith(self.DELIMITER): <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment"># ,  : while not self.uart.any(): yield from asyncio.sleep(0) #        data = b''.join((data, self.uart.read(self.uart.any()))) self.data = data</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рддреНрд░реБрдЯрд┐ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реЛрддреА рдпрджрд┐ рдлреАрдбрдмреИрдХ рдкрд░реАрдХреНрд╖рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдбреЗрдЯрд╛ рдХреЛ UART рдХреЛ рдХрдо рдЧрддрд┐ рдкрд░ рднреЗрдЬрд╛ рдЧрдпрд╛ рд╣реЛрддрд╛ред рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕рдордп рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХреА рдЦреБрд╢рд┐рдпреЛрдВ рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.5 рд╕рд╛рдорд╛рдиреНрдп рддреНрд░реБрдЯрд┐</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрджрд┐ рдХреЛрдИ рдлрд╝рдВрдХреНрд╢рди рдпрд╛ рд╡рд┐рдзрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">async </font></font></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрд┐рдл</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рджреНрд╡рд╛рд░рд╛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХреА рдЬрд╛рддреА рд╣реИ </font><font style="vertical-align: inherit;">рдФрд░ рдмрд╛рдж рдореЗрдВ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреИрд╕реЗ рдХрд┐ рдпрд╣ рдПрдХ рдирд┐рдпрдорд┐рдд (рд╕рд┐рдВрдХреНрд░реЛрдирд╕) рдХреЙрд▓ рдереА, рддреЛ </font><b><font style="vertical-align: inherit;">MicroPython</font></b><font style="vertical-align: inherit;"> рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдВрджреЗрд╢ </font><b><font style="vertical-align: inherit;">рдкреНрд░рджрд░реНрд╢рд┐рдд</font></b><font style="vertical-align: inherit;"> рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред рдпрд╣ рдбрд┐рдЬрд╛рдЗрди рджреНрд╡рд╛рд░рд╛ рд╣реИред рдЖрдорддреМрд░ рдкрд░ рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреА рдУрд░ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдХрд╛рд░реНрдпрдХреНрд░рдо рдЪреБрдкрдЪрд╛рдк рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># code loop.create_task(foo) #  1 1: foo     foo() #  2: .</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореЗрд░реЗ рдкрд╛рд╕ рдПрдХ </font></font><a href="http://github.com/micropython-lib/pull/292" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реБрдЭрд╛рд╡ рд╣реИ</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреЛ </font></font><a href="" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fast_io</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡рд┐рдХрд▓реНрдк 1 рдореЗрдВ рд╕реНрдерд┐рддрд┐ рдХреЛ рдареАрдХ рдХрд░рдиреЗ рдХрд╛ </font><a href="http://github.com/micropython-lib/pull/292" rel="nofollow"><b><font style="vertical-align: inherit;">рд╕реБрдЭрд╛рд╡</font></b></a><font style="vertical-align: inherit;"> рджреЗрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><b><font style="vertical-align: inherit;">Check_async_code.py</font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЙрдбреНрдпреВрд▓ </font><font style="vertical-align: inherit;">coroutines рдХреЗ рд╕рдВрджрд┐рдЧреНрдз рдЙрдкрдпреЛрдЧ рдХреЗ рдорд╛рдорд▓реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реИред рдпрд╣ </font><b><font style="vertical-align: inherit;">рдкрд╛рдпрдерди 3</font></b><font style="vertical-align: inherit;"> рдореЗрдВ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИ </font><font style="vertical-align: inherit;">рдФрд░ рдПрдХ рдкреАрд╕реА рдкрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдЗрд╕ рдЧрд╛рдЗрдб рдореЗрдВ рдЙрд▓реНрд▓рд┐рдЦрд┐рдд рджрд┐рд╢рд╛рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд▓рд┐рдЦреА рдЧрдИ рд▓рд┐рдкрд┐рдпреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬреЛ рдХрд┐ </font><i><font style="vertical-align: inherit;">async def</font></i><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдШреЛрд╖рд┐рдд рдХреА рдЧрдИ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред рдореЙрдбреНрдпреВрд▓ рдПрдХ рддрд░реНрдХ рд▓реЗрддрд╛ рд╣реИ, рд╕реНрд░реЛрдд </font><b><font style="vertical-align: inherit;">MicroPython</font></b><font style="vertical-align: inherit;"> рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдкрде </font><font style="vertical-align: inherit;">(рдпрд╛ --help)ред</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдпрд╣ рдХреБрдЫ рдЕрд╕рднреНрдп рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдПрдХ рд╡рд╛рдХреНрдпрд╡рд┐рдиреНрдпрд╛рд╕ рд░реВрдк рд╕реЗ рд╕рд╣реА рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рд╣реИ, рдЬреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рд╢реБрд░реВ рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рд╕рд╛рдорд╛рдиреНрдп рд╕рд┐рдВрдЯреИрдХреНрд╕ рдЪреЗрдХрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдЗрд▓рд┐рдВрдЯ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬреИрд╕реЗ рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </font><font style="vertical-align: inherit;">( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдЗрд▓рд┐рдВрдЯ рдХреЗ рдкрд╛рд╕</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдпрд╣ рддреНрд░реБрдЯрд┐ рдирд╣реАрдВ рд╣реИ)ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЭреВрдареА рд╕рдХрд╛рд░рд╛рддреНрдордХрддрд╛ рдкреИрджрд╛ рдХрд░рддреА рд╣реИред </font><font style="vertical-align: inherit;">рдпреЛрдЬрдирд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдХреЛрд░рдЖрдЙрдЯ рдкрд╣рд▓реЗ рд╕реНрддрд░ рдХреА рд╡рд╕реНрддреБрдПрдВ рд╣реИрдВ, рдЙрдиреНрд╣реЗрдВ рдХрд╛рд░реНрдпреЛрдВ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЗ рддрд░реНрдХ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдЖрдк рдлрд╝рдВрдХреНрд╢рди рдпрд╛ рдЗрд╕рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдкрд░рд┐рдгрд╛рдо рдХреЛ рдмрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдЗрд░рд╛рджреЗ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреА рд╣реИред </font><font style="vertical-align: inherit;">рдЗрд╕рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдЙрди рдорд╛рдорд▓реЛрдВ рдХреА рдЕрдирджреЗрдЦреА рдХрд░рдирд╛ рд╣реИ рдЬреЛ рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдорд╛рдорд▓реЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рддреЗ рд╕рдордп рд╕рд╣реА рдкреНрд░рддреАрдд рд╣реЛрддреЗ рд╣реИрдВред </font><font style="vertical-align: inherit;">рдорд╛рди рд▓реАрдЬрд┐рдП </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">foo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдЬрд╣рд╛рдВ рд╕рд╣ рджрд┐рдирдЪрд░реНрдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">async рдбреАрдИрдПрдлрд╝</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><pre> <code class="python hljs">loop.run_until_complete(foo()) <span class="hljs-comment"><span class="hljs-comment">#   bar(foo) #     ,      bar(foo()) z = (foo,) z = (foo(),) foo() #  :   .</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реИ, рд▓реЗрдХрд┐рди рд╕реБрдзрд╛рд░ рд╣рдореЗрд╢рд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЙрдХреЗрдЯ (рд╕рд╛рде 7.6 рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЙрдХреЗрдЯ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рд╕реЙрдХреЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛ рдмреБрдирд┐рдпрд╛рджреА рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╣реИрдВ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ред рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рд╕реЙрдХреЗрдЯреНрд╕ рддрдм рддрдХ рдмреНрд▓реЙрдХ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ рдЬрдм рддрдХ рдХрд┐ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд░реАрдб рдпрд╛ рд░рд╛рдЗрдЯ рдСрдкрд░реЗрд╢рди рдкреВрд░рд╛ рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддрд╛ред </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реЗрдбреНрдпреВрд▓рд░</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдмреНрд▓реЙрдХ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд░рдиреЗ рд╕реЗ рд░реЛрдХрдиреЗ рдХреЗ рд▓рд┐рдП </font><i><font style="vertical-align: inherit;">Uasyncio,</font></i><font style="vertical-align: inherit;"> рд╕реЙрдХреЗрдЯ рд▓реЙрдХрд┐рдВрдЧ рдХрд╛ </font><i><font style="vertical-align: inherit;">рдЪрдпрди</font></i><font style="vertical-align: inherit;"> рдХрд░рддрд╛ рд╣реИред рдЬреНрдпрд╛рджрд╛рддрд░ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЗрд╕ рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕рдмрд╕реЗ рдЖрд╕рд╛рди рд╣реИред рдХреНрд▓рд╛рдЗрдВрдЯ рдФрд░ рд╕рд░реНрд╡рд░ рдХреЛрдб рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">client_server</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЙрдХреЗрдЯ рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдорддрджрд╛рди </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд░рдХреЗ рдЪрдпрди.рдкреЙрд▓</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЙрдХреЗрдЯ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЗрд╕ рдЕрд░реНрде рдореЗрдВ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдЗрдВрдЬрди </font><font style="vertical-align: inherit;">рд╕реАрдзреЗ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ </font><font style="vertical-align: inherit;">рд╡рд░реНрддрдорд╛рди рдореЗрдВ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">socket.getaddrinfo</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрд╡рд░реБрджреНрдз рд╣реИред рдирдореВрдирд╛ рдХреЛрдб рдореЗрдВ рд╕рдордп рдХрдо рд╕реЗ рдХрдо рд╣реЛрдЧрд╛, рд▓реЗрдХрд┐рди рдЕрдЧрд░ DNS рд▓реБрдХрдЕрдк рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рддреЛ рдЕрд╡рд░реБрджреНрдз рдЕрд╡рдзрд┐ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реЛ рд╕рдХрддреА рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реЙрдХреЗрдЯ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рджреВрд╕рд░рд╛ рддрд░реАрдХрд╛ рдЧреИрд░-рдЕрд╡рд░реБрджреНрдз рд╕реЙрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред рдпрд╣ рдЬрдЯрд┐рд▓рддрд╛ рдЬреЛрдбрд╝рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреБрдЫ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЦрд╛рд╕рдХрд░ рдпрджрд┐ рдХрдиреЗрдХреНрд╢рди рд╡рд╛рдИрдлрд╛рдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╣реИ (рдиреАрдЪреЗ рджреЗрдЦреЗрдВ)ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рд▓реЗрдЦрди (рдорд╛рд░реНрдЪ 2019) рдХреЗ рд╕рдордп, рдЧреИрд░-рдЕрд╡рд░реБрджреНрдз рд╕реЙрдХреЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЯреАрдПрд▓рдПрд╕ рд╕рдорд░реНрдерди рд╡рд┐рдХрд╛рд╕ рдХреЗ рдЕрдзреАрди рдерд╛ред рдЗрд╕рдХреА рд╕рдЯреАрдХ рд╕реНрдерд┐рддрд┐ рдЕрдЬреНрдЮрд╛рдд рд╣реИ (рдореЗрд░реЗ рд▓рд┐рдП)ред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЧреИрд░-рдЕрд╡рд░реБрджреНрдз рд╕реЙрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╕реНрддрд╛рд░ рдкрд░ рдХреБрдЫ рдзреНрдпрд╛рди рджреЗрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдпрджрд┐ рд╕рд░реНрд╡рд░ рд╡рд┐рд▓рдВрдмрддрд╛ рдХреЗ рдХрд╛рд░рдг рдЧреИрд░-рдЕрд╡рд░реЛрдзрдХ рд░реАрдб рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕ рдмрд╛рдд рдХреА рдХреЛрдИ рдЧрд╛рд░рдВрдЯреА рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЕрдиреБрд░реЛрдзрд┐рдд рдбреЗрдЯрд╛ рдХреЗ рд╕рднреА (рдпрд╛ рдХрд┐рд╕реА рднреА) рд╡рд╛рдкрд╕ рдХрд░ рджрд┐рдП рдЬрд╛рдПрдВрдЧреЗред рдЗрд╕реА рддрд░рд╣, рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рдкреВрд░реА рдирд╣реАрдВ рд╣реЛ рд╕рдХрддреА рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕рд▓рд┐рдП, рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдкрдврд╝рдиреЗ рдФрд░ рд▓рд┐рдЦрдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрдм рддрдХ рдЖрд╡рд╢реНрдпрдХ рдбреЗрдЯрд╛ рдкрдврд╝рд╛ рдпрд╛ рд▓рд┐рдЦрд╛ рдирд╣реАрдВ рдЬрд╛рддрд╛ рд╣реИред рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рд╕рд░реНрд╡рд░ рдЖрдЙрдЯреЗрдЬ рд╕реЗ рдирд┐рдкрдЯрдиреЗ рдХреЗ рд▓рд┐рдП рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдФрд░ рдЬрдЯрд┐рд▓рддрд╛ рдпрд╣ рд╣реИ рдХрд┐ ESP32 рдкреЛрд░реНрдЯ рдореЗрдВ рд╕рдорд╕реНрдпрд╛рдПрдВ рдереАрдВ рдЬреЛ рддреНрд░реБрдЯрд┐ рдореБрдХреНрдд рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдмреБрд░рд╛ рдмреНрд░реЗрдХ-рдЗрди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереАрдВред рдореИрдВрдиреЗ рдкрд░реАрдХреНрд╖рдг рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдЕрднреА рднреА рдорд╛рдорд▓рд╛ рд╣реИред </font><a href="" rel="nofollow"><i><b><font style="vertical-align: inherit;">Sock_nonblock.py</font></b></i></a></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЙрдбреНрдпреВрд▓</font></font><a href="" rel="nofollow"><i><b><font style="vertical-align: inherit;"></font></b></i></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЖрд╡рд╢реНрдпрдХ рддрд░реАрдХреЛрдВ рдХреЛ рджрд┐рдЦрд╛рддрд╛ рд╣реИред рдпрд╣ рдХрд╛рд░реНрдпрд╢реАрд▓ рдбреЗрдореЛ рдирд╣реАрдВ рд╣реИ рдФрд░ рдирд┐рд░реНрдгрдп рдЖрд╡реЗрджрди рдкрд░ рдирд┐рд░реНрднрд░ рд╣реЛрдиреЗ рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.6.1 рд╡рд╛рдИрдлрд╛рдИ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреА </font><b><font style="vertical-align: inherit;">рд╕рдорд╕реНрдпрд╛рдПрдБ</font></b><font style="vertical-align: inherit;"> рд╡рд╛рдИрдлрд╛рдИ рдЖрдЙрдЯреЗрдЬ рдХрд╛ рдкрддрд╛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд▓рдЧрд╛рддреЗ рд╕рдордп uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рддрдВрддреНрд░ </font><font style="vertical-align: inherit;">рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИред рдореИрдВрдиреЗ рдЕрд╕рдлрд▓-рд╕реБрд░рдХреНрд╖рд┐рдд рд╕рдВрдЪрд╛рд▓рди рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдФрд░ рд╡рд┐рдлрд▓рддрд╛рдУрдВ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдЧреНрд░рд╛рд╣рдХ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдЧреИрд░-рдЕрд╡рд░реБрджреНрдз рд╕реЙрдХреЗрдЯреНрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рдкрд╛рдпрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ </font></font><a href="" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджрд╕реНрддрд╛рд╡реЗрдЬрд╝</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЙрди рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдореБрдЭреЗ рд╡рд╛рдИрдлрд╛рдИ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рдЖрдИ рд╣реИрдВ рдЬреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдЕрд╡рдзрд┐ рдХреЗ рд▓рд┐рдП рд╕реЙрдХреЗрдЯ рдЦреЛрд▓рддреЗ рд╣реИрдВ рдФрд░ рд╕рдорд╛рдзрд╛рди рдХреА рд░реВрдкрд░реЗрдЦрд╛ рджреЗрддреЗ рд╣реИрдВред </font></font><br><br> <a href="http://guthub.com/peterhinch/micropython-mqtt" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pltcm</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рдордЬрдмреВрдд рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдПрдордХреНрдпреВрдЯреАрдЯреА рдХреНрд▓рд╛рдЗрдВрдЯ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╡рд╛рдИрдлрд╛рдИ рд╡рд┐рдлрд▓рддрд╛рдУрдВ рдХреЗ рджреМрд░рд╛рди рд╕рдВрджреЗрд╢ рдЕрдЦрдВрдбрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред рд╡рд╛рдпрд░рд▓реЗрд╕ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдмреАрдЪ рдПрдХ рд╕рд░рд▓ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рдлреБрд▓-рдбреБрдкреНрд▓реЗрдХреНрд╕ рд╕реАрд░рд┐рдпрд▓ рд▓рд┐рдВрдХ рдФрд░ рдЧрд╛рд░рдВрдЯреАрдХреГрдд рд╕рдВрджреЗрд╢ рдбрд┐рд▓реАрд╡рд░реА рд╡рд╛рд▓рд╛ рд╡рд╛рдпрд░реНрдб рд╕рд░реНрд╡рд░ рд╡рд░реНрдгрд┐рдд рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7.7 рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХрдВрд╕реНрдЯреНрд░рдХреНрдЯрд░ рдХреЗ рддрд░реНрдХ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрдХ рдЫреЛрдЯреА рд╕реА рддреНрд░реБрдЯрд┐ рд╣реЛ рд╕рдХрддреА рд╣реИ рдпрджрд┐ рдЖрдкрдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рд╕реЗ рднрд┐рдиреНрди рдорд╛рди рд╡рд╛рд▓реЗ рдИрд╡реЗрдВрдЯ рд▓реВрдк рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред рдЗрд╕ рддрд░рд╣ рдХреЗ рд▓реВрдк рдХреЛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрд╕рд┐рдВрдХреЛ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рд╕реА рдЕрдиреНрдп рдХреЛрдб рдХреЛ рдЪрд▓рд╛рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдШреЛрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП </font><font style="vertical-align: inherit;">рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕ рдХреЛрдб рдореЗрдВ рдЗрди рдореВрд▓реНрдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИред рдЕрдиреНрдпрдерд╛, рдХреЛрдб рдХреЛ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рдиреЛрдВ рдХреЗ рд╕рд╛рде рдЖрд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> some_module bar = some_module.Bar() <span class="hljs-comment"><span class="hljs-comment">#   get_event_loop() #     loop = asyncio.get_event_loop(runq_len=40, waitq_len=40)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП рдХрд┐ рдПрдХ рдореЙрдбреНрдпреВрд▓ рдЖрдпрд╛рдд рдХреЛрдб рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд╕рдмрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХрд╛ рд╣реИ рдПрдХ рдШрдЯрдирд╛ рд▓реВрдк рдХреЛ рддреБрд░рдВрдд </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio loop = asyncio.get_event_loop(runq_len=<span class="hljs-number"><span class="hljs-number">40</span></span>, waitq_len=<span class="hljs-number"><span class="hljs-number">40</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> some_module bar = some_module.Bar() <span class="hljs-comment"><span class="hljs-comment"># get_event_loop()   </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЕрдиреНрдп рдХрд╛рд░реНрдпрдХреНрд░рдореЛрдВ рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдореЙрдбреНрдпреВрд▓ рд▓рд┐рдЦрддреЗ рд╕рдордп, рдореИрдВ </font><font style="vertical-align: inherit;">рдЖрдпрд╛рдд рдкрд░ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЛрдб рдЪрд▓рд╛рдиреЗ рд╕реЗ рдмрдЪрдирд╛ рдкрд╕рдВрдж рдХрд░рддрд╛ рд╣реВрдВ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдлрд╝рдВрдХреНрд╢рди рдФрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╡реЗрдВрдЯ рд▓реВрдк рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд┐рдЦреЗрдВред </font><font style="vertical-align: inherit;">рдлрд┐рд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдХреЗрд╡рд▓ рд╢реАрд░реНрд╖-рд╕реНрддрд░реАрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">get_event_loop рдХреЛ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреЙрд▓ </font><i><font style="vertical-align: inherit;">рдХрд░рддреЗ рд╣реИрдВ</font></i><font style="vertical-align: inherit;"> :</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> my_module <span class="hljs-comment"><span class="hljs-comment">#      loop = asyncio.get_event_loop(runq_len=40, waitq_len=40) bar = my_module.Bar(loop)</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╕ рдореБрджреНрджреЗ рдкрд░ </font></font><a href="http://github.com/micropython/micropython-lib/issues/295" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдВ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪрд░реНрдЪрд╛ рдХреА рдЧрдИ </font><a href="http://github.com/micropython/micropython-lib/issues/295" rel="nofollow"><font style="vertical-align: inherit;">рд╣реИ</font></a><font style="vertical-align: inherit;"> ред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП 8 рдиреЛрдЯ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпреЗ рдиреЛрдЯ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рдХреЛрдб рдореЗрдВ рд╢реБрд░реБрдЖрддреА рд▓реЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд╣реИрдВ рдФрд░ рдЙрди рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рд╡рд┐рд╡рд░рдг рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддреЗ рд╣реИрдВ рдЬреЛ рдпреЛрдЬрдирд╛рдХрд╛рд░ рд╣рд▓ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ, рд╕рд╛рде рд╣реА </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рдорд╛рдзрд╛рдиреЛрдВ рдХреЗ</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдП </font><b><font style="vertical-align: inherit;">uasyncio рдХреЗ</font></b><font style="vertical-align: inherit;"> рджреГрд╖реНрдЯрд┐рдХреЛрдг </font><b><font style="vertical-align: inherit;">рдХрд╛</font></b><font style="vertical-align: inherit;"> рдЕрд╡рд▓реЛрдХрди рджреЗрддреЗ </font><font style="vertical-align: inherit;">рд╣реИрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдзрд╛рд░рд╛ 8.5 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ _ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдереНрд░реЗрдб</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЙрдбреНрдпреВрд▓ рдХреЗ рд╕рд╛рдкреЗрдХреНрд╖ рдЧреБрдгреЛрдВ рдкрд░ рдЪрд░реНрдЪрд╛ рдХрд░рддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">, рд╕рд╛рде рд╣реА рдЖрдк </font><font style="vertical-align: inherit;">рд╕рдХреНрд░рд┐рдп рд╢реЗрдбреНрдпреВрд▓рд┐рдВрдЧ (_thread) рдХреЗ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕рд╛рде uasyncio рдХреЛрд░рдЖрдЙрдЯреНрд╕</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдХреНрдпреЛрдВ рдкрд╕рдВрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">ред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.1 рд╕рдорд╕реНрдпрд╛ 1: рдИрд╡реЗрдВрдЯ рд▓реВрдк</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдлрд░реНрдорд╡реЗрдпрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓рдЧрд╛рддрд╛рд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдмрд╛рд╣рд░реА рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЬрд┐рд╕рдореЗрдВ рдПрдбреАрд╕реА рдкрд░ рд╡реЛрд▓реНрдЯреЗрдЬ рдореЗрдВ рдмрджрд▓рд╛рд╡, рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рд░реБрдХрд╛рд╡рдЯ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐, рдпрд╛ рдпреВрдПрдЖрд░рдЯреА рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рдПрдХ рдкреНрд░рддреАрдХ, рдпрд╛ рд╕реЙрдХреЗрдЯ рдкрд░ рдЙрдкрд▓рдмреНрдз рдбреЗрдЯрд╛ рд╢рд╛рдорд┐рд▓ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред рдпреЗ рдИрд╡реЗрдВрдЯ рдЕрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рд░реВрдк рд╕реЗ рд╣реЛрддреЗ рд╣реИрдВ, рдФрд░ рдХреЛрдб рдХреЛ рдЙрд╕ рдЖрджреЗрд╢ рдХреА рдкрд░рд╡рд╛рд╣ рдХрд┐рдП рдмрд┐рдирд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬрд┐рд╕рдореЗрдВ рд╡реЗ рд╣реЛрддреЗ рд╣реИрдВред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╕рдордп-рдирд┐рд░реНрднрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬреИрд╕реЗ рдХрд┐ рдПрд▓рдИрдбреА рдЪрдордХрддреАред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдРрд╕рд╛ рдХрд░рдиреЗ рдХрд╛ рд╕реНрдкрд╖реНрдЯ рддрд░реАрдХрд╛ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasycio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЗрд╡реЗрдВрдЯ </font><b><font style="vertical-align: inherit;">рд▓реВрдк рдХреЗ рд╕рд╛рде рд╣реИ</font></b><font style="vertical-align: inherit;"> ред рдпрд╣ рдЙрджрд╛рд╣рд░рдг рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдХреЛрдб рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдШрдЯрдирд╛ рд▓реВрдк рдХреЗ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рдХреЛ рдЪрд┐рддреНрд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">event_loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> led_1_time = <span class="hljs-number"><span class="hljs-number">0</span></span> led_1_period = <span class="hljs-number"><span class="hljs-number">20</span></span> led_2_time = <span class="hljs-number"><span class="hljs-number">0</span></span> led_2_period = <span class="hljs-number"><span class="hljs-number">30</span></span> switch_state = switch.state() <span class="hljs-comment"><span class="hljs-comment">#    while True: time_now = utime.time() if time_now &gt;= led_1_time: #  LED #1 led1.toggle() led_1_time = time_now + led_1_period if time_now &gt;= led_2_time: #  LED #2 led2.toggle() led_2_time = time_now + led_2_period #    LEDs if switch.value() != switch_state: switch_state = switch.value() #  - if uart.any(): #    UART</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдРрд╕рд╛ рд▓реВрдк рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЬреИрд╕реЗ-рдЬреИрд╕реЗ рдШрдЯрдирд╛рдУрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдмрдврд╝рддреА рд╣реИ, рдХреЛрдб рдЬрд▓реНрджреА рд╕реЗ рдмреЛрдЭрд┐рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред рд╡реЗ рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдореЗрдВ рдЕрдзрд┐рдХрд╛рдВрд╢ рд▓реЙрдЬрд┐рдХ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдСрдмреНрдЬреЗрдХреНрдЯ-рдУрд░рд┐рдПрдВрдЯреЗрдб рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдХреЗ рд╕рд┐рджреНрдзрд╛рдВрддреЛрдВ рдХрд╛ рдЙрд▓реНрд▓рдВрдШрди рдХрд░рддреЗ рд╣реИрдВред рд╣рдо рдПрдХ рдЪрдордХрддреА рдПрд▓рдИрдбреА рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд░реНрдЧ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдЬрд┐рд╕реЗ рдПрдХ рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдбрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдЖрдпрд╛рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрд▓рдИрдбреА рдЪрдордХрддреА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП OOP рджреГрд╖реНрдЯрд┐рдХреЛрдг рдЗрд╕ рддрд░рд╣ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyb <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LED_flashable</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, led_no)</span></span></span><span class="hljs-function">:</span></span> self.led = pyb.LED(led_no) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">flash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, period)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: self.led.toggle() <span class="hljs-comment"><span class="hljs-comment"># -     period, #         </span></span></code> </pre><br><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдореЗрдВ </font><b><font style="vertical-align: inherit;">рдЕрдиреБрд╕реВрдЪрдХ</font></b><font style="vertical-align: inherit;"> рдЖрдкрдХреЛ рдРрд╕реА рдХрдХреНрд╖рд╛рдПрдВ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.2 рд╕рдорд╕реНрдпрд╛ 2: рдмреНрд▓реЙрдХрд┐рдВрдЧ рдХреЗ рддрд░реАрдХреЗ</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд╛рди рд▓реЗрдВ рдХрд┐ рдЖрдкрдХреЛ рд╕реЙрдХреЗрдЯ рд╕реЗ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдмрд╛рдЗрдЯреНрд╕ рдкрдврд╝рдиреЗ рд╣реИрдВред рдпрджрд┐ рдЖрдк </font><font style="vertical-align: inherit;">рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ рдЕрд╡рд░реБрджреНрдз рд╕реЙрдХреЗрдЯ рдХреЗ рд╕рд╛рде рд╕реЙрдХреЗрдЯ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(n)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╣рддреЗ рд╣реИрдВ </font><font style="vertical-align: inherit;">, рддреЛ рдпрд╣ " </font><font style="vertical-align: inherit;">рдмрд╛рдЗрдЯ </font><font style="vertical-align: inherit;">" рд╣реЛрдЧрд╛ (рдЕрд░реНрдерд╛рдд, рдпрд╣ рддрдм рддрдХ рд╕рдорд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛрдЧрд╛) рдЬрдм рддрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдмрд╛рдЗрдЯ </font><font style="vertical-align: inherit;">рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рд╣реЛ рдЬрд╛рддреЗ </font><font style="vertical-align: inherit;">ред рдЗрд╕ рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдиреНрдп рдШрдЯрдирд╛рдУрдВ рдХрд╛ рдЬрд╡рд╛рдм рдирд╣реАрдВ рджреЗрдЧрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреЙрди-рдмреНрд▓реЙрдХрд┐рдВрдЧ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕реЙрдХреЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ </font><b><font style="vertical-align: inherit;">,</font></b><font style="vertical-align: inherit;"> рдЖрдк рдПрдХ рдПрд╕рд┐рдВрдХреНрд░реЛрдирд╕ рд░реАрдб рд╡рд┐рдзрд┐ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВред рдПрдХ рдХрд╛рд░реНрдп рдЬрд┐рд╕реЗ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ (рдЖрд╡рд╢реНрдпрдХ) рдЙрд╕реЗ рдкреНрд░рд╛рдкреНрдд рд╣реЛрдиреЗ рддрдХ рдЕрд╡рд░реБрджреНрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕ рдЕрд╡рдзрд┐ рдХреЗ рджреМрд░рд╛рди рдЕрдиреНрдп рдХрд╛рд░реНрдп рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ, рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЙрддреНрддрд░рджрд╛рдпреА рдмрдиреЗ рд░рд╣рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.3ред Uasyncio рджреГрд╖реНрдЯрд┐рдХреЛрдг</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдЧрд▓реА рдХрдХреНрд╖рд╛ рдореЗрдВ рдПрдХ рдПрд▓рдИрдбреА рд╣реИ рдЬрд┐рд╕реЗ рдЪрд╛рд▓реВ рдФрд░ рдмрдВрдж рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЖрдк рдХрд┐рд╕реА рднреА рдЧрддрд┐ рд╕реЗ рдЭрдкрдХреА рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВред </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LED_async</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЖрд╡реГрддреНрддрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд░рди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИ </font><font style="vertical-align: inherit;">, рдЬрд┐рд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд┐рд░рдВрддрд░ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрд▓ рдИ рдбреА рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдСрди (), рдСрдл (),</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреНрд▓реИрд╢ (рд╕реЗрдХрдВрдб)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyb <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LED_async</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, led_no)</span></span></span><span class="hljs-function">:</span></span> self.led = pyb.LED(led_no) self.rate = <span class="hljs-number"><span class="hljs-number">0</span></span> loop = asyncio.get_event_loop() loop.create_task(self.run()) <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.rate &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep_ms(<span class="hljs-number"><span class="hljs-number">200</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: self.led.toggle() <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep_ms(int(<span class="hljs-number"><span class="hljs-number">500</span></span> / self.rate)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">flash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, rate)</span></span></span><span class="hljs-function">:</span></span> self.rate = rate <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.led.on() self.rate = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">off</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.led.off() self.rate = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдСрди (), рдСрдл ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлреНрд▓реИрд╢ ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╛рдзрд╛рд░рдг рд╕рд┐рдВрдХреНрд░реЛрдирд╕ рддрд░реАрдХреЗ рд╣реИрдВред рд╡реЗ рдПрд▓рдИрдбреА рдХреЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдмрджрд▓рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рддреБрд░рдВрдд рд╡рд╛рдкрд╕ рд▓реМрдЯрддреЗ рд╣реИрдВред рдирд┐рдорд┐рд╖ "рдкреГрд╖реНрдарднреВрдорд┐ рдореЗрдВ рд╣реЛрддрд╛ рд╣реИред" рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдЧрд▓реЗ рднрд╛рдЧ рдореЗрдВ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡рд░реНрдЧ рдУрдУрдкреА рд╕рд┐рджреНрдзрд╛рдВрдд рдХрд╛ рдЕрдиреБрдкрд╛рд▓рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдХрдХреНрд╖рд╛ рдореЗрдВ рдбрд┐рд╡рд╛рдЗрд╕ рд╕реЗ рдЬреБрдбрд╝реЗ рддрд░реНрдХ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИред рдЗрд╕реА рд╕рдордп, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ </font><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдиреНрдп рдШрдЯрдирд╛рдУрдВ рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдЬрдмрдХрд┐ рдПрд▓рдИрдбреА </font><b><font style="vertical-align: inherit;">рдЭрдкрдХреА рд▓реЗ рд░рд╣рд╛</font></b><font style="vertical-align: inherit;"> рд╣реИред рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдХрд╛рд░реНрдпрдХреНрд░рдо </font><font style="vertical-align: inherit;">рд╡рд┐рднрд┐рдиреНрди рдЖрд╡реГрддреНрддрд┐рдпреЛрдВ рдкрд░ </font><font style="vertical-align: inherit;">рдЪрд╛рд░ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдЗрдмреЛрдб</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдПрд▓ рдИ рдбреА рдХреЗ рд╕рд╛рде </font><b><font style="vertical-align: inherit;">рдЪрдордХрддрд╛ рд╣реИ</font></b><font style="vertical-align: inherit;"> , рдФрд░ </font><b><font style="vertical-align: inherit;">рдпреВрдПрд╕рдЖрд░</font></b><font style="vertical-align: inherit;"> рдмрдЯрди рдкрд░ рднреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЗрд╕реЗ рдкреВрд░рд╛ рдХрд░рддрд╛ рд╣реИред</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyb <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> uasyncio <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> asyncio <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> led_async <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LED_async <span class="hljs-comment"><span class="hljs-comment"># ,   async def killer(): # ,      sw = pyb.Switch() while not sw.value(): await asyncio.sleep_ms(100) leds = [LED_async(n) for n in range(1, 4)] for n, led in enumerate(leds): led.flash(0.7 + n/4) loop = asyncio.get_event_loop() loop.run_until_complete(killer())</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдИрд╡реЗрдВрдЯ рд▓реВрдк рдХреЗ рдкрд╣рд▓реЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд╡рд┐рдкрд░реАрдд, рд╕реНрд╡рд┐рдЪ рд╕реЗ рдЬреБрдбрд╝рд╛ рддрд░реНрдХ рдПрд▓рдИрдбреА рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╕реЗ рдЕрд▓рдЧ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╣реИред </font><font style="vertical-align: inherit;">рдЕрдиреБрд╕реВрдЪрдХ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдХреЛрдб рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ:</font></font><br><br><pre> <code class="python hljs">loop = asyncio.get_event_loop() loop.run_until_complete(killer()) <span class="hljs-comment"><span class="hljs-comment">#    #       killer (), #   .</span></span></code> </pre><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.4 uasyncio </font></font></b> <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Python 3.5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MicroPython </font></font></b><font style="vertical-align: inherit;"><b><font style="vertical-align: inherit;">рдореЗрдВ рдирд┐рдпреЛрдЬрди</font></b><font style="vertical-align: inherit;"> рдПрдХ рдЕрддреБрд▓реНрдпрдХрд╛рд▓рд┐рдХ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЕрд╡рдзрд╛рд░рдгрд╛ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдПрдХ coroutine рдпрд╛ рдХрд╛рд░реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдПрдХ coroutine рдореЗрдВ рдХрдо рд╕реЗ рдХрдо рдПрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХреНрд╖рд╛</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рд╡рд░рдг рд╢рд╛рдорд┐рд▓ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП </font><font style="vertical-align: inherit;">ред</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10</span></span>): print(<span class="hljs-string"><span class="hljs-string">'Hello world.'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдлрд╝рдВрдХреНрд╢рди рдПрдХ-рджреВрд╕рд░реЗ рдХреЗ рдЕрдВрддрд░рд╛рд▓ рдкрд░ рджрд╕ рдмрд╛рд░ рд╕рдВрджреЗрд╢ рднреЗрдЬрддрд╛ рд╣реИред рдЬрдмрдХрд┐ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рджреЗрд░реА рдХреА рдкреНрд░рддреНрдпрд╛рд╢рд╛ рдореЗрдВ рд░реЛрдХрд╛ рдЬрд╛рддрд╛ рд╣реИ, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio рдЕрдиреБрд╕реВрдЪрдХ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░реЗрдЧрд╛, рдЙрдиреНрд╣реЗрдВ рдПрдХ рд╕рд╛рде рдЪрд▓рд╛рдиреЗ рдХрд╛ рднреНрд░рдо рдкреИрджрд╛ рдХрд░реЗрдЧрд╛ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рдХреЛрдИ coroutine рд╕рдорд╕реНрдпрд╛рдПрдБ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio.sleep_ms ()</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ </font><i><font style="vertical-align: inherit;">asyncio.sleep () рдХрд╛ </font></i></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдВрддрдЬрд╛рд░ рдХрд░рддреА рд╣реИрдВ, рддреЛ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд░реНрддрдорд╛рди рдХрд╛рд░реНрдп рдХреЛ рд░реЛрдХ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдХрддрд╛рд░ рдореЗрдВ рд░рдЦ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬреЛ рд╕рдордп рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЖрджреЗрд╢ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдХрд╛рд░реНрдп рдХрддрд╛рд░ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдЖрдЧреЗ рдмрдврд╝рддрд╛ рд╣реИред рдХрддрд╛рд░ рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐, рднрд▓реЗ рд╣реА рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдиреАрдВрдж рдореЛрдб рд╢реВрдиреНрдп рд╣реЛ, рдЕрдиреНрдп рдкреНрд░рд╛рд╕рдВрдЧрд┐рдХ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рддрдХ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдпрд╣ "рдИрдорд╛рдирджрд╛рд░ рдкрд░рд┐рдкрддреНрд░" рдпреЛрдЬрдирд╛ рд╣реИред рдпрд╣ </font><i><font style="vertical-align: inherit;">asyncio.sleep (0)</font></i><font style="vertical-align: inherit;"> рд▓реВрдк рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдо рдмрд╛рдд рд╣реИред</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рддрд╛рдХрд┐ рдХрд╛рд░реНрдп рдирд┐рд╖реНрдкрд╛рджрди рдореЗрдВ рджреЗрд░реА рди рдХрд░реЗрдВред </font><font style="vertical-align: inherit;">рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдПрдХ рд╡реНрдпрд╕реНрдд-рдкреНрд░рддреАрдХреНрд╖рд╛ рд▓реВрдк рд╣реИ рдЬреЛ рд╡реИрд╢реНрд╡рд┐рдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдзреНрд╡рдЬ</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЪрд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рдЕрдиреНрдп рдХрд╛рд░реНрдп рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣рд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font><font style="vertical-align: inherit;">рдХрд╛рд╢, рдпрд╣ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛ рдПрдХрд╛рдзрд┐рдХрд╛рд░ рджреЗрддрд╛ рд╣реИ, рдЕрдиреНрдп рдХреЛрд░рд╛рдЙрдЯреАрди рдХреЗ рдкреНрд░рдХреНрд╖реЗрдкрдг рдХреЛ рд░реЛрдХрддрд╛ рд╣реИ:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bad_code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> flag <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> flag: <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-comment"><span class="hljs-comment">#  flag = False #    </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЬрдм рддрдХ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдлрд╝реНрд▓реИрдЧрд┐рд╕ рдлрд╝реЙрд▓реНрд╕</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓реВрдк </font><font style="vertical-align: inherit;">рд╢реЗрдбреНрдпреВрд▓рд░ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рддрдм рддрдХ рдХреЛрдИ рдЕрдиреНрдп рдХрд╛рд░реНрдп рд╢реБрд░реВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </font><font style="vertical-align: inherit;">рд╕рд╣реА рддрд░реАрдХрд╛:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">good_code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> flag <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> flag: <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> asyncio.sleep(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">#  flag = False #    </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЙрд╕реА рдХрд╛рд░рдг рд╕реЗ, рджреЗрд░реА рд╕реЗрдЯ рдХрд░рдирд╛ рдмреБрд░рд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utime.sleep (1)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ 1 рдПрд╕ рдХреЗ рд▓рд┐рдП рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдХрд░рддрд╛ рд╣реИ; рдпрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio.sleep (1)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд╕рд╣реА рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uasyncio </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдиреАрдВрдж</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдФрд░ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sleep_ms</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрд░реАрдХреЛрдВ рд╕реЗ рдЙрддреНрдкрдиреНрди рджреЗрд░реА </font><font style="vertical-align: inherit;">рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╕рдордп рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ рд╕рдХрддреА рд╣реИред рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реИ рдХрд┐ рджреЗрд░реА рдХреЗ рджреМрд░рд╛рди рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред рдмрд╛рдж рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди рд╕реЗ рдкрд╣рд▓реЗ рджреЗрд░реА рдХреА рдЕрд╡рдзрд┐ рддрдХ рдлрд┐рд░ рд╕реЗ рд╢реБрд░реВ рд╣реИ рдЪрд▓ рд░рд╣рд╛ рд╣реИ рдХрд╛рдо рдирд╣реАрдВ рджреЗрдВрдЧреЗ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрдВрддрдЬрд╛рд░</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдпрд╛ рдЗрд╕реНрддреАрдлрд╛ред рдПрдХ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд┐рдП рдЧрдП рдХреЛрд░рдЯрд╛рдЗрди рд╣рдореЗрд╢рд╛ </font><i><font style="vertical-align: inherit;">рдкреНрд░рддреАрдХреНрд╖рд╛ рдХреА</font></i><font style="vertical-align: inherit;"> рдШреЛрд╖рдгрд╛ рдХрд░реЗрдВрдЧреЗ</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдирд┐рдпрдорд┐рдд рдЕрдВрддрд░рд╛рд▓ рдкрд░ред рдЬрд╣рд╛рдВ рдПрдХ рд╕рдЯреАрдХ рджреЗрд░реА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЦрд╛рд╕рдХрд░ рдпрджрд┐ рдХреЛрдИ рдХреБрдЫ рдПрдордПрд╕ рд╕реЗ рдХрдо рд╣реИ, рддреЛ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utime.sleep_us (us)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.5 рд╕рд╣рдпреЛрдЧреА, рдереНрд░реЗрдб-рдЖрдзрд╛рд░рд┐рдд рд╢реЗрдбреНрдпреВрд▓рд┐рдВрдЧ ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">_thread</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">рдХреНрдпреЛрдВ рдирд╣реАрдВ </font><font style="vertical-align: inherit;">?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╕рд╣-рдирд┐рдпреЛрдЬрди рдХреЛрд░рдЖрдЙрдЯ рдХреЗ рд╡рд┐рдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рд╢реБрд░реБрдЖрддреА рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЕрдХреНрд╕рд░ рдирд┐рд░рд╛рд╢рд╛рдЬрдирдХ рд╣реЛрддреА рд╣реИред рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдХреА рдпреЛрдЬрдирд╛ рдмреЗрд╣рддрд░ рд╣реИ? рдпрджрд┐ рдкрд╛рдпрдерди рд╡рд░реНрдЪреБрдЕрд▓ рдорд╢реАрди рдореЗрд░реЗ рд▓рд┐рдП рдРрд╕рд╛ рдХрд░ рд╕рдХрддреА рд╣реИ рддреЛ рдореБрдЭреЗ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рдпрдВрддреНрд░рдг рдХреНрдпреЛрдВ рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЬрдм рдпрд╣ рдПрдореНрдмреЗрдбреЗрдб рд╕рд┐рд╕реНрдЯрдо рдХреА рдмрд╛рдд рдЖрддреА рд╣реИ, рддреЛ рд╕рд╣рдпреЛрдЧ рдореЙрдбрд▓ рдХреЗ рджреЛ рдлрд╛рдпрджреЗ рд╣реИрдВред</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╣рд▓рд╛ рд╣рд▓реНрдХрд╛ рд╡рдЬрди рд╣реИред рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдХреЙрд░рдЖрдЙрдЯреНрд╕ рд╕рдВрднрд╡ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЕрдиреБрд╕реВрдЪрд┐рдд рдзрд╛рдЧреЛрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдирд┐рд▓рдВрдмрд┐рдд рдХреЙрд░рдЖрдЙрдЯреНрд╕ рдХрдо рдЬрдЧрд╣ рд▓реЗрддреЗ рд╣реИрдВред </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рджреВрд╕рд░реЗ, рдпрд╣ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рд╢реЗрдбреНрдпреВрд▓рд┐рдВрдЧ рд╕реЗ рдЬреБрдбрд╝реЗ рдХреБрдЫ рд╕реВрдХреНрд╖реНрдо рдореБрджреНрджреЛрдВ рд╕реЗ рдмрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рд╕рд╣рдпреЛрдЧреА рдорд▓реНрдЯреАрдЯрд╛рд╕реНрдХрд┐рдВрдЧ рдХрд╛ рд╡реНрдпрд╛рдкрдХ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ-рдкреНрд▓рд╛рдирд┐рдВрдЧ рдореЙрдбрд▓ рдХреЗ рдмрдЪрд╛рд╡ рдореЗрдВ, рдореИрдВ рдПрдХ рдлрд╛рдпрджрд╛ рджрд┐рдЦрд╛рдКрдВрдЧрд╛: рдЕрдЧрд░ рдХреЛрдИ рд▓рд┐рдЦрддрд╛ рд╣реИ</font></font><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range ( <span class="hljs-number"><span class="hljs-number">1000000</span></span> ): <span class="hljs-comment"><span class="hljs-comment">#  - </span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣ рдЕрдиреНрдп рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдЕрд╡рд░реБрджреНрдз рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред рд╕рд╣рдпреЛрдЧ рдореЙрдбрд▓ рдорд╛рдирддрд╛ рд╣реИ рдХрд┐ рд▓реВрдк рдХреЛ рдкреНрд░рддреНрдпреЗрдХ рдХрд╛рд░реНрдп рдХреЛ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐рдпреЛрдВ рдХреА рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдЦреНрдпрд╛ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рджреЗрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ coroutine рдореЗрдВ рдХреЛрдб рдбрд╛рд▓рдирд╛ рдФрд░ рд╕рдордп-рд╕рдордп рдкрд░ рдЬрд╛рд░реА </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio.sleep (0)</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЬрд╛рд░реА рдХрд░рдирд╛ </font><font style="vertical-align: inherit;">ред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдХрд╛рд╢, рдпрд╣ рд▓рд╛рдн рдиреБрдХрд╕рд╛рди рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдореЗрдВ рд╣реИред рдЗрди рдореЗрдВ рд╕реЗ рдХреБрдЫ рдХреЛ </font><a href="http://docs.micropython.org/en/latest/reference/isr_rules.html" rel="nofollow"><font style="vertical-align: inherit;">рдмрд╛рдзрд┐рдд рд╣реИрдВрдбрд▓рд░</font></a><font style="vertical-align: inherit;"> рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд▓реЗрдЦрди рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ </font></font><a href="http://docs.micropython.org/en/latest/reference/isr_rules.html" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ред рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рд╢реЗрдбреНрдпреВрд▓рд┐рдВрдЧ рдореЙрдбрд▓ рдореЗрдВ, рдкреНрд░рддреНрдпреЗрдХ рдереНрд░реЗрдб рдХрд┐рд╕реА рднреА рдЕрдиреНрдп рдереНрд░реЗрдб рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдбреЗрдЯрд╛ рдХреЛ рдмрджрд▓ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЕрдиреНрдп рдереНрд░реЗрдбреНрд╕ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред рдПрдХ рдирд┐рдпрдо рдХреЗ рд░реВрдк рдореЗрдВ, рдПрдХ рд▓реЙрдХ рдХреЛ рдвреВрдВрдврдирд╛ рдФрд░ рдареАрдХ рдХрд░рдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИ рдЬреЛ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рдХрд╛рд░рдг рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдХрднреА-рдХрднреА рдмрд╣реБрдд рд╕реВрдХреНрд╖реНрдо рдФрд░ рд╢рд╛рдпрдж рд╣реА рдХрднреА рд╕рд╛рдордирд╛ рдХреА рдЧрдИ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдкрд░рд┐рдгрд╛рдо рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рдЬреЛ рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдпреЛрдЬрдирд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдореЙрдбрд▓ рдХреЗ рдврд╛рдВрдЪреЗ рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рдХреЛрдб рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реАрдзреЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ рдХрд╣реЗрдВ, рдЕрдЧрд░ рдЖрдк рдПрдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорд╛рдЗрдХреНрд░реЛрдкреНрдереЙрди рдХреЛрд░рдЯрд╛рдЗрди</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд▓рд┐рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк </font><font style="vertical-align: inherit;">рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЪрд░ рдХреЛ рдЕрдЪрд╛рдирдХ рдХрд┐рд╕реА рдЕрдиреНрдп coroutine рджреНрд╡рд╛рд░рд╛ рдирд╣реАрдВ рдмрджрд▓рд╛ рдЬрд╛рдПрдЧрд╛: рдЬрдм рддрдХ рдпрд╣ </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asyncio.sleep (0) рдХрд╛ рдЗрдВрддрдЬрд╛рд░ рдирд╣реАрдВ рдХрд░рддрд╛,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рддрдм рддрдХ рдЖрдкрдХрд╛ coroutine рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдг </font><i><font style="vertical-align: inherit;">рд░рдЦрддрд╛ рд╣реИ</font></i><font style="vertical-align: inherit;"> ред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдмрд╛рдзрд╛ рд╣реИрдВрдбрд▓рд░ рдкреНрд░реАрдореЗрдкреНрдЯрд┐рд╡ рд╣реИрдВред рдпрд╣ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдФрд░ рд╕реЙрдлреНрдЯрд╡реЗрдпрд░ рджреЛрдиреЛрдВ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдЖрдкрдХреЗ рдХреЛрдб рдореЗрдВ рдХрд╣реАрдВ рднреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ рдпреЛрдЬрдирд╛ рдХреЗ рдореБрджреНрджреЛрдВ рдХреА рдПрдХ рд╡рд┐рд╕реНрддреГрдд рдЪрд░реНрдЪрд╛ </font></font><a href="http://glyph.twistedmatrix.com/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдпрд╣рд╛рдБ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдорд┐рд▓ рд╕рдХрддреА </font><a href="http://glyph.twistedmatrix.com/" rel="nofollow"><font style="vertical-align: inherit;">рд╣реИ</font></a><font style="vertical-align: inherit;"> ред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.6 рд╕рд╣рднрд╛рдЧрд┐рддрд╛</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдЧреИрд░-рддреБрдЪреНрдЫ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ, рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рдмрд╛рддрдЪреАрдд рдХрд░рдиреА рдЪрд╛рд╣рд┐рдПред рдкрд╛рд░рдВрдкрд░рд┐рдХ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдкрд╛рдпрдерди</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред рдЗрдирдореЗрдВ рд╡реИрд╢реНрд╡рд┐рдХ рдЪрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдпрд╛ рдХреЛрд░рдЯрд╛рдЗрди рдХреЛ рдСрдмреНрдЬреЗрдХреНрдЯ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдШреЛрд╖рд┐рдд рдХрд░рдирд╛ рд╢рд╛рдорд┐рд▓ рд╣реИ: рд╡реЗ рдЙрджрд╛рд╣рд░рдг рдЪрд░ рд╕рд╛рдЭрд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред рд╡реИрдХрд▓реНрдкрд┐рдХ рд░реВрдк рд╕реЗ, рдПрдХ рдЙрддреНрдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╡рд╕реНрддреБ рдХреЛ рдХреЛрд░рдЯрд╛рдЗрди рдХреЗ рддрд░реНрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реНрдЯреНрд░реАрдорд┐рдВрдЧ-рдкреНрд▓рд╛рдирд┐рдВрдЧ рдореЙрдбрд▓ рдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖рдЬреНрдЮреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдХрд┐ рдХрдХреНрд╖рд╛рдПрдВ рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрдиреЗрдХреНрд╢рди рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИрдВ; </font><font style="vertical-align: inherit;">рдПрдХ рд╕рд╣рдпреЛрдЧ рдореЙрдбрд▓ рдореЗрдВ, рдпрд╣ рд╢рд╛рдпрдж рд╣реА рдХрднреА рдЖрд╡рд╢реНрдпрдХ рд╣реИред </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8.7ред </font><font style="vertical-align: inherit;">рдкреЛрд▓ ( </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдорддрджрд╛рди</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдРрд╕реЗ accelerometer рдПрдХ рдХреЗ рд░реВрдк рдореЗрдВ рдХреБрдЫ рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдбрд┐рд╡рд╛рдЗрд╕ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pyboard</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , рдмреАрдЪ рдореЗрдВ рдЖрддрд╛ рд╣реИ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдЗрд╕рд▓рд┐рдП рд╕рд░реНрд╡реЗрдХреНрд╖рдг рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП (рдЕрд░реНрдерд╛рдд рд╕рд╛рд╡рдзрд┐рдХ рдЬрд╛рдВрдЪ)ред </font><font style="vertical-align: inherit;">рдорддрджрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд╛рдзрд┐рдд рд╣реИрдВрдбрд▓рд░ рдХреЗ рд╕рдВрдпреЛрдЬрди рдореЗрдВ рднреА рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: рдмрд╛рдзрд╛ рд╣реИрдВрдбрд▓рд░ рдЙрдкрдХрд░рдг рдмрдирд╛рдП рд░рдЦрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдзреНрд╡рдЬ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред </font><font style="vertical-align: inherit;">рдХреЙрд░рдЯреАрди рдзреНрд╡рдЬ рдХреЛ рдкреЛрд▓ рдХрд░рддрд╛ рд╣реИ - рдпрджрд┐ рдпрд╣ рд╕реЗрдЯ рд╣реИ, рддреЛ рдбреЗрдЯрд╛ рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдзреНрд╡рдЬ рд░реАрд╕реЗрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдЗрд╡реЗрдВрдЯ</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> рдХреНрд▓рд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╣реИ </font><font style="vertical-align: inherit;">ред</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi484472/">https://habr.com/ru/post/hi484472/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi484462/index.html">рд╕реНрдХреНрд░реИрдкрд┐рдВрдЧ рдЧрд┐рдердм: рдбреЗрд╡рд▓рдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП "рд╕реАрдХреНрд░реЗрдЯреНрд╕" рдХреА рдЦреЛрдЬ</a></li>
<li><a href="../hi484464/index.html">рдЬрд╛рдкрд╛рдиреА рдореЛрдЯрд░рд╕рд╛рдЗрдХрд┐рд▓ рдХреА рдиреАрд▓рд╛рдореА, рдпрд╣ рд╕рдм рдХреИрд╕реЗ рд╣реЛрддрд╛ рд╣реИ</a></li>
<li><a href="../hi484466/index.html">рдХреЙрдорди рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдкреНрд░реЙрдорд┐рд╕ рдореИрдЯрд░ рдПрдмреНрд░реАрдмреНрдпреВрдб рдПрдмрд╛рдЙрдЯ рдиреЛ рд╣рд╛рдЙрдЯ рдиреЛ рдЕрдмрд╛рдЙрдЯ</a></li>
<li><a href="../hi484468/index.html">рд░реЗрдб рдХреЙрд░реНрдкреЛрд░реЗрдЯ рд╕рдВрд╕реНрдХреГрддрд┐ рд░реВрд╕реА рд╡реНрдпрд╡рд╕рд╛рдп рдХреА рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛ рд╣реИ (рднрд╛рдЧ 2)</a></li>
<li><a href="../hi484470/index.html">рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рдПрдХреНрд╕реНрдЯреЗрдВрд╕рд┐рдмрд▓ рдПрдХреНрд╕рдЯреЗрдВрд╢рдиреНрд╕</a></li>
<li><a href="../hi484480/index.html">5 рд╕рдмрд╕реЗ рдмрдбрд╝реА рдЕрдореЗрд░рд┐рдХреА рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХреА рдХрдВрдкрдирд┐рдпреЛрдВ рдХрд╛ рдкреВрдВрдЬреАрдХрд░рдг $ 5 рдЯреНрд░рд┐рд▓рд┐рдпрди рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛ рдЧрдпрд╛</a></li>
<li><a href="../hi484482/index.html">рдЬрд▓ рдЙрдкрдЪрд╛рд░ рдкрд░ рдПрдХ рдЫреЛрдЯрд╛ рд╢реИрдХреНрд╖рд┐рдХ рдХрд╛рд░реНрдпрдХреНрд░рдо</a></li>
<li><a href="../hi484484/index.html">рдЙрдмрдВрдЯреВ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдбреЗрд╕реНрдХрдЯреЙрдк рд▓рд┐рдирдХреНрд╕ рдирд╣реАрдВ рд╣реИ</a></li>
<li><a href="../hi484486/index.html">рдПрдХ рдХрдВрдкреНрдпреВрдЯрд░ рдЬреЛ рдорд░рдиреЗ рд╕реЗ рдЗрдирдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi484488/index.html">рдХреНрд╡рд╛рдВрдЯрдо рд╕рд┐рд╕реНрдЯрдо рдХрд┐рддрдирд╛ рднреНрд░рд╛рдордХ рд╣реИ? рдЗрд╕рдХрд╛ рдЙрддреНрддрд░ рдЧрдгрдирд╛ рдпреЛрдЧреНрдп рдирд╣реАрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>