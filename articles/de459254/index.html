<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤛🏼 👣 🆒 Noch bessere Reißverschlussbombe ♏️ 👩🏼‍🚒 🕴🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Artikel zeigt, wie Sie eine nicht rekursive Zip-Bombe erstellen, die ein hohes Maß an Komprimierung bietet, indem Sie Dateien in einem Zip-Contain...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Noch bessere Reißverschlussbombe</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459254/"> Der Artikel zeigt, wie Sie eine <i>nicht rekursive</i> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zip-Bombe</a> erstellen, die ein hohes Maß an Komprimierung bietet, indem Sie Dateien in einem Zip-Container überlappen.  "Nicht rekursiv" bedeutet, dass es nicht von den Dekomprimierern abhängt, die in Zip-Archive eingebettete Dateien dekomprimieren: Es gibt nur eine Runde.  Die Ausgabegröße erhöht sich quadratisch von der Eingabe und erreicht ein Komprimierungsverhältnis von mehr als 28 Millionen (10 MB → 281 TB) innerhalb des Zip-Formats.  Eine weitere Erweiterung ist mit 64-Bit-Erweiterungen möglich.  Das Design verwendet nur den gängigsten DEFLATE-Komprimierungsalgorithmus und ist mit den meisten Zip-Parsern kompatibel. <br><br><a name="2"></a><ul><li>  <a href="">zbsm.zip</a> 42 kB → 5,5 GB <br></li><li>  <a href="">zblg.zip</a> 10 MB → 281 TB <br></li><li>  <a href="">zbxl.zip</a> 46 MB → 4,5 PB (Zip64, weniger kompatibel mit Parsern) </li></ul><br>  Quellcode: <br><pre>  Git-Klon https://www.bamsoftware.com/git/zipbomb.git </pre>  <a href="">zipbomb-20190702.zip</a> <br><br>  Daten und Quelle der Abbildungen: <br><pre>  Git-Klon https://www.bamsoftware.com/git/zipbomb-paper.git </pre><a name="habracut"></a><br><div class="scrollable-table"><table><thead><tr><td colspan="2"></td><th colspan="2">  nicht rekursiv </th><th colspan="2">  rekursiv </th></tr><tr><td></td><th>  Archivgröße </th><th>  unkomprimierte Größe </th><th>  das Verhältnis </th><th>  unkomprimierte Größe </th><th>  das Verhältnis </th></tr></thead><tbody><tr><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quine Cox</a> </th><td>  440 </td><td>  440 </td><td>  1.0 </td><td>  ∞ </td><td>  ∞ </td></tr><tr><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://web.archive.org/web/20160130230432/">Quine Ellingsen</a> </th><td>  28.809 </td><td>  42 569 </td><td>  1.5 </td><td>  ∞ </td><td>  ∞ </td></tr><tr><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">42.zip</a> </th><td>  42.374 * </td><td>  558 432 </td><td>  13.2 </td><td>  4 507 981 343 026 016 </td><td>  106 Milliarden </td></tr><tr><th>  diese Technik </th><td>  42,374 </td><td>  5 461 307 620 </td><td>  129 Tausend </td><td>  5 461 307 620 </td><td>  129 Tausend </td></tr><tr><th>  diese Technik </th><td>  9 893 525 </td><td>  281 395 456 244 934 </td><td>  28 Millionen </td><td>  281 395 456 244 934 </td><td>  28 Millionen </td></tr><tr><th>  diese Technik (Zip64) </th><td>  45 876 ​​952 </td><td>  4 507 981 427 706 459 </td><td>  98 Millionen </td><td>  4 507 981 427 706 459 </td><td>  98 Millionen </td></tr></tbody></table></div><br>  <sub>* Es gibt zwei Versionen von 42.zip: die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://web.archive.org/web/20120222083624/">alten</a> 42 374 Bytes und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://web.archive.org/web/20120301154142/">die neueren</a> 42 428 Bytes.</sub>  <sub>Der Unterschied besteht darin, dass der neue vor dem Auspacken ein Passwort benötigt.</sub>  <sub>Wir vergleichen nur mit der alten Version.</sub>  <sub>Hier ist eine Kopie der Datei, falls Sie sie benötigen: <a href="">42.zip</a> .</sub> <sub><br><br></sub>  <sub>** Ich möchte den Autor von 42.zip kennen und angeben, konnte ihn aber nicht finden - lassen Sie mich wissen, wenn Sie Informationen haben.</sub> <br><br>  Zip-Bomben müssen die Tatsache überwinden, dass der von Parsern am häufigsten unterstützte DEFLATE-Komprimierungsalgorithmus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das</a> Komprimierungsverhältnis von 1032 zu 1 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nicht überschreiten kann</a> . Aus diesem Grund basieren Zip-Bomben normalerweise auf rekursiver Dekomprimierung, indem Zip-Dateien in Zip-Dateien eingebettet werden, um ein zusätzliches Verhältnis zu erhalten 1032 mit jeder Schicht.  Der Trick funktioniert jedoch nur in Implementierungen, die rekursiv dekomprimieren, und die meisten nicht.  Die berühmteste <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">42.zip-</a> Bombe dehnt sich auf beeindruckende 4,5 PB aus, wenn alle sechs Schichten rekursiv entpackt werden, auf der obersten Schicht jedoch nur 0,6 MB.  Zip-Quines geben wie die von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cox</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://web.archive.org/web/20160130230432/">Ellingsen</a> eine Kopie von sich selbst aus und dehnen sich daher beim rekursiven Auspacken unbegrenzt aus.  Sie sind aber auch beim einmaligen Auspacken absolut sicher. <br><br>  Dieser Artikel zeigt, wie eine nicht rekursive Zip-Bombe erstellt wird, deren Komprimierungsrate die DEFLATE-Grenze von 1032 überschreitet. Dabei werden Dateien in einem Zip-Container überlappt, um auf den „Kern“ stark komprimierter Daten in mehreren Dateien zu verweisen, ohne mehrere Kopien zu erstellen.  Die Ausgabegröße der Reißverschlussbombe wächst quadratisch aus der Eingabegröße.  d.h. das Kompressionsverhältnis verbessert sich mit zunehmender Bombengröße.  Das Design hängt von den Funktionen von zip und DEFLATE ab: Es kann nicht direkt in andere Dateiformate oder Komprimierungsalgorithmen übertragen werden.  Die Bombe ist mit den meisten Zip-Parsern kompatibel, mit Ausnahme von Streaming-Parsern, die Dateien in einem einzigen Durchgang analysieren, ohne das zentrale Verzeichnis der Zip-Datei zu überprüfen.  Wir versuchen zwei widersprüchliche Ziele in Einklang zu bringen: <br><br><ul><li>  Kompressionsverhältnis erhöhen.  Wir definieren das Komprimierungsverhältnis als die Summe der Größen aller Dateien im Archiv geteilt durch die Größe der Zip-Datei selbst.  Es werden keine Dateinamen oder andere Dateisystem-Metadaten berücksichtigt, sondern nur der Inhalt. <br></li><li>  Kompatibilität beibehalten.  Zip ist ein komplexes Format, und Parser unterscheiden sich insbesondere in Grenzsituationen und in zusätzlichen Funktionen.  Verwenden Sie keine Techniken, die nur mit bestimmten Parsern funktionieren.  Wir werden einige Möglichkeiten zur Steigerung der Effizienz einer Zip-Bombe mit einem gewissen Kompatibilitätsverlust aufzeigen. </li></ul><br><h1>  Zip-Dateistruktur </h1><br>  Die Zip-Datei besteht aus einem <i>zentralen Verzeichnis von</i> Dateilinks. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/896/5d8/074/8965d80745e0b95831b8e3f7c68c5386.svg"><br><br>  Das zentrale Verzeichnis befindet sich am Ende der Zip-Datei.  Dies ist eine Liste der <i>zentralen Verzeichnisheader</i> .  Jeder zentrale Verzeichnisheader enthält Metadaten für eine einzelne Datei, z. B. den Dateinamen und die CRC-32-Prüfsumme, sowie einen Zeiger zurück auf den lokalen Dateikopf.  Der zentrale Verzeichnisheader hat eine Länge von 46 Bytes plus der Länge des Dateinamens. <br><br>  Die Datei besteht aus dem Header der lokalen Datei, gefolgt von den komprimierten Dateidaten.  Die Länge des lokalen Dateikopfs beträgt 30 Byte plus die Länge des Dateinamens.  Es enthält eine redundante Kopie der Metadaten aus dem Header des zentralen Verzeichnisses sowie die Größe der komprimierten und nicht komprimierten Datendateien dahinter.  Zip ist ein Containerformat, kein Komprimierungsalgorithmus.  Die Daten jeder Datei werden mit dem in den Metadaten angegebenen Algorithmus komprimiert - normalerweise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DEFLATE</a> . <br><br>  In dieser Beschreibung des Zip-Formats werden viele Details ausgelassen, die zum Verständnis der Zip-Bombe nicht erforderlich sind.  Vollständige Informationen finden Sie in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschnitt 4.3 APPNOTE.TXT</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">„PKZip File Structure“ von</a> Florian Buchholz oder im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quellcode</a> . <br><br>  Signifikante Redundanz und viele Unklarheiten im Zip-Format eröffnen Möglichkeiten für Unfug verschiedener Art.  Eine Reißverschlussbombe ist nur die Spitze des Eisbergs.  Links zur weiteren Lektüre: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">"Zehntausend Sicherheitsfallen: Ein ZIP-Format" von</a> Ginwael Coldwind <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Durch mehrdeutiges Zip-Parsing können Sie Firefox-Add-On-Dateien vor dem Linter und anderen Personen verbergen</a> : meine Sicherheitslücke bei addons.mozilla.org </li></ul><br><h1>  Erste Entdeckung: Überlappende Dateien </h1><br>  Durch Komprimieren einer langen Folge von wiederholten Bytes können wir einen <i>Kern</i> hochkomprimierter Daten erstellen.  Das Komprimierungsverhältnis des Kernels selbst darf das DEFLATE-Limit von 1032 nicht überschreiten. Daher benötigen wir eine Möglichkeit, den Kernel in vielen Dateien wiederzuverwenden, ohne in jeder Datei eine separate Kopie davon zu erstellen.  Wir können dies tun, indem wir Dateien überlappen: Stellen Sie sicher, dass viele Header des zentralen Verzeichnisses auf eine einzelne Datei verweisen, deren Daten der Kern sind. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f80/675/a85/f80675a8530b8adfc1d5847eaaf813ca.svg"><br><br>  Betrachten Sie ein Beispiel dafür, wie sich dieses Design auf das Komprimierungsverhältnis auswirkt.  Angenommen, ein Kern von 1000 Bytes wird in 1 MB entpackt.  Dann „kostet“ das erste Megabyte Ausgabe 1078 Byte Eingabedaten: <br><br><ul><li>  31 Bytes für den lokalen Dateikopf (einschließlich 1-Byte-Dateiname) <br></li><li>  47 Bytes für den zentralen Verzeichnisheader (einschließlich eines 1-Byte-Dateinamens) <br></li><li>  1000 Bytes pro Kern </li></ul><br>  Aber jede 1 MB Ausgabe nach der ersten kostet nur 47 Bytes - wir brauchen keinen weiteren Header der lokalen Datei oder eine andere Kopie des Kernels, nur einen zusätzlichen Header des zentralen Verzeichnisses.  Während die erste Verbindung vom Kern ein Kompressionsverhältnis von 1.000.000 / 1.078 ≈ 928 aufweist, bewegt jede zusätzliche Verbindung den Koeffizienten näher an 1.000.000 / 47 ≈ 21.277, und ein großer Kern erhöht die Decke. <br><br>  Das Problem bei dieser Idee ist die mangelnde Kompatibilität.  Da viele Header des zentralen Verzeichnisses auf einen Header der lokalen Datei verweisen, können die Metadaten (insbesondere der Dateiname) nicht für jede Datei gleich sein.  Einige Parser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">schwören darauf</a> .  Zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ruft Info-ZIP UnZip</a> (das Standard- <code>unzip</code> unter Unix) Dateien ab, jedoch mit Warnungen: <br><br><pre>  $ unzip overrap.zip
   Aufblasen: A.
 B: Nicht übereinstimmender "lokaler" Dateiname (A),
          Fortsetzung mit "zentraler" Dateinamenversion
   Aufblasen: B.
 ... </pre><br>  Python <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zipfile löst</a> auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eine Ausnahme aus</a> : <br><br><pre>  $ python3 -m zipfile -e überlappende.zip.
 Traceback (letzter Anruf zuletzt):
 ...
 __main __. BadZipFile: Dateiname im Verzeichnis 'B' und Header b'A 'unterscheiden sich. </pre><br>  Als Nächstes sehen wir uns an, wie Sie die Konsistenz von Dateinamen neu gestalten und dabei die meisten Vorteile überlappender Dateien beibehalten. <br><br><h1>  Zweite Entdeckung: Zitieren der Header lokaler Dateien </h1><br>  Wir müssen die Header der lokalen Dateien für jede Datei trennen, während wir einen Kern wiederverwenden.  Das einfache Kombinieren aller Header funktioniert nicht, da der Zip-Parser den Header der lokalen Datei findet, in der er den Start des DEFLATE-Streams erwartet.  Aber die Idee wird funktionieren, mit geringfügigen Änderungen.  Wir werden die DEFLATE-Funktion von unkomprimierten Blöcken verwenden, um die Header lokaler Dateien so zu "zitieren", dass sie Teil desselben DEFLATE-Streams zu sein scheinen, der im Kernel endet.  Jeder Header der lokalen Datei (mit Ausnahme der ersten) wird auf zwei Arten interpretiert: als Code (Teil der Struktur der Zip-Datei) und als Daten (Teil des Dateiinhalts). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1c1/668/e92/1c1668e92501880340aaf1651df25095.svg"><br><br>  Ein DEFLATE-Stream ist eine Folge von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Blöcken, bei</a> denen jeder Block komprimiert oder nicht komprimiert werden kann.  Wir denken normalerweise nur an komprimierte Blöcke, zum Beispiel ist der Kernel ein großer komprimierter Block.  Es gibt aber auch unkomprimierte, die mit einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5-Byte-Header</a> mit einem Längenfeld beginnen, was einfach bedeutet: "Drucke die nächsten <i>n</i> Bytes wörtlich."  Das Entpacken eines unkomprimierten Blocks bedeutet nur das Löschen des 5-Byte-Headers.  Komprimierte und unkomprimierte Blöcke können sich im DEFLATE-Stream frei mischen.  Die Ausgabe ist eine Verkettung der Ergebnisse des Entpackens aller Blöcke in der angegebenen Reihenfolge.  Das Konzept „unkomprimiert“ ist nur auf DEFLATE-Ebene von Bedeutung.  Dateidaten werden auf Zip-Ebene weiterhin als "komprimiert" betrachtet, unabhängig davon, welche Blöcke verwendet werden. <br><br>  Der einfachste Weg, sich dieses Design vorzustellen, ist eine interne Überlappung von der letzten zur ersten Datei.  Wir beginnen mit dem Einfügen eines Kernels, der das Ende der Datendatei für jede Datei bildet.  Fügen Sie den Header der lokalen LFH <sub><i>N-</i></sub> Datei und den Header des zentralen CDH <sub><i>N-</i></sub> Verzeichnisses hinzu, das darauf verweist.  Stellen Sie das Metadatenfeld "Komprimierte Größe" in LFH <sub><i>N</i></sub> und CDH <sub><i>N</i></sub> auf die komprimierte Kerngröße ein.  Fügen Sie nun den 5-Byte-Header des unkomprimierten Blocks hinzu (im Diagramm grün dargestellt), dessen Längenfeld der Größe LFH <sub><i>N entspricht.</i></sub>  Fügen Sie den zweiten Header der lokalen LFH-Datei <sub><i>N</i> −1</sub> und den Titel des zentralen Verzeichnisses CDH <sub><i>N</i> −1 hinzu</sub> , das darauf verweist.  Legen Sie das Metadatenfeld "komprimierte Größe" als neuen Header für die komprimierte Kernelgröße <i>plus die</i> Größe des unkomprimierten Blockheaders (5 Byte) <i>plus die</i> Größe von LFH <sub><i>N fest.</i></sub> <br><br>  Im Moment enthält die Zip-Datei zwei Dateien mit den Namen Y und Z. Lassen Sie uns durchgehen, was der Parser beim Parsen sieht.  Angenommen, die komprimierte Kernelgröße beträgt 1000 Byte und die LFH <sub><i>N-</i></sub> Größe beträgt 31 Byte.  Wir beginnen mit CDH <sub><i>N</i> −1</sub> und folgen dem Vorzeichen für LFH <sub><i>N</i> −1</sub> .  Der Name der ersten Datei lautet Y, und die komprimierte Größe der Datendatei beträgt 1036 Byte.  Wenn wir die nächsten 1036 Bytes als DEFLATE-Stream interpretieren, stoßen wir zuerst auf einen 5-Byte-Header eines unkomprimierten Blocks, der besagt, dass die nächsten 31 Bytes kopiert werden sollen.  Wir schreiben die nächsten 31 Bytes auf, die LFH <sub><i>N sind</i></sub> , die wir entpacken und zur Y-Datei hinzufügen. Wenn wir uns weiter im DEFLATE-Stream bewegen, finden wir den komprimierten Block (Kernel), den wir in die Y-Datei entpacken. Jetzt haben wir das Ende der komprimierten Daten erreicht und sind mit der Y-Datei fertig. <br><br>  Wenn wir zur nächsten Datei übergehen, folgen wir dem Zeiger von CDH <sub><i>N</i></sub> auf LFH <sub><i>N</i></sub> und finden eine Datei mit dem Namen Z mit einer komprimierten Größe von 1000 Bytes.  Wenn wir diese 1000 Bytes als DEFLATE-Stream interpretieren, stoßen wir sofort auf einen komprimierten Block (wieder Core) und entpacken ihn in eine Z-Datei. Jetzt haben wir das Ende der endgültigen Datei erreicht und sind fertig.  Die Ausgabedatei Z enthält den entpackten Kernel;  Die Ausgabedatei Y ist dieselbe, jedoch optional mit einem Präfix von 31 Byte LFH <sub><i>N.</i></sub> <br><br>  Wir schließen die Konstruktion ab, indem wir den Zitiervorgang wiederholen, bis das Zip-Archiv die erforderliche Anzahl von Dateien enthält.  Jede neue Datei fügt einen zentralen Verzeichnisheader, einen lokalen Dateikopf und einen unkomprimierten Block hinzu, um direkt aus dem nächsten lokalen Dateikopf zu zitieren.  Komprimierte Dateidaten sind normalerweise eine Kette von nicht komprimierten DEFLATE-Blöcken (zitierte lokale Dateikopfzeilen), gefolgt von einem komprimierten Kern.  Jedes Byte im Kernel trägt ungefähr 1032 <i>N</i> zur Ausgabegröße bei, da jedes Byte Teil aller <i>N</i> Dateien ist.  Die Ausgabedateien haben auch unterschiedliche Größen: Die früheren sind größer als die späteren, da sie die Überschriften der lokalen Dateien häufiger zitieren.  Der Inhalt der Ausgabedateien macht nicht viel Sinn, aber niemand sagte, dass es Sinn machen sollte. <br><br>  Dieses Überlappungszitierungsdesign ist besser kompatibel als das vollständige Überlappungsdesign aus dem vorherigen Abschnitt, aber die Kompatibilität wird durch Komprimierung erreicht.  Dort kostet jede hinzugefügte Datei nur den Titel des zentralen Verzeichnisses, hier den Titel des zentralen Verzeichnisses, den Header der lokalen Datei und weitere 5 Bytes für den Citation-Header. <br><br><h1>  Optimierung </h1><br>  Nachdem wir das grundlegende Design der Reißverschlussbombe erhalten haben, werden wir versuchen, sie so effizient wie möglich zu gestalten.  Wir wollen zwei Fragen beantworten: <br><br><ul><li>  Was ist das maximale Komprimierungsverhältnis für eine bestimmte Zip-Dateigröße? <br></li><li>  Was ist das maximale Komprimierungsverhältnis angesichts der Einschränkungen des Zip-Formats? </li></ul><br><h3>  Kernel-Komprimierung </h3><br>  Es ist für uns von Vorteil, den Kernel so weit wie möglich zu komprimieren, da jedes entpackte Byte mit <i>N</i> multipliziert wird <i>.</i>  Zu diesem Zweck verwenden wir einen benutzerdefinierten DEFLATE-Kompressor namens massiven_deflate, der auf das Komprimieren einer Zeichenfolge wiederholter Bytes spezialisiert ist. <br><br>  Alle anständigen DEFLATE-Archivierer kommen dem Komprimierungsverhältnis von 1032 in einem endlosen Strom wiederholter Bytes nahe, aber wir sind besorgt über die spezifische Größe.  In unserer Archivgröße enthält Bulk_deflate mehr Daten als Allzweckarchivierer: etwa 26 KB mehr als zlib und Info-ZIP und etwa 15 KB mehr als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zopfli</a> , wodurch die Geschwindigkeit aus Gründen der Komprimierungsqualität beeinträchtigt wird. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b4/cac/e5b/8b4cace5b49ef6945fd1d1ddc8fd7310.svg"><br><br>  Der Preis eines hohen Kompressionsverhältnisses mass_deflate - der Mangel an Vielseitigkeit.  Es können nur Zeilen mit sich wiederholenden Bytes und nur eine bestimmte Länge komprimiert werden, nämlich 517 + 258 <i>k</i> für eine Ganzzahl <i>k</i> ≥ 0. Zusätzlich zu einer guten Komprimierung arbeitetulk_deflate schnell und führt die Arbeit unabhängig von der Größe der Eingabedaten fast zur gleichen Zeit aus. Zählen der Arbeit des tatsächlichen Schreibens einer komprimierten Zeichenfolge. <br><br><a name="1"></a><h3>  Dateinamen </h3><br>  Für unsere Zwecke sind Dateinamen fast tot.  Obwohl sie zur Ausgabegröße beitragen, indem sie Teil der zitierten Header lokaler Dateien sind, tragen die Bytes im Dateinamen viel weniger bei als die Bytes im Kernel.  Wir möchten, dass die Dateinamen so kurz wie möglich und unterschiedlich sind, ohne die Kompatibilität zu vergessen. <br><br>  Jedes für einen Dateinamen ausgegebene Byte bedeutet zwei nicht für den Kernel ausgegebene Bytes (zwei, da jeder Dateiname zweimal angezeigt wird: im Header des zentralen Verzeichnisses und im Header der lokalen Datei).  Ein Dateinamenbyte ergibt einen Durchschnitt von nur ( <i>N</i> + 1) / 4 Bytes der Ausgabe, während ein Byte im Kernel als 1032 <i>N zählt.</i>  Beispiele: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">3</a> . <br><br>  Die erste Überlegung zur Kompatibilität ist die Codierung.  Die Zip-Format-Spezifikation besagt, dass Dateinamen als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CP 437</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">UTF-8</a> interpretiert werden sollten, wenn ein bestimmtes Flag-Bit gesetzt ist ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">APPNOTE.TXT, Anhang D</a> ).  Dies ist der Hauptgrund für die Inkompatibilität zwischen Zip-Parsern, die Dateinamen in einer festen oder länderspezifischen Codierung interpretieren können.  Aus Kompatibilitätsgründen ist es daher besser, sich auf Zeichen mit derselben Codierung in CP 437 und UTF-8 zu beschränken.  Dies sind nämlich 95 druckbare US-ASCII-Zeichen. <br><br>  Wir sind auch an Namensbeschränkungen für Dateisysteme gebunden.  Bei einigen Dateisystemen wird die Groß- und Kleinschreibung nicht berücksichtigt, daher werden 'a' und 'A' nicht als unterschiedliche Namen betrachtet.  Gängige Dateisysteme wie FAT32 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verbieten bestimmte Zeichen</a> wie '*' und '?'. <br><br>  Als sicheren, aber nicht unbedingt optimalen Kompromiss verwendet unsere Zip-Bombe Dateinamen aus dem 36-stelligen Alphabet, das keine Sonderzeichen und Zeichen in verschiedenen Groß- und Kleinschreibung enthält: <br><br><pre>  0 1 2 3 4 5 6 7 8 9 ABCDEFGHIJKLMNOPQRSTU VWXYZ </pre><br>  Dateinamen werden auf offensichtliche Weise generiert, alle Positionen der Reihe nach, wobei eine Position am Ende der Schleife hinzugefügt wird: <br><br><pre>  "0", "1", "2", ..., "Z",
 "00", "01", "02", ..., "0Z",
 ...
 "Z0", "Z1", "Z2", ..., "ZZ",
 "000", "001", "002", ... </pre><br>  Es gibt 36 einstellige Dateinamen, 36² zweistellige Dateinamen usw.  Vier Bytes reichen für 1.727.604 verschiedene Dateinamen. <br><br>  Wie kann ich sie besser sortieren, da die Dateinamen im Archiv normalerweise unterschiedlich lang sind: vom kürzesten zum längsten oder umgekehrt?  Wenn Sie ein wenig nachdenken, ist es besser, die längsten Namen zuletzt zu setzen.  Diese Sortierung fügt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zblg.zip</a> mehr als 900 MB Ausgabe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hinzu</a> , verglichen mit der längsten bis kürzesten Bestellung.  Dies ist jedoch eine geringfügige Optimierung, da 900 MB nur 0,0003% der Gesamtgröße des Problems ausmachen. <br><br><h3>  Kerngröße </h3><br>  Überlappendes Angebotsdesign ermöglicht es Ihnen, einen komprimierten Datenkern zu platzieren und ihn dann viele Male kostengünstig zu kopieren.  Wie viel Speicherplatz ist für eine bestimmte Größe der Zip-Datei <i>X</i> optimal zum Speichern des Kernels zuzuweisen und wie viel zum Erstellen von Kopien? <br><br>  Um das optimale Gleichgewicht zu finden, müssen Sie nur eine Variable <i>N</i> optimieren, die Anzahl der Dateien im Zip-Archiv.  Jeder <i>N-</i> Wert erfordert einen bestimmten Overhead für die Header des zentralen Verzeichnisses, die Header lokaler Dateien, die Header von Zitierblöcken und die Dateinamen.  Der Rest des Raumes wird vom Kern eingenommen.  Da <i>N</i> eine Ganzzahl sein muss und Sie nur eine bestimmte Anzahl von Dateien einfügen können, bevor die Kernelgröße auf Null fällt, reicht es aus, jeden möglichen Wert von <i>N</i> zu überprüfen und den Wert auszuwählen, der die größte Ausgabe liefert. <br><br>  Durch Anwenden des Optimierungsverfahrens auf <i>X</i> = 42.374 für 42.zip wird ein Maximum bei <i>N</i> = 250 gefunden. Diese 250 Dateien erfordern 21.195 Byte Overhead, sodass 21.179 Byte für den Kernel übrig bleiben.  Ein Kernel dieser Größe wird in 21.841.249 Bytes (1031,3 zu 1 Verhältnis) entpackt.  250 Kopien des entpackten Kernels sowie einige zitierte Header lokaler Dateien ergeben eine entpackte Gesamtausgabe von 5.461.307.620 Bytes und ein Komprimierungsverhältnis von 129.000. <br><br><ul><li>  <a href="">zbsm.zip</a> 42 kB → 5,5 GB </li></ul><pre>  zipbomb --mode = quote_overlap --num-files = 250 --compressed-size = 21179&gt; zbsm.zip </pre><br>  Die Optimierung hat zu einer nahezu gleichmäßigen Verteilung des Speicherplatzes zwischen dem Kernel und den Dateiköpfen geführt.  Dies ist kein Zufall.  Betrachten Sie ein vereinfachtes Modell einer Zitierkonstruktion mit Überlappung.  In einem vereinfachten Modell ignorieren wir Dateinamen sowie eine leichte Vergrößerung der Ausgabedatei aufgrund der Angabe der Header lokaler Dateien.  Die Analyse des vereinfachten Modells zeigt, dass die optimale Verteilung zwischen dem Kernel und den Dateikopfzeilen ungefähr gleichmäßig ist und die Ausgabegröße mit der optimalen Verteilung in Abhängigkeit von der Größe der Eingabe quadratisch wächst. <br><br>  Definition einiger Konstanten und Variablen: <br><br><div class="scrollable-table"><table><tbody><tr><td>  X. </td><td></td><td>  Größe der Zip-Datei (als fest angesehen) </td></tr><tr><td>  N. </td><td></td><td>  Anzahl der Dateien im Zip-Archiv (Variable zur Optimierung) </td></tr><tr><td>  Cdh </td><td>  = 46 </td><td>  Größe des zentralen Verzeichnis-Headers (ohne Dateinamen) </td></tr><tr><td>  Lfh </td><td>  = 30 </td><td>  Größe des lokalen Dateikopfs (ohne Dateinamen) </td></tr><tr><td>  Q. </td><td>  = 5 </td><td>  DEFLATE Block unkomprimierte Größe </td></tr><tr><td>  C. </td><td>  ≈ 1032 </td><td>  Kernel-Komprimierungsverhältnis </td></tr></tbody></table></div><br>  Sei <i>H (N)</i> das Volumen des Overheads für Header für <i>N</i> Dateien.  Sehen Sie sich die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tabelle</a> an, um die Essenz der Formel zu verstehen. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">H</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">N</span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7">N</span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">H</span><span class="MJXp-mo" id="MJXp-Span-13" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">F</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16">H</span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">N</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mn" id="MJXp-Span-22">1</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0.333em; margin-right: 0.333em;">≤</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">Q</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.641ex" height="2.66ex" viewBox="0 -832 19651 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-48" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="888" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4E" x="1278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="2166" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-3D" x="2833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4E" x="3890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2264" x="5056" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="6112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-43" x="6502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-44" x="7262" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-48" x="8091" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2B" x="9201" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4C" x="10202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-46" x="10884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-48" x="11633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="12522" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2B" x="13133" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="14134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4E" x="14524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2212" x="15634" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-31" x="16635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="17135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2264" x="17803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-51" x="18859" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> H (N) = N ≤ (CDH + LFH) + (N - 1) ≤ Q </script></p><br>  Für den Kernel bleiben <i>X - H (N)</i> Stellen übrig.  Die gesamte entpackte Größe <i>S <sub>X</sub> (N)</i> entspricht der Größe von <i>N</i> Kopien des entpackten Kernels mit dem Verhältnis <i>C</i> (in diesem vereinfachten Modell ignorieren wir die geringfügige zusätzliche Erweiterung der genannten lokalen Dateikopfzeilen). <br><br><p><math> </math> $$ Anzeige $$ S_X (N) = (X - H (N)) CN \\ = (X - (N ⋅ (CDH + LFH) + (N - 1) ⋅ Q)) CN \\ = - (CDH + LFH + Q) CN ^ 2 + (X + Q) CN $$ Anzeige $$ </p><br>  S <sub>X</sub> (N) ist in Teil N ein Polynom, daher sollte das Maximum dort sein, wo die Ableitung S ' <sub>X</sub> (N) gleich Null ist.  Wenn wir die Ableitung nehmen und Null finden, erhalten wir N <sub>OPT</sub> , die optimale Anzahl von Dateien. <br><br><p><math> </math> $$ Anzeige $$ S'X (N_ {OPT}) = –2 (CDH + LFH + Q) C N_ {OPT} + (X + Q) C \\ 0 = –2 (CDH + LFH + Q) C. N_ {OPT} + (X + Q) C \\ N_ {OPT} = (X + Q) / (CDH + LFH + Q) / 2 $$ Anzeige $$ </p><br>  <i>H (N <sub>OPT</sub> )</i> bietet den optimalen Platz zum Platzieren von Datei-Headern.  Es ist unabhängig von CDH, LFH und C und liegt nahe bei <i>X / 2</i> . <br><br><p><math> </math> $$ Anzeige $$ H (N_ {OPT}) = N_ {OPT} ⋅ (CDH + LFH) + (N_ {OPT} - 1) ⋅ Q \\ = (X - Q) / 2 $$ Anzeige $$ </p><br>  S <sub>X</sub> (N <sub>OPT</sub> ) - Gesamtgröße beim Auspacken bei optimaler Verteilung.  Daraus ergibt sich, dass die Größe der Ausgabe mit zunehmenden Eingabedaten quadratisch zunimmt. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-249"><span class="MJXp-msubsup" id="MJXp-Span-250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-252" style="vertical-align: -0.4em;">X</span></span><span class="MJXp-mo" id="MJXp-Span-253" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-254"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255" style="margin-right: 0.05em;">N</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-256" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">O</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">P</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">X</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">Q</span><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-268" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">C</span><span class="MJXp-mrow" id="MJXp-Span-270"><span class="MJXp-mo" id="MJXp-Span-271" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">C</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">H</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">L</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">F</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279">H</span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">Q</span><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-283"><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-285">4</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.954ex" height="3.021ex" viewBox="0 -987.6 21077.5 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-58" x="867" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="1316" y="0"></use><g transform="translate(1705,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4E" x="0" y="0"></use><g transform="translate(803,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-50" x="763" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-54" x="1514" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="4178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-3D" x="4846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="5902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-58" x="6291" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2B" x="7366" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-51" x="8367" y="0"></use><g transform="translate(9158,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-43" x="10002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2F" x="10762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="11263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-43" x="11652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-44" x="12413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-48" x="13241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2B" x="14352" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4C" x="15353" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-46" x="16034" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-48" x="16784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2B" x="17894" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-51" x="18895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="19687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-2F" x="20076" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-34" x="20577" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> S_X (N_ {OPT}) = (X + Q) ^ 2C / (CDH + LFH + Q) / 4 </script></p><br>  Wenn Sie die Größe der Zip-Datei erhöhen, werden wir am Ende an die Grenzen des Zip-Formats stoßen: Das Archiv kann nicht mehr als 2 <sup>16</sup> -1-Dateien mit einer Größe von jeweils nicht mehr als 2 <sup>32</sup> -1 Bytes enthalten.  Schlimmer noch, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einige Implementierungen verwenden</a> Maximalwerte als Indikator für das Vorhandensein von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">64-Bit-Erweiterungen</a> , sodass unsere Grenzwerte tatsächlich 2 <sup>16</sup> −2 und 2 <sup>32</sup> −2 sind.  Es kommt vor, dass beim ersten Mal die Größe einer unkomprimierten Datei begrenzt wird.  Bei einer Zip-Dateigröße von 8 319 377 Bytes ergibt die naive Optimierung die Anzahl der Dateien 47 837 und eine maximale Datei von 2 <sup>32</sup> +311 Bytes. <br><br>  (Eigentlich ist alles etwas komplizierter, da die genauen Grenzen von der Implementierung abhängen. Die Python-Zip-Datei <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ignoriert die</a> Anzahl der Dateien. Mit Archiv / Zip in Go <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">können Sie</a> die Anzahl der Dateien erhöhen, bis sie den unteren 16 Bit entsprechen. Aus Gründen der allgemeinen Kompatibilität müssen wir uns jedoch daran halten festgelegte Grenzen). <br><br>  Wenn wir die <i>N-</i> oder Kernelgröße nicht unendlich erhöhen können, möchten wir das maximale Komprimierungsverhältnis innerhalb des Zip-Formats ermitteln.  Sie müssen den Kernel mit der maximalen Anzahl von Dateien so groß wie möglich machen.  Trotz der Tatsache, dass wir keine annähernd gleichmäßige Trennung zwischen dem Kernel und den Datei-Headern mehr aufrechterhalten können, erhöht jede hinzugefügte Datei das Komprimierungsverhältnis - nur nicht so schnell, als ob wir den Kernel weiter vergrößern könnten.  Tatsächlich müssen wir beim Hinzufügen von Dateien <i>die</i> Größe des Kernels <i>reduzieren</i> , um Speicherplatz für die maximale Dateigröße freizugeben, die mit jeder hinzugefügten Datei leicht wächst. <br><br>  Der Plan führt zu einem Zip-Archiv mit 2 <sup>16 -</sup> 2 Dateien und einem Kernel, der in 2 <sup>32 -</sup> 2 178 825 Bytes entpackt wird.  Die Dateien werden zu Beginn des Zip-Archivs größer - die erste und größte Datei wird in 2 <sup>32 -</sup> 56 Byte entpackt.  Dies ist so nah wie möglich an den groben Ausgabeparametern von mass_deflate - die Codierung der letzten 54 Bytes kostet mehr als ihre Größe (die gesamte Zip-Datei hat ein Komprimierungsverhältnis von 28 Millionen und die letzten 54 Bytes erhalten maximal 54 ⋅ 10 <sup>32</sup> ⋅ ( 2 <sup>16</sup> - 2) ≈ 36? 5 Millionen Bytes, dies hilft also nur, wenn 54 Bytes in ein Byte codiert werden können - und ich konnte nicht weniger als zwei codieren. Wenn Sie also 54 Bytes nicht in 1 Byte codieren können, es reduziert nur das Kompressionsverhältnis).  Die Ausgabegröße dieser Zip-Bombe beträgt 281.395.456.244.934 Byte, 99,97% des theoretischen Maximums (2 <sup>32</sup> - 1) × (2 <sup>16</sup> - 1).  Eine signifikante Verbesserung des Kompressionsverhältnisses kann nur durch Verringern der Größe des Eingangssignals und nicht durch Erhöhen des Ausgangs erreicht werden. <br><br><ul><li>  <a href="">zblg.zip</a> 10 MB → 281 TB </li></ul><pre>  zipbomb --mode = quote_overlap --num-files = 65534 --max-uncpressed-size = 4292788525&gt; zblg.zip </pre><br><h1>  Effizientes CRC-32-Computing </h1><br>  Unter den Metadaten im Header des zentralen Verzeichnisses und im Header der lokalen Datei befindet sich eine Prüfsumme der unkomprimierten Dateidaten - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CRC-32</a> .  Dies stellt ein Problem dar, da die Anzahl der CRC-32-Berechnungen für jede Datei proportional zu ihrer Größe ist, die standardmäßig sehr groß ist (schließlich handelt es sich um eine Zip-Bombe).  Wir würden es vorziehen, Arbeiten auszuführen, die mindestens proportional zur Größe des Archivs sind.  Zwei Faktoren sprechen für uns: Alle Dateien haben einen gemeinsamen Kern, und ein unkomprimierter Kernel ist eine Folge von wiederholten Bytes.  Stellen Sie sich CRC-32 als Matrixprodukt vor - so können wir nicht nur die Prüfsumme des Kernels schnell berechnen, sondern auch die Berechnungen zwischen Dateien wiederverwenden.  Die in diesem Abschnitt beschriebene Methode ist eine kleine Erweiterung der Funktion <a href="">crc32_combine</a> in zlib, die Mark Adler <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> erläutert. <br><br>  CRC-32 kann als Zustandsmaschine modelliert werden, wobei ein 32-Bit-Zustandsregister für jedes Eingangsbit aktualisiert wird.  Die grundlegenden Aktualisierungsoperationen für die Bits 0 und 1 sind: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">uint32 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">crc32_update_0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(uint32 state)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Shift out the least significant bit. bit b = state &amp; 1; state = state &gt;&gt; 1; // If the shifted-out bit was 1, XOR with the CRC-32 constant. if (b == 1) state = state ^ 0xedb88320; return state; } uint32 crc32_update_1(uint32 state) { // Do as for a 0 bit, then XOR with the CRC-32 constant. return crc32_update_0(state) ^ 0xedb88320; }</span></span></code> </pre> <br>  Wenn Sie das Zustandsregister als binären Vektor mit 32 Elementen darstellen und XOR für Addition und Multiplikation verwenden, ist <code>crc32_update_0</code> eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lineare Abbildung</a> .  es kann als Multiplikation mit einer binären 32 × 32- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Übergangsmatrix dargestellt werden</a> .  Um zu verstehen, warum, beachten Sie, dass beim Multiplizieren einer Matrix mit einem Vektor einfach die Spalten der Matrix addiert werden, nachdem jede Spalte mit dem entsprechenden Element des Vektors multipliziert wurde.  Der Verschiebungsoperationszustand <code>state &gt;&gt; 1</code> nimmt einfach jedes Bit <i>i</i> des Zustandsvektors und multipliziert es mit einem Vektor, der überall Null ist, mit Ausnahme von Bit <i>i</i> - 1 (Nummerierung der Bits von rechts nach links).  Relativ gesehen tritt der endgültige XOR- <code>state ^ 0xedb88320</code> nur auf, wenn Bit <code>b</code> gleich eins ist.  Dies kann als erste Multiplikation von b mit 0xedb88320 und dann als XORing in diesen Zustand dargestellt werden. <br><br>  Außerdem ist <code>crc32_update_1</code> nur eine <code>crc32_update_0</code> plus (XOR) <code>crc32_update_0</code> .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies führt zu </font></font><code>crc32_update_1</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einer affinen Transformation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Matrixmultiplikation, gefolgt von Abbildung (d. H. Vektoraddition). Wir können uns eine Matrixmultiplikation und -abbildung in einem Schritt vorstellen, wenn wir die Größe der Transformationsmatrix auf 33 × 33 erhöhen und dem Zustandsvektor ein zusätzliches Element hinzufügen, das immer 1 ist (diese Darstellung wird als </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">homogene Koordinaten bezeichnet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br><br><img src="https://habrastorage.org/webt/sg/ay/or/sgayorbdqetnkmc1y-qm42uywic.png"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Transformationsmatrizen sind 33 × 33 M </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und M </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die die durch die Bits 0 bzw. 1 vorgenommene CRC-32-Zustandsänderung berechnen. Spaltenvektoren werden mit dem höchstwertigen Bit unten gespeichert: Wenn Sie die erste Spalte von unten nach oben lesen, sehen Sie die Polynomkonstante CRC-32 edb8832016 = </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">111</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00000 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00 </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 00000 </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Diese beiden Matrizen unterscheiden sich nur in der letzten Spalte, die den Translationsvektor in homogenen Koordinaten darstellt. In M </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 ist die</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Translation Null und in M </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 ist es</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> edb88320 </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , die Polynomkonstante ist CRC-32. Die </font><font style="vertical-align: inherit;">Einheiten sind unmittelbar oberhalb der diagonalen Status der Operation</font></font><code>state &gt;&gt; 1</code></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beide Operationen</font></font><code>crc32_update_0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und</font></font><code>crc32_update_1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kann durch die Übergangsmatrix von 33 × 33 dargestellt werden. Die Matrizen M</font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und M</font><sub><font style="vertical-align: inherit;"> 1</font></sub><font style="vertical-align: inherit;"> sind gezeigt.</font></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Der Vorteil der Matrixdarstellung besteht darin, dass Matrizen multipliziert werden können. </font><font style="vertical-align: inherit;">Angenommen, wir möchten eine Statusänderung sehen, die durch Verarbeiten eines ASCII-Zeichens 'a' erfolgt, dessen binäre Darstellung 01100001 </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 ist</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Wir können uns die kumulative Änderung des Zustands des CRC-32 dieser acht Bits in einer Transformationsmatrix vorstellen:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-286"><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-289" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-291"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-293" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-296" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-299" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-300"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-302" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-303"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-305" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-308" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-311" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-314" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.921ex" height="2.419ex" viewBox="0 -780.1 14174.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-3D" x="1722" y="0"></use><g transform="translate(2778,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-30" x="1372" y="-213"></use></g><g transform="translate(4203,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-31" x="1372" y="-213"></use></g><g transform="translate(5627,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-31" x="1372" y="-213"></use></g><g transform="translate(7052,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-30" x="1372" y="-213"></use></g><g transform="translate(8476,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-30" x="1372" y="-213"></use></g><g transform="translate(9901,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-30" x="1372" y="-213"></use></g><g transform="translate(11325,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-30" x="1372" y="-213"></use></g><g transform="translate(12749,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-31" x="1372" y="-213"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6">M_a = M_0 M_1 M_1 M_0 M_0 M_0 M_0 M_1</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und wir können uns eine Änderung des Zustands einer Zeile vorstellen, die 'a' wiederholt, indem viele Kopien von M </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> multipliziert werden, </font><font style="vertical-align: inherit;">wodurch die Matrix zu einer Potenz erhöht wird. </font><font style="vertical-align: inherit;">Wir können diese schnell mit tun </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">schnell Potenzierung Algorithmus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , der die M zu berechnen erlaubt </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> log nur </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></sub> <sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schritte. </font><font style="vertical-align: inherit;">Hier ist zum Beispiel eine Matrix zum Ändern des Status einer Zeichenfolge mit 9 Zeichen 'a':</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-315"><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-319" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-320"><span class="MJXp-mo" id="MJXp-Span-321" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-322" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-326" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-329" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-332" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-335" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-338" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-341" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-344" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span></span><font style="vertical-align: inherit;"><span class="MJXp-msubsup" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">M </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-350" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">a </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">M </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">a </font></span></span></font><span class="MJXp-msubsup" id="MJXp-Span-348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-350" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a</font></font></span></span><span class="MJXp-mspace" id="MJXp-Span-351" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-353" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-356" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-msubsup" id="MJXp-Span-357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-359" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-msubsup" id="MJXp-Span-360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-362" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-msubsup" id="MJXp-Span-363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-365" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mo" id="MJXp-Span-367" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-368" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-371" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mspace" id="MJXp-Span-372" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-378" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-msubsup" id="MJXp-Span-379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-381" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-msubsup" id="MJXp-Span-382"><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-384" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-385"><span class="MJXp-mo" id="MJXp-Span-386" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-387" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-390" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-mspace" id="MJXp-Span-391" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-392" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-393" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-395" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-398" style="vertical-align: -0.4em;">a</span></span><span class="MJXp-msubsup" id="MJXp-Span-399"><span class="MJXp-mo" id="MJXp-Span-400" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-401" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-402"><span class="MJXp-mo" id="MJXp-Span-403" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-404" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-405"><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-407" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-410" style="vertical-align: -0.4em;">a</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="93.735ex" height="13.985ex" viewBox="0 -987.6 40358 6021.4" role="img" focusable="false" style="vertical-align: -11.691ex; max-width: 778px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(11670,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(1834,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-39" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-3D" x="2955" y="0"></use><g transform="translate(4011,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(5456,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(6901,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(8346,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(9791,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(11236,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(12681,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(14126,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(15571,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g></g><g transform="translate(15422,-1567)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-3D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="1056" y="0"></use><g transform="translate(1445,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(2890,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(4335,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(5780,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(7225,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-32" x="550" y="583"></use></g><g transform="translate(8068,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g></g><g transform="translate(16250,-3133)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-3D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="1056" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="1445" y="0"></use><g transform="translate(1835,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(3280,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(4725,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-32" x="550" y="583"></use></g><g transform="translate(5568,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-32" x="550" y="583"></use></g><g transform="translate(6411,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g></g><g transform="translate(16356,-4699)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-3D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="1056" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="1445" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-28" x="1835" y="0"></use><g transform="translate(2224,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g><g transform="translate(3669,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-32" x="550" y="583"></use></g><g transform="translate(4513,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-32" x="550" y="583"></use></g><g transform="translate(5356,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMAIN-32" x="550" y="583"></use></g><g transform="translate(6199,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-4D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://habr.com/ru/post/459254/&amp;usg=ALkJrhis7nldpO8TWLacW7ycdawj0DAyrQ#MJMATHI-61" x="1372" y="-213"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-7">(M_a)^9 = M_a M_a M_a M_a M_a M_a M_a M_a M_a\\ = (M_a M_a M_a M_a)^2 M_a\\ = ((M_a M_a)^2)^2 M_a\\ = (((M_a)^2)^2)^2 M_a</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Matrix-Schnellmultiplikationsalgorithmus ist nützlich für die Berechnung des M- </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kernels</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , einer Matrix für einen nicht komprimierten Kernel, da der Kernel eine Folge von wiederholten Bytes ist. Um die CRC-32-Prüfsumme aus der Matrix zu erhalten, multiplizieren Sie die Matrix mit dem Nullvektor (der Nullvektor hat einheitliche Koordinaten, dh 32 Nullen, und dann die Einheit; hier lassen wir die geringfügige Komplikation der Vor- und Nachbearbeitung der Prüfsumme weg, um die Übereinstimmung zu überprüfen). Um die Prüfsumme für jede Datei zu berechnen, arbeiten wir in die entgegengesetzte Richtung. Wir beginnen mit einem initialisierten </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M: M = </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">der Kern</font></font></sub></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Die Kernel-Prüfsumme ist auch die Prüfsumme der endgültigen Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , also multiplizieren wir </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M.</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein Nullvektor und speichert die empfangene Prüfsumme in der CDH </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und LFH </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Datendatei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N-1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sind die gleichen wie Dateidatendatei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , aber mit einem hinzugefügten Präfix LFH </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Deshalb berechnen wir</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-411"><span class="MJXp-msubsup" id="MJXp-Span-412"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-414" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mrow" id="MJXp-Span-416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-420" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , Zustandsänderungsmatrix für LFH</font><sub><font style="vertical-align: inherit;">N</font></sub><font style="vertical-align: inherit;">und Aktualisierung</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8">M_{L{FH_N}}</script><font style="vertical-align: inherit;"></font><sub><font style="vertical-align: inherit;"></font></sub><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0.111em; margin-right: 0.167em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L </font></font></span><span class="MJXp-mrow" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-433" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N.</font></font></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9">M := M M_{L{FH_N}}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nun </font><font style="vertical-align: inherit;">repräsentiert </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> die kumulative Zustandsänderung durch Verarbeitung von LFH </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hinter dem Kern. </font><font style="vertical-align: inherit;">Wir berechnen die Prüfsumme für die Datei </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N - 1</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und multiplizieren </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M erneut</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mit dem Nullvektor. </font><font style="vertical-align: inherit;">Wir setzen den Vorgang fort, indem wir Statusänderungsmatrizen in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> akkumulieren, </font><font style="vertical-align: inherit;">bis alle Dateien verarbeitet sind.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erweiterung: Zip64 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Früher hatten wir das Problem der Erweiterung aufgrund von Einschränkungen des Zip-Formats - es war unmöglich, mehr als 281 TB auszugeben, unabhängig davon, wie intelligent die Zip-Datei gepackt war. </font><font style="vertical-align: inherit;">Sie können diese Grenzen mit </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zip64 überschreiten</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, eine Erweiterung im Zip-Format, die die Größe einiger Header-Felder auf 64 Bit erhöht. Die Unterstützung für Zip64 ist keineswegs universell, aber eine der am häufigsten implementierten Erweiterungen. Das Komprimierungsverhältnis bewirkt, dass Zip64 die Größe des Headers des zentralen Verzeichnisses von 46 auf 58 Bytes und die Größe des Headers des lokalen Verzeichnisses von 30 auf 50 Bytes erhöht. Wenn wir uns die Formel für den optimalen Expansionskoeffizienten in einem vereinfachten Modell ansehen, sehen wir, dass die Zip-Bombe im Zip64-Format immer noch quadratisch wächst, aber aufgrund des größeren Nenners langsamer - dies ist in der folgenden Abbildung dargestellt. Aufgrund des Kompatibilitätsverlusts und der Wachstumsverzögerung entfernen wir fast alle Einschränkungen der Dateigröße.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Angenommen, wir brauchen eine Zip-Bombe, die sich auf 4.5 PB erweitert, wie 42.zip. </font><font style="vertical-align: inherit;">Wie groß sollte das Archiv sein? </font><font style="vertical-align: inherit;">Bei Verwendung der binären Suche stellen wir fest, dass die Mindestgröße einer solchen Datei 46 MB beträgt.</font></font><br><br><ul><li> <a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zbxl.zip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 46 MB → 4,5 PB (Zip64, weniger kompatibel)</font></font></li></ul><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zipbomb --mode = quote_overlap --num-files = 190023 --compressed-size = 22982788 --zip64&gt; zbxl.zip </font></font></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4,5 Petabyte - ungefähr die </font><font style="vertical-align: inherit;">gleiche </font><font style="vertical-align: inherit;">Datenmenge wurde vom Event Horizon Telescope für das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">erste Bild eines Schwarzen Lochs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aufgezeichnet </font><font style="vertical-align: inherit;">: Racks und Racks mit Festplatten im Rechenzentrum. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei Zip64 ist es fast nicht interessant, das maximale Komprimierungsverhältnis zu berücksichtigen, da wir einfach die Größe der Zip-Datei und das Komprimierungsverhältnis damit weiter erhöhen können, bis selbst die komprimierte Zip-Datei unzulässig wird. Ein interessanter Schwellenwert sind jedoch 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">64</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Byte (18 EB oder 16 EiB) - so viele Daten passen nicht auf die meisten Dateisysteme. Bei der binären Suche wird die kleinste Zip-Bombe gefunden, die mindestens genauso viel Ausgabe erzeugt: Sie enthält 12 Millionen Dateien und einen komprimierten Kern von 1,5 GB. Die Gesamtgröße der Zip-Datei beträgt 2,9 GB und wird in 2 </font><sup><font style="vertical-align: inherit;">64</font></sup><font style="vertical-align: inherit;"> entpackt</font></font><sup><font style="vertical-align: inherit;"></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+11 727 895 877 Bytes mit einem Komprimierungsverhältnis von mehr als 6,2 Milliarden zu eins. </font><font style="vertical-align: inherit;">Ich habe diese Datei nicht zum Download hochgeladen, aber Sie können sie mithilfe des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quellcodes selbst generieren</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Er hat Dateien von einer solchen Größe, dass sogar ein </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fehler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in Info-ZIP UnZip 6.0 aufgedeckt wurde.</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> zipbomb --mode = quote_overlap --num-files = 12056313 --compressed-size = 1482284040 --zip64&gt; zbxxl.zip </font></font></pre><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erweiterung: bzip2 </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DEFLATE ist der häufigste Komprimierungsalgorithmus für das Zip-Format, dies ist jedoch nur eine von vielen Optionen. Der wahrscheinlich zweithäufigste Algorithmus ist </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bzip2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Obwohl es nicht so kompatibel ist wie DEFLATE. Theoretisch beträgt in bzip2 das maximale Kompressionsverhältnis etwa 1,4 Millionen zu eins, was eine dichtere Packung des Kerns ermöglicht. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bzip2 codiert zuerst die "Lauflängencodierung", wodurch die Zeichenfolgenlänge für sich wiederholende Bytes um das 51-fache reduziert wird. Dann werden die Daten in 900-KB-Blöcke unterteilt und jeder Block wird separat komprimiert. Theoretisch kann ein Block bis zu 32 Bytes komprimieren. 900 000 × 51/32 = 1 434 375. Ist </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bzip2 eine effektivere Bombe, </font><font style="vertical-align: inherit;">wenn </font><font style="vertical-align: inherit;">man den Kompatibilitätsverlust ignoriert?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ja - aber nur für kleine Dateien. Das Problem ist, dass es in bzip2 nichts Vergleichbares zu den unkomprimierten DEFLATE-Blöcken gibt, mit denen wir die Header lokaler Dateien zitiert haben. Daher ist es unmöglich, Dateien zu überlappen und den Kernel wiederzuverwenden. Für jede Datei müssen Sie eine eigene Kopie schreiben, sodass das Gesamtkomprimierungsverhältnis nicht besser ist als das Verhältnis für eine einzelne Datei. In der folgenden Grafik sehen wir, dass bzip2 ohne Überlappung DEFLATE nur für Dateien mit einer Größe von etwa Megabyte überlegen ist. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es gibt nur Hoffnung auf ein alternatives Mittel zum Zitieren von Headern in bzip2, das im nächsten Abschnitt behandelt wird. Wenn Sie wissen, dass ein bestimmter Zip-Parser bzip2 </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">und unterstützt</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn nicht übereinstimmende Dateinamen berücksichtigt werden, können Sie das vollständige Überlappungskonstrukt verwenden, das nicht in Anführungszeichen gesetzt werden muss. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/350/bb1/aa1/350bb1aa131f71762b2ad03d4203ac66.svg"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vergleich des Kompressionsverhältnisses verschiedener Reißverschlussbomben. Achten Sie auf die logarithmische Achse. Jedes Design wird mit und ohne Zip64 gezeigt. Strukturen ohne Überlappung weisen eine lineare Wachstumsrate auf, die sich aus dem konstanten Verhältnis der Achsen ergibt. Der vertikale Versatz des bzip2-Diagramms bedeutet, dass das Komprimierungsverhältnis von bzip2 etwa tausendmal höher ist als das von DEFLATE. Die genannten DEFLATE-Konstrukte weisen eine quadratische Wachstumsrate auf, was durch eine Neigung zu den 2: 1-Achsen belegt wird. Die Zip64-Variante ist etwas weniger effektiv, erlaubt aber mehr als 281 TB. Diagramme für bzip2 mit Anführungszeichen durch ein zusätzliches Feld wechseln von quadratisch zu linear, wenn entweder die maximale Dateigröße erreicht ist (2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32)</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> −2 Bytes) oder die maximal zulässige Anzahl von Dateien</font></font></font></i> <br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erweiterung: Zitieren durch ein zusätzliches Feld </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bisher haben wir die DEFLATE-Funktion verwendet, um die Header lokaler Dateien in Anführungszeichen zu setzen, und wir haben gerade gesehen, dass dieser Trick in bzip2 nicht funktioniert. </font><font style="vertical-align: inherit;">Es gibt jedoch eine alternative, etwas eingeschränktere Zitiermethode, die nur Funktionen im Zip-Format verwendet und vom Komprimierungsalgorithmus unabhängig ist. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Am Ende der Header-Struktur der lokalen Datei befindet sich </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ein zusätzliches Feld mit</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variabler Länge zum Speichern von Informationen, die nicht in die üblichen Header-Felder passen ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APPNOTE.TXT, Abschnitt 4.3.7)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Zusätzliche Informationen können beispielsweise einen Zeitstempel oder eine UID / GID von Unix enthalten. </font><font style="vertical-align: inherit;">Zip64-Informationen werden auch in einem zusätzlichen Feld gespeichert. </font><font style="vertical-align: inherit;">Ein zusätzliches Feld wird als Längenwertstruktur dargestellt. </font><font style="vertical-align: inherit;">Wenn Sie die Länge erhöhen, ohne einen Wert hinzuzufügen, enthält das zusätzliche Feld das, was dahinter in der Zip-Datei steht, nämlich den nächsten Header der lokalen Datei. </font><font style="vertical-align: inherit;">Mit dieser Methode kann jeder Header der lokalen Datei die folgenden Header in Anführungszeichen setzen und sie in ein eigenes zusätzliches Feld einschließen. </font><font style="vertical-align: inherit;">Gegenüber DEFLATE gibt es drei Vorteile:</font></font><br><br><ol><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Das Zitieren durch ein zusätzliches Feld erfordert nur 4 Bytes, nicht 5, wodurch mehr Platz für den Kernel bleibt. </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Aufgrund der Einschränkungen des Zip-Formats wird die Dateigröße nicht erhöht, was einen größeren Kernel bedeutet. </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es bietet Zitate in bzip2. </font></font></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trotz dieser Vorteile ist das Zitieren durch zusätzliche Felder weniger flexibel. Dies ist keine Kette wie in DEFLATE: Jede Überschrift einer lokalen Datei sollte nicht nur die unmittelbar folgende Überschrift enthalten, sondern auch </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alle</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nachfolgenden Überschriften. Zusätzliche Felder werden vergrößert, wenn Sie sich dem Anfang der Zip-Datei nähern. Da die maximale Feldlänge 2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 -</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1 Byte </font><font style="vertical-align: inherit;">beträgt </font><font style="vertical-align: inherit;">, können nur bis zu 1808 lokale Dateikopfzeilen (oder 1170 in Zip64) in Anführungszeichen gesetzt werden, vorausgesetzt, die Namen werden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wie erwartet zugewiesen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Im Fall von DEFLATE können Sie ein zusätzliches Feld verwenden, um die ersten (kürzesten) Header lokaler Dateien in Anführungszeichen zu setzen und dann für den Rest zu DEFLATE zu wechseln.) Ein weiteres Problem: Um der internen Datenstruktur des zusätzlichen Feldes zu entsprechen, muss ein 16-Bit-Tag für den Typ ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">APPNOTE.TXT, Abschnitt 4.5.2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) vor den </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Zitierdaten ausgewählt</font></a><font style="vertical-align: inherit;"> werden. Wir möchten ein Typ-Tag auswählen, das dazu führt, dass Parser die Daten in Anführungszeichen ignorieren, anstatt zu versuchen, sie als aussagekräftige Metadaten zu interpretieren. Zip-Parser sollten Tags eines unbekannten Typs ignorieren, damit wir Tags nach dem Zufallsprinzip auswählen können. Es besteht jedoch das Risiko, dass in Zukunft einige Tags die Kompatibilität des Designs verletzen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das vorherige Diagramm zeigt die Möglichkeit, zusätzliche Felder in bzip2, c und ohne Zip64 zu verwenden. In beiden Diagrammen gibt es einen Wendepunkt, an dem das Wachstum von quadratisch nach linear verläuft. Ohne Zip64 geschieht dies, wenn die maximale Größe der unkomprimierten Datei erreicht ist (2 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">32</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">−2 Bytes); Dann können Sie nur die Anzahl der Dateien erhöhen, nicht jedoch deren Größe. Das Diagramm endet vollständig, wenn die Anzahl der Dateien 1809 erreicht. In einem zusätzlichen Feld ist nicht mehr genügend Speicherplatz vorhanden, um zusätzliche Header anzugeben. Mit Zip64 tritt bei 1171 Dateien ein Bruch auf, wonach nur die Dateigröße erhöht werden kann, nicht jedoch deren Anzahl. Ein zusätzliches Feld hilft bei DEFLATE, aber der Unterschied ist so gering, dass er optisch nicht erkennbar ist. Es erhöht das Komprimierungsverhältnis von zbsm.zip um 1,2%; zblg.zip um 0,019%; und zbxl.zip um 0,0025%.</font></font><br><br><h1>  Die Diskussion </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bei ihrer Arbeit zu diesem Thema verwenden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pletz und Kollegen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Dateiüberlappungen, um ein sich fast selbst replizierendes Zip-Archiv zu erstellen. Die Dateiüberlappung selbst wurde </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">früher</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von Ginvael Coldwind </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">vorgeschlagen</font></a><font style="vertical-align: inherit;"> (Folie 47). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben ein Design einer Reißverschlussbombe mit einer Angebotsüberlappung unter Berücksichtigung der Kompatibilität entwickelt - eine Reihe von Unterschieden bei den Implementierungen, von denen einige in der folgenden Tabelle aufgeführt sind. Das resultierende Design ist mit Zip-Parsern kompatibel, die auf die übliche Weise funktionieren, dh zuerst das zentrale Verzeichnis überprüfen und es als Index für Dateien verwenden. Darunter ein einzigartiger Zip-Parser von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nail</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die automatisch aus der formalen Grammatik generiert wird. Das Design ist jedoch nicht mit "Streaming" -Parsern kompatibel, die die Zip-Datei von Anfang bis Ende in einem Durchgang analysieren, ohne zuerst das zentrale Verzeichnis zu lesen. Streaming-Parser erlauben naturgemäß nicht, dass sich Dateien in irgendeiner Weise überlappen. Höchstwahrscheinlich wird nur die erste Datei extrahiert. Darüber hinaus können sie sogar </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">einen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Fehler </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">auslösen</font></a><font style="vertical-align: inherit;"> , wie dies bei </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">sunzip</font></a><font style="vertical-align: inherit;"> der Fall </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">ist</font></a><font style="vertical-align: inherit;"> , bei dem das zentrale Verzeichnis am Ende analysiert und die Konsistenz mit den Headern der bereits gesehenen lokalen Dateien überprüft wird.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie möchten, dass die extrahierten Dateien mit einem bestimmten Präfix beginnen, das sich von den Header-Bytes der lokalen Datei unterscheidet, können Sie einen DEFLATE-Block vor dem unkomprimierten Block einfügen, den der folgende Header zitiert. Nicht jede Datei im Zip-Archiv sollte an der Erstellung der Bombe beteiligt sein: Sie können bei Bedarf normale Dateien in das Archiv aufnehmen, um einem bestimmten Format zu entsprechen ( </font></font><code>--template</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für diesen Anwendungsfall enthält </font><font style="vertical-align: inherit;">der Quellcode einen Parameter </font><font style="vertical-align: inherit;">). Viele Formate verwenden zip als Container, z. B. Java JAR-Dokumente, Android APK und LibreOffice. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pdf</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in vielerlei Hinsicht ähnlich wie zip. Am Ende der Datei befindet sich eine Querverweistabelle, die auf vorherige Objekte verweist, und sie unterstützt die Komprimierung von Objekten über den FlateDecode-Filter. Ich habe es nicht versucht, aber Sie können die Idee des Zitierens mit Überlappung verwenden, um eine PDF-Bombe zu erstellen. Vielleicht müssen Sie hier nicht einmal hart arbeiten: binaryhax0r </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">schreibt in einem Blog-Beitrag,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass Sie einfach mehrere FlateDecode-Ebenen für ein Objekt angeben können, wonach das Erstellen einer PDF-Bombe trivial wird. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Definieren einer bestimmten Klasse von Zip-Bomben, die in diesem Artikel beschrieben wird, ist einfach: Suchen Sie einfach die überlappenden Dateien. Mark Adler hat einen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Patch geschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">für Unzip Info-ZIP, das genau das tut. </font><font style="vertical-align: inherit;">Im Allgemeinen schützt das Blockieren überlappender Dateien jedoch nicht vor allen Klassen von Zip-Bomben. </font><font style="vertical-align: inherit;">Es ist schwierig, im Voraus vorherzusagen, ob es sich bei der Datei um eine Zip-Bombe handelt oder nicht, wenn Sie keine genauen Kenntnisse über die internen Komponenten der Parser haben, die zur Analyse verwendet werden. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Betrachten der Header und das Summieren der Felder "unkomprimierte Größe" aller Dateien funktioniert nicht</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , da der Wert in den Headern möglicherweise nicht mit der tatsächlichen unkomprimierten Größe übereinstimmt (siehe Kompatibilitätstabelle in der Zeile "Erlaubt, dass die Datei zu klein ist"). </font><font style="vertical-align: inherit;">Zum zuverlässigen Schutz vor Zip-Bomben gehören Zeit-, Speicher- und Speicherplatzbeschränkungen im Zip-Parser während des Betriebs. </font><font style="vertical-align: inherit;">Analysieren Sie Zip-Dateien wie komplexe Vorgänge mit nicht vertrauenswürdigen Daten mit Vorsicht.</font></font><br><br><div class="scrollable-table"><table><thead><tr><td></td><th> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Info-zip </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UnZip 6.0</font></font></a> </th><th> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Python 3.7 <br> zipfile</a> </th><th> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Go 1.12 <br> archive/zip</a> </th><th> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">yauzl 2.10.0 <br> (Node.js)</a> </th><th> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nail <br> examples/zip</a> </th><th> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Android 9.0.0 r1 <br> libziparchive</a> </th><th> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sunzip 0.4</a> <br> (streaming) </th></tr></thead><tbody><tr><th> DEFLATE </th><td>  ✓ </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td></tr><tr><th> Zip64 </th><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">✓</a> </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">−</a> </td><td> <a href="">−</a> </td><td> <a href="">✓</a> </td></tr><tr><th> bzip2 </th><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">✓</a> </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">✓</a> </td><td> <a href="">−</a> </td><td> <a href="">−</a> </td><td> <a href="">−</a> </td><td> <a href="">−</a> </td><td> <a href="">✓</a> </td></tr><tr><th>     </th><td>  </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">−</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">−</a> </td><td> <a href="">✓</a> </td></tr><tr><th>   CRC-32 </th><td> <abbr title="zeigt erwartete und echte CRC"></abbr> </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">−</a> </td><td> <a href=""> </a> </td><td> <a href="">✓</a> </td><td> <a href="">−</a> </td><td> <a href="">✓</a> </td><td> <a href="">−</a> </td></tr><tr><th>      </th><td>  ✓ </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">−</a> </td><td> <a href="">−</a> </td><td> <a href="">−</a> </td><td> <a href="">−</a> </td><td> <a href="">−</a> </td><td> <a href="">−</a> </td></tr><tr><th>  2 <sup>32</sup> −1  </th><td>  ✓ </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">−</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td></tr><tr><th>  2 <sup>16</sup> −1  </th><td>  ✓ </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">−</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td><td> <a href="">✓</a> </td></tr></tbody><tbody><tr><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">overlap.zip</a> </th><td>  </td><td> − </td><td>  ✓ </td><td>  ✓ </td><td>  ✓ </td><td> − </td><td> − </td></tr><tr><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zbsm.zip  zblg.zip</a> </th><td>  ✓ </td><td>  ✓ </td><td>  ✓ </td><td>  ✓ </td><td>  ✓ </td><td>  ✓ </td><td> − </td></tr><tr><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zbxl.zip</a> </th><td>  ✓ </td><td>  ✓ </td><td>  ✓ </td><td>  ✓ </td><td> − </td><td> − </td><td> − </td></tr></tbody></table></div><br> <i><font color="gray">    zip-,    ,     zip-.      DEFLATE  Zip64,          ,    CRC     32-  16- .</font></i> <br><br><h1>  Danksagung </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vielen Dank an </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mark Adler</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Russ Cox</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Brandon Enright</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Marek Maykovsky</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Josh Wolfe</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und die Rezensenten von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USENIX WOOT 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für die Kommentare zum Entwurf dieses Artikels. </font><font style="vertical-align: inherit;">Kaolan McNamara untersuchte die Auswirkungen von Reißverschlussbomben auf die Sicherheit von LibreOffice. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine Version dieses Artikels wurde für den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USENIX WOOT 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Workshop vorbereitet </font><font style="vertical-align: inherit;">. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quellcode</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist verfügbar. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Artefakte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> für die Präsentation auf dem Workshop befinden sich in der Datei </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zipbomb-woot19.zip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Haben Sie ein System gefunden, das eine der Bomben abwirft? </font><font style="vertical-align: inherit;">Haben Bomben Ihnen geholfen, einen Fehler zu finden oder Geld in einem Fehlersuchprogramm zu verdienen? </font><font style="vertical-align: inherit;">Lassen Sie es mich wissen, ich werde versuchen, es hier zu erwähnen.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> LibreOffice 6.1.5.2 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nach dem Umbenennen von zblg.zip in zblg.odt oder zblg.docx erstellt und löscht LibreOffice eine Reihe temporärer Dateien mit ca. 4 GB und versucht, das Dateiformat zu ermitteln. </font><font style="vertical-align: inherit;">Letztendlich beendet er dies und löscht die temporären Dateien, sobald sie eintreffen, sodass die Zip-Bombe nur ein temporäres DoS verursacht, ohne die Festplatte zu füllen. </font><font style="vertical-align: inherit;">Kaolan McNamara hat meine Fehlermeldung beantwortet.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mozilla Addons-Server 2019.06.06 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe Zip-Bomben gegen die lokale Addons-Server-Installation ausprobiert, die Teil der Software addons.mozilla.org ist. </font><font style="vertical-align: inherit;">Das System handhabt die Bombe elegant und legt ein Zeitlimit von 110 Sekunden für das Extrahieren von Dateien fest. </font><font style="vertical-align: inherit;">Die Zip-Bombe dehnt sich schnell aus, soweit die Festplatte dies bis zu diesem Zeitlimit zulässt. Dann wird der Prozess abgebrochen und die entpackten Dateien werden schließlich automatisch bereinigt.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UnZip 6.0 </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mark Adler hat einen Patch für UnZip geschrieben, um diese Klasse von Zip-Bomben zu erkennen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. Juli 2019: Ich habe festgestellt, dass </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CVE-2019-13232 UnZip zugewiesen wurde</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Persönlich würde ich argumentieren, dass die Fähigkeit / Unfähigkeit von UnZip (oder einem beliebigen Zip-Parser), diese Art von Zip-Bombe zu verarbeiten, notwendigerweise eine Sicherheitslücke oder sogar ein Fehler ist. Dies ist eine natürliche Implementierung, die nicht gegen die Spezifikation verstößt, was soll ich sagen. Der Bombentyp in diesem Artikel ist nur ein Typ, und es gibt viele andere Möglichkeiten, wie Sie einen Zip-Parser rätseln können. Wie oben erwähnt, sollten Sie nicht versuchen, jeden einzelnen bekannten Angriff aufzulisten, zu erkennen und zu blockieren, wenn Sie sich vor Angriffen zur Erschöpfung der Ressourcen schützen möchten. Vielmehr müssen externe Zeit- und andere Ressourcenbeschränkungen festgelegt werden, damit der Parser nicht in eine solche Situation gerät, unabhängig davon, auf welche Art von Angriff er gestoßen ist. Es ist nichts Falsches daran, bestimmte Designs als Optimierung des ersten Durchgangs zu erkennen und abzulehnen.aber man kann dort nicht aufhören. Ihr System ist wahrscheinlich immer noch anfällig, es sei denn, Sie isolieren und beschränken Vorgänge mit nicht vertrauenswürdigen Daten. Betrachten Sie die Analogie zum Cross-Site-Scripting in HTML: Der richtige Schutz besteht nicht darin, bestimmte Bytes herauszufiltern, die als Code interpretiert werden können, sondern alles richtig zu vermeiden.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Antiviren-Engines </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Twitter-Benutzer @TVqQAAMAAAAEAAA </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">berichtet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : "McAfee Antivirus auf meinem </font><font style="vertical-align: inherit;">Testcomputer ist </font><font style="vertical-align: inherit;">gerade explodiert." </font><font style="vertical-align: inherit;">Ich habe es nicht selbst getestet und ich habe keine Details wie die Versionsnummer. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tavis Ormandi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gibt an,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dass </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VirusTotal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine Reihe von Zeitüberschreitungen </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">für zblg.zip aufweist</font></a><font style="vertical-align: inherit;"> ( </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot vom 6. Juni 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ): AhnLab-V3, ClamAV, DrWeb, Endspiel, F-Secure, GData, K7AntiVirus, K7GW, MaxSecure, McAfee, McAfee-GW -Edition, Panda, Qihoo-360, Sophos ML, VBA32. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnisse für zbsm.zip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot vom 6. Juni 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) sind ähnlich, aber mit einem anderen Satz von Timeout-Engines: Baido, Bkav, ClamAV, CMC, DrWeb, Endspiel, ESET-NOD32, F-Secure, GData, Kingsoft, McAfee-GW-Edition, NANO-Antivirus, Acronis. </font><font style="vertical-align: inherit;">Interessanterweise </font><font style="vertical-align: inherit;">gibt es </font><font style="vertical-align: inherit;">in den </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ergebnissen von zbxl.zip</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> keine Zeitüberschreitungen ( </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot vom 6. Juni 2019</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Vielleicht unterstützen einige Antivirenprogramme Zip64 nicht? </font><font style="vertical-align: inherit;">Mehrere Engines erkennen Dateien als eine Art „Kompressionsbombe“. </font><font style="vertical-align: inherit;">Es ist interessant zu sehen, ob sie dies auch weiterhin tun, wenn geringfügige Änderungen vorgenommen werden, z. B. das Ändern von Dateinamen oder das Hinzufügen eines ASCII-Präfixes zu jeder Datei.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schlusserklärung </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es ist Zeit, Facebook ein Ende zu setzen. </font><font style="vertical-align: inherit;">Dies ist kein neutraler Job für Sie: Jeden Tag, wenn Sie zur Arbeit kommen, machen Sie etwas falsch. </font><font style="vertical-align: inherit;">Wenn Sie ein Facebook-Konto haben, löschen Sie es. </font><font style="vertical-align: inherit;">Wenn Sie auf Facebook arbeiten, werden Sie entlassen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und vergessen Sie nicht, dass die Nationale Sicherheitsagentur zerstört werden muss.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de459254/">https://habr.com/ru/post/de459254/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de459244/index.html">Hinweise Produktmanager: Benutzerverhalten auf Spieleseiten im App Store. Wie lange dauert das Herunterladen eines Spiels?</a></li>
<li><a href="../de459246/index.html">Warum nimmt die Site-Conversion ab? Beispiele für 60 Design- und Usability-Fehler</a></li>
<li><a href="../de459248/index.html">Digitale Veranstaltungen in Moskau vom 9. bis 14. Juli</a></li>
<li><a href="../de459250/index.html">WAL in PostgreSQL: 2. Protokoll aufzeichnen</a></li>
<li><a href="../de459252/index.html">Sicherheitswoche 28: Ein Smart Home hacken</a></li>
<li><a href="../de459256/index.html">Wie wir unser Themenkrankenhaus für verschiedene Plattformen optimiert haben</a></li>
<li><a href="../de459258/index.html">14.000 Meilen nicht haken</a></li>
<li><a href="../de459262/index.html">Mit 22 in den Ruhestand getreten</a></li>
<li><a href="../de459264/index.html">Verlassen von Tarantool-Netzwerken. Knotensynchronisation beim Filtern des Datenverkehrs</a></li>
<li><a href="../de459272/index.html">Schreiben einer API für React-Komponenten, Teil 1: Erstellen Sie keine widersprüchlichen Requisiten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>