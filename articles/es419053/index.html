<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí™üèº üë©üèº‚Äç‚öïÔ∏è üï° Prueba de la tecnolog√≠a de cach√© RAID Adaptec üìñ ü§±üèø üë®üèΩ‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Las soluciones para trabajar con matrices RAID desde discos duros se han utilizado durante mucho tiempo. En general, contin√∫an siendo populares en muc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prueba de la tecnolog√≠a de cach√© RAID Adaptec</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419053/">  Las soluciones para trabajar con matrices RAID desde discos duros se han utilizado durante mucho tiempo.  En general, contin√∫an siendo populares en muchas √°reas donde se requiere una matriz de alto volumen relativamente tolerante a fallas.  Dado el tama√±o de los discos duros modernos, su velocidad y otras razones, el mayor inter√©s pr√°ctico son las matrices de RAID6 (o RAID60, si hay muchos discos).  Pero este tipo de matrices tiene un bajo rendimiento en operaciones de escritura aleatorias y no es f√°cil hacer nada con √©l. <br><br>  Por supuesto, en este caso estamos hablando de la velocidad del "volumen bruto".  En la vida real, el sistema de archivos, el sistema operativo, las aplicaciones y todo lo que se le agrega.  De hecho, no todo es tan malo.  Sin embargo, tambi√©n existen m√©todos de hardware y software para aumentar la productividad que son independientes de estos subsistemas.  Estamos hablando de tecnolog√≠as de almacenamiento en cach√© cuando se agrega una unidad de memoria flash significativamente m√°s r√°pida a una variedad de discos duros. <br><a name="habracut"></a><br>  En particular, en los controladores RAID Adaptec, esta tecnolog√≠a se llama maxCache y su versi√≥n 3.0 se implementa en los modelos ASR-8885Q y ASR-81605ZQ.  Al usarlo, se deben tener en cuenta varias caracter√≠sticas: solo se permite un volumen maxCache por controlador, el volumen m√°ximo del volumen maxCache es de 1 TB, para que el almacenamiento en cach√© de escritura funcione, debe tener una configuraci√≥n tolerante a fallas del volumen maxCache (por ejemplo, un espejo).  Al mismo tiempo, el usuario puede especificar independientemente para cada volumen l√≥gico c√≥mo trabajar√° exactamente con maxCache, para leer y / o escribir y en qu√© modo. <br>  Para las pruebas, utilizamos un servidor basado en una placa base Supermicro X10SLM-F, un procesador Intel Xeon E3-1225 v3 (4C / 8T, 3.2 GHz), 32 GB de RAM funcionando bajo Debian 9. <br><br><img src="https://habrastorage.org/webt/dg/sb/uf/dgsbufgn7nmom7dyat2wqc3mb44.jpeg" alt="imagen"><br><br>  El controlador ASR-81605ZQ probado tiene una unidad de protecci√≥n de memoria y, cuando trabaja con una gran variedad de discos duros, tiene cach√©s de lectura y escritura activos.  Recuerde que la memoria interna de este modelo es de 1 GB.  Se cre√≥ una matriz RAID6 con un bloque de 256 KB a partir de seis discos duros SATA Seagate ST10000NM0086 con una capacidad de 10 TB.  El volumen total del volumen fue de aproximadamente 36 TB. <br><br>  Dos pares de dispositivos actuaron como SSD para el volumen maxCache: dos Samsung 850 EVO de segunda generaci√≥n de 1 TB cada uno con interfaz SATA y dos Seagate 1200 SSD (ST400FM0053) de 400 GB cada uno con interfaz SAS a partir de la cual se crearon matrices RAID1.  Por supuesto, el primer modelo ya puede considerarse obsoleto y no solo moralmente.  Pero para ilustrar el escenario presupuestario, lo har√°.  El segundo se ajusta formalmente mejor a la categor√≠a "corporativa", pero tambi√©n es dif√≠cil considerarlo moderno.  En la configuraci√≥n de la matriz maxCache, solo existe la opci√≥n Flush and Fetch Rate, que se mantuvo en el valor predeterminado (Medio).  No hay forma de seleccionar una prioridad para operaciones o vol√∫menes de disco.  Tenga en cuenta que las unidades no estaban en un nuevo estado y TRIM no se utiliza en esta configuraci√≥n. <br><br>  Despu√©s de crear el volumen maxCache, debe habilitar los par√°metros para usarlo en las propiedades del volumen l√≥gico.  Hay tres opciones en total: habilitar cach√© de lectura, habilitar cach√© de escritura y tipo de cach√© de escritura. <br><br>  La utilidad fio se utiliz√≥ como herramienta de prueba, y el conjunto de scripts inclu√≠a operaciones secuenciales y aleatorias con un n√∫mero diferente de hilos.  Vale la pena se√±alar que el estudio del rendimiento de los productos con tecnolog√≠as de almacenamiento en cach√© de tecnolog√≠a sint√©tica es dif√≠cil de reconocer como la mejor opci√≥n.  Es mejor evaluar adecuadamente el efecto en tareas reales, ya que la carga sint√©tica en cierta medida contradice la idea misma de almacenamiento en cach√©.  Adem√°s, en este caso consideramos operaciones de bajo nivel, y de hecho el usuario generalmente maneja archivos y, como dijimos anteriormente, el sistema de archivos del volumen, el sistema operativo y el software en s√≠ est√°n incluidos en el trabajo con ellos.  Por lo tanto, son sint√©ticos, atractivos por su simplicidad y repetibilidad, lo que no tiene sentido por s√≠ solo, sino principalmente para comparar "c√≥mo fue y c√≥mo se convirti√≥" en escenarios dif√≠ciles para los algoritmos de almacenamiento en cach√© y una estimaci√≥n bastante aproximada del efecto. <br><br>  Veamos primero de lo que nuestra matriz es capaz por s√≠ sola.  Recuerde que en operaciones secuenciales, la velocidad en MB / sy retrasos (en una escala logar√≠tmica) son interesantes, y en operaciones aleatorias, IOPS y retrasos tambi√©n son interesantes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3s/19/mm/3s19mmb6cs1rao3dpq-owfkvovk.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1n/fd/-p/1nfd-phxwyyxec9whbch84diblc.jpeg" alt="imagen"></div><br>  La velocidad de las operaciones de transmisi√≥n con una matriz de esta configuraci√≥n est√° en el nivel de 900 MB / s.  Al mismo tiempo, los retrasos no superan los 70 ms, incluso con una gran cantidad de subprocesos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2b/jy/xb/2bjyxbmkl9r0qfb-zolkda7snuc.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/24/kz/t2/24kzt2cyodl7hknyw0ujgvn2nja.jpeg" alt="imagen"></div><br>  Para los discos duros, las operaciones aleatorias son la carga m√°s dif√≠cil, como se puede ver en los resultados.  Si establece el umbral de latencia en 100 ms, puede obtener aproximadamente 1100 IOPS en la lectura, y en el registro, independientemente de la carga, la matriz puede proporcionar aproximadamente 300 IOPS.  Tenga en cuenta que con una matriz RAID60 de 36 discos en el mismo controlador, puede obtener n√∫meros m√°s interesantes, gracias a la configuraci√≥n de tres bloques de 12 discos duros.  Esto le permite agregar rotaci√≥n y aumentar las velocidades a 3500 y 1200 IOPS en lectura y escritura aleatorias, respectivamente (en esta configuraci√≥n hab√≠a discos duros SAS bastante antiguos de HGST a 2 TB).  El lado negativo de esta opci√≥n es el costo adicional del volumen, ya que no se ‚Äúpierden‚Äù dos discos por volumen, sino dos por grupo. <br><br>  Entonces, sin almacenamiento en cach√©, nuestra matriz se ve lo suficientemente triste como para operaciones aleatorias.  Por supuesto, esta es la velocidad "en bruto" del volumen, y los programas rara vez dan una carga exclusivamente aleatoria (recuerde que aqu√≠ todav√≠a tenemos una matriz para almacenar archivos grandes, no la base de datos). <br><br><img src="https://habrastorage.org/webt/aw/db/fa/awdbfaorgnfjipkfdtlwejc12u4.png" alt="imagen"><br><br>  Veamos c√≥mo los SSD pueden ayudar en esta situaci√≥n.  En las pruebas, se utilizar√°n cuatro opciones de configuraci√≥n disponibles: solo leer, leer y escribir Escribir a trav√©s, leer y escribir Escribir de nuevo, leer y escribir Instant Write Back: <br><br><ul><li>  WB: reescritura habilitada.  maxCache almacenar√° los datos en el SSD y los volver√° a escribir en los discos duros cuando haya poco o ning√∫n impacto en el rendimiento.  Esta es la pol√≠tica predeterminada. </li><li>  INSTWB: reescritura instant√°nea habilitada.  Adem√°s de la pol√≠tica predeterminada, maxCache crear√° p√°ginas sucias sobre la marcha para escrituras de banda completa si hay espacio en el SSD y el n√∫mero de p√°ginas sucias est√° por debajo del umbral. </li><li>  WT: escritura activada.  Similar a la escritura instant√°nea, pero las escrituras de banda completa van tanto al cach√© como al disco duro y no se crean p√°ginas sucias sobre la marcha. </li></ul><br>  Comencemos con las unidades SATA, que son bastante grandes.  Los gr√°ficos esta vez ser√°n separados: velocidad y demoras para cada uno de los cuatro escenarios de prueba. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fx/uq/c6/fxuqc6pydfis8whfyji2bwgqdes.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pq/l6/ly/pql6lypcnqudq_qymja9_hbp1_s.jpeg" alt="imagen"></div><br>  En operaciones de lectura secuencial, la matriz muestra resultados estables independientemente del tipo de cach√© utilizado, que es de esperar.  Al mismo tiempo, difieren poco de una matriz sin cach√©, todos los mismos 900 MB / sy retrasos de aproximadamente 70 ms. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/87/sl/cd/87slcdfkyy9bahurephtbevd_va.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/go/1d/xn/go1dxnn30tkp-ltqdrbeqe3qnru.jpeg" alt="imagen"></div><br>  Hay dos grupos en escritura secuencial: solo para lectura y con Write Back muestran resultados similares a una matriz sin cach√©: aproximadamente 900 MB / sy hasta 100 ms, y Write Through y Instant Write Back pueden extraer no m√°s de 100 MB / sy con un tama√±o significativamente mayor retrasos <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sj/v_/w8/sjv_w8bpjqwt1i7f8opfov1z3l8.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/di/tl/cn/ditlcnsltth8nbfqvfykhjtiyxy.jpeg" alt="imagen"></div><br>  Recuerde que al leer la matriz de discos duros mostr√≥ un m√°ximo de aproximadamente 1100 IOPS, pero en este l√≠mite los retrasos ya comenzaron a superar los 100 ms.  Con el almacenamiento en cach√© de SSD SATA, puede lograr resultados ligeramente mejores: aproximadamente 1,500 IOPS y con los mismos retrasos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4x/st/bx/4xstbxk1q9rlf0zoavgk7m_lfky.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tx/dj/nu/txdjnuopc4qxxfkqoz6xzixbxx4.jpeg" alt="imagen"></div><br>  En las operaciones de grabaci√≥n aleatoria, vemos el mayor efecto: un aumento en los indicadores de dos veces y media con un aumento simult√°neo en la capacidad de carga.  Al usar el cach√©, puede tener retrasos de hasta 100 ms con dos o tres veces m√°s subprocesos. <br><br>  La conclusi√≥n general sobre esta configuraci√≥n es: no interfiere con la lectura secuencial, no interfiere con la escritura secuencial en algunas configuraciones, agrega alrededor del 35% en lecturas aleatorias y aumenta el rendimiento un par de veces en escrituras aleatorias. <br><br>  Ahora veamos una variante del volumen de almacenamiento en cach√© del segundo par de unidades SSD.  Tenga en cuenta que en nuestro caso ten√≠an un volumen significativamente menor, una interfaz SAS de 12 Gb / sy caracter√≠sticas de mayor velocidad (declarada por el fabricante). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8e/xq/x3/8exqx3s3i0_hsravea2fylcoh8s.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lv/sp/rw/lvsprwwd1m1r2svgrcmjo9awbxs.jpeg" alt="imagen"></div><br>  En la lectura secuencial, los resultados no difieren de los dados anteriormente, lo cual es bastante esperado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gu/dl/gd/gudlgdgjmsedwol2_ybhl2tmiia.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d0/jv/pv/d0jvpv9izv19wdnz91b23kjnt7c.jpeg" alt="imagen"></div><br>  En la grabaci√≥n secuencial, ahora tenemos tres grupos: la configuraci√≥n con escritura a trav√©s de la memoria cach√© de escritura se queda atr√°s, aproximadamente la Escritura instant√°nea muestra aproximadamente la mitad de la velocidad m√°xima y solo la Escritura posterior no es diferente de una matriz sin cach√©.  La misma situaci√≥n con el tiempo de espera. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/el/p-/v-/elp-v-kgirb2hea_ba3vwxtdqsm.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sw/tp/v5/swtpv5z6q0yztaso_t9wpmba8cg.jpeg" alt="imagen"></div><br>  Pero en lectura aleatoria, Instant Write Back demostr√≥ ser la mejor, alcanzando 2500 IOPS, mientras que el resto de las configuraciones solo pueden extenderse hasta 1800 IOPS.  Tenga en cuenta que todas las opciones con almacenamiento en cach√© de escritura son notablemente m√°s r√°pidas que una matriz "limpia".  Al mismo tiempo, el tiempo de espera no supera los 100 ms, incluso con una gran cantidad de subprocesos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/38/wi/6p/38wi6pe6ly2lkwjmemab1l3dukw.jpeg" alt="imagen"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lr/qo/cu/lrqocuuewpw6hzpmnagy8ga3muq.jpeg" alt="imagen"></div><br>  En operaciones de lectura aleatorias, Instant Write Back vuelve a aparecer, mostrando casi 2,000 IOPS.  El segundo grupo contiene las configuraciones Write Through y Write Back con 1000 IOPS. <br><br>  El √∫ltimo participante, que no usa el cach√© para operaciones de escritura, muestra alrededor de 300 IOPS, as√≠ como solo una variedad de discos duros. <br><br>  Quiz√°s la opci√≥n m√°s interesante para este volumen de cach√© es Instant Write Back.  Es cierto que es m√°s lento en las operaciones de lectura de transmisi√≥n.  Es posible arreglar esto usando la configuraci√≥n RAID10 para el volumen maxCache, pero ya costar√° cuatro bah√≠as en el gabinete de almacenamiento. <br><br>  En general, podemos decir que el uso de la tecnolog√≠a maxCache puede ser realmente √∫til para aumentar el rendimiento de las matrices de los discos duros, especialmente si hay muchas operaciones aleatorias en la carga.  Sin embargo, todav√≠a es imposible considerar que es tan efectivo como reemplazar el disco duro con un SSD en una computadora de escritorio o estaci√≥n de trabajo. <br><br>  El mayor efecto que se observ√≥ en las pruebas es un aumento en la velocidad de las operaciones aleatorias en 2-3 veces.  Por supuesto, no se utilizaron los SSD m√°s r√°pidos, lo que se reflej√≥ claramente en algunas pruebas (por ejemplo, grabaci√≥n secuencial en modo Write Through).  Adem√°s, me gustar√≠a volver a llamar la atenci√≥n sobre el hecho de que la elecci√≥n de la configuraci√≥n de almacenamiento en cach√© afecta significativamente los resultados.  Dado que es posible cambiar la configuraci√≥n "sobre la marcha" sin p√©rdida de datos, vale la pena verificar todas las opciones en sus tareas usted mismo y elegir la mejor opci√≥n. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es419053/">https://habr.com/ru/post/es419053/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es419041/index.html">Los nueve rastrillos de Elasticsearch que pis√©</a></li>
<li><a href="../es419043/index.html">El elusivo problema del tiempo de trama</a></li>
<li><a href="../es419047/index.html">Reddit hacke√≥, filtr√≥ la base de datos con contrase√±as y correo electr√≥nico para 2005-2007</a></li>
<li><a href="../es419049/index.html">GeekBrains lanza el marat√≥n educativo en l√≠nea gratuito "Find Yourself in Digital"</a></li>
<li><a href="../es419051/index.html">C√≥mo Flant ayuda a los principiantes</a></li>
<li><a href="../es419055/index.html">En la teor√≠a de cuerdas, puedes sobrevivir con significativamente menos universos.</a></li>
<li><a href="../es419061/index.html">Novedades de GoLand 2018.2</a></li>
<li><a href="../es419063/index.html">Automatizaci√≥n de la obtenci√≥n de informaci√≥n de USRLE usando Freepascal</a></li>
<li><a href="../es419065/index.html">Mundo virtual Intel. Practica</a></li>
<li><a href="../es419067/index.html">C√≥mo vender datos personales o por qu√© es dif√≠cil poner un precio a la informaci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>