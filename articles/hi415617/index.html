<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯдЮЁЯП╗ ЁЯСГЁЯП╝ ЁЯО│ рдбреЗрд▓реНрдлреА рдореЗрдВ InternetPCools FPC рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ тЪТя╕П ЁЯСйЁЯП╜тАНЁЯТ╗ ЁЯд╣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд▓реЗрдЦ рдХреБрдЫ рд╡реНрдпрд╛рдкрдХ рд╣реИ - рдпрд╣ рдХрдИ рдЕрдиреНрдп рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдкрд╛рд░рджрд░реНрд╢реА рд░реВрдк рд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдмрддрд╛рддрд╛ рд╣реИ (рдФрд░ рди рдХреЗрд╡рд▓ рдлреНрд░реА рдкрд╛рд╕реНрдХрд▓ рдХреА рджреБрдирд┐рдпрд╛ рд╕реЗ), рдФрд░ рдЗрдВрдЯ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдбреЗрд▓реНрдлреА рдореЗрдВ InternetPCools FPC рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415617/">  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рд▓реЗрдЦ рдХреБрдЫ рд╡реНрдпрд╛рдкрдХ рд╣реИ - рдпрд╣ рдХрдИ рдЕрдиреНрдп рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ <i>рдкрд╛рд░рджрд░реНрд╢реА рд░реВрдк рд╕реЗ</i> рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдмрддрд╛рддрд╛ рд╣реИ (рдФрд░ рди рдХреЗрд╡рд▓ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдлреНрд░реА рдкрд╛рд╕реНрдХрд▓</a> рдХреА рджреБрдирд┐рдпрд╛ рд╕реЗ), рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрдВрдЯрд░рдиреЗрдЯрдЯреВрд▓</a> рдХреЛ рдЗрд╕рдХреА рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд╕рдВрдкрддреНрддрд┐ рдХреЗ рдХрд╛рд░рдг рдЪреБрдирд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЧрдпрд╛ рдерд╛</a> - рдпрд╣ рдорд╛рдорд▓рд╛ рд╣реИ рдЬрдм (рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд░реВрдк рд╕реЗ) рдЧрд╛рдпрдм рд╣реИ рдбреЗрд▓реНрдлреА-рд╕рдВрд╕реНрдХрд░рдг рд╕рдорд╛рди рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдФрд░ рдкреНрд░рдпреЛрдЬреНрдп рдХреЗ рд╕рд╛рдеред <br><br>  рдпрд╣ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╡реЗрдм рджрд╕реНрддрд╛рд╡реЗрдЬреЛрдВ (XML рдФрд░ HTML) рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА (рдкрд╛рд░реНрд╕рд┐рдВрдЧ) рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХреА рдЧрдИ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдЖрд╡рд╢реНрдпрдХ рдбреЗрдЯрд╛ рдХрд╛ рд╕рдВрдХреЗрдд рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЙрдЪреНрдЪ рд╕реНрддрд░реАрдп рдХреНрд╡реЗрд░реА рднрд╛рд╖рд╛рдУрдВ</a> рдЬреИрд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">XPath</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">XQuery</a> рдХрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЙрдкрдпреЛрдЧ</a> рдХрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдХрддреЗ рд╣реИрдВ</a> , рдФрд░ рдПрдХ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реАрдзреЗ рдкрд╣реБрдВрдЪ</a> рдкреНрд░рджрд╛рди рдХрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдХрддреЗ</a> рд╣реИрдВред рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдкрд░ рдирд┐рд░реНрдорд┐рдд рдПрдХ рдкреЗрдбрд╝ рдХреЗ рддрддреНрд╡ред <br><a name="habracut"></a><br><h2>  рдЗрдВрдЯрд░рдиреЗрдЯрдЯреВрд▓реЛрдВ рдХрд╛ рдкрд░рд┐рдЪрдп </h2><br>  рдЖрдЧреЗ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдПрдХ рд╕рд░рд▓ рдХрд╛рд░реНрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЪрд┐рддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЬрд┐рд╕рдХрд╛ рддрд╛рддреНрдкрд░реНрдп рдЗрд╕ рд▓реЗрдЦ рдХреЗ рдмреБрд▓реЗрдЯреЗрдб рдФрд░ рдЧрд┐рдиреЗ рд╣реБрдП рд╕реВрдЪрд┐рдпреЛрдВ рдХреЗ рдЙрди рддрддреНрд╡реЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╣реИ, рдЬрд┐рдирдореЗрдВ рд▓рд┐рдВрдХ рд╣реЛрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреНрд░рд▓реЗрдЦрди рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ</a> , рддреЛ рдРрд╕рд╛ рдПрдХ рдЫреЛрдЯрд╛ рдХреЛрдб рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ (рдпрд╣ рдЫреЛрдЯреЗ, рдЕрдкреНрд░рдХрд╛рд╢рд┐рдд рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рд╕рд╛рде penultimate рдЙрджрд╛рд╣рд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред ): <br><br><a name="FirstTask"></a><pre><code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> xquery; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ListValue: IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ListValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xqvalue(ArticleURL).retrieve.map(ListXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln(ListValue.toString); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЕрдм рдпрд╣ рдХреЙрдореНрдкреИрдХреНрдЯ рдФрд░ рдСрдмреНрдЬреЗрдХреНрдЯ-рдУрд░рд┐рдПрдВрдЯреЗрдб рдХреЛрдб рдХреЗрд╡рд▓ рдлреНрд░реА рдкрд╛рд╕реНрдХрд▓ рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЙрди рд╕рднреА рдЪреАрдЬреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ рдпрд╣ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдбреЗрд▓реНрдлреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИ, рдФрд░ рдЕрдзрд┐рдорд╛рдирддрдГ рд╕рдорд╛рди рд╢реИрд▓реА рдореЗрдВ, рд╕рдорд╛рди рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЗ рд╕рд╛рде;  рдпрд╣ рднреА рдзреНрдпрд╛рди рд░рдЦрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ InternetTools <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдереНрд░реЗрдб рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ</a> (рдЗрд╕реЗ рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдХрдИ рдереНрд░реЗрдбреНрд╕ рд╕реЗ рдЕрдиреБрдордд рд╣реИ), рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░реЗ рд╡рд┐рдХрд▓реНрдк рдХреЛ рдпрд╣ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br><h2>  рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рддрд░реАрдХреЗ </h2><br>  рдпрджрд┐ рдЖрдк рдХрд╛рд░реНрдп рдХреЛ рдпрдерд╛рд╕рдВрднрд╡ рджреВрд░ рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВ, рддреЛ рдХрд┐рд╕реА рдЕрдиреНрдп <abbr title="рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛">рднрд╛рд╖рд╛</abbr> рдореЗрдВ рд▓рд┐рдЦреА рдЧрдИ рдЪреАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдХрдИ рддрд░реАрдХреЗ <abbr title="рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛">рд╣реИрдВ</abbr> - рд╡реЗ 3 рдмрдбрд╝реЗ рд╕рдореВрд╣ рдмрдирд╛рдПрдВрдЧреЗ: <br><br><ol><li>  рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдПрдХ <b>рдЕрд▓рдЧ рдкреНрд░рдХреНрд░рд┐рдпрд╛</b> рдореЗрдВ рд░рдЦрдХрд░, рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓, рдмрд▓реЛрдВ рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдИ рдЧрдИ рд╣реИ, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, <abbr title="рдирд┐: рд╢реБрд▓реНрдХ рдкрд╛рд╕реНрдХрд▓ рд╕рдВрдХрд▓рдХ">рдПрдлрдкреАрд╕реА</abbr> ред  рд╕рдВрднрд╡ рдиреЗрдЯрд╡рд░реНрдХ рд╕рдВрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкрджреНрдзрддрд┐ рдХреЛ рднреА рджреЛ рд╢реНрд░реЗрдгрд┐рдпреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрдВрдЯрд░рдкреНрд░реЛрд╕реЗрд╕ рд╕рдВрдЪрд╛рд░ рдХрд╛</a> рдХреНрд╖реЗрддреНрд░ рдХреЗрд╡рд▓ рдПрдХ рдХрдВрдкреНрдпреВрдЯрд░ рддрдХ рд╕реАрдорд┐рдд рд╣реИред  рдЗрд╕ рддрд░рд╣ рдХреЗ рд╡рд┐рдирд┐рдордп рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЙрддреНрдкрд╛рджрдХ рд╕рд╛рдзрди (рд╕рд╢рд░реНрдд рд░реВрдк рд╕реЗ рдирд┐рдореНрди рд╕реНрддрд░), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд╛рдЭрд╛ рдХреА рдЧрдИ рдореЗрдореЛрд░реА</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдирд╛рдо рдЪреИрдирд▓ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ</a> ред </li><li>  рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдПрдВ рд╕реБрд▓рдн рд╣реИрдВ - рдпрд╣ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдирд╛рдорд┐рдд рдкрд╛рдЗрдк</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЖрд░рдкреАрд╕реА</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреАрд╕реАрдУрдПрдо</a> , рдЖрджрд┐ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ul></li><li>  рдПрдХ <b>DLL</b> рдореЗрдВ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ <b>рдПрдирдХреНрд░рд┐рдкреНрдЯ рдХрд░рдирд╛</b> (рдЗрд╕рдХреЗ рдмрд╛рдж рдХрднреА-рдХрднреА "рдбрд╛рдпрдиреЗрдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА" рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ), рдкрд░рд┐рднрд╛рд╖рд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░, рдЙрд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рднреАрддрд░ рдХрд╛рдо рдХрд░рдирд╛ред  рдпрджреНрдпрдкрд┐ COM рдСрдмреНрдЬреЗрдХреНрдЯ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЛ</a> DLL рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ</a> , рд▓реЗрдЦ рдПрдХ рд╕рд░рд▓ рдФрд░ рдХрдо рд╕рдордп рд▓реЗрдиреЗ рд╡рд╛рд▓реА рд╡рд┐рдзрд┐ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдЧрд╛, рдЬреЛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╕рдордп рдпрд╣ рд╕рдм рд╕рдорд╛рди рдЖрд░рд╛рдо рдХреЗ рд╕рд╛рде рджреЗрддрд╛ рд╣реИред </li><li>  <b>рдкреЛрд░реНрдЯрд┐рдВрдЧред</b>  рдкрд┐рдЫрд▓реЗ рдорд╛рдорд▓реЛрдВ рдХреА рддрд░рд╣, рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рдЙрдкрдпреБрдХреНрддрддрд╛ - рджреВрд╕рд░реА рднрд╛рд╖рд╛ рдореЗрдВ рдХреЛрдб рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдирд╛ - рдЗрд╕рдХреЗ рдкреЗрд╢реЗрд╡рд░реЛрдВ рдФрд░ рд╡рд┐рдкрдХреНрд╖реЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрддреБрд▓рди рд╕реЗ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрдВрдЯрд░рдиреЗрдЯрдЯреВрд▓ рдХреЗ рд╕рд╛рде рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдкреЛрд░реНрдЯрд┐рдВрдЧ рдХреЗ рдиреБрдХрд╕рд╛рди рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╣реИрдВ, рдЕрд░реНрдерд╛рддреН: рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛрдб рдХреА рдХрд╛рдлреА рдорд╛рддреНрд░рд╛ рдХреЗ рдХрд╛рд░рдг, рдЖрдкрдХреЛ рдХреБрдЫ рдмрд╣реБрдд рдЧрдВрднреАрд░ рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА (рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдУрдВ рдХреА рд╕рдорд╛рдирддрд╛ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрддреЗ рд╣реБрдП), рдФрд░ рд╕рдордп-рд╕рдордп рдкрд░, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреЛрд░реНрдЯреЗрдмрд▓ рдПрдХ</a> рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд┐рдХрд╛рд╕ рдХреЗ</a> рдХрд╛рд░рдг, рдбреЗрд▓реНрдлреА рдореЗрдВ рд╕реБрдзрд╛рд░ рдФрд░ рдирдИ рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдХрд╛рд░реНрдп рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛ред </li></ol><br><h2>  DLL </h2><br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкрд╛рдардХ рдХреЛ рдЕрдВрддрд░ рдорд╣рд╕реВрд╕ рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, 2 рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ рдЬреЛ рдЙрдирдХреЗ рдЙрдкрдпреЛрдЧ рдХреА рд╕реБрд╡рд┐рдзрд╛ рд╕реЗ рдЕрд▓рдЧ рд╣реИрдВред <br><br><h3>  "рдХреНрд▓рд╛рд╕рд┐рдХ" рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди </h3><br>  рдЖрдЗрдП рдПрдХ рдЧрддрд┐рд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рдмрд╣реБрдд рд╣реА рдкреНрд░рдХреГрддрд┐ рджреНрд╡рд╛рд░рд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдд рдкреНрд░рдХреНрд░рд┐рдпрд╛рддреНрдордХ рд╢реИрд▓реА рдореЗрдВ рдЗрдВрдЯрд░рдиреЗрдЯрдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рд╢реБрд░реВ рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВ рдЬреЛ рдХреЗрд╡рд▓ рдХрд╛рд░реНрдпреЛрдВ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ;  рд╣рдо WinAPI рдХреЗ рд╕рдорд╛рди DLL рдХреЗ рд╕рд╛рде рд╕рдВрдЪрд╛рд░ рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдмрдирд╛рдПрдВрдЧреЗ, рдЬрдм рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрд╕рд╛рдзрди рдХрд╛ рд╣реИрдВрдбрд▓ рдкрд╣рд▓реЗ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХреЗ рдмрд╛рдж рдЙрдкрдпреЛрдЧреА рдХрд╛рд░реНрдп рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдореА рд╣реИрдВрдбрд▓ рдирд╖реНрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ (рдмрдВрдж)ред  рдЗрд╕ рд╡рд┐рдХрд▓реНрдк рдХреЛ рд╣рд░ рдЪреАрдЬ рдореЗрдВ рдПрдХ рд░реЛрд▓ рдореЙрдбрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рдЪрд╛рд░ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ - рдпрд╣ рдХреЗрд╡рд▓ рдкреНрд░рджрд░реНрд╢рди рдХреЗ рд▓рд┐рдП рдЪреБрдирд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рджреВрд╕рд░реЗ рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХреЗ рдмрд╛рдж - рдПрдХ рдкреНрд░рдХрд╛рд░ рдХрд╛ рдЧрд░реАрдм рд░рд┐рд╢реНрддреЗрджрд╛рд░ред <br><br>  рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рд╕рдорд╛рдзрд╛рди рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛ рдФрд░ рд╕реНрд╡рд╛рдорд┐рддреНрд╡ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗ (рддреАрд░ рдирд┐рд░реНрднрд░рддрд╛ рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dt/uv/8p/dtuv8pkm7bwa0_rvgnkhxouoc5i.png" alt="&quot;рдХреНрд▓рд╛рд╕рд┐рдХ&quot; рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛" width="600"></div><br><br><h4>  InternetTools.Types рдореЙрдбреНрдпреВрд▓ </h4><br>  рдЪреВрдВрдХрд┐ рджреЛрдиреЛрдВ рднрд╛рд╖рд╛рдПрдБ - рдбреЗрд▓реНрдлреА рдФрд░ рдлреНрд░реА рдкрд╛рд╕реНрдХрд▓ - рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдЗрд╕ рддрд░рд╣ рдХреЗ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдореЙрдбреНрдпреВрд▓ рдХреЛ DLL рдирд┐рд░реНрдпрд╛рдд рд╕реВрдЪреА рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдЖрд╡рдВрдЯрд┐рдд рдХрд░рдирд╛ рдмрд╣реБрдд рд╣реА рдЙрдЪрд┐рдд рд╣реИ, рддрд╛рдХрд┐ рдЗрдВрдЯрд░рдиреЗрдЯрдЯреВрд▓рд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЙрдирдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдХреА рдирдХрд▓ рди рдХрд░реЗрдВред , рдЬрд┐рд╕рдореЗрдВ рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> InternetTools.Types; <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> TXQHandle = Integer; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рдЗрд╕ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ, рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд╢рдлреБрд▓ рдкреНрд░рдХрд╛рд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рднрд╡рд┐рд╖реНрдп рдореЗрдВ, рдореЙрдбреНрдпреВрд▓ "рдкрд░рд┐рдкрдХреНрд╡" рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕рдХреА рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдирд┐рд░реНрд╡рд┐рд╡рд╛рдж рд╣реЛ рдЬрд╛рдПрдЧреАред <br><br><h4>  InternetTools рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА </h4><br>  рдбреАрдПрд▓рдПрд▓ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛ рдиреНрдпреВрдирддрдо рдЪрдпрдирд┐рдд рд╣реИ, рд▓реЗрдХрд┐рди рдЙрдкрд░реЛрдХреНрдд <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд╛рд░реНрдп</a> рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ: <br><br><a name="ClassicLibrary"></a><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">library</span></span> InternetTools; <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> InternetTools.Types; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenDocument</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> TXQHandle; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CloseHandle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> TXQHandle; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Count</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle)</span></span></span><span class="hljs-function">:</span></span> Integer; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ValueByIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Index</span></span></span></span><span class="hljs-function"><span class="hljs-params">: Integer)</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> OpenDocument, CloseHandle, Map, Count, ValueByIndex; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рд╡рд░реНрддрдорд╛рди рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рдбреЗрдореЛ рдкреНрд░рдХреГрддрд┐ рдХреЗ рдХрд╛рд░рдг, рдкреВрд░реНрдг рдХреЛрдб рдирд╣реАрдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ - рдмрд╣реБрдд рдЕрдзрд┐рдХ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕ рд╕рд░рд▓рддрдо рдПрдкреАрдЖрдИ рдХреЛ рдмрд╛рдж рдореЗрдВ рдХреИрд╕реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рдХреЗрд╡рд▓ рдереНрд░реЗрдб рд╕реБрд░рдХреНрд╖рд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреВрд▓рдиреЗ рдХреА рдЬрд╝рд░реВрд░рдд рдирд╣реАрдВ рд╣реИ, рдЬреЛ, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕реЗ рдХреБрдЫ рдкреНрд░рдпрд╛рд╕ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА, рд▓реЗрдХрд┐рди рдпрд╣ рдХреБрдЫ рдЬрдЯрд┐рд▓ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред <br><br><h4>  InternetToolsUsage рдЕрдиреБрдкреНрд░рдпреЛрдЧ </h4><br>  рдкрд┐рдЫрд▓реА рддреИрдпрд╛рд░рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдбреЗрд▓реНрдлреА рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реВрдЪреА рдЙрджрд╛рд╣рд░рдг</a> рдХреЛ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЧрдпрд╛: <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">program</span></span> InternetToolsUsage; ... <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> InternetTools.Types; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DLLName = <span class="hljs-string"><span class="hljs-string">'InternetTools.dll'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenDocument</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> TXQHandle; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CloseHandle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> TXQHandle; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Count</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle)</span></span></span><span class="hljs-function">:</span></span> Integer; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ValueByIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Handle: TXQHandle; </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Index</span></span></span></span><span class="hljs-function"><span class="hljs-params">: Integer)</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RootHandle, ListHandle: TXQHandle; I: Integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> RootHandle := OpenDocument(ArticleURL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> ListHandle := Map(RootHandle, ListXPath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> I := <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Count(ListHandle) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln( ValueByIndex(ListHandle, I) ); <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(ListHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(RootHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ReadLn; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рдпрджрд┐ рдЖрдк рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рдирд╣реАрдВ рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рдпрд╣ рдирд╣реАрдВ рдХрд╣ рд╕рдХрддреЗ рдХрд┐ рдХреЛрдб рдирд┐: рд╢реБрд▓реНрдХ рдкрд╛рд╕реНрдХрд▓ рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рднрд╛рд░реА рд░реВрдк рд╕реЗ рднрд╛рд░реА рд╣реИ, рд▓реЗрдХрд┐рди рдЕрдЧрд░ рд╣рдо рдХрд╛рд░реНрдп рдХреЛ рдереЛрдбрд╝рд╛ рдЬрдЯрд┐рд▓ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдХреБрдЫ рддрддреНрд╡реЛрдВ рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдиреЗ рдФрд░ рд▓рд┐рдВрдХ рдкрддреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред рд╢реЗрд╖: <br><br><a name="SecondTask"></a><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> xquery; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; HrefXPath = <span class="hljs-string"><span class="hljs-string">'./a/@href'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ListValue, HrefValue: IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ListValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xqvalue(ArticleURL).retrieve.map(ListXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-comment"><span class="hljs-comment">{   }</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> HrefValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ListValue.map(HrefXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln(HrefValue.toString); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рд╡рд░реНрддрдорд╛рди рдПрдкреАрдЖрдИ рдбреАрдПрд▓рдПрд▓ рдХреЗ рд╕рд╛рде рдРрд╕рд╛ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рд▓реЗрдХрд┐рди рдкрд░рд┐рдгрд╛рдореА рдХреА рдХреНрд░рд┐рдпрд╛рд╢реАрд▓рддрд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╣реИ, рдЬреЛ рди рдХреЗрд╡рд▓ рдХреЛрдб рдХреА рдкрдардиреАрдпрддрд╛ рдХреЛ рдХрдо рдХрд░рддреА рд╣реИ, рдмрд▓реНрдХрд┐ (рдФрд░ рдХреЛрдИ рдХрдо рдорд╣рддреНрд╡рдкреВрд░реНрдг) рдЗрд╕реЗ рдКрдкрд░ рд╕реЗ рджреВрд░ рдирд╣реАрдВ рд▓реЗ рдЬрд╛рддреА рд╣реИ: <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">program</span></span> InternetToolsUsage; ... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; HrefXPath = <span class="hljs-string"><span class="hljs-string">'./a/@href'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> RootHandle, ListHandle, HrefHandle: TXQHandle; I, J: Integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> RootHandle := OpenDocument(ArticleURL); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> ListHandle := Map(RootHandle, ListXPath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> I := <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Count(ListHandle) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-comment"><span class="hljs-comment">{   }</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> HrefHandle := Map(ListHandle, HrefXPath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> J := <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> Count(HrefHandle) - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln( ValueByIndex(HrefHandle, J) ); <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(HrefHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(ListHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> CloseHandle(RootHandle); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ReadLn; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рдЬрд╛рд╣рд┐рд░ рд╣реИ - рд╡рд╛рд╕реНрддрд╡рд┐рдХ, рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рд▓реЗрдЦрди рдХреА рдорд╛рддреНрд░рд╛ рдХреЗрд╡рд▓ рддреЗрдЬреА рд╕реЗ рдмрдврд╝реЗрдЧреА, рдФрд░ рдЗрд╕рд▓рд┐рдП рд╣рдо рдРрд╕реЗ рд╕рдорд╛рдзрд╛рди рдкрд░ рдЖрдЧреЗ рдмрдврд╝реЗрдВрдЧреЗ рдЬреЛ рдРрд╕реА рд╕рдорд╕реНрдпрд╛рдУрдВ рд╕реЗ рдореБрдХреНрдд рд╣реИред <br><br><h3>  рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди </h3><br>  рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛рддреНрдордХ рд╢реИрд▓реА, рдЬреИрд╕рд╛ рдХрд┐ рдЕрднреА рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рд╕рдВрднрд╡ рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕рдореЗрдВ рдмрд╣реБрдд рдХрдорд┐рдпрд╛рдВ рд╣реИрдВред  рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ DLL рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рдЙрдкрдпреЛрдЧ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ (рдЬреИрд╕рд╛ рдХрд┐ рдкреНрд░рд╛рдкреНрдд рдФрд░ рд▓реМрдЯрд╛рдП рдЧрдП рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░), рдЖрдк InternetTools рдХреЗ рд╕рд╛рде рдЙрд╕реА рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд╛ рдЖрдпреЛрдЬрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рдлреНрд░реА рдкрд╛рд╕реНрдХрд▓ рдХреЗ рд╕рд╛рде рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордпред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЕрд▓рдЧ-рдЕрд▓рдЧ рдореЙрдбреНрдпреВрд▓ рдХреЗ рд▓рд┐рдП рдЗрдВрдЯрд░рдлреЗрд╕ рдХреА рдШреЛрд╖рдгрд╛ рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЛ рд╡рд┐рддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╛рдЗрд▓реЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛ рдХреЛ рдереЛрдбрд╝рд╛ рдмрджрд▓рдирд╛ рд╡рд╛рдВрдЫрдиреАрдп рд╣реИ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ik/48/ki/ik48kioqk2f51pxpdscpsid-auo.png" alt="рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛" width="600"></div><br>  рдкрд╣рд▓реЗ рдХреА рддрд░рд╣, рд╣рдо рдЕрдиреБрдХреНрд░рдо рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВрдЧреЗред <br><br><h4>  InternetTools.Types рдореЙрдбреНрдпреВрд▓ </h4><br>  рдбреАрдПрд▓рдПрд▓ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреА рдШреЛрд╖рдгрд╛ рдХрд░рддрд╛ рд╣реИ: <br><br><a name="InternetTools_Types"></a><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> InternetTools.Types; <span class="hljs-meta"><span class="hljs-meta">{$IFDEF FPC}</span></span> <span class="hljs-meta"><span class="hljs-meta">{$MODE Delphi}</span></span> <span class="hljs-meta"><span class="hljs-meta">{$ENDIF}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> IXQValue = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>; IXQValueEnumerator = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{781B23DC-E8E8-4490-97EE-2332B3736466}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveNext</span></span></span><span class="hljs-function">:</span></span> Boolean; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrent</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> Current: IXQValue <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> GetCurrent; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; IXQValue = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{DCE33144-A75F-4C53-8D25-6D9BD78B91E4}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEnumerator</span></span></span><span class="hljs-function">:</span></span> IXQValueEnumerator; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> }'] <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> InternetTools.Types; <span class="hljs-meta"><span class="hljs-meta">{$IFDEF FPC}</span></span> <span class="hljs-meta"><span class="hljs-meta">{$MODE Delphi}</span></span> <span class="hljs-meta"><span class="hljs-meta">{$ENDIF}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> IXQValue = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>; IXQValueEnumerator = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{781B23DC-E8E8-4490-97EE-2332B3736466}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveNext</span></span></span><span class="hljs-function">:</span></span> Boolean; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrent</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> Current: IXQValue <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> GetCurrent; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; IXQValue = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{DCE33144-A75F-4C53-8D25-6D9BD78B91E4}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEnumerator</span></span></span><span class="hljs-function">:</span></span> IXQValueEnumerator; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> }'] <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> InternetTools.Types; <span class="hljs-meta"><span class="hljs-meta">{$IFDEF FPC}</span></span> <span class="hljs-meta"><span class="hljs-meta">{$MODE Delphi}</span></span> <span class="hljs-meta"><span class="hljs-meta">{$ENDIF}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> IXQValue = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>; IXQValueEnumerator = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{781B23DC-E8E8-4490-97EE-2332B3736466}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveNext</span></span></span><span class="hljs-function">:</span></span> Boolean; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrent</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">property</span></span> Current: IXQValue <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> GetCurrent; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; IXQValue = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{DCE33144-A75F-4C53-8D25-6D9BD78B91E4}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEnumerator</span></span></span><span class="hljs-function">:</span></span> IXQValueEnumerator; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рдбреЗрд▓реНрдлреА рдФрд░ рдПрдлрдкреАрд╕реА-рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рджреЛрдиреЛрдВ рдореЗрдВ рдЕрдкрд░рд┐рд╡рд░реНрддрд┐рдд рдореЙрдбреНрдпреВрд▓ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдХрд╛рд░рдг рд╕рд╢рд░реНрдд рд╕рдВрдХрд▓рди рдирд┐рд░реНрджреЗрд╢ рдЖрд╡рд╢реНрдпрдХ рд╣реИрдВред <br><br>  <code>IXQValueEnumerator</code> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рд╕рд┐рджреНрдзрд╛рдВрдд рд░реВрдк рдореЗрдВ рд╡реИрдХрд▓реНрдкрд┐рдХ рд╣реИ, рд╣рд╛рд▓рд╛рдВрдХрд┐, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП</a> " <code>for ... in ...</code> " рдлрд╝реЙрд░реНрдо рдХреЗ рд▓реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдиреЗ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдП</a> , рдЖрдк рдЗрд╕рдХреЗ рдмрд┐рдирд╛ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ;  рджреВрд╕рд░рд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдореБрдЦреНрдп рд╣реИ рдФрд░ InternetTools рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><code>IXQValue</code></a> рдкрд░ рдПрдХ рдПрдирд╛рд▓реЙрдЧ рд░реИрдкрд░ рд╣реИ (рдЗрд╕реЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЗрд╕реА рдирд╛рдо рд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рддрд╛рдХрд┐ рднрд╡рд┐рд╖реНрдп рдХреЗ рдбреЗрд▓реНрдлреА рдХреЛрдб рдХреЛ рдлреНрд░реА рдкрд╛рд╕реНрдХрд▓ рдкрд░ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдбреЙрдХреНрдпреВрдореЗрдВрдЯреЗрд╢рди рдХреЗ рд╕рд╛рде рд╕рд╣рд╕рдВрдмрдВрдзрд┐рдд рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛ рд╕рдХреЗ)ред  рдпрджрд┐ рд╣рдо рдореЙрдбреНрдпреВрд▓ рдХреЛ рдбрд┐рдЬрд╛рдЗрди рдкреИрдЯрд░реНрди рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдорд╛рдирддреЗ рд╣реИрдВ, рддреЛ рдЗрд╕рдореЗрдВ рдШреЛрд╖рд┐рдд рдЗрдВрдЯрд░рдлреЗрд╕ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдбреЗрдкреНрдЯрд░ рд╣реИрдВ</a> , рд╣рд╛рд▓рд╛рдВрдХрд┐ рдПрдХ рдЫреЛрдЯреА рд╕реА рд╡рд┐рд╢реЗрд╖рддрд╛ рдХреЗ рд╕рд╛рде - рдЙрдирдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдПрдХ рдЧрддрд┐рд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред <br><br>  рд╕рднреА рддрд░реАрдХреЛрдВ рдХреЗ рд▓рд┐рдП <code>safecall</code> рдХреЙрд▓ рдкреНрд░рдХрд╛рд░ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рд╡рд░реНрдгрд┐рдд <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> ред  "рджреЗрд╢реА" рддрд╛рд░реЛрдВ рдХреЗ рдмрдЬрд╛рдп <code>WideString</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдмрд╛рдзреНрдпрддрд╛ рдХреА рдкреБрд╖реНрдЯрд┐ рдирд╣реАрдВ рдХреА рдЬрд╛рдПрдЧреА, рдХреНрдпреЛрдВрдХрд┐ рдбреАрдПрд▓рдПрд▓ рдХреЗ рд╕рд╛рде рдЧрддрд┐рд╢реАрд▓ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛рдУрдВ рдХреЗ рдЖрджрд╛рди-рдкреНрд░рджрд╛рди рдХрд╛ рд╡рд┐рд╖рдп рдЗрд╕ рд▓реЗрдЦ рдХреЗ рджрд╛рдпрд░реЗ рд╕реЗ рдмрд╛рд╣рд░ рд╣реИред <br><br><h4>  InternetTools.Realization рдореЙрдбреНрдпреВрд▓ </h4><br>  рдорд╣рддреНрд╡ рдФрд░ рдорд╛рддреНрд░рд╛ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдкрд╣рд▓рд╛ - рдпрд╣ рд╡рд╣ рд╣реИ, рдЬреЛ рд╢реАрд░реНрд╖рдХ рдореЗрдВ рдкрд░рд┐рд▓рдХреНрд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рдореЗрдВ рдкрд┐рдЫрд▓реЗ рдПрдХ рд╕реЗ рдЗрдВрдЯрд░рдлреЗрд╕ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛: рдЙрди рджреЛрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХрдорд╛рддреНрд░ <code>TXQValue</code> рд╡рд░реНрдЧ рдХреЛ <code>TXQValue</code> , рдЬрд┐рдирдореЗрдВ рд╕реЗ рддрд░реАрдХреЗ рдЗрддрдиреЗ рд╕рд░рд▓ рд╣реИрдВ рдХрд┐ рд▓рдЧрднрдЧ рд╕рднреА рдореЗрдВ рдПрдХ рдкрдВрдХреНрддрд┐ рдХрд╛ рдХреЛрдб рд╣реЛрддрд╛ рд╣реИ (рдпрд╣ рдХрд╛рдлреА рд╣реИред рдЙрдореНрдореАрдж рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреБрд╕реНрддрдХрд╛рд▓рдп рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ - рдпрд╣рд╛рдВ рдЖрдкрдХреЛ рдмрд╕ рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ): <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">unit</span></span> InternetTools.Realization; <span class="hljs-meta"><span class="hljs-meta">{$MODE Delphi}</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> xquery, InternetTools.Types; <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> IOriginalXQValue = xquery.IXQValue; <span class="hljs-title"><span class="hljs-title">TXQValue</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TInterfacedObject, IXQValue, IXQValueEnumerator) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FOriginalXQValue: IOriginalXQValue; FEnumerator: TXQValueEnumerator; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveNext</span></span></span><span class="hljs-function">:</span></span> Boolean; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrent</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEnumerator</span></span></span><span class="hljs-function">:</span></span> IXQValueEnumerator; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">reintroduce</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constructor</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> OriginalXQValue: IOriginalXQValue)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">overload</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SafeCallException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ExceptObject: TObject; ExceptAddr: CodePointer)</span></span></span><span class="hljs-function">:</span></span> HResult; <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> sysutils, comobj, w32internetaccess; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MoveNext</span></span></span><span class="hljs-function">:</span></span> Boolean; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := FEnumerator.MoveNext; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCurrent</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TXQValue.Create(FEnumerator.Current); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetEnumerator</span></span></span><span class="hljs-function">:</span></span> IXQValueEnumerator; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> FEnumerator := FOriginalXQValue.GetEnumerator; Result := Self; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OpenURL</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> FOriginalXQValue := xqvalue(URL).retrieve; Result := Self; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Map</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> XQuery: WideString)</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TXQValue.Create( FOriginalXQValue.map(XQuery) ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToString</span></span></span><span class="hljs-function">:</span></span> WideString; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := FOriginalXQValue.toJoinedString(LineEnding); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">constructor</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> OriginalXQValue: IOriginalXQValue)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> FOriginalXQValue := OriginalXQValue; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TXQValue</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SafeCallException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ExceptObject: TObject; ExceptAddr: CodePointer)</span></span></span><span class="hljs-function">:</span></span> HResult; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := HandleSafeCallException(ExceptObject, ExceptAddr, GUID_NULL, ExceptObject.ClassName, <span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рдпрд╣ <code>SafeCallException</code> рдкрджреНрдзрддрд┐ рдкрд░ рд░реЛрдХ рдХреЗ рд▓рд╛рдпрдХ рд╣реИ - рдЗрд╕рдХреА рдЕрд╡рд░реЛрдзрди, рджреНрд╡рд╛рд░рд╛ рдФрд░ рдмрдбрд╝реА, рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ ( <code>TXQValue</code> рдкреНрд░рджрд░реНрд╢рди <code>TXQValue</code> рдмрд┐рдирд╛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛), рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣рд╛рдВ рджрд┐рдпрд╛ рдЧрдпрд╛ рдХреЛрдб рдбреЗрд▓реНрдлреА рдкрдХреНрд╖ рдХреЗ рдЕрдкрд╡рд╛рдж рдкрд╛рда рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдХрд┐ рд╕реБрд░рдХреНрд╖рд┐рдд рддрд░реАрдХреЗ (рд╡рд┐рд╡рд░рдг) рдореЗрдВ рд╣реЛрдЧрд╛ рдлрд┐рд░ рд╕реЗ, рдПрдХ рд╣рд╛рд▓рд┐рдпрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓реЗрдЦ</a> рдореЗрдВ рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ)ред <br><br>  рдпрд╣ рд╕рдорд╛рдзрд╛рди, рд╕рдм рдХреБрдЫ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдзрд╛рдЧрд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ - рдмрд╢рд░реНрддреЗ рдХрд┐ <code>IXQValue</code> рдкреНрд░рд╛рдкреНрдд рд╣реБрдЖ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>OpenURL</code> рдорд╛рдзреНрдпрдо рд╕реЗ, рдереНрд░реЗрдбреНрд╕ рдХреЗ рдмреАрдЪ рдкреНрд░реЗрд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗрд╡рд▓ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд╕реБрд░рдХреНрд╖рд┐рдд рдЗрдВрдЯрд░рдиреЗрдЯрдЯрд▓реНрд╕ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИред <br><br><h4>  InternetTools рдбрд╛рдпрдирд╛рдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА </h4><br>  рдЙрдкрд░реЛрдХреНрдд рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдп рдХреЗ рдХрд╛рд░рдг, рдпрд╣ DLL рдХреЗ рд▓рд┐рдП рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдирд┐рд░реНрдпрд╛рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ (рдЙрд╕ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд┐рдХрд▓реНрдк рдХреЗ</a> рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░реЗрдВ рдЬрд╣рд╛рдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛рддреНрдордХ рд╢реИрд▓реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛): <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">library</span></span> InternetTools; <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> InternetTools.Types, InternetTools.Realization; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetXQValue</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TXQValue.Create; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> GetXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> SetMultiByteConversionCodePage(CP_UTF8); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  <code>SetMultiByteConversionCodePage</code> рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХреЛ рдареАрдХ рд╕реЗ рдпреВрдирд┐рдХреЛрдб рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><h4>  InternetToolsUsage рдЕрдиреБрдкреНрд░рдпреЛрдЧ </h4><br>  рдпрджрд┐ рдЕрдм рд╣рдо рдкреНрд░рд╕реНрддрд╛рд╡рд┐рдд рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЙрджрд╛рд╣рд░рдг</a> рдХреЗ рдбреЗрд▓реНрдлреА рд╕рдорд╛рдзрд╛рди рдХреЛ рдФрдкрдЪрд╛рд░рд┐рдХ рд░реВрдк рджреЗрддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдирд┐: рд╢реБрд▓реНрдХ рдкрд╛рд╕реНрдХрд▓ рдкрд░ рд╢рд╛рдпрдж рд╣реА рдЕрд▓рдЧ рд╣реЛрдЧрд╛, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд▓реЗрдЦ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд╛рд░реНрдп рдХреЛ рдкреВрд░рд╛ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">program</span></span> InternetToolsUsage; ... <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> System.Win.ComObj, InternetTools.Types; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DLLName = <span class="hljs-string"><span class="hljs-string">'InternetTools.dll'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetXQValue</span></span></span><span class="hljs-function">:</span></span> IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">external</span></span> DLLName; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ListValue: IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ListValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> GetXQValue.OpenURL(ArticleURL).Map(ListXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln(ListValue.ToString); ReadLn; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  <code>System.Win.ComObj</code> рдореЙрдбреНрдпреВрд▓ рдЧрд▓рддреА рд╕реЗ рдЬреБрдбрд╝рд╛ рдирд╣реАрдВ рд╣реИ - рдЗрд╕рдХреЗ рдмрд┐рдирд╛, рд╕рднреА рд╕реЗрдлрд╝рдХреЙрд▓ рдЕрдкрд╡рд╛рджреЛрдВ рдХрд╛ рдкрд╛рда рдПрдХ рдореБрдЦрд░ "рд╕реЗрдлрд╝рдХреЙрд▓ рд╡рд┐рдзрд┐ рдореЗрдВ рдЕрдкрд╡рд╛рдж" рдмрди рдЬрд╛рдПрдЧрд╛, рдФрд░ рдЗрд╕рдХреЗ рд╕рд╛рде рдбреАрдПрд▓рдПрд▓ рдореЗрдВ рдЙрддреНрдкрдиреНрди рдореВрд▓ рдореВрд▓реНрдпред <br><br>  рдЗрд╕реА рддрд░рд╣ рдереЛрдбрд╝рд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬрдЯрд┐рд▓ рдЙрджрд╛рд╣рд░рдг</a> рдбреЗрд▓реНрдлреА рдкрд░ рдиреНрдпреВрдирддрдо рдорддрднреЗрдж рд╣реИрдВ: <br><br><pre> <code class="delphi hljs">... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; ListXPath = <span class="hljs-string"><span class="hljs-string">'//div[@class="post__body post__body_full"]//li[a]'</span></span>; HrefXPath = <span class="hljs-string"><span class="hljs-string">'./a/@href'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ListValue, HrefValue: IXQValue; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ListValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> GetXQValue.OpenURL(ArticleURL).Map(ListXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-comment"><span class="hljs-comment">{   }</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> HrefValue <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ListValue.Map(HrefXPath) <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> Writeln(HrefValue.ToString); ReadLn; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br><h4>  рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рд╢реЗрд╖ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ </h4><br>  рдпрджрд┐ рдЖрдк InternetTools рд╕реЗ <a href="">IXQValue</a> рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреА рдкреВрд░реНрдг рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рджреЗрдЦрддреЗ рд╣реИрдВ, рддреЛ рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ <code>InternetTools.Types</code> рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрдмрдВрдзрд┐рдд рдЗрдВрдЯрд░рдлрд╝реЗрд╕</a> рд╕рдВрдкреВрд░реНрдг рд╕рдореГрджреНрдз рд╕реЗрдЯ рд╕реЗ рдХреЗрд╡рд▓ 2 рд╡рд┐рдзрд┐рдпрд╛рдБ ( <code>Map</code> рдФрд░ <code>ToString</code> ) рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИ;  рдмрд╛рдХреА рдХреЛ рдЬреЛрдбрд╝рдирд╛ рдЬреЛ рдкрд╛рдардХ рдЕрдкрдиреЗ рд╡рд┐рд╢реЗрд╖ рдорд╛рдорд▓реЗ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╕рдордЭрддрд╛ рд╣реИ, рдареАрдХ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдФрд░ рд╕рд░рд▓рддрд╛ рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: рдЖрд╡рд╢реНрдпрдХ рддрд░реАрдХреЗ рдЗрдВрдЯрд░рдиреЗрдЯрдЯреЗрд▓реНрд╕ рдореЗрдВ рд▓рд┐рдЦреЗ рдЧрдП рд╣реИрдВред рдЗрд╕рдХреЗ рдмрд╛рдж рд╡реЗ рдЗрдВрдЯрд░рдиреЗрдЯрдЯреИрд▓рд╕ рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдХреЛрдб рдХреЗ рд╕рд╛рде рдХреЛрдбрд╛рдВрддрд░рдг рдореЙрдбреНрдпреВрд▓ (рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдмрд╛рд░ рдПрдХ рдкрдВрдХреНрддрд┐ рдХреЗ рд░реВрдк рдореЗрдВ)ред <br><br>  рдпрджрд┐ рдЖрдкрдХреЛ рдереЛрдбрд╝реА рдЕрд▓рдЧ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреБрдХреА рдкреНрд░рдмрдВрдзрди, рдЪрд░рдгреЛрдВ рдХрд╛ рдХреНрд░рдо рдмрд╣реБрдд рд╕рдорд╛рди рд╣реИ: <br><br><ol><li>  <code>InternetTools.Types</code> рдореЗрдВ рдПрдХ рдирдпрд╛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ <code>InternetTools.Types</code> рдЧрдпрд╛ <code>InternetTools.Types</code> : <br><br><pre> <code class="delphi hljs">... ICookies = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{21D0CC9A-204D-44D2-AF00-98E9E04412CD}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Value: WideString)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ...</code> -AF00-98E9E04412CD}'] <code class="delphi hljs">... ICookies = <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> [<span class="hljs-string"><span class="hljs-string">'{21D0CC9A-204D-44D2-AF00-98E9E04412CD}'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Value: WideString)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ...</code> </pre> </li><li>  рдлрд┐рд░ рдЗрд╕реЗ <code>InternetTools.Realization</code> рдореЙрдбреНрдпреВрд▓ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="delphi hljs">... <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-title"><span class="hljs-title">TCookies</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">class</span></span>(TInterfacedObject, ICookies) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Value: WideString)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">safecall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SafeCallException</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ExceptObject: TObject; ExceptAddr: CodePointer)</span></span></span><span class="hljs-function">:</span></span> HResult; <span class="hljs-keyword"><span class="hljs-keyword">override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ... <span class="hljs-keyword"><span class="hljs-keyword">implementation</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uses</span></span> ..., internetaccess; ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TCookies</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> URL, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Name</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Value: WideString)</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> defaultInternet.cookies.setCookie( decodeURL(URL).host, decodeURL(URL).path, <span class="hljs-keyword"><span class="hljs-keyword">Name</span></span>, Value, [] ); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TCookies</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clear</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> defaultInternet.cookies.clear; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; ...</code> </pre> </li><li>  рдЙрд╕рдХреЗ рдмрд╛рдж, рдПрдХ рдирдпрд╛ рдирд┐рд░реНрдпрд╛рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдлрд╝рдВрдХреНрд╢рди DLL рдореЗрдВ рд▓реМрдЯрд╛ рд╣реИ рдЬреЛ рдЗрд╕ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рд▓реМрдЯрд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="delphi hljs">... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCookies</span></span></span><span class="hljs-function">:</span></span> ICookies; <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Result := TCookies.Create; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> ..., GetCookies; ...</code> </pre> </li></ol><br><h4>  рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреА рд░рд┐рд╣рд╛рдИ </h4><br>  рдпрджреНрдпрдкрд┐ рдЗрдВрдЯрд░рдиреЗрдЯрдЯреВрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЙрди рдЗрдВрдЯрд░рдлреЗрд╕ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИ рдЬреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЬреАрд╡рдирдХрд╛рд▓ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рдПрдХ рдЧреИрд░-рд╕реНрдкрд╖реНрдЯ рдЕрддрд┐ рд╕реВрдХреНрд╖реНрдо рдЕрдВрддрд░ рд╣реИ рдЬреЛ рдореЗрдореЛрд░реА рд▓реАрдХ рдХреЛ рдЬрдиреНрдо рджреЗрдЧрд╛ - рдпрджрд┐ рдЖрдк рдЕрдЧрд▓рд╛ рдХрдВрд╕реЛрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЪрд▓рд╛рддреЗ рд╣реИрдВ (рдбреЗрд▓реНрдлреА рдкрд░ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдПрдлрдкреАрд╕реА рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдХреБрдЫ рднреА рдирд╣реАрдВ рдмрджрд▓реЗрдЧрд╛), рдлрд┐рд░ рд╣рд░ рдмрд╛рд░ рдЬрдм рдЖрдк рдПрдВрдЯрд░ рдХреБрдВрдЬреА рджрдмрд╛рддреЗ рд╣реИрдВ, рддреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рджреНрд╡рд╛рд░рд╛ рдЦрдкрдд рдХреА рдЧрдИ рдореЗрдореЛрд░реА рдмрдврд╝реЗрдЧреА: <br><br><pre> <code class="delphi hljs">... <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArticleURL = <span class="hljs-string"><span class="hljs-string">'https://habr.com/post/415617'</span></span>; TitleXPath = <span class="hljs-string"><span class="hljs-string">'//head/title'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> I: Integer; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> I := <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Writeln( GetXQValue.OpenURL(ArticleURL).Map(TitleXPath).ToString ); Readln; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>.</code> </pre> <br>  рдпрд╣рд╛рдВ рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд╕рд╛рде рдХреЛрдИ рддреНрд░реБрдЯрд┐ рдирд╣реАрдВ рд╣реИред  рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ InternetTools рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рджреМрд░рд╛рди рдЖрд╡рдВрдЯрд┐рдд рдЕрдкрдиреЗ рдЖрдВрддрд░рд┐рдХ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХреЛ рдЬрд╛рд░реА рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ ( <code>OpenURL</code> рд╡рд┐рдзрд┐ рдореЗрдВ) - рдЗрд╕реЗ рдХрд╛рдо рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реНрдкрд╖реНрдЯ рд░реВрдк</a> рд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП;  рдЗрди рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП, <code>xquery</code> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЙрдбреНрдпреВрд▓ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="><code>freeThreadVars</code></a> рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рдбреЗрд▓реНрдлреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдХреЙрд▓ рдХреЛ DLL рдирд┐рд░реНрдпрд╛рдд рд╕реВрдЪреА рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдХреЗ рддрд╛рд░реНрдХрд┐рдХ рд░реВрдк рд╕реЗ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="delphi hljs">... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">procedure</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FreeResources</span></span></span><span class="hljs-function">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">stdcall</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> freeThreadVars; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">exports</span></span> ..., FreeResources; ...</code> </pre> <br>  рдЗрд╕рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдмрд╛рдж, рд╕рдВрд╕рд╛рдзрдиреЛрдВ рдХрд╛ рдиреБрдХрд╕рд╛рди рдмрдВрдж рд╣реЛ рдЬрд╛рдПрдЧрд╛: <br><br><pre> <code class="delphi hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> I := <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-number"><span class="hljs-number">100</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> Writeln( GetXQValue.OpenURL(ArticleURL).Map(TitleXPath).ToString ); FreeResources; Readln; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>;</code> </pre> <br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреЛ рд╕рдордЭрдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ - <code>FreeResources</code> рд▓рд┐рдП рдПрдХ рдХреЙрд▓ рдЗрд╕ рддрдереНрдп рдХреА рдУрд░ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдкрд╣рд▓реЗ рдкреНрд░рд╛рдкреНрдд рд╕рднреА рдЗрдВрдЯрд░рдлреЗрд╕ рдЕрд░реНрдерд╣реАрди рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рднреА рдкреНрд░рдпрд╛рд╕ рдЕрд╕реНрд╡реАрдХрд╛рд░реНрдп рд╣реИред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi415617/">https://habr.com/ru/post/hi415617/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi415601/index.html">рдХрдВрдЯреЗрдирд░ рдХреЗ рд╕рд╛рде рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рд╣рд╛ рдХреНрд▓рд╕реНрдЯрд░ред рдпрд╛ рдмрд┐рдирд╛ рдХрд░реНрддрд╛ рдХреЗ рдЬреАрд╡рди рд╣реИ?</a></li>
<li><a href="../hi415605/index.html">рд╣рдордиреЗ рдПрдХреНрд╕рдбрд╛рдЯрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рд░реНрдб рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдХреЛ рдХреИрд╕реЗ рдмрдЪрд╛рдпрд╛</a></li>
<li><a href="../hi415611/index.html">PKI: рд░реВрд╕реА рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА рдХреЗ рд╕рдорд░реНрдерди рдХреЗ рд╕рд╛рде OpenSSL рдХреЗ рд╡рд┐рдХрд▓реНрдк рдХреЗ рд░реВрдк рдореЗрдВ GCrypt рдФрд░ KSBA рд▓рд╛рдЗрдмреНрд░реЗрд░реАред рд╡рд┐рд╕реНрддрд╛рд░</a></li>
<li><a href="../hi415613/index.html">рдЖрдкрдХреЛ рдПрд▓рдИрдбреА рдЭреВрдорд░ рдХреНрдпреЛрдВ рдирд╣реАрдВ рдЦрд░реАрджрдирд╛ рдЪрд╛рд╣рд┐рдП</a></li>
<li><a href="../hi415615/index.html">рд╕реНрд╡рд┐рдлреНрдЯ 3 рдореЗрдВ iOS рдореЗрдВ рдПрдкреАрдЖрдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рд░реНрд╡рд░ рдХреЗ рд╕рд╛рде рд╕рд╣рднрд╛рдЧрд┐рддрд╛ 3. рднрд╛рдЧ 2</a></li>
<li><a href="../hi415619/index.html">рдРрдкреНрдкрд▓ рдФрд░ рд╕реИрдорд╕рдВрдЧ 7-рд╡рд░реНрд╖реАрдп рдкреЗрдЯреЗрдВрдЯ рдпреБрджреНрдз рдХреЛ рдкреВрд░рд╛ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi415621/index.html">рдЦрдирди рдирд┐рдЧрд░рд╛рдиреА рдкреНрд░рдгрд╛рд▓реА</a></li>
<li><a href="../hi415623/index.html">рдПрдХ рд╡рд┐рдорд╛рди рдХреА рдКрд░реНрдзреНрд╡рд╛рдзрд░ рдЙрдбрд╝рд╛рди рдХреА рдЧрддрд┐рд╢реАрд▓рддрд╛ рд╣рд╡рд╛ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рд╣рд▓реНрдХреА рд╣реЛрддреА рд╣реИ</a></li>
<li><a href="../hi415625/index.html">рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕: рд╡реЗрдмрд┐рдирд╛рд░ (4 рдЬреБрд▓рд╛рдИ 19:30) рдФрд░ рдЧрд╣рди (3-5 рдЕрдЧрд╕реНрдд)</a></li>
<li><a href="../hi415627/index.html">рдХреИрд╕реЗ (рдирд╣реАрдВ) рдЖрдкрдХреЛ рдПрдХ рдЧрдзреЗ рдмрдирдирд╛ рд╣реИ: рдПрдХ рддрдХрдиреАрдХреА рдирд┐рд░реНрджреЗрд╢рдХ рдХреА рдХрд╣рд╛рдиреА</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>