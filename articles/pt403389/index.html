<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🀄️ 👨🏻‍⚕️ 👐🏿 PhotoScan: como tirar fotos sem ofuscar 😀 👩🏽‍🎨 👨‍👩‍👦‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em 19 de abril de 2017, lançamos uma atualização para o PhotoScan , nosso aplicativo móvel para iOS e Android, que permite digitalizar fotos em papel ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PhotoScan: como tirar fotos sem ofuscar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403389/">  Em 19 de abril de 2017, lançamos uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">atualização para o PhotoScan</a> , nosso aplicativo móvel para iOS e Android, que permite digitalizar fotos em papel com apenas um smartphone.  Um dos principais recursos do PhotoScan é a capacidade de remover o brilho das fotos (geralmente são impressas em papel brilhante e altamente refletivo), bem como de páginas de álbuns de plástico ou fotos em vidro.  Para fazer isso, desenvolvemos uma combinação única de visão computacional e tecnologia de processamento de imagem que pode combinar e combinar com precisão várias fotos ligeiramente diferentes da foto e separar o destaque da própria imagem na foto. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/121/b1e/f1c/121b1ef1c5199b8c5022e1375717252a.png" alt="imagem"><br><a name="habracut"></a><br>  De uma foto, é muito difícil determinar automaticamente quais partes da imagem são a foto original e quais são o destaque.  Além disso, o brilho pode iluminar áreas da foto, pelo que será impossível restaurar a parte dele que está oculta sob o brilho.  Mas se você tirar várias fotos da foto movendo a câmera, o reflexo da lente muda - ela se move por diferentes partes da foto.  Na maioria dos casos, cada pixel individual não será exibido pelo menos em uma das imagens.  Embora nenhuma das fotos fique sem brilho, podemos combinar várias fotos da foto impressa tiradas em ângulos diferentes e, assim, remover o brilho.  A dificuldade é que as imagens devem ser alinhadas com muita precisão para que sejam combinadas corretamente, e esse processamento deve ser realizado no smartphone com rapidez suficiente para obter o efeito de um resultado quase instantâneo. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/a34/502/009/a34502009b1dfac0607f1de8f5d2f35b.gif"></div></div><br><br>  Nossa tecnologia foi inspirada em nosso trabalho anterior publicado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SIGGRAPH 2015</a> , que chamamos de “ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fotografia sem obstruções</a> ”.  Ele usa princípios semelhantes para remover várias interferências do campo de visão.  Mas o algoritmo original foi baseado em um modelo generativo no qual foram avaliados o movimento e a aparência da cena principal e a interferência.  Os recursos desse modelo são ótimos e podem remover uma variedade de interferências - mas é muito caro em termos computacionais para ser usado em smartphones.  Portanto, desenvolvemos um modelo simplificado que se refere ao alargamento como uma espécie de anomalia e tenta reconhecer a imagem abaixo dele.  Embora o modelo seja simplificado, ainda é uma tarefa muito difícil - o reconhecimento deve ser preciso e confiável. <br><br><h2>  Como isso funciona </h2><br>  Começamos com um conjunto de instantâneos da fotografia tirada pelo usuário que moveu a câmera.  O primeiro instantâneo - "quadro de referência" - determina a aparência final desejada do instantâneo.  Recomenda-se ao usuário tirar quatro fotos adicionais.  Em cada quadro, determinamos os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pontos-chave</a> (calculamos as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">propriedades dos ORBs</a> nos ângulos determinados usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o algoritmo Harris</a> ) e os usamos para determinar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">homógrafos</a> que mapeiam cada quadro subsequente para o de referência. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/03b/7be/25b/03b7be25b83e8ece727ce2e2eb4d27b7.gif"></div></div><br><br>  A tecnologia parece simples, mas tem uma pegada - os homógrafos podem apenas comparar imagens planas.  Mas as fotografias em papel geralmente não são planas (como no exemplo acima).  Utilizamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fluxo óptico</a> - uma representação fundamental do movimento na visão computacional, estabelecendo uma correspondência pixel por pixel entre duas imagens, corrigindo desvios do plano.  Começamos com quadros alinhados usando homografia e contamos os "campos de fluxo" para endireitar as imagens e ajustar ainda mais.  Observe que no exemplo abaixo, os cantos da foto esquerda "movem-se" um pouco depois de definir os quadros usando apenas homografia.  À direita, você pode ver como a foto está melhor alinhada após a aplicação do fluxo óptico. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/827/b49/85e/827b4985e1fdd1a18f41bed01ff463ab.gif"></div></div><br><br>  A diferença não é muito marcante, mas afeta significativamente o resultado final.  Preste atenção em como pequenas discrepâncias se manifestam na forma de fragmentos de imagem duplicados e em como essas falhas são eliminadas por refinamentos adicionais usando fluxos. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/427/96a/5cb/42796a5cbf0548ca409434771022a16f.png"><br><br>  E, nesse caso, a dificuldade estava em fazer o algoritmo de fluxo óptico de trabalho lento trabalhar mais rápido em um smartphone.  Em vez do cálculo tradicional do fluxo para cada pixel (o número de vetores é igual ao número de pixels), construímos o campo de fluxo usando um número menor de pontos de controle e registramos o movimento de cada pixel na imagem em função do movimento dos pontos de controle.  Nomeadamente, dividimos cada imagem em células separadas que formam uma estrutura de granulação grossa e representam o fluxo de pixels em uma célula separada como uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">combinação bilinear do</a> fluxo e os quatro cantos da célula que o contém. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/d4c/c27/97a/d4cc2797ae9627e9ee166be11e8b12d9.png"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/79d/9b7/f51/79d9b7f515784254e406361bba5ca10f.png"><br><br>  Resta então resolver um problema mais simples, já que o número de vetores de fluxo agora é igual ao número de pontos da rede, que geralmente são muito menores que os pixels.  Esse processo é semelhante ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">processamento de imagens splining</a> .  Com esse algoritmo, conseguimos reduzir o tempo de cálculo do fluxo óptico no telefone Pixel em cerca de 40 vezes! <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/f7c/ac0/316/f7cac0316cb25966db02f2dce50a2edf.gif"></div></div><br><br>  Por fim, para criar a imagem final sem brilho, para cada parte do quadro, pegamos os valores de pixel e calculamos o “mínimo mínimo” para encontrar a opção mais escura.  Especificamente, calculamos o brilho mínimo esperado a partir dos quadros disponíveis e atribuímos pesos menores aos pixels mais próximos das bordas curvas das imagens.  Utilizamos esse método em vez de calcular diretamente o mínimo devido ao fato de que os mesmos pixels em quadros diferentes podem ter um brilho diferente.  O mínimo de pixel por pixel pode levar ao aparecimento de juntas visíveis devido a mudanças bruscas de intensidade nos limites das imagens sobrepostas. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/16a/95a/311/16a95a31193a215c9617c9f24e0d5a7a.png"><br><br>  O algoritmo é capaz de trabalhar em várias condições de digitalização - fotos foscas e brilhantes, fotos em álbuns e sem elas, capas de revistas. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/5c3/032/dd9/5c3032dd96cc68aea7f240a4dbacb299.gif"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/437/4b3/be6/4374b3be6aac2e6a16f086f16c62ec6d.gif"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/4ba/124/d96/4ba124d9610ece18f12265b466d602fb.gif"><br></div></div><br><br>  Para calcular o resultado final, nossa equipe desenvolveu um método que determina automaticamente os limites da imagem e o leva a uma visualização retangular.  Devido à distorção da perspectiva, uma foto retangular digitalizada geralmente se transforma em um quadrilátero não retangular.  O método analisa sinais, cores e bordas da imagem para descobrir para onde vão as bordas exatas da foto original e depois aplica transformações geométricas para endireitar a imagem.  O resultado é uma versão digital de alta qualidade da fotografia em papel, sem brilho. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/7b9/5ee/532/7b95ee532f40a5dcbf73e12052c8606e.png"><br><br>  Em geral, muitas coisas estão acontecendo sob o capô, e tudo isso funciona quase instantaneamente no seu telefone!  Você pode experimentar o PhotoScan baixando a versão do aplicativo para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Android</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">iOS</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt403389/">https://habr.com/ru/post/pt403389/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt403377/index.html">Análise do Telefone IP DECT Yealink W56P</a></li>
<li><a href="../pt403379/index.html">Desenvolvedor de cartão de crédito Plastc Smart recebe US $ 9 milhões em pré-encomendas e falência anunciada</a></li>
<li><a href="../pt403381/index.html">Além do local de trabalho: de que outra forma um freelancer de coworking pode ser útil</a></li>
<li><a href="../pt403383/index.html">Filosofia da Informação, Capítulo 3. Razões</a></li>
<li><a href="../pt403385/index.html">Eletrônica para role-playing games em 2016</a></li>
<li><a href="../pt403393/index.html">Veículos não tripulados ensinam truques de direção no Grand Theft Auto V</a></li>
<li><a href="../pt403397/index.html">Por alguma razão, beber refrigerantes se correlaciona com o volume cerebral.</a></li>
<li><a href="../pt403399/index.html">Os funcionários do YouTube procuram ódio no vídeo. A IA observa e aprende</a></li>
<li><a href="../pt403401/index.html">A Grã-Bretanha viveu um dia sem carvão como fonte de eletricidade pela primeira vez desde 1882</a></li>
<li><a href="../pt403403/index.html">Cebola para de coletar doações para microcomputador Omega 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>