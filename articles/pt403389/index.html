<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÄÑÔ∏è üë®üèª‚Äç‚öïÔ∏è üëêüèø PhotoScan: como tirar fotos sem ofuscar üòÄ üë©üèΩ‚Äçüé® üë®‚Äçüë©‚Äçüë¶‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em 19 de abril de 2017, lan√ßamos uma atualiza√ß√£o para o PhotoScan , nosso aplicativo m√≥vel para iOS e Android, que permite digitalizar fotos em papel ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PhotoScan: como tirar fotos sem ofuscar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403389/">  Em 19 de abril de 2017, lan√ßamos uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">atualiza√ß√£o para o PhotoScan</a> , nosso aplicativo m√≥vel para iOS e Android, que permite digitalizar fotos em papel com apenas um smartphone.  Um dos principais recursos do PhotoScan √© a capacidade de remover o brilho das fotos (geralmente s√£o impressas em papel brilhante e altamente refletivo), bem como de p√°ginas de √°lbuns de pl√°stico ou fotos em vidro.  Para fazer isso, desenvolvemos uma combina√ß√£o √∫nica de vis√£o computacional e tecnologia de processamento de imagem que pode combinar e combinar com precis√£o v√°rias fotos ligeiramente diferentes da foto e separar o destaque da pr√≥pria imagem na foto. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/121/b1e/f1c/121b1ef1c5199b8c5022e1375717252a.png" alt="imagem"><br><a name="habracut"></a><br>  De uma foto, √© muito dif√≠cil determinar automaticamente quais partes da imagem s√£o a foto original e quais s√£o o destaque.  Al√©m disso, o brilho pode iluminar √°reas da foto, pelo que ser√° imposs√≠vel restaurar a parte dele que est√° oculta sob o brilho.  Mas se voc√™ tirar v√°rias fotos da foto movendo a c√¢mera, o reflexo da lente muda - ela se move por diferentes partes da foto.  Na maioria dos casos, cada pixel individual n√£o ser√° exibido pelo menos em uma das imagens.  Embora nenhuma das fotos fique sem brilho, podemos combinar v√°rias fotos da foto impressa tiradas em √¢ngulos diferentes e, assim, remover o brilho.  A dificuldade √© que as imagens devem ser alinhadas com muita precis√£o para que sejam combinadas corretamente, e esse processamento deve ser realizado no smartphone com rapidez suficiente para obter o efeito de um resultado quase instant√¢neo. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/a34/502/009/a34502009b1dfac0607f1de8f5d2f35b.gif"></div></div><br><br>  Nossa tecnologia foi inspirada em nosso trabalho anterior publicado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SIGGRAPH 2015</a> , que chamamos de ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fotografia sem obstru√ß√µes</a> ‚Äù.  Ele usa princ√≠pios semelhantes para remover v√°rias interfer√™ncias do campo de vis√£o.  Mas o algoritmo original foi baseado em um modelo generativo no qual foram avaliados o movimento e a apar√™ncia da cena principal e a interfer√™ncia.  Os recursos desse modelo s√£o √≥timos e podem remover uma variedade de interfer√™ncias - mas √© muito caro em termos computacionais para ser usado em smartphones.  Portanto, desenvolvemos um modelo simplificado que se refere ao alargamento como uma esp√©cie de anomalia e tenta reconhecer a imagem abaixo dele.  Embora o modelo seja simplificado, ainda √© uma tarefa muito dif√≠cil - o reconhecimento deve ser preciso e confi√°vel. <br><br><h2>  Como isso funciona </h2><br>  Come√ßamos com um conjunto de instant√¢neos da fotografia tirada pelo usu√°rio que moveu a c√¢mera.  O primeiro instant√¢neo - "quadro de refer√™ncia" - determina a apar√™ncia final desejada do instant√¢neo.  Recomenda-se ao usu√°rio tirar quatro fotos adicionais.  Em cada quadro, determinamos os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pontos-chave</a> (calculamos as <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">propriedades dos ORBs</a> nos √¢ngulos determinados usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o algoritmo Harris</a> ) e os usamos para determinar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">hom√≥grafos</a> que mapeiam cada quadro subsequente para o de refer√™ncia. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/03b/7be/25b/03b7be25b83e8ece727ce2e2eb4d27b7.gif"></div></div><br><br>  A tecnologia parece simples, mas tem uma pegada - os hom√≥grafos podem apenas comparar imagens planas.  Mas as fotografias em papel geralmente n√£o s√£o planas (como no exemplo acima).  Utilizamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fluxo √≥ptico</a> - uma representa√ß√£o fundamental do movimento na vis√£o computacional, estabelecendo uma correspond√™ncia pixel por pixel entre duas imagens, corrigindo desvios do plano.  Come√ßamos com quadros alinhados usando homografia e contamos os "campos de fluxo" para endireitar as imagens e ajustar ainda mais.  Observe que no exemplo abaixo, os cantos da foto esquerda "movem-se" um pouco depois de definir os quadros usando apenas homografia.  √Ä direita, voc√™ pode ver como a foto est√° melhor alinhada ap√≥s a aplica√ß√£o do fluxo √≥ptico. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/827/b49/85e/827b4985e1fdd1a18f41bed01ff463ab.gif"></div></div><br><br>  A diferen√ßa n√£o √© muito marcante, mas afeta significativamente o resultado final.  Preste aten√ß√£o em como pequenas discrep√¢ncias se manifestam na forma de fragmentos de imagem duplicados e em como essas falhas s√£o eliminadas por refinamentos adicionais usando fluxos. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/427/96a/5cb/42796a5cbf0548ca409434771022a16f.png"><br><br>  E, nesse caso, a dificuldade estava em fazer o algoritmo de fluxo √≥ptico de trabalho lento trabalhar mais r√°pido em um smartphone.  Em vez do c√°lculo tradicional do fluxo para cada pixel (o n√∫mero de vetores √© igual ao n√∫mero de pixels), constru√≠mos o campo de fluxo usando um n√∫mero menor de pontos de controle e registramos o movimento de cada pixel na imagem em fun√ß√£o do movimento dos pontos de controle.  Nomeadamente, dividimos cada imagem em c√©lulas separadas que formam uma estrutura de granula√ß√£o grossa e representam o fluxo de pixels em uma c√©lula separada como uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">combina√ß√£o bilinear do</a> fluxo e os quatro cantos da c√©lula que o cont√©m. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/d4c/c27/97a/d4cc2797ae9627e9ee166be11e8b12d9.png"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/79d/9b7/f51/79d9b7f515784254e406361bba5ca10f.png"><br><br>  Resta ent√£o resolver um problema mais simples, j√° que o n√∫mero de vetores de fluxo agora √© igual ao n√∫mero de pontos da rede, que geralmente s√£o muito menores que os pixels.  Esse processo √© semelhante ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">processamento de imagens splining</a> .  Com esse algoritmo, conseguimos reduzir o tempo de c√°lculo do fluxo √≥ptico no telefone Pixel em cerca de 40 vezes! <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/f7c/ac0/316/f7cac0316cb25966db02f2dce50a2edf.gif"></div></div><br><br>  Por fim, para criar a imagem final sem brilho, para cada parte do quadro, pegamos os valores de pixel e calculamos o ‚Äúm√≠nimo m√≠nimo‚Äù para encontrar a op√ß√£o mais escura.  Especificamente, calculamos o brilho m√≠nimo esperado a partir dos quadros dispon√≠veis e atribu√≠mos pesos menores aos pixels mais pr√≥ximos das bordas curvas das imagens.  Utilizamos esse m√©todo em vez de calcular diretamente o m√≠nimo devido ao fato de que os mesmos pixels em quadros diferentes podem ter um brilho diferente.  O m√≠nimo de pixel por pixel pode levar ao aparecimento de juntas vis√≠veis devido a mudan√ßas bruscas de intensidade nos limites das imagens sobrepostas. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/16a/95a/311/16a95a31193a215c9617c9f24e0d5a7a.png"><br><br>  O algoritmo √© capaz de trabalhar em v√°rias condi√ß√µes de digitaliza√ß√£o - fotos foscas e brilhantes, fotos em √°lbuns e sem elas, capas de revistas. <br><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/5c3/032/dd9/5c3032dd96cc68aea7f240a4dbacb299.gif"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/437/4b3/be6/4374b3be6aac2e6a16f086f16c62ec6d.gif"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/4ba/124/d96/4ba124d9610ece18f12265b466d602fb.gif"><br></div></div><br><br>  Para calcular o resultado final, nossa equipe desenvolveu um m√©todo que determina automaticamente os limites da imagem e o leva a uma visualiza√ß√£o retangular.  Devido √† distor√ß√£o da perspectiva, uma foto retangular digitalizada geralmente se transforma em um quadril√°tero n√£o retangular.  O m√©todo analisa sinais, cores e bordas da imagem para descobrir para onde v√£o as bordas exatas da foto original e depois aplica transforma√ß√µes geom√©tricas para endireitar a imagem.  O resultado √© uma vers√£o digital de alta qualidade da fotografia em papel, sem brilho. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/7b9/5ee/532/7b95ee532f40a5dcbf73e12052c8606e.png"><br><br>  Em geral, muitas coisas est√£o acontecendo sob o cap√¥, e tudo isso funciona quase instantaneamente no seu telefone!  Voc√™ pode experimentar o PhotoScan baixando a vers√£o do aplicativo para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Android</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">iOS</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt403389/">https://habr.com/ru/post/pt403389/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt403377/index.html">An√°lise do Telefone IP DECT Yealink W56P</a></li>
<li><a href="../pt403379/index.html">Desenvolvedor de cart√£o de cr√©dito Plastc Smart recebe US $ 9 milh√µes em pr√©-encomendas e fal√™ncia anunciada</a></li>
<li><a href="../pt403381/index.html">Al√©m do local de trabalho: de que outra forma um freelancer de coworking pode ser √∫til</a></li>
<li><a href="../pt403383/index.html">Filosofia da Informa√ß√£o, Cap√≠tulo 3. Raz√µes</a></li>
<li><a href="../pt403385/index.html">Eletr√¥nica para role-playing games em 2016</a></li>
<li><a href="../pt403393/index.html">Ve√≠culos n√£o tripulados ensinam truques de dire√ß√£o no Grand Theft Auto V</a></li>
<li><a href="../pt403397/index.html">Por alguma raz√£o, beber refrigerantes se correlaciona com o volume cerebral.</a></li>
<li><a href="../pt403399/index.html">Os funcion√°rios do YouTube procuram √≥dio no v√≠deo. A IA observa e aprende</a></li>
<li><a href="../pt403401/index.html">A Gr√£-Bretanha viveu um dia sem carv√£o como fonte de eletricidade pela primeira vez desde 1882</a></li>
<li><a href="../pt403403/index.html">Cebola para de coletar doa√ß√µes para microcomputador Omega 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>