<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คค ๐ ๐ข ูููู ุชููู Ceph ... ูู ูู ุฌูุฏ ุฌุฏุงุ ๐ฒ๐พ ๐ง ๐ฝ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฃูุง ุฃุญุจ Ceph. ุฃุนูู ูุนู ููุฐ 4 ุณููุงุช (0.80.x-  12.2.6  ุ 12.2.5). ุฃุญูุงููุง ุฃููู ุดุบูููุง ุจู ูุฏุฑุฌุฉ ุฃููู ุฃูุถู ุฃูุณูุงุช ูููุงูู ูู ุดุฑูุชู ุ ูููุณ ูุน ุตุฏููุชู. ููุฏ ูุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูููู ุชููู Ceph ... ูู ูู ุฌูุฏ ุฌุฏุงุ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/croccloudteam/blog/422905/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fm/pp/3b/fmpp3bma4xf_j2pxwystnjgezc0.png"></p><br><p style=";text-align:right;direction:rtl">  ุฃูุง ุฃุญุจ Ceph.  ุฃุนูู ูุนู ููุฐ 4 ุณููุงุช (0.80.x- <del>  12.2.6 </del> ุ 12.2.5).  ุฃุญูุงููุง ุฃููู ุดุบูููุง ุจู ูุฏุฑุฌุฉ ุฃููู ุฃูุถู ุฃูุณูุงุช ูููุงูู ูู ุดุฑูุชู ุ ูููุณ ูุน ุตุฏููุชู.  ููุฏ ูุงุฌูุช ูุดุงูู ูุฎุชููุฉ ูู ูุฐุง ุงูููุชุฌ ุ ููุง ุฒูุช ุฃุนูุด ูุน ุงูุจุนุถ ุญุชู ููููุง ูุฐุง.  ูู ุจุนุถ ุงูุฃุญูุงู ููุช ุณุนูุฏูุง ุจูุฑุงุฑุงุช ุณููุฉ ุ ูุฃุญูุงููุง ููุช ุฃุญูู ุจููุงุก ูุทูุฑูู ููุชุนุจูุฑ ุนู ุณุฎุทุชู.  ููู Ceph ูุง ูุฒุงู ูุณุชุฎุฏู ูู ูุดุฑูุนูุง ููู ุงููุญุชูู ุฃูู ุณูุชู ุงุณุชุฎุฏุงูู ูู ููุงู ุฌุฏูุฏุฉ ุ ุนูู ุงูุฃูู ูู ูุจูู.  ูู ูุฐู ุงููุตุฉ ุ ุณูู ุฃุดุงุฑู ุชุฌุฑุจุชูุง ูู ุชุดุบูู Ceph ุ ุจุทุฑููุฉ ูุง ุณุฃุนุจุฑ ุนู ููุณู ุญูู ููุถูุน ูุง ูุง ูุนุฌุจูู ูู ูุฐุง ุงูุญู ูุฑุจูุง ุณุงุนุฏ ุฃููุฆู ุงูุฐูู ููุธุฑูู ุฅููู ููุชู.  ุฏูุนุชูู ุงูุฃุญุฏุงุซ ุงูุชู ุจุฏุฃุช ููุฐ ุญูุงูู ุนุงู ุนูุฏูุง ุฃุญุถุฑุช Dell EMC ScaleIO ุ ุงููุนุฑูู ุงูุขู ุจุงุณู Dell EMC VxFlex OS ุ ุฅูู ูุชุงุจุฉ ูุฐุง ุงูููุงู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ููุณ ุจุฃู ุญุงู ูู ุงูุฃุญูุงู ุฅุนูุงููุง ูุดุฑูุฉ Dell EMC ุฃู ููุชุฌูุง!  ุฃูุง ุดุฎุตูุงู ูุณุช ุฌูุฏูุง ุฌุฏูุง ูุน ุงูุดุฑูุงุช ุงููุจูุฑุฉ ูุงูุตูุงุฏูู ุงูุณูุฏุงุก ูุซู VxFlex OS.  ูููู ููุง ุชุนูููู ุ ูู ุดูุก ูู ุงูุนุงูู ูุณุจู ูุจุงุณุชุฎุฏุงู ูุซุงู VxFlex OS ุ ูู ุงูููุงุฆู ุฌุฏูุง ุฅุธูุงุฑ ูุง ูู Ceph ูู ุญูุซ ุงูุชุดุบูู ุ ูุณุฃุญุงูู ุงูููุงู ุจุฐูู. <a name="habracut"></a></p><br><h2 id="parametry-rech-idet-o-4-znachnyh-chislah" style=";text-align:right;direction:rtl">  ูุนููุงุช  ุญูุงูู 4 ุฃุฑูุงู! </h2><br><p style=";text-align:right;direction:rtl">  ุฎุฏูุงุช Ceph ูุซู MON ุ OSD ุ ุฅูุฎ.  ูุฏููุง ูุนููุงุช ูุฎุชููุฉ ูุฅุนุฏุงุฏ ุฌููุน ุฃููุงุน ุงููุธู ุงููุฑุนูุฉ.  ูุชู ุชุนููู ุงููุนููุงุช ูู ููู ุงูุชูููู ุ ูููุฑุฃูุง daemons ูู ููุช ุงูุฅุทูุงู.  ูููู ุชุบููุฑ ุจุนุถ ุงูููู ุจุดูู ููุงุฆู ุนูู ุงูููุฑ ุจุงุณุชุฎุฏุงู ุขููุฉ "ุงูุญูู" ุงูููุถุญุฉ ุฃุฏูุงู.  ูู ุดูุก ุฑุงุฆุน ุชูุฑูุจูุง ุ ุฅุฐุง ุญุฐูุช ูุญุธุฉ ูุฌูุฏ ุงููุฆุงุช ูู ุงููุนููุงุช: <br><br>  ุงููุทุฑูุฉ: </p><br><pre style=";text-align:right;direction:rtl"><code class="html hljs xml">&gt; ceph daemon mon.a config show | wc -l 863</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุถูุฆุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="html hljs xml">&gt; ceph daemon mon.a config show | wc -l 1401</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงุชุถุญ ~ 500 ูุนููุฉ ุฌุฏูุฏุฉ ูู ุนุงููู.  ุจุดูู ุนุงู ุ ุงููุนููุฉ ุฑุงุฆุนุฉ ุ ููุณ ูู ุงูุฑุงุฆุน ูุฌูุฏ ุตุนูุจุงุช ูู ููู 80ูช ูู ูุฐู ุงููุงุฆูุฉ.  ุชุตู ุงููุซุงุฆู ุญุณุจ ุชูุฏูุฑู ~ 20ูช ููู ุจุนุถ ุงูุฃูุงูู ุบุงูุถุฉ.  ูุฌุจ ููู ูุนูู ูุนุธู ุงููุนููุงุช ูู github ูููุดุฑูุน ุฃู ูู ุงูููุงุฆู ุงูุจุฑูุฏูุฉ ุ ูููู ูุฐุง ูุง ูุณุงุนุฏ ุฏุงุฆููุง. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุง ููู ูุซุงู ุนูู ุงูุนุฏูุฏ ูู ุงููุนููุงุช ุงูุชู ููุช ููุชููุง ุจูุง ูุคุฎุฑูุง ุ ููุฏ ูุฌุฏุชูุง ูู ูุฏููุฉ ุฃุญุฏ Ceph-gadfly: </p><br><pre style=";text-align:right;direction:rtl"> <code class="html hljs xml">throttler_perf_counter = false // enable/disable throttler perf counter osd_enable_op_tracker = false // enable/disable OSD op tracking</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุนูููุงุช ุงููุฏููุฉ ุจุฑูุญ ุฃูุถู ุงูููุงุฑุณุงุช.  ููุง ูู ุฃููู ุฃููู ุงููููุงุช ูุญุชู ูุง ุชุนููู ุชูุฑูุจูุง ุ ูููู ูุง ุณูุนุทููู ุฅูุงู ููุณ ูุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ุฃู ููุง: <strong>ุงุฎุชูู osd_op_threads</strong> ูู Luminous ููู ุชุณุงุนุฏ ุงููุตุงุฏุฑ ุฅูุง ูู ุฅูุฌุงุฏ ุงุณู ุฌุฏูุฏ: <strong>ุณูุงุณู osd_peering_wq</strong> </p><br><p style=";text-align:right;direction:rtl">  ุฃูุง ุฃูุถูุง ุฃุญุจ ุฃู ููุงู ุฎูุงุฑุงุช ุดุงููุฉ ุจุดูู ุฎุงุต.  ูุธูุฑ ุงููุชุฃูู ููุง ุฃู ุฒูุงุฏุฉ <strong>rgw_num _rados_handles</strong> ุฃูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฌูุฏ</a> : </p><br><p style=";text-align:right;direction:rtl">  ููุนุชูุฏ ุงููุชุฃูู ุงูุขุฎุฑ ุฃู&gt; 1 ุฃูุฑ ูุณุชุญูู ุจู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎุทูุฑ</a> . </p><br><p style=";text-align:right;direction:rtl">  ูุงูุดูุก ุงูููุถู ูุฏู ูู ุนูุฏูุง ูุนุทู ุงููุจุชุฏุฆูู ุฃูุซูุฉ ุนูู ุงูุชูููู ูู ูุดุงุฑูุงุช ุงููุฏููุฉ ุงูุฎุงุตุฉ ุจูู ุ ุญูุซ ูุชู ูุณุฎ ุฌููุน ุงููุนููุงุช ุจูุง ุชูููุฑ (ูุจุฏู ูู) ูู ูุฏููุฉ ุฃุฎุฑู ูู ููุณ ุงูููุน ุ ูุจุงูุชุงูู ูุฅู ูุฌููุนุฉ ูู ุงููุนููุงุช ุงูุชู ูุง ูุนุฑููุง ุฃุญุฏ ุจุงุณุชุซูุงุก ูุคูู ุงูุดูุฑุฉ ูุชุฌูู ูู ุงูุชูููู ูุชูููู. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุง ุฃูุถุง ุฃุญุฑู ุจุดุฏุฉ ูุน ูุง ูุนููู ูู Luminous.  ููุงู ููุฒุฉ ุฑุงุฆุนุฉ ุฌุฏูุง - ุชุบููุฑ ุงููุนููุงุช ุจุณุฑุนุฉ ุ ุฏูู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุนูููุงุช.  ููููู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุชุบููุฑ ูุนููุฉ OSD ูุญุฏุฏุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="html hljs xml">&gt; ceph tell osd.12 injectargs '--filestore_fd_cache_size=512'</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู ุถุน "*" ุจุฏูุงู ูู 12 ูุณูุชู ุชุบููุฑ ุงููููุฉ ูู ุฌููุน OSDs.  ุฅูู ุฑุงุฆุน ุญููุง.  ูููู ุ ูุซู ุงููุซูุฑ ูู Ceph ุ ูุชู ุฐูู ุจุงููุฏู ุงููุณุฑู.  ุชุตููู Bai ูุง ูููู ุชุบููุฑ ุฌููุน ููู ุงููุนููุงุช ุจุณุฑุนุฉ.  ุจุชุนุจูุฑ ุฃุฏู ุ ูููู ุชุนููููุง ูุณุชุธูุฑ ูุชุบูุฑุฉ ูู ุงูุฅุฎุฑุงุฌ ุ ูููู ูู ุงููุงูุน ุ ุชุชู ุฅุนุงุฏุฉ ูุฑุงุกุฉ ุงููููู ูููุง ูุฅุนุงุฏุฉ ุชุทุจูููุง.  ุนูู ุณุจูู ุงููุซุงู ุ ูุง ููููู ุชุบููุฑ ุญุฌู ุชุฌูุน ูุคุดุฑ ุงูุชุฑุงุจุท ุฏูู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุนูููุฉ.  ุญุชู ูููู ูุฏูุฑ ุงููุฑูู ุฃูู ูู ุบูุฑ ุงููุฌุฏู ุชุบููุฑ ุงููุนููุฉ ุจูุฐู ุงูุทุฑููุฉ - ูุฑุฑูุง ุทุจุงุนุฉ ุฑุณุงูุฉ.  ูุฑุญุจูุง. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="html hljs xml">&gt; ceph tell mon.* injectargs '--mon_allow_pool_delete=true' mon.c: injectargs:mon_allow_pool_delete = 'true' (not observed, change may require restart) mon.a: injectargs:mon_allow_pool_delete = 'true' (not observed, change may require restart) mon.b: injectargs:mon_allow_pool_delete = 'true' (not observed, change may require restart)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุบุงูุถ.  ูู ุงููุงูุน ุ ุชุตุจุญ ุฅุฒุงูุฉ ุงูุจุฑู ููููุฉ ุจุนุฏ ุงูุญูู.  ุฃู ุฃู ูุฐุง ุงูุชุญุฐูุฑ ุบูุฑ ุฐู ุตูุฉ ุจูุฐู ุงููุนููุฉ.  ุญุณููุง ุ ูููู ูุง ูุฒุงู ููุงู ุงููุฆุงุช ูู ุงููุนููุงุช ุ ุจูุง ูู ุฐูู ุงููุนููุงุช ุงููููุฏุฉ ุฌุฏูุง ุ ูุงูุชู ุชุญุชูู ุฃูุถูุง ุนูู ุชุญุฐูุฑ ููุง ุชูุฌุฏ ุทุฑููุฉ ููุชุญูู ูู ุชุทุจูููุง ุงููุนูู.  ูู ุงูููุช ุงูุญุงูู ุ ูุง ุฃุณุชุทูุน ุญุชู ุฃู ุฃููู ูู ุฎูุงู ุงูููุฏ ุงููุนููุงุช ุงูุชู ูุชู ุชุทุจูููุง ุจุนุฏ ุงูุญูู ูุงูุชู ูุง ูุชู ุชุทุจูููุง.  ูู ุฃุฌู ุงูููุซูููุฉ ุ ูุฌุจ ุนููู ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุงุช ููุฐุง ุ ููุง ุชุนูู ุ ูุซูุฑ ุงูุบุถุจ.  ูุบุถุจ ูุฃููู ุฃุนูู ุฃู ููุงู ุขููุฉ ุญูู. </p><br><p style=";text-align:right;direction:rtl">  ูุงุฐุง ุนู VxFlex OSุ  ุนูููุงุช ููุงุซูุฉ ูุซู MON (ูู VxFlex ูู MDM) ุ OSD (SDS ูู VxFlex) ูุฏููุง ุฃูุถูุง ูููุงุช ุชูููู ุ ุญูุซ ููุฌุฏ ุงูุนุดุฑุงุช ูู ุงููุนููุงุช ููุฌููุน.  ุตุญูุญ ุฃู ุฃุณูุงุฆูู ุฃูุถูุง ูุง ุชููู ุฃู ุดูุก ุ ููู ุงูุฎุจุฑ ุงูุณุงุฑ ูู ุฃููุง ูู ููุฌุฃ ุฅูููู ุฃุจุฏูุง ููุญุฑู ูุซููุง ุญุฏุซ ูุน Ceph. </p><br><h2 id="tehnicheskiy-dolg" style=";text-align:right;direction:rtl">  ุงูุฏูู ุงูููู </h2><br><p style=";text-align:right;direction:rtl">  ุนูุฏูุง ุชุจุฏุฃ ุงูุชุนุงุฑู ูุน Ceph ูุน ุงูุฅุตุฏุงุฑ ุงูุฃูุซุฑ ุตูุฉ ุงูููู ุ ูุจุฏู ูู ุดูุก ุนูู ูุง ูุฑุงู ุ ูุชุฑูุฏ ูุชุงุจุฉ ููุงู ุฅูุฌุงุจู.  ูููู ุนูุฏูุง ุชุนูุด ูุนู ูู ุญุซ ูู ุงูุฅุตุฏุงุฑ 0.80 ุ ูุฅู ูู ุดูุก ูุง ูุจุฏู ูุฑุฏูุฉ ููุบุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุจู ุงูุฌููุฑุฉ ุ ูุงูุช ุนูููุงุช Ceph ุชุนูู ูุฌุฐุฑ.  ูุฑุฑุช ุฌููู ุฃูู ูุฌุจ ุฃู ุชุนูู ูู ุงููุณุชุฎุฏู ceph ููุฐุง ูุชุทูุจ ุชุบููุฑ ุงูููููุฉ ูุฌููุน ุงูุฏูุงุฆู ุงูุชู ุชุณุชุฎุฏููุง ุฎุฏูุงุช Ceph.  ูุจุฏู ุฃู ูุฐุงุ  ุชุฎูู OSD ุงูุฐู ูุฎุฏู ูุฑุต ูุบูุงุทูุณู SATA ุจุณุนุฉ ูุงููุฉ 2 ุชูุฑุงุจุงูุช.  ูุฐุง ุ ูุฅู ูุฐุง ุงููุฑุต ุ ุจุงูุชูุงุฒู (ูุน ุงูุฏูุงุฆู ุงููุฑุนูุฉ ุงููุฎุชููุฉ) ูุน ุงุณุชุฎุฏุงู ุงููุฑุต ุงููุงูู ูุณุชุบุฑู 3-4 ุณุงุนุงุช.  ุชุฎูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุฏูู 3 ูุฆุงุช ูู ูุฐู ุงูุฃูุฑุงุต.  ุญุชู ุฅุฐุง ููุช ุจุชุญุฏูุซ ุงูุนูุฏ (ูุชู ุชุฎุฒูููุง ุนูู ุงูููุฑ ูู 8 ุฅูู 12 ูุฑุตูุง) ุ ูุณุชุญุตู ุนูู ุชุญุฏูุซ ุทููู ุฅูู ุญุฏ ูุง ุ ุญูุซ ุณุชุญุชูู ุงููุฌููุนุฉ ุนูู OSD ูู ุฅุตุฏุงุฑุงุช ูุฎุชููุฉ ููุณุฎุฉ ูุงุญุฏุฉ ูู ุงูุจูุงูุงุช ุฃูู ูู ููุช ุชุญุฏูุซ ุงูุฎุงุฏู.  ุจุดูู ุนุงู ุ ุงุนุชูุฏูุง ุฃูู ูู ุงูุนุจุซ ูุฅุนุงุฏุฉ ุจูุงุก ุญุฒู Ceph ูุชุฑู OSD ุชุนูู ูุฌุฐุฑ.  ูุฑุฑูุง ุฃูู ุนูุฏูุง ูุฏุฎู ุฃู ูุณุชุจุฏู OSD ุ ุณูููููุง ุฅูู ูุณุชุฎุฏู ุฌุฏูุฏ.  ุงูุขู ูููู ุจุชุบููุฑ 2-3 ูุญุฑูุงุช ุฃูุฑุงุต ูู ุงูุดูุฑ ูุฅุถุงูุฉ 1-2 ุ ุฃุนุชูุฏ ุฃูู ูููููุง ุงูุชุนุงูู ูุนูุง ุจุญููู ุนุงู 2022). </p><br><p style=";text-align:right;direction:rtl">  ุงูุงููุงู CRUSH </p><br><p style=";text-align:right;direction:rtl">  <strong>CRUSH</strong> ูู ููุจ Ceph ุ ูู ุดูุก ูุฏูุฑ ุญููู.  ูุฐู ูู ุงูุฎูุงุฑุฒููุฉ ุงูุชู ูุชู ูู ุฎูุงููุง ุชุญุฏูุฏ ูููุน ุงูุจูุงูุงุช ุจุทุฑููุฉ ุนุดูุงุฆูุฉ ุฒุงุฆูุฉ ูุจูุถู ุฐูู ุ ููุชุดู ุงูุนููุงุก ุงูุฐูู ูุนูููู ูุน ูุฌููุนุฉ RADOS ุฃู OSD ูุชู ุชุฎุฒูู ุงูุจูุงูุงุช (ุงููุงุฆูุงุช) ุงูุชู ูุญุชุงุฌูููุง.  ุงูููุฒุฉ ุงูุฑุฆูุณูุฉ ูู CRUSH ูู ุฃูู ูุง ุชูุฌุฏ ุญุงุฌุฉ ุฅูู ุฃู ุฎูุงุฏู ุจูุงูุงุช ูุตููุฉ ุ ูุซู Luster ุฃู IBM GPFS (ุงูุขู ูููุงุณ ุงูุทูู).  ูุชูุญ CRUSH ููุนููุงุก ู OSD ุงูุชูุงุนู ูุจุงุดุฑุฉ ูุน ุจุนุถูู ุงูุจุนุถ.  ุนูู ุงูุฑุบู ูู ุฃูู ูู ุงูุตุนุจ ุจุงูุทุจุน ููุงุฑูุฉ ุฃูุธูุฉ ุชุฎุฒูู ุงููุงุฆูุงุช ููููุงุช RADOS ุงูุจุฏุงุฆูุฉ ุ ูุงูุชู ุฃุนุทูุชูุง ููุซุงู ุ ูููู ุฃุนุชูุฏ ุฃู ุงูููุฑุฉ ูุงุถุญุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุจุฏูุฑูุง ุ ุชุนุฏ ุฃููุงู CRUSH ูุฌููุนุฉ ูู ุงููุนููุงุช / ุงูุฃุนูุงู ุงูุชู ุชุคุซุฑ ุนูู ุชุดุบูู CRUSH ุ ููุง ูุฌุนููุง ุฃูุซุฑ ููุงุกุฉ ุ ุนูู ุงูุฃูู ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุนูุฏ ุงูุชุฑููุฉ ูู Hammer ุฅูู Jewel (ุงุฎุชุจุงุฑ ุจุดูู ุทุจูุนู) ุ ุธูุฑ ุชุญุฐูุฑ ุ ูููู ุฃู ููู ุชุนุฑูู ุงูุฃููุงู ูุญุชูู ุนูู ูุนููุงุช ุบูุฑ ูุซุงููุฉ ููุฅุตุฏุงุฑ ุงูุญุงูู (Jewel) ูููุตู ุจุชุบููุฑ ุงูููู ุงูุดุฎุตู ุฅูู ุงููุถุน ุงูุฃูุซู.  ุจุดูู ุนุงู ุ ูู ุดูุก ูุงุถุญ.  ูููู ุงูุฑุตูู ุฃู ูุฐุง ููู ุฌุฏูุง ููุฐุง ูู ุงูุทุฑูู ุงูุตุญูุญ ุ ูููู ูููุงู ุฃูุถูุง ุฃูู ุจุนุฏ ุชุจุฏูู ุงูุจูุงูุงุช ุณูููู ููุงู ุฅุนุงุฏุฉ ุชูุฑุฏ ุจูุณุจุฉ 10 ูช ูู ุงูุจูุงูุงุช.  10ูช - ูุง ูุจุฏู ูุฎููุง ุ ููููุง ูุฑุฑูุง ุงุฎุชุจุงุฑู.  ุจุงููุณุจุฉ ูููุชูุฉ ุ ููู ุฃูู ุจุญูุงูู 10 ูุฑุงุช ูู ุงููุฌููุนุฉ ุ ูุน ููุณ ุงูุนุฏุฏ ูู PGs ููู OSD ุ ูููุฆุฉ ุจุจูุงูุงุช ุงูุงุฎุชุจุงุฑ ุ ุญุตููุง ุนูู ุชูุฑุฏ ุจูุณุจุฉ 60 ูช!  ุชุฎูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุน 100 ุชูุฑุงุจุงูุช ูู ุงูุจูุงูุงุช ุ ูุจุฏุฃ 60 ุชูุฑุงุจุงูุช ูู ุงูุงูุชูุงู ุจูู OSDs ููุฐุง ูุน ุงุณุชูุฑุงุฑ ุชุญููู ุงูุนููู ุงูุฐู ูุชุทูุจ ููุช ุงุณุชุฌุงุจุฉ!  ุฅุฐุง ูู ุฃูู ุจุนุฏ ุ ููุญู ููุฏู s3 ูููุณ ูุฏููุง ุญูู ุฃูู ุจูุซูุฑ ุนูู rgw ุญุชู ูู ุงูููู ุ ูููุง 8 ู 4 ุฃุฎุฑู ุชุญุช ููุงูุน ุงูููุจ ุงูุซุงุจุชุฉ.  ุจุดูู ุนุงู ุ ูุฑุฑูุง ุฃู ูุฐุง ูู ููู ุทุฑูููุง ุ ุฎุงุตุฉ ูุฃู ุงูููุงู ุจูุฐุง ุฅุนุงุฏุฉ ุจูุงุก ุนูู ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ ุ ุงูุฐู ูู ููู ูุฏ ุนูููุง ุจู ูู ุงูููุชุฌ ุ ูุงู ุนูู ุงูุฃูู ูุชูุงุฆููุง ููุบุงูุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุงู ูุฏููุง ูุคุดุฑุงุช ุฏูู ูุจูุฑุฉ ุชุนูุฏ ุงูุจูุงุก ุจุดูู ุณูุฆ ููุบุงูุฉ ููุงู ูุฐุง ุฃูุถูุง ุณุจุจ ุงูุชุฃุฎูุฑ ูู ุชุจุฏูู ุงูููู ุงูุดุฎุตู.  ุญูู ุงููุคุดุฑุงุช ุณูููู ุจุดูู ูููุตู ุฃูู ููููุงู.  ูู ุงูููุงูุฉ ุ ุฃุฒููุง ุงูุชุญุฐูุฑ ููุฑุฑูุง ุงูุนูุฏุฉ ุฅููู ูุงุญููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุนูุฏ ุชุจุฏูู ุงูููู ุงูุดุฎุตู ูู ุงูุงุฎุชุจุงุฑ ุ ุณูุท ุนููุงุก cephfs ุงูููุฌูุฏูู ูู ููุงุฉ CentOS 7.2 ูุฃููู ูู ูุชููููุง ูู ุงูุนูู ูุน ุฎูุงุฑุฒููุฉ ุงูุชุฌุฒุฆุฉ ุงูุฃุญุฏุซ ููููู ุงูุดุฎุตู ุงูุฌุฏูุฏ ุงูุฐู ุฌุงุก.  ูุญู ูุง ูุณุชุฎุฏู cephfs ูู prod ุ ูููู ุฅุฐุง ุงุนุชุฏูุง ุนูู ุฐูู ุ ูุณูููู ูุฐุง ุณุจุจูุง ุขุฎุฑ ูุนุฏู ุชุจุฏูู ุงูููู ุงูุดุฎุตู. </p><br><p style=";text-align:right;direction:rtl">  ุจุงูููุงุณุจุฉ ุ ูููู ุงูุฑุตูู ุฃูู ุฅุฐุง ูุงู ูุง ูุญุฏุซ ุฃุซูุงุก ุงูุชูุฑุฏ ูุง ููุงุณุจู ุ ูููููู ุงูุชุฑุงุฌุน ุนู ุงูููู ุงูุดุฎุตู.  ูู ุงููุงูุน ุ ุจุนุฏ ุงูุชุซุจูุช ุงููุธูู ูุฅุตุฏุงุฑ Hammer ูุงูุชุฑููุฉ ุฅูู Jewel ุ ูุจุฏู ุงูููู ุงูุดุฎุตู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="html hljs xml">&gt; ceph osd crush show-tunables { ... "straw_calc_version": 1, "allowed_bucket_algs": 22, "profile": "unknown", "optimal_tunables": 0, ... }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงูููู ุฃู ุชููู "ุบูุฑ ูุนุฑููุฉ" ูุฅุฐุง ุญุงููุช ุฅููุงู ุฅุนุงุฏุฉ ุงูุจูุงุก ุนู ุทุฑูู ุชุญููููุง ุฅูู "ุฅุฑุซ" (ููุง ูู ูุฐููุฑ ูู ุงูุฑุตูู) ุฃู ุญุชู "ูุทุฑูุฉ" ุ ููู ูุชููู ุงูุชูุฑุฏ ุ ุจู ุณูุณุชูุฑ ููููุง ููุฃููุงู ุงูุฃุฎุฑู ุ ูููุณ " ุงูุฃูุซู ".  ุจุดูู ุนุงู ุ ูู ุดูุก ูุญุชุงุฌ ุฅูู ูุญุต ุฏููู ููุญุต ูุฒุฏูุฌ ุ ceph ุบูุฑ ููุซูู ุจู. </p><br><p style=";text-align:right;direction:rtl">  ุชุฌุงุฑุฉ CRUSH </p><br><p style=";text-align:right;direction:rtl">  ููุง ุชุนูููู ุ ูู ุดูุก ูู ูุฐุง ุงูุนุงูู ูุชูุงุฒู ููุชู ุชุทุจูู ุงูุนููุจ ุนูู ุฌููุน ุงููุฒุงูุง.  ุนูุจ CRUSH ูู ุฃู PGs ูุชู ุชูุฒูุนูุง ุจุดูู ุบูุฑ ูุชุณุงู ุนุจุฑ ูุฎุชูู OSD ุญุชู ูุน ููุณ ูุฒู ูุฐุง ุงูุฃุฎูุฑ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุง ููุฌุฏ ุดูุก ูููุน PGs ูุฎุชููุฉ ูู ุงูููู ุจุณุฑุนุงุช ูุฎุชููุฉ ุ ุจูููุง ุณุชูุฎูุถ ูุธููุฉ ุงูุชุฌุฒุฆุฉ.  ุนูู ูุฌู ุงูุชุญุฏูุฏ ุ ูุฏููุง ูุฌููุนุฉ ูู ุงุณุชุฎุฏุงู OSD ุจูุณุจุฉ 48-84 ูช ุ ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู ูุฏููู ููุณ ุงูุญุฌู ูุจุงูุชุงูู ุงููุฒู.  ุญุชู ุฃููุง ูุญุงูู ุฌุนู ุงูุฎูุงุฏู ูุชุณุงููุฉ ูู ุงููุฒู ุ ูููู ูุฐุง ูู ุงูุฃูุฑ ุ ููุท ููุงููุชูุง ุ ูุง ุฃูุซุฑ.  ูุงูุชูู ูุน ุญูููุฉ ุฃู IO ูุชู ุชูุฒูุนู ุจุดูู ุบูุฑ ูุชุณุงูู ุนุจุฑ ุงูุฃูุฑุงุต ุ ูุฅู ุฃุณูุฃ ุดูุก ูู ุฃูู ุนูุฏูุง ุชุตู ุฅูู ุงูุญุงูุฉ ุงููุงููุฉ (95ูช) ุนูู ุงูุฃูู ูู ูุงุฆูุฉ OSD ูุงุญุฏุฉ ูู ุงููุฌููุนุฉ ุ ูุชููู ุงูุชุณุฌูู ุจุงููุงูู ูุชุชุญูู ุงููุชูุฉ ูููุฑุงุกุฉ ููุท.  ุงููุชูุฉ ูููุง!  ููุง ููู ุฃู ุงููุชูุฉ ูุง ุชุฒุงู ูููุฆุฉ ุจุงููุณุงุญุฉ.  ูู ุดูุก ุ ุงูููุงุฆู ุ ูุฎุฑุฌ!  ูุฐู ููุฒุฉ ูุนูุงุฑูุฉ ูู CRUSH.  ุชุฎูู ุฃูู ูู ุฅุฌุงุฒุฉ ุ ุจุนุถ OSD ูุณุฑ ุนูุงูุฉ 85ูช (ุงูุชุญุฐูุฑ ุงูุฃูู ุจุดูู ุงูุชุฑุงุถู) ุ ููุฏูู 10ูช ูู ุงููุฎุฒูู ูููุน ุงูุชุณุฌูู ูู ุงูุชููู.  ู 10ูช ูุน ุงูุชุณุฌูู ุงููุณุชูุฑ ููุณ ูุซูุฑูุง / ุทูููุงู.  ูู ุงููุงุญูุฉ ุงููุซุงููุฉ ุ ูุน ูุฐุง ุงูุชุตููู ุ ูุญุชุงุฌ Ceph ุฅูู ุดุฎุต ูู ุงูุฎุฏูุฉ ููููู ุงุชุจุงุน ุงูุชุนูููุงุช ุงููุนุฏุฉ ูู ูุซู ูุฐู ุงูุญุงูุงุช. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุ ูุฑุฑูุง ุฃูู ูุนูู ุนุฏู ุชูุงุฒู ุงูุจูุงูุงุช ูู ุงููุชูุฉ ุ ูุฃู  ูุงูุช ุงูุนุฏูุฏ ูู OSDs ูุฑูุจุฉ ูู ุนูุงูุฉ ูุฑูุจุฉ (85 ูช). </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุนุฏุฉ ุทุฑู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃุถู ูุญุฑูุงุช </li></ul><br><p style=";text-align:right;direction:rtl">  ุฃุณูู ุทุฑููุฉ ูุถูุนุฉ ููููุงู ูููุณุช ูุนุงูุฉ ููุบุงูุฉ ุ ูุฃู  ูุฏ ูุง ุชูุชูู ุงูุจูุงูุงุช ููุณูุง ูู ูุงุฆูุฉ OSD ุงููุฒุฏุญูุฉ ุฃู ุฃู ุงูุญุฑูุฉ ุณุชููู ุถุฆููุฉ. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุบููุฑ ุงููุฒู ุงูุฏุงุฆู ูู OSD (WEIGHT) </li></ul><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูุคุฏู ุฅูู ุชุบููุฑ ูู ูุฒู ูู ุงูุชุณูุณู ุงููุฑูู (ูุตุทูุญุงุช CRUSH) ุ ุฎุงุฏู OSD ุ ูุฑูุฒ ุงูุจูุงูุงุช ุ ุฅูุฎ.  ููุชูุฌุฉ ูุฐูู ุ ูููู ุงูุจูุงูุงุช ุ ุจูุง ูู ุฐูู ููุณ ูู ุชูู OSD ุงูุชู ุชููู ุถุฑูุฑูุฉ. <br>  ููุฏ ุญุงูููุง ูุฎูุถ ูุฒู ุฃุญุฏ OSD ุ ุจุนุฏ ุฃู ุชู ููุก ุงูุจูุงูุงุช ุงูุชู ุฃุนูุฏุช ุจูุงุก ุฃุฎุฑู ุ ููููุงูุง ุ ุซู ุงูุซุงูุซ ุ ูุฃุฏุฑููุง ุฃููุง ุณููุนุจ ูุฐุง ููุชุฑุฉ ุทูููุฉ. </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุบููุฑ ูุฒู OSD ุบูุฑ ุงูุฏุงุฆู (REWEIGHT) </li></ul><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูุง ูุชู ูู ุฎูุงู ุงุณุชุฏุนุงุก "ceph osd Reweight by by ุงูุงุณุชูุงุฏุฉ".  ูุฐุง ูุคุฏู ุฅูู ุชุบููุฑ ูู ูุง ูุณูู ุจูุฒู ุชุนุฏูู OSD ุ ููุง ูุชุบูุฑ ูุฒู ุงูุฌุฑุงูุฉ ุงูุฃุนูู.  ููุชูุฌุฉ ูุฐูู ุ ุชุชู ููุงุฒูุฉ ุงูุจูุงูุงุช ุจูู OSDs ุงููุฎุชููุฉ ูุฎุงุฏู ูุงุญุฏ ุ ููุง ูุงูุช ุ ุฏูู ุชุฌุงูุฒ ุญุฏูุฏ ูุฌููุนุฉ CRUSH.  ููุฏ ุฃุญุจุจูุง ุญููุง ูุฐุง ุงูููุฌ ุ ูุธุฑูุง ูู ุงูุชุดุบูู ุงูุฌุงู ููุชุบููุฑุงุช ุงูุชู ุณูุชู ุฅุฌุฑุงุคูุง ูุชูููุฐูุง ุนูู ุงูููุชุฌ.  ูุงู ูู ุดูุก ุนูู ูุง ูุฑุงู ุญุชู ุญุตูุช ุนูููุฉ ุฅุนุงุฏุฉ ุงูุชูุงุฒู ุนูู ุญุตุฉ ูู ุงููุณุท.  ูุฑุฉ ุฃุฎุฑู ุบูุบู ุ ููุฑุงุกุฉ ุงูุฑุณุงุฆู ุงูุฅุฎุจุงุฑูุฉ ุ ูุชุฌุฑุจุฉ ุฎูุงุฑุงุช ูุฎุชููุฉ ุ ููู ุงูููุงูุฉ ุงุชุถุญ ุฃู ุงูุชููู ูุงู ุจุณุจุจ ุนุฏู ูุฌูุฏ ุจุนุถ ุงูุงููุงู ูู ุงูููู ุงูุดุฎุตู ุงููุฐููุฑ ุฃุนูุงู.  ูุฑุฉ ุฃุฎุฑู ููุนูุง ูู ุฏููู ูููุฉ.  ููุชูุฌุฉ ูุฐูู ุ ุฐูุจูุง ูู ูุณุงุฑ ุฅุถุงูุฉ ุงูุฃูุฑุงุต ูุฅุนุงุฏุฉ ุงูุจูุงุก ุงูุฃูุซุฑ ูุนุงููุฉ.  ูุญุณู ุงูุญุธ ุ ูุง ุฒููุง ุจุญุงุฌุฉ ููููุงู ุจุฐูู ูุฃูู  ูุงู ูู ุงููุฎุทุท ุชุจุฏูู ููู CRUSH ุจูุงูุด ูุงูู ูู ุงูุณุนุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุนู ุ ูุญู ูุนุฑู ุนู ุงูููุงุฒู (ุงููุถูุก ูุงูุฃุนูู) ุ ููู ุฌุฒุก ูู mgr ุ ูุงูุฐู ุชู ุชุตูููู ูุญู ูุดููุฉ ุงูุชูุฒูุน ุบูุฑ ุงููุชูุงูุฆ ููุจูุงูุงุช ุนู ุทุฑูู ููู PG ุจูู OSDs ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงูููู.  ููููู ูู ุฃุณูุน ุจุนุฏ ููุงุญุธุงุช ุฅูุฌุงุจูุฉ ุญูู ุนููู ุ ุญุชู ูู ุงูุชูููุฏ ุงูุญุงูู. </p><br><p style=";text-align:right;direction:rtl">  ุฑุจูุง ุณุชููู ุฅู ุงูุฏูู ุงูุชููู ูู ูุดููุชูุง ุงูุจุญุชุฉ ูุฑุจูุง ุฃูุงูู ุนูู ุฐูู.  ูููู ููุฏุฉ ุฃุฑุจุน ุณููุงุช ูุน Ceph ูู ุงููุฎุฒ ุ ุณุฌููุง ููุช ุชุนุทู ูุงุญุฏ ููุท S3 ุ ูุงูุฐู ุงุณุชูุฑ ููุฏุฉ ุณุงุนุฉ ูุงููุฉ.  ูุจุนุฏ ุฐูู ุ ูู ุชูู ุงููุดููุฉ ูู RADOS ุ ูููู ูู RGW ุ ุงูุชู ุ ุจุนุฏ ูุชุงุจุฉ 100 ุฎูุท ุงูุชุฑุงุถู ุ ุนููุช ุจุดุฏุฉ ููู ูุณุชูู ูุนุธู ุงููุณุชุฎุฏููู ุงูุทูุจุงุช.  ูุงู ูุง ูุฒุงู ุนูู ูุทุฑูุฉ.  ูู ุฑุฃูู ุ ูุฐุง ูุคุดุฑ ุฌูุฏ ููุชู ุชุญูููู ูุธุฑูุง ูุฃููุง ูุง ูููู ุจุญุฑูุงุช ููุงุฌุฆุฉ ููุชุดูููู ูู ูู ุดูุก ูู Ceph. </p><br><h2 id="dikiy-gc" style=";text-align:right;direction:rtl">  ุฌู ุณู ุงูุจุฑูุฉ </h2><br><p style=";text-align:right;direction:rtl">  ููุง ุชุนูู ุ ูุนุฏ ุญุฐู ุงูุจูุงูุงุช ูุจุงุดุฑุฉ ูู ุงููุฑุต ูููุฉ ุตุนุจุฉ ุฅูู ุญุฏ ูุง ุ ููู ุงูุฃูุธูุฉ ุงููุชูุฏูุฉ ุ ูุชุฃุฎุฑ ุงูุญุฐู ุฃู ูุง ูุชู ุนูู ุงูุฅุทูุงู.  Ceph ูู ุฃูุถูุง ูุธุงู ูุชูุฏู ุ ููู ุญุงูุฉ RGW ุ ุนูุฏ ุญุฐู ูุงุฆู s3 ุ ูุง ูุชู ุญุฐู ูุงุฆูุงุช RADOS ุงูููุงุจูุฉ ุนูู ุงูููุฑ ูู ุงููุฑุต.  ุชุญุฏุฏ RGW ูุงุฆูุงุช s3 ุนูู ุฃููุง ูุญุฐููุฉ ุ ููููู ุฏูู gc- ูููุตู ุจุญุฐู ุงููุงุฆูุงุช ูุจุงุดุฑุฉ ูู ุชุฌูุนุงุช RADOS ุ ูุจุงูุชุงูู ูุชู ุชุฃุฌูููุง ูู ุงูุฃูุฑุงุต.  ุจุนุฏ ุงูุชุญุฏูุซ ุฅูู Luminous ุ ุชุบูุฑ ุณููู gc ุจุดูู ููุญูุธ ุ ูุจุฏุฃ ูู ุงูุนูู ุจุดูู ุฃูุซุฑ ููุฉ ุ ุนูู ุงูุฑุบู ูู ุฃู ูุนููุงุช gc ุธูุช ููุง ูู.  ุจุงููููุฉ ุจุดูู ููุญูุธ ุ ุฃุนูู ุฃููุง ุจุฏุฃูุง ูุฑู gc ุชุนูู ุนูู ุงููุฑุงูุจุฉ ุงูุฎุงุฑุฌูุฉ ููุฎุฏูุฉ ูู ุฃุฌู ุงูููุฒ ุนู ุงููููู.  ุชุฑุงูู ุฐูู ูุน ุงุฑุชูุงุน IO ูู ุชุฌูุน rgw.gc.  ููู ุงููุดููุฉ ุงูุชู ููุงุฌููุง ูู ููุญููุฉ ุฃูุซุฑ ุจูุซูุฑ ูู IO ููุท.  ุนูุฏ ุชุดุบูู gc ุ ูุชู ุฅูุดุงุก ุงููุซูุฑ ูู ุณุฌูุงุช ุงููููุฐุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="html hljs xml">0 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cls</span></span></span><span class="hljs-tag">&gt;</span></span> /builddir/build/BUILD/ceph-12.2.5/src/cls/rgw/cls_rgw.cc:3284: gc_iterate_entries end_key=1_01530264199.726582828</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุญูุซ 0 ูู ุงูุจุฏุงูุฉ ูู ูุณุชูู ุงูุชุณุฌูู ุงูุฐู ุชุชู ุทุจุงุนุฉ ูุฐู ุงูุฑุณุงูุฉ ุนูุฏู.  ููุง ูุงู ุ ูุง ููุฌุฏ ููุงู ูุฎูุถ ูุทุน ุงูุฃุดุฌุงุฑ ุชุญุช ุงูุตูุฑ.  ููุชูุฌุฉ ูุฐูู ุ ุชู ุฅูุดุงุก ~ 1 ุบูุบุงุจุงูุช ูู ุงูุณุฌูุงุช ูููุง ุจูุงุณุทุฉ OSD ูุงุญุฏ ูู ุบุถูู ุณุงุนุชูู ุ ููุงู ูู ุดูุก ุนูู ูุง ูุฑุงู ุฅุฐุง ูู ุชูู ุนูุฏ ceph ุจุฏูู ูุฑุต ... ูููู ุจุชุญููู ูุธุงู ุงูุชุดุบูู ุนุจุฑ PXE ูุจุงุดุฑุฉ ูู ุงูุฐุงูุฑุฉ ููุง ูุณุชุฎุฏู ุงููุฑุต ุงููุญูู ุฃู NFS ุ NBD ููุณู ุงููุธุงู (/).  ุงุชุถุญ ุฎูุงุฏู ุนุฏููุฉ ุงูุฌูุณูุฉ.  ุจุนุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู ุ ูุชู ุชุฏููุฑ ุงูุฏููุฉ ุจุฃููููุง ุนู ุทุฑูู ุงูุฃุชูุชุฉ.  ููู ูุนูู ุ ุณุฃุตู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ูู ููุงู ูููุตู ุ ูุงูุขู ูู ุงูููู ุฃู ูุชู ุชุฎุตูุต 6 ุบูุบุงุจุงูุช ูู ุงูุฐุงูุฑุฉ ูู "/" ุ ูููุง ~ 4 ูุฌุงููุง.  ูุฑุณู ุฌููุน ุงูุณุฌูุงุช ุฅูู Graylog ููุณุชุฎุฏู ุณูุงุณุฉ ุชุฏููุฑ ุงูุณุฌู ุงูุนุฏูุงููุฉ ููุนูุง ูุง ููุง ููุงุฌู ุนุงุฏุฉู ุฃู ูุดุงูู ูู ุชุฌุงูุฒ ุณุนุฉ ุงููุฑุต / ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู.  ูููููุง ูู ููู ูุณุชุนุฏูู ููุฐุง ุ ูุน 12 OSDs ุ ุชูุช ุชุนุจุฆุฉ ุงูุฎุงุฏู "/" ุจุณุฑุนุฉ ูุจูุฑุฉ ุ ููู ูุณุชุฌุจ ุงูุญุงุถุฑูู ูู ุงูููุช ุงููุญุฏุฏ ุฅูู ุงูุฒูุงุฏ ูู Zabbix ู OSD ุจุฏุฃูุง ูู ุงูุชููู ุจุณุจุจ ุนุฏู ุงููุฏุฑุฉ ุนูู ูุชุงุจุฉ ุณุฌู.  ููุชูุฌุฉ ูุฐูู ุ ููููุง ูู ูุซุงูุฉ gc ุ ููู ุชุจุฏุฃ ุงูุชุฐูุฑุฉ ุจุณุจุจ  ูุงู ููุฌูุฏูุง ุจุงููุนู ุ ูุฃุถููุง ูุตูุง ุจุฑูุฌููุง ุฅูู cron ุ ุญูุซ ูุฌุจุฑ ุณุฌูุงุช OSD ุนูู ุงูุงูุชุทุงุน ุนูุฏ ุชุฌุงูุฒ ูููุฉ ูุนููุฉ ุฏูู ุงูุชุธุงุฑ ุชุณุฌูู ุงูุฏุฎูู.  ุจุงูููุงุณุจุฉ ุ ุชู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฒูุงุฏุฉ</a> ูุณุชูู ูุทุน ุงูุฃุดุฌุงุฑ. </p><br><h2 id="placement-groups-i-hvalyonaya-masshtabiruemost" style=";text-align:right;direction:rtl">  ูุฌููุนุงุช ุงูุชูุณูุจ ููุงุจููุฉ ุงูุชูุณุน ุงูุซูุงุก </h2><br><p style=";text-align:right;direction:rtl">  ูู ุฑุฃูู ุ PG ูู ุงูุชุฌุฑูุฏ ุงูุฃุตุนุจ ููููู.  PG ูุทููุจ ูุฌุนู CRUSH ุฃูุซุฑ ูุนุงููุฉ.  ุงูุบุฑุถ ุงูุฑุฆูุณู ูู PG ูู ุชุฌููุน ุงููุงุฆูุงุช ูุชูููู ุงุณุชููุงู ุงูููุงุฑุฏ ูุฒูุงุฏุฉ ุงูุฅูุชุงุฌูุฉ ููุงุจููุฉ ุงูุชูุณุน.  ุฅู ูุนุงูุฌุฉ ุงูุฃุดูุงุก ูุจุงุดุฑุฉ ุ ุจุดูู ูุฑุฏู ุ ุฏูู ุฏูุฌูุง ูู PG ุณูููู ูููููุง ููุบุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงููุดููุฉ ุงูุฑุฆูุณูุฉ ูู PG ูู ุชุญุฏูุฏ ุนุฏุฏูู ูุชุฌูุน ุฌุฏูุฏ.  ูู ูุฏููุฉ Ceph: </p><br><blockquote style=";text-align:right;direction:rtl">  "ุฅู ุงุฎุชูุงุฑ ุงูุนุฏุฏ ุงูุตุญูุญ ูู PGs ูููุชูุฉ ุงูุฎุงุตุฉ ุจู ูู ููุน ูู ุงููู ุงูุฃุณูุฏ - ููุงุจูุณ ูุงุจููุฉ ููุงุณุชุฎุฏุงู." </blockquote><p style=";text-align:right;direction:rtl">  ูุฐุง ุฏุงุฆููุง ูุง ูููู ุฎุงุตูุง ุฌุฏูุง ุจุชุซุจูุช ูุนูู ููุชุทูุจ ุงููุซูุฑ ูู ุงูุชูููุฑ ูุงูุญุณุงุจ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุชูุตูุงุช ุงูุฑุฆูุณูุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุซูุฑ ูู PGs ุนูู OSD ุณูุฆุฉ ุ ุณูููู ููุงู ุฒูุงุฏุฉ ูู ุงูุฅููุงู ุนูู ุงูููุงุฑุฏ ูุตูุงูุชูุง ูุงููุฑุงูู ุฃุซูุงุก ุฅุนุงุฏุฉ ุงูุชูุงุฒู / ุงูุงุณุชุฑุฏุงุฏ. </li><li style=";text-align:right;direction:rtl">  ูููู ูู PGs ุนูู OSD ุณูุฆ ุ ูุณูุนุงูู ุงูุฃุฏุงุก ุ ูุณูุชู ููุก OSDs ุจุดูู ุบูุฑ ูุชุณุงูู. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูููู ุงูุฑูู PG ูุถุงุนููุง ูุฏุฑุฌุฉ 2. ุณูุณุงุนุฏ ุฐูู ูู ุงูุญุตูู ุนูู "ููุฉ CRUSH". </li></ul><br><p style=";text-align:right;direction:rtl">  ูููุง ูุญุชุฑู ูุนู.  PGs ููุณุช ูุญุฏูุฏุฉ ูู ุงูุญุฌู ุฃู ูู ุนุฏุฏ ุงููุงุฆูุงุช.  ูู ุนุฏุฏ ุงูููุงุฑุฏ (ุจุงูุฃุฑูุงู ุงูุญููููุฉ) ุงููุงุฒูุฉ ูุฎุฏูุฉ PG ูุงุญุฏุ  ูู ุชุนุชูุฏ ุนูู ุญุฌููุงุ  ูู ูุนุชูุฏ ุนูู ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ููุฐุง PGุ  ูู ูุฌุจ ุฃู ุขุฎุฐ ุญูุงููุง ุจุฎุงุฑููุง ุฅุฐุง ูุงูุช ูุฏู ุฐุงูุฑุฉ ูุงููุฉ ููุญุฏุงุช ูุนุงูุฌุฉ ูุฑูุฒูุฉ ุณุฑูุนุฉ ูุดุจูุฉ ุฌูุฏุฉุ <br>  ูุชุญุชุงุฌ ุฃูุถูุง ุฅูู ุงูุชูููุฑ ูู ุงูููู ุงููุณุชูุจูู ูููุฌููุนุฉ.  ูุง ูููู ุชูููู ุฑูู PG - ููุท ุฒูุงุฏุฉ.  ูู ุงูููุช ููุณู ุ ูุง ููุตู ุจุงูููุงู ุจุฐูู ุ ุญูุซ ุณูุคุฏู ุฐูู ุ ูู ุฌููุฑู ุ ุฅูู ุชูุณูู ุฌุฒุก ูู PG ุฅูู ุฅุนุงุฏุฉ ุจูุงุก ุฌุฏูุฏุฉ ูุจุฑูุฉ. </p><br><blockquote style=";text-align:right;direction:rtl">  "ุชุนุฏ ุฒูุงุฏุฉ ุนุฏุฏ PG ุงูุฎุงุต ุจูุฌููุนุฉ ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงูุฃุญุฏุงุซ ุชุฃุซูุฑูุง ูู ูุฌููุนุฉ Ceph ุ ููุฌุจ ุชุฌูุจูุง ูู ูุฌููุนุงุช ุงูุฅูุชุงุฌ ุฅู ุฃููู." </blockquote><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุนููู ุงูุชูููุฑ ูู ุงููุณุชูุจู ุนูู ุงูููุฑ ุ ุฅู ุฃููู. </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู ุญูููู. </p><br><p style=";text-align:right;direction:rtl">  ูุฌููุนุฉ ูู 3 ุฎูุงุฏู ูุน 14 ร 2 ุชูุฑุงุจุงูุช OSD ููู ูููุง ุ ูุง ูุฌููุนู 42 OSDs.  ุงููุณุฎุฉ 3 ุ ููุงู ูููุฏ ~ 28 ุชูุฑุงุจุงูุช.  ูุงุณุชุฎุฏุงููุง ุชุญุช S3 ุ ุชุญุชุงุฌ ุฅูู ุญุณุงุจ ุนุฏุฏ PGs ูุชุฌูุน ุงูุจูุงูุงุช ูุชุฌูุน ุงูููุฑุณ.  ุชุณุชุฎุฏู RGW ุชุฌูุนุงุช ุฃูุซุฑ ุ ูููู ุงูุงุซููู ุฃุณุงุณูุงู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูุจ ุฅูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญุงุณุจุฉ PG</a> (ููุงู ูุซู ูุฐู ุงูุญุงุณุจุฉ) ุ ูููุธุฑ ูู 100 PG ุงูููุตู ุจูุง ุนูู OSD ุ ูุญุตู ุนูู 1312 PG ููุท.  ูููู ููุณ ูู ุดูุก ุจุณูุทูุง ุฌุฏูุง: ูุฏููุง ูุฌููุนุฉ ุชูููุฏูุฉ - ุณุชููู ุงููุชูุฉ ุจุงูุชุฃููุฏ ุซูุงุซ ูุฑุงุช ูู ุบุถูู ุนุงู ุ ูููู ุณูุชู ุดุฑุงุก ุงูุญุฏูุฏ ุจุนุฏ ุฐูู ุจูููู.  ูููู ุจุฒูุงุฏุฉ "ุงููุฏู PGs ููู OSD" ุซูุงุซ ูุฑุงุช ุ ุฅูู 300 ููุญุตู ุนูู 4480 PG. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ce/o3/bo/ceo3boailgnmcx_2_w6un6_covi.png"></p><br><p style=";text-align:right;direction:rtl">  ูู ุจุชุนููู ุนุฏุฏ PGs ููุชุฌูุนุงุช ุงูููุงุจูุฉ - ูุญุตู ุนูู ุชุญุฐูุฑ: ูุตู ุนุฏุฏ ูุจูุฑ ุฌุฏูุง ูู PG ููู OSD ...  ุชู ุงูุงุณุชูุงู ~ 300 PG ุนูู OSD ุจุญุฏ 200 (ูุถูุก).  ุจุงูููุงุณุจุฉ ูุงู 300.  ูุงูุดูุก ุงูุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู ูู ุฃูู ูุง ููุณูุญ ูุฌููุน PGs ุบูุฑ ุงูุถุฑูุฑูุฉ ุจุงูุชูุธูุฑ ุ ููุฐุง ููุณ ูุฌุฑุฏ ุชุญุฐูุฑ.  ูุชูุฌุฉ ูุฐูู ุ ูุนุชูุฏ ุฃููุง ููุนู ูู ุดูุก ุจุดูู ุตุญูุญ ุ ูุฑูุน ุงูุญุฏูุฏ ุ ูุฅููุงู ุงูุชุญุฐูุฑ ุ ูุงููุถู ูุฏูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุซุงู ุญูููู ุขุฎุฑ ูู ุฃูุซุฑ ุฅุซุงุฑุฉ ููุงูุชูุงู. </p><br><p style=";text-align:right;direction:rtl">  S3 ุ ุญุฌู ูุงุจู ููุงุณุชุฎุฏุงู ูู 152 ุชูุฑุงุจุงูุช ุ 252 OSD ุนูุฏ 1.81 ุชูุฑุงุจุงูุช ุ ~ 105 PG ุนูู OSD.  ููุช ุงููุฌููุนุฉ ุชุฏุฑูุฌููุง ุ ููุงู ูู ุดูุก ุนูู ูุง ูุฑุงู ุญุชู ูุน ูุฌูุฏ ุงูููุงููู ุงูุฌุฏูุฏุฉ ูู ุจูุฏูุง ุ ูุงูุช ููุงู ุญุงุฌุฉ ููููู ุฅูู 1 ุจูุชุงุจุงูุช ุ ุฃู ~ 850 ุชูุฑุงุจุงูุช ุ ููู ุงูููุช ููุณู ุชุญุชุงุฌ ุฅูู ุงูุญูุงุธ ุนูู ุงูุฃุฏุงุก ุ ููู ุงูุขู ุฌูุฏ ุฌุฏูุง ูู S3.  ูููุชุฑุถ ุฃููุง ุฃุฎุฐูุง ุฃูุฑุงุตูุง ุณุนุฉ 6 ุชูุฑุงุจุงูุช (5.7 ุฑูุงู) ูุน ูุฑุงุนุงุฉ ุงููุณุฎุฉ ุงููุชูุงุซูุฉ 3 ูุญุตู ุนูู + 447 OSD.  ูุน ุงูุฃุฎุฐ ุจุนูู ุงูุงุนุชุจุงุฑ ุงูุญุงููุฉ ุ ูุญุตู ุนูู 699 OSDs ูุน 37 PGs ููู ูููุง ุ ูุฅุฐุง ุฃุฎุฐูุง ูู ุงูุงุนุชุจุงุฑ ุงูุฃูุฒุงู ุงููุฎุชููุฉ ุ ููุฏ ุงุชุถุญ ุฃู OSDs ุงููุฏููุฉ ูุฏููุง ููุท ุงุซูู ุนุดุฑ PGs.  ูู ุชุฎุจุฑูู ููู ุณูุนูู ูุฐุง ุจุดูู ููุจููุ  ูู ุงูุตุนุจ ุฌุฏูุง ููุงุณ ุฃุฏุงุก ูุฌููุนุฉ ุชุญุชูู ุนูู ุนุฏุฏ ูุฎุชูู ูู PGs ุตูุงุนููุง ุ ูููู ุงูุงุฎุชุจุงุฑุงุช ุงูุชู ุฃุฌุฑูุชูุง ุชุธูุฑ ุฃูู ููุญุตูู ุนูู ุงูุฃุฏุงุก ุงูุฃูุซู ุ ูู ุงูุถุฑูุฑู ุฃู ูููู ูู 50 PG ุฅูู 2 ุชูุฑุงุจุงูุช OSD.  ููุงุฐุง ุนู ูุฒูุฏ ูู ุงููููุ  ุจุฏูู ุฒูุงุฏุฉ ุนุฏุฏ PG ุ ููููู ุงูุงูุชูุงู ุฅูู ุชุนููู PG ุฅูู OSD 1: 1.  ุฑุจูุง ูุง ุฃููู ุดูุฆูุงุ </p><br><p style=";text-align:right;direction:rtl">  ูุนู ุ ููููู ุฅูุดุงุก ุชุฌูุน ุฌุฏูุฏ ูู RGW ูุน ุงูุนุฏุฏ ุงููุทููุจ ูู PGs ูุชุนููู ููุทูุฉ S3 ูููุตูุฉ ููุง.  ุฃู ุญุชู ุจูุงุก ุชุฌูุน ุฌุฏูุฏ ูุฑูุจ.  ูููู ูุฌุจ ุฃู ุชุนุชุฑู ุจุฃู ูุฐู ูููุง ุนูุงุฒุงุช.  ูุชุจูู ุฃูู ูุจุฏู ููุฃูู Ceph ูุงุจู ููุชุทููุฑ ุจุดูู ุฌูุฏ ูุธุฑูุง ููููููู ุ ูุชุฏุฑุฌ PG ูุน ุงูุชุญูุธุงุช.  ุณูููู ุนููู ุฅูุง ุงูุนูุด ูุน vorings ูุนุทู ุงุณุชุนุฏุงุฏูุง ููููู ุ ุฃู ูู ูุฑุญูุฉ ูุง ุฅุนุงุฏุฉ ุจูุงุก ุฌููุน ุงูุจูุงูุงุช ูู ุงููุฌููุนุฉ ุ ุฃู ุชุณุฌูู ููุงุท ูู ุงูุฃุฏุงุก ูุงูุนูุด ูุน ูุง ูุญุฏุซ.  ุฃู ุฎุฐูุง ูููุง. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุง ุณุนูุฏ ูุฃู ูุทูุฑู Ceph <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูููููู</a> ุฃู PG ุนุจุงุฑุฉ ุนู ุชุฌุฑูุฏ ูุนูุฏ ูุบูุฑ ุถุฑูุฑู ูููุณุชุฎุฏู ููู ุงูุฃูุถู ุนุฏู ูุนุฑูุชู ุจุฐูู. </p><br><blockquote style=";text-align:right;direction:rtl">  "ูู Luminous ุ ุงุชุฎุฐูุง ุฎุทูุงุช ุฑุฆูุณูุฉ ูููุถุงุก ููุงุฆููุง ุนูู ูุงุญุฏุฉ ูู ุฃูุซุฑ ุงูุทุฑู ุดููุนูุง ูุฏูุน ูุฌููุนุชู ุฅูู ุงูุฎูุฏู ุ ููุชุทูุน ุฅูู ุงููุณุชูุจู ุ ููุฏู ูู ุงูููุงูุฉ ุฅูู ุฅุฎูุงุก PGs ุชูุงููุง ุญุชู ูุง ุชููู ุดูุฆูุง ูุฌุจ ุนูู ูุนุธู ุงููุณุชุฎุฏููู ูุนุฑูุชู ุฃู ููุฑ ูู ". </blockquote><p style=";text-align:right;direction:rtl">  ูู vxFlex ูุง ููุฌุฏ ููููู PG ุฃู ุฃู ูุธุงุฆุฑูุง.  ูุง ุนููู ุณูู ุฅุถุงูุฉ ุฃูุฑุงุต ุฅูู ุงูุชุฌูุน ููุฐุง ูู ูุง ูู ุงูุฃูุฑ.  ูููุฐุง ุชุตู ุฅูู 16 PB.  ุชุฎูู ุ ูุง ุดูุก ูุญุชุงุฌ ุฅูู ุญุณุงุจ ุ ูุง ุชูุฌุฏ ุฃููุงู ูู ุญุงูุงุช ูุฐู PGs ุ ูุชู ุงูุชุฎูุต ูู ุงูุฃูุฑุงุต ุจุดูู ููุญุฏ ุทูุงู ูุชุฑุฉ ุงูููู.  ูุฃู  ูุชู ุฅุนุทุงุก ุงูุฃูุฑุงุต ุฅูู vxFlex ููู (ูุง ููุฌุฏ ูุธุงู ูููุงุช ููููุง) ููุง ุชูุฌุฏ ุทุฑููุฉ ูุชูููู ุงูุงูุชูุงุก ููุง ุชูุฌุฏ ูุซู ูุฐู ุงููุดููุฉ ุนูู ุงูุฅุทูุงู.  ุฃูุง ูุง ุฃุนุฑู ุญุชู ููู ุฃููู ููู ูู ูู ูุทูู. </p><br><h2 id="nuzhno-zhdat-sp1" style=";text-align:right;direction:rtl">  "ุจุญุงุฌุฉ ุฅูู ุงูุชุธุงุฑ SP1" </h2><br><p style=";text-align:right;direction:rtl">  ูุตุฉ ุฃุฎุฑู ุนู "ุงููุฌุงุญ".  ููุง ุชุนูู ุ ูุนุฏ RADOS ุฃูุซุฑ ูุญุฏุงุช ุชุฎุฒูู ุงููููุฉ ุงูุฑุฆูุณูุฉ ุจุฏุงุฆูุฉ.  S3 ุ ุงูุฐู ุชู ุชูููุฐู ุนูู ุฑุฃุณ RADOS ุ ูู ุฃูุถูุง ุจุฏุงุฆู ุ ููููู ูุง ูุฒุงู ุฃูุซุฑ ูุธูููุฉ. ,  S3      .  ,   , RGW       .   โ  RADOS-,      OSD.         .   ,               . OSD            down.   ,      ,   .  ,   scrub'          .      ,    -  503,      . </p><br><p style=";text-align:right;direction:rtl"> <strong>Bucket Index resharding</strong> โ  ,       (RADOS-) , ,    OSD,         . </p><br><p style=";text-align:right;direction:rtl"> ,  ,        Jewel        !  Hammer,      ..    -.       ? </p><br><p style=";text-align:right;direction:rtl">  Hammer       20+  ,       ,     OSD     Graylog ,    .     , ..   IO   .    Luminous, ..         .    Luminous,    , .   ,      . IO    index-,   ,         .    ,  IO     ,      . ,     โฆ   ; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> : </p><br><p style=";text-align:right;direction:rtl">  ,      .       , ..           ,   . </p><br><p style=";text-align:right;direction:rtl"> ,  Hammer-&gt;Jewel   -   . OSD     -  .        ,    OSD       . </p><br><p style=";text-align:right;direction:rtl">    โ   ,     ,       .   Hammer    s3,   .      ,  .       ,    ,      etag,   body,     .           .      ,     . Suspend    .   ""           .            ,        . </p><br><h2 id="holivary-na-temu-chisla-replik" style=";text-align:right;direction:rtl">      </h2><br><p style=";text-align:right;direction:rtl">       ,    2 โ  ,         Cloudmouse. ,    Ceph, , . </p><br><p style=";text-align:right;direction:rtl">  vxFlex OS   2    . ,             .       ,    .           ,         .        ,    ,    ,     Dell EMC. </p><br><h2 id="proizvoditelnost" style=";text-align:right;direction:rtl">  </h2><br><p style=";text-align:right;direction:rtl">    .       ,       ?  . ,      .   ,     Ceph, vxFlex          .       -  .        ,               . </p><br><p style=";text-align:right;direction:rtl">   9   ceph-devel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> : ,     CPU  (  Xeon'  !)   IOPS  All-NVMe   Ceph 12.2.7  bluestore. </p><br><p style=";text-align:right;direction:rtl"> ,       ,  "" Ceph    .    (  Hammer)         Ceph    ,        s3     .  ,  ScaleIO  Ceph RBD   .   Ceph,     โ      CPU.       RDMA  InfiniBand, jemalloc   . ,    10-20 ,       iops,      io, Ceph      . vxFlex          .    โ  Ceph  system time,  scaleio โ io wait. ,    bluestore,      ,    ,         -, ,     Ceph.    ScaleIO  .  ,      , Ceph           Dell EMC. </p><br><p style=";text-align:right;direction:rtl"> ,       ,         PG.        (),     IO. -   PG       IO,     ,      . ,               nearfull.       ,    . </p><br><p style=";text-align:right;direction:rtl">  vxFlex     -   ,      .       (   ceph-volume),         ,     . </p><br><h2 id="scrub" style=";text-align:right;direction:rtl"> Scrub </h2><br><p style=";text-align:right;direction:rtl"> , .  , ,      Ceph. </p><br><p style=";text-align:right;direction:rtl">             ,      . " "    โ   -    ,    . ,      2 TB     &gt;50%,       Ceph,     .            .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> ,       . </p><br><p style=";text-align:right;direction:rtl">  vxFlex OS         ,    ,     .        โ bandwidth  .            .         ,        . </p><br><p style=";text-align:right;direction:rtl"> ,  , vxFlex     scrub-error. Ceph      2   . </p><br><h2 id="monitoring" style=";text-align:right;direction:rtl">  </h2><br><p style=";text-align:right;direction:rtl"> Luminous โ     .        .    MGR-     Zabbix              (3 ).       .   ,   ,  -         IO  ,     gc, .   โ   RGW . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ys/ya/xq/ysyaxqffjukjtgkv3ecnu0_q2ro.png"></p><br><p style=";text-align:right;direction:rtl">       .     . <br>      S3,    "" : </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ax/ge/u5/axgeu5iyyjami3qszjo97akj6oc.png"></p><br><p style=";text-align:right;direction:rtl">   Ceph  , ,   ,       ,    . </p><br><p style=";text-align:right;direction:rtl">  ,   eph   Graylog   GELF    .  , ,  OSD down, out, failed  .          , ,   OSD    down  ,     . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/sd/hz/av/sdhzavl-jyjrmajz5zlsjamujzo.png"></p><br><p style=";text-align:right;direction:rtl"> - ,    OSD       heartbeat      failed (.  ).    <code>vm.zone_reclaim_mode=1</code>     NUMA. </p><br><p style=";text-align:right;direction:rtl">     Ceph.  c vxFlex   .       : </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/hu/nz/e2/hunze2e6ucygc4anzyep2wku050.png"></p><br><p style=";text-align:right;direction:rtl">     : </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/jv/fa/ey/jvfaeyd7ql3kalcrcabrckekuqg.png"></p><br><p style=";text-align:right;direction:rtl">  IO    : </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/sy/vp/lq/syvplqbfmjtek_wii033vszoq9s.png"></p><br><p style=";text-align:right;direction:rtl">              IO,      Ceph. </p><br><p style=";text-align:right;direction:rtl">    : </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/h2/8j/ff/h28jff_jzpstuucf5wfx8vrrmay.png"></p><br><p style=";text-align:right;direction:rtl">   Ceph,    Luminous     .   2.0,    Mimic  ,      . </p><br><h2 id="vxflex-tozhe-ne-idealen" style=";text-align:right;direction:rtl"> vxFlex    </h2><br><p style=";text-align:right;direction:rtl">     <strong>Degraded state</strong> ,          . </p><br><p style=";text-align:right;direction:rtl">  vxFlex โ        RH   .   7.5  , .  Ceph   RBD  cephfs โ          . </p><br><p style=";text-align:right;direction:rtl"> vxFlex       Ceph. vxFlex โ    ,   , , . </p><br><p style=";text-align:right;direction:rtl">     16 PB,     .  eph     2 PB โฆ </p><br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงูุฎูุงุตุฉ </h2><br><p style=";text-align:right;direction:rtl">  ,  Ceph       ,     ,      ,      Ceph โ .      . </p><br><p style=";text-align:right;direction:rtl">       ,  Ceph       " ".       ,  "  ,   ,     R&amp;D,  - ".    .       " ",  Ceph      ,    ,     . </p><br><p style=";text-align:right;direction:rtl">      Ceph  2k18  ,    .      24/7       ( S3, ,  EBS),             ,   Ceph    .  ,    .        โ       .         /     maintenance        backfilling  ,  c Ceph   , ,       . </p><br><p style=";text-align:right;direction:rtl">      Ceph    ?  , "     ".      Ceph.    .      ,         ,   ,  ,    โฆ <br>    ! <br>  HEALTH_OK! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar422905/">https://habr.com/ru/post/ar422905/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar422895/index.html">ุชุฑูุฏ Google ูุชู ุนูุงููู URL</a></li>
<li><a href="../ar422897/index.html">ุณูุก ุ ููู ุฎุงุตุชู: ููููุฉ ูุชุงุจุฉ CSS ูุธูุนุฉ ุญููุง</a></li>
<li><a href="../ar422899/index.html">ุชุญุช ุฅุดุฑุงู ููุธ: ููููุฉ ูุฑุงูุจุฉ ุชุนุฑููุงุช ุงููุถูู ูุงูุญูุงุธ ุนูู ูุชุงููุฌ VPS ูุญุฏุซูุง</a></li>
<li><a href="../ar422901/index.html">ุฌูุงุฒ ุฑุตุฏ ูุนุฏู ุถุฑุจุงุช ุงูููุจ ูุจูุชูู ุ ุฃู ูุง ูู Ritmer</a></li>
<li><a href="../ar422903/index.html">ููู ูููุงุฐุง ูุชุจูุง ุฎุฏูุฉ ูุงุจูุฉ ููุชุทููุฑ ูุญููุฉ ููุบุงูุฉ ูู 1C: Enterprise: Java ู PostgreSQL ู Hazelcast</a></li>
<li><a href="../ar422907/index.html">2018 ุฑูุจูุช ุงููููุณุฉ ุงูููุฑุจุงุฆูุฉ ูุฑุฌุน ุณุฑูุน</a></li>
<li><a href="../ar422909/index.html">10 ุฃุดูุฑ 404 ููุงุทุน ููุฏูู ุงูุญุฏูุซ ูู ููุฑุฌุงู ุงูุฑุฌุนูุฉ</a></li>
<li><a href="../ar422915/index.html">ุฃูุง ุฃุจุญุซ ุนู ููุธู ูุจูุฑ ุจุฏูู ููุชุจ ููููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท: ููู ูููุง ุจุชูุธูู ุนูููุฉ ุจุญุซ ุนู ุงูููุธููู ุงูุจุนูุฏูู ุจูุณุจุฉ 100ูช</a></li>
<li><a href="../ar422917/index.html">ููุณ ูุฏู ูู ุ ูููู ูุง ุจุฏ ูู ูู ุงูุตุฑุงุฎ. ุชุฃููุงุช ูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุงูุฃุฎูุงู</a></li>
<li><a href="../ar422919/index.html">ุงูุฏุฑุงุฌุฉ SIPs ูุงููุญุงุฏุซุฉ ุงููุงุชููุฉ ุงูุณุญุงุจูุฉ ูุน ุจุนุถูุง ุงูุจุนุถ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>