<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë™ üíà ü•ñ Profundidades do SIEM: correla√ß√µes prontas para uso. Parte 3.1. Categoriza√ß√£o de eventos üì´ üí∞ üåè</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="√â poss√≠vel categorizar todos os eventos que chegam ao SIEM e qual sistema de categoriza√ß√£o usar para isso? Como aplicar categorias em regras de correl...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Profundidades do SIEM: correla√ß√µes prontas para uso. Parte 3.1. Categoriza√ß√£o de eventos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/432352/">  √â poss√≠vel categorizar todos os eventos que chegam ao SIEM e qual sistema de categoriza√ß√£o usar para isso?  Como aplicar categorias em regras de correla√ß√£o e pesquisa de eventos?  Analisaremos essas e outras quest√µes em um novo artigo do ciclo dedicado √† metodologia para criar regras de correla√ß√£o prontas para uso em sistemas SIEM. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wp/ok/om/wpokomy1rlw1e495pzqk6uujan4.png" alt="Categoriza√ß√£o de eventos"></div><br>  <i>Imagem: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Worktrooper</a></i> <br><a name="habracut"></a><br>  Este artigo foi co-escrito com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mikhail Maximov</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Alexander Kovtun</a> . <br><br>  Avisamos: o artigo √© amplo, pois descreve a constru√ß√£o do sistema de categoriza√ß√£o e nossas cadeias de racioc√≠nio.  Se voc√™ estiver com pregui√ßa de l√™-lo na √≠ntegra, poder√° imediatamente ir para a se√ß√£o com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conclus√µes</a> - resumimos tudo o que foi discutido no artigo e resumimos os resultados. <br><br>  Em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo anterior,</a> descobrimos que os eventos cont√™m muitas informa√ß√µes importantes que n√£o podem ser perdidas no processo de normaliza√ß√£o.  A descri√ß√£o do esquema de intera√ß√£o refere-se a esse tipo de dados.  Para sistematizar os tipos de intera√ß√£o, fizemos o seguinte: <br><br><ul><li>  identificou os principais esquemas inerentes a qualquer tipo de evento; </li><li>  determinou quais entidades est√£o envolvidas nos esquemas; </li><li>  formou o conjunto b√°sico de campos necess√°rios para descrever todas as entidades encontradas no evento inicial e o canal de intera√ß√µes entre elas. </li></ul><br>  Como resultado da an√°lise de logs de v√°rios tipos de software e hardware, conseguimos distinguir as entidades: Assunto, Objeto de intera√ß√£o, Origem e Transmissor. <br><br>  Agora vamos falar sobre a sem√¢ntica da intera√ß√£o dessas entidades e seu reflexo na categoriza√ß√£o de eventos.  Antes de descrever a abordagem da forma√ß√£o e das categorias, √© necess√°rio responder a duas perguntas: por que √© necess√°rio determinar as categorias de eventos e quais propriedades um sistema de cateterismo deve ter. <br><br>  Primeiro, vamos determinar por que os eventos devem ser categorizados.  Em resumo: a categoriza√ß√£o √© necess√°ria para funcionar igualmente bem com eventos semanticamente semelhantes, independentemente do tipo de fonte.  N√≥s nos referimos aos tipos de fontes, o principal objetivo da fonte: equipamentos de rede, sistemas operacionais, software aplicativo.  A frase ‚Äútrabalhe da mesma maneira com eventos semanticamente semelhantes‚Äù deve ser entendida da seguinte maneira: <br><br><ol><li>  Eventos sem√¢ntica semelhantes de qualquer tipo de fonte t√™m uma categoria comum. </li><li> Para eventos de cada categoria, s√£o definidas regras claras para o preenchimento dos campos do esquema.  Portanto, combatemos efetivamente o caos que ocorre no est√°gio de normaliza√ß√£o dos eventos e geralmente leva a v√°rios falsos positivos das regras de correla√ß√£o. </li><li>  O tratamento de categorias permite evitar verifica√ß√µes desnecess√°rias no c√≥digo das regras de correla√ß√£o para entender a sem√¢ntica do evento.  Por exemplo, n√£o h√° necessidade de verificar a disponibilidade de dados em determinados campos para determinar se o evento descreve a entrada do usu√°rio, e n√£o o backup do sistema. </li><li>  A categoriza√ß√£o √© uma base terminol√≥gica geral que ajuda a escrever as regras de correla√ß√£o e investiga√ß√£o de incidentes, para operar com um √∫nico conjunto de termos e seus significados geralmente aceitos.  Por exemplo, para entender claramente que alterar a configura√ß√£o da rede e alterar a configura√ß√£o do software s√£o tipos completamente diferentes de eventos com significados completamente diferentes. </li></ol><br>  Para obter tudo isso, voc√™ precisa criar um sistema para categorizar eventos e us√°-lo ao escrever regras de correla√ß√£o, investigar incidentes e nos casos em que mais de uma pessoa trabalha em uma organiza√ß√£o com um sistema SIEM. <br><a name="Requirements"></a><br>  Quanto aos requisitos para o sistema de categoriza√ß√£o, ele deve satisfazer quatro propriedades: <br><br><ol><li>  <b>Unambiguity</b> .  Um e o mesmo evento deve ser atribu√≠do a uma e apenas uma categoria. </li><li>  <b>Compacidade</b> .  O n√∫mero total de categorias deve ser tal que elas possam ser facilmente lembradas por um especialista. </li><li>  <b>Hierarquia</b> .  O sistema deve ser constru√≠do em um esquema hier√°rquico e consistir em v√°rios n√≠veis, j√° que essa √© a estrutura mais simples de se lembrar.  Al√©m disso, a hierarquia deve ser constru√≠da com base no princ√≠pio de ‚Äúde geral para particular‚Äù: no primeiro n√≠vel, existem mais categorias ‚Äúgerais‚Äù e, por √∫ltimo, categorias altamente especializadas. </li><li>  <b>Extensibilidade</b> .  Os princ√≠pios pelos quais ele √© constru√≠do devem permitir fazer atualiza√ß√µes no sistema de categoriza√ß√£o quando novos tipos de eventos aparecerem que exijam categorias separadas, sem alterar a abordagem principal. </li></ol><br>  Vamos passar √† descri√ß√£o do sistema de categoriza√ß√£o: come√ßaremos com dois grandes dom√≠nios, que incluem fontes de eventos conectadas ao SIEM e nas quais elas geram eventos. <br><br><a name="MainDomains"></a><h1>  Dom√≠nios de Origem e Evento </h1><br>  A implanta√ß√£o do SIEM geralmente come√ßa conectando fontes que geram eventos diferentes.  Uma propriedade importante desses eventos √© que eles refletem a funcionalidade das pr√≥prias fontes. <br><br>  Dois dom√≠nios globais podem ser distinguidos: <br><br><ol><li>  Fontes de TI - software e hardware de aplicativos em todo o sistema que gera eventos de TI. </li><li>  Fontes IB - software e hardware especializados para a seguran√ßa das informa√ß√µes da empresa que geram eventos de IB. </li></ol><br>  Considere as diferen√ßas fundamentais entre os eventos desses dom√≠nios. <br><br>  As fontes de TI relatam a ocorr√™ncia de qualquer fen√¥meno no sistema automatizado, sem a avalia√ß√£o do n√≠vel de seguran√ßa - "bom" ou "ruim".  Exemplos: aplicar uma nova configura√ß√£o por um dispositivo, fazer backup de dados, transferir um arquivo por uma rede, desativar uma porta de rede em um switch. <br><br>  Ao contr√°rio das fontes de TI, as fontes de SI t√™m conhecimento externo adicional sobre como interpretar certos eventos do ponto de vista da seguran√ßa - pol√≠tica.  Assim, o uso de pol√≠ticas permite que fontes de seguran√ßa da informa√ß√£o tomem decis√µes - se o fen√¥meno observado √© "bom" ou "ruim" - e reporte-o ao SIEM atrav√©s dos eventos de seguran√ßa da informa√ß√£o gerados. <br><br>  Considere o exemplo a seguir: Portanto, em geral, um firewall de n√≠vel de pr√≥xima gera√ß√£o considera um evento de transfer√™ncia de arquivos pela rede "ruim": acontece que o arquivo √© um documento do Word que √© transferido da rede interna da empresa para um servidor externo via FTP, e a pol√≠tica configurada pro√≠be tal intera√ß√µes informacionais.  A desativa√ß√£o da porta de rede √© interpretada como uma viola√ß√£o dos direitos de acesso pela decis√£o de controlar as a√ß√µes dos administradores: uma vez que a desconex√£o da porta √© feita pelo usu√°rio Alex, que n√£o possui direitos a isso, ocorre durante o hor√°rio posterior, de acordo com a pol√≠tica de seguran√ßa configurada. <br><br>  No entanto, n√£o √© totalmente verdade que as fontes de seguran√ßa da informa√ß√£o geram apenas eventos de seguran√ßa da informa√ß√£o.  As fontes de IB geram eventos de IB e de TI.  As fontes de IS geram eventos de TI, como regra, quando relatam uma altera√ß√£o em seu estado: altera√ß√µes na configura√ß√£o, comuta√ß√£o de n√≥s de cluster e backups.  Em geral, esses eventos podem ser atribu√≠dos √† auditoria interna de a√ß√µes e ao estado da fonte.  Ao mesmo tempo, quando a atividade diz respeito √† aplica√ß√£o de pol√≠ticas de seguran√ßa, a mesma fonte j√° gera eventos de seguran√ßa da informa√ß√£o, relatando os resultados de sua aplica√ß√£o. <br><br>  Descrevemos deliberadamente as diferen√ßas entre os dois dom√≠nios em tais detalhes.  Os eventos de cada dom√≠nio t√™m seu pr√≥prio significado e, √†s vezes, podem diferir fundamentalmente um do outro.  Essas diferen√ßas levaram √† exist√™ncia de dois sistemas separados de categoriza√ß√£o de eventos respons√°veis ‚Äã‚Äãpor eventos de TI e eventos de seguran√ßa da informa√ß√£o. <br><br><img src="https://habrastorage.org/webt/lh/q6/2j/lhq62jphooh6zal7eks_kohztki.png" alt="Categoriza√ß√£o de eventos.  Dom√≠nios de Eventos."><br>  <i>Dom√≠nios de eventos</i> <br><br>  H√° mais um tipo raro de fontes que geram eventos de um terceiro dom√≠nio separado - o dom√≠nio dos ataques.  Os eventos desse dom√≠nio podem ser recebidos de fontes do n√≠vel de prote√ß√£o de endpoint (Endpoint Protection), outros SIEMs subordinados (se eles estiverem organizados em uma hierarquia) ou de outras solu√ß√µes capazes de determinar, com base na an√°lise de TI e (ou) eventos de seguran√ßa da informa√ß√£o, que um sistema automatizado ou parte dele est√° sujeito a ataques de hackers. <br><br>  Como parte desta s√©rie de artigos, usaremos os seguintes conceitos ao separar ataques e eventos de seguran√ßa da informa√ß√£o dos meios de defesa de ponta a ponta: <br><br><ol><li>  Um ataque √© uma sequ√™ncia maliciosa de a√ß√µes de um invasor que visa atingir uma meta espec√≠fica dentro de uma empresa. </li><li>  Um ataque pode consistir em um ou mais eventos - uma cadeia de eventos de seguran√ßa da informa√ß√£o e / ou eventos de TI que s√£o viola√ß√µes das pol√≠ticas de seguran√ßa da informa√ß√£o. </li></ol><br>  Existem v√°rias abordagens para categorizar ataques, por exemplo, a crescente popularidade das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">t√°ticas, t√©cnicas e conhecimentos comuns</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MITRE</a> , mas n√£o consideraremos esse dom√≠nio em nossos artigos. <br><br><a name="ITCategorization"></a><h1>  Sistema de Categoriza√ß√£o de Eventos de TI </h1><br>  O software e o hardware de aplicativos em todo o sistema, que atribu√≠mos √†s fontes de eventos de TI, foram projetados para implementar ou dar suporte a determinados processos para cumprir suas tarefas.  No decurso de sua decis√£o, os fatos confirmados s√£o registrados por eventos de TI separados.  Eles podem ser atribu√≠dos ao processo em que cada um deles ocorreu. <br><br>  Isolando os processos que ocorrem nas fontes de TI, podemos formar o primeiro n√≠vel de categoriza√ß√£o (que chamaremos mais tarde de contexto).  Ele definir√° um campo sem√¢ntico que interpretar√° corretamente os eventos de TI. <br><br>  Ao analisar eventos, fica claro que cada um deles descreve a intera√ß√£o de v√°rias entidades na estrutura de um processo j√° definido.  Selecionando como a principal dessas entidades como um objeto de intera√ß√£o, formamos o segundo n√≠vel de categoriza√ß√£o. <br><br>  O comportamento da entidade principal no evento dentro da estrutura de um processo espec√≠fico desempenhar√° o papel do terceiro n√≠vel de categoriza√ß√£o dos eventos de TI. <br>  Total, na sa√≠da, obtivemos os seguintes n√≠veis: <br><br><ol><li>  O contexto (processo) no qual o evento ocorreu. </li><li>  O objeto (entidade principal) descrito pelo evento. </li><li>  A natureza do comportamento do objeto dentro do contexto especificado. </li></ol><br>  Assim, formamos tr√™s n√≠veis de categoriza√ß√£o de eventos de TI, permitindo que voc√™ opere convenientemente eventos semanticamente semelhantes de v√°rios tipos de fontes na infraestrutura de TI. <br><br>  Para garantir a exclusividade do sistema de categoriza√ß√£o resultante, formaremos dom√≠nios separados para cada n√≠vel. <br><br><img src="https://habrastorage.org/webt/yj/8h/qo/yj8hqoi_fevntq2utkvczwh5g_o.png" alt="Categoriza√ß√£o de eventos de TI.  Primeiro n√≠vel"><br>  <i>Sistema de categoriza√ß√£o para eventos de TI.</i>  <i>Primeiro n√≠vel</i> <br><br>  Uma abordagem de processo semelhante ao trabalho com sistemas de TI tamb√©m √© usada no ITSM (Gerenciamento de Servi√ßos de TI, Gerenciamento de Servi√ßos de TI), que postula alguns processos b√°sicos que ocorrem nos servi√ßos de TI.  Contaremos com essa abordagem ao formar poss√≠veis processos ou, em outras palavras, contextos, ao considerar as fontes de eventos de TI. <br><br>  Destacamos os principais processos desse n√≠vel: <br><br><ul><li>  <b>Gerenciamento de Continuidade de Neg√≥cios</b> - eventos relacionados a opera√ß√µes para manter opera√ß√£o cont√≠nua de sistemas: processos de replica√ß√£o, migra√ß√£o e sincroniza√ß√£o de m√°quinas virtuais, bancos de dados e armazenamentos, opera√ß√µes de backup e restaura√ß√£o; </li><li>  <b>Gerenciamento de</b> usu√°rios e direitos ( <b>gerenciamento de</b> usu√°rios e direitos) - eventos relacionados ao trabalho com grupos e contas de usu√°rios; </li><li>  <b>Gerenciamento de Acesso</b> - eventos associados aos processos de Autentica√ß√£o, Autoriza√ß√£o, Contabilidade (AAA) e quaisquer tentativas de acesso ao sistema; </li><li>  <b>Gerenciamento de disponibilidade</b> - eventos associados a qualquer a√ß√£o para iniciar, parar, ativar, desativar, encerrar entidades, incluindo mensagens informativas dos sistemas de controle de acesso √† entidade; </li><li>  <b>Gerenciamento de implanta√ß√£o</b> (gerenciamento de eventos) - eventos associados √† introdu√ß√£o de novas entidades no sistema a partir do exterior, bem como √† remo√ß√£o da entidade desse sistema; </li><li>  <b>Gerenciamento de intera√ß√£o de rede</b> - eventos relacionados √† transmiss√£o de dados atrav√©s da rede, incluindo o estabelecimento de conex√µes, abertura e fechamento de t√∫neis; </li><li>  <b>Gerenciamento de rede</b> - eventos relacionados √† pilha de rede: incluindo quaisquer a√ß√µes com pol√≠ticas e regras para filtragem de rede; </li><li>  <b>Gerenciamento</b> de infraestrutura virtual (gerenciamento de infraestrutura virtual) - eventos relacionados √† infraestrutura de virtualiza√ß√£o; </li><li>  <b>Gerenciamento de Banco de Dados</b> - eventos relacionados ao funcionamento do SGBD e √†s a√ß√µes dos usu√°rios e processos nele; </li><li>  <b>Gerenciamento de Sistema</b> - eventos relacionados ao funcionamento do sistema operacional e software que faz parte do sistema operacional; </li><li>  <b>Gerenciamento gen√©rico de aplicativos</b> (gerenciamento de outros aplicativos) - eventos associados ao funcionamento de outros aplicativos instalados pelo usu√°rio e n√£o parte do sistema operacional. </li></ul><br>  √â importante entender que diferentes processos podem ocorrer na mesma fonte de TI.  Portanto, por exemplo, no servi√ßo DHCP implantado no Unix OS, podem ocorrer o processo de Gerenciamento de Rede (gerando, por exemplo, um evento de atualiza√ß√£o de endere√ßo IP para n√≥s) e o processo de Gerenciamento do Sistema, gerando um evento de reinicializa√ß√£o do servi√ßo ou erro de an√°lise do arquivo de configura√ß√£o. <br><br><h2>  O segundo n√≠vel de categoriza√ß√£o de eventos de TI (entidades) </h2><br><img src="https://habrastorage.org/webt/k_/rn/s6/k_rns6dddokqnddjqsdz9kjfdnk.png" alt="Sistema de categoriza√ß√£o de eventos do IB.  O primeiro e o segundo n√≠veis."><br>  <i>Sistema de categoriza√ß√£o de eventos do IB.</i>  <i>O primeiro e o segundo n√≠veis.</i> <br><br>  O segundo n√≠vel reflete o objeto de intera√ß√£o descrito no evento.  Observe que um evento pode descrever v√°rias entidades.  Por exemplo, considere o seguinte evento: "o usu√°rio enviou uma solicita√ß√£o ao servidor de certifica√ß√£o para a emiss√£o de um certificado pessoal".  Em eventos desse tipo, √© necess√°rio escolher uma entidade b√°sica como objeto de intera√ß√£o, que √© central no evento.  Aqui podemos determinar que a entidade principal √© uma "solicita√ß√£o para um servidor de certifica√ß√£o", pois o usu√°rio √© obviamente o objeto da intera√ß√£o, e o certificado pessoal √© o resultado da intera√ß√£o do sujeito e do objeto.  Ao coletar e analisar uma grande variedade de eventos, podemos distinguir grupos de entidades: <br><br><ul><li>  <b>identifica√ß√£o</b> : conta de usu√°rio, grupo de usu√°rios, certificado - entidades que permitem identificar o usu√°rio ou sistema; </li><li>  <b>execut√°vel</b> : aplicativo, m√≥dulo execut√°vel - tudo o que pode ser iniciado pelo sistema operacional e cont√©m um determinado algoritmo; </li><li>  <b>regras e pol√≠ticas</b> : quaisquer regras, pol√≠ticas de acesso, incluindo pol√≠ticas de grupo do Windows OC; </li><li>  <b>a ess√™ncia do armazenamento de informa√ß√µes no sistema operacional</b> : um arquivo, uma chave de registro, um objeto de um grupo de diret√≥rios - tudo o que pode funcionar como armazenamento de informa√ß√µes no n√≠vel do aplicativo; </li><li>  <b>conex√µes de rede</b> : sess√µes, fluxos, t√∫neis - entidades que transportam um fluxo de dados de um n√≥ para outro; </li><li>  <b>Entidades de identifica√ß√£o de rede de um n√≥</b> : endere√ßo de rede, soquete, diretamente o pr√≥prio n√≥ de rede - todas aquelas entidades que nenhum sistema de monitoramento pode prescindir; </li><li>  <b>rede L5-L7</b> : mensagem de correio, fluxo de m√≠dia, lista de distribui√ß√£o - entidades que transmitem informa√ß√µes nos n√≠veis L5-L7 do modelo OSI; </li><li>  <b>rede de servi√ßo</b> : zona DNS, tabela de roteamento.  Essas entidades s√£o respons√°veis ‚Äã‚Äãpelo correto funcionamento da rede, sem transportar uma carga √∫til para o usu√°rio final; </li><li>  <b>entidades de configura√ß√µes tolerantes a falhas</b> : RAID, elementos de rede de cluster; </li><li>  <b>a ess√™ncia dos sistemas de virtualiza√ß√£o</b> : m√°quinas virtuais, discos r√≠gidos virtuais, instant√¢neos de m√°quinas virtuais; </li><li>  <b>entidades de banco de dados</b> : tabelas, bancos de dados, DBMS; </li><li>  <b>equipamento f√≠sico</b> : dispositivos de encaixe, elementos ACS (torniquetes, c√¢meras IP); </li><li>  <b>outras entidades do SO</b> : um comando no console de gerenciamento, console do sistema, log do sistema - aquelas entidades do SO que n√£o se enquadravam em outras categorias; </li><li>  <b>outras entidades de rede</b> : interface de rede, recurso de rede p√∫blica - aquelas entidades do subsistema de rede que n√£o se enquadravam em outras categorias. </li></ul><br>  Esses grupos n√£o pretendem ser abrangentes, mas abrangem as principais tarefas de atribui√ß√£o de categorias de segundo n√≠vel.  Se necess√°rio, os grupos representados podem expandir. <br><br><h2>  O terceiro n√≠vel de categoriza√ß√£o de eventos de TI (natureza da intera√ß√£o) </h2><br><img src="https://habrastorage.org/webt/x5/wc/ja/x5wcja8h3u9jrersnj_au4im9ke.png" alt="Sistema de categoriza√ß√£o para eventos de TI.  O primeiro, segundo e terceiro n√≠veis."><br>  <i>Sistema de categoriza√ß√£o para eventos de TI.</i>  <i>O primeiro, segundo e terceiro n√≠veis.</i> <br><br>  Dentro de um processo espec√≠fico, o comportamento da entidade principal pode ser reduzido para os seguintes valores: <br><br><ul><li>  <b>Controle</b> - intera√ß√£o que afeta o funcionamento da entidade; </li><li>  <b>Comunica√ß√£o</b> - comunica√ß√£o entre entidades; </li><li>  <b>Manipula√ß√£o</b> - a√ß√µes para trabalhar com a pr√≥pria entidade, incluindo a manipula√ß√£o de seus dados; </li><li>  <b>Incorpora√ß√£o</b> - intera√ß√£o, como resultado da qual uma nova entidade √© adicionada ao contexto (ou a entidade √© removida do contexto); </li><li>  <b>Estado</b> - eventos informativos sobre mudan√ßas no estado de uma entidade. </li></ul><br>  O √∫ltimo dom√≠nio se destaca entre outros: inclui eventos que, na verdade, n√£o descrevem nenhuma intera√ß√£o, mas cont√™m informa√ß√µes sobre a entidade ou transi√ß√µes entre entidades.  Por exemplo, um evento que descreva apenas o estado atual do sistema (sobre a hora atual do sistema, sobre uma altera√ß√£o no status de uma licen√ßa do produto). <br><br>  Os eventos descrevem n√£o apenas a intera√ß√£o em si, mas tamb√©m o resultado.  √â importante entender que o contexto, a ess√™ncia principal e o comportamento de um objeto dentro do contexto n√£o dependem do resultado da intera√ß√£o.  O resultado pode ser "sucesso" e "fracasso".  Um evento tamb√©m pode descrever o processo cont√≠nuo de intera√ß√£o incompleta.  N√≥s chamaremos esse status de "cont√≠nuo". <br><br><h2>  Forma√ß√£o de um conjunto de dados com base em tr√™s n√≠veis </h2><br>  Para cada dom√≠nio de cada n√≠vel, voc√™ pode selecionar um conjunto de dados espec√≠fico contendo eventos. <br><br>  Vamos analisar um exemplo de um evento: <br><br><img src="https://habrastorage.org/webt/0j/e6/so/0je6sogj5o9rk3dbfr4qjylafac.png"><br><br>  Pode ser interpretada como "a conex√£o do n√≥ 10.0.1.5 com o n√≥ 192.168.149.2 foi desconectada".  Observando o contexto de um evento, voc√™ pode ver que ele descreve uma conex√£o de rede.  Assim, ca√≠mos no contexto de "Gerenciamento de intera√ß√£o de rede". <br><br>  Em seguida, determinamos a entidade principal no evento.  Obviamente, o evento descreve tr√™s entidades: dois n√≥s e uma conex√£o de rede.  Com base nas recomenda√ß√µes acima, entendemos que a entidade principal neste caso √© apenas uma conex√£o de rede e os n√≥s s√£o participantes da intera√ß√£o, pontos de extremidade que executam a√ß√µes na entidade.  No total, obtemos a entidade principal do dom√≠nio Network Connections, e a a√ß√£o executada na entidade √© ‚Äúfechar o canal de comunica√ß√£o‚Äù, que pode ser atribu√≠do ao dom√≠nio Communication. <br><br>  No entanto, ainda temos muitos dados que podem ser salvos do evento.  Portanto, um conjunto de entidades do segundo n√≠vel "Conex√µes de Rede" possui propriedades comuns: <br><br><ul><li>  iniciador de conex√£o (endere√ßo + porta + interface); </li><li>  receptor (alvo) da conex√£o (endere√ßo + porta + interface); </li><li>  O protocolo sobre o qual a conex√£o √© estabelecida. </li></ul><br>  Al√©m disso, por exemplo, a a√ß√£o do terceiro n√≠vel de categoriza√ß√£o ‚Äúfechar a conex√£o‚Äù, pertencente ao dom√≠nio Comunica√ß√£o, pode conter os seguintes dados, independentemente de qual conex√£o foi fechada e qual fonte relatou isso: <br><br><ul><li>  n√∫mero de bytes enviados / enviados; </li><li>  n√∫mero de pacotes transmitidos / enviados; </li><li>  dura√ß√£o. </li></ul><br>  Como exemplo, podemos distinguir um conjunto de entidades b√°sicas "Entidades de armazenamento de informa√ß√µes no SO", que s√£o caracterizadas pelos seguintes dados: <br><br><ul><li>  nome da entidade; </li><li>  o caminho da localiza√ß√£o da entidade no sistema operacional; </li><li>  tamanho da entidade; </li><li>  privil√©gios de acesso √† entidade. </li></ul><br>  Um conjunto de a√ß√µes relacionadas a essa entidade, por exemplo, "c√≥pia", inclu√≠do no dom√≠nio de terceiro n√≠vel "Manipula√ß√£o", pode ser caracterizado pelas seguintes propriedades: <br><br><ul><li>  O novo nome da entidade </li><li>  uma nova maneira de organizar a entidade; </li><li>  Novos privil√©gios de acesso √† entidade. </li></ul><br>  Opcionalmente, podemos obter todos esses dados do evento.  O principal √© que a categoria que definimos nos permite destacar um conjunto espec√≠fico de dados que podem ser extra√≠dos do evento, entendendo antecipadamente que esses dados ser√£o semanticamente semelhantes. <br><br>  E, nesse sentido, as categorias est√£o se tornando uma ferramenta conveniente.  Ao comparar um determinado conjunto desses dados com cada n√≠vel de dom√≠nio, temos a oportunidade de armazenar dados semanticamente semelhantes nos mesmos campos de um evento normalizado, independentemente do fabricante e modelo da fonte de eventos.  Isso simplifica bastante a pesquisa de dados em um grande volume de eventos e, consequentemente, a implementa√ß√£o de correla√ß√µes para esses eventos. <br><br><h2>     </h2><br> <b> 1:</b>    ,           . <br><br>     ,      <b>Level 1</b> (  ), <b>Level 2</b> ( )  <b>Level 3</b> ( )  .         : <br><br><ul><li> Level 2: <b> ;</b> </li><li> Level 3: <b>Embedding.</b> </li></ul><br>      ,          . <br><br>  ,        : <br><br><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level2 = ‚Äú&lt;      &gt;‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level3 = ‚ÄúEmbedding‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  <b>Situa√ß√£o 2:</b> √â necess√°rio encontrar todos os eventos que descrevem uma tentativa de modificar objetos do sistema de arquivos com um nome come√ßando com "boot". <br><br>  As fontes conectadas ao SIEM podem produzir eventos de modifica√ß√£o de arquivo completamente diferentes.  No entanto, atribuir as categorias apropriadas aos eventos permite selecionar o necess√°rio de toda a matriz: <br><br><ul><li>  N√≠vel 1: <b>Gerenciamento de Sistema;</b> </li><li>  N√≠vel 2: <b>Entidades de armazenamento de informa√ß√µes no SO;</b> </li><li>  N√≠vel 3: <b>Manipula√ß√£o.</b> </li></ul><br>  Al√©m disso, uma condi√ß√£o √© especificada pelo nome do arquivo: usando conjuntos de dados predefinidos, podemos esperar que, para essa categoria, o nome do arquivo esteja no campo object.name.  Portanto, para selecionar eventos, voc√™ pode formar a seguinte consulta: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level1 = ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">System</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Management</span></span>‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level2 = ‚Äú&lt;        &gt;‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> Level3 = ‚ÄúManipulation‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (object.name <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> ‚Äúboot.%‚Äù)</code> </pre> <br>  Se uma entidade foi copiada, encontraremos informa√ß√µes sobre ela e que foram copiadas de outra entidade - isso dar√° um impulso para uma investiga√ß√£o mais aprofundada. <br><br>  <b>Caso 3:</b> √© necess√°rio fornecer um perfil simples de conex√µes de rede nos roteadores de borda de v√°rios fabricantes instalados nas filiais da empresa.  O SIEM recebe eventos de cada um desses roteadores de borda. <br><br>  Cada um dos roteadores gera eventos de TI, ap√≥s a normaliza√ß√£o dos quais os campos N√≠vel 1, N√≠vel 2, N√≠vel 3 cont√™m categorias.  No exemplo descrito, para cria√ß√£o de perfil, √© necess√°rio e suficiente analisar eventos sobre a abertura e fechamento de conex√µes de rede.  De acordo com o sistema de categoriza√ß√£o apresentado, esses eventos conter√£o os seguintes campos de categoria: <br><br><ul><li>  N√≠vel 1: <b>Gerenciamento de intera√ß√£o de rede;</b> </li><li>  N√≠vel 2: <b>Conex√µes de Rede;</b> </li><li>  N√≠vel 3: <b>Comunica√ß√£o.</b> </li></ul><br>  Al√©m disso, para as opera√ß√µes de abertura e fechamento de conex√µes, voc√™ pode especificar as a√ß√µes "abrir" e "fechar", bem como o status da a√ß√£o "sucesso". <br><br>  Al√©m disso, tendo conjuntos de dados para cada uma das categorias da categoria, voc√™ pode ter certeza de que a hora de in√≠cio dessa conex√£o ser√° registrada no evento de abertura da conex√£o, e as informa√ß√µes sobre os n√≥s que participam da intera√ß√£o da rede ser√£o colocadas no evento de fechamento da conex√£o, bem como nos campos ‚ÄúN√∫mero de bytes transmitidos‚Äù, ‚Äún√∫mero de pacotes transmitidos‚Äù e ‚Äúdura√ß√£o‚Äù ser√£o colocados os dados correspondentes na dura√ß√£o da conex√£o e na quantidade de informa√ß√µes transmitidas, respectivamente. <br><br>  Assim, filtrando o fluxo de eventos pelas categorias e a√ß√µes especificadas, voc√™ pode selecionar apenas os eventos necess√°rios para a opera√ß√£o de cria√ß√£o de perfil, sem precisar especificar uma lista de identificadores de eventos espec√≠ficos. <br><br><h1>  Sistema de categoriza√ß√£o de eventos do IB </h1><br>  Antes de falar sobre o sistema de categoriza√ß√£o, observamos que consideraremos apenas eventos provenientes de defesas.  A categoriza√ß√£o dos ataques de hackers como cadeias de a√ß√µes maliciosas √© uma √°rea separada com seu pr√≥prio sistema de categoriza√ß√£o. <br><br>  O sistema para categorizar eventos de seguran√ßa da informa√ß√£o √© baseado em um certo paradigma.  √â formulado da seguinte maneira: qualquer incidente que ocorre em um sistema automatizado √© refletido em uma ou v√°rias m√≠dias de uma s√≥ vez: o n√≠vel de um host espec√≠fico, o n√≠vel da rede e o n√≠vel do ambiente f√≠sico. <br><br>  As ferramentas de seguran√ßa que operam nesses n√≠veis identificam o incidente ou seus "ecos" e geram eventos de seguran√ßa da informa√ß√£o que entram no SIEM. <br><br>  Por exemplo, a transmiss√£o de um arquivo malicioso atrav√©s de uma rede para um host espec√≠fico pode ser detectada nos n√≠veis de rede e host, no processo de processamento do tr√°fego de rede por meio da prote√ß√£o de rede ou analisando √°reas da mem√≥ria RAM com os m√≥dulos apropriados de ferramentas de prote√ß√£o antiv√≠rus. <br><br>  O acesso f√≠sico n√£o autorizado √† sala pode ser detectado no n√≠vel do ambiente f√≠sico por meio de sistemas de controle de acesso e no n√≠vel do host, por meio de SZI do NSD quando o usu√°rio √© autorizado para o host fora do hor√°rio comercial. <br><br>  Ao trabalhar com eventos de SI, geralmente √© necess√°rio entender em que ambiente o incidente foi registrado.  E j√° procedendo a isso, construa um caminho adicional de investiga√ß√£o ou forme a l√≥gica da regra de correla√ß√£o.  Portanto, o ambiente de detec√ß√£o √© o primeiro n√≠vel de um sistema de categoriza√ß√£o. <br><br><h2>  O primeiro n√≠vel do sistema de categoriza√ß√£o de eventos do IB </h2><br><img src="https://habrastorage.org/webt/ig/ay/vz/igayvzurcou73lz_txlya7rqyya.png" alt="Sistema de categoriza√ß√£o de eventos do IB.  Primeiro n√≠vel"><br>  <i>Sistema de categoriza√ß√£o de eventos do IB.</i>  <i>Primeiro n√≠vel</i> <br><br><ul><li>  <b>Viola√ß√µes de host</b> (eventos no n√≠vel do host) - eventos provenientes dos meios de prote√ß√£o instalados nas esta√ß√µes de trabalho e nos servidores finais.  Como regra, eventos de seguran√ßa da informa√ß√£o desse n√≠vel descrevem o acionamento de pol√≠ticas de seguran√ßa como resultado da an√°lise do estado interno do host por meio de prote√ß√£o.  Sob a an√°lise do estado interno aqui, entende-se a an√°lise de processos em execu√ß√£o, dados nas √°reas da RAM, arquivos no disco. <br>  <b>Tipos de fontes de eventos</b> : ferramentas de prote√ß√£o antiv√≠rus, sistemas de monitoramento de integridade, sistemas de detec√ß√£o de intrus√£o no n√≠vel do host, sistemas de controle de acesso e controle de acesso. </li><li>  <b>Viola√ß√µes de rede</b> - eventos de sistemas que analisam o tr√°fego de rede e aplicam um conjunto de pol√≠ticas de seguran√ßa estabelecidas. <br>  <b>Tipos de fontes de eventos</b> : firewalls, sistemas de detec√ß√£o e preven√ß√£o de intrus√µes, sistemas de detec√ß√£o de DDoS.  Algumas prote√ß√µes de host tamb√©m possuem m√≥dulos de an√°lise de tr√°fego de rede separados.  Por exemplo, ferramentas de prote√ß√£o antiv√≠rus e alguns dispositivos dom√©sticos antiv√≠rus da NSD. </li><li>  <b>Viola√ß√µes f√≠sicas</b> (viola√ß√µes do n√≠vel do ambiente f√≠sico) - eventos provenientes de seguran√ßa f√≠sica. <br>  <b>Tipos de fontes de eventos</b> : sistemas de seguran√ßa de per√≠metro, sistemas de controle de acesso, sistemas de prote√ß√£o contra vazamento de informa√ß√µes por meio de canais vibroac√∫sticos e canais PEMIN. <br>  Essa categoria tamb√©m inclui incidentes identificados pelo servi√ßo de seguran√ßa f√≠sica ou econ√¥mica no curso de atividades internas e trazidos para os bancos de dados internos da empresa, cujas informa√ß√µes podem ser coletadas pelo SIEM.  Devido a algumas raz√µes organizacionais, este √© um evento extremamente raro, mas ainda poss√≠vel. </li></ul><br><h2>  O segundo e terceiro n√≠vel do sistema de categoriza√ß√£o de eventos do IB </h2><br>  O segundo n√≠vel do sistema de categoriza√ß√£o est√° associado ao primeiro, mas possui recursos devido aos seguintes pr√©-requisitos: <br><br><ul><li>  os incidentes de seguran√ßa da informa√ß√£o nem sempre ocorrem no ambiente f√≠sico; </li><li>  incidentes no ambiente f√≠sico nem sempre est√£o associados a incidentes de seguran√ßa da informa√ß√£o, mas tamb√©m h√° interse√ß√µes; </li><li>  os incidentes nos n√≠veis de rede e de host final geralmente t√™m estrutura e sem√¢ntica semelhantes. </li></ul><br>  Portanto, no segundo n√≠vel, s√£o distinguidos um grupo de categorias correspondentes a viola√ß√µes do n√≠vel do ambiente f√≠sico e grupos de categorias comuns a viola√ß√µes da rede e do host. <br><br>  O terceiro n√≠vel do sistema de categoriza√ß√£o esclarece o segundo e descreve diretamente as pr√≥prias viola√ß√µes, cuja ess√™ncia √© refletida nos eventos de seguran√ßa da informa√ß√£o. <br><br>  Analisamos os sistemas de categoriza√ß√£o de eventos das solu√ß√µes de seguran√ßa IBM QRadar, Micro Focus Arcsight e Maxpatrol SIEM para viola√ß√µes de rede e n√≠vel de host.  De acordo com os resultados, eles conclu√≠ram: s√£o todos muito semelhantes e o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">eCSIRT.net mkVI</a> pode servir como o sistema de categoriza√ß√£o mais abrangente e unificador.  Foi ela quem foi tomada como base no sistema de categoriza√ß√£o abaixo. <br><br><img src="https://habrastorage.org/webt/eh/-e/gs/eh-egskwu2pfw2sjhrlucrdii80.png" alt="Sistema de categoriza√ß√£o de eventos do IB. Viola√ß√µes no n√≠vel do host e no n√≠vel da rede."><br>  <i>Sistema de categoriza√ß√£o de eventos do IB.</i>  <i>Viola√ß√µes no n√≠vel do host e no n√≠vel da rede.</i> <br><br><ul><li>  <b>Conte√∫do abusivo</b> - conte√∫do entregue legalmente ao usu√°rio final, solicitando a√ß√µes ilegais (intencionais ou n√£o intencionais) ou contendo dados maliciosos / indesejados. <br>  <b>Categorias de terceiro n√≠vel</b> : spam, phishing. <br>  <b>Tipos de fontes de eventos</b> : servidores proxy com controle de conte√∫do (Microsoft Threat Management Gateway), ferramentas de prote√ß√£o de tr√°fego da Web (Cisco Web Security Appliance, painel de filtragem de URL do Check Point), ferramentas de prote√ß√£o de email (Cisco Email Security Appliance, Kaspersky Secure Mail Gateway), Seguran√ßa do host final com m√≥dulos integrados de controle da Web e de email (McAfee Internet Security, Kaspersky Internet Security). </li><li>  <b>Coleta de informa√ß√µes</b> - coleta de dados sobre o objeto de prote√ß√£o contra fontes abertas e fechadas de informa√ß√µes, usando m√©todos de coleta ativos e passivos. <br>  <b>Categorias de terceiro n√≠vel</b> : impress√£o digital, cheirar, digitalizar, Bruteforce. <br>  <b>Tipos de fontes de eventos</b> : via de regra, recursos de seguran√ßa de rede, a saber: firewalls (Cisco Adaptive Security Appliance, painel Checkpoint Firewall), ferramentas de detec√ß√£o e preven√ß√£o de intrus√µes (IPS de pr√≥xima gera√ß√£o do Cisco Firepower, painel Check Point IPS). </li><li>  <b>Disponibilidade</b> - uma viola√ß√£o maliciosa ou acidental da disponibilidade de servi√ßos e sistemas individuais em geral. <br>  <b>Categorias de terceiro n√≠vel</b> : DDoS, DoS, Flood. <br>  <b>Tipos de fontes de eventos</b> : firewalls e sistemas de detec√ß√£o e preven√ß√£o de intrus√µes, bem como sistemas de detec√ß√£o e bloqueio de ataques de rede DoS (Arbor Pravail APS, Arbor Peakflow SP, Radware DefensePro, Radware DefensePro, IFI Soft APK ‚ÄúPerimeter‚Äù). </li><li>  <b>Explora√ß√£o de vulnerabilidades</b> - identifica uma vulnerabilidade ou grupo de vulnerabilidades.  √â importante observar que esta categoria descreve eventos de seguran√ßa da informa√ß√£o sobre detec√ß√£o de vulnerabilidades, mas n√£o sua opera√ß√£o. <br>  <b>Categorias de terceiro n√≠vel</b> : Firmware, Software. <br>  <b>Tipos de fontes de</b> eventos: eventos do SIEM interno ou do scanner externo integrado de seguran√ßa e auditoria (Tenable Nessus Vulnerability Scanner, Positive Technologies Maxpatrol 8, Positive Technologies XSpider, Positive Technologies XSpider, Qualys Vulnerability Scanner, Burp Suit). </li><li>  <b>Explora√ß√£o de vulnerabilidade</b> (explora√ß√£o de vulnerabilidade) - identifica√ß√£o de impacto negativo deliberado no sistema ou explora√ß√£o da vulnerabilidade do sistema.  Nesse caso, geralmente as categorias de terceiro n√≠vel podem incluir t√©cnicas de ataque individuais listadas no MITRE ATT &amp; CK (link) e definidas por recursos de seguran√ßa. <br>  <b>Categorias de terceiro n√≠vel</b> : entidades externas XML, scripts entre sites, desserializa√ß√£o insegura, envenenamento por roteamento etc. <br>  <b>Tipos de fontes de eventos</b> : sistemas de detec√ß√£o e preven√ß√£o de intrus√µes no n√≠vel da rede (Positive Technologies Network Attack Discovery, Positive Technologies Web Application Firewall, Imperva Web Application Firewall, Cisco Firepower IPS de pr√≥xima gera√ß√£o, blade IPS Check Point) ou n√≠vel de host (Carbon Black Cb Defense, M√≥dulos de prote√ß√£o antiv√≠rus HIPS, OSSEC). </li><li>  <b>Ferramenta de</b> hackers (utilit√°rios de hackers) - uso de utilit√°rios usados ‚Äã‚Äãpara invadir sistemas ou implementar outras a√ß√µes ilegais para obter informa√ß√µes confidenciais e ignorar ferramentas de seguran√ßa. <br>  <b>Categorias de terceiro n√≠vel</b> : Scanner, Bruteforcer, Exploit Kit, Password dumper, Scanner de vulnerabilidade, cliente TOR, Sniffer, Shellcode, Keylogger. <br>  <b>Tipos de fontes de eventos</b> : sistemas de detec√ß√£o e preven√ß√£o de intrus√µes no n√≠vel da rede e do host, scanners de seguran√ßa e auditoria, ferramentas de prote√ß√£o antiv√≠rus. </li><li>  <b>C√≥digo malicioso</b> - detecta o uso de c√≥digo malicioso. <br>  <b>Categorias de terceiro n√≠vel</b> : V√≠rus, Worm, Botnet, Rootkit, Bootkit, Trojan, Backdoor, Cryptor. <br>  <b>Tipos de fontes de eventos</b> : qualquer ferramenta de prote√ß√£o antiv√≠rus da rede e do host, sistemas de detec√ß√£o e preven√ß√£o de intrus√µes no n√≠vel da rede. </li><li>  <b>Conformidade</b> (viola√ß√£o da conformidade) - a identifica√ß√£o dos fatos de n√£o conformidade com as verifica√ß√µes definidas nas pol√≠ticas de conformidade.  Nesse caso, pol√≠ticas de conformidade significam requisitos do PCI DSS, pedido n¬∫ 21 da FSTEC e padr√µes de seguran√ßa corporativa. <br>  <b>Categorias de terceiro n√≠vel</b> : controle de integridade, controle de configura√ß√µes do sistema operacional, controle de configura√ß√µes do aplicativo. <br>  <b>Tipos de fontes de eventos</b> : scanners de seguran√ßa e auditoria. </li><li>  <b>Vazamento de informa√ß√µes</b> - vazamento de dados confidenciais por qualquer canal de comunica√ß√£o. <br>  <b>Categorias de terceiro n√≠vel</b> : email, Messenger, rede social, dispositivo m√≥vel, armazenamento remov√≠vel. <br>  <b>Tipos de fontes de eventos</b> : Sistemas de preven√ß√£o de vazamento de dados (Rostelecom - Solar Dozor, InfoWatch Traffic Monitor). </li><li>  <b>Anomalia</b> (anomalias) - um desvio significativo dos par√¢metros do objeto de prote√ß√£o ou seu comportamento da norma estabelecida anteriormente. <br>  <b>Categorias de terceiro n√≠vel</b> : Estat√≠stica, Comportamental. <br>  <b>Tipos de fontes de eventos</b> : prote√ß√µes de rede de √∫ltima gera√ß√£o, sistemas de preven√ß√£o de vazamento de dados, sistemas de classe de an√°lise de comportamento de usu√°rio e entidade (An√°lise de comportamento de usu√°rio da Splunk, an√°lise de comportamento de usu√°rio e entidade Securonix, an√°lise avan√ßada do Exabeam). </li></ul><br><img src="https://habrastorage.org/webt/d8/zs/xq/d8zsxq3vzpqv8xa8p9415yzs_eg.png" alt="Sistema de categoriza√ß√£o de eventos do IB. Viola√ß√µes do n√≠vel do ambiente f√≠sico."><br>  <i>Sistema de categoriza√ß√£o de eventos do IB.</i>  <i>Viola√ß√µes do n√≠vel do ambiente f√≠sico.</i> <br><br>  Viola√ß√µes no ambiente f√≠sico, significativas do ponto de vista da seguran√ßa da informa√ß√£o, t√™m seu pr√≥prio "ramo" separado no sistema de categoriza√ß√£o.  √â importante que, neste caso, o sistema de categoriza√ß√£o tenha apenas um n√≠vel. <br><br>  Essa representa√ß√£o "truncada" do sistema de categoriza√ß√£o deve-se principalmente a casos extremamente raros de integra√ß√£o do SIEM com equipamentos de seguran√ßa f√≠sica.  Exce√ß√µes s√£o sistemas de controle de acesso e contabilidade (ACS), que geralmente s√£o conectados ao SIEM.  Caso contr√°rio, ao compilar esse "ramo" do sistema de categoriza√ß√£o, n√£o t√≠nhamos dados estat√≠sticos suficientes para sistematizar essa dire√ß√£o espec√≠fica. <br><br><ul><li>  <b>Roubo</b> (roubo) - roubo de m√≠dia f√≠sica ou dispositivos de computa√ß√£o (laptops, tablets, smartphones) com informa√ß√µes confidenciais do territ√≥rio da empresa ou dos funcion√°rios da empresa. <br>  <b>Tipos de fontes de eventos</b> : bases de incidentes do servi√ßo de seguran√ßa f√≠sica, sistemas de pessoal. </li><li>  <b>Intrus√£o</b> (penetra√ß√£o f√≠sica) - desvio n√£o autorizado ou n√£o regulamentado do sistema de prote√ß√£o f√≠sica. <br>  <b>Tipos de fontes de eventos</b> : bases de incidentes do servi√ßo de seguran√ßa f√≠sica, ACS, sistemas de seguran√ßa de per√≠metro. </li><li>  <b>Dano</b> (dano) - dano direcionado, destrui√ß√£o, redu√ß√£o na vida √∫til de equipamentos ou canais de comunica√ß√£o. <br>  <b>Tipos de fontes de eventos</b> : banco de dados de incidentes de seguran√ßa f√≠sica. </li></ul><br><h2>  Exemplos de uso de sistemas de categoriza√ß√£o </h2><br>  Aplicamos o sistema de categoriza√ß√£o descrito para escrever regras de correla√ß√£o de alto n√≠vel e procurar eventos no processo de investiga√ß√£o.  Considere duas situa√ß√µes. <br><br>  <b>Situa√ß√£o 1</b> : por meio da regra de correla√ß√£o, √© necess√°rio identificar um vazamento de informa√ß√µes confidenciais devido √† invas√£o de ativos do sistema automatizado.  O SIEM recebe eventos dos seguintes recursos de seguran√ßa: <br><br><ul><li>  sistemas de preven√ß√£o de vazamento de dados; </li><li>  sistemas de detec√ß√£o e preven√ß√£o de intrus√µes no n√≠vel da rede; </li><li>  sistemas de detec√ß√£o e preven√ß√£o de intrus√µes no n√≠vel do host; </li><li>  ferramenta de prote√ß√£o antiv√≠rus. </li></ul><br>  Cada um deles gera eventos de IB, ap√≥s a normaliza√ß√£o nos <b>campos</b> <b>N√≠vel1</b> , <b>N√≠vel2</b> , <b>N√≠vel3 dos</b> quais as categorias est√£o afixadas. <br>  O texto da regra de correla√ß√£o no pseudo-c√≥digo pode ser assim: <br><br><pre> <code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#         .    ¬´Host_poisoning event Host_poisoning¬ª: #          ,        group by dst.host #     hostname/fqdn/ip ,     filter { Level2 = ‚ÄúMalicious Code‚Äù OR Level2 = ‚ÄúVulnerability Exploitation‚Äù } #           : event Data_leak: group by dst.host filter { Level2 = ‚ÄúInformation Leak‚Äù AND Level3 = ‚ÄúEmail‚Äù #        } #      Host_poisoning_and_data_leakage:   ¬´Host_poisoning¬ª,   ¬´Data_leak¬ª   24       : rule Host_poisoning_and_data_leakage: (Host_poisoning ‚Äî&gt; Data_leak) within 24h emit { #  ‚Äî    }</span></span></code> </pre> <br>  <b>Situa√ß√£o 2:</b> estamos investigando o incidente em um host espec√≠fico - alexhost.company.local.  Voc√™ precisa entender o que aconteceu com ele no per√≠odo de 04:00 a 06:00 11/08/2018.  Durante esse per√≠odo, existem cerca de 21,6 milh√µes de eventos desse host no pr√≥prio SIEM (o fluxo m√©dio de eventos √© de 3000 EPS).  Agora s√£o 11h00 em 09/09/2018, todos os eventos est√£o no banco de dados SIEM. No momento do incidente, nenhuma regra de correla√ß√£o foi estabelecida no SIEM. <br><br>  Obviamente, analisar todos os eventos manualmente √© uma m√° ideia.  √â necess√°rio, de alguma forma, reduzir o volume e localizar o problema.  Vamos tentar procurar eventos de interesse para n√≥s neste conjunto.  Uma consulta de exemplo usar√° sintaxe semelhante ao SQL. <br><br><ol><li>  Aprendemos que "vimos" rem√©dios no momento: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level1 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (‚ÄúHost violations‚Äù, ‚ÄúNetwork violations‚Äù, ‚Äú<span class="hljs-keyword"><span class="hljs-keyword">Physical</span></span> violations‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> dst.dost=‚Äúalexhost.company.local‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  Suponha que recebamos 10.000 eventos de dom√≠nios de viola√ß√µes de host e viola√ß√µes de rede para esta solicita√ß√£o.  Enfim, muito, para an√°lise manual. </li><li>  Vamos tentar entender se o host pode ter sido invadido durante o incidente e n√£o importa para n√≥s que tipo de prote√ß√£o isso significa. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level2 <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (‚ÄúVulnerability Exploitation‚Äù) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> dst.dost=‚Äúalexhost.company.local‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; &gt;)</code> </pre> <br>  Suponha que recebamos 500 eventos para essa solicita√ß√£o dos sistemas de detec√ß√£o e preven√ß√£o de intrus√µes no n√≠vel da rede e do host.  √ìtimo!  Voc√™ j√° pode trabalhar com isso manualmente. </li><li>  Durante a investiga√ß√£o, percebemos que os hackers ocorreram de dentro da empresa.  Vamos tentar descobrir se alguma das ferramentas de prote√ß√£o "viu" a instala√ß√£o ou a execu√ß√£o de ferramentas de hackers em qualquer host da empresa. <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">events</span></span> <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> Level3 = ‚ÄúExploit kit‚Äù <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> <span class="hljs-keyword"><span class="hljs-keyword">between</span></span> (&lt; <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;)</code> </pre> </li></ol><br><a name="Conclusion"></a><h1>  Conclus√µes </h1><br>  Descrevemos os princ√≠pios de constru√ß√£o de um sistema para categorizar eventos e apresentamos os <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">requisitos</a> que determinaram as abordagens e os princ√≠pios para sua forma√ß√£o.  Com base nas especificidades das fontes de eventos conectadas ao SIEM, o sistema de categoriza√ß√£o foi dividido em duas √°reas: categoriza√ß√£o de eventos de fontes de TI e categoriza√ß√£o de eventos de fontes de informa√ß√£o. <br><br>  O sistema de categoriza√ß√£o de eventos de TI foi formado com base nos seguintes princ√≠pios: <br><br><ol><li>  Os eventos de TI refletem os est√°gios ou detalhes dos processos de TI que s√£o suportados ou implementados por fontes de eventos. </li><li>  O sistema de categoriza√ß√£o consiste em 3 n√≠veis principais e um adicional que determina o sucesso ou falha da a√ß√£o descrita no evento. </li><li>  No primeiro n√≠vel, os processos de TI s√£o diferenciados dentro dos quais a fonte de eventos opera. </li><li>  O segundo n√≠vel descreve as entidades b√°sicas envolvidas neste processo. </li><li>  O terceiro n√≠vel determina quais a√ß√µes s√£o executadas por esta ou por essa entidade dentro do processo. </li><li>  Um n√≠vel adicional descreve o status dessas a√ß√µes (sucesso, falha). </li></ol><br>  O sistema de categoriza√ß√£o de eventos do IB √© baseado nos seguintes princ√≠pios: <br><br><ol><li>  A categoriza√ß√£o se aplica exclusivamente a eventos de seguran√ßa de informa√ß√µes coletados de equipamentos de seguran√ßa e n√£o afeta a categoriza√ß√£o de ataques a sistemas automatizados.  As diferen√ßas entre ataques e eventos de seguran√ßa da informa√ß√£o foram dadas no in√≠cio do artigo. </li><li>  O sistema de categoriza√ß√£o consiste em 3 n√≠veis. </li><li>  No primeiro n√≠vel, s√£o identificados dom√≠nios nos quais as viola√ß√µes de IS podem ser registradas: viola√ß√µes no n√≠vel do host, na rede e no ambiente f√≠sico. </li><li>  O segundo n√≠vel de categoriza√ß√£o √© formado por classes espec√≠ficas de viola√ß√µes. </li><li>      ,     . </li></ol><br>                 . <br><br><img src="https://habrastorage.org/webt/_z/3m/ah/_z3mahc8mgidrucoua4fzcbwmgq.png" alt="   "><br> <i>   </i> <br><br>        .       ,        .         ,       ,     . <br><br><hr><br>  <b>S√©rie de artigos:</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Profundidades do SIEM: correla√ß√µes prontas para uso.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1: Marketing puro ou um problema insol√∫vel?</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Profundidades do SIEM: correla√ß√µes prontas para uso.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2. Esquema de dados como reflexo do modelo "mundo"</a> <br><br>  Profundidades do SIEM: correla√ß√µes prontas para uso.  3.1.   ( <i> </i> ) <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Profundidades do SIEM: correla√ß√µes prontas para uso.</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> 3.2.   </a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Profundidades do SIEM: correla√ß√µes prontas para uso.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 4. Modelo do sistema como um contexto de regras de correla√ß√£o</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Profundidades do SIEM: correla√ß√µes prontas para uso.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 5. Metodologia para o desenvolvimento de regras de correla√ß√£o</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt432352/">https://habr.com/ru/post/pt432352/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt432342/index.html">Camunda BPM Meetup Raiffeisenbank UPD Broadcast</a></li>
<li><a href="../pt432344/index.html">Quatro est√°gios de desenvolvimento de engenheiros</a></li>
<li><a href="../pt432346/index.html">Not√≠cias do mundo do OpenStreetMap n¬∫ 436 (20/11/2018 - 26/06/2018)</a></li>
<li><a href="../pt432348/index.html">Master class: moldagem a v√°cuo de pl√°sticos em silicone</a></li>
<li><a href="../pt432350/index.html">Por que os elementos React t√™m uma propriedade $$ typeof?</a></li>
<li><a href="../pt432354/index.html">Os dados mais significativos vazam em 2018. Parte Um (janeiro a junho)</a></li>
<li><a href="../pt432356/index.html">Como escrever um excelente feed de not√≠cias do VKontakte em 20 horas</a></li>
<li><a href="../pt432360/index.html">AlphaGo ‚Äúdescendente‚Äù aprendeu independentemente a jogar xadrez, shogi e ir</a></li>
<li><a href="../pt432362/index.html">Chang'e 4 - miss√£o para o outro lado da lua come√ßa hoje</a></li>
<li><a href="../pt432364/index.html">Alfabeto fon√©tico: como uma solu√ß√£o para a avia√ß√£o ajudar√° a transferir um login por telefone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>