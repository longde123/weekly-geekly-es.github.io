<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👨‍👦‍👦 🌅 👩🏾‍🏫 Extension Web multi-navigateur pour les scripts personnalisés Partie 3 🚓 ➗ 🤜🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans cet article, je continue la série de publications dans lesquelles je veux parler de mon expérience d'écriture d'une extension web pour les naviga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Extension Web multi-navigateur pour les scripts personnalisés Partie 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416585/"> Dans cet article, je continue la série de publications dans lesquelles je veux parler de mon expérience d'écriture d'une extension web pour les navigateurs.  J'avais déjà de l'expérience dans la création d'une extension Web, qui a été installée par environ 100000 utilisateurs de Chrome, qui fonctionnait de manière autonome, mais dans cette série d'articles, j'ai décidé de me plonger dans le processus de développement de l'extension Web en l'intégrant étroitement avec le côté serveur. <br><br><img width="65" src="https://habrastorage.org/getpro/habr/post_images/188/09a/2d6/18809a2d60126c22c85f0dbb38c188dc.png" alt="image"><img width="65" src="https://habrastorage.org/getpro/habr/post_images/474/b37/7c9/474b377c9fd5df452ee6b2ae849c2891.png" alt="image"><img width="65" src="https://habrastorage.org/getpro/habr/post_images/804/cc0/c91/804cc0c91bd30f83537540bd6aca22df.png" alt="image"><img width="65" src="https://habrastorage.org/getpro/habr/post_images/94e/097/462/94e097462cb7f3af3b482312f6fd2ee9.png" alt="image"><img width="65" src="https://habrastorage.org/getpro/habr/post_images/4bf/d73/6f6/4bfd736f6830e4396071afedad261bfd.png" alt="image"><br><a name="habracut"></a><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partie 2</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partie 4</a> <br><br><h1>  Pièges dans la mise en œuvre de l'interaction des extensions Web et du côté serveur </h1><br>  Comme déjà décrit précédemment, le côté serveur utilise Meteor.js.  Pour implémenter l'API RESTful, le package <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/kahmali/meteor-restivus</a> est utilisé.  Il a déjà mis en œuvre une partie de celui-ci pour couvrir les mécanismes des utilisateurs liés à l'autorisation. <br><br>  Par exemple, il suffit de spécifier <b>authRequired: true</b> , comme dans l'exemple ci-dessous, pour que le point API ne fonctionne que pour les utilisateurs autorisés. <br><br><pre><code class="javascript hljs">Api.addRoute(<span class="hljs-string"><span class="hljs-string">'clientScript/:id_script'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">authRequired</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}, {<span class="hljs-attr"><span class="hljs-attr">get</span></span>: { <span class="hljs-attr"><span class="hljs-attr">action</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//method for GET on htts://example.com/api/v1/clientScript/:id_script } });</span></span></code> </pre> <br>  Ainsi, trois points API ont été ajoutés pour l'enregistrement, pour recevoir les données de profil et les mettre à jour, pour réinitialiser le mot de passe. <br><br>  Dans l'extension Web elle-même, lors de l'appel de méthodes nécessitant une autorisation, le code suivant est utilisé: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> details = { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: API_URL + <span class="hljs-string"><span class="hljs-string">'/api/v1/clientDataRowDownload/'</span></span> + dataRowId + <span class="hljs-string"><span class="hljs-string">'/download'</span></span>, <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'GET'</span></span>, <span class="hljs-attr"><span class="hljs-attr">contentType</span></span>: <span class="hljs-string"><span class="hljs-string">'json'</span></span>, <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: {<span class="hljs-string"><span class="hljs-string">'X-Auth-Token'</span></span>: kango.storage.getItem(<span class="hljs-string"><span class="hljs-string">"authToken"</span></span>), <span class="hljs-string"><span class="hljs-string">'X-User-Id'</span></span>: kango.storage.getItem(<span class="hljs-string"><span class="hljs-string">"userId"</span></span>)} }; kango.xhr.send(details, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//code for response handler })</span></span></code> </pre><br>  Un exemple de demande d'autorisation est clairement visible ici.  Les en-têtes incluent X-Auth-Token et X-User-Id, qui ont été obtenus à la suite du processus d'enregistrement ou d'autorisation.  Ces données sont stockées dans le stockage local de l'extension Web et sont toujours disponibles dans le script content.js. <br><br>  Le téléchargement de fichiers dans l'extension Web se fait en lisant le fichier côté navigateur et en l'envoyant via XHR: <br><br><pre> <code class="javascript hljs">$(<span class="hljs-string"><span class="hljs-string">"form#uploadFile"</span></span>).on(<span class="hljs-string"><span class="hljs-string">"submit"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event, template</span></span></span><span class="hljs-function">) </span></span>{ event.preventDefault(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileReader(); reader.onload = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">evt</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> details = { <span class="hljs-attr"><span class="hljs-attr">url</span></span>: API_URL + <span class="hljs-string"><span class="hljs-string">'/api/v1/clientFileAdd/'</span></span> + kango.storage.getItem(<span class="hljs-string"><span class="hljs-string">"userId"</span></span>), <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'POST'</span></span>, <span class="hljs-attr"><span class="hljs-attr">contentType</span></span>: <span class="hljs-string"><span class="hljs-string">'json'</span></span>, <span class="hljs-attr"><span class="hljs-attr">params</span></span>: {<span class="hljs-string"><span class="hljs-string">"content"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(evt.target.result.replace(<span class="hljs-regexp"><span class="hljs-regexp">/^data:[^;]*;base64,/</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)), <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(event.currentTarget.fileInput.files[<span class="hljs-number"><span class="hljs-number">0</span></span>].name), <span class="hljs-string"><span class="hljs-string">"size"</span></span>: event.currentTarget.fileInput.files[<span class="hljs-number"><span class="hljs-number">0</span></span>].size, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: event.currentTarget.fileInput.files[<span class="hljs-number"><span class="hljs-number">0</span></span>].type, <span class="hljs-string"><span class="hljs-string">"lastModified"</span></span>: event.currentTarget.fileInput.files[<span class="hljs-number"><span class="hljs-number">0</span></span>].lastModified }, <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: {<span class="hljs-string"><span class="hljs-string">'X-Auth-Token'</span></span>: kango.storage.getItem(<span class="hljs-string"><span class="hljs-string">"authToken"</span></span>), <span class="hljs-string"><span class="hljs-string">'X-User-Id'</span></span>: kango.storage.getItem(<span class="hljs-string"><span class="hljs-string">"userId"</span></span>)} }; kango.xhr.send(details, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data.status == <span class="hljs-number"><span class="hljs-number">200</span></span> &amp;&amp; data.response != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(data.response.status == <span class="hljs-string"><span class="hljs-string">"success"</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//ok } else { //error } } else { if(data.status == 401) { //notAuth } else { //error } } }); }; if (event.currentTarget.fileInput.files.length != 0) { reader.readAsDataURL(event.currentTarget.fileInput.files[0]); } return false; });</span></span></code> </pre><br>  Il est important de noter la ligne <b>event.target.result.replace (/ ^ data: [^;] *; base64, /, "")</b> .  Le fichier côté navigateur est encodé en base64, mais pour la compatibilité côté serveur lors de l'utilisation de cet encodage dans la ligne <b>Buffer.from (nouvelle chaîne (this.bodyParams.content), "base64")</b> nous devons couper le préfixe d'encodage et lire uniquement le "corps" du fichier .  Il est également nécessaire de noter l'habillage dans encodeURIComponent, car le même <b>+ se</b> trouve souvent dans les noms de base64 et de fichier. <br><br>  Lors de la modification de scripts, vous devez prendre en compte l'encodage des caractères dans le corps du script lors du transfert de contenu.  Dans certains cas, l'encodage base64 n'a pas produit les résultats corrects lors du décodage côté serveur à l'aide d'encodeURIComponent.  Par conséquent, le codage forcé dans utf8 est utilisé au préalable avec utf8.encode (str);  où <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mths.be/utf8js</a> v3.0.0 de @mathias <br><br>  Les téléchargements de fichiers sont mis en œuvre à l'aide de la bibliothèque FileSaver bien établie.  Les données reçues via XHR sont simplement transférées vers l'entrée du constructeur File, puis le téléchargement du fichier est initialisé: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> file = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File([data.response.data.join(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>)], <span class="hljs-string"><span class="hljs-string">"data_rows"</span></span> + date.getFullYear() + <span class="hljs-string"><span class="hljs-string">"_"</span></span> + (date.getMonth() + <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-string"><span class="hljs-string">"_"</span></span> + date.getDate() + <span class="hljs-string"><span class="hljs-string">".csv"</span></span>, {<span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-string"><span class="hljs-string">"application/vnd.ms-excel"</span></span>}); saveAs(file);</code> </pre><br><h1>  Bibliothèque interne pour les scripts personnalisés </h1><br>  Pour que le script, l'extension Web et la partie serveur interagissent, il est nécessaire d'avoir un lien intermédiaire qui vous permettra de recevoir rapidement les données du fichier téléchargé, de sauvegarder les données après l'exécution du script, etc. <br><br>  À cet effet, une bibliothèque interne a été écrite, qui est initialisée avant qu'un script ne commence à fonctionner en s'ajoutant au code de la page.  Ici, vous devez ajouter des informations sur la politique de protection des sources pour charger les ressources, à savoir la politique de sécurité du contenu. <br><br>  De nombreux sites utilisent des en-têtes CSP pour se protéger contre l'exécution de code javascript arbitraire sur leurs pages de services Web, se protégeant ainsi contre XSS du côté du navigateur Web. <br><br>  Étant donné que l'utilisateur installe lui-même l'extension Web, il peut modifier les en-têtes et le contenu de la ressource téléchargée.  En raison d'un bogue dans Mozilla Firefox, c'est un problème pour certains sites.  Autrement dit, dans l'extension Web pour Firefox, il ne sera pas possible de modifier les en-têtes ou d'ajouter une balise META pour annuler la politique CSP pour les sites sur lesquels ils sont utilisés.  Ce bogue n'a pas été fermé depuis plusieurs années, bien que les normes stipulent clairement des dispositions pour les extensions Web, qui stipulent que la politique concernant les ressources téléchargées depuis le côté du serveur d'applications ne peut pas être dominante par rapport aux extensions Web installées par l'utilisateur lui-même. <br><br>  Une restriction de stratégie CSP peut être implémentée à l'aide du framework kango de la manière suivante: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> browserObject; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(kango.browser.getName() == <span class="hljs-string"><span class="hljs-string">'chrome'</span></span>) { browserObject = chrome; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { browserObject = browser; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> filter = { <span class="hljs-attr"><span class="hljs-attr">urls</span></span>: [<span class="hljs-string"><span class="hljs-string">"*://*/*"</span></span>], <span class="hljs-attr"><span class="hljs-attr">types</span></span>: [<span class="hljs-string"><span class="hljs-string">"main_frame"</span></span>, <span class="hljs-string"><span class="hljs-string">"sub_frame"</span></span>] }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> onHeadersReceived = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">details</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newHeaders = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; details.responseHeaders.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-string"><span class="hljs-string">'content-security-policy'</span></span> !== details.responseHeaders[i].name.toLowerCase() &amp;&amp; <span class="hljs-string"><span class="hljs-string">'x-xss-protection'</span></span> !== details.responseHeaders[i].name.toLowerCase() ) { newHeaders.push(details.responseHeaders[i]); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">responseHeaders</span></span>: newHeaders }; }; browserObject.webRequest.onHeadersReceived.addListener(onHeadersReceived, filter, [<span class="hljs-string"><span class="hljs-string">"blocking"</span></span>, <span class="hljs-string"><span class="hljs-string">"responseHeaders"</span></span>]);</code> </pre><br>  Dans ce cas, vous ne devez pas oublier d'ajouter des lignes dans le manifeste de l'extension web qui permettent de travailler avec l'objet webRequest en mode blocage: <br><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"permissions"</span></span>: { ... <span class="hljs-string"><span class="hljs-string">"webRequest"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"webRequestBlocking"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, ... }</code> </pre><br>  Après avoir résolu le problème avec les restrictions imposées par le CSP, l'utilisateur peut utiliser les scripts qu'il a écrits sur n'importe quelle page d'Internet. <br><br>  Les fonctions d'appel à partir de la bibliothèque interne sont disponibles via l'objet Gc global. <br>  Fonctions actuellement implémentées: <br><br><ul><li>  <b>GC.saveRow (nom, contenu, [réécriture = 0, async = false]);</b>  , où nom est le nom des lignes à écrire dans la collection, le contenu est la ligne de données elle-même pour l'écriture, réécrire est l'indicateur pour écraser la collection entière, utilisé dans l'appel Gc.saveRow (nom, 'clear', 1);  qui supprime toutes les entrées de la collection de chaînes, async est un indicateur pour travailler en mode asynchrone. </li><li>  <b>GC.getRows (nom, numéro, [count = 1, async = false]);</b>  où nom est le nom des lignes de la collection, numéro est le numéro de série de la ligne pour recevoir des données, count est le nombre de données reçues en commençant par nombre, async est l'indicateur pour travailler en mode asynchrone. </li><li>  <b>GC.console (chaîne);</b>  , où chaîne est une chaîne de sortie vers la console GC sur la page où le script est exécuté.  Par exemple, pour montrer la progression d'une tâche. </li><li>  <b>GC.clearConsole ();</b>  , la fonction efface la console GC sur la page où le script est exécuté. </li><li>  <b>GC.stopScript ();</b>  , fonction pour arrêter l'exécution du script. </li><li>  <b>GC.loadFile (nom, [parseAs = texte]);</b>  , où nom est le nom du fichier avec l'extension dont vous souhaitez obtenir le contenu, parseAs est le format du préprocesseur de données, json et text sont actuellement pris en charge. </li></ul><br>  Dans le prochain article, je parlerai des « <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tâches planifiées</a> ». </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr416585/">https://habr.com/ru/post/fr416585/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr416575/index.html">Analyse des perturbations de supraconductivité des grands aimants collisionneurs de hadrons au CERN</a></li>
<li><a href="../fr416577/index.html">Digest MBLT DEV - frais pour les développeurs iOS</a></li>
<li><a href="../fr416579/index.html">Nous contrôlons les LED à l'aide de l'API Web Bluetooth et d'Arduino</a></li>
<li><a href="../fr416581/index.html">Modèles de troisième ordre ou comment j'ai porté Jinja2 en C ++</a></li>
<li><a href="../fr416583/index.html">Quel scanner 3D acheter? TOP 5 des meilleurs scanners 3D de 2018 de 3Dtool</a></li>
<li><a href="../fr416587/index.html">Quelques mots sur les subwoofers et pourquoi ils conviennent à presque tout le monde</a></li>
<li><a href="../fr416589/index.html">Cellules mortes: utilisation du pipeline 3D pour l'animation 2D</a></li>
<li><a href="../fr416591/index.html">"Resserrer les noix": pourquoi tout le monde a commencé à parler de resserrement de la réglementation du secteur informatique</a></li>
<li><a href="../fr416593/index.html">Ma participation au développement d'Uncharted 4</a></li>
<li><a href="../fr416595/index.html">Dagaz: Horde</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>