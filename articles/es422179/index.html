<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚣🏾 🍝 🐡 De las nubes a la tierra: cómo crear Kubernetes de grado de producción en cualquier entorno 🛬 🐟 👎🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bueno para todos! Bueno, ha llegado el momento de nuestro próximo curso Devops . Probablemente, este es uno de los cursos más estables y de referencia...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>De las nubes a la tierra: cómo crear Kubernetes de grado de producción en cualquier entorno</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/422179/">  Bueno para todos!  Bueno, ha llegado el momento de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nuestro</a> próximo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">curso Devops</a> .  Probablemente, este es uno de los cursos más estables y de referencia, pero al mismo tiempo el más diverso en términos de estudiantes, ya que ningún grupo se ha parecido nunca al otro: en uno los desarrolladores son casi completamente, luego en los siguientes ingenieros, luego administradores, y así sucesivamente.  Y esto también significa que ha llegado el momento de obtener materiales interesantes y útiles, así como reuniones en línea. <br><br><img src="https://habrastorage.org/webt/v-/xe/oi/v-xeoia0xxkvb6vuzmclcvknrys.png" alt="imagen"><a name="habracut"></a><br><br>  Este artículo contiene recomendaciones sobre el lanzamiento de un clúster de Kubernetes de calidad de producción en un centro de datos local o ubicación periférica (ubicación de borde). <br>  ¿Qué significa el grado de producción? <br><br><ul><li>  Instalación segura </li><li>  La gestión de implementación se realiza mediante un proceso repetitivo y registrado; </li><li>  El trabajo es predecible y consistente; </li><li>  Es seguro llevar a cabo actualizaciones y ajustes; </li><li>  Para detectar y diagnosticar errores y falta de recursos, hay registro y monitoreo; </li><li>  El servicio tiene suficiente "alta disponibilidad" teniendo en cuenta los recursos disponibles, incluidas las restricciones de dinero, espacio físico, energía, etc. </li><li>  El proceso de recuperación está disponible, documentado y probado para su uso en caso de falla. </li></ul><br>  En resumen, el grado de producción significa anticipar errores y preparar la recuperación con un mínimo de problemas y demoras. <br><br><img src="https://habrastorage.org/webt/ji/b8/je/jib8jeiekbsaflpgjsteescumgg.png"><br><br>  Este artículo trata sobre la implementación en el sitio de Kubernetes en un hipervisor o una plataforma básica, dada la cantidad limitada de recursos de soporte en comparación con el aumento de las principales nubes públicas.  Sin embargo, algunas de estas recomendaciones pueden ser útiles para la nube pública si el presupuesto limita los recursos seleccionados. <br><br>  La implementación de un Minikube de metal desnudo de un solo metal puede ser un proceso simple y económico, pero no es de grado de producción.  Por el contrario, no podrá alcanzar el nivel de Google con Borg en una tienda, sucursal o ubicación periférica fuera de línea, aunque es poco probable que lo necesite. <br><br>  Este artículo describe consejos para lograr una implementación de Kubernetes a nivel de producción, incluso en situaciones de recursos limitados. <br><br>  <b>Componentes importantes en el clúster de Kubernetes</b> <br><br>  Antes de profundizar en los detalles, es importante comprender la arquitectura general de Kubernetes. <br>  El clúster de Kubernetes es un sistema altamente distribuido basado en el plano de control y la arquitectura de los nodos de trabajo agrupados, como se muestra a continuación: <br><br><img src="https://habrastorage.org/webt/_9/zu/xd/_9zuxdnulbsg6axshrcnxah2x_o.png"><br><br>  Por lo general, los componentes del Servidor API, Controller Manager y Scheduler están ubicados en varias instancias de nodos de nivel de control (llamados Master).  Los nodos maestros también suelen incluir etcd, sin embargo, hay scripts grandes y muy accesibles que requieren ejecutar etcd en hosts independientes.  Los componentes se pueden ejecutar como contenedores y, opcionalmente, bajo la supervisión de Kubernetes, es decir, funcionan como hogares estáticos. <br><br>  Las instancias redundantes de estos componentes se utilizan para alta disponibilidad.  La importancia y el nivel requerido de redundancia pueden variar. <br><table><tbody><tr><th>  <nobr>Componente</nobr> </th><th>  Roles </th><th>  Consecuencias de la pérdida. </th><th>  Instancias recomendadas </th></tr><tr><td>  etcd </td><td>  Mantiene el estado de todos los objetos de Kubernetes. </td><td>  Pérdida catastrófica de almacenamiento.  Pérdida de la mayoría = Kubernetes pierde el nivel de control, el Servidor API depende de etcd, las llamadas API de solo lectura que no necesitan un quórum, como las cargas de trabajo ya creadas, pueden continuar funcionando. </td><td>  número impar, 3+ </td></tr><tr><td>  Servidor API </td><td>  Proporciona API para uso externo e interno. </td><td>  No se puede detener, iniciar, actualizar nuevos pods.  Scheduler y Controller Manager dependen del servidor API.  Las cargas continúan si no dependen de llamadas API (operadores, controladores personalizados, CRD, etc.) </td><td>  2+ </td></tr><tr><td>  Kube-Scheduler </td><td>  Coloca vainas en nodos </td><td>  Las vainas no se pueden colocar, priorizar o mover entre ellas. </td><td>  2+ </td></tr><tr><td>  gestor-controlador-kube </td><td>  Controla muchos controladores </td><td>  Los principales circuitos de control responsables del estado dejan de funcionar.  La integración en el árbol del proveedor de la nube se rompe. </td><td>  2+ </td></tr><tr><td>  administrador-controlador-nube (CCM) </td><td>  Integración de proveedor de nube fuera del árbol </td><td>  Se rompe la integración del proveedor de la nube </td><td>  1 </td></tr><tr><td>  Adiciones (por ejemplo, DNS) </td><td>  Diferente </td><td>  Diferente </td><td>  Depende del complemento (por ejemplo, 2+ para DNS) </td></tr></tbody></table><br>  Los riesgos de estos componentes incluyen fallas de hardware, errores de software, malas actualizaciones, errores humanos, interrupciones de la red y sobrecarga del sistema que resultan en el agotamiento de los recursos.  La redundancia puede reducir el impacto de estos peligros.  Además, gracias a las características de la plataforma de hipervisor (planificación de recursos, alta disponibilidad), puede multiplicar los resultados utilizando el sistema operativo Linux, Kubernetes y el tiempo de ejecución del contenedor. <br><br>  El servidor API utiliza varias instancias de equilibrador de carga para lograr escalabilidad y disponibilidad.  Un equilibrador de carga es un componente esencial para la alta disponibilidad.  Varios registros A del servidor API de DNS pueden servir como alternativa en ausencia de un equilibrador. <br><br>  Kube-Scheduler y Kube-controller-manager están involucrados en el proceso de selección de un líder en lugar de utilizar un equilibrador de carga.  Dado que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cloud-controller-manager se</a> usa para ciertos tipos de infraestructura de alojamiento, cuya implementación puede variar, no los discutiremos, solo indicamos que son un componente del nivel de administración. <br><br>  Las vainas que se ejecutan en Kubernetes son administradas por el agente kubelet.  Cada instancia del trabajador ejecuta un agente de kubelet y un entorno de inicio de contenedor compatible con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CRI</a> .  Kubernetes está diseñado para monitorear y recuperarse de fallas de nodo de trabajo.  Pero para funciones de carga críticas, gestión de recursos de hipervisor y aislamiento de carga, se puede utilizar para mejorar la accesibilidad y aumentar la previsibilidad de su trabajo. <br><br>  <b>etcd</b> <br><br>  etcd es un almacenamiento persistente para todos los objetos de Kubernetes.  La disponibilidad y la capacidad de recuperación del clúster etcd deben ser una prioridad máxima al implementar Kubernetes de grado de producción. <br><br>  El clúster etcd que consta de cinco nodos es la mejor opción si puede permitirlo.  Por qué  Porque puede dar servicio a uno y, al mismo tiempo, soportar fallas.  Un grupo de tres nodos es lo mínimo que podemos recomendar para un servicio de calidad de producción, incluso si solo hay un hipervisor de host disponible.  Tampoco se recomiendan más de siete nodos, con la excepción de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">instalaciones muy grandes que</a> cubren varias zonas de acceso. <br><br>  Las recomendaciones mínimas para alojar un nodo de clúster etcd son 2 GB de RAM y un disco duro SSD de 8 GB.  Por lo general, 8 GB de RAM y 20 GB de espacio en el disco duro son suficientes.  El rendimiento del disco afecta el tiempo de recuperación de un nodo después de una falla.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Echa</a> un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vistazo</a> para más detalles. <br><br>  <i>En casos especiales, piense en varios grupos de etcd</i> <br><br>  Para los grupos de Kubernetes muy grandes, considere usar un grupo de etcd separado para los eventos de Kubernetes, de modo que demasiados eventos no afecten al servicio de API de Kubernetes.  Cuando se usa la red Flannel, la configuración se guarda en etcd, y los requisitos de versión pueden diferir de Kubernetes.  Esto puede complicar la copia de seguridad de etcd, por lo que recomendamos usar un clúster de etcd separado específicamente para franela. <br><br>  <b>Implementación de host único</b> <br><br>  La lista de riesgos de accesibilidad incluye hardware, software y el factor humano.  Si está limitado a un solo host, el uso de almacenamiento redundante, memoria de corrección de errores y una fuente de alimentación dual puede mejorar la protección contra fallas de hardware.  La ejecución de un hipervisor en un host físico le permite usar componentes de software redundantes y agrega beneficios operativos asociados con la implementación, actualización y monitoreo del uso de recursos.  Incluso en situaciones estresantes, el comportamiento sigue siendo repetible y predecible.  Por ejemplo, incluso si solo puede permitir el lanzamiento de singletones desde los servicios maestros, deben protegerse contra la sobrecarga y el agotamiento de los recursos, compitiendo con la carga de trabajo de su aplicación.  Un hipervisor puede ser más eficiente y más fácil de usar que la priorización en el planificador de Linux, cgroups, banderas de Kubernetes, etc. <br><br>  Puede implementar tres máquinas virtuales etcd si los recursos del host lo permiten.  Cada VM debe ser compatible con un dispositivo de almacenamiento físico separado o usar partes separadas del almacenamiento utilizando redundancia (Mirroring, RAID, etc.). <br>  Las instancias dobles redundantes de la API del servidor, el planificador y el administrador del controlador son la próxima actualización si su único host tiene suficientes recursos para esto. <br><br>  <i>Opciones de implementación de host único, desde la menos adecuada para la producción hasta la mayoría</i> <br><table><tbody><tr><th>  Tipo </th><th>  Caracteristicas </th><th>  Resultado </th></tr><tr><td>  <nobr>Equipo mínimo</nobr> </td><td>  Singleton, etcd y componentes maestros. </td><td>  Laboratorio casero, en absoluto grado de producción.  Punto único de falla múltiple (SPOF).  La recuperación es lenta, y cuando se pierde el almacenamiento, está completamente ausente. </td></tr><tr><td>  Mejora de redundancia de almacenamiento </td><td>  etcd singleton y componentes maestros, el almacenamiento de etcd es redundante. </td><td>  Como mínimo, puede recuperarse de una falla del dispositivo de almacenamiento. </td></tr><tr><td>  Redundancia de nivel gestionado </td><td>  No hay hipervisor, varias instancias de componentes de nivel administrado en pods estáticos. </td><td>  Ha aparecido protección contra errores de software, pero el sistema operativo y el entorno de lanzamiento del contenedor siguen siendo el mismo punto de falla con actualizaciones devastadoras. </td></tr><tr><td>  Agregar un hipervisor </td><td>  Ejecutando tres instancias redundantes de nivel administrado en la VM. </td><td>  Existe protección contra errores de software y errores humanos y una ventaja operativa en instalación, gestión de recursos, monitoreo y seguridad.  Las actualizaciones del sistema operativo y los entornos de lanzamiento de contenedores son menos perjudiciales.  El hipervisor es el único punto único de falla. </td></tr></tbody></table><br>  <b>Implementación de doble host</b> <br><br>  Con dos hosts, los problemas de almacenamiento de etcd son similares a la opción de host único: necesita redundancia.  Es preferible ejecutar tres instancias encd.  Puede parecer poco intuitivo, pero es mejor concentrar todos los nodos etcd en un host.  No aumentará la confiabilidad al dividirlos entre 2 + 1 entre dos hosts: la pérdida de un nodo con la mayoría de las instancias de cifrado provocará un error, independientemente de si es una mayoría de 2 o 3. Si los hosts no son iguales, coloque todo el clúster etcd en el más confiable. <br><br>  Se recomienda que ejecute servidores API redundantes, kube-Schedulers y Kube-controller-managers.  Deben compartirse entre los hosts para minimizar los riesgos de fallas en el entorno de lanzamiento del contenedor, el sistema operativo y el hardware. <br><br>  El lanzamiento de una capa de hipervisor en hosts físicos le permitirá trabajar con componentes de programa redundantes, proporcionando administración de recursos.  También tiene la ventaja operativa del mantenimiento programado. <br><br>  <i>Opciones de implementación para dos hosts, desde el menos adecuado para la producción hasta el más</i> <br><table><tbody><tr><th>  Tipo </th><th>  Caracteristicas </th><th>  Resultado </th></tr><tr><td>  <nobr>Equipo mínimo</nobr> </td><td>  Dos hosts, sin almacenamiento redundante.  Singleton, etcd y componentes maestros en el mismo host. </td><td>  etcd: un único punto de falla, no tiene sentido ejecutar dos en otros servicios maestros.  Compartir entre dos hosts aumenta el riesgo de fallas en la capa administrada.  El beneficio potencial de aislar recursos ejecutando una capa administrada en un host y cargas de trabajo de aplicaciones en otro.  Si se pierde el almacenamiento, no hay recuperación. </td></tr><tr><td>  Mejora de redundancia de almacenamiento </td><td>  Singleton, etcd y componentes maestros en el mismo host, almacenamiento de etcd redundante. </td><td>  Como mínimo, puede recuperarse de una falla del dispositivo de almacenamiento. </td></tr><tr><td>  Redundancia de nivel gestionado </td><td>  No hay hipervisor, varias instancias de componentes de nivel administrado en pods estáticos.  etcd clúster en un host, otros componentes de nivel administrado están separados. </td><td>  Una falla de hardware, la actualización del firmware, el sistema operativo y el entorno de inicio del contenedor en un host sin etcd son menos dañinos. </td></tr><tr><td>  Agregar un hipervisor a ambos hosts </td><td>  Tres componentes redundantes de nivel administrado se ejecutan en máquinas virtuales, clúster etcd en un host, y los componentes de nivel administrado están separados.  Las cargas de trabajo de la aplicación pueden residir en ambos nodos de VM. </td><td>  Aplicación mejorada de aislamiento de carga.  Las actualizaciones del sistema operativo y el entorno de lanzamiento de contenedores son menos perjudiciales.  El mantenimiento programado de hardware / firmware se vuelve no destructivo si el hipervisor admite la migración de VM. </td></tr></tbody></table><br>  <b>Implementación en tres (o más) hosts</b> <br><br>  Transición a un servicio de producción sin concesiones.  Recomendamos dividir etcd entre los tres hosts.  Una falla de hardware reducirá la cantidad de posibles cargas de trabajo de la aplicación, pero no dará como resultado una interrupción completa del servicio. <br><br>  Los grupos muy grandes requerirán más instancias. <br><br>  El lanzamiento de una capa de hipervisor proporciona beneficios operativos y un aislamiento mejorado de las cargas de trabajo de la aplicación.  Esto está más allá del alcance del artículo, pero a nivel de tres o más hosts, pueden estar disponibles funciones mejoradas (almacenamiento compartido redundante en clúster, administración de recursos con un equilibrador de carga dinámico, monitoreo de estado automatizado con migración en vivo y conmutación por error). <br><br>  <i>Opciones de implementación para tres (o más) hosts desde el menos adecuado para la producción hasta el más</i> <br><table><tbody><tr><th>  Tipo </th><th>  Caracteristicas </th><th>  Resultado </th></tr><tr><td>  <nobr>Mínimo</nobr> </td><td>  Tres anfitriones  Instancia, etcd en cada nodo.  Componentes maestros en cada nodo. </td><td>  La pérdida de un nodo reduce el rendimiento, pero no conduce a una caída en Kubernetes.  La posibilidad de recuperación permanece. </td></tr><tr><td>  Agregar un hipervisor a los hosts </td><td>  En máquinas virtuales en tres hosts, etc., se está ejecutando un servidor API, programadores y un administrador de controladores.  Las cargas de trabajo se ejecutan en la VM en cada host. </td><td>  Protección adicional contra errores del sistema operativo / contenedor / entorno de lanzamiento de software y errores humanos.  Beneficios operacionales de instalación, actualización, gestión de recursos, monitoreo y seguridad. </td></tr></tbody></table><br>  <b>Configurar Kubernetes</b> <br><br>  Los nodos maestro y trabajador deben estar protegidos contra sobrecarga y agotamiento de recursos.  Las funciones de hipervisor se pueden usar para aislar componentes críticos y reservar recursos.  También hay ajustes de configuración de Kubernetes que pueden ralentizar cosas como la velocidad de las llamadas API.  Algunos kits de instalación y distribuciones comerciales se encargan de esto, pero si está implementando Kubernetes usted mismo, la configuración predeterminada puede no ser adecuada, especialmente para recursos pequeños o para un clúster que es demasiado grande. <br><br>  El consumo de recursos de nivel administrado se correlaciona con el número de hogares y la tasa de salida de hogares.  Los clústeres muy grandes y muy pequeños se beneficiarán de la solicitud de kube-apiserver modificada y la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">configuración de</a> desaceleración de memoria. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El nodo</a> asignable debe configurarse en los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nodos de trabajo en</a> función de la densidad de carga admitida razonable para cada nodo.  Se pueden crear espacios de nombres para dividir un grupo de nodos de trabajo en varios grupos virtuales con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cuotas</a> para CPU y memoria. <br><br>  <b>Seguridad</b> <br><br>  Cada clúster de Kubernetes tiene una entidad emisora ​​de certificados (CA) raíz.  Se deben generar e instalar los certificados Controller Manager, API Server, Scheduler, kubelet client, kube-proxy y administrador.  Si usa una herramienta de instalación o distribución, es posible que no tenga que lidiar con eso usted mismo.  El proceso manual se describe <a href="">aquí</a> .  Debe estar preparado para reinstalar certificados si expande o reemplaza los nodos. <br><br>  Dado que Kubernetes está totalmente administrado por la API, es imprescindible controlar y limitar la lista de quienes tienen acceso al clúster.  Las opciones de cifrado y autenticación se analizan en esta documentación. <br><br>  Las cargas de trabajo de la aplicación Kubernetes se basan en imágenes de contenedor.  Necesita que la fuente y el contenido de estas imágenes sean confiables.  Casi siempre, esto significa que alojará la imagen del contenedor en el repositorio local.  El uso de imágenes de Internet público puede causar problemas de confiabilidad y seguridad.  Debe seleccionar un repositorio que tenga soporte para firmar la imagen, escanear la seguridad, controlar el acceso para enviar y descargar imágenes, y registrar la actividad. <br><br>  Los procesos deben configurarse para admitir el uso de host, hipervisor, OS6, Kubernetes y otras actualizaciones de firmware de dependencia.  La supervisión de la versión es necesaria para respaldar la auditoría. <br><br>  Recomendaciones: <br><br><ul><li>  Fortalecer la configuración de seguridad predeterminada para componentes de nivel administrado (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bloqueo de nodos de trabajo</a> ); </li><li>  Use <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la política de seguridad del hogar</a> ; </li><li>  Piense en la integración de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NetworkPolicy</a> disponible para su solución de red, incluido el seguimiento, la supervisión y la resolución de problemas; </li><li>  Use RBAC para tomar decisiones de autorización; </li><li>  Piense en la seguridad física, especialmente cuando se implementa en ubicaciones periféricas o remotas que podrían pasarse por alto.  Agregue cifrado de almacenamiento para limitar las consecuencias del robo del dispositivo y protección contra la conexión de dispositivos maliciosos, como llaves USB; </li><li>  Proteja las credenciales de texto del proveedor de la nube (claves de acceso, tokens, contraseñas, etc.). </li></ul><br>  Los objetos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">secretos de</a> Kubernetes son adecuados para almacenar pequeñas cantidades de datos confidenciales.  Se almacenan en etcd.  Se pueden usar de forma segura para almacenar credenciales de la API de Kubernetes, pero hay momentos en que una carga de trabajo o la expansión del clúster en sí requiere una solución más completa.  El proyecto HashiCorp Vault es una solución popular si necesita más de lo que los objetos secretos integrados pueden proporcionar. <br><br>  <b>Recuperación ante desastres y respaldo</b> <br><br><img src="https://habrastorage.org/webt/gv/xp/kd/gvxpkd1qgpap0wosdhv-r4uu-9s.png"><br><br>  La implementación de redundancia mediante el uso de múltiples hosts y máquinas virtuales ayuda a reducir la cantidad de ciertos tipos de fallas.  Pero escenarios como un desastre natural, una mala actualización, un ataque de piratas informáticos, errores de software o un error humano aún pueden provocar bloqueos. <br><br>  Una parte crítica de una implementación de producción es la expectativa de una recuperación futura. <br><br>  También vale la pena señalar que parte de su inversión en diseño, documentación y automatización del proceso de recuperación puede reutilizarse si necesita implementaciones replicadas a gran escala en varios sitios. <br><br>  Entre los elementos de recuperación ante desastres, cabe destacar las copias de seguridad (y posiblemente las réplicas), los reemplazos, el proceso planificado, las personas que realizarán este proceso y la capacitación regular.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los</a> ejercicios y principios de prueba frecuentes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Chaos Engineering</a> se pueden usar para evaluar su preparación. <br><br>  Debido a los requisitos de disponibilidad, es posible que deba almacenar copias locales del sistema operativo, los componentes de Kubernetes y las imágenes del contenedor para permitir la recuperación, incluso si Internet falla.  La capacidad de implementar hosts y nodos de reemplazo en una situación de "aislamiento físico" mejora la seguridad y aumenta la velocidad de implementación. <br><br>  Todos los objetos de Kubernetes se almacenan en etcd.  La copia de seguridad periódica de datos de clúster etcd es un elemento importante en la restauración de clústeres de Kubernetes durante situaciones de emergencia, por ejemplo, cuando se pierden todos los nodos maestros. <br><br>   etcd       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  etcd           .      Kubernetes    .   ,     Kubernetes. <br><br>   ,    Kubernetes      etcd ,      -  .     ,         . <br><br>       etcd. ,  ,    ,   ,     /.       ,        .           : <br><br><ul><li>    : CA, API Server, Apiserver-kubelet-client,  ServiceAccount, “Front proxy”,  Front proxy; </li><li>   DNS; </li><li>    IP/; </li><li>   ; </li><li>  kubeconfig; </li><li> LDAP    ; </li><li>      . </li></ul><br> <b>   </b> <br><br> Anti-affinity           .      ,    .  ,  Kubernetes         ,          .     ,              ,    -   . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">    </a>          ,  . <br><br>   stateful-,    —   Kubernetes    (,   SQL  ). ,   ,  Kubernetes,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">roadmap feature request</a> , ,  ,    Container Storage Interface (CSI).  ,       - ,    ,      . ,      Kubernetes      ,          ,    ,    Kubernetes . <br><br>  stateful- (, Cassandra)        ,    ,    .      - Kubernetes (    -)      . <br><br> <b> </b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> (    )    ,      ,        .     ,      , . <br><br>        ,    (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ansible</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BOSH</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Chef</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Juju</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">kubeadm</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Puppet</a>  .).        ,          . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> , ,          , ,          ,  ,        .       ,  Git,      . <br><br> <b></b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> ,     ,       —   .     2   ,  —   .          —         ,    . <br><br> <b> </b> <br><br><img src="https://habrastorage.org/webt/a5/m-/gx/a5m-gxsrhmwpyxxwmcfsnfc8umm.png"><br><br>       —    .          - ,    Airbus A320 —  .   ,      .    ,   . <br><br>   ,       .   , ,    ,   . Kubernetes     ,    - ,     ,       (, FedEx, Amazon). <br><br>   production-grade  Kubernetes       .               .   , ,     ,    ,     .  ,    (,   Kubernetes   <a href="">self-hosting</a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, no hogares estáticos). </font><font style="vertical-align: inherit;">Quizás deberían discutirse en los siguientes artículos, si hay suficiente interés. </font><font style="vertical-align: inherit;">Además, debido a la alta velocidad de la mejora de Kubernetes, si su motor de búsqueda encontró este artículo después de 2019, algunos de sus materiales podrían estar muy desactualizados.</font></font><br><br>  El fin <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como siempre, estamos esperando sus preguntas y comentarios aquí, y puede ir </font><font style="vertical-align: inherit;">a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la jornada de puertas abiertas de </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander Titov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422179/">https://habr.com/ru/post/es422179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422169/index.html">¿Qué hizo realmente el programa Ada Lovelace?</a></li>
<li><a href="../es422171/index.html">Como hice con un UPS de línea interactiva. Parte 3</a></li>
<li><a href="../es422173/index.html">El aprendizaje automático se usa cada vez más en la física de partículas.</a></li>
<li><a href="../es422175/index.html">La contaminación ambiental reduce las capacidades cognitivas humanas.</a></li>
<li><a href="../es422177/index.html">¿Por qué Arduino es tan lento y qué se puede hacer al respecto?</a></li>
<li><a href="../es422181/index.html">Cómo recopilar servicios corporativos en una plataforma en línea: la historia de MegaFon.</a></li>
<li><a href="../es422183/index.html">¿Y qué, podría ser más barato?</a></li>
<li><a href="../es422185/index.html">¿Cuánto son los datos para el entrenamiento modelo (no) similar a una muestra de prueba?</a></li>
<li><a href="../es422187/index.html">Sberseasons: como pasé este verano</a></li>
<li><a href="../es422189/index.html">La verdad sobre la implementación del portal de intranet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>