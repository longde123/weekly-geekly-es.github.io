<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö£üèæ üçù üê° De las nubes a la tierra: c√≥mo crear Kubernetes de grado de producci√≥n en cualquier entorno üõ¨ üêü üëéüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bueno para todos! Bueno, ha llegado el momento de nuestro pr√≥ximo curso Devops . Probablemente, este es uno de los cursos m√°s estables y de referencia...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>De las nubes a la tierra: c√≥mo crear Kubernetes de grado de producci√≥n en cualquier entorno</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/422179/">  Bueno para todos!  Bueno, ha llegado el momento de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nuestro</a> pr√≥ximo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">curso Devops</a> .  Probablemente, este es uno de los cursos m√°s estables y de referencia, pero al mismo tiempo el m√°s diverso en t√©rminos de estudiantes, ya que ning√∫n grupo se ha parecido nunca al otro: en uno los desarrolladores son casi completamente, luego en los siguientes ingenieros, luego administradores, y as√≠ sucesivamente.  Y esto tambi√©n significa que ha llegado el momento de obtener materiales interesantes y √∫tiles, as√≠ como reuniones en l√≠nea. <br><br><img src="https://habrastorage.org/webt/v-/xe/oi/v-xeoia0xxkvb6vuzmclcvknrys.png" alt="imagen"><a name="habracut"></a><br><br>  Este art√≠culo contiene recomendaciones sobre el lanzamiento de un cl√∫ster de Kubernetes de calidad de producci√≥n en un centro de datos local o ubicaci√≥n perif√©rica (ubicaci√≥n de borde). <br>  ¬øQu√© significa el grado de producci√≥n? <br><br><ul><li>  Instalaci√≥n segura </li><li>  La gesti√≥n de implementaci√≥n se realiza mediante un proceso repetitivo y registrado; </li><li>  El trabajo es predecible y consistente; </li><li>  Es seguro llevar a cabo actualizaciones y ajustes; </li><li>  Para detectar y diagnosticar errores y falta de recursos, hay registro y monitoreo; </li><li>  El servicio tiene suficiente "alta disponibilidad" teniendo en cuenta los recursos disponibles, incluidas las restricciones de dinero, espacio f√≠sico, energ√≠a, etc. </li><li>  El proceso de recuperaci√≥n est√° disponible, documentado y probado para su uso en caso de falla. </li></ul><br>  En resumen, el grado de producci√≥n significa anticipar errores y preparar la recuperaci√≥n con un m√≠nimo de problemas y demoras. <br><br><img src="https://habrastorage.org/webt/ji/b8/je/jib8jeiekbsaflpgjsteescumgg.png"><br><br>  Este art√≠culo trata sobre la implementaci√≥n en el sitio de Kubernetes en un hipervisor o una plataforma b√°sica, dada la cantidad limitada de recursos de soporte en comparaci√≥n con el aumento de las principales nubes p√∫blicas.  Sin embargo, algunas de estas recomendaciones pueden ser √∫tiles para la nube p√∫blica si el presupuesto limita los recursos seleccionados. <br><br>  La implementaci√≥n de un Minikube de metal desnudo de un solo metal puede ser un proceso simple y econ√≥mico, pero no es de grado de producci√≥n.  Por el contrario, no podr√° alcanzar el nivel de Google con Borg en una tienda, sucursal o ubicaci√≥n perif√©rica fuera de l√≠nea, aunque es poco probable que lo necesite. <br><br>  Este art√≠culo describe consejos para lograr una implementaci√≥n de Kubernetes a nivel de producci√≥n, incluso en situaciones de recursos limitados. <br><br>  <b>Componentes importantes en el cl√∫ster de Kubernetes</b> <br><br>  Antes de profundizar en los detalles, es importante comprender la arquitectura general de Kubernetes. <br>  El cl√∫ster de Kubernetes es un sistema altamente distribuido basado en el plano de control y la arquitectura de los nodos de trabajo agrupados, como se muestra a continuaci√≥n: <br><br><img src="https://habrastorage.org/webt/_9/zu/xd/_9zuxdnulbsg6axshrcnxah2x_o.png"><br><br>  Por lo general, los componentes del Servidor API, Controller Manager y Scheduler est√°n ubicados en varias instancias de nodos de nivel de control (llamados Master).  Los nodos maestros tambi√©n suelen incluir etcd, sin embargo, hay scripts grandes y muy accesibles que requieren ejecutar etcd en hosts independientes.  Los componentes se pueden ejecutar como contenedores y, opcionalmente, bajo la supervisi√≥n de Kubernetes, es decir, funcionan como hogares est√°ticos. <br><br>  Las instancias redundantes de estos componentes se utilizan para alta disponibilidad.  La importancia y el nivel requerido de redundancia pueden variar. <br><table><tbody><tr><th>  <nobr>Componente</nobr> </th><th>  Roles </th><th>  Consecuencias de la p√©rdida. </th><th>  Instancias recomendadas </th></tr><tr><td>  etcd </td><td>  Mantiene el estado de todos los objetos de Kubernetes. </td><td>  P√©rdida catastr√≥fica de almacenamiento.  P√©rdida de la mayor√≠a = Kubernetes pierde el nivel de control, el Servidor API depende de etcd, las llamadas API de solo lectura que no necesitan un qu√≥rum, como las cargas de trabajo ya creadas, pueden continuar funcionando. </td><td>  n√∫mero impar, 3+ </td></tr><tr><td>  Servidor API </td><td>  Proporciona API para uso externo e interno. </td><td>  No se puede detener, iniciar, actualizar nuevos pods.  Scheduler y Controller Manager dependen del servidor API.  Las cargas contin√∫an si no dependen de llamadas API (operadores, controladores personalizados, CRD, etc.) </td><td>  2+ </td></tr><tr><td>  Kube-Scheduler </td><td>  Coloca vainas en nodos </td><td>  Las vainas no se pueden colocar, priorizar o mover entre ellas. </td><td>  2+ </td></tr><tr><td>  gestor-controlador-kube </td><td>  Controla muchos controladores </td><td>  Los principales circuitos de control responsables del estado dejan de funcionar.  La integraci√≥n en el √°rbol del proveedor de la nube se rompe. </td><td>  2+ </td></tr><tr><td>  administrador-controlador-nube (CCM) </td><td>  Integraci√≥n de proveedor de nube fuera del √°rbol </td><td>  Se rompe la integraci√≥n del proveedor de la nube </td><td>  1 </td></tr><tr><td>  Adiciones (por ejemplo, DNS) </td><td>  Diferente </td><td>  Diferente </td><td>  Depende del complemento (por ejemplo, 2+ para DNS) </td></tr></tbody></table><br>  Los riesgos de estos componentes incluyen fallas de hardware, errores de software, malas actualizaciones, errores humanos, interrupciones de la red y sobrecarga del sistema que resultan en el agotamiento de los recursos.  La redundancia puede reducir el impacto de estos peligros.  Adem√°s, gracias a las caracter√≠sticas de la plataforma de hipervisor (planificaci√≥n de recursos, alta disponibilidad), puede multiplicar los resultados utilizando el sistema operativo Linux, Kubernetes y el tiempo de ejecuci√≥n del contenedor. <br><br>  El servidor API utiliza varias instancias de equilibrador de carga para lograr escalabilidad y disponibilidad.  Un equilibrador de carga es un componente esencial para la alta disponibilidad.  Varios registros A del servidor API de DNS pueden servir como alternativa en ausencia de un equilibrador. <br><br>  Kube-Scheduler y Kube-controller-manager est√°n involucrados en el proceso de selecci√≥n de un l√≠der en lugar de utilizar un equilibrador de carga.  Dado que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cloud-controller-manager se</a> usa para ciertos tipos de infraestructura de alojamiento, cuya implementaci√≥n puede variar, no los discutiremos, solo indicamos que son un componente del nivel de administraci√≥n. <br><br>  Las vainas que se ejecutan en Kubernetes son administradas por el agente kubelet.  Cada instancia del trabajador ejecuta un agente de kubelet y un entorno de inicio de contenedor compatible con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CRI</a> .  Kubernetes est√° dise√±ado para monitorear y recuperarse de fallas de nodo de trabajo.  Pero para funciones de carga cr√≠ticas, gesti√≥n de recursos de hipervisor y aislamiento de carga, se puede utilizar para mejorar la accesibilidad y aumentar la previsibilidad de su trabajo. <br><br>  <b>etcd</b> <br><br>  etcd es un almacenamiento persistente para todos los objetos de Kubernetes.  La disponibilidad y la capacidad de recuperaci√≥n del cl√∫ster etcd deben ser una prioridad m√°xima al implementar Kubernetes de grado de producci√≥n. <br><br>  El cl√∫ster etcd que consta de cinco nodos es la mejor opci√≥n si puede permitirlo.  Por qu√©  Porque puede dar servicio a uno y, al mismo tiempo, soportar fallas.  Un grupo de tres nodos es lo m√≠nimo que podemos recomendar para un servicio de calidad de producci√≥n, incluso si solo hay un hipervisor de host disponible.  Tampoco se recomiendan m√°s de siete nodos, con la excepci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">instalaciones muy grandes que</a> cubren varias zonas de acceso. <br><br>  Las recomendaciones m√≠nimas para alojar un nodo de cl√∫ster etcd son 2 GB de RAM y un disco duro SSD de 8 GB.  Por lo general, 8 GB de RAM y 20 GB de espacio en el disco duro son suficientes.  El rendimiento del disco afecta el tiempo de recuperaci√≥n de un nodo despu√©s de una falla.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Echa</a> un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vistazo</a> para m√°s detalles. <br><br>  <i>En casos especiales, piense en varios grupos de etcd</i> <br><br>  Para los grupos de Kubernetes muy grandes, considere usar un grupo de etcd separado para los eventos de Kubernetes, de modo que demasiados eventos no afecten al servicio de API de Kubernetes.  Cuando se usa la red Flannel, la configuraci√≥n se guarda en etcd, y los requisitos de versi√≥n pueden diferir de Kubernetes.  Esto puede complicar la copia de seguridad de etcd, por lo que recomendamos usar un cl√∫ster de etcd separado espec√≠ficamente para franela. <br><br>  <b>Implementaci√≥n de host √∫nico</b> <br><br>  La lista de riesgos de accesibilidad incluye hardware, software y el factor humano.  Si est√° limitado a un solo host, el uso de almacenamiento redundante, memoria de correcci√≥n de errores y una fuente de alimentaci√≥n dual puede mejorar la protecci√≥n contra fallas de hardware.  La ejecuci√≥n de un hipervisor en un host f√≠sico le permite usar componentes de software redundantes y agrega beneficios operativos asociados con la implementaci√≥n, actualizaci√≥n y monitoreo del uso de recursos.  Incluso en situaciones estresantes, el comportamiento sigue siendo repetible y predecible.  Por ejemplo, incluso si solo puede permitir el lanzamiento de singletones desde los servicios maestros, deben protegerse contra la sobrecarga y el agotamiento de los recursos, compitiendo con la carga de trabajo de su aplicaci√≥n.  Un hipervisor puede ser m√°s eficiente y m√°s f√°cil de usar que la priorizaci√≥n en el planificador de Linux, cgroups, banderas de Kubernetes, etc. <br><br>  Puede implementar tres m√°quinas virtuales etcd si los recursos del host lo permiten.  Cada VM debe ser compatible con un dispositivo de almacenamiento f√≠sico separado o usar partes separadas del almacenamiento utilizando redundancia (Mirroring, RAID, etc.). <br>  Las instancias dobles redundantes de la API del servidor, el planificador y el administrador del controlador son la pr√≥xima actualizaci√≥n si su √∫nico host tiene suficientes recursos para esto. <br><br>  <i>Opciones de implementaci√≥n de host √∫nico, desde la menos adecuada para la producci√≥n hasta la mayor√≠a</i> <br><table><tbody><tr><th>  Tipo </th><th>  Caracteristicas </th><th>  Resultado </th></tr><tr><td>  <nobr>Equipo m√≠nimo</nobr> </td><td>  Singleton, etcd y componentes maestros. </td><td>  Laboratorio casero, en absoluto grado de producci√≥n.  Punto √∫nico de falla m√∫ltiple (SPOF).  La recuperaci√≥n es lenta, y cuando se pierde el almacenamiento, est√° completamente ausente. </td></tr><tr><td>  Mejora de redundancia de almacenamiento </td><td>  etcd singleton y componentes maestros, el almacenamiento de etcd es redundante. </td><td>  Como m√≠nimo, puede recuperarse de una falla del dispositivo de almacenamiento. </td></tr><tr><td>  Redundancia de nivel gestionado </td><td>  No hay hipervisor, varias instancias de componentes de nivel administrado en pods est√°ticos. </td><td>  Ha aparecido protecci√≥n contra errores de software, pero el sistema operativo y el entorno de lanzamiento del contenedor siguen siendo el mismo punto de falla con actualizaciones devastadoras. </td></tr><tr><td>  Agregar un hipervisor </td><td>  Ejecutando tres instancias redundantes de nivel administrado en la VM. </td><td>  Existe protecci√≥n contra errores de software y errores humanos y una ventaja operativa en instalaci√≥n, gesti√≥n de recursos, monitoreo y seguridad.  Las actualizaciones del sistema operativo y los entornos de lanzamiento de contenedores son menos perjudiciales.  El hipervisor es el √∫nico punto √∫nico de falla. </td></tr></tbody></table><br>  <b>Implementaci√≥n de doble host</b> <br><br>  Con dos hosts, los problemas de almacenamiento de etcd son similares a la opci√≥n de host √∫nico: necesita redundancia.  Es preferible ejecutar tres instancias encd.  Puede parecer poco intuitivo, pero es mejor concentrar todos los nodos etcd en un host.  No aumentar√° la confiabilidad al dividirlos entre 2 + 1 entre dos hosts: la p√©rdida de un nodo con la mayor√≠a de las instancias de cifrado provocar√° un error, independientemente de si es una mayor√≠a de 2 o 3. Si los hosts no son iguales, coloque todo el cl√∫ster etcd en el m√°s confiable. <br><br>  Se recomienda que ejecute servidores API redundantes, kube-Schedulers y Kube-controller-managers.  Deben compartirse entre los hosts para minimizar los riesgos de fallas en el entorno de lanzamiento del contenedor, el sistema operativo y el hardware. <br><br>  El lanzamiento de una capa de hipervisor en hosts f√≠sicos le permitir√° trabajar con componentes de programa redundantes, proporcionando administraci√≥n de recursos.  Tambi√©n tiene la ventaja operativa del mantenimiento programado. <br><br>  <i>Opciones de implementaci√≥n para dos hosts, desde el menos adecuado para la producci√≥n hasta el m√°s</i> <br><table><tbody><tr><th>  Tipo </th><th>  Caracteristicas </th><th>  Resultado </th></tr><tr><td>  <nobr>Equipo m√≠nimo</nobr> </td><td>  Dos hosts, sin almacenamiento redundante.  Singleton, etcd y componentes maestros en el mismo host. </td><td>  etcd: un √∫nico punto de falla, no tiene sentido ejecutar dos en otros servicios maestros.  Compartir entre dos hosts aumenta el riesgo de fallas en la capa administrada.  El beneficio potencial de aislar recursos ejecutando una capa administrada en un host y cargas de trabajo de aplicaciones en otro.  Si se pierde el almacenamiento, no hay recuperaci√≥n. </td></tr><tr><td>  Mejora de redundancia de almacenamiento </td><td>  Singleton, etcd y componentes maestros en el mismo host, almacenamiento de etcd redundante. </td><td>  Como m√≠nimo, puede recuperarse de una falla del dispositivo de almacenamiento. </td></tr><tr><td>  Redundancia de nivel gestionado </td><td>  No hay hipervisor, varias instancias de componentes de nivel administrado en pods est√°ticos.  etcd cl√∫ster en un host, otros componentes de nivel administrado est√°n separados. </td><td>  Una falla de hardware, la actualizaci√≥n del firmware, el sistema operativo y el entorno de inicio del contenedor en un host sin etcd son menos da√±inos. </td></tr><tr><td>  Agregar un hipervisor a ambos hosts </td><td>  Tres componentes redundantes de nivel administrado se ejecutan en m√°quinas virtuales, cl√∫ster etcd en un host, y los componentes de nivel administrado est√°n separados.  Las cargas de trabajo de la aplicaci√≥n pueden residir en ambos nodos de VM. </td><td>  Aplicaci√≥n mejorada de aislamiento de carga.  Las actualizaciones del sistema operativo y el entorno de lanzamiento de contenedores son menos perjudiciales.  El mantenimiento programado de hardware / firmware se vuelve no destructivo si el hipervisor admite la migraci√≥n de VM. </td></tr></tbody></table><br>  <b>Implementaci√≥n en tres (o m√°s) hosts</b> <br><br>  Transici√≥n a un servicio de producci√≥n sin concesiones.  Recomendamos dividir etcd entre los tres hosts.  Una falla de hardware reducir√° la cantidad de posibles cargas de trabajo de la aplicaci√≥n, pero no dar√° como resultado una interrupci√≥n completa del servicio. <br><br>  Los grupos muy grandes requerir√°n m√°s instancias. <br><br>  El lanzamiento de una capa de hipervisor proporciona beneficios operativos y un aislamiento mejorado de las cargas de trabajo de la aplicaci√≥n.  Esto est√° m√°s all√° del alcance del art√≠culo, pero a nivel de tres o m√°s hosts, pueden estar disponibles funciones mejoradas (almacenamiento compartido redundante en cl√∫ster, administraci√≥n de recursos con un equilibrador de carga din√°mico, monitoreo de estado automatizado con migraci√≥n en vivo y conmutaci√≥n por error). <br><br>  <i>Opciones de implementaci√≥n para tres (o m√°s) hosts desde el menos adecuado para la producci√≥n hasta el m√°s</i> <br><table><tbody><tr><th>  Tipo </th><th>  Caracteristicas </th><th>  Resultado </th></tr><tr><td>  <nobr>M√≠nimo</nobr> </td><td>  Tres anfitriones  Instancia, etcd en cada nodo.  Componentes maestros en cada nodo. </td><td>  La p√©rdida de un nodo reduce el rendimiento, pero no conduce a una ca√≠da en Kubernetes.  La posibilidad de recuperaci√≥n permanece. </td></tr><tr><td>  Agregar un hipervisor a los hosts </td><td>  En m√°quinas virtuales en tres hosts, etc., se est√° ejecutando un servidor API, programadores y un administrador de controladores.  Las cargas de trabajo se ejecutan en la VM en cada host. </td><td>  Protecci√≥n adicional contra errores del sistema operativo / contenedor / entorno de lanzamiento de software y errores humanos.  Beneficios operacionales de instalaci√≥n, actualizaci√≥n, gesti√≥n de recursos, monitoreo y seguridad. </td></tr></tbody></table><br>  <b>Configurar Kubernetes</b> <br><br>  Los nodos maestro y trabajador deben estar protegidos contra sobrecarga y agotamiento de recursos.  Las funciones de hipervisor se pueden usar para aislar componentes cr√≠ticos y reservar recursos.  Tambi√©n hay ajustes de configuraci√≥n de Kubernetes que pueden ralentizar cosas como la velocidad de las llamadas API.  Algunos kits de instalaci√≥n y distribuciones comerciales se encargan de esto, pero si est√° implementando Kubernetes usted mismo, la configuraci√≥n predeterminada puede no ser adecuada, especialmente para recursos peque√±os o para un cl√∫ster que es demasiado grande. <br><br>  El consumo de recursos de nivel administrado se correlaciona con el n√∫mero de hogares y la tasa de salida de hogares.  Los cl√∫steres muy grandes y muy peque√±os se beneficiar√°n de la solicitud de kube-apiserver modificada y la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">configuraci√≥n de</a> desaceleraci√≥n de memoria. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">El nodo</a> asignable debe configurarse en los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nodos de trabajo en</a> funci√≥n de la densidad de carga admitida razonable para cada nodo.  Se pueden crear espacios de nombres para dividir un grupo de nodos de trabajo en varios grupos virtuales con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cuotas</a> para CPU y memoria. <br><br>  <b>Seguridad</b> <br><br>  Cada cl√∫ster de Kubernetes tiene una entidad emisora ‚Äã‚Äãde certificados (CA) ra√≠z.  Se deben generar e instalar los certificados Controller Manager, API Server, Scheduler, kubelet client, kube-proxy y administrador.  Si usa una herramienta de instalaci√≥n o distribuci√≥n, es posible que no tenga que lidiar con eso usted mismo.  El proceso manual se describe <a href="">aqu√≠</a> .  Debe estar preparado para reinstalar certificados si expande o reemplaza los nodos. <br><br>  Dado que Kubernetes est√° totalmente administrado por la API, es imprescindible controlar y limitar la lista de quienes tienen acceso al cl√∫ster.  Las opciones de cifrado y autenticaci√≥n se analizan en esta documentaci√≥n. <br><br>  Las cargas de trabajo de la aplicaci√≥n Kubernetes se basan en im√°genes de contenedor.  Necesita que la fuente y el contenido de estas im√°genes sean confiables.  Casi siempre, esto significa que alojar√° la imagen del contenedor en el repositorio local.  El uso de im√°genes de Internet p√∫blico puede causar problemas de confiabilidad y seguridad.  Debe seleccionar un repositorio que tenga soporte para firmar la imagen, escanear la seguridad, controlar el acceso para enviar y descargar im√°genes, y registrar la actividad. <br><br>  Los procesos deben configurarse para admitir el uso de host, hipervisor, OS6, Kubernetes y otras actualizaciones de firmware de dependencia.  La supervisi√≥n de la versi√≥n es necesaria para respaldar la auditor√≠a. <br><br>  Recomendaciones: <br><br><ul><li>  Fortalecer la configuraci√≥n de seguridad predeterminada para componentes de nivel administrado (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bloqueo de nodos de trabajo</a> ); </li><li>  Use <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la pol√≠tica de seguridad del hogar</a> ; </li><li>  Piense en la integraci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NetworkPolicy</a> disponible para su soluci√≥n de red, incluido el seguimiento, la supervisi√≥n y la resoluci√≥n de problemas; </li><li>  Use RBAC para tomar decisiones de autorizaci√≥n; </li><li>  Piense en la seguridad f√≠sica, especialmente cuando se implementa en ubicaciones perif√©ricas o remotas que podr√≠an pasarse por alto.  Agregue cifrado de almacenamiento para limitar las consecuencias del robo del dispositivo y protecci√≥n contra la conexi√≥n de dispositivos maliciosos, como llaves USB; </li><li>  Proteja las credenciales de texto del proveedor de la nube (claves de acceso, tokens, contrase√±as, etc.). </li></ul><br>  Los objetos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">secretos de</a> Kubernetes son adecuados para almacenar peque√±as cantidades de datos confidenciales.  Se almacenan en etcd.  Se pueden usar de forma segura para almacenar credenciales de la API de Kubernetes, pero hay momentos en que una carga de trabajo o la expansi√≥n del cl√∫ster en s√≠ requiere una soluci√≥n m√°s completa.  El proyecto HashiCorp Vault es una soluci√≥n popular si necesita m√°s de lo que los objetos secretos integrados pueden proporcionar. <br><br>  <b>Recuperaci√≥n ante desastres y respaldo</b> <br><br><img src="https://habrastorage.org/webt/gv/xp/kd/gvxpkd1qgpap0wosdhv-r4uu-9s.png"><br><br>  La implementaci√≥n de redundancia mediante el uso de m√∫ltiples hosts y m√°quinas virtuales ayuda a reducir la cantidad de ciertos tipos de fallas.  Pero escenarios como un desastre natural, una mala actualizaci√≥n, un ataque de piratas inform√°ticos, errores de software o un error humano a√∫n pueden provocar bloqueos. <br><br>  Una parte cr√≠tica de una implementaci√≥n de producci√≥n es la expectativa de una recuperaci√≥n futura. <br><br>  Tambi√©n vale la pena se√±alar que parte de su inversi√≥n en dise√±o, documentaci√≥n y automatizaci√≥n del proceso de recuperaci√≥n puede reutilizarse si necesita implementaciones replicadas a gran escala en varios sitios. <br><br>  Entre los elementos de recuperaci√≥n ante desastres, cabe destacar las copias de seguridad (y posiblemente las r√©plicas), los reemplazos, el proceso planificado, las personas que realizar√°n este proceso y la capacitaci√≥n regular.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los</a> ejercicios y principios de prueba frecuentes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Chaos Engineering</a> se pueden usar para evaluar su preparaci√≥n. <br><br>  Debido a los requisitos de disponibilidad, es posible que deba almacenar copias locales del sistema operativo, los componentes de Kubernetes y las im√°genes del contenedor para permitir la recuperaci√≥n, incluso si Internet falla.  La capacidad de implementar hosts y nodos de reemplazo en una situaci√≥n de "aislamiento f√≠sico" mejora la seguridad y aumenta la velocidad de implementaci√≥n. <br><br>  Todos los objetos de Kubernetes se almacenan en etcd.  La copia de seguridad peri√≥dica de datos de cl√∫ster etcd es un elemento importante en la restauraci√≥n de cl√∫steres de Kubernetes durante situaciones de emergencia, por ejemplo, cuando se pierden todos los nodos maestros. <br><br>   etcd       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  etcd           .      Kubernetes    .   ,     Kubernetes. <br><br>   ,    Kubernetes      etcd ,      -  .     ,         . <br><br>       etcd. ,  ,    ,   ,     /.       ,        .           : <br><br><ul><li>    : CA, API Server, Apiserver-kubelet-client,  ServiceAccount, ‚ÄúFront proxy‚Äù,  Front proxy; </li><li>   DNS; </li><li>    IP/; </li><li>   ; </li><li>  kubeconfig; </li><li> LDAP    ; </li><li>      . </li></ul><br> <b>   </b> <br><br> Anti-affinity           .      ,    .  ,  Kubernetes         ,          .     ,              ,    -   . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">    </a>          ,  . <br><br>   stateful-,    ‚Äî   Kubernetes    (,   SQL  ). ,   ,  Kubernetes,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">roadmap feature request</a> , ,  ,    Container Storage Interface (CSI).  ,       - ,    ,      . ,      Kubernetes      ,          ,    ,    Kubernetes . <br><br>  stateful- (, Cassandra)        ,    ,    .      - Kubernetes (    -)      . <br><br> <b> </b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> (    )    ,      ,        .     ,      , . <br><br>        ,    (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ansible</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BOSH</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Chef</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Juju</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">kubeadm</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Puppet</a>  .).        ,          . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> , ,          , ,          ,  ,        .       ,  Git,      . <br><br> <b></b> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> ,     ,       ‚Äî   .     2   ,  ‚Äî   .          ‚Äî         ,    . <br><br> <b> </b> <br><br><img src="https://habrastorage.org/webt/a5/m-/gx/a5m-gxsrhmwpyxxwmcfsnfc8umm.png"><br><br>       ‚Äî    .          - ,    Airbus A320 ‚Äî  .   ,      .    ,   . <br><br>   ,       .   , ,    ,   . Kubernetes     ,    - ,     ,       (, FedEx, Amazon). <br><br>   production-grade  Kubernetes       .               .   , ,     ,    ,     .  ,    (,   Kubernetes   <a href="">self-hosting</a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, no hogares est√°ticos). </font><font style="vertical-align: inherit;">Quiz√°s deber√≠an discutirse en los siguientes art√≠culos, si hay suficiente inter√©s. </font><font style="vertical-align: inherit;">Adem√°s, debido a la alta velocidad de la mejora de Kubernetes, si su motor de b√∫squeda encontr√≥ este art√≠culo despu√©s de 2019, algunos de sus materiales podr√≠an estar muy desactualizados.</font></font><br><br>  El fin <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como siempre, estamos esperando sus preguntas y comentarios aqu√≠, y puede ir </font><font style="vertical-align: inherit;">a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la jornada de puertas abiertas de </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander Titov</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422179/">https://habr.com/ru/post/es422179/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422169/index.html">¬øQu√© hizo realmente el programa Ada Lovelace?</a></li>
<li><a href="../es422171/index.html">Como hice con un UPS de l√≠nea interactiva. Parte 3</a></li>
<li><a href="../es422173/index.html">El aprendizaje autom√°tico se usa cada vez m√°s en la f√≠sica de part√≠culas.</a></li>
<li><a href="../es422175/index.html">La contaminaci√≥n ambiental reduce las capacidades cognitivas humanas.</a></li>
<li><a href="../es422177/index.html">¬øPor qu√© Arduino es tan lento y qu√© se puede hacer al respecto?</a></li>
<li><a href="../es422181/index.html">C√≥mo recopilar servicios corporativos en una plataforma en l√≠nea: la historia de MegaFon.</a></li>
<li><a href="../es422183/index.html">¬øY qu√©, podr√≠a ser m√°s barato?</a></li>
<li><a href="../es422185/index.html">¬øCu√°nto son los datos para el entrenamiento modelo (no) similar a una muestra de prueba?</a></li>
<li><a href="../es422187/index.html">Sberseasons: como pas√© este verano</a></li>
<li><a href="../es422189/index.html">La verdad sobre la implementaci√≥n del portal de intranet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>