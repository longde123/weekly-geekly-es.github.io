<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõéÔ∏è üîî ‚õµÔ∏è Tragen Sie mit dem Go-Critical-Parser zu Go bei üò™ ü•´ üõÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sie erinnern sich vielleicht an die k√ºrzliche Ank√ºndigung eines neuen statischen Analysators f√ºr Go namens go-kritisch . 


 Ich habe das Golang / Go-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tragen Sie mit dem Go-Critical-Parser zu Go bei</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416903/"><p><img src="https://habrastorage.org/webt/fp/k0/rn/fpk0rncwtlo5ozovjev4yi_gok8.png"></p><br><p>  Sie erinnern sich vielleicht an die k√ºrzliche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ank√ºndigung eines neuen statischen Analysators f√ºr Go</a> namens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">go-kritisch</a> . </p><br><p>  Ich habe das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Golang / Go-</a> Projekt damit √ºberpr√ºft und einige Patches gesendet, die einige dort gefundene Probleme beheben. </p><br><p>  In diesem Artikel werden wir den korrigierten Code analysieren und motiviert sein, noch mehr solcher √Ñnderungen an Go zu senden. </p><br><p>  F√ºr die Ungeduldigsten: eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aktualisierte Liste der Troph√§en</a> . </p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Gehen Sie zur Parsing-Liste</b> <div class="spoiler_text"><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">net: Kombiniere Append-Aufrufe in reverseeaddr</a> <code>appendCombine</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">cmd / link / internal / ld: Vermeiden Sie das Verschieben von Kopien in Bereichsschleifen</a> <code>rangeValCopy</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">cmd / compile / internal / ssa: Teile reparierenByVarOffset.Less-Methode</a> <code>dupSubExpr</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Laufzeit: Entfernen Sie redundante explizite Deref in trace.go</a> <code>underef</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">cmd / link / internal / sym:</a> <code>commentedOutCode</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">f√ºr ELF-F√§lle in RelocName commentOutCode</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Laufzeit: Vereinfachen Sie den Slice-Ausdruck, um den Slice-Wert selbst zu</a> <code>unslice</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">html / template: Verwenden Sie benannte consts anstelle ihrer Werte</a> <code>namedConst</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">cmd / internal / obj / arm64: Vereinfache einige</a> <code>boolExprSimplify</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ausdr√ºcke</a> <code>boolExprSimplify</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">math, net: explizites true tag expr in switch</a> <code>switchTrue</code> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">archive / tar: Redundante Parens in</a> <code>typeUnparen</code> </li></ol></div></div><br><h1 id="dupsubexpr">  dupSubExpr </h1><br><p>  Wir alle machen Fehler und oft durch Unaufmerksamkeit.  Go ist eine Sprache, in der Sie manchmal langweiligen Code und Boilerplate-Code schreiben m√ºssen. Manchmal tr√§gt dies zu Tippfehlern und / oder Fehlern beim Kopieren / Einf√ºgen bei. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL122776</a> enth√§lt eine Korrektur f√ºr einen von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dupSubExpr</a> gefundenen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Fehler</a> : </p><br><pre> <code class="diff hljs">func (a partsByVarOffset) Less(i, j int) bool { - return varOffset(a.slots[a.slotIDs[i]]) &lt; varOffset(a.slots[a.slotIDs[i]]) + return varOffset(a.slots[a.slotIDs[i]]) &lt; varOffset(a.slots[a.slotIDs[j]]) // ^__________________________________^ }</code> </pre> <br><p>  Achten Sie auf den Index links und rechts.  Vor der Korrektur waren LHS und RHS des Operators <code>&lt;</code> identisch, und <code>dupSubExpr</code> arbeitete <code>dupSubExpr</code> . </p><br><h1 id="commentedoutcode">  commentOutCode </h1><br><p>  Wenn Ihr Projekt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">von einem Versionskontrollsystem</a> gesponsert <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wird</a> , sollten Sie den Code nicht deaktivieren, indem Sie ihn in einen Kommentar einschlie√üen, sondern ihn vollst√§ndig l√∂schen.  Es gibt Ausnahmen, aber h√§ufiger st√∂rt, verwirrt und kann ein solcher "toter" Code Fehler verbergen. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">commentOutCode</a> konnte ein so interessantes Fragment finden ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL122896</a> ): </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> arch.Family { <span class="hljs-comment"><span class="hljs-comment">// ...  case clause. case sys.I386: return elf.R_386(nr).String() case sys.MIPS, sys.MIPS64: // return elf.R_MIPS(nr).String() // &lt;- 1 case sys.PPC64: // return elf.R_PPC64(nr).String() // &lt;- 2 case sys.S390X: // return elf.R_390(nr).String() // &lt;- 3 default: panic("unreachable") }</span></span></code> </pre> <br><p>  Es gibt einen etwas h√∂heren Kommentar: </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// We didn't have some relocation types at Go1.4. // Uncomment code when we include those in bootstrap code.</span></span></code> </pre> <br><p>  Wenn Sie zum Zweig <code>go1.4</code> wechseln und diese drei Zeilen aus dem Kommentar entfernen, wird der Code nicht kompiliert. Wenn Sie sie jedoch im Assistenten auskommentieren, funktioniert alles. </p><br><p>  In der Regel muss in einem Kommentar ausgeblendeter Code entweder gel√∂scht oder umgekehrt aktiviert werden. </p><br><p>  Es ist von Zeit zu Zeit n√ºtzlich, solche Echos der Vergangenheit in Ihrem Code zu besuchen. </p><br><div class="spoiler">  <b class="spoiler_title">√úber die Schwierigkeiten bei der Erkennung</b> <div class="spoiler_text"><p>  Dies ist einer meiner Lieblingsschecks, aber einer der lautesten. </p><br><p>  Viele Fehlalarme f√ºr Pakete, die <code>math/big</code> und sich im Compiler befinden.  Im ersten Fall handelt es sich normalerweise um erl√§uternde Kommentare zu den ausgef√ºhrten Operationen und im zweiten um eine Beschreibung des Codes, der das AST-Fragment beschreibt.  Es ist nicht trivial, solche Kommentare von echtem "toten" Code zu unterscheiden, ohne falsche Negative einzuf√ºhren. </p><br><p>  Daraus ergibt sich die Idee: Was ist, wenn wir uns darauf einigen, den Code in den Kommentaren irgendwie zu spezialisieren, was erkl√§rend ist?  Dann wird die statische Analyse vereinfacht.  Dies kann eine Kleinigkeit sein, die es entweder einfach macht, einen solchen erkl√§renden Kommentar zu definieren, oder ihn zu einem ung√ºltigen Go-Code macht (wenn Sie beispielsweise ein Nummernzeichen <code>#</code> am Zeilenanfang hinzuf√ºgen). </p><br><p>  Eine weitere Kategorie sind Kommentare mit expliziten <code>TODO</code> .  Wenn der Code f√ºr einen Kommentar entfernt wird, aber es eine klare Beschreibung gibt, warum dies getan wird und wann geplant ist, diesen Code zu reparieren, ist es besser, keine Warnung zu geben.  Dies wurde bereits implementiert, k√∂nnte aber zuverl√§ssiger funktionieren. </p></div></div><br><h1 id="boolexprsimplify">  boolExprSimplify </h1><br><p>  Manchmal schreiben Leute seltsamen Code.  Vielleicht scheint es mir, aber logische ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">boolesche</a> ) Ausdr√ºcke sehen manchmal besonders seltsam aus. </p><br><p>  Go hat ein exzellentes x86-Assembler-Backend (hier ist ein Riss gefallen), aber ARM hat wirklich falsch gemacht: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !(o1 != <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span> }</code> </pre> <br><p>  "Wenn nicht, ist o1 nicht gleich 0" ... Doppelte Negation ist ein Klassiker.  Wenn es Ihnen gefallen hat, lade ich Sie ein, sich mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL123377</a> vertraut zu machen.  Dort sehen Sie die korrigierte Version. </p><br><div class="spoiler">  <b class="spoiler_title">Korrigierte Option (f√ºr diejenigen, die nicht zur √úberpr√ºfung gelockt werden k√∂nnen)</b> <div class="spoiler_text"><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- if !(o1 != 0) { + if o1 == 0 {</span></span></code> </pre> </div></div><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">boolExprSimplify</a> zielt auf Vereinfachungen ab, die die Lesbarkeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">verbessern</a> (und das Go-Optimierungsprogramm h√§tte das Problem der Leistung ohne es bew√§ltigt). </p><br><h1 id="underef">  underef </h1><br><p>  Wenn Sie Go aus fr√ºheren Versionen verwenden, k√∂nnen Sie sich an die obligatorischen Semikolons, das Fehlen einer automatischen Dereferenzierung von Zeigern und andere Funktionen erinnern, die heute im neuen Code kaum mehr zu sehen sind. </p><br><p>  Im alten Code sehen Sie immer noch Folgendes: </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// -    : buf := (*bufp).ptr() // ...     : buf := bufp.ptr()</span></span></code> </pre> <br><p>  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL122895 wurden</a> mehrere Trigger des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Underef-</a> Analysators <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">behoben</a> . </p><br><h1 id="appendcombine">  appendCombine </h1><br><p>  M√∂glicherweise wissen Sie, dass das <code>append</code> mehrere Argumente als Elemente zum Hinzuf√ºgen zum Ziel-Slice verwenden kann.  In einigen Situationen k√∂nnen Sie so die Lesbarkeit des Codes geringf√ºgig verbessern. Dies kann jedoch interessanter sein und Ihr Programm beschleunigen, da der Compiler keine kompatiblen <code>append</code> Aufrufe unterdr√ºckt ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">cmd / compile: Append-Aufrufe kombinieren</a> ). </p><br><p>  In Go hat die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">appendCombine-</a> Pr√ºfung den folgenden Abschnitt gefunden: </p><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- for i := len(ip) - 1; i &gt;= 0; i-- { - v := ip[i] - buf = append(buf, hexDigit[v&amp;0xF]) - buf = append(buf, '.') - buf = append(buf, hexDigit[v&gt;&gt;4]) - buf = append(buf, '.') - } + for i := len(ip) - 1; i &gt;= 0; i-- { + v := ip[i] + buf = append(buf, hexDigit[v&amp;0xF], + '.', + hexDigit[v&gt;&gt;4], + '.') + }</span></span></code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op delta ReverseAddress<span class="hljs-number"><span class="hljs-number">-8</span></span> <span class="hljs-number"><span class="hljs-number">4.10</span></span>¬µs ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>% <span class="hljs-number"><span class="hljs-number">3.94</span></span>¬µs ¬± <span class="hljs-number"><span class="hljs-number">1</span></span>% <span class="hljs-number"><span class="hljs-number">-3.81</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">10</span></span>+<span class="hljs-number"><span class="hljs-number">9</span></span>)</code> </pre> <br><p>  Details in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL117615</a> . </p><br><h1 id="rangevalcopy">  rangeValCopy </h1><br><p>  Es ist kein Geheimnis, dass die in einer <code>range</code> iterierten Werte kopiert werden.  Bei kleinen Objekten, beispielsweise weniger als 64 Byte, bemerken Sie dies m√∂glicherweise nicht einmal.  Wenn ein solcher Zyklus jedoch auf einem ‚Äûhei√üen‚Äú Pfad liegt oder, √ºber den Sie iterieren, eine sehr gro√üe Anzahl von Elementen enth√§lt, kann der Overhead sp√ºrbar sein. </p><br><p>  Go hat einen ziemlich langsamen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Linker</a> (cmd / link), und ohne wesentliche √Ñnderungen in seiner Architektur kann kein starker Leistungsgewinn erzielt werden.  Aber dann k√∂nnen Sie die Ineffizienz mithilfe von Mikrooptimierungen leicht reduzieren.  Jedes oder zwei Prozent z√§hlt. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bei der</a> √úberpr√ºfung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">rangeValCopy</a> wurden mehrere Zyklen mit gleichzeitigem Kopieren unerw√ºnschter Daten festgestellt.  Hier sind die interessantesten von ihnen: </p><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- for _, r := range exports.R { - d.mark(r.Sym, nil) - } + for i := range exports.R { + d.mark(exports.R[i].Sym, nil) + }</span></span></code> </pre> <br><p>  Anstatt <code>R[i]</code> bei jeder Iteration <code>R[i]</code> zu kopieren, wenden wir uns nur an das einzige f√ºr uns interessante Mitglied, <code>Sym</code> . </p><br><pre> <code class="hljs pgsql"><span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-built_in"><span class="hljs-built_in">old</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-type"><span class="hljs-type">time</span></span>/op delta Linker<span class="hljs-number"><span class="hljs-number">-4</span></span> <span class="hljs-number"><span class="hljs-number">530</span></span>ms ¬± <span class="hljs-number"><span class="hljs-number">2</span></span>% <span class="hljs-number"><span class="hljs-number">521</span></span>ms ¬± <span class="hljs-number"><span class="hljs-number">3</span></span>% <span class="hljs-number"><span class="hljs-number">-1.80</span></span>% (p=<span class="hljs-number"><span class="hljs-number">0.000</span></span> n=<span class="hljs-number"><span class="hljs-number">17</span></span>+<span class="hljs-number"><span class="hljs-number">20</span></span>)</code> </pre> <br><p>  Die Vollversion des Patches ist verf√ºgbar unter: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL113636</a> . </p><br><h1 id="namedconst">  namedConst </h1><br><p>  In Go sind benannte Konstanten, die sogar zu Gruppen zusammengefasst sind, leider nicht miteinander verbunden und bilden keine Aufz√§hlung ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vorschlag: spec: Unterst√ºtzung f√ºr typisierte Aufz√§hlungen hinzuf√ºgen</a> ). </p><br><p>  Ein Problem besteht darin, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">untypisierte Konstanten</a> in den Typ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">umzuwandeln</a> , den Sie als Aufz√§hlung verwenden m√∂chten. </p><br><p>  Angenommen, Sie definieren einen <code>const ColDefault Color = 0</code> Wert <code>const ColDefault Color = 0</code> . <br>  Welches dieser beiden Codefragmente gef√§llt Ihnen besser? </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// (A) if color == 0 { return colorBlack } // (B) if color == colorDefault { return colorBlack }</span></span></code> </pre> <br><p>  Wenn Ihnen <code>(B)</code> angemessener erscheint, k√∂nnen Sie durch √úberpr√ºfen von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">namedConst</a> die Verwendung benannter Konstantenwerte verfolgen und die benannte Konstante selbst umgehen. </p><br><p>  So wurde die <a href=""><code>context.mangle</code></a> Methode aus dem <code>html/template</code> Paket transformiert: </p><br><pre> <code class="diff hljs"> s := templateName + "$htmltemplate_" + c.state.String() - if c.delim != 0 { + if c.delim != delimNone { s += "_" + c.delim.String() } - if c.urlPart != 0 { + if c.urlPart != urlPartNone { s += "_" + c.urlPart.String() } - if c.jsCtx != 0 { + if c.jsCtx != jsCtxRegexp { s += "_" + c.jsCtx.String() } - if c.attr != 0 { + if c.attr != attrNone { s += "_" + c.attr.String() } - if c.element != 0 { + if c.element != elementNone { s += "_" + c.element.String() } return s</code> </pre> <br><p>  √úbrigens finden Sie manchmal auf den Links zu den Patches interessante Diskussionen ... <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL123376</a> ist ein solcher Fall. </p><br><h1 id="unslice">  unslice </h1><br><p>  Ein Merkmal des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Slice-Ausdrucks</a> ist, dass <code>x[:]</code> immer mit <code>x</code> identisch ist, wenn Typ <code>x</code> ein Slice oder eine Zeichenfolge ist.  Im Fall von Slices funktioniert dies f√ºr jede Art von <code>[]T</code> Element. </p><br><p>  Alles in der Liste unten ist das gleiche ( <code>x</code> - Slice): </p><br><ul><li> <code>x</code> </li> <li> <code>x[:]</code> </li> <li> <code>x[:][:]</code> </li> <li>  ... </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unslice</a> findet √§hnliche redundante Slice-Ausdr√ºcke.  Diese Ausdr√ºcke sind vor allem mit einer zus√§tzlichen kognitiven Belastung sch√§dlich.  <code>x[:]</code> hat eine ziemlich bedeutende Semantik, wenn ein Slice aus dem Array genommen wird.  Ein Slice-Slice mit Standardbereichen bewirkt nichts anderes als Rauschen. </p><br><p>  Ich bitte um einen Patch in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL123375</a> . </p><br><h1 id="switchtrue">  switchTrue </h1><br><p>  In <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL123378</a> wird " <code>switch true {...}</code> " durch " <code>switch {...}</code> " ersetzt. <br>  Beide Formen sind gleichwertig, aber die zweite ist idiomatischer. <br>  Gefunden durch √úberpr√ºfen von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">switchTrue</a> . </p><br><p>  Die meisten Stilpr√ºfungen zeigen genau solche F√§lle, in denen beide Optionen akzeptabel sind, aber eine davon ist h√§ufiger und mehr Go-Programmierern bekannt.  N√§chster Check aus derselben Serie. </p><br><h1 id="typeunparen">  typeUnparen </h1><br><p>  Go liebt, wie viele andere Programmiersprachen, Klammern.  So sehr, dass ich bereit bin, eine beliebige Anzahl von ihnen zu akzeptieren: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ( t0 <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t1 (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) t2 ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)) <span class="hljs-comment"><span class="hljs-comment">// ... ,  . )</span></span></code> </pre> <br><p>  Aber was passiert, wenn Sie <code>gofmt</code> ? </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> ( t0 <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> t1 (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;- !   . t2 (int) // &lt;-    ... )</span></span></code> </pre> <br><p>  Deshalb gibt es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">typeUnparen</a> .  Er findet im Programm alle Typausdr√ºcke, in denen Sie die Anzahl der Klammern reduzieren k√∂nnen.  Ich habe versucht, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CL123379</a> zu senden. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mal</a> sehen, wie die Community dies akzeptiert. </p><br><div class="spoiler">  <b class="spoiler_title">Lisp mag keine Zahnspangen</b> <div class="spoiler_text"><p>  Im Gegensatz zu C-√§hnlichen Sprachen ist es in Lisp nicht so einfach, an keiner Stelle nutzlose Klammern einzuf√ºgen.  In Sprachen, deren Syntax auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">S-Ausdr√ºcken</a> basiert, ist es schwieriger als in einigen anderen Sprachen, ein Programm zu schreiben, das nur eine gro√üe Anzahl von Klammern enth√§lt. </p></div></div><br><h1 id="go-critic-na-sluzhbe-go">  Go-Kritiker unterwegs </h1><br><p> <a href="" title="Klicken Sie zum Vergr√∂√üern"><img src="https://habrastorage.org/webt/bq/0a/ig/bq0aigrftmrocldewkgzuhiycdo.jpeg"></a> </p><br><p>  Wir haben nur einen kleinen Teil der durchgef√ºhrten Kontrollen untersucht.  Gleichzeitig werden sich Quantit√§t und Qualit√§t erst im Laufe der Zeit weiterentwickeln, auch dank der Menschen, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sich der Entwicklung angeschlossen haben</a> . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">go-kritisch ist</a> f√ºr jede Nutzung absolut kostenlos ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MIT-Lizenz</a> ) und auch offen f√ºr Ihre Teilnahme an der Entwicklung des Projekts.  Senden Sie uns Ideen f√ºr √úberpr√ºfungen, Sie k√∂nnen sofort mit der Implementierung, gemeldete Fehler und M√§ngel melden, Ihre Eindr√ºcke teilen.  Sie k√∂nnen auch Projekte zur Pr√ºfung vorschlagen oder √ºber Ihre Go-Code-√úberpr√ºfung berichten. Diese Erfahrung ist f√ºr uns von unsch√§tzbarem Wert. </p><br><h2 id="tema-kontribyutinga-v-go">  Gehen Sie zum beitragenden Thema </h2><br><p>  Haben Sie den Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Go Contribution Workshop in Russland gesehen</a> ?  Dieser Herbst wird die zweite Runde sein.  Und dieses Mal werden wir neben einem erfolgreicheren Format und Sponsoren eine Geheimwaffe haben - einen wunderbaren statischen Analysator.  Es wird √ºberhaupt genug Beitr√§ge geben! </p><br><p>  Tats√§chlich k√∂nnen Sie jetzt beginnen (obwohl es besser ist - etwas sp√§ter, nach dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einfrieren des Codes</a> ).  Wenn Sie es schaffen, sich vor dem n√§chsten Workshop wohl zu f√ºhlen, wird es sehr cool, weil wir in Russland sehr wenig Mentoren haben. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de416903/">https://habr.com/ru/post/de416903/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de416891/index.html">In den USA durften sie weiterhin 3D-Modelle und digitale Zeichnungen f√ºr DIY-Waffen vertreiben.</a></li>
<li><a href="../de416893/index.html">Vaadin Flow - ein seltsamer Hirsch</a></li>
<li><a href="../de416897/index.html">So erstellen Sie ein Do-it-yourself-Zahlungssystem</a></li>
<li><a href="../de416899/index.html">Wir sagen dem B√ºrgermeister, wohin er gehen soll (unter Verwendung der Open Street Map).</a></li>
<li><a href="../de416901/index.html">So sch√ºtzen sich IT- und Sicherheitsexperten: echte F√§lle mit Cisco Connect, BlackHat, RSAC und MWC</a></li>
<li><a href="../de416905/index.html">Boston Dynamics SpotMini Pr√§sentation</a></li>
<li><a href="../de416907/index.html">Theorie des Gl√ºcks. Das Gesetz der Zebra- und Alien-Warteschlange</a></li>
<li><a href="../de416909/index.html">PostgreSQL-Sitzungsverlauf - neue pgsentinel-Erweiterung</a></li>
<li><a href="../de416911/index.html">Chatbots sollten der n√§chste Durchbruch sein: Was ist schief gelaufen?</a></li>
<li><a href="../de416913/index.html">Was sollte der Administrator beim Wechsel in die Cloud vergessen - und was muss er lernen?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>