<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõ©Ô∏è ü§ó ü§ú Una lista exhaustiva de diferencias entre VB.NET y C #. Parte 1 üë®üèΩ‚ÄçüöÄ ‚ÅâÔ∏è üö¥</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Seg√∫n la calificaci√≥n de TIOBE en 2018, VB.NET super√≥ a C # en popularidad. Coincidencia o no, pero en febrero Eric Lippert, uno de los creadores de C...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Una lista exhaustiva de diferencias entre VB.NET y C #. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/443684/"><img src="https://habrastorage.org/webt/lv/zu/ex/lvzuexv-rlsyr8aeycle0f9r--4.png" alt="imagen"><br><br>  Seg√∫n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la calificaci√≥n de</a> TIOBE en 2018, VB.NET super√≥ a C # en popularidad.  Coincidencia o no, pero en febrero Eric Lippert, uno de los creadores de C #, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">inst√≥ a los</a> lectores a prestar atenci√≥n al blog de su amigo, un ex compa√±ero de equipo del compilador de Roslyn y, en combinaci√≥n, un ardiente fan√°tico de VB.NET, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Anthony Green</a> .  "Tales recursos son detalles detallados de expertos que no son tan f√°ciles de encontrar leyendo la documentaci√≥n", escribe Eric.  Presentamos a su atenci√≥n la primera parte de la traducci√≥n del art√≠culo de Anthony Green "Una lista exhaustiva de diferencias entre VB.NET y C #".  Quiz√°s es precisamente en estas diferencias donde reside el secreto de la din√°mica de la calificaci√≥n de estos idiomas. <br><a name="habracut"></a><br>  Durante casi la mitad de mi vida, he sido testigo y particip√© en innumerables debates sobre cu√°n similares o diferentes son los dos lenguajes .NET m√°s populares.  Primero, como aficionado, luego como profesional y, finalmente, como defensor del cliente, gerente de programa y dise√±ador de idiomas, puedo decir sin exagerar cu√°ntas veces escuch√© o le√≠ algo como: <br><blockquote>  <i>"... VB.NET es realmente una capa delgada encima de IL, como C # ..."</i> </blockquote>  o <blockquote>  <i>"... VB.NET es en realidad solo C # sin punto y coma ..."</i> </blockquote> Como si los idiomas fueran una conversi√≥n XML o una hoja de estilo. <br><br>  Y si alg√∫n visitante ardiente no escribe esto en un comentario, a menudo esto est√° impl√≠cito en preguntas como: <i>‚Äú¬°Hola, Anthony!</i>  <i>Me encontr√© con una diferencia tan peque√±a en un solo lugar: ¬øes esto un error?</i>  <i>¬øC√≥mo podr√≠an estos dos idiomas id√©nticos, que deber√≠an ser id√©nticos en nombre de todos los buenos y santos de este mundo, dispersarse en este √∫nico lugar?</i>  <i>¬øPor qu√© necesitamos tal injusticia?</i> <br><br>  " <b>Separados</b> " <b>,</b> como si fueran lo mismo hasta que ocurri√≥ una mutaci√≥n, y <i>luego se</i> convirtieron en especies separadas.  Ja! <br><br>  Pero entiendo eso.  Antes de unirme a Microsoft, tambi√©n podr√≠a haber mantenido vagamente esta idea y utilizarla como argumento para responder a los oponentes o tranquilizar a alguien.  Entiendo su encanto.  Es f√°cil de entender y muy f√°cil de repetir.  Pero trabajando en Roslyn (esencialmente reescribiendo VB y C # completamente desde cero) durante 5 a√±os, me di cuenta de lo <b>inequ√≠vocamente falsa que es esta idea</b> .  Trabaj√© con un equipo de desarrolladores y probadores para volver a implementar cada pulgada de ambos idiomas, as√≠ como sus herramientas en una gran soluci√≥n multiproyecto con millones de l√≠neas de c√≥digo escritas en ambos idiomas.  Y teniendo en cuenta la gran cantidad de desarrolladores que cambian entre ellos de un lado a otro, y el alto nivel de compatibilidad con los resultados y la experiencia de las versiones anteriores, as√≠ como la necesidad de reproducir de manera confiable el gigantesco volumen de API con gran detalle, me vi obligado a conocer las diferencias muy de cerca.  De hecho, a veces me pareci√≥ que aprend√≠a algo nuevo sobre VB.NET (mi idioma favorito) todos los d√≠as. <br><br>  Y finalmente, me tom√© el tiempo para sentarme y descargar del cerebro una part√≠cula de lo que aprend√≠ usando y creando VB.NET en los √∫ltimos 15 a√±os, con la esperanza de que al menos pueda ahorrar mi tiempo la pr√≥xima vez. <br><br>  Antes de pasar a la lista, describir√© las reglas b√°sicas: <br><br><ul><li>  Esta lista no es exhaustiva en el sentido habitual.  El es exhaustivo.  Estas no son todas las diferencias.  Estas ni siquiera son todas las diferencias que generalmente conozco.  Estas son solo las diferencias que puedo recordar primero, hasta que me canse demasiado para continuar;  hasta que me quede sin fuerzas.  Si yo o alguno de ustedes conoce o recuerda otras diferencias, me complacer√° actualizar esta lista. </li><li>  Comenzar√© al comienzo de la especificaci√≥n VB 11 y descender√© utilizando sus contenidos para recordarme las diferencias que se me ocurren primero sobre este tema. </li><li>  <b>Esta NO es una lista de funciones en VB que no est√°n en C #.</b>  Por lo tanto, no hay "literales XML versus punteros".  Esto es demasiado com√∫n, y ya hay toneladas de tales listas en Internet (algunas de las cuales fueron escritas por m√≠, y tal vez en el futuro escribir√© m√°s).  Me enfocar√© principalmente en construcciones que tienen un an√°logo en ambos idiomas, y donde un observador no informado puede sugerir que estas dos cosas se comportan igual, pero donde hay peque√±as o grandes diferencias;  pueden tener el mismo aspecto, pero funcionan de manera diferente o, en √∫ltima instancia, generan un c√≥digo diferente. </li><li>  <b>Esta NO es una lista de diferencias sint√°cticas entre VB y C #</b> (que son innumerables).  Hablar√© principalmente sobre las diferencias sem√°nticas (qu√© significan las cosas), y no sobre las sint√°cticas (c√≥mo se escriben las cosas).  Por lo tanto, no hay piezas como "VB comienza a comentar con ', y C # usa //" o "en C # _ es un identificador v√°lido, pero no en VB".  Pero romper√© esta regla por varios casos.  Despu√©s de todo, la primera secci√≥n de la especificaci√≥n trata sobre reglas l√©xicas. </li><li>  Muy a menudo, dar√© ejemplos, y a veces ofrecer√© justificaciones por las cuales el dise√±o podr√≠a ir de una forma u otra.  Algunas decisiones de dise√±o se tomaron ante mis ojos, pero la gran mayor√≠a precedi√≥ a mi tiempo, y solo puedo adivinar por qu√© se tomaron. </li><li>  Por favor, deje un comentario o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">twittee</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">@ThatVBGuy</a> ) para hacerme saber sus diferencias favoritas y / o las que le gustar√≠a saber m√°s. </li></ul><br>  Habiendo definido expectativas y sin m√°s demoras ... <br><br><h2>  Contenido </h2><br><div class="spoiler">  <b class="spoiler_title">Texto oculto</b> <div class="spoiler_text"><h4>  Sintaxis y preprocesamiento </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">1. Las palabras clave y los operadores de VB pueden usar caracteres de ancho completo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2. VB admite citas inteligentes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">3. Las constantes de preprocesamiento pueden ser de cualquier tipo primitivo (incluidas las fechas) y pueden contener cualquier valor constante</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">4. Los operadores aritm√©ticos se pueden usar en expresiones de preprocesamiento</a> </li></ul><br><h4>  Anuncios, etc. </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">5. VB a veces omite las declaraciones de implementos en IL para evitar la implementaci√≥n impl√≠cita accidental de una interfaz por nombre</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">6. VB por defecto oculta a los miembros de la clase base por nombre (Shadows), y no por nombre y firma (Sobrecargas)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">7. VB11 y siguientes son m√°s estrictos para los miembros protegidos en gen√©ricos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">8. La sintaxis "Argumento con nombre" en los atributos siempre inicializa propiedades / campos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">9. Todas las declaraciones de nivel superior (generalmente) est√°n ubicadas impl√≠citamente en el espacio de nombres ra√≠z del proyecto.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">10. Los m√≥dulos no se generan como clases abstractas selladas en IL, por lo que no se ven exactamente como clases est√°ticas de C # y viceversa.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">11. No necesita un m√©todo expl√≠cito para el punto de entrada (Sub Main) en las aplicaciones WinForms</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">12. Si llama a algunos m√©todos de tiempo de ejecuci√≥n VB obsoletos (por ejemplo, FileOpen), el m√©todo de llamada se marcar√° impl√≠citamente con un atributo para deshabilitar la alineaci√≥n por razones de correcci√≥n</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">13. Si su tipo est√° marcado con el atributo DesignerGenerated y no contiene ninguna declaraci√≥n expl√≠cita de constructor, el compilador generado por defecto llamar√° InitializeComponent si est√° definido para este tipo.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">14. La ausencia del modificador parcial NO significa que el tipo no sea parcial</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">15. En las clases predeterminadas, el nivel de acceso p√∫blico es para todo excepto campos, y en estructuras p√∫blicas, tambi√©n para campos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">16. VB inicializa los campos DESPU√âS de que se llama al constructor base, mientras que C # los inicializa ANTES de que se llame al constructor base</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">17. El campo de respaldo declarado impl√≠citamente de eventos VB tiene un nombre diferente que en C # y es accesible por nombre</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">18. El campo auxiliar declarado impl√≠citamente de las propiedades autom√°ticas de VB tiene un nombre com√∫n y es accesible por este nombre</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">19. El campo auxiliar de solo lectura de propiedades autom√°ticas declarado impl√≠citamente permite escribir</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">20. Los atributos de evento a veces se aplican a un campo de evento auxiliar</a> </li></ul><br><h4>  Instrucciones </h4><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">21. El alcance de la etiqueta es el cuerpo de todo el m√©todo que lo contiene;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Puedes saltar dentro de los bloques (no todos)</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">22. La vida √∫til de una variable local &lt;&gt; √°mbito</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">23. Las variables siempre se inicializan al valor predeterminado para el tipo correspondiente.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">24. RaiseEvent NO lanza una excepci√≥n si el campo auxiliar es nulo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">25. Las asignaciones no son siempre las mismas;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">a veces una asignaci√≥n de tipo de referencia realiza un clon superficial</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">26. Select Case no es compatible con fall-through;</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">no se requiere descanso</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">27. Cada bloque de caso tiene su propio alcance</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">28, 29, 30. Select Case funciona con tipos no primitivos, puede usar expresiones arbitrarias no constantes en las comprobaciones, y por defecto usa el operador =</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">31. Las variables declaradas dentro de los bucles conservan su significado entre iteraciones de alguna manera</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">32. Tres expresiones de bucle For se eval√∫an solo una vez al comienzo del bucle.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">33. Para cada bucle en VB puede usar el m√©todo de extensi√≥n GetEnumerator</a> </li></ul></div></div><br><h2>  Sintaxis y preprocesamiento </h2><br><a name="section1"></a><h3>  1. Las palabras clave y los operadores de VB pueden usar caracteres de ancho completo </h3><br>  Algunos idiomas (no s√© cu√°ntos exactamente, pero al menos en algunas formas de chino, japon√©s y coreano) usan caracteres de ancho completo.  En resumen, esto significa que cuando se usa una fuente monoespacial (como lo hacen la mayor√≠a de los programadores), el car√°cter chino ocupar√° el doble de espacio horizontal que los caracteres latinos que sol√≠amos ver en el oeste.  Por ejemplo: <br><br><img src="https://habrastorage.org/webt/wl/j8/0u/wlj80uri5nr810dqgpwymj5eru0.png"><br><br>  Aqu√≠ tengo una declaraci√≥n de variables escrita en japon√©s, y la inicializaci√≥n con una cadena tambi√©n escrita en japon√©s.  Seg√∫n el traductor de Bing, la variable se llama "saludo" y la l√≠nea dice "¬°Hola, mundo!"  El nombre de la variable en japon√©s tiene solo 2 caracteres de longitud, pero ocupa el espacio de 4 caracteres de ancho medio que mi teclado generalmente muestra, como lo demuestra el primer comentario.  Hay versiones de n√∫meros de ancho completo y todos los dem√°s caracteres ASCII impresos que tienen el mismo ancho que los japoneses.  Para demostrar esto, escrib√≠ un segundo comentario usando los n√∫meros de ancho completo "1" y "2".  Estos no son "1" y "2" como en el primer comentario.  No hay espacios entre los n√∫meros.  Tambi√©n puede ver que el tama√±o de los caracteres no es exactamente de 2 caracteres de ancho, hay un ligero desplazamiento.  Esto se debe en parte a que este programa mezcla caracteres de ancho completo y medio ancho en una l√≠nea y en las tres l√≠neas. <br><br>  Los espacios son de ancho medio, los caracteres alfanum√©ricos son de ancho completo.  No somos programadores a menos que estemos obsesionados con la alineaci√≥n del texto.  Y me parece que si usted es chino, japon√©s o coreano (u otra persona que usa caracteres de tama√±o completo para su idioma) y usa identificadores o cadenas escritos en su idioma nativo, estos errores menores de alineaci√≥n son irritantes. <br><br>  Seg√∫n tengo entendido, dependiendo de su teclado japon√©s, cambiar entre jerogl√≠ficos y lat√≠n es f√°cil, pero es preferible usar caracteres latinos de ancho completo.  VB admite esto en palabras clave, espacios, operadores e incluso comillas.  Entonces todo esto se puede escribir as√≠: <br><br><img src="https://habrastorage.org/webt/me/mq/ph/memqph465sxyx_tvxov6fglrjfw.png"><br><br>  Como puede ver, en esta versi√≥n, las palabras clave, espacios, comentarios, operadores, incluso comillas usan sus versiones de tama√±o completo.  En el caos trajo el orden. <br><br>  Si  Los japoneses usan VB.  De hecho, a pesar de la sintaxis similar al idioma ingl√©s (y tal vez por eso), para la mayor√≠a de los usuarios de VB que veo en los foros, el ingl√©s no es el idioma principal.  Durante mi trabajo en Microsoft, me encontr√© con el MVP VB japon√©s varias veces, al menos uno de ellos constantemente tra√≠a dulces japoneses.  Si es un programador de VB de China, Jap√≥n o Corea (o de cualquier otro pa√≠s que use caracteres de ancho completo), escriba los comentarios.  (En los comentarios al autor, escribieron que los japoneses est√°n intentando en todas partes del c√≥digo usar ascii, <i>aprox. Per.</i> ) <br><br>  <i><b>Momento curioso:</b> cuando inicialmente implement√© l√≠neas interpoladas en VB, (para mi verg√ºenza) no tom√© en cuenta la posibilidad de tener llaves de ancho completo en los lugares de sustituci√≥n.</i>  <i>Vladimir Reshetnikov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">@vreshetnikov</a> ) descubri√≥ y corrigi√≥ este error, por lo que la gran tradici√≥n de tolerancia VB en los anchos de caracteres segu√≠a siendo v√°lida.</i> <br><br><a name="section2"></a><h3>  2. VB admite citas inteligentes </h3><br>  Bien, esto es, por supuesto, un poco, pero digno de menci√≥n.  ¬øAlguna vez has visto c√≥digo de muestra en un documento de texto como este: <br><br><img src="https://habrastorage.org/webt/ls/8l/qc/ls8lqckokgku3b0raqiboefn9bc.png"><br><br>  Y despu√©s de copiar el ejemplo en su c√≥digo, ¬ødescubri√≥ que ninguna de las citas (resaltadas) funcion√≥, porque Word reemplaza todas las citas habituales de ASCII con <code>‚Äú</code> citas inteligentes <code>‚Äù</code> ? <br><br>  Yo no  Bien, lo tuve, pero solo cuando copi√© los ejemplos en C #.  En VB, las comillas inteligentes son delimitadores v√°lidos para cadenas (es curioso que las comillas rusas <code>¬´¬ª</code> no funcionen - Aprox. Por): <br><br><img src="https://habrastorage.org/webt/l0/yk/wi/l0ykwi3ebeigkgrkkrzq8lfrwhm.png"><br><br>  Tambi√©n funcionan dentro de cadenas, aunque tal vez de una manera extra√±a.  Si duplica las citas inteligentes para escapar, entonces todo lo que obtiene en tiempo de ejecuci√≥n es solo la comilla simple ("tonta").  Esto puede parecer un poco extra√±o, pero sin embargo muy pr√°ctico, ya que casi cualquier otro lugar se permiten comillas inteligentes en la cadena.  El compilador NO te hace terminar con una cita inteligente o usar la correcta si comenzaste con una inteligente, para que puedas mezclarla sin preocuparte.  Y s√≠, esto tambi√©n funciona con el car√°cter de comillas simples utilizado para comentarios: <br><br><img src="https://habrastorage.org/webt/4y/9j/8n/4y9j8n7mexmkyvtx_vmj-jesfak.png"><br><br>  Trat√© de hacer que Paul Wick ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">@panopticoncntrl</a> ) admitiera que lo hizo solo porque estaba atormentado con este problema mientras trabajaba en la especificaci√≥n, pero niega cualquier culpa.  Este no fue el caso en VB6, por lo que alguien agreg√≥ esto m√°s tarde. <br><br><a name="section3"></a><h3>  3. Las constantes de preprocesamiento pueden ser de cualquier tipo primitivo (incluidas las fechas) y pueden contener cualquier valor constante </h3><br><p><img src="https://habrastorage.org/webt/sd/0f/jv/sd0fjva0vsarlwmx7vgwn8yf8xq.png"></p><br><a name="section4"></a><h3>  4. Los operadores aritm√©ticos se pueden usar en expresiones de preprocesamiento </h3><br><p><img src="https://habrastorage.org/webt/hx/cw/0k/hxcw0k25imfieuvg_ncshwbizim.png"></p><br><br><h2>  Anuncios, etc. </h2><br><a name="section5"></a><h3>  5. VB a veces omite IL implementa declaraciones para evitar la implementaci√≥n impl√≠cita accidental de una interfaz por nombre. </h3><br>  Este art√≠culo pertenece a la categor√≠a de esoterismo.  En VB, la implementaci√≥n de una interfaz siempre se realiza expl√≠citamente.  Pero resulta que, en ausencia de una implementaci√≥n expl√≠cita, el comportamiento predeterminado del CLR cuando se llama a un m√©todo de interfaz es buscar m√©todos p√∫blicos por nombre y firma.  En la mayor√≠a de los casos, esto es normal, porque en VB <i>generalmente</i> necesita proporcionar una implementaci√≥n para cada miembro de la interfaz que implemente, excepto en un caso: <br><br><pre> <code class="vbscript hljs">Interface IFoo <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> IFoo_Baz() Implements IFoo.Baz <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> FooDerived Inherits Foo Implements IFoo <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Bar() Implements IFoo.Bar <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Baz() <span class="hljs-comment"><span class="hljs-comment">' Does something unrelated to what an IFoo.Baz would do. End Sub End Class</span></span></code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/39634fd98a0cacc093719ab62d7ab1e6#file-partial-re-implementation-vb</a> <br><br>  En este ejemplo, la clase <code>FooDerived</code> solo quiere reasignar <code>IFoo.Bar</code> al nuevo m√©todo, pero deja las implementaciones restantes sin cambios.  Resulta que si el compilador simplemente genera la directiva de implementos para <code>FooDerived</code> , el CLR tambi√©n <code>FooDerived.Baz</code> como una nueva implementaci√≥n de <code>IFoo.Baz</code> (aunque en este ejemplo no est√° relacionado con <code>IFoo</code> ).  En C #, esto sucede impl√≠citamente (y no estoy seguro si puedo rechazarlo), pero en VB, el compilador en realidad omite 'Implementos' de toda la declaraci√≥n para evitar esto, y anula solo los miembros espec√≠ficos que se volvieron a implementar.  En otras palabras, si le pregunta a <code>FooDerived</code> si <code>IFoo</code> directamente, le dir√° que no: <br><p><img src="https://habrastorage.org/webt/kz/u7/fr/kzu7fr0j1zz4eadll-m5gto7f8q.png"></p><br>  ¬øPor qu√© s√© esto y por qu√© es importante?  Durante muchos a√±os, los usuarios de VB han solicitado soporte para la implementaci√≥n impl√≠cita de una interfaz (sin especificar expl√≠citamente <code>Implements</code> en cada declaraci√≥n), generalmente para la generaci√≥n de c√≥digo.  La incorporaci√≥n de esto con la sintaxis actual ser√≠a un cambio radical, porque <code>FooDerived.Baz</code> ahora implementa <code>IFoo.Baz</code> impl√≠citamente, aunque no ha hecho esto antes.  Pero m√°s recientemente, aprend√≠ m√°s sobre este comportamiento cuando discut√≠ posibles problemas de dise√±o con la funci√≥n de "implementaci√≥n de interfaz predeterminada", que permitir√≠a que las interfaces incluyan implementaciones predeterminadas de algunos miembros y no requieran una nueva implementaci√≥n en cada clase.  Esto ser√≠a √∫til para sobrecargas, por ejemplo, cuando es probable que la implementaci√≥n sea la misma para todos los implementadores (delegaci√≥n a la sobrecarga principal).  Otro escenario es el versionado.  Si una interfaz puede incluir implementaciones predeterminadas, puede agregarle nuevos miembros sin romper las implementaciones antiguas.  Pero hay un problema.  Dado que el comportamiento predeterminado en el CLR es buscar implementaciones p√∫blicas por nombre y firma, si la clase VB no implementa miembros de interfaz con implementaciones predeterminadas, pero tiene miembros p√∫blicos con un nombre y firma adecuados, implementan impl√≠citamente estos miembros de interfaz, incluso si lo hace completamente No se supone que lo haga.  Hay cosas que puede hacer para evitar esto cuando se conoce el conjunto completo de miembros de la interfaz en tiempo de compilaci√≥n.  Pero en caso de que el miembro se agregue despu√©s de compilar el c√≥digo, solo cambia silenciosamente el comportamiento en tiempo de ejecuci√≥n. <br><br><a name="section6"></a><h3>  6. VB por defecto oculta a los miembros de la clase base por nombre (Shadows), y no por nombre y firma (Sobrecargas) </h3><br>  Creo que esta diferencia es bastante conocida.  El escenario es este: usted hereda la clase base ( <code>DomainObject</code> ), posiblemente fuera de su control, y declara un m√©todo con un nombre que tiene sentido en el contexto de su clase, por ejemplo, <code>Print</code> : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> DomainObject <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Invoice Inherits DomainObject <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Print(copies As Integer) <span class="hljs-comment"><span class="hljs-comment">' Sends contents of invoice to default printer. End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/863cfd1e7536fe8bda7cd145795eaf9f#file-shadows-example-vb</a> <br><br>  El hecho de que se pueda imprimir una factura tiene sentido.  Pero en la pr√≥xima versi√≥n de la API donde se declara su clase base, deciden la depuraci√≥n para agregar a todos los DomainObjects un m√©todo que muestre el contenido completo del objeto en la ventana de depuraci√≥n.  Este m√©todo se llama brillantemente Imprimir.  El problema es que el cliente de su API puede notar que el objeto Factura tiene m√©todos <code>Print()</code> e <code>Print(Integer)</code> , y piensa que se trata de sobrecargas relacionadas.  Quiz√°s el primero solo imprima una copia.  Pero esto no es en absoluto lo que concibi√≥ como el autor de Factura.  No ten√≠a idea de que aparecer√≠a <code>DomainObject.Print</code> .  Entonces s√≠, esto no funciona en VB.  Cuando aparece esta situaci√≥n, aparece una advertencia, pero lo m√°s importante, el comportamiento predeterminado en VB es ocultar por nombre.  Es decir, hasta que indique expl√≠citamente con la palabra clave <code>Overloads</code> que su <code>Print</code> es una sobrecarga de <code>Print</code> clase base, un miembro de la clase base (y cualquier sobrecarga de la misma) est√°n completamente ocultos.  Solo la API que declar√≥ originalmente se muestra a sus clientes de clase.  Esto funciona de manera predeterminada, pero puede hacerlo expl√≠citamente a trav√©s de la palabra clave Shadows.  C # solo puede hacer <code>Overloads</code> (aunque tiene en cuenta <code>Shadows</code> cuando se refiere a una biblioteca VB) y lo hace de manera predeterminada (usando la <code>new</code> palabra clave).  Pero esta diferencia aparece de vez en cuando cuando aparecen jerarqu√≠as de herencia en proyectos donde una clase se define en un idioma y otra en otro, y hay m√©todos sobrecargados, pero esto est√° m√°s all√° del alcance del elemento actual en la lista de diferencias. <br><br><a name="section7"></a><h3>  7. VB11 y siguientes son m√°s estrictos para los miembros protegidos en gen√©ricos </h3><br>  De hecho, cambiamos esto entre VS2013 y VS2015.  En particular, decidimos no molestarnos con la reimplementaci√≥n.  Pero estoy escribiendo esta distinci√≥n en caso de que use la versi√≥n anterior y lo note.  En resumen: si un miembro protegido se declara en el tipo gen√©rico, entonces el heredero, que tambi√©n es gen√©rico, puede acceder a este miembro protegido solo a trav√©s de la instancia heredada con los mismos argumentos de tipo. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base(Of T) Protected x As T <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of T) Inherits Base(Of T) <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> F(y As <span class="hljs-built_in"><span class="hljs-built_in">Derived</span></span>(Of <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>)) <span class="hljs-comment"><span class="hljs-comment">' Error: Derived(Of T) cannot access Derived(Of String)'s ' protected members yx = "a" End Sub End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/ce12ac986219eb51d6c85fa02c339a2f#file-protected-in-generics-vb</a> <br><br><a name="section8"></a><h3>  8. La sintaxis "Argumento con nombre" en los atributos siempre inicializa propiedades / campos </h3><br>  VB usa la misma sintaxis <code>:=</code> para inicializar propiedades / campos de atributo que para pasar argumentos de m√©todo por nombre.  Por lo tanto, no hay forma de pasar un argumento al constructor de atributos por nombre. <br><br><a name="section9"></a><h3>  9. Todas las declaraciones de nivel superior (generalmente) est√°n ubicadas impl√≠citamente en el espacio de nombres ra√≠z del proyecto </h3><br>  Esta diferencia est√° casi en la categor√≠a de "caracter√≠sticas avanzadas", pero la he incluido en la lista porque cambia el significado del c√≥digo.  Hay un campo en las propiedades del proyecto VB: <br><br><p><img src="https://habrastorage.org/webt/0y/hy/7_/0yhy7_k2xkchvxq70v1duka5z4a.png"></p><br>  Por defecto, este es simplemente el nombre de su proyecto en el momento de la creaci√≥n.  Este <b>NO</b> es el mismo campo que el "Espacio de nombres predeterminado" en las propiedades de un proyecto de C #.  El espacio de nombres predeterminado simplemente establece qu√© c√≥digo se agrega por defecto a los nuevos archivos en C #.  Pero el espacio de nombres ra√≠z en VB significa que, a menos que se indique lo contrario, cada declaraci√≥n de nivel superior en este proyecto est√° impl√≠citamente en este espacio de nombres.  Esta es la raz√≥n por la cual las plantillas de documentos VB generalmente no contienen ninguna declaraci√≥n de espacio de nombres.  Adem√°s, si agrega una declaraci√≥n de espacio de nombres, no anula la ra√≠z, sino que se agrega a ella: <br><br><pre> <code class="vbscript hljs">Namespace Controllers <span class="hljs-comment"><span class="hljs-comment">' Child namespace. End Namespace Namespace Global.Controllers ' Top-level namespace End Namespace</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/fd1e5e3a58aee862a5082e1d2b078084#file-root-namespace-vb</a> <br><br>  Por lo tanto, el espacio de nombres <code>Controllers</code> realidad declara el espacio de nombres <code>VBExamples.Controllers</code> , a menos que elimine este mecanismo declarando expl√≠citamente <code>Global</code> en el espacio de nombres. <br><br>  Esto es conveniente porque ahorra un nivel de sangr√≠a y un concepto adicional para cada archivo VB.  Y esto es especialmente √∫til si est√° creando una aplicaci√≥n para UWP (porque todo debe estar en el espacio de nombres en UWP), y es extremadamente conveniente si decide cambiar el espacio de nombres de nivel superior para todo su proyecto, por ejemplo, de un nombre en clave como Roslyn a una versi√≥n m√°s larga, como <code>Microsoft.CodeAnalysis</code> , ya que no tiene que actualizar manualmente cada archivo en la soluci√≥n.  Tambi√©n es importante tener esto en cuenta al trabajar con generadores de c√≥digo, espacios de nombres XAML y el nuevo <code>.vbproj</code> archivo <code>.vbproj</code> . <br><br><a name="section10"></a><h3>  10. Los m√≥dulos no se generan como clases abstractas selladas en IL, por lo que no se ven exactamente como clases est√°ticas de C # y viceversa. </h3><br>  Los m√≥dulos en VB exist√≠an antes de las clases est√°ticas de C #, aunque intentamos en 2010 hacerlos iguales en t√©rminos de IL.  Desafortunadamente, este fue un cambio radical, porque el serializador XML (o tal vez era binario) para esa versi√≥n de .NET (creo que lo arreglaron) no quer√≠a serializar el tipo anidado en un tipo que no pod√≠a crearse (y una clase abstracta no puede)  Lanz√≥ una excepci√≥n. <br><br>  Encontramos esto despu√©s de hacer los cambios y revertirlos porque alg√∫n c√≥digo en alguna parte usaba el tipo de enumeraci√≥n que estaba incrustado en el m√≥dulo.  Y como no sabe con qu√© versi√≥n del serializador funcionar√° el programa compilado, nunca ser√° posible cambiarlo, ya que en una versi√≥n de la aplicaci√≥n funcionar√°, y en otros casos arrojar√° excepciones. <br><br><a name="section11"></a><h3>  11. No necesita un m√©todo expl√≠cito para el punto de entrada (Sub Main) en las aplicaciones WinForms </h3><br>  Si su proyecto usa Formulario como el objeto de inicio y no usa el "Marco de aplicaci√≥n" (m√°s sobre esto en la pr√≥xima publicaci√≥n), VB genera un <code>Sub Main</code> , que crea su formulario de inicio y lo pasa a <code>Application.Run</code> , guardando el archivo completo Para administrar este proceso, ya sea un m√©todo adicional en su <code>Form</code> o incluso la necesidad de pensar en este problema. <br><br><a name="section12"></a><h3>  12. Si llama a algunos m√©todos de tiempo de ejecuci√≥n VB obsoletos (por ejemplo, FileOpen), el m√©todo de llamada se marcar√° impl√≠citamente con un atributo para deshabilitar la alineaci√≥n por razones de correcci√≥n </h3><br>  En resumen, los m√©todos para trabajar con archivos de estilo VB6 como <code>FileOpen</code> basan en contextos espec√≠ficos del ensamblaje donde se encuentra el c√≥digo.  Por ejemplo, el archivo # 1 puede ser un registro en un proyecto y una configuraci√≥n en otro.  Para determinar qu√© ensamblaje se est√° ejecutando, <code>Assembly.GetCallingAssembly()</code> llama a <code>Assembly.GetCallingAssembly()</code> .  Pero si el JIT <i>alinea</i> su m√©todo con la persona que llama, desde el punto de vista de la pila, su m√©todo no llamar√° al m√©todo de tiempo de ejecuci√≥n VB, sino a la persona que llama, que puede estar en un ensamblaje diferente, que luego puede permitir que su c√≥digo acceda o viole el estado interno de la persona que llama objeto  Esto no es un problema de seguridad, porque si el c√≥digo comprometido se est√° ejecutando en su proceso, ya ha perdido.  Esto es una cuesti√≥n de correcci√≥n.  Por lo tanto, si utiliza estos m√©todos, el compilador deshabilita la inserci√≥n. <br><br>  Este cambio se realiz√≥ en el √∫ltimo momento en 2010, porque el x64 JIT es MUY agresivo al incorporar / optimizar el c√≥digo, y lo encontramos muy tarde, y era la opci√≥n m√°s segura. <br><br><a name="section13"></a><h3>  13. Si su tipo est√° marcado con el atributo DesignerGenerated y no contiene ninguna declaraci√≥n expl√≠cita de constructor, entonces el compilador generado por defecto llamar√° InitializeComponent si est√° definido para este tipo </h3><br>  En la era anterior a la llegada de los tipos parciales, el equipo de VB libr√≥ una guerra para reducir el c√≥digo repetitivo en los proyectos de WinForms.  Pero incluso con <code>Partial</code> esto es √∫til porque permite que el archivo generado omita completamente el constructor, y el usuario puede declararlo manualmente en su archivo si es necesario, o no declararlo si no.  Sin esto, el dise√±ador se ver√≠a obligado a agregar un constructor solo para llamar a <code>InitializeComponent</code> , y si el usuario tambi√©n agrega, ser√°n duplicados, o el kit de herramientas debe ser lo suficientemente inteligente como para mover el constructor del archivo del dise√±ador al usuario y no regenerarlo en el dise√±ador si ya lo ha hecho. existe en el archivo de usuario. <br><br><a name="section14"></a><h3>  14. La ausencia del modificador parcial NO significa que el tipo no sea parcial </h3><br>  T√©cnicamente, en VB, solo una clase debe marcarse como Parcial.  Esto suele ser (en proyectos GUI) un archivo generado. <br><br>  <b>Por qu√©</b>  Esto mantiene el archivo de usuario hermoso y limpio, y puede ser muy conveniente incluirlo despu√©s de generar o agregar c√≥digo personalizado al c√≥digo generado.  Sin embargo, se recomienda que, como m√°ximo, una clase no tenga un modificador parcial, de lo contrario se emite una advertencia. <br><br><a name="section15"></a><h3>  15. En las clases predeterminadas, el nivel de acceso p√∫blico es para todo excepto campos, y en estructuras p√∫blicas, tambi√©n para campos </h3><br>  Tengo sentimientos encontrados sobre esto.  En C #, todo es <code>private</code> de forma predeterminada (¬°salud, encapsulaci√≥n!), Pero hay un argumento que hacer seg√∫n lo que a menudo declaras: un contrato p√∫blico o detalles de implementaci√≥n.  Las propiedades y eventos generalmente est√°n destinados para uso externo ( <code>public</code> ), y no se puede acceder a los operadores que no sean <code>public</code> .  Sin embargo, rara vez conf√≠o en la accesibilidad predeterminada (con la excepci√≥n de demostraciones como los ejemplos en este art√≠culo). <br><br><a name="section16"></a><h3>  16. VB inicializa los campos DESPU√âS de que se llama al constructor base, mientras que C # los inicializa ANTES de que se llame al constructor base </h3><br>  ¬øHas o√≠do c√≥mo "algunos" dicen que lo primero que sucede en el constructor es una llamada al constructor de la clase base?  Bueno, ese no es el caso, al menos en C #.  En C #, antes de llamar a <code>base()</code> , expl√≠cito o impl√≠cito, los inicializadores de campo se ejecutan primero, luego la llamada del constructor y luego su c√≥digo.  Esta decisi√≥n tiene consecuencias, y creo que s√© por qu√© los desarrolladores de idiomas podr√≠an ir de una forma u otra.  Creo que una de estas consecuencias es que el siguiente c√≥digo no se puede traducir directamente a C #: <br><br><pre> <code class="vbscript hljs">Imports System.Reflection <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> ReflectionFoo <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringType As Type = GetType(<span class="hljs-built_in"><span class="hljs-built_in">String</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringLengthProperty As PropertyInfo = StringType.GetProperty(<span class="hljs-string"><span class="hljs-string">"Length"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringGetEnumeratorMethod As MethodInfo = StringType.GetMethod(<span class="hljs-string"><span class="hljs-string">"GetEnumerator"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> StringEnumeratorType As Type = StringGetEnumeratorMethod.ReturnType <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>() Console.WriteLine(StringType) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/37d01c8e7f085e06172bfaf6a1e567d4#file-field-init-me-reference-vb</a> <br><br>  En los d√≠as en que estaba involucrado en Reflection, a menudo escrib√≠a ese c√≥digo.  Y recuerdo vagamente a un colega antes de Microsoft (Josh), que tradujo mi c√≥digo a C #, a veces quej√°ndose de la necesidad de portar todos mis inicializadores al constructor.  En C #, est√° prohibido hacer referencia a un objeto que se est√° creando antes de llamar a <code>base()</code> .  Y dado que los inicializadores de campo se ejecutan antes de la llamada especificada, tampoco pueden hacer referencia a otros campos ni a ning√∫n miembro de la instancia del objeto.  Entonces, este ejemplo tambi√©n funciona solo en VB: <br><br><pre> <code class="vbscript hljs">MustInherit <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Base <span class="hljs-comment"><span class="hljs-comment">' OOP OP? Private Cached As Object = DerivedFactory() Protected MustOverride Function DerivedFactory() As Object End Class Class Derived Inherits Base Protected Overrides Function DerivedFactory() As Object Return New Object() End Function End Class</span></span></code> </pre> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/fe5ca89e5a98efee97ffee93aa684e50#file-base-derived-init-vb</a> <br><br>  Aqu√≠ tenemos una clase base, que supuestamente tiene mucha funcionalidad, pero necesita alg√∫n objeto clave para la administraci√≥n, el trabajo, que est√° determinado por el tipo derivado.  Hay muchas formas de implementar dicha plantilla, pero generalmente uso esta porque: <br><br><ul><li>  √©l es bajo; </li><li>  no requiere que declare un constructor; </li><li>  no requiere que coloque el c√≥digo de inicializaci√≥n en el constructor, si lo hay; </li><li>  me permite almacenar en cach√© el objeto creado y no requiere tipos derivados para declarar y administrar el almacenamiento del objeto proporcionado, aunque ahora esto no es un problema con las propiedades autom√°ticas. </li></ul><br>  Adem√°s, he estado en ambas situaciones: cuando un campo en un tipo derivado quer√≠a llamar a un m√©todo declarado en la clase base, y cuando el inicializador de la clase de campo necesitaba llamar al miembro <code>MustOverride</code> implementado por el tipo derivado.  Ambos son v√°lidos en VB y ninguno en C #, y eso tiene sentido.  Si el inicializador de campo C # pudiera llamar a un miembro de la clase base, este miembro podr√≠a depender de los campos inicializados en el constructor base (que a√∫n no se est√° ejecutando) y los resultados seguramente ser√≠an incorrectos, y no hab√≠a forma de evitarlo. <br><br>  Pero en VB, el constructor base ya ha funcionado, ¬°as√≠ que puedes hacer cualquier cosa!  En la situaci√≥n opuesta, todo es un poco m√°s complicado, porque llamar al miembro <code>Overridable</code> desde el inicializador (o constructor) de la clase base puede conducir al acceso a los campos antes de que se "inicialicen".  Pero solo su implementaci√≥n sabe si esto es un problema.  En mis guiones, esto simplemente no sucede.  No dependen del estado de la instancia, pero no pueden ser miembros <code>Shared</code> porque no puede tener un miembro <code>Shared Overridable</code> en ning√∫n idioma por razones t√©cnicas m√°s all√° del alcance de este art√≠culo.  Adem√°s, est√° claramente definido qu√© sucede con los campos antes de iniciar los inicializadores personalizados: se inicializan con valores predeterminados, como todas las variables en VB.  Sin sorpresas <br><br>  <b>¬øEntonces por qu√©?</b>  En realidad, no s√© si mis scripts fueron lo que el equipo original de VB.NET ten√≠a en mente cuando lo dise√±aron.  ¬°Simplemente funciona en mi caso!  ,       :  VB ,         ,       .              .          . <br><br> <i> ,              ,    ,          C#  VB,       ,    VB  ,   C#.</i> <br><br><a name="section17"></a><h3> 17.     (backing field)  VB   ,   C#,     </h3><br>          (       ).        <code>E</code> ,  VB   (  IDE)    <code>EEvent</code> .  C#     <code>E</code> ,     ,   <code>E</code>   ,    . <br><br><a name="section18"></a><h3> 18.      VB         </h3><br>      <code>P</code> ,      <code>_P'</code> .    IntelliSense,      .  C#    ¬´¬ª ( <i>mangled</i> ) ,  ,            C#     . <br><br> <b> ?</b>  VB    , -,             ¬´WithEvents¬ª,  -,     ,   -     ,        . <br><br><a name="section19"></a><h3> 19.     read-only    </h3><br>    ,        ,  ‚Ä¶.   VB     ¬´ ¬ª    .    <code>WithEvents</code> -, non-Custom           ,       ,     .    IntelliSense,      ,     ,  .   FTW!  ,   VB  ,    private set;   C#. <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Alarm <span class="hljs-keyword"><span class="hljs-keyword">Private</span></span> ReadOnly Code As Integer ReadOnly <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Status As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-string"><span class="hljs-string">"Disarmed"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>(code As Integer) <span class="hljs-keyword"><span class="hljs-keyword">Me</span></span>.Code = code <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Arm() <span class="hljs-comment"><span class="hljs-comment">' I'm motifying the value of this externally read-only property here. _Status = "Armed" End Sub Function Disarm(code As Integer) As Boolean If code = Me.Code Then ' And here. _Status = "Disarmed" Return True Else Return False End If End Function End Class</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/57ce7962700c5498894ad417296f9066#file-read-only-auto-property-backing-field-is-writeable-vb</a> <br><br><a name="section20"></a><h3> 20.         </h3><br>  ,  <code>NonSerialized</code> . <br><br>   VB       (expanded) Custom-  2005  (?) <b></b>       ,         ,  ,   <code>NonSerialized</code> .  ,     ,   ,   ,       ¬´¬ª       ,    ¬´ ¬ª. <br><br>     ,   ,          ,  ,   . , , ,     ,     two-way bindable ( ,   <code>PropertyChanged</code> ),     ,    , , ,    . <br><br>   ,     ,       CLSA ¬´Expert Business Objects¬ª <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  (Rocky Lhotka)</a> ,      undo/redo (    ,    ,   - ,  ,     ),       .  ,         .  ,  ,        ,    . <br><br><h2>  </h2><br><a name="section21"></a><h3> 21.    ‚Äî    ,  ;      ( ) </h3><br>   ,      <code>GoTo</code>     .   ,        -   . ,       <code>For</code>  <code>For Each</code> ;  <code>Using</code> , <code>SyncLock</code>  <code>With</code> ,   ,     ,        <code>Finally</code> .   <code>If</code>  <code>Select Case</code> ,  <code>Do</code>  <code>While</code> ,    Try ‚Äî    ,        : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> retryCount = <span class="hljs-number"><span class="hljs-number">0</span></span> Try Retry: <span class="hljs-comment"><span class="hljs-comment">' IO call. Catch ex As IO.IOException When retryCount &lt; 3 retryCount += 1 GoTo Retry End Try End Sub End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/b93adcf3c3705e4768dcab0b05b187a0#file-try-goto-retry-vb</a> <br><br>  ,  ,   ,   .NET  VB      ¬´¬ª.  VB6        Quick Basic  ( )       .      QB,      .     ,       ¬´ ¬ª,           .        GoTo,         ‚Äî   ,        . <br><br> <b></b> :    <code>Try</code>    ,  VB -   <code>await</code>   <code>Catch</code>  <code>Finally</code> ,  ,     <code>GoTo</code>    . <br><br><a name="section22"></a><h3> 22.     &lt;&gt;   </h3><br>    ,  VB   (     )  ( <code>static</code> )        (      ).    ,     .        <code>Catch</code>       3 .      <code>Try</code>      <code>Catch</code> ,      ,   ,       <code>Try</code>     . <br><br>  ,  VB.NET     ,     .       CLR      VB   .      :           ,    . <br><br> <i>, C# ,        ,       ¬´¬ª.   VB.NET     .</i> <br><br><a name="section22"></a><h3> 23.          </h3><br>       ,        ,    C#       ¬´ ¬ª ( <i>definite assignment</i> ).   ,    , ,         ¬´ ¬ª.   ,   ( )           ,   ,          .    C/C++.      , !   ,        .  ,        ,    , ‚Äî  .           ,     ,   ,         ,  ,         ,      ,          ,    .  ,  BASIC   ,          ,      ¬´¬ª ,       <code>= Nothing</code> , <code>= 0</code> , <code>= False</code>  .. <br><br> ,   ( <i>flow analysis</i> )  VB    ,    . <br><br>         ,    C#   ,  ,          ,            . VB    <i></i>  ,       ,        ,       .  Roslyn, , API       ¬´ ¬ª,       ,      . <br><br><a name="section24"></a><h3> 24. RaiseEvent   ,     null </h3><br>     ,  -     C#  VB. <code>RaiseEvent</code>  VB ‚Äî        ,     <code>null</code> ( ),    <code>null</code> - ‚Äî  ,      . <br><br><pre> <code class="vbscript hljs"><span class="hljs-comment"><span class="hljs-comment">' You don't have to write this: If PropertyChangedEvent IsNot Nothing Then RaiseEvent PropertyChanged(Me, e) End If ' You don't have to write this: Dim handlers = PropertyChangedEvent If handlers IsNot Nothing Then handlers(Me, e) End If ' You don't have to write this either: PropertyChangedEvent?(Me, e) ' Just write this: RaiseEvent PropertyChanged(Me, e)</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/c3dea3d91ef4ffc50cfa92c41f967937#file-null-safe-event-raising-vb</a> <br><br> ,    null-conditional   C#  VS2015     C#   ,      VB (  ),       ,     ;   VB.NET    . <br><br><a name="section25"></a><h3> 25.    ;        (shallow clone) </h3><br>     , ,        17 , ,     .     (boxed)      Object,       <code>System.Runtime.CompilerServices.RuntimeHelper.GetObjectValue</code> .   ,   CLR.    ,    : <br><br><ul><li>     ,      . <br></li><li>       ,    (,     Integer ),      . <br></li><li>        ,            . <br></li></ul><br>    ,     ,  ,    ,       ( <i>late-bound situations</i> ). ,        ,     (    )  ,           ,   ,        ,      ( <i>caller's copy</i> ).          ,     ,  - , ‚Äî     . <br><br>          .     : <br><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">Property</span></span> Value As Object <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Class</span></span> Structure MyStruct <span class="hljs-keyword"><span class="hljs-keyword">Public</span></span> X, Y As Integer <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Structure Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> defaultValue As Object = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyStruct <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.X = <span class="hljs-number"><span class="hljs-number">3</span></span>, .Y = <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> e = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> MyEventArgs <span class="hljs-keyword"><span class="hljs-keyword">With</span></span> {.Value = defaultValue} RaiseEvent DoSomething(<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, e) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> e.Value <span class="hljs-keyword"><span class="hljs-keyword">Is</span></span> defaultValue <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-comment"><span class="hljs-comment">' No handlers have changed anything. Console.WriteLine("Unchanged.") End If End Sub Event DoSomething(sender As Object, e As MyEventArgs) End Module</span></span></code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/422ac4574af92d9bbbf59f0fbc40b74d#file-get-object-value-vb</a> <br><br>      ,     WPF,               .    ,     . ,                     ,        .    ,    .   ,    -   ,  , ,              . <br><br> ,    ,   ¬´ ¬ª         .    IronRuby/Python,    <code>dynamic</code>  C# (  C#): C#    <code>GetObjectValue</code>     .         <code>object.ReferenceEquals</code> ,  ,    ,   <i></i>    -    <code>dynamic</code> C# (     ).       <code>==</code> ,    .   C#,    ,          . <br><br><a name="section26"></a><h3> 26. Select Case   ¬´¬ª (fall-through);   break </h3><br>     Friday    ,  Sunday ‚Äî  ,  5   . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Tuesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Wednesday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Thursday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Friday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekday"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday: <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Sunday: Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Weekend"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/7b7e136c71dd11b2417a6c7267bb3546#file-select-case-no-fallthrough-vb</a> <br><br>     Roslyn C#  ,  -      : <i>¬´,    ?   !¬ª</i>   <i>¬´,  ¬ª</i> .   . VS    ,    ,   ,    ,      ,     .    ! <br><br>       . C# ,        C,       C.       .  , C#     ,    case   .   -  ,     <code>goto</code> ,  <code>break</code> .     VB   <code>break</code> , <code>Exit Select</code> ,       ,    VB   . <br><br><a name="section27"></a><h3> 27.   Case     </h3><br>      ,      .           C#,   : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> Today.DayOfWeek <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Monday, DayOfWeek.Tuesday, DayOfWeek.Wednesday, DayOfWeek.Thursday, DayOfWeek.Friday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Get to work!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> DayOfWeek.Saturday, DayOfWeek.Sunday <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> message = <span class="hljs-string"><span class="hljs-string">"Funtime!"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/bd642061896246c9336255881fb78546#file-select-case-scopes-vb</a> <br><br>   ,  <code>message</code>        ,    C#   <code>switch</code>         <code>case</code> ‚Äî   .     . ,  ,  -    (  ,  C):        , , ,  ,     . <br><br><a name="section28to30"></a><h3> 28, 29, 30. Select Case    ,             = </h3><br> ,  ,     ,            ,     <code>Select Case</code>             . <br><br>             ,       ,     .    : <br><br><ul><li> <code>Select Case</code> ‚Äî  ,           , ‚Ä¶ <br></li><li> <code>switch</code> ‚Äî   / ,   ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>   ¬ª. <br></li></ul><br>  ,    26-30. <code>switch</code>    ,    ,  , ,     <code>if</code> .  IL   <code>switch</code> ,   ,   <code>If</code> ,   VB        ,   .    switch       , ,    C   .  VB    . <br><br><a name="section31"></a><h3> 31. ,   ,         </h3><br>       <code>x</code>    ,      ,      -1, -2, -3: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> Console.WriteLine(x) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/cbc3a9c70677354973d64f1d993a3c5d#file-loop-variables-retain-their-values-vb</a> <br><br>    <i>¬´     ,    ,    ¬ª</i> ( ).   ,      VB2008  ,    -: <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lambdas = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Action) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x As Integer x -= <span class="hljs-number"><span class="hljs-number">1</span></span> lambdas.Add(<span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span>() Console.WriteLine(x)) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> lambda <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> lambdas lambda() <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/2ef9ba3dfcf9a1abe0e94b0cde12faf1#file-loop-variables-captured-per-iteration-vb</a> <br><br>     -1, -2, -3.     <code>x</code> ‚Äî ¬´ ¬ª, -   <code>x</code>    ,      .          ,        <code>x</code>     .     flow analysis API ‚Äî ! ( <i>¬´‚Ä¶ ‚Ä¶  ?¬ª</i> ) <br><br> <b>?</b>   ,  ,      ,    ,      ,        #22.         ,        ,       -,         . <br><br> ,   VB  C#      ( <i>control variables</i> )  <code>For Each</code>  VS2012 (?),  -   ¬´ ¬ª.   10000%    ,    (  , VB      ,      ).  ,    VB         <code>For</code> ,        .            ,      .      ,   VB  <code>For</code>      <code>For Each</code> ,  <code>for</code>  <code>foreach</code>  C#.          ,   <code>For</code>  VB -  ,    ,      . <br><br><a name="section32"></a><h3> 32.    For        </h3><br>         <code>For</code> .        ,   ,       1,3,5,7,9,          ,     . <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> lower = <span class="hljs-number"><span class="hljs-number">1</span></span>, upper = <span class="hljs-number"><span class="hljs-number">9</span></span>, increment = <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = lower <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> upper <span class="hljs-keyword"><span class="hljs-keyword">Step</span></span> increment Console.WriteLine(i) upper += <span class="hljs-number"><span class="hljs-number">1</span></span> increment -= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/1e48113be204f515c51e221858666ac7#file-for-loop-bounds-cached-vb</a> <br><br>    ,          (       ),   ,     ,    ,          <code>IndexOutOfRangeExceptions</code> ,    . <br><br>   ,   ,      , , ,       C,    VB .  - ,  VB ,  <code>For i = a To b Step c</code>   (  ,  <code>i&gt; b</code> )   (  ,  <code>i &lt;b</code> ),   <code>c</code>    ?    ,    ,      ,   <code>b</code>   ,   ‚Äî .    ,     , , ,       . <br><br><a name="section33"></a><h3> 33. For Each   VB     GetEnumerator </h3><br>       <code>For Each</code> ,     <code>IEnumerable</code> ,       <code>GetEnumerator</code>  ,    <code>For Each</code> . <br> ,   ,     <code>For Each</code>  <code>IEnumerator</code>  ,          , : <br><br><pre> <code class="vbscript hljs">Module Program <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> Main() <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> list = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> List(Of Integer) From {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> info = list.FirstAndRest() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> info.First IsNot <span class="hljs-literal"><span class="hljs-literal">Nothing</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Console.Write(info.First.GetValueOrDefault()) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> other <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> info.Additional Console.Write(<span class="hljs-string"><span class="hljs-string">", "</span></span>) Console.Write(other) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> Console.WriteLine() <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Sub</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> FirstAndRest(Of T As Structure)(sequence As IEnumerable(Of T)) As (First As T?, Additional As IEnumerator(Of T)) <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> enumerator = sequence.GetEnumerator() <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> enumerator.MoveNext() <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Return (enumerator.Current, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Return (<span class="hljs-literal"><span class="hljs-literal">Nothing</span></span>, enumerator) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> &lt;Runtime.CompilerServices.Extension&gt; <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> GetEnumerator(Of T)(enumerator As IEnumerator(Of T)) As IEnumerator(Of T) Return enumerator <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Module</code> </pre> <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gist.github.com/AnthonyDGreen/d7dbb7a5b98a940765c4adc33e3eaeee#file-for-each-extension-get-enumerator-vb</a> <br><br>           F#        ,    <code>IEnumerator</code> ,     <code>For Each</code>    ,   . <br><br>  VB   ,            ( <i>well-known name</i> ),      .   , ,   Add,   . C#     ,          (. <code>async</code> / <code>await</code> ).      ,    C# Roslyn ()     ,     . <br><blockquote>  Minuto de publicidad. 15-16   -    .NET- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DotNext 2019 Piter</a> .   ,       .       ,      .     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/443684/">https://habr.com/ru/post/443684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../443672/index.html">Pruebas basadas en riesgo</a></li>
<li><a href="../443676/index.html">Vinilo en lugar de un sello postal: rareza inusual</a></li>
<li><a href="../443678/index.html">Legibilidad de c√≥digo</a></li>
<li><a href="../443680/index.html">Semana laboral de cuatro d√≠as. Experiencia rusa</a></li>
<li><a href="../443682/index.html">Monetizaci√≥n de la nube: c√≥mo atraer clientes y no quebrar</a></li>
<li><a href="../443686/index.html">30 - 31 de marzo, SIBUR CHALLENGE en Nizhny Novgorod</a></li>
<li><a href="../443690/index.html">Parallels RAS: ¬øqu√© es y con qu√© come?</a></li>
<li><a href="../443692/index.html">Alquimia del siglo XXI: conversi√≥n de deuterio de metal l√≠quido a plasma</a></li>
<li><a href="../443694/index.html">C√≥mo ayuda el navegador al camarada mayor</a></li>
<li><a href="../443698/index.html">Google ha dejado de "estrangular al ganso": DuckDuckGo est√° incluido en la lista de motores de b√∫squeda est√°ndar de Chrome para 60 pa√≠ses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>