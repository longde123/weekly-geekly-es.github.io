<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶â üçß ü§ô Berechnung des UEFA-L√§nderverh√§ltnisses üöå ü•ê üïõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gibt zwei beliebte Turniere im Fu√üball: die Champions League und die Europa League. Basierend auf ihren Ergebnissen wird die sogenannte Bewertung v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Berechnung des UEFA-L√§nderverh√§ltnisses</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lsfusion/blog/467279/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/jo/ja/xr/jojaxrvo8padbcbvfqrdsouex_e.jpeg" alt="Bild"></div><br>  Es gibt zwei beliebte Turniere im Fu√üball: die Champions League und die Europa League.  Basierend auf ihren Ergebnissen wird die sogenannte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bewertung von Fu√üballverb√§nden</a> berechnet.  Basierend auf dieser Bewertung wird ferner bestimmt, wie viele Teams aus jedem Land an nachfolgenden Turnieren teilnehmen werden. <br><br>  In diesem Artikel werde ich eine Anwendung erstellen, die auf der offenen und kostenlosen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lsFusion-</a> Plattform basiert und diese Bewertung berechnet.  Es speichert alle seine Daten in PostgreSQL, bietet eine Weboberfl√§che zum √Ñndern und Anzeigen mit Filter- und Sortierfunktionen sowie den Import von √úbereinstimmungsergebnissen mithilfe einer speziellen API. <br><br>  Der gesamte Code zur Implementierung dieser Anwendung besteht aus etwa 300 signifikanten Zeilen. <br><a name="habracut"></a><br><h3>  Dom√§nenlogik </h3><br>  Die Erstellung eines Informationssystems beginnt mit der Aufgabe der Dom√§nenlogik. <br>  Zun√§chst ist es logisch, die einfachsten Verzeichnisse auszuw√§hlen, die nur einen Code und einen Namen haben: <br><br><ul><li>  <b>Turnier</b>  Champions League oder Europa League. </li><li>  <b>Saison</b> .  2018-2019 / 2017-2018 usw. </li><li> <b>Rund</b> .  Finale, Halbfinale, Gruppenphase usw.  Es kann als Komposition f√ºr das Turnier betrachtet werden, aber in dieser Implementierung habe ich es als separate Einheit herausgegriffen. </li><li>  <b>Land</b>  Diese Anwendung wird als Fu√üballverband verwendet.  Zum Beispiel befindet sich der Verein von Monaco im Land von Monaco, spielt aber in der franz√∂sischen Meisterschaft. </li><li>  <b>Club</b>  Barcelona, ‚Äã‚ÄãReal Madrid, Manchester United usw. </li></ul><br>  Da lsFusion dieselbe Art von Logik verwendet, um sie zu deklarieren, deklarieren wir einen Metacode (oder eine Codevorlage), der die entsprechende Logik generiert: <br><br><div class="spoiler">  <b class="spoiler_title">Verzeichnisdeklaration Metacode</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td><code><font color="#a626a4">META</font> defineMasterObject(object, caption, captions, nameLength) <br> <font color="#a626a4">CLASS</font> <font color="#4078f2">###</font> object caption; <br> <br> id <font color="#50a14f">''</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">INTEGER</font> ( <font color="#4078f2">###</font> object); <br> object ( <font color="#a626a4">INTEGER</font> id) = <font color="#a626a4">GROUP</font> <font color="#a626a4">AGGR</font> <font color="#4078f2">###</font> object o <font color="#a626a4">BY</font> id(o); <font color="#808080"><i>//    </i></font> <br> <br> name <font color="#50a14f">''</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">ISTRING</font> ( <font color="#4078f2">###</font> object) <font color="#a626a4">CHARWIDTH</font> nameLength; <br> object ( <font color="#a626a4">ISTRING</font> name) = <font color="#a626a4">GROUP</font> <font color="#a626a4">AGGR</font> <font color="#4078f2">###</font> object o <font color="#a626a4">BY</font> name(o); <font color="#808080"><i>//    </i></font> <br> <br> <font color="#a626a4">FORM</font> object caption <br> <font color="#a626a4">OBJECTS</font> o = <font color="#4078f2">###</font> object <font color="#a626a4">PANEL</font> <br> <font color="#a626a4">PROPERTIES</font> (o) id, name <br> <br> <font color="#a626a4">EDIT</font> <font color="#4078f2">###</font> object <font color="#a626a4">OBJECT</font> o <br> ; <br> <br> <font color="#a626a4">FORM</font> object <font color="#4078f2">##</font> s captions <br> <font color="#a626a4">OBJECTS</font> o = <font color="#4078f2">###</font> object <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">READONLY</font> id, name <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">NEWSESSION</font> <font color="#a626a4">NEW</font> , <font color="#a626a4">EDIT</font> , <font color="#a626a4">DELETE</font> <br> ; <br> <br> <font color="#a626a4">FORM</font> dialog <font color="#4078f2">###</font> object <font color="#4078f2">##</font> s captions <br> <font color="#a626a4">OBJECTS</font> o = <font color="#4078f2">###</font> object <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">READONLY</font> id, name <br> <br> <font color="#a626a4">LIST</font> <font color="#4078f2">###</font> object <font color="#a626a4">OBJECT</font> o <br> ; <br> <br> <font color="#a626a4">NAVIGATOR</font> { <br> <font color="#a626a4">NEW</font> object <font color="#4078f2">##</font> s; <br> } <br> <font color="#a626a4">END</font> <br></code> </td></tr></tbody></table></div><br></div></div><br>  Er wird bekannt geben: <br><br><ul><li>  Klasse mit Vornamen </li><li>  Eigenschaften mit Code und Name f√ºr die neue Klasse </li><li>  Drei Formulare: Bearbeiten eines Objekts, ein Formular mit einer Liste aller Objekte, das dann dem Navigator hinzugef√ºgt wird, ein Dialogfeld zur Auswahl dieses Objekts.  Als Dialog k√∂nnen Sie das zweite Formular verwenden, aber dann hat der Benutzer die M√∂glichkeit, Objekte bei der Auswahl zu √§ndern, was zu Fehlern seitens der Benutzer f√ºhren kann. </li></ul><br>  Vier Parameter werden an den Metacode √ºbergeben: <br><br><ul><li>  <b>Kennung (Objekt)</b> .  Mit diesem Namen werden Klassen und Formulare erstellt.  Das Konstrukt ### wird verwendet, um den ersten Buchstaben des Bezeichners im resultierenden Code gro√ü zu schreiben. </li><li>  <b>Name im Singular</b> .  Wird f√ºr den Titel der Klasse und des Formulars verwendet. </li><li>  <b>Der Name steht im Plural</b> .  Wird f√ºr Kombinationsfeld und Dialog verwendet. </li><li>  <b>Name L√§nge</b> .  Bei den Namen verschiedener Objekte werden unterschiedliche L√§ngen erwartet, was beim Erstellen der Schnittstelle wichtig ist. </li></ul><br>  F√ºgen Sie mithilfe des erstellten Metacodes die f√ºnf oben beschriebenen Entit√§ten hinzu: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#4078f2">@defineMasterObject</font> (tournament, <font color="#50a14f">''</font> , <font color="#50a14f">''</font> , <font color="#986801">20</font> ); <br> <font color="#4078f2">@defineMasterObject</font> (season, <font color="#50a14f">''</font> , <font color="#50a14f">''</font> , <font color="#986801">5</font> ); <br> <font color="#4078f2">@defineMasterObject</font> (round, <font color="#50a14f">''</font> , <font color="#50a14f">''</font> , <font color="#986801">15</font> ); <br> <font color="#4078f2">@defineMasterObject</font> (country, <font color="#50a14f">''</font> , <font color="#50a14f">''</font> , <font color="#986801">10</font> ); <br> <font color="#4078f2">@defineMasterObject</font> (team, <font color="#50a14f">''</font> , <font color="#50a14f">''</font> , <font color="#986801">20</font> ); <br></code> </td></tr></tbody></table></div><br><br>  Der generierte Code f√ºr ein Turnier sieht beispielsweise folgenderma√üen aus: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">CLASS</font> Tournament <font color="#50a14f">''</font> ; <br> <br> id <font color="#50a14f">''</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">INTEGER</font> (Tournament); <br> tournament ( <font color="#a626a4">INTEGER</font> id) = <font color="#a626a4">GROUP</font> <font color="#a626a4">AGGR</font> Tournament o <font color="#a626a4">BY</font> id(o); <br> <br> name <font color="#50a14f">''</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">ISTRING</font> (Tournament) <font color="#a626a4">CHARWIDTH</font> <font color="#986801">20</font> ; <br> tournament ( <font color="#a626a4">ISTRING</font> name) = <font color="#a626a4">GROUP</font> <font color="#a626a4">AGGR</font> Tournament o <font color="#a626a4">BY</font> name(o); <br> <br> <font color="#a626a4">FORM</font> tournament <font color="#50a14f">''</font> <br> <font color="#a626a4">OBJECTS</font> o = Tournament <font color="#a626a4">PANEL</font> <br> <font color="#a626a4">PROPERTIES</font> (o) id, name <br> <br> <font color="#a626a4">EDIT</font> Tournament <font color="#a626a4">OBJECT</font> o <br> ; <br> <br> <font color="#a626a4">FORM</font> tournaments <font color="#50a14f">''</font> <br> <font color="#a626a4">OBJECTS</font> o = Tournament <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">READONLY</font> id, name <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">NEWSESSION</font> <font color="#a626a4">NEW</font> , <font color="#a626a4">EDIT</font> , <font color="#a626a4">DELETE</font> <br> ; <br> <br> <font color="#a626a4">FORM</font> dialogTournaments <font color="#50a14f">''</font> <br> <font color="#a626a4">OBJECTS</font> o = Tournament <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">READONLY</font> id, name <br> <br> <font color="#a626a4">LIST</font> Tournament <font color="#a626a4">OBJECT</font> o <br> ; <br> <br> <font color="#a626a4">NAVIGATOR</font> { <br> <font color="#a626a4">NEW</font> tournaments; <br> } <br></code> </td></tr></tbody></table></div><br>  F√ºgen Sie der generierten Clublogik den Link zum Land hinzu.  Erstellen Sie dazu zun√§chst die entsprechende Eigenschaft, die Sie dann in die Bearbeitungs- und Anzeigeformulare des Clubs einf√ºgen: <br><div class="scrollable-table"><table><tbody><tr><td> <code>country = <font color="#a626a4">DATA</font> Country (Team); <br> nameCountry <font color="#50a14f">''</font> (Team t) = name(country(t)); <br> <br> <font color="#a626a4">EXTEND</font> <font color="#a626a4">FORM</font> team <font color="#a626a4">PROPERTIES</font> (o) nameCountry; <br> <font color="#a626a4">EXTEND</font> <font color="#a626a4">FORM</font> teams <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">READONLY</font> nameCountry; <br></code> </td></tr></tbody></table></div><br>  Wir legen die gesamte erstellte Logik in einem separaten Master-Modul (Datei Master.lsf) ab. <br><br>  Erstellen Sie nun eine Entit√§tsliga.  Sie wird das Turnier einer bestimmten Saison bestimmen.  Zum Beispiel Champions League 2017-18 oder Europa League 2018-19.  Die Liga hat keinen Namen, sondern nur Links zum Turnier und zur Saison.  Daher werden wir den vorherigen Metacode nicht verwenden, aber wir werden dieselbe Logik ausf√ºhren und sie in das neue Ligamodul einf√ºgen: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">MODULE</font> League; <br> <br> <font color="#a626a4">REQUIRE</font> Master; <br> <br> <font color="#a626a4">CLASS</font> League <font color="#50a14f">''</font> ; <br> <br> id <font color="#50a14f">''</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">INTEGER</font> (League); <br> league ( <font color="#a626a4">INTEGER</font> id) = <font color="#a626a4">GROUP</font> <font color="#a626a4">AGGR</font> League o <font color="#a626a4">BY</font> id(o); <br> <br> tournament = <font color="#a626a4">DATA</font> Tournament (League); <br> nameTournament <font color="#50a14f">''</font> (League l)= name(tournament(l)); <br> <br> season = <font color="#a626a4">DATA</font> Season(League); <br> nameSeason <font color="#50a14f">''</font> (League l)= name(season(l)); <br> <br> <font color="#a626a4">FORM</font> league <font color="#50a14f">''</font> <br> <font color="#a626a4">OBJECTS</font> o = League <font color="#a626a4">PANEL</font> <br> <font color="#a626a4">PROPERTIES</font> (o) id, nameTournament, nameSeason <br> <br> <font color="#a626a4">EDIT</font> League <font color="#a626a4">OBJECT</font> o <br> ; <br> <br> <font color="#a626a4">FORM</font> leagues <font color="#50a14f">''</font> <br> <font color="#a626a4">OBJECTS</font> o = League <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">READONLY</font> id, nameTournament, nameSeason <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">NEWSESSION</font> <font color="#a626a4">NEW</font> , <font color="#a626a4">EDIT</font> , <font color="#a626a4">DELETE</font> <br> ; <br> <br> <font color="#a626a4">FORM</font> dialogLeagues <font color="#50a14f">''</font> <br> <font color="#a626a4">OBJECTS</font> o = League <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">READONLY</font> id, nameTournament, nameSeason <br> <br> <font color="#a626a4">LIST</font> League <font color="#a626a4">OBJECT</font> o <br> ; <br> <br> <font color="#a626a4">NAVIGATOR</font> { <br> <font color="#a626a4">NEW</font> leagues; <br> } <br></code> </td></tr></tbody></table></div><br>  Und schlie√ülich f√ºgen Sie die Logik der √úbereinstimmungen hinzu.  Erstellen Sie dazu die Klasse <i>Match</i> , die sich auf die Liga und die Runde bezieht.  F√ºr ihn werden auch die Vereine, die daran teilgenommen haben, und das Ergebnis gefragt.  Wir haben dies alles in einem separaten Match-Modul zusammengefasst: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">MODULE</font> Match; <br> <br> <font color="#a626a4">REQUIRE</font> League; <br> <br> <font color="#a626a4">CLASS</font> Match <font color="#50a14f">''</font> ; <br> <br> id <font color="#50a14f">''</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">INTEGER</font> (Match); <br> match ( <font color="#a626a4">INTEGER</font> id) = <font color="#a626a4">GROUP</font> <font color="#a626a4">AGGR</font> Match o <font color="#a626a4">BY</font> id(o); <br> <br> dateTime <font color="#50a14f">''</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">DATETIME</font> (Match); <br> <br> league = <font color="#a626a4">DATA</font> League (Match); <br> <br> tournament (Match m) = tournament(league(m)); <br> nameTournament <font color="#50a14f">''</font> (Match m) = name(tournament(m)); <br> <br> season(Match m) = season(league(m)); <br> nameSeason <font color="#50a14f">''</font> (Match m) = name(season(m)); <br> <br> round = <font color="#a626a4">DATA</font> Round (Match); <br> nameRound <font color="#50a14f">''</font> (Match m) = name(round(m)); <br> <br> homeTeam = <font color="#a626a4">DATA</font> Team (Match); <br> nameHomeTeam <font color="#50a14f">''</font> (Match m) = name(homeTeam(m)); <br> <br> awayTeam = <font color="#a626a4">DATA</font> Team (Match); <br> nameAwayTeam <font color="#50a14f">''</font> (Match m) = name(awayTeam(m)); <br> <br> goalsHome <font color="#50a14f">' ()'</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">INTEGER</font> (Match); <br> goalsAway <font color="#50a14f">' ()'</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">INTEGER</font> (Match); <br> <br> <font color="#a626a4">FORM</font> match <font color="#50a14f">''</font> <br> <font color="#a626a4">OBJECTS</font> o = Match <font color="#a626a4">PANEL</font> <br> <font color="#a626a4">PROPERTIES</font> (o) id, dateTime, nameTournament, nameSeason, nameRound, <br> nameHomeTeam, goalsHome, goalsAway, nameAwayTeam <br> <br> <font color="#a626a4">EDIT</font> Match <font color="#a626a4">OBJECT</font> o <br> ; <br> <br> <font color="#a626a4">FORM</font> matches <font color="#50a14f">''</font> <br> <font color="#a626a4">OBJECTS</font> o = Match <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">READONLY</font> id, dateTime, nameTournament, nameSeason, nameRound, <br> nameHomeTeam, goalsHome, goalsAway, nameAwayTeam <br> <font color="#a626a4">PROPERTIES</font> (o) <font color="#a626a4">NEWSESSION</font> <font color="#a626a4">NEW</font> , <font color="#a626a4">EDIT</font> , <font color="#a626a4">DELETE</font> <br> <br> <font color="#a626a4">LIST</font> Match <font color="#a626a4">OBJECT</font> o <br> ; <br> <br> <font color="#a626a4">NAVIGATOR</font> { <br> <font color="#a626a4">NEW</font> matches; <br> } <br></code> </td></tr></tbody></table></div><br><br><h3>  Datenimport </h3><br>  Leider konnte ich nur eine √∂ffentliche und kostenlose API finden, die alle Eurocups unterst√ºtzt.  Dies ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Fu√üball-API</a> .  Es gibt jedoch Probleme: <br><br><ul><li>  Bis 2016 liegen keine Ergebnisse vor. </li><li>  Bis 2018 gibt es keine Qualifikationen f√ºr die Europa League. </li><li>  Es gibt bestimmte Fehler in den Daten.  Zum Beispiel wird Irtysch Pavlodar Russland zugewiesen, obwohl dieser Verein Kasachstan vertritt.  Au√üerdem bezieht sich Europa Fc aus irgendeinem Grund auf Spanien anstelle von Gibraltar. </li></ul><br><br>  Datenfehler k√∂nnen mithilfe zuvor erstellter Formulare manuell korrigiert werden.  Da die Berechnung des Gesamtkoeffizienten jedoch auf den letzten f√ºnf Jahren basiert, funktioniert es leider nicht, den Gesamtkoeffizienten aus den API Football-Daten zu berechnen.  Wenn jemand in den Kommentaren vorschl√§gt, wo er die erforderlichen Daten in einem beliebigen Format aus den vergangenen Jahren erhalten kann, bin ich sehr dankbar.  Da jedoch vollst√§ndige Daten f√ºr 2018 vorliegen, kann die Richtigkeit der Berechnung mindestens f√ºr dieses Jahr √ºberpr√ºft werden. <br><br>  Die von uns ben√∂tigte API wird in Form von HTTP-Anfragen implementiert, bei denen Parameter per URL √ºbertragen werden und ein spezieller Zugriffsschl√ºssel im Header angegeben ist.  Deklarieren Sie die entsprechende Logik: <br><div class="scrollable-table"><table><tbody><tr><td> <code>host = <font color="#50a14f">'api-football-v1.p.rapidapi.com'</font> ; <br> key <font color="#50a14f">'  API Football'</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">STRING</font> () <font color="#a626a4">CHARWIDTH</font> <font color="#986801">50</font> ; <br> <br> url = <font color="#50a14f">'https://'</font> + host() + <font color="#50a14f">'/v2'</font> ; <br> <br> headers( <font color="#a626a4">TEXT</font> name) = <font color="#a626a4">CASE</font> <br> <font color="#a626a4">WHEN</font> name = <font color="#50a14f">'x-rapidapi-host'</font> <font color="#a626a4">THEN</font> host() <br> <font color="#a626a4">WHEN</font> name = <font color="#50a14f">'x-rapidapi-key'</font> <font color="#a626a4">THEN</font> key(); <br></code> </td></tr></tbody></table></div><br>  Alle Datenimportaktionen werden auf dem zuvor erstellten <i>Ligenformular platziert</i> .  Dort platzieren wir den Zugriffsschl√ºssel in der Symbolleiste der Tabelle mit der Liste der Ligen: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">EXTEND</font> <font color="#a626a4">FORM</font> leagues <br> <font color="#a626a4">PROPERTIES</font> () key <font color="#a626a4">DRAW</font> o <font color="#a626a4">TOOLBAR</font> <br> ; <br></code> </td></tr></tbody></table></div><br><br>  Zun√§chst implementieren wir die Liste der Ligen.  Daf√ºr hat die Fu√üball-API eine spezielle URL: / Ligen.  Eine GET-Anforderung gibt JSON des Formulars zur√ºck: <br><br><div class="spoiler">  <b class="spoiler_title">Die Antwort</b> <div class="spoiler_text"><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"api"</span></span>:{ <span class="hljs-attr"><span class="hljs-attr">"results"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"leagues"</span></span>:[ { <span class="hljs-attr"><span class="hljs-attr">"league_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018 Russia World Cup"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:<span class="hljs-string"><span class="hljs-string">"World"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"country_code"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"season"</span></span>:<span class="hljs-number"><span class="hljs-number">2018</span></span>, <span class="hljs-attr"><span class="hljs-attr">"season_start"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-06-14"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"season_end"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-07-15"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logo"</span></span>:<span class="hljs-string"><span class="hljs-string">"https://www.api-football.com/public/leagues/1.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"flag"</span></span>:<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"standings"</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"is_current"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"league_id"</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Premier League"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"country"</span></span>:<span class="hljs-string"><span class="hljs-string">"England"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"country_code"</span></span>:<span class="hljs-string"><span class="hljs-string">"GB"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"season"</span></span>:<span class="hljs-number"><span class="hljs-number">2018</span></span>, <span class="hljs-attr"><span class="hljs-attr">"season_start"</span></span>:<span class="hljs-string"><span class="hljs-string">"2018-08-10"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"season_end"</span></span>:<span class="hljs-string"><span class="hljs-string">"2019-05-12"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"logo"</span></span>:<span class="hljs-string"><span class="hljs-string">"https://www.api-football.com/public/leagues/2.png"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"flag"</span></span>:<span class="hljs-string"><span class="hljs-string">"https://www.api-football.com/public/flags/gb.svg"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"standings"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"is_current"</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> } ] } }</code> </pre> </div></div><br><br>  Um eine GET-Anforderung zu generieren und den Antworttext aufzuzeichnen, wird die folgende Konstruktion verwendet: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">LOCAL</font> result = <font color="#a626a4">FILE</font> (); <br> <font color="#a626a4">EXTERNAL</font> <font color="#a626a4">HTTP</font> <font color="#a626a4">GET</font> url() + <font color="#50a14f">'/leagues'</font> <font color="#a626a4">HEADERS</font> headers <font color="#a626a4">TO</font> result; <br></code> </td></tr></tbody></table></div><br>  Das <i>Ergebnis wird</i> ohne Parameter vom Typ FILE in die lokale <i>Ergebniseigenschaft geschrieben</i> . <br><br>  Um eine Datei im JSON-Format zu analysieren, wird ein Formular erstellt, dessen Struktur der JSON-Struktur entspricht.  Sie k√∂nnen es in der IDE √ºber den Men√ºpunkt generieren: <br><br><img src="https://habrastorage.org/webt/wx/zf/8o/wxzf8oy-hnpcpdffxhltnfrrwcy.png" alt="Bild"><br><br>  F√ºr den obigen JSON sieht das Formular folgenderma√üen aus (wobei nur die Werte ber√ºcksichtigt werden, die importiert werden): <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">GROUP</font> api; <br> <br> tournamentName = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">STRING</font> ( <font color="#a626a4">INTEGER</font> ); <br> seasonName = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">STRING</font> ( <font color="#a626a4">INTEGER</font> ); <br> leagueId = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">INTEGER</font> ( <font color="#a626a4">INTEGER</font> ); <br> <br> <font color="#a626a4">FORM</font> importLeagues <br> <font color="#a626a4">OBJECTS</font> leagues = <font color="#a626a4">INTEGER</font> <font color="#a626a4">IN</font> api <br> <font color="#a626a4">PROPERTIES</font> (leagues) name = tournamentName, season = seasonName, league_id = leagueId <br> ; <br></code> </td></tr></tbody></table></div><br>  Verwenden Sie den folgenden Befehl <i>,</i> um direkt aus der JSON- <i>Ergebniseigenschaft</i> im Format des <i>importLeagues-</i> Formulars zu <i>importieren</i> : <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">IMPORT</font> importLeagues <font color="#a626a4">JSON</font> <font color="#a626a4">FROM</font> result(); <br></code> </td></tr></tbody></table></div><br>  Nach der Ausf√ºhrung werden die entsprechenden Werte aus der JSON-Datei in den Eigenschaften <i>TournamentName</i> , <i>SeasonName</i> und <i>LeagueId abgelegt</i> : <br><br><img src="https://habrastorage.org/webt/vg/va/sq/vgvasqm0awmpbqdweoumd2ha8ty.png" alt="Bild"><br><br>  Das hei√üt, der Wert f√ºr <i>Turniername (0)</i> ist "Weltmeisterschaft" und in <i>Turniername (1) ist es</i> "Premier League". <br><br>  Leider hat API Football √ºberhaupt keine Turniereinheit.  Die einzige M√∂glichkeit, alle Ligen zu verkn√ºpfen, besteht darin, einen Namen zu haben, der mit den Ligen desselben Turniers aus verschiedenen Spielzeiten √ºbereinstimmt.  Dazu gruppieren wir beim Import zun√§chst alle Namen der importierten Ligen und erstellen, falls nicht in der Datenbank, neue Turniere: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">FOR</font> [ <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">BY</font> tournamentName( <font color="#a626a4">INTEGER</font> i)]( <font color="#a626a4">STRING</font> tn) <font color="#a626a4">AND</font> <font color="#a626a4">NOT</font> tournament(tn) <font color="#a626a4">DO</font> <font color="#a626a4">NEW</font> t = Tournament { <br> name(t) &lt;- tn; <br> } <br></code> </td></tr></tbody></table></div><br>  Es gibt auch keine Codes f√ºr die Jahreszeiten. Wenn Sie also Ligen importieren, werden diese auf die gleiche Weise erstellt.  Nachdem die fehlenden Objekte erstellt wurden, werden die Ligen direkt importiert.  Turniere und Spielzeiten werden anhand der zuvor von <i>GROUP AGGR erstellten</i> Eigenschaften nach Namen <i>durchsucht</i> : <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">FOR</font> leagueId( <font color="#a626a4">INTEGER</font> i) <font color="#a626a4">AND</font> <font color="#a626a4">NOT</font> league(leagueId(i)) <font color="#a626a4">DO</font> <font color="#a626a4">NEW</font> l = League { <br> id(l) &lt;- leagueId(i); <br> tournament(l) &lt;- tournament(tournamentName(i)); <br> season(l) &lt;- season(seasonName(i)); <br> } <br></code> </td></tr></tbody></table></div><br>  Standardm√§√üig werden die Daten geladen, jedoch nur in der Datenbank gespeichert, wenn der Benutzer im Formular auf die Schaltfl√§che Speichern klickt.  Bei Bedarf k√∂nnen Sie den Befehl <i>APPLY</i> am Ende der Aktion hinzuf√ºgen, damit er ohne Vorschau sofort in der Datenbank gespeichert wird. <br><br>  Und schlie√ülich f√ºgen Sie die Importaktion zum Ligalistenformular hinzu: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">EXTEND</font> <font color="#a626a4">FORM</font> leagues <br> <font color="#a626a4">PROPERTIES</font> () importLeagues <font color="#a626a4">DRAW</font> o <font color="#a626a4">TOOLBAR</font> <br> ; <br></code> </td></tr></tbody></table></div><br>  Ebenso importieren wir Vereine und Spiele.  Da die API jedoch die M√∂glichkeit bietet, sie nur f√ºr eine bestimmte Liga zu importieren, muss die Aktion die Liga als Eingabe verwenden: <br><br><div class="spoiler">  <b class="spoiler_title">Vereine und Spiele importieren</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#808080"><i>//  </i></font> <br> teamId = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">INTEGER</font> ( <font color="#a626a4">INTEGER</font> ); <br> teamName = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">STRING</font> ( <font color="#a626a4">INTEGER</font> ); <br> countryName = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">STRING</font> ( <font color="#a626a4">INTEGER</font> ); <br> <br> <font color="#a626a4">FORM</font> importTeams <br> <font color="#a626a4">OBJECTS</font> teams = <font color="#a626a4">INTEGER</font> <font color="#a626a4">IN</font> api <br> <font color="#a626a4">PROPERTIES</font> (teams) team_id = teamId, name = teamName, country = countryName <br> ; <br> <br> importTeams <font color="#50a14f">' '</font> (League l) { <br> <font color="#a626a4">LOCAL</font> result = <font color="#a626a4">FILE</font> (); <br> <font color="#a626a4">EXTERNAL</font> <font color="#a626a4">HTTP</font> <font color="#a626a4">GET</font> url() + <font color="#50a14f">'/teams/league/'</font> + id(l) <font color="#a626a4">HEADERS</font> headers <font color="#a626a4">TO</font> result; <br> <br> <font color="#a626a4">IMPORT</font> importTeams <font color="#a626a4">JSON</font> <font color="#a626a4">FROM</font> result(); <br> <font color="#a626a4">FOR</font> [ <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">BY</font> countryName( <font color="#a626a4">INTEGER</font> i)]( <font color="#a626a4">STRING</font> cn) <font color="#a626a4">AND</font> <font color="#a626a4">NOT</font> country(cn) <font color="#a626a4">DO</font> <font color="#a626a4">NEW</font> c = Country { <br> name(c) &lt;- cn; <br> } <br> <br> <font color="#a626a4">FOR</font> teamId( <font color="#a626a4">INTEGER</font> i) <font color="#a626a4">AND</font> <font color="#a626a4">NOT</font> team(teamId(i)) <font color="#a626a4">DO</font> <font color="#a626a4">NEW</font> t = Team { <br> id(t) &lt;- teamId(i); <br> name(t) &lt;- teamName(i); <br> country(t) &lt;- country(countryName(i)); <br> } <br> } <br> <br> <font color="#808080"><i>//  </i></font> <br> <br> matchId = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">INTEGER</font> ( <font color="#a626a4">INTEGER</font> ); <br> dateTime = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">STRING</font> ( <font color="#a626a4">INTEGER</font> ); <br> roundName = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">STRING</font> ( <font color="#a626a4">INTEGER</font> ); <br> <br> <font color="#a626a4">GROUP</font> homeTeam; <br> homeTeamId = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">INTEGER</font> ( <font color="#a626a4">INTEGER</font> ); <br> <br> <font color="#a626a4">GROUP</font> awayTeam; <br> awayTeamId = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">INTEGER</font> ( <font color="#a626a4">INTEGER</font> ); <br> <br> goalsHome = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">INTEGER</font> ( <font color="#a626a4">INTEGER</font> ); <br> goalsAway = <font color="#a626a4">DATA</font> <font color="#a626a4">LOCAL</font> <font color="#a626a4">INTEGER</font> ( <font color="#a626a4">INTEGER</font> ); <br> <br> <font color="#a626a4">FORM</font> importMatches <br> <font color="#a626a4">OBJECTS</font> fixtures = <font color="#a626a4">INTEGER</font> <font color="#a626a4">IN</font> api <br> <font color="#a626a4">PROPERTIES</font> (fixtures) fixture_id = matchId, league_id = leagueId, event_date = dateTime, round = roundName, <br> homeTeamId <font color="#a626a4">IN</font> homeTeam <font color="#a626a4">EXTID</font> <font color="#50a14f">'team_id'</font> , <br> awayTeamId <font color="#a626a4">IN</font> awayTeam <font color="#a626a4">EXTID</font> <font color="#50a14f">'team_id'</font> , <br> goalsHomeTeam = goalsHome, goalsAwayTeam = goalsAway <br> ; <br> <br> importMatches <font color="#50a14f">' '</font> (League l) { <br> <font color="#a626a4">LOCAL</font> result = <font color="#a626a4">FILE</font> (); <br> <font color="#a626a4">EXTERNAL</font> <font color="#a626a4">HTTP</font> <font color="#a626a4">GET</font> url() + <font color="#50a14f">'/fixtures/league/'</font> + id(l) <font color="#a626a4">HEADERS</font> headers <font color="#a626a4">TO</font> result; <br> <br> <font color="#a626a4">IMPORT</font> importMatches <font color="#a626a4">JSON</font> <font color="#a626a4">FROM</font> result(); <br> <font color="#a626a4">FOR</font> [ <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">BY</font> awayTeamId( <font color="#a626a4">INTEGER</font> i)]( <font color="#a626a4">INTEGER</font> id) <font color="#a626a4">AND</font> <font color="#a626a4">NOT</font> team(id) <font color="#a626a4">DO</font> { <br> <font color="#a626a4">MESSAGE</font> <font color="#50a14f">'      '</font> + id; <br> <font color="#a626a4">RETURN</font> ; <br> } <br> <br> <font color="#a626a4">FOR</font> [ <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">BY</font> awayTeamId( <font color="#a626a4">INTEGER</font> i)]( <font color="#a626a4">INTEGER</font> id) <font color="#a626a4">AND</font> <font color="#a626a4">NOT</font> team(id) <font color="#a626a4">DO</font> { <br> <font color="#a626a4">MESSAGE</font> <font color="#50a14f">'      '</font> + id; <br> <font color="#a626a4">RETURN</font> ; <br> } <br> <br> <font color="#a626a4">FOR</font> [ <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">BY</font> roundName( <font color="#a626a4">INTEGER</font> i)]( <font color="#a626a4">STRING</font> rn) <font color="#a626a4">AND</font> <font color="#a626a4">NOT</font> round(rn) <font color="#a626a4">DO</font> <font color="#a626a4">NEW</font> r = Round { <br> name(r) &lt;- rn; <br> } <br> <br> <font color="#a626a4">FOR</font> matchId( <font color="#a626a4">INTEGER</font> i) <font color="#a626a4">AND</font> <font color="#a626a4">NOT</font> match(matchId(i)) <font color="#a626a4">DO</font> <font color="#a626a4">NEW</font> m = Match { <br> id(m) &lt;- matchId(i); <br> dateTime(m) &lt;- toDateTimeFormat(left(dateTime(i), <font color="#986801">19</font> ), <font color="#50a14f">'yyyy-MM-ddThh24:mi:ss'</font> ); <br> league(m) &lt;- league(leagueId(i)); <br> round(m) &lt;- round(roundName(i)); <br> homeTeam(m) &lt;- team(homeTeamId(i)); <br> awayTeam(m) &lt;- team(awayTeamId(i)); <br> goalsHome(m) &lt;- goalsHome(i); <br> goalsAway(m) &lt;- goalsAway(i); <br> } <br> } <br></code> </td></tr></tbody></table></div><br>  Es gibt eine Besonderheit f√ºr Spiele: <i>Teamcodes</i> <i>befinden</i> sich in zus√§tzlichen <i>homeTeam-</i> und <i>awayTeam-Tags</i> .  Entsprechend der API werden f√ºr sie entsprechende Gruppen erstellt.  Au√üerdem haben sie im Inneren die gleichen <i>team_id-</i> Tags.  Da dem Formular keine Eigenschaften mit demselben Namen hinzugef√ºgt werden k√∂nnen, wird das spezielle Schl√ºsselwort <i>EXTID verwendet</i> , das den Tag-Namen im importierten JSON definiert. <br><br>  Damit alle Importe in derselben Form vorliegen und an Ligen gebunden sind, nehmen wir sie alle in dieselbe Form.  Au√üerdem f√ºgen wir dem Formular Teams und Spiele hinzu, um zu sehen, was vor dem Speichern importiert wird: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">EXTEND</font> <font color="#a626a4">FORM</font> leagues <br> <font color="#a626a4">OBJECTS</font> t = Team <br> <font color="#a626a4">PROPERTIES</font> (t) <font color="#a626a4">READONLY</font> id, name <br> <br> <font color="#a626a4">PROPERTIES</font> importTeams(o) <font color="#a626a4">DRAW</font> t <font color="#a626a4">TOOLBAR</font> <br> <br> <font color="#a626a4">OBJECTS</font> m = Match <br> <font color="#a626a4">PROPERTIES</font> (m) <font color="#a626a4">READONLY</font> id, dateTime, nameRound, nameHomeTeam, goalsHome, goalsAway, nameAwayTeam <br> <font color="#a626a4">FILTERS</font> league(m) = o <br> <br> <font color="#a626a4">PROPERTIES</font> importMatches(o) <font color="#a626a4">DRAW</font> m <font color="#a626a4">TOOLBAR</font> <br> ; <br> <br> <font color="#a626a4">DESIGN</font> leagues { <br> <font color="#a626a4">OBJECTS</font> { <br> <font color="#a626a4">NEW</font> leagueDetails { <br> fill = <font color="#986801">2</font> ; <br> type = <font color="#a626a4">SPLITH</font> ; <br> <font color="#a626a4">MOVE</font> <font color="#a626a4">BOX</font> (t); <br> <font color="#a626a4">MOVE</font> <font color="#a626a4">BOX</font> (m); <br> } <br> } <br> } <br></code> </td></tr></tbody></table></div></div></div><br><br>  Das resultierende Formular sieht folgenderma√üen aus: <br><img src="https://habrastorage.org/webt/is/ot/y6/isoty6b7twgeg3zssi-8tdxkyv4.gif" alt="Bild"><br><br>  Alle Importe werden in ein separates APIFootball-Modul gestellt. <br><br><h3>  Koeffizientenberechnung </h3><br>  Wir fahren direkt mit der Berechnung des UEFA-L√§nderkoeffizienten fort.  Es ist logisch, den gesamten Code daf√ºr in ein speziell installiertes UEFA-Modul zu stellen. <br><br>  Denken Sie zun√§chst daran, dass die Fu√üball-API eine Schnittstelle zum Importieren aller Spiele und nicht nur von Eurocups bietet.  Daher trennen wir Eurocup-Spiele nach dem Namen des Turniers (es ist korrekter, eine separate prim√§re Eigenschaft daf√ºr zu haben, aber die Implementierung der Eigenschaften kann immer ge√§ndert werden, ohne den Rest der Logik zu √§ndern): <br><div class="scrollable-table"><table><tbody><tr><td> <code>isCL (Tournament t) = name(t) = <font color="#50a14f">'Champions League'</font> ; <br> isEL (Tournament t) = name(t) = <font color="#50a14f">'Europa League'</font> ; <br> <br> isUL (Tournament t) = isCL(t) <font color="#a626a4">OR</font> isEL(t); <br> isUL (Match m) = isUL(tournament(m)); <br></code> </td></tr></tbody></table></div><br>  Berechnen wir zun√§chst die Punkte, die jeder Verein in einer Saison f√ºr die Ergebnisse bestimmter Spiele erh√§lt. <br><blockquote>  W√§hrend dieser Zeit erh√§lt jedes Team: <br>  2 Punkte im Falle eines Sieges; <br>  1 Punkt bei Gleichstand. <br>  Seit 1999 werden diese Punkte zweigeteilt, wenn sie in Qualifikationsrunden gesammelt werden, dh: <br>  1 Punkt im Falle eines Sieges; <br>  0,5 Punkte f√ºr ein Unentschieden. <br></blockquote><br><br>  Erstellen Sie zus√§tzliche Eigenschaften, die die Beziehung zwischen dem Spiel und dem Verein bestimmen: <br><div class="scrollable-table"><table><tbody><tr><td> <code>played (Team t, Match m) = homeTeam(m) = t <font color="#a626a4">OR</font> awayTeam(m) = t; <br> won (Team t, Match m) = (homeTeam(m) = t <font color="#a626a4">AND</font> goalsHome(m) &gt; goalsAway(m)) <font color="#a626a4">OR</font> (awayTeam(m) = t <font color="#a626a4">AND</font> goalsHome(m) &lt; goalsAway(m)); <br> draw (Team t, Match m) = played(t, m) <font color="#a626a4">AND</font> goalsHome(m) = goalsAway(m); <br></code> </td></tr></tbody></table></div><br>  Um zu bestimmen, wie viele Punkte in jedem Spiel erzielt werden, f√ºgen wir die prim√§re Eigenschaft des numerischen Typs f√ºr die Runde hinzu, die standardm√§√üig gleich eins ist: <br><div class="scrollable-table"><table><tbody><tr><td> <code>dataMatchCoeff = <font color="#a626a4">DATA</font> <font color="#a626a4">NUMERIC</font> [ <font color="#986801">10</font> , <font color="#986801">1</font> ] (Round); <br> matchCoeff <font color="#50a14f">' '</font> (Round r) = <font color="#a626a4">OVERRIDE</font> dataMatchCoeff(r), <font color="#986801">1.0</font> ; <br></code> </td></tr></tbody></table></div><br>  Dann z√§hlen wir Punkte f√ºr Siege und Unentschieden und addieren: <br><div class="scrollable-table"><table><tbody><tr><td> <code>wonPoints <font color="#50a14f">'  '</font> (Season s, Team t) = <br> <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">2</font> * matchCoeff(round(Match m)) <font color="#a626a4">IF</font> won(t, m) <font color="#a626a4">AND</font> season(m) = s <font color="#a626a4">AND</font> isUL(m); <br> drawPoints <font color="#50a14f">'  '</font> (Season s, Team t) = <br> <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> * matchCoeff(round(Match m)) <font color="#a626a4">IF</font> draw(t, m) <font color="#a626a4">AND</font> season(m) = s <font color="#a626a4">AND</font> isUL(m); <br> matchPoints <font color="#50a14f">'  '</font> (Season s, Team t) = wonPoints(s, t) (+) drawPoints(s, t) <font color="#a626a4">MATERIALIZED</font> ; <br></code> </td></tr></tbody></table></div><br>  Punkte f√ºr √úbereinstimmungen werden als MATERIALISIERT markiert, damit sie in der Tabelle gespeichert und nicht jedes Mal berechnet werden. <br><br>  Jetzt m√ºssen Sie Bonuspunkte z√§hlen: <br><blockquote>  Zus√§tzlich werden Bonuspunkte vergeben: <br>  1 Punkt wird vergeben, wenn die Mannschaft das Viertelfinale, das Halbfinale und das Finale im Europapokal erreicht. <br>  4 Punkte f√ºr das Erreichen der Gruppenphase der Champions League (bis 1996 - 2 Punkte von 1997 bis 2003 - 1 Punkt von 2004 bis 2008 - 3 Punkte); <br>  5 Punkte f√ºr den Fall, dass eine Mannschaft das Achtelfinale der Champions League erreicht (vor 2008 - 1 Punkt). <br>  Es werden nur gespielte Spiele ber√ºcksichtigt (technische Verluste werden nicht ber√ºcksichtigt).  Spiele, die bei der Berechnung des Koeffizienten in einer Reihe von Elfmeterschie√üen enden, werden gem√§√ü dem Ergebnis ber√ºcksichtigt, das durch die Ergebnisse des Spiels in der Haupt- und Verl√§ngerung festgelegt wird. <br></blockquote><br>  Bei dieser Implementierung gehen wir davon aus, dass der Verein in die Runde des Turniers gegangen ist, wenn er mindestens ein Spiel in diesem Turnier gespielt hat.  Dazu berechnen wir, wie viele Spiele der Verein in einer bestimmten Saison, einem bestimmten Turnier oder einer bestimmten Runde gespielt hat: <br><div class="scrollable-table"><table><tbody><tr><td> <code>played <font color="#50a14f">''</font> (Season s, Tournament t, Round r, Team tm) = <br> <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">IF</font> played(tm, Match m) <font color="#a626a4">AND</font> round(m) = r <font color="#a626a4">AND</font> tournament(m) = t <font color="#a626a4">AND</font> season(m) = s; <br></code> </td></tr></tbody></table></div><br><br>  Jetzt m√ºssen Sie bestimmen, wie viele Punkte f√ºr die Passage in einer bestimmten Runde erzielt werden sollen.  Da es vom Turnier abh√§ngt (zum Beispiel erh√§lt eine Passage in der ‚Öõ Champions League 5 Punkte, aber nichts in der Europa League).  Dazu f√ºhren wir die prim√§re Eigenschaft ein: <br><div class="scrollable-table"><table><tbody><tr><td> <code>bonusPoints <font color="#50a14f">'  '</font> = <font color="#a626a4">DATA</font> <font color="#a626a4">NUMERIC</font> [ <font color="#986801">10</font> , <font color="#986801">1</font> ] (Tournament, Round); <br></code> </td></tr></tbody></table></div><br>  Berechnen wir nun die Bonuspunkte und die Gesamtzahl der Punkte f√ºr den Verein f√ºr die Saison: <br><div class="scrollable-table"><table><tbody><tr><td> <code>bonusPoints <font color="#50a14f">' '</font> (Season s, Team tm) = <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> bonusPoints(Tournament t, Round r) <font color="#a626a4">IF</font> played(s, t, r, tm) <font color="#a626a4">MATERIALIZED</font> ; <br> <br> points <font color="#50a14f">''</font> (Season s, Team tm) = matchPoints(s, tm) (+) bonusPoints(s, tm); <br></code> </td></tr></tbody></table></div><br>  Schlie√ülich gehen wir direkt zum L√§nderkoeffizienten. <br><blockquote>  Zur Berechnung der Bewertung des Verbandes werden alle Punkte der an der Champions League und der Europa League teilnehmenden Vereine addiert und das Ergebnis durch die Anzahl der Vereine dieses Verbandes geteilt [2] [3]. <br></blockquote><br>  Berechnen wir die Anzahl der Vereine f√ºr jeden Verband, der an europ√§ischen Wettbewerben teilgenommen hat: <br><div class="scrollable-table"><table><tbody><tr><td> <code>matchesUL <font color="#50a14f">'  '</font> (Season s, Team t) = <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">IF</font> played(t, Match m) <font color="#a626a4">AND</font> season(m) = s <font color="#a626a4">AND</font> isUL(m); <br> teams <font color="#50a14f">''</font> (Season s, Country c) = <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">IF</font> matchesUL(s, Team t) <font color="#a626a4">AND</font> country(t) = c; <br></code> </td></tr></tbody></table></div><br>  Nun betrachten wir die Gesamtzahl der Assoziationspunkte f√ºr die Saison und dividieren durch die Anzahl der Vereine: <br><div class="scrollable-table"><table><tbody><tr><td> <code>totalPoints <font color="#50a14f">' ()'</font> (Season s, Country c) = <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> points(s, Team t) <font color="#a626a4">IF</font> country(t) = c; <br> points <font color="#50a14f">''</font> (Season s, Country c) = trunc( <font color="#a626a4">NUMERIC</font> [ <font color="#986801">13</font> , <font color="#986801">4</font> ](totalPoints(s, c)) / teams(s, c), <font color="#986801">3</font> ); <br></code> </td></tr></tbody></table></div><br><br><blockquote>  Das Rating eines Landes ist die Summe der Koeffizienten des Landes f√ºr die letzten 5 Jahre. <br></blockquote><br><br>  Dazu nummerieren wir alle Jahreszeiten beginnend mit der letzten durch den internen Code (wir gehen davon aus, dass letztere sp√§ter hinzugef√ºgt wurden und einen gr√∂√üeren Code haben): <br><div class="scrollable-table"><table><tbody><tr><td> <code>index <font color="#50a14f">''</font> (Season s) = <font color="#a626a4">PARTITION</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">IF</font> s <font color="#a626a4">IS</font> Season <font color="#a626a4">ORDER</font> <font color="#a626a4">DESC</font> s; <br></code> </td></tr></tbody></table></div><br>  Bei Bedarf k√∂nnen Sie ein separates Feld oder eine Nummer nach Namen eingeben. <br>  Es bleibt nur die endg√ºltige Bewertung f√ºr das Land zu berechnen: <br><div class="scrollable-table"><table><tbody><tr><td> <code>rating <font color="#50a14f">''</font> (Country c) = <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> points(Season s, c) <font color="#a626a4">IF</font> index(s) &lt;= <font color="#986801">5</font> ; <br></code> </td></tr></tbody></table></div><br>  Oben haben wir Quoten f√ºr Turniere und Runden angek√ºndigt.  F√ºgen Sie sie dem Turnierbearbeitungsformular hinzu, w√§hrend Sie nur die Runden filtern, die in diesen Turnieren enthalten waren: <br><div class="scrollable-table"><table><tbody><tr><td> <code>matches (Tournament t, Round r) = <font color="#a626a4">GROUP</font> <font color="#a626a4">SUM</font> <font color="#986801">1</font> <font color="#a626a4">IF</font> tournament(Match m) = t <font color="#a626a4">AND</font> round(m) = r; <br> <br> <font color="#a626a4">EXTEND</font> <font color="#a626a4">FORM</font> tournament <br> <font color="#a626a4">OBJECTS</font> r = Round <br> <font color="#a626a4">PROPERTIES</font> name(r) <font color="#a626a4">READONLY</font> , matchCoeff(r), bonusPoints(o, r) <br> <font color="#a626a4">FILTERS</font> matches(o, r) <br> ; <br></code> </td></tr></tbody></table></div><br><br>  Quoteneinstellungen, zum Beispiel f√ºr die Champions League, m√ºssen Sie wie folgt einstellen: <br><img src="https://habrastorage.org/webt/fi/yy/gl/fiyyglmdvm2zst_v58pebjpc3ai.png" alt="Bild"><br><br>  Zeichnen wir ein Formular, in dem die Bewertung angezeigt wird, in der die Teams f√ºr jedes Land und f√ºr jedes Team seine Spiele angezeigt werden: <br><div class="scrollable-table"><table><tbody><tr><td> <code><font color="#a626a4">FORM</font> countryCoefficientUEFA <font color="#50a14f">'  UEFA'</font> <br> <font color="#a626a4">OBJECTS</font> s = Season <br> <font color="#a626a4">FILTERS</font> index(s) &lt;= <font color="#986801">5</font> <br> <br> <font color="#a626a4">OBJECTS</font> c = Country <br> <font color="#a626a4">PROPERTIES</font> (c) <font color="#a626a4">READONLY</font> name, rating <br> <font color="#a626a4">PROPERTIES</font> (s, c) <font color="#a626a4">COLUMNS</font> (s) points <font color="#a626a4">HEADER</font> <font color="#50a14f">' : '</font> + name(s), teams <font color="#a626a4">HEADER</font> <font color="#50a14f">' : '</font> + name(s) <br> <br> <font color="#a626a4">OBJECTS</font> t = Team <br> <font color="#a626a4">PROPERTIES</font> (t) <font color="#a626a4">READONLY</font> nameCountry, name <br> <font color="#a626a4">PROPERTIES</font> (s,t) <font color="#a626a4">COLUMNS</font> (s) <font color="#a626a4">HEADER</font> name(s) points <font color="#a626a4">BACKGROUND</font> matchesUL(s, t) <br> <font color="#a626a4">FILTERGROUP</font> country <br> <font color="#a626a4">FILTER</font> <font color="#50a14f">' '</font> country(t) = c <font color="#a626a4">DEFAULT</font> <br> <br> <font color="#a626a4">OBJECTS</font> m = Match <br> <font color="#a626a4">PROPERTIES</font> (m) <font color="#a626a4">READONLY</font> dateTime, nameTournament, nameSeason, nameRound, <br> nameHomeTeam, <br> goalsHome <font color="#a626a4">BACKGROUND</font> goalsHome(m) &gt; goalsAway(m), <br> goalsAway <font color="#a626a4">BACKGROUND</font> goalsHome(m) &lt; goalsAway(m), <br> nameAwayTeam <br> <font color="#a626a4">FILTERS</font> played(t, m) <br> <font color="#a626a4">ORDER</font> dateTime(m) <font color="#a626a4">DESC</font> <br> ; <br> <br> <font color="#a626a4">DESIGN</font> countryCoefficientUEFA { <br> <font color="#a626a4">OBJECTS</font> { <br> <font color="#a626a4">NEW</font> countryDetails { <br> type = <font color="#a626a4">SPLITH</font> ; <br> fill = <font color="#986801">0.5</font> ; <br> <font color="#a626a4">MOVE</font> <font color="#a626a4">BOX</font> (t); <br> <font color="#a626a4">MOVE</font> <font color="#a626a4">BOX</font> (m); <br> } <br> } <br> <br> } <br> <br> <font color="#a626a4">NAVIGATOR</font> { <br> <font color="#a626a4">NEW</font> countryCoefficientUEFA; <br> } <br></code> </td></tr></tbody></table></div><br>  Das resultierende Formular sieht folgenderma√üen aus: <br><img src="https://habrastorage.org/webt/za/ps/ov/zapsovbiitv6s0ggc1i19l0kad0.gif" alt="Bild"><br>  Die Farbe in den Tabellen der Vereine zeigt, wann er an den Spielzeiten teilgenommen hat, und in der Tabelle der Spiele - wer hat gewonnen. <br>  Das Bild zeigt, dass die Bewertungen f√ºr 2018 genauso berechnet werden wie bei Wikipedia.  Wie bereits erw√§hnt, bietet die Football API in den vergangenen Jahren nicht alle Informationen. <br><br><h3>  Zusammenfassung </h3><br><br>  Wir haben eine kleine Anwendung erstellt, die im obigen Code vollst√§ndig beschrieben ist und deren Daten in PostgreSQL speichert. Sie bietet eine Weboberfl√§che zum Anzeigen und Bearbeiten von Daten.  Gleichzeitig funktioniert es effektiv bei gro√üen Volumes, da alle Formulare nur das sichtbare Fenster lesen.  Ebenfalls sofort einsatzbereit sind Filter, Sortieren, Hochladen in Excel und vieles mehr. <br><br>  Es sollte beachtet werden, wie einfach die Aufgabe der Berechnung des Koeffizienten unter Verwendung der Plattform in einzelne Eigenschaften zerlegt wurde.  Bei der Ausf√ºhrung wird diese gesamte Logik in SQL-Abfragen √ºbersetzt, und alle Berechnungen werden unter Verwendung aller DBMS-Optimierungen direkt auf dem Datenbankserver ausgef√ºhrt. <br><br>  Ein Beispiel f√ºr die Funktionsweise der Anwendung mit den darin geladenen Daten finden Sie unter: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://demo.lsfusion.org/euroleague</a> .  Gast Login ohne Passwort.  Der Benutzer befindet sich im schreibgesch√ºtzten Modus. <br><br>  Wer m√∂chte, kann sich alles lokal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einstellen</a> und beispielsweise die Koeffizienten durch Eingabe der Ergebnisse zuk√ºnftiger √úbereinstimmungen modellieren.  Alle oben beschriebenen Anwendungsmodule werden auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">github</a> gehostet.  Nach der automatischen Installation m√ºssen Sie diese Dateien nur aus den Anweisungen in den entsprechenden Ordner einf√ºgen und den Server neu starten. <br><br>  Um Daten von der Fu√üball-API herunterzuladen, m√ºssen Sie sich bei ihnen registrieren und den API-Schl√ºssel erhalten.  Es ist eine Karte erforderlich. Wenn Sie jedoch nicht mehr als 50 Anfragen pro Tag stellen, wird nichts davon abgezogen. <br><br>  Dar√ºber hinaus k√∂nnen Sie diese Anwendung online im entsprechenden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschnitt</a> auf der Website ausf√ºhren.  W√§hlen Sie auf der Registerkarte Plattform das Beispiel f√ºr die Berechnung der UEFA-Gewinnchancen aus und klicken Sie auf Wiedergabe. <br><br>  √úbrigens, wenn jemand ein einfaches System implementieren muss, f√ºr das Excel nicht mehr geeignet ist, dann schreibe in die Kommentare.  Um die Funktionen der Plattform kennenzulernen, werden wir versuchen, sie zu implementieren und den entsprechenden Artikel zu schreiben. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de467279/">https://habr.com/ru/post/de467279/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de467263/index.html">Wir verdienen mit Solarenergie oder passivem Einkommen 25% pro Jahr, praktische Erfahrung. Teil 2</a></li>
<li><a href="../de467269/index.html">Modelle in der Informationssicherheit</a></li>
<li><a href="../de467271/index.html">Berufsprogrammierer, Chemiker von Beruf</a></li>
<li><a href="../de467275/index.html">Zum Tag des Programmierers. Programmierer im Jahr 2019</a></li>
<li><a href="../de467277/index.html">pg_stat_statements + pg_stat_activity + loq_query = pg_ash?</a></li>
<li><a href="../de467281/index.html">Portr√§t eines Datenwissenschaftlers in Russland. Nur Fakten</a></li>
<li><a href="../de467283/index.html">Wie Sie Ihrer Gro√ümutter den Unterschied zwischen SQL und NoSQL erkl√§ren k√∂nnen</a></li>
<li><a href="../de467289/index.html">Entwicklung eines monolithischen Unix-√§hnlichen Betriebssystems - GDT & IDT (5)</a></li>
<li><a href="../de467291/index.html">iOS f√ºr Kreativit√§t: Zeichnen</a></li>
<li><a href="../de467295/index.html">Die lang erwartete View Binding in Android</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>