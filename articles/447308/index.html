<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔧 🙇 🧖🏽 Diseño instantáneo 🍺 ⛵️ 🔟</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La gente aprende arquitectura de viejos libros que fueron escritos para Java. Los libros son buenos, pero proporcionan una solución a los problemas de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Diseño instantáneo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/447308/">  La gente aprende arquitectura de viejos libros que fueron escritos para Java.  Los libros son buenos, pero proporcionan una solución a los problemas de esa época con instrumentos de esa época.  El tiempo ha cambiado, C # es más similar a Light Scala que Java, y hay pocos libros nuevos y buenos. <br><br>  En este artículo, examinaremos los criterios para el código bueno y el código malo, cómo y qué medir.  Veremos una descripción general de las tareas y enfoques típicos, analizaremos los pros y los contras.  Al final habrá recomendaciones y mejores prácticas para diseñar aplicaciones web. <br><br>  Este artículo es una transcripción de mi informe de la conferencia DotNext 2018 Moscú.  Además del texto, hay un video y un enlace a las diapositivas debajo del corte. <br><br><img src="https://habrastorage.org/webt/qu/ur/ih/quurihchxowghlgnkanhvmb5o7e.jpeg"><br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qJPwSvDLmQE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b>Diapositivas</b></a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">página del informe en el sitio</a> . </blockquote>  Brevemente sobre mí: soy de Kazán, trabajo para High Tech Group.  Estamos desarrollando software para empresas.  Recientemente, he estado impartiendo un curso en la Universidad Federal de Kazan llamado Desarrollo de software corporativo.  De vez en cuando sigo escribiendo artículos sobre Habr sobre prácticas de ingeniería, sobre el desarrollo de software empresarial. <br><br>  Como probablemente haya adivinado, hoy hablaré sobre el desarrollo de software empresarial, a saber, cómo estructurar aplicaciones web modernas: <br><br><ul><li>  los criterios </li><li>  una breve historia del desarrollo del pensamiento arquitectónico (qué fue, qué se convirtió, qué problemas son); </li><li>  Resumen de los defectos de la arquitectura clásica de hojaldre </li><li>  la decision </li><li>  análisis paso a paso de la implementación sin sumergirse en detalles </li><li>  resultados. </li></ul><br><h1>  Criterios </h1><br>  Formulamos los criterios.  Realmente no me gusta cuando hablar de diseño es al estilo de "mi kung fu es más fuerte que tu kung fu".  Una empresa tiene, en principio, un criterio específico llamado dinero.  Todos saben que el tiempo es dinero, por lo que estos dos componentes suelen ser los más importantes. <br><br><img src="https://habrastorage.org/webt/pu/2e/fh/pu2efhyhoibrcu9lav6fzdg48da.jpeg"><br><br>  Entonces, los criterios.  En principio, la empresa nos pide con mayor frecuencia "tantas funciones como sea posible por unidad de tiempo", pero con una advertencia: estas funciones deberían funcionar.  Y el primer paso donde podría romperse es la revisión del código.  Es decir, parece que el programador dijo: "Lo haré en tres horas".  Pasaron tres horas, la revisión entró en el código y el líder del equipo dijo: "Oh, no, rehaga".  Hay tres más, y cuántas iteraciones ha pasado la revisión del código, tanto que necesita multiplicar tres horas. <br><br>  El siguiente punto es el regreso de la etapa de prueba de aceptación.  Lo mismo  Si la función no funciona, entonces no se hace, estas tres horas se extienden durante una semana, dos, bueno, como de costumbre.  El último criterio es el número de regresiones y errores, que sin embargo, a pesar de las pruebas y la aceptación, pasaron por la producción.  Esto también es muy malo.  Hay un problema con este criterio.  Es difícil de rastrear, porque la conexión entre el hecho de que empujamos algo al repositorio y el hecho de que algo se rompió después de dos semanas puede ser difícil de rastrear.  Pero, sin embargo, es posible. <br><br><h1>  Desarrollo de la arquitectura </h1><br>  Érase una vez, cuando los programadores comenzaban a escribir programas, todavía no había arquitectura, y todos hicieron todo lo que quisieron. <br><br><img src="https://habrastorage.org/webt/27/l7/oq/27l7oqmpgjyxndbw-4trowmrmem.jpeg"><br><br>  Por lo tanto, tenemos un estilo tan arquitectónico.  Esto se llama "código de fideos" aquí, dicen "código de espagueti" en el extranjero.  Todo está conectado con todo: cambiamos algo en el punto A: se rompe en el punto B, es completamente imposible entender qué está conectado con qué.  Naturalmente, los programadores se dieron cuenta rápidamente de que esto no funcionaría, y había que hacer alguna estructura, y decidieron que algunas capas nos ayudarían.  Ahora, si imagina que la carne picada es código, y la lasaña es tales capas, aquí hay una ilustración de la arquitectura en capas.  La carne picada permaneció picada, pero ahora la carne picada de la capa No. 1 no puede simplemente ir y hablar con la carne picada de la capa No. 2. Le dimos alguna forma al código: incluso en la imagen se puede ver que la escalada está más enmarcada. <br><br><img src="https://habrastorage.org/webt/yx/_j/cu/yx_jcumnfvnensrmrbjwi9lyyqa.jpeg"><br><br>  Probablemente todos estén familiarizados con la <b>arquitectura clásica en capas</b> : hay una interfaz de usuario, hay una lógica de negocios y hay una capa de acceso a datos.  Todavía hay todo tipo de servicios, fachadas y capas, nombrados por el arquitecto que dejó la empresa, puede haber un número ilimitado de ellos. <br><br><img src="https://habrastorage.org/webt/dd/28/qj/dd28qjfaycsftyr71tczg5ykxjo.jpeg"><br><br>  La siguiente etapa fue la llamada <b>arquitectura de cebolla</b> .  Parecería que hay una gran diferencia: antes había un pequeño cuadrado, y aquí había círculos.  Parece ser completamente diferente. <br><br><img src="https://habrastorage.org/webt/pe/8r/rx/pe8rrxifll2tswmz63paezukklq.jpeg"><br><br>  En realidad no  La diferencia es que en algún momento en ese momento se formularon los principios de SOLID, y resultó que en la cebolla clásica hay un problema con la inversión de dependencia, porque el código de dominio abstracto por alguna razón depende de la implementación, en Data Access, por lo que decidimos implementar Data Access y tener acceso a datos dependen del dominio. <br><br><img src="https://habrastorage.org/webt/8o/eb/we/8oebwed-cag1f-zvake5t9lmhl8.jpeg"><br><br>  Aquí practiqué el dibujo y dibujé la arquitectura de la cebolla, pero no de forma clásica con los "anillos".  Tengo algo entre un polígono y círculos.  Hice esto para mostrar simplemente que si te encuentras con las palabras "cebolla", "hexagonal" o "puertos y adaptadores", todos son lo mismo.  El punto es que el dominio está en el centro, está envuelto en servicios, pueden ser servicios de dominio o aplicación, como lo desee.  Y el mundo exterior en forma de interfaz de usuario, pruebas e infraestructura donde DAL se mudó: se comunican con el dominio a través de esta capa de servicio. <br><br><h2>  Un simple ejemplo.  Actualización por correo electrónico </h2><br>  Veamos cómo se vería un caso de uso simple en tal paradigma: actualizar la dirección de correo electrónico del usuario. <br><br><img src="https://habrastorage.org/webt/ta/fg/x-/tafgx-5pwfraeofdjg323ewoova.jpeg"><br><br>  Necesitamos enviar una solicitud, validar, actualizar el valor en la base de datos, enviar una notificación a un nuevo correo electrónico: "Todo está en orden, usted cambió su correo electrónico, sabemos que todo está bien" y responder al navegador "200": todo está bien. <br><br><img src="https://habrastorage.org/webt/xs/vm/0f/xsvm0f4b6zhpypwnixjazbv3ufi.jpeg"><br><br>  El código puede verse más o menos así.  Aquí tenemos la validación estándar de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ASP.NET</a> MVC, hay ORM para leer y actualizar los datos, y hay algún tipo de remitente de correo electrónico que envía una notificación.  Parece que todo está bien, ¿verdad?  Una advertencia: en un mundo ideal. <br><br>  En el mundo real, la situación es ligeramente diferente.  El punto es agregar autorización, verificación de errores, formateo, registro y creación de perfiles.  Todo esto no tiene nada que ver con nuestro caso de uso, pero debería serlo.  Y ese pequeño fragmento de código se hizo grande y aterrador: con mucho anidamiento, con mucho código, con el hecho de que es difícil de leer, y lo más importante, que hay más código de infraestructura que código de dominio. <br><br><img src="https://habrastorage.org/webt/lh/xr/xd/lhxrxdbyaacgxsxrjcsoinbq-c8.jpeg"><br><br>  "¿Dónde están los servicios?"  - usted dice  Escribí toda la lógica a los controladores.  Por supuesto, esto es un problema, ahora agregaré servicios y todo estará bien. <br><br><img src="https://habrastorage.org/webt/c6/nd/ca/c6ndcaxmuebeyawelqctgsh19ig.jpeg"><br><br>  Agregamos servicios, y realmente mejora, porque en lugar de un gran calzado, tenemos una pequeña línea hermosa. <br><br>  ¿Ha mejorado?  Se ha convertido!  Y ahora podemos reutilizar este método en diferentes controladores.  El resultado es obvio.  Veamos la implementación de este método. <br><br><img src="https://habrastorage.org/webt/up/xx/rx/upxxrx8d_fc-5qmzbk-d0afuht4.jpeg"><br><br>  Pero aquí no todo es tan bueno.  Este código todavía está aquí.  Acabamos de transferir lo mismo a los servicios.  Decidimos no resolver el problema, sino simplemente disfrazarlo y transferirlo a otro lugar.  Eso es todo <br><br><img src="https://habrastorage.org/webt/m0/bo/fj/m0bofjvz471nmxub7ubqhshqwgi.jpeg"><br><br>  Además de esto, surgen algunas otras preguntas.  ¿Deberíamos hacer la validación en el controlador o aquí?  Bueno, algo así como en el controlador.  ¿Y si necesita ir a la base de datos y ver que existe una ID de este tipo o que no hay otro usuario con ese correo electrónico?  Hmm, bueno, entonces en el servicio.  ¿Pero el manejo de errores aquí?  Este manejo de errores probablemente esté aquí, y el manejo de errores que responderá al navegador en el controlador.  Y el método SaveChanges, ¿está en el servicio o necesita transferirlo al controlador?  Puede ser así, porque si se llama a un servicio, es más lógico llamar al servicio, y si tiene tres métodos de servicios en el controlador que deben llamarse, entonces debe llamarlo fuera de estos servicios para que la transacción sea uno.  Estas reflexiones sugieren que quizás las capas no resuelven ningún problema. <br><br><img src="https://habrastorage.org/webt/9d/s6/gd/9ds6gdwecmtqyjjv3rko5l-rccg.jpeg"><br><br>  Y esta idea se le ocurrió a más de una persona.  Si buscas en Google, al menos tres de estos maridos respetables escriben sobre lo mismo.  De arriba a abajo: Stephen .NET Junkie (desafortunadamente, no sé su apellido, porque no aparece en ningún lugar de Internet), el autor del contenedor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Simple Injector</a> IoC.  Siguiente Jimmy Bogard es el autor de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">AutoMapper</a> .  Y abajo está Scott Vlashin, autor de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">F # por diversión y ganancias</a> . <br><br><img src="https://habrastorage.org/webt/pu/lt/rz/pultrzyz_24mf5fycqif--zcbpe.jpeg"><br><br>  Todas estas personas están hablando de lo mismo y sugieren construir aplicaciones no sobre la base de capas, sino sobre la base de casos de uso, es decir, aquellos requisitos que la empresa nos solicita.  En consecuencia, el caso de uso en C # se puede determinar utilizando la interfaz IHandler.  Tiene valores de entrada, hay valores de salida y hay un método en sí mismo que realmente ejecuta este caso de uso. <br><br><img src="https://habrastorage.org/webt/9m/lj/hw/9mljhwhphjkuckh2r5tvegoyzg0.jpeg"><br><br>  Y dentro de este método puede haber un modelo de dominio o algún tipo de modelo desnormalizado para leer, tal vez usando Dapper o Elastic Search, si necesita buscar algo, y tal vez tenga Legacy -sistema con procedimientos almacenados, no hay problema, así como solicitudes de red, bueno, en general, cualquier cosa que pueda necesitar allí.  Pero si no hay capas, ¿qué hacer? <br><br><img src="https://habrastorage.org/webt/lg/iw/se/lgiwseqpyf9krjfkv4j9ciluxri.jpeg"><br><br>  Para comenzar, eliminemos UserService.  Eliminamos el método y creamos una clase.  Y lo eliminaremos, y lo eliminaremos nuevamente.  Y luego tomar y eliminar la clase. <br><br><img src="https://habrastorage.org/webt/xx/tv/z1/xxtvz10bmxyzpefudhd2cw7892y.jpeg"><br><br>  Pensemos, ¿son estas clases equivalentes o no?  La clase GetUser devuelve datos y no cambia nada en el servidor.  Esto, por ejemplo, sobre la solicitud "Dame la ID de usuario".  Las clases UpdateEmail y BanUser devuelven el resultado de la operación y cambian el estado.  Por ejemplo, cuando le decimos al servidor: "Cambie el estado, debe cambiar algo". <br><br><img src="https://habrastorage.org/webt/yj/qs/tn/yjqstnlgzw9lwrk8s1nr0j2s47u.jpeg"><br><br>  Veamos el protocolo HTTP.  Existe un método GET que, de acuerdo con la especificación del protocolo HTTP, debe devolver datos y no cambiar el estado del servidor. <br><br><img src="https://habrastorage.org/webt/uq/ql/7i/uqql7icixrsmjce88qwxwuxouss.jpeg"><br><br>  Y hay otros métodos que pueden cambiar el estado del servidor y devolver el resultado de la operación. <br><br><img src="https://habrastorage.org/webt/zu/u3/l6/zuu3l6-bulai-mgo4fozlyru8ci.jpeg"><br><br>  El paradigma CQRS parece estar diseñado específicamente para el protocolo HTTP.  Las consultas son operaciones GET y los comandos PUT, POST, DELETE, sin necesidad de inventar nada. <br><br><img src="https://habrastorage.org/webt/2t/wk/yp/2twkypfgr9s5xxslujdjfelkkx4.jpeg"><br><br>  Redefinimos nuestro controlador y definimos interfaces adicionales.  IQueryHandler, que solo difiere en que colgamos la restricción de que el tipo de valores de entrada es IQuery.  IQuery es una interfaz de marcador, no tiene nada más que este genérico.  Necesitamos el genérico para poner restricciones en el QueryHandler, y ahora, al declarar QueryHandler, no podemos pasar allí, no Query, pero al pasar el objeto Query allí, sabemos su valor de retorno.  Esto es conveniente si solo tiene una interfaz, por lo que no tiene que buscar su implementación en el código, y nuevamente para no equivocarse.  Escribe IQueryHandler, escribe una implementación allí, y en TOut no puede sustituir otro tipo de valor de retorno.  Simplemente no se compila.  Por lo tanto, puede ver de inmediato qué valores de entrada corresponden a qué datos de entrada. <br><br><img src="https://habrastorage.org/webt/e5/k9/pd/e5k9pdmjpohmvppi9j5mco2lpz8.jpeg"><br><br>  La situación es completamente similar para CommandHandler con una excepción: este genérico es necesario para un truco más, que veremos un poco más adelante. <br><br><h3>  Implementación del controlador </h3><br>  Los controladores, anunciamos, ¿cuál es su implementación? <br><br><img src="https://habrastorage.org/webt/xb/ye/no/xbyeno8s7xry4tv5n1t2sgig4fk.jpeg"><br><br>  ¿Hay algún problema, sí?  Algo parece haber fallado. <br><br><h3>  Los decoradores corren al rescate </h3> <br>  Pero no ayudó, porque todavía estamos en el medio del camino, necesitamos finalizar un poco más, y esta vez necesitamos usar el patrón <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">decorador</a> , es decir, su maravillosa característica de diseño.  El decorador se puede envolver en un decorador, envolver en un decorador, envolver en un decorador; continúe hasta que se aburra. <br><br><img src="https://habrastorage.org/webt/pj/oj/m2/pjojm2jkr9q2q3of-rgouuydrjc.jpeg"><br><br>  Entonces todo se verá así: hay una entrada Dto, ingresa al primer decorador, el segundo, el tercero, luego entramos en Handler y también salimos, pasamos por todos los decoradores y regresamos Dto en el navegador.  Declaramos una clase base abstracta para luego heredar, el cuerpo de Handler se pasa al constructor y declaramos el método Handle abstracto, en el que se colgará la lógica decoradora adicional. <br><br><img src="https://habrastorage.org/webt/4k/df/ha/4kdfha-rrtuvomibpp8tuadhcrw.jpeg"><br><br>  Ahora, con la ayuda de decoradores, puede construir una tubería completa.  Comencemos con los equipos.  Que tuvimos  Valores de entrada, validación, verificación de derechos de acceso, la lógica en sí misma, algunos eventos que ocurren como resultado de esta lógica y valores de retorno. <br><br><img src="https://habrastorage.org/webt/zp/yw/3i/zpyw3iastzi8ggkluwnk_dhdes0.jpeg"><br><br>  Comencemos con la validación.  Declaramos un decorador.  IEnumerable de los validadores de tipo T entra en el constructor de este decorador. Los ejecutamos todos, verificamos si la validación falla y el tipo de retorno es <code>IEnumerable&lt;validationresult&gt;</code> , luego podemos devolverlo porque los tipos coinciden.  Y si se trata de otro Hander, entonces tienes que lanzar una Excepción, porque aquí no hay ningún resultado, el tipo de otro valor de retorno. <br><br><img src="https://habrastorage.org/webt/wp/pi/bp/wppibp3w6wzoylmbhx8nsop6lda.jpeg"><br><br>  El siguiente paso es la seguridad.  También declaramos el decorador, hacemos el método CheckPermission y verificamos.  Si de repente algo salió mal, todo, no continuamos.  Ahora, después de haber completado todas las verificaciones y estar seguros de que todo está bien, podemos cumplir con nuestra lógica. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Obsesión con los primitivos.</a> </h3><br>  Antes de mostrar la implementación de la lógica, quiero comenzar un poco antes, es decir, con los valores de entrada que vienen allí. <br><br><img src="https://habrastorage.org/webt/gl/y5/ro/gly5roxocvdausjqf9dztn69jjk.jpeg"><br><br>  Ahora, si seleccionamos una clase de este tipo, la mayoría de las veces puede verse así.  Al menos el código que veo en el trabajo diario. <br><br><img src="https://habrastorage.org/webt/is/e4/6r/ise46rxpz-gsrqeqpqjwac-ir58.jpeg"><br><br>  Para que la validación funcione, agregamos algunos atributos aquí que le indican qué tipo de validación es.  Esto ayudará desde el punto de vista de la estructura de datos, pero no ayudará con la validación como verificar los valores en la base de datos.  Es solo EmailAddress, no está claro cómo, dónde verificar cómo usar estos atributos para ir a la base de datos.  En lugar de atributos, puede ir a tipos especiales, luego se resolverá este problema. <br><br><img src="https://habrastorage.org/webt/oq/6b/3x/oq6b3xuwdmc5xh_04v71g02jkmo.jpeg"><br><br>  En lugar de la primitiva <code>int</code> , declaramos un tipo de Id que tiene un genérico que es una determinada entidad con una clave int.  O bien pasamos esta entidad al constructor, o pasamos su Id, pero al mismo tiempo debemos pasar una función que por Id puede tomar y devolver, verificar si es nula o no nula. <br><br><img src="https://habrastorage.org/webt/tt/fk/ut/ttfkutansz1nzthl3x5adtxftde.jpeg"><br><br>  Hacemos lo mismo con el correo electrónico.  Convierta todos los correos electrónicos a la línea de fondo para que todo se vea igual para nosotros.  A continuación, tomamos el atributo Correo electrónico, lo declaramos como estático por compatibilidad con la validación ASP.NET, y aquí simplemente lo llamamos.  Es decir, esto también se puede hacer.  Para que la infraestructura ASP.NET detecte todo esto, debe modificar ligeramente la serialización y / o ModelBinding.  No hay mucho código allí, es relativamente simple, así que no me detendré allí. <br><br><img src="https://habrastorage.org/webt/md/5k/zi/md5kzigojhdaybdbizxrvby2p5w.jpeg"><br><br>  Después de estos cambios, en lugar de los tipos primitivos, aparecen aquí los tipos especializados: Id y Correo electrónico.  Y después de que estos ModelBinder y el deserializador actualizado hayan funcionado, sabemos con certeza que estos valores son correctos, incluso que dichos valores están en la base de datos.  "Invariantes" <br><br><img src="https://habrastorage.org/webt/hu/ew/ul/huewulf5m8-mwkha62fbu3dm5sy.jpeg"><br><br>  El siguiente punto en el que me gustaría insistir es en el estado de los invariantes en la clase, porque a menudo se usa un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">modelo anémico</a> , en el que solo hay una clase, muchos captadores, no está completamente claro cómo deberían trabajar juntos.  Trabajamos con una lógica empresarial compleja, por lo que es importante para nosotros que el código se documente automáticamente.  En cambio, es mejor declarar el constructor real junto con vacío para ORM, puede declararse protegido para que los programadores en su código de aplicación no puedan llamarlo, y ORM sí.  Aquí no pasamos el tipo primitivo, sino el tipo de correo electrónico, ya es correcto, si es nulo, seguimos lanzando una excepción.  Puede usar un poco de Fody, PostSharp, pero pronto llegará C # 8. Por consiguiente, habrá un tipo de referencia no anulable, y es mejor esperar su soporte en el lenguaje.  El próximo momento, si queremos cambiar el nombre y el apellido, lo más probable es que queramos cambiarlos juntos, por lo que debe haber un método público apropiado que los cambie juntos. <br><br><img src="https://habrastorage.org/webt/p8/ze/vw/p8zevw3bkth4ialnrabvlsk3hru.jpeg"><br><br>  En este método público, también verificamos que la longitud de estas líneas coincida con lo que usamos en la base de datos.  Y si algo está mal, entonces pare la ejecución.  Aquí uso el mismo truco.  Declaro un atributo especial y solo lo llamo en el código de la aplicación. <br><br><img src="https://habrastorage.org/webt/tj/ae/mi/tjaemirkcgpbgkmknl9acjkhioa.jpeg"><br><br>  Además, dichos atributos se pueden reutilizar en Dto.  Ahora, si quiero cambiar el nombre y el apellido, es posible que tenga ese comando de cambio.  ¿Vale la pena agregar un constructor especial aquí?  Parece valer la pena.  Será mejor, nadie cambiará estos valores, no los romperá, serán exactamente correctos. <br><br><img src="https://habrastorage.org/webt/lt/hq/r1/lthqr1w63fzepclzgrcl6ykwaik.jpeg"><br><br>  En realidad no realmente.  El hecho es que los Dto no son realmente objetos en absoluto.  Este es un diccionario en el que ponemos datos deserializados.  Es decir, fingen ser objetos, por supuesto, pero tienen una sola responsabilidad: ser serializados y deserializados.  Si tratamos de luchar contra esta estructura, comenzaremos a anunciar algunos ModelBinders con diseñadores, para hacer algo así es increíblemente agotador y, lo más importante, se romperá con nuevos lanzamientos de nuevos marcos.  Todo esto fue bien descrito por Mark Simon en el artículo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"En los bordes del programa no están orientados a objetos"</a> , si es interesante, es mejor leer su publicación, allí se describe en detalle. <br><br><img src="https://habrastorage.org/webt/mf/bw/he/mfbwhegqg7nbmsw4iwj0y8w99c0.jpeg"><br><br>  En resumen, tenemos un mundo externo sucio, ponemos cheques en la entrada, lo convertimos a nuestro modelo limpio y luego lo transferimos de nuevo a la serialización, al navegador, nuevamente al mundo externo sucio. <br><br><h3>  Manejador </h3><br>  Después de que se hayan realizado todos estos cambios, ¿cómo se verá el Hander aquí? <br><br><img src="https://habrastorage.org/webt/o-/ov/wl/o-ovwlxyrkjuv2murrbk4ifttr4.jpeg"><br><br>  Escribí dos líneas aquí para que sea más conveniente leer, pero en general se puede escribir en una.  Los datos son exactamente correctos, porque tenemos un sistema de tipos, hay validación, es decir, los datos son de hormigón armado, no es necesario volver a verificarlos.  Ese usuario también existe, no hay otro usuario con un correo electrónico tan ocupado, todo se puede hacer.  Sin embargo, todavía no hay una llamada al método SaveChanges, no hay notificación y no hay registros ni perfiladores, ¿verdad?  Seguimos adelante. <br><a name="events"></a><br><h3>  Eventos </h3><br>  Eventos de dominio <br><br><img src="https://habrastorage.org/webt/fo/s8/tq/fos8tqpb3kq5ealyvsm3qu9ayhm.jpeg"><br><br>  Probablemente la primera vez que este concepto fue popularizado por Udi Dahan en su publicación <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Eventos de dominio - Salvación"</a> .  Allí, sugiere simplemente declarar una clase estática con el método Raise y lanzar tales eventos.  Un poco más tarde, Jimmy Bogard propuso una mejor implementación, se llama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Un mejor patrón de eventos de dominio"</a> . <br><br><img src="https://habrastorage.org/webt/lq/e_/hq/lqe_hqerzlvb_vi4less4xr6lg4.jpeg"><br><br>  Mostraré la serialización de Bogard con un pequeño cambio, pero importante.  En lugar de lanzar eventos, podemos declarar alguna lista, y en aquellos lugares donde debería tener lugar algún tipo de reacción, directamente dentro de la entidad para guardar estos eventos.  En este caso, este captador de <code>email</code> también es una clase de usuario, y esta clase, esta propiedad no pretende ser una propiedad con captadores y configuradores automáticos, pero realmente agrega algo a esto.  Es decir, esto es encapsulación real, no blasfemias.  Al cambiar, verificamos que el correo electrónico es diferente y lanzamos un evento.  Este evento aún no ha llegado a ninguna parte; solo lo tenemos en la lista interna de entidades. <br><br><img src="https://habrastorage.org/webt/ge/4c/nd/ge4cndzro2vbjuhb4qeujuot1qq.jpeg"><br><br>  Además, en el momento en que llamaremos al método SaveChanges, tomamos ChangeTracker, para ver si hay entidades que implementen la interfaz, si tienen eventos de dominio.  Y si lo hay, tomemos todos estos eventos de dominio y envíelos a algún despachador que sepa qué hacer con ellos. <br><br>  La implementación de este despachador es un tema para otra discusión, existen algunas dificultades con el despacho múltiple en C #, pero esto también se hace.  Con este enfoque, hay otra ventaja no obvia.  Ahora, si tenemos dos desarrolladores, uno puede escribir código que cambie este correo electrónico y el otro puede hacer un módulo de notificación.  No están absolutamente conectados entre sí, escriben código diferente, están conectados solo al nivel de este evento de dominio de una clase Dto.  El primer desarrollador simplemente descarta esta clase en algún momento, el segundo responde y sabe que debe enviarse por correo electrónico, SMS, notificaciones automáticas al teléfono y todos los otros millones de notificaciones, teniendo en cuenta las preferencias de los usuarios que generalmente ocurren. <br><br><img src="https://habrastorage.org/webt/pb/-r/op/pb-ropw5rupxtrrbdfes8_lvp6q.jpeg"><br><br>  Aquí está el punto más pequeño, pero importante.  El artículo de Jimmy usa una sobrecarga del método SaveChanges, y es mejor no hacerlo.  Y es mejor hacerlo en el decorador, porque si sobrecargamos el método SaveChanges y necesitamos dbContext en Handler, obtendremos dependencias circulares.  Puede trabajar con esto, pero las soluciones son un poco menos convenientes y un poco menos hermosas.  Por lo tanto, si la tubería se basa en decoradores, entonces no veo ninguna razón para hacerlo de manera diferente. <br><br><h3>  Registro y perfilado </h3><br><img src="https://habrastorage.org/webt/bg/nq/m_/bgnqm_jchmmhwbbl7bsvb-binni.jpeg"><br><br>  La anidación del código se mantuvo, pero en el ejemplo inicial primero usamos MiniProfiler, luego intentamos atrapar, luego si.  Total había tres niveles de anidación, ahora cada nivel de anidación está en su propio decorador.  Y dentro del decorador, que es responsable de la creación de perfiles, solo tenemos un nivel de anidamiento, el código se lee perfectamente.  Además, está claro que en estos decoradores solo hay una responsabilidad.  Si el decorador es responsable del registro, solo registrará, si para el perfil, respectivamente, solo el perfil, todo lo demás está en otros lugares. <br><br><h3>  Respuesta </h3><br>  Después de que toda la tubería ha funcionado, solo podemos tomar Dto y enviarlo al navegador más, serializar JSON. <br><br><img src="https://habrastorage.org/webt/wc/tt/0h/wctt0hneqcetsw0pjtya_s5p5eg.jpeg"><br><br>  Pero una cosa más pequeña, algo que a veces se olvida: en cada etapa, una Excepción puede suceder aquí, y en realidad necesitas manejarla de alguna manera. <br><br><img src="https://habrastorage.org/webt/rh/ns/lh/rhnslhowdccmndavybt1a9pyfmy.jpeg"><br><br>  No puedo dejar de mencionar a Scott Vlashin y su informe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Programación orientada al ferrocarril"</a> aquí nuevamente.  Por qué  El informe original está completamente dedicado a trabajar con errores en el lenguaje F #, cómo organizar el flujo de manera un poco diferente y por qué este enfoque puede ser preferible a usar Exception'ov.  En F #, esto realmente funciona muy bien, porque F # es un lenguaje funcional y Scott usa la funcionalidad de un lenguaje funcional. <br><br><img src="https://habrastorage.org/webt/wd/-7/gg/wd-7ggf6-mg0y1orcgz-2si45ci.jpeg"><br><br>  Dado que, probablemente, la mayoría de ustedes todavía escriben en C #, si escriben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un análogo en C #</a> , entonces este enfoque se verá más o menos así.  En lugar de lanzar excepciones, declaramos una clase Result que tiene una rama exitosa y una rama no exitosa.  En consecuencia, dos diseñadores.  Una clase puede estar en un solo estado.  Esta clase es un caso especial de tipo de unión, unión discriminada de F #, pero reescrita en C #, porque no hay soporte incorporado en C #. <br><br><img src="https://habrastorage.org/webt/jo/xu/p2/joxup2i8w_uziwqyawnwp6cty8e.jpeg"><br><br>  En lugar de declarar captadores públicos que alguien podría no verificar nulos en el código, se utiliza Pattern Matching.  Nuevamente, en F # sería un lenguaje de coincidencia de patrones incorporado, en C # tenemos que escribir un método separado en el que pasaremos una función que sepa qué hacer con el resultado exitoso de la operación, cómo convertirlo más abajo en la cadena y eso con un error.  Es decir, no importa qué rama trabajó para nosotros, debemos convertir esto en un único resultado devuelto.  En F #, todo esto funciona muy bien, porque hay una composición funcional, bueno, y todo lo demás que ya he enumerado.  En .NET, esto funciona un poco peor, porque tan pronto como tiene más de un Resultado, pero mucho, y casi todos los métodos pueden fallar por una razón u otra, casi todos sus tipos de funciones resultantes se convierten en Tipos de Resultados, y los necesita como para combinar algo <br><br><img src="https://habrastorage.org/webt/vb/s8/wd/vbs8wdzd81uocge3l2louammnwa.jpeg"><br><br>  La forma más fácil de combinarlos es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">usar LINQ</a> , porque de hecho LINQ funciona no solo con IEnumerable, si redefine los métodos SelectMany y Select de la manera correcta, entonces el compilador de C # verá que puede usar la sintaxis LINQ para estos tipos.  En general, resulta papel de calco con la notación de Haskell o con las mismas expresiones de cálculo en F #.  ¿Cómo se debe leer esto?  Aquí tenemos tres resultados de la operación, y si todo está bien en los tres casos, tome estos resultados r1 + r2 + r3 y agréguelos.  El tipo del valor resultante también será Resultado, pero el nuevo Resultado, que declaramos en Seleccionar.  En general, este es incluso un enfoque de trabajo, si no uno, pero. <br><br><img src="https://habrastorage.org/webt/ez/8d/lw/ez8dlwqtpilfzqbpsp_8zg1udvw.jpeg"><br><br>  Para todos los demás desarrolladores, tan pronto como comience a escribir dicho código en C #, comenzará a parecerse a esto.  “Estas son excepciones de miedo, ¡no las escribas!  Son malvados!  ¡Es mejor escribir código que nadie entienda y no pueda depurar! <br><br><img src="https://habrastorage.org/webt/v4/v4/vd/v4v4vdhq2reierp3a0diyhtm-ws.jpeg"><br><br>  C # no es F #, es algo diferente, no existen conceptos diferentes en función de los cuales se hace esto, y cuando intentamos tirar de un búho en el mundo, resulta, por decirlo suavemente, inusual. <br><br><img src="https://habrastorage.org/webt/ns/w3/q7/nsw3q7lbpx2xqiewao1619j-t1s.jpeg"><br><br>  En cambio, puede usar las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">herramientas normales incorporadas</a> que están documentadas, que todos conocen y que no causarán disonancia cognitiva entre los desarrolladores.  ASP.NET tiene una excepción de controlador global. <br><br><img src="https://habrastorage.org/webt/i8/9i/vk/i89ivkfdyr5w8xmemg2by9qz0zs.jpeg"><br><br>  Sabemos que si hay algún problema con la validación, debe devolver el código 400 o 422 (Entidad no procesable).  Si hay un problema con la autenticación y la autorización, hay 401 y 403. Si algo salió mal, entonces algo salió mal.  Y si algo salió mal y desea decirle al usuario exactamente qué, defina su tipo de excepción, diga que es IHasUserMessage, declare un captador de mensajes en esta interfaz y simplemente verifique: si esta interfaz está implementada, puede recibir un mensaje desde la Excepción y pasarlo en JSON al usuario.  Si esta interfaz no está implementada, significa que hay algún tipo de error del sistema, y ​​simplemente les decimos a los usuarios que algo salió mal, ya lo estamos haciendo, todos lo sabemos, bueno, como siempre. <br><br><h3>  Tubería de consulta </h3><br>  Concluimos esto con los equipos y miramos lo que tenemos en la pila de lectura.  En cuanto a la solicitud, validación, respuesta directa: esto es casi lo mismo, no nos detendremos por separado.  Todavía puede haber una memoria caché adicional, pero en general tampoco hay grandes problemas con la memoria caché. <br><br><h3>  Seguridad </h3><br>  Veamos mejor un control de seguridad.  También puede haber el mismo decorador de seguridad, que verifica si esta solicitud se puede hacer o no: <br><br><img src="https://habrastorage.org/webt/9k/y7/dr/9ky7drwhf3o5tk_r6wcapy4nqaw.jpeg"><br><br>  Pero hay otro caso en el que mostramos más de un registro y una lista, y para algunos usuarios necesitamos mostrar una lista completa (por ejemplo, para algunos superadministradores), y para otros usuarios tenemos que enumerar listas limitadas, en tercer lugar, limitadas a otro, bueno, y como suele ser el caso en las aplicaciones corporativas, los derechos de acceso pueden ser extremadamente sofisticados, por lo que debe asegurarse de que los datos que no se dirigen a estos usuarios no entren en estas listas. <br><br>  El problema se resuelve de manera <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">bastante simple</a> .  Podemos redefinir la interfaz (IPermissionFilter) en la que llega el consultable original y regresa consultable.  La diferencia es que para el consultable que regresa, ya hemos impuesto condiciones adicionales donde, verificamos al usuario actual y le dijimos: "Aquí, devuelva solo esos datos a ese usuario ...", y luego toda su lógica relacionada con los permisos .  Nuevamente, si tiene dos programadores, un programador va a escribir permisos, él sabe que necesita escribir solo una gran cantidad de permisosFiltros y verificar que funcionen correctamente para todas las entidades.  Y otros programadores no saben nada sobre permisos, en su lista los datos correctos simplemente siempre pasan, eso es todo.  Debido a que reciben en la entrada, ya no se puede consultar el original de dbContext, sino que se limitan a los filtros.  Dicho permissionFilter también tiene una propiedad de diseño, podemos agregar y aplicar todos los permissionFilters.  Como resultado, obtenemos el permisoFilter resultante, que reducirá la selección de datos al máximo, teniendo en cuenta todas las condiciones que sean adecuadas para esta entidad. <br><br><img src="https://habrastorage.org/webt/25/2o/xj/252oxjpxf1p7zd_aq3nt55cenyi.jpeg"><br><br>  ¿Por qué no hacerlo con las herramientas integradas de ORM, por ejemplo, filtros globales en un marco de entidad?  Una vez más, para no crear dependencias cíclicas para usted y no arrastrar ninguna historia adicional sobre su capa de negocio al contexto. <br><br><h3>  Tubería de consulta.  Leer modelo </h3><br>  Queda por ver el modelo de lectura.  El paradigma CQRS no utiliza el modelo de dominio en la pila de lectura, en su lugar, simplemente creamos inmediatamente el Dto que el navegador necesita en este momento. <br><br><img src="https://habrastorage.org/webt/2s/kc/0y/2skc0ygq4rmh9rs6cyg5czxa5rm.jpeg"><br><br>  Si escribimos en C #, lo más probable es que estemos usando LINQ, si no existen requisitos de rendimiento monstruosos, y si los hay, es posible que no tenga una aplicación corporativa.  En general, este problema se puede resolver de una vez por todas con un LinqQueryHandler.  Aquí hay una restricción bastante aterradora sobre el genérico: esta es Consulta, que devuelve una lista de proyecciones, y aún puede filtrar estas proyecciones y ordenar estas proyecciones.  También trabaja solo con algunos tipos de entidades y sabe cómo convertir estas entidades en proyecciones y devolver la lista de tales proyecciones en forma de Dto al navegador. <br><br><img src="https://habrastorage.org/webt/8e/vz/ax/8evzaxkzbhqx0mgxfadxacpek24.jpeg"><br><br>  La implementación del método Handle puede ser bastante simple.  Por si acaso, verifique si este filtro TQuery se implementa para la entidad original.  Además hacemos una proyección, es consultable la extensión AutoMapper'a.  Si alguien aún no lo sabe, AutoMapper puede construir proyecciones en LINQ, es decir, aquellas que construirán el método Select y no lo mapearán en la memoria. <br><br>  Luego aplicamos filtrado, clasificación y lo mostramos todo en el navegador.     ,      DotNext,     ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  </a> ,  , , ,     expression' ,            . <br><br><h3>     <s></s>   SQL </h3><br>  .  ,       DotNext', —      SQL.    Select , ,      ,  queryable-   . <br><br><img src="https://habrastorage.org/webt/3j/ns/3b/3jns3bzz_ebriubturd0ewzzwqg.jpeg"><br><br>      ,    .     ,    Title,  Title      ,     .      ,  .        SubTitle,      ,   ,     -      ,    queryable-   .    ,        . <br><br>      ,    .  ,    ,     .    ,   , .     «JsonIgnore»,     .    ,   ,  Dto.    ,     ,      .       JSON,  ,  Created  LastUpdated   ,  SubTitle —   ,   .    ,   ,        ,   , ,       .          ,  -     . <br><br><img src="https://habrastorage.org/webt/uy/el/go/uyelgoxsnf7dzhsv6arfq0q16ly.jpeg"><br><br>      . ,  -,      ,    .    ,  pipeline,     .      —      , ,  . ,      SaveChanges,   Query    SaveChanges.      ,    ,          ,   NuGet,         . <br><br>         .     ,    -  ,     ,     .   , ,   , , ,       —   . ,  ,      : «    », —   .  . <br><br><h2>   </h2><br>    ,    ? <br><br><img src="https://habrastorage.org/webt/rj/px/0i/rjpx0ig2zyqa7d9g47vibhbeccy.jpeg"><br><br>    -  .   . <br><br><img src="https://habrastorage.org/webt/d6/ag/p7/d6agp7a_t3m2ppxscq9vb7piagq.jpeg"><br><br>  , ,    ,     .   MediatR  ,         . ,    ,    — ,    MediatR   pipeline behaviour.    ,      Request/Response, RequestHandler'      .    Simple Injector,    —    . <br><br><img src="https://habrastorage.org/webt/qd/et/4g/qdet4g_b9ezljfr1mx9moe_m18y.jpeg"><br><br>       , ,  ,       ,  TIn: ICommand. <br><br><img src="https://habrastorage.org/webt/su/nb/vn/sunbvndlkmxley6clq7hs4hj70s.jpeg"><br><br>   Simple Injector'      constraint' .     ,    , ,     constraint',        Handler',     constraint. ,     constraint ICommand,      SaveChanges   constraint'  ICommand,  Simple Injector  ,    constraint' ,         Handler'. ,      ,          ,     . <br><br>  ? Simple Injector  MeriatR —  ,       ,    Autofac', -,          ,    ,  .  , . <br><br><h2>   ,    </h2><br>          ,   «». <br><br><img src="https://habrastorage.org/webt/8m/1l/lj/8m1lljzfrx2amaidftyjnthd3yc.jpeg"><br><br>   ,   «Clean architecture».             . <br><br><img src="https://habrastorage.org/webt/ch/gm/jq/chgmjq7gihsvthnvinnydngrtcw.jpeg"><br><br>  - -     ,   MVC,   ,    . <br><br><img src="https://habrastorage.org/webt/g8/70/wz/g870wzkcrbvqeplit3m_i69uru4.jpeg"><br><br>  ,   ,   ,     Angular, ,       ,      ,    .  ,  : « — MVC-»,  : «    Features,    :     ,    Blog     - Import,    -  ». <br><br>  , , ,  ,   MVC-,  ,   -  , .    MVC  .    ,   ,      —     .       . <br><br><img src="https://habrastorage.org/webt/ix/8v/qo/ix8vqotanjad8uljd2rfz17xygg.jpeg"><br><br><img src="https://habrastorage.org/webt/xq/lj/bv/xqljbvd8zk59n6pdn1-q-x4czhc.jpeg"><br><br>    -     ,  -   -,        . <br><br> -,     ,   .            ,   .   ,          -   ,         User Service,   pull request',     ,       User Service    ,   .    ,      - ,     -  , . -       ,             . <br><br>  .         ,          .  ,    ,             ,   . , ,  ,  ,   ,     ,    ,     -   .    ,      (    ,    ),     ,    «Delete»:   ,      ,  .  . <br><br>          —  «», ,   ,       ,   .          ,    :   ,    ,     ,      .           ,   .      ,    ,   .      ,      ,      . <br><br>   :        .    « »,        :     ,     ,         . ,    ,    ,       , ,    ,  ,   .        ,   .  ,   - pull request    ,    —  ,    — -   ,    .          VCS    :     -  ,    ?       ,    -  ,         ,    . <br><br><img src="https://habrastorage.org/webt/ie/g2/i6/ieg2i6gpy-mp6nsmrvdvxot3x6o.jpeg"><br><br>   , ,    ,   .  :     .        ,     .  ,    ,      ,  ,   .    , ,    ,      . ,  , .    « »,        ,     .  ,   ,      —  ,      ,   . <br><br>      :    , - , .           .  -      ,    ,  ,   ,  .       -        ,  -        ,      , ,      ,    .    . <br><br><img src="https://habrastorage.org/webt/8g/7g/3h/8g7g3htn43hhoprdfj2thj86wre.jpeg"><br><br> .         ,       IHandler     .    . <br><br>   IHandler    ICommandHandler  IQueryHandler  ,    .    ,     ,       .  ,   CommandHandler,      CommandHandler',       . <br><br>  Por qué      ,    Query   ,   Query —   .      ,     ,  ,    Hander,    CommandHandler  QueryHandler,   -  use case,     . <br><br>  —     ,      ,  ,    ,     :  ,  . <br><br>      ,  .         ,    .    ,       -. <br><br>      C# 8,   nullable reference type      .  , , ,     ,  . <br><br>         ChangeTracker' ORM. <br><br>  Exception' —     ,     F#,     C#.  ,   -     ,    -   , .        ,   ,      Exception', ,      LINQ,   ,  ,    ,     ,    , Dapper  - , ,  ,   .NET. <br><br>          ,  LINQ,  , permission' —   . ,    ,   - ,    ,       .      ,     —   . <br><br>        .  : <br><br><hr><br><ul><li> Vertical Slices <br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.youtube.com/watch?v=SUiWfhAhgQw</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.cuttingedge.it/blogs/steven/pivot/entry.php?id=91</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cuttingedge.it/blogs/steven/pivot/entry.php?id=92</a> </li></ul></li><li>   <br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habr.com/post/266937</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habr.com/post/205088</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habr.com/post/205108</a> </li></ul></li><li> Domain Events <br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">udidahan.com/2009/06/14/domain-events-salvation</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lostechies.com/jimmybogard/2014/05/13/a-better-domain-events-pattern</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enterprisecraftsmanship.com/2017/10/03/domain-events-simple-and-reliable-solution</a> </li></ul></li><li> DDD <br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habr.com/post/334126</a> </li></ul></li><li> ROP <br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fsharpforfunandprofit.com/rop</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habr.com/post/339606</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habr.com/post/347284</a> </li></ul></li><li> LINQ  Expressions: <br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">habr.com/company/jugru/blog/423891</a> </li></ul></li><li> Clean Architecture <br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">www.youtube.com/watch?v=JEeEic-c0D4</a> </li></ul></li></ul><br><img src="https://habrastorage.org/webt/fm/ik/wu/fmikwu49krcbqw7xbefe1vm6tsq.jpeg"><br><br>   —   .      .   —     «Domain Modeling Made Functional»,   F#,          F#,      ,     ,     ,        ,      .       C# ,    ,         Exception'. <br><br>  ,  ,   —  «Entity Framework Core In Action».      ,    Entity Framework,         ,     DDD  ORM,   ,   ORM      DDD    . <br><br><blockquote>  Minuto de publicidad. 15-16  2019  .NET- DotNext Piter,      .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  </a> ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> </a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447308/">https://habr.com/ru/post/447308/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447298/index.html">Gestión del conocimiento a través de modelos de competencia.</a></li>
<li><a href="../447300/index.html">Construyendo VirtualBox para Windows</a></li>
<li><a href="../447302/index.html">Sistema operativo de fin de semana</a></li>
<li><a href="../447304/index.html">Avaricious no paga dos veces: configuramos la memoria en la plataforma AMD B450 y recibimos productividad gratuita</a></li>
<li><a href="../447306/index.html">Transformador Tesla en una placa de una pulgada cuadrada</a></li>
<li><a href="../447310/index.html">Cómo pasamos del desarrollo web al desarrollo de juegos</a></li>
<li><a href="../447314/index.html">Lo que entendí sobre construir un negocio después de trabajar durante siete años en Airbnb</a></li>
<li><a href="../447318/index.html">Gadgets de un mercado de pulgas: por qué comprar una laptop Packard Bell de 20 años por 10 euros</a></li>
<li><a href="../447322/index.html">Principios para construir una API REST JSON</a></li>
<li><a href="../447324/index.html">Cómo funciona la computadora dentro de Hayabusa-2, que arrojó una bomba sobre Ryuga. Y fotos de sus desarrolladores.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>