<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòÅ üî§ üñïüèª CMS sin cabeza. ¬øPor qu√© estoy escribiendo el m√≠o? üï∫üèæ üë©üèæ‚Äçüíª üìó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos! 

 Este reciente art√≠culo me impuls√≥ a escribir esta publicaci√≥n (la vi ayer). 

 Vuelva a contar las caracter√≠sticas principales de Hea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CMS sin cabeza. ¬øPor qu√© estoy escribiendo el m√≠o?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448982/"> Hola a todos! <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Este reciente art√≠culo</a> me <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">impuls√≥</a> a escribir esta publicaci√≥n (la vi ayer). <br><br>  Vuelva a contar las caracter√≠sticas principales de Headless / content-first / api-first, etc.  No ser√© CMS, el material est√° lleno y probablemente muchos ya est√©n familiarizados con esta tendencia.  Y quiero decirles por qu√© y c√≥mo escribo mi sistema, por qu√© no pude elegir entre los existentes, qu√© pienso sobre otros sistemas que he encontrado antes y qu√© perspectivas veo para todo esto.  La ficci√≥n ser√° voluminosa (para el material en dos a√±os), pero intentar√© escribir m√°s interesante y √∫til.  A qui√©n le importa, por favor, debajo del gato. <br><a name="habracut"></a><br>  En general, la historia es muy larga y tratar√© de contarla primero.  Ya sea para aclarar cu√°les son las verdaderas razones para crear este motor por su cuenta, o simplemente porque sin esto ser√° dif√≠cil en el terreno explicar por qu√© lo estoy haciendo de esta manera, y no de alguna manera. <br><br>  Pero, para empezar, escribir√© brevemente personalmente los principales criterios de selecci√≥n para el Headless-CMS moderno, por qu√© a√∫n no pod√≠a elegir una soluci√≥n preparada para m√≠.  <i>Solo para que la gente no se detenga a leer muchas hayas, sin entender lo que eventualmente se contar√°.</i> <br><br>  Brevemente: quer√≠a que todo estuviera en un solo lugar: tanto la parte posterior como la frontal (y no esto o lo otro), y la API GraphQL, y que la base de datos sea administrada y mucho m√°s, incluido el bot√≥n "Make Beautiful".  No he encontrado esto.  Yo tampoco he hecho esto todav√≠a, pero en general ha resultado bastante y, lo m√°s importante, me permite hacer proyectos reales. <br><br>  Y as√≠, mi enfoque dif√≠cilmente puede llamarse cient√≠fico y justificado.  El hecho es que generalmente escribo algo muy a menudo.  Me gusta programar aqu√≠.  Y hace dos a√±os (y antes de eso otros 8 a√±os) me sent√© en el MODX CMF (bajo el cual tambi√©n invent√© muchas de mis muletas).  Y durante tres a√±os comenzamos un proyecto a gran escala, en virtud del cual, me pareci√≥, pod√≠a usar MODX.  Pero result√≥ que no pod√≠a ... La raz√≥n principal era que era una startup sin ning√∫n requisito t√©cnico, con un mont√≥n de ideas que cambiaban y se complementaban todos los d√≠as (y varias veces al d√≠a).  Y ahora, cada vez que, bajo una nueva idea, era necesario agregar alguna entidad nueva, registrar / cambiar campos para los existentes, crear / eliminar / cambiar relaciones entre estas entidades (respectivamente, con un cambio en la estructura de la base de datos), tengo en alg√∫n momento Comenz√≥ a tomar varias horas para cambiar estas entidades.  De hecho, adem√°s del hecho de que era necesario registrar estos cambios en el esquema, era necesario cambiar la base de datos (casi manualmente), actualizar la API, reescribir el c√≥digo del programa, etc., etc.  En consecuencia, el frente tuvo que actualizarse bajo todo esto.  Como resultado, decid√≠ que deber√≠amos buscar algo nuevo, m√°s conveniente, que de alguna manera simplificara todo esto.  Aclarar√© una vez m√°s que en ese momento yo era un backend de php, as√≠ que no se sorprenda ni se r√≠a de que comenc√© a descubrir varios constructores front-end, menos procesadores, npm, etc.  etc.  Pero de todos modos, gradualmente en nuestro proyecto apareci√≥ un frente en react + less, una API en GraphQL y un servidor en express. <br><br>  Pero no todo era tan color de rosa como parecer√≠a a muchos ahora.  D√©jame recordarte, esto fue hace m√°s de dos a√±os.  Si ha estado en la web moderna de JS por menos de dos a√±os, le aconsejo que lea este art√≠culo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">N razones para usar la aplicaci√≥n Create React</a> (habr).  Demasiado perezoso, en resumen: con el advenimiento de los scripts de reacci√≥n, no puede molestarse en configurar el paquete web, etc.  Todo esto pasa a un segundo plano.  Los tipos buenos ya han configurado el paquete web para que la mayor√≠a de los proyectos reactivos est√©n casi garantizados para trabajar en √©l, y el desarrollador final se centr√≥ directamente en la programaci√≥n del producto final, en lugar de configurar un mont√≥n de dependencias, cargadores, etc.  Pero esto es m√°s tarde.  Y antes de eso, solo ten√≠a que configurar este paquete web, seguir la actualizaci√≥n del mont√≥n de todo lo que vol√≥ con √©l para ponerse al d√≠a, etc.  etc.  Pero esto es solo una parte del trabajo, solo esencialmente el frente.  Y tambi√©n necesitas un servidor.  Y tambi√©n necesitas una API.  Y tambi√©n necesita SSR (representaci√≥n del lado del servidor), que, por cierto, react-script todav√≠a no proporciona, por lo que s√©.  En general, todo era mucho m√°s complicado que ahora, no hab√≠a mucho, y todos se paralizaron lo mejor que pudieron.  ¬øY c√≥mo me mude entonces? <br><br>  Solo imagina: <br><br><ul><li>  Configuraci√≥n nativa del paquete web por separado para el frente y el servidor. </li><li>  Implementaci√≥n propia de SSR, para que async funcione normalmente con react-server, y los estilos inmediatamente listos lleguen, y se indexen normalmente, y se proporcionen los estados del servidor para las p√°ginas no encontradas. </li><li>  No redux.  Bueno, no me gust√≥ redux de inmediato.  Me gust√≥ la idea de usar mi flujo de reacci√≥n nativo (aunque tuve que reescribirlo un poco para m√≠). </li><li>  Esquemas y solucionadores GraphQL prescritos manualmente, sin despliegue autom√°tico de la base de datos (el servidor API se utiliz√≥ como medio para un sitio MODX). </li><li>  Sin react-apollo / apollo-client, etc.  Todo se escribe de forma independiente con solicitudes a trav√©s de fetch, repositorios en un navegador basado en flujo personalizado. </li></ul><br>  Como resultado: hasta ahora, una de las primeras versiones de este tiene un proyecto con una asistencia de m√°s de 500, y en la temporada (invierno) 1000-1700 estudiantes √∫nicos por d√≠a.  Tiempo de actividad 2 meses.  Esto se debe a que reinici√© manualmente el servidor despu√©s de una actualizaci√≥n preventiva de software.  Y antes de este reinicio, el tiempo de actividad era de m√°s de 6 meses.  Pero lo m√°s interesante es el consumo de memoria.  Actualmente hay casi 700 megabytes de proceso js.  S√≠, s√≠, tambi√©n me estoy riendo contigo :) Por supuesto, esto es mucho.  Y antes de eso hice un poco de prevenci√≥n y mejor√© este indicador.  Anteriormente, hab√≠a un total de 1000M + por proceso ... Sin embargo, funcion√≥ y fue bastante tolerable.  Y antes de que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Google cambiara los algoritmos de PageSpeed ‚Äã‚ÄãInsights</a> en noviembre, el sitio ten√≠a una m√©trica de rendimiento 97/100.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Prueba</a> <br><br>  Una conclusi√≥n intermedia basada en este proyecto basada en un sistema que se desarroll√≥ a√∫n m√°s sin este proyecto (el proyecto se qued√≥ atr√°s): <br><br>  <b>Pros</b> <br><br><ol><li>  La API del proyecto se ha vuelto m√°s flexible mediante el uso de GraphQL, y la cantidad de solicitudes del servidor se ha reducido significativamente. </li><li>  El proyecto tiene acceso a una gran cantidad de componentes en npm. </li><li>  La gesti√≥n de proyectos se ha vuelto m√°s transparente mediante el uso de dependencias, git, etc. </li><li>  Las secuencias de comandos y los estilos incorporados son ciertamente m√°s agradables que un mont√≥n de secuencias de comandos separadas en sitios antiguos, cuando no sabes qu√© puedes eliminar de este zool√≥gico sin consecuencias (y a menudo ves varias versiones de un error en un sitio). </li><li>  El sitio se ha vuelto m√°s interactivo, las p√°ginas funcionan sin reiniciar, volver a las p√°ginas vistas anteriormente no requiere llamadas repetidas al servidor. </li><li>  La edici√≥n de datos se realiza directamente en la p√°gina, seg√∫n el principio de "editar lo que ves y d√≥nde ves", sin ning√∫n panel de administraci√≥n separado. </li></ol><br>  <b>Contras (principalmente para el desarrollador)</b> <br><br><ol><li>  Todo es muy complicado.  De verdad.  Simplemente no es realista conectar a un desarrollador externo al proyecto.  Yo mismo apenas pod√≠a entender qu√© y c√≥mo funciona y de d√≥nde crecen mis piernas.  Si nos fijamos en la p√°gina 3 de las ventajas, donde se dice acerca de la transparencia, entonces la transparencia solo est√° en que si enganchas algo en alg√∫n lugar, puedes ver de inmediato lo que est√° roto (los scripts no se compilan, etc.), sino por commits y diffs Puedes encontrar d√≥nde se enganch√≥ eso.  Bueno, si lograste agregar algo nuevo y funciona, al menos entiendes claramente que s√≠, que todo sali√≥ bien.  Pero en general sigue siendo un infierno infernal. </li><li>  Dificultades con el almacenamiento en cach√©.  M√°s tarde, descubr√≠ apollo-client por m√≠ mismo.  Y antes de eso, como dije, escrib√≠ mis almacenamientos basados ‚Äã‚Äãen flujo.  Debido a estos almacenamientos, era posible obtener los datos necesarios para renderizar desde diferentes componentes, pero el volumen de cach√© en el lado del cliente era muy grande (cada conjunto de entidades t√≠picas ten√≠a su propio repositorio).  Como resultado, fue dif√≠cil verificar si el objeto se solicit√≥ antes o no (es decir, si vale la pena hacer una solicitud al servidor para encontrarlo), si todos los datos relacionados est√°n disponibles, etc. </li><li>  Dificultades con los esquemas, la estructura de la base de datos y los solucionadores (funciones API para recibir / modificar datos).  Como dije, escrib√≠ esquemas manualmente, y tambi√©n resolvers.  En lo que resolvi√≥, intent√© proporcionar almacenamiento en cach√© y procesamiento de solicitudes anidadas y otras sutilezas.  En ese momento tuve que profundizar en la esencia y el c√≥digo del programa GraphQL.  Lo bueno es que generalmente entiendo bastante bien c√≥mo funciona GraphQL, cu√°les son sus ventajas y desventajas, y c√≥mo cocinarlo mejor.  La desventaja es que, por supuesto, no puede escribir todas esas comodidades y bollos escritos por comandos como Apolo en uno.  Como resultado, cuando descubr√≠ Apollo, por supuesto, con gran placer comenc√© a usar sus componentes (pero principalmente en el frente, te dir√© por qu√© a continuaci√≥n). </li></ol><br>  En general, este proyecto que utiliza tecnolog√≠as obsoletas es personalmente m√≠o al 100%, por lo que puedo permitirme abandonarlo hasta tiempos mejores.  Pero hay otros proyectos para los que tuve que ir m√°s all√° y desarrollar la plataforma.  Y varias veces tuve que reescribir todo desde cero.  Adem√°s, hablar√© con m√°s detalle sobre las tareas individuales que encontr√© y qu√© soluciones desarroll√© y apliqu√© como resultado. <br><br>  <b>Esquema primero.</b>  <b>Primero el circuito, y luego todo lo dem√°s</b> <br><br>  Un sitio (interfaz web, cliente ligero, etc.) es toda la visualizaci√≥n de informaci√≥n (bueno, gesti√≥n de la informaci√≥n, si est√° permitida, y la funcionalidad lo permite).  Pero primero, de todos modos, una base de datos (tablas, columnas, etc.).  Habiendo encontrado varios enfoques diferentes para trabajar con la base de datos en mi camino, me gust√≥ m√°s el enfoque del primer esquema.  Es decir, describe el esquema de entidades y tipos de datos (manualmente o a trav√©s de la interfaz), implementa el esquema e inmediatamente tiene los cambios descritos en la base de datos (las tablas / columnas se crean / eliminan, as√≠ como las relaciones entre ellas).  Dependiendo de la implementaci√≥n, tambi√©n generar√° todas las funciones de resoluci√≥n necesarias para administrar estos datos.  Sobre todo en esta direcci√≥n, me gust√≥ el proyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">prisma.io</a> . <br><br>  Con su permiso, ya que incluso en el centro no he visto un solo art√≠culo sobre el prisma, llamar√© la atenci√≥n un poco sobre ellos, ya que el proyecto es realmente muy interesante, y sin ellos no hubiera tenido una plataforma que me hiciera tan feliz. .  En realidad, es por eso que llam√© a mi plataforma prisma-cms, porque prisma.io juega un papel muy importante en ella. <br><br>  En realidad, prisma.io es un proyecto SaaS, pero con una gran advertencia: ponen casi todo lo que hacen en un github.  Es decir, puede usar sus servidores por una tarifa muy razonable (y configurar su propia base de datos y API en cuesti√≥n de minutos), o puede implementar completamente todo en casa.  En este caso, el prisma debe dividirse l√≥gicamente en dos partes separadas importantes: <br><br><ol><li>  Prisma-server, es decir, el servidor donde tambi√©n gira la base de datos. </li><li>  Prisma-cliente.  Esencialmente tambi√©n es un servidor, pero en relaci√≥n con la fuente de datos (servidor prisma) es un cliente. </li></ol><br>  Ahora intentar√© explicar esta situaci√≥n confusa.  En general, la esencia del prisma es que al usar un √∫nico punto final de API, puede trabajar con diferentes fuentes de datos.  S√≠, aqu√≠ cualquiera dir√° que a todos se les ocurri√≥ GraphQL y que no se necesita prisma aqu√≠.  En general, todos tendr√°n raz√≥n, pero hay un punto serio: GraphQL solo define los principios y el trabajo general, pero por s√≠ solo, no proporciona trabajo con las fuentes de datos finales listas para usar.  √âl dice: "Puede crear una API para describir qu√© solicitudes pueden enviar los usuarios, pero la forma en que maneja estas solicitudes depende de usted".  Y el prisma tambi√©n, por supuesto, usa GraphQL (por cierto, y muchas otras cosas, incluidos varios productos apollo).  Pero el prisma m√°s a esto solo proporciona trabajo con la base de datos.  Es decir, al describir el esquema y su despliegue, las tablas y columnas necesarias (as√≠ como las relaciones entre ellas) se crear√°n inmediatamente en la base de datos especificada, e incluso generar√°n de inmediato todas las funciones CRUD necesarias.  Es decir, con un prisma, no solo obtienes un servidor GraphQL, sino una API de trabajo completa que te permite trabajar inmediatamente con la base de datos.  Por lo tanto, Prisma-server proporciona una base de datos e interacci√≥n con ella, y prisma-client le permite escribir sus resoluciones y enviar solicitudes a prisma-server (o en otro lugar, incluso para algunos servidores prisma).  Y resulta que solo puede implementar prisma-client por su cuenta (y SaaS prisma.io se usar√° como prisma-server), y puede implementar prisma-server por su cuenta, y generalmente no depende de un prisma de ninguna manera, eso es todo el tuyo <br><br>  Aqu√≠ he elegido un prisma para m√≠, como base de mi plataforma.  Pero luego tuve que hacerla girar para obtener una plataforma completa. <br><br><h4>  1. Combinar esquemas </h4><br>  En ese momento, el prisma no pod√≠a combinar circuitos.  Es decir, la tarea es la siguiente: <br><br>  Tiene un modelo de usuario descrito en un m√≥dulo. <br><br><pre><code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique email: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> @unique }</code> </pre> <br>  y en otro m√≥dulo <br><br><pre> <code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique firstname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> lastname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> }</code> </pre><br>  Como parte de un proyecto, desea combinar estos dos esquemas autom√°ticamente para obtener el resultado <br><br><pre> <code class="javascript hljs">type User { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: ID! @unique username: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span>! @unique email: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> @unique firstname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> lastname: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> }</code> </pre><br>  Pero entonces este prisma no pudo hacer.  Result√≥ implementar esto usando la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">biblioteca merge-graphql-schemas</a> . <br><br><h4>  Trabaja con un servidor prisma arbitrario. </h4><br>  En el prisma, la configuraci√≥n se escribe en un archivo de configuraci√≥n especial.  Si desea cambiar la direcci√≥n del servidor de prisma utilizado, debe editar el archivo.  Un poco, no agradable.  Quer√≠a hacer posible la URL para especificar en el comando, por ejemplo endpoint = http: // endpoint-address yarn deploy (inicio de hilo).  Eso fue asesinado durante varios d√≠as ... Pero ahora puedes usar un proyecto de prisma para cualquier n√∫mero de puntos finales.  Por cierto, hasta ahora prisma-cms funciona f√°cilmente incluso con una base de datos local, incluso con servidores de prisma SaaS. <br><br><h4>  M√≥dulos / Complementos </h4><br>  Esto generalmente no fue suficiente.  Como dije, la tarea principal del prisma es proporcionar trabajo con varias bases de datos.  Y hacen un excelente trabajo de esto.  Ya admiten trabajar con MySQL, PostgreSQL, Amazon RDS y MongoDB, varios tipos m√°s de fuentes en camino.  Pero no proporcionan ninguna infraestructura modular.  Hasta ahora no hay mercado o algo as√≠.  Solo hay unos pocos espacios en blanco t√≠picos.  Pero no puede elegir dos o tres de varios espacios en blanco e instalar en un proyecto.  Tendremos que elegir uno.  Quer√≠a que fuera posible instalar un n√∫mero diferente de m√≥dulos en el proyecto final, y que al implementar los circuitos y los resolvers se alegraran y obtuvieran un proyecto √∫nico con la funcionalidad total.  Y aunque todav√≠a no hay una interfaz gr√°fica, ya hay m√°s de dos docenas de m√≥dulos de trabajo y componentes que se pueden combinar en el proyecto final.  Aqu√≠ inmediatamente decidir√© un poco sobre las definiciones personales: un m√≥dulo es lo que est√° instalado en la parte posterior (expandiendo la base de datos y la API), y un componente es lo que est√° instalado en la parte frontal (para agregar varios elementos de interfaz).  Hasta ahora, no hay una interfaz gr√°fica para conectar m√≥dulos, pero no es dif√≠cil para m√≠ escribir de esta manera (esto no se hace a menudo): <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(options = {}) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(options); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mergeModules([ LogModule, MailModule, UploadModule, SocietyModule, EthereumModule, WebrtcModule, UserModule, RouterModule, ]); }</code> </pre><br>  Despu√©s de agregar nuevos m√≥dulos, es suficiente simplemente realizar una implementaci√≥n con un comando nuevamente y eso es todo, aqu√≠ ya tenemos nuevas tablas / columnas y funcionalidad aumentada. <br><br><h4>  5 frontal, sensible a los cambios en el backend </h4><br>  Esto no fue suficiente en absoluto.  Esto ser√° seguido por una digresi√≥n.  El hecho es que todos los CMS que vi por primera vez en la API dicen "Somos incre√≠bles para proporcionar la API, y t√∫ atornillas el frente que deseas".  Esto es lo que "atornillan lo que quieras" en realidad significa "molesta como quieras".  Exactamente lo mismo que los marcos de la interfaz de usuario dicen, "mira qu√© botones geniales somos y hacemos todo eso, y conf√∫ndete con el back-end".  Eso siempre mataba.  Solo quer√≠a encontrar un CMS completo escrito en javascript, usando GraphQL y proporcionando tanto atr√°s como adelante.  Pero no encontr√© uno as√≠.  Realmente quer√≠a que los cambios de API se percibieran de inmediato en el frente.  Y para esto, se completaron varios subpasos: <br><br><h4>  5.1 Generando fragmentos de API </h4><br>  En el frente, los fragmentos del archivo de esquema se registran en las solicitudes.  Cuando la API se reconstruye en el servidor, tambi√©n se genera un nuevo archivo JS con fragmentos de API.  Y en las solicitudes se escribe as√≠: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { UserNoNestingFragment, EthAccountNoNestingFragment, NotificationTypeNoNestingFragment, BatchPayloadNoNestingFragment, } = queryFragments; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userFragment = <span class="hljs-string"><span class="hljs-string">` fragment user on User { ...UserNoNesting EthAccounts{ ...EthAccountNoNesting } NotificationTypes{ ...NotificationTypeNoNesting } } </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${UserNoNestingFragment}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${EthAccountNoNestingFragment}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${NotificationTypeNoNestingFragment}</span></span></span><span class="hljs-string"> `</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> usersConnection = <span class="hljs-string"><span class="hljs-string">` query usersConnection ( $where: UserWhereInput $orderBy: UserOrderByInput $skip: Int $after: String $before: String $first: Int $last: Int ){ objectsConnection: usersConnection ( where: $where orderBy: $orderBy skip: $skip after: $after before: $before first: $first last: $last ){ aggregate{ count } edges{ node{ ...user } } } } </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${userFragment}</span></span></span><span class="hljs-string"> `</span></span>;</code> </pre><br><h4>  5.2 Un contexto para todos los componentes </h4><br>  React 16.3 presenta una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nueva API de contexto</a> .  Lo hice para que en los componentes secundarios en cualquier nivel pueda acceder a un solo contexto sin enumerar los tipos deseados del contexto, sino simplemente especificando static contextType = PrismaCmsContext y obteniendo todos los encantos a trav√©s de este-&gt; contexto (incluido el cliente API, el esquema , solicitudes, etc.). <br><br><h4>  5.3 filtros din√°micos </h4><br>  Tambi√©n realmente quer√≠a hacerlo.  GraphQL le permite crear consultas complejas con una estructura anidada.  Tambi√©n quer√≠a que los filtros fueran din√°micos, formados a partir del esquema API, y que nos permitieran crear condiciones anidadas.  Esto es lo que sucedi√≥: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YOCF3ttK2Mg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h4>  5.4 Creador de sitios web </h4><br>  Y finalmente, lo que me faltaba era un editor de sitio externo, es decir, un dise√±ador.  Quer√≠a que el servidor tuviera solo un m√≠nimo de acciones para realizar, y todo el dise√±o final deber√≠a hacerse en el frente (incluida la configuraci√≥n de enrutamiento, generaci√≥n de selecciones, etc.).  Este es un tema para un art√≠culo separado, porque entre otras cosas, tambi√©n escrib√≠ mi editor de wysiwyg crutchy para √©l en contenido puro Editable, y hay muchas sutilezas.  Si recupero mis derechos y qui√©n estar√° interesado, escribir√© un art√≠culo por separado. <br><br>  Bueno, finalmente, un breve video de demostraci√≥n del dise√±ador en acci√≥n.  Todav√≠a bastante crudo, pero me gusta. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/4j9ePxDhHGU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Terminar√© con eso.  Todav√≠a no he escrito mucho, lo que me gustar√≠a escribir, pero han pasado muchas cosas.  Estar√© encantado de comentar. <br><br>  PD: todos los c√≥digos fuente, incluidos los c√≥digos fuente del sitio en s√≠, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">est√°n aqu√≠</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/448982/">https://habr.com/ru/post/448982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448968/index.html">PHP asincr√≥nico. Por qu√©</a></li>
<li><a href="../448970/index.html">Autenticaci√≥n de dos factores para SSH</a></li>
<li><a href="../448974/index.html">Enfoque sin servidor para el r√°pido desarrollo de un servicio de video en funcionamiento</a></li>
<li><a href="../448976/index.html">Eventos de primavera de Gamedev en HSE</a></li>
<li><a href="../448980/index.html">Nuestro primer almuerzo juntos: por qu√© y c√≥mo pasamos nuestro d√≠a de prueba</a></li>
<li><a href="../448986/index.html">Ingenier√≠a inversa 3D con escaneo 3D</a></li>
<li><a href="../448988/index.html">Las SSD de Kingston se han vuelto m√°s amplias, manteniendo casi el mismo costo: cumplimos con la serie A400-R</a></li>
<li><a href="../448994/index.html">¬øEs tan dif√≠cil comenzar el camino de un reclutador de TI?</a></li>
<li><a href="../448996/index.html">Crear una pol√≠tica de contrase√±a en Linux</a></li>
<li><a href="../448998/index.html">Si la conexi√≥n es solo de esta√±o, entonces debes enterrarla</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>