<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíû üë≤ ü§üüèæ Generador de gr√°ficos de transacciones grandes con patrones de actividad criminal. ‚õëÔ∏è ‚ôíÔ∏è ‚ú®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buen dia 


 Hace un par de a√±os, nuestro equipo (cumplimiento en un banco suizo) enfrent√≥ una tarea muy interesante: era necesario generar un gran gr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Generador de gr√°ficos de transacciones grandes con patrones de actividad criminal.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447626/"><p>  Buen dia </p><br><img src="https://habrastorage.org/getpro/habr/post_images/bf5/b6a/741/bf5b6a741fe67284b678bcebf503a2b1.jpg" alt="Red"><br><br>  Hace un par de a√±os, nuestro equipo (cumplimiento en un banco suizo) enfrent√≥ una tarea muy interesante: era necesario generar un gran gr√°fico de transacciones entre clientes, empresas y cajeros autom√°ticos, agregar patrones similares a los del lavado de dinero y otras actividades delictivas a este gr√°fico, y tambi√©n agregar un m√≠nimo informaci√≥n sobre los nodos de este gr√°fico: nombres, direcciones, hora, etc.  Por supuesto, todos los datos tuvieron que ser generados desde cero, sin utilizar los datos existentes del cliente. <br><p>  Para resolver este problema, se escribi√≥ un generador, que me gustar√≠a compartir con ustedes.  Debajo del corte, encontrar√° una historia que explica por qu√© la necesit√°bamos, y una descripci√≥n del funcionamiento del generador.  Para impacientes: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠ est√° el c√≥digo</a> .  Me alegrar√≠a que alguien se beneficie de nuestra experiencia. </p><a name="habracut"></a><br><h2 id="zachem-my-zanyalis-takoy-erundoy">  ¬øPor qu√© estamos haciendo tales tonter√≠as? </h2><br><p>  Nuestro equipo decidi√≥ participar como patrocinadores en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hackathon</a> LauzHack </p>  .  Una de las condiciones para participar en el formato de patrocinador fue la provisi√≥n de una tarea comercial real para los participantes.  Justo en ese momento, ten√≠amos un proyecto muy interesante relacionado con la automatizaci√≥n de la b√∫squeda de delitos financieros y lavado de dinero entre las transacciones de nuestros clientes, y sin dudarlo, decidimos ofrecer la misma tarea a los participantes del hackathon. <br><p>  Por razones obvias, no pudimos usar datos reales, por lo que tuvimos que crearlos.  Para hacer la tarea lo m√°s cercana posible a la realidad, observamos las estad√≠sticas de los datos reales e intentamos, como pudimos, acercar los datos generados a las distribuciones reales, y tampoco escatimamos en la cantidad y complejidad de los datos; no necesit√°bamos una soluci√≥n trabajando en un gr√°fico de 100 nodos y 200 conexiones, est√°bamos buscando una soluci√≥n capaz de procesar gr√°ficos del tama√±o de millones de nodos y miles de millones de conexiones, y teniendo en cuenta toda la informaci√≥n disponible sobre nodos y conexiones. </p><br><h2 id="chto-u-nas-poluchilos">  Que conseguimos </h2><br><p>  ¬°Y obtuvimos un generador bastante r√°pido (ajustado por la cantidad de datos), interesante y configurable!  Comprendamos en detalle </p><br><h3 id="tipy-dannyh">  Tipos de datos </h3><br><p>  Queremos tener un gr√°fico de transacciones financieras, respectivamente, los posibles participantes en este gr√°fico son: </p><br><ul><li>  Cliente: puede decir una cuenta de un cliente abstracto de un banco.  Se describe por nombre, correo electr√≥nico, edad, trabajo, opiniones pol√≠ticas, nacionalidad, educaci√≥n y direcci√≥n de residencia. </li><li>  Una empresa es una entidad comercial en el sistema financiero.  Est√° determinado por el tipo de empresa, nombre y pa√≠s. </li><li>  ATM: en t√©rminos generales, los puntos de salida de dinero del gr√°fico controlado por nosotros.  Definido por coordenadas geogr√°ficas. </li><li>  Transacci√≥n: el hecho de transferir dinero de un nodo del gr√°fico a otro.  Definido por el nodo inicial y final, cantidad, moneda y tiempo. </li></ul><br><p>  Para crear estos datos, utilizamos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mimesis</a> , una gran biblioteca para crear datos falsos. </p><br><h3 id="sozdanie-grafa-bazovye-suschnosti">  Crear un gr√°fico: entidades b√°sicas </h3><br><p>  Primero debe crear todas las entidades b√°sicas: clientes, empresas y cajeros autom√°ticos.  El script toma la cantidad de clientes que desea crear y, en funci√≥n de esto, calcula la cantidad de empresas y cajeros autom√°ticos.  Seg√∫n nuestros datos, el n√∫mero de compa√±√≠as que tienen una gran cantidad de transacciones con clientes es aproximadamente el 2.5% del n√∫mero de clientes, y el n√∫mero de cajeros autom√°ticos es el 0.05% del n√∫mero de clientes.  Estos valores son muy generalizados y no configurables (conectados en el c√≥digo del generador). </p><br><p>  Toda la informaci√≥n se guarda en archivos .csv.  La escritura en estos archivos ocurre en lotes, k l√≠neas a la vez.  Este valor se configura mediante argumentos de script.  Adem√°s, se generan tres tipos de nodos en paralelo. </p><br><h3 id="sozdanie-grafa-soedineniya-mezhdu-suschnostyami">  Crear un gr√°fico: conexiones entre entidades </h3><br><p>  Despu√©s de crear las entidades b√°sicas, comenzamos a conectarlas.  En esta etapa, todav√≠a no estamos generando las transacciones, sino simplemente el hecho de que hay una conexi√≥n entre los nodos.  Esto se hizo para acelerar el proceso de generar el gr√°fico completo y funciona aproximadamente de la siguiente manera: si dos nodos est√°n conectados, entonces generamos un cierto n√∫mero de transacciones entre ellos, dispersos en el tiempo.  Si no est√° conectado, pero las transacciones entre estos nodos no existen. </p><br><p>  La probabilidad de una conexi√≥n entre los dos nodos se configura a trav√©s de argumentos, los valores est√°ndar se enumeran a continuaci√≥n. </p><br><p>  Posibles tipos de conexi√≥n: </p><br><ul><li>  Cliente -&gt; Cliente (p = 0.4%) </li><li>  Cliente -&gt; Empresa (p = 1%) </li><li>  Cliente -&gt; ATM (p = 3%) </li><li>  Empresa -&gt; Cliente (p = 0.5%) </li></ul><br><p>  Al igual que los nodos, todos los tipos de conexiones se generan en paralelo y se escriben en sus archivos en lotes. </p><br><h3 id="sozdaniya-grafa-tranzakcii">  Creaci√≥n de gr√°ficos: transacciones </h3><br><p>  Teniendo los nodos del gr√°fico y las conexiones entre ellos que caen bajo la distribuci√≥n deseada, podemos comenzar a generar transacciones.  El proceso es bastante simple en s√≠ mismo, pero paralelizarlo es bastante dif√≠cil.  Por lo tanto, en esta etapa, solo hay dos flujos independientes: transacciones que se originan en el cliente y transacciones que se originan en la empresa. </p><br><p>  No sucede nada particularmente interesante en esta etapa: el script se ejecuta a trav√©s de la lista de conexiones y genera un n√∫mero aleatorio de transacciones para cada conexi√≥n.  Est√° escrito de la misma manera: en archivos .csv por paquetes. </p><br><h3 id="sozdaniya-grafa-patterny">  Contar creaciones: patrones </h3><br><p>  Y aqu√≠ hay puntos interesantes.  Los tipos de patrones de comportamiento que quer√≠amos obtener en la columna final: </p><br><ul><li>  Flujo: una gran cantidad va de un nodo a otro, cada uno de estos m nodos transfiere dinero al siguiente nivel de n nodos, y as√≠ sucesivamente, hasta que el √∫ltimo nivel env√≠a todo el dinero a un destinatario. </li><li>  Circular: la cantidad de dinero va en un c√≠rculo y vuelve a la fuente. </li><li>  Tiempo: una cierta cantidad de dinero va de un nodo a otro con cierta frecuencia fija. </li></ul><br><p>  Veamos cada uno de estos patrones con m√°s detalle: </p><br><h4 id="flow">  Flujo </h4><br><p> Para empezar, se selecciona el n√∫mero de niveles a trav√©s de los cuales tendr√° que ir el dinero.  En nuestra implementaci√≥n, este n√∫mero aleatorio entre 2 y 6 no es configurable y est√° conectado en el c√≥digo.  A continuaci√≥n, se seleccionan dos nodos del gr√°fico: el remitente y el destinatario.  Tambi√©n se selecciona una cantidad aleatoria, que el remitente enviar√° al destinatario (de acuerdo con la f√≥rmula inteligente <code>50000 * random() + 50000 * random()</code> ). </p><br><p>  Cada miembro de esta red cobra alg√∫n tipo de tarifa por sus servicios.  En nuestra implementaci√≥n, el precio m√°ximo por transferir dinero a trav√©s de la red ser√° del 10% del monto transferido por el remitente. </p><br><p>  Las transacciones generadas tienen un cambio en el tiempo de las transacciones relativas del nivel de red anterior, es decir, el dinero primero llega al nivel n-1, y solo luego pasa al nivel n.  Los retrasos se seleccionan al azar dentro de 4-5 d√≠as.  Adem√°s, las transacciones generadas tienen montos seudoaleatorios (limitados por el monto inicial y teniendo en cuenta las tarifas para cada nodo) </p><br><h4 id="circular">  Circular </h4><br><p>  Se genera de acuerdo con un principio similar a Flow, pero en lugar de diferentes emisores y receptores y varios niveles en este patr√≥n, el dinero va en un c√≠rculo y regresa al nodo original.  Todos los nodos intermedios cobran una tarifa, como es el caso de Flow, y las transacciones tambi√©n tienen una compensaci√≥n de tiempo. </p><br><h4 id="time">  Tiempo </h4><br><p>  El patr√≥n m√°s simple.  Se env√≠a una cantidad determinada del remitente al destinatario un n√∫mero aleatorio de veces (de 5 a 50, no configurable) con cambios de tiempo pseudoaleatorios. </p><br><p>  Todas las transacciones nuevas se escriben de la misma manera en archivos .csv en lotes. </p><br><h2 id="randomizaciya-grafa-i-sbor-vseh-tranzakciy-v-odin-fayl">  Graficar la aleatorizaci√≥n y recopilar todas las transacciones en un archivo </h2><br><p>  En esta etapa, tenemos varios archivos .csv: </p><br><ul><li>  3 archivos con nodos (clientes, empresas y cajeros autom√°ticos) </li><li>  4 archivos de transacciones: uno para transacciones regulares y 3 que contienen patrones. </li></ul><br><p>  Un script adicional mezcla transacciones de patrones junto con transacciones regulares para que no sea posible ver patrones en un gr√°fico en el orden en que se registran las transacciones en un archivo. </p><br><h2 id="i-chto-so-vsem-etim-delat">  ¬øY qu√© hacer con todo esto? </h2><br><p>  Al final, tenemos 4 hermosos archivos con nodos gr√°ficos y transacciones entre ellos.  Puede importar a Neo4J, puede distribuir a trav√©s de REST, pero lo que su coraz√≥n desee, puede hacerlo con ellos. </p><br><p>  En cuanto a nosotros, recibimos una respuesta muy positiva de los participantes del hackathon y algunas soluciones muy interesantes para encontrar patrones en gr√°ficos masivos. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447626/">https://habr.com/ru/post/447626/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447612/index.html">Centro de datos espaciales. Traducci√≥n de texto del lanzamiento del servidor a la estratosfera</a></li>
<li><a href="../447614/index.html">No podr√° resolver este problema en la entrevista.</a></li>
<li><a href="../447616/index.html">Conectando Aquastorozh a Smart Home en Z-Wave</a></li>
<li><a href="../447618/index.html">La base de datos del servicio de transmisi√≥n Kanopy filtr√≥ hasta 40 millones de entradas de registro sobre pel√≠culas vistas por los usuarios</a></li>
<li><a href="../447622/index.html">C√≥mo los cambios en Google Play afectar√°n la optimizaci√≥n de ASO</a></li>
<li><a href="../447628/index.html">Hackear WPA3: DragonBlood</a></li>
<li><a href="../447630/index.html">SpaceX: lanzamiento de Falcon Heavy y aterrizaje de tres aceleradores, dos de ellos al mismo tiempo [01: 35MSK, 12 de abril de 2019]</a></li>
<li><a href="../447632/index.html">Infraestructura de bicicletas en los Pa√≠ses Bajos: ¬øc√≥mo funciona?</a></li>
<li><a href="../447634/index.html">La estimulaci√≥n con electricidad conduce a una mejora significativa en la memoria de los ancianos.</a></li>
<li><a href="../447636/index.html">C√≥mo ser un dise√±ador de tu vida: consejos de Bill Burnett, gerente del programa de dise√±o de Stanford y veterano de Apple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>