<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé• üë®üèΩ‚Äçüî¨ üí® Millones de binarios despu√©s. C√≥mo se fortaleci√≥ Linux üë©üèø‚Äçüè´ üóª üïô</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="TL; DR . En este art√≠culo, exploramos esquemas de fortalecimiento que funcionan de manera inmediata en cinco distribuciones populares de Linux. Para c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Millones de binarios despu√©s. C√≥mo se fortaleci√≥ Linux</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444418/"><img src="https://habrastorage.org/getpro/habr/post_images/43f/b35/8ca/43fb358cac8e2bec978126698b7d2ece.png" align="left" width="340">  <b>TL; DR</b> .  En este art√≠culo, exploramos esquemas de fortalecimiento que funcionan de manera inmediata en cinco distribuciones populares de Linux.  Para cada uno, tomamos la configuraci√≥n predeterminada del n√∫cleo, descargamos todos los paquetes y analizamos los esquemas de protecci√≥n en los archivos binarios adjuntos.  Consideramos las distribuciones de OpenSUSE 12.4, Debian 9, CentOS, RHEL 6.10 y 7, as√≠ como Ubuntu 14.04, 12.04 y 18.04 LTS. <br><br>  Los resultados confirman que incluso los esquemas b√°sicos, como los canarios de pila y el c√≥digo independiente de la posici√≥n, a√∫n no son utilizados por todos.  La situaci√≥n es a√∫n peor para los compiladores cuando se trata de proteger contra vulnerabilidades como el choque de la pila, que se convirti√≥ en el centro de atenci√≥n en enero despu√©s de publicar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informaci√≥n de vulnerabilidad en systemd</a> .  Pero no todo es tan desesperado.  En una parte importante de los archivos binarios, se implementan m√©todos de protecci√≥n b√°sicos y su n√∫mero crece de una versi√≥n a otra. <br><br>  La verificaci√≥n mostr√≥ que el mayor n√∫mero de m√©todos de protecci√≥n se implementa en Ubuntu 18.04 a nivel de sistema operativo y aplicaci√≥n, seguido de Debian 9. Por otro lado, en OpenSUSE 12.4, CentOS 7 y RHEL 7, tambi√©n se implementan esquemas de protecci√≥n b√°sicos, y la protecci√≥n contra colisiones de pila se aplica a√∫n m√°s ampliamente. con un conjunto mucho m√°s denso de paquetes por defecto. <br><a name="habracut"></a><br><h1>  Introduccion </h1><br>  Es dif√≠cil proporcionar software de alta calidad.  A pesar de la gran cantidad de herramientas avanzadas para el an√°lisis de c√≥digo est√°tico y el an√°lisis din√°mico en tiempo de ejecuci√≥n, as√≠ como el progreso significativo en el desarrollo de compiladores y lenguajes de programaci√≥n, el software moderno todav√≠a sufre vulnerabilidades que los cibercriminales explotan constantemente.  La situaci√≥n es a√∫n peor en los ecosistemas que incluyen c√≥digo heredado.  En tales casos, no solo nos enfrentamos al eterno problema de encontrar posibles errores explotados, sino que tambi√©n estamos limitados por marcos r√≠gidos de compatibilidad con versiones anteriores, que a menudo requieren mantener un c√≥digo limitado o a√∫n peor, vulnerable o con errores. <br><br>  Aqu√≠ es donde entran en juego los m√©todos de endurecimiento.  No podemos evitar algunos tipos de errores, pero podemos hacer que la vida de un atacante sea m√°s dif√≠cil y resolver parcialmente el problema evitando o previniendo la <i>operaci√≥n de</i> estos errores.  Dicha protecci√≥n se usa en todos los sistemas operativos modernos, sin embargo, los m√©todos var√≠an mucho en complejidad, eficiencia y rendimiento: desde los canarios de pila y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ASLR</a> hasta las protecciones completas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CFI</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ROP</a> .  En este art√≠culo, consideraremos qu√© m√©todos de protecci√≥n se usan en las distribuciones de Linux m√°s populares en la configuraci√≥n predeterminada, y tambi√©n estudiaremos las propiedades de los archivos binarios que se distribuyen a trav√©s de los sistemas de administraci√≥n de paquetes de cada distribuci√≥n. <br><br><h3>  CVE y seguridad </h3><br>  Todos hemos visto art√≠culos con t√≠tulos como "Aplicaciones m√°s vulnerables del a√±o" o "Sistemas operativos m√°s vulnerables".  Por lo general, proporcionan estad√≠sticas sobre el n√∫mero total de registros de vulnerabilidad, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CVE (Common Vulnerability and Exposures)</a> obtenidos de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">National Vulnerability Database (NVD)</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NIST</a> y otras fuentes.  Posteriormente, estas aplicaciones o sistemas operativos se clasifican seg√∫n el n√∫mero de CVE.  Desafortunadamente, aunque los CVE son muy √∫tiles para rastrear problemas e informar a proveedores y usuarios, dicen poco sobre la seguridad real del software. <br><br>  Como ejemplo, considere el n√∫mero total de CVE en los √∫ltimos cuatro a√±os para el kernel de Linux y las cinco distribuciones de servidor m√°s populares, a saber, Ubuntu, Debian, Red Hat Enterprise Linux y OpenSUSE. <br><br><img src="https://habrastorage.org/webt/3_/pt/md/3_ptmdzx313ayxw3xpi0udnlbdq.png"><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">1</font></i> <br><br>  ¬øQu√© nos dice este cuadro?  ¬øM√°s CVE significa que una distribuci√≥n es m√°s vulnerable que otra?  No hay respuesta  Por ejemplo, en este art√≠culo ver√° que Debian implementa mecanismos de seguridad m√°s estrictos en comparaci√≥n con, por ejemplo, OpenSUSE o RedHat Linux, y a√∫n as√≠ Debian tiene m√°s CVE.  Sin embargo, no necesariamente significan seguridad debilitada: incluso tener un CVE no dice si la vulnerabilidad es <i>explotable</i> .  Los puntajes de gravedad dan una idea de cu√°n <i>probable es la</i> explotaci√≥n de la vulnerabilidad, pero al final, la explotabilidad depende en gran medida de la protecci√≥n presente en los sistemas afectados, as√≠ como de los recursos y capacidades de los atacantes.  Adem√°s, la falta de informes de CVE no dice nada sobre otras vulnerabilidades <i>no registradas o desconocidas</i> .  La diferencia en CVE puede explicarse no por la calidad del software, sino por otros factores, incluidos los recursos asignados para las pruebas o el tama√±o de la base de usuarios.  En nuestro ejemplo, m√°s CVE de Debian pueden simplemente indicar que Debian est√° entregando m√°s paquetes de software. <br><br>  Por supuesto, el sistema CVE proporciona informaci√≥n √∫til que le permite crear protecciones apropiadas.  Cuanto mejor comprendamos las razones del fracaso del programa, m√°s f√°cil ser√° identificar los posibles m√©todos de operaci√≥n y desarrollar mecanismos de <i>detecci√≥n y respuesta</i> adecuados.  En la fig.  La Figura 2 muestra las categor√≠as de vulnerabilidad para todas las distribuciones en los √∫ltimos cuatro a√±os ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fuente</a> ).  Es obvio de inmediato que la mayor√≠a de los CVE se dividen en las siguientes categor√≠as: denegaci√≥n de servicio (DoS), ejecuci√≥n de c√≥digo, desbordamiento, corrupci√≥n de memoria, p√©rdida de informaci√≥n (exfiltraci√≥n) y escalada de privilegios.  Aunque muchas CVE est√°n cubiertas varias veces en diferentes categor√≠as, en general, los mismos problemas persisten de a√±o en a√±o.  En la siguiente parte del art√≠culo, evaluaremos el uso de varios esquemas de protecci√≥n para evitar la explotaci√≥n de estas vulnerabilidades. <br><br><img src="https://habrastorage.org/webt/tr/92/pc/tr92pcngbl1y4qxt3shouu6wdi8.png"><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">2</font></i> <br><br><h3>  Las tareas </h3><br>  En este art√≠culo, tenemos la intenci√≥n de responder las siguientes preguntas: <br><br><ul><li>  ¬øCu√°l es la seguridad de varias distribuciones de Linux?  ¬øQu√© mecanismos de defensa existen en las aplicaciones de kernel y espacio de usuario? <br></li><li>  ¬øC√≥mo ha cambiado la adopci√≥n de mecanismos de protecci√≥n para diversas distribuciones con el tiempo? <br></li><li>  ¬øCu√°les son las dependencias promedio de paquetes y bibliotecas para cada distribuci√≥n? <br></li><li>  ¬øQu√© protecciones se implementan para cada binario? </li></ul><br><h3>  Elegir distribuciones </h3><br>  Resulta que es dif√≠cil encontrar estad√≠sticas precisas sobre las instalaciones de distribuci√≥n, ya que en la mayor√≠a de los casos el n√∫mero de descargas no indica el n√∫mero de instalaciones reales.  Sin embargo, las variantes de Unix constituyen la mayor√≠a de los sistemas de servidor (69,2% en servidores web, seg√∫n las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estad√≠sticas de</a> W3techs y otras fuentes), y su participaci√≥n est√° en constante crecimiento.  Por lo tanto, para nuestro estudio, nos centramos en las distribuciones disponibles de f√°brica en la plataforma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Google Cloud</a> .  En particular, elegimos el siguiente sistema operativo: <br><br><table><tbody><tr><th>  Distribuci√≥n / versi√≥n </th><th>  El n√∫cleo </th><th>  Construir </th></tr><tr><td>  OpenSUSE 12.4 </td><td>  4.12.14-95.3-predeterminado </td><td>  # 1 SMP mi√© 5 dic 06:00:48 UTC 2018 (63a8d29) </td></tr><tr><td>  Debian 9 (estiramiento) </td><td>  4.9.0-8-amd64 </td><td>  # 1 SMP Debian 4.9.130-2 (2018-10-27) </td></tr><tr><td>  CentOS 6.10 </td><td>  2.6.32-754.10.1.el6.x86_64 </td><td>  # 1 SMP martes 15 de enero 17:07:28 UTC 2019 </td></tr><tr><td>  CentOS 7 </td><td>  3.10.0-957.5.1.el7.x86_64 </td><td>  # 1 SMP vie 1 feb 14:54:57 UTC 2019 </td></tr><tr><td>  Red Hat Enterprise Linux Server 6.10 (Santiago) </td><td>  2.6.32-754.9.1.el6.x86_64 </td><td>  # 1 SMP Mi√© 21 de noviembre 15:08:21 EST 2018 </td></tr><tr><td>  Red Hat Enterprise Linux Server 7.6 (Maipo) </td><td>  3.10.0-957.1.3.el7.x86_64 </td><td>  # 1 SMP jue 15 de noviembre 17:36:42 UTC 2018 </td></tr><tr><td>  Ubuntu 14.04 (Trusty Tahr) </td><td>  4.4.0‚Äì140-gen√©rico </td><td><br>  # 166 ~ 14/04/1-Ubuntu SMP s√°b 17 nov 01:52:43 UTC 20 ... </td></tr><tr><td>  Ubuntu 16.04 (Xenial Xerus) </td><td>  4.15.0-1026-gcp </td><td>  # 27 ~ 16.04.1-Ubuntu SMP vie 7 dic 09:59:47 UTC 2018 </td></tr><tr><td>  Ubuntu 18.04 (Bionic Beaver) </td><td>  4.15.0-1026-gcp </td><td>  # 27-Ubuntu SMP jue 6 dic 18:27:01 UTC 2018 </td></tr></tbody></table>  <i><font color="gray">Tabla 1</font></i> <br><br><h1>  An√°lisis </h1><br>  Examinaremos la configuraci√≥n predeterminada del kernel, as√≠ como las propiedades de los paquetes disponibles a trav√©s del administrador de paquetes de cada paquete de distribuci√≥n listo para usar.  Por lo tanto, consideramos solo los paquetes de los espejos predeterminados de cada distribuci√≥n, ignorando los paquetes de repositorios inestables (por ejemplo, probando espejos en Debian) y paquetes de terceros (por ejemplo, paquetes de Nvidia de espejos est√°ndar).  Adem√°s, no consideramos compilaciones de kernel personalizadas o configuraciones de seguridad avanzadas. <br><br><h3>  An√°lisis de configuraci√≥n del kernel </h3><br>  Utilizamos un script de an√°lisis basado en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">verificador gratuito kconfig</a> .  Consideramos las opciones de protecci√≥n listas para usar para las distribuciones nombradas y las comparamos con la lista del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Kernel Self-Defense Project</a> (KSPP).  Para cada par√°metro de configuraci√≥n, la Tabla 2 describe la configuraci√≥n deseada: una marca de verificaci√≥n es para distribuciones que cumplen con las recomendaciones de KSSP (para una explicaci√≥n de los t√©rminos ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> ; en futuros art√≠culos describiremos cu√°ntos de estos m√©todos de protecci√≥n aparecieron y c√≥mo piratear el sistema en su ausencia). <br><br> <a href=""><img src="https://habrastorage.org/webt/dx/oh/o0/dxoho0z-lifjcybajszqb-aiirq.png"></a> <br><br><img src="https://habrastorage.org/webt/rm/or/h1/rmorh1jx8aswaj98ts0-7jptjmk.png"><br><br>  En general, los n√∫cleos m√°s nuevos tienen configuraciones m√°s estrictas fuera de la caja.  Por ejemplo, CentOS 6.10 y RHEL 6.10 en el n√∫cleo 2.6.32 no tienen la mayor√≠a de las funciones cr√≠ticas implementadas en los nuevos n√∫cleos, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SMAP</a> , permisos RWX fuertes, aleatorizaci√≥n de direcciones o protecci√≥n contra copy2usr.  Cabe se√±alar que muchas de las opciones de configuraci√≥n de la tabla no est√°n disponibles en versiones anteriores del n√∫cleo y no son aplicables en la realidad; esto todav√≠a se indica en la tabla como la falta de protecci√≥n adecuada.  Del mismo modo, si el par√°metro de configuraci√≥n no est√° disponible en esta versi√≥n, y por seguridad, este par√°metro debe estar deshabilitado, esto se considera una configuraci√≥n razonable. <br><br>  Otro punto a la hora de interpretar los resultados: algunas configuraciones de kernel que aumentan la superficie de ataque se pueden usar simult√°neamente por seguridad.  Tales ejemplos incluyen uprobes y kprobes, m√≥dulos de kernel y BPF / eBPF.  Nuestra recomendaci√≥n es utilizar los mecanismos anteriores para proporcionar una protecci√≥n real, ya que no son triviales de usar, y su funcionamiento supone que los actores maliciosos ya est√°n arraigados en el sistema.  Pero si estas opciones est√°n habilitadas, el administrador del sistema debe monitorear activamente el abuso. <br><br>  Al estudiar m√°s a fondo las entradas en la Tabla 2, vemos que los n√∫cleos modernos ofrecen varias opciones para proteger contra la explotaci√≥n de vulnerabilidades como la fuga de informaci√≥n y el desbordamiento de pila / mont√≥n.  Sin embargo, notamos que incluso las distribuciones populares m√°s recientes a√∫n no han implementado una protecci√≥n m√°s sofisticada (por ejemplo, con parches de seguridad) o protecci√≥n moderna contra ataques de reutilizaci√≥n de c√≥digo (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">combinando aleatorizaci√≥n con esquemas como R ^ X para c√≥digo</a> ).  Peor a√∫n, incluso estas defensas m√°s avanzadas no protegen contra una gama completa de ataques.  Por lo tanto, es crucial que los administradores de sistemas complementen las configuraciones inteligentes con soluciones que ofrezcan detecci√≥n y prevenci√≥n de exploits en tiempo de ejecuci√≥n. <br><br><h3>  An√°lisis de la aplicaci√≥n </h3><br>  No es sorprendente que diferentes distribuciones tengan diferentes caracter√≠sticas de paquetes, opciones de compilaci√≥n, dependencias de biblioteca, etc. Existen diferencias incluso para distribuciones <a href="">relacionadas</a> y paquetes con un peque√±o n√∫mero de dependencias (por ejemplo, coreutils en Ubuntu o Debian).  Para evaluar las diferencias, descargamos todos los paquetes disponibles, extrajimos sus contenidos y analizamos los archivos binarios y las dependencias.  Para cada paquete, rastreamos los otros paquetes de los que depende, y para cada binario rastreamos sus dependencias.  Esta secci√≥n resume los hallazgos. <br><br><h4>  Distribuciones </h4><br>  En total, descargamos 361,556 paquetes para todas las distribuciones, extrayendo solo paquetes de los espejos predeterminados.  Ignoramos los paquetes sin archivos ejecutables ELF, como c√≥digos fuente, fuentes, etc. Despu√©s del filtrado, quedaron 129 569 paquetes que conten√≠an un total de 584 457 archivos binarios.  La distribuci√≥n de paquetes y archivos entre distribuciones se muestra en la fig.  3) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f9d/8fc/bbf/f9d8fcbbf2ac0887f4948e1e49446e9a.png"><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">3</font></i> <br><br>  Puede notar que cuanto m√°s moderna es la distribuci√≥n, m√°s paquetes y archivos binarios contiene, lo cual es l√≥gico.  Al mismo tiempo, los paquetes Ubuntu y Debian incluyen muchos m√°s archivos binarios (m√≥dulos y bibliotecas tanto ejecutables como din√°micas) que CentOS, SUSE y RHEL, lo que potencialmente afecta la superficie de ataque de Ubuntu y Debian (debe tenerse en cuenta que los n√∫meros reflejan todos los archivos binarios de todas las versiones paquete, es decir, algunos archivos se analizan varias veces).  Esto es especialmente importante cuando se consideran las dependencias entre paquetes.  Por lo tanto, una vulnerabilidad en el binario de un solo paquete puede afectar muchas partes del ecosistema, as√≠ como una biblioteca vulnerable puede afectar a todos los archivos binarios que lo importan.  Como punto de referencia, veamos la distribuci√≥n del n√∫mero de dependencias entre paquetes en varios sistemas operativos: <br><br> <a href=""><img src="https://habrastorage.org/webt/ii/e3/e5/iie3e5-ei26ezg5yvcyvtzqzl80.png"></a> <br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">4 4</font></i> <br><br>  En casi todas las distribuciones, el 60% de los paquetes tienen al menos 10 dependencias.  Adem√°s, algunos paquetes tienen m√°s dependencias (m√°s de 100).  Lo mismo se aplica a las dependencias de paquetes inversos: como se esperaba, muchos paquetes son utilizados por muchos otros paquetes en la distribuci√≥n, por lo que las vulnerabilidades en estos pocos favoritos tienen un alto riesgo.  Como ejemplo, la siguiente tabla enumera 20 paquetes con el n√∫mero m√°ximo de dependencias inversas en SLES, Centos 7, Debian 9 y Ubuntu 18.04 (cada cuadro indica el paquete y el n√∫mero de dependencias inversas). <br><br><img src="https://habrastorage.org/webt/0g/hl/w0/0ghlw0dtmbb3vswp-xgtx1zs-lu.png"><br>  <i><font color="gray">Tabla 3</font></i> <br><br>  Un hecho interesante  Aunque todos los sistemas operativos analizados est√°n construidos para la arquitectura x86_64, mientras que la mayor√≠a de los paquetes tienen la arquitectura definida como x86_64 y x86, los paquetes a menudo contienen binarios para otras arquitecturas, como se muestra en la Fig.  5) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c4e/899/601/c4e899601e6fc711b224aba6b204c02a.png"><br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">5 5</font></i> <br><br>  En la siguiente secci√≥n, profundizaremos en las caracter√≠sticas de los binarios analizados. <br><br><h4>  Estad√≠sticas de protecci√≥n binaria </h4><br>  Como m√≠nimo absoluto, debe estudiar el conjunto b√°sico de opciones de protecci√≥n para los archivos binarios existentes.  Varias distribuciones de Linux vienen con scripts que realizan tales comprobaciones.  Por ejemplo, en Debian / Ubuntu existe tal script.  Aqu√≠ hay un ejemplo de su trabajo: <br><br><pre><code class="bash hljs">$ hardening-check $(<span class="hljs-built_in"><span class="hljs-built_in">which</span></span> docker) /usr/bin/docker: Position Independent Executable: yes Stack protected: yes Fortify Source <span class="hljs-built_in"><span class="hljs-built_in">functions</span></span>: no, only unprotected <span class="hljs-built_in"><span class="hljs-built_in">functions</span></span> found! Read-only relocations: yes Immediate binding: yes</code> </pre> <br>  El script verifica cinco <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">funciones de protecci√≥n</a> : <br><br><ul><li>  Position Independent Executable (PIE): indica si la secci√≥n de texto del programa se puede mover en la memoria para lograr la aleatorizaci√≥n si ASLR est√° habilitado en el n√∫cleo. <br></li><li>  Pila protegida: si los canarios de pila est√°n incluidos para proteger contra los ataques de colisi√≥n de pila. <br></li><li>  Fortificar fuente: si las funciones inseguras (por ejemplo, strcpy) se reemplazan por sus contrapartes m√°s seguras, y las llamadas verificadas en tiempo de ejecuci√≥n se reemplazan por sus contrapartes no verificadas (por ejemplo, memcpy en lugar de __memcpy_chk). <br></li><li>  Reubicaciones de solo lectura (RELRO): si las entradas en la tabla de movimiento est√°n marcadas como de solo lectura si funcionaron antes de que comenzara la ejecuci√≥n. <br></li><li>  Enlace inmediato: si el enlazador de tiempo de ejecuci√≥n permite todos los movimientos antes de iniciar el programa (esto es equivalente a RELRO completo). </li></ul><br>  ¬øSon suficientes los mecanismos anteriores?  Lamentablemente no.  Hay formas conocidas de eludir todas las defensas anteriores, pero cuanto m√°s estricta sea la defensa, m√°s alta ser√° la barra para el atacante.  Por ejemplo, las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">soluciones alternativas de RELRO son</a> m√°s dif√≠ciles de aplicar si PIE y la vinculaci√≥n inmediata est√°n vigentes.  Del mismo modo, un ASLR completo requiere trabajo adicional para crear un exploit de trabajo.  Sin embargo, los atacantes sofisticados est√°n listos para enfrentar tales defensas: su ausencia esencialmente acelerar√° la pirater√≠a.  Por lo tanto, es imperativo que estas medidas se consideren el <i>m√≠nimo</i> necesario. <br><br>  Quer√≠amos estudiar cu√°ntos archivos binarios en las distribuciones en cuesti√≥n est√°n protegidos por estos, as√≠ como tres m√©todos m√°s: <br><br><ul><li>  Un bit no ejecutable ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">NX</a> ) impide la ejecuci√≥n en cualquier regi√≥n que no deber√≠a ser ejecutable, como un mont√≥n de pila, etc. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RPATH / RUNPATH</a> indica la ruta de ejecuci√≥n utilizada por el cargador din√°mico para encontrar las bibliotecas apropiadas.  El primero es <i>obligatorio</i> para cualquier sistema moderno: su ausencia permite a los atacantes escribir arbitrariamente la carga √∫til en la memoria y ejecutarla tal como est√°.  Para el segundo, las configuraciones incorrectas de la ruta de ejecuci√≥n ayudan a introducir c√≥digo no confiable, lo que puede provocar una serie de problemas (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">escalada de privilegios</a> , as√≠ como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">otros problemas</a> ). </li><li>  La protecci√≥n de colisi√≥n de la pila proporciona protecci√≥n contra ataques que hacen que la pila se superponga con otras √°reas de la memoria (como un mont√≥n).  Dadas las recientes vulnerabilidades que abusan de las <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">vulnerabilidades de colisi√≥n del mont√≥n en systemd</a> , nos pareci√≥ apropiado incluir este mecanismo en nuestro conjunto de datos. </li></ul><br>  Entonces, sin m√°s pre√°mbulos, pasemos a los n√∫meros.  Las tablas 4 y 5 contienen una muestra de an√°lisis de archivos ejecutables y bibliotecas de varias distribuciones, respectivamente. <br><br><ul><li>  Como puede ver, la protecci√≥n NX se implementa en todas partes, con raras excepciones.  En particular, su menor uso en las distribuciones de Ubuntu y Debian se puede observar en comparaci√≥n con CentOS, RHEL y OpenSUSE. <br></li><li>  Los canarios de pila no est√°n disponibles en muchos lugares, especialmente en distribuciones con n√∫cleos antiguos.  Se ha visto alg√∫n progreso en las distribuciones recientes de Centos, RHEL, Debian y Ubuntu. <br></li><li>  Con la excepci√≥n de Debian y Ubuntu 18.04, la mayor√≠a de las distribuciones tienen poca compatibilidad con PIE. <br></li><li>  La protecci√≥n contra colisiones de la pila est√° mal implementada en OpenSUSE, Centos 7 y RHEL 7 y est√° pr√°cticamente ausente del resto. <br></li><li>  Todas las distribuciones con n√∫cleos modernos tienen alg√∫n soporte RELRO, con Ubuntu 18.04 a la cabeza, con Debian ocupando el segundo lugar. </li></ul><br>  Como ya se mencion√≥, las m√©tricas en esta tabla son promedio en todas las versiones del archivo binario.  Si solo mira las √∫ltimas versiones de los archivos, los n√∫meros ser√°n diferentes (por ejemplo, vea el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">progreso de Debian con la implementaci√≥n de PIE</a> ).  Adem√°s, la mayor√≠a de las distribuciones generalmente al calcular estad√≠sticas verifican la protecci√≥n de solo unas pocas funciones en c√≥digo binario, y en nuestro an√°lisis se indica el porcentaje real de funciones fortificadas.  Por lo tanto, si 5 de 50 funciones est√°n protegidas en el binario, le daremos una calificaci√≥n de 0.1, que corresponde al 10% de las funciones fortalecidas. <br><br><img src="https://habrastorage.org/webt/m-/fn/1l/m-fn1l_i9vp3-gh8sicmbnkintc.png"><br>  <i><font color="gray">Tabla 4. Caracter√≠sticas de protecci√≥n para archivos ejecutables que se muestran en la fig.</font></i>  <i><font color="gray">3 (implementaci√≥n de las funciones correspondientes como un porcentaje del n√∫mero total de archivos ejecutables)</font></i> <br><br><img src="https://habrastorage.org/webt/yt/y1/sa/yty1saotef9aqmxkik36r8iijus.png"><br>  <i><font color="gray">Tabla 5. Caracter√≠sticas de protecci√≥n para las bibliotecas que se muestran en la Fig.</font></i>  <i><font color="gray">3 (implementaci√≥n de las funciones correspondientes como un porcentaje del n√∫mero total de bibliotecas)</font></i> <br><br>  Entonces, ¬øhay progreso?  Definitivamente existe: puede verse en las estad√≠sticas de distribuciones individuales (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Debian</a> ), as√≠ como en las tablas anteriores.  Como ejemplo en la fig.  La Figura 6 muestra la implementaci√≥n de mecanismos de defensa en tres distribuciones consecutivas de Ubuntu LTS 5 (hemos omitido las estad√≠sticas de protecci√≥n de colisi√≥n de la pila).  Notamos que de una versi√≥n a otra, m√°s y m√°s archivos admiten canarios apilados, y tambi√©n secuencialmente, cada vez m√°s archivos binarios vienen con protecci√≥n RELRO completa. <br><br> <a href=""><img src="https://habrastorage.org/webt/d1/ni/or/d1niordj1hmiklmg2-w5rsk6dla.png"></a> <br>  <i><font color="gray">Fig.</font></i>  <i><font color="gray">6 6</font></i> <br><br>  Desafortunadamente, varios archivos ejecutables en diferentes distribuciones todav√≠a no tienen ninguna de las protecciones anteriores.  Por ejemplo, mirando Ubuntu 18.04, puede ver el binario ngetty (reemplazo de getty), as√≠ como los shells mksh y lksh, el int√©rprete picolisp, los paquetes nvidia-cuda-toolkit (un paquete popular para aplicaciones aceleradas por GPU como marcos de aprendizaje autom√°tico) y klibc -utils.  Del mismo modo, el binario mandos-client (una herramienta administrativa que le permite reiniciar autom√°ticamente m√°quinas con sistemas de archivos encriptados), as√≠ como rsh-redone-client (re-implementando rsh y rlogin) se entregan sin protecci√≥n NX, aunque tienen derechos SUID :(. Adem√°s, Varios binarios suid no tienen protecci√≥n b√°sica, como los canarios de pila (por ejemplo, el binario Xorg.wrap del paquete Xorg). <br><br><h1>  Resumen y observaciones finales </h1><br>  En este art√≠culo, destacamos varias caracter√≠sticas de seguridad de las distribuciones modernas de Linux.  El an√°lisis mostr√≥ que la √∫ltima distribuci√≥n Ubuntu LTS (18.04) implement√≥ en promedio la protecci√≥n m√°s fuerte del sistema operativo y del nivel de aplicaci√≥n entre las distribuciones con n√∫cleos relativamente nuevos, como Ubuntu 14.04, 12.04 y Debian 9. Sin embargo, las distribuciones CentOS, RHEL y OpenSUSE discutidas en nuestro kit de forma predeterminada, se emite un conjunto m√°s denso de paquetes, y en versiones recientes (CentOS y RHEL) tienen un mayor porcentaje de protecci√≥n contra colisiones de la pila en comparaci√≥n con los competidores basados ‚Äã‚Äãen Debian (Debian y Ubuntu).  Al comparar las versiones CentOS y RedHat, notamos grandes mejoras en la implementaci√≥n de los canarios de pila y RELRO de las versiones 6 a 7, pero en promedio CentOS tiene m√°s caracter√≠sticas que RHEL.  En general, todas las distribuciones deben prestar especial atenci√≥n a la protecci√≥n PIE, que, con la excepci√≥n de Debian 9 y Ubuntu 18.04, se implementa en menos del 10% de los archivos binarios de nuestro conjunto de datos. <br><br>  Finalmente, debe tenerse en cuenta: aunque hicimos la investigaci√≥n manualmente, hay muchas herramientas de seguridad (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lynis</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tiger</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Hubble</a> ) que realizan an√°lisis y ayudan a evitar configuraciones inseguras.  Desafortunadamente, incluso una protecci√≥n fuerte en configuraciones razonables no garantiza la ausencia de exploits.  Es por eso que estamos firmemente convencidos de que es vital garantizar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un monitoreo confiable y la prevenci√≥n de ataques en tiempo real</a> , enfoc√°ndonos en modelos operativos y previni√©ndolos. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/444418/">https://habr.com/ru/post/444418/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444406/index.html">Italia digital. Que y como funciona</a></li>
<li><a href="../444408/index.html">Apple lanz√≥ ayer nuevos iPads y tiene preguntas.</a></li>
<li><a href="../444410/index.html">Mapas de red. Una breve descripci√≥n del software para construir mapas de red</a></li>
<li><a href="../444414/index.html">Snapdragon 8cx: plataforma de PC de 7 nm</a></li>
<li><a href="../444416/index.html">HyperX Alloy CORE - cuando la membrana puede jugar juegos</a></li>
<li><a href="../444420/index.html">C√≥mo montar dos ruedas para trabajar</a></li>
<li><a href="../444422/index.html">Como lo fue en 2018: impresi√≥n FDM industrial en Top 3D Expo</a></li>
<li><a href="../444424/index.html">AMD Radeon VII: Chip de gama alta (Parte 2)</a></li>
<li><a href="../444426/index.html">Lyft y Uber salen a bolsa p√∫blica. ¬øPor qu√© invertir en Lyft?</a></li>
<li><a href="../444428/index.html">Mountain Car: resolviendo el desaf√≠o cl√°sico con entrenamiento de refuerzo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>