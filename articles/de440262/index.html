<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äç‚úàÔ∏è ü¶Ü üëÄ Magento 2: Produkte direkt in die Datenbank importieren üë®‚Äçüíº üë≤ üíë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In einem fr√ºheren Artikel habe ich den Prozess des Importierens von Produkten in Magento 2 auf die √ºbliche Weise beschrieben - √ºber Modelle und Reposi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Magento 2: Produkte direkt in die Datenbank importieren</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440262/"><p>  In einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fr√ºheren Artikel habe</a> ich den Prozess des Importierens von Produkten in Magento 2 auf die √ºbliche Weise beschrieben - √ºber Modelle und Repositorys.  Das √ºbliche Verfahren zeichnet sich durch eine sehr geringe Datenverarbeitungsgeschwindigkeit aus.  Auf meinem Laptop kam ungef√§hr ein Produkt pro Sekunde heraus.  In dieser Fortsetzung betrachte ich eine alternative M√∂glichkeit zum Importieren eines Produkts - durch direkte Aufzeichnung in der Datenbank unter Umgehung der Standardmechanismen von Magento 2 (Modelle, Fabriken, Repositorys).  Die Reihenfolge der Schritte zum Importieren von Produkten kann an jede Programmiersprache angepasst werden, die mit MySQL arbeiten kann. </p><br><p> <em>Haftungsausschluss</em> : Magento verf√ºgt √ºber eine vorgefertigte Funktion zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Importieren von Daten</a> , von der Sie h√∂chstwahrscheinlich genug haben.  Wenn Sie jedoch eine umfassendere Kontrolle √ºber den Importvorgang ben√∂tigen, m√ºssen Sie nicht nur eine CSV-Datei f√ºr das vorbereiten, was sie ist - willkommen bei cat. </p><br><p><img src="https://habrastorage.org/webt/1n/nh/qm/1nnhqmebkwnkqvecqrlr_wf5b5y.jpeg" alt="Bild"></p><a name="habracut"></a><br><p>  Der Code, der sich aus dem Schreiben beider Artikel ergibt, kann im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">flancer32 / mage2_ext_demo_import</a> Magento-Modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">angezeigt</a> werden.  Hier sind einige der Einschr√§nkungen, die ich befolgt habe, um den Code des Demomoduls zu vereinfachen: </p><br><ul><li>  Produkte werden nur erstellt, nicht aktualisiert. </li><li>  Ein Lagerhaus </li><li>  Es werden nur Kategorienamen ohne deren Struktur importiert </li><li>  Datenstrukturen entsprechen Version 2.3 </li></ul><br><p>  JSON zum Importieren eines einzelnen Produkts: </p><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"sku"</span></span>: <span class="hljs-string"><span class="hljs-string">"MVA20D-UBV-3"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"   47-29 IEK"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"desc"</span></span>: <span class="hljs-string"><span class="hljs-string">"    ..."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"desc_short"</span></span>: <span class="hljs-string"><span class="hljs-string">"   47-29 IEK   ..."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"price"</span></span>: <span class="hljs-number"><span class="hljs-number">5.00</span></span>, <span class="hljs-attr"><span class="hljs-attr">"qty"</span></span>: <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-attr"><span class="hljs-attr">"categories"</span></span>: [<span class="hljs-string"><span class="hljs-string">" 1"</span></span>, <span class="hljs-string"><span class="hljs-string">" 2"</span></span>], <span class="hljs-attr"><span class="hljs-attr">"image_path"</span></span>: <span class="hljs-string"><span class="hljs-string">"mva20d_ubv_3.png"</span></span> }</code> </pre> <br><h1 id="obzor-osnovnyh-etapov-importa">  √úbersicht √ºber die wichtigsten Importschritte </h1><br><ul><li>  Produktregistrierung </li><li>  Produkt und Website verlinken </li><li>  grundlegende Produktattribute (EAV) </li><li>  Bestandsdaten (Menge des auf Lager befindlichen Produkts) </li><li>  Medien (Bilder) </li><li>  Link zu Katalogkategorien </li></ul><br><h1 id="registraciya-produkta">  Produktregistrierung </h1><br><p>  Grundlegende Produktinformationen finden Sie in <code>catalog_product_entity</code> : </p><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-string"><span class="hljs-string">`catalog_product_entity`</span></span> ( <span class="hljs-string"><span class="hljs-string">`entity_id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> AUTO_INCREMENT <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Entity Id'</span></span>, <span class="hljs-string"><span class="hljs-string">`attribute_set_id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">smallint</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Attribute Set ID'</span></span>, <span class="hljs-string"><span class="hljs-string">`type_id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">32</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'simple'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Type ID'</span></span>, <span class="hljs-string"><span class="hljs-string">`sku`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">64</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'SKU'</span></span>, <span class="hljs-string"><span class="hljs-string">`has_options`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">smallint</span></span>(<span class="hljs-number"><span class="hljs-number">6</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Has Options'</span></span>, <span class="hljs-string"><span class="hljs-string">`required_options`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">smallint</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'0'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Required Options'</span></span>, <span class="hljs-string"><span class="hljs-string">`created_at`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT_TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Creation Time'</span></span>, <span class="hljs-string"><span class="hljs-string">`updated_at`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">timestamp</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT_TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT_TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COMMENT</span></span> <span class="hljs-string"><span class="hljs-string">'Update Time'</span></span>, PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-string"><span class="hljs-string">`entity_id`</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> <span class="hljs-string"><span class="hljs-string">`CATALOG_PRODUCT_ENTITY_ATTRIBUTE_SET_ID`</span></span> (<span class="hljs-string"><span class="hljs-string">`attribute_set_id`</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> <span class="hljs-string"><span class="hljs-string">`CATALOG_PRODUCT_ENTITY_SKU`</span></span> (<span class="hljs-string"><span class="hljs-string">`sku`</span></span>) )</code> </pre> <br><p>  Mindestinformationen zum Erstellen eines Eintrags in der Produktregistrierung: </p><br><ul><li> <code>attribute_set_id</code> </li> <li> <code>sku</code> </li> </ul><br><p>  zus√§tzlich: </p><br><ul><li>  <code>type_id</code> - wenn nicht <code>type_id</code> , wird 'simple' verwendet </li></ul><br><p>  F√ºr die direkte Aufzeichnung in der Datenbank verwende ich den DB-Adapter von Magento selbst: </p><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($sku, $typeId, $attrSetId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'catalog_product_entity'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'sku'</span></span> =&gt; $sku, <span class="hljs-string"><span class="hljs-string">'type_id'</span></span> =&gt; $typeId, <span class="hljs-string"><span class="hljs-string">'attribute_set_id'</span></span> =&gt; $attrSetId ]; $conn-&gt;insert($table, $bind); $result = $conn-&gt;lastInsertId($table); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $result; }</code> </pre> <br><p>  Nachdem Sie ein Produkt in <code>catalog_product_entity</code> registriert <code>catalog_product_entity</code> es im Admin-Bereich im Produktraster ( <em>Katalog / Produkte</em> ) <code>catalog_product_entity</code> . </p><br><p><img src="https://habrastorage.org/webt/oj/u1/qm/oju1qm6qkqksiq9wugh9g45ut6q.png" alt="Bild"></p><br><h1 id="svyaz-produkta-i-web-sayta">  Produkt und Website verkn√ºpfen </h1><br><p>  Die Beziehung des Produkts zur Website bestimmt, in welchen Gesch√§ften und in welchen Vitrinen das Produkt vorne erh√§ltlich sein wird. </p><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">linkToWebsite</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prodId, $websiteId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'catalog_product_website'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'product_id'</span></span> =&gt; $prodId, <span class="hljs-string"><span class="hljs-string">'website_id'</span></span> =&gt; $websiteId ]; $conn-&gt;insert($table, $bind); }</code> </pre> <br><p><img src="https://habrastorage.org/webt/km/aq/al/kmaqaluoyidb9_ejzeyikkpd-x8.png" alt="Bild"></p><br><h1 id="bazovye-atributy-produkta">  Grundlegende Produktattribute </h1><br><p>  Ein frisch registriertes Produkt hat noch keinen Namen oder eine Beschreibung.  All dies erfolgt √ºber die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">EAV-Attribute</a> .  Hier ist eine Liste grundlegender Produktattribute, die erforderlich sind, um sicherzustellen, dass das Produkt vorne korrekt angezeigt wird: </p><br><ul><li> <code>name</code> </li> <li> <code>price</code> </li> <li> <code>description</code> </li> <li> <code>short_description</code> </li> <li> <code>status</code> </li> <li> <code>tax_class_id</code> </li> <li> <code>url_key</code> </li> <li> <code>visibility</code> </li> </ul><br><p>  So wird dem Produkt ein separates Attribut hinzugef√ºgt (die Details zum Abrufen des Bezeichners und des Attributtyps anhand seines Codes werden weggelassen): </p><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prodId, $attrCode, $attrValue)</span></span></span><span class="hljs-function"> </span></span>{ $attrId = <span class="hljs-comment"><span class="hljs-comment">/* get attribute ID by attribute code */</span></span> $attrType = <span class="hljs-comment"><span class="hljs-comment">/* get attribute type [datetime|decimal|int|text|varchar]) by attribute code */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($attrId) { <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $tblName = <span class="hljs-string"><span class="hljs-string">'catalog_product_entity_'</span></span> . $attrType; $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName($tblName); $bind = [ <span class="hljs-string"><span class="hljs-string">'attribute_id'</span></span> =&gt; $attrId, <span class="hljs-string"><span class="hljs-string">'entity_id'</span></span> =&gt; $prodId, <span class="hljs-comment"><span class="hljs-comment">/* put all attributes to default store view with id=0 (admin) */</span></span> <span class="hljs-string"><span class="hljs-string">'store_id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'value'</span></span> =&gt; $attrValue ]; $conn-&gt;insert($table, $bind); } }</code> </pre> <br><p>  Bestimmen Sie anhand des Attributcodes die ID und den Datentyp ( <code>datetime</code> / <code>datetime</code> , <code>decimal</code> , <code>int</code> , <code>text</code> , <code>varchar</code> ). In die entsprechende Tabelle schreiben wir dann die Daten f√ºr die administrative Storefront ( <code>store_id = 0</code> ). </p><br><p>  Nachdem wir dem Produkt die oben genannten Attribute hinzugef√ºgt haben, wird dieses Bild im Admin-Bereich angezeigt: </p><br><p><img src="https://habrastorage.org/webt/wd/wr/ho/wdwrhobsk4l_updxfernrw_uak4.png" alt="Bild"></p><br><h1 id="inventarnye-dannye">  Inventardaten </h1><br><p>  Ab Version 2.3 verf√ºgt Magento gleichzeitig √ºber zwei Tabellens√§tze, in denen Inventarinformationen (Produktmenge) gespeichert werden: </p><br><ul><li>  <code>cataloginventory_*</code> : alte Struktur; </li><li>  <code>inventory_*</code> : neue Struktur (MSI - Multi Source Inventory); </li></ul><br><p>  Sie m√ºssen beiden Strukturen Inventardaten hinzuf√ºgen, weil  Die neue Struktur ist noch nicht vollst√§ndig unabh√§ngig von der alten (anscheinend wird die Tabelle <code>cataloginventory_stock_status</code> als <code>inventory_stock_1</code> f√ºr das <code>default</code> in der neuen Struktur verwendet). </p><br><h2 id="cataloginventory_">  cataloginventory_ </h2><br><p>  Bei der Bereitstellung von Magneto 2.3 haben wir zun√§chst zwei Eintr√§ge in <code>store_website</code> , die zwei Sites entsprechen - dem administrativen und dem Hauptclient: </p><br><pre> <code class="plaintext hljs">website_id|code |name |sort_order|default_group_id|is_default| ----------|-----|------------|----------|----------------|----------| 0|admin|Admin | 0| 0| 0| 1|base |Main Website| 0| 1| 1|</code> </pre> <br><p>  In der Tabelle <code>cataloginventory_stock</code> haben wir nur einen Eintrag: </p><br><pre> <code class="plaintext hljs">stock_id|website_id|stock_name| --------|----------|----------| 1| 0|Default |</code> </pre> <br><p>  Das hei√üt, in unserer alten Struktur gibt es nur ein "Lager" ( <code>stock</code> ) und es ist an die Verwaltungswebsite gebunden.  Das Hinzuf√ºgen neuer <code>sources</code> / <code>stocks</code> zum MSI √ºber das Admin- <code>stocks</code> (neue Struktur) f√ºhrt nicht zu neuen Eintr√§gen in <code>cataloginventory_stock</code> . </p><br><p>  Bestandsdaten zu Produkten in der alten Struktur werden zun√§chst in die folgenden Tabellen geschrieben: </p><br><ul><li> <code>cataloginventory_stock_item</code> </li> <li> <code>cataloginventory_stock_status</code> </li> </ul><br><h3 id="cataloginventory_stock_item">  cataloginventory_stock_item </h3><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createOldItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prodId, $qty)</span></span></span><span class="hljs-function"> </span></span>{ $isQtyDecimal = (((int)$qty) != $qty); $isInStock = ($qty &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'cataloginventory_stock_item'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'product_id'</span></span> =&gt; $prodId, <span class="hljs-comment"><span class="hljs-comment">/* we use one only stock in 'cataloginventory' structure by default */</span></span> <span class="hljs-string"><span class="hljs-string">'stock_id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'qty'</span></span> =&gt; $qty, <span class="hljs-string"><span class="hljs-string">'is_qty_decimal'</span></span> =&gt; $isQtyDecimal, <span class="hljs-string"><span class="hljs-string">'is_in_stock'</span></span> =&gt; $isInStock, <span class="hljs-comment"><span class="hljs-comment">/* default stock is bound to admin website (see `cataloginventory_stock`) */</span></span> <span class="hljs-string"><span class="hljs-string">'website_id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ]; $conn-&gt;insert($table, $bind); }</code> </pre> <br><h3 id="cataloginventory_stock_status">  cataloginventory_stock_status </h3><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createOldStatus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prodId, $qty)</span></span></span><span class="hljs-function"> </span></span>{ $isInStock = ($qty &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'cataloginventory_stock_status'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'product_id'</span></span> =&gt; $prodId, <span class="hljs-comment"><span class="hljs-comment">/* we use one only stock in 'cataloginventory' structure by default */</span></span> <span class="hljs-string"><span class="hljs-string">'stock_id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'qty'</span></span> =&gt; $qty, <span class="hljs-string"><span class="hljs-string">'stock_status'</span></span> =&gt; \Magento\CatalogInventory\Api\Data\StockStatusInterface::STATUS_IN_STOCK, <span class="hljs-comment"><span class="hljs-comment">/* default stock is bound to admin website (see `cataloginventory_stock`) */</span></span> <span class="hljs-string"><span class="hljs-string">'website_id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ]; $conn-&gt;insert($table, $bind); }</code> </pre> <br><h2 id="inventory_">  inventar_ </h2><br><p>  Die neue Struktur zum Speichern von Inventardaten enth√§lt zun√§chst 1 " <em>Quelle</em> " ( <code>inventory_source</code> ): </p><br><pre> <code class="plaintext hljs">source_code|name |enabled|description |latitude|longitude|country_id|...| -----------|--------------|-------|--------------|--------|---------|----------|...| default |Default Source| 1|Default Source|0.000000| 0.000000|US |...|</code> </pre> <br><p>  und ein " <em>Lager</em> " ( <code>inventory_stock</code> ): </p><br><pre> <code class="plaintext hljs">stock_id|name | --------|-------------| 1|Default Stock|</code> </pre> <br><p>  Eine ‚Äû <em>Quelle</em> ‚Äú ist ein physischer Speicher f√ºr Produkte (der Datensatz enth√§lt physische Koordinaten und eine Postanschrift).  Ein " <em>Lager</em> " ist eine logische Vereinigung mehrerer "Quellen" ( <code>inventory_source_stock_link</code> ) </p><br><pre> <code class="plaintext hljs">link_id|stock_id|source_code|priority| -------|--------|-----------|--------| 1| 1|default | 1|</code> </pre> <br><p>  auf dessen Ebene ein Link zum Vertriebskanal besteht ( <code>inventory_stock_sales_channel</code> ) </p><br><pre> <code class="plaintext hljs">type |code|stock_id| -------|----|--------| website|base| 1|</code> </pre> <br><p>  Gemessen an der Datenstruktur werden verschiedene Arten von Vertriebskan√§len angenommen, aber standardm√§√üig wird nur die Verbindung " <em>Lager</em> " - " <em>Website</em> " verwendet (der Link zur Website wird durch die Website-Codebasis angegeben). </p><br><p>  Ein ‚Äû <em>Lager</em> ‚Äú kann mit mehreren ‚Äû <em>Quellen</em> ‚Äú verkn√ºpft werden, und eine ‚Äû <em>Quelle</em> ‚Äú kann mit mehreren ‚Äû <em>Lagern</em> ‚Äú verkn√ºpft werden (Viele-zu-Viele-Beziehung).  Ausnahmen sind default'ovye " <em>source</em> " und " <em>warehouse</em> ".  Sie sind nicht an andere Entit√§ten gebunden (Einschr√§nkung auf Codeebene - der Fehler " <em>Link kann nicht in Bezug auf Standardquelle oder Standardbestand gespeichert werden</em> " st√ºrzt ab).  Weitere Informationen zur MSI-Struktur in Magento 2 finden Sie im Artikel " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Warehouse Management System mit CQRS und Event Sourcing. Design</a> ". </p><br><p>  Ich werde die Standardkonfiguration verwenden und alle Inventarinformationen zur <code>default</code> hinzuf√ºgen, die in dem Vertriebskanal verwendet wird, der der Website mit dem <code>store_website</code> (entspricht dem Client-Teil des Gesch√§fts - siehe <code>store_website</code> ): </p><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNewItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($sku, $qty)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'inventory_source_item'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'source_code'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-string"><span class="hljs-string">'sku'</span></span> =&gt; $sku, <span class="hljs-string"><span class="hljs-string">'quantity'</span></span> =&gt; $qty, <span class="hljs-string"><span class="hljs-string">'status'</span></span> =&gt; \Magento\InventoryApi\Api\Data\SourceItemInterface::STATUS_IN_STOCK ]; $conn-&gt;insert($table, $bind); }</code> </pre> <br><p>  Nach dem Hinzuf√ºgen von Inventardaten zum Produkt im Admin-Bereich erhalten wir dieses Bild: </p><br><p><img src="https://habrastorage.org/webt/o1/pa/31/o1pa31wrecqqgma118t-9jqokqg.png" alt="Bild"></p><br><h1 id="media">  Medien </h1><br><p>  Wenn Sie dem Produkt √ºber das Admin-Panel "manuell" Bilder hinzuf√ºgen, werden die relevanten Informationen in den folgenden Tabellen aufgezeichnet: </p><br><ul><li>  <code>catalog_product_entity_media_gallery</code> : Medienregistrierung (Bilder und Videodateien); </li><li>  <code>catalog_product_entity_media_gallery_value</code> : Verkn√ºpfen von Medien mit Produkten und Storefronts (Lokalisierung); </li><li>  <code>catalog_product_entity_media_gallery_value_to_entity</code> : Binden von Medien nur an Produkte (vermutlich Standardmedieninhalt f√ºr das Produkt); </li><li>  <code>catalog_product_entity_varchar</code> : Hier werden Rollen gespeichert, die das Bild verwenden. </li></ul><br><p>  und die Bilder selbst werden im Verzeichnis <code>./pub/media/catalog/product/x/y/</code> , wobei <code>x</code> und <code>y</code> der erste und zweite Buchstabe des Bilddateinamens sind.  Beispielsweise muss die Datei <code>image.png</code> als <code>./pub/media/catalog/product/i/m/image.png</code> werden, damit die Plattform sie als Image bei der Beschreibung von Produkten aus dem Katalog verwenden kann. </p><br><h2 id="catalog_product_entity_media_gallery">  catalog_product_entity_media_gallery </h2><br><p>  Wir registrieren die Mediendatei unter <code>./pub/media/catalog/product/</code> (der Vorgang des Platzierens der Datei in diesem Artikel wird nicht ber√ºcksichtigt): </p><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createMediaGallery</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($imgPathPrefixed)</span></span></span><span class="hljs-function"> </span></span>{ $attrId = <span class="hljs-comment"><span class="hljs-comment">/* get attribute ID by attribute code 'media_gallery' */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'catalog_product_entity_media_gallery'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'attribute_id'</span></span> =&gt; $attrId, <span class="hljs-string"><span class="hljs-string">'value'</span></span> =&gt; $imgPathPrefixed, <span class="hljs-comment"><span class="hljs-comment">/* 'image' or 'video' */</span></span> <span class="hljs-string"><span class="hljs-string">'media_type'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'image'</span></span>, <span class="hljs-string"><span class="hljs-string">'disabled'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> ]; $conn-&gt;insert($table, $bind); $result = $conn-&gt;lastInsertId($table); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $result; }</code> </pre> <br><p>  Bei der Registrierung wird einer neuen Mediendatei eine Kennung zugewiesen. </p><br><h2 id="catalog_product_entity_media_gallery_value">  catalog_product_entity_media_gallery_value </h2><br><p>  Wir verkn√ºpfen die registrierte Mediendatei mit dem entsprechenden Produkt f√ºr das Standard-Schaufenster: </p><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createGalleryValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($mediaId, $prodId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'catalog_product_entity_media_gallery_value'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'value_id'</span></span> =&gt; $mediaId, <span class="hljs-comment"><span class="hljs-comment">/* use admin store view by default */</span></span> <span class="hljs-string"><span class="hljs-string">'store_id'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'entity_id'</span></span> =&gt; $prodId, <span class="hljs-string"><span class="hljs-string">'label'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-comment"><span class="hljs-comment">/* we have one only image */</span></span> <span class="hljs-string"><span class="hljs-string">'position'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'disabled'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> ]; $conn-&gt;insert($table, $bind); }</code> </pre> <br><h2 id="catalog_product_entity_media_gallery_value_to_entity">  catalog_product_entity_media_gallery_value_to_entity </h2><br><p>  Wir verkn√ºpfen die registrierte Mediendatei mit dem entsprechenden Produkt, ohne auf eine Storefront zu verweisen.  Es ist nicht klar, wo genau diese Daten verwendet werden und warum es nicht m√∂glich ist, auf die Daten der vorherigen Tabelle zuzugreifen, aber diese Tabelle existiert und die Daten werden beim Hinzuf√ºgen eines Bildes zum Produkt darauf geschrieben.  Deshalb so. </p><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createGalleryValueToEntity</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($mediaId, $prodId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'catalog_product_entity_media_gallery_value_to_entity'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'value_id'</span></span> =&gt; $mediaId, <span class="hljs-string"><span class="hljs-string">'entity_id'</span></span> =&gt; $prodId ]; $conn-&gt;insert($table, $bind); }</code> </pre> <br><h2 id="catalog_product_entity_varchar">  catalog_product_entity_varchar </h2><br><p>  Eine Mediendatei kann mit verschiedenen Rollen verwendet werden (der Code des entsprechenden Attributs ist in Klammern angegeben): </p><br><ul><li>  Basis ( <code>image</code> ) </li><li>  Kleines Bild ( <code>small_image</code> ) </li><li>  Vorschaubild ( <code>thumbnail</code> ) </li><li>  Swatch Image ( <code>swatch_image</code> ) </li></ul><br><p>  Das Binden von Rollen an eine Mediendatei erfolgt nur in <code>catalog_product_entity_varchar</code> .  Der Bindungscode √§hnelt dem Code im Abschnitt " <em>Grundlegende Produktattribute</em> ". </p><br><p>  Nach dem Hinzuf√ºgen des Bildes zum Produkt im Admin-Bereich sieht es folgenderma√üen aus: </p><br><p><img src="https://habrastorage.org/webt/w-/vn/uf/w-vnufrenpxowdr5ckl8k5fqzzo.png" alt="Bild"></p><br><h1 id="kategorii">  Kategorien </h1><br><p>  Haupttabellen, die Daten nach Kategorie enthalten: </p><br><ul><li>  <code>catalog_category_entity</code> : Register der Kategorien; </li><li>  <code>catalog_category_product</code> : Zuordnung von Produkten und Kategorien; </li><li>  <code>catalog_category_entity_*</code> : Werte von EAV-Attributen; </li></ul><br><p>  In einer leeren Magento-Anwendung enth√§lt die Kategorieregistrierung zun√§chst zwei Kategorien (ich habe die Spaltennamen gek√ºrzt: <code>crt</code> - <code>created_at</code> , <code>upd</code> - <code>updated_at</code> ): </p><br><pre> <code class="plaintext hljs">entity_id|attribute_set_id|parent_id|crt|upd|path|position|level|children_count| ---------|----------------|---------|---|---|----|--------|-----|--------------| 1| 3| 0|...|...|1 | 0| 0| 1| 2| 3| 1|...|...|1/2 | 1| 1| 0|</code> </pre> <br><p>  Die Kategorie mit id = 1 ist das Stammverzeichnis des gesamten Magento-Verzeichnisses und steht weder im Admin-Bereich noch auf der Vorderseite zur Verf√ºgung.  Die Kategorie mit der ID = 2 ( <em>Standardkategorie</em> ) ist die Stammkategorie f√ºr den Hauptspeicher der Hauptwebsite ( <em>Hauptwebsite-Speicher</em> ), die w√§hrend der Anwendungsbereitstellung erstellt wurde (siehe <em>Admin / Stores / All Stores</em> ).  Dar√ºber hinaus ist auch die Stammkategorie des Gesch√§fts an der Vorderseite nicht verf√ºgbar, nur die Unterkategorien. </p><br><p>  Da das Thema dieses Artikels immer noch Produktdaten importiert, verwende ich beim Erstellen von Kategorien keine direkte Aufzeichnung in der Datenbank, sondern die von Magento selbst bereitgestellten Klassen (Modelle und Repositorys).  Die direkte Aufzeichnung in der Datenbank wird nur zum Verkn√ºpfen des importierten Produkts mit der Kategorie verwendet (die Kategorie wird anhand ihres Namens zugeordnet, die Kategorie-ID wird beim Abgleich extrahiert): </p><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($prodId, $catId)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\App\ResourceConnection $this-&gt;resource */</span></span> <span class="hljs-comment"><span class="hljs-comment">/** </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> \Magento\Framework\DB\Adapter\Pdo\Mysql $conn */</span></span> $conn = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getConnection(); $table = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;resource-&gt;getTableName(<span class="hljs-string"><span class="hljs-string">'catalog_category_product'</span></span>); $bind = [ <span class="hljs-string"><span class="hljs-string">'category_id'</span></span> =&gt; $catId, <span class="hljs-string"><span class="hljs-string">'product_id'</span></span> =&gt; $prodId, ]; $conn-&gt;insert($table, $bind); }</code> </pre> <br><p>  Nach dem Hinzuf√ºgen eines Produktlinks zu den Kategorien "Kategorie 1" und "Kategorie 2" sehen die Produktdetails im Admin-Bereich ungef√§hr so ‚Äã‚Äãaus: </p><br><p><img src="https://habrastorage.org/webt/p9/1l/yc/p91lycpb0w_tpqfe169n5t4djfs.png" alt="Bild"></p><br><h1 id="dopolnitelnye-deystviya">  Zus√§tzliche Aktionen </h1><br><p>  Nach Abschluss des Datenimports m√ºssen Sie die folgenden zus√§tzlichen Schritte ausf√ºhren: </p><br><ul><li>  <code>./bin/magento indexer:reindex</code> : Ein Aufruf in der Konsole <code>./bin/magento indexer:reindex</code> ; </li><li>  URL-Regeneration f√ºr Produkte / Kategorien: Sie k√∂nnen die Erweiterung " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">elgentos / regenerate-catalog-urls</a> " verwenden. </li></ul><br><p>  Produkte im Admin-Bereich nach Abschluss weiterer Schritte: </p><br><p><img src="https://habrastorage.org/webt/q5/ge/fd/q5gefdgdiwcxotbysfymjggmcom.png" alt="Bild"></p><br><p>  und vorne: </p><br><p><img src="https://habrastorage.org/webt/pl/dw/6l/pldw6lefwqdxl_ye2o-debpkyz4.png" alt="Bild"></p><br><h1 id="rezyume">  Zusammenfassung </h1><br><p>  Der gleiche Satz von Produkten (10 St√ºck) wie im vorherigen Artikel wird mindestens eine Gr√∂√üenordnung schneller importiert (1 Sekunde gegen√ºber 10).  F√ºr eine genauere Sch√§tzung der Geschwindigkeit ben√∂tigen Sie eine gr√∂√üere Anzahl von Produkten - mehrere hundert und vorzugsweise Tausende.  Trotzdem kann trotz einer so geringen Menge an Eingabedaten der Schluss gezogen werden, dass die Verwendung der von Magento bereitgestellten Tools (Modelle und Repositorys) die Entwicklung der erforderlichen Funktionalit√§t erheblich beschleunigt (hervorheben - <em>deutlich</em> !), Aber erheblich (hervorheben - <em>deutlich</em> !) Reduziert Geschwindigkeit, mit der Daten in die Datenbank gelangen. </p><br><p>  Infolgedessen stellte sich heraus, dass das Wasser nass war, und dies ist keine Offenbarung.  Jetzt habe ich jedoch Code zum Spielen und m√∂glicherweise interessantere Schlussfolgerungen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de440262/">https://habr.com/ru/post/de440262/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de440250/index.html">Gelegenheit schlief f√ºr immer ein: Die NASA erkannte den Verlust eines Rovers an</a></li>
<li><a href="../de440252/index.html">Antiquit√§ten: ein moderner Computer aus alten Teilen</a></li>
<li><a href="../de440256/index.html">Installieren Sie die Diaspora *</a></li>
<li><a href="../de440258/index.html">Eine unbemannte Stra√üenbahn wird in Moskau getestet. Wir haben mit den Autopilot-Entwicklern gesprochen.</a></li>
<li><a href="../de440260/index.html">Das Chang'e-4-Modul und der Yutu-2-Rover sind bereit f√ºr die zweite Nacht auf der anderen Seite des Mondes</a></li>
<li><a href="../de440264/index.html">Tetris-Spiele oder was ist Kapazit√§tsmanagement in einem Rechenzentrum?</a></li>
<li><a href="../de440266/index.html">Ein paar Worte zu physikalischen Theorien als Ann√§herungen an die reale Welt</a></li>
<li><a href="../de440268/index.html">Schallumleitung: Mechanismus zur Erzeugung von Ultraschallklicks in Nachtmotten zum Schutz vor Flederm√§usen</a></li>
<li><a href="../de440270/index.html">Wir betrachten einen Schichtplan im Kopf</a></li>
<li><a href="../de440272/index.html">Mobile Opera hat ein kostenloses VPN</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>