<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ ğŸ’‚ ğŸˆµ PHP GR8: Akankah JIT Meningkatkan Kinerja PHP 8 ğŸ¥  ğŸ‘¸ğŸ¿ ğŸ–•ğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PHP adalah salah satu bahasa pengembangan utama di Badoo. Di pusat data kami, ribuan inti prosesor sibuk mengeksekusi jutaan baris kode PHP. Kami teru...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PHP GR8: Akankah JIT Meningkatkan Kinerja PHP 8</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/448622/"><img src="https://habrastorage.org/webt/bw/fj/lk/bwfjlk2iy2btywbt8rqmlsok_-i.jpeg"><br><br>  <i>PHP adalah salah satu bahasa pengembangan utama di Badoo.</i>  <i>Di pusat data kami, ribuan inti prosesor sibuk mengeksekusi jutaan baris kode PHP.</i>  <i>Kami terus mengikuti berita dan secara aktif mencari cara untuk meningkatkan produktivitas, karena bahkan sedikit optimasi pada volume kami mengarah pada penghematan sumber daya yang signifikan.</i>  <i>Salah satu berita kinerja PHP utama adalah penampilan JIT dalam versi bahasa yang kedelapan.</i>  <i>Ini, tentu saja, tidak dapat tetap tanpa perhatian kami, dan kami menerjemahkan sebuah artikel tentang apa itu JIT, bagaimana itu akan diterapkan dalam PHP, mengapa diputuskan untuk melakukannya dan apa yang diharapkan dari itu.</i> <br><br>  Jika Anda tidak meninggalkan gua atau tidak datang dari masa lalu (dalam hal ini, selamat datang), Anda sudah tahu bahwa PHP 8 akan memiliki JIT: hari lain, suara dengan tenang dan damai, dan sebagian besar peserta memberikan suara mendukung implementasi, jadi semuanya diputuskan . <br><br>  Dalam kegembiraan, Anda bahkan dapat menggambarkan beberapa gerakan gila seperti di foto (ini, omong-omong, disebut "Detroit JIT": <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/ip/gp/gk/ipgpgk3stro-ora0on1jhgbxg-y.jpeg"><br><br>  Sekarang, duduk dan baca artikel mitos-sanggahan ini.  Saya ingin mengklarifikasi kesalahpahaman terkait dengan apa JIT itu dan bagaimana itu berguna, dan berbicara tentang cara kerjanya (tetapi tidak terlalu banyak detail sehingga Anda tidak bosan). <br><br>  Karena saya tidak tahu siapa yang akan membaca artikel itu, saya akan beralih dari pertanyaan sederhana ke rumit.  Jika Anda sudah tahu jawaban pertanyaan dalam judul, Anda dapat dengan aman melewati bab yang sesuai. <br><br><h1>  Apa itu JIT? </h1><br>  PHP diimplementasikan berdasarkan mesin virtual (kami menyebutnya Zend VM).  Bahasa mengkompilasi kode sumber PHP menjadi instruksi yang dimengerti mesin virtual (ini disebut tahap kompilasi).  Instruksi mesin virtual yang diperoleh pada tahap kompilasi disebut opcodes.  Pada tahap runtime, Zend VM mengeksekusi opcodes, sehingga melakukan pekerjaan yang diperlukan. <br><br>  Sirkuit ini berfungsi dengan baik.  Selain itu, alat-alat seperti APC (sebelum) dan OpCache (hari ini) men-cache hasil dari tahap kompilasi, jadi tahap ini hanya dilakukan jika perlu. <br><br>  Singkatnya, JIT adalah strategi kompilasi just-in-time (pada waktu yang tepat), di mana kode pertama-tama diterjemahkan ke dalam representasi perantara, yang kemudian berubah menjadi kode mesin yang bergantung pada arsitektur selama eksekusi. <br><br>  Dalam PHP, ini berarti bahwa JIT akan mempertimbangkan instruksi untuk mesin virtual yang diterima pada tahap kompilasi sebagai representasi perantara dan mengeluarkan kode mesin yang tidak lagi dijalankan oleh Zend VM, tetapi langsung oleh prosesor. <br><br><h1>  Mengapa PHP membutuhkan JIT? </h1><br>  Sesaat sebelum munculnya PHP 7.0, fokus utama tim PHP adalah kinerja bahasa.  Sebagian besar perubahan utama dalam PHP 7.0 ada di patch PHPNG, yang sangat meningkatkan cara PHP menggunakan memori dan prosesor.  Sejak itu, kita masing-masing harus melirik kinerja bahasa. <br><br>  Setelah rilis PHP 7.0, peningkatan kinerja berlanjut: tabel hash (struktur data utama dalam PHP) dioptimalkan, spesialisasi opcode tertentu dalam Zend VM dan spesialisasi urutan tertentu dalam kompiler dilaksanakan, Pengoptimal (komponen OpCache) terus ditingkatkan, dan banyak perubahan lainnya diterapkan. <br><br>  Kebenaran yang keras adalah bahwa sebagai hasil dari semua optimisasi ini, kami dengan cepat mendekati batas peluang peningkatan produktivitas. <br><br>  Harap dicatat: dengan "batas peluang peningkatan" yang saya maksudkan adalah fakta bahwa pertukaran yang harus dilakukan untuk perbaikan lebih lanjut tidak lagi terlihat menarik.  Ketika datang untuk mengoptimalkan kinerja, kami selalu berbicara tentang pertukaran.  Seringkali, demi produktivitas, kita harus mengorbankan kesederhanaan.  Semua orang ingin berpikir bahwa kode paling sederhana juga yang tercepat, tetapi di dunia modern pemrograman C ini tidak demikian.  Yang tercepat paling sering adalah kode yang disiapkan untuk mengambil keuntungan dari struktur internal arsitektur atau struktur yang dibangun ke dalam platform / kompiler.  Kesederhanaan saja tidak menjamin kinerja yang lebih baik. <br><br>  Oleh karena itu, pada tahap ini, cara terbaik untuk memeras kinerja lebih banyak lagi dari PHP adalah dengan mengimplementasikan JIT. <br><br><h1>  Akankah JIT mempercepat situs saya? </h1><br>  Kemungkinan besar, tidak signifikan. <br><br>  Ini mungkin bukan jawaban yang Anda harapkan.  Faktanya adalah bahwa secara umum, aplikasi PHP dibatasi oleh input / output (terikat I / O), dan JIT bekerja paling baik dengan kode yang dibatasi oleh prosesor (terikat CPU). <br><br><h1>  Apa yang dimaksud dengan "dibatasi oleh I / O dan prosesor"? </h1><br>  Untuk menggambarkan karakteristik kinerja keseluruhan beberapa kode atau aplikasi, kami menggunakan istilah "dibatasi oleh input-output" dan "dibatasi oleh prosesor". <br><br>  Definisi paling sederhana: <br><br><ul><li>  kode yang dibatasi oleh I / O akan bekerja lebih cepat jika kita menemukan cara untuk meningkatkan (mengurangi, mengoptimalkan) operasi I / O yang dilakukan; <br></li><li>  kode terbatas prosesor akan bekerja lebih cepat jika kita menemukan cara untuk meningkatkan (mengurangi, mengoptimalkan) instruksi yang dijalankan oleh prosesor atau secara ajaib meningkatkan kecepatan jam prosesor. <br></li></ul><br>  Kode dan aplikasi dapat dibatasi oleh I / O, oleh prosesor, atau keduanya. <br><br>  Secara umum, aplikasi PHP cenderung dibatasi oleh I / O: hambatan utamanya adalah seringnya operasi I / O - menghubungkan, membaca dan menulis ke database, cache, file, soket, dll. <br><br><h1>  Seperti apa bentuk kode PHP terbatas prosesor? </h1><br>  Mungkin beberapa programmer PHP baru mengenal kode terbatas prosesor karena sifat sebagian besar aplikasi PHP: mereka biasanya bertindak sebagai tautan ke basis data atau cache, mengambil dan menghasilkan sejumlah kecil tanggapan HTML / JSON / XML. <br><br>  Anda dapat melihat basis kode Anda dan menemukan banyak kode yang tidak ada hubungannya dengan I / O, kode yang memanggil fungsi yang tidak ada hubungannya dengan I / O.  Dan Anda mungkin bingung bahwa ini tidak membuat aplikasi Anda dibatasi oleh prosesor, meskipun kodenya memiliki lebih banyak baris yang tidak berfungsi dengan I / O daripada bekerja. <br><br>  Faktanya adalah bahwa PHP adalah salah satu bahasa yang ditafsirkan tercepat.  Tidak ada perbedaan nyata antara memanggil fungsi yang tidak menggunakan I / O di Zend VM dan dalam kode mesin.  Tentu saja, ada beberapa perbedaan, tetapi kode mesin dan Zend VM menggunakan konvensi pemanggilan, jadi tidak masalah <code>-___()</code> Anda memanggil <code>-___()</code> dalam opcodes atau dalam kode mesin - ini tidak akan memiliki efek nyata pada kinerja seluruh aplikasi yang melakukan panggilan. <br><br>  <i>Catatan: secara sederhana, konvensi panggilan adalah urutan instruksi yang dijalankan <b>sebelum</b> memasuki fungsi lain.</i>  <i>Dalam kedua kasus, konvensi pemanggilan meneruskan argumen ke stack.</i> <br><br>  Anda bertanya: "Bagaimana dengan loop, tail tail, dan banyak lagi?"  PHP cukup pintar - dan ketika Pengoptimal dari OpCache dihidupkan, kode Anda akan secara ajaib dikonversi ke versi yang lebih efisien dari apa yang Anda tulis. <br><br>  Perlu dicatat di sini bahwa JIT tidak akan mengubah konvensi pemanggilan Zend VM.  Ini dilakukan karena PHP harus dapat beralih antara mode JIT dan VM kapan saja (oleh karena itu, mereka memutuskan untuk tetap menggunakan konvensi saat ini).  Akibatnya, semua panggilan yang Anda lihat di mana saja menggunakan JIT tidak akan berfungsi lebih cepat. <br><br>  Jika Anda ingin melihat seperti apa kode PHP terbatas prosesor, lihat di sini: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://github.com/php/php-src/blob/master/Zend/bench.php</a> .  Ini adalah contoh ekstrem, tetapi itu menunjukkan bahwa semua kemegahan JIT terungkap dalam matematika. <br><br><h1>  Harus membuat kompromi ekstrem untuk mempercepat perhitungan matematika dalam PHP? </h1><br>  Tidak.  Kami melakukan ini demi memperluas jangkauan aplikasi bahasa (dan memperluas signifikan). <br><br>  Kami tidak ingin sesumbar, tetapi PHP mendominasi web.  Jika Anda terlibat dalam pengembangan web dan tidak mempertimbangkan menggunakan PHP dalam proyek Anda berikutnya, maka Anda melakukan sesuatu yang salah (menurut pengembang PHP yang sangat bias). <br><br>  Sekilas, mungkin tampak bahwa akselerasi perhitungan matematis dalam PHP memiliki aplikasi yang sangat sempit.  Namun, ini membuka jalan bagi kita, misalnya, untuk pembelajaran mesin, rendering 3D, rendering 2D (GUI) dan analisis data. <br><br><h1>  Mengapa ini tidak dapat diimplementasikan dalam PHP 7.4? </h1><br>  Di atas, saya menyebut JIT sebagai kompromi yang ekstrem, dan saya benar-benar berpikir demikian: ini adalah salah satu strategi kompilasi yang paling sulit di antara semua yang ada, jika bukan yang paling sulit.  Menerapkan JIT adalah peningkatan kompleksitas yang signifikan. <br><br>  Jika Anda bertanya kepada Dmitry, penulis JIT, apakah ia membuat PHP rumit, ia akan menjawab: "Tidak, saya benci kompleksitas" (ini kutipan). <br><br>  Pada dasarnya, "kompleks" berarti "apa yang tidak kita mengerti."  Dan hari ini, beberapa pengembang bahasa benar-benar memahami implementasi JIT yang ada. <br><br>  Bekerja dengan PHP 7.4 mengalami kemajuan pesat, dan pengenalan JIT dalam versi ini akan mengarah pada fakta bahwa hanya sedikit yang dapat melakukan debug, memperbaiki dan meningkatkan bahasa.  Ini tidak dapat diterima bagi mereka yang memberikan suara menentang JIT di PHP 7.4. <br><br>  Sebelum rilis PHP 8, banyak dari kita akan memahami implementasi JIT.  Ada fitur yang ingin kita implementasikan, dan alat yang ingin kita tulis ulang untuk versi kedelapan, jadi kita harus terlebih dahulu memahami JIT.  Kami membutuhkan waktu ini, dan kami sangat berterima kasih bahwa mayoritas memilih untuk memberikannya kepada kami. <br><br>  Kompleks tidak identik dengan yang mengerikan.  Kompleksitas dapat seindah bintang nebula, dan ini hanya tentang JIT.  Dengan kata lain, bahkan ketika 20 orang di tim kami mulai memahami JIT tidak lebih buruk dari Dmitry, ini tidak akan mengubah kompleksitas sifat JIT. <br><br><h1>  Apakah pengembangan PHP akan melambat? </h1><br>  Tidak ada alasan untuk berpikir demikian.  Kami memiliki cukup waktu, sehingga dapat diperdebatkan bahwa pada saat PHP 8 siap, akan ada cukup banyak di antara kita yang telah cukup menguasai JIT untuk bekerja tidak kurang efisien daripada hari ini ketika datang untuk memperbaiki bug dan mengembangkan PHP. <br><br>  Ketika Anda mencoba menghubungkan ini dengan gagasan tentang kompleksitas asli JIT, ingatlah bahwa sebagian besar waktu yang kami habiskan untuk memperkenalkan fitur baru dihabiskan untuk membahasnya.  Paling sering, ketika mengerjakan fitur dan memperbaiki bug, menulis kode membutuhkan beberapa menit atau jam, dan diskusi membutuhkan waktu berminggu-minggu atau berbulan-bulan.  Dalam kasus yang jarang terjadi, kode harus ditulis berjam-jam atau berhari-hari, tetapi bahkan diskusi selalu berlangsung lebih lama. <br><br>  Hanya itu yang ingin saya katakan. <br><br><blockquote>  Dan karena kita berbicara tentang kinerja, saya mengundang rekan saya Pavel Murzakov ke laporan pada 17 Mei di konferensi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PHP Russia.</a>  Pasha tahu cara memeras CPU terakhir dari kode PHP! </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id448622/">https://habr.com/ru/post/id448622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id448606/index.html">Sidorin: KnowledgeConf adalah tentang bagaimana mempertahankan pengetahuan dengan durasi kerja rata-rata di satu tempat dalam 2-3 tahun</a></li>
<li><a href="../id448608/index.html">Bagaimana cara mengambil langkah pertama dalam robotika?</a></li>
<li><a href="../id448610/index.html">DIY: Bagaimana Kami Membuat Jadwal Langsung untuk Codefest X</a></li>
<li><a href="../id448612/index.html">Apa yang dibekukan pada pembekuan fitur 2019. Bagian I. JSONPath</a></li>
<li><a href="../id448618/index.html">Algoritma Douglas-Pecker</a></li>
<li><a href="../id448624/index.html">Lihat datanya? Tidak. Jadi saya tidak melihat, tetapi mereka. Kami menghancurkan data pada drive SSD, dan bahkan mengembalikan kecepatan</a></li>
<li><a href="../id448626/index.html">DDoS untuk membantu: bagaimana kita melakukan tes stres dan stres</a></li>
<li><a href="../id448628/index.html">Estetika dan teknologi teknis Soviet</a></li>
<li><a href="../id448632/index.html">Java sekarang dibayar? Desas-desus desas-desus (atau tidak?)</a></li>
<li><a href="../id448634/index.html">Pelajaran Ukraina</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>