<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍙 👰🏻 📱 WiFi-Wasserkocher zu Hause oder wie man einen normalen Wasserkocher wirklich intelligent macht 🚩 🌜 🕵️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vorwort
 
 Wenn Sie meinen vorherigen Artikel ( Running Line auf Arduino ) lesen , wissen Sie wahrscheinlich bereits, dass wir die Möglichkeit haben, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>WiFi-Wasserkocher zu Hause oder wie man einen normalen Wasserkocher wirklich intelligent macht</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/393785/"><img src="https://habrastorage.org/files/13e/789/ac5/13e789ac5ab64c99bb2243540c6188bc.jpg" alt="Bild"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vorwort</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie meinen vorherigen Artikel ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Running Line auf Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font><font style="vertical-align: inherit;">lesen </font><font style="vertical-align: inherit;">, wissen Sie wahrscheinlich bereits, dass wir die Möglichkeit haben, Hardware-Kursprojekte an unserer Universität durchzuführen. </font><font style="vertical-align: inherit;">Und ich, inspiriert von meiner früheren Arbeit, beschloss, noch einmal zu versuchen, etwas mit meinen eigenen Händen zu tun. </font><font style="vertical-align: inherit;">Erst jetzt hätte das Thema ernster sein sollen. </font><font style="vertical-align: inherit;">Übrigens habe ich mir überlegt, was ich in den Winterferien, also vor dem Semester, tun soll. </font><font style="vertical-align: inherit;">Ich wollte gleichzeitig etwas Interessantes und Nützliches tun.</font></font><br>
<br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suche nach einer Idee</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Einmal hatten wir in einem Paar über die Grundlagen des Informationsschutzes ein Thema im Zusammenhang mit geistigem Eigentum und Patenten. Der Lehrer gab uns die Aufgabe, ein Patent für jedes Gerät gemäß allen Anforderungen zu erteilen, und führte als Beispiel einen WLAN-Wasserkocher an. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sagte er - und vergaß. Und alle haben es vergessen, aber in meinem Kopf blieb dieses Thema. Und als es an der Zeit war, darüber nachzudenken, was ich im nächsten Semester als Kursarbeit tun sollte, erinnerte ich mich an diese Teekanne. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das erste, was ich sehen wollte, ist, was bereits getan wurde. Und was war meine Überraschung, als ich sah, dass es nur drei Modelle von Dummies mit WiFi-Steuerungsunterstützung gibt, von denen zwei zur selben Firma gehören. Dies waren Smarter iKettle 1.0 und 2.0 sowie der russische Polaris PWK 1792CGL.</font></font><br>
<br>
<img src="https://psv4.vk.me/c615220/u9412861/docs/0ad68e7b3b82/imgonline-com-ua-twotoonefP6QyHRwpyGH.jpg?extra=DYIN0iLJbtamO0yymkG01568IjGjd-b5TPTlrxOGOg9GKUkRFG9qAbzX7whoNtLphkadbiiUq9AIz1X7jxfJ5trWX89OM_uDNpnwCw7j1tyXwPGFSsnL" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist interessant, dass fast jedes Haus gewöhnliche Wasserkocher hat und es so wenige intelligente gibt. </font><font style="vertical-align: inherit;">Beim Vergleich der von iKettle und Polaris angebotenen Funktionen habe ich eine Liste der wichtigsten erstellt. </font><font style="vertical-align: inherit;">Folgendes ist passiert:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ein- und Ausschalten von einem Smartphone aus;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einstellen einer beliebigen Temperatur zum Erhitzen von Wasser;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">die Fähigkeit, die aktuelle Temperatur herauszufinden;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verfolgung des aktuellen Wasservolumens im Wasserkocher;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warnung und Schutz gegen Einschalten mit wenig Wasser;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Einstellen der automatischen Weckzeit;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bereitschaftsmitteilung;</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es scheint echt auszusehen, es ist Zeit, zur Sache zu kommen.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suchen Sie nach erforderlichen Komponenten</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da es nicht möglich war, einen komplett neuen Wasserkocher herzustellen, wurde beschlossen, einen vorgefertigten normalen elektrischen Wasserkocher zu modifizieren. Zu Hause war ein verwaister Wasserkocher mit einem kaputten Schalter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Fundament ist also schon da, dachte ich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt musste ich nach Komponenten für die Hardware suchen. Da es bereits wenig Erfahrung mit Arduino gab, habe ich beschlossen, alles darauf zu implementieren. Darüber hinaus sind Arduin selbst und Module dafür kostengünstig. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da ich den gesamten Teil der Steuerung des Kessels in den Kessel einführen musste, fiel die Wahl auf den Arduino Nano. Es ist klein und verfügt im Gegensatz zum Pro Mini über eine Schnittstelle zum Anschließen eines Kabels, die über UART geflasht werden muss.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/bd1/d8a/273/bd1d8a273b5189fb42cdd0834246dbc4.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Hauptkomponente eines WLAN-Wasserkochers ist natürlich ein WLAN-Modul. Das Durchsuchen des Internets nach etwas Erschwinglichem und vielen Tutorials stieß auf den ESP8266. In Version 01 sah es nämlich günstig aus (ca. 2 US-Dollar) und es gab viele Anweisungen zum Anschließen. Hielt an. Was das Modul selbst betrifft, ist der Satz hier gut: billig und fröhlich. Aber dazu später mehr. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/a39/db0/0e5/a39db00e5e05bc51f4c727c9b75ee18a.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Temperatur zu regeln, brauchten wir eine Art wasserdichten Temperatursensor. Ich habe einen wasserdichten NTC-Thermistor auf aliexpress gefunden, der Temperaturen von mehr als 100 Grad standhält. Ich habe auch ein Beispiel für die Arbeit mit ihm gefunden, also habe ich mich hier schnell entschieden.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/205/649/1b9/2056491b9c4e3906446017711d069826.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war notwendig zu entscheiden, wie der Wasserkocher zu einem bestimmten Zeitpunkt eingeschaltet werden soll. Natürlich können Sie die Programmuhr auf Arduino einstellen und den Wasserkocher einschalten, wenn die Zeit zusammenfällt. Dies würde jedoch instabil funktionieren, und wenn das Programm versehentlich zurückgesetzt wird, läuft alles schief. Daher kam hier eine Echtzeituhr zur Rettung. Nämlich DS1307. Sie haben eine unabhängige Stromversorgung (von einer 3-V-Batterie) und es gab auch einen 32-K-Bit-EEPROM-Speicherchip auf dem Modul, an dem ich angehalten habe, wodurch ich Zeit gespart habe. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/f8b/6d4/3e1/f8b6d43e1e1ddcf1ab573ad49bec80f3.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oh ja, da sich der Wasserkocher jetzt programmgesteuert einschalten sollte, benötigte er auch ein 1-Kanal-Relais. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/be1/f74/46d/be1f7446d29e3cdcc3a226860e31d01d.jpg" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Flüssigkeitsstandsensor musste manuell durchgeführt werden. Details unten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Übrigen wurden noch mehrere Widerstände unterschiedlicher Nennwerte benötigt, ein Steckbrett für Tests, eine Leiterplatte für die eigentliche Installation, Verkabelung, ein Lötkolben mit Flussmittel und Lötmittel und der Löwenanteil der Geduld.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entwicklungsstart</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da es sich bei dem Projekt um einen WLAN-Wasserkocher handelt, wollte und musste ich mich als erstes mit dem WLAN-Modul befassen. </font><font style="vertical-align: inherit;">Sobald das Paket angekommen war, packte ich es sofort aus und begann mich zu verbinden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe eine Reihe von Beispielen im Internet gefunden. </font><font style="vertical-align: inherit;">Alles ist wie es sollte, 3,3 V Spannungsregler, Spannungsteiler für RX und TX. </font><font style="vertical-align: inherit;">Ich habe alles anhand eines Beispiels gesammelt, ich verbinde es - es ist nicht geflogen! </font><font style="vertical-align: inherit;">Wie sich herausstellte, wurde auf dem COM-Port-Monitor eine Reihe von Texten angezeigt. Das Modul wurde ständig zurückgesetzt. </font><font style="vertical-align: inherit;">Es reagiert nicht auf gesendete AT-Befehle. </font><font style="vertical-align: inherit;">Der Autor des Artikels arbeitet, ich nicht.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Was ist los? Ich habe versucht, nach anderen Verbindungsschemata usw. zu suchen, aber das Modul ist immer noch entweder zurückgesetzt oder zeigt nichts an. Und überall ist es in roter Schrift geschrieben: "Nicht auf das 5-V-Modul anwenden, sonst schlägt es fehl." Die Suche nach Lösungen dauerte manchmal abends. Ich dachte bereits über den Kauf eines anderen Moduls nach, entschied mich jedoch, die Spannung mit einem Multimeter zu überprüfen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich heraus, dass beim Anschließen des Moduls an 3,3 V die Spannung unter 3,2 V abfällt. Es scheint, dass sie abfällt und abfällt. Ich entschied mich für eine Stromversorgung über eine andere Stromquelle und es stellte sich heraus, dass das Modul normal mit einer Spannung über 3,2 V arbeitet und darunter nicht ausreicht und es ständig zurückgesetzt wird. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Infolgedessen habe ich es auf eigene Gefahr und Gefahr an 5 V angeschlossen und alles hat funktioniert und funktioniert immer noch einwandfrei. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d5d/17e/780/d5d17e7804c34c46a595c059100295e1.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es gab keine derartigen Probleme mit anderen Komponenten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem ich WLAN herausgefunden hatte, musste ich mich entscheiden, was ich mit dem Flüssigkeitsstandsensor machen sollte. Beim Googeln fand ich einen Artikel, in dem der Autor einen Bodenfeuchtesensor herstellte. Wenn der Boden trocknet, steigt der Widerstand des Sensors und die Spannung am analogen Anschluss von Arduino steigt an. Durch Erfassen einer Spannungsänderung kann das Auftreten einer Flüssigkeit erfasst werden. Anstelle von zwei Kontakten wurde 6 verwendet, um den Flüssigkeitsstand in meinem Projekt zu bestimmen. Einer davon ist mit dem 5-V-Ausgang verbunden, der Rest mit den Analogeingängen und 10-kΩ-Widerständen mit GND. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sind Fotos der Tests. </font></font><br>
<br>
<img src="https://habrastorage.org/files/43c/536/5fd/43c5365fd8464326bf5b4eee5bfbe806.jpg"><br>
<img src="https://habrastorage.org/files/c99/d28/fee/c99d28fee740489a9b3893e4f9fdd418.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier ist der Füllstandsensor das Ergebnis.</font></font><br>
<br>
<img src="https://habrastorage.org/files/b1e/2bb/10d/b1e2bb10db5f4e7ea647a746bc7e039c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das nächste, was ich getestet habe, ist die Echtzeituhr. </font><font style="vertical-align: inherit;">Aber mit ihnen zu arbeiten ist grundsätzlich einfach. </font><font style="vertical-align: inherit;">Um die Zeit einzustellen und Informationen darüber zu erhalten, habe ich ausschließlich Beispiele aus der Bibliothek für die Arbeit mit DS1307 verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als alles auf einem Steckbrett montiert war, hatten wir eine solche Kreuzung zwischen Drähten und Modulen. </font><font style="vertical-align: inherit;">Auf diesen Fotos befindet sich übrigens ein weiterer Temperatursensor.</font></font><br>
<br>
<img src="https://habrastorage.org/files/2f9/74d/288/2f974d288e8b43b0ab3612641a985f0e.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erste Schritte</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jetzt musste alles auf die Leiterplatte gelötet werden. </font><font style="vertical-align: inherit;">Es gibt nichts Besonderes zu kommentieren, also nur ein Foto. </font><font style="vertical-align: inherit;">Wie Sie sehen, wurde eine weitere Taste hinzugefügt, mit der Sie den Wasserkocher nicht nur von einem Smartphone aus, sondern auch auf die übliche Weise einschalten können. </font></font><br>
<br>
<img src="https://habrastorage.org/files/98a/ad1/920/98aad19203204e46a644e52c9f905af0.jpg"><br>
<img src="https://habrastorage.org/files/995/592/45e/99559245edb048699172208c2584b689.jpg"><br>
<img src="https://habrastorage.org/files/2dd/594/23c/2dd59423cb0a447295593b52da781dd5.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes müssen Sie alles in den Wasserkocher stellen. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9cb/50e/bf8/9cb50ebf8d05486babe76682ce68fddf.jpg"><br>
<img src="https://habrastorage.org/files/39d/b11/53b/39db1153b86c4592862b1b2f66531252.jpg"><br>
<img src="https://habrastorage.org/files/605/7db/1e6/6057db1e6ead493c81d399e164b399d4.jpg"><br>
<img src="https://habrastorage.org/files/853/6fc/00e/8536fc00ead6460ab5e581029bbdaf64.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein Asbesteinsatz wurde hinzugefügt, um alle Innenseiten vor Überhitzung zu schützen. </font></font><br>
<br>
<img src="https://habrastorage.org/files/027/99a/f36/02799af362264b6682b3355bae815b9c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zwar musste das Gehäuse mit einem zusätzlichen Kunststoffeinsatz leicht angehoben werden.</font></font><br>
<br>
<img src="https://habrastorage.org/files/ec3/06e/ab8/ec306eab83114666a94c62b33f9ce6f2.jpg"><br>
<img src="https://habrastorage.org/files/836/47b/9ac/83647b9ac23a43c7bd39ec57c4b2807c.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gehen Sie jetzt zum mobilen Teil.</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da die Anwendung unter dem Android-Betriebssystem entwickelt wurde, war ursprünglich die Verwendung von Android Studio geplant. Um neue Technologien zu untersuchen, wurde beschlossen, eine vorgefertigte Plattform für die Entwicklung von Programmen im Bereich des Internet der Dinge zu verwenden. Infolgedessen fiel die Wahl auf das Evothings-Produkt - Evothings Studio. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/74f/e14/7b1/74fe147b1a99d6a7fd6dd0b6a01ac2a2.png" alt="Bild"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier sind seine Hauptvorteile: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Eine große Anzahl von Standardbeispielen für die Arbeit mit verschiedenen Modulen (Wifi, Bluetooth); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Anwendungsentwicklung mit JS, HTML, CSS, mit der Sie einen Code schreiben können, der unter Android und iOS gleichermaßen funktioniert, d. H. Die Bindung an nur eine Plattform verschwindet.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Einfaches Testen der Anwendung: Auf dem Smartphone ist eine Anwendung installiert, um eine Vorschau ihrer Entwicklung anzuzeigen, und alle Testmeldungen und Fehlermeldungen werden im Programm auf dem Computer angezeigt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Eine große Menge an Informationen im Internet über die Entwicklung mit JS, HTML, CSS; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Evothings Studio gab es ein Beispiel für das Einschalten der LED durch Senden einer Einschaltanforderung über den ESP8266. Ich habe mich für dieses Beispiel entschieden, weil es für mich das Wertvollste war - die Kommunikation mit dem WiFi-Modul über eine TCP-Buchse. Und ähnlich wie die Anforderung zum Einschalten der LED übertragen wurde, habe ich eine Anforderung zum Aktualisieren der Sensoren des Wasserkochers, zum Einstellen der Einschaltzeit, zum Einstellen der Temperatur usw. gestellt.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann habe ich Benachrichtigungen über Bereitschaft und eine kleine Menge Wasser geschraubt, der Vorteil ist, dass alles in unserer Zeit leicht gegoogelt werden kann. </font><font style="vertical-align: inherit;">Das Ergebnis ist eine solche Anwendung (eine schöne Sache ist es, die Anwendungsoberfläche mit CSS zu erstellen):</font></font><br>
<br>
<img src="https://habrastorage.org/files/0b9/985/b2d/0b9985b2d0fb4c97bb36d4ebeb772ab6.jpg"><br>
<img src="https://habrastorage.org/files/431/aaa/445/431aaa44557d42de996527f587d8691f.jpg"><br>
<img src="https://habrastorage.org/files/e3a/f8d/fb1/e3af8dfb13764be2b2b9e9acbad28769.jpg"><br>
<img src="https://habrastorage.org/files/9c0/db4/c6e/9c0db4c6e1b44b0f86f725b5e75a265a.jpg"><br>
<img src="https://habrastorage.org/files/80a/7ff/90f/80a7ff90f43b46e197fdfc3594297e1a.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine kurze Beschreibung der Interaktion von Smartphone und Wasserkocher</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Kommunikation zwischen Server und Client erfolgt über das WiFi-Modul. Wenn Sie das Kettle-Steuermodul einschalten, beginnt das WiFi-Modul mit der Verteilung eines Netzwerks namens artKettle. Dies erfolgt über AT-Befehle auf der Serverseite. Um das Modul beispielsweise in den Access Point-Modus zu versetzen, muss es den Befehl AT + CWMODE = 2 senden. Als Nächstes müssen Sie mit diesen Befehlen Netzwerkparameter zuweisen, die Verbindung mehrerer Geräte zulassen und die IP-Adresse von WLAN selbst abrufen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der Clientseite erfolgt die Verbindung über einen bestimmten Port und über die IP-Adresse des WLAN-Moduls mit chrome.tcp.socket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nachdem Sie den Client mit dem Server verbunden haben, können Sie den Wasserkocher von Ihrem Smartphone aus steuern. Betrachten Sie das Beispiel des Einschaltens des Wasserkochers.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn Sie in der artKettle-Anwendung auf den Ein- / Ausschalter klicken, wird die entsprechende Funktion der Aufnahme von app.kettleOn () aufgerufen. </font><font style="vertical-align: inherit;">Innerhalb dieser Funktion werden zwei Zeilen auf die Serverseite übertragen:</font></font><br>
<br>
<pre><code class="cpp hljs">app.sendString(<span class="hljs-string"><span class="hljs-string">'H'</span></span>);<font></font>
app.sendString(<span class="hljs-string"><span class="hljs-string">'U'</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als nächstes kommt die Arbeit bereits auf der Seite von Arduino. </font><font style="vertical-align: inherit;">Nachdem die erste Zeile mit dem Zeichen 'H' eingetroffen ist, wird der folgende Code ausgeführt:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(message.indexOf(<span class="hljs-string"><span class="hljs-string">"H"</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; waterDetected())  {<font></font>
      digitalWrite(POWER_PIN, LOW); <font></font>
      IS_ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"ON"</span></span>);<font></font>
      sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>); <font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zunächst wird durch Aufrufen der Methode waterDetected () überprüft, ob sich Wasser im Wasserkocher befindet. </font><font style="vertical-align: inherit;">Ziehen Sie die Option in Betracht, wenn sich Wasser im Wasserkocher befindet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein niedriger Spannungspegel wird an den Steuerstift des Relais angelegt, was seinem Einschluss entspricht, d.h. </font><font style="vertical-align: inherit;">Stromkreis schließt:</font></font><br>
<pre><code class="cpp hljs">digitalWrite(POWER_PIN, LOW); 
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann wird das Flag gesetzt, um anzuzeigen, dass der Wasserkocher eingeschaltet ist, und eine Meldung am Ausgang des Monitors für die serielle Schnittstelle wird angezeigt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach wird eine Funktion aufgerufen, die eine Antwortnachricht an die Client-Seite sendet, dass die gesamte Aufnahme erfolgreich war:</font></font><br>
<br>
<pre><code class="cpp hljs">sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf der Clientseite wird nach dem Überprüfen der eingehenden Nachricht der Netzschalter auf den Status Ein gesetzt:</font></font><br>
<pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buf.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) == <span class="hljs-string"><span class="hljs-string">"ON"</span></span>) {<font></font>
	app.setButtonOn();<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Danach wird die Textnachricht mit dem Zeichen 'U' verarbeitet, das vom Client an den Server gesendet wird. </font><font style="vertical-align: inherit;">In ähnlicher Weise wie beim Einschluss werden hier Informationen über die aktuelle Temperatur und das aktuelle Flüssigkeitsvolumen im Kessel aktualisiert. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somit ist die bidirektionale Kommunikation zwischen dem Client und dem Server so organisiert, dass jeder von ihnen zu einem bestimmten Zeitpunkt den Status des anderen kennt.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fazit</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als Ergebnis des Kursprojekts wurde eine Modifikation für einen herkömmlichen Wasserkocher entwickelt, mit der er von einem Smartphone über WLAN gesteuert werden kann. Jetzt kann diese Teekanne den Vertretern des Internet der Dinge zugeschrieben werden. Wir haben es geschafft, alle Funktionen vollständig zu implementieren. Daher verfügt dieser Wasserkocher nun über die folgenden Funktionen: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Ein- und Ausschalten über ein Smartphone; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Einstellen einer beliebigen Temperatur zum Erhitzen von Wasser; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - die Fähigkeit, die aktuelle Temperatur herauszufinden; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Verfolgung des aktuellen Wasservolumens im Wasserkocher; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Warnung und Schutz gegen Einschalten mit wenig Wasser; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Einstellen der Einschaltzeit; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Benachrichtigung über die Bereitschaft;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Vorteile des implementierten Projekts sind die Zugänglichkeit der Elementbasis, da alles, was Sie benötigen, in Geschäften für elektronische Komponenten zu finden ist, die Erweiterbarkeit des Projekts. Da im Wasserkocher alle erforderlichen Sensoren installiert sind, kann er programmgesteuert geändert und nicht schlechter als Analoga gemacht werden. Angesichts der Vielseitigkeit des verwendeten WLAN-Moduls können Sie es mit dem Internet verbinden und die Steuerung des Wasserkochers organisieren. Sie können sich überall auf der Welt befinden und mithilfe des Onlinedienstes für die Verarbeitung von SMS-Nachrichten die Aufnahme per SMS organisieren. Das heißt, Das Projekt ist immer noch sehr erweiterbar, es gibt Möglichkeiten dafür, aber sie wurden nicht umgesetzt, da sie nicht Teil der Ziele des zu entwickelnden Projekts waren.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Projekt hat natürlich auch Nachteile. </font><font style="vertical-align: inherit;">Der erste ist der instabile Betrieb des Wifi-Moduls. </font><font style="vertical-align: inherit;">Ein Modul verliert manchmal nur sein Netzwerk, setzt die Einstellungen zurück oder verarbeitet eingehende Signale einfach nicht. </font><font style="vertical-align: inherit;">Darüber hinaus sind dies beliebte Probleme bei Benutzern dieses Moduls. </font><font style="vertical-align: inherit;">Der zweite Nachteil ist das Fehlen einer mechanischen Abschaltung des Kessels. </font><font style="vertical-align: inherit;">Das Herunterfahren ist in der Software implementiert. Wenn der Siedepunkt erreicht ist, bricht der Stromkreis mit Hilfe eines Relais. </font><font style="vertical-align: inherit;">Wenn das Programm plötzlich abstürzt, schaltet sich der Wasserkocher möglicherweise nicht aus. </font><font style="vertical-align: inherit;">Der dritte Nachteil ist das Problem der Überwachung der Heiztemperatur. </font><font style="vertical-align: inherit;">Wenn Sie beispielsweise den Wasserkocher bei einer Temperatur von 60 Grad ausschalten, gibt die Heizung 10 weiterhin Wärme ab, und nach einer Weile beträgt die Wassertemperatur bereits etwa 70 Grad. </font><font style="vertical-align: inherit;">Dies wird jedoch durch Anpassungen am Programm korrigiert.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de393785/">https://habr.com/ru/post/de393785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de393775/index.html">Delfine entdeckten die Grundlagen der Sprachkommunikation</a></li>
<li><a href="../de393777/index.html">Passage von Merkur auf der Sonne - Foto und Video</a></li>
<li><a href="../de393779/index.html">Die VAE planen, künstliche Berge zu schaffen, um die Niederschlagsmenge zu erhöhen</a></li>
<li><a href="../de393781/index.html">Wissenschaftler von NUST "MISiS" haben das Scheitern der klassischen Theorie der Erdstruktur bewiesen</a></li>
<li><a href="../de393783/index.html">Die Basis der Sonnen- und Mondfinsternisse von -1999 bis +3000 Jahren</a></li>
<li><a href="../de393787/index.html">Wie man Kernreaktoren repariert</a></li>
<li><a href="../de393791/index.html">Schweizer Stadt darf Stromrechnungen in Bitcoins bezahlen</a></li>
<li><a href="../de393795/index.html">Aufgrund der globalen Erwärmung werden Teile des Nahen Ostens und Nordafrikas unbewohnbar</a></li>
<li><a href="../de393797/index.html">Die Vorbestellungen für die Pyra-Spielekonsole wurden gestartet</a></li>
<li><a href="../de393799/index.html">Mit Amazon Echo zeigte der Tesla-Besitzer, wie einfach es ist, ein Auto zum Verlassen der Garage zu bringen.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>