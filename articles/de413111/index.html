<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•¢ üë®üèº‚Äçüåæ üßõüèº STM32 + NetBeans =? üë®‚Äçüë®‚Äçüëß‚Äçüë¶ ‚ôíÔ∏è ü§úüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie Sie wissen, eignet sich die Kompatibilit√§t mit GNU-Tools und die Unterst√ºtzung von GDB f√ºr nahezu jede beliebte Entwicklungsumgebung zum Debuggen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>STM32 + NetBeans =?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413111/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/ip/g9/vp/ipg9vp8f1dw4qq31hrwfvxyuvza.png" alt="Langweiliges Logo"></div><br>  Wie Sie wissen, eignet sich die Kompatibilit√§t mit GNU-Tools und die Unterst√ºtzung von GDB f√ºr nahezu jede beliebte Entwicklungsumgebung zum Debuggen einer Vielzahl eingebetteter Plattformen, meistens kostenlos und legal.  In der Theorie. <br><br>  Was passiert in der Praxis, wenn versucht wird, sich mit STM32 und NetBeans anzufreunden, und ist es im Prinzip m√∂glich, ein funktionsf√§higes System mit Unterst√ºtzung f√ºr die neuesten Steine ‚Äã‚Äãzu erhalten - unter dem Schnitt. <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  Ja  Aber nein. </div></div><a name="habracut"></a><br><h2>  Einige Texte </h2><br>  Ich wollte den Mikrochip wirklich nicht verlassen.  Nach dem Kauf durch Atmela vertuschten sie jedoch zun√§chst m√∂glicherweise eine der vielversprechendsten Familien im Portfolio des Unternehmens - PIC32MM und dann die gesamte MIPS-Linie.  Es wurde deutlich, dass der √úbergang zu ARM auf absehbare Zeit unvermeidlich ist, da der Mikrochip seit zwei Jahren die Unterst√ºtzung von Atmelovsk-Controllern nicht in sein √ñkosystem integriert hat und ‚ÄûStay with us‚Äú keine Vorteile brachte.  Im Gegenteil, die Preispolitik nach oben und die traditionellen organisatorischen Schwierigkeiten des Zusammenschlusses machten Atmelovskiye AWPs weniger attraktiv.  Gleichzeitig tauchte ein Projekt auf, √ºber das der PIC32MZ einfach gestolpert ist.  Eine kritische Masse wurde erreicht. <br><br>  Warum STM: breite Marktabdeckung, Budget-Debugging, eine kostenlose Open-Source-Umgebung mit vollem Funktionsumfang auf Basis von Open-Source-SW4STM32, der politische Aspekt - ST Microelectronics wird von der franz√∂sischen Regierung als strategische Ressource unterst√ºtzt, sodass ein pl√∂tzlicher Marktaustritt oder eine pl√∂tzliche √úbernahme anscheinend nicht gef√§hrdet sind. <br><br><h2>  Debugging - Erste Eindr√ºcke </h2><br>  SW4STM32 wurde auf herk√∂mmliche Weise installiert - durch wiederholtes Dr√ºcken der Schaltfl√§che Weiter&gt; (* im Folgenden finden alle Experimente unter Win7 x64 statt).  Ein Demo-Projekt, das zum Testen der gew√ºnschten Funktion geeignet war, wurde aus dem STM32Cube-Firmware-Paket entfernt. Alles funktionierte mehr oder weniger sofort.  Der erste Start des JTAG-Emulators hinterlie√ü einen Eindruck: Der gesamte Zyklus des Aufrufen des Debug-Modus, beginnend mit der Verbindung und endend mit dem Stopp am Anfang von main () mit Aktualisierung des Kontexts, kann in 1-2 Sekunden passen.  Im Vergleich zu Mikrochip-Debuggern (sogar REAL ICE f√ºr eine halbe H√§lfte) ist der Geschwindigkeitsunterschied ein Vielfaches! <br>  Und doch etwas unangenehm √úberraschtes. <br><br><h2>  Was ist los mit Eclipse / SW4STM32 </h2><br>  Eine Vielzahl von Einstellungen und unlogischer Organisation, versteckte Men√ºelemente, Perspektiven, Schnittstellenfehler und visuelle Artefakte, fehlende h√§ufig verwendete Tasten und Funktionen in der Symbolleiste, kleine ungeschickte, unlesbare Piktogramme und Markierungen sowie das Fehlen von ‚ÄûVerwendungen finden‚Äú sind teilweise subjektiv, und Sie k√∂nnen sie anpassen, wenn Sie dies w√ºnschen .  Aber: vergisst regelm√§√üig, die ge√§nderten Dateien vor dem Zusammenbau zu speichern, obwohl alle H√§kchen bei Bedarf vorhanden sind;  Beim erzwungenen manuellen Speichern werden keine √Ñnderungen angezeigt, und die inkrementelle Baugruppe erweist sich als irrelevant.  Es gibt keine vollst√§ndige Neuerstellung (Clean and Build) als einzelnes Team. Nach der erzwungenen Bereinigung durch Clean Project schl√§gt die Assembly fehl (Dateizugriff?) und wird erst nach dem 4. Versuch erfolgreich abgeschlossen. Dies kann nicht mehr angemessen erkl√§rt werden.  Selbst die fr√ºhen MPLAB X Beta-Versionen, die auf den alten NetBeans 6.xx basieren, hatten vor 10 Jahren nicht die gleichen Probleme wie die offiziell unterst√ºtzte Entwicklungsumgebung f√ºr STM32 heute. <br><br>  Dar√ºber hinaus sind mit SW4STM32 bereits 3 Kopien typischer IDEs im System gew√§hlt, da au√üerdem MPLAB X noch fest mit NetBeans 8.0.1 verbunden und etwas eingez√§unt ist (d. H. Es ist unm√∂glich, es f√ºr andere Sprachen / Plattformen zu verwenden). und NetBeans 8.2 f√ºr Java und C / C ++. <br><br>  Es stellt sich heraus, dass durch das Einrichten von NetBeans 8.2 f√ºr STM32 die beschriebenen praktischen Probleme von Eclipse beseitigt, die Anzahl der IDE-Kopien verringert und auf eine Plattform reduziert werden, wenn auch geringf√ºgig andere Versionen. <br><br><h2>  NetBeans 8.2 und GNU ARM Tools </h2><br>  NetBeans ist besser f√ºr die Verwendung von 32-Bit geeignet, da zus√§tzlich zum doppelten Speicherverbrauch die Unterschiede der 64-Bit-Version nicht gefunden werden konnten. <br><br>  Google fand schnell eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Installationsanleitung</a> .  Der grundlegende Unterschied bestand nur im Betriebssystem (sie haben Linux gegen Win7 x64 f√ºr mich), so dass die Installation der * nix-Umgebung MSYS, die Teil des MinGW-Pakets ist, zu einem Gewinnspiel wurde.  Die Toolchain-Einstellungen sollten ungef√§hr so ‚Äã‚Äãaussehen: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pa/at/55/paat55hytkpcafquqmaeouhiork.png" alt="nb-toolchain"></div><br>  Ein wichtiger Punkt: W√§hlen Sie beim Hinzuf√ºgen der GNU ARM-Toolchain die Familie ‚ÄûGNU MinGW‚Äú aus. In diesem Fall ruft NetBeans MSYS korrekt auf.  Wenn Cygwin bereits auf dem Computer installiert ist, ist es logisch, es zu verwenden. Dementsprechend sollte die GNU ARM-Familie ‚ÄûGNU Cygwin‚Äú ausw√§hlen. <br><br>  Eine erfolgreiche Zusammenstellung zu erreichen war nicht einfach, aber sehr einfach.  Da SW4STM32 denselben Compiler verwendet, √ºberpr√ºfen Sie die Befehlszeile des Compileraufrufs in SW4STM32 und kopieren Sie die fehlenden Schl√ºssel in Projekteigenschaften ‚Üí C-Compiler ‚Üí Zus√§tzliche Optionen <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ch/l1/9d/chl19dfpmn67u7v2qcpyqrieoeu.png" alt="nb-compiler"></div><br>  Wir erhalten genau das gleiche Ausgabeergebnis, aber mit einem wichtigen praktischen Unterschied: Alles wird beim ersten Mal gesammelt, es gibt Clean and Build und es funktioniert einwandfrei: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xy/p8/aa/xyp8aacaqx7cik38y4mqzhlbxlc.png" alt="nb-build1"></div><br>  Dieses Ergebnis kann jedoch auch durch Hinzuf√ºgen der optionalen Post-Build-Verarbeitung verbessert werden.  √ñffnen Sie das Makefile und f√ºgen Sie im Abschnitt .build-post: .build-impl Folgendes hinzu: <br><br><pre><code class="hljs powershell">.build<span class="hljs-literal"><span class="hljs-literal">-post</span></span>: .build<span class="hljs-literal"><span class="hljs-literal">-impl</span></span> cp <span class="hljs-variable"><span class="hljs-variable">$</span></span>{CND_DISTDIR}/<span class="hljs-variable"><span class="hljs-variable">$</span></span>{CONF}/<span class="hljs-variable"><span class="hljs-variable">$</span></span>{CND_ARTIFACT_NAME_<span class="hljs-variable"><span class="hljs-variable">$</span></span>{CONF}} <span class="hljs-variable"><span class="hljs-variable">$</span></span>{CND_ARTIFACT_NAME_<span class="hljs-variable"><span class="hljs-variable">$</span></span>{CONF}} arm<span class="hljs-literal"><span class="hljs-literal">-none</span></span><span class="hljs-literal"><span class="hljs-literal">-eabi</span></span><span class="hljs-literal"><span class="hljs-literal">-objcopy</span></span> <span class="hljs-literal"><span class="hljs-literal">-O</span></span> ihex <span class="hljs-variable"><span class="hljs-variable">$</span></span>{CND_ARTIFACT_NAME_<span class="hljs-variable"><span class="hljs-variable">$</span></span>{CONF}} <span class="hljs-variable"><span class="hljs-variable">$</span></span>{CND_ARTIFACT_NAME_<span class="hljs-variable"><span class="hljs-variable">$</span></span>{CONF}}.hex arm<span class="hljs-literal"><span class="hljs-literal">-none</span></span><span class="hljs-literal"><span class="hljs-literal">-eabi</span></span><span class="hljs-literal"><span class="hljs-literal">-size</span></span> <span class="hljs-variable"><span class="hljs-variable">$</span></span>{CND_ARTIFACT_NAME_<span class="hljs-variable"><span class="hljs-variable">$</span></span>{CONF}}</code> </pre> <br>  (wichtig - der Einzug muss ein einzelnes Tabulatorzeichen sein, keine Leerzeichen) <br>  Zeile f√ºr Zeile: 1 - Kopiert die Objektdatei (.elf) aus dem Ausgabeordner in das Stammverzeichnis des Projekts, um den Zugriff zu erleichtern.  2 - erzeugt HEX aus Elf (kann auskommentiert werden, wenn HEX nicht ben√∂tigt wird);  3 - Zeigt die Menge des belegten Speichers nach Segmenten an. <br><br>  Das Endergebnis: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6e/eb/u3/6eebu3andr0dd6zfgqh869chw7s.png" alt="nb-build2"></div><br>  So weit so gut. <br><br><h2>  OpenOCD - die ersten Schwierigkeiten </h2><br>  In den oben genannten Online-Handb√ºchern ist die Programmierung eines Chips √ºber OpenOCD einfach und routinem√§√üig.  Die neueste Version (0.10.0) wird installiert, die Konfigurationsdatei wird entnommen (aus dem OpenOCD-Kit oder aus dem Projektordner SW4STM32), ein Befehl des Formulars wird in Projekteigenschaften ‚Üí Ausf√ºhren geschrieben: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x-/6a/5b/x-6a5bkmgaxhecmza5flej2x-iy.png" alt="nb-run"></div><br>  und alles funktioniert sofort.  Dies ist zwar bei j√ºngeren Familien wie STM32F103 und F407 der Fall, aber ich interessiere mich f√ºr F7 und H7.  Mit der ersten Version st√ºrzt die offizielle Version von OpenOCD 0.10.0 mit den Fehlern "auto_probe failed" und "undefined debug reason 7" ab.  Letztere werden √ºberhaupt nicht unterst√ºtzt.  Wir haben alle verf√ºgbaren offiziellen Baugruppen 0.10.0 von Januar 2017 bis Januar 2018 ausprobiert - das Ergebnis ist identisch.  Eine Stichwortsuche best√§tigt die Existenz des Problems, obwohl Sie es nicht als massiv bezeichnen k√∂nnen.  Es gibt keine Analyse und L√∂sung. <br><br>  Es gibt jedoch eine Version, die garantiert funktioniert - aus dem SW4STM32-Kit.  Nat√ºrlich stellt sich heraus, dass es durch neue Skripte und Unterst√ºtzung f√ºr die H7-Familie verbessert und erg√§nzt wird.  Au√üerdem wurde die Dateistruktur darin ge√§ndert, und im Plug-In werden die Ressourcen in einem separaten Modul gespeichert. Damit das in einem einzelnen Ordner konsolidierte Dienstprogramm seine Skripte sehen kann, war der Schalter -s erforderlich. <br><br>  Board.cfg f√ºr NUCLEO-F767ZI, ohne Kommentare und komprimiert: <br><br><pre> <code class="hljs powershell">set CHIPNAME STM32F767ZITx source [<span class="hljs-type"><span class="hljs-type">find</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span><span class="hljs-type"><span class="hljs-type">erface</span></span>/<span class="hljs-type"><span class="hljs-type">stlink</span></span>-<span class="hljs-type"><span class="hljs-type">v2</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-type"><span class="hljs-type">.cfg</span></span>] transport select hla_swd source [<span class="hljs-type"><span class="hljs-type">find</span></span> <span class="hljs-type"><span class="hljs-type">target</span></span>/<span class="hljs-type"><span class="hljs-type">stm32f7x.cfg</span></span>] set WORKAREASIZE <span class="hljs-number"><span class="hljs-number">0</span></span>x10000 set ENABLE_LOW_POWER <span class="hljs-number"><span class="hljs-number">1</span></span> set STOP_WATCHDOG <span class="hljs-number"><span class="hljs-number">1</span></span> reset_config srst_only srst_nogate connect_assert_srst set CONNECT_UNDER_RESET <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  Starten Sie schlie√ülich √ºber Run Main Project: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/oh/y-/j8/ohy-j8mnmadnqvq4zbcszplzchq.png" alt="nb-prog"></div><br>  Die Firmware ist erfolgreich, der Code wird ausgef√ºhrt. <br><br><h2>  Debuggen </h2><br>  Es wird angenommen, dass das Schema das traditionellste ist: NetBeans, ein lokaler GDB-Server unter OpenOCD, stellt √ºber localhost eine Verbindung her: 3333 √ºber TCP.  Dementsprechend ben√∂tigt NetBeans das Gdbserver-Plugin. <br><br>  Es ist m√∂glich, den Start von OpenOCD √ºber ein Bat-Skript zu vereinfachen. Da die Sitzung nach Abschluss der Sitzung an die Konsole gesendet wird, ist es sinnvoll, den Neustart endlos zu wiederholen: <br><br><pre> <code class="hljs pgsql">:<span class="hljs-keyword"><span class="hljs-keyword">start</span></span> openocd -f <span class="hljs-keyword"><span class="hljs-keyword">debug</span></span>.cfg -sd:/Prog/openocd/scripts goto <span class="hljs-keyword"><span class="hljs-keyword">start</span></span></code> </pre> <br>  Start: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/k-/dl/bzk-dlt4v3upg6tijzo16oiaodc.png" alt="oocd-debug"></div><br>  Die Version von SW4STM32 ist nicht explizit geschrieben, aber der Server wartet auf eine TCP-Verbindung zu Port 3333. W√§hlen Sie in NetBeans Debug ‚Üí Debugger anh√§ngen ... und installieren Sie: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/-k/t8/qk-kt8brsnjmi4m8os7gumqbdu4.png" alt="nb-attach"></div><br>  Die Sitzung ist aktiv.  OpenOCD-Terminal: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3-/uh/b6/3-uhb6p4mqszlfw9jqk6klyljtc.png" alt="oocd-debug"></div><br>  Im Aussehen sieht alles gut aus - die Debugging-Sitzung ist aktiv, der Code wird ausgef√ºhrt.  Das Problem besteht jedoch weiterhin. <br><br><h2>  Das Problem </h2><br>  Im Freilaufmodus kann die Ausf√ºhrung nicht gestoppt werden. <br><br>  Wenn Sie vor dem Starten der Sitzung einen Haltepunkt festlegen, wird beim Aufrufen des Debuggens die Aktualisierung des Kontexts beendet, die schrittweise Ausf√ºhrung und das Anzeigen / √Ñndern von Variablen funktionieren, dh im Prinzip alle grundlegenden Funktionen, die f√ºr das vollst√§ndige Debuggen erforderlich sind: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sq/s_/71/sqs_71pvec8ufdq6cln9cvbtfkm.png" alt="nb-debug"></div><br>  Aber nur bis zum n√§chsten freien Start, danach bleibt nur noch die Sitzung zu schlie√üen und neu zu starten. <br><br>  Eine weitere unangenehme Kleinigkeit ist mit Software-Haltepunkten verbunden: Die Funktion SYSTEM_Halt () ist als __asm__ ("bkpt") definiert, und ihre Operation f√ºhrt zur Anzeige eines unn√∂tigen Dialogs: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9h/fu/gb/9hfugbj1z9u2pyj1peffrzpfozq.png" alt="nb-sigtrap"></div><br>  Wenn Sie auf Verwerfen und Anhalten klicken, funktioniert dies wie erforderlich (dh es wird die Ausf√ºhrung gestoppt). Es ist jedoch nicht m√∂glich, diese Option standardm√§√üig festzulegen und die Fensteranzeige standardm√§√üig auszuschalten. <br><br>  Vor dem Heap m√∂chte ich den Start von OpenOCD automatisieren und den Debugger direkt √ºber NetBeans verbinden. <br><br>  Objektiv gesehen ist die einzige Funktion, die f√ºr ein mehr oder weniger vollst√§ndiges Debuggen nicht ausreicht, das Stoppen der Ausf√ºhrung (es ist auch erforderlich, einen Haltepunkt im laufenden Betrieb festzulegen). <br><br><h2>  Debuggen Debuggen </h2><br>  Eine Google-Suche ergab, dass √§hnliche Probleme mit NetBeans, die GDB stoppen, gestoppt wurden, aber vor einigen Jahren behoben wurden.  Mangels einer besseren Idee wurden NetBeans-Quellen heruntergeladen, in der Hoffnung, den Debugger live zu durchlaufen.  √úberraschenderweise gelang es uns, das Problem schnell zu lokalisieren, bevor wir das externe Dienstprogramm GdbKillProc.exe aufriefen, das im Wesentlichen ein Wrapper f√ºr DebugBreakProcess (pid) von WinAPI ist.  Das Prinzip des Dienstprogramms reduziert sich auf eine nicht st√∂rende Unterbrechung des Prozesses (analog zu "kill -SIGINT [pid]" unter * nix oder Strg + C in der Konsole). <br><br>  Aber sie arbeitet nicht. <br><br><h2>  Was wird getestet </h2><br>  Im Konsolenmodus reagiert der GDB-Client (arm-none-eabi-gdb.exe) korrekt auf Strg + C, dh er stoppt die Codeausf√ºhrung, ohne die Sitzung zu schlie√üen, und wartet auf weitere Anweisungen. <br><br>  ps -W und Windows Process Explorer zeigen den Prozess korrekt an und die PID stimmt mit der internen Variablen in NetBeans √ºberein. <br><br>  Der manuelle Aufruf von "kill -SIGINT [pid]" aus dem MSYS-Paket l√∂st den Fehler "Kein solcher Prozess" aus. <br><br>  Das Durchchecken von "taskkill / pid [pid]" ergibt "Der Prozess ... konnte nicht beendet werden ... Dieser Prozess kann nur mit Gewalt beendet werden ...", was auf eine Systemsperre hinweist.  Mit dem Schalter / f wird der Prozess vollst√§ndig geschlossen, was auch nicht gut ist. <br><br>  Dabei stellte sich heraus, dass unter Windows die Situation bei der Erzeugung von Interrupt-Signalen keine Rolle spielt oder vielmehr in keiner Weise: Standardm√§√üig wird nur das SIGTERM-Analogon unterst√ºtzt, was einer groben Verk√ºrzung des Prozesses entspricht, und es gibt keine allgemein akzeptierte L√∂sung. <br><br>  Im Internet wurde ein Windows-Kill-Dienstprogramm gefunden, das Strg + C und Strg + Brk emuliert.  Der Prozess findet, dass der Interrupt fehlerfrei sendet, aber der GDB-Client antwortet immer noch nicht. <br><br>  Die Experimente wurden mit allen 32-Bit-Versionen (NetBeans, ARM Tools, MSYS 1.0) durchgef√ºhrt, mit Ausnahme von Windows-Kill, das sich weigerte, 32-Bit zu starten ("... nicht richtig zu starten ...").  Vielleicht liegt das Problem genau darin, denn nach fragmentarischen Daten aus Foren und Bugtrackern sollten die Bittiefe des Dienstprogramms und des Prozesses zusammenfallen.  Die Schwierigkeit hierbei ist, dass ARM die x64-Version der Toolchain f√ºr Windows nicht anbietet. Die einzige M√∂glichkeit, die Heterogenit√§t zu beseitigen, besteht darin, die x32-Version von Windows-Kill zum Laufen zu bringen, was auch nicht klar ist, ob dies unter Win x64 im Prinzip m√∂glich ist. <br><br>  In der Mitte des Prozesses wurde das Betriebssystem von Grund auf neu installiert, und es wurden keine √Ñnderungen im Verhalten der Versuchspersonen festgestellt, auch wenn mit gro√üer Sicherheit die Merkmale eines bestimmten Systems beseitigt werden k√∂nnen. <br><br><h2>  Hallenhilfe erforderlich </h2><br>  Tats√§chlich kann alles oben Genannte als Einf√ºhrung in diesen Absatz betrachtet werden. <br>  Der letzte Schritt besteht darin, das STM32-Debugging unter NetBeans real zu machen: <br><br>  <i>erfordert einen funktionierenden Softwaremechanismus zum Senden des SIGINT-Interrupt-Signals (Strg + C) an den Windows GDB-Client-Prozess</i> <br><br>  Im Folgenden finden Sie eine Empfehlung zum Festlegen der Mindestkonfiguration, die ausreicht, um das oben genannte Problem zu √ºberpr√ºfen / zu debuggen.  Wenn / wann es behoben werden kann, wird der Artikel in einer einfachen Schritt-f√ºr-Schritt-Anleitung zum Konfigurieren von NetBeans + OpenOCD f√ºr mehrere verschiedene Familien und Debug-Boards wiederholt.  Weitere Funktionen k√∂nnen nach Belieben ausgef√ºhrt werden, da bereits eine funktionsf√§hige Basisl√∂sung vorhanden ist. <br><br><h2>  Testaufbau </h2><br>  Es wird vorgeschlagen, das Blue Pill Board basierend auf dem STM32F103C8T6 und dem Klon ST-Link V2 als Hardwareplattform zu verwenden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8g/m5/5r/8gm55r80dnmbhba7vr90piemhc0.png" alt="blaue Pille"></div><br>  Es ist notwendig: <br><br>  1. Installieren Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GNU Arm Embedded Toolchain</a> <br><br>  2. Installieren Sie OpenOCD 0.10.0 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Build unter Win</a> ) <br><br>  3. Registrieren Sie die Bin-Ordner beider Pakete in PATH (Systemsteuerung ‚Üí System ‚Üí Erweiterte Systemeinstellungen ‚Üí Umgebungsvariablen ... ‚Üí Pfad). <br><br>  4. Kopieren Sie den Inhalt an einem geeigneten Ort zum Erstellen der Datei board.cfg: <br><br><pre> <code class="hljs powershell">source [<span class="hljs-type"><span class="hljs-type">find</span></span> <span class="hljs-built_in"><span class="hljs-built_in">int</span></span><span class="hljs-type"><span class="hljs-type">erface</span></span>/<span class="hljs-type"><span class="hljs-type">stlink</span></span>-<span class="hljs-type"><span class="hljs-type">v2.cfg</span></span>] source [<span class="hljs-type"><span class="hljs-type">find</span></span> <span class="hljs-type"><span class="hljs-type">target</span></span>/<span class="hljs-type"><span class="hljs-type">stm32f1x.cfg</span></span>] transport select <span class="hljs-string"><span class="hljs-string">"hla_swd"</span></span> reset_config none separate set WORKAREASIZE <span class="hljs-number"><span class="hljs-number">0</span></span>x5000 set CHIPNAME STM32F103C8T6 set ENABLE_LOW_POWER <span class="hljs-number"><span class="hljs-number">1</span></span> set STOP_WATCHDOG <span class="hljs-number"><span class="hljs-number">1</span></span> set CLOCK_FREQ <span class="hljs-number"><span class="hljs-number">4000</span></span> set CONNECT_UNDER_RESET <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  5. W√§hlen Sie die entsprechende Test-Firmware (test.elf). Das Hauptkriterium ist, dass Ausf√ºhrung und Stopp klar voneinander zu unterscheiden sind.  Kopieren Sie an einen geeigneten Ort. <br><br>  6. Von einem geeigneten Ort aus, um die Platine zu flashen: <br><br> <code>openocd -f board.cfg -c "program test.elf verify reset exit"</code> <br> <br>  Die Firmware sollte starten.  Beispielausgabe von OpenOCD an die Konsole: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ye/4s/iv/ye4sivaywyegu12-xjodmnhntdw.png" alt="oocd-prog"></div><br>  7. Starten Sie den OpenOCD GDB-Server von einem geeigneten Ort aus: <br><br> <code>openocd -f board.cfg</code> <br> <br>  Der Code wird noch ausgef√ºhrt.  Beispielausgabe (Konsole bleibt von OpenOCD gesperrt): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eo/ku/hd/eokuhd9oajy5kea8tz_dzcfwhq8.png" alt="oocd-debug"></div><br>  8. F√ºhren Sie in einer anderen Konsole oder direkt arm-none-eabi-gdb.exe aus dem GNU ARM Embedded Toolchain-Paket aus und f√ºhren Sie die folgenden Befehle aus: <br><br>  <code>target extended-remote localhost:3333</code> (Code wird noch ausgef√ºhrt) <br>  <code>continue</code> (Code l√§uft, die Konsole ist gesperrt) <br>  <code>Ctrl+C</code> (Code gestoppt, Konsole aktiv) <br>  <code>continue</code> (l√§uft wieder, die Konsole ist gesperrt) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ye/4s/iv/ye4sivaywyegu12-xjodmnhntdw.png" alt="oocd-debug"></div><br>  Die Aufgabe besteht darin, den GDB-Client programmgesteuert aus dem Ausf√ºhrungsstatus zu entfernen (d. H. Im Wesentlichen Strg + C zu emulieren). <br><br>  Verwenden Sie zum Ermitteln der Prozess-ID "ps-W" aus der * nix-Umgebung oder den Windows-Prozess-Explorer (optional installiert). <br><br>  M√∂glicherweise wird jemand direkt nach der Ersteinrichtung von NetBeans korrekt debuggen - solche Informationen sind auch n√ºtzlich, insbesondere mit einer detaillierten Beschreibung des Systems und m√∂glicher Funktionen. <br><br>  Bitte teilen Sie Ideen in den Kommentaren mit, und ich hoffe, dass wir durch die Zusammenarbeit ein mutiges Experiment in einen n√ºtzlichen Leitfaden f√ºr die Einrichtung eines noch n√ºtzlicheren Tools verwandeln k√∂nnen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413111/">https://habr.com/ru/post/de413111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413101/index.html">STM32F4 Debug Board im Raspberry Pi Formfaktor</a></li>
<li><a href="../de413103/index.html">3CX v15.5 Update 5 Beta und REST-Integration mit AmoCRM ver√∂ffentlicht</a></li>
<li><a href="../de413105/index.html">Hinweise des IoT-Anbieters. Aktivierung und Sicherheit in LoraWAN</a></li>
<li><a href="../de413107/index.html">√úbersetzung des Svelto.ECS-Projekt-Wikis. ECS-Framework f√ºr Unity3D</a></li>
<li><a href="../de413109/index.html">So erstellen Sie eine SaaS-Produktintegrationsplattform: Poster Cloud Checkout Experience</a></li>
<li><a href="../de413113/index.html">Klasse JavaScript Unterst√ºtzung der JavaScript-Serialisierung</a></li>
<li><a href="../de413117/index.html">So programmieren Sie sicher in Bash</a></li>
<li><a href="../de413119/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends f√ºr die letzte Woche Nr. 317 (28. Mai - 3. Juni 2018)</a></li>
<li><a href="../de413121/index.html">Fototour von Moskau Coworking #tceh</a></li>
<li><a href="../de413123/index.html">JETZT in NoSQL-Datenbanken</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>