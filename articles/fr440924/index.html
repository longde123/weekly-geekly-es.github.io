<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∂üèΩ üë®üèª‚ÄçüöÄ ü§πüèæ Historique de la deuxi√®me place de la Coupe AI russe 2018: CodeBall üç∞ üë≤üèæ üîª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! 

 Je suis un √©tudiant de troisi√®me ann√©e et au tout d√©but de mes √©tudes √† l'universit√©, j'ai d√©couvert la Coupe Ai russe , puis la Co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Historique de la deuxi√®me place de la Coupe AI russe 2018: CodeBall</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/440924/"><img src="https://habrastorage.org/webt/af/ae/ow/afaeownubljxqa1m35toussj7si.jpeg" align="left" width="220">  Bonjour √† tous! <br><br>  Je suis un √©tudiant de troisi√®me ann√©e et au tout d√©but de mes √©tudes √† l'universit√©, j'ai d√©couvert la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Coupe Ai russe</a> , puis la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Coupe Mini Ai</a> , les comp√©titions d'intelligence artificielle, et j'ai commenc√© √† y participer activement, montrant de bons r√©sultats.  Cette fois, l'IRAC est tomb√© dans la s√©ance, donc rien ne pouvait m'arr√™ter :) Et aujourd'hui, je veux vous dire comment j'ai r√©ussi √† prendre la deuxi√®me place. <br><br>  Les r√®gles du concours peuvent √™tre consult√©es sur le site Web du concours, ainsi que dans cet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> .  Lien vers mon profil: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">russianaicup.ru/profile/TonyK</a> . <br><a name="habracut"></a><br>  D'une part, la t√¢che de cette ann√©e √©tait similaire √† celle des ann√©es pass√©es, et il semblait que la solution id√©ologique serait tr√®s similaire aux pr√©c√©dentes (Agar IO et Mad Cars);  apr√®s environ une semaine, je vais m'ennuyer et me lasser de participer. <br><br>  D'un autre c√¥t√©, j'ai compris que j'avais beaucoup appris lors des pr√©c√©dentes comp√©titions de physique et maintenant je peux appliquer cette exp√©rience, pas marcher sur l'ancien r√¢teau et, au final, montrer un meilleur r√©sultat. <br><br>  En ce qui concerne la visualisation, j'ai d√©cid√© que j'aurais suffisamment de projections sur diff√©rents axes ou que j'afficherais sous un certain angle.  Mais je me suis tromp√©, et sans le visualiseur magique int√©gr√© √† Local Runner, que les organisateurs ont ajout√© plus tard, je devrais emprunter des visualiseurs 3D aux aimables participants qui ont pass√© la phase de test b√™ta √† les √©crire et √† les mettre dans le domaine public. <br><br>  Cette fois, le pseudo-code du simulateur √©tait disponible, qui √©galisait les possibilit√©s de ceux qui savaient comment inverser la physique et √©crire un bot cool, et ceux qui ne pouvaient pas inverser la physique, mais qui pouvaient √©galement √©crire un bot fort.  Je pense que c'√©tait une bonne d√©cision de la part des organisateurs. <br><br>  La premi√®re chose que j'ai faite a √©t√© de r√©√©crire le code du simulateur √† partir de la documentation en C ++, puis de mesurer le temps du simulateur sur mon ancien ordinateur et sur le serveur.  Dans le deuxi√®me cas, cela s'est av√©r√© deux fois plus rapide, bien que ce soit pr√©vu.  J'ai pens√© combien de fois et √† quelle profondeur je pouvais simuler.  Il est imm√©diatement devenu √©vident qu'il fallait oublier la simulation honn√™te de 100 microtiques (sur le serveur, une tique de la physique √©tait divis√©e en 100 "microtiques"), et il faudrait r√©soudre les probl√®mes avec pr√©cision de mani√®re d√©tourn√©e. <br><br>  Du fait que le shell a √©t√© organis√© de mani√®re √† ce que la demande d'action pour chaque robot soit appel√©e s√©par√©ment √† chaque tick, j'ai impl√©ment√© une logique simple: au moment o√π le premier robot est sollicit√© pour une action, le programme recherche des actions pour tous les robots, se souvient et donne l'action du premier, et quand l'action est demand√©e au reste des robots, elle rend ce dont elle s'est souvenue. <br><br>  J'√©tais impatient d'envoyer bient√¥t le bot au combat.  J'ai d√©cid√© de g√©n√©rer des trajectoires al√©atoires et de choisir la meilleure.  En m√™me temps, il voulait que l'ensemble g√©n√©r√© permette d'effectuer des actions complexes, par exemple, faire le tour du ballon du c√¥t√© droit, puis frapper. <br><br>  Une trajectoire est un plan d'action.  Au d√©part, la trajectoire √©tait la suivante: <br><br><ul><li>  d√©finir l'action sous un angle al√©atoire; </li><li>  sur un tick al√©atoire de la trajectoire, changez l'angle pour un autre al√©atoire; </li><li>  sauter une fois dans un tick al√©atoire de la trajectoire. </li></ul><br>  Un tel espace de trajectoires √©tait un bon ajustement pour une recherche al√©atoire avec le nombre de simulations que je (et, probablement, tout le monde √† l'√©poque) pouvais me permettre avec le simulateur brut de la documentation.  De bonnes trajectoires √©taient souvent devin√©es, et comme la meilleure trajectoire de la tique pr√©c√©dente √©tait pr√©serv√©e, la recherche s'est av√©r√©e √©tir√©e dans le temps. <br><br>  Tous les objets ont √©t√© plac√©s dans le simulateur: mes robots, les robots de l'adversaire et la balle.  L'√©valuation √©tait la plus simple: la somme des distances du ballon au but ennemi √† tous les points de la trajectoire et les grandes valeurs du but √† quelqu'un.  Profondeur de simulation 200 ticks.  Les ennemis sont pr√©dits √† leur derni√®re vitesse. <br><br><img src="https://habrastorage.org/webt/6p/n1/-f/6pn1-ft3htl0ohqjsqkcb3dvcfm.png"><br><br>  J'ai imm√©diatement ajout√© une action distincte pour le deuxi√®me robot, ainsi que l'annulation forc√©e du saut, si pendant le vol il n'y avait pas de contact avec le ballon, afin de ne pas sauter en vain.  En m√™me temps, mes robots ont pris plus de la moiti√© du temps et connaissaient la meilleure trajectoire l'un de l'autre.  Maintenant, les premiers <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">buts</a> ont commenc√© pour des adversaires forts, qui avaient d√©j√† un gardien de but et une logique plus compliqu√©e. <br><br>  Il s'est av√©r√© en outre que je ne consid√©rais pas la distance aux portes ennemies, mais jusqu'au point du c√¥t√© du centre du champ (m√©lang√© <code>x</code> et <code>z</code> ), mais cela n'affectait en rien la strat√©gie.  C'est bien qu'apr√®s la correction √ßa n'ait pas empir√©.  Cela se produit souvent lorsque vous √©crivez un bot. <br><br>  Puis il a ajout√© le gardien de but en modifiant le score: il m'a inflig√© une p√©nalit√© pour le ballon dans ma moiti√© de terrain et pour le but, et a √©galement estim√© la distance du gardien de but √† mon but.  Maintenant, le gardien de but se tenait au but et a frapp√© le ballon.  Une optimisation importante a √©t√© que si le ballon n'est pas dans ma moiti√© de terrain, alors 90% du temps est donn√© √† l'attaquant et 10% au gardien de but, sinon 50%. <br><br>  L'√©valuation des trajectoires des robots en chaque point a √©t√© multipli√©e par 0,9 ^ de profondeur, j'ai d√©riv√© ce coefficient de mani√®re empirique, comme l'ensemble de la notation.  Les valeurs des coefficients n'ont pas chang√© depuis tr√®s longtemps selon le principe "√ßa marche". <br><br>  Il a commenc√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√† gagner les</a> premiers et √† monter rapidement dans le classement.  La phase b√™ta est termin√©e. <br><br>  Pendant longtemps, je n'avais aucune id√©e de la strat√©gie, les versions √©taient notables pour des modifications mineures, des corrections de bugs (il s'est av√©r√© que je consid√©rais la force de rebond moyenne comme <code>(MAX_HIT_E - MIN_HIT_E) / 2</code> ), et √©galement optimis√© le simulateur.  Un r√¥le important a √©t√© jou√© par le nombre de trajectoires que j'ai r√©ussi √† trier par tick, donc je me suis concentr√© sur l'optimisation.  Suppression des sinus et des racines carr√©es.  Ajout d'une vitesse nulle improbable sur la trajectoire avant ou apr√®s avoir chang√© l'angle.  Score l√©g√®rement chang√©. <br><br>  La 16e version est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rest√©e</a> longtemps en t√™te du classement, mais une semaine apr√®s la fin des tests b√™ta, comme pr√©vu, beaucoup ont commenc√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√† gagner</a> . <br><br><img src="https://habrastorage.org/webt/nd/mi/1v/ndmi1vn6qa2rshoih_ufarabuj0.jpeg" align="left">  J'ai essay√© d'affiner la trajectoire avec la somme des distances les plus proches de l'ennemi au ballon, et j'ai eu un comportement tr√®s int√©ressant.  Mes robots, quand ils ne pouvaient pas frapper de mani√®re rentable, commen√ßaient souvent √† bloquer les ennemis, brisant leurs trajectoires et les emp√™chant de courir jusqu'au ballon, parfois cela s'est av√©r√© tr√®s r√©ussi et insidieusement. <br><br>  Ensuite, j'ai fix√© la pr√©cision en sautant.  Si quelqu'un saute sur la tique actuelle, nous effectuons d'abord 1 microtik deux fois, puis les 98 microtics restants, puis j'ai essay√© le coefficient heuristique pour compenser la perte de pr√©cision dans le cas o√π, pour certains microtics, la vitesse maximale est atteinte.  Les am√©liorations ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">grandement</a> aid√© et il y avait des hits plus pr√©cis et pr√©-calcul√©s. <br><br>  √Ä cette √©poque √©galement, j'ai commenc√© √† afficher sur le site parmi les informations de d√©bogage le nombre d'it√©rations que j'ai r√©ussi √† terminer.  Il y en avait 250 √† 200 ticks, au total j'ai eu 50 000 ticks de simulations pendant le temps allou√© √† ma strat√©gie par tick. <br><br>  J'ai ensuite activ√© les trajectoires de mutation.  Cela a grandement am√©lior√© la strat√©gie.  Dans environ la moiti√© de toutes les it√©rations, ce n'est pas la nouvelle trajectoire qui a √©t√© utilis√©e, mais la meilleure avec des valeurs l√©g√®rement modifi√©es, qui a permis de converger quelque part, par exemple, vers un maximum local.  Cela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s'est av√©r√©</a> √™tre une strat√©gie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">solide</a> √† l'√©poque, que j'ai d√©cid√© de laisser jusqu'au premier tour, m√™me si c'√©tait encore deux semaines enti√®res avant.  Mais apr√®s quelques jours, elle a cess√© de dominer le sommet. <br><br>  J'ai pass√© un certain temps √† m'√©loigner de l'al√©atoire complet, par exemple, j'ai essay√© avec une recherche ternaire de trouver l'angle auquel le robot devait acc√©l√©rer pour frapper la balle.  Mais cela n'a pas toujours fonctionn√© et je n'ai pas compris comment d√©velopper davantage cette id√©e. <br><br>  Mes robots ne savaient sauter qu'une seule fois par trajectoire, mais lorsqu'ils √©taient au sol et voulaient sauter, puis frapper la balle en l'air, ils ne savaient pas que lorsque vous touchez la balle, vous pouvez sauter une deuxi√®me fois, frappant ainsi la balle fort, et pas seulement le pousser. <br><br>  Cela a √©t√© corrig√©, et maintenant le simulateur, quand il a remarqu√© que quelqu'un pouvait frapper la balle au tick actuel, a recul√© d'un tick et a forc√© le robot √† sauter avec une force maximale.  Maintenant, debout sur le sol, le robot savait qu'il repousserait le sol et non pas seulement pousserait, mais frapperait la balle avec un deuxi√®me saut. <br><br>  J'ai compris que lorsque nitro et un autre robot seraient ajout√©s, tout serait pli√© √† cause du manque d'it√©rations.  Aussi √† diff√©rents endroits, j'ai eu de gros probl√®mes de pr√©cision, que je ne savais pas comment r√©soudre.  Je n'ai vu aucune <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">solution analytique</a> ni aucun <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mode de gestion intelligent</a> . <br><br>  J'avais besoin d'une strat√©gie compl√®tement nouvelle, ou d'un simulateur magique qui combine pr√©cision et vitesse, et dans la phase finale me fournira suffisamment de trajectoires pour it√©rer.  Je n'ai pas trouv√© de nouvelle strat√©gie (√©tonnamment) et j'ai commenc√© √† travailler sur un simulateur. <br><br><h2>  "Simulateur intelligent" </h2><br>  La premi√®re chose que je voulais faire avec pr√©cision. <br><br>  J'ai simul√© 100 Mikrotiks √† la fois, bien qu'une collision - ou un autre √©v√©nement - se soit produite sur l'un de ces cent Mikrotiks.  Si vous l'ignorez, les objets entrent en collision plus tard que dans la r√©alit√© (toujours au 100e microtics), et rebondissent donc diff√©remment.  Vers la fin de la trajectoire, cette petite erreur peut se transformer en une grosse impr√©cision.  Par exemple, nous pensons que la balle atteint le but ennemi, mais en r√©alit√© elle rebondira <s>dans la n√¥tre</s> depuis le poteau. <br><br>  Il est facile de voir que dans une situation o√π une collision se produit sur le <code>i</code> √®me microtics, au lieu de compter les 100 microtics, il suffit de compter les premiers <code>i - 1</code> microtics √† la fois (en fait, l'√©tape physique est consid√©r√©e pendant un certain temps <code>dt</code> , et maintenant ce temps sera <code>t * (i - 1)</code> , o√π <code>t</code> est le temps correspondant √† un Mikrotik).  Vous devez maintenant simuler 1 microtique ( <code>dt = t</code> ) et les <code>100 - i</code> micros restants.  Nous obtenons exactement le m√™me r√©sultat en seulement trois simulations au lieu d'une centaine.  Le seul probl√®me est que nous ne savons pas sur quels microtics la collision se produira. <br><br>  √âtant sur un tick fixe de la simulation, nous pouvons faire n'importe quel nombre de microtics de 1 √† 100 dans une simulation et voir s'il y a une collision ou non.  Dans ce cas, l'image sera comme ceci: au d√©but il n'y a pas de toucher, mais √† partir d'un certain nombre de microtiques et jusqu'√† une centaine il y a un toucher.  Sauf dans de tr√®s rares cas, quand il n'y a pas de contact au d√©but, alors il y a un contact sur un segment de la microtique, puis √† nouveau il n'y a plus de contact. <br><br>  Par cons√©quent, il est possible de trouver le Mikrotik o√π la collision s'est produite en utilisant une recherche binaire pour 10 simulations dans le pire des cas.  Et comme d√©crit pr√©c√©demment, pour trois simulations, vous pouvez obtenir l'√©tat du monde √† travers 100 microtiques avec une pr√©cision parfaite. <br><br>  En fait, il y avait plusieurs autres types d'√©v√©nements en plus d'une collision, et plusieurs pouvaient se produire pendant une tique, donc seul le premier √©v√©nement √©tait localis√© avec une dichotomie, puis le deuxi√®me √©v√©nement √©tait localis√© au suffixe restant de la dichotomie de tique, et ainsi de suite.  Ainsi, une tique a √©t√© consid√©r√©e comme des segments de plusieurs microtiques par simulation, jusqu'√† ce que tous les √©v√©nements aient √©t√© compt√©s. <br><br>  Les probl√®mes ont donc √©t√© r√©solus avec pr√©cision.  Mais en raison du fait qu'il y avait 5 objets dans la simulation, et selon les r√®gles finales, il devait y en avoir 7, et tous se sont souvent √©cras√©s, en moyenne les dichotomies ont √©t√© appel√©es trop souvent, et cela a fonctionn√© de mani√®re prohibitive.  J'ai donc proc√©d√© √† la deuxi√®me √©tape du d√©veloppement du simulateur - optimisation. <br><br>  √âvidemment, lorsque la trajectoire de l'un des robots passe, tous les autres objets dans lesquels ce robot ne s'√©crase pas se d√©placent de la m√™me fa√ßon √† chaque fois.  Il est clair que recalculer leurs √©tats avec un simulateur - par exemple, calculer de lourdes collisions avec l'ar√®ne - n'est pas n√©cessaire. <br><br>  Avant de trier les trajectoires d'un robot particulier, il suffit de simuler honn√™tement et de se souvenir pour les objets restants de leurs √©tats √† tout instant, puis de simplement prendre ces √©tats de la m√©moire.  Nous appelons ces objets statiques, et un robot dont la trajectoire est tri√©e est dynamique. <br><br>  Si soudainement un objet dynamique influence (a une collision) avec un objet statique, nous ajoutons cet objet statique aux objets dynamiques jusqu'√† la fin de la simulation de la trajectoire courante.  En fait, au stade du stockage des √©tats pour les objets statiques, un graphique des influences les uns sur les autres est construit, puis il est utilis√© pour transf√©rer correctement les objets statiques vers des objets dynamiques.  Par exemple, un robot ennemi a frapp√© la balle, et nous avons g√©n√©r√© un chemin o√π nous renversons le robot ennemi avant qu'il ne frappe la balle.  Maintenant, la balle volera plus loin, et pendant la simulation, lorsque le robot ennemi est ajout√© √† des objets dynamiques, il est n√©cessaire de noter que la balle doit √™tre ajout√©e aux objets dynamiques un peu plus tard, √† la tique √† laquelle le robot ennemi frapperait la balle si nous ne le g√™nions pas. .  Dans le cas g√©n√©ral, cela se fait r√©cursivement selon le graphe d'influence. <br><br><img src="https://habrastorage.org/webt/ey/fr/cj/eyfrcjzg0s28o3fjqgberru64bm.jpeg"><br><br>  D√©sormais, le simulateur ne calcule pas tous les objets, mais uniquement les objets dynamiques, ce qui correspond en moyenne √† un objet et demi au lieu de sept, et les longues dichotomies sont beaucoup moins utilis√©es.  Cela s'est av√©r√© tr√®s rapidement et n'a plus √† souffrir en finale avec des robots suppl√©mentaires - cool! <br><br>  La 26e version avec un nouveau simulateur et une profondeur de simulation r√©duite de 200 √† 100 a √©t√© envoy√©e au premier tour.  Mais il contenait quelques bugs, et il n'y avait aucun avantage √©vident. <br><br>  Le dernier probl√®me de pr√©cision est rest√©: le mouvement le long de l'arrondi de l'ar√®ne.  Dans ce cas, pour atteindre une pr√©cision absolue, il est n√©cessaire de compter honn√™tement 100 microtiques.  La solution √©tait √©tonnamment simple: toujours sauter de toutes les surfaces √† l'exception du sol.  Pas d'arrondi - pas de probl√®me. <br><br>  De plus, pendant un certain temps, j'ai optimis√©, affaibli et, en regardant des jeux avec des strat√©gies plus intelligentes, j'ai ramass√© de nouvelles constantes de score.  C'est devenu beaucoup mieux, la strat√©gie est mont√©e haut dans le classement et la 37√®me version a obtenu le meilleur r√©sultat de toutes mes strat√©gies dans le bac √† sable tout le temps avant la finale. <br><br>  √Ä partir de ce moment, j'ai lou√© une machine √† 32 c≈ìurs dans un service cloud pour ex√©cuter mes strat√©gies les unes contre les autres et j'ai commenc√© √† exp√©rimenter beaucoup avec tout de suite.  Chang√© les constantes.  J'ai essay√© d'utiliser ma propre strat√©gie pour pr√©dire les actions de l'ennemi, mais cela n'a pas aid√© m√™me dans les matchs contre ma strat√©gie. <br><br>  En r√©solvant l'√©quation, il a appris √† calculer la derni√®re action de l'ennemi et a commenc√© √† pr√©dire son comportement ult√©rieur.  Ajout du support pour nitro: un point al√©atoire sur la surface de la sph√®re est s√©lectionn√© pour l'action.  Plusieurs modifications mineures ont √©t√© apport√©es.  Mais il n'y a pas eu beaucoup de progr√®s.  Au d√©but du deuxi√®me tour, 4-5 sommets me gagnaient r√©guli√®rement <br><br>  Pourtant, je ne d√©sesp√©rais pas.  J'avais deux am√©liorations que je comptais mettre en ≈ìuvre avant la finale, et j'esp√©rais qu'elles am√©lioreraient consid√©rablement la strat√©gie.  J'ai d√©cid√© de ne pas les aborder jusqu'√† ce que le bac √† sable commence selon les r√®gles finales, et plut√¥t de passer du temps √† d√©boguer et √† optimiser ce qui a d√©j√† √©t√© fait pour minimiser les risques de bugs malveillants au cours de la derni√®re semaine, lorsque chaque minute compte. <br><br>  La derni√®re semaine avant le d√©but de la finale. <br><br>  La premi√®re am√©lioration que j'ai apport√©e a √©t√© la suivante.  Dans les matches, dans le cas g√©n√©ral, la plupart de mes probl√®mes, et toute autre strat√©gie survient lorsque l'adversaire prend possession du ballon.  Il le frappe en quelque sorte, passe, en g√©n√©ral - contr√¥le.  Il est impossible de pr√©dire la trajectoire de la balle et de pr√©voir d'autres actions rentables dans ce cas, il reste √† faire ¬´quoi que ce soit¬ª jusqu'√† ce que l'adversaire commette une erreur et transf√®re le contr√¥le de la balle √† mes robots.  Et apr√®s cela, vous devez essayer de ne pas effectuer de telles actions qui pourraient conduire au fait que la balle sera √† nouveau avec l'ennemi. <br><br>  En d'autres termes, au moment de planifier la trajectoire, je veux prendre en compte les positions possibles des adversaires et essayer de ne pas y frapper le ballon.  J'ai d√©cid√© d'utiliser un champ potentiel √† quatre dimensions (les trois premi√®res dimensions sont les coordonn√©es, le c√¥t√© des cubes est √©gal au diam√®tre du robot et la quatri√®me dimension est le temps), que je remplirai, g√©n√©rant des trajectoires ennemies al√©atoires. <br><br>  Plus tard, lors de l'√©valuation de la trajectoire de mon robot, j'ai calcul√© la somme de tous les cubes qui ont travers√© la balle aux points correspondants dans le temps, et multipli√©e par un coefficient qui d√©passe toutes les autres valeurs du score.  Autrement dit, le champ potentiel a √©t√© pris en compte avec la priorit√© la plus √©lev√©e apr√®s l'objectif.  Cela permettait √©galement de supprimer les ennemis de la simulation apr√®s les 30 premi√®res tiques (l'ennemi pouvait faire quoi que ce soit pendant ce temps lorsqu'il √©tait au sol, et de telles pr√©visions inexactes √† distance ne faisaient qu'interf√©rer) s'ils n'√©taient pas dans l'air (il semblait que personne ne serait dans l'air pour changer la trajectoire de mani√®re complexe √† l'aide de nitro). <br><br>  En g√©n√©rant des trajectoires al√©atoires pour l'ennemi, il a √©t√© possible de conna√Ætre le temps minimum qu'il lui a fallu pour frapper la balle.  Cette valeur a √©t√© utile pour r√©soudre le probl√®me avec les premiers sauts de mon gardien de but hors de la porte.  Beaucoup de buts ont √©t√© marqu√©s pour moi parce que mon gardien de but a saut√© t√¥t et est devenu incontr√¥lable dans les airs.  Apr√®s cela, l'ennemi a facilement pr√©dit comment mon gardien de but volerait et, s'il le pouvait, a chang√© la trajectoire du ballon avant que mon gardien de but ne l'atteigne.  Maintenant, j'ai annul√© le saut du gardien de but si l'ennemi peut frapper la balle plus t√¥t que mon gardien de but ne le pr√©voit. <br><br><img src="https://habrastorage.org/webt/00/p5/e5/00p5e59dlcqljg9ags7vttdyohy.jpeg"><br><br>  Il s'est av√©r√© que, sans dommage significatif √† la strat√©gie, il est possible de calculer la trajectoire non pas √† chaque tick, mais √† travers un.  En r√©duisant de moiti√© le temps d'ex√©cution, j'ai ainsi doubl√© le nombre moyen d'it√©rations.  Un peu de magie se produit ici.  Il semble que si nous comptons les trajectoires de chaque seconde et que nous doublons le nombre d'it√©rations, le nombre moyen d'it√©rations ne changera pas.  Mais en fait, le simulateur comptera deux ticks (200 microtiks) par simulation au lieu d'un.  Et les trajectoires seront d√©j√† profondes de 50 et non de 100. C'est pourquoi le nombre moyen d'it√©rations doublera. <br><br>  Rest√© quelques jours avant la finale.  Bien que ma strat√©gie ait commenc√© √† conc√©der moins de buts en raison d'un bon contr√¥le du ballon, je n'ai pas commenc√© √† mieux marquer.  J'ai donc d√ª la motiver avec un coefficient quand bient√¥t pour le but d'un adversaire.  Plus un but est marqu√© rapidement, plus le ratio est √©lev√©.  Et ce coefficient cro√Æt beaucoup pour d√©passer le reste du score et ne pas avoir peur du champ potentiel, quand, par exemple, il reste 10 ticks avant de marquer. <br><br>  Ajout d'un calcul de l'endroit o√π l'ennemi envoie du nitro.  Cela a √©t√© fait en utilisant la force brute avec une certaine √©tape.  De plus, le gardien de but a commenc√© √† reconstituer les r√©serves de nitro, quand rien ne menace mon objectif. <br><br>  La deuxi√®me am√©lioration majeure a √©t√© d'utiliser minimax.  Si l'utilisation de forces d'impact diff√©rentes pour l'ennemi pendant la construction de trajectoires statiques affecte le vol de la balle, alors pendant la recherche, les deux options ont √©t√© consid√©r√©es, avec une force d'impact maximale et minimale de l'ennemi, et le minimum des estimations a √©t√© pris. <br><br>  En finale, j'avais 7 options de trajectoires lorsque le robot √©tait au sol: <br><br><ul><li>  2 coins sans saut; </li><li>  2 coins avec un saut; </li><li>  2 angles avec saut et vitesse codirectionnelle nitro; </li><li>  2 angles avec un saut et nitro compense la gravit√©; </li><li>  1 coin avec un saut; </li><li>  1 angle avec saut et vitesse codirectionnelle nitro; </li><li>  1 coin avec un saut et nitro compense la gravit√© (non utilis√© en raison d'un bug, remarqu√© lors de l'√©criture d'un article). </li></ul><br>  et deux options lorsque le robot est en l'air: <br><br><ul><li>  nitro √† un point al√©atoire sur la surface de la sph√®re et force d'impact al√©atoire; </li><li>  force d'impact al√©atoire. </li></ul><br>  Il y avait de la comp√©tition quelques heures avant les finales, mais ma strat√©gie √©tait clairement meilleure.  Il semblait que tout avait d√©j√† √©t√© fait, je n'avais pas dormi plus d'une journ√©e et rien ne d√©pendait de moi.  Il restait √† regarder.  Deux heures avant la finale, Andrei a envoy√© son graal fra√Æchement cuit et a remport√© avec succ√®s la premi√®re place.  L'historique de sa participation se trouve ici: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">habr.com/en/post/440398</a> . <br><br>  Dans l'intervalle entre les √©tapes de la finale, j'ai ajout√© un champ potentiel √©loignant le ballon de mon but, ind√©pendamment de tout le reste, et cela, il me semble, m'a √©gal√© avec Andrei.  Mais il √©tait d√©j√† tard, car j'avais perdu 7 points en premi√®re mi-temps, et m√™me 3/3 victoires en seconde mi-temps n'√©taient pas suffisantes. <br><br>  L'IRAC est une comp√©tition difficile et les prix sont remis aux participants tr√®s, tr√®s difficiles.  Lorsqu'un participant est en haut de la table, pour lui, ce n'est pas seulement du divertissement - c'est une lutte.  Il y a beaucoup de petites choses √† consid√©rer lors de la r√©daction d'une strat√©gie solide.  Chaque d√©cision prise peut affecter de mani√®re significative le r√©sultat. <br><br>  Le code source de la strat√©gie sera disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr440924/">https://habr.com/ru/post/fr440924/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr440914/index.html">J'ai perdu confiance dans l'industrie, br√ªl√©, mais le culte de l'outil m'a sauv√©</a></li>
<li><a href="../fr440916/index.html">Rayonnement: unit√©s</a></li>
<li><a href="../fr440918/index.html">Security Week 08: piratage de VFEMail en direct</a></li>
<li><a href="../fr440920/index.html">Impl√©mentation de l'interface utilisateur dans iOS: meilleure, plus rapide et √©volutive</a></li>
<li><a href="../fr440922/index.html">Fonctionnement de Level Flow dans Uncharted 4 et The Last Of Us</a></li>
<li><a href="../fr440928/index.html">D√©terminez votre bio-√¢ge sur le profil</a></li>
<li><a href="../fr440930/index.html">J'ai men√© une centaine d'entretiens, refus√© √† des centaines de personnes - et c'est seulement alors que j'ai appris √† interviewer</a></li>
<li><a href="../fr440932/index.html">Un peu sur l'informatique d√©cisionnelle</a></li>
<li><a href="../fr440938/index.html">Pourquoi Google avait-il besoin d'un graphique de connaissances?</a></li>
<li><a href="../fr440940/index.html">Redux - r√©vision de la logique et des actions du r√©ducteur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>