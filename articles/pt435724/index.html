<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë® üåº üêë Retendo os v√≠cios do imperativo üë©üèæ‚Äçüè´ üì∑ üë®üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O paradigma orientado a objetos √© extremamente conveniente para os neg√≥cios: permite implementar praticamente qualquer id√©ia, fornecendo desempenho ac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Retendo os v√≠cios do imperativo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/435724/"> O paradigma orientado a objetos √© extremamente conveniente para os neg√≥cios: permite implementar praticamente qualquer id√©ia, fornecendo desempenho aceit√°vel do produto.  Nesse caso, por produto queremos dizer um aplicativo iOS; portanto, em conclus√£o, prosseguiremos com o desenvolvimento especificamente nesta plataforma. <br><br>  Fechando os olhos para as falhas conhecidas desse paradigma popular, a lista de seus desvantagens inclui sua vantagem mais importante - a flexibilidade do desenvolvimento.  Por que isso √© um sinal de menos?  √â bastante √≥bvio que a flexibilidade, al√©m da capacidade b√°sica de resolver problemas de neg√≥cios, possibilita isso de v√°rias maneiras.  √â verdade que existem uma d√∫zia de erros para uma abordagem correta, apesar do fato de que a tarefa de neg√≥cios ser√° resolvida corretamente em qualquer um dos casos, mas com diferen√ßas na implementa√ß√£o, cuja extensibilidade e transpar√™ncia j√° depender√£o da corre√ß√£o da abordagem aplicada. <br><a name="habracut"></a><br>  Levando em conta a lei de Murphy, a conclus√£o √© que, na aus√™ncia das restri√ß√µes arquitet√¥nicas corretas, √© mais prov√°vel que siga o caminho do caos, ou seja, a qualidade do c√≥digo diminuir√° rapidamente, apenas porque o paradigma o permite.  Este artigo discutir√° uma das poss√≠veis limita√ß√µes arquitet√¥nicas que ajudar√£o a manter o equil√≠brio das for√ßas do bem e do mal, ou seja, a din√¢mica do crescimento da entropia na base de c√≥digo do projeto.  √â importante que essa din√¢mica se correlacione diretamente com o n√∫mero de pessoas envolvidas na escrita do c√≥digo; portanto, para grandes projetos, a corre√ß√£o das restri√ß√µes selecionadas √© especialmente cr√≠tica.  Qual √© o objetivo? <br><br>  O ponto √© simples.  Vamos sair do pr√≥ximo axioma - quanto mais propriedades houver em um objeto, mais "pior" ser√°.  Esta afirma√ß√£o pode ser explicada da seguinte forma: com um aumento no n√∫mero de estados internos, todos os indicadores positivos do objeto - extensibilidade, modularidade, transpar√™ncia, testabilidade - diminuem.  Pode-se objetar, dizendo que a complexidade do objeto e sua funcionalidade est√£o interconectados e que, sem o primeiro, o segundo n√£o acontece.  Tudo √© verdade, mas, seguindo o caminho "stateful", o crescimento da complexidade ocorre exponencialmente, enquanto idealmente o crescimento deve ser linear ou, mais simplesmente, um novo recurso n√£o deve complicar os recursos existentes. <br><br>  <em>PS Aqui, vale esclarecer que os recursos s√£o entendidos como camadas semanticamente relacionadas da l√≥gica de neg√≥cios; portanto, muitas vezes √© tomada uma decis√£o para complicar uma classe existente, em vez de criar uma nova.</em>  <em>Nesses casos, √© dif√≠cil encontrar contradi√ß√µes com o primeiro princ√≠pio do SOLID.</em> <br><br>  Um exemplo √© uma tela completamente padr√£o com uma lista de entidades com uma escolha.  Algumas das propriedades podem se tornar n√£o est√°veis, mas o IB nos liga ao construtor padr√£o do controlador e isso nos obriga a "fazer sujeira".  O acesso a essas propriedades √© obtido implicitamente por cada m√©todo de classe no mesmo arquivo.  E o momento mais desagrad√°vel √© que sua mutabilidade tamb√©m n√£o √© coberta por nada, e isso de alguma forma leva a consequ√™ncias irrevers√≠veis na forma de uma conex√£o forte e, consequentemente, ao fato de que a fixa√ß√£o de alguns defeitos causa o aparecimento de novos: <br><br><img src="https://habrastorage.org/webt/dl/ei/9i/dlei9iar48aabzsso89hb2rxcy4.png"><br><br>  Podemos concluir que um aumento linear na complexidade de um objeto com um estado comum √© praticamente inating√≠vel.  A funcionalidade com essa abordagem se torna monol√≠tica e dif√≠cil para qualquer tipo de segrega√ß√£o.  Um bom exemplo √© o Massive-View-Controller antipattern, que √© bastante comum e demonstra claramente o resultado da aus√™ncia de quaisquer restri√ß√µes ao projeto. <br><br><img src="https://habrastorage.org/webt/bs/zk/l9/bszkl9ysxdvs0vdgx5v0obipw34.png"><br><br>  Usando o UIKit como exemplo, voc√™ pode ver exatamente como o estilo imperativo de desenvolvimento afeta a complexidade do c√≥digo e em que pontos a estrutura ‚Äúfor√ßa‚Äù as propriedades a serem criadas nas classes. <br>  O caso mais simples - o processamento de pressionar um bot√£o - √© realizado apenas de maneira padr√£o, definindo o ‚Äúm√©todo sujo‚Äù, ou seja, por uma fun√ß√£o que n√£o pode receber nada de √∫til; portanto, voc√™ ter√° que sair para acessar as propriedades: <br><br><img src="https://habrastorage.org/webt/fw/bt/ir/fwbtir1_7icsnnn9qojg3k8jguc.png"><br><br>  Assim, o "recurso" do bot√£o complicar√° tiranicamente o restante da funcionalidade do objeto, uma vez que todos os residentes da classe ter√£o acesso a esses dados.  De fato, quase qualquer controle de interface do usu√°rio do iOS funciona de maneira semelhante.  Portanto, lembre-se de implementar algum tipo de wrapper sobre os elementos da interface do usu√°rio, por exemplo, que encerre, como um processamento da "opera√ß√£o" de um elemento em particular, mas a dificuldade √© descobrir como tornar esse wrapper conciso e confi√°vel.  Afinal, o assunto n√£o est√° apenas na entrada, mas tamb√©m na sa√≠da de informa√ß√µes, por exemplo, a tabela onipresente com dados tamb√©m funciona "suja" e n√£o tem id√©ia dos dados que mostra, ent√£o voc√™ deve salv√°-la em um objeto: <br><br><img src="https://habrastorage.org/webt/dy/q1/cp/dyq1cpxc1lfggibxweuepzl9dxi.png"><br><br>  √â conveniente?  Convenientemente, todos sempre t√™m acesso aos dados.  Flex√≠vel, r√°pido, imperativo.  Mas tudo se transforma ao longo do tempo, em regra, em um obelisco concreto para mil linhas de c√≥digo e nas l√°grimas daqueles que tiveram a tarefa de trabalhar nessa classe. <br><br>  Voltando √†s limita√ß√µes, o seguinte princ√≠pio pode ser formado a partir do c√≥digo acima - sem propriedades nas classes √© muito mais limpo e mais lucrativo com suporte e extens√£o.  Idealmente, a l√≥gica do objeto deve estar em seus m√©todos "puros", que tomam todas as suas depend√™ncias como entrada e t√™m o resultado de sua atividade na sa√≠da. <br>  A id√©ia √© diminuir o estado privado do objeto um n√≠vel abaixo.  Ou seja, se o privado fecha propriedades do mundo exterior, nossa tarefa √© ir ainda mais longe e fortalecer o encapsulamento ao n√≠vel dos pr√≥prios m√©todos.  √Ä primeira vista, por toda a natureza ass√≠ncrona da plataforma e a imperatividade da estrutura principal, pode parecer que toda essa id√©ia n√£o seja apenas imposs√≠vel, mas pelo menos sua implementa√ß√£o parecer√° antinatural.  E, muito provavelmente, ser√°, mas esse √© um daqueles problemas que podem ser resolvidos com a introdu√ß√£o de um n√≠vel adicional de abstra√ß√µes. <br><br>  Se queremos encaixar toda a l√≥gica das classes em seus m√©todos sem recorrer √†s propriedades, precisamos trabalhar em estreita colabora√ß√£o com os fechamentos.  O IOS possui ferramentas padr√£o para gerenciar opera√ß√µes ass√≠ncronas, como GCD e OperationQueue.  Parece que eles seriam suficientes, mas quando voc√™ tenta dar vida √† ideia, tudo ficar√° longe de ser t√£o otimista quanto voc√™ gostaria.  Com essa abordagem, al√©m do fato de haver uma grande chance de um retorno de chamada, o c√≥digo em si ser√° complicado, ter√° muitos buracos l√≥gicos e estar√° fortemente conectado.  √â poss√≠vel que esse c√≥digo seja ainda mais complicado do que estamos tentando escapar t√£o rapidamente. <br><br>  Se voc√™ olhar em volta, ver√° que existem maneiras muito mais bonitas e funcionais de atingir esse objetivo.  A programa√ß√£o reativa √© utilizada h√° muito tempo no desenvolvimento comercial de software e √© ideal para o mundo front-end ass√≠ncrono.  Nesse caso, consideraremos uma implementa√ß√£o (bastante bem-sucedida) do paradigma reativo para Swift-Rx. <br><br><img src="https://habrastorage.org/webt/bp/ev/lj/bpevljtykqk_lsfouse5d-f6ti8.png"><br><br>  Ele oferece uma entidade simples chamada Observable.  Esse √© um tipo de abstra√ß√£o sobre o fluxo de eventos, pode ser inscrito e, depois disso, o assinante receber√° esses eventos ao longo do tempo: <br><br><img src="https://habrastorage.org/webt/pg/dz/nl/pgdznlosgnhek3yqt-gkeu07nsm.png"><br><br>  A maneira mais f√°cil de imaginar o fluxo de eventos √© apresentando um bot√£o regular.  O evento de sua opera√ß√£o √© aqui um fluxo, para que qualquer objeto possa se inscrever e receber eventos com um clique e, o mais importante, o bot√£o n√£o sabe nada sobre seus pr√≥prios assinantes.  Convenientemente, quase qualquer a√ß√£o pode ser transformada em uma seq√º√™ncia semelhante de valores, e isso √© importante, porque o Observable pode ser combinado entre si, uma vez que nenhuma estrutura padr√£o tornar√° isso poss√≠vel. <br><br>  Por exemplo, voc√™ pode enviar v√°rias solicita√ß√µes pressionando o bot√£o (filtrando toque duplo), aguardar que cada uma responda e combinar a resposta com o que o usu√°rio inseriu na tela, executar outra solicita√ß√£o e ir para a pr√≥xima tela, transferindo o resultado para ela, quando esse Rx tornar√° poss√≠vel manipular sucintamente os erros e concluir essa cadeia (cancelar solicita√ß√µes) ao sair da tela, e toda essa l√≥gica precisar√° de duas d√∫zias de linhas de c√≥digo digitado: <br><br><img src="https://habrastorage.org/webt/8u/gp/qa/8ugpqajg3s9h23iwhafig7tyco0.png"><br><br>  <em>Vale a pena falar sobre a √∫nica propriedade do disposeBag.</em>  <em>Como pode ser visto nas capturas de tela, cada assinatura √© colocada nela, e isso √© necess√°rio para controlar sua vida √∫til.</em>  <em>Ou seja, as assinaturas s√£o v√°lidas enquanto a "bolsa" permanecer em que foram colocadas, nesse caso, enquanto o controlador permanecer.</em> <br><br>  Al√©m da compacta√ß√£o, √© dif√≠cil cometer um erro no c√≥digo acima, pois cada fechamento retorna algo e n√£o cont√©m efeitos colaterais.  Este √© o poder que est√°vamos procurando. <br><br>  Voc√™ pode notar mais um ponto importante: como a classe n√£o possui propriedades, n√£o √© necess√°rio escrever [self fraco], o que afeta positivamente a legibilidade do c√≥digo.  Todas as fun√ß√µes podem e podem ser melhor definidas localmente no m√©todo em que s√£o usadas ou executadas em classes separadas.  A prop√≥sito, links para depend√™ncias (ViewModel, Presenter, etc.) nesse caso podem ser passados ‚Äã‚Äãcomo um argumento para o m√©todo do controlador; nesse caso, n√£o h√° necessidade de salv√°-los nas propriedades.  Isto est√° correto. <br><br>  Depois de revisar, √© hora de usar o Observable para simplificar o desenvolvimento.  Como exatamente?  Vamos voltar √† id√©ia de m√©todos "limpos" e tentar implementar a l√≥gica de uma tela pequena em seu √∫nico m√©todo.Para maior clareza, escolheremos o m√©todo de finalizar o carregamento da visualiza√ß√£o (viewDidLoad).  Naturalmente, se a tela for composta no IB, teremos que criar propriedades para pontos de venda, mas isso n√£o √© assustador, porque os elementos em si n√£o representam a l√≥gica de neg√≥cios, portanto, n√£o afetar√£o muito a complexidade da tela.  Mas se a tela √© composta de c√≥digo, voc√™ pode ficar sem propriedades (exceto para o disposeBag), criando elementos em nosso m√©todo e usando-os ali mesmo.  E a imperatividade dos elementos UIKit que foram descritos anteriormente?  O Rx, al√©m da pr√≥pria abordagem, fornece wrappers reativos para componentes padr√£o da interface do usu√°rio; portanto, na maioria dos casos, voc√™ pode obter a sequ√™ncia necess√°ria de eventos no local.  Ou, por outro lado, vincule o Observable existente a, por exemplo, uma tabela - traga uma solicita√ß√£o a ele para que ele atualize seu conte√∫do imediatamente ap√≥s sua conclus√£o: <br><br><img src="https://habrastorage.org/webt/xd/dk/w1/xddkw1csdfuq5xblt_scy4bznf0.png"><br><br>  <em>A liga√ß√£o a cole√ß√µes √© bastante flex√≠vel, mas, por padr√£o, funciona apenas atrav√©s de reloadData.</em>  <em>Para atualiza√ß√µes de pontos, existe uma maravilhosa biblioteca depurada do mesmo autor - RxDataSources.</em>  <em>Com isso, voc√™ pode esquecer as falhas durante o batchUpdates.</em> <br><br>  O que acontecer√° depois?  Um m√©todo de tela √∫nica crescer√° e, em um caso bastante complicado, ficar√° dif√≠cil de manter.  E quando isso acontece, fica subitamente claro que esse m√©todo n√£o depende de nada al√©m de si mesmo, e a abordagem reativa dividiu o c√≥digo em blocos l√≥gicos que podem ser facilmente colocados em objetos separados, projetando-os de maneira semelhante.  Mas desta vez, os m√©todos j√° ter√£o algumas depend√™ncias na tela e retornar√£o algum resultado.  O ponto positivo √© que a assinatura, neste caso, √© obtida com o maior conte√∫do poss√≠vel; pode-se observar que a fun√ß√£o requer seu trabalho e qual √© o seu resultado.  Pode ser algo como isto: <br><br><img src="https://habrastorage.org/webt/-k/3m/sx/-k3msxloljkxb4dy9mvs_uslxes.png"><br><br>  Estruturas separadas ajudam a manter o cabe√ßalho do m√©todo leg√≠vel e organizado, pois pode haver muitas depend√™ncias. <br><br>  √â importante entender que o m√©todo n√£o precisa ser o √∫nico em todo o objeto, a ess√™ncia de sua independ√™ncia um do outro.  Gra√ßas ao Rx, suas entradas e sa√≠das podem ser ass√≠ncronas e representam um ou mais Observ√°veis, fornecendo outra dimens√£o para manipula√ß√£o de dados. <br><br>  Essa abordagem desata suas m√£os e permite implementar telas de praticamente qualquer complexidade, mantendo o c√≥digo expl√≠cito e com pouca flexibilidade. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt435724/">https://habr.com/ru/post/pt435724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt435712/index.html">Procter & Gamble lan√ßa impressora anti-envelhecimento para pele</a></li>
<li><a href="../pt435714/index.html">Os desenvolvedores ucranianos tiveram acesso aos arquivos de todas as c√¢meras Ring do mundo</a></li>
<li><a href="../pt435718/index.html">Bombeamos NGSW angular usando l√≥gica personalizada no Service Worker</a></li>
<li><a href="../pt435720/index.html">R√°dio Adblock de desenvolvimento</a></li>
<li><a href="../pt435722/index.html">NB-IoT, Internet das coisas em banda estreita. Modos de economia de energia e comandos de controle</a></li>
<li><a href="../pt435728/index.html">[Sexta-feira] Hist√≥ria de como a venda de TI tentou vender lenha, ou nos bastidores de um concurso</a></li>
<li><a href="../pt435730/index.html">A concha rachou</a></li>
<li><a href="../pt435732/index.html">Friday JS: um quine que toca tic-tac-toe</a></li>
<li><a href="../pt435734/index.html">Como n√£o se deixar enganar fazendo f√≠sica</a></li>
<li><a href="../pt435738/index.html">T√©cnica de projeto DIY. Parte um</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>