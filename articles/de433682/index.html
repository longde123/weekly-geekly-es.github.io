<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗾 🏗️ 🥛 So kombinieren Sie Dateiinhalte in PowerShell. Und nicht leiden 💺 👩🏻‍🔧 🙁</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Was musste getan werden? 


 Einmal musste ich eine Reihe von Textdateien, die in einem Verzeichnis lagen, in einer Datei kombinieren. Ich wollte das ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So kombinieren Sie Dateiinhalte in PowerShell. Und nicht leiden</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433682/"><h3 id="chto-nado-bylo-sdelat">  Was musste getan werden? </h3><br><p>  Einmal musste ich eine Reihe von Textdateien, die in einem Verzeichnis lagen, in einer Datei kombinieren.  Ich wollte das nicht mit meinen Händen machen und Google kam mir wie immer zu Hilfe!  Ich habe viel über die Leistungsfähigkeit eines Tools wie PowerShell gehört und beschlossen, es für diese "Mega-Aufgabe" zu verwenden.  Zumindest, weil ich mit dem Elend von <strong>cmd.exe</strong> nicht vertraut bin.  Nun, es mit deinen Händen zu tun ist nicht unser Weg. </p><a name="habracut"></a><br><h3 id="chto-poshlo-ne-tak">  Was ist schief gelaufen? </h3><br><p>  Google hat mir gesagt, dass Sie dies mit einem einfachen Befehl tun können </p><br><pre><code class="bash hljs">Get-ChildItem -Filter *.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> | Get-Content | Out-File result.txt</code> </pre> <br><p>  <em>"Wirklich cool! Nur eine Art Unix-Weg!"</em>  Dachte ich.  Ich habe den Befehl kopiert, leicht geändert und die Eingabetaste gedrückt.  Der Cursor bewegte sich in eine neue Zeile ... und nichts weiter.  Im Dateimanager habe ich die endgültige Datei geöffnet - es war wirklich etwas Ähnliches wie das gewünschte Ergebnis.  Es hatte viele Zeilen aus den Quelldateien.  Als ich zur Konsole zurückkehrte, sah ich, dass der Prozess noch ... im Prozess ist.  Hat <strong>Strg + C</strong> geholfen <strong>.</strong> </p><br><p>  Bei näherer Betrachtung der Dateigröße stellte ich fest, dass sie irgendwie verdächtig groß war.  Seine Größe überschritt 100 Megabyte.  Obwohl die Wasserdaten nicht so groß waren. </p><br><h3 id="pochemu-eto-sluchilos">  Warum ist das passiert? </h3><br><p>  Es geht nur um meine "einfache Modifikation".  Ich brauchte nur keinen Erweiterungsfilter.  Ja, und dieser Parameter ist optional.  Und es stellte sich heraus, dass das Team die resultierende Datei erstellt hatte, sah, dass sie sich im Verzeichnis befand, sie las und ihren Inhalt erneut bis zum Ende schrieb und dies tat, bis ich <strong>Strg + C</strong> drückte. Ich konnte das kontinuierliche Wachstum der Ausgabedatei für nichts anderes erklären </p><br><p>  Ich wiederholte dies unter "sterilen" Bedingungen.  Der Einfachheit und Reinheit halber habe ich das Experiment in einem separaten Verzeichnis durchgeführt, weil ich Angst habe, eine funktionierende Maschine zu töten </p><br><ol><li><p>  Ich erstelle eine Textdatei </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Hello world"</span></span> &gt; hello.txt</code> </pre> <br></li><li><p>  Ich führe den Befehl aus </p><br><pre> <code class="bash hljs">Get-ChildItem | Get-Content | Out-File result.txt</code> </pre> <br><p>  oder in Kurzform </p><br><pre> <code class="bash hljs">dir | cat | Out-File result.txt</code> </pre> <br><p>  Das Problem wird wiederholt.  Die resultierende Datei wächst, ergänzt mit einer Zeile aus der Quelle (oder Zeilen aus sich selbst?).  In 10 Sekunden Ausführung: </p><br><ul><li>  Eine Zeile der Quelldatei wird zu 400.000 Zeilen </li><li>  Die Dateigröße wurde von 11 Byte auf fast 8 Megabyte erhöht </li><li>  Der Prozessor ist zu ca. 20-25% ausgelastet. </li><li>  Es gibt keine Überlastungen des Festplattensubsystems oder des Arbeitsspeichers.  Anscheinend ist PowerShell hinsichtlich der Arbeit mit diesen Komponenten gut optimiert.  ) </li></ul><br></li></ol><br><p>  Interessant ist auch: Wenn Sie den Namen der einzigen Datei im Verzeichnis als Parameter des letzten Befehls angeben, haben Sie natürlich die <strong><em>Trommelrolle</em></strong> erraten ... die Leere wird in die Datei geschrieben! </p><br><p>  Hier ist eine so „interessante“ Arbeitslogik </p><br><h3 id="chto-poluchilos">  Was ist passiert? </h3><br><p>  Die im ersten Schritt erstellte Datei beginnt zu wachsen.  Dieses Verhalten ist zumindest unvorhersehbar. <br>  Es war auch überraschend, dass das Betriebssystem weiterhin normal funktioniert.  Die Datei wächst langsam (oder nicht wirklich?), Ohne die Arbeit des Benutzers zu blockieren. </p><br><h3 id="chem-opasno">  Was ist gefährlich? </h3><br><p>  Nicht wahrnehmbare Füllung des Speicherplatzes. </p><br><h3 id="kak-izbezhat">  Wie vermeide ich? </h3><br><p>  Filtern Sie die Liste der Eingabedateien: </p><br><pre> <code class="bash hljs">Get-ChildItem -Filter *.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> | Get-Content | Out-File result.txt</code> </pre> <br><p>  Dies wird jedoch nicht gespeichert, wenn sowohl die Eingabe- als auch die Ausgabedatei der Filterbedingung entsprechen </p><br><h4 id="ps">  PS </h4><br><p>  Ich verwende PowerShell Version 5.1.17134.407.  Übrigens habe ich beim Versuch, es herauszufinden, alle Methoden / Logik und den gesunden Menschenverstand ausprobiert, die ich kenne (nämlich Flags wie <strong><em>-Version --version -v -h</em></strong> ).  Aber das hat nicht geholfen.  Hat wie immer Stackoverflow geholfen.  Hier erfahren Sie, wie Sie die Version von PowerShell herausfinden </p><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$PSVersionTable</span></span>.PSVersion</code> </pre> <br><p>  Diese Antwort hat fast 3.000 Likes gesammelt!  Dies ist sicherlich weniger als die Antwort auf die Frage, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wie man vim</a> schließt, aber ich denke, es ist auch bezeichnend! </p><br><p>  Im Allgemeinen ist PowerShell wirklich eine leistungsstarke Sache (zumindest im Vergleich zu cmd.exe)!  Und natürlich werde ich es weiterhin benutzen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de433682/">https://habr.com/ru/post/de433682/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de433672/index.html">Leute, ist Ruby tot oder nicht?</a></li>
<li><a href="../de433674/index.html">Der Testtunnel der Boring Company wird heute Abend in Kalifornien eröffnet</a></li>
<li><a href="../de433676/index.html">Wer verdient mehr Geld in der IT: Büro- oder Remote-Mitarbeiter?</a></li>
<li><a href="../de433678/index.html">Krypto-Hacking - eine neue Art von Angriff auf das Rechenzentrum</a></li>
<li><a href="../de433680/index.html">Winterereignisse für die Spielebranche im HSE- und Desktop-Gamedev-Simulator</a></li>
<li><a href="../de433686/index.html">Amazon beginnt mit dem Verkauf von Apple-Produkten direkt auf seiner Website</a></li>
<li><a href="../de433688/index.html">Wie der jährliche YouTube-Event-Review den Bürgerkrieg auslöste</a></li>
<li><a href="../de433692/index.html">Fügen Sie einfach Laser hinzu, um die schwierigsten Optimierungsaufgaben zu lösen</a></li>
<li><a href="../de433696/index.html">Verlauf einer Anfrage</a></li>
<li><a href="../de433698/index.html">CSS-Philosophie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>