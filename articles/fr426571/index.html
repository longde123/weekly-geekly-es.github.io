<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💅🏼 👉 🔊 Une approche systématique de la vitesse: mesures en ligne sur le front end 🎋 🧗🏾 🐜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La commande de vitesse Yandex optimise manuellement les résultats de la recherche. Le faire à l'aveuglette est difficile et souvent tout simplement in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Une approche systématique de la vitesse: mesures en ligne sur le front end</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/426571/"> La commande de vitesse Yandex optimise manuellement les résultats de la recherche.  Le faire à l'aveuglette est difficile et souvent tout simplement inutile.  Par conséquent, la société a construit une infrastructure pour collecter des métriques, tester la vitesse et analyser les données. <br><br>  À propos des mesures à utiliser et de la façon d'optimiser tout, le développeur des interfaces Yandex <b>Andrei Prokopyuk</b> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Andre_487</a> ) le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">sait</a> . <br><br><img src="https://habrastorage.org/webt/jh/gn/r4/jhgnr48w9fhjphnfjkjcggtsdds.png"><br><br>  Le matériel est basé sur le discours d'Andrey lors de la conférence <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HolyJS</a> .  Sous la coupe - et la vidéo, et une version texte du rapport. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Whm2FMBIgA0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote>  En plus de ce rapport sur les mesures en ligne, il y a un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport d'Alexei Kalmakov</a> (également de Yandex) sur les mesures hors ligne, dans son cas il n'y a pas de version texte, mais une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vidéo</a> est disponible. </blockquote><br><br>  Les résultats de recherche Yandex se composent de nombreux blocs différents, de classes de réponses aux requêtes des utilisateurs.  Plus de 50 personnes y travaillent dans l'entreprise, et pour que le taux d'émission ne baisse pas, nous veillons en permanence au développement. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/044/4e1/e2a/0444e1e2a6db39e37b9c2a085c7433db.jpg"><br><br>  Personne ne dira que les utilisateurs préfèrent l'interface rapide à l'interface lente.  Mais avant de commencer l'optimisation, il est important de comprendre comment cela affectera votre entreprise.  Les développeurs doivent-ils passer du temps à accélérer l'interface si cela n'affecte pas les mesures commerciales? <br><br>  Pour répondre à cette question, je vais vous raconter deux histoires. <br><br><h2>  Historique de l'introduction d'une police web spécifique sur l'émission </h2><br>  Après avoir établi une expérience avec les polices, nous avons constaté que le temps moyen de rendu du contenu s'est détérioré de 3%, de 62 millisecondes.  Pas tellement si vous le prenez pour un delta dans le vide.  Le retard perceptible à l'œil nu commence avec seulement 100 millisecondes - et pourtant le temps jusqu'au premier clic a immédiatement augmenté d'un pour cent et demi. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ef/2b5/548/4ef2b5548ae1789980552312d0b92857.jpg"><br><br>  Les utilisateurs ont commencé à interagir plus tard avec la page.  Le nombre de pages cliquées a diminué de près d'un demi pour cent.  Le temps de présence sur le service a été réduit et le temps d'absence a été augmenté. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c15/215/b5f/c15215b5fb72633582890da9e018d4a4.jpg"><br><br>  Nous n'avons pas commencé à déployer la fonctionnalité avec les polices.  Après tout, ces chiffres semblent petits jusqu'à ce que vous vous souveniez de l'ampleur du service.  En réalité, un et demi pour cent - des centaines de milliers de personnes. <br><br>  De plus, la vitesse a un effet cumulatif.  Pour une mise à jour avec une part de non réclamés - 0,4% suivra de plus en plus.  Dans Yandex, ces fonctionnalités sont déployées par dizaines par jour, et si vous ne vous battez pas pour chaque part, cela ne durera pas longtemps et atteindra 10%. <br><br><h2>  Historique de la mise en cache LS </h2><br>  Cette histoire est liée au fait que nous insérons beaucoup de contenu statique dans la page. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c33/3fd/7d2/c333fd7d205cc0695c8934cb0111c820.jpg"><br><br>  En raison de sa grande variabilité, nous ne pouvons pas le compiler en un seul paquet ou le livrer avec des ressources externes.  La pratique a montré qu'avec la livraison en ligne, le rendu et l'initialisation de JavaScript sont les plus rapides. <br><br>  Une fois que nous avons décidé que l'utilisation d'un référentiel de navigateur serait une bonne idée.  Mettez tout dans localStorage et, lors des entrées suivantes sur la page, chargez-le à partir de là et ne le transmettez pas sur le réseau. <br><br>  Ensuite, nous nous sommes concentrés principalement sur les métriques «taille HTML» et «délai de livraison HTML» et avons obtenu de bons résultats sur celles-ci.  Au fil du temps, nous avons inventé de nouvelles méthodes de mesure de la vitesse, acquis de l'expérience et décidé de revérifier, de mener une expérience inverse, de désactiver l'optimisation. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b9/37c/2c9/3b937c2c9c4f0a85c2e76a26d6fdfacf.jpg"><br><br>  Le délai de livraison HTML moyen (la métrique clé au moment du développement de l'optimisation) a augmenté de 12%, ce qui est beaucoup.  Mais en même temps, le temps jusqu'à ce que l'en-tête soit dessiné, avant le début de l'analyse du contenu et avant l'initialisation de JavaScript.  Réduit également le temps au premier clic.  Le pourcentage est petit - 0,6, mais si vous vous souvenez de l'échelle ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f88/35c/0fd/f8835c0fdce5780914f129f41f445f8d.jpg"><br><br>  En désactivant l'optimisation, nous avons obtenu une détérioration de la métrique, visible uniquement pour les spécialistes, et en même temps, une amélioration notable pour l'utilisateur. <br><br>  On peut en tirer les conclusions suivantes: <br><br>  Premièrement, la vitesse affecte vraiment les affaires et les mesures commerciales. <br><br>  Deuxièmement, les optimisations doivent être précédées de mesures.  Si vous implémentez quelque chose, après avoir fait de mauvaises mesures, il est probable que vous ne ferez rien d'utile.  La composition de l'audience, la flotte d'appareils, les scénarios d'interaction et les réseaux sont différents partout, et vous devez vérifier ce qui fonctionnera exactement pour vous. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0bf/2c6/06b/0bf2c606bacfb7bc5769594fbc326a52.jpg"><br><br>  Une fois, Ash nous a appris des morts sinistres d'abord à tirer, puis à penser ou à ne pas penser du tout.  En vitesse, vous n'avez pas à le faire. <br><br>  Et le troisième point: les mesures doivent refléter l'expérience utilisateur.  Par exemple, la taille HTML et le délai de livraison sont des mesures de vitesse médiocres car l'utilisateur ne s'assoit pas avec devTools et ne sélectionne pas un service avec moins de retard.  Mais quelles mesures sont bonnes et correctes - nous le dirons plus loin. <br><br><h2>  Quoi et comment mesurer? </h2><br>  Les mesures doivent commencer par quelques mesures clés qui, contrairement, par exemple, à la taille HTML, sont proches de l'expérience utilisateur. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec1/3c5/783/ec13c57830d7b1b3b8380273dda5bbc8.jpg"><br><br>  Si TTFCP (temps avant la première peinture complète) et TTFMP (temps avant la première peinture significative) indiquent le temps jusqu'au premier rendu du contenu et le temps avant le rendu du contenu significatif, alors le troisième est le temps jusqu'à ce que le cadre soit initialisé, cela vaut la peine d'être expliqué. <br><br>  C'est le moment où le framework a déjà traversé la page, collecté toutes les données nécessaires et bloqué les gestionnaires.  Si l'utilisateur clique quelque part à ce moment, il recevra une réponse dynamique. <br><br>  Et la dernière, quatrième métrique, le temps jusqu'à la première interactivité, est généralement appelée temps à interactif (TTI). <br><br>  Ces métriques, contrairement à la taille html ou au délai de livraison, sont proches de l'expérience utilisateur. <br><br><h2>  Il est temps de peindre le premier contenu </h2><br>  Pour mesurer le moment où l'utilisateur a vu le premier contenu de la page, il existe une API de synchronisation de peinture, disponible jusqu'à présent uniquement en chrome.  Les données peuvent être obtenues de la manière suivante. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e16/80a/c27/e1680ac270e35eaad20070c90e47066d.jpg"><br><br>  Avec cet appel, nous obtenons un ensemble d'événements de rendu.  Jusqu'à présent, deux types d'événements sont pris en charge: la première peinture - tout rendu et la première peinture de contenu - tout rendu de contenu autre que le fond blanc de l'onglet vide et le contenu d'arrière-plan de la page. <br><br>  Nous obtenons donc un tableau d'événements, filtrons la peinture en premier contenu et envoyons avec un certain ID. <br><br><h2>  Temps de première peinture significative </h2><br>  Il n'y a aucun événement dans l'API Paint Timing signalant qu'un contenu significatif a été rendu sur la page.  Cela est dû au fait que ce contenu sur chaque page est différent.  Si nous parlons de service vidéo, l'essentiel est le joueur, dans les résultats de recherche - le premier résultat non publicitaire.  Il existe de nombreux services et une API universelle n'a pas encore été développée.  Mais ici, de bonnes béquilles éprouvées entrent en jeu. <br><br>  Il y a deux écoles de béquilles dans Yandex pour mesurer cette métrique: en utilisant RequestAnimationFrame et en mesurant avec InterceptionObserver. <br><br>  Dans RequestAnimationFrame, le rendu est mesuré à l'aide d'un intervalle. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/22b/dfe/945/22bdfe945df84617220936267638cc21.jpg"><br><br>  Supposons qu'il existe un contenu significatif.  Voici une div avec le contenu principal de la classe.  Un script est placé devant, où RequestAnimationFrame est appelé deux fois. <br><br>  Dans le rappel du premier appel, écrivez la limite inférieure de l'intervalle.  Dans le rappel de la seconde - le haut.  Cela est dû à la structure de trame que le navigateur rend. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/79d/783/a88/79d783a883b6a718095228cfbea29469.jpg"><br><br>  Le premier est l'exécution de JavaScript, puis l'analyse des styles, puis le calcul de la mise en page, du rendu et de la composition. <br><br>  Le rappel, appelant RequestAnimationFrame, est activé au même stade que JavaScript et le contenu est rendu dans la dernière section du cadre lors de la composition.  Par conséquent, lors du premier appel, nous n'obtenons que la limite inférieure, sensiblement supprimée dans le temps de la sortie des pixels à l'écran. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/81c/788/f38/81c788f38c68e241cf3a34612503f9d0.jpg"><br><br>  Placez deux cadres côte à côte.  On peut voir qu'à la fin du premier d'entre eux le contenu a été rendu.  Nous écrivons la bordure inférieure de RequestAnimationFrame, appelée à l'intérieur du premier rappel, et rappelons dans la deuxième trame.  Ainsi, nous obtenons l'intervalle de JavaScript appelé dans le cadre où le contenu a été rendu en JavaScript dans le deuxième cadre. <br><br><h2>  InterceptionObserver </h2><br>  Notre deuxième béquille avec le même contenu fonctionne différemment.  Cette fois, le script est placé ci-dessous.  Nous y créons InterceptionObserver et souscrivons à domNode. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd6/dea/87d/fd6dea87dd53e374e2ba19aa79d4a379.jpg"><br><br>  Nous ne transmettons pas de paramètres supplémentaires, nous mesurons donc son intersection avec la fenêtre.  Cette heure est enregistrée comme l'heure exacte du rendu. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/549/5ab/d02/5495abd0268d0d59077d00ade282989a.jpg"><br><br>  Cela fonctionne parce que l'intersection du contenu principal et de la fenêtre est l'intersection exacte que l'utilisateur voit.  Cette API a été conçue pour savoir exactement quand un utilisateur a vu une annonce, mais nos recherches ont montré que cela fonctionne également sur des blocs non publicitaires. <br><br>  De ces deux méthodes, il est toujours préférable d'utiliser RequestAnimationFrame: son support est plus large, et il est mieux testé par nous en pratique. <br><br><h2>  Js inited </h2><br>  Imaginez un framework qui a une sorte d'événement «init» auquel vous pouvez vous abonner, mais rappelez-vous qu'en pratique, JS Inited est à la fois une métrique simple et complexe. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3bf/6fe/85c/3bf6fe85c743f0ad6c255d8e4c448eae.jpg"><br><br>  Simple - car il vous suffit de trouver le moment où le framework a terminé l'organisation des événements.  Complexe - car vous devez rechercher ce point par vous-même pour chaque framework. <br><br><h2>  Temps d'interactivité </h2><br>  TTI est souvent confondu avec la métrique précédente, mais en fait c'est un indicateur du moment où le flux principal du navigateur est libéré.  Pendant le chargement de la page, de nombreuses tâches sont effectuées: du rendu de divers éléments à l'initialisation du framework.  Ce n'est que lorsqu'il est déchargé que vient le temps de la première interactivité. <br><br>  Le concept de tâches longues et l'API Long Task aident à mesurer cela. <br><br>  Tout d'abord sur les longues tâches. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f79/67b/828/f7967b8283a7302b1d8d9b1bd076cfac.jpg"><br><br>  Entre les courtes tâches indiquées par des flèches, le navigateur peut facilement entasser le traitement d'un événement utilisateur, par exemple une entrée, car il a une priorité élevée.  Mais avec les longues tâches indiquées par les flèches rouges, cela ne fonctionnera pas. <br><br>  L'utilisateur devra attendre jusqu'à épuisement, et seulement après que le navigateur aura procédé au traitement de sa saisie.  Dans le même temps, le framework peut déjà être initialisé, et les boutons fonctionneront, mais lentement.  Une telle réponse différée est une expérience utilisateur plutôt désagréable.  Au moment où la dernière tâche longue est terminée et le thread est vide depuis longtemps, l'illustration arrive à 7 secondes et 300 millisecondes. <br><br>  Comment mesurer cet intervalle à l'intérieur de JavaScript? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/66f/f1b/114/66ff1b114d718aa4e31cf8c2f1094525.jpg"><br><br>  La première étape est conditionnellement désignée comme la balise d'ouverture du corps, après quoi vient le script.  Cela crée un PerformanceObserver qui s'abonne à l'événement de tâche longue.  Dans le PerformanceObserver de rappel, les informations sur les événements sont collectées dans un tableau. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3e3/1c4/c60/3e31c4c60298c19431ca84a93c908394.jpg"><br><br>  Après avoir collecté les données, le moment est venu pour la deuxième étape.  Il est désigné sous forme de balise de fermeture.  Nous prenons le dernier élément du tableau, la dernière longue tâche, regardons le moment de son achèvement et vérifions si suffisamment de temps s'est écoulé. <br><br>  Dans le travail original sur cette métrique, 5 secondes ont été prises comme constante, mais le choix n'a été aucunement étayé.  Cela s'est avéré suffisant pour 3 secondes.  Si 3 secondes s'écoulent, nous comptons le temps jusqu'à la première interactivité; sinon, nous réglons Timeout et vérifions à nouveau cette constante. <br><br><h2>  Comment traiter les données? </h2><br>  Les données doivent être reçues des clients, traitées et présentées de manière pratique.  Notre concept d'envoi de données est assez simple.  Cela s'appelle un compteur. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/38f/158/cba/38f158cbaf1233223fdca1ba255f9e25.jpg"><br><br>  Nous transférons les données d'une certaine métrique vers un stylo spécial sur le backend et les collectons dans le référentiel. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/884/cda/04a/884cda04a3b619b084dfde376a0645cc.jpg"><br><br>  Ici, l'agrégation de données est classiquement désignée comme une requête SQL.  Voici les principales agrégations que nous considérons généralement en fonction des métriques de vitesse: moyenne arithmétique et groupe centile (50e, 75e, 95e, 99e). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/354/84a/d7c/35484ad7c51d967118abb42646a09801.jpg"><br><br>  La moyenne arithmétique dans notre série numérique est presque 1900. Elle est sensiblement plus grande que la plupart des éléments de l'ensemble, car cette agrégation est très sensible aux valeurs aberrantes.  Cette propriété nous est toujours utile. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d6b/2ac/b00/d6b2acb00b844c6294fa80a50e03495c.jpg"><br><br>  Afin de calculer les centiles pour le même ensemble, triez-le et placez le pointeur sur l'index des centiles.  Disons le 50e, qui est aussi appelé la médiane.  Nous tombons entre les éléments.  Dans ce cas, vous pouvez sortir de la situation de différentes manières, nous calculons la moyenne entre elles.  Nous obtenons 150. Par rapport à la moyenne arithmétique, on voit clairement que les centiles sont insensibles aux valeurs aberrantes. <br><br>  Nous prenons en compte et utilisons ces fonctionnalités d'agrégation.  La sensibilité arithmétique des émissions est un inconvénient si vous essayez d'évaluer l'expérience utilisateur avec.  En effet, un utilisateur peut toujours se connecter au réseau, par exemple depuis un train, et gâcher la sélection. <br><br>  Mais la même sensibilité est un avantage en matière de monitoring.  Afin de ne pas rater un problème important, nous utilisons la moyenne arithmétique.  Il se déplace facilement, mais le risque de faux positifs dans ce cas n'est pas un gros problème.  Mieux vaut négliger que négliger. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dcb/e92/a6b/dcbe92a6baf2a4ec1e2ef01580dd948d.jpg"><br><br>  De plus, nous considérons la médiane (si nous l'attachons aux métriques de temps, la médiane est un indicateur de l'heure à laquelle 50% des demandes correspondent) et le 75e centile.  75% des demandes correspondent à ce moment, nous considérons cela comme une estimation de la vitesse globale.  Les 95e et 99e centiles sont considérés comme mesurant la longue queue lente.  Ce sont de très grands nombres.  Le 95e est considéré comme la demande la plus lente.  Le 99e centile est anormal. <br><br>  Il ne sert à rien de compter le maximum.  C'est le chemin de la folie.  Après avoir calculé le maximum, il peut s'avérer que l'utilisateur attend le chargement de la page depuis 20 ans. <br><br>  Après avoir considéré les agrégations, il ne reste plus qu'à appliquer ces nombres, et la chose la plus évidente qui puisse être faite avec eux est de les présenter sous forme de graphiques. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8d/552/3e9/e8d5523e9eeebf2545a7f214b75b8ede.jpg"><br><br>  Sur le graphique, notre temps réel pour les premières mesures de peinture de contenu pour la recherche.  La ligne bleue reflète la dynamique des ordinateurs de bureau, la rouge - pour les appareils mobiles. <br><br>  Nous devons constamment surveiller les graphiques de vitesse et nous avons confié cette tâche au robot. <br><br><h2>  Suivi </h2><br>  Étant donné que les mesures de vitesse sont volatiles et fluctuent constamment avec différentes périodes, la surveillance doit être affinée.  Pour cela, nous utilisons le concept de frustrations. <br><br>  Le débogage est le moment où un processus aléatoire modifie ses caractéristiques, telles que la variance ou l'attente mathématique.  Dans notre cas, il s'agit de l'échantillon moyen.  Comme mentionné, la moyenne est sensible aux émissions et bien adaptée à la surveillance. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/621/9a7/c0b/6219a7c0bc99aef5991cda07179a487a.jpg"><br><br>  Voici un exemple de graphique où l'alignement s'est produit et où le robot a enregistré l'incident.  Comment a-t-il isolé ce moment de plusieurs autres hésitations?  Pour comprendre cela, nous imposons des données supplémentaires. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/93e/d21/ec4/93ed21ec4f2a624e3d703dc90b2c2530.jpg"><br><br>  Le graphique jaune est un indicateur métrique, et le graphique bleu est une moyenne mobile avec une période suffisamment longue.  Le rouge est la moyenne plus trois écarts-types.  Le vert est le même, seulement avec un signe moins. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c8/899/b90/4c8899b90f7e2696100aa4c7069a868c.jpg"><br><br>  Les indicateurs rouges et verts forment un couloir sûr.  Alors que la métrique et la moyenne mobile fluctuent entre elles - tout est normal, ce sont des fluctuations ordinaires.  Mais s'ils quittent la zone de sécurité, la surveillance est déclenchée. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9fb/d41/25e/9fbd4125ece689bd90a84e520304fd3a.jpg"><br><br><h2>  Vérification des fonctionnalités pour la vitesse </h2><br>  Tout ce qui a été discuté était de travailler avec les données de vitesse d'un projet déjà lancé, mais je veux mesurer la vitesse des fonctionnalités individuelles avant de les envoyer à une grande production.  Pour ce faire, nous utilisons les tests A / B - une comparaison des métriques pour les groupes de contrôle et expérimentaux. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/819/128/e94/819128e94c08fec52e22da5914d28cbe.jpg"><br><br>  Nous divisons les utilisateurs en groupes de contrôle et expérimentaux.  Les lectures de chaque créneau sont collectées séparément, agrégées et tabulées. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/31d/89b/1eb/31d89b1eb1915e2a0f8f29bc986f0521.jpg"><br><br>  Dans les tests A / B, en règle générale, la moyenne arithmétique est également utilisée.  Nous voyons ici un delta et, afin de déterminer avec précision s'il s'agit d'un accident ou d'un résultat significatif, un test statistique est appliqué. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e78/37d/134/e7837d1340c59e00cf61a132c6ac72c9.jpg"><br><br>  Il est désigné comme «MW» car le test de Mann-Whitney est utilisé dans le calcul.  Avec son aide, le soi-disant "pourcentage d'exactitude" est calculé.  Cet indicateur a un seuil, après lequel nous considérons le delta comme vrai.  Ici, il est fixé à 99,9%. <br><br>  Lorsque le test atteint cette valeur, le delta est mis en surbrillance dans l'interface.  Nous l'appelons coloration.  Ici, nous voyons le vert, c'est-à-dire une bonne coloration à temps pour la première peinture pleine de contenu.  Le temps de la première peinture significative n'atteint pas cette valeur, c'est-à-dire que le delta est également bon, mais pas 99,9%.  Il est totalement impossible de lui faire confiance.  Lors de l'initialisation du cadre et du temps d'interactivité, une coloration rouge confiante est observée.  On peut en tirer la même conclusion que dans le cas des polices. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/25b/415/b14/25b415b14b30b25549f514aced7b52dd.jpg"><br><br><h2>  Comment le faire soi-même? </h2><br>  Vous pouvez implémenter des mesures de vitesse de deux manières.  La première consiste à tout faire vous-même. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e30/344/cb5/e30344cb56179ed9a633ff26c187291e.jpg"><br><br>  Une poignée pour recevoir des données des clients, un backend, qui met tout cela dans une base de données, MongoDB, PostgreSQL, MySQL, n'importe quel SGBD (ils ont des agrégations hors de la boîte), plus l'une des nombreuses solutions open source - afin de dessiner des graphiques et d'organiser la surveillance. <br><br>  La deuxième solution consiste à utiliser les systèmes d'analyse Yandex Metric ou Google Analytics.  Sur l'exemple de Yandex Metrics, cela ressemble à ceci. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/424/a97/f61/424a97f61a797dff9419d7df8828046b.jpg"><br><br>  Voici les mesures que la mesure fournit à l'utilisateur hors de la boîte.  Bien sûr, ce n'est pas tout ce qui précède, mais déjà quelque chose.  Le reste peut être ajouté manuellement via les paramètres utilisateur.  Des tests et une surveillance A / B sont également disponibles. <br><br><h2>  Conclusion </h2><br>  Le concept de mesure de vitesse en ligne dont nous avons parlé est connu sous le nom de RUM - Real User Monitoring.  Nous l'aimons tellement que nous avons même dessiné un logo avec un tréma rock and roll cool. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e5f/8a9/448/e5f8a94489f01743c09e5ec04453cc56.jpg"><br><br>  Cette approche est bonne car elle est basée sur des chiffres du monde réel, ces indicateurs dont dispose l'audience de votre service.  À l'aide de mesures, vous semblez obtenir des commentaires de chaque utilisateur.  Alors commencez à optimiser et ne vous arrêtez pas. <br><blockquote>  L'annonce à la fin.  Si vous avez aimé cette conversation avec <b>HolyJS 2018 Piter</b> , vous serez probablement intéressé par le prochain <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">HolyJS 2018 Moscou</a></b> , qui se <b>tiendra du 24 au 25 novembre</b> .  Là, vous pouvez non seulement voir de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nombreux autres</a> rapports JS, mais aussi demander à n'importe quel orateur dans la zone de discussion après le rapport.  Et demain, à partir du 1er novembre, le prix des billets augmentera jusqu'à la finale, c'est donc aujourd'hui la dernière occasion de les acheter à prix réduit! </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr426571/">https://habr.com/ru/post/fr426571/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr426559/index.html">Réseaux de neurones pour le traitement d'images. Dit Alexander Savsunenko de Skylum Software</a></li>
<li><a href="../fr426561/index.html">The Great Five: doit avoir des outils pour accélérer le développement</a></li>
<li><a href="../fr426563/index.html">Carnet d'adresses hiérarchique, changement d'e-mail principal et autres innovations dans Zimbra 8.8.10</a></li>
<li><a href="../fr426565/index.html">«Le monde Java ne sera plus jamais le même» - entretien avec Alexander Belokrylov et Alexey Voitilov de BellSoft</a></li>
<li><a href="../fr426567/index.html">Le livre «Chaos mathématique. Des mathématiques élémentaires aux abstractions sublimes »</a></li>
<li><a href="../fr426573/index.html">ZeroNights 2018. Recharger</a></li>
<li><a href="../fr426575/index.html">Rapport du Club de Rome 2018, chapitre 1.12: «D'un monde vide à un monde complet»</a></li>
<li><a href="../fr426579/index.html">Engie et Ledger développent une solution de blockchain matérielle pour stocker les données générées par les sources d'énergie verte</a></li>
<li><a href="../fr426581/index.html">Ouvrir la leçon "Présentation des fonctionnalités de Node.js"</a></li>
<li><a href="../fr426583/index.html">Dix personnes sur 90 mille sites: comment ne pas devenir fou</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>