<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👄 🖕🏼 🍧 Zeitcheck: Timejacking gegen Bitcoin ✴️ 👼🏻 🎶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Im Wettbewerb um das beliebteste Wort des Jahres würde das Wort „Blockchain“ wahrscheinlich der Gewinner der IT-Sphäre werden. Trotz der Tatsache, das...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Zeitcheck: Timejacking gegen Bitcoin</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/neobit/blog/413721/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/32/86/rv/3286rvioxsavz1pt8i6sqrd0n4c.jpeg"></div><br><br>  Im Wettbewerb um das beliebteste Wort des Jahres würde das Wort „Blockchain“ wahrscheinlich der Gewinner der IT-Sphäre werden.  Trotz der Tatsache, dass es eine <s>ungesunde</s> Tendenz gibt, es überall aktiv einzuführen - in der Medizin, der Wirtschaft, dem Internet der Dinge, der Aufzucht von Kaninchen und der Herstellung von Kuchen bleiben Kryptowährungen der Hauptbereich der Blockchain.  Und jeder weiß: virtuelle Geldbörsen für Hacker - wie eine Katze mit saurer Sahne. <br><br>  In diesem Artikel werden wir den "Timejacking" -Angriff betrachten, der auf der Sicherheitsanfälligkeit bei der Verarbeitung von Zeitstempeln von Blöcken im Bitcoin-Kryptowährungssystem basiert, und versuchen zu erklären, warum der Angriff erfolgt und seine erfolgreiche Implementierung nicht. <br><br>  PS Es wird viele Ableitungen des Wortes "Zeit" geben.  Sehr viel. <br><a name="habracut"></a><br><h2>  <b>Kurzgesagt</b> </h2><br>  Zum ersten Mal schrieb Alex Boverman über den Timejacking-Angriff.  Hier können Sie sich mit der Veröffentlichung vertraut machen.  Was ist das Wesentliche: Der Angriff nutzt Schwachstellen des Mechanismus aus, um die Zeitstempel von Blöcken und den Zeitzähler in Bitcoin zu überprüfen.  Der Angreifer manipuliert einen der Zeitzähler des Opferknotens und erstellt einen „vergifteten“ Block.  Das Opfer wird diesen Block fallen lassen und der Rest des Netzwerks wird erfolgreich akzeptieren, und bitte - wir haben eine Gabelung provoziert!  Das gesamte Netzwerk verwendet eine Kette von Blöcken, die nach dem „vergifteten“ Block erstellt wurden, und das Opfer betrachtet eine alternative Kette mit wiederholten Token-Ausgaben (auch als Doppelausgaben bezeichnet), in der der „vergiftete“ Block nicht angezeigt wird, als gültig. <br><br>  Der Angriff erfolgt in zwei Schritten.  Um es klarer zu machen, lassen Sie uns über jeden von ihnen einzeln sprechen. <br><br><h2>  <b>Akt 1. Eine Gabel erstellen und das Opfer isolieren</b> </h2><br>  Ein Angreifer muss einen „APPLE of Contention“ generieren - den sehr „vergifteten“ Block, den das Opfer ignoriert.  Auf die gleiche Weise lässt das Opfer andere Blöcke fallen, die nacheinander nach dem „vergifteten“ hinzugefügt werden. <br><br>  <b>Wie kann man ein Opfer austricksen und es zwingen, den richtigen Block fallen zu lassen?</b> <br><br>  Der Header jedes Blocks hat einen Zeitstempel, den der Knoten während der Überprüfung überprüft.  Dieser Wert sollte in einen bestimmten Bereich fallen, wir nennen ihn ein temporäres Fenster.  Der Zeitfensterbereich ist in der folgenden Abbildung dargestellt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/mu/go/fsmugohtfy3uilmc0iyf2u7fp6a.jpeg"></div><br>  Das Zeitfenster hat zwei Grenzen: <br><br><ul><li>  niedriger - <b>t <sub>min</sub></b> , entspricht dem Median der Zeitstempel von 11 Blöcken vor dem verifizierten Block </li><li>  obere - entspricht dem Wert der Netzwerkzeit t <sub>0</sub> + 2 Stunden </li></ul><br>  Der Wert des Zeitstempels des Blocks wird nicht in Bezug auf die Systemzeit des Knotens überprüft, sondern in Bezug auf die Medianzeit seiner Nachbarn - Netzwerkzeit (auch als netzwerkangepasste Zeit bezeichnet). <br><br>  Wie wird die Netzwerkzeit berücksichtigt: <br><br><ul><li>  Wenn eine neue Verbindung hergestellt wird, tauschen Knoten ihre Systemzeit aus </li><li>  Jeder Knoten berechnet die Abweichung seiner eigenen Systemzeit von der Systemzeit jedes seiner Nachbarn </li><li>  Für berechnete Abweichungen wird der Medianwert ausgewählt. </li><li>  Native Systemzeit + Medianabweichung = <b>Netzwerkzeit</b> </li></ul><br>  Hier ist ein Beispiel für die Berechnung der Netzwerkzeit: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zw/dm/eu/zwdmeuayfjs0vslokmwolesugo4.jpeg"></div><br>  Auf diese Weise kann ein Angreifer den Wert der Netzwerkzeit des Opfers manipulieren, indem er eine ausreichende Anzahl von Nachbarn mit ihm verbindet, die die verzögerte Systemzeit ankündigen.  Der Wert der Netzwerkzeit des Opfers nimmt ab - die Obergrenze des Bereichs zulässiger Werte des Zeitstempels des verifizierten Blocks nimmt ab.  Wenn die Abweichung der Zeit des Nachbarn <a href="">70 Minuten</a> überschreitet, wird seine Zeit bei der Berechnung der Netzwerkzeit nicht berücksichtigt.  Daher beträgt der maximale Wert, um den die Netzwerkzeit des Opfers reduziert werden kann, 70 Minuten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/yq/dk/wnyqdkckyddzalio-mzl9m-i7b0.jpeg"></div><br>  Dementsprechend ist unser "vergifteter" Block ein Block, dessen Zeitstempel in das Zeitfenster aller Netzwerkknoten mit Ausnahme des Opfers fallen sollte.  Nur dann wird das gesamte Netzwerk es erfolgreich akzeptieren, und das Opfer, dessen Netzwerkzeit geändert wird, wird es nicht weniger erfolgreich löschen.  In der folgenden Abbildung das Zeitfenster des Opfers im Vergleich zum Zeitfenster der verbleibenden Knoten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-k/jf/yc/-kjfycci5-wji1inohzrlxujg4e.jpeg"></div><br>  Beachten Sie, dass wir dank des NTP-Protokolls davon ausgehen können, dass für die meisten Knoten die Systemzeit ungefähr gleich ist, d. H. Die Netzwerkzeit jedes Knotens liegt nahe an ihrer Systemzeit. <br><br>  Infolgedessen ist das Opfer vom Hauptnetzwerk isoliert und betrachtet die Hauptblockkette als falsch, die von den übrigen Knoten aus dem "vergifteten" Block erstellt wird.  Gleichzeitig akzeptiert das Opfer sicher die anderen Blöcke, die vom Angreifer für die alternative Kette hilfreich generiert wurden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/44/7z/6t/447z6t74qbyjwqnzzjhnxgog6le.jpeg"></div><br><h2>  <b>Akt 2. Doppelte Ausgaben</b> </h2><br>  Zu diesem Zeitpunkt generiert der Angreifer eine alternative Kette, in der er eine Transaktion hinzufügt, die Token in die Brieftasche des Opfers überträgt.  Alternative Kettenblöcke werden an das Opfer gesendet.  In der folgenden Abbildung - der Wertebereich des Zeitstempels des "vergifteten" Blocks. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gb/lx/ig/gblxigftue4b3qftdlldapqed40.jpeg"></div><br>  Das Opfer wird diese Kette akzeptieren, da der Eindringling den Wert der Zeitstempel aus seinem eigenen Zeitfenster ausgewählt hat und die verbleibenden Knoten ihn zu Recht ignorieren - schließlich bauen sie ihre Kette bereits aus dem „vergifteten“ Block, der länger als die Alternative ist.  Infolgedessen glaubt das Opfer, Token erhalten und die Waren gesendet zu haben.  Und das Hauptnetzwerk ist sich sicher, dass die Token die Brieftasche des Angreifers nicht verlassen haben und er die Ware für "Danke" erhält - schließlich können sich die meisten nicht irren.  Finale, der Held der dunklen Seite triumphiert! <br><br><h2>  <b>Aber nicht so einfach</b> </h2><br>  <b>Fallstricke Nr. 1</b> <br><br>  Beim Bitcoin-Mining ist heute eine enorme Rechenleistung erforderlich.  Die Wahrscheinlichkeit einer erfolgreichen Erzeugung eines "vergifteten" Blocks kann durch die folgende Formel geschätzt werden: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/js/4u/ddjs4uoct9fzcc3lajt9qwz8_ca.png"></div><br>  Heute beträgt die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gesamt-</a> Hash- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Rate des</a> Bitcoin-Netzwerks ungefähr H = 34 ∙ 10 <sup>18</sup> Hash / s.  In diesem Fall beträgt bei Verwendung des produktivsten Geräts aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieser Liste</a> , dessen deklarierte Hash-Rate h = 18 ∙ 10 <sup>12</sup> Hash / s beträgt, die Wahrscheinlichkeit, in 1 Jahr einen „vergifteten“ Block zu erzeugen (t = 365 ∙ 24 ∙ 60), ungefähr 3%.  Wenn wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesen Statistiken einen</a> relativ kleinen Mining-Pool entnehmen, der 0,3% der gesamten Hash-Rate ausmacht, beträgt die Wahrscheinlichkeit einer erfolgreichen Blockgenerierung innerhalb von 3 Tagen 73%. <br><br>  <b>Fallstricke Nr. 2</b> <br><br>  Im Laufe der Zeit des Netzwerks des Opfers fällt der Zeitstempel des "vergifteten" Blocks schließlich in das Zeitfenster des Opfers.  Dann ändert das Opfer die alternative Kette in die Hauptkette, da das gesamte Netzwerk daran arbeitet und die Höhe größer ist.  Der "vergiftete" Block fällt in nicht mehr als 70 Minuten in das Zeitfenster des Opfers - dies ist die maximale Zeit, für die die zweite Stufe abgeschlossen werden muss. <br><br>  Damit das Opfer die Transaktion mit doppelten Ausgaben akzeptieren kann, muss der Block mit weiteren 6 Blöcken (für einen Standardkunden) bestätigt werden.  Der Übertreter muss selbstständig Bestätigungsblöcke generieren, und gleichzeitig müssen die oben genannten 70 Minuten eingehalten werden.  Boverman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">betrachtet eine</a> Situation, in der ein Angreifer 10% der Leistung des gesamten Netzwerks besitzt.  In einer solchen Situation dauert es ~ 5,5 Stunden, um 6 Blöcke mit einer Erfolgsrate von 10% zu generieren.  Für 3,3 Stunden sinkt die Erfolgswahrscheinlichkeit für 140 Minuten auf 1% - 0,147%.  Nach diesen Schätzungen ist es eine Fantasie, 6 Blöcke in 70 Minuten erfolgreich zu generieren. <br><br>  <b>Fallstricke Nr. 3</b> <br><br>  Wenn der Knoten die Netzwerkzeit berechnet, berücksichtigt er nur die Systemzeit der <a href="">ersten 200 Nachbarn</a> - dann wird die mittlere Abweichung nicht neu berechnet.  Dies bedeutet, dass der Angriff ausgeführt werden muss, bis die Anzahl der Nachbarn, die bereits mit dem Opfer verbunden sind, 99 nicht überschreitet. Andernfalls ist die vom Angreifer angekündigte Zeit kein Median.  Diese Anzahl von Nachbarn wird in ungefähr 24 Stunden ausgeführt, und danach muss das Opfer neu gestartet werden - beispielsweise mithilfe von DoS. <br><br><h2>  <b>Das Ende</b> </h2><br>  Zusammenfassend können wir sagen, dass der "Timejacking" -Angriff sehr gut ist, aber in den harten Realitäten wird Bitcoin nicht mehr anwendbar.  Was ist mit anderen Systemen, die Blockchain verwenden?  Lassen Sie uns diese Frage für Ihre weitere Forschung verlassen! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413721/">https://habr.com/ru/post/de413721/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413711/index.html">Vorprogramm PyConRu-2018: drei Python Core-Entwickler, Sprecher von Google, Yelp, Red Hat, Yandex</a></li>
<li><a href="../de413713/index.html">Data Warehouse-Leistung: Neue Ziffern</a></li>
<li><a href="../de413715/index.html">IT-Altersrente</a></li>
<li><a href="../de413717/index.html">GraphQL für InterSystems-Plattformen</a></li>
<li><a href="../de413719/index.html">C ++ 20 unterwegs! Treffen bei Rapperswil Yona</a></li>
<li><a href="../de413723/index.html">Saga der elektronischen Dienste und ihrer Standorte. Teil 2. Elektronischer Schrank</a></li>
<li><a href="../de413725/index.html">Arbeiten mit Arrays in Bash</a></li>
<li><a href="../de413729/index.html">Wie und warum haben wir unser ECS geschrieben?</a></li>
<li><a href="../de413731/index.html">BA / SA Arbeitsmarktforschung</a></li>
<li><a href="../de413733/index.html">Mikrosh, Krista, Apogee, Lviv - die ersten sowjetischen Computer zum Mitnehmen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>