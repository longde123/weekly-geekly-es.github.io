<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíê üñïüèΩ üëÅÔ∏è Nous travaillons avec le cobot Dobot M1 üë®üèæ‚Äçü§ù‚Äçüë®üèº üç¥ ‚ù£Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a un an sur Habr√©, la revue du robot de bureau Dobot Magician est sortie. Dans cet article, je propose d'√©valuer son fr√®re a√Æn√© Dobot M1 en actio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous travaillons avec le cobot Dobot M1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467407/">  Il y a un an sur Habr√©, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">revue du</a> robot de bureau Dobot Magician est sortie.  Dans cet article, je propose d'√©valuer son fr√®re a√Æn√© Dobot M1 en action.  J'essaierai √©galement d'expliquer pourquoi j'ai choisi ce mod√®le particulier pour mon projet, je d√©crirai le processus de d√©veloppement de la d√©mo en Qt / c ++, ainsi que certains moments d√©sagr√©ables que j'ai rencontr√©s lors du processus de d√©veloppement. <br><a name="habracut"></a><br><h1>  Pr√©sentation </h1><br>  Cette ann√©e, j'ai travaill√© dans l'un des instituts de recherche les plus courants.  Au d√©but, tout √©tait plut√¥t d√©contract√©, et l'ann√©e ne promettait rien d'int√©ressant, jusqu'√† ce qu'un jour, lors d'un rassemblement, une discussion n'ait commenc√© sur la fa√ßon de r√©aliser un assemblage carrel√© de cellules solaires (cellules solaires en bardeaux).  Cette approche n'est pas nouvelle, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">disent-ils</a> , c'est l'une des premi√®res fa√ßons d'assembler des panneaux pour les satellites spatiaux. <br><br>  Je ne sais pas √† quel point c'est vrai parce que je n'ai pas vu d'articles ou de brevets.  Mais l'int√©r√™t du public pour cette d√©cision s'est r√©chauff√©, en partie aussi parce qu'il y a quelques ann√©es, SunPower a d√©ploy√© ses nouveaux panneaux, qu'elle appelait la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s√©rie P.</a>  Il se trouve que dans le monde du photovolta√Øque, comme le sanpower fait quelque chose, alors tout le monde doit le faire aussi.  Nous y voil√†.  Tout est simple: nous pr√©parons les substrats, les coupons en bandes et assemblons.  √Ä ce moment-l√†, j'ai remarqu√© que je ne collecterais certainement rien manuellement, car mes mains ne diff√©raient pas en particulier sur la plan√©it√©.  Sinon, le r√©sultat pourrait √™tre quelque chose comme une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vid√©o</a> sur YouTube.  Et nous, apr√®s tout, nous sommes une institution enti√®re, si nous faisons vraiment quelque chose, ce n'est pas une ferme collective.  J'ai propos√© d'acheter des robots et de les configurer pour le processus souhait√©, et ils m'ont donn√© le feu vert. <br><br>  Il est √† noter que nous avons d√©cid√© de commencer plus simplement et d'assembler des mini-panneaux.  Un mini-panneau est un panneau solaire plus petit que la norme.  Nous le faisons pour tester les processus techniques.  Tout d'abord, j'ai √©t√© guid√© par un panneau d'une taille de 1 cellule solaire standard avec des plans de mise √† l'√©chelle vers un panneau de 2 x 2. La taille du c√¥t√© d'une cellule solaire est de 16 cm. Par cons√©quent, des robots √©taient n√©cessaires avec un champ d'acc√®s de 32 x 32 cm. Je voulais une pr√©cision plus pr√©cise et le prix √©tait moins cher .  Alors, arm√© d'une barre de recherche, j'ai commenc√© √† √©tudier les phrases.  J'ai d√©cid√© que 6 axes ne sont pas n√©cessaires pour le projet, 4 suffisent, donc le choix s'est limit√© aux robots comme une cicatrice.  J'ai d√©couvert que l'achat de robots industriels s'accompagne de d√©penses suppl√©mentaires, telles que la conception d'un espace de travail s√ªr et le fait de laisser l'ing√©nieur d'application sur le site d'installation, qui programme le robot pour votre t√¢che.  Les bons robots industriels sont chers en principe, et les services d'ing√©nieurs augmenteront encore le prix, de plus, il √©tait int√©ressant de mettre en ≈ìuvre le projet vous-m√™me.  Par cons√©quent, le choix s'est limit√© aux cobots, robots collaboratifs, avec des exigences de s√©curit√© moindres et plus conviviaux pour l'auto-prototypage.  J'ai donc rapidement trouv√© la soci√©t√© Dobot.  J'ai imm√©diatement laiss√© tomber le Dobot Magician en raison de la taille et de la pr√©cision, qui est de 100 microns.  Je leur ai √©crit une demande de sp√©cifications et leur ai dit o√π acheter.  J'ai d√©couvert qu'avec les API, il y a des API et elles peuvent √™tre programm√©es en C ++.  Cela me convenait, mais je ne pouvais pas simplement l'acheter directement.  Heureusement, j'ai trouv√© un fournisseur aux Pays-Bas qui m'a vendu 2 pi√®ces pour 8700 euros avec TVA, livr√© de Chine, et en m√™me temps pris en charge tout le d√©douanement. <br><br><h1>  Caract√©ristiques gentillesse </h1><br><img src="https://habrastorage.org/webt/eq/li/v_/eqliv_l21t5_qnph5vis0kjci9m.jpeg"><br><br>  Le Dobot M1 se positionne comme un robot collaboratif professionnel √† 4 axes abordable.  Il peut supporter jusqu'√† 1,5 kg de charge (non test√©), a une port√©e allant jusqu'√† 400 mm (pas partout) et une pr√©cision allant jusqu'√† 20 microns (v√©rifi√©).  L'espace de travail de la gentillesse est illustr√© dans la figure ci-dessous.  Il n'est pas difficile de remarquer qu'en raison des caract√©ristiques de conception, il y a une zone aveugle avec un rayon l√©g√®rement inf√©rieur √† 15 centim√®tres √† l'avant.  De plus, cette carte spatiale ne prend pas en compte l'orientation de la main.  Le Dobot peut √™tre droitier ou gaucher, je n'ai toujours pas compris comment cela peut √™tre activ√© en d√©placement sans √©talonnage suppl√©mentaire.  Par d√©faut, Dobot est droitier, ce qui signifie que la zone droite est limit√©e par la zone d'acc√®s de la 2e articulation, lorsque la premi√®re articulation est dirig√©e vers la droite.  La zone r√©elle de l'espace de travail repr√©sente donc environ les 2/3 de ce qui est indiqu√© dans le dessin officiel. <br><br><img src="https://habrastorage.org/webt/qf/bv/dp/qfbvdpisi2sc2pbc62vg38miyko.png"><br><br>  Goodness dispose de ports d'E / S: entr√©es et sorties num√©riques avec des niveaux de 24 V (les niveaux par d√©faut sont √©lev√©s), ainsi que des entr√©es analogiques.  Quel type d'ADC est l√†, je ne sais pas.  Des ports sont disponibles sur le panneau arri√®re du support et sur la main elle-m√™me pour travailler avec des buses.  J'ai oubli√© de photographier le connecteur sur le bras lui-m√™me, mais c'est un type de CAA.  Il existe √©galement une interface d'extension pour laquelle vous pouvez acheter des frais suppl√©mentaires.  Dobot se connecte √† un PC via RS-232 ou via un r√©seau. <br><br><img src="https://habrastorage.org/webt/wx/jp/tx/wxjptxd8lxcgzk7z7orkbmi-hri.png"><br><br>  Mat√©riaux de fabrication du bo√Ætier: polycarbonate, apparemment, plus un support en m√©tal peint en noir.  Cette conception ne provoque pas un sentiment de prime, mais aussi un sens de l'artisanat.  J'en ai achet√© un enti√®rement charg√© et un dans la base.  Je n'ai pas test√© la buse laser et l'impression 3D. <br><br>  Pour tester la qualit√© de la gentillesse, j'ai utilis√© le programme M1Studio pour Windows, qui est t√©l√©charg√© sur le site Web de l'entreprise.  Mais c‚Äôest tout.  De plus, arm√© d'api, de Qt et d'un poste de travail avec des gu√™pes √©l√©mentaires, je me suis assis pour √©crire une d√©mo pour travailler avec plusieurs hauts et bas. <br><br><h1>  Nous √©crivons une d√©mo </h1><br>  En fait, la d√©mo est d√©j√† disponible sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> .  La documentation de l'API et du protocole de communication peut √™tre t√©l√©charg√©e sur le site Web du fabricant. <br><br>  Tout d'abord, nous avons utilis√© la m√©thode SearchDobot () de l'API, qui ne montrait rien sous Linux, et ne fonctionnait dans Windows que si le dobot √©tait connect√© via RS-232.  C'est √©trange, car M1Studiya d√©finit parfaitement dobotov sur le r√©seau.  Avec des adresses IP connues, la m√©thode ConnectDobot () fonctionne tr√®s bien.  C'est bon, je pensais, je vais configurer le routeur et laisser l'adresse IP √™tre attach√©e au coquelicot.  Le lendemain, j'ai √©t√© surpris par le fait que les bont√©s ne r√©agissent pas.  Il s'est av√©r√© que lorsqu'il est allum√©, le dobot a une adresse de pavot al√©atoire.  C'est une telle fonctionnalit√© du firmware, qui a √©t√© corrig√© dans la nouvelle version en mai, mais que j'avais cependant peur d'installer. <br><br>  Arm√© d'un programme d'analyse des paquets r√©seau, j'ai d√©couvert que Dobot r√©pondait √† la demande UDP du port 6000 avec le texte ¬´WhoisDobotM1¬ª r√©ponse UDP avec du texte contenant le num√©ro de mod√®le du Dobot.  Sur cette base, une m√©thode personnalis√©e a √©t√© √©crite qui envoie des requ√™tes sur l'ensemble du sous-r√©seau et, dans le cas d'une r√©ponse, initialise la gentillesse. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MainWindow::on_buttonSearch_clicked() { QHostAddress host; QList&lt;QHostAddress&gt; <span class="hljs-built_in"><span class="hljs-built_in">list</span></span> = QNetworkInterface::allAddresses(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-built_in"><span class="hljs-built_in">list</span></span>.count(); i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((!<span class="hljs-built_in"><span class="hljs-built_in">list</span></span>.at(i).isLoopback()) &amp;&amp; (<span class="hljs-built_in"><span class="hljs-built_in">list</span></span>.at(i).protocol() == QAbstractSocket::IPv4Protocol)) host = <span class="hljs-built_in"><span class="hljs-built_in">list</span></span>.at(i); } QString subnet = host.toString().section(<span class="hljs-string"><span class="hljs-string">'.'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>) + <span class="hljs-string"><span class="hljs-string">"."</span></span>; QByteArray data = <span class="hljs-string"><span class="hljs-string">"WhoisDobotM1"</span></span>; QUdpSocket udpSocketSend; udpSocketSend.writeDatagram(data);<span class="hljs-comment"><span class="hljs-comment">//need tocall it otherwise in Win get socket doesn't open udpSocketSend.bind(host, 54321, QAbstractSocket::ShareAddress); udpSocketGet.bind(host, udpSocketSend.localPort(), QAbstractSocket::ShareAddress); connect(&amp;udpSocketGet, &amp;QUdpSocket::readyRead, this, &amp;MainWindow::readUdpData); for (int i=1; i&lt;255; i++) udpSocketSend.writeDatagram(data, 32, QHostAddress(subnet + QString::number(i)), 6000); }</span></span></code> </pre> <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MainWindow::readUdpData() { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (udpSocketGet.hasPendingDatagrams()) { QNetworkDatagram data = udpSocketGet.receiveDatagram(); QByteArray ip = data.senderAddress().toString().toUtf8(); QString name = QString(data.data()).section(<span class="hljs-string"><span class="hljs-string">'_'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">// cuts "dobotM1" from "dobotM1_Dobot M1_0033\x00" if (name == "dobotM1") { MyDobot* a = new MyDobot(); dobot-&gt;push_back(a); dobot-&gt;last()-&gt;initDobot(ip); ui-&gt;listDobots-&gt;addItem(ip); on_listDobots_activated(ui-&gt;listDobots-&gt;currentIndex()); } } }</span></span></code> </pre><br>  L'interface de d√©monstration est assez simple et est pr√©sent√©e dans l'image ci-dessous. <br><br><img src="https://habrastorage.org/webt/p1/t1/ym/p1t1ym-u5v1th1j0qwacwvrc3w8.png"><br><br>  Pour initialiser et contr√¥ler la gentillesse, j'ai √©crit une classe dans laquelle j'ai impl√©ment√© les fonctions dont j'ai besoin: contr√¥le d'axe, mouvement de point en point en ligne droite et dans une courbe, retour √† la position initiale, contr√¥le de la pompe √† air, mais aussi suivi des positions et des erreurs.  Prenons tour √† tour.  Lorsque la classe est initialis√©e, l'adresse IP de gentillesse est stock√©e dans la variable, la premi√®re connexion √† celle-ci se produit, la file d'attente de commandes enti√®re est nettoy√©e, m√™me si la file d'attente est vide, et les param√®tres d'acc√©l√©ration et de vitesse pour les moteurs sont d√©finis. <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyDobot</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> QObject { Q_OBJECT <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">explicit</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyDobot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(QObject *parent = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">nullptr</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; ~MyDobot(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initDobot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(QByteArray IPaddress)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">Pose </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentPosition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goHomeSafe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goHome</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goSafe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goPosition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goPositionStraight</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> r)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">goJog</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAirPump</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> status, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> direction)</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">//status 1 off 0 on; direction 0 suck 1 push void setOutput(uint8_t address, uint8_t level); void setMotor(int velocity, int acceleration); alarmState getAlarms(); void clearAlarms(); void clearQueue(); QString getName(); public slots: private: char deviceSN[64]; char deviceName[64]; QByteArray thisDobotIP; Pose currentPosition, futurePosition; };</span></span></code> </pre><br>  J'ai d√©cid√© d'utiliser un vecteur avec des √©l√©ments de ma classe pour contr√¥ler les dobots lorsque leur nombre est sup√©rieur √† 1. Chaque √©l√©ment du vecteur a une variable qui stocke l'adresse IP du dobot.  Parce que  la biblioth√®que est une, et il y a plusieurs dobotov, puis dans chaque m√©thode de la classe, vous devez d'abord appeler la m√©thode de connexion √† un dobot sp√©cifique.  Cela peut sembler tordu, mais tout est sous le capot, puis travailler avec cette classe est tr√®s pratique. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> MyDobot::setAirPump(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> status, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> direction) { ConnectDobot(thisDobotIP, <span class="hljs-number"><span class="hljs-number">115200</span></span>, <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>, <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>); ...</code> </pre><br>  Le mouvement d'un point √† un autre dans API Goodness est mis en ≈ìuvre par plusieurs m√©thodes: en ligne droite, en courbe et d'une autre mani√®re dont je ne me souviens pas.  Dans la figure ci-dessous, deux trajectoires de mouvement entre 2 points sont visibles.  La premi√®re est une ligne droite qui, avec un √©talonnage correct de l'appareil, ne se bifurque pas lors des allers-retours.  La deuxi√®me trajectoire est la ligne courbe que vous obtenez, car le micrologiciel de gentillesse ajuste s√©quentiellement les moteurs pour obtenir les coordonn√©es souhait√©es.  Il est √† noter que le d√©placement en ligne droite n'est pas toujours possible, certaines positions des articulations ne permettent pas d'atteindre du point A au point B en ligne droite. <br><br><img src="https://habrastorage.org/webt/px/i2/ke/pxi2keh8edb25v9jos_b508trha.jpeg"><br><br>  La surveillance de position de Dobot est impl√©ment√©e √† l'aide de la classe Qtimer, dont le signal Qtimer :: timeout est li√© √† ma m√©thode MainWindow :: on_getPoseTimer.  Je dois admettre que c'est une solution m√©diocre, car un fonctionnement r√©actif de l'application avec ups n'est possible que si vous d√©finissez un d√©lai d'expiration de 1000 ms.  Avec des d√©lais plus courts, des secousses commencent √† se faire sentir lors de la gestion des hauts.  J'ai remarqu√© que parfois dobot peut √™tre stupide pendant un certain temps lors de la r√©ception d'une commande, et si vous envoyez des commandes assez souvent, la probabilit√© de devenir stupide augmente.  Cela est peut-√™tre d√ª √† l'appel constant √† ConnectDobot, qui peut sembler inutile dans cette d√©mo, mais la d√©mo a √©t√© √©crite en parall√®le avec le projet principal, et dans le projet principal, j'ai vraiment besoin d'une telle impl√©mentation.  Cependant, pour surveiller la connexion n'est pas appel√© √† chaque fois, mais le probl√®me avec la suspension demeure.  Un timeout de 1 s, malheureusement, ne fournit pas une mesure aussi fluide de la position de la gentillesse dans l'espace, qui, par exemple, est impl√©ment√©e dans le Studio M1, mais, d'autre part, ce n'est pas important. <br><br>  Dans la m√™me m√©thode, une demande d'erreurs se produit.  Dans la gentillesse de l'API, la transmission du code d'erreur est impl√©ment√©e via la structure AlarmState. <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alarmState</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> value[<span class="hljs-number"><span class="hljs-number">32</span></span>]; };</code> </pre><br>  Cette structure est un tableau d'√©l√©ments √† 8 bits et le code d'erreur est cod√© dans la repr√©sentation binaire de l'un des plusieurs √©l√©ments du tableau.  Pour calculer le code d'erreur, vous devez trouver ¬´1¬ª dans l'√©l√©ment et ajouter son num√©ro de d√©charge (unit√©) √† 8 * n √©l√©ments (contenant ou non d'autres erreurs) avant dans le tableau de valeurs.  Oui, il peut y avoir plus d'une erreur √† la fois.  Ensuite, le code d'erreur doit √™tre trouv√© dans le document, qui peut √™tre t√©l√©charg√© sur le site Web du fabricant.  Le contenu de pdfk a √©t√© copi√© dans un fichier texte, qui est boulonn√© au projet en tant que ressource.  Si le code d'erreur diff√®re de 8 * 32 (c'est-√†-dire qu'il n'y a pas d'erreur), alors ce code appara√Æt dans le champ d'erreur et en cliquant sur le bouton Alarme, sa description est analys√©e dans le fichier, puis affich√©e dans le champ de texte.  Par ailleurs, le d√©codage et l'analyse des erreurs sont effectu√©s en dehors de la classe pour contr√¥ler les ups.  Cela ne me semble plus tout √† fait la bonne id√©e. <br><br>  Une pompe √† air est incluse dans le kit, qui dans le manuel d'instructions sugg√®re de se connecter aux sorties num√©riques 17 et 18. Une sortie contr√¥le la marche / arr√™t de la pompe, et la seconde contr√¥le la direction du mouvement de l'air.  Ainsi, par exemple, une pince pneumatique est activ√©e, qui est √©galement fournie. <br><br><h1>  Les mauvaises herbes </h1><br>  Dans le processus d'exploitation du Dobot, j'ai rencontr√© quelques probl√®mes. <br><br><ol><li>  Les trous dans le support ne sont pas faits pour le pas des trous dans la planche √† pain optique standard.  D'un autre c√¥t√©, une fois quand, par erreur, mes gentillesse sont entr√©es en collision, l'une d'elles a simplement fait d√©filer l'axe du boulon de fixation, ce qui, je pense, a √©vit√© de graves dommages. </li><li>  Du premier paragraphe suit le second.  Apr√®s la collision des Dobot, leurs axes se sont d√©plac√©s.  Ce n'√©tait pas effrayant au d√©but, car j'ai √©crit une m√©thode pour calibrer l'axe du Dobot par rapport √† la cam√©ra.  La chose terrible s'est produite au paragraphe 3. </li><li>  L'axe vertical a √©galement chang√© et maintenant ma normale n'est pas normale.  Cela peut √™tre d√©tect√© par la cam√©ra, si vous dessinez deux perpendiculaires avec les points.  Vous pouvez vous assurer qu'en raison de la verticale inclin√©e, dobot dessine maintenant avec un stylo non pas ses vrais axes X et Y, mais leurs projections.  Et ces projections peuvent avoir un angle inf√©rieur √† 90 degr√©s.  En r√©alit√©, cela conduit √† une petite erreur d'alignement.  En revanche, ce n'est pas si effrayant car l'erreur est lin√©aire. </li><li>  Firmware Dobot, en principe, env.  Il y avait un petit montant avec une adresse de pavot, il y a quelques probl√®mes avec l'attente des r√©ponses aux demandes UDP, mais sinon √ßa marche bien. </li><li>  La conception fournit une batterie, qui est n√©cessaire pour maintenir les derni√®res coordonn√©es apr√®s avoir d√©sactiv√© la gentillesse.  Lorsque la batterie meurt, sa tension baisse, ce qui efface ces donn√©es.  Pour cette raison, le dobot est charg√© dans un √©tat d'erreur.  Pour d√©duire de ces √©tats, vous devez d'abord appeler la m√©thode pour effacer les messages d'erreur, puis appeler la m√©thode de recherche pour la position "home".  Vous pouvez remplacer la batterie, l'avantage est inclus.  Cependant, la batterie est cach√©e dans le support, et pour y acc√©der, vous avez d√ª d√©visser 4 boulons.  La fente de l'un d'eux est abattue. </li><li>  Dans mon projet, j'ai utilis√© 3 feuilles de verre pour augmenter le niveau de la table.  D√©cision moyenne, car le verre est tordu.  Le fait est que Dobot commence √† g√©n√©rer des erreurs lorsque son axe vertical a une valeur inf√©rieure √† 15 mm, et il semble que toutes les fonctions ne soient pas disponibles.  Il est donc n√©cessaire que l'espace de travail soit situ√© juste au-dessus du plan de fixation du Dobot. </li></ol><br><h1>  Conclusion </h1><br>  La gentillesse m'a permis de mettre en ≈ìuvre un projet d'assemblage de cellules solaires dans une mini-prise carrel√©e, visible en vid√©o.  La pr√©cision de positionnement a √©t√© v√©rifi√©e sur les m√™mes tranches de silicium et √©tait dans la limite de 1 pixel sur un axe et de 10 pixels dans un autre.  La cam√©ra dans ce projet a √©t√© utilis√©e avec une r√©solution de 20 MP, et le champ de vision de la cam√©ra le long du c√¥t√© √©tait d'environ 17 cm, il n'est pas difficile de calculer qu'un pixel correspondait √† une taille lin√©aire d'environ 30 microns.  Il se trouve que l'optique utilis√©e, bien que de haute qualit√©, permet d'observer clairement des tranches de silicium uniquement en leur centre, tandis que les bords des tranches deviennent tr√®s flous, ce qui conduit √† une incertitude dans la d√©termination de leurs faces sur des c√¥t√©s courts, et par cons√©quent √† une incertitude dans la d√©termination du centre de la tranche.  Apr√®s avoir calibr√© les axes, j'ai r√©gl√© la mise au point de la cam√©ra sur les petits c√¥t√©s des plaques.  Il est √† noter qu'en principe, il √©tait impossible de se focaliser l√† comme au centre du champ de vision, mais quand m√™me.  En raison de cet effet, l'erreur de positionnement le long de l'axe le long du c√¥t√© long de la cellule solaire √©tait dans la limite de 10 pixels, mais seulement 1 pixel sur le c√¥t√© court.  Ce qui correspond √† environ 300 et 30 microns.  Cela m'a permis de v√©rifier l'int√©grit√© des sp√©cifications pour la pr√©cision. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/j7SNzEHzecM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467407/">https://habr.com/ru/post/fr467407/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467395/index.html">Habr Weekly # 18 / Nouveaux gadgets Apple, un smartphone enti√®rement modulaire, le village des programmeurs en Bi√©lorussie, le ph√©nom√®ne XY</a></li>
<li><a href="../fr467399/index.html">Vous ne pouvez pas interdire d'apporter: comment mettre en ≈ìuvre le concept BYOD et ne pas nuire √† la s√©curit√© des informations</a></li>
<li><a href="../fr467401/index.html">Comparaison de Tesla Model S et Porsche Taycan</a></li>
<li><a href="../fr467403/index.html">Ce que vous pouvez et ne pouvez pas extraire des composants Web</a></li>
<li><a href="../fr467405/index.html">Lyft lance un concours de reconnaissance d'objets 3D</a></li>
<li><a href="../fr467409/index.html">Pour faire des affaires dans la Silicon Valley, vous devez vous comporter</a></li>
<li><a href="../fr467413/index.html">Framework de microservice PHP - `Hello world` de Swoft</a></li>
<li><a href="../fr467415/index.html">March√© des changes moderne</a></li>
<li><a href="../fr467419/index.html">Sortie finale de Jakarta EE 8</a></li>
<li><a href="../fr467421/index.html">Cr√©er des pointeurs intelligents expressifs pour la m√©moire distante en C ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>