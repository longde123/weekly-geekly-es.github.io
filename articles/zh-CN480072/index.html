<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¤ğŸ¿ ğŸ§” ğŸ‘‰ğŸ¼ Kubernetesï¼šä¸ºä»€ä¹ˆè®¾ç½®ç³»ç»Ÿèµ„æºç®¡ç†å¦‚æ­¤é‡è¦ï¼Ÿ ğŸŠ ğŸ•¯ï¸ ğŸ¤¦ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="é€šå¸¸ï¼Œå§‹ç»ˆéœ€è¦ä¸ºä»»ä½•åº”ç”¨ç¨‹åºæä¾›ä¸“ç”¨çš„èµ„æºæ± ï¼Œä»¥ç¡®ä¿å…¶æ­£ç¡®è€Œç¨³å®šçš„è¿è¡Œã€‚ ä½†æ˜¯ï¼Œå¦‚æœå¤šä¸ªåº”ç”¨ç¨‹åºåŒæ—¶ä½¿ç”¨ç›¸åŒçš„å®¹é‡æ€ä¹ˆåŠï¼Ÿ å¦‚ä½•ä¸ºä»–ä»¬æ¯ä¸ªäººæä¾›æœ€å°‘çš„å¿…è¦èµ„æºï¼Ÿ å¦‚ä½•é™åˆ¶èµ„æºæ¶ˆè€—ï¼Ÿ å¦‚ä½•æ­£ç¡®åˆ†é…èŠ‚ç‚¹ä¹‹é—´çš„è´Ÿè½½ï¼Ÿ åœ¨åº”ç”¨ç¨‹åºè´Ÿè½½å¢åŠ çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ç¡®ä¿æ°´å¹³ç¼©æ”¾çš„æœºåˆ¶ï¼Ÿ 





 æ‚¨éœ€è¦ä»ç³»ç»Ÿä¸­å­˜åœ¨çš„...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kubernetesï¼šä¸ºä»€ä¹ˆè®¾ç½®ç³»ç»Ÿèµ„æºç®¡ç†å¦‚æ­¤é‡è¦ï¼Ÿ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/nixys/blog/480072/"><p> é€šå¸¸ï¼Œå§‹ç»ˆéœ€è¦ä¸ºä»»ä½•åº”ç”¨ç¨‹åºæä¾›ä¸“ç”¨çš„èµ„æºæ± ï¼Œä»¥ç¡®ä¿å…¶æ­£ç¡®è€Œç¨³å®šçš„è¿è¡Œã€‚ ä½†æ˜¯ï¼Œå¦‚æœå¤šä¸ªåº”ç”¨ç¨‹åºåŒæ—¶ä½¿ç”¨ç›¸åŒçš„å®¹é‡æ€ä¹ˆåŠï¼Ÿ å¦‚ä½•ä¸ºä»–ä»¬æ¯ä¸ªäººæä¾›æœ€å°‘çš„å¿…è¦èµ„æºï¼Ÿ å¦‚ä½•é™åˆ¶èµ„æºæ¶ˆè€—ï¼Ÿ å¦‚ä½•æ­£ç¡®åˆ†é…èŠ‚ç‚¹ä¹‹é—´çš„è´Ÿè½½ï¼Ÿ åœ¨åº”ç”¨ç¨‹åºè´Ÿè½½å¢åŠ çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•ç¡®ä¿æ°´å¹³ç¼©æ”¾çš„æœºåˆ¶ï¼Ÿ </p><br><p><img src="https://habrastorage.org/webt/-f/yj/hw/-fyjhwhkhcibnshgzndgd4w4e_c.png"></p><a name="habracut"></a><br><p> æ‚¨éœ€è¦ä»ç³»ç»Ÿä¸­å­˜åœ¨çš„èµ„æºçš„åŸºæœ¬ç±»å‹å¼€å§‹-å½“ç„¶æ˜¯å¤„ç†å™¨æ—¶é—´å’ŒRAMã€‚ åœ¨k8sæ¸…å•ä¸­ï¼Œè¿™äº›ç±»å‹çš„èµ„æºä»¥ä»¥ä¸‹å•ä½åº¦é‡ï¼š </p><br><ul><li>  CPU-æ ¸å¿ƒ </li><li>  RAM-ä»¥å­—èŠ‚ä¸ºå•ä½ </li></ul><br><p> æ­¤å¤–ï¼Œå¯¹äºæ¯ç§èµ„æºï¼Œéƒ½æœ‰æœºä¼šè®¾ç½®ä¸¤ç§ç±»å‹çš„éœ€æ±‚- <strong>è¯·æ±‚</strong>å’Œ<strong>é™åˆ¶</strong> ã€‚ è¯·æ±‚-æè¿°è¿è¡Œå®¹å™¨ï¼ˆä»¥åŠæ•´ä¸ªç‚‰åºŠï¼‰çš„èŠ‚ç‚¹çš„ç©ºé—²èµ„æºçš„æœ€ä½è¦æ±‚ï¼Œè€Œé™åˆ¶å¯¹å®¹å™¨å¯ç”¨çš„èµ„æºè®¾ç½®äº†ä¸¥æ ¼çš„é™åˆ¶ã€‚ </p><br><p> é‡è¦çš„æ˜¯è¦äº†è§£ï¼Œåœ¨æ¸…å•ä¸­ä¸å¿…æ˜¾å¼å®šä¹‰ä¸¤ç§ç±»å‹ï¼Œå…¶è¡Œä¸ºå¦‚ä¸‹ï¼š </p><br><ul><li> å¦‚æœä»…æ˜¾å¼è®¾ç½®èµ„æºçš„é™åˆ¶ï¼Œåˆ™å¯¹æ­¤èµ„æºçš„è¯·æ±‚å°†è‡ªåŠ¨é‡‡ç”¨ç­‰äºé™åˆ¶çš„å€¼ï¼ˆå¯ä»¥é€šè¿‡è°ƒç”¨describeå®ä½“è¿›è¡ŒéªŒè¯ï¼‰ã€‚ å³ å®é™…ä¸Šï¼Œå®¹å™¨çš„è¿è¡Œå°†å—åˆ°å…¶è¿è¡Œæ‰€éœ€èµ„æºé‡çš„é™åˆ¶ã€‚ </li><li> å¦‚æœä»…ä¸ºèµ„æºæ˜ç¡®è®¾ç½®è¯·æ±‚ï¼Œåˆ™åœ¨æ­¤èµ„æºä¹‹ä¸Šä¸ä¼šè®¾ç½®ä»»ä½•é™åˆ¶-å³ å®¹å™¨ä»…å—èŠ‚ç‚¹æœ¬èº«èµ„æºçš„é™åˆ¶ã€‚ </li></ul><br><p> ä½¿ç”¨ä»¥ä¸‹å®ä½“ï¼Œä¸ä»…å¯ä»¥åœ¨ç‰¹å®šå®¹å™¨çº§åˆ«é…ç½®èµ„æºç®¡ç†ï¼Œè¿˜å¯ä»¥åœ¨åç§°ç©ºé—´çº§åˆ«é…ç½®èµ„æºç®¡ç†ï¼š </p><br><ul><li>  <strong>LimitRange-</strong>ä»¥nsä¸ºå•ä½æè¿°å®¹å™¨/ç‚‰è†›çº§åˆ«çš„é™åˆ¶ç­–ç•¥ï¼Œå¹¶ä¸”éœ€è¦ç”¨å®ƒæ¥æè¿°å¯¹å®¹å™¨/ç‚‰è†›çš„é»˜è®¤é™åˆ¶ï¼Œä»¥åŠé˜²æ­¢åˆ›å»ºæ˜æ˜¾çš„èƒ–å®¹å™¨/ç‚‰è†›ï¼ˆåä¹‹äº¦ç„¶ï¼‰ï¼Œé™åˆ¶å…¶æ•°é‡å¹¶ç¡®å®šé™åˆ¶ä¹‹é—´çš„å¯èƒ½å·®å¼‚å’Œè¦æ±‚ </li><li>  <strong>ResourceQuotas-</strong>é€šå¸¸ä»¥nsä¸ºå•ä½æè¿°æ‰€æœ‰å®¹å™¨çš„é™åˆ¶ç­–ç•¥ï¼Œé€šå¸¸ç”¨äºé™åˆ¶ç¯å¢ƒä¹‹é—´çš„èµ„æºï¼ˆå½“åœ¨èŠ‚ç‚¹çº§åˆ«æœªä¸¥æ ¼é™åˆ¶ç¯å¢ƒæ—¶å¾ˆæœ‰ç”¨ï¼‰ </li></ul><br><p> ä»¥ä¸‹æ˜¯è®¾ç½®èµ„æºé™åˆ¶çš„æ¸…å•çš„ç¤ºä¾‹ï¼š </p><br><ul><li><p> åœ¨ç‰¹å®šçš„å®¹å™¨çº§åˆ«ï¼š </p><br><pre><code class="plaintext hljs">containers: - name: app-nginx image: nginx resources: requests: memory: 1Gi limits: cpu: 200m</code> </pre> <br><p> å³ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¦ä½¿ç”¨nginxå¯åŠ¨å®¹å™¨ï¼Œæ‚¨è‡³å°‘éœ€è¦åœ¨èŠ‚ç‚¹ä¸Šå­˜åœ¨å…è´¹çš„1G OPå’Œ0.2 CPUï¼Œè€Œæœ€å¤§çš„å®¹å™¨å¯ä»¥åƒæ‰0.2 CPUå’ŒèŠ‚ç‚¹ä¸Šæ‰€æœ‰å¯ç”¨çš„OPã€‚ </p><br></li><li><p> åœ¨nsæ•´æ•°çº§ï¼š </p><br><pre> <code class="plaintext hljs">apiVersion: v1 kind: ResourceQuota metadata: name: nxs-test spec: hard: requests.cpu: 300m requests.memory: 1Gi limits.cpu: 700m limits.memory: 2Gi</code> </pre> <br><p> å³ å¯¹äºCPUï¼Œé»˜è®¤nsä¸­æ‰€æœ‰è¯·æ±‚å®¹å™¨çš„æ€»å’Œä¸èƒ½è¶…è¿‡300mï¼Œå¯¹äºOPï¼Œå…¶æ€»æ•°ä¸èƒ½è¶…è¿‡1Gï¼Œå¯¹äºCPUå’ŒOPï¼Œæ‰€æœ‰é™åˆ¶çš„æ€»å’Œåˆ†åˆ«ä¸º700må’Œ2Gã€‚ </p><br></li><li><p>  nsä¸­å®¹å™¨çš„é»˜è®¤é™åˆ¶ï¼š </p><br><pre> <code class="plaintext hljs">apiVersion: v1 kind: LimitRange metadata: name: nxs-limit-per-container spec: limits: - type: Container defaultRequest: cpu: 100m memory: 1Gi default: cpu: 1 memory: 2Gi min: cpu: 50m memory: 500Mi max: cpu: 2 memory: 4Gi</code> </pre> <br><p> å³ åœ¨æ‰€æœ‰å®¹å™¨çš„é»˜è®¤å‘½åç©ºé—´ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒCPUçš„è¯·æ±‚å°†è®¾ç½®ä¸º100mï¼ŒOPçš„è¯·æ±‚å°†è®¾ç½®ä¸º1Gï¼Œé™åˆ¶ä¸º1 CPUå’Œ2Gã€‚ åŒæ—¶ï¼Œå¯¹CPUï¼ˆ50m &lt;x &lt;2ï¼‰å’ŒRAMï¼ˆ500M &lt;x &lt;4Gï¼‰çš„è¯·æ±‚/é™åˆ¶ä¸­çš„å¯èƒ½å€¼ä¹Ÿå»ºç«‹äº†é™åˆ¶ã€‚ </p><br></li><li><p>  nsç‚‰è†›æ°´å¹³çš„å±€é™æ€§ï¼š </p><br><pre> <code class="plaintext hljs">apiVersion: v1 kind: LimitRange metadata: name: nxs-limit-pod spec: limits: - type: Pod max: cpu: 4 memory: 1Gi</code> </pre> <br><p> å³ å¯¹äºé»˜è®¤nsä¸­çš„æ¯ä¸ªç‚‰åºŠï¼Œå°†è®¾ç½®4ä¸ªvCPUå’Œ1Gçš„é™åˆ¶ã€‚ </p><br></li></ul><br><p> ç°åœ¨ï¼Œæˆ‘æƒ³å‘Šè¯‰æ‚¨ï¼Œå®‰è£…è¿™äº›é™åˆ¶å¯ä»¥ç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆå¥½å¤„ã€‚ </p><br><h2 id="mehanizm-balansirovki-nagruzki-mezhdu-nodami"> èŠ‚ç‚¹ä¹‹é—´çš„è´Ÿè½½å¹³è¡¡æœºåˆ¶ </h2><br><p> å¦‚æ‚¨æ‰€çŸ¥ï¼Œk8sç»„ä»¶ï¼ˆä¾‹å¦‚<strong>Scheduler</strong> ï¼‰æ˜¯æ ¹æ®æŸç§ç®—æ³•å·¥ä½œçš„ï¼Œå®ƒè´Ÿè´£åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šåˆ†é…ç‚‰è†›ã€‚ è¯¥ç®—æ³•åœ¨é€‰æ‹©è¦è¿è¡Œçš„æœ€ä½³èŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ç»å†ä¸¤ä¸ªé˜¶æ®µï¼š </p><br><ol><li> ç­›é€‰ </li><li> æ’å </li></ol><br><p> å³ æ ¹æ®æ‰€æè¿°çš„ç­–ç•¥ï¼Œé¦–å…ˆæ ¹æ®ä¸€ç»„<strong>è°“è¯</strong> ï¼ˆåŒ…æ‹¬èŠ‚ç‚¹æ˜¯å¦æœ‰è¶³å¤Ÿçš„èµ„æºæ¥è¿è¡Œç‚‰åºŠ-PodFitsResourcesï¼‰é€‰æ‹©å¯ä»¥åœ¨å…¶ä¸Šå¯åŠ¨ç‚‰åºŠçš„èŠ‚ç‚¹ï¼Œç„¶åæ ¹æ®<strong>ä¼˜å…ˆçº§</strong> ï¼ˆåŒ…æ‹¬ï¼ŒèŠ‚ç‚¹æ‹¥æœ‰çš„å¯ç”¨èµ„æºè¶Šå¤š-ä¸ºå…¶åˆ†é…çš„ç‚¹æ•°è¶Šå¤š-LeastResourceAllocation / LeastRequestedPriority / BalancedResourceAllocationï¼‰å¹¶åœ¨å…·æœ‰æœ€å¤šç‚¹æ•°çš„èŠ‚ç‚¹ä¸Šè¿è¡Œï¼ˆå¦‚æœå¤šä¸ªèŠ‚ç‚¹ä¸€æ¬¡æ»¡è¶³æ­¤æ¡ä»¶ï¼Œåˆ™é€‰æ‹©ä¸€ä¸ªéšæœºæ¡ä»¶ï¼‰ã€‚ </p><br><p> åŒæ—¶ï¼Œæ‚¨éœ€è¦äº†è§£è°ƒåº¦ç¨‹åºåœ¨è¯„ä¼°èŠ‚ç‚¹çš„å¯ç”¨èµ„æºæ—¶ï¼Œå°†é‡ç‚¹æ”¾åœ¨å­˜å‚¨åœ¨etcdä¸­çš„æ•°æ®ä¸Šï¼Œå³ å–å†³äºåœ¨æ­¤èŠ‚ç‚¹ä¸Šè¿è¡Œçš„æ¯ä¸ªpodçš„è¯·æ±‚/é™åˆ¶èµ„æºçš„æ•°é‡ï¼Œè€Œä¸æ˜¯å®é™…æ¶ˆè€—çš„èµ„æºã€‚ å¯ä»¥åœ¨<code>kubectl describe node $NODE</code>å‘½ä»¤çš„è¾“å‡ºä¸­è·å¾—æ­¤ä¿¡æ¯ï¼Œä¾‹å¦‚ï¼š </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># kubectl describe nodes nxs-k8s-s1 .. Non-terminated Pods: (9 in total) Namespace Name CPU Requests CPU Limits Memory Requests Memory Limits AGE --------- ---- ------------ ---------- --------------- ------------- --- ingress-nginx nginx-ingress-controller-754b85bf44-qkt2t 0 (0%) 0 (0%) 0 (0%) 0 (0%) 233d kube-system kube-flannel-26bl4 150m (0%) 300m (1%) 64M (0%) 500M (1%) 233d kube-system kube-proxy-exporter-cb629 0 (0%) 0 (0%) 0 (0%) 0 (0%) 233d kube-system kube-proxy-x9fsc 0 (0%) 0 (0%) 0 (0%) 0 (0%) 233d kube-system nginx-proxy-k8s-worker-s1 25m (0%) 300m (1%) 32M (0%) 512M (1%) 233d nxs-monitoring alertmanager-main-1 100m (0%) 100m (0%) 425Mi (1%) 25Mi (0%) 233d nxs-logging filebeat-lmsmp 100m (0%) 0 (0%) 100Mi (0%) 200Mi (0%) 233d nxs-monitoring node-exporter-v4gdq 112m (0%) 122m (0%) 200Mi (0%) 220Mi (0%) 233d Allocated resources: (Total limits may be over 100 percent, ie, overcommitted.) Resource Requests Limits -------- -------- ------ cpu 487m (3%) 822m (5%) memory 15856217600 (2%) 749976320 (3%) ephemeral-storage 0 (0%) 0 (0%)</span></span></code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°åœ¨ç‰¹å®šèŠ‚ç‚¹ä¸Šè¿è¡Œçš„æ‰€æœ‰Podï¼Œä»¥åŠæ¯ä¸ªPodè¦æ±‚çš„èµ„æºã€‚ è¿™æ˜¯å¯åŠ¨cronjob-cron-events-1573793820-xt6q9 podæ—¶è°ƒåº¦ç¨‹åºæ—¥å¿—çš„å¤–è§‚ï¼ˆåœ¨å¯åŠ¨å‘½ä»¤--v = 10çš„å‚æ•°ä¸­è®¾ç½®ç¬¬åçº§æ—¥å¿—è®°å½•æ—¶ï¼Œæ­¤ä¿¡æ¯æ˜¾ç¤ºåœ¨è°ƒåº¦ç¨‹åºæ—¥å¿—ä¸­ï¼‰ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">æµ·é¸¥</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">I1115 07:57:21.637791 1 scheduling_queue.go:908] About to try and schedule pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 I1115 07:57:21.637804 1 scheduler.go:453] Attempting to schedule pod: nxs-stage/cronjob-cron-events-1573793820-xt6q9 I1115 07:57:21.638285 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s5 is allowed, Node is running only 16 out of 110 Pods. I1115 07:57:21.638300 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s6 is allowed, Node is running only 20 out of 110 Pods. I1115 07:57:21.638322 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s3 is allowed, Node is running only 20 out of 110 Pods. I1115 07:57:21.638322 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s4 is allowed, Node is running only 17 out of 110 Pods. I1115 07:57:21.638334 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s10 is allowed, Node is running only 16 out of 110 Pods. I1115 07:57:21.638365 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s12 is allowed, Node is running only 9 out of 110 Pods. I1115 07:57:21.638334 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s11 is allowed, Node is running only 11 out of 110 Pods. I1115 07:57:21.638385 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s1 is allowed, Node is running only 19 out of 110 Pods. I1115 07:57:21.638402 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s2 is allowed, Node is running only 21 out of 110 Pods. I1115 07:57:21.638383 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s9 is allowed, Node is running only 16 out of 110 Pods. I1115 07:57:21.638335 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s8 is allowed, Node is running only 18 out of 110 Pods. I1115 07:57:21.638408 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s13 is allowed, Node is running only 8 out of 110 Pods. I1115 07:57:21.638478 1 predicates.go:1369] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s10 is allowed, existing pods anti-affinity terms satisfied. I1115 07:57:21.638505 1 predicates.go:1369] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s8 is allowed, existing pods anti-affinity terms satisfied. I1115 07:57:21.638577 1 predicates.go:1369] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s9 is allowed, existing pods anti-affinity terms satisfied. I1115 07:57:21.638583 1 predicates.go:829] Schedule Pod nxs-stage/cronjob-cron-events-1573793820-xt6q9 on Node nxs-k8s-s7 is allowed, Node is running only 25 out of 110 Pods. I1115 07:57:21.638932 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s10: BalancedResourceAllocation, capacity 39900 millicores 66620178432 memory bytes, total request 2343 millicores 9640186880 memory bytes, score 9 I1115 07:57:21.638946 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s10: LeastResourceAllocation, capacity 39900 millicores 66620178432 memory bytes, total request 2343 millicores 9640186880 memory bytes, score 8 I1115 07:57:21.638961 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s9: BalancedResourceAllocation, capacity 39900 millicores 66620170240 memory bytes, total request 4107 millicores 11307422720 memory bytes, score 9 I1115 07:57:21.638971 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s8: BalancedResourceAllocation, capacity 39900 millicores 66620178432 memory bytes, total request 5847 millicores 24333637120 memory bytes, score 7 I1115 07:57:21.638975 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s9: LeastResourceAllocation, capacity 39900 millicores 66620170240 memory bytes, total request 4107 millicores 11307422720 memory bytes, score 8 I1115 07:57:21.638990 1 resource_allocation.go:78] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s8: LeastResourceAllocation, capacity 39900 millicores 66620178432 memory bytes, total request 5847 millicores 24333637120 memory bytes, score 7 I1115 07:57:21.639022 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s10: TaintTolerationPriority, Score: (10) I1115 07:57:21.639030 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s8: TaintTolerationPriority, Score: (10) I1115 07:57:21.639034 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s9: TaintTolerationPriority, Score: (10) I1115 07:57:21.639041 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s10: NodeAffinityPriority, Score: (0) I1115 07:57:21.639053 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s8: NodeAffinityPriority, Score: (0) I1115 07:57:21.639059 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s9: NodeAffinityPriority, Score: (0) I1115 07:57:21.639061 1 interpod_affinity.go:237] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s10: InterPodAffinityPriority, Score: (0) I1115 07:57:21.639063 1 selector_spreading.go:146] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s10: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639073 1 interpod_affinity.go:237] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s8: InterPodAffinityPriority, Score: (0) I1115 07:57:21.639077 1 selector_spreading.go:146] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s8: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639085 1 interpod_affinity.go:237] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s9: InterPodAffinityPriority, Score: (0) I1115 07:57:21.639088 1 selector_spreading.go:146] cronjob-cron-events-1573793820-xt6q9 -&gt; nxs-k8s-s9: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639103 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s10: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639109 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s8: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639114 1 generic_scheduler.go:726] cronjob-cron-events-1573793820-xt6q9_nxs-stage -&gt; nxs-k8s-s9: SelectorSpreadPriority, Score: (10) I1115 07:57:21.639127 1 generic_scheduler.go:781] Host nxs-k8s-s10 =&gt; Score 100037 I1115 07:57:21.639150 1 generic_scheduler.go:781] Host nxs-k8s-s8 =&gt; Score 100034 I1115 07:57:21.639154 1 generic_scheduler.go:781] Host nxs-k8s-s9 =&gt; Score 100037 I1115 07:57:21.639267 1 scheduler_binder.go:269] AssumePodVolumes for pod "nxs-stage/cronjob-cron-events-1573793820-xt6q9", node "nxs-k8s-s10" I1115 07:57:21.639286 1 scheduler_binder.go:279] AssumePodVolumes for pod "nxs-stage/cronjob-cron-events-1573793820-xt6q9", node "nxs-k8s-s10": all PVCs bound and nothing to do I1115 07:57:21.639333 1 factory.go:733] Attempting to bind cronjob-cron-events-1573793820-xt6q9 to nxs-k8s-s10</code> </pre> </div></div><br><p> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°è°ƒåº¦ç¨‹åºæœ€åˆæ‰§è¡Œè¿‡æ»¤å¹¶å½¢æˆ3ä¸ªå¯ä»¥åœ¨å…¶ä¸Šè¿è¡Œçš„èŠ‚ç‚¹çš„åˆ—è¡¨ï¼ˆnxs-k8s-s8ï¼Œnxs-k8s-s9ï¼Œnxs-k8s-s10ï¼‰ã€‚ ç„¶åï¼Œæ ¹æ®è¿™äº›å‚æ•°ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹çš„å‡ ä¸ªå‚æ•°ï¼ˆåŒ…æ‹¬BalancedResourceAllocationï¼ŒLeastResourceAllocationï¼‰è®¡ç®—ç‚¹ï¼Œä»¥ç¡®å®šæœ€åˆé€‚çš„èŠ‚ç‚¹ã€‚ æœ€åï¼Œå°†å…¶è§„åˆ’åœ¨å…·æœ‰æœ€å¤šç‚¹çš„èŠ‚ç‚¹ä¸‹ï¼ˆæ­¤å¤„ï¼Œä¸¤ä¸ªèŠ‚ç‚¹ä¸€æ¬¡å…·æœ‰ç›¸åŒæ•°é‡çš„ç‚¹100037ï¼Œå› æ­¤é€‰æ‹©ä¸€ä¸ªéšæœºç‚¹-nxs-k8s-s10ï¼‰ã€‚ </p><br><p>  <strong>ç»“è®º</strong> ï¼šå¦‚æœpodåœ¨æœªè®¾ç½®ä»»ä½•é™åˆ¶çš„èŠ‚ç‚¹ä¸Šå·¥ä½œï¼Œåˆ™å¯¹äºk8ï¼ˆä»èµ„æºæ¶ˆè€—çš„è§’åº¦æ¥çœ‹ï¼‰ï¼Œè¿™ç­‰æ•ˆäºè¯¥èŠ‚ç‚¹ä¸Šå®Œå…¨æ²¡æœ‰æ­¤ç±»podã€‚ å› æ­¤ï¼Œå¦‚æœæ‚¨æœ‰æ¡ä»¶åœ°æ‹¥æœ‰ä¸€ä¸ªè¿›ç¨‹ç¹ççš„Podï¼ˆä¾‹å¦‚wowzaï¼‰ï¼Œå¹¶ä¸”å¯¹æ­¤æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µï¼šå®é™…ä¸Šï¼Œç»™å®šçš„Podå·²ç»è€—å°½äº†è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰èµ„æºï¼Œä½†å¯¹äºk8sï¼Œè¯¥èŠ‚ç‚¹è¢«è§†ä¸ºå·²å¸è½½å¹¶ä¸”è¿›è¡Œæ’åæ—¶ï¼Œå®ƒå°†è·å¾—ç›¸åŒæ•°é‡çš„åˆ†æ•°ï¼ˆå³ï¼Œå¯¹å¯ç”¨èµ„æºè¿›è¡Œè¯„ä¼°çš„åˆ†æ•°ï¼‰ï¼Œä»¥åŠæ²¡æœ‰å·¥ä½œé—´è·çš„èŠ‚ç‚¹ï¼Œè¿™æœ€ç»ˆä¼šå¯¼è‡´èŠ‚ç‚¹ä¹‹é—´çš„è´Ÿè½½åˆ†é…ä¸å‡ã€‚ </p><br><h2 id="vyselenie-poda"> ç‚‰è†›é©±é€ </h2><br><p> å¦‚æ‚¨æ‰€çŸ¥ï¼Œä¸ºæ¯ä¸ªPodåˆ†é…äº†3ç§QoSç±»ä¹‹ä¸€ï¼š </p><br><ol><li>  <strong>ä¿è¯</strong> -åœ¨ä¸ºç‚‰è†›ä¸­çš„æ¯ä¸ªå®¹å™¨è®¾ç½®å†…å­˜å’Œcpuçš„è¯·æ±‚å’Œé™åˆ¶æ—¶åˆ†é…ï¼Œå¹¶ä¸”è¿™äº›å€¼å¿…é¡»åŒ¹é… </li><li>  <strong>å¯çˆ†</strong> -ç‚‰è†›ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨å…·æœ‰è¯·æ±‚å’Œé™åˆ¶ï¼Œè€Œè¯·æ±‚&lt;limit </li><li>  <strong>å°½åŠ›è€Œä¸º</strong> -å½“ç‚‰è†›ä¸­æ²¡æœ‰å®¹å™¨å—åˆ°èµ„æºé™åˆ¶æ—¶ </li></ol><br><p> åŒæ—¶ï¼Œå½“èŠ‚ç‚¹ä¸Šçš„èµ„æºï¼ˆç£ç›˜ï¼Œå†…å­˜ï¼‰ä¸è¶³æ—¶ï¼Œkubeletå¼€å§‹æ ¹æ®æŸç§ç®—æ³•å¯¹Podè¿›è¡Œæ’åå’Œé€å‡ºï¼Œè¯¥ç®—æ³•è€ƒè™‘äº†Podçš„ä¼˜å…ˆçº§åŠå…¶QoSç±»ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬è°ˆè®ºçš„æ˜¯RAMï¼Œåˆ™æ ¹æ®QoSç­‰çº§ï¼Œå°†æ ¹æ®ä»¥ä¸‹åŸåˆ™æˆäºˆåˆ†æ•°ï¼š </p><br><ul><li>  <strong>ä¿è¯çš„</strong> ï¼š-998 </li><li>  <strong>å°½åŠ›è€Œä¸º</strong> ï¼š1000 </li><li>  <strong>çªå‘</strong> ï¼šæœ€å°å€¼ï¼ˆæœ€å¤§å€¼ï¼ˆ <strong>2ï¼Œ1000-</strong> ï¼ˆ1000 * memoryRequestBytesï¼‰/ machineMemoryCapacityBytesï¼‰ï¼Œ999ï¼‰ </li></ul><br><p> å³ å…·æœ‰ç›¸åŒä¼˜å…ˆçº§çš„kubeletå°†é¦–å…ˆä»èŠ‚ç‚¹ä¸­æ’å‡ºå…·æœ‰å°½åŠ›è€Œä¸ºQoSç­‰çº§çš„Podã€‚ </p><br><p>  <strong>ç»“è®º</strong> ï¼šå¦‚æœè¦å‡å°‘åœ¨èŠ‚ç‚¹ä¸Šæ²¡æœ‰è¶³å¤Ÿèµ„æºçš„æƒ…å†µä¸‹ä»èŠ‚ç‚¹ä¸Šé€å‡ºå¿…è¦Podçš„å¯èƒ½æ€§ï¼Œé‚£ä¹ˆé™¤äº†ä¼˜å…ˆçº§å¤–ï¼Œè¿˜å¿…é¡»æ³¨æ„ä¸ºå…¶è®¾ç½®è¯·æ±‚/é™åˆ¶ã€‚ </p><br><h2 id="mehanizm-gorizontalnogo-avtomasshtabirovaniya-podov-prilozheniya-hpa"> åº”ç”¨ç‚‰è†›æ°´å¹³è‡ªåŠ¨ç¼©æ”¾æœºæ„ï¼ˆHPAï¼‰ </h2><br><p> å½“ä»»åŠ¡æ˜¯æ ¹æ®èµ„æºï¼ˆç³»ç»Ÿ-CPU / RAMæˆ–ç”¨æˆ·-rpsï¼‰çš„ä½¿ç”¨è‡ªåŠ¨å¢åŠ å’Œå‡å°‘podçš„æ•°é‡æ—¶ï¼Œè¯¸å¦‚<strong>HPA</strong> ï¼ˆHorizoâ€‹â€‹ntal Pod Autoscalerï¼‰ä¹‹ç±»çš„å®ä½“k8så¯ä»¥å¸®åŠ©è§£å†³é—®é¢˜ã€‚ å…¶ç®—æ³•å¦‚ä¸‹ï¼š </p><br><ol><li> ç¡®å®šè§‚å¯Ÿèµ„æºçš„å½“å‰è¯»æ•°ï¼ˆcurrentMetricValueï¼‰ </li><li> ç¡®å®šèµ„æºçš„æœŸæœ›å€¼ï¼ˆdesiredMetricValueï¼‰ï¼Œä½¿ç”¨è¯·æ±‚ä¸ºç³»ç»Ÿèµ„æºè®¾ç½®è¿™äº›æœŸæœ›å€¼ </li><li> ç¡®å®šå½“å‰å‰¯æœ¬æ•°ï¼ˆcurrentReplicasï¼‰ </li><li> ä¸‹é¢çš„å…¬å¼è®¡ç®—æ‰€éœ€çš„å‰¯æœ¬æ•°ï¼ˆdesiredReplicasï¼‰ <br>  wantedReplicas = [currentReplicas *ï¼ˆcurrentMetricValue /æœŸæœ›MetricValueï¼‰] </li></ol><br><p> ä½†æ˜¯ï¼Œå½“ç³»æ•°ï¼ˆcurrentMetricValue / desireMetricValueï¼‰æ¥è¿‘1æ—¶ï¼Œå°†ä¸ä¼šå‘ç”Ÿç¼©æ”¾ï¼ˆæˆ‘ä»¬å¯ä»¥è‡ªè¡Œè®¾ç½®å…è®¸è¯¯å·®ï¼Œé»˜è®¤ä¸º0.1ï¼‰ã€‚ </p><br><p> è€ƒè™‘ä½¿ç”¨app-teståº”ç”¨ç¨‹åºï¼ˆç§°ä¸ºâ€œéƒ¨ç½²â€ï¼‰ä½¿ç”¨hpaï¼Œåœ¨æ­¤æœ‰å¿…è¦æ ¹æ®CPUæ¶ˆè€—æ›´æ”¹å‰¯æœ¬æ•°ï¼š </p><br><ul><li><p> ç”³è¯·æ¸…å• </p><br><pre> <code class="plaintext hljs">kind: Deployment apiVersion: apps/v1beta2 metadata: name: app-test spec: selector: matchLabels: app: app-test replicas: 2 template: metadata: labels: app: app-test spec: containers: - name: nginx image: registry.nixys.ru/generic-images/nginx imagePullPolicy: Always resources: requests: cpu: 60m ports: - name: http containerPort: 80 - name: nginx-exporter image: nginx/nginx-prometheus-exporter resources: requests: cpu: 30m ports: - name: nginx-exporter containerPort: 9113 args: - -nginx.scrape-uri - http://127.0.0.1:80/nginx-status</code> </pre> <br><p> å³ æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸‹ï¼Œå®ƒæœ€åˆæ˜¯åœ¨ä¸¤ä¸ªå®ä¾‹ä¸­å¯åŠ¨çš„ï¼Œæ¯ä¸ªå®ä¾‹åŒ…å«ä¸¤ä¸ªå®¹å™¨nginxå’Œnginx-exporterï¼Œæ¯ä¸ªå®¹å™¨éƒ½ç»™å‡ºäº†å¯¹CPUçš„<strong>è¯·æ±‚</strong> ã€‚ </p><br></li><li><p>  HPAæ¸…å• </p><br><pre> <code class="plaintext hljs">apiVersion: autoscaling/v2beta2 kind: HorizontalPodAutoscaler metadata: name: app-test-hpa spec: maxReplicas: 10 minReplicas: 2 scaleTargetRef: apiVersion: extensions/v1beta1 kind: Deployment name: app-test metrics: - type: Resource resource: name: cpu target: type: Utilization averageUtilization: 30</code> </pre> <br><p> å³ æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªhpaæ¥ç›‘æ§Deployment app-testå¹¶æ ¹æ®cpuæŒ‡æ ‡è°ƒæ•´åº”ç”¨ç¨‹åºçš„ç‚‰åºŠæ•°é‡ï¼ˆæˆ‘ä»¬å¸Œæœ›ç‚‰åºŠæ¶ˆè€—å…¶è¯·æ±‚çš„CPUçš„30ï¼…ï¼‰ï¼Œè€Œå‰¯æœ¬æ•°åœ¨2-10ä¹‹é—´ã€‚ </p><br><p> ç°åœ¨ï¼Œå¦‚æœå°†è´Ÿè½½æ–½åŠ åˆ°ä¸€ä¸ªç‚‰è†›ä¸Šï¼Œæˆ‘ä»¬å°†è€ƒè™‘hpaæ“ä½œæœºåˆ¶ï¼š </p><br><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment"># kubectl top pod NAME CPU(cores) MEMORY(bytes) app-test-78559f8f44-pgs58 101m 243Mi app-test-78559f8f44-cj4jz 4m 240Mi</span></span></code> </pre> <br></li></ul><br><p> æ€»è®¡ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å†…å®¹ï¼š </p><br><ul><li> æœŸæœ›å€¼ï¼ˆdesiredMetricValueï¼‰-æ ¹æ®hpaè®¾ç½®ï¼Œæˆ‘ä»¬æœ‰30ï¼… </li><li> å½“å‰å€¼ï¼ˆcurrentMetricValueï¼‰-ä¸ºäº†è¿›è¡Œè®¡ç®—ï¼Œæ§åˆ¶å™¨ç®¡ç†å™¨ä»¥ï¼…ä¸ºå•ä½è®¡ç®—èµ„æºæ¶ˆè€—çš„å¹³å‡å€¼ï¼Œå³ æœ‰æ¡ä»¶åœ°æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š <br><ol><li> ä»æŒ‡æ ‡æœåŠ¡å™¨è·å–ç‚‰åºŠæŒ‡æ ‡çš„ç»å¯¹å€¼ï¼Œå³  101må’Œ4m </li><li> è®¡ç®—å¹³å‡ç»å¯¹å€¼ï¼Œå³  ï¼ˆ101m + 4mï¼‰/ 2 = 53m </li><li> è·å–æ‰€éœ€èµ„æºæ¶ˆè€—çš„ç»å¯¹å€¼ï¼ˆä¸ºæ­¤ï¼Œæ‰€æœ‰å®¹å™¨çš„è¯·æ±‚æ±‚å’Œï¼‰60m + 30m = 90m </li><li> è®¡ç®—ç›¸å¯¹äºè¯·æ±‚ç‚‰åºŠçš„CPUæ¶ˆè€—çš„å¹³å‡ç™¾åˆ†æ¯”ï¼Œå³  53m / 90m * 100ï¼…= 59ï¼… </li></ol></li></ul><br><p> ç°åœ¨ï¼Œæˆ‘ä»¬å…·æœ‰ç¡®å®šæ˜¯å¦éœ€è¦æ›´æ”¹å‰¯æœ¬æ•°çš„æ‰€æœ‰å¿…è¦æ¡ä»¶ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬è®¡ç®—ç³»æ•°ï¼š </p><br><p> <code>ratio = 59% / 30% = 1.96</code> </p> <br><p> å³ å¤åˆ¶å‰¯æœ¬çš„æ•°é‡åº”å¢åŠ çº¦2å€ï¼Œå¹¶ç»„æˆ[2 * 1.96] = 4ã€‚ </p><br><p>  <strong>ç»“è®ºï¼š</strong>å¦‚æ‚¨æ‰€è§ï¼Œä¸ºäº†ä½¿æ­¤æœºåˆ¶èµ·ä½œç”¨ï¼Œå…ˆå†³æ¡ä»¶æ˜¯åŒ…æ‹¬å¯¹è§‚å¯Ÿåˆ°çš„ç‚‰è†›ä¸­æ‰€æœ‰å®¹å™¨çš„è¯·æ±‚çš„å¯ç”¨æ€§ã€‚ </p><br><h2 id="mehanizm-gorizontalnogo-avtomasshtabirovaniya-nod-cluster-autoscaler"> èŠ‚ç‚¹çš„æ°´å¹³è‡ªåŠ¨ç¼©æ”¾æœºåˆ¶ï¼ˆCluster Autoscalerï¼‰ </h2><br><p> ä¸ºäº†æ¶ˆé™¤è´Ÿè½½çªå¢æœŸé—´å¯¹ç³»ç»Ÿçš„è´Ÿé¢å½±å“ï¼Œä»…è°ƒæ•´hpaçš„å­˜åœ¨æ˜¯ä¸å¤Ÿçš„ã€‚ ä¾‹å¦‚ï¼Œæ ¹æ®hpaæ§åˆ¶å™¨ç®¡ç†å™¨ä¸­çš„è®¾ç½®ï¼Œéœ€è¦å°†å‰¯æœ¬æ•°é‡å¢åŠ 2å€ï¼Œä½†æ˜¯ï¼ŒèŠ‚ç‚¹ä¸Šæ²¡æœ‰å¯ç”¨çš„èµ„æºæ¥è¿è¡Œå¦‚æ­¤æ•°é‡çš„Podï¼ˆå³èŠ‚ç‚¹æ— æ³•ä¸ºPodè¯·æ±‚æä¾›è¯·æ±‚çš„èµ„æºï¼‰ä»¥åŠè¿™äº›Podè¿›å…¥å¾…å¤„ç†çŠ¶æ€ã€‚ </p><br><p> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœæä¾›è€…å…·æœ‰é€‚å½“çš„IaaS / PaaSï¼ˆä¾‹å¦‚GKE / GCEï¼ŒAKSï¼ŒEKSç­‰ï¼‰ï¼Œåˆ™è¯¸å¦‚<strong>Node Autoscalerä¹‹</strong>ç±»çš„å·¥å…·å¯ä»¥ä¸ºæˆ‘ä»¬æä¾›å¸®åŠ©ã€‚ å½“é›†ç¾¤ä¸­çš„èµ„æºä¸è¶³å¹¶ä¸”æ— æ³•è°ƒåº¦Podæ—¶ï¼ˆé€šè¿‡PendingçŠ¶æ€ï¼‰ï¼Œå®ƒå…è®¸æ‚¨è®¾ç½®é›†ç¾¤ä¸­èŠ‚ç‚¹çš„æœ€å¤§å’Œæœ€å°æ•°ç›®ï¼Œå¹¶è‡ªåŠ¨è°ƒæ•´å½“å‰èŠ‚ç‚¹æ•°ï¼ˆé€šè¿‡è®¿é—®äº‘æä¾›å•†APIæ¥è®¢è´­/åˆ é™¤èŠ‚ç‚¹ï¼‰ã€‚ </p><br><p>  <strong>ç»“è®ºï¼š</strong>ä¸ºäº†èƒ½å¤Ÿè‡ªåŠ¨æ‰©å±•èŠ‚ç‚¹ï¼Œå¿…é¡»åœ¨ç‚‰åºŠå®¹å™¨ä¸­æŒ‡å®šè¯·æ±‚ï¼Œä»¥ä¾¿k8så¯ä»¥æ­£ç¡®è¯„ä¼°èŠ‚ç‚¹çš„è´Ÿè½½ï¼Œå¹¶ç›¸åº”åœ°æŠ¥å‘Šé›†ç¾¤ä¸­æ²¡æœ‰èµ„æºæ¥å¯åŠ¨ä¸‹ä¸€ä¸ªç‚‰åºŠã€‚ </p><br><hr><br><h2 id="zaklyuchenie"> ç»“è®º </h2><br><p> åº”å½“æ³¨æ„ï¼Œä¸ºå®¹å™¨è®¾ç½®èµ„æºé™åˆ¶ä¸æ˜¯æˆåŠŸå¯åŠ¨åº”ç”¨ç¨‹åºçš„å…ˆå†³æ¡ä»¶ï¼Œä½†æ˜¯å‡ºäºä»¥ä¸‹åŸå› ï¼Œè¿™æ ·åšè¿˜æ˜¯æ›´å¥½çš„ï¼š </p><br><ol><li> ä¸ºäº†åœ¨k8sèŠ‚ç‚¹ä¹‹é—´çš„è´Ÿè½½å¹³è¡¡æ–¹é¢å®ç°æ›´ç²¾ç¡®çš„è°ƒåº¦ç¨‹åºæ“ä½œ </li><li> ä¸ºäº†å‡å°‘å‘ç”Ÿç‚‰è†›æ¬è¿äº‹ä»¶çš„å¯èƒ½æ€§ </li><li> ç”¨äºæ°´å¹³è‡ªåŠ¨ç¼©æ”¾åº”ç”¨ç‚‰åºŠï¼ˆHPAï¼‰ </li><li> ç”¨äºäº‘æä¾›å•†çš„èŠ‚ç‚¹çš„æ°´å¹³è‡ªåŠ¨ç¼©æ”¾ï¼ˆç¾¤é›†è‡ªåŠ¨ç¼©æ”¾ï¼‰ </li></ol><br><h2 id="takzhe-chitayte-drugie-stati-v-nashem-bloge"> å¦è¯·é˜…è¯»æˆ‘ä»¬åšå®¢ä¸Šçš„å…¶ä»–æ–‡ç« ï¼š </h2><br><ul><li>  <a href="https://habr.com/ru/company/nixys/blog/481992/">Tektonç®¡é“-KubernetesåŸç”Ÿç®¡é“</a> </li><li>  <a href="https://habr.com/ru/company/nixys/blog/473578/">ä¸ºNginxæ„å»ºåŠ¨æ€æ¨¡å—</a> </li><li>  <a href="https://habr.com/ru/company/nixys/blog/468779/">ä»æœªç»æˆæƒçš„ClickHouseè¿ç§»åˆ°å…·æœ‰æˆæƒçš„ClickHouseçš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</a> </li><li>  <a href="https://habr.com/ru/company/nixys/blog/461723/">äº†è§£Golangä¸­çš„ContextåŒ…</a> </li><li>  <a href="https://habr.com/ru/company/nixys/blog/437372/">å‡å°‘Dockeræ˜ åƒçš„ä¸‰ä¸ªç®€å•æŠ€å·§</a> </li><li>  <a href="https://habr.com/ru/company/nixys/blog/424717/">å¤‡ä»½å¤§é‡å¼‚æ„Webé¡¹ç›®</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN480072/">https://habr.com/ru/post/zh-CN480072/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN480060/index.html">ç®€å•çš„P300åˆ†ç±»å™¨å¯å¤„ç†å¼€æ”¾æ•°æ®</a></li>
<li><a href="../zh-CN480062/index.html">10ä¸ªæ§åˆ¶ç³»ç»Ÿã€‚ åœ¨ä»»åŠ¡ä¸Šè¿›è¡Œäº¤æµå’Œå…±äº«æ–‡ä»¶åœ¨å“ªé‡Œæ›´æ–¹ä¾¿ï¼Ÿ</a></li>
<li><a href="../zh-CN480064/index.html">å­¦ä¹ æŒ‰ä¸»é¢˜åˆ†ç»„çš„å•è¯</a></li>
<li><a href="../zh-CN480068/index.html">[æ›´æ–°]æˆ‘ä»¬çš„äººæ°‘é­åˆ°æ®´æ‰“ï¼Œæˆ‘ä»¬ä¼šä¿æŒæ²‰é»˜å—ï¼Ÿ</a></li>
<li><a href="../zh-CN480070/index.html">ååº”æ”¶ç›Šï¼šä¼ä¸šçš„ç¦æ°”ï¼Ÿ</a></li>
<li><a href="../zh-CN480076/index.html">å¯¹æ¥è‡ªå„ç§æ¥æºçš„æ•°æ®è¿›è¡Œå¤šå¤„ç†å’Œæ ¸å¯¹</a></li>
<li><a href="../zh-CN480078/index.html">Reactå¤–è®¾ä¸Šçš„æ–°å‰ç«¯åº“</a></li>
<li><a href="../zh-CN480080/index.html">æ‚¨åœ¨åšç¬”è®°åº”ç”¨ç¨‹åºæ—¶éœ€è¦ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="../zh-CN480082/index.html">åœ¨MySQLä¸­ä¸ºZabbixä½¿ç”¨åˆ†åŒºå’Œå¤§é‡ç›‘è§†å¯¹è±¡</a></li>
<li><a href="../zh-CN480086/index.html">å¦‚ä½•ç¬¦åˆ152-FZçš„è¦æ±‚ï¼Œä¿æŠ¤å®¢æˆ·çš„ä¸ªäººæ•°æ®ï¼Œè€Œä¸æ˜¯è¸©æˆ‘ä»¬çš„è€™å­</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>