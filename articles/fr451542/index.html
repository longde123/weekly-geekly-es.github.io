<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≤üèª üò¢ üëàüèª Comment et pourquoi avons-nous fait une reconnaissance historique dans Mail.ru Cloud üëÉüèª üôÖüèø üñäÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Avec l'av√®nement des appareils photo de haute qualit√© dans les t√©l√©phones mobiles, nous photographions de plus en plus souvent, filmant des vid√©os des...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment et pourquoi avons-nous fait une reconnaissance historique dans Mail.ru Cloud</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/451542/"><img src="https://habrastorage.org/getpro/habr/post_images/a5d/eeb/615/a5deeb615e9a57fb482a1a5464ab6fcc.png"><br><br>  Avec l'av√®nement des appareils photo de haute qualit√© dans les t√©l√©phones mobiles, nous photographions de plus en plus souvent, filmant des vid√©os des moments forts et importants de notre vie.  Beaucoup d'entre nous ont des archives photographiques datant de dizaines d'ann√©es et des milliers de photographies, dans lesquelles il devient de plus en plus difficile de naviguer.  Rappelez-vous combien de temps il a fallu souvent pour trouver la bonne photo il y a plusieurs ann√©es. <br><br>  L'un des objectifs de Mail.ru Cloud est de fournir l'acc√®s et la recherche les plus pratiques dans vos archives photo et vid√©o.  Pour ce faire, nous, l'√©quipe de vision industrielle de Mail.ru, avons cr√©√© et mis en ≈ìuvre des syst√®mes intelligents de traitement de photos: recherche par objets, sc√®nes, visages, etc. Une autre technologie aussi frappante est la reconnaissance des vues.  Et aujourd'hui, je vais vous expliquer comment nous avons r√©solu ce probl√®me avec l'aide du Deep Learning. <br><a name="habracut"></a><br>  Imaginez la situation: vous √™tes parti en vacances et avez apport√© un tas de photos.  Et dans une conversation avec des amis, ils vous ont demand√© de montrer comment vous avez visit√© un palais, un ch√¢teau, une pyramide, un temple, un lac, une cascade, une montagne, etc.  Vous commencez √† parcourir fr√©n√©tiquement le dossier avec des photos, en essayant de trouver le bon.  Tr√®s probablement, vous ne le trouvez pas parmi des centaines d'images, et dites que vous le montrerez plus tard. <br><br>  Nous r√©solvons ce probl√®me en regroupant les photos personnalis√©es dans des albums.  Cela vous permet de trouver facilement les bonnes images en quelques clics.  Nous avons maintenant des albums sur les visages, sur les objets et les sc√®nes, ainsi que sur les attractions. <br><br>  Les photos avec des points de rep√®re sont importantes car elles affichent souvent des moments importants de notre vie (par exemple, les voyages).  Il peut s'agir de photographies en arri√®re-plan d'une structure architecturale ou d'un coin de la nature vierge de l'homme.  Par cons√©quent, nous devons trouver ces photos et donner aux utilisateurs un acc√®s facile et rapide √† elles. <br><br><h1>  Reconnaissance des fonctionnalit√©s </h1><br>  Mais il y a une nuance: vous ne pouvez pas simplement prendre et former un mod√®le pour reconna√Ætre les sites, il y a beaucoup de difficult√©s. <br><br><ul><li>  Premi√®rement, nous ne pouvons pas d√©crire clairement ce qu'est un ¬´point de rep√®re¬ª.  Nous ne pouvons pas dire pourquoi un b√¢timent est un point de rep√®re, et se tenir √† c√¥t√© de lui ne l'est pas.  Ce n'est pas un concept formalis√©, ce qui complique la formulation du probl√®me de reconnaissance. <br></li><li>  Deuxi√®mement, les sites sont extr√™mement divers.  Il peut s'agir de b√¢timents historiques ou culturels - temples, palais, ch√¢teaux.  Ce peuvent √™tre les monuments les plus divers.  Il peut s'agir d'objets naturels - lacs, canyons, cascades.  Et un mod√®le doit pouvoir trouver toutes ces attractions. <br></li><li>  Troisi√®mement, il y a tr√®s peu d'images avec des vues, selon nos calculs, elles ne se trouvent que dans 1 √† 3% des photos des utilisateurs.  Par cons√©quent, nous ne pouvons pas nous permettre des erreurs de reconnaissance, car si nous montrons √† une personne une photo sans point d'int√©r√™t, elle sera imm√©diatement perceptible et provoquera la confusion et des r√©actions n√©gatives.  Ou, au contraire, nous avons montr√© √† la personne une photo avec un point de rep√®re √† New York, et il n'√©tait jamais all√© en Am√©rique.  Le mod√®le de reconnaissance doit donc avoir un FPR faible (taux de faux positifs). <br></li><li>  Quatri√®mement, environ 50% des utilisateurs, voire plus, d√©sactivent le stockage des informations g√©ographiques lors de la photographie.  Nous devons en tenir compte et d√©terminer la place uniquement √† partir de l'image.  La plupart des services qui parviennent aujourd'hui √† travailler avec des lieux d'int√©r√™t le font gr√¢ce aux g√©odonn√©es.  Nos exigences initiales √©taient plus strictes. <br></li></ul><br>  Je vais montrer maintenant avec des exemples. <br><br>  Voici des objets similaires, trois cath√©drales gothiques fran√ßaises.  La gauche est la cath√©drale d'Amiens, au milieu de la cath√©drale de Reims, √† droite est Notre Dame de Paris. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd4/da6/7f7/bd4da67f77caa21c8afdd344e1e1a05a.png"><br><br>  M√™me une personne a besoin d'un certain temps pour les regarder et comprendre qu'il s'agit de cath√©drales diff√©rentes, et la machine doit √©galement √™tre en mesure d'y faire face, et plus rapidement qu'une personne. <br><br>  Et voici un exemple d'une autre difficult√©: les trois photos sur la diapositive sont Notre Dame de Paris, prises sous des angles diff√©rents.  Les photos se sont av√©r√©es tr√®s diff√©rentes, mais elles doivent toutes √™tre reconnues et trouv√©es. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/837/0a4/f9b/8370a4f9b8785814cd4cc7368770aac2.png"><br><br>  Les objets naturels sont compl√®tement diff√©rents de ceux architecturaux.  √Ä gauche, C√©sar√©e en Isra√´l, √† droite, le parc anglais de Munich. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/55d/632/245/55d632245cf529e935e25a78de40f020.png"><br><br>  Dans ces photographies, il y a tr√®s peu de d√©tails caract√©ristiques pour lesquels le mod√®le peut ¬´s'accrocher¬ª. <br><br><h1>  Notre m√©thode </h1><br>  Notre m√©thode est enti√®rement bas√©e sur des r√©seaux neuronaux convolutionnels profonds.  En tant qu'approche de l'apprentissage, ils ont choisi ce que l'on appelle l'apprentissage curriculaire - l'apprentissage en plusieurs √©tapes.  Afin de travailler plus efficacement √† la fois en pr√©sence et en l'absence de g√©odonn√©es, nous avons fait une d√©duction sp√©ciale (conclusion).  Je vais vous parler plus en d√©tail de chacune des √©tapes. <br><br><h1>  Datacet </h1><br>  Le carburant de l'apprentissage automatique est la donn√©e.  Et tout d'abord, nous devions collecter un ensemble de donn√©es pour la formation des mod√®les. <br><br>  Nous avons divis√© le monde en 4 r√©gions, chacune √©tant utilis√©e √† diff√©rents stades de formation.  Ensuite, des pays ont √©t√© pris dans chaque r√©gion, pour chaque pays une liste de villes a √©t√© compil√©e et une base de donn√©es de photographies de leurs attractions a √©t√© compil√©e.  Des exemples de donn√©es sont pr√©sent√©s ci-dessous. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3f6/e54/629/3f6e546299616e59efd6a1a1464b9b65.png"><br><br>  Tout d'abord, nous avons essay√© de former notre mod√®le sur la base r√©sultante.  Les r√©sultats √©taient mauvais.  Ils ont commenc√© √† analyser, et il s'est av√©r√© que les donn√©es sont tr√®s "sales".  Chaque attraction avait une grande quantit√© de d√©chets.  Que faire  L'examen manuel de l'√©norme quantit√© de donn√©es est co√ªteux, morne et peu intelligent.  Par cons√©quent, nous avons effectu√© un nettoyage automatique de la base, au cours duquel le traitement manuel n'est utilis√© qu'en une seule √©tape: pour chaque attraction, nous avons s√©lectionn√© manuellement 3-5 photographies de r√©f√©rence qui contiennent avec pr√©cision l'attraction souhait√©e dans une perspective plus ou moins correcte.  Cela se r√©v√®le assez rapidement, car le volume de ces donn√©es de r√©f√©rence est faible par rapport √† l'ensemble de la base de donn√©es.  Ensuite, un nettoyage automatique bas√© sur des r√©seaux de neurones convolutionnels profonds est d√©j√† effectu√©. <br><br>  De plus, j'utiliserai le terme ¬´int√©gration¬ª, par lequel je comprendrai ce qui suit.  Nous avons un r√©seau de neurones convolutionnels, nous l'avons form√© pour la classification, coup√© la derni√®re couche de classification, pris quelques images, travers√© le r√©seau et re√ßu un vecteur num√©rique √† la sortie.  Je l'appellerai int√©gration. <br><br>  Comme je l'ai dit, notre formation s'est d√©roul√©e en plusieurs √©tapes, correspondant √† des parties de notre base de donn√©es.  Par cons√©quent, nous prenons d'abord soit un r√©seau de neurones de l'√©tape pr√©c√©dente, soit un r√©seau d'initialisation. <br><br>  Nous allons diffuser les photos des sites touristiques sur le r√©seau et obtenir plusieurs int√©grations.  Vous pouvez maintenant nettoyer la base.  Nous prenons toutes les photos de l'ensemble de donn√©es pour cette attraction, et nous conduisons √©galement chaque photo √† travers le r√©seau.  Nous obtenons un tas de plongements et pour chacun d'eux, nous consid√©rons les distances par rapport √† l'int√©gration des normes.  Ensuite, nous calculons la distance moyenne, et si elle est sup√©rieure √† un certain seuil, qui est le param√®tre de l'algorithme, nous consid√©rons que ce n'est pas une attraction touristique.  Si la distance moyenne est inf√©rieure au seuil, alors nous laissons cette photo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/305/300/a87/305300a8734289229c57e0d1876fa74e.png"><br><br>  En cons√©quence, nous avons obtenu une base de donn√©es qui contient plus de 11 mille attractions de plus de 500 villes dans 70 pays du monde - plus de 2,3 millions de photos.  Il est maintenant temps de se rappeler que la plupart des photos ne contiennent aucune attraction.  Ces informations doivent √™tre partag√©es d'une mani√®re ou d'une autre avec nos mod√®les.  Par cons√©quent, nous avons ajout√© 900 000 photos sans vues √† notre base de donn√©es et form√© notre mod√®le sur l'ensemble de donn√©es r√©sultant. <br><br>  Pour mesurer la qualit√© de la formation, nous avons introduit un test hors ligne.  Sur la base du fait que les vues ne se trouvent que dans environ 1 √† 3% des photographies, nous avons compil√© manuellement un ensemble de 290 photographies qui montrent des vues.  Ce sont des photographies diff√©rentes et assez complexes avec un grand nombre d'objets pris sous des angles diff√©rents, de sorte que le test est aussi difficile que possible pour le mod√®le.  Par le m√™me principe, nous avons s√©lectionn√© 11 000 photographies sans vues, qui sont √©galement assez complexes, et nous avons essay√© de trouver des objets tr√®s similaires aux vues disponibles dans notre base de donn√©es. <br><br>  Pour √©valuer la qualit√© de la formation, nous mesurons la pr√©cision de notre mod√®le √† partir de photographies avec et sans viseurs.  Ce sont nos deux principales mesures. <br><br><h1>  Approches existantes </h1><br>  Il existe relativement peu d'informations sur la reconnaissance de la vue dans la litt√©rature scientifique.  La plupart des solutions sont bas√©es sur des fonctionnalit√©s locales.  L'id√©e est que nous avons une certaine image de demande et une image de la base de donn√©es.  Dans ces images, nous trouvons des panneaux locaux - des points cl√©s et les comparons.  Si le nombre de correspondances est suffisamment important, nous pensons avoir trouv√© un point d'int√©r√™t. <br><br>  √Ä ce jour, la meilleure m√©thode est la m√©thode propos√©e par Google, DELF (fonctionnalit√©s locales approfondies), dans laquelle une comparaison des fonctionnalit√©s locales est combin√©e avec un apprentissage en profondeur.  En ex√©cutant l'image d'entr√©e via le r√©seau de convolution, nous obtenons des signes DELF. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e17/a2d/803/e17a2d803135ba5a7821842f035b1cf8.png"><br><br>  Comment est la reconnaissance des attractions?  Nous avons une base de donn√©es de photos et une image d'entr√©e, et nous voulons comprendre s'il y a une attraction touristique ou non.  Nous ex√©cutons toutes les images via DELF, nous obtenons les signes correspondants pour la base et pour l'image d'entr√©e.  Ensuite, nous effectuons une recherche en utilisant la m√©thode des voisins les plus proches et en sortie, nous obtenons des images candidates avec des signes.  Nous comparons ces signes √† l'aide d'une v√©rification g√©om√©trique: s'ils r√©ussissent, nous pensons qu'il y a un point d'int√©r√™t dans l'image. <br><br><h1>  R√©seau de neurones convolutifs </h1><br>  Pour le Deep Learning, la pr√©-formation est cruciale.  Par cons√©quent, nous avons pris la base des sc√®nes et nous avons pr√©-form√© notre r√©seau de neurones.  Pourquoi  Une sc√®ne est un objet complexe qui comprend un grand nombre d'autres objets.  Et l'attraction est un cas particulier de la sc√®ne.  Un mod√®le de pr√©-formation sur une telle base, nous pouvons donner au mod√®le une id√©e de certaines fonctionnalit√©s de bas niveau qui peuvent ensuite √™tre g√©n√©ralis√©es pour la reconnaissance r√©ussie des attractions. <br><br>  Comme mod√®le, nous avons utilis√© un r√©seau de neurones de la famille des r√©seaux r√©siduels.  Leur principale caract√©ristique est qu'ils utilisent un bloc r√©siduel, qui comprend une connexion de saut, qui permet au signal de passer librement sans entrer dans des couches avec des poids.  Avec cette architecture, vous pouvez entra√Æner qualitativement des r√©seaux profonds et g√©rer l'effet du flou de d√©grad√©, ce qui est tr√®s important lors de l'apprentissage. <br><br>  Notre mod√®le est Wide ResNet 50-2, une modification de ResNet 50, dans laquelle le nombre de convolutions dans le bloc de goulot d'√©tranglement interne est doubl√©. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/008/a1f/544/008a1f544843103423b5bcdb4c8b1fe5.png"><br><br>  Le r√©seau est tr√®s efficace.  Nous avons effectu√© des tests sur notre base de donn√©es de sc√®nes et voici ce que nous avons obtenu: <br><br><div class="scrollable-table"><table><tbody><tr><th>  Mod√®le <br></th><th>  Top 1 err <br></th><th>  Top 5 des erreurs <br></th></tr><tr><td>  ResNet-50 <br></td><td>  46,1% <br></td><td>  15,7% <br></td></tr><tr><td>  ResNet-200 <br></td><td>  42,6% <br></td><td>  12,9% <br></td></tr><tr><td>  SE-ResNext-101 <br></td><td>  42% <br></td><td>  12,1% <br></td></tr><tr><td>  WRN-50-2 (rapide!) <br></td><td>  41,8% <br></td><td>  11,8% <br></td></tr></tbody></table></div><br>  Wide ResNet s'est av√©r√© √™tre presque deux fois plus rapide que le r√©seau ResNet 200, assez grand. Et la vitesse de fonctionnement est tr√®s importante pour le fonctionnement.  Sur la base de la totalit√© de ces circonstances, nous avons pris Wide ResNet 50-2 comme notre principal r√©seau de neurones. <br><br><h2>  La formation </h2><br>  Pour former le r√©seau, nous avons besoin de perte (fonction de perte).  Pour le s√©lectionner, nous avons d√©cid√© d'utiliser l'approche d'apprentissage m√©trique: un r√©seau de neurones est form√© afin que les repr√©sentants de la m√™me classe soient rassembl√©s dans un cluster.  Dans le m√™me temps, les clusters pour diff√©rentes classes doivent √™tre aussi √©loign√©s que possible.  Pour les attractions, nous avons utilis√© la perte centrale, qui rassemble des points de la m√™me classe √† un certain centre.  Une caract√©ristique importante de cette approche est qu'elle ne n√©cessite pas d'√©chantillonnage n√©gatif, ce qui dans les √©tapes ult√©rieures de la formation est une proc√©dure assez difficile. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27a/ed1/cfb/27aed1cfbe8d7cffa90bc1a96b578eff.png"><br><br>  Permettez-moi de vous rappeler que nous avons n classes d'attractions et une autre classe de ¬´pas d'attractions¬ª, la perte centrale n'est pas utilis√©e pour cela.  Nous voulons dire qu'un point de rep√®re est un seul et m√™me objet, et qu'il y a une structure en lui, il est donc conseill√© d'envisager un centre pour lui.  Mais aucune attraction touristique ne peut √™tre rien, et consid√©rer le centre pour lui est d√©raisonnable. <br><br>  Ensuite, nous avons tout rassembl√© et obtenu un mod√®le de formation.  Il se compose de trois parties principales: <br><br><ul><li>  R√©seau de neurones convolutifs Wide ResNet 50-2, pr√©-form√© sur la base de sc√®nes; <br></li><li>  Parties d‚Äôincorporation constitu√©es d‚Äôune couche enti√®rement connect√©e et d‚Äôune couche normalis√©e par lots; <br></li><li>  Un classificateur, qui est une couche enti√®rement connect√©e, suivi d'une paire de perte Softmax et de perte centrale. <br></li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/6dd/7bf/338/6dd7bf33835ea1d84565a04c5ff1e281.jpg"><br><br>  Comme vous vous en souvenez, notre base est divis√©e en 4 parties par r√©gion du monde.  Nous utilisons ces 4 parties dans le cadre du paradigme d'apprentissage du curriculum.  √Ä chaque √©tape, nous avons l'ensemble de donn√©es actuel, nous y ajoutons une autre partie du monde et nous obtenons un nouvel ensemble de donn√©es de formation. <br><br>  Le mod√®le se compose de trois parties, et pour chacune d'elles, nous utilisons notre propre rythme d'apprentissage en formation.  Cela est n√©cessaire pour que le r√©seau puisse non seulement apprendre les vues de la nouvelle partie de l'ensemble de donn√©es que nous avons ajout√©, mais aussi qu'il n'oublie pas les donn√©es d√©j√† apprises.  Apr√®s de nombreuses exp√©riences, cette approche s'est av√©r√©e la plus efficace. <br><br>  Nous avons donc form√© le mod√®le.  Vous devez comprendre comment cela fonctionne.  Utilisons la carte d'activation de classe pour voir quelle partie de l'image est la plus sensible √† notre r√©seau neuronal.  Dans l'image ci-dessous, dans la premi√®re ligne, les images d'entr√©e, et dans la seconde, elles sont superpos√©es √† la carte d'activation de classe de la grille, que nous avons form√©e √† l'√©tape pr√©c√©dente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5aa/4aa/264/5aa4aa26413082931c28f1a393a64b95.png"><br><br>  La carte thermique montre √† quelles parties de l'image le r√©seau accorde plus d'attention.  De la carte d'activation de classe, on peut voir que notre r√©seau de neurones a r√©ussi √† apprendre le concept d'attraction. <br><br><h2>  Inf√©rence </h2><br>  Maintenant, vous devez en quelque sorte utiliser ces connaissances pour obtenir le r√©sultat.  Puisque nous avons utilis√© la perte de centre pour la formation, il semble tout √† fait logique √† l'inf√©rence de calculer √©galement le tserotoid pour les attractions. <br><br>  Pour cela, nous prenons une partie des images du set d'entra√Ænement pour une sorte d'attraction, par exemple pour le Bronze Horseman.  Nous les ex√©cutons √† travers le r√©seau, obtenons des int√©grations, une moyenne et obtenons un centro√Øde. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c49/b0f/69e/c49b0f69e33581f30c05985a98702f6f.png"><br><br>  Mais la question se pose: combien de centro√Ødes pour une attraction est-il logique de calculer?  Au d√©but, la r√©ponse semble claire et logique: un centro√Øde.  Mais ce ne fut pas tout √† fait le cas.  Au d√©but, nous avons √©galement d√©cid√© de faire un centro√Øde et avons obtenu un assez bon r√©sultat.  Alors pourquoi avez-vous besoin de prendre quelques centro√Ødes? <br><br>  Premi√®rement, nos donn√©es ne sont pas enti√®rement propres.  Bien que nous ayons nettoy√© l'ensemble de donn√©es, nous n'avons supprim√© que les ordures.  Et nous pourrions avoir des images qui ne pourraient pas √™tre consid√©r√©es comme des ordures, mais qui aggravent le r√©sultat. <br><br>  Par exemple, j'ai une classe embl√©matique du Palais d'hiver.  Je veux lui compter un centro√Øde.  Mais l'ensemble comprenait un certain nombre de photographies de la place du Palais et de l'arc du b√¢timent de l'√©tat-major.  Si nous consid√©rons le centro√Øde dans toutes les images, il se r√©v√©lera pas trop stable.  Il est n√©cessaire de regrouper en quelque sorte leurs plongements, qui sont obtenus √† partir de la grille habituelle, de ne prendre que le centro√Øde responsable du Palais d'hiver et de calculer la moyenne en fonction de ces donn√©es. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/000/7b7/8ef/0007b78efb3d15296bab0ebef0cf4dfb.png"><br><br>  Deuxi√®mement, les photographies peuvent √™tre prises sous diff√©rents angles. <br><br>  Je citerai le clocher de Belfort √† Bruges comme illustration de ce comportement.  Deux centro√Ødes sont compt√©s pour elle.  Dans la rang√©e sup√©rieure de l'image se trouvent les photos les plus proches du premier centro√Øde, et dans la deuxi√®me rang√©e - celles qui sont plus proches du deuxi√®me centro√Øde: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d13/5f4/105/d135f4105f2823a612e458f946e25221.png"><br><br>  Le premier centro√Øde est responsable des photos rapproch√©es plus ¬´intelligentes¬ª prises depuis la place du march√© de Bruges.  Et le deuxi√®me centro√Øde est responsable des photographies prises de loin, des rues adjacentes. <br><br>  Il s'av√®re qu'en calculant plusieurs centro√Ødes par classe d'un point d'int√©r√™t, nous pouvons afficher diff√©rents angles de ce point d'int√©r√™t par d√©duction. <br><br>  Alors, comment trouvons-nous ces ensembles pour calculer les centro√Ødes?  Nous appliquons un regroupement hi√©rarchique aux ensembles de donn√©es pour chaque point d'int√©r√™t - lien complet.  Avec son aide, nous trouvons des clusters valides par lesquels nous calculerons les centro√Ødes.  Par grappes valides, nous entendons celles qui, √† la suite d'une grappe, contiennent au moins 50 photographies.  Les clusters restants sont supprim√©s.  En cons√©quence, il s'est av√©r√© qu'environ 20% des vues ont plus d'un centro√Øde. <br><br>  Maintenant inf√©rence.  Nous la calculons en deux √©tapes: d'abord, nous ex√©cutons l'image d'entr√©e √† travers notre r√©seau de neurones convolutionnels et obtenons l'int√©gration, puis en utilisant le produit scalaire, nous comparons l'int√©gration avec les centro√Ødes.  Si les images contiennent des g√©odonn√©es, nous limitons la recherche aux centro√Ødes, qui se rapportent aux attractions situ√©es dans un carr√© de 1 pour 1 km du lieu de prise de vue.  Cela vous permet de rechercher plus pr√©cis√©ment, de choisir un seuil inf√©rieur pour une comparaison ult√©rieure.  Si la distance obtenue est sup√©rieure au seuil, qui est un param√®tre de l'algorithme, alors on dit que sur la photo il y a un point d'int√©r√™t avec la valeur maximale du produit scalaire.  Si moins, ce n'est pas une attraction touristique. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d01/75c/5a5/d0175c5a5142647bf9446f7d65df0509.png"><br><br>  Supposons que la photo contienne un point de rep√®re.  Si nous avons des g√©odonn√©es, nous les utilisons et affichons la r√©ponse.  S'il n'y a pas de g√©odonn√©es, nous effectuons une v√©rification suppl√©mentaire.  Lorsque nous avons nettoy√© l'ensemble de donn√©es, nous avons cr√©√© un ensemble d'images de r√©f√©rence pour chaque classe d'attractions.  Pour eux, nous pouvons compter les plongements, puis nous calculons la distance moyenne entre eux et l'incorporation de l'image de la demande.  S'il d√©passe un certain seuil, la v√©rification est r√©ussie, nous incluons les m√©tadonn√©es et affichons le r√©sultat.  Il est important de noter que nous pouvons faire une telle proc√©dure pour plusieurs attractions qui ont √©t√© trouv√©es dans l'image. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/14b/ffe/04f/14bffe04fe6ca1b3d09876432e319e53.png"><br><br><h1>  R√©sultats des tests </h1><br>  Nous avons compar√© notre mod√®le avec DELF, pour lequel nous avons pris les param√®tres pour lesquels il a montr√© les meilleurs r√©sultats sur notre test.  Les r√©sultats √©taient presque les m√™mes. <br><br><div class="scrollable-table"><table><tbody><tr><th>  Mod√®le <br></th><th>  Vues <br></th><th>  Pas d'attractions <br></th></tr><tr><td>  Notre <br></td><td>  80% <br></td><td>  99% <br></td></tr><tr><td>  Delf <br></td><td>  80,1% <br></td><td>  99% <br></td></tr></tbody></table></div><br>       :  ( 100 ),   87 %     ,  .      :  85,3 %.      46 %,     ‚Äî          . <br><br><div class="scrollable-table"><table><tbody><tr><th>  Tapez <br></th><th>  <br></th><th>     <br></th></tr><tr><td>  <br></td><td> 85,3 % <br></td><td> 87 % <br></td></tr><tr><td>  <br></td><td> 46 % <br></td><td> 13 % <br></td></tr></tbody></table></div><br>    /B-   .          10 %,       3 %,       13 %. <br><br>       DELF.  GPU DELF  7  ,    7  ,      1 .  CPU DELF             .      CPU   15  .        ,     . <br><br><h1> :    </h1><br>               .  . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/72c/df4/52e/72cdf452e2105c18f8e4375a1b69d497.png"><br><br>   ,        .   ¬´¬ª, ¬´¬ª, ¬´¬ª.      ,    .      ,        . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec6/7f8/929/ec67f892964ee568754a86cd48e16b51.png"><br><br>   :   , ,   .       Instagram      ,      ,    ‚Äî     . <br><br><h1>  R√©sum√© </h1><br>      . <br><br><ol><li>   .      ,      .           . <br></li><li>        deep metric learning,        . <br></li><li>       curriculum learning ‚Äî   .      .  inference    ,           . <br></li></ol><br>  ,   ‚Äî    .     ,     ,    .         -   .      ! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr451542/">https://habr.com/ru/post/fr451542/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr451528/index.html">¬´Et c'est ainsi¬ª: que les fournisseurs de cloud ne s'entendent pas sur les donn√©es personnelles</a></li>
<li><a href="../fr451532/index.html">Nouvelles du monde d'OpenStreetMap n ¬∞ 459 (30/04/2019 - 06/05/2019)</a></li>
<li><a href="../fr451534/index.html">12 principes d'animation dans le d√©veloppement de jeux vid√©o</a></li>
<li><a href="../fr451538/index.html">Guide de mise √† l'√©chelle parall√®le d'Amazon Redshift et r√©sultats des tests</a></li>
<li><a href="../fr451540/index.html">Combien de d√©veloppeurs ont besoin de cr√©er un service comme Airbnb</a></li>
<li><a href="../fr451552/index.html">Nous construisons des canaux de vente en r√©seau du gadget DO-RA</a></li>
<li><a href="../fr451556/index.html">Flutter: localisation d'applications √† l'aide d'Android Studio</a></li>
<li><a href="../fr451558/index.html">Un jour dans la vie de l'automatisation QA</a></li>
<li><a href="../fr451560/index.html">Cher client, c'est pourquoi ce changement a pris autant de temps.</a></li>
<li><a href="../fr451562/index.html">Comment √©chapper √† une secte?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>