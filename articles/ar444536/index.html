<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐พ ๐คก ๐ MVCC-2. ุทุจูุงุช ุ ูููุงุช ุ ุตูุญุงุช ๐ ๐จ ๐ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุขุฎุฑ ูุฑุฉ ุชุญุฏุซูุง ูููุง ุนู ุชูุงุณู ุงูุจูุงูุงุช ุ ุฏุฑุณูุง ุงููุฑู ุจูู ูุณุชููุงุช ูุฎุชููุฉ ูู ุนุฒู ุงููุนุงููุฉ ูู ุฎูุงู ุฃุนูู ุงููุณุชุฎุฏู ุ ูุชูุตููุง ุฅูู ูุนุฑูุฉ ุฃูููุฉ ูุนุฑูุฉ ุฐูู. ุจ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MVCC-2. ุทุจูุงุช ุ ูููุงุช ุ ุตูุญุงุช</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/444536/" style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุขุฎุฑ ูุฑุฉ</a> ุชุญุฏุซูุง ูููุง ุนู ุชูุงุณู ุงูุจูุงูุงุช ุ ุฏุฑุณูุง ุงููุฑู ุจูู ูุณุชููุงุช ูุฎุชููุฉ ูู ุนุฒู ุงููุนุงููุฉ ูู ุฎูุงู ุฃุนูู ุงููุณุชุฎุฏู ุ ูุชูุตููุง ุฅูู ูุนุฑูุฉ ุฃูููุฉ ูุนุฑูุฉ ุฐูู.  ุจุฏุฃูุง ุงูุขู ูู ูุนุฑูุฉ ููููุฉ ุชุทุจูู PostgreSQL ููุนุฒูุฉ ุงููุงุฆูุฉ ุนูู ุงูุตูุฑ ูุขููุฉ ุงูุฅุตุฏุงุฑุงุช ุงููุชุนุฏุฏุฉ. <br><br>  ูู ูุฐู ุงูููุงูุฉ ุ ุณููุธุฑ ูู ููููุฉ ูุฌูุฏ ุงูุจูุงูุงุช ูุนูููุง ูู ุงููููุงุช ูุงูุตูุญุงุช.  ูุฐุง ูููุฏูุง ุจุนูุฏูุง ุนู ููุถูุน ุงูุนุฒูุฉ ุ ููู ูุซู ูุฐุง ุงูุงูุญุฏุงุฑ ุถุฑูุฑู ูููู ุงููุฒูุฏ ูู ุงูููุงุฏ.  ูุญู ุจุญุงุฌุฉ ุฅูู ููู ููููุฉ ุนูู ุชุฎุฒูู ุงูุจูุงูุงุช ููุฎูุถ ุงููุณุชูู. <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุนูุงูุฉ (ุงูุนูุงูุงุช) </h1><br>  ุฅุฐุง ูุธุฑุช ุฏุงุฎู ุงูุฌุฏุงูู ูุงูููุงุฑุณ ุ ุงุชุถุญ ุฃููุง ูุฑุชุจุฉ ุจุทุฑููุฉ ููุงุซูุฉ.  ูู ูู ุฐูู ููุงุฆูุงุช ุฃุฎุฑู ุชุญุชูู ุนูู ุจุนุถ ุงูุจูุงูุงุช ุงูุชู ุชุชููู ูู ุฎุทูุท. <br><br>  ุญูููุฉ ุฃู ุงูุฌุฏูู ูุชููู ูู ุงูุตููู ูุง ุดู ููู ุ  ุจุงููุณุจุฉ ูููุคุดุฑ ุ ูุฐุง ุฃูู ูุถูุญูุง.  ููุน ุฐูู ุ ุชุฎูู ุดุฌุฑุฉ B: ุชุชููู ูู ุงูุนูุฏ ุงูุชู ุชุญุชูู ุนูู ููู ูููุฑุณุฉ ูุฑูุงุจุท ูุนูุฏ ุฃุฎุฑู ุฃู ุฅูู ุตููู ุงูุฌุฏูู.  ูููู ุงุนุชุจุงุฑ ูุฐู ุงูุนูุฏ ุฎุทูุท ููุฑุณ - ูู ุงููุงูุน ุ ููุง ูู. <br><br>  ูู ุงููุงูุน ุ ูุง ูุฒุงู ููุงู ุนุฏุฏ ูู ุงููุงุฆูุงุช ูุฑุชุจุฉ ุจุทุฑููุฉ ููุงุซูุฉ: ุงูุชุณูุณูุงุช (ุฌุฏุงูู ุฐุงุช ุตู ุฃุญุงุฏู ุจุดูู ุฃุณุงุณู) ุ ุทุฑู ุนุฑุถ ููููุณุฉ (ุจุดูู ุฃุณุงุณู ุฌุฏุงูู ุชุชุฐูุฑ ุงูุงุณุชุนูุงู).  ุซู ููุงู ุทุฑู ุงูุนุฑุถ ุงููุนุชุงุฏุฉ ุ ูุงูุชู ูู ุญุฏ ุฐุงุชูุง ูุง ุชุฎุฒู ุงูุจูุงูุงุช ุ ูููู ูู ุฌููุน ุงูููุงุญู ุงูุฃุฎุฑู ุชุดุจู ุงูุฌุฏุงูู. <br><br>  ุชุณูู ูู ูุฐู ุงููุงุฆูุงุช ูู PostgreSQL <em>ุนูุงูุฉ</em> ุงููููุงุช ุงูุดุงุฆุนุฉ.  ุงููููุฉ ูุคุณูุฉ ููุบุงูุฉ ูุฃููุง ูุตุทูุญ ูู ูุธุฑูุฉ ุงูุนูุงุฆููุฉ.  ููููู ุฑุณู ููุงุฒู ุจูู ุงูุนูุงูุฉ ูุงูุฌุฏูู (ุงูุนุฑุถ) ุ ูููู ุจุงูุชุฃููุฏ ููุณ ุจูู ุงูุนูุงูุฉ ูุงูููุฑุณ.  ูููู ุญุฏุซ ุฐูู: ุฌุฐูุฑ PostgreSQL ุงูุฃูุงุฏูููุฉ ุชุฌุนู ููุณูุง ุชุดุนุฑ.  ุฃุนุชูุฏ ุฃูู ูู ุงูุจุฏุงูุฉ ูุงู ูุณูู ุงูุฌุฏุงูู ูุงูุขุฑุงุก ุ ูุงูุจุงูู ููุง ูุน ูุฑูุฑ ุงูููุช. <br><a name="habracut"></a><br>  ุนูุงูุฉ ุนูู ุฐูู ุ ูู ุฃุฌู ุงูุจุณุงุทุฉ ุ ุณูู ูุชุญุฏุซ ููุท ุนู ุงูุฌุฏุงูู ูุงูููุงุฑุณ ุ ูููู ุจููุฉ <em>ุงูุนูุงูุงุช</em> ูููููุฉ ุชูุงููุง. <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุทุจูุงุช (ุงูุดูู) ูุงููููุงุช </h1><br>  ุนุงุฏุฉ ุ ูู ุนูุงูุฉ ููุง ุนุฏุฉ <em>ุทุจูุงุช</em> (ุดููุงุช).  ุชููู ุงูุทุจูุงุช ูู ุนุฏุฉ ุฃููุงุน ููู ูููุง ูุญุชูู ุนูู ููุน ูุนูู ูู ุงูุจูุงูุงุช. <br><br>  ุฅุฐุง ูุงูุช ููุงู ุทุจูุฉ ุ ูุณูุชู ุชูุซูููุง ูู ุงูุจุฏุงูุฉ <em>ุจููู</em> ูุงุญุฏ.  ูุชููู ุงุณู ุงูููู ูู ูุนุฑู ุฑููู ูููู ุฅุถุงูุฉ ุงูููุงูุฉ ุงููุทุงุจูุฉ ูุงุณู ุงูุทุจูุฉ ุฅููู. <br><br>  ูููู ุงูููู ุชุฏุฑูุฌูุงู ูุนูุฏูุง ูุตู ุญุฌูู ุฅูู 1 ุบูุบุงุจุงูุช ุ ูุชู ุฅูุดุงุก ุงูููู ุงูุชุงูู ูู ููุณ ุงูุทุจูุฉ (ุชุณูู ูุฐู ุงููููุงุช ุฃุญูุงููุง <em>ุดุฑุงุฆุญ</em> ).  ูุชู ุฅูุญุงู ุฑูู ุงููุทุนุฉ ุจููุงูุฉ ุงุณู ุงูููู. <br><br>  ูุดุฃุช ูููุฏ ุญุฌู ููู 1 ุฌูุฌุงุจุงูุช ุชุงุฑูุฎูุง ูุฏุนู ุฃูุธูุฉ ุงููููุงุช ุงููุฎุชููุฉ ุ ูุจุนุถูุง ูุง ูููู ุฃู ูุนูู ูุน ุงููููุงุช ุงููุจูุฑุฉ.  ูููู ุชุบููุฑ ุงูููุฏ ุนูุฏ ุฅูุดุงุก PostgreSQL ( <code>./configure --with-segsize</code> ). <br><br>  ูุจุงูุชุงูู ุ ูููู ุฃู ุชุชูุงูู ุนุฏุฉ ูููุงุช ูุน ุนูุงูุฉ ูุงุญุฏุฉ ุนูู ุงููุฑุต.  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ูุทุงููุฉ ุตุบูุฑุฉ ุณูููู ููุงู 3 ูููู. <br><br>  ุณูุชู ูุถุน ุฌููุน ูููุงุช ุงููุงุฆูุงุช ุงูุชู ุชูุชูู ุฅูู ูุณุงุญุฉ ุฌุฏูู ูุงุญุฏุฉ ููุงุนุฏุฉ ุจูุงูุงุช ูุงุญุฏุฉ ูู ุฏููู ูุงุญุฏ.  ูุฌุจ ุฃู ูุคุฎุฐ ุฐูู ูู ุงูุงุนุชุจุงุฑ ูุฃู ุฃูุธูุฉ ุงููููุงุช ุนุงุฏุฉ ูุง ุชุนูู ุจุดูู ุฌูุฏ ูุน ุนุฏุฏ ูุจูุฑ ูู ุงููููุงุช ูู ุงูุฏููู. <br><br>  ูุงุญุธ ููุท ุฃู ุงููููุงุช ุ ุจุฏูุฑูุง ุ ุชููุณู ุฅูู <em>ุตูุญุงุช</em> (ุฃู <em>ูุชู</em> ) ุ ุนุงุฏุฉู 8 โโูููู ุจุงูุช.  ุณูุชุญุฏุซ ุนู ุงููููู ุงูุฏุงุฎูู ููุตูุญุงุช ุฃุฏูุงู. <br><br><img src="https://habrastorage.org/webt/oz/ur/4z/ozur4zenihys-v-7wl5rnxyi8em.png"><br><br>  ุงูุขู ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุฃููุงุน ุงูุทุจูุงุช. <br><br>  <strong>ุงูุทุจูุฉ ุงูุฑุฆูุณูุฉ</strong> ูู ุงูุจูุงูุงุช ููุณูุง: ููุณ ุงูุฌุฏูู ุฃู ุตููู ุงูููุฑุณ.  ุชูุฌุฏ ุงูุทุจูุฉ ุงูุฑุฆูุณูุฉ ูุฃู ุนูุงูุฉ (ุจุงุณุชุซูุงุก ุงูุชูุซููุงุช ุงูุชู ูุง ุชุญุชูู ุนูู ุจูุงูุงุช). <br><br>  ุชุชููู ุฃุณูุงุก ุงููููุงุช ูู ุงูุทุจูุฉ ุงูุฑุฆูุณูุฉ ูู ูุนุฑู ุฑููู ููุท.  ูููุง ููู ูุซุงู ุนูู ูุณุงุฑ ููู ุงูุฌุฏูู ุงูุฐู ุฃูุดุฃูุงู ูู ุงููุฑุฉ ุงูุฃุฎูุฑุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_relation_filepath(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_relation_filepath ---------------------- base/41493/41496 (1 row)</code> </pre><br>  ูู ุฃูู ุชุฃุชู ูุฐู ุงููุนุฑูุงุชุ  ูุชูุงูู ุงูุฏููู ุงูุฃุณุงุณู ูุน ูุณุงุญุฉ ุงูุฌุฏุงูู pg_default ุ ูุงูุฏููู ุงููุฑุนู ุงูุชุงูู ูุชูุงูู ูุน ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุงูููู ุงูุฐู ููููุง ููู ููุฌูุฏ ุจุงููุนู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_database <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> datname = <span class="hljs-string"><span class="hljs-string">'test'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> oid ------- 41493 (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> relfilenode <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> relname = <span class="hljs-string"><span class="hljs-string">'accounts'</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> relfilenode ------------- 41496 (1 row)</code> </pre><br>  ุงููุณุงุฑ ูุณุจู ุ ูุชู ุญุณุงุจู ูู ุฏููู ุงูุจูุงูุงุช (PGDATA).  ุนูุงูุฉ ุนูู ุฐูู ุ ูุชู ุญุณุงุจ ุฌููุน ุงููุณุงุฑุงุช ุชูุฑูุจูุง ูู PostgreSQL ูู PGDATA.  ุจูุถู ูุฐุง ุ ููููู ููู PGDATA ุจุฃูุงู ุฅูู ููุงู ุขุฎุฑ - ูุง ูุญุชูุธ ุจุฃู ุดูุก (ุฅูุง ุฅุฐุง ููุช ูุฏ ุชุญุชุงุฌ ุฅูู ุชูููู ุงููุณุงุฑ ุฅูู ุงูููุชุจุงุช ูู LD_LIBRARY_PATH). <br><br>  ูุญู ููุธุฑ ุฅูู ุฃุจุนุฏ ูู ุฐูู ูู ูุธุงู ุงููููุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">postgres$ ls -l --time-style=+ /var/lib/postgresql/11/main/base/41493/41496</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-rw------- 1 postgres postgres 8192 /var/lib/postgresql/11/main/base/41493/41496</code> </pre><br>  ุชูุฌุฏ <strong>ุทุจูุฉ ุชููุฆุฉ</strong> ููุท ููุฌุฏุงูู ุบูุฑ ุงูููููุฉ (ุงูุชู ุชู ุฅูุดุงุคูุง ุจุงุณุชุฎุฏุงู UNLOGGED) ูููุงุฑุณูุง.  ูุฐู ุงูุฃุดูุงุก ูุง ุชุฎุชูู ุนู ุงูุฃุดูุงุก ุงูุนุงุฏูุฉ ุ ุฅูุง ุฃูู ูุง ูุชู ุชุณุฌูู ุงูุฅุฌุฑุงุกุงุช ูุนูุง ูู ุณุฌู ุงูุณุฌู ุงููุณุจู.  ูุจุณุจุจ ูุฐุง ุ ูููู ุงูุนูู ูุนูู ุฃุณุฑุน ุ ูููู ูู ุญุงูุฉ ุญุฏูุซ ุนุทู ุ ูููู ูู ุงููุณุชุญูู ุงุณุชุนุงุฏุฉ ุงูุจูุงูุงุช ูู ุญุงูุฉ ูุชุณูุฉ.  ูุฐูู ุ ุนูุฏ ุงูุงุณุชุฑุฏุงุฏ ุ ูููู PostgreSQL ุจุจุณุงุทุฉ ุจุญุฐู ุฌููุน ุทุจูุงุช ูุฐู ุงููุงุฆูุงุช ูููุชุจ ุทุจูุฉ ุงูุชููุฆุฉ ุฅูู ููุงู ุงูุทุจูุฉ ุงูุฑุฆูุณูุฉ.  ูุงููุชูุฌุฉ ูู "ุฏููุฉ".  ุณูุชุญุฏุซ ุนู ุงูููููุฉ ุจุงูุชูุตูู ุ ูููู ูู ุฏูุฑุฉ ูุฎุชููุฉ. <br><br>  ุชุชู ูุชุงุจุฉ ุฌุฏูู ุงูุญุณุงุจุงุช ุ ูุฐุง ูุง ุชูุฌุฏ ุทุจูุฉ ุชููุฆุฉ ูู.  ูููู ุจุงููุณุจุฉ ููุชุฌุฑุจุฉ ุ ููููู ุชุนุทูู ุงูุชุณุฌูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNLOGGED</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_relation_filepath(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_relation_filepath ---------------------- base/41493/41507 (1 row)</code> </pre><br>  ุชุชุถูู ุงููุฏุฑุฉ ุนูู ุชูููู ูุชุนุทูู ุนูู ุงูููููุฉ ุฃุซูุงุก ุงูุชููู ุ ููุง ูุชุจูู ูู ุงููุซุงู ุ ุงููุชุงุจุฉ ููู ุงูุจูุงูุงุช ูู ูููุงุช ุจุฃุณูุงุก ูุฎุชููุฉ. <br><br>  ุทุจูุฉ ุงูุชููุฆุฉ ููุง ููุณ ุงุณู ุงูุทุจูุฉ ุงูุฑุฆูุณูุฉ ุ ูููู ูุน ุงููุงุญูุฉ "_init": <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">postgres$ ls -l --time-style=+ /var/lib/postgresql/11/main/base/41493/41507_init</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-rw------- 1 postgres postgres 0 /var/lib/postgresql/11/main/base/41493/41507_init</code> </pre><br>  <strong>ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ</strong> (ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ) - ุทุจูุฉ ูููุง ูุณุงุญุฉ ูุงุฑุบุฉ ุฏุงุฎู ุงูุตูุญุงุช.  ูุชุบูุฑ ูุฐุง ุงูููุงู ุจุงุณุชูุฑุงุฑ: ุนูุฏ ุฅุถุงูุฉ ุฅุตุฏุงุฑุงุช ุฌุฏูุฏุฉ ูู ุงูุฃูุชุงุฑ ุ ูุฅููุง ุชุชูุงูุต ุ ุจูููุง ูุฒูุฏ ุงูุชูุธูู - ูุฒุฏุงุฏ.  ูุชู ุงุณุชุฎุฏุงู ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ ุนูุฏ ุฅุฏุฑุงุฌ ุฅุตุฏุงุฑุงุช ุฌุฏูุฏุฉ ูู ุงูุตููู ููุนุซูุฑ ุจุณุฑุนุฉ ุนูู ุตูุญุฉ ููุงุณุจุฉ ุชูุงุณุจ ุงูุจูุงูุงุช ุงููุฑุงุฏ ุฅุถุงูุชูุง. <br><br>  ุชุญุชูู ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ ุนูู ุงููุงุญูุฉ "_fsm".  ููู ุงูููู ูุง ูุธูุฑ ุนูู ุงูููุฑ ุ ูููู ููุท ุฅุฐุง ูุฒู ุงูุฃูุฑ.  ุฃุณูู ุทุฑููุฉ ูุชุญููู ุฐูู ูู ุชูุธูู ุงูุทุงููุฉ (ููุงุฐุง - ุฏุนูุง ูุชุญุฏุซ ูู ุงูููุช ุงูููุงุณุจ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> accounts;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">postgres$ ls -l --time-style=+ /var/lib/postgresql/11/main/base/41493/41507_fsm</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-rw------- 1 postgres postgres 24576 /var/lib/postgresql/11/main/base/41493/41507_fsm</code> </pre><br>  ุฎุฑูุทุฉ ุงูุฑุคูุฉ ูู ุทุจูุฉ ูุชู ูููุง ุชูููุฒ ุงูุตูุญุงุช ุงูุชู ุชุญุชูู ุนูู ุงูุฅุตุฏุงุฑุงุช ุงูุญุงููุฉ ููุท ูู ุงูุณูุงุณู ุจุจุช ูุงุญุฏ.  ุจูุนูู ุชูุฑูุจู ุ ูุนูู ูุฐุง ุฃูู ุนูุฏูุง ุชุญุงูู ูุนุงููุฉ ูุฑุงุกุฉ ุณุทุฑ ูู ูุฐู ุงูุตูุญุฉ ุ ูููู ุนุฑุถ ุงูุฎุท ุฏูู ุงูุชุญูู ูู ุธููุฑู.  ุณูุจุญุซ ุจุงูุชูุตูู ููู ูุญุฏุซ ูุฐุง ูู ุงูููุงูุงุช ุงูุชุงููุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">postgres$ ls -l --time-style=+ /var/lib/postgresql/11/main/base/41493/41507_vm</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-rw------- 1 postgres postgres 8192 /var/lib/postgresql/11/main/base/41493/41507_vm</code> </pre><br><h1 style=";text-align:right;direction:rtl">  ุตูุญุฉ </h1><br>  ููุง ูููุง ุจุงููุนู ุ ูุชู ุชูุณูู ุงููููุงุช ุจุดูู ููุทูู ุฅูู ุตูุญุงุช. <br><br>  ุนุงุฏุฉู ูุง ูููู ุญุฌู ุงูุตูุญุฉ 8 ูููู ุจุงูุช.  ููููู ุชุบููุฑ ุงูุญุฌู ุฏุงุฎู ุญุฏูุฏ ูุนููุฉ (16 ูููู ุจุงูุช ุฃู 32 ููููุจุงูุช) ุ ูููู ููุท ุฃุซูุงุก ุงูุชุฌููุน ( <code>./configure --with-blocksize</code> ).  ูููู ุฃู ุชุนูู ุงููุณุฎุฉ ุงููุฌูุนุฉ ูุงูุนุงููุฉ ูุน ุตูุญุงุช ุจุญุฌู ูุงุญุฏ ููุท. <br><br>  ุจุบุถ ุงููุธุฑ ุนู ุงูุทุจูุฉ ุงูุชู ุชูุชูู ุฅูููุง ุงููููุงุช ุ ูุชู ุงุณุชุฎุฏุงููุง ุจูุงุณุทุฉ ุงูุฎุงุฏู ุจููุณ ุงูุทุฑููุฉ ุชูุฑูุจูุง.  ุชุชู ูุฑุงุกุฉ ุงูุตูุญุงุช ุฃููุงู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุญูุซ ูููู ููุนูููุงุช ูุฑุงุกุชูุง ูุชุนุฏูููุง ุ  ุซู ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูุชู ุฏูุน ุงูุตูุญุงุช ูุฑุฉ ุฃุฎุฑู ุฅูู ุงููุฑุต. <br><br>  ุชุญุชูู ูู ุตูุญุฉ ุนูู ุชุฑููุฒ ุฏุงุฎูู ูุชุญุชูู ุนููููุง ุนูู ุงูุฃูุณุงู ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl">        0 + ----------------------------------- +
           |  ุงูุนููุงู |
       24 + ----------------------------------- +
           |  ูุฌููุนุฉ ูู ุงููุคุดุฑุงุช ุฅูู ุณูุงุณู ุงูุฅุตุฏุงุฑ |
    ุฃูู + ----------------------------------- +
           |  ูุณุงุญุฉ ุญุฑุฉ |
    ุงูุนููู + ----------------------------------- +
           |  ุฅุตุฏุงุฑุงุช ุงูุตู |
  ุฎุงุต + ----------------------------------- +
           |  ููุทูุฉ ุฎุงุตุฉ |
 pageize + ----------------------------------- +
</pre><br>  ูุณูู ุงูุชุดุงู ุญุฌู ูุฐู ุงูุฃูุณุงู ูู ุฎูุงู ููุญู ุงูุจุญุซ "pageinspect": <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXTENSION</span></span> pageinspect; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> lower, upper, special, pagesize <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> page_header(get_raw_page(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>));</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> lower | upper | special | pagesize -------+-------+---------+---------- 40 | 8016 | 8192 | 8192 (1 row)</code> </pre><br>  ููุง ููุธุฑ ุฅูู <strong>ุนููุงู</strong> ุงูุตูุญุฉ ุงูุฃููู (ุตูุฑ) ูู ุงูุฌุฏูู.  ุจุงูุฅุถุงูุฉ ุฅูู ุญุฌู ุงูููุงุทู ุงููุชุจููุฉ ุ ูุญุชูู ุงูุฑุฃุณ ุนูู ูุนูููุงุช ุฃุฎุฑู ุญูู ุงูุตูุญุฉ ุ ููููุง ูุง ุชูููุง ุญุชู ุงูุขู. <br><br>  ููุฌุฏ ุฃุณูู ุงูุตูุญุฉ <strong>ููุทูุฉ ุฎุงุตุฉ</strong> ุ ูู ุญุงูุชูุง ุ ูุงุฑุบุฉ.  ูุชู ุงุณุชุฎุฏุงูู ููุท ููููุงุฑุณ ุ ุซู ููุณ ููุฌููุน.  "ุงููุงุน" ููุง ูุชูุงูู ูุน ุงูุตูุฑุฉ ุ  ุฑุจูุง ุณูููู ูู ุงูุฃุตุญ ููู "ูู ุงูุนูุงููู ุงูุนููุง". <br><br>  ุจุนุฏ ุงูููุทูุฉ ุงูุฎุงุตุฉ ุชูุฌุฏ <strong>ุฅุตุฏุงุฑุงุช ุงูุตู</strong> - ุงูุจูุงูุงุช ุฐุงุชูุง ุงูุชู ูุฎุฒููุง ูู ุงูุฌุฏูู ุ ุจุงูุฅุถุงูุฉ ุฅูู ุจุนุถ ุงููุนูููุงุช ุงูุนุงูุฉ. <br><br>  ูู ุฃุนูู ุงูุตูุญุฉ ุ ูุจุงุดุฑุฉ ุจุนุฏ ุงูุนููุงู ุ ููุฌุฏ ุฌุฏูู ุงููุญุชููุงุช: <strong>ูุฌููุนุฉ ูู ุงููุคุดุฑุงุช</strong> ูุฅุตุฏุงุฑ ุงูุฃุณุทุฑ ุงููุชููุฑุฉ ูู ุงูุตูุญุฉ. <br><br>  ุจูู ุฅุตุฏุงุฑุงุช ุงูุฎุทูุท ูุงููุคุดุฑุงุช ูุฏ ุชููู ููุงู <strong>ูุณุงุญุฉ ุญุฑุฉ</strong> (ูุงูุชู ุชู ูุถุน ุนูุงูุฉ ุนูููุง ูู ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ).  ูุงุญุธ ุฃูู ูุง ููุฌุฏ ุชุฌุฒุฆุฉ ุฏุงุฎู ุงูุตูุญุฉ ุ ุญูุซ ูุชู ุชูุซูู ูู ุงููุณุงุญุฉ ุงูุญุฑุฉ ุฏุงุฆููุง ุจุฌุฒุก ูุงุญุฏ. <br><br><h2 style=";text-align:right;direction:rtl">  ูุคุดุฑุงุช </h2><br>  ููุงุฐุง ุชุนุฏ ูุคุดุฑุงุช ุณูุณูุฉ ุงูุฅุตุฏุงุฑุงุช ุถุฑูุฑูุฉุ  ุงูุญูููุฉ ูู ุฃู ุตููู ุงูููุฑุณ ูุฌุจ ุฃู ุชุดูุฑ ุจุทุฑููุฉ ูุง ุฅูู ุฅุตุฏุงุฑ ุงูุตููู ูู ุงูุฌุฏูู.  ูู ุงููุงุถุญ ุฃู ุงูุฑุงุจุท ูุฌุจ ุฃู ูุญุชูู ุนูู ุฑูู ุงูููู ูุฑูู ุงูุตูุญุฉ ูู ุงูููู ูุจุนุถ ุงููุคุดุฑุงุช ุนูู ุฅุตุฏุงุฑ ุงูุณุทุฑ.  ูููู ุงุณุชุฎุฏุงู ุฅุฒุงุญุฉ ูู ุจุฏุงูุฉ ุงูุตูุญุฉ ูุฅุดุงุฑุฉ ุ ููู ูุฐุง ุบูุฑ ูุฑูุญ.  ูู ูุชููู ูู ููู ุฅุตุฏุงุฑ ุงูุณุทุฑ ุฏุงุฎู ุงูุตูุญุฉ ูุฃูู ุณูุคุฏู ุฅูู ูุทุน ุงูุฑูุงุจุท ุงูุญุงููุฉ.  ููุฐุง ูู ุดุฃูู ุฃู ูุคุฏู ุฅูู ุชุฌุฒุฆุฉ ุงููุณุงุญุฉ ุฏุงุฎู ุงูุตูุญุงุช ูุบูุฑูุง ูู ุงูุนูุงูุจ ุบูุฑ ุงูุณุงุฑุฉ.  ูุฐูู ุ ูุดูุฑ ุงูููุฑุณ ุฅูู ุฑูู ุงูููุฑุณ ุ ููุดูุฑ ุงููุคุดุฑ ุฅูู ุงูููุถุน ุงูุญุงูู ูุฅุตุฏุงุฑ ุงูุตู ูู ุงูุตูุญุฉ.  ุงุชุถุญ ุนูููุฉ ุบูุฑ ูุจุงุดุฑุฉ. <br><br>  ูุดุบู ูู ูุคุดุฑ 4 ุจุงูุช ุจุงูุถุจุท ููุญุชูู ุนูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุตู ุฅูู ุฅุตุฏุงุฑ ุงูุณูุณูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุทูู ูุฐุง ุงูุฅุตุฏุงุฑ ูู ุงูุณูุณูุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุงูุนุฏูุฏ ูู ูุญุฏุงุช ุงูุจุช ุงูุชู ุชุญุฏุฏ ุญุงูุฉ ุฅุตุฏุงุฑ ุงูุณูุณูุฉ. </li></ul><br><h2 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุจูุงูุงุช </h2><br>  ูุชุฒุงูู ุชูุณูู ุงูุจูุงูุงุช ุนูู ุงููุฑุต ุชูุงููุง ูุน ุชูุซูู ุงูุจูุงูุงุช ูู ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู.  ุชุชู ูุฑุงุกุฉ ุงูุตูุญุฉ ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช "ููุง ูู" ุ ุฏูู ุฃู ุชุญูููุงุช.  ูุฐูู ุ ูููุงุช ุงูุจูุงูุงุช ูู ูุธุงู ุฃุณุงุณู ูุงุญุฏ ุบูุฑ ูุชูุงููุฉ ูุน ุงูุฃูุธูุฉ ุงูุฃุณุงุณูุฉ ุงูุฃุฎุฑู. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ูู x86 architecture ุ ูุชู ุงุนุชูุงุฏ ุชุฑุชูุจ ุงูุจุงูุช ูู ุงูุฃูู ุฃูููุฉ ุฅูู ุงูุฃุนูู (end-little-endian) ุ z / Architecture ูุณุชุฎุฏู ุงูุชุฑุชูุจ ุงูุนูุณู (end-bigian) ุ ููู ARM ุชุฑุชูุจ ุงูุชุจุฏูู. <br><br>  ุชููุฑ ุงูุนุฏูุฏ ูู ุงูุจูู ูุญุงุฐุงุฉ ุงูุจูุงูุงุช ุนุจุฑ ุญุฏูุฏ ุงููููุงุช ุงูุฌูุงุฒ.  ุนูู ุณุจูู ุงููุซุงู ุ ุนูู ูุธุงู x86 32 ุจุช ุ ุณูุชู ูุญุงุฐุงุฉ ุฃุนุฏุงุฏ ุตุญูุญุฉ (ููุน ุนุฏุฏ ุตุญูุญ ุ ุชุดุบู 4 ุจุงูุช) ุนูู ุญุฏูุฏ ุงููููุงุช ุฐุงุช 4 ุจุงูุช ุ ููุฐูู ุฃุฑูุงู ุงููุงุตูุฉ ุงูุนุงุฆูุฉ ุงููุฒุฏูุฌุฉ ุงูุฏูุฉ (ููุน ุงูุฏูุฉ ุงููุฒุฏูุฌุฉ ุ 8 ุจุงูุช).  ูุนูู ูุธุงู 64 ุจุช ุ ุณุชุชู ูุญุงุฐุงุฉ ุงูููู ุงููุฒุฏูุฌุฉ ุนูู ุญุฏูุฏ ุงููููุงุช ุฐุงุช 8 ุจุงูุช.  ูุฐุง ุณุจุจ ุขุฎุฑ ูุนุฏู ุงูุชูุงูู. <br><br>  ุจุณุจุจ ุงููุญุงุฐุงุฉ ุ ูุนุชูุฏ ุญุฌู ุตู ุงูุฌุฏูู ุนูู ุชุฑุชูุจ ุงูุญููู.  ุนุงุฏุฉ ูุง ูููู ูุฐุง ุงูุชุฃุซูุฑ ููุญูุธูุง ููุบุงูุฉ ุ ูููู ูู ุจุนุถ ุงูุญุงูุงุช ูุฏ ูุคุฏู ุฅูู ุฒูุงุฏุฉ ูุจูุฑุฉ ูู ุงูุญุฌู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ููุช ุจูุถุน ุงูุญุฑู (1) ูุญููู ุงูุฃุนุฏุงุฏ ุงูุตุญูุญุฉ ูุฎุชูุทุฉ ุ ูุนุงุฏุฉู ูุง ูุชู ุฅูุฏุงุฑ 3 ุจุงูุช ุจููููุง.  ููููู ูุนุฑูุฉ ุงููุฒูุฏ ุญูู ูุฐุง ุงูููุถูุน ูู ุนุฑุถ ูููููุงู ุดุงุจููู " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">What Inside It</a> ". <br><br><h1 style=";text-align:right;direction:rtl">  ุณูุณูุฉ ุงูุชูุณุช ูุงูุฅุตุฏุงุฑุงุช </h1><br>  ุญูู ููููุฉ ุชุฑุชูุจ ุฅุตุฏุงุฑุงุช ุงูุณูุงุณู ูู ุงูุฏุงุฎู ุ ุณูุชุญุฏุซ ุจุงูุชูุตูู ูู ุงููุฑุฉ ุงููุงุฏูุฉ.  ุญุชู ุงูุขู ุ ุงูุดูุก ุงููุญูุฏ ุงูููู ุจุงููุณุจุฉ ููุง ูู ุฃู ูู ุฅุตุฏุงุฑ ูุฌุจ ุฃู ูุชูุงุกู ุชูุงููุง ูุน ุตูุญุฉ ูุงุญุฏุฉ: PostgreSQL ูุง ูููุฑ ุทุฑููุฉ "ูููุงุตูุฉ" ุงูุณุทุฑ ูู ุงูุตูุญุฉ ุงูุชุงููุฉ.  ุจุฏูุงู ูู ุฐูู ุ ูุชู ุงุณุชุฎุฏุงู ุชูููุฉ ุชุณูู TOAST (ุชูููุฉ ุชุฎุฒูู ุงูุณูุงุช ูุจูุฑุฉ ุงูุญุฌู).  ูุดูุฑ ุงูุงุณู ููุณู ุฅูู ุฃู ุงูุณูุณูุฉ ูููู ูุตูุง ูู ุงูุฎุจุฒ ุงููุญูุต. <br><br>  ุนูู ูุญูู ุงูุฌุฏ ุ TOAST ููุทูู ุนูู ุงูุนุฏูุฏ ูู ุงูุงุณุชุฑุงุชูุฌูุงุช.  ูููู ุฅุฑุณุงู ููู ุงูุณูุงุช "ุงูุทูููุฉ" ุฅูู ุฌุฏูู ุฎุฏูุฉ ูููุตู ุ ููุทูุน ูุณุจููุง ุฅูู ูุทุน ุตุบูุฑุฉ ูู ุงูุฎุจุฒ ุงููุญูุต.  ููุงู ุฎูุงุฑ ุขุฎุฑ ููู ุถุบุท ุงููููุฉ ุจุญูุซ ูุง ูุฒุงู ุฅุตุฏุงุฑ ุงูุตู ููุงุณุจูุง ูู ุตูุญุฉ ุฌุฏูู ุนุงุฏูุฉ.  ููู ุงููููู ุฃู ููุงููุง ูุงูุขุฎุฑ: ูู ุงูุจุฏุงูุฉ ููุถุบุท ุ ูุนูุฏูุง ููุท ูุฎูุถ ูุฅุฑุณุงู. <br><br>  ููู ุฌุฏูู ุฑุฆูุณู ุ ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูุชู ุฅูุดุงุก ุฌุฏูู ูููุตู ุ ูููู ููู ุงูุณูุงุช ุ ูุชู ุฅูุดุงุก ุฌุฏูู TOAST (ูููุฑุณ ุฎุงุต ูู).  ูุชู ุชุญุฏูุฏ ุงูุถุฑูุฑุฉ ูู ุฎูุงู ูุฌูุฏ ุณูุงุช ุทูููุฉ ูุญุชููุฉ ูู ุงูุฌุฏูู.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุงูุฌุฏูู ูุญุชูู ุนูู ุนููุฏ ูู ุงูููุน ุงูุฑููู ุฃู ุงููุต ุ ูุณูุชู ุฅูุดุงุก ุฌุฏูู TOAST ุนูู ุงูููุฑ ุ ุญุชู ุฅุฐุง ูู ูุชู ุงุณุชุฎุฏุงู ุงูููู ุงูุทูููุฉ. <br><br>  ูุธุฑูุง ูุฃู ุฌุฏูู TOAST ุนุจุงุฑุฉ ุนู ุฌุฏูู ููุชุธู ุ ูุฅูู ูุง ูุฒุงู ูุญุชูู ุนูู ููุณ ูุฌููุนุฉ ุงูุทุจูุงุช.  ููุฐุง ูุถุงุนู ุนุฏุฏ ุงููููุงุช ุงูุชู "ุชุฎุฏู" ุงูุฌุฏูู. <br><br>  ูู ุงูุจุฏุงูุฉ ุ ูุชู ุชุญุฏูุฏ ุงูุงุณุชุฑุงุชูุฌูุงุช ุญุณุจ ุฃููุงุน ุจูุงูุงุช ุงูุฃุนูุฏุฉ.  ููููู ูุดุงูุฏุชูุง ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ <code>\d+</code> ูู psql ุ ูููู ูุธุฑูุง ูุฃูู ูุนุฑุถ ุฃูุถูุง ุงููุซูุฑ ูู ุงููุนูููุงุช ุงูุฃุฎุฑู ุ ูุณูุณุชุฎุฏู ุงูุทูุจ ูู ุฏููู ุงููุธุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> attname, atttypid::<span class="hljs-type"><span class="hljs-type">regtype</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> attstorage <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-string"><span class="hljs-string">'p'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'plain'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-string"><span class="hljs-string">'e'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'external'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-string"><span class="hljs-string">'m'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'main'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-string"><span class="hljs-string">'x'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-string"><span class="hljs-string">'extended'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">storage</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_attribute <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> attrelid = <span class="hljs-string"><span class="hljs-string">'accounts'</span></span>::<span class="hljs-type"><span class="hljs-type">regclass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> attnum &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> attname | atttypid | storage ---------+----------+---------- id | integer | plain number | text | extended client | text | extended amount | numeric | main (4 rows)</code> </pre><br>  ุฃุณูุงุก ุงูุงุณุชุฑุงุชูุฌูุงุช ููุง ุงููุนุงูู ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนุงุฏู - ูุง ูุณุชุฎุฏู TOAST (ูุณุชุฎุฏู ูุฃููุงุน ุงูุจูุงูุงุช "ุงููุตูุฑุฉ" ุจูุถูุญ ุ ูุซู ุนุฏุฏ ุตุญูุญ) ุ </li><li style=";text-align:right;direction:rtl">  ููุชุฏ - ูู ูู ุงูุถุบุท ูุงูุชุฎุฒูู ูู ุฌุฏูู TOAST ูููุตู ูุณููุญ ุจู ุ </li><li style=";text-align:right;direction:rtl">  ูุชู ุชุฎุฒูู ุงูููู ุงูุฎุงุฑุฌูุฉ ุงูุทูููุฉ ูู ุฌุฏูู TOAST ุบูุฑ ูุถุบูุท ุ </li><li style=";text-align:right;direction:rtl">  ุงูุฑุฆูุณูุฉ - ูุชู ุถุบุท ุงูููู ุงูุทูููุฉ ุฃููุงู ูููุท ูู ุฌุฏูู TOAST ุฅุฐุง ูู ูุณุงุนุฏ ุงูุถุบุท. </li></ul><br>  ุจุนุจุงุฑุงุช ุนุงูุฉ ุ ุงูุฎูุงุฑุฒููุฉ ูู ููุง ููู.  ูุฑูุฏ PostgreSQL ุงุญุชูุงุก 4 ุฃุณุทุฑ ุนูู ุงูุฃูู ุนูู ุงูุตูุญุฉ.  ูุฐูู ุ ุฅุฐุง ุชุฌุงูุฒ ุญุฌู ุงูุฎุท ุงูุฌุฒุก ุงูุฑุงุจุน ูู ุงูุตูุญุฉ ุ ูุน ุงูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุงูุนููุงู (ูุน ุตูุญุฉ 8 ูููู ุจุงูุช ุงูุนุงุฏูุฉ 2040 ุจุงูุช) ุ ูุฌุจ ุชุทุจูู TOAST ุนูู ุฌุฒุก ูู ุงูููู.  ูุญู ูุชุตุฑู ุจุงูุชุฑุชูุจ ุงูููุถุญ ุฃุฏูุงู ููุชููู ุจูุฌุฑุฏ ุชููู ุงูุณุทุฑ ุนู ุงูุนุชุจุฉ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃููุงู ุ ูููู ุจุงููุฑุฒ ุจูู ุงูุณูุงุช ุฐุงุช ุงูุงุณุชุฑุงุชูุฌูุงุช ุงูุฎุงุฑุฌูุฉ ูุงูููุชุฏุฉ ุ ูููุชูู ูู ุงูุฃุทูู ุฅูู ุงูุฃูุตุฑ.  ูุชู ุถุบุท ุงูุณูุงุช ุงูููุณุนุฉ (ุฅุฐุง ูุงู ูุฐุง ูู ุชุฃุซูุฑ) ุ ูุฅุฐุง ุชุฌุงูุฒุช ุงููููุฉ ููุณูุง ุฑุจุน ุงูุตูุญุฉ ุ ูุชู ุฅุฑุณุงููุง ุนูู ุงูููุฑ ุฅูู ุฌุฏูู TOAST.  ูุชู ุงูุชุนุงูู ูุน ุงูุณูุงุช ุงูุฎุงุฑุฌูุฉ ุจููุณ ุงูุทุฑููุฉ ุ ูููููุง ุบูุฑ ูุถุบูุทุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุฅุตุฏุงุฑ ุงูุตู ูุง ูุฒุงู ุบูุฑ ุตุงูุญ ุจุนุฏ ูุฑูุฑ ุฃูู ุงูุฃูุฑ ุ ููุญู ูุฑุณู ุงูุณูุงุช ุงููุชุจููุฉ ูุน ุงูุงุณุชุฑุงุชูุฌูุงุช ุงูุฎุงุฑุฌูุฉ ูุงูููุชุฏุฉ ุฅูู ุฌุฏูู TOAST. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูู ูุณุงุนุฏ ุฐูู ุฃูุถูุง ุ ูุญุงูู ุถุบุท ุงูุณูุงุช ูุน ุงูุงุณุชุฑุงุชูุฌูุฉ ุงูุฑุฆูุณูุฉ ุ ูุน ุชุฑููุง ูู ุตูุญุฉ ุงูุฌุฏูู. </li><li style=";text-align:right;direction:rtl">  ูููุท ุฅุฐุง ูุงู ุงูุตู ูุง ูุฒุงู ุบูุฑ ูุงูู ุ ูุณูุชู ุฅุฑุณุงู ุงูุณูุงุช ุงูุฑุฆูุณูุฉ ุฅูู ุฌุฏูู TOAST. </li></ol><br>  ูุฏ ูููู ูู ุงููููุฏ ูู ุจุนุถ ุงูุฃุญูุงู ุชุบููุฑ ุงูุฅุณุชุฑุงุชูุฌูุฉ ูุจุนุถ ุงูุฃุนูุฏุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ูู ุงููุนุฑูู ูุณุจููุง ุฃู ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ูู ุงูุนููุฏ ุบูุฑ ูุถุบูุทุฉ ุ ููููู ุชุนููู ุงุณุชุฑุงุชูุฌูุฉ ุฎุงุฑุฌูุฉ ููุง - ุณูููุฑ ุฐูู ุนูู ูุญุงููุงุช ุงูุถุบุท ุบูุฑ ุงููุฌุฏูุฉ.  ููุชู ุฐูู ุนูู ุงููุญู ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COLUMN</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">STORAGE external</span></span>;</code> </pre><br>  ุชูุฑุงุฑ ุงูุทูุจ ุ ูุญุตู ุนูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> attname | atttypid | storage ---------+----------+---------- id | integer | plain number | text | external client | text | extended amount | numeric | main</code> </pre><br>  ุชูุฌุฏ ุฌุฏุงูู ูููุงุฑุณ TOAST ูู ูุฎุทุท pg_toast ูููุตู ูุจุงูุชุงูู ูุง ุชููู ูุฑุฆูุฉ ุนุงุฏุฉู.  ุจุงููุณุจุฉ ููุฌุฏุงูู ุงููุคูุชุฉ ุ ูุชู ุงุณุชุฎุฏุงู ูุฎุทุท pg_toast_temp_ <em>N</em> ุ ุนูู ุบุฑุงุฑ ูุฎุทุท pg_temp_ <em>N.</em> ุงููุนุชุงุฏ <br><br>  ุจุงูุทุจุน ุ ุฅุฐุง ุฑุบุจุช ูู ุฐูู ุ ูุง ุฃุญุฏ ูุฒุนุฌ ุฃู ููุธุฑ ุฅูู ุงููููุงูููุง ุงูุฏุงุฎููุฉ ููุนูููุฉ.  ูููุชุฑุถ ุฃู ููุงู ุซูุงุซ ุณูุงุช ุทูููุฉ ูู ุฌุฏูู ุงูุญุณุงุจุงุช ุ ูุฐูู ูุฌุจ ุฃู ูููู ุฌุฏูู TOAST.  ููู ููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> relnamespace::<span class="hljs-type"><span class="hljs-type">regnamespace</span></span>, relname <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> = ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> reltoastrelid <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> relname = <span class="hljs-string"><span class="hljs-string">'accounts'</span></span> );</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> relnamespace | relname --------------+---------------- pg_toast | pg_toast_33953 (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; \d+ pg_toast.pg_toast_33953</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">TOAST table "pg_toast.pg_toast_33953" Column | Type | Storage ------------+---------+--------- chunk_id | oid | plain chunk_seq | integer | plain chunk_data | bytea | plain</code> </pre><br>  ููู ุงูููุทูู ุฃูู ุจุงููุณุจุฉ ูู "ุงูุฎุจุฒ ุงููุญูุต" ุงูุฐู ูุชู ููู ุชูุทูุน ุงูุฎุท ุฅูู ุดุฑุงุฆุญ ุ ูุชู ุชุทุจูู ุงูุฅุณุชุฑุงุชูุฌูุฉ ุงูุจุณูุทุฉ: TOAST ูู ุงููุณุชูู ุงูุซุงูู ุบูุฑ ููุฌูุฏ. <br><br>  ูุฎูู ูุคุดุฑ PostgreSQL ุจุนูุงูุฉ ุฃูุจุฑ ุ ูููู ูู ุงูุณูู ุฃูุถูุง ุงูุนุซูุฑ ุนูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> indexrelid::<span class="hljs-type"><span class="hljs-type">regclass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_index <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> indrelid = ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-type"><span class="hljs-type">oid</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_class <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> relname = <span class="hljs-string"><span class="hljs-string">'pg_toast_33953'</span></span> );</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> indexrelid ------------------------------- pg_toast.pg_toast_33953_index (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; \d pg_toast.pg_toast_33953_index</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Unlogged index "pg_toast.pg_toast_33953_index" Column | Type | Key? | Definition -----------+---------+------+------------ chunk_id | oid | yes | chunk_id chunk_seq | integer | yes | chunk_seq primary key, btree, for table "pg_toast.pg_toast_33953"</code> </pre><br>  ูุณุชุฎุฏู ุนููุฏ ุงูุนููู ุงูุฅุณุชุฑุงุชูุฌูุฉ ุงูููุณุนุฉ: ุณูุชู ุถุบุท ุงูููู ุงูููุฌูุฏุฉ ุจู.  ุชุญูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> client = repeat(<span class="hljs-string"><span class="hljs-string">'A'</span></span>,<span class="hljs-number"><span class="hljs-number">3000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> id = <span class="hljs-number"><span class="hljs-number">1</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_toast.pg_toast_33953;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> chunk_id | chunk_seq | chunk_data ----------+-----------+------------ (0 rows)</code> </pre><br>  ูุง ููุฌุฏ ุดูุก ูู ุฌุฏูู TOAST: ูุชู ุถุบุท ุงูุฃุญุฑู ุงูููุฑุฑุฉ ุชูุงููุง ูุจุนุฏ ุฐูู ูุชู ุงุญุชูุงุก ุงููููุฉ ูู ุตูุญุฉ ุฌุฏูู ุนุงุฏูุฉ. <br><br>  ุงุณูุญ ุงูุขู ุฃู ูุชููู ุงุณู ุงูุนููู ูู ุฃุญุฑู ุนุดูุงุฆูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> client = ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> string_agg( chr(trunc(<span class="hljs-number"><span class="hljs-number">65</span></span>+random()*<span class="hljs-number"><span class="hljs-number">26</span></span>)::<span class="hljs-type"><span class="hljs-type">integer</span></span>), <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">3000</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> id = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURNING</span></span> left(client,<span class="hljs-number"><span class="hljs-number">10</span></span>) || <span class="hljs-string"><span class="hljs-string">'...'</span></span> || right(client,<span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ?column? ------------------------- TCKGKZZSLI...RHQIOLWRRX (1 row)</code> </pre><br>  ูุง ูููู ุถุบุท ูุฐุง ุงูุชุณูุณู ุ ูููุน ูู ุฌุฏูู TOAST: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> chunk_id, chunk_seq, length(chunk_data), left(encode(chunk_data,<span class="hljs-string"><span class="hljs-string">'escape'</span></span>)::<span class="hljs-type"><span class="hljs-type">text</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) || <span class="hljs-string"><span class="hljs-string">'...'</span></span> || right(encode(chunk_data,<span class="hljs-string"><span class="hljs-string">'escape'</span></span>)::<span class="hljs-type"><span class="hljs-type">text</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_toast.pg_toast_33953;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> chunk_id | chunk_seq | length | ?column? ----------+-----------+--------+------------------------- 34000 | 0 | 2000 | TCKGKZZSLI...ZIPFLOXDIW 34000 | 1 | 1000 | DDXNNBQQYH...RHQIOLWRRX (2 rows)</code> </pre><br>  ููุง ุชุฑูู ุ ูุชู ูุทุน ุงูุจูุงูุงุช ุฅูู ุฃุฌุฒุงุก ูู 2000 ุจุงูุช. <br><br>  ุนูุฏ ุงููุตูู ุฅูู ูููุฉ "ุทูููุฉ" ุ ูููู PostgreSQL ุชููุงุฆููุง ูุดูุงููุง ุจุงูุชุทุจูู ุ ุจุงุณุชุนุงุฏุฉ ุงููููุฉ ุงูุฃุตููุฉ ูุฅุนุงุฏุชูุง ุฅูู ุงูุนููู. <br><br>  ุจุงูุทุจุน ุ ูุชู ุฅููุงู ุงููุซูุฑ ูู ุงูููุงุฑุฏ ุนูู ุถุบุท ุดุฑุงุฆุญ ูุงูุงุณุชุฑุฏุงุฏ ุงููุงุญูุฉ.  ูุฐูู ุ ูุฅู ุชุฎุฒูู ุงูุจูุงูุงุช ุงูุถุฎูุฉ ูู PostgreSQL ููุณ ููุฑุฉ ุฌูุฏุฉ ุ ุฎุงุตุฉ ุฅุฐุง ุชู ุงุณุชุฎุฏุงููุง ุจูุดุงุท ููู ููู ููุทู ุงููุนุงููุงุช ูุทููุจูุง ููุง (ุนูู ุณุจูู ุงููุซุงู: ุงููุณุชูุฏุงุช ุงูุฃุตููุฉ ุงูููุณูุญุฉ ุถูุฆููุง ูููุณุชูุฏุงุช ุงููุญุงุณุจูุฉ).  ูุฏ ูููู ุงูุจุฏูู ุงูุฃูุซุฑ ุฑุจุญูุฉ ูู ุชุฎุฒูู ูุฐู ุงูุจูุงูุงุช ุนูู ูุธุงู ุงููููุงุช ุ ููู ููุงุนุฏ ุงูุจูุงูุงุช ุ ุฃุณูุงุก ุงููููุงุช ุงูููุงุจูุฉ. <br><br>  ูุชู ุงุณุชุฎุฏุงู ุฌุฏูู TOAST ููุท ุนูุฏ ุงูุฅุดุงุฑุฉ ุฅูู ูููุฉ "ุทูููุฉ".  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุญุชูู ุฌุฏูู ุงูุชูุณุช ุนูู ุฅุตุฏุงุฑ ุฎุงุต ุจู: ุฅุฐุง ูู ูุคุซุฑ ุชุญุฏูุซ ุงูุจูุงูุงุช ุนูู ุงููููุฉ "ุงูุทูููุฉ" ุ ูุณูุดูุฑ ุงูุฅุตุฏุงุฑ ุงูุฌุฏูุฏ ูู ุงูุตู ุฅูู ููุณ ุงููููุฉ ูู ุฌุฏูู TOAST - ููุฐุง ูููุฑ ุงููุณุงุญุฉ. <br><br>  ูุงุญุธ ุฃู TOAST ูุนูู ููุท ููุฌุฏุงูู ุ ูููู ููุณ ููููุงุฑุณ.  ูุฐุง ููุฑุถ ุญุฏูุง ุนูู ุญุฌู ุงูููุงุชูุญ ุงููููุฑุณุฉ. <br><blockquote style=";text-align:right;direction:rtl">  ููููู ูุฑุงุกุฉ ุงููุฒูุฏ ุญูู ุชูุธูู ุงูุจูุงูุงุช ุงูุฏุงุฎููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูู ุงููุซุงุฆู</a> . <br></blockquote>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃู ุชุณุชูุฑ</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar444536/">https://habr.com/ru/post/ar444536/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar444524/index.html">Lambdas: ูู C ++ 11 ุฅูู C ++ 20. ุงูุฌุฒุก 1</a></li>
<li><a href="../ar444526/index.html">DOTS Stack: C ++ & C #</a></li>
<li><a href="../ar444528/index.html">ุงููููู: ูุฏ ุชุญุฏ ุงููุงุจุงู ูู ุชูุฒูู ุงููุญุชูู ูู ุงูุดุจูุฉ - ูุญู ูููู ูููุงูุด</a></li>
<li><a href="../ar444530/index.html">ูุณุชูุจู ุญูู ุงูุชุจุนูุฉ ูู Android</a></li>
<li><a href="../ar444534/index.html">ูุณุญ ุงูุซุบุฑุงุช ูุงูุชูููุฉ ุงูุขููุฉ. ุงูุฌุฒุก 1</a></li>
<li><a href="../ar444540/index.html">Intel ุฌุงูุฒุฉ ูุจุฏุก ุฅูุชุงุฌ ุฐุงูุฑุฉ MRAM</a></li>
<li><a href="../ar444542/index.html">ุฌุฏูู ุงูุจุซ ุงููุจุงุดุฑ ูุงููุคุชูุฑ ูู SmartMail Conf: ุงูุชุนูู ุงูุขูู</a></li>
<li><a href="../ar444544/index.html">ุดูุก ุนู ูุฑุงูุฒ ุงูุจูุงูุงุช ุงูููุฒุนุฉ ููุฃุนูุงู</a></li>
<li><a href="../ar444546/index.html">ููู ูููุงุฐุง ุงูุนูู ุฃุจุทุฃุ ุทุฑููุฉ ุณูุฑุฌู ููุฑูููู</a></li>
<li><a href="../ar444548/index.html">ุชุฌุฑุจุฉ ุดุฎุตูุฉ: ููู ุดุงุฑููุง ูู ุชุดุฌูุน ุจุฏุก ุงูุชุดุบูู ูู ุฃุตู ูุงุชููู ูู ุฃูุฑููุง ุงููุงุชูููุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>