<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚ÄçüöÄ üë©üèº‚Äçüéì üë®üèª Smart Sockel REDMOND SkyPort 100S üë©üèø‚Äçü§ù‚Äçüë©üèæ üë®‚Äçüöí üìº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dies ist eine Fortsetzung meines ersten Artikels √ºber die Redmond Smart Cap . In diesem Artikel werden wir √ºber ein anderes Redmond-Ger√§t sprechen - S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Smart Sockel REDMOND SkyPort 100S</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450860/"><p>  Dies ist eine Fortsetzung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">meines ersten Artikels √ºber die Redmond Smart Cap</a> .  In diesem Artikel werden wir √ºber ein anderes Redmond-Ger√§t sprechen - Smart Socket REDMOND SkyPort 100S.  Dieses Ger√§t basiert ebenfalls <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auf dem nRF51822-Chip,</a> und wie hier gesagt wird, hat Gott selbst einen Versuch angeordnet.  Also wurde diese Steckdose gekauft.  Das Geh√§use l√§sst sich so einfach zerlegen wie die Basis, der Zugriff auf den Programmieranschluss ist noch bequemer. <a name="habracut"></a>  Aber mit Blick auf die Zukunft werde ich sagen, dass alles etwas komplizierter ist, als es mir zun√§chst schien.  Ich habe den Stromkreis dieser Steckdose nicht angerufen, weil  Es gibt bereits eine Reihe von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úberpr√ºfungen zum Aktualisieren</a> und √Ñndern dieser Verkaufsstellen. </p><br><img src="https://habrastorage.org/webt/lz/us/-9/lzus-9vti8hlegui-1vdbl6gkp0.jpeg"><br><p> In einer der Bewertungen fand ich eine Schaltung, und diese war begrenzt.  Aus dem Diagramm geht hervor, dass nur 4 Pins am nRF51822-Modul auf die gleiche Weise wie an der Smart Base beteiligt sind.  Das Ger√§t verf√ºgt √ºber eine Uhrentaste an Pin p0.00, zwei LEDs, rot an Pin p0.01, gr√ºn an Pin p0.02.  Ein elektromagnetisches Relais an 10A ist an Pin p0.03 angeschlossen.  Starten Sie also die Arduino IDE und starten Sie eine Instanz: </p><br><pre><code class="plaintext hljs">#define BUTTON_PIN 0 #define RED_LED_PIN 1 #define GREEN_LED_PIN 2 #define RELAY_PIN 3 boolean iswitch = 0; boolean flag_button = 0; static uint32_t previousMillis; //#define MY_DEBUG #define MY_DISABLED_SERIAL #define MY_RADIO_NRF5_ESB //#define MY_NRF5_ESB_PA_LEVEL (NRF5_PA_LOW) #define MY_NRF5_ESB_PA_LEVEL (NRF5_PA_MAX) //#define MY_PASSIVE_NODE #define MY_NODE_ID 201 #define MY_PARENT_NODE_ID 0 #define MY_PARENT_NODE_IS_STATIC #define MY_TRANSPORT_UPLINK_CHECK_DISABLED #define RELAY_ID 1 #include &lt;MySensors.h&gt; MyMessage lMsg(RELAY_ID, V_STATUS); void preHwInit() { pinMode(BUTTON_PIN, INPUT_PULLUP); pinMode(RED_LED_PIN, OUTPUT); pinMode(GREEN_LED_PIN, OUTPUT); pinMode(RELAY_PIN, OUTPUT); } void before() { digitalWrite(RED_LED_PIN, HIGH); } void presentation() { sendSketchInfo("REDMOND R nRF51", "1.0"); wait(300); present(RELAY_ID, S_BINARY, "RELAY SWITCH"); wait(300); } void setup() { digitalWrite(RED_LED_PIN, LOW); wait(300); digitalWrite(GREEN_LED_PIN, HIGH); wait(200); digitalWrite(GREEN_LED_PIN, LOW); wait(200); digitalWrite(GREEN_LED_PIN, HIGH); wait(200); digitalWrite(GREEN_LED_PIN, LOW); wait(200); digitalWrite(GREEN_LED_PIN, HIGH); wait(200); digitalWrite(GREEN_LED_PIN, LOW); wait(500); send(lMsg.set(iswitch)); wait(500); } void loop() { if (digitalRead(BUTTON_PIN) == LOW &amp;&amp; flag_button == 0) { flag_button = 1; previousMillis = millis(); wait(20); } if (digitalRead(BUTTON_PIN) == LOW &amp;&amp; flag_button == 1) { //   ,   } if (digitalRead(BUTTON_PIN) == HIGH &amp;&amp; flag_button == 1) { if ((millis() - previousMillis &gt; 0) &amp;&amp; (millis() - previousMillis &lt;= 3000)) { if (iswitch == 0) { digitalWrite(GREEN_LED_PIN, HIGH); wait(10); } else if (iswitch == 1) { digitalWrite(GREEN_LED_PIN, LOW); wait(10); } flag_button = 0; iswitch = !iswitch; digitalWrite(RELAY_PIN, iswitch); wait(1500); send(lMsg.set(iswitch)); } if (millis() - previousMillis &gt; 3000) { flag_button = 0; } } } void receive(const MyMessage &amp; message) { if (message.type == V_STATUS) { if (message.sensor == RELAY_ID) { if (mGetCommand(message) == 1) { if (message.isAck()) { //AckG = 1; } else { wait(50); if (iswitch == 0) { digitalWrite(GREEN_LED_PIN, HIGH); }else if (iswitch == 1) { digitalWrite(GREEN_LED_PIN, LOW); } iswitch = !iswitch; wait(10); digitalWrite(RELAY_PIN, iswitch); wait(1500); send(lMsg.set(iswitch)); } } if (mGetCommand(message) == 2) { } } } }</code> </pre> <br><p>  Wie Sie sehen k√∂nnen, ist der Code klein und ziemlich einfach, danke an die Mysensors-Community. </p><br><p>  Als der Code fertig war, habe ich den Programmierer an das Ger√§t angeschlossen und es erneut geflasht.  Das Anschlie√üen des Programmierger√§ts an die Steckdose ist sehr einfach. In meinem Fall habe ich zwei gew√∂hnliche Ausgangswiderst√§nde genommen, das Kabel mit Drahtschneidern abgebissen, Haken aus dem Kabel gezogen, es gebogen, diese Haken in die Kabel des Programmierger√§ts eingef√ºhrt und an die Steckdose ‚Äûangeschlossen‚Äú. Das Video zeigt, wie ich es mache Es ist Zeit zu testen, was passiert ist.  Ich habe einen Smart Socket in einen Socket gesteckt :), habe den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Majordomo</a> ge√∂ffnet, alles ist in Ordnung, der Socket war bereits im Maysensors Netzwerk vorhanden.  Ich sende den ersten Befehl zum Einschalten und ... Neustart :) ... unerwartetes Einschalten.  Das erste, was mir in den Sinn kam, war ein Stromausfall, w√§hrend das Relais eingeschaltet war.  Er √§nderte das Programm, entfernte die LED beim Einschalten des Relais, um den Verbrauch zu senken.  Und es hat funktioniert, der Sockel wurde nicht mehr neu gestartet, als das Relais ausgeschaltet wurde. ... aber nicht lange :).  Und so wurde klar, dass dem Modul die Stromversorgung fehlte.  Die Schaltung des transformatorlosen Netzteils ist so ausgelegt, dass es nur ausreicht, um im BLE-Modus zu arbeiten.  Mysensors verwendet auch einen anderen Modus des 2,4-GHz-Funkmoduls (Kompatibilit√§t mit RF24-ANT).  Wir haben also ein Defizit von ca. 10mA.  Nachdem Mysensors das Problem in unserem Chat besprochen hatte, beschlossen sie, einen Ballastkondensator hinzuzuf√ºgen, da dies eine sehr einfache Manipulation ist, die f√ºr die Wiederholung erforderlich ist.  Folgendes ist passiert: </p><br><p><img src="https://habrastorage.org/webt/1h/ds/ik/1hdsikihai95br_gfrun-35avrg.jpeg" alt="Bild"></p><br><p><img src="https://habrastorage.org/webt/9x/ut/qs/9xutqseeqejkhxeuoaxebutcxg0.jpeg" alt="Bild"></p><br><p>  Er baute die Steckdose wieder zusammen und begann ein wenig aufgeregt zu testen.  Die Entwicklung war jetzt hervorragend.  Ich habe die Logik des Programms zur√ºckgeschrieben und ein weiteres #define MY_NRF5_ESB_PA_LEVEL (NRF5_PA_MAX) hinzugef√ºgt, dh ich habe das Radio mit voller Leistung "abgeschnitten" (ja, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">es</a> ist sehr einfach mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Mysensors</a> ). ... Es funktioniert.  Keine Fehler.  Keine Neustarts.  Das ist ein Sieg :) </p><br><p><img src="https://habrastorage.org/webt/gc/ae/gg/gcaeggbdts0omxqeiva8u7giuka.jpeg" alt="Bild"></p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/C5W_3nAF-2A" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Dieser Hersteller hat aber auch andere Ger√§te am nRF51822 - einen Rauchsensor, einen Bewegungssensor, einen Gassensor, W√§rmekonverter, L√ºfter, Luftbefeuchter, Reiniger, Wasserkocher ...;) </p><br><p>  Ein Telegramm-Chat unserer Community, in dem sie immer helfen, Bibliotheken zu installieren, Boards zu unterst√ºtzen und zu erkl√§ren, wie in einer halben Stunde ein Netzwerk von Sensoren auf Arduinen ohne Kopfschmerzen aufgebaut werden kann - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://t.me/mysensors_rus</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450860/">https://habr.com/ru/post/de450860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450846/index.html">Die Wunder der Verpackung von Microsoft: der Linux-Kernel in Windows 10 und die IE-Engine in Chromium Edge</a></li>
<li><a href="../de450848/index.html">√úber gelben Phosphor und die Panik des Menschen</a></li>
<li><a href="../de450850/index.html">Auf dem Weg zu einer besseren Zukunft f√ºr intelligente Compiler</a></li>
<li><a href="../de450854/index.html">Erfahrung in der Entwicklung eines Unity-Assets zur Suche nach einem Pfad im 3D-Raum</a></li>
<li><a href="../de450858/index.html">Open Source Networking-Treffen - jetzt in Yandex.Cloud # 3.2019</a></li>
<li><a href="../de450862/index.html">@ Pythonetc April 2019</a></li>
<li><a href="../de450864/index.html">Tipps und Tricks von meinem Telegramm-Kanal @pythonetc, April 2019</a></li>
<li><a href="../de450868/index.html">Videoberichte vom FunTech QA-Automation Meetup</a></li>
<li><a href="../de450870/index.html">Wie Netflix Python verwendet</a></li>
<li><a href="../de450872/index.html">TestNG Annotation Guide f√ºr Selenium WebDriver</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>