<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëÇüèª üéí üë±üèø C√≥mo desarrollamos TI en Leroy Merlin: reconstruyendo un motor sobre la marcha üë©‚Äçüç≥ üë®üèæ‚Äçüè≠ üîç</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace cuatro a√±os, una base de clientes se manten√≠a por separado en cada tienda, m√°s otra en el sitio. 

 En la serie anterior: hace tres a√±os, decidim...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo desarrollamos TI en Leroy Merlin: reconstruyendo un motor sobre la marcha</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/leroy_merlin/blog/457466/"><img src="https://habrastorage.org/webt/cy/-z/2f/cy-z2fzscbxzwe8sybjnsqkg7j8.jpeg"><br><br>  Hace cuatro a√±os, una base de clientes se manten√≠a por separado en cada tienda, m√°s otra en el sitio. <br><br>  En la serie anterior: hace tres a√±os, decidimos que necesit√°bamos hacer nuestro desarrollo en Rusia.  Hace dos a√±os, comenzaron a escribir su propio c√≥digo en lugar de modificar el c√≥digo fork de la empresa matriz.  La historia de hoy ser√° sobre c√≥mo cambiamos de un gran monolito Legacy a un grupo de peque√±os microservicios conectados por una especie de autob√∫s (orquestador). <br><br>  El caso de usuario m√°s f√°cil: haga un pedido a trav√©s del sitio y rec√≥jalo en la tienda real de Leroy Merlin en Rusia.  Anteriormente, los pedidos de la tienda en l√≠nea se procesaban en otra aplicaci√≥n en general y de acuerdo con un esquema diferente.  Ahora necesit√°bamos un escaparate omnicanal para que cualquier pedido se dividiera en una interfaz: un cajero en una tienda, una aplicaci√≥n m√≥vil, un terminal en una tienda, un sitio web, lo que sea.  Si pones Linux en el microondas, deja que est√© el microondas.  Lo principal es que algunas interfaces pueden golpear la API hacia atr√°s y decir que aqu√≠ debe realizar tal y tal orden.  Y recibieron una respuesta clara a esto.  La segunda historia fue con solicitudes de disponibilidad y propiedades de los bienes de su tarjeta. <br><br>  En el frente (escribiremos sobre esto pronto), tenemos un monstruo: AEM, y detr√°s de √©l en la parte posterior hab√≠a dos grandes aplicaciones: OPUS y MoVe.  El primero es una base de datos de las propiedades de cada producto (desde las dimensiones hasta la descripci√≥n), el segundo es responsable del pago, es decir, el monolito de la caja.  Si muy simplificado. <a name="habracut"></a><br><br><h3>  ¬øQu√© le pasaba a Opus? </h3><br>  OPUS es una gran base distribuida.  M√°s precisamente, es un software que proporciona una interfaz para acceder a la base de datos, es decir, accede a la base de datos y, por ejemplo, busca o simplemente expone la API para que los clientes no vayan directamente a la base de datos.  Este software funciona y es compatible con Francia.  La segunda caracter√≠stica, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">como ya dijimos</a> , es que la l√≠nea de mejoras es muy larga y no tenemos la m√°xima prioridad en comparaci√≥n con la unidad de negocios de Francia. <br><br>  Con gran dificultad, pudimos entender c√≥mo los desarrolladores pod√≠an hacer cambios sin un equipo de Francia; se obtuvieron aprobaciones muy largas.  Caracter√≠stica lanzada durante seis meses.  En realidad, al principio quer√≠amos hacer nuestro propio desarrollo y su revisi√≥n, y luego llegamos a nuestro propio desarrollo, nuestra infraestructura, nuestras pruebas y, en general, las nuestras.  Y al mismo tiempo arroj√≥ casi un tercio del c√≥digo Legacy. <br><br>  Pero volvamos a OPUS.  Dado que el sistema almacena informaci√≥n relevante sobre la disponibilidad, caracter√≠sticas, transacciones y otras cosas, recurrimos a ella por cualquier motivo.  Espec√≠ficamente para el sitio, esto significa que si el usuario tiene tres productos en la cesta, entonces debe llamar a la base de datos desde cada p√°gina, porque se verifica la relevancia.  Incluso si toca una vez el cach√©, y luego lo actualiza de manera inteligente, todav√≠a hab√≠a caracter√≠sticas.  Cuando abre la p√°gina del cat√°logo en general, todas las especificaciones del producto se tomaron de OPUS. <br><br>  El siguiente paso l√≥gico es que comenzamos a extraer OPUS con menos frecuencia e hicimos nuestra base (m√°s precisamente, microservicios con bases).  El sistema en su conjunto se llamaba PUB ruso. <br><br>  Luego formaron una orquesta, que ya puede almacenar agregados, es decir, los datos recopilados para la creaci√≥n de p√°ginas.  En el sentido de que cuando el usuario cambia la vista de p√°gina de tarjetas a listas, sigue siendo el mismo agregado, solo el frente es diferente. <br><br>  Es decir, dejamos el OPUS original (todav√≠a est√° en Francia), pero nuestro espejo casi completo lo "chupa", lo que corta la base en pedazos, listo para ensamblar en una orquesta.  Y el orquestador recoge y almacena los agregados (o los recibe r√°pidamente y comienza a almacenarlos), que otros sistemas necesitan.  Como resultado, esta parte funciona como deber√≠a.  De la funcionalidad original del OPUS franc√©s, queda alrededor del cinco por ciento.  Pronto lo reemplazaremos por completo. <br><br><h3>  ¬øQu√© estaba mal con MoVe? </h3><br>  Nada especial, excepto por el hecho de que decidimos tirar todo el c√≥digo, porque: <br><br><ol><li>  Era antiguo en una vieja pila. </li><li>  Tom√≥ en cuenta las caracter√≠sticas de cada regi√≥n "Leroy Merlin" en la cadena de FI. </li><li>  Era tan dif√≠cil de leer y mantener que el mejor m√©todo de refactorizaci√≥n era "escribir de nuevo e inmediatamente documentar normalmente". </li></ol><br>  Lo cual hicimos.  Solo que lo reescribimos no como un monolito, sino que comenzamos a hacer microservicios para cada funci√≥n individual.  Y luego, parte de la funcionalidad de MoVe con el cambio al microservicio se elimin√≥ sin problemas.  Y as√≠, uno por uno, hasta que la funcionalidad de MoVe termine por completo.  Es decir, todav√≠a funciona, pero en alg√∫n lugar en el vac√≠o y sin flujos de datos. <br><br>  Desde que construimos la plataforma a partir de piezas, el proyecto se llam√≥ Lego. <br><br>  Lego cambi√≥ por completo este medio.  S√≠, aclaremos: un back-end real es un bus heredado, sistemas de archivos, bases de datos y otros niveles casi de infraestructura.  Las grandes aplicaciones en torno a esto y los microservicios de l√≥gica son intermedios.  La presentaci√≥n ya es el frente. <br><br><h3>  ¬øPor qu√© necesitabas reescribir todo esto? </h3><br>  Porque viv√≠amos con bases de clientes separadas para cada instancia, 15 a√±os despu√©s de la apertura en Rusia, y esto no le conven√≠a a nadie.  Tampoco hubo sincronizaci√≥n.  En otros pa√≠ses todav√≠a viven as√≠. <br><br>  La empresa matriz de Francia hizo la log√≠stica general, reutilizamos el sistema Pixis: esta es una sola tienda de recibos, es decir, pedidos de clientes: una tienda ve los pedidos de otra tienda.  Pero esto no resolvi√≥ por completo el problema del orden omnicanal.  Por lo tanto, era necesario consolidar la base y hacer el procesamiento general.  Esto es lo principal. <br><br>  La segunda raz√≥n fue la ley federal de taquilla: con nuestros plazos de desarrollo para un sistema com√∫n (y pruebas) para todos los pa√≠ses, habr√≠amos multado con multas. <br><br>  Una opci√≥n aproximadamente similar se introdujo en Brasil: comenzaron Leroy Merlin all√≠ sin ning√∫n software de la empresa matriz, y tuvieron √©xito.  Eso fue antes de la decisi√≥n dividida.  Por cierto, se comprometen mucho con los <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">innersors</a> , tienen un desarrollo muy r√°pido. <br><br>  Pixis solo pod√≠a hacer un pedido desde la caja registradora, de hecho.  Cambiamos la situaci√≥n en tres etapas: <br><br><ol><li>  Primero creamos una aplicaci√≥n m√≥vil para el empleado, que simplifica enormemente su vida.  Sobre esta base, comenzaron a construir un ecosistema donde las interfaces se separan con l√≥gica. </li><li>  Mientras todo estaba configurado, los pedidos por Internet se llevaban a la caja a mano. </li><li>  Pusieron microservicios a su vez, lo que lo reemplaz√≥ todo en el medio. </li></ol><br>  ¬øPor qu√© necesitabas comenzar con la aplicaci√≥n de la tienda?  Porque nuevamente tenemos procesos √∫nicos en comparaci√≥n con Francia.  Por ejemplo, una persona decidi√≥ comprar seis metros y diez cent√≠metros de una cadena en una tienda.  El vendedor lo interrumpi√≥, le dio un documento de cu√°nto tiempo es y cu√°nto cuesta.  Vas al cajero con este papel y pagas all√≠.  Desde el punto de vista de la l√≥gica, la venta no debe realizarse en la taquilla, sino que el vendedor debe tenerla, pero de hecho es en la taquilla donde comienza lo m√°s interesante: debe tener tanto los productos como el papel. <br><br>  Al final, vamos a ser una plataforma para hacer pedidos: ahora, por ejemplo, encima de nuestro sistema principal, se agregaron servicios para comprar servicios de maestros (compr√© una cocina, orden√© la instalaci√≥n de un maestro externo, pero lo encontramos y nos garantizamos), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">mercado</a> ( compra directa de un proveedor en un rango m√°s amplio), y pronto debe haber un afiliado para que nuestros bloques se puedan colocar en cualquier lugar.  Algo as√≠ como incrustar tiendas de Amazon en blogs, solo que m√°s vers√°til. <br><br><h3>  ¬øC√≥mo se tom√≥ la decisi√≥n de reemplazo? </h3><br>  <b>Yo paso</b>  <b>Refinar el modelo de negocio.</b> <br><br>  Verificamos, y de hecho: el modelo, como en Rusia, precios bajos todos los d√≠as, es exitoso.  Leroy Merlin en Europa es significativamente m√°s caro, pero es en Rusia donde este es nuestro nicho: una tienda de construcci√≥n donde definitivamente puedes encontrar productos al mejor precio. <br><br>  <b>II paso.</b>  <b>Crea un script de cliente.</b> <br><br>  Es decir, construir procesos como queremos que interact√∫en con nosotros desde el punto de vista del cliente.  Es decir, una visi√≥n √∫nica de qui√©nes queremos ser en unos a√±os y c√≥mo se ve desde el punto de vista de la arquitectura. <br><br>  <b>III paso.</b>  <b>Construye una arquitectura.</b> <br><br>  Divide esta visi√≥n en conocimientos y arquitectura espec√≠ficos con mayor detalle.  Result√≥ 110 proyectos, que dividimos en cinco categor√≠as durante cinco a√±os. <br><br>  Luego formaron equipos especializados.  Muy a menudo, estas son sus personas m√°s un contratista.  Al principio, sufrieron mucho de esto: cuando fueron a la producci√≥n, realmente no entendieron c√≥mo digerir un volumen tan grande de cambios.  Luego comenzaron a hacer un enfoque com√∫n para las tareas y a aumentar gradualmente la parte de su desarrollo. <br><br>  En aquellos lugares donde el error fue cr√≠tico, trabajaron de acuerdo con los esquemas de la NASA, donde el error es inaceptable, no es una opci√≥n en absoluto.  Esto se trata de transacciones de dinero. <br><br>  Y donde era posible caer, lo principal era levantarse r√°pidamente, utilizamos un enfoque cercano al SRE de Google.  Iterativamente, con jambas, pero los proyectos podr√≠an implementarse lo antes posible.  Y ahora estamos haciendo mucho, y es muy bueno desarrollarlo. <br><br>  El tercer enfoque es la innovaci√≥n.  Desarrollamos una caja de arena de ideas para hacer r√°pidamente los primeros MVP con nuestros recursos internos, lo que nos permite realizar pruebas de forma r√°pida y econ√≥mica.  Este es el verdadero "intentar r√°pido, fallar r√°pido".  Esto le permiti√≥ obtener un presupuesto y autoridad para aquellos que crearon un proyecto genial. <br><br>  El segundo foco importante estaba en el geodesarrollo.  Luego abri√≥ 20 tiendas al a√±o (ahora un poco m√°s lento).  Seis mil empleados.  Muchas regiones.  Era necesario reescribir toda la cadena de suministro, para desarrollar r√°pidamente procesos para elevar la infraestructura de las tiendas. <br><br>  En 2017, decidimos convertirnos en una plataforma para pedidos de construcci√≥n: esta es una estrategia prometedora para los pr√≥ximos a√±os. <br><br>  Para la geograf√≠a, necesit√°bamos una gran oficina administrativa de TI para el crecimiento de la empresa y el crecimiento de la cadena de suministro.  Para omnicanal (orden general): un nivel diferente de SLA para sistemas internos, en tiempo real, microservicios y sincronizaci√≥n entre cientos de subsistemas.  Este es generalmente un nivel diferente de madurez de TI.  Para la plataforma, la velocidad de cambio tambi√©n es importante. <br><br>  Cuando reci√©n comenzaba, todos pensaban que √°gil salvar√≠a al mundo.  Con los contratistas, √°gil puede no ser tan efectivo.  De ah√≠ el deseo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">reclutar</a> 200 personas en el departamento de TI. <br><br>  Vimos cu√°n r√°pido podemos implementar todo sin p√©rdida para la marca.  Algo podr√≠a escribirse r√°pidamente, pero no tuvo tiempo para preparar el servicio.  Por ejemplo, si no hay informaci√≥n de existencias, entonces no hay forma de pagar en l√≠nea sin una garant√≠a de que los bienes ser√°n reservados.  Descomponemos la cadena de interdependencias en varias.  Ahora ya sabemos que debemos acortar los ciclos, porque las competencias del equipo siguen siendo importantes.  Ahora estamos cortando caracter√≠sticas en piezas peque√±as, estamos recopilando una conexi√≥n, ahora solo el a√±o actual est√° en los planes.  Una estrategia a largo plazo, pero por caracter√≠sticas, es de un a√±o como m√°ximo, y muchos equipos de productos separados. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/457466/">https://habr.com/ru/post/457466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457450/index.html">Las 10 principales tendencias tecnol√≥gicas en procesamiento de datos y an√°lisis en 2019 seg√∫n Gartner</a></li>
<li><a href="../457458/index.html">Soporte m√≥vil para m√°quinas herramienta chinas. O como colocarlos en un departamento</a></li>
<li><a href="../457460/index.html">Tarjeta de seguridad del kernel de Linux</a></li>
<li><a href="../457462/index.html">Uber: descripci√≥n general de los algoritmos clave de gesti√≥n de la plataforma</a></li>
<li><a href="../457464/index.html">Deduplicaci√≥n de anuncios en Yandex.Real Estate</a></li>
<li><a href="../457468/index.html">Memoria universal: SRAM, DRAM y memoria flash en una botella</a></li>
<li><a href="../457470/index.html">Matem√°ticas de la hoja: c√≥mo un arbusto inusual cambi√≥ la ecuaci√≥n de un modelo de crecimiento de plantas</a></li>
<li><a href="../457476/index.html">Reducir el tama√±o de una imagen acoplable con una aplicaci√≥n de arranque por resorte</a></li>
<li><a href="../457480/index.html">Crear una aplicaci√≥n de escucha para ver el tr√°fico MMORPG m√≥vil</a></li>
<li><a href="../457490/index.html">Aisioshechka de Zuckerberg - brevemente y en el caso de Libra</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>