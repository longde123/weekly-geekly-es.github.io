<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ŠğŸ¼ ğŸ‘ŠğŸ¾ ğŸ‘™ Cara mudah untuk membuat peringatan suara di sistem Home Automation ("Smart Home") ğŸ‘¶ğŸ½ â™ˆï¸ ğŸ›‹ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Setelah menguji klien SIP konsol Linphonec, saya melihat di dalamnya kemungkinan cara sederhana dan cepat untuk menerapkan peringatan suara pada ponse...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara mudah untuk membuat peringatan suara di sistem Home Automation ("Smart Home")</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466735/">  Setelah menguji klien SIP konsol Linphonec, saya melihat di dalamnya kemungkinan cara sederhana dan cepat untuk menerapkan peringatan suara pada ponsel, untuk sistem otomasi rumah. <br><br>  Saya pikir metode ini cocok untuk banyak sistem otomasi rumah DIY, saya akan memberikan versi saya. <br><br>  Saya memiliki sistem otomasi Rumah Pintar MajorDoMo yang diinstal pada komputer papan tunggal Raspberry Pi (menjalankan Raspbian (Debian 9). <br><br>  Kami akan membuat kemungkinan pemberitahuan dari MajorDoMo ke smartphone tanpa menggunakan peralatan tambahan dan server VoIP kami. <br><br>  Prinsip singkat peringatan: jika terjadi kecelakaan kritis (semua orang dapat menentukan daftar kecelakaan mereka sendiri), sistem otomasi mengelola klien VoIP konsol dan memanggil pemilik melalui protokol SIP, setelah responsnya memutar file suara yang direkam sebelumnya dengan pesan kecelakaan. <br><a name="habracut"></a><br>  Pertama-tama, kita membutuhkan dua akun dari penyedia SIP dengan inbound / outbound gratis dalam jaringan.  Misalnya, ambil layanan telepon cloud Zadarma.com. <br><br>  Langkah pertama: kami mendaftar dengan penyedia, saat mengakses akun pribadi Anda dan akun SIP Anda.  Kami dapat mendaftar dengan beberapa kotak surat, tetapi kami dapat mengisi ulang akun dan mendapatkan nomor tambahan.  Bagaimanapun, kita harus memiliki 2 angka (akun) dan kata sandi. <br><br>  Pada smartphone (berfungsi untuk saya di bawah Androd OS) kami memasang aplikasi seluler dari pasar, klien SIP akan melakukannya.  Untuk kenyamanan dan meminimalkan pengaturan awal, kita bisa menggunakan aplikasi eksklusif untuk panggilan Zadarma, tetapi kita bisa lebih fungsional. <br>  Setelah instalasi, kami melakukan registrasi dengan menunjukkan nomor dan kata sandi Anda, ini menyelesaikan pengaturan smartphone.  Jadi kami menggunakan satu nomor. <br><br>  Pada Server Otomasi Rumah Raspberry, kita memerlukan klien terminal SIP Linphonec.  Ketika menginstal dari repositori Raspbian, versi 3.6.1 yang agak lama diinstal, yang tidak bekerja dengan baik dengan sistem suara ALSA, tetapi karena tidak perlu menggunakan suara secara langsung, mari kita ikuti cara yang mudah. <br><br>  <i>Menginstal versi saat ini dari paket Linphone (3.12.0) tanpa antarmuka grafis untuk Debian 9, saya jelaskan dalam artikel sebelumnya: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tombol panggilan DIY.</a></i>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Raspberry Pi, MajorDoMo, Freeswitch dan Linphonec</a> .</i>  <i>Di sana Anda dapat menemukan informasi tentang cara memasang kartu suara USB dan pengaturan suara untuk Raspberry Pi.</i> <br><br>  Di terminal, jalankan perintah berikut: <br><br><pre><code class="plaintext hljs">sudo apt-get install linphone-nogtk</code> </pre> <br>  Instalasi linphonec utilitas klien konsol dan linphonecsh dilakukan - program konsol untuk mengelola linphonec berjalan di latar belakang di direktori / usr / bin. <br>  Mari kita jalankan pertama dengan mengetik: <br><br><pre> <code class="plaintext hljs">linphonec</code> </pre> <br>  Kami meluncurkannya, klien SIP bersumpah di ALSA, kami tidak memperhatikannya. <br><br>  Kami menjalankan perintah pendaftaran klien (Linphonec) di server zadarma, tentukan nomor dan kata sandi Anda yang kedua: <br><br><pre> <code class="plaintext hljs">register sip:xxxxxx@sip.zadarma.com sip.zadarma.com PASSWORD</code> </pre> <br>  Jika inputnya benar, maka kita melihat jawaban tentang pendaftaran yang berhasil: <br><br><img src="https://habrastorage.org/webt/sd/jj/wc/sdjjwcmmgdfsfklr4flza5tcnp8.png" alt="gambar"><br><br>  Kami keluar dari klien (Ctrl + c, sementara klien menyimpan pengaturan ke file .linphonerc dari pengguna saat ini, dalam kasus saya, direktori / home / pi /. Waktu berikutnya SIP dimulai, klien secara otomatis terdaftar pada server penyedia. <br><br>  Kami merekam pesan suara (misalnya: "Perhatian sistem telah di-boot ulang, statusnya sekarang beroperasi": <br><br><pre> <code class="plaintext hljs">arecord -D plughw:1,0 -f cd /home/pi/alarm_restart.wav</code> </pre><br>  Untuk menjalankan dan mengontrol Linphonec dalam mode daemon, utilitas Linphonecsh digunakan.  Awalnya, pada saat startup, inisialisasi klien lininit -init diperlukan.  Ketika perintah ini dijalankan, klien konsol memulai tanpa memuat file konfigurasi. <br><br>  Agar saat startup konfigurasi dibaca, jalankan dengan bendera dengan: <br><br><pre> <code class="plaintext hljs"> linphonecsh init -c /home/pi/.linphonerc</code> </pre><br>  Sekarang kita dapat mengelola klien konsol dari terminal. <br><br><div class="spoiler">  <b class="spoiler_title">Daftar Perintah Linphonecsh</b> <div class="spoiler_text"><pre> <code class="xml hljs">Usage: linphonecsh <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag">&gt;</span></span> [arguments] where action is one of init : spawn a linphonec daemon (first step to make other actions) followed by the arguments sent to linphonec generic : sends a generic command to the running linphonec daemon followed by the generic command surrounded by quotes, for example "call sip:joe@example.net" register : register; arguments are --host <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">host</span></span></span><span class="hljs-tag">&gt;</span></span> --username <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span> --password <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span> unregister : unregister dial : dial <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sip</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">or</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">number</span></span></span><span class="hljs-tag">&gt;</span></span> status : can be 'status register', 'status autoanswer' or 'status hook' soundcard : can be 'soundcard capture', 'soundcard playback', 'soundcard ring', followed by an optional number representing the index of the soundcard, in which case the soundcard is set instead of just read. exit : make the linphonec daemon to exit.</code> </pre> <br><br></div></div><br>  Mari kita coba perintah berikut: <br><br><pre> <code class="plaintext hljs">linphonecsh generic 'soundcard use files'</code> </pre> <br><pre> <code class="plaintext hljs">linphonecsh generic 'play alarm.wav'</code> </pre> <br><pre> <code class="plaintext hljs">linphonecsh dial sip:@sip.zadarma.com</code> </pre> <br>  Di mana generik adalah tim dari program Linphonec itu sendiri.  XXXXXX adalah nomor SIP kami yang terinstal di smartphone. <br><br>  Dalam hal ini, panggilan terjadi, ketika menjawab - Anda dapat mendengar pemutaran file yang direkam sebelumnya dengan kecelakaan. <br><br>  Secara manual itu berhasil.  Untuk berintegrasi dengan sistem otomatisasi rumah berbasiskan MajorDoMo, misalnya, lakukan darurat untuk me-restart server. <br>  Kami menulis baris berikut dalam crontab (saat memuat PC, klien konsol memuat: <br><br><pre> <code class="plaintext hljs">crontab -e</code> </pre> <br><pre> <code class="xml hljs">@reboot sudo -u pi linphonecsh init -c /home/pi/.linphonerc</code> </pre> <br>  Selanjutnya, buka halaman web sistem DD, buka <b>Control Panel - Scripts - Events - Startup.</b>  . <br><br><img src="https://habrastorage.org/webt/3i/ui/ec/3iuiec-as4d75jtddxvsmdgbgme.png"><br><br>  Skrip diimplementasikan dalam bahasa pemrograman PHP.  Sudah ada satu baris dalam kode itu, ketika memulai sistem, mengucapkan frasa dengan alamat IP server. <br><br>  Tambahkan beberapa lagi: <br><br><pre> <code class="php hljs">exec (<span class="hljs-string"><span class="hljs-string">"sudo -u pi linphonecsh generic 'soundcard use files'"</span></span>);</code> </pre> <br><pre> <code class="php hljs">exec (<span class="hljs-string"><span class="hljs-string">"sudo -u pi linphonecsh generic 'play alarm.wav'"</span></span>);</code> </pre> <br><pre> <code class="php hljs">exec (<span class="hljs-string"><span class="hljs-string">"sudo -u pi linphonecsh dial sip:576935@sip.zadarma.com "</span></span>);</code> </pre> <br>  Kami menginstal <i>untuk mengeksekusi setelah menyimpan</i> , kami menyimpan, pada saat yang sama ada panggilan pada ponsel. <br><br>  Kami me-reboot sistem MajorDoMo, melalui <b>Layanan - Reboot / shutdown</b> . <br>  Setelah reboot, pemberitahuan suara tiba di telepon.  Algoritme tindakan yang sama dapat dilakukan untuk kecelakaan lain yang penting bagi Anda. <br><br>  Setelah sedikit mengubah urutan tindakan, Anda dapat menginstal server IP telephony Anda sendiri (Asterisk, Freeswitch, dll.) Di sistem otomasi rumah Anda, sambungkan gateway VoIP ke sana dan secara langsung mengakses operator seluler atau PSTN.  Opsi ini lebih fungsional, memiliki lebih banyak fitur, tetapi juga membutuhkan beberapa biaya besar, baik material maupun untuk pengaturan sistem. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id466735/">https://habr.com/ru/post/id466735/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id466725/index.html">Belati 2 adalah unsur dasar (Bagian 1)</a></li>
<li><a href="../id466727/index.html">Upgrade malas: bagaimana PostgreSQL 12 meningkatkan kinerja</a></li>
<li><a href="../id466729/index.html">Buku "Data mining. Mengambil informasi dari Facebook, Twitter, LinkedIn, Instagram, GitHub Â»</a></li>
<li><a href="../id466731/index.html">Extravaganza. September naik</a></li>
<li><a href="../id466733/index.html">Selamat datang di DINS Java EVENING 18 September</a></li>
<li><a href="../id466737/index.html">Mengapa jaringan sosial Google+ gagal</a></li>
<li><a href="../id466739/index.html">Yang terbaik adalah musuh dari yang baik</a></li>
<li><a href="../id466741/index.html">Yang terbaik adalah musuh dari yang baik</a></li>
<li><a href="../id466745/index.html">Tempat kerja pertama atau cara mulai mengembangkan API di Node.js</a></li>
<li><a href="../id466747/index.html">Mitap pengembang iOS di Redmadrobot</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>