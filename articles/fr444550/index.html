<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§òüèΩ ü§Ωüèª üï∫üèº √Ä la question de la division üèáüèø üö≥ üï¥Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous avons eu l'occasion de mener un petit exercice tactique extr√™mement int√©ressant 
 Dans le processus de recherche d'un nouveau MK d'une entreprise...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√Ä la question de la division</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444550/"><h3>  Nous avons eu l'occasion de mener un petit exercice tactique extr√™mement int√©ressant </h3><br>  Dans le processus de recherche d'un nouveau MK d'une entreprise bien connue bas√©e sur l'architecture Cortex-M4 (j'√©crirai certainement √† ce sujet plus tard), la question s'est pos√©e de la rapidit√© avec laquelle l'op√©ration de division enti√®re dans l'impl√©mentation mat√©rielle peut fonctionner.  L'exp√©rience √† grande √©chelle a donn√© un r√©sultat quelque peu inattendu: la division d'un nombre 32 bits en un nombre 32 bits est effectu√©e sur 3 cycles d'horloge de la fr√©quence du processeur - enfin, peu importe la vitesse.  Il s'est av√©r√© que cela n'a lieu qu'avec certains op√©randes, mais d'autres √©tudes ont montr√© que jamais le temps de terminer la division ne d√©passe pas 7 mesures.  Les r√©sultats obtenus ont provoqu√© une l√©g√®re pr√©cipitation ("et ce n'est pas une certaine forme de discours, qui ne sait pas ce que cela signifie, mais un verbe tr√®s sp√©cifique" - Divov, comme toujours, est incomparable). <br><br>  Eh bien, vous ne pouvez pas simplement prendre et diviser rapidement des nombres aussi longs, c'est √©trange comme √ßa, mais les faits sont obstin√©s.  J'ai imagin√© la photo que le pr√©sident de la F√©d√©ration de Russie m'appelle demain et me confie la t√¢che de ne pas rendre MK pire que celle d'ARM (je conviens que la photo est d√©lirante, mais elle ne se produit pas dans le monde), mais je le regarde confus et je comprends que Je ne serai pas en mesure de faire une telle division de tels nombres dans un tel laps de temps, et je ne serai pas √† la hauteur des attentes qui m'ont √©t√© impos√©es (enfin, en fait, je peux toujours acheter une licence d'ARM tranquillement et pr√©tendre que j'ai tout invent√© moi-m√™me, beaucoup le font, mais Le PIB attend quelque chose de compl√®tement diff√©rent de moi, et puis - je peux le tromper, mais il est peu probable que je le fasse). <br><a name="habracut"></a><br>  Et j'√©tais triste que les gars d'ARM soient beaucoup plus intelligents que moi, et j'ai regard√© avec envie sur Internet pour voir comment ils le faisaient.  Je n'ai trouv√© aucune information sur le temps d'ex√©cution sur le site Web d'ARM, dans l'un des documents sur STM32, il a √©t√© indiqu√© que la division prend de 2 √† 7 cycles d'horloge, ce qui correspond aux observations, mais il n'y a aucune information sur la fa√ßon dont cela est fait. <br><br>  En g√©n√©ral, l'Internet omnipotent n'a pas beaucoup aid√©, il y a des astuces avec division par constante, j'ai √©crit √† leur sujet dans l'un des articles, mais nous avons une situation diff√©rente, il y a l'algorithme de Newton et sa version acc√©l√©r√©e, mais ce n'est clairement pas le cas, il existe un algorithme bas√© sur Transform√©e de Fourier, mais pour un tr√®s grand nombre et il est peu probable qu'elle soit achev√©e en 7 cycles, m√™me sur l'architecture ARM.  J'ai d√ª le trouver moi-m√™me et une solution a √©t√© trouv√©e, et si simple et √©vidente que cela devient quelque peu g√™nant du fait que cela n'a pas √©t√© fait imm√©diatement apr√®s la formulation de la t√¢che. <br><br>  Avant de prendre ma d√©cision, je vous sugg√®re de trouver la v√¥tre, puis de comparer avec la mienne, et si elles diff√®rent, je vous attends dans les commentaires. <br><br>  Alors, comment divisons-nous rapidement (en pas plus de 7 cycles) deux nombres 32 bits pour obtenir un r√©sultat 32 bits. <br><br>  Pour commencer, nous rappelons comment la division en arithm√©tique binaire est g√©n√©ralement effectu√©e dans <br>  forme classique.  L'algorithme est assez simple et direct - nous soustrayons le diviseur du dividende.  Si le r√©sultat n'est pas n√©gatif (nous divisons les nombres non sign√©s), faites alors le chiffre suivant du r√©sultat √©gal √† un et consid√©rez le r√©sultat comme le prochain dividende, sinon le bit suivant du r√©sultat est 0. Avant la mesure suivante, nous divisons par deux le diviseur (soit le d√©placer vers la droite, ou d√©placer le dividende vers la gauche) et r√©duire le poids du bit de 2 fois (par des d√©calages similaires).  Ainsi, nous obtenons un bit du r√©sultat en un cycle d'horloge et l'ensemble de l'op√©ration durera 32 cycles d'horloge.  Il y a encore un changement initial dans ce processus, mais cela n'affecte pas l'√©valuation de la situation dans son ensemble.  Nous allons acc√©l√©rer, mais comment? <br><br>  Nous notons que l'algorithme r√©sultant ressemble fortement au fonctionnement d'un ADC avec une approximation s√©quentielle et rappelons qu'il existe d'autres m√©thodes de conversion, beaucoup plus rapides - la conversion parall√®le.  Et si ... <br><br>  Nous allons soustraire du diviseur non seulement le dividende, mais le dividende * 2 et le dividende * 3 (en m√™me temps, sur trois additionneurs), puis nous obtiendrons trois bits (signes de r√©sultats) des informations, qui prennent 4 valeurs diff√©rentes, de sorte que vous pouvez en extraire 2 bits √† la fois r√©sultat.  Ensuite, nous extrapolons une approche similaire pour 3,4,5 bits du r√©sultat. <br>  Pour obtenir 5 bits d'informations par cycle, nous avons besoin de 31 additionneurs, sur chacun desquels l'op√©ration Dividend-Divisor * n (1-31) sera effectu√©e, les signes du r√©sultat passent par l'encodeur et nous recevrons imm√©diatement 5 bits du r√©sultat.  Ensuite, nous d√©calons le dividende de 5 chiffres vers la gauche et r√©p√©tons jusqu'√† ce que vous soyez pr√™t.  Ensuite, nous avons besoin de 32/5 = 6,4 =&gt; 7 mesures pour terminer l'op√©ration. <br><br>  Pour le travail, nous avons besoin de 31 + x additionneurs, cela semble √™tre beaucoup, mais nous les avons d√©j√†, car nous avons une op√©ration de multiplication 32 * 32 par cycle, et pour l'impl√©menter, nous ne pouvons pas nous passer de 32 additionneurs (enfin, je pense que oui ... ), pour que nous ayons d√©j√† l'√©quipement n√©cessaire, la seule question est de construire un circuit de contr√¥le et un tas de multiplexeurs pour r√©aliser un d√©calage rapide, mais cela est compl√®tement r√©soluble. <br><br>  Ainsi, la t√¢che de diviser en 7 √©tapes est r√©solue, la question demeure - comment ce temps peut-il √™tre r√©duit, car dans le MK √©tudi√©, il est inf√©rieur √† 7. La solution √©vidente consiste √† d√©terminer le nombre du chiffre le plus significatif du dividende (H) et du diviseur (3) au stade de la pr√©paration de l'algorithme il deviendra imm√©diatement clair combien de bits hauts du quotient sont √©gaux √† z√©ro, de sorte que nous pouvons sauter la premi√®re ou plusieurs phases de l'algorithme.  Par exemple, si C &lt;3, alors le r√©sultat est imm√©diatement nul et nous terminons l'op√©ration, c'est s√ªr que vous pouvez d√©river une formule pour le nombre de mesures, mais je m'ennuyais d√©j√†. <br><br>  Fait int√©ressant, l'op√©ration udiv ne donne que le quotient, bien que le reste reste √©videmment quelque part √† l'int√©rieur.  En principe, il n'est pas difficile de l'obtenir en deux √©tapes, ce qui a √©t√© fait dans le fragment √©tudi√© du code machine en ex√©cutant le pseudo-code Divisible-Private * Divider, mais c'est pour 2 √©tapes, pourquoi ne pas le diffuser imm√©diatement dans la paire de registres - je ne connais pas la r√©ponse √† cela une question. <br><br>  En g√©n√©ral, respectez le PIB, dites-lui que nous ferons d√©finitivement la division en MK si √ßa l'int√©resse encore. <br><br>  PS: Au fait, lorsque je cherchais du KDPV (comme vous l‚Äôavez remarqu√©, je ne l‚Äôai pas trouv√©), j‚Äôen ai remarqu√© un avec l‚Äôinscription franchement incorrecte "Vous ne devez pas diviser par z√©ro."  Je dois dire avec certitude qu'il est possible de diviser par z√©ro, ne peut pas √™tre divis√©.  Mais s√©rieusement, dans diff√©rentes architectures, ils se divisent par z√©ro diff√©remment, en x86, nous obtenons une exception (c'est une erreur inoubliable 200), dans certains, nous obtenons un dividende ou z√©ro, mais je n'ai jamais vu l'entier maximum.  Dans ARM n / 0 = 0/0 et il s'av√®re 0. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr444550/">https://habr.com/ru/post/fr444550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr444540/index.html">Intel est pr√™t √† commencer la production de m√©moire MRAM</a></li>
<li><a href="../fr444542/index.html">Diffusion en direct et calendrier des conf√©rences pour SmartMail Conf: Machine Learning</a></li>
<li><a href="../fr444544/index.html">Quelque chose au sujet des centres de donn√©es distribu√©s pour les entreprises</a></li>
<li><a href="../fr444546/index.html">Comment et pourquoi travailler plus lentement? La m√©thode de Sergey Korolev</a></li>
<li><a href="../fr444548/index.html">Exp√©rience personnelle: comment nous nous sommes engag√©s dans la promotion de startups hispaniques en Am√©rique latine</a></li>
<li><a href="../fr444552/index.html">TDMS Fairway. Travailler avec expertise</a></li>
<li><a href="../fr444554/index.html">L'API JSON RESTful la plus simple sur Elixir</a></li>
<li><a href="../fr444556/index.html">La couleur de la lune et du soleil de l'espace dans les valeurs de RVB et de temp√©rature de couleur</a></li>
<li><a href="../fr444558/index.html">Quoi de neuf dans CUBA 7</a></li>
<li><a href="../fr444560/index.html">Nous vous invitons √† la conf√©rence ¬´Clouds. Tendances de la mode ‚Äù26 mars 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>