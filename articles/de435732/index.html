<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔖 👂🏽 ⭐️ Freitag JS: eine Quine, die Tic-Tac-Toe spielt 🔥 👨🏼‍🏫 🙎🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich grüße alle in meinem traditionellen Bereich voller Lovecraftian-Wahnsinn. 

 Beim Schreiben eines der vorherigen Artikel (nicht schauen, es war ni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Freitag JS: eine Quine, die Tic-Tac-Toe spielt</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435732/"> Ich grüße alle in meinem traditionellen Bereich voller Lovecraftian-Wahnsinn. <br><br>  Beim Schreiben eines der vorherigen Artikel (nicht schauen, es war nicht besonders gut) habe ich über die Tatsache nachgedacht, dass Quine ... Ja, nur für den Fall, ich erinnere Sie daran: Quine ist ein Programm, das seinen eigenen Text anzeigt und es "ehrlich" macht ( ohne beispielsweise diesen Text in einer Datei auf Ihrer Festplatte zu suchen).  Im Allgemeinen die traditionelle bedeutungslose Puzomerka der Programmierer. <br><br>  Also dachte ich darüber nach, dass Quine im Prinzip eine beliebige Nutzlast tragen kann.  Das heißt, etwas anderes als seine Hauptfunktion zu tun.  Und als Proof-of-Concept habe ich beschlossen, eine Quine zu schreiben, die Tic-Tac-Toe spielt.  Und schrieb.  Schmutzige Details unter dem Schnitt. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/310/2e0/e41/3102e0e41c87371ea771188ab03d4c13.jpg" alt="Bild"><br><a name="habracut"></a><br>  "Aber wie kann er etwas anderes tun, als seinen Text anzuzeigen?"  - Vielleicht fragst du.  Und einfach.  Neben der Ausgabe verfügt das Programm auch über eine Eingabe.  Wenn das Programm seinen Text ohne Eingabe anzeigt, ist es quine.  Wenn das Programm etwas anderes tut, wenn Eingaben verfügbar sind, wen sollen wir dann verurteilen? <br><br>  Vielleicht lege ich sofort die Karten auf den Tisch.  <a href="">Hier ist ein Link zu meiner Kreation.</a>  Die Datei enthält drei Entitäten, auf die verwiesen wird: <br><br><ol><li>  Die Quine-Funktion ist das, worüber ich spreche. </li><li>  Die evalAndCall-Funktion ist ein Helfer. </li><li>  Spielklasse - noch mehr Helfer </li></ol><br>  Zuerst werden wir darüber sprechen, wie man mit der Quine-Funktion arbeitet und dann, wie es funktioniert. <br><br><h3>  Wie man mit ihr arbeitet </h3><br>  Ganz am Anfang der Quine-Funktion sehen Sie Folgendes: <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">input</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/* |1|2|3| |4|x|6| |7|8|9| !  - ,     -. ,   .     ,    ,     .             ,    . :   - 0   - 0  - 0 */</span></span></code> </pre> <br>  Der Kommentar ganz am Anfang der Funktion ist die Benutzeroberfläche.  Dadurch wird die Funktion mit denen kommunizieren, die sie für das Spiel verwenden.  Zuerst dachte ich darüber nach, es über die Konsole zu tun, aber dann entschied ich, dass es korrekter wäre, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Funktion sauber</a> zu halten. <br><br>  Lassen Sie uns überprüfen, ob die Funktion wirklich quine ist.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hier habe</a> ich der Einfachheit halber eine (fast) leere HTML-Seite mit dem angehängten Skript quine.js gepostet.  Wenn Sie die Tools des Entwicklers öffnen, können Sie den folgenden Code dort nicht selektiv steuern: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> quineText = quine(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> evaluatedQuine = <span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">"("</span></span> + quineText + <span class="hljs-string"><span class="hljs-string">")"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ,     eval       //  undefined,   const evaluatedQuineText = evaluatedQuine(); quineText == evaluatedQuineText; // true</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Bohrung mod</b> <div class="spoiler_text">  Tatsächlich haben wir natürlich nur überprüft, ob die Quine-Funktion den Text des Quines zurückgibt und nicht, ob es sich selbst um den Quine handelt.  Und um genau zu sein - wir haben nur überprüft, ob die Quine-Funktion den Text der Funktion zurückgibt, die in unserem Fall wie Quine funktioniert hat.  Es gibt keine Garantie dafür, dass das Innere nichts enthält wie: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() &lt; <span class="hljs-number"><span class="hljs-number">0.99</span></span>){ beAGoodQuine(); }<span class="hljs-keyword"><span class="hljs-keyword">else</span></span>{ haltAndCatchFire(); }</code> </pre><br></div></div><br>  Jetzt können wir versuchen, mit ihr zu spielen.  Nehmen wir an, wir machen den ersten Schritt in die obere linke Ecke des Feldes. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> quineText = quine(<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><br>  Nun ist die "Benutzeroberfläche" wie folgt: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">input</span></span></span><span class="hljs-function">)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/* |o|x|3| |4|x|6| |7|8|9| !  - ,     -. ,   .     ,    ,     .             ,    . :   - 0   - 0  - 0 */</span></span></code> </pre><br>  Quine berücksichtigte unseren Umzug und gab eine Antwort im oberen zentralen Feld.  Übrigens wird die resultierende Funktion auch ohne Argumente quine aufgerufen. Sie gibt ihren neuen Text zurück, nicht den Text der ursprünglichen Funktion.  Wir können das ganze Spiel spielen, aber der Einfachheit halber werden wir die Hilfsfunktion evalAndCall verwenden. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> quineText = quine(); <span class="hljs-comment"><span class="hljs-comment">//         ,    . /* |1|2|3| |4|x|6| |7|8|9| */ quineText = evalAndCall(quineText, 1) /* |x|o|3| |4|x|6| |7|8|9| */ quineText = evalAndCall(quineText, 3) /* |x|o|o| |4|x|6| |7|8|x|     .    ,   0    */ quineText = evalAndCall(quineText, 0) /* |1|2|3| |4|x|6| |7|8|9| :   - 0   - 1  - 0 */</span></span></code> </pre><br>  Voila!  Quine spielt, gewinnt und punktet sogar.  Sie können länger damit spielen, aber für mehr Komfort empfehle ich die Verwendung der Spielklasse, mit der ich das Spiel selbst getestet habe.  Ich denke, wenn Sie bis zu diesem Punkt lesen, muss ich nicht erklären, wie man es benutzt. <br><br><h3>  Wie es funktioniert </h3><br>  Im Allgemeinen bestand die Aufgabe aus zwei Teilen: Wenn möglich, eine präzise Funktion des Tic-Tac-Toe-Spiels zu schreiben und sie dann in die Quine zu schieben.  Beginnen wir mit Tic-Tac-Toe. <br><br>  Der Kern der „künstlichen Intelligenz“ befindet sich in den Zeilen 66 bis 90 und ihre Silhouette ähnelt einem hartnäckigen Eichhörnchen: <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> rules = { <span class="hljs-string"><span class="hljs-string">"o___x____"</span></span>: <span class="hljs-string"><span class="hljs-string">"ox__x__!_"</span></span>, <span class="hljs-string"><span class="hljs-string">"ox__x__o_"</span></span>: <span class="hljs-string"><span class="hljs-string">"ox!_x_xo_"</span></span>, <span class="hljs-string"><span class="hljs-string">"oxo_x_xo_"</span></span>: <span class="hljs-string"><span class="hljs-string">"oxo!xxxo_"</span></span>, <span class="hljs-string"><span class="hljs-string">"oxooxxxo_"</span></span>: <span class="hljs-string"><span class="hljs-string">"oxooxxxoxd"</span></span>, <span class="hljs-string"><span class="hljs-string">"_o__x____"</span></span>: <span class="hljs-string"><span class="hljs-string">"xo__x___!"</span></span>, <span class="hljs-string"><span class="hljs-string">"xo__x___o"</span></span>: <span class="hljs-string"><span class="hljs-string">"xo_xx!!_o"</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> next = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">field, move</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!~<span class="hljs-string"><span class="hljs-string">"!_"</span></span>.indexOf(field[--move])){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } field[move] = <span class="hljs-string"><span class="hljs-string">"o"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> win = field.indexOf(<span class="hljs-string"><span class="hljs-string">"!"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(~win){ field[win] = <span class="hljs-string"><span class="hljs-string">"x"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [...field, <span class="hljs-string"><span class="hljs-string">"w"</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; n &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; n++){ field = field.map(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_, i</span></span></span><span class="hljs-function">) =&gt;</span></span> field[[<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>][i]]); rules[field.join(<span class="hljs-string"><span class="hljs-string">""</span></span>)] &amp;&amp; (field = rules[field.join(<span class="hljs-string"><span class="hljs-string">""</span></span>)].split(<span class="hljs-string"><span class="hljs-string">""</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> field; }</code> </pre> <br>  Dieser Code sieht etwas verschleiert aus, weil ich daran interessiert war, ihn so kurz wie möglich zu halten.  Das Wesentliche ist Folgendes: Bei der Eingabe der nächsten Funktion werden der Status des Feldes - ein Array von neun Elementen - und die Zellennummer, in der die Spielerperson einen Zug ausführt (der nächste prüft die Gültigkeit dieses Zuges), empfangen.  Jedes Element des Feldes kann ein Kreuz, eine Null, ein Unterstrich (leere Zelle) oder ein Ausrufezeichen (eine leere Zelle, auf die bei der ersten Gelegenheit ein Kreuz gesetzt werden soll) sein.  Wenn es ein Ausrufezeichen auf dem Feld gibt, machen wir sofort einen Zug dorthin und gewinnen.  Andernfalls kleben wir das Array in eine Zeichenfolge und suchen im Regelobjekt nach der entsprechenden Regel.  Um Platz zu sparen, sind die Regeln drehgenau. Bei der Suche wird das Feld daher viermal gedreht.  Wenn die gewünschte Regel gefunden wurde, wird der Status des Felds durch den Wert der Regel ersetzt, der in Zeichen unterteilt ist.  Als nächstes gibt die nächste Funktion den neuen Status des Feldes zurück.  Gleichzeitig kann ein weiteres zehntes Zeichen hinzukommen: "w" - wenn die KI gewonnen hat, "d" - wenn es ein Unentschieden gab. <br><br>  Dank der Ausrufezeichen, „Hinweise“ und der Rotation des Feldes und natürlich auch aufgrund der Tatsache, dass die KI an erster Stelle steht, wurde die optimale Strategie in nur 6 Regeln beschrieben. <br><br>  Mit der nächsten Funktion verarbeitet die Quine-Funktion die Eingabe und schreibt einige Felder in das magicHash-Objekt.  Und hier kommen wir reibungslos zum zweiten Teil: Wie die „Quayne“ -Komponente funktioniert.  Alle Magie befindet sich im magicHash-Objekt und seiner magicString-Eigenschaft. <br><br>  Wie Sie leicht sehen können, enthält die magicString-Zeile fast vollständig duplizierten Programmtext.  Wie jedoch jeder weiß, der jemals versucht hat, eine Quine zu schreiben, kann man keinen vollständig vollständigen Text hineinschieben - denn dann muss er sich streng selbst enthalten, was für Strings endlicher Länge unmöglich ist.  Daher enthält es neben dem „einfachen“ Text auch „magische“ Platzhaltersequenzen, die auf beiden Seiten durch das Zeichen „$“ begrenzt sind. <br><br>  Wenn die Zeit X kommt und wir den Text der Funktion zurückgeben müssen, nehmen wir einfach magicString und ersetzen die darin enthaltenen Platzhalter durch die entsprechenden Eigenschaften des magicHash-Objekts.  Diese Eigenschaften können statisch sein (Backtick), sich zur Laufzeit ändern (Feld) oder sogar zur Laufzeit hinzugefügt werden (Nachricht) - das spielt keine Rolle.  Es ist wichtig, dass wir für jeden „problematischen“ Code, der nicht einfach in einer Zeile dupliziert werden kann, eine „magische“ Eigenschaft des magicHash-Objekts haben.  Der letzte ersetzt magicString selbst.  Letzteres - denn sonst gäbe es zusätzliche Platzhaltersequenzen, die ebenfalls ersetzt würden. <br><br><h3>  Zusammenfassung </h3><br>  Ich habe aus eigener Erfahrung überprüft, ob man alles in eine Quine stopfen kann.  Wenn Sie sich die Mühe machen, können Sie im Prinzip einen Quine-Generator erstellen - eine Funktion, die jede andere reine Funktion in Quine umwandelt und es Ihnen ermöglicht, einen beliebigen Zustand zu speichern, auf den die obige reine Funktion zugreifen kann.  Die Ränder dieses Manuskripts sind jedoch zu eng ... <br><br>  Im Allgemeinen gebe ich nicht vor, die besondere Neuheit meiner "Entdeckung" zu sein.  Hardcore-Funktionäre müssen diesen Text mit einem hervorragenden Lächeln gelesen haben.  Aber es war interessant für mich, es mit meinen eigenen Händen aufzunehmen, sozusagen Finger in Wunden zu stecken.  Und ich hoffe, Sie waren daran interessiert, darüber zu lesen. <br><br>  Auf Wiedersehen, Mädchen und Jungen.  Wir sehen uns wieder. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de435732/">https://habr.com/ru/post/de435732/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de435720/index.html">Entwicklung Adblock Radio</a></li>
<li><a href="../de435722/index.html">NB-IoT, Schmalband-Internet der Dinge. Energiesparmodi und Steuerbefehle</a></li>
<li><a href="../de435724/index.html">Die Laster des Imperativs zurückhalten</a></li>
<li><a href="../de435728/index.html">[Freitag] Geschichte darüber, wie IT-Sale versucht hat, Brennholz zu verkaufen, oder die Backstage einer Ausschreibung</a></li>
<li><a href="../de435730/index.html">Die Muschel knackte</a></li>
<li><a href="../de435734/index.html">Wie man sich nicht von Physik täuschen lässt</a></li>
<li><a href="../de435738/index.html">DIY Projekttechnik. Teil eins</a></li>
<li><a href="../de435740/index.html">Die Registrierung ist beim GraphQL Meetup in St. Petersburg möglich</a></li>
<li><a href="../de435742/index.html">Ressourcenmanagement in der Zimbra Collaboration Suite</a></li>
<li><a href="../de435744/index.html">Fintech Digest: Die Bank of Russia wird in der Lage sein, Standorte zu blockieren, das P2P-Kreditvolumen sinkt, Krypto in Europa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>