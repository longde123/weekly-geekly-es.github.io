<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ôìÔ∏è üêÉ üßñüèª C√≥mo Namecoin Blockchain Research predijo ataques cibern√©ticos RTM üë©‚Äçüë¶ üéüÔ∏è üàπ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La cadena de bloques Namecoin se cre√≥ como una alternativa a los registradores DNS tradicionales, protegida contra la censura y la incautaci√≥n forzada...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo Namecoin Blockchain Research predijo ataques cibern√©ticos RTM</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pt/blog/460857/"><img src="https://habrastorage.org/webt/yc/l5/bz/ycl5bz9rlakm74fw8zztbhesnbm.png"><br><br>  La cadena de bloques Namecoin se cre√≥ como una alternativa a los registradores DNS tradicionales, protegida contra la censura y la incautaci√≥n forzada de dominios.  En los √∫ltimos a√±os, los operadores de botnets como Dimnie, Shifu, RTM y Gandcrab han comenzado a usarlo para administrar las direcciones de los servidores de C&amp;C. <br><br>  Por un lado, la descentralizaci√≥n y la estabilidad de blockchain evitan que los investigadores y proveedores eliminen dichos dominios o tomen el control de ellos.  Por otro lado, la infraestructura basada en la cadena de bloques tiene una caracter√≠stica arquitect√≥nica: todos los cambios en la red est√°n disponibles p√∫blicamente y pueden usarse para estudiar y rastrear las acciones de los atacantes. <br><br>  Este art√≠culo presenta el enfoque utilizado para mapear botnets en Namecoin y seguirlas para extraer nuevos COI.  Utilizando el enfoque descrito, se compilaron listas de activos (ver el ap√©ndice) utilizados por las botnets mencionadas anteriormente. <br><a name="habracut"></a><br><h2>  Digresi√≥n l√≠rica </h2><br>  Las invenciones que cambian Internet a menudo resuelven no solo y no tanto un problema t√©cnico como social.  Precisamente, esas tecnolog√≠as y servicios son los que permiten a la comunidad mirar de lado a algunos axiomas que parec√≠an inquebrantables, repensarlos, recrearlos desde cero, dejando solo una idea y dejando caer la carga de convenciones y limitaciones heredadas acumuladas a lo largo de los a√±os.  Blockchain y Bitcoin, Tor, Wikipedia: detr√°s del √©xito de cada uno de ellos hay un peque√±o grupo de entusiastas con ojos ardientes, que creen sinceramente que est√°n haciendo una sociedad mejor. <br><br>  Por desgracia, otros a menudo los persiguen, ajenos a los extra√±os ideales de los pioneros de Internet, pero mucho m√°s pr√°cticos.  Encuentran <i>una</i> aplicaci√≥n <i>alternativa</i> para la tecnolog√≠a, en la cual los creadores no pensaron (o no quisieron pensar).  Estando en la frontera (y m√°s a menudo, para esconderse, abiertamente en el extranjero) de lo permitido, esta aplicaci√≥n alternativa, a menudo no sin la ayuda de los medios, ya que la mayor√≠a se convierte en <i>impl√≠cita por defecto</i> , o incluso en la <i>√∫nica</i> . <br><br>  La equivalencia de la tecnolog√≠a como idea y el m√©todo m√°s discutido de su uso puede llevar al rechazo de la sociedad por la tecnolog√≠a misma.  Como resultado de la criminalizaci√≥n de su uso, un servicio inmaduro puede reducirse al nivel de una cultura marginal o destruirse por completo.  Entonces sucedi√≥ hace mucho tiempo con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Napster</a> , no hace mucho tiempo, con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">BitTorrent</a> y Tor, en este momento esto est√° sucediendo con Bitcoin. <br><br>  Este no es el h√©roe pasado de este trabajo: Namecoin.  Namecoin es una cadena de bloques dise√±ada para almacenar pares arbitrarios de clave-valor, el m√°s famoso de los cuales es un sistema de registro de nombre DNS descentralizado y resistente a la censura: Dot-Bit. <br><br>  Nuestro inter√©s en Namecoin creci√≥ despu√©s de que el grupo de administraci√≥n de botnets RTM comenz√≥ a usar Dot-Bit para administrar sus servidores de C&amp;C.  En alg√∫n momento, nos preguntamos: ¬øes posible detectar nuevos servidores C &amp; C inmediatamente despu√©s de que est√©n registrados en Dot-Bit?  Y si no hubo problemas con las actualizaciones de dominios conocidos, el desarrollo de un enfoque que permita detectar evidencia s√≥lida de la conexi√≥n de nuevos dominios con una persona de inter√©s result√≥ ser una tarea de investigaci√≥n emocionante, cuyo resultado fue este trabajo. <br><br>  En general, la investigaci√≥n de Namecoin y la recopilaci√≥n de indicadores de compromiso en Dot-Bit se llevaron a cabo antes.  El trabajo m√°s detallado puede considerarse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un art√≠culo de Kevin Perlow</a> .  Fue el primero en llamar la atenci√≥n sobre la posibilidad fundamental de extraer datos de Namecoin y describi√≥ varias t√©cnicas heur√≠sticas que permiten a un experto encontrar dominios similares en caracter√≠sticas a los conocidos servidores de C&amp;C de un grupo en particular. <br><br>  El enfoque presentado en este estudio tiene varias diferencias significativas con respecto a la t√©cnica de indexaci√≥n y pivote experta descrita por Kevin.  Las reglas heur√≠sticas que desarrollamos para determinar los propietarios de dominios se derivan de los principios del funcionamiento de la cadena de bloques y la formaci√≥n de transacciones en ella y, adem√°s de la descripci√≥n general, se presentan en forma de formulaciones l√≥gicas estrictas.  Junto con una descripci√≥n formal del algoritmo de derivaci√≥n, esto le permite automatizar la b√∫squeda de COI, lo que aumenta significativamente la efectividad de la investigaci√≥n.  Adem√°s, el algoritmo desarrollado ayuda no solo a encontrar otros nombres que alguna vez fueron utilizados por el grupo de estudio, sino que tambi√©n le permite rastrear la creaci√≥n de nuevos dominios controlados por la misma persona. <br><br>  Todo el trabajo se divide en tres cap√≠tulos.  El primer cap√≠tulo describe los conceptos b√°sicos de Bitcoin, cuyo c√≥digo se utiliz√≥ como plataforma para crear Namecoin.  Namecoin ha heredado muchas entidades, relaciones y sus implementaciones definidas en Bitcoin.  Su comprensi√≥n es crucial para una mayor discusi√≥n. <br><br>  El segundo cap√≠tulo est√° dedicado directamente a Namecoin y su aplicaci√≥n principal: Dot-Bit. <br><br>  El tercer cap√≠tulo describe el enfoque propuesto para extraer datos de Namecoin, y tambi√©n ofrece una descripci√≥n formal del algoritmo de derivaci√≥n de blockchain y las reglas heur√≠sticas utilizadas para establecer relaciones entre dominios. <br><br>  Los ap√©ndices contienen IOC recopilados utilizando el m√©todo descrito para algunas botnets, as√≠ como una lista de referencias y repositorios que ayudar√°n a los investigadores que quieran seguir trabajando en este tema. <br><br><h2>  Bitcoin 201 </h2><br>  La mayor parte de la informaci√≥n en esta secci√≥n se recopila de los materiales de la serie de art√≠culos de Sergey <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">Pavlov_dog</a> Potekhin " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bitcoin en pocas palabras</a> ".  Para los lectores de habla rusa, esta fuente, en nuestra opini√≥n, es la m√°s completa y profunda disponible p√∫blicamente, pero es sorprendentemente f√°cil de leer.  Investigadores interesados ‚Äã‚Äãen el dispositivo interno de Bitcoin, instamos a no limitarnos a los extractos dados en esta secci√≥n, sino a familiarizarnos con el texto completo de los art√≠culos, disponibles por referencia en la aplicaci√≥n.  El resto de la informaci√≥n presentada a continuaci√≥n ser√° suficiente para comprender la descripci√≥n del algoritmo y las reglas heur√≠sticas para encontrar la relaci√≥n entre las direcciones en Namecoin, que se proporciona en el √∫ltimo cap√≠tulo. <br><br>  Aunque es costumbre comenzar la historia sobre blockchain con bloques y la criptograf√≠a que los conecta, comenzaremos con las transacciones. <br><br><h3>  Transacci√≥n </h3><br>  Como saben, el an√°logo m√°s cercano a Bitcoin es un libro de cuentas en el que se registran todas las transacciones con monedas.  Pero, curiosamente, en Bitcoin no hay una tabla general del formulario <code>&lt;, &gt;</code> , al igual que no hay un contador principal que edite esta tabla. <br><br>  En cambio, se usa la cadena de bloques muy notoria, es decir, todas las transacciones generalmente se almacenan.  Por simplicidad, podemos suponer que estos son mensajes de la forma: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag">&gt;</span></span> sent <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">amount</span></span></span><span class="hljs-tag">&gt;</span></span> BTC to <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">2</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Entonces, si recorres toda la cadena de bloques, puedes calcular cu√°ntas monedas "pertenecen" a una direcci√≥n en particular. <br><br><h4>  Entradas y salidas </h4><br>  Una transacci√≥n real en una red de Bitcoin es un poco m√°s complicada que la descrita anteriormente.  Esta es una estructura cuyos componentes principales son entradas y salidas. <br><br>  Las entradas son transacciones a las que se "refiere".  Imagine que se enviaron tres transacciones a su direcci√≥n X una vez: <br><br><pre> <code class="json hljs">TXN_ID: <span class="hljs-number"><span class="hljs-number">123456</span></span>, VALUE: <span class="hljs-number"><span class="hljs-number">40</span></span> BTC TXN_ID: <span class="hljs-number"><span class="hljs-number">645379</span></span>, VALUE: <span class="hljs-number"><span class="hljs-number">10</span></span> BTC TXN_ID: <span class="hljs-number"><span class="hljs-number">888888</span></span>, VALUE: <span class="hljs-number"><span class="hljs-number">100</span></span> BTC</code> </pre> <br>  Si necesita gastar, por ejemplo, <code>45 BTC</code> , puede consultar la transacci√≥n <code>888888</code> o dos transacciones a la vez: <code>123456</code> y <code>645379</code> . <br><br>  Salidas - literalmente "salidas".  Podemos suponer que estas son "direcciones" a las que se enviar√°n las monedas como resultado de la transacci√≥n.  Tambi√©n puede haber varias salidas; cada una de ellas tiene su propia cantidad. <br><br>  En la imagen a continuaci√≥n, <code>C</code> una nueva transacci√≥n <code>C</code> , que se refiere a dos salidas: <code>A</code> y <code>B</code>  Como resultado, la transacci√≥n tiene <code>0.008 BTC</code> en la entrada, que luego se dividen en dos salidas: <code>0.001 BTC</code> env√≠a a la primera direcci√≥n y <code>0.006 BTC</code> a la segunda. <br><br><img src="https://habrastorage.org/webt/hc/jj/-v/hcjj-vgrvls-t0qv4alrdutq1mm.png" alt="imagen"><br><br>  La capacidad de especificar m√∫ltiples salidas a la vez es una caracter√≠stica muy importante, porque <b>la salida de la transacci√≥n se puede usar como entrada solo una vez y solo en su totalidad</b> .  Si tiene una transacci√≥n entrante a <code>10 BTC</code> y necesita gastar 8 de ellas, simplemente cree una transacci√≥n con una entrada y dos salidas: <code>8 BTC</code> para el vendedor y <code>2 BTC</code> regreso a su direcci√≥n.  Si crea una transacci√≥n en la que la suma de las salidas es menor que la suma de las entradas (como en la imagen), la diferencia se env√≠a a la direcci√≥n del minero que escribi√≥ su transacci√≥n en el bloque. <br><br><h2>  Tarifa </h2><br>  Es esta diferencia entre la suma de entradas y la suma de salidas lo que se denomina " <code>transaction fee</code> ", <code>transaction fee</code> .  Es la segunda fuente de ingresos m√°s importante para los mineros, y el tiempo que tarda la transacci√≥n en incluirse en la cadena de bloques depende de ello.  Esto se debe al hecho de que cada minero tiene un cierto grupo de transacciones no verificadas que afirman estar en el bloque y, por regla general, el minero simplemente las ordena en orden descendente, maximizando as√≠ sus ganancias.  Por lo tanto, cuanto mayor sea la comisi√≥n, m√°s alto estar√° en la cola y m√°s r√°pido ir√° su pago. <br><br>  La vista general de la transacci√≥n se describe en la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">especificaci√≥n oficial del protocolo</a> , aqu√≠ se da uno de los casos particulares m√°s comunes. <br><br><img src="https://habrastorage.org/webt/sy/s-/g1/sys-g1dafvutkmxwetsud1urhng.png"><br><br>  <code>previous output hash</code> : identificador (hash) de la transacci√≥n a la que nos referimos.  <code>previous output index</code> : dado que necesitamos referirnos no a la transacci√≥n en s√≠, sino a una de sus salidas, en este par√°metro indicamos en qu√© salida en particular estamos interesados.  La numeraci√≥n comienza desde cero.  <code>value</code> : la cantidad de Satoshi ( <code>1/100000000</code> BTC) enviada a la salida.  Se registra en una forma little-endian, es decir, <code>62 64 01 00 00 00 00 00</code> : es <code>0x016462</code> o <code>0.00091234 BTC</code> . <br><br>  El <code>block lock time</code> y los par√°metros de <code>sequence</code> rara vez se usan en la pr√°ctica.  No estamos interesados ‚Äã‚Äãen ellos, por lo que omitiremos la descripci√≥n de su prop√≥sito. <br><br>  Pero en los par√°metros con la palabra <code>script</code> en el t√≠tulo nos detenemos con m√°s detalle. <br><br><h4>  Gui√≥n </h4><br>  La red Bitcoin tiene un mecanismo basado en algoritmos criptogr√°ficos con una clave p√∫blica que le permite crear un sistema en el que solo el propietario de la clave puede usar las monedas asociadas con la direcci√≥n obtenida de esta clave.  Descubriremos c√≥mo se implementa esto bajo el cap√≥. <br><br>  Para empezar, dentro de Bitcoin hay un lenguaje de programaci√≥n simple y apilado llamado <code>Script</code> .  Aqu√≠ est√° el programa de script m√°s simple: <br><br><pre> <code class="xml hljs">2 3 OP_ADD 5 OP_EQUAL</code> </pre> <br>  Cada instrucci√≥n se llama <code>opcode</code> , hay alrededor de 80 en total. La siguiente imagen muestra el proceso de ejecuci√≥n del programa anterior. <br><br><img src="https://habrastorage.org/webt/du/p0/a9/dup0a971icbk3mhhz1k7vfsipg0.png"><br><br><img src="https://habrastorage.org/webt/pe/xz/6k/pexz6k4icaot60gal2hc7y_iijk.png"><br><br><img src="https://habrastorage.org/webt/ie/nr/sg/ienrsgzd8tb5ncdwaxvvpzzdfku.png"><br><br><img src="https://habrastorage.org/webt/n8/zy/ve/n8zyvevbelp1wm7za8aksy-kcpi.png"><br><br><img src="https://habrastorage.org/webt/gx/aw/v_/gxawv_arrvb86zydou0zm22qhi0.png"><br><br>  Bitcoin <code>Script</code> se usa para establecer la condici√≥n bajo la cual ser√° posible gastar la salida y poder confirmar que se cumple la condici√≥n.  La condici√≥n ( <code>locking script</code> ) se almacena en la transacci√≥n en el campo <code>scriptPubKey</code> para cada salida.  La confirmaci√≥n de que se cumple la condici√≥n ( <code>unlocking script</code> ) se escribe en el campo <code>scriptSig</code> para cada entrada. <br><br>  Para verificar el derecho a utilizar la salida, debe conectar el <code>unlocking script</code> + <code>locking script</code> y ejecutar el programa resultante en su conjunto.  Si despu√©s de la ejecuci√≥n, <code>TRUE</code> permanece en la parte superior de la pila, entonces la transacci√≥n es v√°lida. <br><br><a name="P2PKH"></a><br><h4>  Pagar al hash de clave p√∫blica (P2PKH) </h4><br>  El script <code>P2PKH</code> usa en la mayor√≠a de las transacciones, por lo que debe comprender c√≥mo funciona.  Aqu√≠ est√° su visi√≥n general: <br><br><img src="https://habrastorage.org/webt/yc/l5/bz/ycl5bz9rlakm74fw8zztbhesnbm.png"><br><br>  Este script se conoce desde el advenimiento de Bitcoin, y realiza la tarea que se mencion√≥ al principio del cap√≠tulo: asegurarse de que solo el propietario de la clave pueda usar las monedas asociadas con la direcci√≥n obtenida de esta clave. <br><br>  La idea es esta: deje que su amigo <code>B</code> posea un par de claves: <code>P</code> (privado) y <code>K</code> (p√∫blico).  Usando la funci√≥n hash, obtiene la direcci√≥n <code>A</code> de la clave p√∫blica y le dice la direcci√≥n.  A continuaci√≥n, env√≠a, por ejemplo, <code>1 BTC</code> a la direcci√≥n <code>A</code> y escribe lo siguiente en el campo de <code>locking script</code> : <br><br><blockquote>  Solo alguien que posee la clave privada para la direcci√≥n <code>A</code> puede gastar esta transacci√≥n.  Como prueba, escriba en el <code>unlocking script</code> , en primer lugar, la clave p√∫blica <code>K</code> y, en segundo lugar, la firma de la transacci√≥n con la clave privada <code>P</code> <br></blockquote><br>  Cuando <code>B</code> decide utilizar su transacci√≥n como entrada, crear√° su, por ejemplo, <code>0.5 BTC</code> , y en el campo de <code>unlocking script</code> pondr√° la firma de su transacci√≥n con la clave privada <code>P</code> - <code>sig</code> y la clave p√∫blica K - <code>PubK</code> . <br><br>  Aqu√≠ est√° el proceso de ejecuci√≥n del programa combinado: <br><br><img src="https://habrastorage.org/webt/et/zx/tw/etzxtwxr3qihzwza6e43rrymdcs.png"><br><br><img src="https://habrastorage.org/webt/yj/bs/1n/yjbs1nuol2e6ut1rp_p9iifi9z4.png"><br><br><img src="https://habrastorage.org/webt/ia/eo/kb/iaeokbdrdznakoutfhiuu2m53xu.png"><br><br><img src="https://habrastorage.org/webt/ix/zh/v2/ixzhv2l0_qhjxgn55tjung8tyng.png"><br><br><img src="https://habrastorage.org/webt/3f/ah/zf/3fahzfikukod-rbz-29tufqlry8.png"><br><br><img src="https://habrastorage.org/webt/71/gf/2h/71gf2hcsfwo7eqtvmmmmdebz0pw.png"><br><br><img src="https://habrastorage.org/webt/yk/f_/b7/ykf_b7fyo6hplbhax7wolaukqrk.png"><br><br><h2>  Bloques y blockchain </h2><br>  Si toda la cadena de bloques es un libro, los bloques individuales se pueden representar como p√°ginas en las que se registran las transacciones.  Cada bloque "se refiere" al anterior, y as√≠ sucesivamente hasta el primer bloque ( <code>genesis block</code> ).  Esto es lo que crea una caracter√≠stica de blockchain como la inmutabilidad.  No puede tomar y cambiar el bloque <code>#123</code> para que nadie se d√© cuenta: la cadena de bloques est√° dise√±ada de tal manera que implicar√° un cambio en el bloque <code>#124</code> , luego en el <code>#125</code> y as√≠ sucesivamente. <br><br>  La estructura del bloque se ve as√≠: <br><br><img src="https://habrastorage.org/webt/bs/kp/3d/bskp3dzxovwwy4zx-s-pxzromgu.png"><br><br>  Los primeros seis par√°metros (todos excepto <code>txn_count</code> y <code>txns</code> ) forman el encabezado del bloque.  El hash de encabezado se llama hash de bloque;  Las transacciones en s√≠ mismas no participan directamente en el hash.  <code>merkle_root</code> es responsable de su inmutabilidad; si se simplifica, este es un hash de todas las transacciones en el bloque.  Puede leer m√°s sobre el algoritmo para construir el √°rbol Merkle aqu√≠ en este <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace</a> . <br><br>  Nonce y bits est√°n directamente relacionados con el proceso de aparici√≥n de bloques: miner√≠a. <br><br><h3>  Miner√≠a </h3><br>  La miner√≠a es un proceso cr√≠tico para Bitcoin, que consiste en crear nuevos bloques y perseguir dos objetivos a la vez.  El primero es la producci√≥n de oferta monetaria.  Cada vez que un minero crea un nuevo bloque, es recompensado por esto con la en√©sima cantidad de monedas que luego gasta en alg√∫n lugar, lanzando as√≠ nuevos fondos a la red. <br><br>  El segundo objetivo, y mucho m√°s importante, es controlar el cumplimiento de las reglas de la red.  Son los mineros quienes verifican los scripts y las entradas de transacciones antes de incluirlos en el bloque. <br><br>  Aquellos que deseen obtener m√°s informaci√≥n sobre los fundamentos financieros de Bitcoin pueden aconsejar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este art√≠culo</a> .  No prestar√© mucha atenci√≥n al primer aspecto de la miner√≠a y me concentrar√© en el segundo: verificar las transacciones y lanzarlas en la red. <br><br><h3>  Prueba de trabajo </h3><br>  Deja que seas minero.  Tiene 10 transacciones que desea incluir en el bloque.  Verifica la validez de estas transacciones, forma un bloque fuera de ellas, especifica 0 en el campo <code>nonce</code> y considera el hash del bloque.  Luego cambie <code>nonce</code> a 1, cuente el hash nuevamente. <br><br>  Su tarea es encontrar un <code>nonce</code> tal que el hash de bloque (n√∫mero de 256 bits) sea menor que un n√∫mero predeterminado <code>N</code>  La b√∫squeda de tal hash solo es posible a trav√©s de la fuerza bruta <code>nonce</code> .  Por lo tanto, cuanto m√°s r√°pido desee encontrar nonce, m√°s potencia necesitar√°. <br><br>  El n√∫mero <code>N</code> es exactamente ese par√°metro (tambi√©n se llama <code>target</code> ), que la red ajusta seg√∫n la potencia total de los mineros.  Si ma√±ana comienzan a salir bloques, en t√©rminos relativos, cada tres minutos, entonces se reducir√° <code>N</code> , se necesitar√° m√°s tiempo para buscar nonce y el <code>block time</code> aumentar√° nuevamente a 10 minutos.  Y viceversa. <br><br>  As√≠ es como se ve el algoritmo de Prueba de trabajo subyacente de Bitcoin y muchas otras cadenas de bloques.  Con aparente simplicidad, tiene una serie de caracter√≠sticas importantes: <br><br><ul><li>  Crear un nuevo bloque es una tarea computacionalmente dif√≠cil.  Al mismo tiempo, verificar que el bloque sea correcto es una operaci√≥n simple y casi instant√°nea. </li><li>  Toda la red tarda 10 minutos en calcular un nuevo bloque (en promedio).  El tiempo espec√≠fico es diferente para cada cadena de bloques, pero la conclusi√≥n es que el tiempo promedio est√° preestablecido.  Adem√°s, este tiempo no depende del n√∫mero de participantes de la red.  Incluso si alg√∫n d√≠a habr√° cien veces m√°s mineros, el algoritmo cambiar√° sus par√°metros para que sea m√°s dif√≠cil encontrar el <code>block time</code> y el <code>block time</code> vuelva a la proximidad del tiempo especificado. <br><br>  Como se describi√≥ anteriormente, el proceso de miner√≠a se reduce a encontrar un hash de bloque menor que un n√∫mero llamado <code>target</code> .  En la estructura de bloques, este n√∫mero se escribe en el campo de bits.  Por ejemplo, para el bloque <code>#277316 target</code> era <code>1903a30c</code> . </li></ul><br>  Como se describi√≥ anteriormente, el proceso de miner√≠a se reduce a encontrar un hash de bloque menor que un n√∫mero llamado <code>target</code> .  En la estructura de bloques, este n√∫mero se escribe en el campo de <code>bits</code> .  Por ejemplo, para el bloque <code>#277316</code> <code>target</code> era <code>1903a30c</code> . <br><br><pre> <code class="json hljs">$ bitcoin-cli getblock <span class="hljs-number"><span class="hljs-number">0000000000000001</span></span>b<span class="hljs-number"><span class="hljs-number">6</span></span>b<span class="hljs-number"><span class="hljs-number">9</span></span>a<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-number"><span class="hljs-number">3</span></span>b<span class="hljs-number"><span class="hljs-number">0</span></span><span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-number"><span class="hljs-number">5</span></span>e<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-number"><span class="hljs-number">6</span></span>db<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-number"><span class="hljs-number">1</span></span>c<span class="hljs-number"><span class="hljs-number">4</span></span>a<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">8</span></span>b<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-number"><span class="hljs-number">7</span></span>ef<span class="hljs-number"><span class="hljs-number">2</span></span>d<span class="hljs-number"><span class="hljs-number">9</span></span><span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-number"><span class="hljs-number">4</span></span>a<span class="hljs-number"><span class="hljs-number">9</span></span>b<span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-number"><span class="hljs-number">1</span></span>b<span class="hljs-number"><span class="hljs-number">2</span></span>cc<span class="hljs-number"><span class="hljs-number">7</span></span>bdc<span class="hljs-number"><span class="hljs-number">4</span></span> { <span class="hljs-attr"><span class="hljs-attr">"hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"0000000000000001b6b9a13b095e96db41c4a928b97ef2d944a9b31b2cc7bdc4"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"confirmations"</span></span> : <span class="hljs-number"><span class="hljs-number">35561</span></span>, <span class="hljs-attr"><span class="hljs-attr">"size"</span></span> : <span class="hljs-number"><span class="hljs-number">218629</span></span>, <span class="hljs-attr"><span class="hljs-attr">"height"</span></span> : <span class="hljs-number"><span class="hljs-number">277316</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span> : <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"merkleroot"</span></span> : <span class="hljs-string"><span class="hljs-string">"c91c008c26e50763e9f548bb8b2fc323735f73577effbc55502c51eb4cc7cf2e"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tx"</span></span> : [<span class="hljs-string"><span class="hljs-string">"d5ada064c6417ca25c4308bd158c34b77e1c0eca2a73cda16c737e7424afba2f"</span></span>, ...], <span class="hljs-attr"><span class="hljs-attr">"time"</span></span> : <span class="hljs-number"><span class="hljs-number">1388185914</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nonce"</span></span> : <span class="hljs-number"><span class="hljs-number">924591752</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bits"</span></span> : <span class="hljs-string"><span class="hljs-string">"1903a30c"</span></span>, // &lt;--   <span class="hljs-attr"><span class="hljs-attr">"difficulty"</span></span> : <span class="hljs-number"><span class="hljs-number">1180923195.25802612</span></span>, <span class="hljs-attr"><span class="hljs-attr">"chainwork"</span></span> : <span class="hljs-string"><span class="hljs-string">"000000000000000000000000000000000000000000000934695e92aaf53afa1a"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"previousblockhash"</span></span> : <span class="hljs-string"><span class="hljs-string">"0000000000000002a7bbd25a417c0374cc55261021e8a9ca74442b01284f0569"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"nextblockhash"</span></span> : <span class="hljs-string"><span class="hljs-string">"000000000000000010236c269dd6ed714dd5db39d36b33959079d78dfd431ba7"</span></span> }</code> </pre> <br>  En <code>bits</code> de hecho, se escriben dos n√∫meros a la vez: el primer byte <code>0x19</code> es el exponente, los tres bytes restantes <code>0x03a30c</code> son la mantisa.  Para obtener el <code>target</code> de <code>bits</code> , debe usar la siguiente f√≥rmula: <br><br><pre> <code class="python hljs">target = mantissa * <span class="hljs-number"><span class="hljs-number">2</span></span>^(<span class="hljs-number"><span class="hljs-number">8</span></span> * (exponent - <span class="hljs-number"><span class="hljs-number">3</span></span>))</code> </pre> <br>  Pero los <code>bits</code> , como regla, se indican en todos los registros de bloque en l√≠nea, como, por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://namecha.in/</a> - Registro de bloque de Namecoin. <br><br>  Y s√≠, suficiente teor√≠a.  Todo lo que mencionamos anteriormente cuando se aplica a Bitcoin se aplica igualmente a Namecoin, a excepci√≥n de las peque√±as diferencias, de las que hablaremos en la siguiente secci√≥n. <br><br><h2>  Namecoin </h2><br>  <i>Namecoin</i> es una cadena de bloques basada en los algoritmos y el c√≥digo fuente de Bitcoin, cuya idea principal es utilizar un esquema de registro de transacciones distribuidas para administrar un sistema de nombres de dominio, un an√°logo del DNS tradicional. <br><br>  Namecoin copia los enfoques b√°sicos de Bitcoin (Prueba de trabajo, intervalo de generaci√≥n de bloques de 10 minutos) y formatos de datos, con la excepci√≥n de peque√±as adiciones, de las que hablaremos m√°s adelante. <br><br>  Los dominios Namecoin tienen el sufijo .bit.  Esta zona no fue asignada por IANA y no fue asignada a la lista de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dominios de prop√≥sito especial</a> .  Los servidores DNS normales suelen responder a tales solicitudes NXDOMAIN.  Pero hay puertas de enlace de DNS a Namecoin (por ejemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OpenNIC</a> ), servidores proxy p√∫blicos con soporte de Namecoin, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">complementos de</a> navegador y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">un proyecto de c√≥digo abierto</a> que le permite iniciar su propio servidor DNS con soporte de Namecoin. <br><br>  Para administrar un dominio con el nombre, digamos, <code>facebook.bit</code> , es suficiente registrar la clave <code>d/facebook</code> prefijo <code>d/facebook</code> se usa en Namecoin para dominios) y determinar su valor.  El formato JSON se usa para establecer los valores.  Una entrada que establece la resoluci√≥n del dominio en la direcci√≥n IP <code>1.2.3.4</code> tiene este aspecto: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"ip"</span></span>: [<span class="hljs-string"><span class="hljs-string">"1.2.3.4"</span></span>]}</code> </pre> <br>  Namecoin asigna nombres por <i>orden de</i> llegada.  Incluso para el propio Mark Zuckerberg, ser√° criptogr√°ficamente imposible quitarle el dominio <code>facebook.bit</code> al propietario. <br><br>  De hecho, nada restringe el uso de Namecoin a solo administrar los paquetes de nombres DNS: la direcci√≥n IP.  Namecoin se puede usar (y usar) como una tabla distribuida para asignar claves arbitrarias a valores.  Pero nos concentraremos precisamente en el escenario de su uso en el que representa un DNS alternativo sobre blockchain. <br><br><h2>  Gesti√≥n de dominios </h2><br>  Namecoin utiliza una transacci√≥n para almacenar un registro de dominio.  A saber, el campo <code>scriptPubKey</code> contiene el programa es la condici√≥n para usar la salida de transacci√≥n, a la que dedicamos tanto tiempo en el cap√≠tulo anterior.  Para administrar registros, Namecoin introdujo tres nuevos operadores (m√°s precisamente, redefini√≥ los existentes): <br><br><ul><li>  NAME_NEW </li><li>  NAME_FIRSTUPDATE </li><li>  NAME_UPDATE </li></ul><br>  Su significado es claro a partir de los nombres, pero sin embargo analizaremos el prop√≥sito y el formato de uso de cada uno de ellos. <br><br>  Puede notar que falta el operador de eliminaci√≥n o invalidaci√≥n de dominio.  Para limpiar el registro de los nombres no utilizados, se ha incorporado un mecanismo en la red que libera autom√°ticamente un nombre que no se ha actualizado durante 36,000 bloques (~ 250 d√≠as). <br><br><h3>  NAME_NEW </h3><br>  El primer paso es anunciar la intenci√≥n de registrar un nuevo nombre en la red.  Para hacer esto, solo cree una moneda especial (salida) que pese al menos <code>0.01 NMC</code> , cuyo <code>output script</code> se ver√° m√°s o menos as√≠: <br><br><pre> <code class="xml hljs">OP_NAMENEW <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">20</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">byte</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">hash</span></span></span><span class="hljs-tag">&gt;</span></span> OP_2DROP <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Para demostrarlo, utilizar√© las transacciones que hizo Stephen Morse para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ilustrar su art√≠culo</a> . <br><br>  Entonces, si queremos anunciar el registro del nombre <code>d/stephenmorse</code> , debemos hacer lo siguiente: <br><br><img src="https://habrastorage.org/webt/q9/br/b8/q9brb8jrft9fyzc1vc2ph0ssade.png"><br><br>  Al observar la transacci√≥n resultante, puede observar dos hechos interesantes.  En primer lugar, a pesar de que el <code>output script</code> escrito en notaci√≥n Namecoin, sigue siendo v√°lido desde el punto de vista del Bitcoin original.  Los creadores de Namecoin han elegido c√≥digos con tanto √©xito para sus operaciones que en Bitcoin corresponden a operaciones que son esencialmente equivalentes a escribir en la pila constante.  <code>NAME_NEW (0x51)</code> corresponde a <code>OP_1</code> , que empuja <code>OP_1</code> pila 1. Una historia similar con <code>NAME_FIRSTUPDATE</code> ( <code>0x52</code> u <code>OP_2</code> , pone 2) y con <code>NAME_UPDATE</code> ( <code>0x53</code> u <code>OP_3</code> , pone 3).  Entonces, los primeros dos pasos del script solo ponen dos valores en la pila.  Y la siguiente operaci√≥n <code>OP_2DROP</code> elimina de la pila, de modo que m√°s <code>P2PKH</code> funciona "desde cero".  Por lo tanto, todos esos trucos de script que cubrimos en el cap√≠tulo sobre Bitcoin tambi√©n son aplicables a Namecoin, a pesar de la redefinici√≥n de algunas operaciones. <br><br>  En segundo lugar, las teclas que abren una moneda especial y cambian son diferentes.  Aunque t√©cnicamente nada le impide usar la misma clave repetidamente, es una pr√°ctica com√∫n generar una nueva clave para cada recibo.  Esto se hace para dificultar la identificaci√≥n de correlaciones entre transacciones y aumentar el nivel de anonimato en la red. <br><br>  A primera vista, parece extra√±o que, al contrario del sentido com√∫n, es imposible tomar y registrar de inmediato un nombre m√°s una direcci√≥n IP.  Esto se hace para que nadie pueda interceptar el nombre tan pronto como vea que desea registrarlo (y luego revenderlo). <br><br>  Por ejemplo, los mineros, al analizar transacciones no confirmadas (a√∫n no incluidas en ninguno de los bloques) en la red, podr√≠an crear su propia transacci√≥n para el registro del mismo dominio e incluirla (y no la suya) en su bloque.  Para implementar este ataque, ni siquiera es necesario extraer tu bloque.  Ser√° suficiente para poner su transacci√≥n en la red con una tarifa grande.  Por lo tanto, <code>NAME_FIRSTUPDATE</code> dos operaciones separadas <code>NAME_NEW</code> y <code>NAME_FIRSTUPDATE</code> , y la segunda solo puede realizarla la persona que realiz√≥ la primera, y solo despu√©s de que <code>NAME_NEW</code> entre en cualquier bloque. <br><br>  De hecho, esta restricci√≥n es incluso un poco m√°s estricta: <code>NAME_FIRSTUPDATE</code> es posible no antes de 12 bloques despu√©s de <code>NAME_NEW</code> (que es aproximadamente 2 horas).  Para comprender por qu√© los bloqueos en esta restricci√≥n no son 1, ni 2, ni 3, sino espec√≠ficamente 12, tendremos que retroceder un poco de la historia principal y descubrir qu√© son <code>fork</code> y <code>51% attack</code> . <br><br><div class="spoiler">  <b class="spoiler_title">Tenedor</b> <div class="spoiler_text">  Imagine que los mineros est√°n buscando el bloque <code>#123456</code> .  Y casi al mismo tiempo, fue encontrado independientemente por dos mineros, uno de los cuales vive en Australia y el otro en los Estados Unidos.  Cada uno de ellos comienza a dispersar su versi√≥n del bloque a trav√©s de la red, y como resultado resulta que la mitad del mundo tiene una cadena de bloques y la otra tiene otra. <br><br><img src="https://habrastorage.org/webt/ov/a1/yq/ova1yqiulayufd1o7z6vbmwpb0e.png"><br><br>  ¬øEs esto posible?  Si es posible.  Adem√°s, esto sucede con bastante frecuencia.  En este caso, cada nodo contin√∫a adhiri√©ndose a su propia versi√≥n de la cadena de bloques hasta que alguien encuentre el siguiente bloque.  Suponga que el nuevo bloque contin√∫a la rama verde, como en la imagen a continuaci√≥n.  En este caso, los nodos que se adhieren a la versi√≥n roja sincronizan autom√°ticamente la versi√≥n verde, porque la regla funciona en Bitcoin (y, en consecuencia, en Namecoin): la versi√≥n m√°s larga de blockchain es verdadera.  La versi√≥n roja de la cadena de bloques simplemente se olvidar√°, junto con las recompensas para aquellos que la encuentren. <br><br><img src="https://habrastorage.org/webt/br/le/xq/brlexqeynpgyq5qjq6u0knjla5q.png"><br><br>  Por supuesto, te√≥ricamente, en el segundo paso, la situaci√≥n puede repetirse y al mismo tiempo con p√∫rpura encontrar√°n otra que continuar√° con la versi√≥n roja de la cadena de bloques.  Y en el tercero, y as√≠ sucesivamente.  Pero la probabilidad de incluso la primera bifurcaci√≥n es bastante peque√±a, la segunda es a√∫n menor y as√≠ sucesivamente.  La bifurcaci√≥n m√°s larga en la historia de Bitcoin fue de solo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cuatro bloques</a> .  Entonces, en alg√∫n momento, una de las ramas se abrir√° paso, y toda la red ir√° a ella. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">51% de ataque</b> <div class="spoiler_text">  El hecho de que la cadena m√°s larga en la cadena de bloques sea dominante se basa en un ataque que lleva el nombre del 51%. <br><br>  Imagine que es un estafador y compra productos a <code>1000 BTC</code> en una tienda.  Usted est√° de acuerdo con el vendedor y le env√≠a el dinero.  El vendedor verifica la cadena de bloques, ve que tal transacci√≥n realmente fue, pas√≥ todas las verificaciones e incluso entr√≥ en alg√∫n bloque, por ejemplo <code>#123</code> .  Despu√©s de eso, el vendedor va al correo y le env√≠a la mercanc√≠a. <br><br>  En este momento, enciende su granja minera y comienza a minar, comenzando desde el bloque <code>#122</code> .  Si tiene suficiente potencia, puede adelantar al resto de la red y contar el m√°s r√°pido para bloquear <code>#124</code> , despu√©s de lo cual todo el mundo cambiar√° a su versi√≥n de blockchain.  Al mismo tiempo, no incluir√° su transacci√≥n por <code>1000 BTC</code> en ninguno de los bloques, lo que significa que se olvidar√° para siempre, como si nunca lo hubiera sido.          . <br><br>         ,          .      .   11   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a>  , ,     6  ,      0,1%    ,    10% .        ,         . ,  Namecoin      ,     20%  . <br><br>       . ,        .    ,  <code>NAME_NEW</code> ,  12 ,       <code>NAME_FIRSTUPDATE</code> . <br></div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NAME_FIRSTUPDATE </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El prop√≥sito de la operaci√≥n </font></font><code>NAME_FIRSTUPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es publicar el nombre que anunci√© </font></font><code>NAME_NEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y especificarle un valor. </font><font style="vertical-align: inherit;">Para hacer esto, necesito iniciar una transacci√≥n en la red, cuya entrada es la moneda muy especial que gener√© en la salida </font></font><code>NAME_NEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Para confirmar el derecho a usarlo, presento en el script de entrada mi clave p√∫blica y la firma de la transacci√≥n </font></font><code>NAME_NEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">realizada por la clave de par privado, exactamente de acuerdo con el esquema que examinamos en el cap√≠tulo sobre </font></font><code>P2PKH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uno de los resultados de la transacci√≥n ser√° una nueva moneda especial que pese, como la anterior, nada menos </font></font><code>0.01 NMC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Su script de salida deber√≠a ser as√≠:</font></font><br><br><pre> <code class="xml hljs">OP_NAME_FIRSTUPDATE <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Salt</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Value</span></span></span><span class="hljs-tag">&gt;</span></span> OP_2DROP OP_2DROP <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> <code>Salt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es el n√∫mero muy aleatorio </font></font><code>0xd5eeb22ee8117f57</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que creamos en la primera etapa de preparaci√≥n del gui√≥n </font></font><code>NAME_NEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><code>Name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- es </font></font><code>d/stephenmorse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en hexadecimal </font></font><code>0x642f7374657068656e6d6f727365</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El campo </font></font><code>Value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">debe contener una matriz asociativa que represente las reglas mediante las cuales se resolver√° el nombre. Una lista completa de posibles claves y reglas para completarlas </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En una primera aproximaci√≥n, este es un an√°logo del archivo de zona; el enlace de arriba muestra la asignaci√≥n de entidades Namecoin a entidades DNS familiares. Los m√°s populares son ip, un ejemplo con el que era m√°s alto, y ns, que usamos ahora. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para indicar cu√°l ser√° el servidor NS para el dominio, pondremos </font></font><code>1.2.3.4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un valor en Value </font></font><code>{‚Äúns‚Äù:[‚Äú1.2.3.4‚Äù]}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero, por supuesto, en hexadecimal - </font></font><code>0x7b226e73223a5b22312e322e332e34225d7d</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como la √∫ltima vez, cierre la moneda con </font></font><code>P2PKH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En su ejemplo, Stephen cre√≥ deliberadamente una moneda en el paso NAME_NEW con un peso no exactamente </font></font><code>0.01 NMC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, pero con un margen, de modo que en el siguiente paso este margen ser√≠a suficiente para la comisi√≥n al minero. </font><font style="vertical-align: inherit;">En el caso general, la transacci√≥n tendr√° una entrada m√°s para garantizar la comisi√≥n y una salida m√°s para la entrega. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recopilamos todo en una transacci√≥n y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lanzamos </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">a la red</font></a><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/nn/rt/cd/nnrtcdedqwwblvhs_wsdawyivpg.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando la transacci√≥n cae en el bloque, los hosts actualizar√°n en sus tablas el valor de la clave </font></font><code>d/stephenmorse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">activada </font></font><code>{‚Äúns‚Äù:[‚Äú1.2.3.4‚Äù]}</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Todos los navegadores con soporte de Namecoin ahora resolver√°n el dominio </font></font><code>stephenmorse.bit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y sus subdominios a direcciones IP a trav√©s del servidor DNS ubicado en </font></font><code>1.2.3.4</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> NAME_UPDATE </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La "tabla" con claves y sus significados, que mencion√© al final de la √∫ltima secci√≥n, en realidad se llama </font></font><code>UTXO set (unspent transaction output)</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Dado que es fundamental que la red evite el gasto repetido de fondos, antes de agregar una transacci√≥n al bloque, el minero verifica si se usaron las entradas especificadas previamente en la transacci√≥n. Para acelerar esta operaci√≥n, todas las salidas no utilizadas se almacenan en una estructura de datos separada. Esta estructura no existe a nivel de red, pero cada nodo la calcula y almacena localmente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Despu√©s de completar la transacci√≥n </font></font><code>NAME_FIRSTUPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, la salida de mi moneda con un peso </font></font><code>0.01 NMC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, al que se adjunta el valor de la clave </font></font><code>d/stephenmorse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, golpe√≥ la mesa</font></font><code>UTXO</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Si esta salida no se gasta en 36,000 bloques (que es m√°s de 8 meses con 10 minutos por bloque en promedio), se considerar√° no v√°lida y el nombre correspondiente ser√° gratuito. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este per√≠odo de 36,000 bloques (as√≠ como el valor m√≠nimo de una moneda especial en </font></font><code>0.01 NMC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) est√° claramente definido al inicio de la red y no cambia. Para extender el registro del nombre, as√≠ como para cualquier cambio en el registro o transferirlo a otro propietario, se utiliza una transacci√≥n </font></font><code>NAME_UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las reglas para la formaci√≥n de tal transacci√≥n pr√°cticamente no difieren de las descritas anteriormente. La entrada para la transacci√≥n debe ser la salida de la moneda obtenida en la transacci√≥n.</font></font><code>NAME_FIRSTUPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Se necesita una entrada adicional para garantizar la comisi√≥n. </font><font style="vertical-align: inherit;">De las dos salidas de la transacci√≥n, una es una moneda nueva con un valor actualizado para el nombre, y la segunda est√° dise√±ada para transferir el cambio de la comisi√≥n. </font><font style="vertical-align: inherit;">El formato del script de salida para la moneda es:</font></font><br><br><pre> <code class="xml hljs">OP_NAME_UPDATE <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Value</span></span></span><span class="hljs-tag">&gt;</span></span> OP_2DROP OP_DROP <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lock</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como en el caso anterior, </font></font><code>Name</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">esto es </font></font><code>d/stephenmorse</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, y </font></font><code>Value</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- JSON con un valor, ambos en hexadecimal. </font><font style="vertical-align: inherit;">Cierre la salida con P2PKH y lance la transacci√≥n </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a la red</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/ny/2t/vq/ny2tvqbgf2fhkaiebkx2b9_fdkc.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En general, esto es casi todo lo que quer√≠a contar sobre la gesti√≥n de nombres en Namecoin. </font><font style="vertical-align: inherit;">Todo lo que queda es decir algunas palabras sobre los costos de poseer un dominio.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Costo </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Calculemos cu√°nto cuesta el contenido del nombre </font></font><code>Dot-Bit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(el nombre de la zona DNS .bit, que opera sobre la base de Namecoin) en criptomoneda y, traduciendo los n√∫meros a moneda fiduciaria, es comparable al costo de un dominio DNS "normal". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entonces, como se puede ver en la secci√≥n anterior, para una transacci√≥n, los </font></font><code>NAME_NEW</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">costos del propietario del dominio ser√°n </font></font><code>0.01 NMC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">crear una moneda a la que se adjuntar√° la zona, m√°s la comisi√≥n del minero. Para una transacci√≥n, </font></font><code>NAME_FIRSTUPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se crea </font><font style="vertical-align: inherit;">una </font><font style="vertical-align: inherit;">nueva moneda a expensas de la antigua, y adem√°s el propietario paga solo la comisi√≥n. Despu√©s de aproximadamente 8 meses, el propietario tendr√° que completar la transacci√≥n </font></font><code>NAME_UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para conservar el nombre registrado. Y aqu√≠ es donde los costos requeridos para el primer a√±o finalizan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La mayor√≠a de los art√≠culos sobre Namecoin (incluido el </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">art√≠culo</font></a><font style="vertical-align: inherit;"> citado anteriormente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">por Stephen Morse</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) se basan en datos de los primeros a√±os de existencia de la red y afirman que la comisi√≥n del minero es de 0.005 NMC. Pero desde entonces, el valor medio de la comisi√≥n ha disminuido gradualmente y a principios de 2019 </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">es de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aproximadamente 0,0003 NMC. El tipo de cambio NMC frente al d√≥lar estadounidense, por el contrario, despu√©s de haber sufrido varias alzas, volvi√≥ al nivel de 2015 y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">asciende a</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alrededor de $ 0.7 por 1 NMC. Es f√°cil calcular que el dominio en la zona .bit en el primer a√±o le costar√° al propietario de 0.0109 NMC o $ 0.00763. Quiz√°s sea m√°s f√°cil para alguien recordar un an√°logo aproximado de esta cantidad en moneda rusa: 50 kopeks.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bueno, este es el l√≠mite inferior que coincide con el escenario para comprar un nombre para uso futuro o ciberocupaci√≥n. ¬øQu√© pasa con el l√≠mite superior? Dado que la entrada de cada transacci√≥n que actualiza la zona debe ser una moneda de uno de los bloques anteriores, el m√°ximo te√≥rico de la frecuencia de actualizaci√≥n del nombre es igual a la frecuencia de aparici√≥n de nuevos bloques. Recordando que el valor promedio de este valor se estableci√≥ al inicio de la red y es de aproximadamente 10 minutos, se puede estimar que el l√≠mite superior del costo de mantener un dominio ser√° 15.7744 NMC o un poco m√°s de $ 11.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como puede ver, incluso un escenario tan fant√°stico de usar un nombre en Namecoin a un costo es aproximadamente equivalente al primer a√±o de poseer un dominio regular en la zona .com m√°s popular. Si comparamos un escenario m√°s realista con una actualizaci√≥n en promedio una vez al d√≠a, entonces el nombre en la zona .bit costar√° alrededor de 8 centavos al a√±o, que es un orden de magnitud m√°s barato que las ofertas m√°s ventajosas en el DNS tradicional, que no caen por debajo de $ 1. En el escenario de uso a corto plazo del dominio (de varias horas a un mes), la diferencia a favor de Namecoin ya ser√° de dos √≥rdenes de magnitud.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Teniendo en cuenta el atractivo financiero del servicio, as√≠ como el anonimato del propietario del dominio, incluida la falta de un "rastro de dinero" tradicional para el DNS ordinario, queda claro por qu√© Namecoin se ha convertido en una red popular para los propietarios de servicios con un mayor riesgo de desconexi√≥n o bloqueo, en particular botnets. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Botnets en Namecoin </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">De hecho, el hecho de que los operadores de botnets comenzaron a usar el anonimato </font></font><code>Dot-Bit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para proteger sus servidores de C&amp;C no es sorprendente. Otra cosa es m√°s interesante: cu√°nto tiempo permanecen activas las botnets en .bit. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Los dominios C&amp;C registrados en zonas DNS "ordinarias" se retiran tarde o temprano del propietario, lo que obliga al operador a pagar por registrar un nuevo nombre y lanzar un nuevo conjunto de bot en la red, con un nuevo servidor de administraci√≥n. La imposibilidad fundamental de eliminar un dominio en la zona .bit aument√≥ la vida √∫til de la botnet en √≥rdenes de magnitud. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tomemos, por ejemplo, el </font></font><code>pationare.bit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dominio registrado en diciembre de 2016. Fue utilizado para controlar una botnet </font></font><code>Chthronic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(distribuyendo un troyano bancario construido sobre la base del famoso ZeuS). Campa√±a de distribuci√≥n</font></font><code>Chthronic</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se asoci√≥ con el uso del paquete de exploits RIG y fue descrito en detalle por varios investigadores (por ejemplo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">malware-traffic-analysis.net</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) a fines de 2016 y la primera mitad de 2017. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se podr√≠a suponer que esta botnet fue destruida hace mucho tiempo. Pero no: m√°s de dos a√±os despu√©s del lanzamiento, el dominio C&amp;C de la botnet y su red a√∫n est√°n activos. Como se puede ver en la captura de pantalla a continuaci√≥n, la √∫ltima actualizaci√≥n se realiz√≥ en diciembre de 2018.</font></font><br><br><img src="https://habrastorage.org/webt/9k/o9/5w/9ko95wbszt4g7fqntkxm0cnh34u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se ve tentador, ¬øverdad? Dado que el nombre DNS del servidor de administraci√≥n permanece intacto, no es necesario actualizar con frecuencia el c√≥digo bot y reiniciar la campa√±a de distribuci√≥n. Solo queda el costo de cambiar el alojamiento despu√©s de bloquear la direcci√≥n IP, pero estos costos tambi√©n se pueden reducir mediante el uso de servidores web pirateados como servidores proxy, cuyos costos cuestan menos de un d√≥lar.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por otro lado, todas las transacciones en la cadena de bloques est√°n disponibles p√∫blicamente para cualquier participante. </font><font style="vertical-align: inherit;">Como discutimos en detalle en cap√≠tulos anteriores, las monedas en Namecoin no desaparecen sin dejar rastro, lo que significa que podemos rastrear su redistribuci√≥n entre direcciones. </font><font style="vertical-align: inherit;">Y conociendo las reglas y restricciones, teniendo en cuenta qu√© transacciones se forman en Namecoin, podemos encontrar patrones significativos en los que la gesti√≥n uniforme de algunas direcciones involucradas en la transacci√≥n ser√° obvia. </font><font style="vertical-align: inherit;">En este caso, los dominios pagados con monedas de estas direcciones tendr√°n un propietario com√∫n: el grupo que administramos, que controla la botnet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desarrollaremos m√°s esta idea.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Esquema general de cobro del COI </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Describamos el esquema de b√∫squeda general usando el ejemplo de una botnet real del grupo RTM. Nos basaremos en esta </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muestra</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que se identific√≥ como </font></font><code>Win32/Spy.RTM.N</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/webt/9r/rx/tq/9rrxtqepv4ods_wcbibv-2hk9uk.png"><br><br><img src="https://habrastorage.org/webt/ps/by/dk/psbydk2cmnsifuf5cf8njpmnnvm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como puede ver en la captura de pantalla anterior, despu√©s de comenzar, intenta obtener la direcci√≥n IP para el nombre </font></font><code>stat-counter-4.bit</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Obtenemos </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">informaci√≥n</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre el historial de transacciones de este nombre en Namecoin. </font></font><br><br><img src="https://habrastorage.org/webt/ok/jj/aj/okjjajszmlcuj_8enwzkosbze6k.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El identificador de la transacci√≥n que cre√≥ este dominio, lo obtenemos haciendo clic en el enlace a la operaci√≥n NAME_NEW. La direcci√≥n de entrada de esta transacci√≥n, con la ayuda de la cual se cre√≥ el dominio, obviamente es administrada por el grupo que nos interesa. √âl ser√° el conjunto inicial de datos: </font></font><code>N3KPt8py24EAsAiKquyFgoKGyTYeR5Tmry</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><img src="https://habrastorage.org/webt/-k/si/6n/-ksi6n9mz69t-tscu-cpyilewpa.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seg√∫n el conjunto de datos inicial, recorrimos iterativamente la cadena de bloques, movi√©ndonos en la direcci√≥n de su crecimiento (movimiento ascendente o movimiento ascendente). Al comienzo de cada paso, obtenemos una transacci√≥n, cuya moneda en la entrada pertenece a la persona que nos interesa. En el primer paso, verificamos la transacci√≥n del conjunto de datos inicial, el propietario de las monedas en la entrada de las cuales sabemos a priori.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se verifica el cumplimiento de la transacci√≥n con las reglas heur√≠sticas (las formularemos a continuaci√≥n), que garantizan que cierta moneda (o monedas) a la salida de la transacci√≥n pertenece a la misma persona que la moneda de entrada conocida. Si la transacci√≥n en cuesti√≥n satisface una o m√°s heur√≠sticas, entonces dichas monedas indicadoras indicar√°n la direcci√≥n de un movimiento adicional. La transacci√≥n que gasta la moneda gu√≠a ser√° el siguiente paso en la iteraci√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cada paso de la iteraci√≥n, reponemos la lista de dominios que participaron en las transacciones y la lista de direcciones IP en las que se resolvieron estos dominios. Estos son identificadores hist√≥ricos de compromiso (COI), que pueden utilizarse para forenses, as√≠ como para identificar t√°cticas y m√©todos de agrupaci√≥n.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El movimiento se detiene si la transacci√≥n en cuesti√≥n no satisface ninguna de las heur√≠sticas. Esto significa que no podemos decir con certeza que cualquiera de los resultados de la transacci√≥n en cuesti√≥n est√© controlada por la persona que nos interesa. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Otra situaci√≥n que detiene el movimiento es la falta de transacciones desde la direcci√≥n de salida. Guardaremos dichas direcciones en una lista separada de monedas no gastadas (UTXO). Representan el mayor valor en todo el estudio. Dado que confiamos en que estas direcciones son administradas por la persona que nos interesa, cualquier transacci√≥n futura que use estas direcciones generar√° un IOC nuevo y previamente desconocido, el nombre de dominio o la direcci√≥n IP, que a√∫n no ha sido utilizado por la agrupaci√≥n. Pero con alta probabilidad ser√° pronto.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para evitar la cadena de bloques, es conveniente exportarla a la base de datos. Para esto, puede usar, por ejemplo, la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilidad</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> modificada </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">oxidado-blockparser</font></a><font style="vertical-align: inherit;"> , en la cual mejoramos el soporte para Namecoin agregando reconocimiento de operaciones </font></font><code>NAME_*</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, estructuras de datos </font></font><code>Auxiliary Proof-of-Work</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y expandiendo el formato de exportaci√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El pseudoc√≥digo de Python para el movimiento ascendente se presenta a continuaci√≥n. En lo sucesivo, se supone que los datos de transacci√≥n de blockchain se almacenan en MongoDB.</font></font><br><br><pre> <code class="python hljs">start = <span class="hljs-string"><span class="hljs-string">"37d40bc2f3ca7415908dc9e276593b50d3120158cd540cb088246f2e2cf88b16"</span></span> tx = namecoin.transactions.find_one({<span class="hljs-string"><span class="hljs-string">"id"</span></span>: start}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">upstream_movement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tx)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> names <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> IPs <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> utxo <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> known_addresses heuristic_result = upstream_heuristic_test(tx) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> heuristic_result <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> heuristic_result.guiding_outs: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> tx.has_name_op(): names.add(tx.name_op.name) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ip_address <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tx.name_op.get_ip(): IPs.add(ip_address) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> guiding_out <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> heuristic_result.guiding_outs: known_addresses.add(guiding_out.address) tx = namecoin.transactions.find_one({<span class="hljs-string"><span class="hljs-string">"in.id"</span></span>: guiding_out.id}) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> tx: upstream_movement(tx) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: utxo.add(guiding_out)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La segunda parte del bypass de blockchain es el movimiento contra el crecimiento de blockchain (movimiento hacia abajo o hacia abajo). En general, el algoritmo de movimiento hacia abajo no es diferente del algoritmo hacia arriba. Un movimiento comienza con una transacci√≥n del conjunto de datos original. En cada paso, se verifica el cumplimiento de la transacci√≥n con las reglas heur√≠sticas (en general, diferentes de las reglas para el movimiento ascendente). La √∫nica diferencia es que la moneda, cuya membres√≠a se conoce a priori, est√° a la salida de la transacci√≥n, y la heur√≠stica garantiza que la misma persona tiene una o m√°s monedas en la entrada.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un movimiento hacia abajo tambi√©n se detiene si la transacci√≥n actual no satisface ninguna de las heur√≠sticas. </font><font style="vertical-align: inherit;">A diferencia del movimiento hacia arriba, no podemos encontrar monedas no gastadas entre las gu√≠as, y esta opci√≥n para salir de la recursi√≥n en el movimiento hacia abajo no funcionar√°. </font><font style="vertical-align: inherit;">Pero, al igual que con el movimiento ascendente, reponemos tanto la lista de nombres como la lista de direcciones IP. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El pseudoc√≥digo de Python para el movimiento descendente se ver√≠a as√≠:</font></font><br><br><pre> <code class="python hljs">start = <span class="hljs-string"><span class="hljs-string">"37d40bc2f3ca7415908dc9e276593b50d3120158cd540cb088246f2e2cf88b16"</span></span> tx = namecoin.transactions.find_one({<span class="hljs-string"><span class="hljs-string">"id"</span></span>: start}) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">downstream_movement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tx)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> names <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> IPs <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> utxo <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> known_addresses heristic_result = downstream_heuristic_test(tx) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> heuristic_result <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> heuristic_result.guiding_ins: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> tx.has_name_op(): names.add(tx.name_op.name) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ip_address <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tx.name_op.get_ip(): IPs.add(ip_address) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> guiding_in <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> heuristic_result.guiding_ins: known_addresses.add(guiding_in.address) tx = namecoin.transactions.find_one({<span class="hljs-string"><span class="hljs-string">"out.id"</span></span>: guiding_in.id}) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> tx: downstream_movement(tx)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ahora considere las reglas heur√≠sticas que usaremos al movernos por la cadena de bloques. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reglas heur√≠sticas </font></font></h2><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cambio com√∫n </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Veamos nuevamente la transacci√≥n, cuya captura de pantalla se muestra arriba. Se env√≠a una direcci√≥n que </font></font><code>N3KPt8py24EAsAiKquyFgoKGyTYeR5Tmry</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contiene dinero para crear un nuevo nombre </font><font style="vertical-align: inherit;">a la entrada de la transacci√≥n </font><font style="vertical-align: inherit;">. Habr√° </font><font style="vertical-align: inherit;">dos direcciones </font><font style="vertical-align: inherit;">para las transacciones </font></font><code>NAME_FIRSTUPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>NAME_UPDATE</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en la entrada: una moneda especial con una zona de la transacci√≥n anterior por dominio y fondos adicionales para cubrir la comisi√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notar√© de inmediato que, en el contexto de las transacciones, hablaremos tanto de monedas como de direcciones. A pesar de que en algunos trabajos estos conceptos se consideran casi equivalentes, es importante que indiquemos claramente la diferencia entre estos t√©rminos, ya que en el curso del estudio sacaremos conclusiones sobre las monedas y las direcciones.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al decir "moneda", nos referiremos a un saldo positivo formado como el resultado de una transacci√≥n. Esta moneda se identifica por el n√∫mero de transacci√≥n que la gener√≥ y el √≠ndice de salida. Por ejemplo, una moneda en la entrada de la transacci√≥n considerada anteriormente tiene un identificador </font></font><code>5778be8e1901e9931e9b41a128a0b7f963e6e1ae72e461df2cba26e6279d433a:1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ya que se form√≥ como una salida (con √≠ndice 1) de la transacci√≥n </font></font><code>5778be8e1901e9931e9b41a128a0b7f963e6e1ae72e461df2cba26e6279d433a</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una moneda especial, como antes, llamaremos una moneda con un valor nominal de b </font></font><code>0.01 NMC</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font><code>locking script</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que contiene la operaci√≥n con un nombre de dominio. Examinamos en detalle el mecanismo para la formaci√≥n de tales monedas en la secci√≥n de Gesti√≥n de Dominios. Una moneda ordinaria que llamaremos una moneda de denominaci√≥n arbitraria, a la que la operaci√≥n con el dominio no est√° vinculada.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La propiedad principal de las monedas es su inmutabilidad. Cualquier moneda se puede gastar solo una vez y solo en su totalidad. Por lo tanto, cualquiera se menciona en la red Namecoin un m√°ximo de dos veces: una vez en la creaci√≥n y una segunda vez en el gasto. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al decir "direcci√≥n", nos referiremos a un identificador que identifica de forma exclusiva un par de claves que puede abrir un script de bloqueo en un formato </font></font><code>P2PKH</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que cierra una moneda ubicada en la entrada o salida de una transacci√≥n. Dado que solo la clave correspondiente a la direcci√≥n puede gastar una moneda, la analog√≠a m√°s cercana del mundo f√≠sico a la direcci√≥n es la billetera en la que se almacenan las monedas (y de las cuales se gastan).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A pesar de que en Namecoin, una direcci√≥n a menudo tambi√©n se usa solo dos veces, no es necesario recibir y consumir una sola moneda. Los hechos de reutilizar direcciones nos ayudar√°n un poco en el futuro. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hablamos con m√°s detalle sobre entradas, salidas y direcciones en el cap√≠tulo de Bitcoin 201. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entonces, se forman dos monedas a la salida de la transacci√≥n. La </font></font><code>N2hgZoWaTKoJ7FPmLuytTow3XrCCfEj2ca</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">misma moneda especial, con un peso de 0.01 NMC, a la que est√° vinculado el dominio, fue a la </font><font style="vertical-align: inherit;">direcci√≥n </font><font style="vertical-align: inherit;">. Se </font></font><code>NKMMLwyMw4nwGuke6vd3AuDBMP18FWRaF1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">envi√≥ una moneda ordinaria con cambio a la </font><font style="vertical-align: inherit;">segunda direcci√≥n </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este es el esquema de transacci√≥n m√°s com√∫n. Todav√≠a hay opciones cuando hay m√°s de una moneda en la entrada, pero su propiedad com√∫n es que la moneda con cambio siempre es exactamente la misma.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede adivinar que dicha transacci√≥n corresponde a una simple actualizaci√≥n de la informaci√≥n del dominio. El pago de la actualizaci√≥n se realiza utilizando una (menos frecuentemente varias) monedas pertenecientes a una persona. De hecho, dado que una transacci√≥n siempre tiene un solo autor, debe administrar todas las direcciones de entrada. Sin esto, no podr√° crear un script de desbloqueo, que es necesario para usar las monedas de esta billetera. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bueno, dado que todo el cambio de esta operaci√≥n se recoge en una moneda, est√° claro que esta moneda pertenece a la misma persona que las monedas en la entrada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un esquema similar para Bitcoin se describe en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este trabajo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donde se llama </font></font><code>one-time change</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Refleja el m√©todo por el cual las aplicaciones nativas de Bitcoin realizan transacciones, </font></font><code>bitcoind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y</font></font><code>bitcoin-qt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Se llama una sola vez (una vez) debido a otra caracter√≠stica de estas aplicaciones. Por defecto, generan nuevas direcciones para monedas en la salida de la transacci√≥n creada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Namecoin, junto con la base de c√≥digo de Bitcoin, ha heredado la mayor parte del c√≥digo de estas aplicaciones, que se denominan </font></font><code>namecoind</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font><code>namecoin-qt</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Con respecto a las monedas ordinarias, podemos usar esta heur√≠stica de manera segura sin ning√∫n cambio.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las estad√≠sticas de reutilizaci√≥n de direcciones para almacenar monedas especiales muestran que esta regla tambi√©n se observa en la mayor√≠a de los casos. La reutilizaci√≥n de tales direcciones es bastante rara. Direcciones utilizadas m√°s de una vez, aproximadamente el 6% del total; m√°s de dos veces, alrededor del 1%. Basado en el prop√≥sito de Namecoin, parece razonable suponer que la mayor√≠a de las transacciones con monedas especiales en la red son simples operaciones de creaci√≥n y actualizaci√≥n, durante las cuales el propietario del dominio no cambia. Por lo tanto, podemos argumentar que dicha operaci√≥n corresponde al retiro de una moneda especial a una nueva direcci√≥n, previamente no utilizada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ahora veamos un ejemplo de una transacci√≥n con una direcci√≥n reutilizada para una moneda de salida especial. Para hacer esto, tome otra transacci√≥n del grupo RTM:</font></font><code>b3c7ce9ca3a689c6236b9d6df3c257c5fab6c3985187669ccf731ac42a127a11</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/webt/em/d6/hx/emd6hxidz3xhgqny_f5e7ho5-04.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La direcci√≥n </font></font><code>NDpWDEx1mBkUYywqxDTAZZeGCfUV4GkVE8</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a la que se dirigi√≥ la moneda especial ya se us√≥ en transacciones anteriores. </font></font><br><br><img src="https://habrastorage.org/webt/ws/32/00/ws3200wv6hvjc1z63vt4p1hdivs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como se mencion√≥ anteriormente, los scripts predeterminados en las aplicaciones cliente nativas para Namecoin no dan como resultado la reutilizaci√≥n de direcciones. Para enviar una moneda especial a una direcci√≥n existente, el propietario deber√° realizar esfuerzos opcionales por separado, descubrir e indicar la direcci√≥n de salida expl√≠citamente en la etapa de formaci√≥n de la transacci√≥n. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øPor qu√© podr√≠a ser requerido? La √∫nica menci√≥n de la situaci√≥n en la que la direcci√≥n de salida se especifica manualmente, me reun√≠ solo en las </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instrucciones</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para transferir el dominio a otro propietario.</font></font><br><br><img src="https://habrastorage.org/webt/zv/8q/pe/zv8qpeblzvm4jogj-axkgmcgili.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La conjetura se confirma si consideramos el destino adicional de las direcciones a la salida de la transacci√≥n en cuesti√≥n. En el diagrama a continuaci√≥n, esta transacci√≥n est√° marcada por un hito verde brillante. Se puede ver que la siguiente transacci√≥n </font></font><code>9e16f6be</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">en el dominio stat-counter-4 se realiz√≥ utilizando una direcci√≥n de dinero </font></font><code>NJ8xUePv</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que no tiene una conexi√≥n expl√≠cita con la direcci√≥n utilizada en la transacci√≥n "padre". Obviamente, el dominio fue transferido a la gesti√≥n de otra persona.</font></font><br><br><img src="https://habrastorage.org/webt/ue/ho/ea/uehoea2yau72ydjns-ujsixawkw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el caso general, esto puede ser la venta de un dominio a otro propietario que no est√° relacionado con las actividades de la persona en cuesti√≥n o la transferencia de un dominio entre las cuentas de una persona. </font><font style="vertical-align: inherit;">La segunda opci√≥n es la simplicidad y el bajo costo de registrar un nuevo dominio, as√≠ como la falta de inter√©s visible de las organizaciones y los propietarios de marcas registradas en el registro de dominios en la zona .bit. </font><font style="vertical-align: inherit;">No pudimos encontrar al menos un poco de motivaci√≥n justificada para comprar un dominio, notado en actividades maliciosas. </font><font style="vertical-align: inherit;">Por lo tanto, creemos que a pesar de la posibilidad de transferir el dominio a otra persona, las transacciones con direcciones reutilizables para el retiro de una moneda especial representan una reorganizaci√≥n de activos entre varias cuentas controladas por un grupo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Formulamos los argumentos anteriores en forma de una regla heur√≠stica, que llamaremos cambio com√∫n: </font></font><br><br><blockquote>         ,   ,       ,     . <br><br>          ,     ,    . <br><br>  ,    ,     . </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El esquema para usar esta regla se muestra en la figura. Corrientes grises - monedas ordinarias, verdes - una moneda especial. Las gu√≠as ser√°n todas las monedas desde el final de la transacci√≥n opuesta a la moneda a trav√©s de la cual llegamos a esta transacci√≥n: todas las salidas son para el movimiento hacia arriba, y todas las entradas son para el movimiento hacia abajo. </font></font><br><br><img src="https://habrastorage.org/webt/1a/bh/fo/1abhfo8tmu_v8xwuw_uk7j0mla4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Observamos varias caracter√≠sticas de esta heur√≠stica. En primer lugar, bidireccional: funciona tanto para el movimiento hacia arriba, cuando conocemos al propietario de la entrada, como para el movimiento hacia abajo, cuando conocemos al propietario de una de las monedas en la salida. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En segundo lugar, la disponibilidad opcional de una moneda especial: a pesar de que, en su ausencia, la transacci√≥n no est√° relacionada con la actualizaci√≥n del dominio, el razonamiento l√≥gico dado anteriormente con respecto al propietario de una moneda regular sigue siendo v√°lido.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El pseudoc√≥digo para probar una transacci√≥n para el cumplimiento de la regla de cambio com√∫n se ver√≠a as√≠: </font></font><br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">common_change</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tx)</span></span></span><span class="hljs-function">:</span></span> result = {<span class="hljs-string"><span class="hljs-string">"guiding_outs"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"guiding_ins"</span></span>: []} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(tx.outs.money) != <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {} addr = tx.outs.money[<span class="hljs-number"><span class="hljs-number">0</span></span>].address first_tx = namecoin.tx.find_one({<span class="hljs-string"><span class="hljs-string">"out.id"</span></span>: addr}, sort=[(<span class="hljs-string"><span class="hljs-string">"block"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)]) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> first_tx.id != tx.id: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: result[<span class="hljs-string"><span class="hljs-string">"guiding_outs"</span></span>] = tx.outs.all result[<span class="hljs-string"><span class="hljs-string">"guiding_ins"</span></span>] = tx.ins.all <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result</code> </pre><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Gasto com√∫n </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La heur√≠stica considerada anteriormente tiene otra propiedad importante, adem√°s de la bidireccionalidad. Cambio com√∫n - heur√≠stico "sin memoria"; el resultado de la verificaci√≥n est√° determinado solo por las caracter√≠sticas de la transacci√≥n en cuesti√≥n y no depende de los resultados de otras heur√≠sticas y datos acumulados. Tal heur√≠stica es indispensable en las primeras iteraciones de un recorrido, para el llenado inicial de un conjunto de datos. Por otro lado, es f√°cil notar las limitaciones de su aplicaci√≥n. Por ejemplo, se centrar√° en una transacci√≥n que contenga dos o m√°s salidas de efectivo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como ejemplo de tal transacci√≥n, considere </font></font><code>db4ff4082f39d0a501508706e627f26aa92712d27b4f633ded59917d201cfae5</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Esta transacci√≥n se relaciona con las actividades del grupo que administra la botnet Dimnie. </font></font><br><br><img src="https://habrastorage.org/webt/td/61/-c/td61-cbmmd7enx-0olfyjxrpcva.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bajamos esta transacci√≥n a trav√©s de la direcci√≥n</font></font><code>My7Ap3nH5f4X6Us2KiUWisd77wRpMG1MDY</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que se us√≥ en la transacci√≥n CC anterior como la direcci√≥n de inicio de sesi√≥n. A pesar de que su actitud hacia la persona en estudio est√° fuera de toda duda, no podemos decir lo mismo (ni lo contrario) sobre ninguna de las otras salidas y entradas. Esto puede ser una redistribuci√≥n de monedas entre direcciones de grupo, en cuyo caso todas las direcciones est√°n controladas por la persona que nos interesa. O es, tal vez, una recarga de las direcciones de cualquiera de los intercambios que venden tokens Namecoin. O una transferencia de otro miembro de la red que no est√° relacionado con las actividades de la persona en estudio. Es imposible llegar a una conclusi√≥n definitiva sobre los atributos de esta transacci√≥n solo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Considera la direcci√≥n</font></font><code>N4XtLb7xpC4Zk72T8QcshKhTW17ZCyQ1j1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a la entrada de esta transacci√≥n. </font><font style="vertical-align: inherit;">Esta direcci√≥n ya se ha utilizado anteriormente ("anterior" para un movimiento descendente significa "en el futuro", "en la direcci√≥n del crecimiento de blockchain") en la entrada de una transacci√≥n CC </font></font><code>6bffc741eb66de074c09a380fb5e6bd13d4bd5205c36a76e3682674dba08461e</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, lo que nos permite considerar que esta direcci√≥n sea administrada por la persona que nos interesa. </font><font style="vertical-align: inherit;">Y dado que, como ya se ha mostrado, las claves de todas las monedas en la entrada de la transacci√≥n est√°n controladas por una persona (lo que no se puede decir sobre las salidas), tenemos razones para creer que todas las dem√°s entradas tambi√©n pertenecen al grupo de inter√©s para nosotros. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La condici√≥n estricta del gasto com√∫n heur√≠stico parece muy simple:</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si se sabe que al menos una de las direcciones en la entrada de la transacci√≥n est√° controlada por una determinada persona, entonces todas las dem√°s direcciones en las entradas de esta transacci√≥n est√°n controladas por la misma persona. </font><font style="vertical-align: inherit;">Las monedas en estas entradas pertenecen a la misma persona.</font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como puede ver, esta heur√≠stica tiene sentido solo para el movimiento hacia abajo. Al avanzar en la direcci√≥n del crecimiento de blockchain, llegamos a la transacci√≥n en estudio a trav√©s de una de las entradas. En este caso, la condici√≥n de la regla se cumple autom√°ticamente, pero no dice nada sobre los resultados de la transacci√≥n y no le permite continuar movi√©ndose en la direcci√≥n ascendente. En otras palabras, esta es una heur√≠stica unidireccional. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La segunda caracter√≠stica de esta heur√≠stica, que vale la pena se√±alar, es que aqu√≠ usamos primero los datos acumulados como resultado de la verificaci√≥n de transacciones anteriores: una lista de direcciones administradas por la persona bajo investigaci√≥n. Por esta raz√≥n, esta heur√≠stica secundaria no puede usarse para un movimiento independiente, sin ninguna heur√≠stica primaria que no dependa de los resultados acumulados (como el cambio com√∫n).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El pseudoc√≥digo para probar una transacci√≥n para el cumplimiento de la regla de gasto com√∫n se ver√≠a as√≠: </font></font><br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">common_spending</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tx)</span></span></span><span class="hljs-function">:</span></span> result = { <span class="hljs-string"><span class="hljs-string">"guiding_ins"</span></span>: [] } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> input <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tx.get_ins(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> input.address <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> known_addresses: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-string"><span class="hljs-string">"guiding_ins"</span></span>: tx.ins.all} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {}</code> </pre><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Direcci√≥n conocida </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La √∫ltima heur√≠stica que consideraremos en el marco de esta secci√≥n es la m√°s simple de todas. </font><font style="vertical-align: inherit;">Esta es una heur√≠stica bidireccional secundaria que (dado que es bidireccional) puede usarse tanto para movimiento hacia arriba como hacia abajo. </font><font style="vertical-align: inherit;">La formulaci√≥n estricta de la direcci√≥n heur√≠stica conocida para el movimiento ascendente se ve as√≠:</font></font><br><br><blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Si se sabe que la direcci√≥n en la entrada (salida) de la transacci√≥n est√° controlada por una determinada persona, entonces las monedas recibidas en esta direcci√≥n (gastadas desde esta direcci√≥n) pertenecen a la misma persona. </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aunque la heur√≠stica parece una verdad obvia, esta regla ayuda a encontrar sucursales e intersecciones en los flujos de monedas y agrega conectividad al √°rbol de transacciones. Adem√°s, le permite no detener el movimiento en transacciones que no se incluyen en otras heur√≠sticas. Un ejemplo es la transacci√≥n de la </font></font><code>7a35b9cb0a16b3eba92781be014555eaa4255bd17655bb00f2b3f42c3950ac69</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">botnet Dimnie ya mencionada. </font></font><br><br><img src="https://habrastorage.org/webt/06/eg/as/06egasevdvty7quvjjvr0jrp6gy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Al haberlo alcanzado en un movimiento ascendente, no podremos avanzar con la ayuda de un cambio com√∫n, ya que la salida es m√°s de una moneda ordinaria. Al observar una transacci√≥n, no podemos decir cu√°ntas monedas en la salida pertenecen a la misma persona que la moneda en la entrada, ambas, una o ninguna. El uso de la direcci√≥n heur√≠stica conocida le permite avanzar debido al hecho de que la direcci√≥n</font></font><code>MwMdTb8WQvoRW9jEW5dHn9SkkCJTRn31wQ</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">particip√≥ en la transacci√≥n CC </font></font><code>cf7ac8986f9855246c6cf26df9a24aa5645cb9258bf787e034a33e75101ae1fc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que cre√≥ el dominio que </font><font style="vertical-align: inherit;">se conoci√≥ anteriormente en el movimiento ascendente </font></font><code>d/sectools</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En aras de la integridad, damos el pseudoc√≥digo de la direcci√≥n heur√≠stica conocida:</font></font><br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">known_address</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tx)</span></span></span><span class="hljs-function">:</span></span> result = { <span class="hljs-string"><span class="hljs-string">"guiding_outs"</span></span>: [], <span class="hljs-string"><span class="hljs-string">"guiding_ins"</span></span>: [] } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> output <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tx.get_outs(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> output.address <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> known_addresses: result[<span class="hljs-string"><span class="hljs-string">"guiding_outs"</span></span>].append(output) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> input <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tx.get_ins(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> input.address <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> known_addresses: result[<span class="hljs-string"><span class="hljs-string">"guiding_ins"</span></span>].append(input) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Entonces, ahora tenemos tanto el algoritmo de derivaci√≥n general como las heur√≠sticas necesarias para moverse a lo largo de la cadena de bloques, de modo que podamos juntarlos para obtener algo de COI de Namecoin. </font></font><br><br><h2>  Vamos! </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comenzaremos con las transacciones RTM con el movimiento hacia arriba y hacia abajo, comenzando con </font></font><code>37d40bc2f3ca7415908dc9e276593b50d3120158cd540cb088246f2e2cf88b16</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. En el curso de avanzar en la cadena de bloques, recopilaremos no solo el COI, sino tambi√©n las transacciones mismas que satisfacen la heur√≠stica. Las monedas fluyen entre las transacciones que visualizamos usando el gr√°fico de Sankey. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El diagrama completo es demasiado grande para mostrarse en el formato de este documento, por lo que dar√© aqu√≠ solo una parte que es necesaria para la historia adicional. </font></font><br><br><img src="https://habrastorage.org/webt/zj/jh/un/zjjhundsmnmtabrgw81hkty76nk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Una corriente de monedas ordinarias se resalta en gris. Los colores restantes corresponden a los flujos de monedas especiales. Se selecciona un color separado para cada nombre. Los hitos blancos corresponden a transacciones que satisfacen las condiciones heur√≠sticas. Los hitos rojos brillantes a la derecha son UTXO.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El elemento del gr√°fico al que me gustar√≠a llamar la atenci√≥n est√° resaltado con un hito azul. Esta es una entrada colgante: una moneda que surgi√≥ a la entrada de una transacci√≥n que el algoritmo pas√≥ en el movimiento ascendente, pero la transacci√≥n que cre√≥ esta moneda no lo encontr√≥.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las entradas colgantes son signos de que la estructura en estudio tiene ramas laterales que no est√°n conectadas al tronco principal a lo largo del cual se mueve el algoritmo. En el caso que se muestra, esta es otra cuenta independiente. Como se puede ver en el diagrama, comienza a usarse para pagar los cambios en los dominios que ya conocemos. De este hecho podemos concluir que esta cuenta tambi√©n est√° controlada por la persona bajo investigaci√≥n. Para obtener el COI asociado con las operaciones en esta cuenta hasta que aparezca en el gr√°fico, comenzaremos un movimiento descendente por separado, comenzando en una transacci√≥n con una entrada colgante. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Del mismo modo, en un movimiento hacia abajo, pueden ocurrir salidas colgantes. Para cada uno de ellos, lanzaremos un movimiento ascendente separado a partir de la transacci√≥n correspondiente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s de las transacciones del grupo que controla la botnet RTM, tambi√©n examinamos las transacciones de los grupos que controlan las botnets Shifu, Dimnie y GandCrab. Como resultado, se encontraron 164 dominios registrados en inter√©s de estos grupos y 277 direcciones IP asociadas con estos nombres. Al momento de escribir este art√≠culo, de las UTXO recolectadas pertenecientes a estos grupos, 39 monedas segu√≠an vigentes. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las listas de COI, as√≠ como las direcciones de Namecoin en las que permanecieron las monedas no utilizadas de los grupos, se dan en el Ap√©ndice A.</font></font><br><br><h2>  Conclusi√≥n </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las pruebas de la vida real son un desaf√≠o para casi cualquier tecnolog√≠a. A mediados de la d√©cada de 2000, Wikipedia se hab√≠a convertido en una fuente de informaci√≥n confiable y tan popular que al cambiar los textos de los art√≠culos se hizo posible controlar la opini√≥n p√∫blica, comenzar y ganar dinero. Este per√≠odo en la historia del servicio es famoso por sus enormes guerras de revisi√≥n: el uso agresivo del mecanismo para corregir art√≠culos y la reversi√≥n de ediciones por varias partes beligerantes para ganar la disputa sobre el contenido del art√≠culo. Las p√°ginas de Wikipedia se convirtieron en una feria internacional de tocadores, donde todos quer√≠an decir literalmente la √∫ltima palabra.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por un lado, comenzaron a luchar con las enmiendas, estableciendo reglas especiales que, en caso de disputa, permiten excluir temporalmente la posibilidad de editar el art√≠culo, hasta que los debatientes en la secci√≥n "Discusi√≥n" encuentren una redacci√≥n de compromiso. Por otro lado, la guerra de revisiones oblig√≥ a Wikipedia a lanzar un mecanismo din√°mico para administrar los recursos de los administradores, lo que les permiti√≥ participar r√°pidamente en la resoluci√≥n de conflictos en las √°reas m√°s calientes. Adem√°s, la enciclopedia aprovech√≥ la atenci√≥n p√∫blica que atrajo los enfrentamientos en torno a art√≠culos individuales para atraer a m√°s participantes a la edici√≥n de estos art√≠culos y lograr la cobertura m√°s correcta y completa de un tema en particular.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øPuede Namecoin, como Wikipedia, crecer y hacer frente a su desaf√≠o? </font><font style="vertical-align: inherit;">Espera y mira. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las tablas PS con indicadores de compromiso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">est√°n disponibles en GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Publicado por</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Alexey Goncharov, PT Expert Security Center</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460857/">https://habr.com/ru/post/460857/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460845/index.html">Fernando Corbato, el padre de su computadora (y contrase√±a), muri√≥ a los 93 a√±os</a></li>
<li><a href="../460847/index.html">12,3 millones de WebSockets concurrentes</a></li>
<li><a href="../460849/index.html">Parte 4. Un modelo gr√°fico para calcular funciones l√≥gicas para procesos paralelos asincr√≥nicos</a></li>
<li><a href="../460851/index.html">SamsPcbGuide, Parte 10: Tecnolog√≠a - Soldadura de componentes sin plomo</a></li>
<li><a href="../460855/index.html">¬øC√≥mo usar PHP para implementar microservicios?</a></li>
<li><a href="../460859/index.html">IThink # 3 conferencia en Jarkov - basada en WWDC 2019</a></li>
<li><a href="../460861/index.html">Alcance y cierre l√©xico de JavaScript</a></li>
<li><a href="../460863/index.html">Detalles del accidente de Cloudflare 2 de julio de 2019</a></li>
<li><a href="../460865/index.html">La gente en la luna. Fuentes</a></li>
<li><a href="../460867/index.html">Sourcery para convertir autom√°ticamente a estructuras de objetos Realm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>