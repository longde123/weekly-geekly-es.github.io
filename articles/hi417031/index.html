<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСГЁЯП┐ ЁЯХЫ ЁЯСиЁЯП╝тАНЁЯПл рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рд╕реБрд░рдХреНрд╖рд╛ ЁЯСиЁЯП╝тАНЁЯОУ ЁЯПг тЩ╗я╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд╕рднреА рдХреЛ рдирдорд╕реНрдХрд╛рд░! рдореИрдВ рдирд┐рдХрд┐рддрд╛ рд╕реНрдЯреБрдкрд┐рди, рд╕реВрдЪрдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ, Mail.Ru рдореЗрд▓ рд╣реВрдБред рдЗрддрдирд╛ рд╕рдордп рдкрд╣рд▓реЗ рдирд╣реАрдВ, рдореИрдВрдиреЗ рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдкрд░ рднреЗрджреНрдпрддрд╛ рдЕрдиреБрд╕рдВрдзрд╛рди рдХрд┐рдпрд╛ред рдПрдХ рд╕...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рд╕реБрд░рдХреНрд╖рд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/417031/"><img src="https://habrastorage.org/getpro/habr/post_images/205/605/cd5/205605cd5b166f65aa8085fe1606779f.jpg"><br><br>  рд╕рднреА рдХреЛ рдирдорд╕реНрдХрд╛рд░!  рдореИрдВ рдирд┐рдХрд┐рддрд╛ рд╕реНрдЯреБрдкрд┐рди, рд╕реВрдЪрдирд╛ рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ, Mail.Ru рдореЗрд▓ рд╣реВрдБред  рдЗрддрдирд╛ рд╕рдордп рдкрд╣рд▓реЗ рдирд╣реАрдВ, рдореИрдВрдиреЗ рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдкрд░ рднреЗрджреНрдпрддрд╛ рдЕрдиреБрд╕рдВрдзрд╛рди рдХрд┐рдпрд╛ред  рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдпреЛрдЬрдирд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЕрдкрдиреЗ рд╢реБрджреНрдз рд░реВрдк рдореЗрдВ рдорд╛рдирдХ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдФрд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ_рдпреВрд░реА рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИред  рдореЛрдмрд╛рдЗрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдмрд╛рд░реАрдХрд┐рдпреЛрдВ рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рдФрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕реБрд░рдХреНрд╖рд╛ рддрдВрддреНрд░ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред <br><br>  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ рдореИрдВ рдЖрдкрдХреЗ рд╕рд╛рде рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдкрд░ рд╣рдорд▓реЛрдВ, рд╕реБрд░рдХреНрд╖рд╛ рд╡рд┐рдзрд┐рдпреЛрдВ рдФрд░ рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬреНрдЮрд╛рди рд╕рд╛рдЭрд╛ рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВред  рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рд╕реБрд░рдХреНрд╖рд╛ рдШрдЯрдХ, рдЬрд┐рдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдореИрдВ рдиреАрдЪреЗ рдЪрд░реНрдЪрд╛ рдХрд░реВрдВрдЧрд╛, Mail.Ru рдореЗрд▓ рдореЛрдмрд╛рдЗрд▓ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рд▓рд┐рдП рдирд╡реАрдирддрдо SDK рдореЗрдВ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред <br><a name="habracut"></a><br><h1>  OAuth 2.0 рдХреА рдкреНрд░рдХреГрддрд┐ рдФрд░ рдХрд╛рд░реНрдп </h1><br>  OAuth 2.0 рдПрдХ рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдХрд┐рд╕реА рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рдХрд┐рд╕реА рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕рдВрд╕рд╛рдзрдиреЛрдВ рддрдХ рдкрд╣реБрдВрдЪрдирд╛ рдХреИрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИред  рдЗрд╕реА рд╕рдордп, OAuth 2.0 рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдмрд╛рд╣рд░ рдПрдХ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░рдиреЗ рд╕реЗ рдмрдЪрд╛рддрд╛ рд╣реИ: "рдореИрдВ рд╕рд╣рдордд рд╣реВрдВ ..." рдмрдЯрди рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреВрд░реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрдо рд╣реЛ рдЧрдИ рд╣реИред <br><br>  OAuth 2.0 рдХреЗ рд╕рдВрджрд░реНрдн рдореЗрдВ рдПрдХ рдкреНрд░рджрд╛рддрд╛ рдПрдХ рд╕реЗрд╡рд╛ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХрд╛ рдорд╛рд▓рд┐рдХ рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рдЕрдиреБрдорддрд┐ рдХреЗ рд╕рд╛рде, рдЗрд╕ рдбреЗрдЯрд╛ рддрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдкрд╣реБрдВрдЪ рдХреЗ рд╕рд╛рде рддреГрддреАрдп-рдкрдХреНрд╖ рд╕реЗрд╡рд╛рдПрдВ (рдХреНрд▓рд╛рдЗрдВрдЯ) рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдПрдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реИ рдЬреЛ рдПрдХ рдкреНрд░рджрд╛рддрд╛ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реИред <br><br>  OAuth 2.0 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдЬрд╛рд░реА рд╣реЛрдиреЗ рдХреЗ рдХреБрдЫ рд╕рдордп рдмрд╛рдж, рд╕рд╛рдорд╛рдиреНрдп рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ рдЗрд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд┐рдпрд╛, рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рдореВрд▓ рд░реВрдк рд╕реЗ рдЗрд╕рдХреЗ рд▓рд┐рдП рдЕрднрд┐рдкреНрд░реЗрдд рдирд╣реАрдВ рдерд╛ред  рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рд╕реЗ рдЕрдЯреИрдХ рд╡реЗрдХреНрдЯрд░ рдХреЛ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬреЛ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗрд╡рд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдпрд╣ рдХреЗрд╡рд▓ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рддрдХ рд╕реАрдорд┐рдд рдирд╣реАрдВ рдерд╛ред  рдореЛрдмрд╛рдЗрд▓ рдРрдк рдФрд░ рд░реВрдкрд╛рдВрддрд░рдг рдХреЗ рджреМрд░ рдореЗрдВ, рдПрдХ рдмрдЯрди рдХреЗ рд╕рд╛рде рдРрдк рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рдирд╛ рдмрд╣реБрдд рд▓реБрднрд╛рд╡рдирд╛ рд╣реЛ рдЧрдпрд╛ рд╣реИред  рдбреЗрд╡рд▓рдкрд░реНрд╕ рдиреЗ OAuth 2.0 рдХреЛ рдореЛрдмрд╛рдЗрд▓ рд░реЗрд▓ рдкрд░ рд░рдЦрд╛ред  рд╕реНрд╡рд╛рднрд╛рд╡рд┐рдХ рд░реВрдк рд╕реЗ, рдХреБрдЫ рд▓реЛрдЧреЛрдВ рдиреЗ рдореЛрдмрд╛рдЗрд▓ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдмрд╛рд░реАрдХрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реЛрдЪрд╛: рдПрдХ рдмрд╛рд░ рдФрд░ рдЙрддреНрдкрд╛рджрди рдореЗрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, OAuth 2.0 рдЖрдо рддреМрд░ рдкрд░ рд╡реЗрдм рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдмрд╛рд╣рд░ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ: рдореЛрдмрд╛рдЗрд▓ рдФрд░ рдбреЗрд╕реНрдХрдЯреЙрдк рджреЛрдиреЛрдВ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рд╕рдорд╛рди рд╕рдорд╕реНрдпрд╛рдПрдВ рджреЗрдЦреА рдЬрд╛рддреА рд╣реИрдВред <br><br>  рдЖрдЗрдП рдЬрд╛рдиреЗрдВ рдХрд┐ рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдХреИрд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рдПред <br><br><h1>  рдпрд╣ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ? </h1><br>  рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░, рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рдмреИрдХрдПрдВрдб рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдореЛрдмрд╛рдЗрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдореЗрдВ рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдХреЗ рд▓рд┐рдП рджреЛ рдкреНрд░рдореБрдЦ рд╕реБрд░рдХреНрд╖рд╛ рдореБрджреНрджреЛрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд░рдирд╛ рдкрдбрд╝ рд░рд╣рд╛ рд╣реИ: <br><br><ol><li>  рдЧреНрд░рд╛рд╣рдХ рдкрд░ рднрд░реЛрд╕рд╛ рдирд╣реАрдВ рд╣реИред </li><li>  рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рдореЛрдмрд╛рдЗрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рддрдХ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХрд╛ рд╡реНрдпрд╡рд╣рд╛рд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреНрд╡рд╛рд░рд╛ рд╕реНрдерд╛рдкрд┐рдд рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдФрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред </li></ol><br><h4>  рдореЛрдмрд╛рдЗрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЧреНрд░рд╛рд╣рдХ рд╣реИ </h4><br>  рдкрд╣рд▓реА рд╕рдорд╕реНрдпрд╛ рдХреА рдЬрдбрд╝ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╕рд░реНрд╡рд░-рдЯреВ-рд╕рд░реНрд╡рд░ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ OAuth 2.0 рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдХреНрд▓рд╛рдЗрдВрдЯ-рдЯреВ-рд╕рд░реНрд╡рд░ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ OAuth 2.0 рдХреЗ рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░реЗрдВред <br><br>  рджреЛрдиреЛрдВ рд╣реА рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдпрд╣ рд╕рдм рдЗрд╕ рддрдереНрдп рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ рдХрд┐ рд╕реЗрд╡рд╛ рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд╕рд╛рде рдкрдВрдЬреАрдХреГрдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ <code>client_secret</code> рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ рдФрд░, рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, <code>client_secret</code> ред  <code>client_id</code> рдорд╛рди рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рд╣реИ рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗрд╡рд╛ рдХреА рдкрд╣рдЪрд╛рди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ, рдЬрд┐рд╕рдХреЗ рд╡рд┐рдкрд░реАрдд <code>client_secret</code> , рдЬрд┐рд╕рдХрд╛ рдорд╛рди рдирд┐рдЬреА рд╣реИред  рдкрдВрдЬреАрдХрд░рдг рдкреНрд░рдХреНрд░рд┐рдпрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">RFC 7591</a> рдореЗрдВ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд░реНрдгрд┐рдд рд╣реИред <br><br>  рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рдЖрд░реЗрдЦ рдореЗрдВ рд╕рд░реНрд╡рд░-рд╕реЗ-рд╕рд░реНрд╡рд░ рд╕рдВрдЪрд╛рд░ рдореЗрдВ OAuth 2.0 рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f06/279/e8a/f06279e8ac68f2fe664362caec6fa063.png"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Https://tools.ietf.org/html/rfc6749#section-1.2</a> рд╕реЗ рд▓реА рдЧрдИ рдЫрд╡рд┐</i> <br><br>  OAuth 2.0 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ 3 рдореБрдЦреНрдп рдЪрд░рдг рд╣реИрдВ: <br><br><ol><li>  [рдПрд╕реА рдХрджрдо] рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ (рдмрд╛рдж рдореЗрдВ рдмрд╕ <code>code</code> )ред </li><li>  [DE рдЪрд░рдг] <code>access_token</code> <code>code</code> рд▓рд┐рдП рдПрдХреНрд╕рдЪреЗрдВрдЬ <code>code</code> ред </li><li>  <code>access_token</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрд╕рд╛рдзрди рддрдХ <code>access_token</code> ред </li></ol><br>  рдЖрдЗрдП рд╣рдо рдФрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдХреЛрдб рдХреА рдкреНрд░рд╛рдкреНрддрд┐ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВ: <br><br><ol><li>  [рдЪрд░рдг рдП] рд╕реЗрд╡рд╛ рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред </li><li>  [рдЪрд░рдг рдмреА] рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛ (рддреАрд░ рдмреА рдЕрдк) рдХреЛ рдбреЗрдЯрд╛ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗ рдЕрдиреБрдорддрд┐ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ (рджрд╛рдИрдВ рдУрд░ рддреАрд░ B)ред </li><li>  [рдЪрд░рдг рд╕реА] рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ <code>code</code> рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рдЬреЛ <code>code</code> рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛ рдореЗрдВ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред </li></ol><br>  рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ <code>access_token</code> рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ <code>access_token</code> рджреЗрдВ: <br><br><ol><li>  [рдЪрд░рдг рдбреА] рдХреНрд▓рд╛рдЗрдВрдЯ рд╕рд░реНрд╡рд░ <code>access_token</code> рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрддрд╛ рд╣реИред  рдЕрдиреБрд░реЛрдз рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: <code>code</code> , <code>client_secret</code> рдФрд░ <code>redirect_uri</code> ред </li><li>  [рдЪрд░рдг E] рд╡реИрдз <code>code</code> рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, <code>client_secret</code> рдФрд░ <code>redirect_uri</code> , <code>client_secret</code> рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </li></ol><br>  <code>access_token</code> рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рд╕рд░реНрд╡рд░-рд╕реЗ-рд╕рд░реНрд╡рд░ рдпреЛрдЬрдирд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ, <code>client_secret</code> рдЪреЛрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>client_secret</code> рд╣рдорд▓рд╛рд╡рд░ рдХреЛ рд╕рд░реНрд╡рд░-рдХреНрд▓рд╛рдЗрдВрдЯ-рд╕рд░реНрд╡рд░ рдпрд╛ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рд╕рд░реНрд╡рд░ рдХреЛ рд╣реИрдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br>  рдЕрдм рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ OAuth 2.0 рдпреЛрдЬрдирд╛ рдПрдХ рдмреИрдХреЗрдВрдб (рдХреНрд▓рд╛рдЗрдВрдЯ-рдЯреВ-рд╕рд░реНрд╡рд░ рдЗрдВрдЯрд░реИрдХреНрд╢рди) рдХреЗ рдмрд┐рдирд╛ рдореЛрдмрд╛рдЗрд▓ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдХреИрд╕реА рджрд┐рдЦрддреА рд╣реИред <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7cb/9fb/b7d/7cb9fbb7dcc35c74e921f18d22584254.png"><br>  <i>рдЫрд╡рд┐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://tools.ietf.org/html/rfc8252#section-4.1</a> рд╕реЗ рд▓реА рдЧрдИ рд╣реИ</i> <br><br>  рд╕рд╛рдорд╛рдиреНрдп рдпреЛрдЬрдирд╛ рдХреЛ 3 рдореБрдЦреНрдп рдЪрд░рдгреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: <br><br><ol><li>  [рдЪрд┐рддреНрд░ рдореЗрдВ 1-4 рдЪрд░рдг] <code>code</code> рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВред </li><li>  [рдЪрд┐рддреНрд░ рдореЗрдВ 5-6 рдЪрд░рдг] <code>access_token</code> <code>code</code> рд▓рд┐рдП рдПрдХреНрд╕рдЪреЗрдВрдЬ <code>code</code> ред </li><li>  <code>access_token</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрд╕рд╛рдзрди рддрдХ <code>access_token</code> ред </li></ol><br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореЛрдмрд╛рдЗрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рд╕рд░реНрд╡рд░ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ <code>client_secret</code> рдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЕрдВрджрд░ <code>client_secret</code> рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрд╣ рдЗрд╕ рддрдереНрдп рдХреА рдУрд░ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рд╕реЗ <code>lient_secret</code> рдЧреБрдкреНрдд рд░рдЦрдирд╛ рдЕрд╕рдВрднрд╡ рд╣реИред  <code>client_secret</code> рдХреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ <code>client_secret</code> рдХрд░рдиреЗ рдХреЗ рджреЛ рддрд░реАрдХреЗ рд╣реИрдВ: рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд╕рд░реНрд╡рд░ рд╕реЗ рдЯреНрд░реИрдлрд╝рд┐рдХ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рдирд╛ рдпрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░ рдХрд░рдирд╛ред  рджреЛрдиреЛрдВ рддрд░реАрдХреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИ, рдЗрд╕рд▓рд┐рдП <code>client_secret</code> рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ рдмреЗрдХрд╛рд░ рд╣реИред <br><br>  рдХреНрд▓рд╛рдЗрдВрдЯ-рдЯреВ-рд╕рд░реНрд╡рд░ рд╕реНрдХреАрдо рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ, рдЖрдкрдХреЗ рдкрд╛рд╕ рдПрдХ рдкреНрд░рд╢реНрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИ: "рддреБрд░рдВрдд <code>access_token</code> рдХреНрдпреЛрдВ рдирд╣реАрдВ?"ред  рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ, рд╣рдореЗрдВ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдХрджрдо рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдХреНрдпреЛрдВ рд╣реИ?  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдПрдХ <code>access_token</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЧреНрд░рд╛рдВрдЯ</a> рд╕реНрдХреАрдо рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдХреНрд▓рд╛рдЗрдВрдЯ рддреБрд░рдВрдд рдПрдХ <code>access_token</code> рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рд╣рдо рдиреАрдЪреЗ рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЗрдВрдкреНрд▓рд┐рдореЗрдВрдЯ рдЧреНрд░рд╛рдВрдЯ</a> рд╕реБрд░рдХреНрд╖рд┐рдд рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдирд╣реАрдВ рд╣реИред <br><br><h4>  рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд </h4><br>  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдореЛрдмрд╛рдЗрд▓ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкрд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХрд╕реНрдЯрдо рдпреВрдЖрд░рдЖрдИ рдпреЛрдЬрдирд╛</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдРрдкрд▓рд┐рдВрдХ</a> рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рдХреЗ рд╢реБрджреНрдз рд░реВрдк рдореЗрдВ рдЗрдирдореЗрдВ рд╕реЗ рдХреЛрдИ рднреА рддрдВрддреНрд░ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рдирд╣реАрдВ рд╣реИред <br><br>  рдХрд╕реНрдЯрдо рдпреВрдЖрд░рдЖрдИ рдпреЛрдЬрдирд╛ (рдпрд╛ рдЧрд╣рд░реА рд▓рд┐рдВрдХ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: рдбреЗрд╡рд▓рдкрд░ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рд╕реЗ рдкрд╣рд▓реЗ рдЖрд╡реЗрджрди рдпреЛрдЬрдирд╛ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддрд╛ рд╣реИред  рдпреЛрдЬрдирд╛ рдордирдорд╛рдиреА рд╣реЛ рд╕рдХрддреА рд╣реИ, рдЬрдмрдХрд┐ рдПрдХ рд╣реА рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдПрдХ рд╣реА рдпреЛрдЬрдирд╛ рд╡рд╛рд▓реЗ рдХрдИ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрдВрд╕реНрдЯреЙрд▓ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдЬрдм рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдкреНрд░рддреНрдпреЗрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИ рддреЛ рд╕рдм рдХреБрдЫ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИред  рд▓реЗрдХрд┐рди рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдЕрдЧрд░ рджреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдиреЗ рдПрдХ рд╣реА рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рдПрдХ рд╣реА рд╕рд░реНрдХрд┐рдЯ рдкрдВрдЬреАрдХреГрдд рдХрд┐рдпрд╛?  рдСрдкрд░реЗрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХрд╕реНрдЯрдо рдпреВрдЖрд░рдЖрдИ рд╕реНрдХреАрдо рдХреЛ рдПрдХреНрд╕реЗрд╕ рдХрд░рддреЗ рд╕рдордп рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рджреЛрдиреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ?  рдПрдВрдбреНрд░реЙрдЗрдб рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдкрд╕рдВрдж рдХреЗ рд╕рд╛рде рдПрдХ рд╡рд┐рдВрдбреЛ рджрд┐рдЦрд╛рдПрдЧрд╛ рдЬрд┐рд╕рдореЗрдВ рдЖрдк рдПрдХ рд▓рд┐рдВрдХ рдЦреЛрд▓рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред  IOS рдореЗрдВ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ</a> , рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рджреЛрдиреЛрдВ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЛ рдЦреЛрд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рджреЛрдиреЛрдВ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЛрдб рдпрд╛ access_token рдХреЛ рд░реЛрдХ рд╕рдХрддрд╛ рд╣реИ</a> ред <br><br>  AppLink, рдХрд╕реНрдЯрдо URI рд╕реНрдХреАрдо рдХреЗ рд╡рд┐рдкрд░реАрдд, рд╕рд╣реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЦреЛрд▓рдиреЗ рдХреА рдЧрд╛рд░рдВрдЯреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕ рддрдВрддреНрд░ рдХреЗ рдХрдИ рдиреБрдХрд╕рд╛рди рд╣реИрдВ: <br><br><ol><li>  рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд╡рд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╕реНрд╡рддрдВрддреНрд░ рд░реВрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реЗ рд╕рддреНрдпрд╛рдкрди рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ</a> рдкрд╛рд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </li><li>  рдПрдВрдбреНрд░реЙрдЗрдб рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдореЗрдВ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдРрдкрд▓рд┐рдВрдХ рдХреЛ рдмрдВрдж рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </li><li>  рдПрдВрдбреНрд░реЙрдЗрдб 6.0 рд╕реЗ рдиреАрдЪреЗ рдФрд░ iOS 9.0 рд╕реЗ рдиреАрдЪреЗ рдРрдкреНрдкрд▓рд┐рдВрдХ рдХрд╛ рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </li></ol><br>  рдРрдкрд▓рд┐рдВрдХ рдХреЗ рдЙрдкрд░реЛрдХреНрдд рдиреБрдХрд╕рд╛рди, рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╕рдВрднрд╛рд╡рд┐рдд рдЧреНрд░рд╛рд╣рдХ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╡реЗрд╢ рд╕реАрдорд╛ рдХреЛ рдмрдврд╝рд╛рддреЗ рд╣реИрдВ, рдФрд░ рджреВрд╕рд░реА рдмрд╛рдд, рдЗрд╕ рддрдереНрдп рдХреЛ рдЬрдиреНрдо рджреЗ рд╕рдХрддреА рд╣реИ рдХрд┐ рдХреБрдЫ рдкрд░рд┐рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ OAuth 2.0 рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ред  рдпрд╣ OAuth 2.0 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд░реАрдбрд╛рдпрд░реЗрдХреНрдЯ рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП AppLink рдХреЛ рдЕрдиреБрдкрдпреБрдХреНрдд рдмрдирд╛рддрд╛ рд╣реИред <br><br><h1>  рдареАрдХ рд╣реИ, рдХреНрдпрд╛ рд╣рдорд▓рд╛ рдХрд░рдирд╛ рд╣реИ? </h1><br>  рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдХреА рд╕рдорд╕реНрдпрд╛рдУрдВ рдиреЗ рднреА рд╡рд┐рд╢рд┐рд╖реНрдЯ рд╣рдорд▓реЛрдВ рдХреЛ рдЬрдиреНрдо рджрд┐рдпрд╛ред  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рд╡реЗ рдХреНрдпрд╛ рд╣реИрдВ рдФрд░ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддреЗ рд╣реИрдВред <br><br><a name="1"></a><h4>  рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб рдЕрд╡рд░реЛрдзрди рд╣рдорд▓рд╛ </h4><br>  рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдбреЗрдЯрд╛: рдПрдХ рд╡реИрдз рдПрдкреНрд▓рд┐рдХреЗрд╢рди (OAuth 2.0 рдХреНрд▓рд╛рдЗрдВрдЯ) рдФрд░ рдПрдХ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди, рдЬрд┐рд╕рдиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ рд╡реИрдз рдПрдХ рд╣реА рдпреЛрдЬрдирд╛ рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд┐рдпрд╛ рд╣реИред  рдиреАрдЪреЗ рджрд┐рдпрд╛ рдЧрдпрд╛ рдЖрдВрдХрдбрд╝рд╛ рд╣рдорд▓реЗ рдХреА рдпреЛрдЬрдирд╛ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a87/336/d4c/a87336d4c0d73c89a62bb448cb12d49b.png"><br>  <i>рдЪрд┐рддреНрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://tools.ietf.org/html/rfc7636#section-1</a> рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ</i> <br><br>  рдпрд╣рд╛рдВ рд╕рдорд╕реНрдпрд╛ рд╣реИ: рдЪрд░рдг 4 рдореЗрдВ, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╕реНрдЯрдо рдпреВрдЖрд░рдЖрдИ рдпреЛрдЬрдирд╛ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЖрд╡реЗрджрди рдкрд░ <code>code</code> рд▓реМрдЯрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП <code>code</code> рдХреЛ рдореИрд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рдЙрд╕реА рдпреЛрдЬрдирд╛ рдХреЛ рд╡реИрдз рдЕрдиреБрдкреНрд░рдпреЛрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдкрдВрдЬреАрдХреГрдд рдХрд░рддрд╛ рд╣реИ)ред  рдЙрд╕рдХреЗ рдмрд╛рдж, рдореИрд▓рд╡реЗрдпрд░ <code>code</code> рдХреЛ <code>access_token</code> рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред <br><br>  рдЦреБрдж рдХреА рд╕реБрд░рдХреНрд╖рд╛ рдХреИрд╕реЗ рдХрд░реЗрдВ?  рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЗрдВрдЯрд░рдкреНрд░реЛрд╕реЗрд╕ рд╕рдВрдЪрд╛рд░ рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ; рд╣рдо рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдиреАрдЪреЗ рдмрд╛рдд рдХрд░реЗрдВрдЧреЗред  рд╕рд╛рдорд╛рдиреНрдп рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЖрдкрдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЛрдб рдПрдХреНрд╕рдЪреЗрдВрдЬ рдХреЗ рд▓рд┐рдП рдкреНрд░реВрдл рдХреА</a> рдирд╛рдордХ рдПрдХ рдпреЛрдЬрдирд╛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдЗрд╕рдХрд╛ рд╕рд╛рд░ рдиреАрдЪреЗ рдХреЗ рдЪрд┐рддреНрд░ рдореЗрдВ рдкрд░рд┐рд▓рдХреНрд╖рд┐рдд рд╣реЛрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/getpro/habr/post_images/123/67e/349/12367e3497cbbd54d007a18a678bfc0d.png"><br>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Https://tools.ietf.org/html/rfc7636#section-1.1</a> рд╕реЗ рд▓реА рдЧрдИ рдЫрд╡рд┐</i> <br><br>  рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдЕрдиреБрд░реЛрдзреЛрдВ рдореЗрдВ, рдХрдИ рдЕрддрд┐рд░рд┐рдХреНрдд рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВ: <code>code_verifier</code> , <code>code_challenge</code> ( <code>t(code_verifier)</code> ) рдФрд░ <code>code_challenge_method</code> ( <code>t_m</code> рдЖрд░реЗрдЦ рдкрд░)ред <br><br>  <code>Code_verifier</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рдВрдмрд╛рдИ рдореЗрдВ рдХрдо рд╕реЗ рдХрдо 256 рдмрд┐рдЯреНрд╕ рдХреА</a> рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рд╕рдВрдЦреНрдпрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> рдЬреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЗрд╡рд▓ рдПрдХ рдмрд╛рд░ рдЙрдкрдпреЛрдЧ рдХреА рдЬрд╛рддреА рд╣реИ</a> ред  рдЕрд░реНрдерд╛рдд, <code>code</code> рд▓рд┐рдП <b>рдкреНрд░рддреНрдпреЗрдХ</b> рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП <code>code</code> рдЧреНрд░рд╛рд╣рдХ рдХреЛ рдПрдХ рдирдпрд╛ <code>code_verifier</code> рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br>  <code>Code_challenge_method</code> рдПрдХ рд░реВрдкрд╛рдВрддрд░рдг рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдирд╛рдо рд╣реИ, рдЬреЛ рдЕрдХреНрд╕рд░ SHA-256 рд╣реИред <br><br>  <code>Code_challenge</code> рдПрдХ <code>code_verifier</code> рд╣реИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП <code>code_challenge_method</code> рд░реВрдкрд╛рдВрддрд░рдг <code>code_challenge_method</code> рдХрд┐рдпрд╛ рдЧрдпрд╛ <code>code_challenge_method</code> рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд Base64 URL рдореЗрдВ рдПрдиреНрдХреЛрдб рдХрд┐рдпрд╛ рдЧрдпрд╛ <code>code_challenge_method</code> ред <br><br>  <code>code</code> рдЕрдиреБрд░реЛрдз рдХрд░рддреЗ рд╕рдордп <code>code_verifier</code> (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рд╕рд┐рд╕реНрдЯрдо рд▓реЙрдЧ рд╕реЗ) рдХреЗ рдЕрд╡рд░реЛрдзрди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдХреЛрдб рд╡реИрдХреНрдЯрд░ рдХреЗ рдЦрд┐рд▓рд╛рдл <code>code_challenge</code> рд░реВрдкрд╛рдВрддрд░рдг рдЖрд╡рд╢реНрдпрдХ рд╣реИред <br><br>  рдпрджрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рдбрд┐рд╡рд╛рдЗрд╕ SHA-256 рдХрд╛ <b>рд╕рдорд░реНрдерди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ</b> , рддреЛ рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбрд╛рдЙрдирдЧреНрд░реЗрдб рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рддреА рд╣реИ рдЬрдм рддрдХ рдХрд┐ code_verifier рд░реВрдкрд╛рдВрддрд░рдг рдЧрд╛рдпрдм рди рд╣реЛ</a> ред  рдЕрдиреНрдп рд╕рднреА рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЖрдкрдХреЛ SHA-256 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  рдпреЛрдЬрдирд╛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдХрд╛рдо рдХрд░рддреА рд╣реИ: <br><br><ol><li>  рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдХ <code>code_verifier</code> рдФрд░ рдЙрд╕реЗ рдпрд╛рдж рд░рдЦрддрд╛ рд╣реИред </li><li>  рдХреНрд▓рд╛рдЗрдВрдЯ <code>code_challenge_method</code> рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ рдФрд░ <code>code_challenge</code> рд╕реЗ <code>code_verifier</code> рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред </li><li>  [рдЪрд░рдг A] рдХреНрд▓рд╛рдЗрдВрдЯ рдЕрдиреБрд░реЛрдз <code>code</code> , <code>code_challenge</code> рдФрд░ <code>code_challenge_method</code> рд╕рд╛рде рдЕрдиреБрд░реЛрдз рдореЗрдВ рдЬреЛрдбрд╝рд╛ рдЧрдпрд╛ред </li><li>  [рдЪрд░рдг B] рдкреНрд░рджрд╛рддрд╛ рд╕рд░реНрд╡рд░ рдкрд░ <code>code_challenge</code> рдФрд░ <code>code_challenge_method</code> рдХреЛ рдпрд╛рдж <code>code_challenge</code> рдФрд░ рдХреНрд▓рд╛рдЗрдВрдЯ <code>code</code> рд▓реМрдЯрд╛рддрд╛ рд╣реИред </li><li>  [рдЪрд░рдг C] рдХреНрд▓рд╛рдЗрдВрдЯ <code>access_token</code> рдЕрдиреБрд░реЛрдз <code>access_token</code> , рдЬрд┐рд╕рдореЗрдВ <code>access_token</code> <code>code_verifier</code> рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИред </li><li>  рдкреНрд░рджрд╛рддрд╛ рдЖрдиреЗ рд╡рд╛рд▓реЗ <code>code_challenge</code> рд╕реЗ <code>code_challenge</code> рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ <code>code_challenge</code> рдЦрд┐рд▓рд╛рдл рдЪреЗрдХ рдХрд░рддрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рдпрд╛рдж рд░рдЦрд╛ рдЧрдпрд╛ рдерд╛ред </li><li>  [рдЪрд░рдг рдбреА] рдпрджрд┐ рдорд╛рди рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВ, рддреЛ рдкреНрд░рджрд╛рддрд╛ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ <code>access_token</code> рдПрдХ <code>access_token</code> рд╣реИред </li></ol><br>  рдЖрдЗрдП <code>code_challenge</code> рдХрд┐ рдХреНрдпреЛрдВ <code>code_challenge</code> рдПрдХ рдХреЛрдб рдЕрд╡рд░реЛрдзрди рд╣рдорд▓реЗ рд╕реЗ рдЦреБрдж рдХреЛ рдмрдЪрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо <code>access_token</code> рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рдЪрд░рдгреЛрдВ рд╕реЗ <code>access_token</code> ред <br><br><ol><li>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдПрдХ рд╡реИрдз рдЖрд╡реЗрджрди рдЕрдиреБрд░реЛрдз <code>code</code> ( <code>code_challenge</code> рдФрд░ <code>code_challenge_method</code> рдПрдХ рд╕рд╛рде <b>рдЕрдиреБрд░реЛрдз рдХреЗ</b> рд╕рд╛рде рднреЗрдЬрд╛ рдЬрд╛рддрд╛ рд╣реИ)ред </li><li>  рдореИрд▓рд╡реЗрдпрд░ <code>code</code> <code>code_challenge</code> (рд▓реЗрдХрд┐рди <code>code_challenge</code> рдирд╣реАрдВ, рдХреНрдпреЛрдВрдХрд┐ <b>рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ</b> рдХреЛрдИ <code>code_challenge</code> рдирд╣реАрдВ рд╣реИ)ред </li><li>  рдореИрд▓рд╡реЗрдпрд░ <code>access_token</code> (рдорд╛рдиреНрдп <code>code</code> рд╕рд╛рде, рд▓реЗрдХрд┐рди рдорд╛рдиреНрдп <code>code_verifier</code> <b>рдмрд┐рдирд╛</b> ) рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИред </li><li>  рд╕рд░реНрд╡рд░ <code>code_challenge</code> рдмреЗрдореЗрд▓ рдХреЛ рдиреЛрдЯрд┐рд╕ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рддреНрд░реБрдЯрд┐ рдлреЗрдВрдХрддрд╛ рд╣реИред </li></ol><br>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдорд▓рд╛рд╡рд░ рдореЗрдВ <code>code_verifier</code> (рдпрд╛рджреГрдЪреНрдЫрд┐рдХ 256 рдмрд┐рдЯреНрд╕!) рдХрд╛ рдЕрдиреБрдорд╛рди рд▓рдЧрд╛рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдирд╣реАрдВ рд╣реИ рдпрд╛ рдЗрд╕реЗ рд▓реЙрдЧ рдореЗрдВ рдХрд╣реАрдВ рд▓рдЧрддрд╛ рд╣реИ ( <code>code_verifier</code> рдПрдХ рдмрд╛рд░ рдкреНрд░рд╕рд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ)ред <br><br>  рдпрджрд┐ рдпрд╣ рд╕рдм рдПрдХ рд╡рд╛рдХреНрдпрд╛рдВрд╢ рд╕реЗ рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ <code>code_challenge</code> рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЛ рдкреНрд░рд╢реНрди рдХрд╛ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: " <code>access_token</code> рдХреЛ рдЙрд╕реА рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрд░реЛрдз рдХрд┐рдпрд╛ <code>access_token</code> рдЬреЛ <code>code</code> рдЕрдиреБрд░реЛрдз рдХрд░рддрд╛ рд╣реИ, рдпрд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рджреНрд╡рд╛рд░рд╛?" <br><br><h4>  OAuth 2.0 CSRF </h4><br>  рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░, OAuth 2.0 рдХреЛ рдЕрдХреНрд╕рд░ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рддрдВрддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рд╣рдо рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВ, OAuth 2.0 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рдорд╛рдгреАрдХрд░рдг рдкреНрд░рд╛рдзрд┐рдХрд░рдг рд╕реЗ рднрд┐рдиреНрди рд╣реЛрддрд╛ рд╣реИ рдХрд┐ OAuth 2.0 рднреЗрджреНрдпрддрд╛ рд╕реЗрд╡рд╛ рдЧреНрд░рд╛рд╣рдХ рдХреЗ рдкрдХреНрд╖ рдореЗрдВ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддреА рд╣реИ, рдФрд░ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЛ рдирд╣реАрдВред  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, OAuth 2.0 рдкрд░ CSRF рдХрд╛ рд╣рдорд▓рд╛ рдЖрдкрдХреЛ рдХрд┐рд╕реА рдФрд░ рдХрд╛ рдЦрд╛рддрд╛ рдЪреБрд░рд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br>  рдЯреИрдХреНрд╕реА рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдФрд░ рдкреНрд░рджрд╛рддрд╛.рдХреЙрдо рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ OAuth 2.0 рдХреЗ рдЦрд┐рд▓рд╛рдл CSRF рд╣рдорд▓реЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдЕрдкрдиреЗ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ attacker@provider.com рдкрд░ рд▓реЙрдЧ рдСрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЯреИрдХреНрд╕реА <code>code</code> рд▓рд┐рдП рдПрдХ <code>code</code> рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред  рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдорд▓рд╛рд╡рд░ OAuth 2.0 рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрд╛рдзрд┐рдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рд▓рд┐рдВрдХ рдмрдирд╛рддрд╛ рд╣реИ: <br><br> <code>com.taxi.app://oauth? <br> code=b57b236c9bcd2a61fcd627b69ae2d7a6eb5bc13f2dc25311348ee08df43bc0c4 <br></code> <br>  рдлрд┐рд░ рд╣рдорд▓рд╛рд╡рд░ рдкреАрдбрд╝рд┐рдд рдХреЛ рдПрдХ рд▓рд┐рдВрдХ рднреЗрдЬрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЯреИрдХреНрд╕реА рдкреНрд░рд╢рд╛рд╕рди рд╕реЗ рдПрдХ рдкрддреНрд░ рдпрд╛ рдПрд╕рдПрдордПрд╕ рдХреА рдЖрдбрд╝ рдореЗрдВред  рдкреАрдбрд╝рд┐рдд рд▓рд┐рдВрдХ рдХрд╛ <code>access_token</code> рдХрд░рддрд╛ рд╣реИ, рдЙрд╕рдХреЗ рдлреЛрди рдкрд░ рдПрдХ рдЯреИрдХреНрд╕реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЦреБрд▓рддрд╛ рд╣реИ, рдЬреЛ <code>access_token</code> рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдкреАрдбрд╝рд┐рдд <b>рд╣рдорд▓рд╛рд╡рд░</b> рдХреЗ рдЯреИрдХреНрд╕реА рдЦрд╛рддреЗ рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред  рдкрдХрдбрд╝ рд╕реЗ рдЕрдирдЬрд╛рди, рдкреАрдбрд╝рд┐рдд рдЗрд╕ рдЦрд╛рддреЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: рдпрд╛рддреНрд░рд╛рдПрдВ рдХрд░рддрд╛ рд╣реИ, рдЕрдкрдиреЗ рдбреЗрдЯрд╛ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░рддрд╛ рд╣реИ, рдЖрджрд┐ред <br><br>  рдЕрдм, рдПрдХ рд╣рдорд▓рд╛рд╡рд░ рдХрд┐рд╕реА рднреА рд╕рдордп рдкреАрдбрд╝рд┐рдд рдХреЗ рдЯреИрдХреНрд╕реА рдЦрд╛рддреЗ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╡рд╣ рд╣рдорд▓рд╛рд╡рд░@рдкреНрд░реЛрд╡рд╛рдЗрдбрд░.рдХреЙрдо рд╕реЗ рдмрдВрдзрд╛ рд╣реИред  рд▓реЙрдЧрд┐рди рдкрд░ CSRF рдХреЗ рд╣рдорд▓реЗ рдиреЗ рдПрдХ рдЦрд╛рддрд╛ рдЪреЛрд░реА рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреАред <br><br>  CSRF рдХреЗ рд╣рдорд▓реЛрдВ рдХреЛ рдЖрдорддреМрд░ рдкрд░ CSRF рдЯреЛрдХрди (рдЬрд┐рд╕реЗ <code>state</code> рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ <code>state</code> ) рдХреЗ рд╕рд╛рде рд╕рдВрд░рдХреНрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ <code>state</code> , рдФрд░ OAuth 2.0 рдХреЛрдИ рдЕрдкрд╡рд╛рдж рдирд╣реАрдВ рд╣реИред  CSRF рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ: <br><br><ol><li>  рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЬреЗрдирд░реЗрдЯ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдореЛрдмрд╛рдЗрд▓ рдбрд┐рд╡рд╛рдЗрд╕ рдкрд░ CSRF рдЯреЛрдХрди рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИред </li><li>  рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ <code>code</code> рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдореЗрдВ CSRF рдЯреЛрдХрди рд╢рд╛рдорд┐рд▓ рд╣реИред </li><li>  рд╕рд░реНрд╡рд░ рдХреЛрдб рдХреЗ рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рд╕рдорд╛рди CSRF рдЯреЛрдХрди рд▓реМрдЯрд╛рддрд╛ рд╣реИред </li><li>  рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЗрдирдХрдорд┐рдВрдЧ рдФрд░ рд╕реНрдЯреЛрд░ рдХрд┐рдП рдЧрдП CSRF рдЯреЛрдХрди рдХреА рддреБрд▓рдирд╛ рдХрд░рддрд╛ рд╣реИред  рдпрджрд┐ рдорд╛рди рдореЗрд▓ рдЦрд╛рддреЗ рд╣реИрдВ, рддреЛ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдЬрд╛рд░реА рд░рд╣рддреА рд╣реИред </li></ol><br>  CSRF рдЯреЛрдХрди рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ: рдХрдо рд╕реЗ рдХрдо 256 рдмрд┐рдЯ рд▓рдВрдмреА, рдЫрджреНрдо рдЖрдпрд╛рдореА рджреГрд╢реНрдпреЛрдВ рдХреЗ рдПрдХ рдЕрдЪреНрдЫреЗ рд╕реНрд░реЛрдд рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХреАред <br><br>  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, CSRF рдЯреЛрдХрди рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЗрд╕ рд╕рд╡рд╛рд▓ рдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: "рдХреНрдпрд╛ рдореИрдВ <code>access_token</code> рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рд░рд╣рд╛ рдерд╛, рдпрд╛ рдХреЛрдИ рдореБрдЭреЗ рдзреЛрдЦрд╛ рджреЗрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИ?" <br><br><h4>  рдПрдХ рд╡реИрдз рдЧреНрд░рд╛рд╣рдХ рд╣реЛрдиреЗ рдХрд╛ рдирд╛рдЯрдХ рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдореИрд▓рд╡реЗрдпрд░ </h4><br>  рдХреБрдЫ рдореИрд▓рд╡реЗрдпрд░ рд╡реИрдз рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреА рдирдХрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЙрдирдХреА рдУрд░ рд╕реЗ рдПрдХ рд╕рд╣рдорддрд┐ рд╕реНрдХреНрд░реАрди рдмрдврд╝рд╛ рд╕рдХрддреЗ рд╣реИрдВ (рд╕рд╣рдорддрд┐ рд╕реНрдХреНрд░реАрди рдПрдХ рдРрд╕реА рд╕реНрдХреНрд░реАрди рд╣реИ, рдЬрд┐рд╕ рдкрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рджреЗрдЦрддрд╛ рд╣реИ: "рдореИрдВ ... рдХреЛ рдПрдХреНрд╕реЗрд╕ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╣рдордд рд╣реВрдВ")ред  рдЕрдкреНрд░рднрд╛рд╡реА рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "рдЕрдиреБрдорддрд┐" рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдореИрд▓рд╡реЗрдпрд░ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдВрдЪ рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИред <br><br>  рдПрдВрдбреНрд░реЙрдЗрдб рдФрд░ рдЖрдИрдУрдПрд╕ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдкрд╛рд░рд╕реНрдкрд░рд┐рдХ рд╕рддреНрдпрд╛рдкрди рдХреЗ рд▓рд┐рдП рддрдВрддреНрд░ рдкреНрд░рджрд╛рди рдХрд░рддреЗ рд╣реИрдВред  рдкреНрд░рджрд╛рддрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рд╡реИрдзрддрд╛ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрддред <br><br>  рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдЕрдЧрд░ OAuth 2.0 рддрдВрддреНрд░ рдПрдХ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдзрд╛рд░рд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рддреЛ рдЖрдк рдЗрд╕ рд╣рдорд▓реЗ рд╕реЗ рдмрдЪрд╛рд╡ рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред <br><br><h4>  рдЕрдиреНрдп рд╣рдорд▓реЗ </h4><br>  рд╣рдордиреЗ рдЙрди рд╣рдорд▓реЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬреЛ рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдХреЗ рд▓рд┐рдП рдЕрджреНрд╡рд┐рддреАрдп рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдирд┐рдпрдорд┐рдд OAuth 2.0 рдкрд░ рд╣рдорд▓реЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдордд рднреВрд▓рдирд╛: <code>redirect_uri</code> рд╕реНрдкреВрдлрд┐рдВрдЧ, рдПрдХ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдХрдиреЗрдХреНрд╢рди рдкрд░ рдпрд╛рддрд╛рдпрд╛рдд рдЕрд╡рд░реЛрдзрди, рдЖрджрд┐ред  рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдЙрдирдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h1>  рдХреНрдпрд╛ рдХрд░реЗрдВ? </h1><br>  рд╣рдордиреЗ рд╕реАрдЦрд╛ рдХрд┐ OAuth 2.0 рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдпрд╣ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ рдХрд┐ рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░ рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдХреНрдпрд╛ рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рдореМрдЬреВрдж рд╣реИрдВред  рдЕрдм рдЖрдЗрдП рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЯреБрдХрдбрд╝реЛрдВ рд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдпреЛрдЬрдирд╛ рдХреЛ рдПрдХ рд╕рд╛рде рд░рдЦреЗрдВред <br><br><h4>  рдЕрдЪреНрдЫрд╛, рдмреБрд░рд╛ OAuth 2.0 </h4><br>  рдЪрд▓рд┐рдП рд╢реБрд░реБрдЖрдд рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ рд╕рд╣рдорддрд┐ рд╕реНрдХреНрд░реАрди рдХреЛ рдареАрдХ рд╕реЗ рдмрдврд╝рд╛рдПрдВред  рдореЛрдмрд╛рдЗрд▓ рдЙрдкрдХрд░рдгреЛрдВ рдкрд░, рдореВрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рдПрдХ рд╡реЗрдм рдкреЗрдЬ рдЦреЛрд▓рдиреЗ рдХреЗ рджреЛ рддрд░реАрдХреЗ рд╣реИрдВ (рджреЗрд╢реА рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдЙрджрд╛рд╣рд░рдг: Mail.Ru рдореЗрд▓, рд╡реАрдХреЗ, рдлреЗрд╕рдмреБрдХ)ред <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ee/bd1/d02/7eebd1d02b5fa11a820fe37abbd1c552.png"><br><br>  рдкрд╣рд▓реА рд╡рд┐рдзрд┐ рдХреЛ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╕реНрдЯрдо рдЯреИрдм рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ (рдмрд╛рдИрдВ рдУрд░ рдХреА рддрд╕реНрд╡реАрд░ рдореЗрдВ)ред  <b>рдиреЛрдЯ</b> : рдПрдВрдбреНрд░реЙрдЗрдб рдкрд░ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╕реНрдЯрдо рдЯреИрдм рдХреЛ рдХреНрд░реЛрдо рдХрд╕реНрдЯрдо рдЯреИрдм рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ iOS SafariViewController рдкрд░ред  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдпрд╣ рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЯреИрдм рд╣реИ, рдЬреЛ рд╕реАрдзреЗ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддред  рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдмреАрдЪ рдХреЛрдИ рджреГрд╢реНрдп рд╕реНрд╡рд┐рдЪрд┐рдВрдЧ рдирд╣реАрдВ рд╣реИред <br><br>  рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рджреВрд╕рд░реА рд╡рд┐рдзрд┐ рдХреЛ "рдмрдврд╝рд╛рдПрдБ WebView" (рджрд╛рдИрдВ рдУрд░ рдХреА рддрд╕реНрд╡реАрд░ рдореЗрдВ) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдореИрдВ рдЗрд╕реЗ рдмрд╣реБрдд рдмреБрд░рд╛ рдорд╛рдирддрд╛ рд╣реВрдВред <br><br>  WebView рдПрдХ рджреЗрд╢реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдПрдХ рд╕реНрдЯреИрдВрдбрдЕрд▓реЛрди рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╣реИред <br><br>  <i>рдПрдХ</i> "рд╕реНрдЯреИрдВрдб-рдЕрд▓реЛрди <i>рдмреНрд░рд╛рдЙрдЬрд╝рд░</i> " рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╡реЗрдмрд╡реНрдпреВ, рдХреВрдлрд╝ рдФрд░ рдХреНрд░реЛрдо рдмреНрд░рд╛рдЙрдЬрд╝рд░ рд╕реЗ рдХреБрдХреАрдЬрд╝, рд╕реНрдЯреЛрд░реЗрдЬ, рдХреИрд╢, рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ рдЕрдиреНрдп рдбреЗрдЯрд╛ рддрдХ рдкрд╣реБрдБрдЪ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИред  рд░реВрдкрд╛рдВрддрд░рдг рднреА рд╕рд╣реА рд╣реИ: рд╕рдлрд╛рд░реА рдФрд░ рдХреНрд░реЛрдо рд╡реЗрдм рд╡реНрдпреВ рдбреЗрдЯрд╛ рддрдХ рдирд╣реАрдВ рдкрд╣реБрдВрдЪ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  " <i>рджреЗрд╢реА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░</i> " рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рд╡реЗрдмрд╡реНрдпреВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рд╡рд╛рд▓реЗ рдореВрд▓ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдХреБрдХреАрдЬрд╝, рд╕реНрдЯреЛрд░реЗрдЬ, рдХреИрд╢, рдЗрддрд┐рд╣рд╛рд╕ рдФрд░ рдЕрдиреНрдп рд╡реЗрдмрд╡реНрдпреВ рдбреЗрдЯрд╛ рддрдХ <b>рдкреВрд░реА</b> рдкрд╣реБрдВрдЪ рд╣реИред <br><br>  рдЕрдм рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ "рд▓реЙрдЧ рдЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ ..." рдмрдЯрди рджрдмрд╛рддрд╛ рд╣реИ рдФрд░ рджреБрд░реНрднрд╛рд╡рдирд╛рдкреВрд░реНрдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ WebView рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд╕реЗ рдЙрд╕рдХрд╛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рдорд╛рдВрдЧрддрд╛ рд╣реИред <br><br>  рд╕рднреА рдореЛрд░реНрдЪреЛрдВ рдкрд░ рдПрдХ рдмрд╛рд░ рд╡рд┐рдлрд▓рддрд╛: <br><br><ol><li>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рдХреЗ рдЦрд╛рддреЗ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЖрд╕рд╛рдиреА рд╕реЗ рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рдЪреБрд░рд╛ рд╕рдХрддрд╛ рд╣реИред </li><li>  OAuth 2.0 рдХреЛ рдореВрд▓ рд░реВрдк рд╕реЗ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ рддрд╛рдХрд┐ рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд╕реЗ <i>рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдирд╛рдо рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рди рдХрд┐рдпрд╛ рдЬрд╛</i> рд╕рдХреЗред </li><li>  рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдХрд╣реАрдВ рднреА рд▓реЙрдЧрд┐рди рдФрд░ рдкрд╛рд╕рд╡рд░реНрдб рджрд░реНрдЬ рдХрд░рдиреЗ рдХреА рдЖрджрдд рд╣реЛ рдЬрд╛рддреА рд╣реИ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдлрд╝рд┐рд╢рд┐рдВрдЧ</a> рдХреА рд╕рдВрднрд╛рд╡рдирд╛ рдмрдврд╝ рдЬрд╛рддреА рд╣реИред <br></li></ol><br>  рдпрд╣ рджреЗрдЦрддреЗ рд╣реБрдП рдХрд┐ рд╕рднреА рддрд░реНрдХ WebView рдХреЗ рд╡рд┐рд░реБрджреНрдз рд╣реИрдВ, рдпрд╣ рдирд┐рд╖реНрдХрд░реНрд╖ рд╕реНрд╡рдпрдВ рдмрддрд╛рддрд╛ рд╣реИ: рд╕рд╣рдорддрд┐ рд╕реНрдХреНрд░реАрди рдХреЗ рд▓рд┐рдП рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╕реНрдЯрдо рдЯреИрдм рдмрдврд╝рд╛рдПрдВред <br><br>  рдпрджрд┐ рдЖрдк рдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдХреЗ рдкрд╛рд╕ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╕реНрдЯрдо рдЯреИрдм рдХреЗ рдмрдЬрд╛рдп WebView рдХреЗ рдкрдХреНрд╖ рдореЗрдВ рддрд░реНрдХ рд╣реИрдВ, рддреЛ рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдореЗрдВ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд▓рд┐рдЦреЗрдВ, рдореИрдВ рдмрд╣реБрдд рдЖрднрд╛рд░реА рд░рд╣реВрдВрдЧрд╛ред <br><br><h4>  рд╕реБрд░рдХреНрд╖рд┐рдд рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдпреЛрдЬрдирд╛ </h4><br>  рд╣рдо рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдХреЛрдб рдЕрдиреБрджрд╛рди рдпреЛрдЬрдирд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╣рдореЗрдВ рдПрдХ <code>code_challenge</code> рдЬреЛрдбрд╝рдиреЗ рдФрд░ рдПрдХ рдХреЛрдб рдЕрд╡рд░реЛрдзрди рд╣рдорд▓реЗ рд╕реЗ <code>code_challenge</code> рдХреЛ рдмрдЪрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7cb/9fb/b7d/7cb9fbb7dcc35c74e921f18d22584254.png"><br>  <i>рдЫрд╡рд┐ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://tools.ietf.org/html/rfc8252#section-4.1</a> рд╕реЗ рд▓реА рдЧрдИ рд╣реИ</i> <br><br>  рдХреЛрдб рдЕрдиреБрд░реЛрдз (рдЪрд░рдг 1-2) рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛: <br><br> <code>https://o2.mail.ru/code? <br> redirect_uri=com.mail.cloud.app%3A%2F%2Foauth&amp; <br> anti_csrf=927489cb2fcdb32e302713f6a720397868b71dd2128c734181983f367d622c24&amp; code_challenge=ZjYxNzQ4ZjI4YjdkNWRmZjg4MWQ1N2FkZjQzNGVkODE1YTRhNjViNjJjMGY5MGJjNzdiOGEzMDU2ZjE3NGFiYw%3D%3D&amp; <br> code_challenge_method=S256&amp; <br> scope=email%2Cid&amp; <br> response_type=code&amp; <br> client_id=984a644ec3b56d32b0404777e1eb73390c <br></code> <br>  рдЪрд░рдг 3 рдореЗрдВ, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХреЛ рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рд┐рдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓рддреА рд╣реИ: <br><br> <code>com.mail.cloud.app://outh? <br> code=b57b236c9bcd2a61fcd627b69ae2d7a6eb5bc13f2dc25311348ee08df43bc0c4&amp; <br> anti_csrf=927489cb2fcdb32e302713f6a720397868b71dd2128c734181983f367d622c24</code> <br> <br>  рдЪрд░рдг 4 рдореЗрдВ, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╕реНрдЯрдо рдпреВрдЖрд░рдЖрдИ рдпреЛрдЬрдирд╛ рдЦреЛрд▓рддрд╛ рд╣реИ рдФрд░ <code>code</code> рдФрд░ рд╕реАрдПрд╕рдЖрд░рдПрдл рдЯреЛрдХрди рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИред <br><br>  <code>access_token</code> (рдЪрд░рдг 5) рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз: <br><br> <code>https://o2.mail.ru/token? <br> code_verifier=e61748f28b7d5daf881d571df434ed815a4a65b62c0f90bc77b8a3056f174abc&amp; <br> code=b57b236c9bcd2a61fcd627b69ae2d7a6eb5bc13f2dc25311348ee08df43bc0c4&amp; <br> client_id=984a644ec3b56d32b0404777e1eb73390c <br></code> <br>  рдЕрдВрддрд┐рдо рдЪрд░рдг <code>access_token</code> рд╕рд╛рде рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИред <br><br>  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдЙрдкрд░реЛрдХреНрдд рдпреЛрдЬрдирд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рд╣реИ, рд▓реЗрдХрд┐рди рдРрд╕реЗ рд╡рд┐рд╢реЗрд╖ рдорд╛рдорд▓реЗ рднреА рд╣реИрдВ рдЬрд┐рдирдореЗрдВ OAuth 2.0 рдХреЛ рд╕рд░рд▓ рдФрд░ рдереЛрдбрд╝рд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><h4>  Android IPC </h4><br>  рдПрдВрдбреНрд░реЙрдЗрдб рдореЗрдВ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдмреАрдЪ рджреЛ-рддрд░рдлрд╝рд╛ рдбреЗрдЯрд╛ рд╡рд┐рдирд┐рдордп рдХреЗ рд▓рд┐рдП рдПрдХ рддрдВрддреНрд░ рд╣реИ: IPC (рдЕрдВрддрд░-рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╕рдВрдЪрд╛рд░)ред  IPC рдХреЛ рджреЛ рдХрд╛рд░рдгреЛрдВ рд╕реЗ рдХрд╕реНрдЯрдо URI рдпреЛрдЬрдирд╛ рд╕реЗ рдЕрдзрд┐рдХ рдкрд╕рдВрдж рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: <br><br><ol><li>  рдПрдХ рдЖрдИрдкреАрд╕реА рдЪреИрдирд▓ рдЦреЛрд▓рдиреЗ рд╡рд╛рд▓рд╛ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЕрдкрдиреЗ рдкреНрд░рдорд╛рдгрдкрддреНрд░ рджреНрд╡рд╛рд░рд╛ рдЦреЛрд▓реЗ рдЧрдП рдЖрд╡реЗрджрди рдХреА рдкреНрд░рд╛рдорд╛рдгрд┐рдХрддрд╛ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рд░реВрдкрд╛рдВрддрд░рдг рднреА рд╕рддреНрдп рд╣реИ: рдПрдХ рдЦреБрд▓рд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЙрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдкреНрд░рд╛рдорд╛рдгрд┐рдХрддрд╛ рдХреЛ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬрд┐рд╕рдиреЗ рдЗрд╕реЗ рдЦреЛрд▓рд╛ рдерд╛ред </li><li>  рдЖрдИрдкреАрд╕реА рдЪреИрдирд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдХ рдЕрдиреБрд░реЛрдз рднреЗрдЬрдХрд░, рдкреНрд░реЗрд╖рдХ рдЙрд╕реА рдЪреИрдирд▓ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдЖрдкрд╕реА рд╕рддреНрдпрд╛рдкрди (рдЖрдЗрдЯрдо 1) рдХреЗ рд╕рд╛рде, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХреЛрдИ рднреА рддреГрддреАрдп-рдкрдХреНрд╖ рдкреНрд░рдХреНрд░рд┐рдпрд╛ <code>access_token</code> рдХреЛ рдмрд╛рдзрд┐рдд рдирд╣реАрдВ рдХрд░ <code>access_token</code> ред </li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/693/84d/6f6/69384d6f63788694137f8d559d6469fa.png"><br><br>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Implicit Grant рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдпреЛрдЬрдирд╛ рдХреЛ рд╕рд░рд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдХреЛрдИ <code>code_challenge</code> рдФрд░ CSRF рдЯреЛрдХрди рдирд╣реАрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рд╕реНрд╡рдпрдВ рдХреЛ рдореИрд▓рд╡реЗрдпрд░ рд╕реЗ рдмрдЪрд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдВрдЧреЗ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЦрд╛рддреЛрдВ рдХреЛ рдЪреЛрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡реИрдз рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреА рдирдХрд▓ рдХрд░рддреЗ рд╣реИрдВред <br><br><h4>  рдЧреНрд░рд╛рд╣рдХ рдПрд╕рдбреАрдХреЗ </h4><br>  рдКрдкрд░ рд╡рд░реНрдгрд┐рдд рд╕реБрд░рдХреНрд╖рд┐рдд рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдпреЛрдЬрдирд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкреНрд░рджрд╛рддрд╛ рдХреЛ рдЕрдкрдиреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рдПрд╕рдбреАрдХреЗ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдпрд╣ рдЧреНрд░рд╛рд╣рдХ рдкрдХреНрд╖ рдкрд░ OAuth 2.0 рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░реЗрдЧрд╛ рдФрд░ рд╕рд╛рде рд╣реА рддреНрд░реБрдЯрд┐рдпреЛрдВ рдФрд░ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдХреЛ рдХрдо рдХрд░реЗрдЧрд╛ред <br><br><h1>  рдирд┐рд╖реНрдХрд░реНрд╖ рдирд┐рдХрд╛рд▓рдирд╛ </h1><br>  OAuth 2.0 рдкреНрд░рджрд╛рддрд╛рдУрдВ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ "рд╕рд┐рдХреНрдпреЛрд░ рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдЪреЗрдХрд▓рд┐рд╕реНрдЯ" рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛: <br><br><ol><li>  рдПрдХ рдареЛрд╕ рдиреАрдВрд╡ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред  рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдзрд╛рд░ рдпреЛрдЬрдирд╛ рдпрд╛ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪреБрдирддреЗ рд╣реИрдВред  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдкрдирд╛ OAuth 2.0 рд╕реНрдХреАрдорд╛ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╕рдордп,</a> рдПрдХ рдЧрд▓рддреА рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИред  рджреВрд╕рд░реЛрдВ рдиреЗ рдкрд╣рд▓реЗ рд╣реА рдзрдХреНрдХреЛрдВ рдХреЛ рднрд░ рджрд┐рдпрд╛ рд╣реИ рдФрд░ рдирд┐рд╖реНрдХрд░реНрд╖ рдмрдирд╛ рджрд┐рдпрд╛ рд╣реИ, рдЙрдирдХреА рдЧрд▓рддрд┐рдпреЛрдВ рд╕реЗ рд╕реАрдЦрдиреЗ рдФрд░ рддреБрд░рдВрдд рдПрдХ рд╕реБрд░рдХреНрд╖рд┐рдд рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд░рдиреЗ рдореЗрдВ рдХреБрдЫ рднреА рдЧрд▓рдд рдирд╣реАрдВ рд╣реИред  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╕рдмрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдпреЛрдЬрдирд╛ рд╡реНрд╣рд╛рдЯ рдЯреВ рдбреВ рд╕реЗрдХреНрд╢рди рдореЗрдВ рдПрдХ рд╣реИред </li><li>  <code>Access_token</code> рдФрд░ рдЕрдиреНрдп рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдбреЗрдЯрд╛: iOS рдХреЗ рддрд╣рдд - рдХрд┐рдЪреЗрди рдореЗрдВ, рдПрдВрдбреНрд░реЙрдЗрдб рдХреЗ рддрд╣рдд - рдЗрдВрдЯрд░рдирд▓ рд╕реНрдЯреЛрд░реЗрдЬ рдореЗрдВред  рдпреЗ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдРрд╕реЗ рдЙрджреНрджреЗрд╢реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдП рдЧрдП рд╣реИрдВред  рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╣реЛ, рддреЛ рдЖрдк рдПрдВрдбреНрд░реЙрдЗрдб рдореЗрдВ рд╕рд╛рдордЧреНрд░реА рдкреНрд░рджрд╛рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕реЗ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред </li><li>  <code>Code</code> рдПрдХ рд╕рдордп рдХрд╛ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдПрдХ рдЫреЛрдЯреЗ рдЬреАрд╡рди рд╕рдордп рдХреЗ рд╕рд╛рдеред </li><li>  рдХреЛрдб рдЕрд╡рд░реЛрдзрди рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <code>code_challenge</code> рдЙрдкрдпреЛрдЧ <code>code_challenge</code> ред </li><li>  рд▓реЙрдЧрд┐рди рдкрд░ рдПрдХ рд╕реАрдПрд╕рдЖрд░рдПрдл рд╣рдорд▓реЗ рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╕реАрдПрд╕рдЖрд░рдПрдл рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </li><li>  рд╕рд╣рдорддрд┐ рд╕реНрдХреНрд░реАрди рдХреЗ рд▓рд┐рдП WebView рдХрд╛ рдЙрдкрдпреЛрдЧ рди рдХрд░реЗрдВ, рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдХрд╕реНрдЯрдо рдЯреИрдм рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </li><li>  рдЕрдЧрд░ рдпрд╣ рдмреИрдХрдПрдВрдб рдкрд░ рд╕рдВрдЧреНрд░рд╣реАрдд рдирд╣реАрдВ рд╣реИ рддреЛ <code>Client_secret</code> <b>рдмреЗрдХрд╛рд░</b> рд╣реИред  рдЗрд╕реЗ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рди рджреЗрдВред </li><li>  HTTP рдкрд░ рдбрд╛рдЙрдирдЧреНрд░реЗрдб рдХреЗ рдирд┐рд╖реЗрдз рдХреЗ рд╕рд╛рде, <b>рд╣рд░ рдЬрдЧрд╣</b> HTTPS рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред </li><li>  <b>рдорд╛рдирдХреЛрдВ рд╕реЗ</b> рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА рд╕рд┐рдлрд╛рд░рд┐рд╢реЛрдВ (рд╕рд┐рдлрд░ рдЪрдпрди, рдЯреЛрдХрди рд▓рдВрдмрд╛рдИ, рдЖрджрд┐) рдХрд╛ рдкрд╛рд▓рди рдХрд░реЗрдВред  рдЖрдк рдбреЗрдЯрд╛ рдХреА рдкреНрд░рддрд┐рд▓рд┐рдкрд┐ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкрддрд╛ рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдРрд╕рд╛ рдХреНрдпреЛрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЖрдк рдЕрдкрдиреА рдХреНрд░рд┐рдкреНрдЯреЛрдЧреНрд░рд╛рдлреА рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ</a> ред </li><li>  рдХреНрд▓рд╛рдЗрдВрдЯ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ, рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдЖрдк OAuth 2.0 рдХреЗ рд▓рд┐рдП рдХреМрди рдЦреЛрд▓рддреЗ рд╣реИрдВ, рдФрд░ рдкреНрд░рджрд╛рддрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ, рдЬрд╛рдБрдЪ рдХрд░реЗрдВ рдХрд┐ OAuth 2.0 рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреМрди рдЦреЛрд▓рддрд╛ рд╣реИред </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд╛рдорд╛рдиреНрдп OAuth 2.0 рдХрдордЬреЛрд░рд┐рдпреЛрдВ рд╕реЗ</a> рдЕрд╡рдЧрдд рд░рд╣реЗрдВред  рдореЛрдмрд╛рдЗрд▓ OAuth 2.0 рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдирд┐рдпрдорд┐рдд рд░реВрдк рд╕реЗ рдкреВрд░рдХ рд╣реЛрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдХрд┐рд╕реА рдиреЗ рдирд┐рдпрдорд┐рдд OAuth 2.0 рдХреЗ рд▓рд┐рдП рд╕рдЯреАрдХ рдореИрдЪреЛрдВ рдФрд░ рдЕрдиреНрдп рд╕рд┐рдлрд╛рд░рд┐рд╢реЛрдВ рдХреЗ рд▓рд┐рдП <code>redirect_uri</code> рдЪреЗрдХ рдХреЛ рд░рджреНрдж рдирд╣реАрдВ рдХрд┐рдпрд╛ред </li><li>  рдПрд╕рдбреАрдХреЗ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреЛ рдкреНрд░рджрд╛рди рдХрд░рдирд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВред  рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЗ рдкрд╛рд╕ рдХреЛрдб рдореЗрдВ рдХрдо рдмрдЧ рдФрд░ рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рд╣реЛрдВрдЧреА, рдФрд░ рдЖрдкрдХреЗ рд▓рд┐рдП рдЖрдкрдХреЗ OAuth 2.0 рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реЛрдЧрд╛ред </li></ol><br><h1>  рдХреНрдпрд╛ рдкрдврд╝рдирд╛ рд╣реИ? </h1><br><ol><li>  [RFC] OAuth 2.0 рдиреЗрдЯрд┐рд╡ рдПрдкреНрд╕ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://tools.ietf.org/html/rfc8252</a> </li><li>  рдореЛрдмрд╛рдЗрд▓ рдФрд░ рдбреЗрд╕реНрдХрдЯреЙрдк рдРрдкреНрд╕ рдХреЗ рд▓рд┐рдП Google OAuth 2.0 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://developers.google.com/identity/protocols/OAuth2EInallerApps</a> </li><li>  [RFC] OAuth рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЧреНрд░рд╛рд╣рдХреЛрдВ рджреНрд╡рд╛рд░рд╛ рдХреЛрдб рдПрдХреНрд╕рдЪреЗрдВрдЬ рдХреЗ рд▓рд┐рдП рд╕рдмреВрдд <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://tools.ietf.org/html/rfc7636</a> </li><li>  OAuth 2.0 рд░реЗрд╕ рдХрдВрдбреАрд╢рди <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://hackerone.com/reports/55140</a> </li><li>  [RFC] OAuth 2.0 рдЦрддрд░рд╛ рдореЙрдбрд▓ рдФрд░ рд╕реБрд░рдХреНрд╖рд╛ рд╕рдВрдмрдВрдзреА рд╡рд┐рдЪрд╛рд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://tools.ietf.org/html/rfcF6819</a> </li><li>  рдирд┐рдпрдорд┐рдд OAuth 2.0 рдкрд░ рд╣рдорд▓реЛрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://sakurity.com/oauth</a> </li><li>  [RFC] OAuth 2.0 рдбрд╛рдпрдиреЗрдорд┐рдХ рдХреНрд▓рд╛рдЗрдВрдЯ рдкрдВрдЬреАрдХрд░рдг рдкреНрд░реЛрдЯреЛрдХреЙрд▓ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">https://tools.ietf.org/html/rfc7591</a> </li></ol><br><h1>  рдзрдиреНрдпрд╡рд╛рдж </h1><br>  рд╣рд░ рдХрд┐рд╕реА рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдЗрд╕ рд▓реЗрдЦ рдХреЛ рд▓рд┐рдЦрдиреЗ рдореЗрдВ рдорджрдж рдХреА, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рд╕рд░реНрдЧреЗрдИ рдмреЗрд▓реЛрд╡, рдПрдВрдбреНрд░реА рд╕реНрдпреВрдорд┐рди, рдПрдВрдбреНрд░реА рд▓реИрдмрдВрдЯреНрд╕ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">@isciurus</a> ) рдФрд░ рдбрд╛рд░рд┐рдпрд╛ рдпрд╛рдХреЛрд╡рд▓реЗрд╡рд╛ред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi417031/">https://habr.com/ru/post/hi417031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi417015/index.html">рд╣рдо рд╕рдордЭрддреЗ рд╣реИрдВ рдХрд┐ рдмрд░реНрдЧрд░ рдХрд┐рдВрдЧ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреНрдпрд╛ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддрд╛ рд╣реИ рдФрд░ рдХреНрдпрд╛ рдирд╣реАрдВ</a></li>
<li><a href="../hi417017/index.html">рдХреИрд╕реЗ рдПрдХ рдЕрд╕рдлрд▓ рдкрд░рдорд╛рдгреБ рдкреНрд░рдпреЛрдЧ рдиреЗ рдЧрд▓рддреА рд╕реЗ рдиреНрдпреВрдЯреНрд░рд┐рдиреЛ рдЦрдЧреЛрд▓ рд╡рд┐рдЬреНрдЮрд╛рди рдЙрддреНрдкрдиреНрди рдХрд┐рдпрд╛</a></li>
<li><a href="../hi417023/index.html">рд░реЗрдореНрдмрд▓рд░ рд╕рдореВрд╣ рдХрд╛ рдЕрдиреБрднрд╡: рд╣рдордиреЗ рдлреНрд░рдВрдЯ-рдПрдВрдб рд░рд┐рдПрдХреНрдЯ рдШрдЯрдХреЛрдВ рдХреЗ рдЧрдарди рдФрд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХреИрд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛</a></li>
<li><a href="../hi417027/index.html">рдореИрдВрдиреЗ рдорд╛рдирдХ C ++ 11 рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЛ рдХреИрд╕реЗ рд▓рд┐рдЦрд╛ рд╣реИ рдпрд╛ рдмреВрд╕реНрдЯ рдЗрддрдирд╛ рдбрд░рд╛рд╡рдирд╛ рдХреНрдпреЛрдВ рд╣реИред рдкрд░рд┐рдЪрдп</a></li>
<li><a href="../hi417029/index.html">рдПрд▓рдПрд▓рд╡реАрдПрдо рдХреЗ рд╕рд╛рде рдХреЛрдб рдкреНрд░реЛрдлрд╛рдЗрд▓рд┐рдВрдЧ</a></li>
<li><a href="../hi417033/index.html">7 рдЬреВрди рдХреЛ QIWI рдХрд┐рдЪрди - рд╣рдорд╛рд░реЗ рд╡рдХреНрддрд╛рдУрдВ рдХреЗ рднрд╛рд╖рдгреЛрдВ рдХрд╛ рд╡реАрдбрд┐рдпреЛ</a></li>
<li><a href="../hi417035/index.html">рдЙрдиреНрдиреАрд╡рд░реНрд▓реНрдб: рдкреЛрд╕реНрдЯрдорд╛рд░реНрдЯрдо</a></li>
<li><a href="../hi417037/index.html">BEERBRAZZERSред рдкреНрд░рдХрд╛рд╢ рдирд┐рдпрдВрддреНрд░рдгред рд╡рд┐рдХреНрд╕реЗрди рд▓рд╛рдЗрдЯреНрд╕ 3. рдХреНрд╡рд┐рдХ рд╕реНрдЯрд╛рд░реНрдЯ (1/4)</a></li>
<li><a href="../hi417039/index.html">Youtube рдЦрд┐рд▓рд╛рдбрд╝рд┐рдпреЛрдВ рдХреЛ рдЬрд▓реНрджреА рд╕реЗ рдкреНрд░рд╕реНрддреБрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд░реНрдбрдкреНрд░реЗрд╕ (рдФрд░ рдЕрдзрд┐рдХ) рдЬрд╛рдиреЗрдВ</a></li>
<li><a href="../hi417041/index.html">рдПрд╕реНрд▓рд┐рдВрдЯ-рд╕реНрдХреЛрдк v3.7.2 рдПрдирдкреАрдПрдо рдЯреЛрдХрди рдЪреБрд░рд╛рддрд╛ рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>