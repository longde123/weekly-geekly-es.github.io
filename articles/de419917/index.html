<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üññüèæ ü§æ üéº Neuronale Netze: Umsetzung der Aufgabe √ºber Pilze auf Tensor Flow und Python üêä ‚õπüèæ üßíüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tensor Flow ist ein Framework zum Aufbau und zur Arbeit mit neuronalen Netzen von Google. Erm√∂glicht es Ihnen, von den internen Details des maschinell...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Neuronale Netze: Umsetzung der Aufgabe √ºber Pilze auf Tensor Flow und Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419917/">  Tensor Flow ist ein Framework zum Aufbau und zur Arbeit mit neuronalen Netzen von Google.  Erm√∂glicht es Ihnen, von den internen Details des maschinellen Lernens zu abstrahieren und sich direkt auf die L√∂sung Ihres Problems zu konzentrieren.  Es ist eine sehr leistungsstarke Funktion, mit der Sie neuronale Netze aller bekannten Typen erstellen, trainieren und verwenden k√∂nnen.  Ich habe zu diesem Thema keinen einzigen vern√ºnftigen Text √ºber Habr√© gefunden, also schreibe ich meinen eigenen.  Im Folgenden wird die Implementierung der L√∂sung f√ºr das Problem der Pilze mithilfe der Tensor Flow-Bibliothek beschrieben.  Der unten beschriebene Algorithmus eignet sich √ºbrigens f√ºr Vorhersagen in nahezu jedem Bereich.  Zum Beispiel die Wahrscheinlichkeit von Krebs bei einer Person in der Zukunft oder Karten bei einem Gegner beim Poker. <a name="habracut"></a><br><br><h3>  Herausforderung </h3><br>  Das Wesentliche des Problems: Auf der Grundlage der Eingabeparameter des Pilzes, um seine Essbarkeit zu bestimmen.  Die Besonderheit ist, dass diese Parameter kategorisch und nicht numerisch sind.  Beispielsweise kann der Parameter "Hutform" auf "flach" oder "konvex" oder "kegelf√∂rmig" eingestellt werden.  Pilzdatensatz f√ºr das Netzwerklernen aus dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repository</a> f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">maschinelles Lernen</a> .  Daher kann die L√∂sung des Problems als eine Art Hallo-Welt im Bereich des maschinellen Lernens bezeichnet werden, zusammen mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Problem der Iris</a> , bei der die Blumenparameter in digitalen Werten ausgedr√ºckt werden. <br><br><h3>  Quellcode </h3><br>  Sie k√∂nnen alle Quellen aus meinem Repository auf Github herunterladen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> .  Tun Sie dies, um den Code in Aktion zu sehen.  Verwenden Sie nur Quellcodes, da dort alle erforderlichen Einr√ºckungen und Codierungen beachtet werden.  Im Folgenden wird der gesamte Prozess ausf√ºhrlich besprochen. <br><br><h3>  Vorbereitung </h3><br>  Es wird davon ausgegangen, dass Sie eine vorinstallierte Tensor Flow-Installation haben.  Wenn nicht, k√∂nnen Sie den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Link</a> installieren. <br><br><h3>  Quellcode </h3><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-comment"><span class="hljs-comment">#       . #     CSV-    Tensor Flow       .  ,       (0  1) def prepare_data(data_file_name): header = ['class', 'cap_shape', 'cap_surface', #  CSV-   ,     'agaricus-lepiota.name'   'cap_color', 'bruises', 'odor', 'gill_attachment', 'gill_spacing', 'gill_size', 'gill_color', 'stalk_shape', 'stalk_root', 'stalk_surface_above_ring', 'stalk_surface_below_ring', 'stalk_color_above_ring', 'stalk_color_below_ring', 'veil_type', 'veil_color', 'ring_number', 'ring_type', 'spore_print_color', 'population', 'habitat'] df = pd.read_csv(data_file_name, sep=',', names=header) #   "?"      #        df.replace('?', np.nan, inplace=True) df.dropna(inplace=True) #         #  'e'  'p' .       # ,   0  , 1 -    df['class'].replace('p', 0, inplace=True) df['class'].replace('e', 1, inplace=True) #       , #     . Tensor Flow      # .  Pandas    "get_dummies" #      cols_to_transform = header[1:] df = pd.get_dummies(df, columns=cols_to_transform) #      #    -    () #      () df_train, df_test = train_test_split(df, test_size=0.1) #           num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #      csv-, .. #          #  csv,    Tensor Flow df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #     ,    open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read()) #   ,     os.remove("train_temp.csv") os.remove("test_temp.csv") #        Tensor Flow def get_test_inputs(): x = tf.constant(test_set.data) y = tf.constant(test_set.target) return x, y #        Tensor Flow def get_train_inputs(): x = tf.constant(training_set.data) y = tf.constant(training_set.target) return x, y #        #    ( : , ) #  ,         def new_samples(): return np.array([[0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1]], dtype=np.int) if __name__ == "__main__": MUSHROOM_DATA_FILE = "agaricus-lepiota.data" #     Tensor Flow, #   CSV- (  ) prepare_data(MUSHROOM_DATA_FILE) #    training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_train.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_test.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) # ,        ( ) feature_columns = [tf.contrib.layers.real_valued_column("", dimension=98)] #   DNN-  10, 20  10    classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=2, model_dir="/tmp/mushroom_model") #   classifier.fit(input_fn=get_train_inputs, steps=2000) #        accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=1)["accuracy"] print("\n : {0:f}\n".format(accuracy_score)) #         predictions = list(classifier.predict_classes(input_fn=new_samples)) print("   : {}\n" .format(predictions))</span></span></code> </pre> <br><h3>  Laden Sie Daten aus dem Repository herunter und bereiten Sie sie vor </h3><br>  Wir werden die Daten zum Trainieren und Testen des neuronalen Netzwerks aus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dem</a> speziell daf√ºr erstellten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repository</a> f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">maschinelles Lernen</a> herunterladen.  Alle Daten werden in zwei Dateien dargestellt: agaricus-lepiota.data und agaricus-lepiota.names.  Die ersten 8124 Zeilen und 22 Spalten.  Eine Zeile enth√§lt einen Pilz, jede Spalte ist einer der 22 Parameter des Pilzes in Form eines Reduktionszeichens aus dem gesamten Parameterwort.  Die Legende aller Zeichen befindet sich in der Datei agarius-lepiota.names. <br><br>  Daten aus dem Repository m√ºssen verarbeitet werden, um eine f√ºr Tensor Flow akzeptable Form zu erhalten.  Zuerst importieren wir einige Bibliotheken f√ºr die Arbeit <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os</code> </pre> <br>  Dann bilden wir aus den Parametern des Pilzes f√ºr Tensor Flow einen Header, damit die Bibliothek wei√ü, welche Spalte in der Datendatei welchem ‚Äã‚ÄãParameter entspricht.  Der Hut wird auf die Datendatei geklebt.  Wir bilden in Form eines Arrays, dessen Elemente aus der Datei agaricus-lepiota.names stammen. <br><br><pre> <code class="python hljs">header = [<span class="hljs-string"><span class="hljs-string">'class'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_surface'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'bruises'</span></span>, <span class="hljs-string"><span class="hljs-string">'odor'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_attachment'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_spacing'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_size'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_root'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_number'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'spore_print_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'population'</span></span>, <span class="hljs-string"><span class="hljs-string">'habitat'</span></span>] df = pd.read_csv(data_file_name, sep=<span class="hljs-string"><span class="hljs-string">','</span></span>, names=header)</code> </pre> <br>  Jetzt m√ºssen Sie sich mit den fehlenden Daten befassen.  In diesem Fall wird das Symbol "?" In der Datei agaricus-lepiota.data anstelle des Parameters festgelegt.  Es gibt viele Methoden, um solche F√§lle zu behandeln, aber wir werden einfach die gesamte Zeile mit mindestens einem fehlenden Parameter l√∂schen. <br><br><pre> <code class="python hljs">df.replace(<span class="hljs-string"><span class="hljs-string">'?'</span></span>, np.nan, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  Als N√§chstes m√ºssen Sie den symbolischen Essbarkeitsparameter manuell durch einen digitalen ersetzen.  Das hei√üt, ersetzen Sie "p" und "e" durch 0 und 1. <br><br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'p'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br>  Danach k√∂nnen Sie den Rest der Daten in eine Ziffer konvertieren.  Dies ist, was die Funktion get_dummies der Pandas-Bibliothek tut. <br><br><pre> <code class="python hljs">cols_to_transform = header[<span class="hljs-number"><span class="hljs-number">1</span></span>:] df = pd.get_dummies(df, columns=cols_to_transform)</code> </pre> <br>  Jedes neuronale Netzwerk muss trainiert werden.  Daneben muss es aber auch kalibriert werden, um die Arbeitsgenauigkeit unter realen Bedingungen zu erh√∂hen.  Dazu teilen wir unseren Datensatz in zwei Bereiche auf - Training und Kalibrierung.  Der erste ist gr√∂√üer als der zweite, wie es sein sollte. <br><br><pre> <code class="python hljs">df_train, df_test = train_test_split(df, test_size=<span class="hljs-number"><span class="hljs-number">0.1</span></span>)</code> </pre> <br>  Und der letzte.  F√ºr Tensor Flow muss die Anzahl der Zeilen und Spalten der Datei am Anfang der Datendateien angegeben werden.  Wir werden diese Informationen manuell aus unseren Trainings- und Kalibrierungsdatens√§tzen extrahieren und dann in die resultierenden CSV-Dateien schreiben. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#         num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #     CSV df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #       CSV,      open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read())</span></span></code> </pre> <br>  Am Ende sollten Sie diese Dateien erhalten: <a href="">Training</a> und <a href="">Kalibrierung</a> . <br><br><h3>  Werfen Sie die generierten Daten in Tensor Flow </h3><br>  Nachdem wir die CSV-Dateien aus dem Repository heruntergeladen und mit Pilzdaten verarbeitet haben, k√∂nnen Sie sie zur Schulung an Tensor Flow senden.  Dies erfolgt mit der Funktion load_csv_with_header (), die vom Framework selbst bereitgestellt wird: <br><br><pre> <code class="python hljs">training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_train.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_test.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  Die Funktion load_csv_with_header () bildet einen Trainingsdatensatz aus den oben gesammelten Dateien.  Zus√§tzlich zur Datendatei verwendet die Funktion target_dtype als Argument. Dies ist ein Datentyp, der am Ende vorhergesagt wird.  In unserem Fall ist es notwendig, dem neuronalen Netzwerk beizubringen, die Essbarkeit oder Toxizit√§t des Pilzes vorherzusagen, was durch die Werte 1 oder 0 ausgedr√ºckt werden kann. In unserem Fall ist target_dtype also ein ganzzahliger Wert.  features_dtype - Parameter, bei dem der Typ der f√ºr das Training akzeptierten Parameter festgelegt wird.  In unserem Fall ist es auch eine Ganzzahl (anfangs waren sie Zeichenfolgen, aber wie Sie sich erinnern, haben wir sie in eine Zahl umgewandelt).  Am Ende wird der Parameter target_column festgelegt. Dies ist der Index der Spalte mit dem Parameter, den das neuronale Netzwerk vorhersagen soll.  Das hei√üt, mit dem Essbarkeitsparameter. <br><br><h3>  Erstellen Sie ein Tensor Flow Classifier-Objekt </h3><br>  Das hei√üt, ein Objekt einer Klasse, das direkt an der Vorhersage des Ergebnisses beteiligt ist.  Mit anderen Worten, die Klasse des neuronalen Netzwerks selbst. <br><br><pre> <code class="python hljs">feature_columns = [tf.contrib.layers.real_valued_column(<span class="hljs-string"><span class="hljs-string">""</span></span>, dimension=<span class="hljs-number"><span class="hljs-number">98</span></span>)] classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], n_classes=<span class="hljs-number"><span class="hljs-number">2</span></span>, model_dir=<span class="hljs-string"><span class="hljs-string">"/tmp/mushroom_model"</span></span>)</code> </pre> <br>  Der erste Parameter ist feature_columns.  Dies sind die Parameter von Pilzen.  Bitte beachten Sie, dass der Parameterwert genau dort etwas h√∂her erstellt wird.  Dort wird am Eingang der Wert 98 des Dimensionsparameters genommen, dh 98 verschiedene Parameter des Pilzes mit Ausnahme der Essbarkeit. <br><br>  hidden_units - Die Anzahl der Neuronen in jeder Schicht des neuronalen Netzwerks.  Die richtige Auswahl der Anzahl der Schichten und Neuronen in ihnen ist etwas auf der Ebene der Kunst im Bereich des maschinellen Lernens.  Es ist m√∂glich, diese Werte erst nach Erfahrung korrekt zu bestimmen.  Wir haben diese Zahlen nur genommen, weil sie in einem der Tensor Flow-Tutorials aufgef√ºhrt sind.  Und sie arbeiten. <br><br>  n_classes - Die Anzahl der vorherzusagenden Klassen.  Wir haben zwei davon - essbar und nicht. <br><br>  model_dir - Der Pfad, in dem das trainierte Modell des neuronalen Netzwerks gespeichert wird.  Und in Zukunft wird es verwendet, um Ergebnisse vorherzusagen, um das Netzwerk nicht jedes Mal zu trainieren. <br><br><h3>  Schulung </h3><br>  Um die Arbeit in Zukunft zu vereinfachen, werden wir zwei Funktionen erstellen: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_test_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(test_set.data) y = tf.constant(test_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_train_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(training_set.data) y = tf.constant(training_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y</code> </pre> <br>  Jede Funktion stellt ihre eigenen Eingabedaten bereit - zum Training und zur Kalibrierung.  x und y sind die Tensor Flow-Konstanten, die das Framework zum Arbeiten ben√∂tigt.  Gehen Sie nicht auf Details ein, sondern akzeptieren Sie nur, dass diese Funktionen ein Vermittler zwischen Daten und einem neuronalen Netzwerk sein sollten. <br><br>  Wir trainieren ein Netzwerk: <br><br><pre> <code class="python hljs">classifier.fit(input_fn=get_train_inputs, steps=<span class="hljs-number"><span class="hljs-number">2000</span></span>)</code> </pre> <br>  Der erste Parameter verwendet die direkt dar√ºber gebildeten Eingabedaten, der zweite die Anzahl der Trainingsschritte.  Auch hier wurde die Nummer in einem der Tensor Flow-Handb√ºcher verwendet, und das Verst√§ndnis dieser Einstellung wird Ihnen mit Erfahrung einfallen. <br><br>  Kalibrieren Sie als N√§chstes das trainierte Netzwerk.  Dies erfolgt anhand des oben generierten Kalibrierungsdatensatzes.  Das Ergebnis der Arbeit wird die Genauigkeit zuk√ºnftiger Netzwerkvorhersagen sein (Genauigkeitscore). <br><br><pre> <code class="python hljs">accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=<span class="hljs-number"><span class="hljs-number">1</span></span>)[<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>] print(<span class="hljs-string"><span class="hljs-string">"\n : {0:f}\n"</span></span>.format(accuracy_score))</code> </pre> <br><h3>  Wir werden in testen </h3><br>  Jetzt ist das neuronale Netzwerk bereit und Sie k√∂nnen versuchen, mit seiner Hilfe die Essbarkeit des Pilzes vorherzusagen. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_samples</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.array([[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]], dtype=np.int)</code> </pre> <br>  Die obige Funktion gibt die Daten von zwei v√∂llig neuen Pilzen an, die weder im Training noch in den Kalibrierungss√§tzen vorhanden waren (tats√§chlich wurden sie einfach aus letzteren gezogen).  Stellen Sie sich zum Beispiel vor, Sie haben sie auf dem Markt gekauft und versuchen zu verstehen, ob sie gegessen werden k√∂nnen.  Der folgende Code definiert dies: <br><br><pre> <code class="python hljs">predictions = list(classifier.predict(input_fn=new_samples)) print(<span class="hljs-string"><span class="hljs-string">"   : {}\n"</span></span> .format(predictions))</code> </pre> <br>  Das Ergebnis der Arbeit sollte folgendes sein: <br><br><pre> <code class="python hljs">   : [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]</code> </pre> <br>  Und das bedeutet, dass der erste Pilz giftig ist, der zweite vollst√§ndig essbar.  Auf diese Weise k√∂nnen Sie Vorhersagen basierend auf beliebigen Daten treffen, sei es Pilze, Menschen, Tiere oder irgendetwas.  Es reicht aus, die Eingabedaten korrekt zu bilden.  Und um beispielsweise die Wahrscheinlichkeit einer zuk√ºnftigen Arrhythmie eines Patienten oder die Aktienkursbewegung an der B√∂rse vorherzusagen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de419917/">https://habr.com/ru/post/de419917/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de419905/index.html">Die britische Startindustrie erwacht und setzt sich Ziele - ein halbes Jahrhundert nach Black Arrow</a></li>
<li><a href="../de419907/index.html">Tipps zum Start von Handyspielen: Teil 2, Globaler Start</a></li>
<li><a href="../de419911/index.html">Erstellen von Umlaufbahnen von Himmelsk√∂rpern mit Python</a></li>
<li><a href="../de419913/index.html">IKEA und Smart Home. Teil 2</a></li>
<li><a href="../de419915/index.html">Bonding und SSH-Server in initramfs</a></li>
<li><a href="../de419919/index.html">Versionskontrolle in SQL Server</a></li>
<li><a href="../de419921/index.html">So verwerfen Sie 10 Millionen Pakete pro Sekunde</a></li>
<li><a href="../de419923/index.html">Meine Zeitarbeit, Motherboard-Uhren</a></li>
<li><a href="../de419925/index.html">Versionskontrolle einzelner Dateien mit dem GitHub Gist</a></li>
<li><a href="../de419927/index.html">[DotNetBook] Ausnahmen: Typ Systemarchitektur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>