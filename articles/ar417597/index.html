<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ ๐ฉ๐ฟโ๐คโ๐ฉ๐พ ุชุฎุฒูู ููุซูู ุจู ูุน DRBD9 ู Proxmox (ุงูุฌุฒุก 2: iSCSI + LVM) ๐ ๐ฉ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ููุงู ุณุงุจู ุ ุฏุฑุณุช ุฅููุงููุฉ ุฅูุดุงุก ุฎุงุฏู NFS ูุชุญูู ุงูุฃุฎุทุงุก ุจุงุณุชุฎุฏุงู DRBD ู Proxmox. ุงุชุถุญ ุงูุฃูุฑ ุฌูุฏูุง ุ ููููุง ูู ูุฑุชุงุญ ูู ุฃูุฌุงุฏูุง ุ ูุงูุขู ุณูุญุงูู "ุนุตุฑ ุฌูู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุชุฎุฒูู ููุซูู ุจู ูุน DRBD9 ู Proxmox (ุงูุฌุฒุก 2: iSCSI + LVM)</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417597/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/101/70c/524/10170c52443d67bd757a09ef22ba39e2.jpg" alt="ุงูุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู ุณุงุจู ุ</a> ุฏุฑุณุช ุฅููุงููุฉ ุฅูุดุงุก ุฎุงุฏู NFS ูุชุญูู ุงูุฃุฎุทุงุก ุจุงุณุชุฎุฏุงู DRBD ู Proxmox.  ุงุชุถุญ ุงูุฃูุฑ ุฌูุฏูุง ุ ููููุง ูู ูุฑุชุงุญ ูู ุฃูุฌุงุฏูุง ุ ูุงูุขู ุณูุญุงูู "ุนุตุฑ ุฌููุน ุงูุนุตุงุฆุฑ" ูู ูุฎุงุฒูุชูุง. </p><br><p style=";text-align:right;direction:rtl"> ูู ูุฐู ุงูููุงูุฉ ุ ุณุฃุฎุจุฑู ุจููููุฉ ุฅูุดุงุก ูุฏู iSCSI ุงููุชุณุงูุญ ุจูุฐู ุงูุทุฑููุฉ ุ ูุงูุฐู ุณูุณุชุฎุฏู LVM ูุชูุทูุนู ุฅูู ูุทุน ุตุบูุฑุฉ ูุงุณุชุฎุฏุงููุง ููุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูู ุงูููุฌ ุงูุฐู ุณูููู ุงูุญูู ููุฒูุฏ ูู ุณุฑุนุฉ ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุนุฏุฉ ูุฑุงุช ุ ููุฐุง ูููุฏ ุจุดูู ุฎุงุต ุนูุฏูุง ูุง ูููู ุงููุตูู ุงูุชูุงูุณู ุฅูู ุงูุจูุงูุงุช ูุทููุจูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ุชูุธูู ุงูุชุฎุฒูู ููุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ. </p><a name="habracut"></a><br><h2 id="para-slov-o-drbd" style=";text-align:right;direction:rtl">  ุจุถุน ูููุงุช ุญูู DRBD </h2><br><p style=";text-align:right;direction:rtl">  DRBD ูู ุญู ุจุณูุท ููุงุถุฌ ุฅูู ุญุฏ ูุง ุ ูุชู ุงุนุชูุงุฏ ุฑูุฒ ุงูุฅุตุฏุงุฑ ุงูุซุงูู ูุฌุฒุก ูู ููุงุฉ Linux.  ูู ุงููุงูุน ุ ุฅูู ููุซู ูุฑุขุฉ ุดุจูุฉ RAID1.  ูุฏู ุงูุฅุตุฏุงุฑ ุงูุชุงุณุน ุฏุนู ุงููุตุงุจ ูุงููุณุฎ ุงููุชูุงุซู ุจุฃูุซุฑ ูู ุนูุฏุชูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ูุณูุญ ูู ุจุฏูุฌ ุฃุฌูุฒุฉ ุงูุญุธุฑ ุนูู ุนุฏุฉ ุนูุฏ ูุนููุฉ ูู ุดุจูุฉ ูุดุชุฑูุฉ ูุงุญุฏุฉ ูุดุชุฑูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู DRBD ููููู ุชุญููู ุชููููุงุช ูุซูุฑุฉ ููุงูุชูุงู ููุบุงูุฉ.  ุงูููู ุณูุชุญุฏุซ ุนู iSCSI ู LVM. </p><br><p style=";text-align:right;direction:rtl">  ููููู ูุนุฑูุฉ ุงููุฒูุฏ ุนู ุฐูู ูู ุฎูุงู ูุฑุงุกุฉ ููุงูุชู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุณุงุจูุฉ</a> ุ ุญูุซ ูุตูุช ูุฐุง ุงูุญู ุจุงูุชูุตูู. </p><br><h2 id="para-slov-ob-iscsi" style=";text-align:right;direction:rtl">  ุจุถุน ูููุงุช ุญูู iSCSI </h2><br><p style=";text-align:right;direction:rtl">  ุฅู ุจุฑูุชูููู iSCSI ูู ุจุฑูุชูููู ุชุณููู ุฌูุงุฒ ููุน ุนุจุฑ ุดุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุนูุณ NBD ุ ููู ูุฏุนู ุงูุชุฎููู ุ ููุนูู ุนูู ูุดู ุงูุดุจูุฉ ุฏูู ูุดุงูู ููุฏุนู ุงูุนุฏูุฏ ูู ุงููุธุงุฆู ุงููููุฏุฉ ุงูุฃุฎุฑู ุ ูุงูุฃูู ูู ุฐูู ุฃูู ูุธูุฑ ุฃุฏุงุกู ุฌูุฏูุง ููุบุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ููุงู ุนุฏุฏ ูุจูุฑ ูู ุชุทุจููุงุชูุง ุ ุจุนุถูุง ูุฏุฑุฌ ุฃูุถูุง ูู ุงูููุงุฉ ููุง ุชุชุทูุจ ุตุนูุจุงุช ุฎุงุตุฉ ูุชูููููุง ูุงุชุตุงููุง. </p><br><h2 id="para-slov-ob-lvm" style=";text-align:right;direction:rtl">  ุจุถุน ูููุงุช ุญูู LVM </h2><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃู LINBIT ูุฏููุง ุญููุง ุงูุฎุงุต ูู Proxmox ุ ูุฌุจ ุฃู ุชุนูู ุฎุงุฑุฌ ุงูุตูุฏูู ูุชุณูุญ ุจุชุญููู ูุชูุฌุฉ ููุงุซูุฉ ุ ูููู ูู ูุฐู ุงูููุงูุฉ ูุง ุฃุฑูุฏ ุงูุชุฑููุฒ ููุท ุนูู Proxmox ููุตู ุจุนุถ ุงูุญููู ุงูุฃูุซุฑ ุดููููุฉ ุงูููุงุณุจุฉ ููู ูู Proxmox ู ุฃู ุดูุก ุขุฎุฑ ุ ูู ูุฐุง ุงููุซุงู ุ ูุชู ุงุณุชุฎุฏุงู proxmox ููุท ููุณููุฉ ูุชูุณูู ุงูุญุงููุงุช ุ ูู ุงููุงูุน ููููู ุงุณุชุจุฏุงูู ุจุญู ุขุฎุฑ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุญุงููุงุช ุงูุฅุทูุงู ุฐุงุช ุงููุฏู ูู Kubernetes. </p><br><p style=";text-align:right;direction:rtl">  ุจุงููุณุจุฉ ุฅูู Proxmox ุนูู ูุฌู ุงูุชุญุฏูุฏ ุ ูุฅูู ูุนูู ุจุดูู ุฌูุฏ ูุน LUN ู LVM ุงููุดุชุฑููู ุ ูุฐูู ุจุงุณุชุฎุฏุงู ุจุฑุงูุฌ ุงูุชุดุบูู ุงูููุงุณูุฉ ุงูุฎุงุตุฉ ุจู ููุท. </p><br><p style=";text-align:right;direction:rtl">  ุชุดูู ูุฒุงูุง LVM ุญูููุฉ ุฃู ุงุณุชุฎุฏุงูู ููุณ ุดูุฆูุง ุซูุฑููุง ุฌุฏูุฏูุง ูุบูุฑ ูุงูู ุ ููููู ุนูู ุงูุนูุณ ุ ูุธูุฑ ุงุณุชูุฑุงุฑูุง ุฌุงููุง ุ ููู ูุทููุจ ุนุงุฏุฉู ูู ุงูุชุฎุฒูู.  ูู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃู LVM ูุณุชุฎุฏู ุจูุดุงุท ูู ุจูุฆุงุช ุฃุฎุฑู ุ ุนูู ุณุจูู ุงููุซุงู ุ ูู OpenNebula ุฃู Kubernetes ุ ููู ูุฏุนูู ุฌูุฏูุง ููุงู. </p><br><p style=";text-align:right;direction:rtl">  ูุจุงูุชุงูู ุ ุณุชุชููู ุชุฎุฒูููุง ุนุงููููุง ูููู ุงุณุชุฎุฏุงูู ูู ุฃูุธูุฉ ูุฎุชููุฉ (ููุณ ููุท ูู ุงูุจุฑููุณูููุณ) ุ ูุฐูู ุจุงุณุชุฎุฏุงู ุจุฑุงูุฌ ุงูุชุดุบูู ุงูุฌุงูุฒุฉ ููุท ุ ุฏูู ุงูุญุงุฌุฉ ุฅูู ุชุนุฏูููุง ุจููู. </p><br><p style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ุนูุฏ ุงุฎุชูุงุฑ ุญู ููุชุฎุฒูู ุ ุนููู ุฏุงุฆููุง ุชูุฏูู ุจุนุถ ุงูุชูุงุฒูุงุช.  ูุฐุง ููุง ุ ูู ูููุญู ูุฐุง ุงูุญู ููุณ ุงููุฑููุฉ ูุซู Ceph. <br>  ููุชุตุฑ ุญุฌู ุงููุฑุต ุงูุธุงูุฑู ุนูู ุญุฌู ูุฌููุนุฉ LVM ุ ูุณูุชู ุจุงูุถุฑูุฑุฉ ุฅุนุงุฏุฉ ุชุฎุตูุต ุงูููุทูุฉ ุงููุญุฏุฏุฉ ููุฑุต ุงูุชุฑุงุถู ูุนูู - ููุฐุง ูุญุณู ุฅูู ุญุฏ ูุจูุฑ ุณุฑุนุฉ ุงููุตูู ุฅูู ุงูุจูุงูุงุช ุ ููููู ูุง ูุณูุญ ุจุชูููุฑ ุฑููุน (ุนูุฏูุง ูุดุบู ุงููุฑุต ุงูุงูุชุฑุงุถู ูุณุงุญุฉ ุฃูู ููุง ูู ุนููู ุจุงููุนู).  ูู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃู ุฃุฏุงุก LVM ูุชุฑุงุฌุน ูุซูุฑูุง ุนูุฏ ุงุณุชุฎุฏุงู ุงูููุทุงุช ุ ูุจุงูุชุงูู ุบุงูุจูุง ูุง ูุชู ุงุณุชุจุนุงุฏ ุฅููุงููุฉ ุงุณุชุฎุฏุงููุง ูุฌุงููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุนู ุ ูุฏุนู LVM ุชุฌูุนุงุช ุงูุชุฒููุฏ ุงูุฑููู ุงูุฎุงููุฉ ูู ูุฐุง ุงูุนูุจ ุ ูููู ููุฃุณู ูุง ูููู ุงุณุชุฎุฏุงููุง ุฅูุง ูู ุณูุงู ุนูุฏุฉ ูุงุญุฏุฉ ููุง ุชูุฌุฏ ุทุฑููุฉ ููุดุงุฑูุฉ ุชุฌููุน ุฑููุน ูุงุญุฏ ููุนุฏูุฏ ูู ุงูุนูุฏ ูู ุงููุฌููุนุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุนูู ุงูุฑุบู ูู ูุฐู ุงูุนููุจ ุ ูุธุฑูุง ูุจุณุงุทุชูุง ุ ูุง ุชุฒุงู LVM ูุง ุชุณูุญ ููููุงูุณูู ุจุงูุงูุชูุงู ุญูููุง ูุฏูุนูุง ุจุงููุงูู ุฎุงุฑุฌ ุณุงุญุฉ ุงููุนุฑูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุน ุญูู ุตุบูุฑ ุฅูู ุญุฏ ูุง ุ ูุง ุชุฒุงู LVM ุชููุฑ ุญููุง ุณุฑูุนูุง ุฌุฏูุง ููุณุชูุฑูุง ููุฑูุงู ุฅูู ุญุฏ ูุง. </p><br><h1 id="obschaya-shema" style=";text-align:right;direction:rtl">  ูุฎุทุท ุนุงู </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฏููุง <strong>ุซูุงุซ ุนูุฏ</strong> </li><li style=";text-align:right;direction:rtl">  ุชุญุชูู ูู ุนูุฏุฉ ุนูู <strong>ุฌูุงุฒ drbd</strong> ููุฒุน. </li><li style=";text-align:right;direction:rtl">  ูู ุงูุฌุฒุก ุงูุนููู ูู ุฌูุงุฒ drbd ุ ุชู ุฅุทูุงู <strong>ุญุงููุฉ</strong> LXC ุฐุงุช ูุฏู iSCSI. </li><li style=";text-align:right;direction:rtl">  ุงููุฏู ูุชุตู ุจุงูุนูุฏ ุงูุซูุงุซ. </li><li style=";text-align:right;direction:rtl">  ุชู ุฅูุดุงุก <strong>ูุฌููุนุฉ LVM</strong> ุนูู ุงููุฏู ุงููุชุตู. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูููู ุฃู ุชูุชูู <strong>ุญุงููุฉ LXC</strong> ุฅูู ุนูุฏุฉ ุฃุฎุฑู ุ ูุน <strong>ูุฏู iSCSI</strong> </li></ul><br><h1 id="nastroyka" style=";text-align:right;direction:rtl">  ุงูุชุฎุตูุต </h1><br><p style=";text-align:right;direction:rtl">  ููุฏ ุชูุตููุง ุฅูู ุงูููุฑุฉ ุงูุขู ุ ุฏุนูุง ููุชูู ุฅูู ุงูุชูููุฐ. </p><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุงูุชุฑุงุถู <strong>ุ</strong> ูุชู ุชูููุฑ <strong>ุงูุฅุตุฏุงุฑ ุงูุซุงูู ูู drbd</strong> <strong>ูุน ููุงุฉ ููููุณ</strong> ุ ููุฃุณู ูุง <strong>ููุงุณุจูุง</strong> ููุญู ุจุญุงุฌุฉ ุฅูู ุชุซุจูุช ุงูุฅุตุฏุงุฑ ุงูุชุงุณุน ูู ุงููุญุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุชูุตูู ูุณุชูุฏุน LINBIT ููู ุจุชุซุจูุช ูู ูุง ุชุญุชุงุฌู: </p><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">wget -O- https://packages.linbit.com/package-signing-pubkey.asc | apt-key add - <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"deb http://packages.linbit.com/proxmox/ proxmox-5 drbd-9.0"</span></span> \ &gt; /etc/apt/sources.list.d/linbit.list apt-get update &amp;&amp; apt-get -y install pve-headers drbd-dkms drbd-utils drbdtop</code> </pre> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>pve-headers</code> kernel ุงููุงุฒูุฉ ูุจูุงุก ุงููุญุฏุฉ </li><li style=";text-align:right;direction:rtl">  <code>drbd-dkms</code> - ูุญุฏุฉ kernel ูู ุดูู DKMS </li><li style=";text-align:right;direction:rtl">  <code>drbd-utils</code> - ุงููุฑุงูู ุงูุฃุณุงุณูุฉ ูุฅุฏุงุฑุฉ DRBD </li><li style=";text-align:right;direction:rtl">  <code>drbdtop</code> ูู ุฃุฏุงุฉ ุชูุงุนููุฉ ูุซู ุงูููุฉ ูู DRBD ููุท </li></ul><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุชุซุจูุช <strong>ุงููุญุฏุฉ ุ</strong> ุชุญูู ููุง ุฅุฐุง ูุงู ูู ุดูุก ุนูู ูุง ูุฑุงู ูุนูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># modprobe drbd # cat /proc/drbd version: 9.0.14-1 (api:2/proto:86-113)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุฑุฃูุช <strong>ุงูุฅุตุฏุงุฑ ุงูุซุงูู</strong> ูู ุฅุฎุฑุงุฌ ุงูุฃูุฑ ุ ุญุฏุซ ุฎุทุฃ ูุง ูุชู ุชุญููู ูุญุฏุฉ kernel <strong>ุฏุงุฎู ุงูุดุฌุฑุฉ</strong> .  ุชุญูู ูู <code>dkms status</code> ููุนุฑูุฉ ุงูุณุจุจ. </p><br><p style=";text-align:right;direction:rtl">  ุณูููู ููู ุนูุฏุฉ ูุฏููุง ููุณ <strong>ุฌูุงุฒ drbd</strong> ูุนูู ุนูู ุงูุฃูุณุงู ุงูุนุงุฏูุฉ.  ูุญุชุงุฌ ุฃููุงู ุฅูู ุฅุนุฏุงุฏ ูุฐุง ุงููุณู ูู drbd ุนูู ูู ุนูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุฃู ูููู ูุฐุง ุงููุณู ุฃู <strong>ุฌูุงุฒ ูุชูุฉ</strong> ุ ูููู ุฃู ูููู lvm ุฃู zvol ุฃู ูุณู ุงููุฑุต ุฃู ุงููุฑุต ุจุฃูููู.  ูู ูุฐู ุงูููุงูุฉ ุณุฃุณุชุฎุฏู ูุฑุต nvme ูููุตู ูุน ูุณู ุชุญุช drbd: <code>/dev/nvme1n1p1</code> </p><br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุฃุณูุงุก ุงูุฃุฌูุฒุฉ ุชููู ุฅูู ุงูุชุบููุฑ ูู ุจุนุถ ุงูุฃุญูุงู ุ ูุฐูู ูู ุงูุฃูุถู ุฃู ุชุฃุฎุฐูุง ุนูู ุงูููุฑ ูุนุงุฏุฉ ูุงุณุชุฎุฏุงู ุงุฑุชุจุงุท ุฑูุฒู ุซุงุจุช ููุฌูุงุฒ. </p><br><p style=";text-align:right;direction:rtl">  ููููู ุงูุนุซูุฑ ุนูู ูุซู ูุฐุง ุงูุงุฑุชุจุงุท ุงูุฑูุฒู ูู <code>/dev/nvme1n1p1</code> ุจูุฐู ุงูุทุฑููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># find /dev/disk/ -lname '*/nvme1n1p1' /dev/disk/by-partuuid/847b9713-8c00-48a1-8dff-f84c328b9da2 /dev/disk/by-path/pci-0000:0e:00.0-nvme-1-part1 /dev/disk/by-id/nvme-eui.0000000001000000e4d25c33da9f4d01-part1 /dev/disk/by-id/nvme-INTEL_SSDPEKKA010T7_BTPY703505FB1P0H-part1</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญู ูุตู ููุงุฑุฏูุง ุนูู ุฌููุน ุงูุนูุฏ ุงูุซูุงุซ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># cat /etc/drbd.d/tgt1.res resource tgt1 { meta-disk internal; device /dev/drbd100; protocol C; net { after-sb-0pri discard-zero-changes; after-sb-1pri discard-secondary; after-sb-2pri disconnect; } on pve1 { address 192.168.2.11:7000; disk /dev/disk/by-partuuid/95e7eabb-436e-4585-94ea-961ceac936f7; node-id 0; } on pve2 { address 192.168.2.12:7000; disk /dev/disk/by-partuuid/aa7490c0-fe1a-4b1f-ba3f-0ddee07dfee3; node-id 1; } on pve3 { address 192.168.2.13:7000; disk /dev/disk/by-partuuid/847b9713-8c00-48a1-8dff-f84c328b9da2; node-id 2; } connection-mesh { hosts pve1 pve2 pve3; } }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุงููุณุชุญุณู ุงุณุชุฎุฏุงู <strong>ุดุจูุฉ ูููุตูุฉ</strong> ููุฒุงููุฉ drbd. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูู ุจุฅูุดุงุก ุจูุงูุงุช ุงูุชุนุฑูู ูู drbd ููู ุจุชุดุบูููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># drbdadm create-md tgt1 initializing activity log initializing bitmap (320 KB) to all zero Writing meta data... New drbd meta data block successfully created. success # drbdadm up tgt1</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฑุฑ ูุฐู ุงูุฎุทูุงุช ุนูู ุงูุนูุฏ ุงูุซูุงุซ ูุชุญูู ูู ุงูุญุงูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># drbdadm status tgt1 role:Secondary disk:Inconsistent pve2 role:Secondary peer-disk:Inconsistent pve3 role:Secondary peer-disk:Inconsistent</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุฑุตูุง <strong>ุบูุฑ ุงููุชูุงุณู ููุฌูุฏ</strong> ุนูู ุฌููุน ุงูุนูุฏ ุงูุซูุงุซ ุ ูุฐูู ูุฃู drbd ูุง ูุนุฑู ุฃู ูุฑุต ูุฌุจ ุฃู ูุคุฎุฐ ุนูู ุฃูู ุงูุฃุตูู.  ูุฌุจ ูุถุน ุนูุงูุฉ ุนูู ุฃุญุฏูุง ุนูู ุฃูู <strong>ุฃุณุงุณู</strong> ุญุชู ุชุชู ูุฒุงููุฉ ุญุงูุชู ูุน ุงูุนูุฏ ุงูุฃุฎุฑู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">drbdadm primary --force tgt1 drbdadm secondary tgt1</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุจุงุดุฑุฉ ุจุนุฏ ุฐูู ุ ุณุชุจุฏุฃ <strong>ุงููุฒุงููุฉ</strong> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># drbdadm status tgt1 role:Secondary disk:UpToDate pve2 role:Secondary replication:SyncSource peer-disk:Inconsistent done:26.66 pve3 role:Secondary replication:SyncSource peer-disk:Inconsistent done:14.20</span></span></code> </pre><br><p style=";text-align:right;direction:rtl">  ูุง ูุฌุจ ุฃู ููุชุธุฑ ุญุชู ููุชูู ููููููุง ุชูููุฐ ุฎุทูุงุช ุฃุฎุฑู ุจุงูุชูุงุฒู.  ูููู ุชูููุฐูุง ุนูู <strong>ุฃู ุนูุฏุฉ</strong> ุ ุจุบุถ ุงููุธุฑ ุนู ุญุงูุชูุง ุงูุญุงููุฉ ูููุฑุต ุงููุญูู ูู DRBD.  ุณุชุชู ุฅุนุงุฏุฉ ุชูุฌูู ุฌููุน ุงูุทูุจุงุช ุชููุงุฆููุง ุฅูู ุงูุฌูุงุฒ ุจุญุงูุฉ <strong>UpToDate</strong> . </p><br><p style=";text-align:right;direction:rtl">  ูุง ุชูุณู ุชูุนูู <strong>ุงูุชุดุบูู ุงูุชููุงุฆู</strong> ูุฎุฏูุฉ drbd ุนูู ุงูุนูุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">systemctl <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> drbd.service</code> </pre> <br><h2 id="nastroyka-lxc-konteynera" style=";text-align:right;direction:rtl">  ุชูููู ุญุงููุฉ LXC </h2><br><p style=";text-align:right;direction:rtl">  ุณูุญุฐู ุฌุฒุก ุงูุชููุฆุฉ ูู <strong>ูุฌููุนุฉ Proxmox</strong> ูู ุซูุงุซ ุนูุฏ ุ ููุฐุง ุงูุฌุฒุก ููุตูู ุฌูุฏูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููููู ุงูุฑุณูู</a> </p><br><p style=";text-align:right;direction:rtl">  ููุง ููุช ูู ูุจู ุ ุณูุนูู <strong>ูุฏู iSCSI</strong> ูู <strong>ุญุงููุฉ LXC</strong> .  <code>/dev/drbd100</code> ุจุงูุญุงููุฉ ุนูู ุงูุฌูุงุฒ <code>/dev/drbd100</code> ุงูุฐู <code>/dev/drbd100</code> ููุชู. </p><br><p style=";text-align:right;direction:rtl">  ูุญุชุงุฌ ุฃููุงู ุฅูู ุฅูุดุงุก <strong>ูุธุงู ูููุงุช</strong> ุนููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">mkfs <span class="hljs-literal"><span class="hljs-literal">-t</span></span> ext4 <span class="hljs-literal"><span class="hljs-literal">-O</span></span> mmp <span class="hljs-literal"><span class="hljs-literal">-E</span></span> mmp_update_interval=<span class="hljs-number"><span class="hljs-number">5</span></span> /dev/drbd100</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุถูู <strong>Proxmox</strong> ุจุดูู ุงูุชุฑุงุถู <strong>ุญูุงูุฉ ูุชุนุฏุฏุฉ</strong> ุนูู ูุณุชูู ูุธุงู ุงููููุงุช ุ ูู ุญูุซ ุงููุจุฏุฃ ุ ูููููุง ุงูุงุณุชุบูุงุก ุนููุง ุ ูุฃูู  ุชุชูุชุน DRBD ุจุญูุงูุชูุง ุงูุฎุงุตุฉ ุจุดูู ุงูุชุฑุงุถู ุ ููู ุจุจุณุงุทุฉ ุชููุน <strong>ุงูุฃุณุงุณู</strong> ุงูุซุงูู ููุฌูุงุฒ ุ ูููู ุงูุญุฐุฑ ูุง ูุคุฐููุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูู ุจุชูุฒูู ูุงูุจ Ubuntu: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql"># wget http://download.proxmox.com/images/<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>/ubuntu<span class="hljs-number"><span class="hljs-number">-16.04</span></span>-standard_16<span class="hljs-number"><span class="hljs-number">.04</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>_amd64.tar.gz -P /var/lib/vz/<span class="hljs-keyword"><span class="hljs-keyword">template</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">cache</span></span>/</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฃูุดุฆ ุญุงููุชูุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">pct create <span class="hljs-number"><span class="hljs-number">101</span></span> local:vztmpl/ubuntu<span class="hljs-literal"><span class="hljs-literal">-16</span></span>.<span class="hljs-number"><span class="hljs-number">04</span></span><span class="hljs-literal"><span class="hljs-literal">-standard_16</span></span>.<span class="hljs-number"><span class="hljs-number">04</span></span><span class="hljs-literal"><span class="hljs-literal">-1_amd64</span></span>.tar.gz \ -<span class="hljs-literal"><span class="hljs-literal">-hostname</span></span>=tgt1 \ -<span class="hljs-literal"><span class="hljs-literal">-net0</span></span>=name=eth0,bridge=vmbr0,gw=<span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">1.1</span></span>,ip=<span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">1.11</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> \ -<span class="hljs-literal"><span class="hljs-literal">-rootfs</span></span>=volume=/dev/drbd100,shared=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฃูุฑ ุ ูุดูุฑ ุฅูู ุฃู <strong>ูุธุงู ุงูุฌุฐุฑ</strong> <code>/dev/drbd100</code> ุณูููู ุนูู ุงูุฌูุงุฒ <code>/dev/drbd100</code> ูุฅุถุงูุฉ ุงููุนููุฉ <code>shared=1</code> ููุณูุงุญ <code>/dev/drbd100</code> ุงูุญุงููุฉ ุจูู ุงูุนูุฏ. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุญุฏุซ ุฎุทุฃ ูุง ุ ูููููู ุฏุงุฆููุง ุฅุตูุงุญู ูู ุฎูุงู ูุงุฌูุฉ <code>/etc/pve/lxc/101.conf</code> ุฃู ูู <code>/etc/pve/lxc/101.conf</code> ุญุงููุฉ <code>/etc/pve/lxc/101.conf</code> </p><br><p style=";text-align:right;direction:rtl">  ุณูููู Proxmox ุจูู ุงููุงูุจ ูุฅุนุฏุงุฏ <strong>ูุธุงู ุฌุฐุฑ</strong> ุงูุญุงููุฉ ููุง.  ุจุนุฏ ุฐูู ูููููุง ุฅุทูุงู ุงูุญุงููุฉ ุงูุฎุงุตุฉ ุจูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">pct <span class="hljs-keyword"><span class="hljs-keyword">start</span></span> <span class="hljs-number"><span class="hljs-number">101</span></span></code> </pre> <br><h2 id="nastroyka-iscsi-targeta" style=";text-align:right;direction:rtl">  ุชูููู ูุฏู iSCSI. </h2><br><p style=";text-align:right;direction:rtl">  ูู ุจูู ูุฌููุนุฉ <strong>ุงูุฃูุฏุงู</strong> ุจุฃููููุง ุ ุงุฎุชุฑุช <strong>istgt</strong> ุ ูุฃููุง ุชุชูุชุน ุจุฃุนูู ุฃุฏุงุก ูุชุนูู ูู ูุณุงุญุฉ ุงููุณุชุฎุฏู. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฏุนููุง ุชุณุฌูู ุงูุฏุฎูู ุฅูู ุงูุญุงููุฉ ูุฏููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs perl">pct <span class="hljs-keyword"><span class="hljs-keyword">exec</span></span> <span class="hljs-number"><span class="hljs-number">101</span></span> bash</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุซุจูุช ุงูุชุญุฏูุซุงุช ู <strong>istgt</strong> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs sql">apt-get <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> -y <span class="hljs-keyword"><span class="hljs-keyword">upgrade</span></span> apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> -y <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> istgt</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุจุฅูุดุงุก ููู ุณูุนุทูู ุนุจุฑ ุงูุดุจูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">mkdir <span class="hljs-literal"><span class="hljs-literal">-p</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">data</span></span> fallocate <span class="hljs-literal"><span class="hljs-literal">-l</span></span> <span class="hljs-number"><span class="hljs-number">740</span></span>G /<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>/target1.img</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุชุงุฌ ุงูุขู ุฅูู ูุชุงุจุฉ ุชููุฆุฉ ูู <strong>istgt</strong> <code>/etc/istgt/istgt.conf</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs sql">[Global] <span class="hljs-keyword"><span class="hljs-keyword">Comment</span></span> <span class="hljs-string"><span class="hljs-string">"Global section"</span></span> NodeBase <span class="hljs-string"><span class="hljs-string">"iqn.2018-07.org.example.tgt1"</span></span> PidFile /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/run/istgt.pid AuthFile /etc/istgt/auth.conf MediaDirectory /<span class="hljs-keyword"><span class="hljs-keyword">var</span></span>/istgt LogFacility <span class="hljs-string"><span class="hljs-string">"local7"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Timeout</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> NopInInterval <span class="hljs-number"><span class="hljs-number">20</span></span> DiscoveryAuthMethod <span class="hljs-keyword"><span class="hljs-keyword">Auto</span></span> MaxSessions <span class="hljs-number"><span class="hljs-number">16</span></span> MaxConnections <span class="hljs-number"><span class="hljs-number">4</span></span> MaxR2T <span class="hljs-number"><span class="hljs-number">32</span></span> MaxOutstandingR2T <span class="hljs-number"><span class="hljs-number">16</span></span> DefaultTime2Wait <span class="hljs-number"><span class="hljs-number">2</span></span> DefaultTime2Retain <span class="hljs-number"><span class="hljs-number">60</span></span> FirstBurstLength <span class="hljs-number"><span class="hljs-number">262144</span></span> MaxBurstLength <span class="hljs-number"><span class="hljs-number">1048576</span></span> MaxRecvDataSegmentLength <span class="hljs-number"><span class="hljs-number">262144</span></span> InitialR2T Yes ImmediateData Yes DataPDUInOrder Yes DataSequenceInOrder Yes ErrorRecoveryLevel <span class="hljs-number"><span class="hljs-number">0</span></span> [UnitControl] <span class="hljs-keyword"><span class="hljs-keyword">Comment</span></span> <span class="hljs-string"><span class="hljs-string">"Internal Logical Unit Controller"</span></span> AuthMethod CHAP Mutual AuthGroup AuthGroup10000 Portal UC1 <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span>:<span class="hljs-number"><span class="hljs-number">3261</span></span> Netmask <span class="hljs-number"><span class="hljs-number">127.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span> [PortalGroup1] <span class="hljs-keyword"><span class="hljs-keyword">Comment</span></span> <span class="hljs-string"><span class="hljs-string">"SINGLE PORT TEST"</span></span> Portal DA1 <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.11</span></span>:<span class="hljs-number"><span class="hljs-number">3260</span></span> [InitiatorGroup1] <span class="hljs-keyword"><span class="hljs-keyword">Comment</span></span> <span class="hljs-string"><span class="hljs-string">"Initiator Group1"</span></span> InitiatorName <span class="hljs-string"><span class="hljs-string">"ALL"</span></span> Netmask <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span> [LogicalUnit1] <span class="hljs-keyword"><span class="hljs-keyword">Comment</span></span> <span class="hljs-string"><span class="hljs-string">"Hard Disk Sample"</span></span> TargetName disk1 TargetAlias <span class="hljs-string"><span class="hljs-string">"Data Disk1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Mapping</span></span> PortalGroup1 InitiatorGroup1 AuthMethod <span class="hljs-keyword"><span class="hljs-keyword">Auto</span></span> AuthGroup AuthGroup1 UseDigest <span class="hljs-keyword"><span class="hljs-keyword">Auto</span></span> UnitType Disk LUN0 <span class="hljs-keyword"><span class="hljs-keyword">Storage</span></span> /<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>/target1.img <span class="hljs-keyword"><span class="hljs-keyword">Auto</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุนุงุฏุฉ ุชุดุบูู istgt: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs pgsql">systemctl <span class="hljs-keyword"><span class="hljs-keyword">restart</span></span> istgt</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ูุฐุง ุงูุฅุนุฏุงุฏ ุงููุฏู </p><br><h2 id="nastroyka-ha" style=";text-align:right;direction:rtl">  ุฅุนุฏุงุฏ HA </h2><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูููููุง ุงูุงูุชูุงู ุฅูู ุชูููู <strong>HA-manager</strong> .  ูููู ุจุฅูุดุงุก ูุฌููุนุฉ HA ูููุตูุฉ ูุฌูุงุฒูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">ha<span class="hljs-literal"><span class="hljs-literal">-manager</span></span> groupadd tgt1 -<span class="hljs-literal"><span class="hljs-literal">-nodes</span></span> pve1,pve2,pve3 -<span class="hljs-literal"><span class="hljs-literal">-nofailback</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span> -<span class="hljs-literal"><span class="hljs-literal">-restricted</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุณูุนูู ููุฑุฏูุง ููุท ุนูู ุงูุนูุฏ ุงููุญุฏุฏุฉ ููุฐู ุงููุฌููุนุฉ.  ุฃุถู ุญุงููุชูุง ููุฐู ุงููุฌููุนุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">ha<span class="hljs-literal"><span class="hljs-literal">-manager</span></span> add ct:<span class="hljs-number"><span class="hljs-number">101</span></span> -<span class="hljs-literal"><span class="hljs-literal">-group</span></span>=tgt1 -<span class="hljs-literal"><span class="hljs-literal">-max_relocate</span></span>=<span class="hljs-number"><span class="hljs-number">3</span></span> -<span class="hljs-literal"><span class="hljs-literal">-max_restart</span></span>=<span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br><h2 id="rekomendacii-i-tyuning" style=";text-align:right;direction:rtl">  ุงูุชูุตูุงุช ูุงูุถุจุท </h2><br><h5 id="drbd" style=";text-align:right;direction:rtl">  DRBD </h5><br><p style=";text-align:right;direction:rtl">  ููุง ุฃุดุฑุช ุฃุนูุงู ุ ูู ุงููุณุชุญุณู ุฏุงุฆููุง ุงุณุชุฎุฏุงู ุดุจูุฉ ูููุตูุฉ ูููุณุฎ ุงููุชูุงุซู.  ูู ุงููุณุชุญุณู ููุบุงูุฉ ุงุณุชุฎุฏุงู <strong>ูุญููุงุช ุดุจูุฉ 10 ุฌูุฌุงุจุช</strong> ุ ูุฅูุง ูุณูู ุชูุงุฌู ุณุฑุนุฉ ุงููููุฐ. <br>  ุฅุฐุง ูุงู ุงููุณุฎ ุงููุชูุงุซู ูุจุฏู ุจุทูุฆูุง ุจูุง ููู ุงูููุงูุฉ ุ ูุฌุฑุจ ุจุนุถ ุงูุฎูุงุฑุงุช ูู <strong>DRBD</strong> .  ููุง ูู ุงูุชูููู ุ ููู ูู ุฑุฃูู ุงูุฃูุซู <strong>ูุดุจูุฉ 10G</strong> ุงูุฎุงุตุฉ ุจู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs swift"># cat /etc/drbd.d/global_common.conf global { usage-<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> yes; udev-always-use-vnr; } common { handlers { } startup { } options { } disk { <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>-fill-target 10M; <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-rate 720M; <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>-plan-ahead <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">c</span></span>-<span class="hljs-built_in"><span class="hljs-built_in">min</span></span>-rate 20M; } net { <span class="hljs-built_in"><span class="hljs-built_in">max</span></span>-buffers 36k; sndbuf-size 1024k; rcvbuf-size 2048k; } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููููู ุงูุญุตูู ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช ุญูู ูู ูุนููุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงุฆู DRBD ุงูุฑุณููุฉ.</a> </p><br><h5 id="open-iscsi" style=";text-align:right;direction:rtl">  ุงูุชุญ iSCSI </h5><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุฃููุง ูุง ูุณุชุฎุฏู ุชุนุฏุฏ ุงููุณุงุฑุงุช ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููู ุงููุณุชุญุณู</a> ูู ุญุงูุชูุง ุชุนุทูู ุนูููุงุช ูุญุต ุงูุงุชุตุงู ุงูุฏูุฑูุฉ ููุนููุงุก ุ ุจุงูุฅุถุงูุฉ ุฅูู ุฒูุงุฏุฉ ูููุงุช ุงูุงูุชุธุงุฑ ูุงุณุชุนุงุฏุฉ ุงูุฌูุณุฉ ูู <code>/etc/iscsi/iscsid.conf</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="hljs powershell">node.conn[<span class="hljs-number"><span class="hljs-number">0</span></span>].timeo.noop_out_interval = <span class="hljs-number"><span class="hljs-number">0</span></span> node.conn[<span class="hljs-number"><span class="hljs-number">0</span></span>].timeo.noop_out_timeout = <span class="hljs-number"><span class="hljs-number">0</span></span> node.session.timeo.replacement_timeout = <span class="hljs-number"><span class="hljs-number">86400</span></span></code> </pre> <br><h2 id="ispolzovanie" style=";text-align:right;direction:rtl">  ุงุณุชุฎุฏู </h2><br><h4 id="proxmox" style=";text-align:right;direction:rtl">  Proxmox </h4><br><p style=";text-align:right;direction:rtl">  ูููู ุชูุตูู <strong>ูุฏู iSCSI</strong> ุงููุงุชุฌ ุนูู ุงูููุฑ ุจู Proxmox ุ ุฏูู ูุณูุงู ุฅูุบุงุก ุชุญุฏูุฏ <strong>Use LUN Directly</strong> . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/uw/j3/pu/uwj3pusr-nf9bc7neisd5x-fcsg.png"></p><br><p style=";text-align:right;direction:rtl">  ูุจุงุดุฑุฉ ุจุนุฏ ุฐูู ุ ุณูููู ูู ุงููููู ุฅูุดุงุก LVM ููููุง ุ ูุง ุชูุณ ุชุญุฏูุฏ ุงููุฑุจุน <strong>ุงููุดุชุฑู</strong> : </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/j1/ob/mw/j1obmwcwhz-e6krjix72pmiz118.png"></p><br><h4 id="drugie-sredy" style=";text-align:right;direction:rtl">  ุจูุฆุงุช ุฃุฎุฑู </h4><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุชุฎุทุท ูุงุณุชุฎุฏุงู ูุฐุง ุงูุญู ูู ุจูุฆุฉ ูุฎุชููุฉ ุ ููุฏ ุชุญุชุงุฌ ุฅูู ุชุซุจูุช ููุญู ูุธุงู ุงููุฌููุนุฉ ูู LVM ูู ูุญุธุฉ ูุฌูุฏ ุชุทุจูููู.  <strong>CLVM</strong> ู <strong>lvmlockd</strong> . </p><br><p style=";text-align:right;direction:rtl">  ุชูููู <strong>CLVM</strong> ููุณ ุชุงููุง ููุชุทูุจ ูุฏูุฑ ูุฌููุนุฉ ุนูู. <br>  ุญูุซ ูุทุฑููุฉ ุซุงููุฉ ุ ูู ูุชู ุงุฎุชุจุงุฑ <strong>lvmlockd</strong> ุจุงููุงูู ุญุชู ุงูุขู ูุจุฏุฃ ููุชู ูู ุงูุธููุฑ ูู ูุณุชูุฏุนุงุช ูุณุชูุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุตู ุจูุฑุงุกุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>ููุงู</strong></a> ููุชุงุฒ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><strong>ุนู ุงูุญุฌุจ ูู LVM</strong></a> </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุงุณุชุฎุฏุงู <strong>LVM</strong> ูุน <strong>Proxmox ุ</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุง ููุฒู</a> ุฅุถุงูุฉ ุงููุฌููุนุฉ ุ ุญูุซ ูุชู ุชูููุฑ ุฅุฏุงุฑุฉ ูุญุฏุฉ ุงูุชุฎุฒูู ุนู ุทุฑูู proxmox ููุณูุง ุ ูุงูุชู ุชููู ุจุชุญุฏูุซ ููุฑุงูุจุฉ ุจูุงูุงุช ุชุนุฑูู LVM ุจุดูู ูุณุชูู.  ุงูุฃูุฑ ููุณู ููุทุจู ุนูู <strong>OpenNebula</strong> ุ ููุง ุชุดูุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> ุจูุถูุญ. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar417597/">https://habr.com/ru/post/ar417597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar417587/index.html">ูุณุงุฆู ุงูุฅุนูุงู: ุฃุฏุช ุงููุฌูุงุช ุงูุฅููุชุฑูููุฉ ุนูู ูุทุงู ูุงุณุน ุฅูู ุชุณุฑูุน ููู ุฑุณููุฉ ุงูุดุฑูุงุช ูู ุตูุงุนุฉ ุฃูู ุงููุนูููุงุช</a></li>
<li><a href="../ar417589/index.html">ุณุจุน ููุงุนุฏ ุจุณูุทุฉ ูุฌุนู ุงูุฅูุชุฑูุช ูู ูุชูุงูู ุงูุฌููุน</a></li>
<li><a href="../ar417591/index.html">ููููุฉ "ุชุนูู" ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ูู ุนุงู ูุงุญุฏ ุจููุฑุฏู ุฃู ููุงู ูุฃููุฆู ุงูุฐูู ูู ูุนูููุง ูุน ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</a></li>
<li><a href="../ar417593/index.html">NewSQL = NoSQL + ACID</a></li>
<li><a href="../ar417595/index.html">ุงูุขุซุงุฑ: ูุธุงู ุงูุชุดุบูู ุจุงูู ุ ููุฏ ูุนุงู ูุตูุฑ ูุซูุฑุฉ ููุงุดูุฆุฒุงุฒ</a></li>
<li><a href="../ar417599/index.html">ููุฎุต ุงูุชูููููุฌูุง ุงููุงููุฉ: ูุญุชุงุฌ ุงูููุธููู ุงููุงูููู ุฅูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุฃุฌู ุงูุนูู ูู ุงูุธุฑูู ุงูุญุฏูุซุฉ</a></li>
<li><a href="../ar417601/index.html">ุงุฎุชุฑ ุฎุงุฏููุง. ูุง ุงูุฐู ุชุจุญุซ ุนููุ ูุงุฆูุฉ ุงูุชุญูู</a></li>
<li><a href="../ar417603/index.html">ุงูุฅุนูุงู ุนู ูุงุชู ูุญููู: ูุงุฐุง ุชูุนู ุนูุฏูุง ูุตุจุญ ุงูุชุทุจูู ูุจูุฑูุงุ</a></li>
<li><a href="../ar417605/index.html">ุฃุณุงุณูุงุช ุงูููุฐุฌุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ ููุทุจุงุนุฉ ุซูุงุซูุฉ ุงูุฃุจุนุงุฏ</a></li>
<li><a href="../ar417607/index.html">ุงุฎุชุจุงุฑุงุช A / B ูุง ุชุนูู. ุชุญูู ููุง ุชูุนูู ุจุดูู ุฎุงุทุฆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>