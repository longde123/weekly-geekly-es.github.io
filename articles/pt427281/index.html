<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèæ‚Äçüíº üéÇ üîñ Desenvolvimento de classes de interface em C ++ üí≥ üßñüèº üö≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As classes de interface s√£o muito usadas em programas C ++. Infelizmente, por√©m, muitas vezes s√£o cometidos erros na implementa√ß√£o de solu√ß√µes baseada...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento de classes de interface em C ++</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427281/"><hr><p>  <i>As classes de interface s√£o muito usadas em programas C ++.</i>  <i>Infelizmente, por√©m, muitas vezes s√£o cometidos erros na implementa√ß√£o de solu√ß√µes baseadas em classes de interface.</i>  <i>O artigo descreve como projetar corretamente as classes da interface; v√°rias op√ß√µes s√£o consideradas.</i>  <i>O uso de ponteiros inteligentes √© descrito em detalhes.</i>  <i>Um exemplo da implementa√ß√£o de uma classe de exce√ß√£o e um modelo de classe de cole√ß√£o baseado em classes de interface √© fornecido.</i> </p><hr><br><a name="habracut"></a><br><h1>  Sum√°rio </h1><br><div class="spoiler">  <b class="spoiler_title">Sum√°rio</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1. Introdu√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1. Fun√ß√µes-membro especiais, criando e excluindo objetos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fun√ß√µes especiais para membros</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criando e excluindo objetos - detalhes b√°sicos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1.3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">N√≠vel de acesso do destruidor</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1.4</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Crie e exclua em um m√≥dulo</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1.5</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Dele√ß√£o polim√≥rfica</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">1.6</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Excluindo quando a declara√ß√£o de classe est√° incompleta</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2. Fun√ß√µes puramente virtuais e classes abstratas</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fun√ß√µes virtuais puras</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classes abstratas</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">2.3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Destruidor virtual puro</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3. Classes de interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Implementa√ß√µes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cria√ß√£o de Objetos</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Excluir objeto</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.3.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Usando o operador de exclus√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.3.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Usando uma fun√ß√£o virtual especial</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.3.3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Usando uma fun√ß√£o externa</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.3.4</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Exclus√£o autom√°tica usando o ponteiro inteligente</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.4</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Outras op√ß√µes para gerenciar o tempo de vida de uma inst√¢ncia de uma classe de implementa√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.5</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sem√¢ntica de c√≥pia</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.6</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Construtor da classe de interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.7</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Intera√ß√£o bidirecional</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.8</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ponteiros inteligentes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.9</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Fun√ß√µes membro constantes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.10</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Interfaces COM</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">3.11</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classes e bibliotecas de interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4. Um exemplo de uma classe de interface e sua implementa√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classe de interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classe de implementa√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ponteiros inteligentes padr√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.3.1</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cria√ß√£o do lado do cliente</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.3.2</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cria√ß√£o do lado da implementa√ß√£o</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">4.4</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Implementa√ß√£o alternativa da classe base</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5. Exce√ß√µes e cole√ß√µes implementadas usando classes de interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.1 Exce√ß√µes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5.2 Colec√ß√µes</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">6. Classes de interface e classes de wrapper</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">7. Resumo</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Refer√™ncias</a> <br></div></div><br><a name="id-introdaction"></a><br><h1>  1. Introdu√ß√£o </h1><br><p>  Uma classe de interface √© uma classe que n√£o possui dados e consiste principalmente em fun√ß√µes puramente virtuais.  Essa solu√ß√£o permite separar completamente a implementa√ß√£o da interface - o cliente usa a classe de interface - em outro local √© criada uma classe derivada, na qual fun√ß√µes puramente virtuais s√£o redefinidas e a fun√ß√£o de f√°brica √© definida.  Os detalhes da implementa√ß√£o est√£o completamente ocultos do cliente.  Dessa maneira, o verdadeiro encapsulamento √© implementado, o que √© imposs√≠vel com a classe usual.  Voc√™ pode ler sobre as classes de interface em Scott Meyers [Meyers2].  As classes de interface tamb√©m s√£o chamadas de classes de protocolo. </p><br><p>  O uso de classes de interface permite enfraquecer as depend√™ncias entre diferentes partes do projeto, o que simplifica o desenvolvimento da equipe e reduz o tempo de compila√ß√£o / montagem.  As classes de interface facilitam a implementa√ß√£o de solu√ß√µes flex√≠veis e din√¢micas quando os m√≥dulos s√£o carregados seletivamente em tempo de execu√ß√£o.  O uso das classes de interface como uma biblioteca de interface (API) (SDK) simplifica a solu√ß√£o de problemas de compatibilidade bin√°ria. </p><br><p>  As classes de interface s√£o usadas amplamente, com a ajuda de implementar a interface (API) de bibliotecas (SDK), a interface de plug-ins (plugins) e muito mais.  Muitos padr√µes do Gang of Four [GoF] s√£o naturalmente implementados usando classes de interface.  As classes de interface incluem interfaces COM.  Infelizmente, por√©m, muitas vezes s√£o cometidos erros na implementa√ß√£o de solu√ß√µes baseadas em classes de interface.  Vamos tentar esclarecer esse problema. </p><br><a name="id-1"></a><br><h1>  1. Fun√ß√µes-membro especiais, criando e excluindo objetos </h1><br><p>  Esta se√ß√£o descreve brevemente v√°rios recursos do C ++ que voc√™ precisa conhecer para entender completamente as solu√ß√µes oferecidas para as classes de interface. </p><br><a name="id-1-1"></a><br><h2>  1.1  Fun√ß√µes especiais para membros </h2><br><p>  Se o programador n√£o definiu as fun√ß√µes de membro da classe da lista a seguir - construtor padr√£o, construtor de c√≥pias, operador de atribui√ß√£o de c√≥pias, destruidor -, o compilador pode fazer isso por ele.  O C ++ 11 adicionou um construtor de movimenta√ß√£o e um operador de atribui√ß√£o de movimenta√ß√£o a esta lista.  Essas fun√ß√µes de membro s√£o chamadas de fun√ß√µes de membro especiais.  Eles s√£o gerados apenas se forem usados ‚Äã‚Äãe condi√ß√µes adicionais espec√≠ficas para cada fun√ß√£o s√£o atendidas.  Observe que esse uso pode se mostrar bastante oculto (por exemplo, ao implementar heran√ßa).  Se a fun√ß√£o necess√°ria n√£o puder ser gerada, um erro ser√° gerado.  (Com exce√ß√£o das opera√ß√µes de realoca√ß√£o, elas s√£o substitu√≠das por opera√ß√µes de c√≥pia.) As fun√ß√µes de membro geradas pelo compilador s√£o p√∫blicas e incorpor√°veis. </p><br><p>  Fun√ß√µes-membro especiais n√£o s√£o herdadas; se uma fun√ß√£o-membro especial for necess√°ria na classe derivada, o compilador sempre tentar√° ger√°-la; a presen√ßa da fun√ß√£o-membro correspondente definida na classe base pelo programador n√£o afeta isso. </p><br><p> O programador pode proibir a gera√ß√£o de fun√ß√µes-membro especiais; em C ++ 11, √© necess√°rio usar a constru√ß√£o <code>"=delete"</code> ao declarar; em C ++ 98, declarar a fun√ß√£o de membro correspondente privada e n√£o definir.  Na heran√ßa de classe, a proibi√ß√£o de gerar uma fun√ß√£o de membro especial feita na classe base se aplica a todas as classes derivadas. </p><br><p>  Se o programador estiver confort√°vel com as fun√ß√µes de membro geradas pelo compilador, no C ++ 11 ele poder√° indicar isso explicitamente, e n√£o apenas descartar a declara√ß√£o.  Para fazer isso, voc√™ deve usar a constru√ß√£o <code>"=default"</code> ao declarar, enquanto o c√≥digo √© melhor lido e recursos adicionais aparecem relacionados ao gerenciamento do n√≠vel de acesso. </p><br><p>  Detalhes sobre fun√ß√µes-membro especiais podem ser encontrados em [Meyers3]. </p><br><a name="id-1-2"></a><br><h2>  1.2  Criando e excluindo objetos - detalhes b√°sicos </h2><br><p>  Criar e excluir objetos usando os operadores <code>new/delete</code> √© uma opera√ß√£o t√≠pica de duas em uma.  Ao chamar <code>new</code> , a mem√≥ria √© alocada primeiro para o objeto.  Se a sele√ß√£o for bem sucedida, o construtor √© chamado.  Se o construtor lan√ßar uma exce√ß√£o, a mem√≥ria alocada ser√° liberada.  Quando o operador de <code>delete</code> √© chamado, tudo acontece na ordem inversa: primeiro, o destruidor √© chamado e a mem√≥ria √© liberada.  O destruidor n√£o deve lan√ßar exce√ß√µes. </p><br><p>  Se o <code>new</code> operador for usado para criar uma matriz de objetos, a mem√≥ria ser√° alocada primeiro para toda a matriz.  Se a sele√ß√£o for bem-sucedida, o construtor padr√£o ser√° chamado para cada elemento da matriz come√ßando do zero.  Se algum construtor lan√ßa uma exce√ß√£o, para todos os elementos criados da matriz, o destruidor √© chamado na ordem inversa da chamada do construtor, a mem√≥ria alocada √© liberada.  Para excluir uma matriz, voc√™ deve chamar o operador <code>delete[]</code> (chamado operador de <code>delete</code> para matrizes) e, para todos os elementos da matriz, o destruidor √© chamado na ordem inversa do construtor e a mem√≥ria alocada √© liberada. </p><br><p>  Aten√ß√£o!  Voc√™ deve chamar a forma correta do operador de <code>delete</code> , dependendo de um √∫nico objeto ou matriz ser exclu√≠do.  Essa regra deve ser observada rigorosamente, caso contr√°rio, voc√™ poder√° obter um comportamento indefinido, ou seja, tudo pode acontecer: vazamento de mem√≥ria, falha etc.  Veja [Meyers2] para detalhes. </p><br><p>  As fun√ß√µes de aloca√ß√£o de mem√≥ria padr√£o <code>std::bad_alloc</code> ao atender √† solicita√ß√£o, <code>std::bad_alloc</code> uma exce√ß√£o do tipo <code>std::bad_alloc</code> . </p><br><p>  √â seguro aplicar qualquer forma do operador de <code>delete</code> a um ponteiro nulo. </p><br><p>  Na descri√ß√£o acima, √© necess√°rio um esclarecimento.  Para os chamados tipos triviais (tipos internos, estruturas no estilo C), o construtor n√£o pode ser chamado e o destruidor n√£o faz nada em nenhum caso.  Veja tamb√©m a se√ß√£o 1.6. </p><br><a name="id-1-3"></a><br><h2>  1.3  N√≠vel de acesso do destruidor </h2><br><p>  Quando o operador de <code>delete</code> √© aplicado a um ponteiro de uma classe, o destruidor dessa classe deve estar dispon√≠vel no ponto de chamada de <code>delete</code> .  (Existe alguma exce√ß√£o a esta regra, discutida na Se√ß√£o 1.6.) Assim, ao tornar o destruidor seguro ou fechado, o programador pro√≠be o uso do operador de <code>delete</code> onde o destruidor n√£o est√° dispon√≠vel.  Lembre-se de que, se nenhum destruidor estiver definido na classe, o compilador far√° isso por conta pr√≥pria e esse destruidor estar√° aberto (consulte a se√ß√£o 1.1). </p><br><a name="id-1-4"></a><br><h2>  1.4  Crie e exclua em um m√≥dulo </h2><br><p>  Se o <code>new</code> operador criou um objeto, o operador de <code>delete</code> deve estar no mesmo m√≥dulo para <code>delete</code> lo.  Figurativamente falando, "coloque-o onde voc√™ o levou".  Essa regra √© bem conhecida, veja, por exemplo, [Sutter / Alexandrescu].  Se essa regra for violada, poder√° ocorrer ‚Äúincompatibilidade‚Äù das fun√ß√µes de aloca√ß√£o e libera√ß√£o de mem√≥ria, o que, via de regra, leva a um encerramento anormal do programa. </p><br><a name="id-1-5"></a><br><h2>  1.5  Dele√ß√£o polim√≥rfica </h2><br><p>  Se voc√™ estiver projetando uma hierarquia polim√≥rfica de classes cujas inst√¢ncias s√£o exclu√≠das usando o operador <code>delete</code> , deve haver um destruidor virtual aberto na classe base, isso garante que o destruidor do tipo real do objeto seja chamado quando o operador de <code>delete</code> for aplicado ao ponteiro da classe base.  Se essa regra for violada, poder√° ocorrer uma chamada para o destruidor da classe base, o que pode levar a um vazamento de recurso. </p><br><a name="id-1-6"></a><br><h2>  1.6  Excluindo quando a declara√ß√£o de classe est√° incompleta </h2><br><p>  A on√≠vora do operador de <code>delete</code> pode criar certos problemas; pode ser aplicada a um ponteiro do tipo <code>void*</code> ou a um ponteiro para uma classe que possui uma declara√ß√£o incompleta (preemptiva).  Nesse caso, um erro n√£o ocorre, apenas a chamada para o destruidor √© ignorada, apenas a fun√ß√£o para liberar a mem√≥ria √© chamada.  Considere um exemplo: </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-comment"><span class="hljs-comment">//   X* CreateX(); void Foo() {    X* p = CreateX();    delete p; }</span></span></code> </pre> <br><p>  Esse c√≥digo √© compilado mesmo se uma declara√ß√£o completa da classe <code>X</code> n√£o estiver dispon√≠vel no ponto de discagem de <code>delete</code> .  Verdadeiro, ao compilar (Visual Studio) um aviso √© emitido: </p><br><p> <code>warning C4150: deletion of pointer to incomplete type 'X'; no destructor called</code> </p> <br><p>  Se houver uma implementa√ß√£o de <code>X</code> e <code>CreateX()</code> , o c√≥digo ser√° <code>CreateX()</code> ; se <code>CreateX()</code> retornar um ponteiro para o objeto criado pelo <code>new</code> operador, a chamada <code>Foo()</code> executada com √™xito, o destruidor n√£o ser√° chamado.  √â claro que isso pode levar a uma drenagem de recursos, portanto, mais uma vez, sobre a necessidade de ter cuidado com os avisos. </p><br><p>  Essa situa√ß√£o n√£o √© exagerada, pode surgir facilmente ao usar classes como ponteiros inteligentes ou classes de descritores.  Scott Meyers lida com esse problema em [Meyers3]. </p><br><a name="id-2"></a><br><h1>  2. Fun√ß√µes puramente virtuais e classes abstratas </h1><br><p>  O conceito de classes de interface √© baseado em conceitos de C ++, como fun√ß√µes virtuais puras e classes abstratas. </p><br><a name="id-2-1"></a><br><h2>  2.1  Fun√ß√µes virtuais puras </h2><br><p>  Uma fun√ß√£o virtual declarada usando a constru√ß√£o <code>"=0"</code> √© chamada virtual pura. </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">X</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-comment"><span class="hljs-comment">// ...    virtual void Foo() = 0; };</span></span></code> </pre> <br><p>  Diferentemente de uma fun√ß√£o virtual regular, uma fun√ß√£o puramente virtual n√£o pode ser definida (com exce√ß√£o do destruidor, consulte a se√ß√£o 2.3), mas deve ser redefinida em uma das classes derivadas. </p><br><p>  Fun√ß√µes puramente virtuais podem ser definidas.  O emblema Sutter oferece v√°rios usos √∫teis para esse recurso [Obturador]. </p><br><a name="id-2-2"></a><br><h2>  2.2  Classes abstratas </h2><br><p>  Uma classe abstrata √© uma classe que possui pelo menos uma fun√ß√£o puramente virtual.  Uma classe que √© derivada de uma classe abstrata e n√£o substitui pelo menos uma fun√ß√£o puramente virtual tamb√©m ser√° abstrata.  O padr√£o C ++ pro√≠be a cria√ß√£o de inst√¢ncias de uma classe abstrata; voc√™ s√≥ pode criar inst√¢ncias de derivadas de classes n√£o abstratas.  Assim, uma classe abstrata √© criada para ser usada como classe base.  Portanto, se um construtor √© definido em uma classe abstrata, n√£o faz sentido abri-lo, ele deve ser protegido. </p><br><a name="id-2-3"></a><br><h2>  2.3  Destruidor virtual puro </h2><br><p>  Em alguns casos, √© aconselh√°vel criar um destruidor virtual puro.  Mas esta solu√ß√£o tem dois recursos. </p><br><ol><li>  Um destruidor puramente virtual deve ser definido.  (A defini√ß√£o padr√£o geralmente √© usada, ou seja, usando a constru√ß√£o <code>"=default"</code> .) O destruidor de classe derivado chama destruidores de classe base ao longo de toda a cadeia de heran√ßa e, portanto, a fila √© garantida para atingir a raiz - um destruidor puramente virtual. </li><li>  Se o programador n√£o redefiniu um destruidor virtual puro na classe derivada, o compilador far√° isso por ele (consulte a se√ß√£o 1.1).  Assim, uma classe derivada de uma classe abstrata com um destruidor puramente virtual pode perder sua abstra√ß√£o sem substituir explicitamente o destruidor. </li></ol><br><p>  Um exemplo de uso de um destruidor virtual puro pode ser encontrado na se√ß√£o 4.4. </p><br><a name="id-3"></a><br><h1>  3. Classes de interface </h1><br><p>  Uma classe de interface √© uma classe abstrata que n√£o possui dados e consiste principalmente em fun√ß√µes puramente virtuais.  Essa classe pode ter fun√ß√µes virtuais comuns (n√£o puramente virtuais), por exemplo, um destruidor.  Tamb√©m pode haver fun√ß√µes membro est√°ticas, como fun√ß√µes de f√°brica. </p><br><a name="id-3-1"></a><br><h2>  3.1  Implementa√ß√µes </h2><br><p>  Uma implementa√ß√£o de uma classe de interface ser√° chamada de classe derivada na qual fun√ß√µes puramente virtuais s√£o redefinidas.  Pode haver v√°rias implementa√ß√µes da mesma classe de interface, e dois esquemas s√£o poss√≠veis: horizontal, quando v√°rias classes diferentes herdam a mesma classe de interface, e vertical, quando a classe de interface √© a raiz da hierarquia polim√≥rfica.  Claro, pode haver h√≠bridos. </p><br><p>  O ponto principal do conceito de classe de interface √© a separa√ß√£o completa da interface da implementa√ß√£o - o cliente trabalha apenas com a classe de interface, a implementa√ß√£o n√£o est√° dispon√≠vel para ela. </p><br><a name="id-3-2"></a><br><h2>  3.2  Cria√ß√£o de Objetos </h2><br><p>  A inacessibilidade da classe de implementa√ß√£o causa certos problemas ao criar objetos.  O cliente deve criar uma inst√¢ncia da classe de implementa√ß√£o e obter um ponteiro para a classe da interface atrav√©s da qual o objeto ser√° acessado.  Como a classe de implementa√ß√£o n√£o est√° dispon√≠vel, voc√™ n√£o pode usar o construtor, portanto, a fun√ß√£o de f√°brica √© usada, definida no lado da implementa√ß√£o.  Essa fun√ß√£o geralmente cria um objeto usando o <code>new</code> operador e retorna um ponteiro para o objeto criado, convertido em um ponteiro para uma classe de interface.  Uma fun√ß√£o de f√°brica pode ser um membro est√°tico de uma classe de interface, mas n√£o √© necess√°rio, por exemplo, pode ser um membro de uma classe de f√°brica especial (que, por sua vez, pode ser uma classe de interface) ou uma fun√ß√£o livre.  Uma fun√ß√£o de f√°brica pode retornar n√£o um ponteiro bruto para uma classe de interface, mas um inteligente.  Esta op√ß√£o √© discutida nas se√ß√µes 3.3.4 e 4.3.2. </p><br><a name="id-3-3"></a><br><h2>  3.3  Excluir objeto </h2><br><p>  A remo√ß√£o de um objeto √© uma opera√ß√£o extremamente cr√≠tica.  Um erro resulta em um vazamento de mem√≥ria ou em uma exclus√£o dupla, o que geralmente leva a uma falha no programa.  Abaixo, esse problema √© considerado o mais detalhado poss√≠vel, com muita aten√ß√£o sendo prestada √† preven√ß√£o de a√ß√µes err√¥neas do cliente. </p><br><p>  Existem quatro op√ß√µes principais: </p><br><ol><li>  Usando o operador de <code>delete</code> . </li><li>  Usando uma fun√ß√£o virtual especial. </li><li>  Usando uma fun√ß√£o externa. </li><li>  Exclus√£o autom√°tica usando o ponteiro inteligente. </li></ol><br><a name="id-3-3-1"></a><br><h3>  3.3.1  Usando o operador de <code>delete</code> <br></h3><br><p>  Para fazer isso, voc√™ deve ter um destruidor virtual aberto na classe de interface.  Nesse caso, o operador de <code>delete</code> , chamado de um ponteiro para uma classe de interface no lado do cliente, fornece uma chamada ao destruidor da classe de implementa√ß√£o.  Essa op√ß√£o pode funcionar, mas √© dif√≠cil reconhec√™-la como bem-sucedida.  Recebemos chamadas dos operadores <code>new</code> e <code>delete</code> em diferentes lados da ‚Äúbarreira‚Äù, <code>new</code> no lado da implementa√ß√£o e <code>delete</code> no lado do cliente.  E se a implementa√ß√£o da classe de interface for feita em um m√≥dulo separado (o que √© bastante comum), obteremos uma viola√ß√£o da regra na se√ß√£o 1.4. </p><br><a name="id-3-3-2"></a><br><h3>  3.3.2  Usando uma fun√ß√£o virtual especial </h3><br><p>  Mais progressiva √© outra op√ß√£o: a classe de interface deve ter uma fun√ß√£o virtual especial que remova o objeto.  Essa fun√ß√£o, no final, se resume a chamar <code>delete this</code> , mas isso j√° est√° acontecendo no lado da implementa√ß√£o.  Essa fun√ß√£o pode ser chamada de maneiras diferentes, por exemplo, <code>Delete()</code> , mas outras op√ß√µes tamb√©m s√£o usadas: <code>Release()</code> , <code>Destroy()</code> , <code>Dispose()</code> , <code>Free()</code> , <code>Close()</code> , etc.  Al√©m de seguir a regra na se√ß√£o 1.4, esta op√ß√£o tem v√°rias vantagens adicionais. </p><br><ol><li>  Permite usar fun√ß√µes de aloca√ß√£o / desaloca√ß√£o de mem√≥ria definidas pelo usu√°rio para a classe de implementa√ß√£o. </li><li>  Permite implementar um esquema mais complexo para controlar a vida √∫til do objeto de implementa√ß√£o, por exemplo, usando um contador de refer√™ncia. </li></ol><br><p>  Nesta modalidade, uma tentativa de excluir um objeto usando o operador de <code>delete</code> pode ser compilada e at√© executada, mas isso √© um erro.  Para evit√°-lo na classe de interface, basta ter um destruidor protegido vazio ou puramente virtual (consulte a se√ß√£o 1.3).  Observe que o uso do operador de <code>delete</code> pode ser bastante mascarado, por exemplo, ponteiros inteligentes padr√£o usam o operador de exclus√£o para excluir um objeto por padr√£o e o c√≥digo correspondente est√° profundamente oculto em sua implementa√ß√£o.  Um destruidor protegido permite detectar todas essas tentativas no est√°gio de compila√ß√£o. </p><br><a name="id-3-3-3"></a><br><h3>  3.3.3  Usando uma fun√ß√£o externa </h3><br><p>  Essa op√ß√£o pode atrair uma certa simetria de procedimentos para criar e excluir um objeto, mas, na realidade, n√£o possui vantagens em rela√ß√£o √† vers√£o anterior, mas h√° muitos problemas adicionais.  Esta op√ß√£o n√£o √© recomendada para uso e n√£o √© considerada no futuro. </p><br><a name="id-3-3-4"></a><br><h3>  3.3.4  Exclus√£o autom√°tica usando o ponteiro inteligente </h3><br><p>  Nesse caso, a fun√ß√£o de f√°brica n√£o retorna um ponteiro bruto para uma classe de interface, mas um ponteiro inteligente correspondente.  Esse ponteiro inteligente √© criado no lado da implementa√ß√£o e encapsula o objeto de exclus√£o, que exclui automaticamente o objeto de implementa√ß√£o quando o ponteiro inteligente (ou sua √∫ltima c√≥pia) fica fora do escopo no lado do cliente.  Nesse caso, uma fun√ß√£o virtual especial para excluir o objeto de implementa√ß√£o pode n√£o ser necess√°ria, mas ainda √© necess√°rio um destruidor protegido; √© necess√°rio evitar o uso incorreto do operador de <code>delete</code> .  (√â verdade, deve-se notar que a probabilidade de um erro desse tipo √© visivelmente reduzida.) Essa op√ß√£o √© discutida em mais detalhes na Se√ß√£o 4.3.2. </p><br><a name="id-3-4"></a><br><h2>  3.4  Outras op√ß√µes para gerenciar o tempo de vida de uma inst√¢ncia de uma classe de implementa√ß√£o </h2><br><p>  Em alguns casos, o cliente pode receber um ponteiro para a classe da interface, mas n√£o a possui.  O gerenciamento da vida √∫til do objeto de implementa√ß√£o √© totalmente do lado da implementa√ß√£o.  Por exemplo, um objeto pode ser um objeto singleton est√°tico (essa solu√ß√£o √© t√≠pica para f√°bricas).  Outro exemplo est√° relacionado √† intera√ß√£o bidirecional, consulte a se√ß√£o 3.7.  O cliente n√£o deve excluir esse objeto, mas √© necess√°rio um destruidor protegido para essa classe de interface; √© necess√°rio evitar o uso incorreto do operador de <code>delete</code> . </p><br><a name="id-3-5"></a><br><h2>  3.5  Sem√¢ntica de c√≥pia </h2><br><p>  Para uma classe de interface, a cria√ß√£o de uma c√≥pia do objeto de implementa√ß√£o usando o construtor de c√≥pia n√£o √© poss√≠vel; portanto, se a c√≥pia for necess√°ria, a classe dever√° ter uma fun√ß√£o virtual que crie uma c√≥pia do objeto de implementa√ß√£o e retorne um ponteiro para a classe de interface.  Essa fun√ß√£o √© geralmente chamada de construtor virtual e seu nome tradicional √© <code>Clone()</code> ou <code>Duplicate()</code> . </p><br><p>  O uso do operador de atribui√ß√£o de c√≥pias n√£o √© proibido, mas n√£o pode ser considerado uma boa ideia.  O operador de atribui√ß√£o de c√≥pia est√° sempre emparelhado; deve ser emparelhado com o construtor de c√≥pias.  O operador gerado pelo compilador padr√£o n√£o faz sentido; n√£o faz nada.  √â teoricamente poss√≠vel declarar um operador de atribui√ß√£o puramente virtual com redefini√ß√£o subsequente, mas a atribui√ß√£o virtual n√£o √© uma pr√°tica recomendada; detalhes podem ser encontrados em [Meyers1].  Al√©m disso, a atribui√ß√£o parece muito antinatural: o acesso aos objetos da classe de implementa√ß√£o geralmente √© feito atrav√©s de um ponteiro para a classe de interface, portanto, a atribui√ß√£o ter√° a seguinte apar√™ncia: </p><br><pre> <code class="cpp hljs">* = *;</code> </pre> <br><p>  √â melhor proibir o operador de atribui√ß√£o e, se necess√°rio, essa sem√¢ntica tem na classe de interface a fun√ß√£o virtual correspondente. </p><br><p>  Existem duas maneiras de proibir a atribui√ß√£o. </p><br><ol><li>  Declare o operador de atribui√ß√£o exclu√≠do ( <code>=delete</code> ).  Se as classes de interface formam uma hierarquia, isso √© suficiente na classe base.  A desvantagem desse m√©todo √© que ele afeta a classe de implementa√ß√£o, a proibi√ß√£o tamb√©m se aplica a ele. </li><li>  Declare uma instru√ß√£o de atribui√ß√£o protegida com uma defini√ß√£o padr√£o ( <code>=default</code> ).  Isso n√£o afeta a classe de implementa√ß√£o, mas no caso de uma hierarquia de classes de interface, esse an√∫ncio deve ser feito em cada classe. </li></ol><br><a name="id-3-6"></a><br><h2>  3.6  Construtor da classe de interface </h2><br><p>  Freq√ºentemente, o construtor de uma classe de interface n√£o √© declarado.  Nesse caso, o compilador gera o construtor padr√£o necess√°rio para implementar a heran√ßa (consulte a se√ß√£o 1.1).  Este construtor √© aberto, embora o suficiente para ser seguro.  Se na classe de interface o construtor de c√≥pia for declarado exclu√≠do ( <code>=delete</code> ), a gera√ß√£o pelo compilador do construtor ser√° suprimida por padr√£o, e esse construtor dever√° ser declarado explicitamente.  √â natural torn√°-lo seguro com uma defini√ß√£o padr√£o ( <code>=default</code> ).  Em princ√≠pio, a declara√ß√£o de um construtor protegido pode sempre ser feita.  Um exemplo est√° na se√ß√£o 4.4. </p><br><a name="id-3-7"></a><br><h2>  3.7  Intera√ß√£o bidirecional </h2><br><p>  As classes de interface s√£o convenientes para o uso da comunica√ß√£o bidirecional.  Se algum m√≥dulo estiver acess√≠vel atrav√©s de classes de interface, o cliente tamb√©m poder√° criar implementa√ß√µes de algumas classes de interface e passar ponteiros para elas no m√≥dulo.  Por meio desses ponteiros, o m√≥dulo pode receber servi√ßos do cliente e tamb√©m transmitir dados ou notifica√ß√µes ao cliente. </p><br><a name="id-3-8"></a><br><h2>  3.8  Ponteiros inteligentes </h2><br><p>  Como o acesso a objetos da classe de implementa√ß√£o geralmente √© feito por meio de um ponteiro, √© natural usar ponteiros inteligentes para controlar sua vida √∫til.  Por√©m, deve-se ter em mente que, se a segunda op√ß√£o para excluir objetos for usada, com o ponteiro inteligente padr√£o √© necess√°rio transferir um deleter (tipo) ou uma inst√¢ncia desse tipo.  Se isso n√£o for feito, o ponteiro inteligente usar√° o operador <code>delete</code> para excluir o objeto, e o c√≥digo simplesmente n√£o ser√° compilado (gra√ßas ao destruidor protegido).  Ponteiros inteligentes padr√£o (incluindo o uso de removedores personalizados) s√£o discutidos em detalhes em [Josuttis], [Meyers3].  Um exemplo de uso de um removedor personalizado pode ser encontrado na se√ß√£o 4.3.1. </p><br><p>      ,       ,      ,    . </p><br><a name="id-3-9"></a><br><h2> 3.9.  - </h2><br><p>     -    const.              ,  ,    -,       . </p><br><a name="id-3-10"></a><br><h2> 3.10. COM- </h2><br><p> COM-    ,     ,  COM ‚Äî      ,  COM-     ,   C,    ,   .  COM-  C++      ,   COM. </p><br><a name="id-3-11"></a><br><h2> 3.11.     </h2><br><p>         (API)    (SDK).       .    -,      -,           .     ,     (Windows DLL),     :  -.          .        ,  ,       .     <code>LoadLibrary()</code>      ,    -,       . </p><br><a name="id-4"></a><br><h1> 4.       </h1><br><a name="id-4-1"></a><br><h2>  4.1   </h2><br><p>       ,      . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBase</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IBase() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   public:    virtual void Delete() = 0; //      IBase&amp; operator=(const IBase&amp;) = delete; //   };</span></span></code> </pre> <br><p>    . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IActivatable</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IBase { <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    ~IActivatable() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   public:    virtual void Activate(bool activate) = 0;    static IActivatable* CreateInstance(); // - };</span></span></code> </pre> <br><p> ,         ,     .     ,           <code>IBase</code> .     ,            (.  1.3).       ,       . </p><br><a name="id-4-2"></a><br><h2>  4.2   </h2><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activator</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IActivatable { <span class="hljs-comment"><span class="hljs-comment">// ... private:    Activator(); protected:    ~Activator(); public:    void Delete() override;    void Activate(bool activate) override;    friend IActivatable* IActivatable::CreateInstance(); }; Activator::Activator() {/* ... */} Activator::~Activator() {/* ... */} void Activator::Delete() { delete this; } void Activator::Activate(bool activate) {/* ... */} IActivatable* IActivatable::CreateInstance() {    return static_cast&lt;IActivatable*&gt;(new Activator()); }</span></span></code> </pre> <br><p>      , ,        ,  -  ,         . </p><br><a name="id-4-3"></a><br><h2>  4.3    </h2><br><a name="id-4-3-1"></a><br><h3> 4.3.1.     </h3><br><p>           . -   (     <code>IBase</code> ): </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseDeleter</span></span></span><span class="hljs-class"> {</span></span>    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(IBase* p)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ p-&gt;Delete(); } };</code> </pre> <br><p>  <code>std::unique_ptr&lt;&gt;</code> -   : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class">&gt; // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class"> ‚Äî  </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBase</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">using</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UniquePtr</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">std</span></span></span><span class="hljs-class">:</span></span>:<span class="hljs-built_in"><span class="hljs-built_in">unique_ptr</span></span>&lt;I, BaseDeleter&gt;;</code> </pre> <br><p> ,   ,  -   ,  <code>UniquePtr</code>    . </p><br><p>   -: </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class">&gt; // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class"> ‚Äî  - </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateInstance</span></span></span><span class="hljs-class">() </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UniquePtr</span></span></span><span class="hljs-class">&lt;I&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateInstance</span></span></span><span class="hljs-class">() {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UniquePtr&lt;I&gt;(I::CreateInstance()); }</code> </pre> <br><p>        : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class">&gt; // </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class"> ‚Äî  </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBase</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UniquePtr</span></span></span><span class="hljs-class">&lt;I&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToPtr</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">I</span></span></span><span class="hljs-class">* </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">) {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UniquePtr&lt;I&gt;(p); }</code> </pre> <br><p>  <code>std::shared_ptr&lt;&gt;</code>    <code>std::unique_ptr&lt;&gt;</code> ,   ,  <code>std::shared_ptr&lt;&gt;</code>   .      <code>Activator</code> . </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> un1 = CreateInstance&lt;IActivatable&gt;(); un1-&gt;Activate(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> un2 = ToPtr(IActivatable::CreateInstance()); un2-&gt;Activate(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;IActivatable&gt; sh = CreateInstance&lt;IActivatable&gt;(); sh-&gt;Activate(<span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre> <br><p>          (     ‚Äî -): </p><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">shared_ptr</span></span>&lt;IActivatable&gt; sh2(IActivatable::CreateInstance());</code> </pre> <br><p>     <code>std::make_shared&lt;&gt;()</code> ,      (    ). </p><br><p>    :          ,     .     :     ,  - .     4.4. </p><br><a name="id-4-3-2"></a><br><h3> 4.3.2.     </h3><br><p>       .           -.   <code>std::shared_ptr&lt;&gt;</code>         ,    ,      (         ).     <code>std::shared_ptr&lt;&gt;</code> (  )  -  ,           <code>delete</code>     .  <code>std::shared_ptr&lt;&gt;</code> -       (   )   -      .        . </p><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; class IActivatable; using ActPtr = std::shared_ptr&lt;IActivatable&gt;; //   class IActivatable { protected:    virtual ~IActivatable() = default; //      IActivatable&amp; operator=(const IActivatable&amp;) = default; //   public:    virtual void Activate(bool activate) = 0;    static ActPtr CreateInstance(); // - }; //   class Activator : public IActivatable { // ... public:    Activator();  //      ~Activator(); //      void Activate(bool activate) override; }; Activator::Activator() {/* ... */} Activator::~Activator() {/* ... */} void Activator::Activate(bool activate) {/* ... */} ActPtr IActivatable::CreateInstance() {    return ActPtr(new Activator()); }</span></span></span></span></code> </pre> <br><p>  -        <code>std::make_shared&lt;&gt;()</code> : </p><br><pre> <code class="cpp hljs">ActPtr IActivatable::CreateInstance() {    <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::make_shared&lt;Activator&gt;(); }</code> </pre> <br><p>      <code>std::unique_ptr&lt;&gt;</code> ,        , -   ,        . </p><br><a name="id-4-4"></a><br><h2>  4.4     </h2><br><p>    C#  Java  C++    ¬´¬ª,       .        .      <code>IBase</code> . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBase</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    IBase() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IBase() = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// ,       virtual void Delete(); //   public:    IBase(const IBase&amp;) = delete;            //      IBase&amp; operator=(const IBase&amp;) = delete; //      struct Deleter        // -    {        void operator()(IBase* p) const { p-&gt;Delete(); }    };    friend struct IBase::Deleter; };</span></span></code> </pre> <br><p>     , <code>Delete()</code>    ,     . </p><br><pre> <code class="cpp hljs">IBase::~IBase() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> IBase::Delete() { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }</code> </pre> <br><p>      <code>IBase</code> .         <code>Delete()</code> ,              . -      <code>IBase</code> . <code>Delete()</code>  , - .     <code>Delete()</code>         ,    .       ,    4.3.1. </p><br><a name="id-5"></a><br><h1> 5.   ,      </h1><br><a name="id-5-1"></a><br><h2> 5.1  </h2><br><p>  ,    ,   ,      ,        . </p><br><p>   ,  ,    <code>IException</code>    <code>Exception</code> . </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IException</span></span></span><span class="hljs-class"> {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">friend</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Exception</span></span></span><span class="hljs-class">;</span></span>    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> IException* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~IException() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">What</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    IException&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> IException&amp;) = <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>; }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Exception</span></span></span><span class="hljs-class"> {</span></span>    IException* <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> m_Ptr; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    Exception(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* what, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code);    Exception(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Exception&amp; src) : m_Ptr(src.m_Ptr-&gt;Clone()) {}    ~Exception() { m_Ptr-&gt;Delete(); }    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> IException* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Ptr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_Ptr; } };</code> </pre> <br><p>         <code>Exception</code> ,            <code>IException</code> .       ,    <code>throw</code> ,   .    <code>Exception</code>      ,      .  -      ,   . </p><br><p>  <code>Exception</code> , ,  . </p><br><p>   <code>IException</code> : </p><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExcImpl</span></span></span><span class="hljs-class"> :</span></span> IException {    <span class="hljs-keyword"><span class="hljs-keyword">friend</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Exception</span></span></span><span class="hljs-class">;</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> m_What;    <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m_Code;    ExcImpl(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* what, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code);    ExcImpl(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ExcImpl&amp;) = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>;    <span class="hljs-function"><span class="hljs-function">IException* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Clone</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> override</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    ~ExcImpl() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function">* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">What</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Code</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> override</span></span>; }; ExcImpl::ExcImpl(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* what, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code)    : m_What(what), m_Code(code) {} IException* ExcImpl::Clone() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ExcImpl(*<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> ExcImpl::Delete() { <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* ExcImpl::What() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_What.c_str(); } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ExcImpl::Code() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> m_Code; }</code> </pre> <br><p>   <code>Exception</code> : </p><br><pre> <code class="cpp hljs">Exception::Exception(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* what, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> code)    : m_Ptr(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ExcImpl(what, code)) {}</code> </pre> <br><p>    ,       ‚Äî .NET ‚Äî  , ‚Äî          ,     C++/CLI.  ,        ,     ,   C++/CLI. </p><br><a name="id-5-2"></a><br><h2> 5.2  </h2><br><p>   -    : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ICollect</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~ICollect() = <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ICollect&lt;T&gt;* Clone() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Delete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsEmpty</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetCount</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> T&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ind)</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> T&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ind)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>;    ICollect&lt;T&gt;&amp; <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>=(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ICollect&lt;T&gt;&amp;) = <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>; };</code> </pre> <br><p>        ,             -,        . </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ICollect</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Iterator</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Contain</span></span></span><span class="hljs-class"> {</span></span>    <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> ICollect&lt;T&gt; CollType;    CollType* m_Coll; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>:    <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> T value_type;    Contain(CollType* coll);    ~Contain(); <span class="hljs-comment"><span class="hljs-comment">//     Contain(const Contain&amp; src);    Contain&amp; operator=(const Contain&amp; src); //     Contain(Contain&amp;&amp; src);    Contain&amp; operator=(Contain&amp;&amp; src);    bool mpty() const;    int size() const;    T&amp; operator[](int ind);    const T&amp; operator[](int ind) const;    Iterator&lt;T&gt; begin();    Iterator&lt;T&gt; end(); };</span></span></code> </pre> <br><p>      .   ,       . ,      ,    ,     ,    - <code>begin()</code>  <code>end()</code> ,   .           (. [Josuttis]),         <code>for</code>   .                .            , ,      . </p><br><a name="id-6"></a><br><h1> 6.    - </h1><br><p>       .         -,      .          .   ,         ++.              ,   .NET, Java  Pyton.              .      ,  ,         .   .NET Framework     C++/CLI          C++.    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> . </p><br><a name="id-conclusion"></a><br><h1> 7.  </h1><br><p>      -,         . </p><br><p>         . </p><br><ol><li>   <code>delete</code> . </li><li>    . </li><li>      . </li></ol><br><p>          . </p><br><p>         ,       <code>delete</code> .                ,      . </p><br><p>    -   ,           .             ,    ,      <code>delete</code> . </p><br><p>             . </p><br><p>      ,          ,     ,  ,       . </p><br><br><a name="id-refs"></a><br><h1>   </h1><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[GoF] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gamma E., Helm R., Johnson R., Vlissides J. M√©todos de design orientado a objetos. </font><font style="vertical-align: inherit;">Padr√µes de design.: Por. </font><font style="vertical-align: inherit;">do ingl√™s </font><font style="vertical-align: inherit;">- S√£o Petersburgo: Peter, 2001.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Josuttis] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Josattis, Nikolai M. Biblioteca padr√£o C ++: Reference Guide, 2a ed.: Per. </font><font style="vertical-align: inherit;">do ingl√™s </font><font style="vertical-align: inherit;">- M .: LLC ‚ÄúI.D. </font><font style="vertical-align: inherit;">Williams, 2014.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Dewhurst] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dewhurst, Stefan K. Slippery coloca C ++. </font><font style="vertical-align: inherit;">Como evitar problemas ao projetar e compilar seus programas. </font><font style="vertical-align: inherit;">do ingl√™s </font><font style="vertical-align: inherit;">- M .: DMK Press, 2012.</font></font></p><br><p> [Meyers1] <br> , .    C++. 35        .: .  . ‚Äî .:  , 2000. </p><br><p> [Meyers2] <br> , .   C++. 55        .: .  . ‚Äî .:  , 2014. </p><br><p> [Meyers3] <br> , .    C++: 42    C++11  C++14.: .  . ‚Äî .:  ¬´.. ¬ª, 2016. </p><br><p> [Sutter] <br> , .     C++.: .  . ‚Äî :  ¬´.. ¬ª, 2015. </p><br><p> [Sutter/Alexandrescu] <br> , . , .    ++.: .  . ‚Äî .:  ¬´.. ¬ª, 2015. </p><br></div></div><br><br></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt427281/">https://habr.com/ru/post/pt427281/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt427271/index.html">Hist√≥ria e experi√™ncia do uso de tradu√ß√£o autom√°tica. Palestra Yandex</a></li>
<li><a href="../pt427273/index.html">A intelig√™ncia artificial pode deixar as casas de apostas sem trabalho?</a></li>
<li><a href="../pt427275/index.html">Arquitetura de informa√ß√µes da Internet, parte 3</a></li>
<li><a href="../pt427277/index.html">Um padr√£o de difra√ß√£o √© encontrado na distribui√ß√£o dos primos, semelhante aos quasicristais</a></li>
<li><a href="../pt427279/index.html">CoLaboratory: Noite do Android # Apple</a></li>
<li><a href="../pt427283/index.html">Como √© garantida a alta disponibilidade no Kubernetes</a></li>
<li><a href="../pt427285/index.html">Escola b√°sica de circuitos digitais: Novosibirsk - Ok, Krasnoyarsk - prepare-se</a></li>
<li><a href="../pt427289/index.html">Modelagem Geol√≥gica 3D, Registro e Tecnologia da Aramco Innovations</a></li>
<li><a href="../pt427291/index.html">Minimize o tr√°fego nos formul√°rios da Web do ASP.NET, div clic√°vel e pesquisas peri√≥dicas no servidor</a></li>
<li><a href="../pt427293/index.html">Padr√µes de Design JavaScript</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>