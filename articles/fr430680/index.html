<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë®‚Äçüëß‚Äçüë¶ üßñüèª ü§ß √âcrire un processeur et un environnement simples pour cela üîª ü§≤üèæ üï∑Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour Dans cet article, je vais vous expliquer les √©tapes √† suivre pour cr√©er un processeur et un environnement simples. 
 Architecture du jeu de co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>√âcrire un processeur et un environnement simples pour cela</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430680/"><p>  Bonjour  Dans cet article, je vais vous expliquer les √©tapes √† suivre pour cr√©er un processeur et un environnement simples. </p><a name="habracut"></a><br><h1 id="arhitektura-nabora-komand-isahttpsruwikipediaorgwikid090d180d185d0b8d182d0b5d0bad182d183d180d0b0_d0bdd0b0d0b1d0bed180d0b0_d0bad0bed0bcd0b0d0bdd0b4">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Architecture du jeu de commandes (ISA)</a> </h1><br><p>  Vous devez d'abord d√©cider quel sera le processeur.  Les param√®tres suivants sont importants: </p><br><ul><li>  La taille du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mot machine</a> et des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">registres</a> (bit / "bit" du processeur) </li><li>  Instructions de la machine (instructions) et leur taille </li></ul><br><p>  Les architectures de processeur peuvent √™tre divis√©es en 2 types en fonction de la taille des instructions (en fait, il y en a plus, mais d'autres options sont moins populaires): </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><em>RISC</em></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><em>CISC</em></a> </li></ul><br><p>  Leur principale diff√©rence est que <em>les</em> processeurs <em>RISC</em> ont la m√™me taille d'instruction.  Leurs instructions sont simples et s'ex√©cutent relativement rapidement, tandis que <em>les</em> processeurs <em>CISC</em> peuvent avoir diff√©rentes tailles d'instructions, dont certaines peuvent prendre un certain temps. </p><br><p>  J'ai d√©cid√© de faire un processeur <em>RISC</em> un peu comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><em>MIPS</em></a> . </p><br><p>  Je l'ai fait pour un certain nombre de raisons: </p><br><ul><li>  Il est assez simple de cr√©er un prototype d'un tel processeur. </li><li>  Toute la complexit√© de ce type de processeur est transf√©r√©e √† des programmes tels que l'assembleur et / ou le compilateur. </li></ul><br><p>  Voici les principales caract√©ristiques de mon processeur: </p><br><ul><li>  Mot machine et taille de registre - 32 bits </li><li>  64 registres (y compris <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le compteur de commandes</a> ) </li><li>  2 types d'instructions </li></ul><br><p>  <em>Le type de registre</em> (ci-apr√®s le type de registre) ressemble √† ceci: </p><br><p><img src="https://habrastorage.org/webt/se/sy/ys/sesyysl1k4_d-2ruukf-fgtkni8.png" alt="rtype" title="Type d'enregistrement"></p><br><p>  La particularit√© de ces instructions est qu'elles fonctionnent avec trois registres. </p><br><p>  <em>Type imm√©diat</em> : </p><br><p><img src="https://habrastorage.org/webt/vw/is/ij/vwisij-vr9pbu-sw6sz63dg7nqe.png" alt="itype" title="Type imm√©diat"></p><br><p>  Les instructions de ce type fonctionnent avec deux registres et un num√©ro. </p><br><p>  <em>OP</em> est le num√©ro de l'instruction √† ex√©cuter (ou pour indiquer que cette instruction de <em>type registre</em> ). </p><br><p>  <em>R0</em> , <em>R1</em> , <em>R2</em> sont des num√©ros de registre qui servent d'op√©randes pour l'instruction. </p><br><p>  <em>Func</em> est un champ suppl√©mentaire utilis√© pour indiquer le type d'instructions de <em>type Register</em> . </p><br><p>  <em>Imm</em> est le champ o√π la valeur est √©crite, que nous voulons fournir explicitement des instructions sous forme d'op√©rande. </p><br><ul><li>  Seulement 28 instructions </li></ul><br><p>  Une liste compl√®te des instructions peut √™tre trouv√©e dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©p√¥t github</a> . </p><br><p>  En voici quelques-unes: </p><br><pre><code class="plaintext hljs">nor r0, r1, r2</code> </pre> <br><p>  <em>NOR</em> est une instruction de <em>type Registre</em> qui effectue un <strong><em>OU</em></strong> logique <strong><em>NON</em></strong> sur les registres r1 et r2, apr√®s quoi elle √©crit le r√©sultat dans le registre r0. </p><br><p>  Pour utiliser cette instruction, vous devez modifier le champ <em>OP</em> en <strong>0000</strong> et le champ <em>Func</em> en <strong>0000000111</strong> dans le syst√®me num√©rique binaire. </p><br><pre> <code class="plaintext hljs">lw r0, n(r1)</code> </pre> <br><p>  <em>LW</em> est une instruction de <em>type Imm√©diat</em> qui charge une valeur de m√©moire √† <strong>r1 + n</strong> dans le registre r0. </p><br><p>  Pour utiliser cette instruction, vous devez √† son tour changer le champ <em>OP</em> en <strong>0111</strong> et √©crire le nombre <strong>n</strong> dans le champ <em>IMM</em> . </p><br><h1 id="napisanie-koda-processora">  √âcriture du code du processeur </h1><br><p>  Apr√®s avoir cr√©√© l' <em>ISA,</em> vous pouvez commencer √† √©crire le processeur. </p><br><p>  Pour cela, nous avons besoin de conna√Ætre une sorte de langage de description d'√©quipement.  En voici quelques uns: </p><br><ul><li>  Verilog </li><li>  VHDL (√† ne pas confondre avec le pr√©c√©dent!) </li></ul><br><p>  J'ai choisi Verilog, car  sa programmation faisait partie de mon cursus universitaire. </p><br><p>  Pour √©crire un processeur, vous devez comprendre la logique de son fonctionnement: </p><br><ol><li>  Obtenir des instructions sur le <em>compteur de commandes (PC)</em> </li><li>  Instructions de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©codage</a> </li><li>  Ex√©cution des instructions </li><li>  Ajout au <em>compteur de la</em> taille de <em>commande</em> de l'instruction ex√©cut√©e </li></ol><br><p>  Et ainsi de suite √† l'infini. </p><br><p>  Il s'av√®re que vous devez cr√©er plusieurs modules: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Enregistrer le fichier</a> </li><li>  D√©codeur </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ALU</a> </li></ul><br><p>  Nous analyserons chaque module individuellement. </p><br><h2 id="registrovyy-fayl">  Enregistrer le fichier </h2><br><p>  Un fichier de registre permet d'acc√©der aux registres.  Avec lui, vous devez obtenir les valeurs de certains registres ou les modifier. </p><br><p>  Dans mon cas, j'ai 64 registres.  Dans l'un des registres, le r√©sultat de l'op√©ration sur les deux autres est √©crit, donc je dois fournir la possibilit√© de changer un seul et d'obtenir les valeurs des deux autres. </p><br><h2 id="dekoder">  D√©codeur </h2><br><p>  Un d√©codeur est cette unit√© qui est responsable des instructions de d√©codage.  Il indique quelles op√©rations doivent √™tre effectu√©es par l'ALU et d'autres unit√©s. </p><br><p>  Par exemple, l' <em>instruction addi</em> doit ajouter la valeur du registre <strong>$ z√©ro</strong> (elle stocke toujours <strong>0</strong> ) et <strong>20</strong> et mettre le r√©sultat dans le registre $ t0. </p><br><pre> <code class="plaintext hljs">addi $t0, $zero, 20</code> </pre> <br><p>  √Ä ce stade, le d√©codeur d√©termine que cette instruction: </p><br><ul><li>  Type imm√©diat </li><li>  Doit √©crire le r√©sultat dans le registre </li></ul><br><p>  Et transf√®re ces informations dans les blocs suivants. </p><br><h2 id="alu">  ALU </h2><br><p>  Apr√®s le contr√¥le passe √† ALU.  Il effectue g√©n√©ralement toutes les op√©rations math√©matiques et logiques, ainsi que les op√©rations de comparaison des nombres. </p><br><p>  Autrement dit, si nous consid√©rons la m√™me instruction <em>addi</em> , √† ce stade, l'addition de <strong>0</strong> et <strong>20</strong> se produit. </p><br><h2 id="drugie">  Autre </h2><br><p>  En plus des blocs ci-dessus, le processeur devrait pouvoir: </p><br><ul><li>  Obtenir et modifier des valeurs en m√©moire </li><li>  Effectuer des sauts conditionnels </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l√†,</a> vous pouvez voir √† quoi cela ressemble dans le code. </p><br><h1 id="assembler">  Assembleur </h1><br><p>  Apr√®s avoir √©crit le processeur, nous avons besoin d'un programme qui convertit les commandes de texte en code machine afin de ne pas le faire manuellement.  Par cons√©quent, vous devez √©crire l'assembleur. </p><br><p>  J'ai d√©cid√© de l'impl√©menter dans le langage de programmation C. </p><br><p>  √âtant donn√© que mon processeur a une architecture <em>RISC</em> , afin de simplifier ma vie, j'ai d√©cid√© de concevoir l'assembleur afin de pouvoir facilement ajouter mes propres pseudo instructions (combinaisons de plusieurs instructions √©l√©mentaires ou d'autres pseudo instructions). </p><br><p>  Vous pouvez l'impl√©menter √† l'aide d'une structure de donn√©es qui stocke le type d'instruction, son format, un pointeur sur une fonction qui renvoie les codes d'instructions machine et son nom. </p><br><p>  Un programme r√©gulier commence par une d√©claration de segment. </p><br><p>  Deux segments <strong>.text</strong> nous suffisent - dans lesquels le code source de nos programmes sera stock√© - et <strong>.data</strong> - dans lequel nos donn√©es et constantes seront stock√©es. </p><br><p>  Une instruction pourrait ressembler √† ceci: </p><br><pre> <code class="plaintext hljs">.text jie $zero, $zero, $zero #  addi $t1, $zero, 2 # $t1 = $zero + 2 lw $t1, 5($t2) # $t1 = *($t2 + 5) syscall 0, $zero, $zero # syscall(0, 0, 0) la $t1, label# $t1 = label</code> </pre> <br><p>  D'abord, le nom de l'instruction est indiqu√©, puis les op√©randes. </p><br><p>  En <strong>.data</strong> , les d√©clarations de donn√©es sont indiqu√©es. </p><br><pre> <code class="plaintext hljs">.data .byte 23 #   1  .half 1337 #   2  .word 69000, 25000 #   4  .asciiz "Hello World!" #     ( ) .ascii "12312009" #   ( ) .space 45 #  45 </code> </pre> <br><p>  Une annonce doit commencer par un point et un nom de type de donn√©es, suivis de constantes ou d'arguments. </p><br><p>  Il est pratique d'analyser (scanner) le fichier assembleur comme suit: </p><br><ol><li>  Commencez par scanner le segment </li><li>  S'il s'agit d'un segment <strong>.data</strong> , nous analysons diff√©rents types de donn√©es ou un segment <strong>.text</strong> </li><li>  S'il s'agit d'un segment <strong>.text</strong> , nous analysons les commandes ou un segment .data </li></ol><br><p>  Pour fonctionner, l'assembleur doit parcourir le fichier source 2 fois.  La premi√®re fois qu'il consid√®re les d√©calages des liens (ils servent), ils ressemblent g√©n√©ralement √† ceci: </p><br><pre> <code class="plaintext hljs"> la $s4, loop #   loop  s4 loop: # ! mul $s2, $s2, $s1 # s2 = s2 * s1 addi $s1, $s1, -1 # s1 = s1 - 1 jil $s3, $s1, $s4 #  s3 &lt; s1    </code> </pre> <br><p>  Et dans le deuxi√®me passage, vous pouvez d√©j√† g√©n√©rer un fichier. </p><br><h1 id="itog">  R√©sum√© </h1><br><p>  √Ä l'avenir, vous pouvez ex√©cuter le fichier de sortie de l'assembleur sur notre processeur et √©valuer le r√©sultat. </p><br><p>  De plus, un assembleur pr√™t √† l'emploi peut √™tre utilis√© dans le compilateur C.  Mais c'est plus tard. </p><br><p>  R√©f√©rences: </p><br><ul><li>  Conception de syst√®mes informatiques num√©riques avec Verilog.  David J. Lilja et Sachin S. Sapatnekar </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Code source</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Code source d'un autre processeur</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430680/">https://habr.com/ru/post/fr430680/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430670/index.html">Gestion des arrangements</a></li>
<li><a href="../fr430672/index.html">Version texte du rapport ¬´Acteurs vs CSP vs T√¢ches ...¬ª avec C ++ CoreHard Automne 2018</a></li>
<li><a href="../fr430674/index.html">La logique de construction d'horaires de travail universels</a></li>
<li><a href="../fr430676/index.html">Antiquit√©s: shshshsh, sssssss, VOIP, BBS et autres amis du modem</a></li>
<li><a href="../fr430678/index.html">Test de dix gradateurs avec lampes LED</a></li>
<li><a href="../fr430682/index.html">Trois ans du projet de microsatellites lunaires: √©tapes de la croissance</a></li>
<li><a href="../fr430684/index.html">Analyse des contrats Ethereum en direct pour une erreur d'envoi non contr√¥l√©. 2e partie</a></li>
<li><a href="../fr430686/index.html">Pr√©sentation: la premi√®re machine de d√©coupe au jet d'eau de WAZER</a></li>
<li><a href="../fr430688/index.html">Transfert de donn√©es via QR anim√© vers Gomobile et GopherJS</a></li>
<li><a href="../fr430690/index.html">Exceptions d√©terministes et gestion des erreurs dans le ¬´C ++ du futur¬ª</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>