<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👰🏼 🧑🏼‍🤝‍🧑🏼 ⏩ 使用KOMPAS-3D API→第16课→控制字符 🤘🏻 🌬️ 🧕🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我们继续阅读有关使用CAD API COMPASS-3D的系列文章。 在本周期的先前课程中，控制字符已经出现过几次了。 然后每次都说输出行不应包含它们，因为COMPAS以特殊方式处理它们。 现在是时候更好地了解他们了。 

 掌握了它们的工作之后，您将了解创建复杂的复合字符串是一项微不足道的任务，在...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>使用KOMPAS-3D API→第16课→控制字符</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ascon/blog/457702/"> 我们继续阅读有关使用CAD API COMPASS-3D的系列文章。 在本周期的先前课程中，控制字符已经出现过几次了。 然后每次都说输出行不应包含它们，因为COMPAS以特殊方式处理它们。 现在是时候更好地了解他们了。 <br><br> 掌握了它们的工作之后，您将了解创建复杂的复合字符串是一项微不足道的任务，在大多数情况下，不需要编写大量代码。 <br><br> 在本课中，我们将研究如何将特殊字符和字体字符与控制字符一起使用，讨论如何在它们的帮助下创建小数和偏差，并考虑将其与段落结合使用。 <br><br><img src="https://habrastorage.org/webt/5c/cs/bd/5ccsbdc8ufpd1vavz6hzfbqasas.png"><br><a name="habracut"></a><br><blockquote><h4> 课程系列“使用KOMPAS-3D API的工作”的内容 </h4><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">基础知识</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">图纸设计</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">正确连接到KOMPAS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">主题词</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">图形图元</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">以各种格式保存文档</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了解设置</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">标题栏中更复杂的书写方法</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">读取字幕单元</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">特殊字符，包括字符串</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">简单文字标签</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">复合弦</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">段落</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">多行文字</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">基于段落的复合线</a> </li><li>  <b>控制字符</b> </li></ol></blockquote><br><h2>  <font color="#00B2FF">课程复习</font> </h2><br> 控制字符为：@，$，＆，;，〜，^和＃。 不幸的是，KOMPAS SDK几乎没有关于如何使用它们的信息。 有关更多信息，请参见<i>“ 9.</i>部分<i>”中</i>的KOMPAS帮助<i>。</i>  <i>KOMPAS-3D设置/系统设置存储/服务文件/用户菜单文件/文件语法</i> 。 <i>”</i> <br><br><img src="https://habrastorage.org/webt/ya/jc/cx/yajccx87d-06xfzy5rjhfdlc2wa.png"><br><br> 所有控制字符都可以有条件地分为两组：主要和辅助。 辅助符号仅与主要符号一起使用，并且它们本身不描述任何组件。 下表简要说明了控制字符。 <br><br><img src="https://habrastorage.org/webt/bg/tj/ap/bgtjapszut_xvfq_u2vq0l3rak4.png"><br><br> 让我们更详细地考虑它们。 <br><br><h2>  <font color="#00B2FF">插入特殊字符</font> </h2><br> 我们已经考虑了特殊字符（请参阅第<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">4</a>和第<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">10</a>课）。 然后，要插入一个特殊字符，使用了<b>ksTextItemParam</b>接口的单独实例。 使用控制字符，您可以在字符串中插入尽可能多的特殊字符，而无需<b>重新使用ksTextItemParam</b>接口。 <br> 插入特殊字符的语法为： <br><br>  <i><b>AA</b> @ <b>YXXXX〜BB</b></i> <br><br> 在哪里 <br>  <b>AA-</b>位于特殊字符之前的字符串， <br>  <b>Y-</b>表示特殊字符代码的修饰符， <br>  <b>XXXX-</b>插入的特殊字符的代码。 <br>  <b>BB-</b>特殊字符后的一行。 <br><br> 插入的特殊字符的代码在<i>@</i>和<i>〜</i>之间指定。 此外，根据修饰符<b>Y</b>的值，可以十进制或十六进制表示。 下表中显示了有效的修饰符<b>Y</b>值。 <br><br><img src="https://habrastorage.org/webt/pk/td/jq/pktdjqgmgj8ftldxtei4-614ct0.png"><br><br>  <i>注意：</i>如我的实验所示，COMPASS通常会处理<i>〜</i>字符的缺失。 在这种情况下，需要插入特殊字符。 但是，我强烈建议不要依赖此行为，并始终使用<i>〜</i>字符完成插入操作。 <br><br> 以下是演示特殊字符输出的程序示例。 <br><br><pre><code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" @+51~ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" @*33~ ")); document2D-&gt;ksText(100.0,90.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre> <br> 在此示例中，相同的字符（αalpha）显示两次。 第一次以十进制指定其代码，第二次以十六进制指定。 下图显示了程序的结果。 <br><br><img src="https://habrastorage.org/webt/o3/4b/3i/o34b3igkqgkvdrmze1ky6w4a1es.png"><br><br> 控制字符使您可以在同一行上显示几个特殊字符。 因此，在以下示例中，在一次对<b>ksText</b>方法的调用中显示了希腊字母的前三个字母。 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR("@+51~ @+52~ @+53~")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 下图显示了该程序的结果。 <br><br><img src="https://habrastorage.org/webt/mg/_v/xv/mg_vxv17mpco689p7gm6fzhp-ms.png"><br><br> 修饰符+是默认修饰符。 因此，上面的行可以这样写： <br><br>  <i>“ @ 51〜@ 52〜@ 53〜”</i> <br><br> 在这种情况下，程序的结果将保持不变。 <br><br> 如果<i>@是</i>无效字符，则<i>@</i>和<i>〜</i>之间的行将按原样显示。 字符<i>@</i>和<i>〜被</i>省略。 例如，使用以下行： <br><br>  <i>“在@ T51之前〜之后”</i> <br><br> 该文档将显示： <br><br>  <i>T51之前之后</i> <br><br>  <i>注意：</i> KOMPAS的这种行为是未记录的，并且在程序的不同版本中可能有所不同。 <br><br>  <i>注意：</i>控制字符不适用于插入包含字符串的特殊字符。 事实是，要限制其行为，您需要使用标志SPECIAL_SYMBOL_END（有关更多详细信息，请参见<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">本</a>周期的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">10节</a> ），但是控制字符不允许使用标志。 <br><br><h2>  <font color="#00B2FF">插入字体字符</font> </h2><br> 除特殊字符外，您还可以按其代码插入普通字符。 控制字符<i>^</i>和<i>〜</i>用于此目的。 它们的语法在下面给出。 <br><br>  <i><b>AA</b> ^（ <b>FNAME</b> ） <b>YXXXX〜BB</b></i> <br><br> 在哪里 <br>  <b>AA-</b>位于插入字符之前的字符串， <br>  <b>FNAME-提取</b>字符的字体名称， <br>  <b>Y-</b>修饰符，用于表示字符代码（类似于@）， <br>  <b>XXXX-</b>插入字符的数字代码， <br>  <b>BB-</b>插入字符后的一行。 <br><br> 就其目的而言，控制字符<i>^</i>与<i>@</i>相似。 它们甚至具有相似的语法。 但是它们之间有两个重要区别： <br><br><ol><li>  <i>^</i>不是插入特殊字符，而是按其代码插入字体字符； </li><li> 对于要插入的字符，可以在<b>FNAME</b>字段中设置字体（@不允许这样做）。 </li></ol><br> 可以使用charmap应用程序（符号表）查看符号代码，该应用程序是Windows操作系统的一部分。 <br><br> 如果未指定字体，则使用默认字体。 以下是使用<i>^</i>字符的示例。 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" ^(Arial)*B1~  ^*39~ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 在此示例中，在结果字符串中插入了两个字符，第一个字符选择字体<i>Arial</i> ，第二个字符保留默认字体。 下图显示了输出到文档的行。 <br><br><img src="https://habrastorage.org/webt/lj/8i/5k/lj8i5kqw_acqwuvq0lulgnmgolw.png"><br><br> 请注意：仅针对显示的字符设置字体。 如我的实验所示，KOMPAS通常处理不存在终止子的情况。 但是，我不建议依赖此行为，并且始终设置终结器。 <br><br> 如果在<i>^</i>之后指定了无效字符（或无效代码）， <i>则会</i>省略<i>^</i>和<i>〜</i> ，并使用默认字体按原样显示它们之间的行。 例如，与行 <br><br>  <i>“ ^ Q（Arial）前* B1〜之后”</i> <br><br> 该文档将显示： <br><br>  <i>“ Q之前（Arial）* B1之后”</i> <br><br> 如果在<b>FNAME</b>字段中输入了错误的字体名称，则KOMPAS将选择该字体并在其中显示字符。 <br><br> 如果该行中没有右括号，则不会完全显示该行。 例如，使用以下行： <br><br>  <i>“在^ Q之前（Arial * B1〜之后）”</i> <br><br> 该文件只会显示 <br><br>  <i>“直到”</i> <br><br>  <i>注意：</i>以上带有错误控制字符语法的行为对于KOMPAS-3D V17有效，并且未记录。 在其他版本中，它可能有所不同。 <br><br><h2>  <font color="#00B2FF">插入字符的其他方式</font> </h2><br> 字符<i>@</i>和<i>^分别</i>具有类似物- <i>＆</i>和<i>＃</i> 。 它们具有相似的语法： <br><br>  <i><b>AA</b>和<b>XX〜BB</b></i> <i><br></i>  <i><b>AA</b> ＃（ <b>FNAME</b> ） <b>XX〜BB</b></i> <br><br> 在哪里 <br><br>  <b>AA-</b>在插入的字符之前显示的字符串， <br>  <b>XX-</b>插入字符的代码（对于＆-特殊字符，对于＃-字体字符）， <br>  <b>BB-</b>在插入字符后显示的字符串， <br>  <b>FNAME-</b>字体名称。 <br><br>  <i>@</i>和<i>^</i>字符及其对应的字符之间只有两个区别： <br><br><ol><li>  ＆和＃字符没有Y修饰符，字符代码始终以十进制表示法指定。 </li><li> 要插入的字符的代码最多由两位数字指定。 </li></ol><br> 以下是演示如何使用<i>＆</i>和<i>＃</i>字符的程序的源代码。 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" &amp;51~ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" #(Arial)37~  #37~ ")); document2D-&gt;ksText(100.0,90.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 下图显示了该程序的结果。 <br><br><img src="https://habrastorage.org/webt/xq/ku/tw/xqkutwd7x225k5zx8dd-lsriorg.png"><br><br><h2>  <font color="#00B2FF">多行文字</font> </h2><br> 使用控制字符，可以显示多行文本。 为此，在转移到新行的位置，您需要插入以下序列： <i>@ /</i> 。 注意： <i>@</i>字符不带终止符<i>〜</i> 。 以下是使用控制字符显示多行文本的程序的源代码。 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" @/ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 请注意：由于使用了控制字符，我们仅需调用<b>ksText</b>方法即可显示两行文本。 下图显示了该程序的结果。 <br><br><img src="https://habrastorage.org/webt/tp/-3/fm/tp-3fmwgsjpyrgrhhw9icccok70.png"><br><br><h2>  <font color="#00B2FF">插入控制字符</font> </h2><br> 我们想出了如何插入任意特殊字符和Unicode字符。 但是，如果您想插入控制字符本身怎么办？ 在这里，您可以通过两种方式进行。 第一种方法是使用<i>^</i>字符并将其粘贴为常规字体字符。 但是，有一种更简单的方法。 <br><br> 符号<i>;</i> 是辅助的，可以直接插入文本中。 要插入其他控制字符，您需要将它们加倍。 也就是说，一对<i>@@</i>字符将单个<i>@</i>字符插入文本中。 其他控制字符也是如此。 <br><br> 下面是一个示例程序，演示了如何在字符串中插入控制字符。 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" : @@ $$ &amp;&amp; ; ~~ ^^ ##")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 下图显示了该程序的结果。 <br><br><img src="https://habrastorage.org/webt/4t/jv/rx/4tjvrxux7i2epcfivimh8aai-2g.png"><br><br><h2>  <font color="#00B2FF">上下偏差</font> </h2><br> 以下语法用于插入偏差： <br><br>  <i><b>AA</b> $ <b>XX</b> ;</i>  <i><b>YY</b> $ <b>BB</b></i> <br><br> 在哪里 <br><br>  <b>AA-</b>偏差前显示的文字； <br>  <b>XX-</b>上限偏差； <br>  <b>YY</b>为下偏差； <br>  <b>BB-</b>偏差后显示的文本。 <br><br> 请注意：整个结构仅限于<i>$个</i>字符，“  »用作上下偏差之间的分隔符。 <br><br> 如果在字符<i>$</i>之间没有定界符“ <i>；</i>  ”，那么它们之间的整条线将被解释为最大偏差。 如果不存在组件<b>XX</b> ，即在第一个<i>$之后</i>立即变为“ <i>;</i>  ”，则随后的最接近<i>$</i>的整行将<i>被</i>解释为较低的偏差。 <br><br>  <i>注意：</i>偏差较大<i>的</i>文本不应以字母<i>b</i> ， <i>d</i> ， <i>s</i> ， <i>m</i>和<i>l</i> （小写<i>L</i> ）开头。 其原因将在后面解释。 <br><br> 以下是显示偏差输出的程序示例 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" $;$ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 下图显示了该程序的结果： <br><br><img src="https://habrastorage.org/webt/-w/hr/ql/-whrqlu38elpopxgq22zblob6tm.png"><br><br> 请注意KOMPAS只处理一个字符“ <i>;</i>  ”。 第二个字符是“ <i>;</i>  “可以解释为整个结构的终结者。 例如，在“ <i>11 $ 22; 33; 44 $</i> ”行中，屏幕将显示： <br><br><img src="https://habrastorage.org/webt/pf/22/0i/pf220i_rer29nw_nsx2h88ja_le.png"><br><br>  <i>注意：</i> KOMPAS的这种行为没有记录，因此您不能依赖它。 <br><br><h2>  <font color="#00B2FF">分数</font> </h2><br> 分数语法与偏差语法相似，并且具有两个等效选项： <br><br>  <i><b>AA</b> $ <b>bXX</b> ;</i>  <i><b>YY</b> $ <b>BB</b></i> <i><br></i>  <i><b>AA</b> $ <b>dXX</b> ;</i>  <i><b>YY</b> $ <b>BB</b></i> <br><br> 在哪里 <br><br>  <b>AA-</b>文本输出为分数； <br>  <b>XX</b>是分子； <br>  <b>YY</b>是分母； <br>  <b>BB-</b>分数后显示的文本。 <br><br> 请注意：分数输出和偏差输出之间的唯一区别是<i>$</i>的第一个符号后紧跟字母<i>d</i>或<i>b</i> 。 否则，它们的语法是相同的。 <br><br> 如果字符<i>$ d</i> （ <i>$ b</i> ）和<i>$</i>之间没有“ <i>；</i> ”  ”，那么它们之间的整行将被解释为分子。 如果不存在组件<b>XX</b> ，即在<i>$ d</i> （ <i>$ b</i> ）之后立即出现“ <i>;</i>  ，然后将最接近的<i>$</i>的整行都解释为分母。 <br><br>  <i>注意：</i>分子文本不能以字母<i>s</i> ， <i>m</i>或<i>l</i> （小写<i>L</i> ）开头。 其原因将在后面解释。 <br><br> 下面是一个程序示例，该示例演示使用控制字符输出小数。 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" $d;$ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 下图显示了该程序的结果。 <br><br><img src="https://habrastorage.org/webt/ha/sm/dd/hasmddwd9o67w8t747vhwceoae0.png"><br><br> 请注意，KOMPAS处理“额外”字符“ <i>;</i>  »以及出现偏差的情况。 此行为是未记录的，不能依赖。 <br><br><h2>  <font color="#00B2FF">变化和馏分大小控制</font> </h2><br> 在偏差或分数构建的最开始，可以找到一个字母： <i>s</i> ， <i>m</i>或<i>l</i> （小写<i>L</i> ）。 它们指定偏差的大小和分数的元素（分子和分母）。 下表描述了它们的目的。 <br><br><img src="https://habrastorage.org/webt/mp/ez/1u/mpez1un_2njdu3jxixivvwqbdz4.png"><br><br> 如果未指定这些字母，则将<i>l</i>用作分数，将<i>m</i>用作偏差。 下面是一个示例程序，演示了这些字母的用法。 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR(" $d;$ ")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" $dl;$ ")); document2D-&gt;ksText(100.0,85.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" $dm;$ ")); document2D-&gt;ksText(100.0,70.0,0.0,0.0,0.0,0,str); SysFreeString(str); str = SysAllocString(OLESTR(" $ds;$ ")); document2D-&gt;ksText(100.0,60.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 下图显示了该程序的结果。 <br><br><img src="https://habrastorage.org/webt/z2/2_/dj/z22_djahn5b1uiugptca_0doqui.png"><br><br> 尽管在此示例中，字母<i>s</i> ， <i>m</i>和<i>l</i>用于分数，但它们用于偏差的用法没有什么不同。 <br><br> 请注意，如果在分数或偏差的开头（ <i>$</i> ， <i>$ d</i>或<i>$ b</i> ）与字母<i>s</i> ， <i>m</i>或<i>l</i>之间，至少有一个“外部”字符（例如空格），则COMPAS将不会“看到”字母，并且分数或偏差将是默认大小。 <br><br><h2>  <font color="#00B2FF">嵌套控制字符</font> </h2><br> 输出分数和偏差时，将对其组成中包含的线进行递归处理。 这意味着在形成分子和分母时，也可以使用控制字符。 下面的示例演示了这种方法。 <br><br><pre> <code class="plaintext hljs">BSTR str = SysAllocString(OLESTR("@54~$s2$ + $d@+51~;@+52~$ - ^(Symbol)*70~")); document2D-&gt;ksText(100.0,100.0,0.0,0.0,0.0,0,str); SysFreeString(str);</code> </pre><br> 下图显示了该程序的结果。 <br><br><img src="https://habrastorage.org/webt/qq/f_/9a/qqf_9au_d7ijxvxhvopiuzlhpbk.png"><br><br> 要插入希腊字母，我们使用控制字符@和^（用于字母pi）。 第一项的度是使用偏差得出的。 子字符串<i>$ s2 $</i>显示它。 字母<i>s</i>表示偏差很小，但是由于没有分隔符“ <i>；</i>  »仅显示上偏差。 <br><br> 为了形成分数，使用了组合<i>$ d; $</i> 。 此外，分子和分母包括控制字符，这些控制字符提供希腊字母的输出。 <br><br> 使用控制字符<i>^</i>和<i>〜</i>将最后减去的（πpi）显示为Symbol字体的符号。 <br><br> 不幸的是，这种“递归”的可能性非常有限。 我们不能将分数和偏差相互投资。 问题在于它们两者都是使用<i>$</i>控制字符形成的。 因此，COMPASS无法正确解析哪个<i>$</i>属于哪个元素。 <br><br><h2>  <font color="#00B2FF">段落中的控制字符</font> </h2><br> 您可以使用段落使用嵌套的控制字符部分地绕过限制。 一起使用控制字符和段落可以使您构建更复杂的结构。 下面的示例演示了4级分数的构造。 <br><br><div class="spoiler">  <b class="spoiler_title">用于构建4级分数的程序代码</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">//   DynamicArrayPtr dynamicArray; dynamicArray = static_cast&lt;DynamicArrayPtr&gt;(kompas-&gt;GetDynamicArray(TEXT_ITEM_ARR)); dynamicArray-&gt;ksClearArray(); TextItemParamPtr textItemParam; textItemParam = static_cast&lt;TextItemParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextItemParam)); //     BSTR str = SysAllocString(OLESTR("  ")); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //     TextItemFontPtr textItemFont; textItemFont = static_cast&lt;TextItemFontPtr&gt;(textItemParam-&gt;GetItemFont()); textItemFont-&gt;set_bitVector(NUMERATOR); str = SysAllocString(OLESTR("1 + $d@+51~;2$")); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //    textItemFont-&gt;set_bitVector(DENOMINATOR); str = SysAllocString(OLESTR("1 + $d@+56~;2$")); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //  textItemFont-&gt;set_bitVector(END_FRACTION); str = SysAllocString(OLESTR("  ")); textItemParam-&gt;set_s(str); dynamicArray-&gt;ksAddArrayItem(-1, textItemParam); SysFreeString(str); //   textItemFont.Unbind(); textItemParam.Unbind(); //    ksTextLineParam TextLineParamPtr textLineParam; textLineParam = static_cast&lt;TextLineParamPtr&gt;(kompas-&gt;GetParamStruct(ko_TextLineParam)); textLineParam-&gt;Init(); textLineParam-&gt;SetTextItemArr(dynamicArray); dynamicArray.Unbind(); //  ParagraphParamPtr paragraphParam; paragraphParam=static_cast&lt;ParagraphParamPtr&gt;(kompas-&gt;GetParamStruct(ko_ParagraphParam)); paragraphParam-&gt;Init(); paragraphParam-&gt;set_x(100.0); paragraphParam-&gt;set_y(100.0); document2D-&gt;ksParagraph(paragraphParam); document2D-&gt;ksTextLine(textLineParam); document2D-&gt;ksEndObj(); //   textLineParam.Unbind(); paragraphParam.Unbind();</code> </pre><br></div></div><br> 在此示例中，控制字符用于构造主分数的分子和分母中的分数，以及插入希腊字母。 下图显示了该程序的结果。 <br><br><img src="https://habrastorage.org/webt/ji/x6/lo/jix6loqqynqpondf3g47pvhopj0.png"><br><br><h2> 结论 </h2><br> 在本课程中，我们遇到了控制字符，并学习了如何使用它们来显示特殊字符和字体字符。 如您所见，它们为创建包含特殊字符，分数和偏差的字符串提供了一种简单的语法。 不幸的是，它们不适合插入包含字符串的特殊字符。 但是这种特殊字符极为罕见。 这是控制字符的局限之一。 此外，它们不能用于创建子字符串和子字符串，并且在处理包含字符串的特殊字符时存在一些限制。 但这并没有减损他们的优点。 至此，我们对控制字符的讨论结束了。 <br><br>  <b>要继续，请关注博客新闻。</b> <br><br> <a href=""><img src="https://habrastorage.org/web/595/eee/f27/595eeef271b24830b3578751fcb52716.png"></a>  Sergey Norseev博士，《在Delphi中进行COMPAS的应用程序开发》一书的作者。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN457702/">https://habr.com/ru/post/zh-CN457702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN457692/index.html">关于国家NB-Fi标准和计费系统的思考</a></li>
<li><a href="../zh-CN457694/index.html">使用多字符常量的危险</a></li>
<li><a href="../zh-CN457696/index.html">使用多字符常量的危险</a></li>
<li><a href="../zh-CN457698/index.html">实验：我们使用代理作为抵御DoS攻击的工具</a></li>
<li><a href="../zh-CN457700/index.html">Node.js身份验证指南，不包含password.js和第三方服务</a></li>
<li><a href="../zh-CN457704/index.html">GPU如何处理分支</a></li>
<li><a href="../zh-CN457706/index.html">机器人测试SAP ERP</a></li>
<li><a href="../zh-CN457710/index.html">神经网络的惊人功能2019</a></li>
<li><a href="../zh-CN457712/index.html">Verizon和BGP Optimizer如何离线设置</a></li>
<li><a href="../zh-CN457714/index.html">英语中的堆栈溢出：社区终止指南</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>