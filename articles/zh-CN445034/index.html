<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍃 🕴🏼 🐕 LockerGoga：Norsk Hydro到底发生了什么 😚 🚴🏿 ♐️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="图片来源-www.msspalert.com 


 在星期一晚上至星期二晚上（UTC 03/18/2019大约23:00）， Norsk Hydro专家注意到网络和许多系统出现故障。 很快就可以看出，故障是由加密器对系统的大量感染造成的，该加密器在基础设施中迅速传播。 在确定威胁之后，安全服务开始...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>LockerGoga：Norsk Hydro到底发生了什么</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/445034/"><p><img src="https://habrastorage.org/webt/av/ct/qp/avctqp5o4hco2o_xndkw0drfgpu.jpeg"><br><br>  <em>图片来源<a href="">-www.msspalert.com</a></em> </p><br><p> 在星期一晚上至星期二晚上（UTC 03/18/2019大约23:00）， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Norsk Hydro</a>专家注意到网络和许多系统出现故障。 很快就可以看出，故障是由加密器对系统的大量感染造成的，该加密器在基础设施中迅速传播。 在确定威胁之后，安全服务开始了隔离过程，但是，恶意软件设法在基础架构上广泛传播，以至于有必要将部分生产转移到手动控制模式（“回滚”到生产过程计算机化之前采用的过程）。 要对攻击进行调查，需要地方当局和执法机构（国家安全局/ NorCERT，挪威警察安全局，国家刑事调查局）以及一些商业公司的参与。 基础设施的重建尚未完成，单个生产设施（例如，挤压铝型材）仍处于一半产能。 </p><br><p> 尽管对事件的调查尚未完成，并且仍然难以预测其完成的时间，但根据现有事实，您可以了解攻击者的行动机制并分析Norsk Hydro正确和不正确的方法以及可以如何改进防御措施。 </p><a name="habracut"></a><br><h2 id="sostoyanie-kompanii-posle-ataki"> 攻击后公司的状态 </h2><br><p>  Norsk Hydro是一家相当大的公司：其设施位于40个国家/地区，员工总数超过35,000人。 受攻击影响的信息系统和计算机的数量也很大。 根据公司代表在与当局举行的联合<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">新闻发布会</a>上发表的信息以及有关网站上调查和恢复进展的每日新闻（更新日期为03/22/2019），得出以下结论： </p><br><ul><li> 没有发生当地的工业事故和人身伤害； </li><li> 结果，所有工厂都被成功隔离，并且在可能的情况下将过程转移到手动控制（在铝型材挤压工厂中，效率仅达到50％）； </li><li> 移动设备和某些PC正常运行，云邮件正常运行； </li><li> 无法完全了解发生故障的PC和服务器的数量，对基础设施的损害程度也不同； </li><li> 无法访问包含订单数据的系统，但是必须有一定数量的信息才能生成订单； </li><li> 没有关于攻击者的假设；关于用于攻击的恶意软件的最可能假说是LockerGoga勒索软件； </li><li> 该公司拥有完善的备份流程，回滚到以前制作的备份是主要的恢复策略； </li><li> 该公司拥有网络风险保险，他们计划将其用于弥补攻击造成的损失。 </li></ul><br><p> 重要的是要注意Norsk Hydro在攻击过程中的表现。 该公司采取了尽可能公开的行动：在主站点出现问题时，它启动了一个临时站点，通过Facebook帐户通知了公众，将其情况通知了证券市场，并在攻击的第一天举行了新闻发布会。 </p><br><p><img src="https://habrastorage.org/webt/5u/87/hf/5u87hftny53by1ywyav3bzxjcw8.jpeg"><br><br>  <em>警告Norsk Hydro员工，由于网络攻击，您不应将任何设备连接到网络。</em>  <em>图片来源<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-www.reuters.com</a></em> </p><br><h2 id="chto-predstavlyaet-soboy-vredonos-lockergoga"> 什么是LockerGoga恶意软件？ </h2><br><p> 公众第一次在2019年1月底开始意识到使用LockerGoga进行的攻击，Atran咨询公司遭受了这次攻击，但是攻击的技术细节很少。  Norsk Hydro受到了几种版本的恶意软件的攻击，根据其行为方式，它们与一月份攻击中使用的示例相似（除了个别的“功能”）。 </p><br><p> 恶意可执行文件使用Sectigo（以前称为Comodo CA）签发的证书与用于Altran攻击的示例相同的证书签名（可能是空壳公司<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ALISA LTD，</a>具有2个所有者和2股，每股价格1英镑）。 目前，该证书已被吊销，但是在攻击过程中它是有效的。 </p><br><p> 显然，每个恶意软件样本都是为受攻击的公司唯一生成的， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">研究人员</a>在样本分析中注意到了这一点。 </p><br><p> 所有识别出的样本均不具备自我复制的能力（与WannaCry和NotPetya不同），必须在受攻击的节点上运行。 恶意软件在Norsk Hydro网络上传播的最可能假说是使用AD组策略来创建带有恶意内容的任务或服务。 这很有可能意味着在渗透阶段使用了另一种恶意软件，借助该恶意软件，可以在域中获得管理特权。 一种可能的机制可能是网络钓鱼，然后是从受感染节点的内存中盗窃Kerberos密码或票证。 </p><br><p>在感染过程中，恶意可执行文件被复制到<code>%TEMP%</code>目录并以提升的特权启动。 此后，它将启动大量子进程，并根据组合列表向其分配文件加密。 从可用样本的行为来看，不仅带有Office文档，数据库和其他工作文件扩展名的文件（ <code>doc, dot, wbk, docx, dotx, docb, xlm, xlsx, xltx, xlsb, xlw, ppt, pot, pps, pptx, potx, ppsx, sldx, pdf</code> ），还有C：\驱动器上的其他文件（例如dll库），具体取决于示例。 子进程使用RNG <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">生成</a>一个密钥/ iv对，然后使用AES算法用加密的数据覆盖该文件，使用公共密钥对密钥/ iv对进行加密，将加密的密钥对添加到该文件，然后重命名该文件，并将<code>.LOCKED</code>添加到扩展名。 此行为使您可以更多地利用受感染计算机的处理器执行加密任务，并使整个过程更快。 </p><br><p> 父进程还会在桌面上创建一个带有赎金请求的文本文件（名称有所不同的README_LOCKED.txt），更改本地用户的密码（此行为可能取决于示例的版本，即只能对本地管理员的密码进行加密）并提交强制退出用户会话。 在某些版本中，显示了禁用计算机网络接口的功能。 </p><br><p> 因此，在某些情况下，受感染的PC可能根本无法启动（如果OS内核的关键组件已加密），或者用户将无法登录以查看赎金要求，这​​对于毒蛇更常见。 </p><br><p> 赎金请求（下面给出一个示例）不包含钱包地址或赎金金额，而仅包含用于与入侵者进行交互的邮政地址。 不同版本的恶意样本在请求中具有不同的电子邮件地址。 </p><br><pre> <code class="plaintext hljs">Greetings! There was a significant flaw in the security system of your company. You should be thankful that the flaw was exploited by serious people and not some rookies. They would have damaged all of your data by mistake or for fun. Your files are encrypted with the strongest military algorithms RSA4096 and AES-256. Without our special decoder it is impossible to restore the data. Attempts to restore your data with third party software as Photorec, RannohDecryptor etc. will lead to irreversible destruction of your data. To confirm our honest intentions. Send us 2-3 different random files and you will get them decrypted. It can be from different computers on your network to be sure that our decoder decrypts everything. Sample files we unlock for free (files should not be related to any kind of backups). We exclusively have decryption software for your situation DO NOT RESET OR SHUTDOWN – files may be damaged. DO NOT RENAME the encrypted files. DO NOT MOVE the encrypted files. This may lead to the impossibility of recovery of the certain files. To get information on the price of the decoder contact us at: AbbsChevis@protonmail.com IjuqodiSunovib98@o2.pl The payment has to be made in Bitcoins. The final price depends on how fast you contact us. As soon as we receive the payment you will get the decryption tool and instructions on how to improve your systems security</code> </pre> <br><p> 该恶意软件不使用任何C＆C基础架构，与攻击者的唯一通信渠道是电子邮件。 此外，该恶意软件不会尝试隐藏其活动的痕迹。 结合勒索机制的类似实现以及加密PC的实际失效，可以假定LockerGoga的目标类似于WannaCry和NotPetya恶意软件。 但是，无论是否正确，目前尚不能说。 </p><br><h2 id="chto-bylo-sdelano-pravilno-a-chto-net"> 做对了什么没做对 </h2><br><p> 在披露有关引人注目的网络攻击的信息之后，您通常会看到文章和各种材料，它们说明了攻击的受害者做错了什么。 对于Norsk Hydro，情况则有所不同；该公司未在基础架构组织中显示出明显的故障（生产没有停止），并且很好地对攻击进行了响应，即： </p><br><ul><li> 该公司对投资者和公众尽可能开放，以告知消除攻击的进展。 积极反应的间接指标可能是证券交易所的股价：尽管股价在23.03时小幅下跌（3.6％），但仍需要进一步稳定增长的前提。 </li><li> 可以足够快地隔离生产设施，从而不会影响其生产。 </li><li> 有完善的过程可以使生产设备以手动控制模式运行（至少对于大多数生产而言）。 </li><li> 已经建立了备份过程，这将极大地促进事件发生后基础结构节点的恢复。 </li><li> 有备用通信渠道（云邮件），即使主要基础结构出现问题，员工也可以进行交互。 </li><li> 该公司使用网络风险保险，这将有助于补偿攻击造成的部分损失。 </li></ul><br><p> 同时，Norsk Hydro过分依赖安装在其中的防病毒解决方案。 根据研究人员的说法，3月初， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">任何</a>防病毒解决方案都未检测到一些恶意软件样本，在攻击开始之时，确定样本为恶意的解决方案的数量也很少。 此外，认证中心在攻击开始后为时已晚，吊销了恶意证书。 另外，对于某些设施，从办公室对工业基础设施的分割可能执行不充分。 </p><br><p> 在早期发现攻击将有助于持续监控： </p><br><ul><li> 特权帐户活动； </li><li> 组策略更改 </li><li> 创建调度程序的新服务和任务； </li><li> 特权帐户的密码更改事件，包括 和本地管理员； </li><li> 与“哈希传递”和“票证传递”攻击类似的活动； </li></ul><br><p> 这种控制应由内部监视服务（使用类似于SIEM的解决方案和行为分析系统）和/或外部SOC / CSIRT进行。 </p><br><p> 确实，及早发现将有助于节省大量资金，消除攻击的后果。 </p><br><h1 id="upd-26032019"> 更新。  2019/03/26 </h1><br><p>  Alert Logic的研究人员<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">发现了</a>恶意软件中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的</a>错误。 当收集用于加密的文件列表时，恶意软件偶然发现包含错误（根据研究表明网络路径不正确或与RPC端点没有关联）的链接（* .lnk）时，攻击者没有提供异常处理。 从“最近的项目”文件夹中收集文件时，可能会发生这种情况。 在这种情况下，主进程由操作系统终止，甚至无法进行加密。 也许这可以部分解释公司节点受损程度不均的原因。 </p><br><h1 id="ssylki"> 参考文献 </h1><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.bleepingcomputer.com/news/security/new-lockergoga-ransomware-allegedly-used-in-altran-attack/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.nrk.no/norge/skreddersydd-dobbeltangrep-mot-hydro-1.14480202</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://webtv.hegnar.no/presentation.php?webcastId=97819442</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.hydro.com/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://twitter.com/GossiTheDog/status/1107986706089811968</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://twitter.com/malwrhunterteam/status/1104082562216062978</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://twitter.com/_qaz_qaz/status/1108441356836503553</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.bleepingcomputer.com/news/security/lockergoga-ransomware-sends-norsk-hydro-into-manual-mode/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.bloomberg.com/news/articles/2019-03-19/hydro-says-victim-of-extensive-cyber-attack-impacting-operations-jtfgz6td</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://blog.talosintelligence.com/2019/03/lockergoga.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.nozominetworks.com/blog/breaking-research-lockergoga-ransomware-impacts-norsk-hydro/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.joesecurity.org/blog/2995389471535835488</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://doublepulsar.com/how-lockergoga-took-down-hydro-ransomware-used-in-targeted-attacks-aimed-at-big-business-c666551f5880</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://securityaffairs.co/wordpress/82684/malware/lockergoga-ransomware-spreads.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://www.bbc.com/news/technology-47624207</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://uk.globaldatabase.com/company/alisa-ltd</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://blog.alertlogic.com/halting-the-lockergoga-ransomware/</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN445034/">https://habr.com/ru/post/zh-CN445034/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN445022/index.html">我如何结识PlayStation 2和PlayStation Portable（扰流器-合并为一个模拟器）的朋友</a></li>
<li><a href="../zh-CN445024/index.html">将DSLogic Basic转变为DSLogic Plus</a></li>
<li><a href="../zh-CN445026/index.html">原子到分子的连接模型</a></li>
<li><a href="../zh-CN445028/index.html">智能听诊器-ITMO大学加速器的启动项目</a></li>
<li><a href="../zh-CN445030/index.html">您可能不需要Kubernetes</a></li>
<li><a href="../zh-CN445036/index.html">什么是第一部iPhone？</a></li>
<li><a href="../zh-CN445038/index.html">在GitHub上100,000个存储库中发现的分类信息泄漏</a></li>
<li><a href="../zh-CN445040/index.html">我们建立模型，“出售”知识管理以进行管理，并纠正幸存者的错误</a></li>
<li><a href="../zh-CN445042/index.html">Ulan-Ude程序员的Delphic成功故事</a></li>
<li><a href="../zh-CN445044/index.html">在生产系统中进行应用。 验证者</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>