<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëâüèø üë≥ üëèüèº Redes neurais e aprendizado profundo, cap√≠tulo 3, parte 3: como escolher hiperpar√¢metros de redes neurais? ü§¥üèΩ üë®‚Äçüëß‚Äçüë¶ üë®üèª‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Conte√∫do 

- Cap√≠tulo 1: usando redes neurais para reconhecer n√∫meros manuscritos 
- Cap√≠tulo 2: como o algoritmo de retropropaga√ß√£o funciona 
- Cap√≠t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Redes neurais e aprendizado profundo, cap√≠tulo 3, parte 3: como escolher hiperpar√¢metros de redes neurais?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460711/"><div class="spoiler">  <b class="spoiler_title">Conte√∫do</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap√≠tulo 1: usando redes neurais para reconhecer n√∫meros manuscritos</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap√≠tulo 2: como o algoritmo de retropropaga√ß√£o funciona</a> </li><li>  Cap√≠tulo 3: <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1: aprimorando o m√©todo de treinamento de redes neurais</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2: Por que a regulariza√ß√£o ajuda a reduzir a reciclagem?</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 3: como escolher hiperpar√¢metros de redes neurais?</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap√≠tulo 4: prova visual de que as redes neurais s√£o capazes de computar qualquer fun√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Cap√≠tulo 5: por que as redes neurais profundas s√£o t√£o dif√≠ceis de treinar?</a> </li><li>  Cap√≠tulo 6: <ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1: Aprendizado Profundo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2: progresso recente no reconhecimento de imagens</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Posf√°cio: existe um algoritmo simples para criar intelig√™ncia?</a> </li></ul></div></div><br>  At√© agora, n√£o expliquei como escolho os valores dos hiperpar√¢metros - a taxa de aprendizado Œ∑, o par√¢metro de regulariza√ß√£o Œª e assim por diante.  Eu apenas dei bons valores de trabalho.  Na pr√°tica, quando voc√™ usa uma rede neural para atacar um problema, pode ser dif√≠cil encontrar bons hiperpar√¢metros.  Imagine, por exemplo, que acabamos de nos informar sobre o problema do MNIST, e come√ßamos a trabalhar nele, sem saber nada sobre os valores de hiperpar√¢metros adequados.  Suponhamos que tivemos sorte por acaso, e nos primeiros experimentos, escolhemos muitos hiperpar√¢metros, como j√° fizemos neste cap√≠tulo: 30 neur√¥nios ocultos, um tamanho de minipacote de 10, treinamento para 30 √©pocas e o uso de entropia cruzada.  No entanto, escolhemos a taxa de aprendizado Œ∑ = 10,0 e o par√¢metro de regulariza√ß√£o Œª = 1000,0.  E aqui est√° o que eu vi com essa corrida: <br><a name="habracut"></a><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> mnist_loader &gt;&gt;&gt; training_data, validation_data, test_data = \ ... mnist_loader.load_data_wrapper() &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> network2 &gt;&gt;&gt; net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]) &gt;&gt;&gt; net.SGD(training_data, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10.0</span></span>, lmbda = <span class="hljs-number"><span class="hljs-number">1000.0</span></span>, ... evaluation_data=validation_data, monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) Epoch <span class="hljs-number"><span class="hljs-number">0</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">1030</span></span> / <span class="hljs-number"><span class="hljs-number">10000</span></span> Epoch <span class="hljs-number"><span class="hljs-number">1</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">990</span></span> / <span class="hljs-number"><span class="hljs-number">10000</span></span> Epoch <span class="hljs-number"><span class="hljs-number">2</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">1009</span></span> / <span class="hljs-number"><span class="hljs-number">10000</span></span> ... Epoch <span class="hljs-number"><span class="hljs-number">27</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">1009</span></span> / <span class="hljs-number"><span class="hljs-number">10000</span></span> Epoch <span class="hljs-number"><span class="hljs-number">28</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">983</span></span> / <span class="hljs-number"><span class="hljs-number">10000</span></span> Epoch <span class="hljs-number"><span class="hljs-number">29</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">967</span></span> / <span class="hljs-number"><span class="hljs-number">10000</span></span></code> </pre> <br>  Nossa classifica√ß√£o n√£o funciona melhor que a amostragem aleat√≥ria!  Nossa rede funciona como um gerador de ru√≠do aleat√≥rio! <br><br>  "Bem, isso √© f√°cil de consertar", voc√™ poderia dizer, "basta reduzir os hiperpar√¢metros, como velocidade de aprendizado e regulariza√ß√£o".  Infelizmente, a priori, voc√™ n√£o tem informa√ß√µes sobre o que exatamente esses hiperpar√¢metros voc√™ precisa ajustar.  Talvez o principal problema seja que nossos 30 neur√¥nios ocultos nunca funcionem, independentemente de como os outros hiperpar√¢metros sejam selecionados?  Talvez precisemos de pelo menos 100 neur√¥nios ocultos?  Ou 300?  Ou muitas camadas ocultas?  Ou uma abordagem diferente para codifica√ß√£o de sa√≠da?  Talvez nossa rede esteja aprendendo, mas precisamos trein√°-la mais √©pocas?  Talvez o tamanho dos mini pacotes seja muito pequeno?  Talvez tiv√©ssemos feito melhor se retorn√°ssemos √† fun√ß√£o quadr√°tica do valor?  Talvez precisemos tentar uma abordagem diferente para inicializar pesos?  E assim por diante e assim por diante.  No espa√ßo dos hiperpar√¢metros, √© f√°cil se perder.  E isso pode trazer muitos inconvenientes se a sua rede for muito grande ou usar grandes quantidades de dados de treinamento, e voc√™ poder√° trein√°-lo por horas, dias ou semanas sem receber resultados.  Em tal situa√ß√£o, sua confian√ßa come√ßa a passar.  Talvez as redes neurais tenham sido a abordagem errada para resolver seu problema?  Talvez voc√™ pare e fa√ßa apicultura? <br><br>  Nesta se√ß√£o, explicarei algumas abordagens heur√≠sticas que voc√™ pode usar para configurar hiperpar√¢metros em uma rede neural.  O objetivo √© ajud√°-lo a elaborar um fluxo de trabalho que permita configurar muito bem os hiperpar√¢metros.  Obviamente, n√£o posso cobrir todo o t√≥pico da otimiza√ß√£o do hiperpar√¢metro.  Essa √© uma √°rea enorme e n√£o √© um problema que possa ser resolvido completamente, ou existe um acordo geral sobre as estrat√©gias corretas para resolv√™-lo.  Sempre h√° a oportunidade de tentar outro truque para extrair resultados extras da sua rede neural.  Mas as heur√≠sticas nesta se√ß√£o devem fornecer um ponto de partida. <br><br><h3>  Estrat√©gia geral </h3><br>  Ao usar uma rede neural para atacar um novo problema, a primeira dificuldade √© obter resultados n√£o triviais da rede, ou seja, excedendo uma probabilidade aleat√≥ria.  Isso pode ser surpreendentemente dif√≠cil, especialmente quando voc√™ se depara com uma nova classe de tarefas.  Vejamos algumas estrat√©gias que podem ser usadas para esse tipo de dificuldade. <br><br>  Suponha, por exemplo, que voc√™ seja o primeiro a atacar a tarefa MNIST.  Voc√™ come√ßa com grande entusiasmo, mas a falha completa da sua primeira rede √© um pouco desanimadora, conforme descrito no exemplo acima.  Ent√£o voc√™ precisa desmontar o problema em partes.  Voc√™ precisa se livrar de todo o treinamento e imagens de suporte, exceto imagens de zeros e uns.  Em seguida, tente treinar a rede para distinguir 0 de 1. Essa tarefa n√£o √© apenas essencialmente mais f√°cil do que distinguir todos os dez d√≠gitos, mas tamb√©m reduz a quantidade de dados de treinamento em 80%, acelerando o aprendizado em 5 vezes.  Isso permite realizar experimentos muito mais rapidamente e oferece a oportunidade de entender rapidamente como criar uma boa rede. <br><br>  As experi√™ncias podem ser aceleradas ainda mais, reduzindo a rede a um tamanho m√≠nimo que provavelmente ser√° treinado de maneira significativa.  Se voc√™ acha que √© prov√°vel que a rede [784, 10] seja capaz de classificar os d√≠gitos do MNIST melhor que uma amostra aleat√≥ria, comece a experimentar.  Vai ser muito mais r√°pido que o treinamento [784, 30, 10], e voc√™ j√° pode fazer isso mais tarde. <br><br>  Outra acelera√ß√£o dos experimentos pode ser obtida aumentando a frequ√™ncia do rastreamento.  No programa network2.py, monitoramos a qualidade do trabalho no final de cada √©poca.  Ao processar 50.000 imagens por √©poca, precisamos esperar um tempo bastante longo - cerca de 10 segundos por √©poca no meu laptop durante o treinamento em rede [784, 30, 10] - antes de obter feedback sobre a qualidade do treinamento em rede.  √â claro que dez segundos n√£o s√£o t√£o longos, mas se voc√™ quiser experimentar v√°rias dezenas de hiperpar√¢metros diferentes, isso come√ßar√° a incomodar e, se voc√™ quiser experimentar centenas ou milhares de op√ß√µes, isso ser√° devastador.  O feedback pode ser recebido muito mais rapidamente, rastreando a precis√£o da confirma√ß√£o com mais frequ√™ncia, por exemplo, a cada 1.000 imagens de treinamento.  Al√©m disso, em vez de usar o conjunto completo de 10.000 imagens de confirma√ß√£o, podemos obter uma estimativa muito mais r√°pida usando apenas 100 imagens de confirma√ß√£o.  O principal √© que a rede v√™ imagens suficientes para realmente aprender e obter uma estimativa suficientemente boa da efic√°cia.  Obviamente, nosso network2.py ainda n√£o fornece esse rastreamento.  Por√©m, como muletas para alcan√ßar esse efeito com fins ilustrativos, recortamos nossos dados de treinamento para as primeiras 1000 imagens MNIST.  Vamos tentar ver o que acontece (para simplificar o c√≥digo, n√£o usei a ideia de deixar apenas as imagens 0 e 1 - isso tamb√©m pode ser realizado com um pouco mais de esfor√ßo). <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]) &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10.0</span></span>, lmbda = <span class="hljs-number"><span class="hljs-number">1000.0</span></span>, \ ... evaluation_data=validation_data[:<span class="hljs-number"><span class="hljs-number">100</span></span>], \ ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) Epoch <span class="hljs-number"><span class="hljs-number">0</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">10</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">1</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">10</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">2</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">10</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> ...</code> </pre> <br>  Ainda temos ru√≠do puro, mas temos uma grande vantagem: o feedback √© atualizado em fra√ß√µes de segundo e n√£o a cada dez segundos.  Isso significa que voc√™ pode experimentar muito mais rapidamente com a sele√ß√£o de hiperpar√¢metros, ou mesmo experimentar com muitos hiperpar√¢metros diferentes quase simultaneamente. <br><br>  No exemplo acima, deixei o valor de Œª igual a 1000,0, como antes.  Por√©m, como alteramos o n√∫mero de exemplos de treinamento, precisamos alterar Œª para que o enfraquecimento dos pesos seja o mesmo.  Isso significa que mudamos Œª em 20,0.  Nesse caso, obtemos o seguinte: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]) &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10.0</span></span>, lmbda = <span class="hljs-number"><span class="hljs-number">20.0</span></span>, \ ... evaluation_data=validation_data[:<span class="hljs-number"><span class="hljs-number">100</span></span>], \ ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) Epoch <span class="hljs-number"><span class="hljs-number">0</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">12</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">1</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">14</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">2</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">25</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">3</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">18</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> ...</code> </pre> <br>  Sim!  N√≥s temos um sinal.  N√£o √© particularmente bom, mas existe.  Isso j√° pode ser tomado como ponto de partida e altere os hiperpar√¢metros para tentar obter mais melhorias.  Suponha que decidimos que precisamos aumentar a velocidade do aprendizado (como voc√™ provavelmente entendeu, decidimos incorretamente, pelo motivo que discutiremos mais adiante, mas vamos tentar fazer isso por enquanto).  Para testar nosso palpite, giramos Œ∑ para 100,0: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]) &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">100.0</span></span>, lmbda = <span class="hljs-number"><span class="hljs-number">20.0</span></span>, \ ... evaluation_data=validation_data[:<span class="hljs-number"><span class="hljs-number">100</span></span>], \ ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) Epoch <span class="hljs-number"><span class="hljs-number">0</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">10</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">1</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">10</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">2</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">10</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">3</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">10</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> ...</code> </pre> <br>  Tudo est√° ruim!  Aparentemente, nosso palpite estava incorreto e o problema n√£o estava no valor muito baixo da velocidade de aprendizado.  Tentamos apertar Œ∑ para um pequeno valor de 1,0: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>net = network2.Network([<span class="hljs-number"><span class="hljs-number">784</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>]) &gt;&gt;&gt; net.SGD(training_data[:<span class="hljs-number"><span class="hljs-number">1000</span></span>], <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">1.0</span></span>, lmbda = <span class="hljs-number"><span class="hljs-number">20.0</span></span>, \ ... evaluation_data=validation_data[:<span class="hljs-number"><span class="hljs-number">100</span></span>], \ ... monitor_evaluation_accuracy=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) Epoch <span class="hljs-number"><span class="hljs-number">0</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">62</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">1</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">42</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">2</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">43</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> Epoch <span class="hljs-number"><span class="hljs-number">3</span></span> training complete Accuracy on evaluation data: <span class="hljs-number"><span class="hljs-number">61</span></span> / <span class="hljs-number"><span class="hljs-number">100</span></span> ...</code> </pre> <br>  Isso √© melhor!  E assim podemos continuar, torcendo cada hiperpar√¢metro e melhorando gradualmente a efici√™ncia.  Tendo estudado a situa√ß√£o e encontrado um valor aprimorado para Œ∑, prosseguimos na busca de um bom valor para Œª.  Em seguida, realizaremos um experimento com uma arquitetura mais complexa, por exemplo, com uma rede de 10 neur√¥nios ocultos.  Ent√£o, novamente ajustamos os par√¢metros para Œ∑ e Œª.  Ent√£o aumentaremos a rede para 20 neur√¥nios ocultos.  Um pouco de ajuste nos hiperpar√¢metros.  E assim por diante, avaliando a efic√°cia em cada etapa usando parte de nossos dados de suporte e usando essas estimativas para selecionar todos os melhores hiperpar√¢metros.  No processo de aprimoramentos, leva cada vez mais tempo para ver o efeito do ajuste de hiperpar√¢metros, para que possamos reduzir gradualmente a frequ√™ncia de rastreamento. <br><br>  Como estrat√©gia geral, essa abordagem parece promissora.  No entanto, quero voltar ao primeiro passo na busca de hiperpar√¢metros que permitam √† rede aprender pelo menos de alguma forma.  De fato, mesmo no exemplo acima, a situa√ß√£o era otimista demais.  Trabalhar com uma rede que n√£o aprende nada pode ser extremamente irritante.  Voc√™ pode ajustar os hiperpar√¢metros por v√°rios dias e n√£o receber respostas significativas.  Portanto, gostaria de enfatizar mais uma vez que, nos est√°gios iniciais, √© necess√°rio garantir um feedback r√°pido das experi√™ncias.  Intuitivamente, pode parecer que simplificar o problema e a arquitetura apenas o atrasar√°.  De fato, isso acelera o processo, porque voc√™ pode encontrar uma rede com um sinal significativo muito mais r√°pido.  Depois de receber esse sinal, voc√™ poder√° obter rapidamente melhorias ao ajustar os hiperpar√¢metros.  Como em muitas situa√ß√µes da vida, o mais dif√≠cil √© iniciar o processo. <br><br>  Ok, esta √© uma estrat√©gia geral.  Agora, vamos dar uma olhada nas recomenda√ß√µes espec√≠ficas para prescrever hiperpar√¢metros.  Vou me concentrar na velocidade de aprendizado Œ∑, no par√¢metro de regulariza√ß√£o L2 Œª e no tamanho do minipacote.  No entanto, muitos coment√°rios ser√£o aplic√°veis ‚Äã‚Äãa outros hiperpar√¢metros, incluindo aqueles relacionados √† arquitetura de rede, outras formas de regulariza√ß√£o e alguns hiperpar√¢metros, que aprenderemos mais adiante no livro, por exemplo, o coeficiente de momento. <br><br><h3>  Velocidade de aprendizagem </h3><br>  Suponha que tenhamos lan√ßado tr√™s redes MNIST com tr√™s velocidades de aprendizado diferentes, Œ∑ = 0,025, Œ∑ = 0,25 e Œ∑ = 2,5, respectivamente.  Deixamos os hiperpar√¢metros restantes como estavam nas se√ß√µes anteriores - 30 eras, o tamanho do minipacote √© 10, Œª = 5,0.  Tamb√©m voltaremos a usar todas as 50.000 imagens de treinamento.  Aqui est√° um gr√°fico mostrando o comportamento do custo do treinamento (criado pelo programa multiple_eta.py): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ec/dc3/761/1ecdc37614b9207a1f03ce2aad97e61d.png"><br><br>  Em Œ∑ = 0,025, o custo diminui suavemente at√© a √∫ltima era.  Com Œ∑ = 0,25, o custo inicialmente diminui, mas ap√≥s 20 √©pocas ele fica saturado, de modo que a maioria das mudan√ßas acaba sendo pequena e, obviamente, flutua√ß√µes aleat√≥rias.  Com Œ∑ = 2,5, o custo varia muito desde o in√≠cio.  Para entender o motivo dessas flutua√ß√µes, lembramos que a descida do gradiente estoc√°stico deve gradualmente nos levar ao vale da fun√ß√£o de custo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/37e/5f9/af1/37e5f9af1985610568cba31157e35763.png"><br><br>  Essa imagem ajuda a imaginar intuitivamente o que est√° acontecendo, mas n√£o √© uma explica√ß√£o completa e abrangente.  Mais precisamente, mas brevemente, a descida do gradiente usa uma aproxima√ß√£o de primeira ordem para a fun√ß√£o de custo para entender como reduzir o custo.  Para Œ∑ maior, os membros de uma fun√ß√£o de custo de ordem mais alta se tornam mais importantes e podem dominar o comportamento interrompendo a descida do gradiente.  Isso √© especialmente prov√°vel quando se aproxima os m√≠nimos e m√≠nimos locais da fun√ß√£o de custo, j√° que pr√≥ximo a esses pontos o gradiente se torna pequeno, o que facilita o dom√≠nio de membros de uma ordem superior. <br><br>  No entanto, se Œ∑ for muito grande, as etapas ser√£o t√£o grandes que poder√£o saltar um m√≠nimo, devido ao qual o algoritmo subir√° do vale.  Provavelmente √© isso que faz o pre√ßo oscilar em Œ∑ = 2,5.  A escolha de Œ∑ = 0,25 leva ao fato de que as etapas iniciais realmente nos levam a um m√≠nimo da fun√ß√£o de custo, e somente quando chegamos a ela come√ßamos a ter dificuldades com o salto.  E quando escolhemos Œ∑ = 0,025, n√£o temos essas dificuldades durante as primeiras 30 √©pocas.  Obviamente, a escolha de um valor t√£o pequeno de Œ∑ cria outra dificuldade - ou seja, diminui a descida do gradiente estoc√°stico.  A melhor abordagem seria come√ßar com Œ∑ = 0,25, aprender 20 eras e depois ir para Œ∑ = 0,025.  Mais tarde, discutiremos essa taxa de aprendizado vari√°vel.  Enquanto isso, vamos nos concentrar na quest√£o de encontrar um valor adequado para a velocidade de aprendizado Œ∑. <br><br>  Com isso em mente, podemos escolher Œ∑ da seguinte maneira.  Primeiro, avaliamos o valor limite Œ∑ no qual o custo dos dados de treinamento come√ßa imediatamente a diminuir, mas n√£o flutua e n√£o aumenta.  Essa estimativa n√£o precisa ser precisa.  A ordem pode ser estimada come√ßando com Œ∑ = 0,01.  Se o custo diminuir nas primeiras eras, vale a pena tentar Œ∑ = 0,1, 1,0 e assim por diante, at√© encontrar um valor no qual o valor flutue ou aumente nas primeiras eras.  E vice-versa, se o valor flutuar ou aumentar nas primeiras √©pocas com Œ∑ = 0,01, tente Œ∑ = 0,001, Œ∑ = 0,0001, at√© encontrar o valor em que o custo diminui nas primeiras eras.  Este procedimento fornecer√° a ordem do valor limite Œ∑.  Se desejar, voc√™ pode refinar sua avalia√ß√£o escolhendo o valor mais alto para Œ∑, no qual o custo diminui nas primeiras √©pocas, por exemplo, Œ∑ = 0,5 ou Œ∑ = 0,2 (a ultraprecis√£o n√£o √© necess√°ria aqui).  Isso nos fornece uma estimativa do valor limite Œ∑. <br><br>  O valor real de Œ∑, obviamente, n√£o deve exceder o limite selecionado.  De fato, para que o valor Œ∑ permane√ßa √∫til por muitas √©pocas, √© melhor usar um valor duas vezes menor que o limite.  Essa escolha geralmente permite que voc√™ aprenda muitas √©pocas sem diminuir drasticamente o aprendizado. <br><br>  No caso de dados MNIST, seguir esta estrat√©gia levar√° a uma estimativa da ordem do limiar de Œ∑ em 0,1.  Ap√≥s algum refinamento, obtemos o valor Œ∑ = 0,5.  Seguindo a receita acima, devemos usar Œ∑ = 0,25 para nossa velocidade de aprendizado.  Mas, na verdade, descobri que Œ∑ = 0,5 funcionou bem por 30 √©pocas, ent√£o n√£o estava preocupado em diminu√≠-lo. <br><br>  Tudo isso parece bem direto.  No entanto, usar o custo do treinamento para selecionar Œ∑ parece contradizer o que eu disse anteriormente - que escolhemos hiperpar√¢metros, avaliando a efic√°cia da rede usando dados confirmat√≥rios selecionados.  De fato, usaremos a precis√£o da confirma√ß√£o para selecionar os hiperpar√¢metros de regulariza√ß√£o, o tamanho do minipacote e os par√¢metros de rede, como o n√∫mero de camadas e os neur√¥nios ocultos, etc.  Por que fazemos as coisas de maneira diferente com velocidade de aprendizado?  Honestamente, essa escolha se deve √†s minhas prefer√™ncias est√©ticas pessoais e provavelmente √© tendenciosa.  O argumento √© que outros hiperpar√¢metros devem melhorar a precis√£o da classifica√ß√£o final no conjunto de testes, portanto, faz sentido escolh√™-los com base na precis√£o da confirma√ß√£o.  No entanto, a taxa de aprendizado afeta indiretamente apenas a precis√£o da classifica√ß√£o final.  Seu principal objetivo √© controlar o tamanho da etapa da descida do gradiente e acompanhar o custo do treinamento da melhor maneira para reconhecer um tamanho de etapa muito grande.  Mas ainda assim, essa √© uma prefer√™ncia est√©tica pessoal.  Nos est√°gios iniciais do treinamento, o custo do treinamento geralmente diminui apenas se a precis√£o da confirma√ß√£o aumentar; portanto, na pr√°tica, n√£o deve importar quais crit√©rios usar. <br><br><h3>  Usando uma parada antecipada para determinar o n√∫mero de eras de treinamento </h3><br>  Como mencionamos neste cap√≠tulo, uma parada antecipada significa que, no final de cada era, precisamos calcular a precis√£o da classifica√ß√£o nos dados de suporte.  Quando deixa de melhorar, paramos de trabalhar.  Como resultado, definir o n√∫mero de √©pocas se torna um assunto simples.  Em particular, isso significa que n√£o precisamos descobrir especificamente como o n√∫mero de √©pocas depende de outros hiperpar√¢metros.  Isso acontece automaticamente.  Al√©m disso, uma parada antecipada tamb√©m nos impede automaticamente de reciclagem.  Isso, √© claro, √© bom, embora possa ser √∫til desativar a parada inicial nos est√°gios iniciais das experi√™ncias, para que voc√™ possa ver sinais de reciclagem e us√°-los para ajustar a abordagem da regulariza√ß√£o. <br><br>  Para implementar o RO, precisamos descrever mais especificamente o que significa "parar a melhoria da precis√£o da classifica√ß√£o".  Como vimos, a precis√£o pode ir muito longe, mesmo quando a tend√™ncia geral est√° melhorando.  Se pararmos pela primeira vez, quando a precis√£o diminuir, quase certamente n√£o alcan√ßaremos poss√≠veis melhorias adicionais.  A melhor abordagem √© interromper o aprendizado se a melhor precis√£o da classifica√ß√£o n√£o melhorar por um longo tempo.  Suponha, por exemplo, que estamos envolvidos no MNIST.  Ent√£o, podemos decidir interromper o processo se a precis√£o da classifica√ß√£o n√£o tiver melhorado nas √∫ltimas dez √©pocas.  Isso garante que n√£o paremos muito cedo devido a uma falha no treinamento, mas n√£o esperaremos para sempre as melhorias que n√£o acontecer√£o. <br><br>  Esta regra de ‚Äúnenhuma melhoria em mais de dez √©pocas‚Äù √© adequada para o estudo inicial do MNIST.  No entanto, √†s vezes as redes podem atingir um plat√¥ pr√≥ximo a uma certa precis√£o de classifica√ß√£o, permanecer por algum tempo e come√ßar a melhorar novamente.  Se voc√™ precisar obter um desempenho muito bom, a regra "nenhuma melhoria em mais de dez √©pocas" pode ser muito agressiva para isso.  Portanto, recomendo usar a regra "sem melhoria em dez √©pocas" para experimentos prim√°rios e adotar regras mais brandas quando voc√™ come√ßar a entender melhor o comportamento da sua rede: "nenhuma melhoria em vinte √©pocas", "nenhuma melhoria em cinquenta √©pocas" e assim por diante mais adiante.  Obviamente, isso nos fornece outro hiperpar√¢metro para otimiza√ß√£o!  Mas, na pr√°tica, esse hiperpar√¢metro √© geralmente f√°cil de ajustar para obter bons resultados.  E para tarefas que n√£o sejam o MNIST, a regra ‚Äúsem melhoria em dez √©pocas‚Äù pode ser muito agressiva ou n√£o agressiva o suficiente, dependendo dos detalhes de uma tarefa espec√≠fica.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No entanto, depois de experimentar um pouco, geralmente √© bastante f√°cil encontrar uma estrat√©gia adequada de parada precoce. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainda n√£o usamos uma parada precoce em nossos experimentos com o MNIST. </font><font style="vertical-align: inherit;">Isso se deve ao fato de termos feito muitas compara√ß√µes de diferentes abordagens de aprendizagem. </font><font style="vertical-align: inherit;">Para essas compara√ß√µes, √© √∫til usar o mesmo n√∫mero de √©pocas em todos os casos. </font><font style="vertical-align: inherit;">No entanto, vale a pena alterar o network2.py introduzindo o RO no programa.</font></font><br><br><h3>  As tarefas </h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modifique network2.py para que o pedido apare√ßa l√° de acordo com a regra "sem altera√ß√£o para n √©pocas", em que n √© um par√¢metro configur√°vel. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pense em uma regra de parada antecipada que n√£o seja "inalterada em √©pocas". </font><font style="vertical-align: inherit;">Idealmente, a regra deve buscar um compromisso entre obter precis√£o com alta confirma√ß√£o e um tempo de treinamento bastante curto. </font><font style="vertical-align: inherit;">Adicione uma regra ao network2.py e execute tr√™s experimentos comparando a precis√£o da valida√ß√£o e o n√∫mero de eras de treinamento com a regra "sem altera√ß√£o acima de 10 eras".</font></font></li></ul><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Plano de Mudan√ßa da Velocidade de Aprendizagem </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enquanto mantivemos a velocidade de aprendizado Œ∑ constante. </font><font style="vertical-align: inherit;">No entanto, geralmente √© √∫til modific√°-lo. </font><font style="vertical-align: inherit;">Nos est√°gios iniciais do processo de treinamento, √© mais prov√°vel que os pesos sejam atribu√≠dos completamente errados. </font><font style="vertical-align: inherit;">Portanto, ser√° melhor usar uma alta taxa de treinamento, o que far√° com que os pesos mudem mais rapidamente. </font><font style="vertical-align: inherit;">Depois, voc√™ pode reduzir a velocidade do treinamento para fazer um ajuste mais preciso das escalas.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como delineamos um plano para mudar a velocidade do aprendizado? Aqui voc√™ pode aplicar muitas abordagens. Uma op√ß√£o natural √© usar a mesma id√©ia b√°sica que no RO. Mantemos a velocidade de aprendizado constante at√© que a precis√£o da confirma√ß√£o comece a se deteriorar. Em seguida, reduzimos o CO em uma certa quantia, digamos, duas ou dez vezes. Repetimos isso v√°rias vezes at√© que o CO seja 1024 (ou 1000) vezes menor que o inicial. E termine o treinamento.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um plano para alterar a velocidade de aprendizado pode melhorar a efici√™ncia e tamb√©m abre enormes oportunidades para a escolha de um plano. </font><font style="vertical-align: inherit;">E isso pode ser uma dor de cabe√ßa - voc√™ pode gastar para sempre otimizar o plano. </font><font style="vertical-align: inherit;">Para os primeiros experimentos, sugiro usar um valor √∫nico e constante de CO. </font><font style="vertical-align: inherit;">Isso lhe dar√° uma boa primeira aproxima√ß√£o. </font><font style="vertical-align: inherit;">Mais tarde, se voc√™ quiser extrair a melhor efici√™ncia da rede, vale a pena experimentar o plano de alterar a velocidade de aprendizado conforme eu a descrevi. </font><font style="vertical-align: inherit;">Um </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabalho cient√≠fico</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bastante f√°cil de ler </font><a href=""><font style="vertical-align: inherit;">de</font></a><font style="vertical-align: inherit;"> 2010 demonstra as vantagens de velocidades vari√°veis ‚Äã‚Äãde aprendizado ao atacar o MNIST.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exerc√≠cio </font></font></h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Modifique network2.py para que ele implemente o seguinte plano para alterar a velocidade de aprendizado: reduza pela metade o CR sempre que a precis√£o da confirma√ß√£o satisfizer a regra "nenhuma altera√ß√£o em 10 √©pocas" e pare de aprender quando a velocidade de aprendizado cair para 1/128 em rela√ß√£o √† inicial. </font></font></li></ul><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O par√¢metro de regulariza√ß√£o Œª </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu recomendo come√ßar sem nenhuma regulariza√ß√£o (Œª = 0,0) e determinar o valor de Œ∑, como indicado acima. </font><font style="vertical-align: inherit;">Usando o valor selecionado de Œ∑, podemos usar os dados de suporte para selecionar um bom valor de Œª. </font><font style="vertical-align: inherit;">Comece com Œª = 1,0 (n√£o tenho um bom argumento a favor dessa escolha) e aumente ou diminua em 10 vezes para aumentar a efici√™ncia no trabalho com dados de confirma√ß√£o. </font><font style="vertical-align: inherit;">Tendo encontrado a ordem correta de magnitude, podemos ajustar o valor de Œª com mais precis√£o. </font><font style="vertical-align: inherit;">Depois disso, √© necess√°rio retornar √† otimiza√ß√£o Œ∑ novamente.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exerc√≠cio </font></font></h3><br><ul><li>     ,        ,  Œª  Œ∑.      ,        Œª?      ,        Œ∑? </li></ul><br><h3>        </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se voc√™ usar as recomenda√ß√µes desta se√ß√£o, ver√° que os valores selecionados de Œ∑ e Œª nem sempre correspondem exatamente aos que usei anteriormente. S√≥ que o livro tem limita√ß√µes de texto, o que √†s vezes tornava impratic√°vel otimizar os hiperpar√¢metros. Lembre-se de todas as compara√ß√µes das diferentes abordagens de treinamento em que estamos trabalhando - comparando a fun√ß√£o de custo quadr√°tico e entropia cruzada, m√©todos antigos e novos de inicializa√ß√£o de pesos, iniciando com e sem regulariza√ß√£o e assim por diante. Para tornar essas compara√ß√µes significativas, tentei n√£o alterar os hiperpar√¢metros entre as abordagens comparadas (ou escal√°-las corretamente). Obviamente, n√£o h√° raz√£o para que os mesmos hiperpar√¢metros sejam √≥timos para todas as abordagens diferentes de aprendizado; portanto, os hiperpar√¢metros que utilizo foram o resultado de um compromisso.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como alternativa, eu poderia tentar otimizar todos os hiper par√¢metros para cada abordagem de aprendizado ao m√°ximo. </font><font style="vertical-align: inherit;">Seria uma abordagem melhor e mais honesta, j√° que tirar√≠amos o melhor de cada uma das abordagens da aprendizagem. </font><font style="vertical-align: inherit;">No entanto, fizemos dezenas de compara√ß√µes e, na pr√°tica, isso seria muito caro computacionalmente. </font><font style="vertical-align: inherit;">Portanto, decidi comprometer-me a usar op√ß√µes de hiperpar√¢metro boas o suficiente (mas n√£o necessariamente √≥timas).</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mini tamanho da embalagem </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como escolher o tamanho da minipacote? </font><font style="vertical-align: inherit;">Para responder a essa pergunta, primeiro vamos assumir que estamos envolvidos em treinamento on-line, ou seja, usamos um mini-pacote de tamanho 1.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O problema √≥bvio do aprendizado on-line √© que o uso de mini-pacotes que consistem em um √∫nico exemplo de treinamento levar√° a erros graves na estimativa do gradiente. Mas, de fato, esses erros n√£o apresentar√£o um problema t√£o s√©rio. A raz√£o √© que as estimativas individuais de gradiente n√£o precisam ser altamente precisas. S√≥ precisamos obter uma estimativa suficientemente precisa para que nossa fun√ß√£o de custo diminua. √â como se voc√™ estivesse tentando chegar ao p√≥lo magn√©tico norte, mas teria uma b√∫ssola n√£o confi√°vel, com cada medi√ß√£o confundida em 10 a 20 graus. Se voc√™ verificar a b√∫ssola com bastante frequ√™ncia e, em m√©dia, indicar a dire√ß√£o certa, voc√™ poder√° chegar ao p√≥lo magn√©tico norte.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diante desse argumento, parece que devemos usar o aprendizado on-line. Mas, na realidade, a situa√ß√£o √© um pouco mais complicada. Na tarefa do cap√≠tulo anterior, apontei que, para calcular a atualiza√ß√£o de gradiente para todos os exemplos no mini-pacote, voc√™ pode usar t√©cnicas de matriz ao mesmo tempo, em vez de um loop. Dependendo dos detalhes do seu hardware e da biblioteca de √°lgebra linear, pode ser muito mais r√°pido calcular a estimativa para o minipacote de, digamos, 100 do que calcular a estimativa de gradiente para o minipacote em um ciclo para 100 exemplos de treinamento. Pode ser, por exemplo, apenas 50 vezes mais lento, e n√£o 100. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A princ√≠pio, parece que isso n√£o ajuda muito. Com um tamanho de minipacote de 100, a regra de treinamento para pesos se parece com:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtable" id="MJXp-Span-2"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-3" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-4" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-6" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-msup" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-9" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-10" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-12" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-14" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">100</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-17"><span class=""><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span><span class="MJXp-mi" id="MJXp-Span-20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-23" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="6.154ex" viewBox="0 -1558.2 33095.6 2649.6" role="img" focusable="false" style="vertical-align: -2.535ex; max-width: 638px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(30815,0)"><g id="mjx-eqn-100" transform="translate(0,157)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-30" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-30" x="1390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-29" x="1891" y="0"></use></g></g><g transform="translate(10345,0)"><g transform="translate(-15,0)"><g transform="translate(0,157)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2192" x="994" y="0"></use><g transform="translate(2272,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2032" x="1013" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-3D" x="3561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="4617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2212" x="5556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-3B7" x="6557" y="0"></use><g transform="translate(7060,0)"><g transform="translate(120,0)"><rect stroke="none" width="1621" height="60" x="0" y="220"></rect><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-31" x="560" y="676"></use><g transform="translate(60,-686)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-30" x="1001" y="0"></use></g></g></g><g transform="translate(9089,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJSZ2-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-78" x="735" y="-1487"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2207" x="10700" y="0"></use><g transform="translate(11533,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-78" x="1011" y="-213"></use></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> w \rightarrow w' = w-\eta \frac{1}{100} \sum_x \nabla C_x \tag{100} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde a soma vai sobre os exemplos de treinamento no minipacote. </font><font style="vertical-align: inherit;">Compare com</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-24"><span class="MJXp-mtable" id="MJXp-Span-25"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-26" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-27" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-29" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-msup" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-32" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mi" id="MJXp-Span-37"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-40" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="2.901ex" viewBox="0 -883.9 33095.6 1249" role="img" focusable="false" style="vertical-align: -0.848ex; max-width: 638px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(30815,0)"><g id="mjx-eqn-101" transform="translate(0,-30)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-30" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-31" x="1390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-29" x="1891" y="0"></use></g></g><g transform="translate(12164,0)"><g transform="translate(-15,0)"><g transform="translate(0,-30)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2192" x="994" y="0"></use><g transform="translate(2272,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2032" x="1013" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-3D" x="3561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="4617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2212" x="5556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-3B7" x="6557" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2207" x="7060" y="0"></use><g transform="translate(7894,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-78" x="1011" y="-213"></use></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> w \rightarrow w' = w-\eta \nabla C_x \tag{101} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">para aprendizado online. </font><font style="vertical-align: inherit;">Mesmo que demore 50 vezes mais tempo para atualizar o mini-pacote, o treinamento on-line ainda parece ser a melhor op√ß√£o, pois seremos atualizados com mais frequ√™ncia. </font><font style="vertical-align: inherit;">Mas suponha, no entanto, que, no caso do mini-pacote, aumentemos a velocidade de aprendizado em 100 vezes, a regra de atualiza√ß√£o se transformar√° em:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-41"><span class="MJXp-mtable" id="MJXp-Span-42"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-43" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-44" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-msup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-49" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-munderover" id="MJXp-Span-54"><span class=""><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> x</font></font></span></span></span><span class="MJXp-mi" id="MJXp-Span-57"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àá </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-60" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="5.31ex" viewBox="0 -1402.6 33095.6 2286.5" role="img" focusable="false" style="vertical-align: -2.053ex; max-width: 638px;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(30815,0)"><g id="mjx-eqn-102" transform="translate(0,354)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-28"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-30" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-32" x="1390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-29" x="1891" y="0"></use></g></g><g transform="translate(11275,0)"><g transform="translate(-15,0)"><g transform="translate(0,354)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2192" x="994" y="0"></use><g transform="translate(2272,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2032" x="1013" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-3D" x="3561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-77" x="4617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2212" x="5556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-3B7" x="6557" y="0"></use><g transform="translate(7227,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJSZ2-2211" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-78" x="735" y="-1487"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMAIN-2207" x="8838" y="0"></use><g transform="translate(9672,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/post/460711/&amp;usg=ALkJrhiLZ6R4gKDUqgBTfxQ-nwhepn_m4Q#MJMATHI-78" x="1011" y="-213"></use></g></g></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> w \rightarrow w' = w-\eta \sum_x \nabla C_x \tag{102} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√â semelhante a 100 est√°gios separados de aprendizado on-line com uma velocidade de aprendizado de Œ∑. </font><font style="vertical-align: inherit;">No entanto, um passo no aprendizado on-line leva apenas 50 vezes mais tempo. </font><font style="vertical-align: inherit;">Obviamente, na realidade, esses n√£o s√£o exatamente 100 n√≠veis de aprendizado on-line, pois no minipacote todos os ‚àáC </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> s√£o avaliados para o mesmo conjunto de pesos, em contraste com o aprendizado acumulado que ocorre no caso on-line. </font><font style="vertical-align: inherit;">E, no entanto, parece que o uso de mini-pacotes maiores acelerar√° o processo.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dados todos esses fatores, a escolha do melhor tamanho de minipacote √© um compromisso. Escolha muito pequeno e n√£o obtenha todos os benef√≠cios de boas bibliotecas matriciais otimizadas para hardware r√°pido. Escolha muito grande e n√£o atualizar√° o peso com frequ√™ncia suficiente. Voc√™ precisa escolher um valor de compromisso que maximize a velocidade de aprendizado. Felizmente, a escolha do tamanho do minipacote na qual a velocidade √© maximizada √© relativamente independente de outros hiperpar√¢metros (exceto para a arquitetura geral); portanto, para encontrar um bom tamanho de minipacote, n√£o √© necess√°rio otimiz√°-los. Portanto, ser√° suficiente usar valores aceit√°veis ‚Äã‚Äã(n√£o necessariamente √≥timos) para outros hiperpar√¢metros e tentar v√°rios tamanhos diferentes de minipacotes, escalando Œ∑, conforme indicado acima.Crie um gr√°fico da precis√£o da confirma√ß√£o versus o tempo (tempo real decorrido, n√£o as apagadas!) E escolha um tamanho de minipacote que ofere√ßa a melhoria mais r√°pida do desempenho. Com o tamanho de minipacote selecionado, voc√™ pode otimizar outros hiperpar√¢metros.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, como voc√™ j√° entendeu, sem d√∫vida, em nosso trabalho n√£o realizei essa otimiza√ß√£o. </font><font style="vertical-align: inherit;">Em nossa implementa√ß√£o da Assembl√©ia Nacional, uma abordagem r√°pida para atualizar mini-pacotes n√£o √© usada. </font><font style="vertical-align: inherit;">Simplesmente usei o tamanho do minipacote 10 sem comentar ou explicar, em quase todos os exemplos. </font><font style="vertical-align: inherit;">Em geral, podemos acelerar o aprendizado reduzindo o tamanho do minipacote. </font><font style="vertical-align: inherit;">Eu n√£o fiz isso, em particular, porque meus experimentos preliminares sugeriram que a acelera√ß√£o seria bastante modesta. </font><font style="vertical-align: inherit;">Mas em implementa√ß√µes pr√°ticas, definitivamente gostar√≠amos de implementar a abordagem mais r√°pida para atualizar mini-pacotes e tentar otimizar seu tamanho para maximizar a velocidade geral.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> T√©cnicas automatizadas </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Descrevi essas abordagens heur√≠sticas como algo que precisa ser ajustado manualmente. A otimiza√ß√£o manual √© uma boa maneira de ter uma id√©ia de como o NS funciona. No entanto, e, ali√°s, n√£o surpreende que muito trabalho j√° tenha sido feito na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">automa√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> deste projeto. Uma t√©cnica comum √© uma pesquisa de grade que peneira sistematicamente uma grade no espa√ßo dos hiperpar√¢metros. Uma vis√£o geral das realiza√ß√µes e limita√ß√µes dessa t√©cnica (bem como recomenda√ß√µes sobre alternativas facilmente implement√°veis) pode ser encontrada em </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2012</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Muitas t√©cnicas sofisticadas foram propostas. N√£o vou revisar todos eles, mas quero observar o trabalho promissor de 2012, usando a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">otimiza√ß√£o bayesiana de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> hiperpar√¢metros. O c√≥digo do trabalho est√° </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aberto a todos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , e com algum sucesso foi usado por outros pesquisadores. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Resumir </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usando as regras de pr√°tica que descrevi, voc√™ n√£o obter√° os melhores resultados do seu PS de todos os poss√≠veis. Mas √© prov√°vel que eles forne√ßam um bom ponto de partida e base para novas melhorias. Em particular, descrevi basicamente os hiperpar√¢metros de forma independente. Na pr√°tica, h√° uma conex√£o entre eles. Voc√™ pode experimentar com Œ∑, decidir que encontrou o valor correto, come√ßar a otimizar Œª e descobrir que ele viola sua otimiza√ß√£o Œ∑. Na pr√°tica, √© √∫til avan√ßar em diferentes dire√ß√µes, aproximando-se gradualmente de bons valores. Acima de tudo, lembre-se de que as abordagens heur√≠sticas que descrevi s√£o regras simples de pr√°tica, mas n√£o algo esculpido em pedra. Voc√™ precisa procurar sinais de que algo n√£o est√° funcionando e deseja experimentar. Em particularmonitore cuidadosamente o comportamento da sua rede neural, especialmente a precis√£o da confirma√ß√£o.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A complexidade da escolha dos hiperpar√¢metros √© agravada pelo fato de que o conhecimento pr√°tico de sua escolha est√° espalhado por muitos trabalhos e programas de pesquisa, e geralmente est√° apenas na cabe√ßa de cada profissional. H√° uma enorme quantidade de trabalho com descri√ß√µes do que fazer (geralmente conflitando entre si). No entanto, existem v√°rios trabalhos particularmente √∫teis que sintetizam e destacam grande parte desse conhecimento. </font></font><a href=""><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Joshua Benji a partir de 2012 d√° conselhos pr√°ticos sobre o uso de back-propaga√ß√£o gradiente descendente e treinamento para a Assembleia Nacional, incluindo a Assembleia Nacional e profundo. Benjio descreve muitos dos detalhes com muito mais detalhes. Do que eu, incluindo uma busca sistem√°tica por hiperpar√¢metros. Outro bom trabalho √© o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabalho.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Yanna Lekuna e outros, 1998. Ambos os trabalhos aparecem no livro extremamente √∫til de 2012, que cont√©m muitos truques frequentemente usados ‚Äã‚Äãna Assembl√©ia Nacional: " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Redes neurais: truques de artesanato</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". O livro √© caro, mas muitos de seus artigos foram publicados na Internet por seus autores e podem ser encontrados nos motores de busca.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A partir desses artigos, e especialmente de nossos pr√≥prios experimentos, uma coisa fica clara: o problema de otimizar hiperpar√¢metros n√£o pode ser chamado de completamente resolvido. Sempre h√° outro truque que voc√™ pode tentar melhorar a efici√™ncia. Os escritores dizem que um livro n√£o pode ser finalizado, mas que pode ser descartado. O mesmo vale para a otimiza√ß√£o do NS: o espa√ßo dos hiperpar√¢metros √© t√£o grande que a otimiza√ß√£o n√£o pode ser conclu√≠da, mas s√≥ pode ser interrompida, deixando o NS para os descendentes. Portanto, seu objetivo ser√° desenvolver um fluxo de trabalho que permita executar rapidamente uma boa otimiza√ß√£o, deixando a oportunidade de experimentar op√ß√µes de otimiza√ß√£o mais detalhadas, se necess√°rio.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As dificuldades na sele√ß√£o dos hiperpar√¢metros fazem com que algumas pessoas se queixem de que os SNs exigem muito esfor√ßo em compara√ß√£o com outras t√©cnicas de MO. Ouvi muitas variantes de reclama√ß√µes como: ‚ÄúSim, um NS bem ajustado pode oferecer a melhor efici√™ncia na solu√ß√£o de um problema. Mas, por outro lado, eu posso tentar uma floresta aleat√≥ria [ou SVM, ou qualquer outra tecnologia favorita], e simplesmente funciona. N√£o tenho tempo para descobrir qual NA √© a certa para mim. " Obviamente, do ponto de vista pr√°tico, √© bom ter t√©cnicas f√°ceis de usar com um amigo. Isso √© especialmente bom quando voc√™ est√° apenas come√ßando a trabalhar com uma tarefa e ainda n√£o est√° claro se o MO pode ajudar a resolv√™-la. Por outro lado, se √© importante que voc√™ obtenha os melhores resultados, pode ser necess√°rio experimentar v√°rias abordagens que requerem conhecimento mais especializado. Seria √≥timose MO sempre foi f√°cil, mas n√£o h√° raz√µes para que isso seja trivial a priori.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Outras t√©cnicas </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cada uma das t√©cnicas desenvolvidas neste cap√≠tulo √© valiosa por si s√≥, mas essa n√£o √© a √∫nica raz√£o pela qual as descrevi. </font><font style="vertical-align: inherit;">√â mais importante se familiarizar com alguns dos problemas que podem surgir no campo de NA e com um estilo de an√°lise que pode ajudar a super√°-los. </font><font style="vertical-align: inherit;">De certa forma, estamos aprendendo a pensar sobre o NS. </font><font style="vertical-align: inherit;">No restante deste cap√≠tulo, descreverei brevemente um conjunto de outras t√©cnicas. </font><font style="vertical-align: inherit;">Suas descri√ß√µes n√£o ser√£o t√£o profundas quanto as anteriores, mas devem transmitir algumas sensa√ß√µes sobre a variedade de t√©cnicas encontradas no campo de NA.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Varia√ß√µes da descida do gradiente estoc√°stico </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A descida do gradiente estoc√°stico por meio da retropropaga√ß√£o nos serviu bem durante o ataque ao problema de classifica√ß√£o de n√∫meros manuscritos do MNIST. </font><font style="vertical-align: inherit;">No entanto, existem muitas outras abordagens para otimizar a fun√ß√£o de custo e, √†s vezes, mostram uma efici√™ncia superior √† da descida estoc√°stica do gradiente com minipacotes. </font><font style="vertical-align: inherit;">Nesta se√ß√£o, descrevo brevemente duas dessas abordagens, Hessian e momentum.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hessian </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para come√ßar, vamos deixar de lado a Assembl√©ia Nacional. </font><font style="vertical-align: inherit;">Em vez disso, simplesmente consideramos o problema abstrato de minimizar a fun√ß√£o de custo C de muitas vari√°veis, w = w1, w2, ..., ou seja, C = C (w). </font><font style="vertical-align: inherit;">Pelo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">teorema de Taylor,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> a fun√ß√£o de custo no ponto w pode ser aproximada:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-61"><span class="MJXp-mtable" id="MJXp-Span-62"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-63" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-64" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-69"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-70"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-munderover" id="MJXp-Span-78"><span class=""><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-left: 0px;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> j </font></font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-81" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-82"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-84"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-88"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œî</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-91" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mspace" id="MJXp-Span-92" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-94" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-95"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-96"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-97"><span class=""><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àë</font></font></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-99" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-102"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mfrac" id="MJXp-Span-106" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi" id="MJXp-Span-108" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ</font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-109" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-111"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-114" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mi" id="MJXp-Span-115"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àÇ </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-118" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-119"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œî</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> C(w+\Delta w) = C(w) + \sum_j \frac{\partial C}{\partial w_j} \Delta w_j \nonumber \\ + \frac{1}{2} \sum_{jk} \Delta w_j \frac{\partial^2 C}{\partial w_j \partial w_k} \Delta w_k + \ldots \tag{103} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Podemos reescrev√™-lo de forma mais compacta como </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-125"><span class="MJXp-mtable" id="MJXp-Span-126"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-127" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-128" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-133"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-135" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-140" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-142"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ãÖ </font></font></span><span class="MJXp-mi" id="MJXp-Span-145"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-147" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-148" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-149"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-150"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-151"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œî</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-154" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi" id="MJXp-Span-156"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+</font></font></span><span class="MJXp-mo" id="MJXp-Span-159" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">...</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> C(w+\Delta w) = C(w) + \nabla C \cdot \Delta w + \frac{1}{2} \Delta w^T H \Delta w + \ldots \tag{104} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde ‚àáC √© o vetor gradiente comum e H √© a matriz conhecida como </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">matriz de Hessian</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , onde jk cont√©m ‚àÇ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C / ‚àÇw </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àÇw </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Suponhamos que aproximamos C abandonando termos de ordem superior escondidos atr√°s das retic√™ncias na f√≥rmula:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-160"><span class="MJXp-mtable" id="MJXp-Span-161"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-162" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-163" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-167" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-168"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-170" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚âà </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-173" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-177"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ãÖ </font></font></span><span class="MJXp-mi" id="MJXp-Span-180"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-182" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-183" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-184"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-185"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span><span class="MJXp-mi" id="MJXp-Span-186"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Œî</font></font></span><span class="MJXp-msubsup" id="MJXp-Span-187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-189" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H</font></font></span><span class="MJXp-mi" id="MJXp-Span-191"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> C(w+\Delta w) \approx C(w) + \nabla C \cdot \Delta w + \frac{1}{2} \Delta w^T H \Delta w \tag{105} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usando √°lgebra, pode ser mostrado que a express√£o no lado direito pode ser minimizada selecionando: </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-193"><span class="MJXp-mtable" id="MJXp-Span-194"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-195" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-196" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-197"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œî </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-201"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">H </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-203" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-204"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-205"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span><span class="MJXp-mi" id="MJXp-Span-206"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> \Delta w = -H^{-1} \nabla C \tag{106} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estritamente falando, para que isso seja apenas um m√≠nimo, e n√£o apenas um extremo, devemos assumir que a matriz hessiana √© um positivo mais definido. </font><font style="vertical-align: inherit;">Intuitivamente, isso significa que a fun√ß√£o C √© como um vale, n√£o uma montanha ou uma sela. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se (105) for uma boa aproxima√ß√£o √† fun√ß√£o de custo, espera-se que a transi√ß√£o do ponto w para o ponto w + Œîw = w - H - 1 ‚àíC reduza significativamente a fun√ß√£o de custo. </font><font style="vertical-align: inherit;">Isso oferece um poss√≠vel algoritmo de minimiza√ß√£o de custos:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Selecione o ponto inicial w. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atualize w para um novo ponto, w ‚Ä≤ = w - H </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àí1</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àáC, onde o Hessian H e ‚àáC s√£o calculados em w.</font></font></li><li>  w'   , w‚Ä≤‚Ä≤=w‚Ä≤‚àíH‚Ä≤ <sup>‚àí1</sup> ‚àá‚Ä≤C,   H  ‚àáC   w'. </li><li>  ... </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na pr√°tica, (105) √© apenas uma aproxima√ß√£o, e √© melhor dar passos menores. Faremos isso atualizando constantemente w por Œîw = ‚àíŒ∑H - 1‚àáC, onde Œ∑ √© a velocidade de aprendizado. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa abordagem para minimizar a fun√ß√£o de custo √© conhecida como otimiza√ß√£o de Hessian. H√° resultados te√≥ricos e emp√≠ricos mostrando que os m√©todos de Hessian convergem para o m√≠nimo em menos etapas do que uma descida de gradiente padr√£o. Em particular, ao incluir informa√ß√µes sobre altera√ß√µes de segunda ordem na fun√ß√£o de custo, √© poss√≠vel evitar muitas patologias encontradas na descida do gradiente na abordagem de Hessian. Al√©m disso, existem vers√µes do algoritmo de retropropaga√ß√£o que podem ser usadas para calcular o Hessian.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se a otimiza√ß√£o do Hessian √© t√£o legal, por que n√£o a usamos em nosso NS? </font><font style="vertical-align: inherit;">Infelizmente, embora tenha muitas propriedades desej√°veis, h√° uma muito indesej√°vel: √© muito dif√≠cil colocar em pr√°tica. </font><font style="vertical-align: inherit;">Parte do problema √© o enorme tamanho da matriz hessiana. </font><font style="vertical-align: inherit;">Suponha que tenhamos um NS com 10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pesos e compensa√ß√µes. </font><font style="vertical-align: inherit;">Ent√£o, na matriz hessiana correspondente, haver√° 10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √ó 10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elementos. </font><font style="vertical-align: inherit;">Demais! </font><font style="vertical-align: inherit;">Como resultado </font><font style="vertical-align: inherit;">, acaba sendo muito dif√≠cil </font><font style="vertical-align: inherit;">calcular H- </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ‚àáC na pr√°tica. </font><font style="vertical-align: inherit;">Mas isso n√£o significa que √© in√∫til saber sobre ela. </font><font style="vertical-align: inherit;">Muitas op√ß√µes de descida de gradiente s√£o inspiradas na otimiza√ß√£o de Hessian, elas simplesmente evitam o problema de matrizes excessivamente grandes. </font><font style="vertical-align: inherit;">Vamos dar uma olhada em uma dessas t√©cnicas, a descida do gradiente de impulso.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Descida de gradiente baseada em impulso </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intuitivamente, a vantagem da otimiza√ß√£o de Hessian √© que ela inclui n√£o apenas informa√ß√µes sobre o gradiente, mas tamb√©m informa√ß√µes sobre suas altera√ß√µes. A descida do gradiente baseada em impulso √© baseada em uma intui√ß√£o semelhante, mas evita matrizes grandes de segundas derivadas. Para entender a t√©cnica de impulso, vamos relembrar nossa primeira imagem de descida gradiente, na qual examinamos uma bola rolando por um vale. Ent√£o vimos que a descida do gradiente, ao contr√°rio do nome, se assemelha apenas ligeiramente a uma bola caindo no fundo. A t√©cnica de pulso altera a descida do gradiente em dois lugares, o que a torna mais parecida com uma imagem f√≠sica. Primeiro, ela introduz o conceito de "velocidade" para os par√¢metros que estamos tentando otimizar. O gradiente est√° tentando alterar a velocidade, n√£o o "local" diretamente, semelhante √† forma como as for√ßas f√≠sicas alteram a velocidade,e afetam apenas indiretamente o local. Em segundo lugar, o m√©todo de impulso √© um tipo de termo de atrito que reduz gradualmente a velocidade.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos dar uma defini√ß√£o mais matematicamente precisa. </font><font style="vertical-align: inherit;">Introduzimos as vari√°veis ‚Äã‚Äãde velocidade v = v1, v2, ..., uma para cada vari√°vel correspondente w </font></font><sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (na rede neural, essas vari√°veis ‚Äã‚Äãincluem naturalmente todos os pesos e deslocamentos). </font><font style="vertical-align: inherit;">Em seguida, alteramos a regra de atualiza√ß√£o da descida do gradiente w ‚Üí w ‚Ä≤ = w - Œ∑‚àáC para</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-208"><span class="MJXp-mtable" id="MJXp-Span-209"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-210" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-211" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-213" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-msup" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-216" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-217" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œº </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-220" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Œ∑ </font></font></span><span class="MJXp-mi" id="MJXp-Span-222"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚àá </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> v \rightarrow v' = \mu v - \eta \nabla C \tag{107} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-224"><span class="MJXp-mtable" id="MJXp-Span-225"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-226" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-227" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-229" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Üí </font></font></span><span class="MJXp-msup" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-232" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-233" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-235" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-msup" id="MJXp-Span-236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-238" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Ä≤</font></font></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> w \rightarrow w' = w+v' \tag{108} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nas equa√ß√µes, Œº √© um hiperpar√¢metro que controla a quantidade de frenagem ou atrito do sistema. Para entender o significado das equa√ß√µes, primeiro √© √∫til considerar o caso em que Œº = 1, ou seja, quando n√£o h√° atrito. Nesse caso, o estudo das equa√ß√µes mostra que agora a ‚Äúfor√ßa‚Äù ‚àáC altera a velocidade v, e a velocidade controla a taxa de varia√ß√£o w. Intuitivamente, √© poss√≠vel ganhar velocidade adicionando constantemente membros gradientes a ela. Isso significa que, se o gradiente se mover em aproximadamente uma dire√ß√£o durante v√°rias etapas do treinamento, podemos obter uma velocidade de movimento suficientemente alta nessa dire√ß√£o. Imagine, por exemplo, o que acontece quando se move ladeira abaixo:</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/37e/5f9/af1/37e5f9af1985610568cba31157e35763.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A cada passo da encosta, a velocidade aumenta e nos movemos cada vez mais r√°pido para o fundo do vale. Isso permite que a t√©cnica de velocidade corra muito mais r√°pido que a descida de gradiente padr√£o. Obviamente, o problema √© que, tendo atingido o fundo do vale, vamos passar por ele. Ou, se o gradiente mudar muito rapidamente, pode acontecer que estamos nos movendo na dire√ß√£o oposta. Este √© o ponto de introduzir o hiperpar√¢metro Œº em (107). Eu disse anteriormente que ¬µ controla a quantidade de atrito no sistema; mais precisamente, a quantidade de atrito deve ser imaginada como 1 Œº. Quando ¬µ = 1, como vimos, n√£o h√° atrito, e a velocidade √© completamente determinada pelo gradiente ‚àáC. E vice-versa, quando Œº = 0, h√° muito atrito, nenhuma velocidade √© obtida e as equa√ß√µes (107) e (108) s√£o reduzidas √†s equa√ß√µes usuais de descida do gradiente, w ‚Üí w ‚Ä≤ = w - Œ∑‚àáC. Na pr√°tica,usar o valor de Œº no intervalo entre 0 e 1 pode nos dar a vantagem da capacidade de ganhar velocidade sem o risco de escorregar no m√≠nimo. Podemos escolher esse valor para Œº usando os dados de confirma√ß√£o pendentes da mesma maneira que escolhemos os valores para Œ∑ e Œª.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At√© agora, evitei nomear o hiperpar√¢metro Œº. O fato √© que o nome padr√£o para Œº foi mal escolhido: √© chamado de coeficiente de momento. Isso pode ser confuso, porque ¬µ n√£o √© nada parecido com o conceito de momento da f√≠sica. Est√° muito mais fortemente associado ao atrito. No entanto, o termo ‚Äúcoeficiente de momentum‚Äù √© amplamente usado, portanto continuaremos a us√°-lo tamb√©m.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma caracter√≠stica interessante da t√©cnica de impulso √© que quase nada precisa ser feito para alterar a implementa√ß√£o da descida do gradiente para incluir essa t√©cnica nela. </font><font style="vertical-align: inherit;">Ainda podemos usar a propaga√ß√£o reversa para calcular gradientes, como antes, e usar id√©ias como verificar minipacks estoc√°sticos selecionados. </font><font style="vertical-align: inherit;">Nesse caso, podemos obter alguns dos benef√≠cios da otimiza√ß√£o do Hessian usando informa√ß√µes sobre altera√ß√µes de gradiente. </font><font style="vertical-align: inherit;">No entanto, tudo isso acontece sem falhas e com apenas pequenas altera√ß√µes no c√≥digo. </font><font style="vertical-align: inherit;">Na pr√°tica, a t√©cnica de impulso √© amplamente usada e geralmente ajuda a acelerar o aprendizado.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exerc√≠cios </font></font></h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O que vai dar errado se usarmos Œº&gt; 1 na t√©cnica de pulso? </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> O que vai dar errado se usarmos &lt;0 na t√©cnica de pulso? </font></font></li></ul><br><br><h3>  Desafio </h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adicione a descida do gradiente estoc√°stico com base no momento ao network2.py. </font></font></li></ul><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Outras abordagens para minimizar a fun√ß√£o de custo </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Muitas outras abordagens foram desenvolvidas para minimizar a fun√ß√£o de custo e nenhum acordo foi alcan√ßado sobre a melhor abordagem. </font><font style="vertical-align: inherit;">Aprofundando o assunto das redes neurais, √© √∫til se aprofundar em outras tecnologias, entender como elas funcionam, quais s√£o seus pontos fortes e fracos e como coloc√°-las em pr√°tica. </font><font style="vertical-align: inherit;">No </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabalho</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> que mencionei anteriormente </font><font style="vertical-align: inherit;">, v√°rias dessas t√©cnicas s√£o introduzidas e comparadas, incluindo a descida gradiente emparelhada e o m√©todo BFGS (e tamb√©m estudamos o m√©todo BFGS estreitamente relacionado com limite de mem√≥ria, ou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L-BFGS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Outra tecnologia que recentemente mostrou </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">resultados promissores.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, esse √© o gradiente acelerado de Nesterov, melhorando a t√©cnica de pulso. </font><font style="vertical-align: inherit;">No entanto, a descida simples do gradiente funciona bem para muitas tarefas, especialmente ao usar o momento, portanto, permaneceremos na descida estoc√°stica do gradiente at√© o final do livro.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Outros modelos de neur√¥nio artificial </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At√© agora, criamos nosso NS usando neur√¥nios sigm√≥ides. </font><font style="vertical-align: inherit;">Em princ√≠pio, o NS constru√≠do em neur√¥nios sigm√≥ides pode calcular qualquer fun√ß√£o. </font><font style="vertical-align: inherit;">Mas, na pr√°tica, as redes constru√≠das em outros modelos de neur√¥nios √†s vezes est√£o √† frente dos modelos sigm√≥ides. </font><font style="vertical-align: inherit;">Dependendo do aplicativo, as redes baseadas nesses modelos alternativos podem aprender mais rapidamente, generalizar melhor os dados de verifica√ß√£o ou fazer as duas coisas. </font><font style="vertical-align: inherit;">Deixe-me mencionar alguns modelos alternativos de neur√¥nios para ter uma id√©ia de algumas op√ß√µes usadas com frequ√™ncia. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Talvez a varia√ß√£o mais simples seja um neur√¥nio tang que substitui uma fun√ß√£o sigm√≥ide por uma tangente hiperb√≥lica. </font><font style="vertical-align: inherit;">A sa√≠da de um neur√¥nio tangente com a entrada x, um vetor de pesos w e um deslocamento b √© especificada como</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-239"><span class="MJXp-mtable" id="MJXp-Span-240"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-241" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-242" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-243"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tanh </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246"><font style="vertical-align: inherit;">w </font></span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">‚ãÖ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248"><font style="vertical-align: inherit;">x </font></span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">+ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250"><font style="vertical-align: inherit;">b </font></span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-245" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-249" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-251" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> \tanh(w \cdot x+b) \tag{109} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onde tanh √© naturalmente </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tangente hiperb√≥lica</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Acontece que ele est√° intimamente ligado ao neur√¥nio sigm√≥ide. </font><font style="vertical-align: inherit;">Para ver isso, lembre-se que tanh √© definido como</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-252"><span class="MJXp-mtable" id="MJXp-Span-253"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-254" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-255" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-256"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tanh </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259"><font style="vertical-align: inherit;">z </font></span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">‚â° </font></span><span class="MJXp-mfrac" id="MJXp-Span-262" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">e </font></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-262" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-265" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;">z</font></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-262" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"> - </font></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-262" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">e </font></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-262" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-269" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-270"><font style="vertical-align: inherit;">- </font></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-262" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mrow MJXp-script" id="MJXp-Span-269" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271"><font style="vertical-align: inherit;">z</font></span></span></span></span></span></font><span class="MJXp-mo" id="MJXp-Span-257" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-260" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mfrac" id="MJXp-Span-262" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-265" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-269" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-270"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271"><font style="vertical-align: inherit;"></font></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-274" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-276"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-278" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-279"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> \tanh(z) \equiv \frac{e^z-e^{-z}}{e^z+e^{-z}} \tag{110} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Usando um pouco de √°lgebra, √© f√°cil ver que </font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-281"><span class="MJXp-mtable" id="MJXp-Span-282"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-283" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-284" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œÉ </font></font></span><span class="MJXp-mo" id="MJXp-Span-286" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-288" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-289" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-290" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-291"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-292" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi" id="MJXp-Span-293"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tanh </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296"><font style="vertical-align: inherit;">z </font></span><span class="MJXp-mrow" id="MJXp-Span-297"><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;">/</font></span></span><span class="MJXp-mn" id="MJXp-Span-299"><font style="vertical-align: inherit;"> 2 </font></span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">)</font></span></font><span class="MJXp-mo" id="MJXp-Span-294" style="margin-left: 0em; margin-right: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-295" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-297"><span class="MJXp-mo" id="MJXp-Span-298" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn" id="MJXp-Span-299"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mn" id="MJXp-Span-301"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \sigma(z) = \frac{1+\tanh(z/2)}{2} \tag{111} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isto √©, tanh est√° apenas escalando o sigm√≥ide. </font><font style="vertical-align: inherit;">Graficamente, voc√™ tamb√©m pode ver que a fun√ß√£o tanh tem a mesma forma que o sigm√≥ide: </font></font><br><br><img src="https://habrastorage.org/webt/2d/al/jw/2daljwgmoaw7v8g4bz7jkiy8fwo.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma diferen√ßa entre os neur√¥nios tang e os neur√¥nios sigm√≥ides √© que a sa√≠da do primeiro se estende de -1 a 1, e n√£o de 0 a 1. Isso significa que, ao criar uma rede baseada em neur√¥nios tangentes, talvez seja necess√°rio normalizar suas sa√≠das (e, dependendo dos detalhes do aplicativo, talvez as entradas) um pouco diferente das redes sigm√≥ides. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como os sigm√≥ides, os neur√¥nios tang, em princ√≠pio, podem calcular qualquer fun√ß√£o (embora existam alguns truques), marcando entradas de -1 a 1. Al√©m disso, as id√©ias de propaga√ß√£o traseira e descida de gradiente estoc√°stico s√£o igualmente f√°ceis de aplicar ao tang -neur√¥nios, bem como sigm√≥ides.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Exerc√≠cio </font></font></h3><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prove a equa√ß√£o (111). </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Que tipo de neur√¥nio deve ser usado em redes, tang ou sigm√≥ide? A resposta, para dizer o m√≠nimo, n√£o √© √≥bvia! No entanto, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">existem </font></font></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">argumentos te√≥ricos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e algumas evid√™ncias emp√≠ricas de que os neur√¥nios tangores √†s vezes funcionam melhor. Vamos analisar brevemente um dos argumentos te√≥ricos a favor dos neur√¥nios tang. Suponha que usemos neur√¥nios sigm√≥ides, e todas as ativa√ß√µes na rede ser√£o positivas. Considere os pesos w </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l + 1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jk</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> inclu√≠dos para o neur√¥nio n. J na camada n. L + 1. regras Back-Propagation (Bp4) dizem-nos que o gradiente associado √© um </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a k</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> delta </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l + 1, </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Como as ativa√ß√µes s√£o positivas, o sinal desse gradiente ser√° o mesmo de Œ¥ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l + 1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Isso significa que se Œ¥ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l + 1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j for</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> positivo, todos os pesos w </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l + 1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jk</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> diminuir√£o durante a descida do gradiente e se Œ¥ </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l + 1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j for</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> negativo, todos os pesos w </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l + 1 </font></font></sup> <sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jk</font></font></sub><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aumentar√° durante a descida do gradiente. Em outras palavras, todos os pesos associados ao mesmo neur√¥nio aumentam ou diminuem juntos. E isso √© um problema, porque voc√™ pode precisar aumentar alguns pesos enquanto reduz outros. Mas isso pode acontecer apenas se algumas ativa√ß√µes de entrada tiverem sinais diferentes. Isso sugere a necessidade de substituir o sigm√≥ide por outra fun√ß√£o de ativa√ß√£o, por exemplo, tangente hiperb√≥lica, que permite que as ativa√ß√µes sejam positivas e negativas. De fato, como tanh √© sim√©trico em rela√ß√£o a zero, tanh (‚àíz) = ‚àítanh (z), pode-se esperar que, grosso modo, as ativa√ß√µes em camadas ocultas sejam igualmente distribu√≠das entre positivo e negativo. Isso ajudar√° a garantir que n√£o haja vi√©s sistem√°tico nas atualiza√ß√µes das escalas em uma dire√ß√£o ou outra.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu√£o seriamente esse argumento deve ser considerado? Afinal, √© heur√≠stico, n√£o fornece evid√™ncias estritas de que os neur√¥nios tang s√£o superiores aos sigm√≥ides. Talvez os neur√¥nios sigm√≥ides possuam algumas propriedades que compensem esse problema? De fato, em muitos casos, a fun√ß√£o tanh mostrou vantagens m√≠nimas a inexistentes em compara√ß√£o com o sigm√≥ide. Infelizmente, n√£o temos m√©todos simples e implementados rapidamente para verificar qual tipo de neur√¥nio aprender√° mais rapidamente ou se mostrar√° mais eficaz na generaliza√ß√£o de um caso espec√≠fico. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Outra variante de um neur√¥nio sigm√≥ide √© um neur√¥nio linear retificado, ou unidade linear retificada, ReLU. A sa√≠da ReLU com entrada x, o vetor de pesos we deslocamento b √© especificado da seguinte forma:</font></font><br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-307"><span class="MJXp-mtable" id="MJXp-Span-308"><span><span class="MJXp-mlabeledtr" id="MJXp-Span-309" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-310" style="text-align: center;"><span class="MJXp-mo" id="MJXp-Span-311" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">max </font></font></span><span class="MJXp-mo" id="MJXp-Span-312" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mn" id="MJXp-Span-313"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 </font></font></span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mo" id="MJXp-Span-316" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ãÖ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-13"> \max(0, w \cdot x+b) \tag{112} </script></p><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A fun√ß√£o de corre√ß√£o gr√°fica max (0, z) √© assim: </font></font><br><br><img src="https://habrastorage.org/webt/tu/1x/uv/tu1xuvrfyle3eismzxadvwjzjqq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esses neur√¥nios, obviamente, s√£o muito diferentes dos neur√¥nios sigmoides e tang. </font><font style="vertical-align: inherit;">No entanto, eles s√£o semelhantes, pois tamb√©m podem ser usados ‚Äã‚Äãpara calcular qualquer fun√ß√£o e podem ser treinados usando propaga√ß√£o de retorno e descida de gradiente estoc√°stico. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quando devo usar ReLU em vez de neur√¥nios sigm√≥ides ou tang? </font><font style="vertical-align: inherit;">Em trabalhos recentes sobre reconhecimento de imagem ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) Foram encontradas s√©rias vantagens de usar o ReLU em quase toda a rede. No entanto, como nos neur√¥nios tang, ainda n√£o temos uma compreens√£o realmente profunda de quando exatamente quais ReLUs ser√£o prefer√≠veis e por qu√™. Para ter uma id√©ia de alguns problemas, lembre-se de que os neur√¥nios sigm√≥ides param de aprender quando saturados, ou seja, quando a sa√≠da √© pr√≥xima de 0 ou 1. Como vimos muitas vezes neste cap√≠tulo, o problema √© que os membros de œÉ reduzem o gradiente isso atrasa o aprendizado. Os neur√¥nios Tang sofrem de dificuldades semelhantes na satura√ß√£o. Ao mesmo tempo, um aumento na entrada ponderada na ReLU nunca a saturar√°, portanto, uma desacelera√ß√£o correspondente no treinamento n√£o ocorrer√°. Por outro lado, quando a entrada ponderada na ReLU √© negativa, o gradiente desaparece e o neur√¥nio deixa de aprender.Este √© apenas um dos muitos problemas que tornam pouco trivial entender quando e como as ReLUs se comportam melhor do que os neur√¥nios sigm√≥ides ou tang.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu pintei um quadro de incerteza, enfatizando que ainda n√£o temos uma teoria s√≥lida da escolha das fun√ß√µes de ativa√ß√£o. De fato, esse problema √© ainda mais complicado do que eu descrevi, uma vez que existem infinitas fun√ß√µes de ativa√ß√£o poss√≠veis. Qual deles nos dar√° a rede de aprendizado mais r√°pido? Qual dar√° a maior precis√£o nos testes? Estou surpreso com o n√∫mero de estudos realmente aprofundados e sistem√°ticos sobre essas quest√µes. Idealmente, devemos ter uma teoria que nos diga em detalhes como escolher (e possivelmente mudar rapidamente) nossas fun√ß√µes de ativa√ß√£o. Por outro lado, n√£o devemos ser impedidos pela falta de uma teoria completa! J√° temos ferramentas poderosas e, com a ajuda deles, podemos alcan√ßar um progresso significativo. At√© o final do livro, usarei os neur√¥nios sigm√≥ides como os principais,pois eles funcionam bem e d√£o ilustra√ß√µes concretas de id√©ias-chave relacionadas √† Assembl√©ia Nacional. Mas lembre-se de que as mesmas id√©ias podem ser aplicadas a outros neur√¥nios, e essas op√ß√µes t√™m suas vantagens.</font></font><br><br><h3>     </h3><br><blockquote> :          ,      ,   ?         ? <br><br> :   ,      .          ,     .    .      :         ,     ,     ? <br><br> ‚Äî         </blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma vez em uma confer√™ncia sobre o b√°sico da mec√¢nica qu√¢ntica, notei o que parecia ser um h√°bito engra√ßado da fala: no final do relat√≥rio, as perguntas da plat√©ia geralmente come√ßavam com a frase: "Eu realmente gosto do seu ponto de vista, mas ..." Os fundamentos qu√¢nticos n√£o s√£o exatamente o meu campo usual, e chamei a aten√ß√£o para esse estilo de fazer perguntas, porque em outras confer√™ncias cient√≠ficas eu praticamente n√£o encontrei para que o questionador demonstrasse simpatia pelo ponto de vista do orador. Naquela √©poca, decidi que a preval√™ncia de tais quest√µes indicava que o progresso nos fundamentos qu√¢nticos era bastante alcan√ßado e que as pessoas estavam apenas come√ßando a ganhar impulso. Mais tarde, percebi que essa avalia√ß√£o era muito dura. Os oradores lutaram com alguns dos problemas mais dif√≠ceis que as mentes humanas j√° encontraram. Naturalmente, o progresso foi lento!No entanto, ainda havia valor em ouvir not√≠cias do pensamento das pessoas sobre essa √°rea, mesmo que elas tivessem pouco ou nada.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neste livro, voc√™ deve ter notado um "tique nervoso" semelhante √† frase "Estou muito impressionado". Para explicar o que temos, recorri frequentemente a palavras como "heuristicamente" ou "grosso modo", seguidas de uma explica√ß√£o de um fen√¥meno em particular. Essas hist√≥rias s√£o cr√≠veis, mas as evid√™ncias emp√≠ricas eram muitas vezes bastante superficiais. Se voc√™ estudar a literatura de pesquisa, ver√° que hist√≥rias desse tipo aparecem em muitos trabalhos de pesquisa em redes neurais, geralmente na companhia de uma pequena quantidade de evid√™ncias que as ap√≥iam. Como nos relacionamos com essas hist√≥rias?</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Em muitos campos da ci√™ncia - especialmente onde fen√¥menos simples s√£o considerados - √© poss√≠vel encontrar evid√™ncias muito rigorosas e confi√°veis ‚Äã‚Äãde hip√≥teses muito gerais. Mas na Assembl√©ia Nacional h√° um grande n√∫mero de par√¢metros e hiperpar√¢metros, e h√° rela√ß√µes extremamente complexas entre eles. Em sistemas incrivelmente complexos, √© incrivelmente dif√≠cil fazer declara√ß√µes gerais confi√°veis. A compreens√£o do NS em toda a sua plenitude, como fundamentos qu√¢nticos, testa os limites da mente humana. Freq√ºentemente, temos que dispensar evid√™ncias a favor ou contra v√°rios casos espec√≠ficos espec√≠ficos de uma declara√ß√£o geral. Como resultado, algumas vezes essas declara√ß√µes precisam ser alteradas ou abandonadas, √† medida que novas evid√™ncias surgem.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma das abordagens para essa situa√ß√£o √© considerar que qualquer hist√≥ria heur√≠stica sobre o SN implica em um certo desafio. Por exemplo, considere a explica√ß√£o que citei sobre por que uma exce√ß√£o (abandono) do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trabalho em 2012 funciona.</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: ‚ÄúEssa t√©cnica reduz a complexa adapta√ß√£o articular dos neur√¥nios, j√° que um neur√¥nio n√£o pode contar com a presen√ßa de certos vizinhos. No final, ele precisa aprender caracter√≠sticas mais confi√°veis ‚Äã‚Äãque possam ser √∫teis no trabalho em conjunto com muitos subconjuntos aleat√≥rios diferentes de neur√¥nios. ‚Äù Uma declara√ß√£o rica e provocativa, com base na qual voc√™ pode construir um programa de pesquisa completo, no qual precisar√° descobrir o que √© verdadeiro, onde est√° errado e o que precisa ser esclarecido e alterado. E agora realmente existe uma ind√∫stria inteira de pesquisadores estudando a exce√ß√£o (e suas muitas varia√ß√µes), tentando entender como ela funciona e quais limita√ß√µes ela possui. Assim √© com muitas outras abordagens heur√≠sticas que discutimos. Cada um deles n√£o √© apenas uma explica√ß√£o potencial,mas tamb√©m um desafio para a pesquisa e um entendimento mais detalhado.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obviamente, nenhuma pessoa ter√° tempo suficiente para investigar todas essas explica√ß√µes heur√≠sticas profundamente. Toda a comunidade de pesquisadores de NS levar√° d√©cadas para desenvolver uma teoria realmente poderosa do treinamento em NS com base em evid√™ncias. Isso significa que vale a pena rejeitar as explica√ß√µes heur√≠sticas como frouxas e sem evid√™ncias? N√£o! Precisamos de uma heur√≠stica que inspire nosso pensamento. Isso √© semelhante √† era das grandes descobertas geogr√°ficas: os primeiros estudiosos frequentemente agiam (e faziam descobertas) com base em cren√ßas que eram equivocadas de maneira s√©ria. Mais tarde, corrigimos esses erros, reabastecendo nosso conhecimento geogr√°fico. Quando voc√™ entende algo mal - como os pesquisadores entendem a geografia e como hoje entendemos o NS - √© mais importante estudar corajosamente o desconhecido,do que estar escrupulosamente certo a cada passo do seu racioc√≠nio. Portanto, voc√™ deve considerar essas hist√≥rias como instru√ß√µes √∫teis sobre como refletir sobre os NSs, mantendo uma consci√™ncia saud√°vel de suas limita√ß√µes e monitorando cuidadosamente a confiabilidade das evid√™ncias em cada caso. Em outras palavras, precisamos de boas hist√≥rias para motiva√ß√£o e inspira√ß√£o e investiga√ß√µes minuciosas e escrupulosas para revelar fatos reais.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt460711/">https://habr.com/ru/post/pt460711/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt460699/index.html">Habr Weekly # 10 / Super servi√ßos e passaporte eletr√¥nico, smartphones e russos, "gadgets de espionagem", vida sem sat√©lites</a></li>
<li><a href="../pt460701/index.html">Curso "Start in Data Science": o primeiro passo no trabalho com dados</a></li>
<li><a href="../pt460703/index.html">Oceano Azul de Oportunidade: de zero a 400 mil entrevistas em v√≠deo</a></li>
<li><a href="../pt460707/index.html">Est√° na hora dos desenvolvedores de jogos pararem de ouvir seus f√£s?</a></li>
<li><a href="../pt460709/index.html">Reflex√µes sobre o Agile</a></li>
<li><a href="../pt460713/index.html">Desenvolvimento de aplicativos no SwiftUI. Parte 1: fluxo de dados e Redux</a></li>
<li><a href="../pt460717/index.html">Not√≠cias da semana: Testes de rede via sat√©lite OneWeb, interfaces neurais da m√°scara Ilona e dispositivos eletr√¥nicos sem espionagem</a></li>
<li><a href="../pt460719/index.html">Classes da Funda√ß√£o da Ind√∫stria. Breve introdu√ß√£o</a></li>
<li><a href="../pt460723/index.html">NVIDIA Jetson Nano: testes e primeiras impress√µes</a></li>
<li><a href="../pt460725/index.html">C√≥digo de auto-documenta√ß√£o √© (geralmente) um absurdo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>