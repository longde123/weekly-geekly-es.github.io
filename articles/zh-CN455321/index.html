<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚴🏽 🚾 🚣🏼 自己动手做家庭自动化 👉🏼 🚣🏿 👃</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我的文章对那些只考虑这种系统的人有用，将帮助他们决定是否自己做，并且主要关注集体农场爱好者。 最初，我写的是“自动化”而不是智能家居，因为在此阶段，我的控制系统中没有智能功能，现在的任务是收集数据和管理设备。 将来，当算法使房屋变得智能时，一切都会改变。 从我的角度来看，如果您可以通过智能手机打开灯...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>自己动手做家庭自动化</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455321/"> 我的文章对那些只考虑这种系统的人有用，将帮助他们决定是否自己做，并且主要关注集体农场爱好者。 最初，我写的是“自动化”而不是智能家居，因为在此阶段，我的控制系统中没有智能功能，现在的任务是收集数据和管理设备。 将来，当算法使房屋变得智能时，一切都会改变。 从我的角度来看，如果您可以通过智能手机打开灯，则这不会使您的家变得智能。 当您编写了有助于您的脚本，使您可以更轻松地控制自己的房屋并使日常工作对您不可见时，它就会变得很聪明。 例如，当照明水平低于阈值时打开门廊上的灯，并在两晚关闭它;如果今天他们承诺降水的可能性超过60％，则不要打开浇水;如果房间中有活动，请打开楼梯的灯，等等。 而且只有在这种情况下，他才变得“聪明”。 <br><a name="habracut"></a><br> 一点歌词。 长期以来，我一直想在乡下拥有一所房子，因为建造不仅要花大笔的财务费用，而且要花大量的个人时间，这可以用于您最喜欢的爱好，家庭。 幸运的是，我拥有的其中之一就是开发各种不必要的设备。 在最初的其他地方，我自己决定这可能很有趣，然后选择一个站点，我开始制定计划。 首先，当然，我不得不花很多时间来解决与建筑本身有关的问题，例如项目，寻找建造者以及其他各种麻烦。 但是，当盒子准备好了时，就该考虑家庭自动化系统了，这是我喜欢的以及我想做的事情，好吧，对于程序员来说，从沙发上关掉浴室的灯是很奇怪的。 <br><br> 研究开始于市场上的东西，以及您可以购买和预耕的东西。 事实证明，市场上有很多解决方案，但他们却缺乏，因此他们没有一个可以使我满意的整体解决方案（当然，没有解决方案，但是成本是20吨。我不满意） 。 例如，施耐德（Schneider）有一个基于KNX的好的解决方案，您可以在其上构建照明，卷帘和通风控制，但是几乎不可能将除标准元素之外的任何其他东西集成到系统中，此外您还可以忘记Web界面和google控制以及一般的脚本自动化不用说话 另一方面，市场上有足够的解决方案，既是无线解决方案，又是与Google的朋友，而且应用程序已经为他们准备好了，但是它们有很多细微差别，将此类解决方案推向了后台。 例如，从常规开关和应用程序同时控制照明的复杂性通常根本是不可能的，或者如果有可能实现直通开关有问题，但我想拥有一栋房屋，万一发生故障，一切都可以在没有智能房屋的情况下正常工作。 另外，我并不是真的想用一大堆单独的盒子来称重房子，我仍然不明白为什么不应该将运动传感器，一氧化碳和温度放在一个盒子里，即使这样做会花费更多，但我不必用某些设备将整个天花板挂起来，甚至每两年更换一次电池。 <br><br> 总的来说，我用“ tyzh程序员”一词开始思考我将如何独自承担这项工作以及为此需要什么。 考虑一下系统的不同应用程序后，很明显，在做某事之前，您需要认真思考（这似乎很明显，但是，有时您现在想做某事），因为将布线放到门口并抹上灰泥，是没有回路的。 <br><br> 形成愿望清单后，我得到了以下子系统： <br><br><ul><li> 家庭照明 </li><li> 角色 </li><li> 通风阀控制 </li><li> 室内运动传感器，光线，CO和温度传感器 </li><li> 自动浇水 </li><li> 现场运动传感器 </li><li> 备用电源 </li></ul><br> 最初，我想将所有东西放到购买的设备上，然后以某种方式将它们放到一个系统中，这似乎是时间/财务和系统可靠性的最佳选择。 想法从一个子系统跳到另一个子系统，但是没有为任何一个子系统制定连贯的解决方案，几个月过去了，但是没有解决方案形成，而且建筑本身也分散了人们的注意力，甚至冬天开始了（这是高山滑雪的时候，这是没有的所有妥协，那么情况仍然如此）。 我不得不限制思想的发展，迫使自己自己设计出一个子系统，所有子系统都始于照明。 <br><br> 让我们快速浏览一下。 <br><br>  <b>灯饰</b> 从输入来看，灯光应该同时从开关和控制系统（以下称为ACS）工作，此外还应该具有通过开关的能力。 为此，自行火炮必须至少知道现在是否开启。 有几种实现方法的想法，但我决定在此图上-一个按钮开关-一个脉冲继电器（Elko MR-41）-一个离散输出-一个离散输入。 离散输出与按钮开关并联，NO继电器触点用于灯泡，NC触点用于数字输入以获取状态。 <br><br><img src="https://habrastorage.org/webt/4s/ol/rt/4solrt7wpzujpwuohnj0kbhiapg.jpeg" alt="图片"><br><br> 从这一切开始，到每个照明点，都应由开关和自行式火炮控制，每个开关都应从屏蔽罩引出自己的电线，类似于开关。 素描本中的接线图确实有助于理解灾难的规模，那里有很多电线，但这不应该吓到选择智能家居的人。 我建议不要偷懒，并且不必在草图中仍然采用此方案，将来即使需要挂画多年，这项工作仍将为您节省大量时间和帮助，并且您会怀疑那里是否有电线。 <br><br>  <b>角色</b> 与光的区别在于，在这种情况下，负载不是灯泡，而是电动机，这意味着所有的负载。 就像照明一样，我希望可以通过机械开关和控制系统进行控制。 因此，该电路的结果如下：离散输出-接触器，并为每个旋转方向并联一个按钮开关。 <br><br><img src="https://habrastorage.org/webt/cn/lw/gz/cnlwgz6b_awwpn_xc9k6fmwetvq.jpeg" alt="图片"><br><br>  <b>通风</b> 。 一切都很简单，我把它交给了SPG，并且没有提供任何其他控制，我几乎从来不想打开/关闭通风管道，而并非来自应用程序。 因此，该电路-两个离散输出-一个带有ebay的简单Belimo LM24-T驱动器，价格为25美元，无反馈。 <br><br><img src="https://habrastorage.org/webt/uw/m3/we/uwm3we4zdmxrbjysqscqy9zkz9s.jpeg" alt="图片"><br><br> 这是安装在通风阀上的执行器的外观： <br><br><img src="https://habrastorage.org/webt/xn/6j/nr/xn6jnrccrecwbf5mzfs9w7uc1pi.jpeg" alt="图片"><br><br> 室内的<b>运动传感器</b> ，光线传感器，CO和温度。 现在市场上有很多这样的设备，但是所有带有专有接口并将它们连接到自己的本地系统的设备都相当困难，并且上述问题是它们试图将每个传感器作为单独的设备出售。 我想看到的最后一件事是天花板上散落着不同的设备，但是您如何看待所有这些设备都需要更换电池，而且变得很恐怖。 此外，制造商总是有可能会关闭其设备的打开的api，并迫使您仅使用您的应用程序，因为Google最近从Nest那里收到了该消息，整个系统将崩溃。 因此，我在AVR上制作了设备，称其为“传感器标签”，并包装了我需要的一切：带有数字灵敏度调整功能的运动传感器，光，温度，一氧化碳传感器，受控背光，ESP8266，带电隔离的RS485、24V电源。 原来这里是这样一种设备，但实际上它需要专门撰写一篇文章，而在本篇文章中并没有真正关注它。 <br><br><img src="https://habrastorage.org/webt/i-/1g/lh/i-1glhkzoebro6vg4837gtektes.jpeg" alt="图片"><br><br><img src="https://habrastorage.org/webt/_5/fb/xe/_5fbxerlagblk6xo52ajmcmqpki.jpeg" alt="图片"><br><br>  <b>自动浇水。</b> 看来这很复杂，应该有一个最简单的离散输出类型的设备-24V电磁铁。 但事实证明，所有灌溉阀均为24V交流电。 因此，我不得不制作一个带有24V变压器和一个继电器单元的单独的单元，该单元将24V DC切换为24V DC。 <br><br><img src="https://habrastorage.org/webt/z1/ei/hw/z1eihww133uzr9cde3zzboyeu1e.jpeg" alt="图片"><br><br> 现场的<b>运动传感器</b> 。 对于安全传感器，输出为常开和常闭触点，因此一切都很简单，输入离散，但不要忘了避雷器（避雷器选件适用于配线架）。 <br><br>  <b>储备食物。</b> 最初，这是没有计划的，但是随着时间的流逝，很明显，市外的断电不是紧急状态，而是一种非常普遍的现象。 而且，尽管我相信智能家居系统的设计应使其可以随时打开/关闭而不会给她和房子带来麻烦，但我并没有拒绝备用电源。 确定已经拥有24V传感器传感器，24V驱动器后，我将使用24V的所有ACS电源。 事实证明，它能正常工作的有很多电源，电池和电池。 <br><br><img src="https://habrastorage.org/webt/aj/66/9e/aj669ecgtfoc3tqc31zolwqmbk0.jpeg" alt="图片"><br><br> 形成硬件解决方案后，似乎可以在一个完整的系统中进行电源单元的安装工作：铺设电源线，连接电源屏蔽罩和连接低压。 原来，可怕的是，有很多电线，但是从一个周末到另一个周末，它变得越来越漂亮，结果，一个月后一切都正常了。 一个好处是有机会为建筑商制作一个临时控制面板，用于灯光和卷帘。 <br><br><img src="https://habrastorage.org/webt/n0/36/wk/n036wkfwgo8yg0usj3xcxtdnv0o.jpeg" alt="图片"><br><br><img src="https://habrastorage.org/webt/lb/tt/qk/lbttqktzgqwrf-pzk3-zff4wzl0.jpeg" alt="图片"><br><br><img src="https://habrastorage.org/webt/lj/xc/ee/ljxcee-0sxtapkxrbvjz9gj3hcw.jpeg" alt="图片"><br><br><img src="https://habrastorage.org/webt/la/3e/ir/la3eir29gc-rtqiqradhhyancf0.jpeg" alt="图片"><br><br>  <b>下一步是计划带有控制模块的仪表板。</b> <br><br> 系统拓扑： <br><br><img src="https://habrastorage.org/webt/en/mn/ez/enmnezvjyvg0l3fj2wt1euebbj8.jpeg" alt="图片"><br><br>  <u>DI / DO模块。</u> 有必要估计系统的拓扑，其中包括哪些模块，在哪些控制器上起作用。 有许多实施选项，如果可行，所有选项都是正确的。 展望未来，我会说我选择了购买的DI / DO模块系统，该系统控制Beaglebone black上的控制器和Raspberry Pi上的Web服务器。 接下来，您需要计算所有离散输入/输出及其类型。 因为 没有开发DI / DO模块的愿望，我只是看着已经准备好以合理价格购买的市场。 我停在Aries模块上，原则上，它们满足了我的所有管理需求： <br><br><ol><li>  MV110-8DF，作为220V信号的离散输入模块。 </li><li>  110-16，用于控制照明，卷帘，通风和灌溉阀。 </li><li>  MV110-16DN作为来自街道运动传感器的信号的离散输入模块。 </li></ol><br> 这些模块原则上是通过行业标准通过RS485 ModBus接口连接到系统的，因此其实现应该没有任何困难（您可以自己编写对主要命令的支持，也可以使用现成的库）。 <br><br>  <u>控制者</u> 为了与位于每个房间的“ sensorortag”模块以及仪表板上的Aries模块进行通信，我需要一个控制器，该控制器可以通过RS485接口对其进行询问，并具有以太网与服务器进行通信。 我考虑了使用Wiren Board的选项，但它们几乎没有RS485端口，我想自己做控制器。 该控制器想单独发表一篇文章，因此在这里我们可以提到它是采用Beaglebone黑色制造的，具有3个电隔离的RS-485端口和24V电源。 <br><br>  Beaglebone black控制器的系统是基于Buildroot构建的，并处于运行构建的状态-我们获得了SD卡的最终映像。  Beaglebone black软件包括：通信核心，MQTT网关和Mosquitto服务器。 通信核心轮询RS-485端口，形成离散点和模拟点的内部表。  MQTT网关将控制器点转换为MQTT主题的值，并将它们传递给Mosquitto服务器。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此链接上的所有内容均可用</a> 。 <br><br> 控制面板和信号模拟器（照明，百叶窗和通风）： <br><br><img src="https://habrastorage.org/webt/nc/os/_v/ncos_v2uht5ke4pt2wct_74flgg.jpeg" alt="图片"><br><br><img src="https://habrastorage.org/webt/gy/hu/va/gyhuvapp-asvex_g2awlpgs3bbo.jpeg" alt="图片"><br><br>  <u>Raspberry Pi软件</u>是家庭助理。 我对这个系统很满意，它非常简单，支持许多现成的设备，并允许您非常灵活地用python编写插件。 例如，在几周内，我编写了自己的MQTT插件，用于照明，卷帘，警报和各种类型的传感器（照明，CO，运动，温度）和几种自动化类型，所有这些都非常灵活，最重要的是进入系统的门槛很低。 家庭助理还支持与Google Home和Alexa集成。 您可以稍微折磨自己并自己进行配置，也可以付费订阅他们的服务（每月5美元），然后双击Home Assistant和Google Home进行同步。 作为奖励，我们可以使用英语进行语音控制，但承诺几乎会支持俄语。 看起来像这样： <br><br><img src="https://habrastorage.org/webt/tf/jw/ud/tfjwudo8if5dj_n8ts3j9lm8vm4.png" alt="图片"><br><br> 在本文中，我想提供系统的概述和特定实现的示例，并且我不假装自己选择的决策的正确性。 有人可能会说这是房子的通灵物，但有人可能会受益。 通常，不要害怕它会令人兴奋，只需将所有内容合理地构造并开始。 所有想法不会立即出现，而是会在实施过程中出现，因此您将不得不更改，而且不止一次。 接下来，我计划写控制器和传感器标签的开发，作为程序员，这比这里描述的所有内容都有趣。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN455321/">https://habr.com/ru/post/zh-CN455321/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN455310/index.html">对旁路通道的攻击：现在，不仅PC受到攻击，而且智能手机也受到攻击（分析审查）</a></li>
<li><a href="../zh-CN455314/index.html">什么是服务网络</a></li>
<li><a href="../zh-CN455316/index.html">我们修改了蓝牙堆栈，以改善没有编解码器AAC，aptX和LDAC的耳机上的声音</a></li>
<li><a href="../zh-CN455318/index.html">3D打印的应用领域是什么？</a></li>
<li><a href="../zh-CN455319/index.html">工作流程3D艺术家。 如何不淹没大量信息。 第一部分</a></li>
<li><a href="../zh-CN455325/index.html">将桌面应用程序移植到.NET Core</a></li>
<li><a href="../zh-CN455329/index.html">Azure IoT Edge工具扩展（预览）公告</a></li>
<li><a href="../zh-CN455331/index.html">计算机如何学习如何出色地识别图像</a></li>
<li><a href="../zh-CN455333/index.html">谁将Python放入Windows 10 May 2019更新中？</a></li>
<li><a href="../zh-CN455335/index.html">小资小喜乐＃3：诗歌</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>