<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔫 🐌 🏣 V8: satu tahun dengan Spectre 🔗 🤳🏽 🤲🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada 3 Januari 2018, Google Project Zero dan lainnya mengungkapkan tiga kerentanan pertama dari kelas baru yang memengaruhi prosesor eksekusi spekulat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>V8: satu tahun dengan Spectre</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449546/"> Pada 3 Januari 2018, Google Project Zero dan lainnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mengungkapkan</a> tiga kerentanan pertama dari kelas baru yang memengaruhi prosesor eksekusi spekulatif.  Mereka disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Specter</a> (1 dan 2) dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Meltdown</a> .  Dengan menggunakan mekanisme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">eksekusi</a> CPU <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">spekulatif</a> , penyerang dapat melewati sementara pemeriksaan keamanan perangkat lunak eksplisit dan implisit yang mencegah program membaca data yang tidak dapat diakses dalam memori.  Sementara eksekusi spekulatif dirancang sebagai bagian dari arsitektur mikro, tidak terlihat di tingkat arsitektur, program yang dirancang dengan cermat dapat membaca informasi yang tidak dapat diakses dalam blok spekulatif dan mengungkapkannya melalui saluran samping, seperti waktu pelaksanaan fragmen program. <br><br>  Ketika ditunjukkan bahwa serangan Specter dimungkinkan menggunakan JavaScript, tim V8 ikut serta dalam menyelesaikan masalah.  Kami membentuk tim tanggap darurat dan bekerja sama dengan tim Google lainnya, mitra browser kami yang lain, dan mitra perangkat keras.  Bersama mereka, kami secara proaktif melakukan penelitian ofensif (membangun modul penyerang untuk membuktikan konsep) dan defensif (memitigasi potensi serangan). <br><a name="habracut"></a><br>  Serangan Spectre terdiri dari dua bagian: <br><br><ul><li>  <i>Kebocoran data yang tidak dapat diakses ke kondisi laten CPU</i> .  Semua serangan Spectre yang dikenal menggunakan spekulasi untuk mentransfer bit data yang tidak dapat diakses ke cache CPU. <br></li><li>  <i>Mengambil status tersembunyi</i> untuk memulihkan data yang tidak dapat diakses.  Untuk ini, seorang penyerang membutuhkan jam tangan yang cukup akurat.  (Akurasi mengejutkan rendah, terutama dengan metode seperti edge thresholding - membandingkan dengan ambang batas sepanjang garis yang dipilih). </li></ul><br>  Secara teoritis, itu akan cukup untuk memblokir salah satu dari dua komponen serangan.  Karena kami tidak tahu cara memblokirnya, kami mengembangkan dan menyebarkan mitigasi yang secara signifikan mengurangi jumlah informasi yang bocor ke dalam cache CPU dan mitigasi yang membuatnya sulit untuk memulihkan keadaan tersembunyi. <br><br><h1>  Timer presisi tinggi </h1><br>  Perubahan negara kecil yang tersisa setelah eksekusi spekulatif menghasilkan perbedaan temporal yang kecil, hampir tidak mungkin kecil, dari urutan sepersejuta detik.  Untuk secara langsung mendeteksi perbedaan seperti itu, penyerang membutuhkan pengatur waktu presisi tinggi.  Prosesor menawarkan penghitung waktu seperti itu, tetapi platform web tidak mengaturnya.  Pengatur waktu paling akurat pada platform web <code>performance.now()</code> memiliki resolusi beberapa mikrodetik, yang awalnya dianggap tidak cocok untuk tujuan ini.  Namun, dua tahun lalu, sebuah kelompok penelitian yang mengkhususkan diri dalam serangan mikroarsitektur menerbitkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sebuah artikel</a> tentang penghitung waktu pada platform web.  Mereka menyimpulkan bahwa memori bersama yang dapat berubah secara simultan dan berbagai metode pemulihan resolusi memungkinkan pembuatan timer dengan resolusi lebih tinggi, hingga nanosecond.  Penghitung waktu semacam itu cukup akurat untuk mendeteksi setiap klik dan kesalahan cache L1.  Dialah yang biasanya digunakan untuk menangkap informasi dalam serangan Specter. <br><br><h1>  Perlindungan timer </h1><br>  Untuk mengganggu kemampuan mendeteksi perbedaan kecil dalam waktu, pengembang browser telah memilih pendekatan multilateral.  Di semua browser, resolusi <code>performance.now()</code> berkurang (di Chrome dari 5 mikrodetik menjadi 100) dan jitter acak diperkenalkan untuk mencegah pemulihan resolusi.  Setelah berkonsultasi antara pengembang semua browser, kami memutuskan bersama untuk mengambil langkah yang belum pernah terjadi sebelumnya: segera dan secara surut menonaktifkan <code>SharedArrayBuffer</code> API di semua browser untuk mencegah pembuatan timer nanosecond. <br><br><h1>  Keuntungan </h1><br>  Pada awal penelitian ofensif kami, menjadi jelas bahwa pengurangan waktu saja tidak cukup.  Salah satu alasannya adalah penyerang dapat menjalankan kodenya berulang kali sehingga perbedaan waktu kumulatif lebih dari satu hit atau cache miss.  Kami dapat membuat "gadget" andal yang menggunakan banyak baris cache sekaligus, hingga seluruh kapasitas cache, yang memberikan perbedaan waktu hingga 600 mikrodetik.  Kemudian, kami menemukan metode amplifikasi acak yang tidak dibatasi oleh kapasitas cache.  Metode amplifikasi semacam itu didasarkan pada upaya berulang-ulang untuk membaca data rahasia. <br><br><h1>  Perlindungan JIT </h1><br>  Untuk membaca data yang tidak dapat diakses menggunakan Specter, seorang penyerang memaksa CPU untuk secara spekulatif mengeksekusi kode yang membaca data yang biasanya tidak dapat diakses dan menempatkannya dalam cache.  Perlindungan dapat dipertimbangkan dari dua sisi: <br><br><ol><li>  Cegah eksekusi kode spekulatif. <br></li><li>  Pencegahan membaca data yang tidak dapat diakses dari pipa spekulatif. </li></ol><br>  Kami bereksperimen dengan opsi pertama dengan memasukkan instruksi yang direkomendasikan untuk mencegah spekulasi, seperti Intel <code>LFENCE</code> dari setiap cabang kondisional kritis dan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">retpolin</a> untuk cabang tidak langsung.  Sayangnya, mitigasi berat seperti itu secara signifikan mengurangi produktivitas (pelambatan 2-3x pada benchmark Octane).  Sebaliknya, kami mengambil pendekatan kedua dengan memasukkan urutan mitigasi yang mencegah data sensitif dibaca karena spekulasi yang tidak tepat.  Biarkan saya menggambarkan teknik dengan potongan kode berikut: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (condition) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a[i]; }</code> </pre> <br>  Untuk kesederhanaan, kita asumsikan bahwa kondisi <code>0</code> atau <code>1</code> .  Kode di atas rentan jika CPU secara spekulatif membaca dari <code>a[i]</code> ketika <code>i</code> luar jangkauan, mendapatkan akses ke data yang biasanya tidak dapat diakses.  Pengamatan penting adalah bahwa dalam kasus ini, spekulasi mencoba membaca <code>a[i]</code> ketika kondisinya <code>0</code> .  Mitigasi kami menulis ulang program ini sehingga berperilaku persis sama dengan program asli, tetapi tidak membiarkan data yang dimuat secara spekulatif bocor. <br><br>  Kami memesan satu register CPU, yang kami sebut "racun", untuk melacak apakah kode dieksekusi di cabang yang disalahtafsirkan.  Register racun didukung di semua cabang dan panggilan kode yang dihasilkan, sehingga cabang yang diartikan salah menyebabkan register racun menjadi <code>0</code> .  Lalu kami mengukur semua akses memori sehingga mereka tanpa syarat menutupi semua hasil unduhan dengan nilai register racun saat ini.  Ini tidak mencegah prosesor memprediksi (atau salah menafsirkan) cabang, tetapi merusak informasi (berpotensi di luar batas) dari nilai yang dimuat karena cabang ditafsirkan salah.  Kode alat ditunjukkan di bawah ini ( <code>a</code> adalah array angka). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> poison = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">// … if (condition) { poison *= condition; return a[i] * poison; }</span></span></code> </pre> <br>  Kode tambahan tidak mempengaruhi perilaku normal (ditentukan oleh arsitektur) program.  Ini hanya mempengaruhi keadaan mikro-arsitektur ketika bekerja pada CPU dengan eksekusi spekulatif.  Jika Anda memasukkan program pada level kode sumber, optimisasi lanjutan dalam kompiler modern dapat menghapus instrumentasi tersebut.  Di V8, kami mencegah kompiler menghapus mitigasi dengan memasukkannya pada tahap kompilasi yang sangat terlambat. <br><br>  Kami juga menggunakan teknik keracunan ini untuk mencegah kebocoran dari cabang tidak langsung dalam loop bytecode interpreter dan dalam urutan panggilan fungsi JavaScript.  Dalam penerjemah, kami menetapkan racun ke <code>0</code> jika bytecode handler (mis., Urutan kode mesin yang mengartikan satu bytecode) tidak cocok dengan bytecode saat ini.  Untuk panggilan JavaScript, kami meneruskan fungsi target sebagai parameter (dalam register) dan mengatur racun ke <code>0</code> di awal setiap fungsi jika fungsi target yang masuk tidak cocok dengan fungsi saat ini.  Dengan pelunakan ini, kita melihat perlambatan kurang dari 20% di benchmark Octane. <br><br>  Mitigasi untuk WebAssembly lebih sederhana, karena pemeriksaan keamanan utama adalah untuk memastikan bahwa akses memori berada dalam batas-batas.  Untuk platform 32-bit, sebagai tambahan pada pemeriksaan batas yang biasa, kami mengisi semua memori ke kekuatan dua berikutnya dan tanpa syarat menutupi bit atas dari indeks memori pengguna.  Platform 64-bit tidak memerlukan mitigasi seperti itu, karena implementasinya menggunakan perlindungan memori virtual untuk pemeriksaan perbatasan.  Kami bereksperimen dengan mengkompilasi pernyataan switch / case ke dalam kode pencarian biner alih-alih menggunakan cabang tidak langsung yang rentan, tetapi terlalu mahal untuk beberapa beban kerja.  Panggilan tidak langsung dilindungi oleh retpolin. <br><br><h1>  Perlindungan Perangkat Lunak - Tidak Dapat Diandalkan </h1><br>  Untungnya atau sayangnya, penelitian ofensif kami berkembang jauh lebih cepat daripada defensif, dan kami dengan cepat menemukan tidak mungkin untuk secara terprogram mengurangi semua kemungkinan kebocoran selama serangan Specter.  Ada beberapa alasan untuk ini.  Pertama, upaya rekayasa untuk memerangi Specter tidak proporsional dengan tingkat ancaman.  Di V8, kami menghadapi banyak risiko keamanan lain yang jauh lebih buruk, dari membaca langsung di luar perbatasan karena bug umum (yang lebih cepat dan lebih mudah daripada Spectre), menulis di luar perbatasan (ini tidak mungkin dengan Specter dan lebih buruk) dan potensi jarak jauh eksekusi kode (mustahil dengan Spectre dan jauh, jauh lebih buruk).  Kedua, langkah-langkah mitigasi yang semakin canggih yang kami kembangkan dan implementasikan membawa kompleksitas yang signifikan, yang merupakan kewajiban teknis dan benar-benar dapat meningkatkan permukaan serangan dan overhead kinerja.  Ketiga, menguji dan mempertahankan mitigasi kebocoran mikroarsitektur bahkan lebih sulit daripada merancang sendiri gadget untuk serangan, karena sulit untuk memastikan bahwa mitigasi terus bekerja dengan cara yang mereka rancang.  Setidaknya sekali, mitigasi penting secara efektif dibatalkan oleh optimisasi kompiler kemudian.  Keempat, kami menemukan bahwa secara efektif mengurangi beberapa opsi Specter, terutama opsi 4, tidak mungkin dilakukan dalam perangkat lunak, bahkan setelah upaya heroik dari mitra Apple kami untuk menangani masalah dalam kompiler JIT mereka. <br><br><h1>  Isolasi Situs </h1><br>  Penelitian kami mengarah pada kesimpulan: pada prinsipnya, kode yang tidak dipercaya dapat membaca seluruh ruang alamat dari suatu proses menggunakan Spectre dan saluran samping.  Mitigasi perangkat lunak mengurangi efektivitas banyak gadget potensial, tetapi tidak efektif atau komprehensif.  Satu-satunya ukuran yang efektif adalah memindahkan data sensitif di luar ruang alamat proses.  Untungnya, Chrome telah mencoba selama bertahun-tahun untuk memisahkan situs ke dalam proses yang berbeda untuk mengurangi permukaan serangan karena kerentanan umum.  Investasi ini terbayar, dan pada Mei 2018 kami membawa ke tahap kesiapan dan memperluas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">isolasi situs</a> pada jumlah platform maksimum.  Dengan demikian, model keamanan Chrome tidak lagi menganggap privasi bahasa selama proses render. <br><br>  Spectre telah datang jauh dan menekankan manfaat kolaborasi pengembang dalam industri dan akademisi.  Sejauh ini, topi putih lebih unggul dari yang hitam.  Kami masih belum tahu tentang satu serangan nyata, dengan pengecualian para peneliti yang ingin tahu dan peneliti profesional mengembangkan gadget untuk membuktikan konsep tersebut.  Varian baru dari kerentanan ini terus muncul dan ini akan berlanjut untuk beberapa waktu.  Kami terus memantau ancaman ini dan menanggapinya dengan serius. <br><br>  Seperti banyak programmer, kami juga berpikir bahwa bahasa yang aman memberikan batas yang tepat untuk abstraksi, mencegah program yang diketik dengan baik dari membaca memori sewenang-wenang.  Sangat menyedihkan bahwa ini ternyata menjadi kesalahan - jaminan ini tidak sesuai dengan peralatan saat ini.  Tentu saja, kami masih percaya bahwa bahasa yang aman memiliki lebih banyak keunggulan teknik, dan masa depan ada pada mereka, tapi ... pada peralatan saat ini mereka sedikit bocor. <br><br>  Pembaca yang tertarik dapat mempelajari topik ini lebih dalam dan mendapatkan informasi lebih rinci dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel ilmiah</a> kami. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id449546/">https://habr.com/ru/post/id449546/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id449536/index.html">iOS Digest No. 4 (5 April - 26 April)</a></li>
<li><a href="../id449538/index.html">Memindahkan portal web: dari monolit ke arsitektur layanan mikro</a></li>
<li><a href="../id449540/index.html">Efek doodle shader</a></li>
<li><a href="../id449542/index.html">Obat bergerak ke web, ruang obrolan, dan aplikasi seluler. Percakapan dengan BestDoctor</a></li>
<li><a href="../id449544/index.html">Dunia modern bersandar pada API</a></li>
<li><a href="../id449548/index.html">Pusat Data Luar Angkasa. Laporan video dari peluncuran</a></li>
<li><a href="../id449552/index.html">Enkripsi asimetris dalam praktiknya</a></li>
<li><a href="../id449554/index.html">Mozilla akan menggunakan WASI untuk semua perangkat, komputer, dan sistem operasi</a></li>
<li><a href="../id449556/index.html">Blazor pindah dari percobaan ke Pratinjau</a></li>
<li><a href="../id449558/index.html">Pembelajaran mesin untuk semua orang yang belajar matematika di kelas delapan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>