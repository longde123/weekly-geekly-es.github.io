<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📭 🤲🏻 👨‍🚀 Metaprogrammierung in JavaScript und TypeScript 🏂🏿 🔣 🐃</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prolog 


 Ich möchte Ihrem Gericht eine Reihe von Mini-Statuen vorstellen, die die Techniken und Grundlagen der Metaprogrammierung beschreiben. Ich w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Metaprogrammierung in JavaScript und TypeScript</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450540/"><h4>  Prolog </h4><br><p>  <i>Ich möchte Ihrem Gericht eine Reihe von Mini-Statuen vorstellen, die die Techniken und Grundlagen der Metaprogrammierung beschreiben.</i>  <i>Ich werde hauptsächlich über die Verwendung bestimmter Techniken in JavaScript oder in TypeScript schreiben</i> <i><br></i>  <i>Dies ist der erste (und hoffentlich nicht der letzte) Artikel in der Reihe.</i> </p><br><h4>  Was ist Metaprogrammierung? </h4><br><blockquote>  <b>Metaprogrammierung</b> ist eine Programmiertechnik, bei der Computerprogramme andere Programme als ihre Daten behandeln können.  Dies bedeutet, dass ein Programm so gestaltet werden kann, dass es andere Programme liest, generiert, analysiert oder transformiert und sich sogar während der Ausführung selbst ändert.  In einigen Fällen <b>können Programmierer so die Anzahl der Codezeilen minimieren, um eine Lösung auszudrücken, was wiederum die Entwicklungszeit verkürzt</b> . </blockquote><p>  Eine ziemlich verwirrende Beschreibung, aber der Hauptvorteil der Metaprogrammierung ist verständlich: </p><br><blockquote>  ... können Programmierer so die Anzahl der Codezeilen minimieren, um die Lösung zu implementieren, was wiederum die Entwicklungszeit verkürzt </blockquote><p><img src="https://habrastorage.org/webt/zw/yk/oe/zwykoepkmw_dicgpgzlxsim7dle.jpeg"></p><a name="habracut"></a><br><p> In der Tat hat Metaprogrammierung viel Gesicht und Gestalt.  Und Sie können lange darüber diskutieren, „wo die Metaprogrammierung endet und die Programmierung selbst beginnt“. </p><br><p>  Für mich selbst habe ich folgende Regeln akzeptiert: </p><br><ol><li>  Die Metaprogrammierung befasst sich nicht mit Geschäftslogik, ändert sie nicht und beeinflusst sie in keiner Weise. </li><li>  Wenn Sie den gesamten Metaprogrammiercode entfernen, sollte dies das Programm nicht (radikal) beeinflussen. </li></ol><br><p>  In JavaScript ist die Metaprogrammierung ein relativ neuer Trend, dessen Basisbaustein der Deskriptor ist. </p><br><h4>  JavaScript-Deskriptor </h4><br><p>  Deskriptor ist eine Art Beschreibung (Metainformation) einer bestimmten Eigenschaft oder Methode in einem Objekt. </p><br><p>  Das Verstehen und ordnungsgemäße Bearbeiten dieses Objekts ( <i>Deskriptors</i> ) ermöglicht viel mehr als nur das Erstellen und Ändern von Methoden oder Eigenschaften in Objekten. <br>  Auch der <i>Deskriptor</i> hilft beim Verständnis der Arbeit mit Dekorateuren (mehr dazu im nächsten Artikel). </p><br><p>  Stellen Sie sich zur Klarheit vor, unser Objekt ist eine Beschreibung der Wohnung. <br>  Wir beschreiben das Objekt unserer Wohnung: </p><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> apt = { <span class="hljs-attr"><span class="hljs-attr">floor</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-attr"><span class="hljs-attr">number</span></span>: <span class="hljs-string"><span class="hljs-string">'12B'</span></span>, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-number"><span class="hljs-number">3400</span></span>, <span class="hljs-attr"><span class="hljs-attr">bedRooms</span></span>: <span class="hljs-number"><span class="hljs-number">3.4</span></span>, <span class="hljs-attr"><span class="hljs-attr">bathRooms</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">price</span></span>: <span class="hljs-number"><span class="hljs-number">400000</span></span>, <span class="hljs-attr"><span class="hljs-attr">amenities</span></span>: {...} };</code> </pre> <br><p>  Lassen Sie uns feststellen, welche der Eigenschaften geändert werden können und welche nicht. </p><br><p>  Zum Beispiel kann der Boden oder die Gesamtgröße der Wohnung nicht geändert werden, aber die Anzahl der Zimmer oder Badezimmer ist durchaus möglich. <br>  Wir haben also folgende Anforderung: Machen Sie es in <i>geeigneten</i> Objekten unmöglich, die Eigenschaften zu ändern: <i>Boden</i> und <i>Größe</i> . </p><br><p>  Um dieses Problem zu lösen, benötigen wir nur <i>Deskriptoren für</i> jede dieser Eigenschaften.  Um den <i>Deskriptor</i> <i>abzurufen</i> , verwenden wir die statische Methode <i>getOwnPropertyDescriptor</i> , die zur Klasse <i>Object gehört</i> . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> descriptor = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(todoObject, <span class="hljs-string"><span class="hljs-string">'floor'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(descriptor); <span class="hljs-comment"><span class="hljs-comment">// Output { value: 12, writable: true, enumerable: true, configurable: true }</span></span></code> </pre> <br><p>  Lassen Sie uns der Reihe nach analysieren: <br>  <em>value: any</em> - tatsächlich derselbe Wert, der irgendwann der <em>Etage</em> zugewiesen wurde <br>  <em>beschreibbar: boolean</em> - legt fest, ob der <em>Wert</em> geändert werden soll oder nicht <br>  <em>enumerable: boolean</em> - bestimmt, ob die <em>Etageeigenschaft</em> aufgelistet werden kann oder nicht - (dazu später mehr). <br>  <em>konfigurierbar: boolean</em> - Definiert die Möglichkeit, Änderungen am <em>Deskriptorobjekt</em> vorzunehmen. </p><br><p>  Um zu verhindern, dass die Bodeneigenschaft nach der Initialisierung geändert werden kann, muss der Wert von <em>writable</em> in <em>false</em> geändert werden. <br>  Um die Eigenschaften eines <em>Deskriptors</em> zu ändern <em>,</em> gibt es eine statische Methode <em>defineProperty</em> , die das Objekt selbst, den Namen der Eigenschaft und den <em>Deskriptor verwendet</em> . </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(apt, <span class="hljs-string"><span class="hljs-string">'floor'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">writable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>});</code> </pre> <br><p>  In diesem Beispiel übergeben wir nicht das gesamte <em>Deskriptorobjekt</em> , sondern nur eine <em>beschreibbare</em> Eigenschaft mit dem Wert <em>false</em> . <br>  Versuchen wir nun, den Wert in der Bodeneigenschaft zu ändern: </p><br><pre> <code class="javascript hljs">apt.floor = <span class="hljs-number"><span class="hljs-number">44</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(apt.floor); <span class="hljs-comment"><span class="hljs-comment">// output 12</span></span></code> </pre> <br><p>  Der Wert hat sich nicht geändert, und bei Verwendung von 'use strict' wird eine Fehlermeldung angezeigt: </p><br><blockquote>  Kann nicht der schreibgeschützten Eigenschaft 'Etage' des Objekts zuweisen ... </blockquote><p>  Und jetzt können wir den Wert nicht mehr ändern.  Wir können jedoch weiterhin <em>beschreibbar -&gt; true zurückgeben</em> und dann die <em>Bodeneigenschaft</em> ändern.  Um dies zu vermeiden, muss der Wert der <em>konfigurierbaren</em> Eigenschaft im <em>Deskriptor</em> auf <em>false</em> geändert werden. </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(apt, <span class="hljs-string"><span class="hljs-string">'floor'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">writable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">configurable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>});</code> </pre> <br><p>  Wenn wir jetzt versuchen, den Wert einer der Eigenschaften unseres Deskriptors zu ändern ... </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(apt, <span class="hljs-string"><span class="hljs-string">'floor'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">writable</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">configurable</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>});</code> </pre> <br><p>  Als Antwort erhalten wir: </p><br><blockquote>  TypeError: Eigenschaft: Etage kann nicht neu definiert werden <br>  Mit anderen Worten, wir können weder den Wert des <em>Bodens</em> noch seinen <em>Deskriptor</em> mehr ändern. </blockquote><br><h4 id="summiruem">  Fassen Sie zusammen </h4><br><p>  Um den Eigenschaftswert im Objekt unverändert zu lassen, muss die Konfiguration dieser Eigenschaft registriert werden: <em>{beschreibbar: falsch, konfigurierbar: falsch}</em> . </p><br><p>  Dies kann wie bei der Eigenschaftsinitialisierung erfolgen: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(apt, <span class="hljs-string"><span class="hljs-string">'floor'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-attr"><span class="hljs-attr">writable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">configurable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>});</code> </pre> <br><p>  Oder danach. </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(apt, <span class="hljs-string"><span class="hljs-string">'floor'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">writable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">configurable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>});</code> </pre> <br><p>  Betrachten Sie am Ende ein Beispiel mit einer Klasse: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Apartment</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(apt) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.apt = apt; } getFloor() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.apt.floor } } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> apt = { <span class="hljs-attr"><span class="hljs-attr">floor</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-attr"><span class="hljs-attr">number</span></span>: <span class="hljs-string"><span class="hljs-string">'12B'</span></span>, <span class="hljs-attr"><span class="hljs-attr">size</span></span>: <span class="hljs-number"><span class="hljs-number">3400</span></span>, <span class="hljs-attr"><span class="hljs-attr">bedRooms</span></span>: <span class="hljs-number"><span class="hljs-number">3.4</span></span>, <span class="hljs-attr"><span class="hljs-attr">bathRooms</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">price</span></span>: <span class="hljs-number"><span class="hljs-number">400000</span></span>, <span class="hljs-attr"><span class="hljs-attr">amenities</span></span>: {...} };</code> </pre> <br><p>  Ändern Sie die getFloor-Methode: </p><br><pre> <code class="javascript hljs">Apartment.prototype.getFloor = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">44</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> myApt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Apartment(apt); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myApt); <span class="hljs-comment"><span class="hljs-comment">// output will be changed. 44</span></span></code> </pre> <br><p>  Ändern Sie nun den <em>Deskriptor der</em> Methode <em>getFloor ()</em> : </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(Apartment.prototype, <span class="hljs-string"><span class="hljs-string">'getFloor'</span></span>, {<span class="hljs-attr"><span class="hljs-attr">writable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">configurable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}); Apartment.prototype.getFloor = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">44</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> myApt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Apartment(apt); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(myApt); <span class="hljs-comment"><span class="hljs-comment">// output will be original. 12</span></span></code> </pre> <br><p>  Ich hoffe, dieser Artikel gibt etwas mehr Aufschluss darüber, was <em>Deskriptor ist</em> und wie er verwendet werden kann. </p><br><blockquote>  Alles, was oben geschrieben wurde, behauptet nicht, absolut wahr oder das einzig Richtige zu sein. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450540/">https://habr.com/ru/post/de450540/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450530/index.html">Was ist neu in der Cloud: 15 Materialien zu Standards, Tools und Vorschriften</a></li>
<li><a href="../de450532/index.html">Wie ich PMP wurde und wie ich es am besten nicht mache</a></li>
<li><a href="../de450534/index.html">Was ist in der Luft zu hören? Wir empfangen und decodieren die interessantesten Signale</a></li>
<li><a href="../de450536/index.html">Absolventen amerikanischer Universitäten sind Absolventen Russlands, Chinas und Indiens überlegen</a></li>
<li><a href="../de450538/index.html">Ascot 170 - mechanischer Computer und sowjetisches Paläoendemikum</a></li>
<li><a href="../de450542/index.html">Die interessantesten Gifte</a></li>
<li><a href="../de450544/index.html">PHP 7.4 enthält Pfeilfunktionen (Kurznotation anonymer Funktionen)</a></li>
<li><a href="../de450546/index.html">Das sprechende Präfix der Waschmaschine, das nicht gegen die Garantie verstößt</a></li>
<li><a href="../de450548/index.html">"Runet Isolation" oder "Sovereign Internet"</a></li>
<li><a href="../de450550/index.html">Teil 4. Karriereprogrammierer. Junior. Freiberuflicher Einstieg</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>