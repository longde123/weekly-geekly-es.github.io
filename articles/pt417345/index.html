<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•§ üë©üèø‚Äçü§ù‚Äçüë©üèæ üë©üèø‚ÄçüöÄ Ca√ßa a amea√ßas com visibilidade da Cisco üòò ‚óªÔ∏è üë®üèæ‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Imagine que voc√™ leu um artigo no Kommersant que um pacote completo para ataques a bancos Pegasus foi disponibilizado publicamente na Internet. Voc√™ p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ca√ßa a amea√ßas com visibilidade da Cisco</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/cisco/blog/417345/"> Imagine que voc√™ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">leu</a> um artigo no Kommersant que um pacote completo para ataques a bancos Pegasus foi disponibilizado publicamente na Internet.  Voc√™ provavelmente desejar√° descobrir se tamb√©m foi pego na distribui√ß√£o e se o c√≥digo malicioso est√° na sua rede.  Por um lado, voc√™ tem v√°rios logs e eventos de seguran√ßa de v√°rios meios de prote√ß√£o e, por outro, pode receber informa√ß√µes sobre amea√ßas como parte de uma assinatura de qualquer servi√ßo pago ou gratuito do Threat Intelligence (por exemplo, do BI.ZONE, do State Security Service ou FinCERT).  Por um lado, voc√™ tem muitos dados para analisar, mas n√£o sabe se eles t√™m vest√≠gios do que voc√™ est√° procurando.  Por outro lado, voc√™ tem informa√ß√µes sobre os rastreamentos (isto √©, indicadores de comprometimento), mas n√£o sabe como eles s√£o aplic√°veis ‚Äã‚Äãa voc√™.  Voc√™ precisa combinar esses dois conjuntos de dados implementando o que √© comumente chamado Threat Hunting ou localizando vest√≠gios de ataques em sua infraestrutura.  Vamos ver como voc√™ pode automatizar essa tarefa com a solu√ß√£o gratuita Cisco Visibility, lan√ßada recentemente. <br><br><img src="https://habrastorage.org/webt/ri/tn/jd/ritnjduwd50csjcb8tqkx-gxzqk.png" alt="imagem"><a name="habracut"></a><br><br>  Voc√™ n√£o sabe por onde come√ßar?  Onde procurar vest√≠gios de uma amea√ßa que lhe interessa?  Aqui est√° uma folha em branco e, no Cisco Visibility, fica assim: <br><br><img src="https://habrastorage.org/webt/hz/ql/ie/hzqlieayft079i9gry1wg5jmjzw.png" alt="imagem"><br><br>  Nesta janela, voc√™ carrega tudo o que procurar√°.  Vamos usar o TeslaCrypt como exemplo (na vida real, em vez do TeslaCrypt, voc√™ substituir√° qualquer outra amea√ßa que voc√™ precise encontrar vest√≠gios ou provar sua aus√™ncia durante a ca√ßa √†s amea√ßas).  Primeiro, voc√™ precisa reunir todos os indicadores de comprometimento para os quais usa os servi√ßos existentes de Threat Intelligence.  Por exemplo, voc√™ obt√©m dados do TeslaCrypt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no blog Cisco Talos</a> .  Voc√™ tem 9 indicadores √† sua frente - endere√ßos IP, hashes de arquivos de malware e dom√≠nios com os quais o criptografador implantado entra em contato para receber comandos adicionais e pagar pelo resgate em criptomoeda.  Voc√™ carrega todos esses indicadores no Cisco Visibility: <br><br><img src="https://habrastorage.org/webt/sq/vr/v1/sqvrv1qyfiqbw6jiwvlamctaxlg.png" alt="imagem"><br><br>  Aqui voc√™ precisa fazer uma pequena digress√£o.  O Cisco Visibility agora trabalha com dados do Cisco AMP for Endpoints, ou seja, com uma solu√ß√£o de classe EDR (Endpoint Detection and Response) instalada em computadores pessoais e m√≥veis com Windows, Linux, MacOS, Android e iOS.  Portanto, a detec√ß√£o de amea√ßas com o Cisco Visibility agora √© realizada em dispositivos de terminal, que s√£o 70% direcionados por atacantes. <br><br><img src="https://habrastorage.org/webt/km/fw/iu/kmfwiu5ky9hdr11hrqxiuwrpsao.png" alt="imagem"><br><br>  O que vemos ap√≥s carregar indicadores no Cisco Visibility?  A √°rea principal da tela √© ocupada pelo gr√°fico de relacionamento, que reflete as intera√ß√µes entre indicadores de comprometimento, eventos de seguran√ßa coletados da infraestrutura do cliente e o ambiente externo.  Voc√™ pode dimensionar a imagem para ter uma id√©ia geral da imagem do que est√° acontecendo. <br><br><img src="https://habrastorage.org/webt/ad/kz/kk/adkzkkzagihootdjg2_kalsyabe.png" alt="imagem"><br><br>  Acima do gr√°fico de intera√ß√µes, h√° um painel que exibe um resumo de todos os pontos de interesse para n√≥s: <br><br><ul><li>  Metas ou sacrif√≠cios.  Ao clicar neste campo, voc√™ receber√° imediatamente uma lista de todos os n√≥s da sua rede nos quais as faixas que voc√™ procura s√£o encontradas.  √â exatamente isso que voc√™ precisa para entender a escala do desastre e o quanto voc√™ sofreu.  Se nenhum n√≥ for mostrado aqui, voc√™ n√£o ter√° n√≥s envolvidos no ataque. </li><li>  Pegadas.  Ao clicar neste campo, voc√™ obter√° uma lista de faixas que procura, com destaque para cores que reflete o fato de que essas faixas est√£o nos bancos de dados do Cisco Threat Intelligence. </li><li>  Indicadores.  Ao clicar neste campo, voc√™ ver√° os padr√µes de comportamento encontrados em sua infraestrutura que correspondem aos rastreamentos que voc√™ est√° procurando. </li><li>  Dom√≠nios, hashes, endere√ßos IP e URLs.  Esses campos mostram os tra√ßos correspondentes. </li><li>  M√≥dulos  Este item de menu reflete a lista de m√≥dulos com a ajuda de quais dados foram enriquecidos e rastros de ataques foram detectados.  Existem v√°rios m√≥dulos e incluem solu√ß√µes da Cisco (por exemplo, Cisco ThreatGrid, Cisco Umbrella, Intelig√™ncia Global da Cisco AMP, Talos Intelligence) e solu√ß√µes de terceiros (por exemplo, VirusTotal).  A lista desses m√≥dulos ser√° expandida. </li></ul><br><br><img src="https://habrastorage.org/webt/2c/gc/d_/2cgcd_-ebsbncdvvjipkwvorxny.png" alt="imagem"><br><br>  Considerando que os agentes AMP4E podem ser instalados em centenas e milhares de computadores, n√£o estamos interessados ‚Äã‚Äãem todos eles, mas apenas naqueles que ‚Äúficaram sob a distribui√ß√£o‚Äù (se √© que conseguiram, √© claro).  Ao clicar no campo Destino, obtemos uma lista daqueles n√≥s em que foram encontrados tra√ßos da amea√ßa.  No nosso caso, este √© apenas um n√≥. <br><br><img src="https://habrastorage.org/webt/xb/dy/ir/xbdyirqf-1ga43virsmb8i9rbmk.png" alt="imagem"><br><br>  Ao clicar no nome desse n√≥, obtemos imediatamente a √°rea do gr√°fico de intera√ß√µes, que reflete todas as conex√µes entre os tra√ßos desejados e o n√≥ comprometido. <br><br><img src="https://habrastorage.org/webt/4g/kh/yb/4gkhybixr3knbccch9sy-3eq7ro.png" alt="imagem"><br><br>  √â imediatamente claro que apenas uma pequena parte da infraestrutura foi afetada, na qual voc√™ pode se concentrar. <br><br><img src="https://habrastorage.org/webt/ri/tn/jd/ritnjduwd50csjcb8tqkx-gxzqk.png" alt="imagem"><br><br>  Os rastreamentos encontrados foram aprimorados usando v√°rios m√≥dulos, incluindo solu√ß√µes de terceiros (neste caso, VirusTotal).  Isso nos permite ter mais confian√ßa nos resultados da an√°lise, j√° que a confirma√ß√£o dos rastreamentos encontrados foi obtida de v√°rias fontes de Threat Intelligence.  Nesse caso, a investiga√ß√£o foi enriquecida com dados de TI de 5 fontes: <br><br><img src="https://habrastorage.org/webt/al/y5/rm/aly5rmv0lqhgzsn6wajemvfymvu.png" alt="imagem"><br><br>  Muitos indicadores de comprometimento, isto √©, padr√µes comportamentais, foram encontrados com rela√ß√£o aos tra√ßos procurados (19): <br><br><img src="https://habrastorage.org/webt/md/px/07/mdpx07llwqdd8bbajl2djtijqom.png" alt="imagem"><br><br>  A √°rea da tela "Linha do tempo da avistagem" mostra uma linha do tempo que reflete duas quest√µes importantes - quando os rastros foram encontrados em nossa infraestrutura local e quando foram encontrados fora da empresa, no mundo (os √∫ltimos 30 dias s√£o exibidos para n√£o levar os analistas muito longe do momento atual )  Essa compara√ß√£o das duas linhas do tempo nos permite concluir se a atividade maliciosa √© global (e n√≥s apenas ca√≠mos em distribui√ß√µes como muitas outras) ou se foi focal, projetada especificamente para n√≥s. <br><br><img src="https://habrastorage.org/webt/bg/7t/el/bg7telzembuqnsjn2tsb_ok-pk8.png" alt="imagem"><br><br>  Na parte inferior da tela, veremos uma se√ß√£o onde voc√™ pode obter os detalhes de cada faixa, artefato, indicador de comprometimento encontrado e fazer uma an√°lise mais detalhada.  Observe que, de todos os rastreamentos que procuramos, apenas um foi encontrado em nossa rede - o hash do arquivo malicioso. <br><br><img src="https://habrastorage.org/webt/iq/k1/7b/iqk17bn0jjq1phhsycrhsjwum9e.png" alt="imagem"><br><br>  Por exemplo, √© assim que as informa√ß√µes sobre arquivos maliciosos detectados em nossa infraestrutura com o hash correspondente s√£o exibidas.  No entanto, vale a pena prestar aten√ß√£o a um ponto t√£o importante.  Para cada faixa, vemos v√°rias guias.  O primeiro deles s√£o os julgamentos.  Nele, vemos refer√™ncias a v√°rios m√≥dulos que "viram" esses tra√ßos algum dia.  Por exemplo, vemos que no banco de dados do VirusTotal h√° um hash correspondente e √© reconhecido por diferentes mecanismos antiv√≠rus.  Isso significa que esta amea√ßa est√° em nossa rede?  Ainda n√£o.  Talvez este seja um malware antigo que n√£o √© mais v√°lido.  Por exemplo, no campo Expira√ß√£o, pode haver uma observa√ß√£o de que esse rastreamento foi registrado pela √∫ltima vez "na natureza" dois meses atr√°s. <br><br><img src="https://habrastorage.org/webt/ia/yw/ds/iaywdsihkz8zhjjwb17hav3qpfc.png" alt="imagem"><br><br>  A guia Veredicto (senten√ßa final) √© muito mais importante, o que nos permite tirar uma conclus√£o final (avaliando dados diferentes, cujo resultado ponderado √© exibido na guia Veredicto) sobre a presen√ßa ou aus√™ncia de uma amea√ßa em nossa infraestrutura. <br><br><img src="https://habrastorage.org/webt/li/kb/n4/likbn4bx17o9cq1uyozhayjyxjk.png" alt="imagem"><br><br>  A guia Avistamentos mostra artefatos por amea√ßa e onde foram descobertos: <br><br><img src="https://habrastorage.org/webt/ti/gv/de/tigvdeoqymwnpirye-snmwama9s.png" alt="imagem"><br><br>  A guia Indicadores mostra uma descri√ß√£o detalhada de cada indicador inerente aos rastreios detectados: <br><br><img src="https://habrastorage.org/webt/qw/8t/f_/qw8tf_j1jbaqvtqasvf_qyeayfw.png" alt="imagem"><br><br>  Observe que temos intera√ß√£o com o Tor, exclus√£o de c√≥pias de backup, reconhecimento de antiv√≠rus e cria√ß√£o de um grande n√∫mero de artefatos etc.  Nos nossos bancos de dados de Intelig√™ncia de Amea√ßas, analisamos cerca de 1000 indicadores diferentes. <br><br><img src="https://habrastorage.org/webt/x6/qm/og/x6qmogkcwjcc-tiotzjnzgvajxc.png" alt="imagem"><br><br>  Ap√≥s receber informa√ß√µes sobre os rastreamentos de um ataque encontrado em nossa infraestrutura, podemos realizar uma investiga√ß√£o mais detalhada usando as ferramentas que forneceram os dados iniciais ao Cisco Visibility.  Por exemplo, podemos executar o AMP for Endpoints para obter uma an√°lise detalhada de um evento espec√≠fico, o que levou √† possibilidade de detectar uma amea√ßa. <br><br><img src="https://habrastorage.org/webt/ap/zd/s8/apzds89cfirq4mbtiqopzjzim-k.png" alt="imagem"><br><br>  Vemos toda a imagem do que est√° acontecendo.  Arquivo malicioso criado pelo processo explorer.exe √†s 20:00:00, hor√°rio de Moscou, em 15 de julho.  Vemos onde esse arquivo est√° localizado e os valores de seus hashes de acordo com v√°rios algoritmos (SHA1 e MD5). <br><br><img src="https://habrastorage.org/webt/dk/a8/6g/dka86gxg9965skwqvay02uehgyw.png" alt="imagem"><br><br>  Usando a tecnologia de seguran√ßa retrospectiva e o mecanismo de visualiza√ß√£o da Trajet√≥ria de dispositivos, podemos visualizar todas as a√ß√µes realizadas ou realizadas pelo arquivo de seu interesse.  Nesse caso, vemos que o objeto de arquivo t.exe criado pelo processo explorer.exe lan√ßou o utilit√°rio Windows completamente legal - vssadmin.exe, que gerencia c√≥pias de sombra e, entre outras coisas, √© frequentemente usado pelos criptografadores para exclu√≠-las (para que n√£o possam ser restauradas) dados criptografados).  Se voc√™ olhar a descri√ß√£o do TeslaCrypt, veremos que esse criptografador usa vssadmin em suas atividades. <br><br><img src="https://habrastorage.org/webt/dr/se/pu/drsepug7_ofjtv-4usydyseb4dq.png" alt="imagem"><br><br>  A prop√≥sito, recentemente atualizamos o mecanismo Device Trajectory e agora parece um pouco diferente: <br><br><img src="https://habrastorage.org/webt/eg/bi/zt/egbiztnnll_m0roakbxmb44iztq.png" alt="imagem"><br><br>  No exemplo acima, o arquivo t.exe n√£o foi bloqueado e n√£o foi colocado em quarentena, embora isso seja exatamente o que o AMP for Endpoints faz na vida real.  Mas, para os fins deste artigo, o AMP4E opera no modo de auditoria, que permite monitorar eventos, mas n√£o bloque√°-los.  A prop√≥sito, se o PowerShell fosse iniciado em vez do vssadmin (tamb√©m uma ferramenta de administra√ß√£o do sistema totalmente legal), ver√≠amos isso e os par√¢metros da linha de comando usados ‚Äã‚Äãno PowerShell. <br><br>  Portanto, resumindo, parece trabalhar com o Cisco Visibility enquanto procura vest√≠gios de amea√ßas na infraestrutura local e enriquece os eventos de seguran√ßa existentes com dados de v√°rias fontes de Threat Intelligence. <br><br>  PS: O Cisco Visibility √© baseado no Cisco Threat Intelligence Model (CTIM) que desenvolvemos, que, por sua vez, √© baseado no padr√£o de comunica√ß√£o Threat Intelligence - STIX.  Por√©m, diferentemente do STIX, o modelo CTIM n√£o se concentra na formaliza√ß√£o do formato dos dados de amea√ßas, mas no processo de coleta, armazenamento e an√°lise desses dados.  Com base na Cisco Threat Intelligence API (este √© um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">projeto de c√≥digo aberto</a> e pode ser usado em suas solu√ß√µes), planejamos expandir a lista de fontes com as quais trabalharemos, tanto em termos de recebimento de eventos de seguran√ßa quanto em termos de recebimento de dados de Threat Intelligence.  Al√©m disso, planejamos adicionar ao Cisco Visibility a capacidade de trabalhar n√£o apenas com indicadores at√¥micos de comprometimento (IP, hash, dom√≠nio, URL), mas tamb√©m com dados de vulnerabilidade (CVE), programas de configura√ß√£o (CWE) e banco de dados de padr√µes de ataque (CAPEC). e uma base de conhecimento sobre m√©todos, t√°ticas e procedimentos do invasor (ATT e CK).  Este trabalho est√° em andamento. <br><br>  PPS: No come√ßo da nota, eu era um pouco esperto.  O Cisco Visibility √© realmente uma solu√ß√£o gratuita, mas, para us√°-lo, voc√™ deve pelo menos ter o Cisco AMP for Endpoints instalado em sua organiza√ß√£o (e de onde obter os dados para a busca de amea√ßas?).  Tamb√©m √© desej√°vel (mas n√£o necess√°rio) ter acesso aos servi√ßos Cisco Threat Grid (sandbox) e Cisco Umbrella (an√°lise de DNS).  Nesses casos, ser√° poss√≠vel realizar uma an√°lise mais profunda das amea√ßas (rastreamentos e indicadores) j√° dentro dos servi√ßos especificados lan√ßados pelo Cisco Visibility.  E, √© claro, voc√™ deve ter acesso a servi√ßos externos de Threat Intelligence que se integram ao Cisco Visibility.  At√© agora, este √© apenas o VirusTotal (mas n√£o estamos parados e expandimos seu n√∫mero), acesso ao qual qualquer pessoa pode obter. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt417345/">https://habr.com/ru/post/pt417345/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt417329/index.html">Voc√™ e Brad Pitt s√£o 99%</a></li>
<li><a href="../pt417331/index.html">Semana 26 de Seguran√ßa: Spectre atualizado, agora com grava√ß√£o de bom gosto</a></li>
<li><a href="../pt417333/index.html">Classifica√ß√£o social</a></li>
<li><a href="../pt417337/index.html">Princ√≠pios de opera√ß√£o e aplica√ß√£o de troca at√¥mica</a></li>
<li><a href="../pt417339/index.html">3DTouch - Escalas no iPhone: Conclus√£o</a></li>
<li><a href="../pt417349/index.html">Troca de dados e equa√ß√µes diferenciais</a></li>
<li><a href="../pt417353/index.html">Alemanha aprova o uso de trens de c√©lulas a combust√≠vel de hidrog√™nio</a></li>
<li><a href="../pt417355/index.html">Calv√≠cie: Teoria e Pr√°tica do Tratamento, Parte 2 ‚ÄúAt√© a pr√≥stata tem am√≠gdalas, prostaglandinas‚Äù</a></li>
<li><a href="../pt417357/index.html">√Åreas de trabalho "Sobre TI". Hist√≥ria dos jogos de configura√ß√£o do computador</a></li>
<li><a href="../pt417359/index.html">Seguran√ßa da informa√ß√£o? N√£o n√£o ouvi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>