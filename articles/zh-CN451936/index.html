<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¦… ğŸ§‘ğŸ½â€ğŸ¤â€ğŸ§‘ğŸ» ğŸšµğŸ¿ åœ¨UCæµè§ˆå™¨ä¸­å¯»æ‰¾æ¼æ´ ğŸˆ ğŸˆ² ğŸ¤¦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¼•è¨€ 
 3æœˆåº•ï¼Œæˆ‘ä»¬æŠ¥å‘Šè¯´ ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ç§éšè—çš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨UCæµè§ˆå™¨ä¸­ä¸‹è½½å’Œè¿è¡Œæœªç»éªŒè¯çš„ä»£ç ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è¯¦ç»†åˆ†æè¿™ç§ä¸‹è½½çš„å‘ç”Ÿæ–¹å¼ä»¥åŠé»‘å®¢å¦‚ä½•å°†å…¶ç”¨äºè‡ªå·±çš„ç›®çš„ã€‚ 

 ä¸ä¹…å‰ï¼ŒUCæµè§ˆå™¨å¾—åˆ°äº†å¹¿æ³›çš„å®£ä¼ å’Œåˆ†å‘ï¼šå®ƒä½¿ç”¨æ¶æ„è½¯ä»¶å®‰è£…åœ¨ç”¨æˆ·çš„è®¾å¤‡ä¸Šï¼Œå¹¶ä»¥è§†é¢‘æ–‡ä»¶çš„å½¢å¼ä»å„ä¸ªç«™ç‚¹åˆ†å‘ï¼ˆä¾‹å¦‚ï¼Œç”¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨UCæµè§ˆå™¨ä¸­å¯»æ‰¾æ¼æ´</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/drweb/blog/451936/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/-f/na/kn/-fnaknrx70xmfiflvfa6ijw1pys.jpeg"></div><br><h3> å¼•è¨€ </h3><br>  3æœˆåº•ï¼Œæˆ‘ä»¬<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æŠ¥å‘Šè¯´</a> ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ç§éšè—çš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨UCæµè§ˆå™¨ä¸­ä¸‹è½½å’Œè¿è¡Œæœªç»éªŒè¯çš„ä»£ç ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è¯¦ç»†åˆ†æè¿™ç§ä¸‹è½½çš„å‘ç”Ÿæ–¹å¼ä»¥åŠé»‘å®¢å¦‚ä½•å°†å…¶ç”¨äºè‡ªå·±çš„ç›®çš„ã€‚ <br><br> ä¸ä¹…å‰ï¼ŒUCæµè§ˆå™¨å¾—åˆ°äº†å¹¿æ³›çš„å®£ä¼ å’Œåˆ†å‘ï¼šå®ƒä½¿ç”¨æ¶æ„è½¯ä»¶å®‰è£…åœ¨ç”¨æˆ·çš„è®¾å¤‡ä¸Šï¼Œå¹¶ä»¥è§†é¢‘æ–‡ä»¶çš„å½¢å¼ä»å„ä¸ªç«™ç‚¹åˆ†å‘ï¼ˆä¾‹å¦‚ï¼Œç”¨æˆ·ä»¥ä¸ºä»–ä»¬ä¸‹è½½äº†ä¾‹å¦‚è‰²æƒ…å‰ªè¾‘ï¼Œä½†å´æ”¶åˆ°äº†ä¸æ­¤ç›¸å…³çš„APKï¼‰æµè§ˆå™¨ï¼‰ï¼Œä½¿ç”¨ä»¤äººææƒ§çš„æ¨ªå¹…å¹¿å‘Šï¼Œæ ‡æ˜æµè§ˆå™¨å·²è¿‡æ—¶ï¼Œæ˜“å—æ”»å‡»ï¼Œå¹¶ä¸”å­˜åœ¨ç±»ä¼¼é—®é¢˜ã€‚  VKä¸­çš„å®˜æ–¹UCæµè§ˆå™¨å°ç»„çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸»é¢˜</a>æ˜¯ç”¨æˆ·å¯ä»¥æŠ±æ€¨å¹¿å‘Šä¸å…¬å¹³çš„ä¾‹å­ï¼Œæœ‰å¾ˆå¤šä¾‹å­ã€‚  2016å¹´ï¼Œç”šè‡³æœ‰ä¿„è¯­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è§†é¢‘å¹¿å‘Š</a> ï¼ˆæ˜¯çš„ï¼Œæ¥è‡ªé˜»æ­¢å¹¿å‘Šçš„æµè§ˆå™¨ä¸­çš„å¹¿å‘Šï¼‰ã€‚ <br><br> åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒUCæµè§ˆå™¨åœ¨Google Playä¸Šçš„å®‰è£…é‡å·²è¶…è¿‡500,000,000ã€‚ è¿™ä»¤äººå°è±¡æ·±åˆ»-åªæœ‰Google Chromeæµè§ˆå™¨æœ‰æ›´å¤šåŠŸèƒ½ã€‚ åœ¨è¯„è®ºä¸­ï¼Œæ‚¨ä¼šçœ‹åˆ°å¾ˆå¤šå…³äºå¹¿å‘Šçš„æŠ•è¯‰ï¼Œå¹¶é‡å®šå‘åˆ°Google Playä¸Šçš„æŸäº›åº”ç”¨ç¨‹åºã€‚ è¿™å°±æ˜¯è¿›è¡Œè¿™é¡¹ç ”ç©¶çš„åŸå› ï¼šæˆ‘ä»¬å†³å®šæŸ¥çœ‹UCæµè§ˆå™¨æ˜¯å¦åšå¾—ä¸å¥½ã€‚ äº‹å®è¯æ˜ï¼Œä»–æ­£åœ¨è¿™æ ·åšï¼ <br><a name="habracut"></a><br> è¯¥åº”ç”¨ç¨‹åºä»£ç æ˜¾ç¤ºäº†ä¸‹è½½å’Œè¿è¡Œå¯æ‰§è¡Œä»£ç çš„èƒ½åŠ›ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™ä¸</a>åœ¨Google Playä¸Š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å‘å¸ƒåº”ç”¨ç¨‹åºçš„è§„åˆ™ç›¸çŸ›ç›¾</a> ã€‚ é™¤äº†UC Browserä¸‹è½½å¯æ‰§è¡Œä»£ç ä¹‹å¤–ï¼Œå®ƒè¿˜ä½¿å®ƒä¸å®‰å…¨ï¼Œå¯ç”¨äºè¿›è¡ŒMitMæ”»å‡»ã€‚ è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬æ˜¯å¦èƒ½å¤Ÿè¿›è¡Œè¿™æ ·çš„æ”»å‡»ã€‚ <br><br> ä»¥ä¸‹ç¼–å†™çš„æ‰€æœ‰å†…å®¹å‡ä¸ç ”ç©¶æ—¶Google Playä¸Šçš„UCæµè§ˆå™¨ç‰ˆæœ¬æœ‰å…³ï¼š <br><br><pre><code class="plaintext hljs">package: com.UCMobile.intl versionName: 12.10.8.1172 versionCode: 10598 sha1 APK-: f5edb2243413c777172f6362876041eb0c3a928c</code> </pre> <br><h3> æ”»å‡»å‘é‡ </h3><br> åœ¨â€œ UCæµè§ˆå™¨â€æ¸…å•ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªåä¸º<i>com.uc.deployment.UpgradeDeployService</i>çš„æœåŠ¡ã€‚ <br><br><pre> <code class="plaintext hljs"> &lt;service android:exported="false" android:name="com.uc.deployment.UpgradeDeployService" android:process=":deploy" /&gt;</code> </pre><br> å¯åŠ¨æ­¤æœåŠ¡åï¼Œæµè§ˆå™¨<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°†å¯¹puds.ucweb.com/upgrade/index.xhtml</a></i>æ‰§è¡ŒPOSTè¯·æ±‚ï¼Œå¯åŠ¨åçš„ä¸€æ®µæ—¶é—´å†…å°±ä¼šåœ¨æµé‡ä¸­æ³¨æ„åˆ°è¯¥è¯·æ±‚ã€‚ ä½œä¸ºå“åº”ï¼Œä»–å¯èƒ½ä¼šæ”¶åˆ°ä¸‹è½½æ›´æ–°æˆ–æ–°æ¨¡å—çš„å‘½ä»¤ã€‚ åœ¨åˆ†æè¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨æœªæä¾›æ­¤ç±»å‘½ä»¤ï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå½“å°è¯•åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€PDFæ—¶ï¼Œå®ƒåœ¨ä¸Šè¿°åœ°å€å‘å‡ºäº†ç¬¬äºŒä¸ªè¯·æ±‚ï¼Œç„¶åä¸‹è½½äº†æœ¬æœºåº“ã€‚ ä¸ºäº†è¿›è¡Œæ”»å‡»ï¼Œæˆ‘ä»¬å†³å®šä½¿ç”¨UCæµè§ˆå™¨çš„æ­¤åŠŸèƒ½ï¼šä½¿ç”¨æœ¬æœºåº“æ‰“å¼€PDFçš„åŠŸèƒ½ï¼Œè¯¥æœ¬æœºä¸åœ¨APKä¸­ï¼Œå¹¶ä¸”å¦‚æœ‰å¿…è¦ï¼Œå¯ä»Internetä¸‹è½½ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä»ç†è®ºä¸Šè®²ï¼Œå¦‚æœæ‚¨å¯¹æµè§ˆå™¨å¯åŠ¨åæ‰§è¡Œçš„è¯·æ±‚ç»™å‡ºæ­£ç¡®æ ¼å¼çš„å“åº”ï¼Œåˆ™å¯ä»¥å¼ºåˆ¶UCæµè§ˆå™¨ä¸‹è½½æŸäº›å†…å®¹è€Œæ— éœ€ç”¨æˆ·äº¤äº’ã€‚ ä½†æ˜¯ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ›´è¯¦ç»†åœ°ç ”ç©¶ä¸æœåŠ¡å™¨çš„äº¤äº’åè®®ï¼Œå› æ­¤æˆ‘ä»¬å†³å®šç¼–è¾‘æˆªè·çš„å“åº”å¹¶æ›¿æ¢ç”¨äºå¤„ç†PDFçš„åº“æ›´åŠ å®¹æ˜“ã€‚ <br><br> å› æ­¤ï¼Œå½“ç”¨æˆ·æƒ³è¦ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€PDFæ—¶ï¼Œå¯ä»¥åœ¨æµé‡ä¸­çœ‹åˆ°ä»¥ä¸‹è¯·æ±‚ï¼š <br><br><img src="https://habrastorage.org/webt/j0/i1/c1/j0i1c1n_nwf_gnauzbudnqor5oi.png"><br><br> é¦–å…ˆæ˜¯å¯¹<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">puds.ucweb.com/upgrade/index.xhtml</a></i>çš„POSTè¯·æ±‚ï¼Œä¹‹å <br> ä¸‹è½½å¸¦æœ‰åº“çš„å­˜æ¡£ï¼Œä»¥æŸ¥çœ‹PDFå’ŒOfficeæ ¼å¼ã€‚ é€»è¾‘ä¸Šæ˜¯å‡è®¾åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ä¸­ä¼ è¾“äº†æœ‰å…³ç³»ç»Ÿçš„ä¿¡æ¯ï¼ˆè‡³å°‘æ˜¯ä½“ç³»ç»“æ„ä»¥ä¾¿æä¾›å¿…è¦çš„åº“ï¼‰ï¼Œå¹¶ä¸”å“åº”äºæ­¤ï¼Œæµè§ˆå™¨æ”¶åˆ°äº†ä¸€äº›éœ€è¦ä¸‹è½½çš„æœ‰å…³åº“çš„ä¿¡æ¯ï¼šåœ°å€ä»¥åŠå¯èƒ½çš„å…¶ä»–ä¿¡æ¯ã€‚ é—®é¢˜æ˜¯æ­¤è¯·æ±‚å·²åŠ å¯†ã€‚ <br><br><div class="scrollable-table"><table><tbody><tr><td> ç´¢å–æ‘˜è¦ <br><br></td><td> å“åº”ç‰‡æ®µ <br><br></td></tr><tr><td><img src="https://habrastorage.org/webt/go/tj/tz/gotjtzkpg2owfmk8jrnznox_vdg.jpeg"><br><br></td><td><img src="https://habrastorage.org/webt/g5/7k/iv/g57kivkwrysmcqvptmhclqzzipq.png"><br><br></td></tr></tbody></table></div><br><br> è¯¥åº“æœ¬èº«æ‰“åŒ…ä¸ºZIPæ ¼å¼ï¼ŒæœªåŠ å¯†ã€‚ <br><br><img src="https://habrastorage.org/webt/6r/lt/ns/6rltnsrtyd-_5ekwis68qn-vydc.png"><br><br><h3> æœç´¢æµé‡è§£å¯†ç  </h3><br><br> è®©æˆ‘ä»¬å°è¯•è§£å¯†æœåŠ¡å™¨å“åº”ã€‚ æˆ‘ä»¬æŸ¥çœ‹<i>com.uc.deployment.UpgradeDeployService</i>ç±»çš„ä»£ç ï¼šä»<i>onStartCommand</i>æ–¹æ³•å¼€å§‹<i>ï¼Œ</i>è½¬åˆ°<i>com.uc.deployment.bx</i> ï¼Œç„¶åä»å®ƒè½¬åˆ°<i>com.uc.browser.core.dcfe</i> ï¼š <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">e</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l arg9)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v4_5; String v3_1; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v3; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v1 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg9 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { v3 = v1; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v3_1 = arg9.iGX.ipR; StringBuilder v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]product:"</span></span>); v4.append(arg9.iGX.ipR); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]version:"</span></span>); v4.append(arg9.iGX.iEn); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]upgrade_type:"</span></span>); v4.append(arg9.iGX.mMode); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]force_flag:"</span></span>); v4.append(arg9.iGX.iEo); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]silent_mode:"</span></span>); v4.append(arg9.iGX.iDQ); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]silent_type:"</span></span>); v4.append(arg9.iGX.iEr); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]silent_state:"</span></span>); v4.append(arg9.iGX.iEp); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]silent_file:"</span></span>); v4.append(arg9.iGX.iEq); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apk_md5:"</span></span>); v4.append(arg9.iGX.iEl); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]download_type:"</span></span>); v4.append(arg9.mDownloadType); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]download_group:"</span></span>); v4.append(arg9.mDownloadGroup); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]download_path:"</span></span>); v4.append(arg9.iGH); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_child_version:"</span></span>); v4.append(arg9.iGX.iEx); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_series:"</span></span>); v4.append(arg9.iGX.iEw); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_cpu_arch:"</span></span>); v4.append(arg9.iGX.iEt); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_cpu_vfp3:"</span></span>); v4.append(arg9.iGX.iEv); v4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v4.append(v3_1); v4.append(<span class="hljs-string"><span class="hljs-string">"]apollo_cpu_vfp:"</span></span>); v4.append(arg9.iGX.iEu); ArrayList v3_2 = arg9.iGX.iEz; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3_2 != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; v3_2.size() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { Iterator v3_3 = v3_2.iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(v3_3.hasNext()) { Object v4_1 = v3_3.next(); StringBuilder v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v5.append(((au)v4_1).getName()); v5.append(<span class="hljs-string"><span class="hljs-string">"]component_name:"</span></span>); v5.append(((au)v4_1).getName()); v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v5.append(((au)v4_1).getName()); v5.append(<span class="hljs-string"><span class="hljs-string">"]component_ver_name:"</span></span>); v5.append(((au)v4_1).aDA()); v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v5.append(((au)v4_1).getName()); v5.append(<span class="hljs-string"><span class="hljs-string">"]component_ver_code:"</span></span>); v5.append(((au)v4_1).gBl); v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v5.append(((au)v4_1).getName()); v5.append(<span class="hljs-string"><span class="hljs-string">"]component_req_type:"</span></span>); v5.append(((au)v4_1).gBq); } } j v3_4 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> j(); mb(v3_4); h v4_2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> h(); mb(v4_2); ay v5_1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ay(); v3_4.hS(<span class="hljs-string"><span class="hljs-string">""</span></span>); v3_4.setImsi(<span class="hljs-string"><span class="hljs-string">""</span></span>); v3_4.hV(<span class="hljs-string"><span class="hljs-string">""</span></span>); v5_1.bPQ = v3_4; v5_1.bPP = v4_2; v5_1.yr(arg9.iGX.ipR); v5_1.gBF = arg9.iGX.mMode; v5_1.gBI = arg9.iGX.iEz; v3_2 = v5_1.gAr; c.aBh(); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"os_ver"</span></span>, c.getRomInfo())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"processor_arch"</span></span>, com.uc.baacgetCpuArch())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_arch"</span></span>, com.uc.baacPb())); String v4_3 = com.uc.baacPd(); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_vfp"</span></span>, v4_3)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"net_type"</span></span>, String.valueOf(com.uc.base.system.a.Jo()))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"fromhost"</span></span>, arg9.iGX.iEm)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"plugin_ver"</span></span>, arg9.iGX.iEn)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"target_lang"</span></span>, arg9.iGX.iEs)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"vitamio_cpu_arch"</span></span>, arg9.iGX.iEt)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"vitamio_vfp"</span></span>, arg9.iGX.iEu)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"vitamio_vfp3"</span></span>, arg9.iGX.iEv)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"plugin_child_ver"</span></span>, arg9.iGX.iEx)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"ver_series"</span></span>, arg9.iGX.iEw)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"child_ver"</span></span>, r.aVw())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cur_ver_md5"</span></span>, arg9.iGX.iEl)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cur_ver_signature"</span></span>, SystemHelper.getUCMSignature())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"upgrade_log"</span></span>, i.bjt())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"silent_install"</span></span>, String.valueOf(arg9.iGX.iDQ))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"silent_state"</span></span>, String.valueOf(arg9.iGX.iEp))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"silent_file"</span></span>, arg9.iGX.iEq)); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"silent_type"</span></span>, String.valueOf(arg9.iGX.iEr))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_archit"</span></span>, com.uc.baacPc())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_set"</span></span>, SystemHelper.getCpuInstruction())); <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> v4_4 = v4_3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || !v4_3.contains(<span class="hljs-string"><span class="hljs-string">"neon"</span></span>) ? <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"neon"</span></span>, String.valueOf(v4_4))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"cpu_cores"</span></span>, String.valueOf(com.uc.baacJl()))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"ram_1"</span></span>, String.valueOf(com.uc.baahPo()))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"totalram"</span></span>, String.valueOf(com.uc.baahOL()))); c.aBh(); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"rom_1"</span></span>, c.getRomInfo())); v4_5 = e.getScreenWidth(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v6 = e.getScreenHeight(); StringBuilder v7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); v7.append(v4_5); v7.append(<span class="hljs-string"><span class="hljs-string">"*"</span></span>); v7.append(v6); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"ss"</span></span>, v7.toString())); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"api_level"</span></span>, String.valueOf(Build$VERSION.SDK_INT))); v3_2.add(g.fs(<span class="hljs-string"><span class="hljs-string">"uc_apk_list"</span></span>, SystemHelper.getUCMobileApks())); Iterator v4_6 = arg9.iGX.iEA.entrySet().iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(v4_6.hasNext()) { Object v6_1 = v4_6.next(); v3_2.add(g.fs(((Map$Entry)v6_1).getKey(), ((Map$Entry)v6_1).getValue())); } v3 = v5_1.toByteArray(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.a(arg9, <span class="hljs-string"><span class="hljs-string">"up_encode"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } v4_5 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGw ? <span class="hljs-number"><span class="hljs-number">0x1F</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v3 = gi(v4_5, v3); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[v3.length + <span class="hljs-number"><span class="hljs-number">16</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v6_2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">16</span></span>]; Arrays.fill(v6_2, <span class="hljs-number"><span class="hljs-number">0</span></span>); v6_2[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0x5F</span></span>; v6_2[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>; v6_2[<span class="hljs-number"><span class="hljs-number">2</span></span>] = ((<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)v4_5); v6_2[<span class="hljs-number"><span class="hljs-number">3</span></span>] = -<span class="hljs-number"><span class="hljs-number">50</span></span>; System.arraycopy(v6_2, <span class="hljs-number"><span class="hljs-number">0</span></span>, v1, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); System.arraycopy(v3, <span class="hljs-number"><span class="hljs-number">0</span></span>, v1, <span class="hljs-number"><span class="hljs-number">16</span></span>, v3.length); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v1 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.a(arg9, <span class="hljs-string"><span class="hljs-string">"up_encrypt"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(TextUtils.isEmpty(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.mUpgradeUrl)) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.a(arg9, <span class="hljs-string"><span class="hljs-string">"up_url"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } StringBuilder v0 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v0.append(arg9.iGX.ipR); v0.append(<span class="hljs-string"><span class="hljs-string">"]url:"</span></span>); v0.append(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.mUpgradeUrl); com.uc.browser.core.dci v0_1 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI; v3_1 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.mUpgradeUrl; com.uc.base.net.e v0_2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> com.uc.base.net.e(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> com.uc.browser.core.dci$a(v0_1, arg9)); v3_1 = v3_1.contains(<span class="hljs-string"><span class="hljs-string">"?"</span></span>) ? v3_1 + <span class="hljs-string"><span class="hljs-string">"&amp;dataver=pb"</span></span> : v3_1 + <span class="hljs-string"><span class="hljs-string">"?dataver=pb"</span></span>; n v3_5 = v0_2.uc(v3_1); mb(v3_5, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); v3_5.setMethod(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>); v3_5.setBodyProvider(v1); v0_2.b(v3_5); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.a(arg9, <span class="hljs-string"><span class="hljs-string">"up_null"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"success"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGY.iGI.b(arg9); }</code> </pre> <br> æˆ‘ä»¬åœ¨è¿™é‡Œçœ‹åˆ°POSTè¯·æ±‚çš„å½¢æˆã€‚ æˆ‘ä»¬æè¯·æ³¨æ„16å­—èŠ‚æ•°ç»„çš„åˆ›å»ºåŠå…¶å¡«å……ï¼š0x5Fï¼Œ0ã€0x1Fï¼Œ-50ï¼ˆ= 0xCEï¼‰ã€‚ åŒ¹é…æˆ‘ä»¬åœ¨ä¸Šé¢çš„è¯·æ±‚ä¸­çœ‹åˆ°çš„å†…å®¹ã€‚ <br><br> åœ¨åŒä¸€ç±»ä¸­ï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ä¸€ä¸ªåµŒå¥—ç±»ï¼Œå…¶ä¸­æœ‰å¦ä¸€ä¸ªæœ‰è¶£çš„æ–¹æ³•ï¼š <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(l arg10, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] arg11)</span></span></span><span class="hljs-function"> </span></span>{ f v0 = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.iGQ; StringBuilder v1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"["</span></span>); v1.append(arg10.iGX.ipR); v1.append(<span class="hljs-string"><span class="hljs-string">"]:UpgradeSuccess"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v1_1 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11.length &lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11[<span class="hljs-number"><span class="hljs-number">0</span></span>] != <span class="hljs-number"><span class="hljs-number">0x60</span></span> &amp;&amp; arg11[<span class="hljs-number"><span class="hljs-number">3</span></span>] != <span class="hljs-number"><span class="hljs-number">0xFFFFFFD0</span></span>) { goto label_57; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v3 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v5 = arg11[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11[<span class="hljs-number"><span class="hljs-number">2</span></span>] != <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; arg11[<span class="hljs-number"><span class="hljs-number">2</span></span>] != <span class="hljs-number"><span class="hljs-number">11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg11[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0x1F</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v3 = <span class="hljs-number"><span class="hljs-number">0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v7 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[arg11.length - <span class="hljs-number"><span class="hljs-number">16</span></span>]; System.arraycopy(arg11, <span class="hljs-number"><span class="hljs-number">16</span></span>, v7, <span class="hljs-number"><span class="hljs-number">0</span></span>, v7.length); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v3 != <span class="hljs-number"><span class="hljs-number">0</span></span>) { v7 = gj(arg11[<span class="hljs-number"><span class="hljs-number">2</span></span>], v7); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v7 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { goto label_57; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v5 != <span class="hljs-number"><span class="hljs-number">0</span></span>) { v1_1 = gP(v7); goto label_57; } v1_1 = v7; } label_57: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v1_1 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { v0.iGY.iGI.a(arg10, <span class="hljs-string"><span class="hljs-string">"up_decrypt"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } q v11 = gb(arg10, v1_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v11 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { v0.iGY.iGI.a(arg10, <span class="hljs-string"><span class="hljs-string">"up_decode"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"fail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v0.iGY.iGt) { v0.d(arg10); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v0.iGY.iGo != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { v0.iGY.iGo.a(<span class="hljs-number"><span class="hljs-number">0</span></span>, ((o)v11)); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v0.iGY.iGs) { v0.iGY.a(((o)v11)); v0.iGY.iGI.a(v11, <span class="hljs-string"><span class="hljs-string">"up_silent"</span></span>, <span class="hljs-string"><span class="hljs-string">"yes"</span></span>, <span class="hljs-string"><span class="hljs-string">"success"</span></span>); v0.iGY.iGI.a(v11); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } v0.iGY.iGI.a(v11, <span class="hljs-string"><span class="hljs-string">"up_silent"</span></span>, <span class="hljs-string"><span class="hljs-string">"no"</span></span>, <span class="hljs-string"><span class="hljs-string">"success"</span></span>); } }</code> </pre> <br> è¯¥æ–¹æ³•æ¥æ”¶å­—èŠ‚æ•°ç»„ä½œä¸ºè¾“å…¥ï¼Œå¹¶æ£€æŸ¥é›¶å­—èŠ‚ä¸º0x60æˆ–ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¸º0xD0ï¼Œç¬¬äºŒä¸ªå­—èŠ‚ä¸º1ã€11æˆ–0x1Fã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹æœåŠ¡å™¨çš„ç­”æ¡ˆï¼šé›¶å­—èŠ‚-0x60ï¼Œç¬¬äºŒä¸ª-0x1Fï¼Œç¬¬ä¸‰ä¸ª-0x60ã€‚ çœ‹èµ·æ¥åƒæˆ‘ä»¬éœ€è¦çš„ã€‚ ä»å„è¡Œï¼ˆä¾‹å¦‚ï¼Œâ€œ up_decryptâ€ï¼‰æ¥çœ‹ï¼Œåº”è¯¥åœ¨æ­¤å¤„è°ƒç”¨ä¸€ç§è§£å¯†æœåŠ¡å™¨å“åº”çš„æ–¹æ³•ã€‚ <br> æˆ‘ä»¬ä¼ é€’ç»™<i>gj</i>æ–¹æ³•ã€‚ è¯·æ³¨æ„ï¼Œåç§»é‡ä¸º2çš„å­—èŠ‚ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º0x1Fï¼‰ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ è¾“åˆ°è¯¥å­—èŠ‚ï¼ŒæœåŠ¡å™¨å“åº”ä¸åŒ…å« <br> å‰16ä¸ªå­—èŠ‚ã€‚ <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] j(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> arg1, <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] arg2) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg1 == <span class="hljs-number"><span class="hljs-number">1</span></span>) { arg2 = cc(arg2, c.adu); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg1 == <span class="hljs-number"><span class="hljs-number">11</span></span>) { arg2 = m.aF(arg2); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(arg1 != <span class="hljs-number"><span class="hljs-number">0x1F</span></span>) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { arg2 = EncryptHelper.decrypt(arg2); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> arg2; }</code> </pre> <br> æ˜¾ç„¶ï¼Œå¯ä»¥é€‰æ‹©è§£å¯†ç®—æ³•å’Œç›¸åŒçš„å­—èŠ‚ï¼Œ <br>  caseä¸º0x1Fï¼Œè¡¨ç¤ºä¸‰ä¸ªå¯èƒ½çš„é€‰é¡¹ä¹‹ä¸€ã€‚ <br><br> æˆ‘ä»¬ç»§ç»­åˆ†æä»£ç ã€‚ ç»è¿‡å‡ æ¬¡è·³è½¬åï¼Œæˆ‘ä»¬è¿›å…¥äº†ä¸€ä¸ªå…·æœ‰å¯¹è¯åçš„æ–¹æ³•<i>cryptoBytesByKey</i> ã€‚ <br><br> åœ¨è¿™é‡Œï¼Œå¦å¤–ä¸¤ä¸ªå­—èŠ‚ä¸æˆ‘ä»¬çš„ç­”æ¡ˆåˆ†å¼€ï¼Œå¹¶ä»ä¸­è·å¾—ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ æ˜¾ç„¶ï¼Œä»¥è¿™ç§æ–¹å¼é€‰æ‹©äº†å¯†é’¥æ¥è§£å¯†æ¶ˆæ¯ã€‚ <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] decryptBytesByKey(<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytes) { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v0 = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(bytes != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(bytes.length &lt; EncryptHelper.PREFIX_BYTES_SIZE) { } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(bytes.length == EncryptHelper.PREFIX_BYTES_SIZE) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v0; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] prefix = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[EncryptHelper.PREFIX_BYTES_SIZE]; <span class="hljs-comment"><span class="hljs-comment">// 2  System.arraycopy(bytes, 0, prefix, 0, prefix.length); String keyId = c.ayR().d(ByteBuffer.wrap(prefix).getShort()); //   if(keyId == null) { return v0; } else { a v2 = EncryptHelper.ayL(); if(v2 == null) { return v0; } else { byte[] enrypted = new byte[bytes.length - EncryptHelper.PREFIX_BYTES_SIZE]; System.arraycopy(bytes, EncryptHelper.PREFIX_BYTES_SIZE, enrypted, 0, enrypted.length); return v2.l(keyId, enrypted); } } } } catch(SecException v7_1) { EncryptHelper.handleDecryptException(((Throwable)v7_1), v7_1.getErrorCode()); return v0; } catch(Throwable v7) { EncryptHelper.handleDecryptException(v7, 2); return v0; } } return v0; }</span></span></code> </pre> <br> å±•æœ›æœªæ¥ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ï¼Œç›®å‰è¿˜æ²¡æœ‰è·å¾—å¯†é’¥ï¼Œåªæœ‰å®ƒçš„â€œæ ‡è¯†ç¬¦â€ã€‚ è·å–å¯†é’¥æœ‰ç‚¹å¤æ‚ã€‚ <br><br> åœ¨ä¸‹ä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œå°†å¦å¤–ä¸¤ä¸ªæ·»åŠ åˆ°ç°æœ‰å‚æ•°ä¸­ï¼Œå…¶ä¸­æœ‰å››ä¸ªï¼šé­”æœ¯æ•°å­—16ï¼Œå¯†é’¥æ ‡è¯†ç¬¦ï¼ŒåŠ å¯†æ•°æ®å’Œéš¾ä»¥ç†è§£çš„å­—ç¬¦ä¸²ï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ä¸ºç©ºï¼‰ã€‚ <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] l(String keyId, <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] encrypted) <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> SecException { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.ayJ().staticBinarySafeDecryptNoB64(<span class="hljs-number"><span class="hljs-number">16</span></span>, keyId, encrypted, <span class="hljs-string"><span class="hljs-string">""</span></span>); }</code> </pre> <br> ç»è¿‡ä¸€ç³»åˆ—è½¬æ¢ä¹‹åï¼Œæˆ‘ä»¬åˆ°è¾¾<i>com.alibaba.wireless.security.open.staticdataencrypt.IStaticDataEncryptComponent</i>æ¥å£çš„<i>staticBinarySafeDecryptNoB64</i>æ–¹æ³•<i>ã€‚</i> ä¸»åº”ç”¨ç¨‹åºä»£ç ä¸­æ²¡æœ‰å®ç°è¯¥æ¥å£çš„ç±»ã€‚ è¿™æ ·çš„ç±»åœ¨æ–‡ä»¶<i>lib / armeabi-v7a / libsgmain.soä¸­</i> ï¼Œè¯¥æ–‡ä»¶å®é™…ä¸Šä¸æ˜¯.soï¼Œè€Œæ˜¯.jarã€‚ æˆ‘ä»¬æ„Ÿå…´è¶£çš„æ–¹æ³•å®ç°å¦‚ä¸‹ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.alibaba.wireless.security.ai; <span class="hljs-comment"><span class="hljs-comment">// ... public class a implements IStaticDataEncryptComponent { private ISecurityGuardPlugin a; // ... private byte[] a(int mode, int magicInt, int xzInt, String keyId, byte[] encrypted, String magicString) { return this.a.getRouter().doCommand(10601, new Object[]{Integer.valueOf(mode), Integer.valueOf(magicInt), Integer.valueOf(xzInt), keyId, encrypted, magicString}); } // ... private byte[] b(int magicInt, String keyId, byte[] encrypted, String magicString) { return this.a(2, magicInt, 0, keyId, encrypted, magicString); } // ... public byte[] staticBinarySafeDecryptNoB64(int magicInt, String keyId, byte[] encrypted, String magicString) throws SecException { if(keyId != null &amp;&amp; keyId.length() &gt; 0 &amp;&amp; magicInt &gt;= 0 &amp;&amp; magicInt &lt; 19 &amp;&amp; encrypted != null &amp;&amp; encrypted.length &gt; 0) { return this.b(magicInt, keyId, encrypted, magicString); } throw new SecException("", 301); } //... }</span></span></code> </pre> <br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çš„å‚æ•°åˆ—è¡¨ç”±å¦å¤–ä¸¤ä¸ªæ•´æ•°è¡¥å……ï¼š2å’Œ0ã€‚ <br>  <i>æ€»ä½“è€Œè¨€</i> ï¼Œ2è¡¨ç¤ºè§£å¯†ï¼Œå°±åƒ<i>javax.crypto.Cipher</i>ç³»ç»Ÿç±»çš„<i>doFinal</i>æ–¹æ³•ä¸€æ ·ã€‚ æ‰€æœ‰è¿™äº›éƒ½è¢«è½¬ç§»åˆ°ç¼–å·ä¸º10601çš„æŸä¸ªè·¯ç”±å™¨-æ˜¾ç„¶ï¼Œè¿™æ˜¯å‘½ä»¤ç¼–å·ã€‚ <br><br> åœ¨ä¸‹ä¸€ä¸ªè¿‡æ¸¡é“¾ä¹‹åï¼Œæˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªå®ç°<i>IRouterComponent</i>æ¥å£å’Œ<i>doCommand</i>æ–¹æ³•çš„ç±»ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.alibaba.wireless.security.mainplugin; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.alibaba.wireless.security.framework.IRouterComponent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.taobao.wireless.security.adapter.JNICLibrary; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">a</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IRouterComponent</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg2, Object[] arg3)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> JNICLibrary.doCommandNative(arg2, arg3); } }</code> </pre> <br> è¿˜æœ‰<i>JNICLibrary</i>ç±»ï¼Œå…¶ä¸­<i>å£°æ˜</i>äº†<i>doCommandNative</i>æœ¬æœºæ–¹æ³•ï¼š <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.taobao.wireless.security.adapter; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JNICLibrary</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">native</span></span></span><span class="hljs-function"> Object </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommandNative</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> arg0, Object[] arg1)</span></span></span></span>; }</code> </pre> <br> å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœ¬æœºä»£ç ä¸­æ‰¾åˆ°<i>doCommandNative</i>æ–¹æ³•ã€‚ ç„¶åä¹è¶£å°±å¼€å§‹äº†ã€‚ <br><br><h3> æœºå™¨ç æ··æ·† </h3><br>  <i>libsgmain.so</i>æ–‡ä»¶ï¼ˆå®é™…ä¸Šæ˜¯.jarï¼‰ä¸­æœ‰ä¸€ä¸ªæœ¬æœºåº“ï¼š <i>libsgmainso-6.4.36.so</i> ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬å‘ç°äº†ä¸€äº›æ›´é«˜ä¸€äº›åŠ å¯†æ¥å£çš„<i>å®ç°</i> ã€‚ åœ¨IDAä¸­å°†å…¶æ‰“å¼€ï¼Œå¹¶è·å¾—ä¸€å †å¸¦æœ‰é”™è¯¯çš„å¯¹è¯æ¡†ã€‚ é—®é¢˜åœ¨äºèŠ‚å¤´è¡¨æ— æ•ˆã€‚ è¿™æ ·åšæ˜¯ä¸ºäº†ä½¿åˆ†æå¤æ‚åŒ–ã€‚ <br><br><img src="https://habrastorage.org/webt/_k/bz/5c/_kbz5cbedw6g1jnsj047rtqudli.jpeg"><br><br> ä½†è¿™ä¹Ÿä¸æ˜¯å¿…éœ€çš„ï¼šä¸ºäº†æ­£ç¡®åŠ è½½ELFæ–‡ä»¶å¹¶è¿›è¡Œåˆ†æï¼Œç¨‹åºå¤´è¡¨å°±è¶³å¤Ÿäº†ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€åˆ é™¤èŠ‚è¡¨ï¼Œå³å¯ä½¿æ ‡é¢˜ä¸­çš„ç›¸åº”å­—æ®µæ— æ•ˆã€‚ <br><br><img src="https://habrastorage.org/webt/2y/xh/vk/2yxhvksp30f016gfyhrlfh0pklc.jpeg"><br><br> å†æ¬¡åœ¨IDAä¸­æ‰“å¼€æ–‡ä»¶ã€‚ <br><br> æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å‡†ç¡®åœ°å‘ŠçŸ¥Javaè™šæ‹Ÿæœºæœ¬æœºåº“ä¸­Javaä»£ç ä¸­å£°æ˜ä¸ºæœ¬æœºçš„æ–¹æ³•çš„å®ç°ä½äºä½•å¤„ã€‚ é¦–å…ˆæ˜¯ç»™å®ƒä¸€ä¸ªåç§°ï¼Œå½¢å¼ä¸º<i>Java_package_name_ClassName_Method_name</i> ã€‚ <br><br> ç¬¬äºŒç§æ˜¯åœ¨åŠ è½½åº“æ—¶æ³¨å†Œå®ƒï¼ˆåœ¨<i>JNI_OnLoad</i>å‡½æ•°ä¸­ï¼‰ <br> é€šè¿‡è°ƒç”¨<i>RegisterNatives</i>å‡½æ•°ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä½¿ç”¨ç¬¬ä¸€ç§æ–¹æ³•ï¼Œåˆ™åç§°åº”ç±»ä¼¼äºï¼š <i>Java_com_taobao_wireless_security_adapter_JNICLibrary_doCommandNative</i> ã€‚ <br><br> åœ¨å¯¼å‡ºçš„å‡½æ•°ä¸­ï¼Œæ²¡æœ‰è¿™æ ·çš„å‡½æ•°ï¼Œå› æ­¤æ‚¨éœ€è¦æŸ¥æ‰¾å¯¹<i>RegisterNatives</i>çš„è°ƒç”¨ã€‚ <br> æˆ‘ä»¬è½¬åˆ°<i>JNI_OnLoad</i>å‡½æ•°å¹¶æŸ¥çœ‹ä¸‹å›¾ï¼š <br><br><img src="https://habrastorage.org/webt/m6/dp/iw/m6dpiwaonfuyri-jg8thppcfgqe.jpeg"><br><br> è¿™æ˜¯æ€ä¹ˆå›äº‹ ä¹ä¸€çœ‹ï¼Œè¯¥åŠŸèƒ½çš„å¼€å§‹å’Œç»“æŸæ˜¯ARMä½“ç³»ç»“æ„çš„å…¸å‹ç‰¹å¾ã€‚ å †æ ˆä¸Šçš„ç¬¬ä¸€æ¡æŒ‡ä»¤å­˜å‚¨å‡½æ•°å°†åœ¨å…¶å·¥ä½œä¸­ä½¿ç”¨çš„å¯„å­˜å™¨çš„å†…å®¹ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºR0ï¼ŒR1å’ŒR2ï¼‰ï¼Œä»¥åŠå¯„å­˜å™¨LRçš„å†…å®¹ï¼Œå…¶ä¸­åŒ…å«å‡½æ•°çš„è¿”å›åœ°å€ã€‚ ä½¿ç”¨æœ€åä¸€æ¡æŒ‡ä»¤ï¼Œå°†æ¢å¤ä¿å­˜çš„å¯„å­˜å™¨ï¼Œå¹¶å°†è¿”å›åœ°å€ç«‹å³æ”¾ç½®åœ¨PCå¯„å­˜å™¨ä¸­ï¼Œä»è€Œä»å‡½æ•°è¿”å›ã€‚ ä½†æ˜¯ï¼Œå¦‚æœä»”ç»†è§‚å¯Ÿï¼Œæ‚¨ä¼šå‘ç°å€’æ•°ç¬¬äºŒæ¡æŒ‡ä»¤ä¼šæ›´æ”¹å­˜å‚¨åœ¨å †æ ˆä¸­çš„è¿”å›åœ°å€ã€‚ æˆ‘ä»¬è®¡ç®—ä¹‹å <br> ä»£ç æ‰§è¡Œã€‚ å°†æŸä¸ªåœ°å€0xB130è£…å…¥R1ï¼Œä»ä¸­å‡å»5ï¼Œç„¶åå°†å…¶ä¼ é€åˆ°R0ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ 0x10ã€‚ åŸæ¥æ˜¯0xB13Bã€‚ å› æ­¤ï¼ŒIDAè®¤ä¸ºåœ¨æœ€åä¸€æ¡æŒ‡ä»¤ä¸­ï¼Œè¯¥å‡½æ•°æœ‰æ­£å¸¸è¿”å›ï¼Œä½†å®é™…ä¸Šå­˜åœ¨åˆ°è®¡ç®—åœ°å€0xB13Bçš„è½¬æ¢ã€‚ <br><br> å€¼å¾—å›é¡¾çš„æ˜¯ï¼ŒARMå¤„ç†å™¨å…·æœ‰ä¸¤ç§æ¨¡å¼å’Œä¸¤ç»„æŒ‡ä»¤ï¼šARMå’ŒThumbã€‚ åœ°å€çš„æœ€ä½æœ‰æ•ˆä½å‘Šè¯‰å¤„ç†å™¨æ­£åœ¨ä½¿ç”¨å“ªä¸ªæŒ‡ä»¤é›†ã€‚ å³ï¼Œè¯¥åœ°å€å®é™…ä¸Šæ˜¯0xB13Aï¼Œä½ä½çš„å•ä½è¡¨ç¤ºThumbæ¨¡å¼ã€‚ <br><br> åœ¨è¯¥åº“ä¸­æ¯ä¸ªå‡½æ•°çš„å¼€å¤´éƒ½æ·»åŠ äº†ä¸€ä¸ªç±»ä¼¼çš„â€œé€‚é…å™¨â€ï¼Œ <br> åƒåœ¾ä»£ç ã€‚ æ­¤å¤–ï¼Œæˆ‘ä»¬ä¸ä¼šè¯¦ç»†ä»‹ç»å®ƒä»¬-æˆ‘ä»¬åªè®°å¾— <br> å‡ ä¹æ‰€æœ‰åŠŸèƒ½çš„çœŸæ­£å¼€å§‹è¿˜æœ‰ä¸€ç‚¹ã€‚ <br><br> ç”±äºä»£ç ä¸­æ²¡æœ‰æ˜ç¡®è¿‡æ¸¡åˆ°0xB13Aï¼Œå› æ­¤IDAæœ¬èº«æ— æ³•è¯†åˆ«è¯¥ä»£ç åœ¨è¯¥ä½ç½®ã€‚ ç”±äºç›¸åŒçš„åŸå› ï¼Œå®ƒæ— æ³•å°†åº“ä¸­çš„å¤§å¤šæ•°ä»£ç è¯†åˆ«ä¸ºä»£ç ï¼Œè¿™ä½¿å¾—åˆ†ææœ‰äº›å›°éš¾ã€‚ æˆ‘ä»¬å‘Šè¯‰IDAä»£ç åœ¨è¿™é‡Œï¼Œç»“æœå¦‚ä¸‹ï¼š <br><br><img src="https://habrastorage.org/webt/eq/wp/p3/eqwpp3exmqnybi7r_tdvvan4jls.png"><br><br> è¡¨æ ¼ä»0xB144å¼€å§‹ã€‚ é‚£sub_494Cå‘¢ï¼Ÿ <br><br><img src="https://habrastorage.org/webt/bo/9b/rn/bo9brnkfvauy3ntm2dnucnsxqhs.png"><br><br> åœ¨LRå¯„å­˜å™¨ä¸­è°ƒç”¨æ­¤å‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å°†è·å¾—ä¸Šè¿°è¡¨çš„åœ°å€ï¼ˆ0xB144ï¼‰ã€‚ åœ¨R0ä¸­ï¼Œæ­¤è¡¨ä¸­çš„ç´¢å¼•ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä»è¡¨ä¸­è·å–ä¸€ä¸ªå€¼ï¼Œå°†å…¶æ·»åŠ åˆ°LRå¹¶è·å¾— <br> åœ°å€å»ã€‚ è®©æˆ‘ä»¬å°è¯•è®¡ç®—å®ƒï¼š0xB144 + [0xB144 + 8 * 4] = 0xB144 + 0x120 = 0xB264ã€‚ æˆ‘ä»¬è½¬åˆ°æ¥æ”¶åˆ°çš„åœ°å€ï¼Œä»…çœ‹åˆ°ä¸€äº›æœ‰ç”¨çš„è¯´æ˜ï¼Œç„¶åå†æ¬¡è½¬æ¢åˆ°0xB140ï¼š <br><br><img src="https://habrastorage.org/webt/nz/95/4x/nz954xqtjmky6tnpaqeejhvecus.png"><br><br> ç°åœ¨ï¼Œè¡¨ä¸­çš„ç´¢å¼•åç§»é‡ä¸º0x20ã€‚ <br><br> ä»è¡¨çš„å¤§å°æ¥çœ‹ï¼Œä»£ç ä¸­æœ‰è®¸å¤šè¿™æ ·çš„è½¬æ¢ã€‚ é—®é¢˜æ˜¯ï¼Œæ˜¯å¦æœ‰å¯èƒ½ä»¥æŸç§æ–¹å¼æ›´è‡ªåŠ¨åœ°å¤„ç†æ­¤é—®é¢˜ï¼Œè€Œæ— éœ€æ‰‹åŠ¨è®¡ç®—åœ°å€ã€‚ è„šæœ¬å’ŒIDAä¸­è¡¥ä¸ä»£ç çš„åŠŸèƒ½ä¸ºæˆ‘ä»¬æä¾›äº†å¸®åŠ©ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">put_unconditional_branch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(source, destination)</span></span></span><span class="hljs-function">:</span></span> offset = (destination - source - <span class="hljs-number"><span class="hljs-number">4</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset &gt; <span class="hljs-number"><span class="hljs-number">2097151</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> offset &lt; <span class="hljs-number"><span class="hljs-number">-2097152</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> RuntimeError(<span class="hljs-string"><span class="hljs-string">"Invalid offset"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset &gt; <span class="hljs-number"><span class="hljs-number">1023</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> offset &lt; <span class="hljs-number"><span class="hljs-number">-1024</span></span>: instruction1 = <span class="hljs-number"><span class="hljs-number">0xf000</span></span> | ((offset &gt;&gt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) instruction2 = <span class="hljs-number"><span class="hljs-number">0xb800</span></span> | (offset &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) patch_word(source, instruction1) patch_word(source + <span class="hljs-number"><span class="hljs-number">2</span></span>, instruction2) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: instruction = <span class="hljs-number"><span class="hljs-number">0xe000</span></span> | (offset &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) patch_word(source, instruction) ea = here() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> get_wide_word(ea) == <span class="hljs-number"><span class="hljs-number">0xb503</span></span>: <span class="hljs-comment"><span class="hljs-comment">#PUSH {R0,R1,LR} ea1 = ea + 2 if get_wide_word(ea1) == 0xbf00: #NOP ea1 += 2 if get_operand_type(ea1, 0) == 1 and get_operand_value(ea1, 0) == 0 and get_operand_type(ea1, 1) == 2: index = get_wide_dword(get_operand_value(ea1, 1)) print "index =", hex(index) ea1 += 2 if get_operand_type(ea1, 0) == 7: table = get_operand_value(ea1, 0) + 4 elif get_operand_type(ea1, 1) == 2: table = get_operand_value(ea1, 1) + 4 else: print "Wrong operand type on", hex(ea1), "-", get_operand_type(ea1, 0), get_operand_type(ea1, 1) table = None if table is None: print "Unable to find table" else: print "table =", hex(table) offset = get_wide_dword(table + (index &lt;&lt; 2)) put_unconditional_branch(ea, table + offset) else: print "Unknown code", get_operand_type(ea1, 0), get_operand_value(ea1, 0), get_operand_type(ea1, 1) == 2 else: print "Unable to detect first instruction"</span></span></code> </pre> <br> æˆ‘ä»¬å°†å…‰æ ‡æ”¾åœ¨è¡Œ0xB26Aä¸Šï¼Œè¿è¡Œè„šæœ¬å¹¶æŸ¥çœ‹åˆ°0xB4B0çš„è¿‡æ¸¡ï¼š <br><br><img src="https://habrastorage.org/webt/52/rf/fx/52rffxhzmtrfdhfrznsr8dovfim.png"><br><br>  IDAå†æ¬¡æ²¡æœ‰å°†è¯¥ç«™ç‚¹è¯†åˆ«ä¸ºä»£ç ã€‚ æˆ‘ä»¬å¸®åŠ©å¥¹ï¼Œå¹¶åœ¨é‚£é‡Œçœ‹åˆ°å¦ä¸€ç§å»ºç­‘ï¼š <br><br><img src="https://habrastorage.org/webt/ct/d9/kv/ctd9kvewm9l1blmw3pqipi8mnqm.png"><br><br>  BLXä¹‹åçš„æŒ‡ä»¤çœ‹èµ·æ¥ä¸æ˜¯å¾ˆæœ‰æ„ä¹‰ï¼Œæ›´åƒæ˜¯æŸç§åè§ã€‚ æˆ‘ä»¬çœ‹ä¸€ä¸‹sub_4964ï¼š <br><br><img src="https://habrastorage.org/webt/o7/wi/4-/o7wi4-imrothkr6qpkbrklj40aw.png"><br><br> å®é™…ä¸Šï¼Œè¿™é‡Œçš„åŒå­—æ˜¯åœ¨ä½äºLRä¸­çš„åœ°å€å¤„æå–çš„ï¼Œå¹¶æ·»åŠ åˆ°è¯¥åœ°å€ï¼Œç„¶ååœ¨æ¥æ”¶åˆ°çš„åœ°å€å¤„è·å–å€¼å¹¶å°†å…¶å‹å…¥å †æ ˆã€‚ å¦å¤–ï¼Œåœ¨LRä¸­æ·»åŠ äº†4ï¼Œä»¥ä¾¿åœ¨ä»å‡½æ•°è¿”å›åè·³è½¬ç›¸åŒçš„åç§»é‡ã€‚ ç„¶åPOP {R1}å‘½ä»¤ä»å †æ ˆä¸­æå–æ¥æ”¶åˆ°çš„å€¼ã€‚ å¦‚æœæŸ¥çœ‹åœ°å€0xB4BA + 0xEA = 0xB5A4ï¼Œåˆ™ä¼šçœ‹åˆ°ç±»ä¼¼äºåœ°å€è¡¨çš„å†…å®¹ï¼š <br><br><img src="https://habrastorage.org/webt/ev/hb/a8/evhba8ty8dtnv8niuxyfue0nkfk.png"><br><br> è¦ä¿®è¡¥æ­¤è®¾è®¡ï¼Œæ‚¨éœ€è¦ä»ä»£ç ä¸­è·å–ä¸¤ä¸ªå‚æ•°ï¼šåç§»é‡å’Œè¦å°†ç»“æœæ”¾å…¥å…¶ä¸­çš„å¯„å­˜å™¨å·ã€‚ å¯¹äºæ¯ä¸ªå¯èƒ½çš„å¯„å­˜å™¨ï¼Œæ‚¨éƒ½å¿…é¡»äº‹å…ˆå‡†å¤‡ä¸€æ®µä»£ç ã€‚ <br><br><pre> <code class="python hljs">patches = {} patches[<span class="hljs-number"><span class="hljs-number">0</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x48</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">1</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x49</span></span>, <span class="hljs-number"><span class="hljs-number">0x09</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">2</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x4a</span></span>, <span class="hljs-number"><span class="hljs-number">0x12</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">3</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x4b</span></span>, <span class="hljs-number"><span class="hljs-number">0x1b</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">4</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x4c</span></span>, <span class="hljs-number"><span class="hljs-number">0x24</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">5</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0x4d</span></span>, <span class="hljs-number"><span class="hljs-number">0x2d</span></span>, <span class="hljs-number"><span class="hljs-number">0x68</span></span>, <span class="hljs-number"><span class="hljs-number">0x02</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">8</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0xd8</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x80</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">9</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0xd9</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0x90</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">10</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0xda</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xa0</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) patches[<span class="hljs-number"><span class="hljs-number">11</span></span>] = (<span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xbf</span></span>, <span class="hljs-number"><span class="hljs-number">0xdf</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x06</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-number"><span class="hljs-number">0xdb</span></span>, <span class="hljs-number"><span class="hljs-number">0xf8</span></span>, <span class="hljs-number"><span class="hljs-number">0x00</span></span>, <span class="hljs-number"><span class="hljs-number">0xb0</span></span>, <span class="hljs-number"><span class="hljs-number">0x01</span></span>, <span class="hljs-number"><span class="hljs-number">0xe0</span></span>) ea = here() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (get_wide_word(ea) == <span class="hljs-number"><span class="hljs-number">0xb082</span></span> <span class="hljs-comment"><span class="hljs-comment">#SUB SP, SP, #8 and get_wide_word(ea + 2) == 0xb503): #PUSH {R0,R1,LR} if get_operand_type(ea + 4, 0) == 7: pop = get_bytes(ea + 12, 4, 0) if pop[1] == '\xbc': register = -1 r = get_wide_byte(ea + 12) for i in range(8): if r == (1 &lt;&lt; i): register = i break if register == -1: print "Unable to detect register" else: address = get_wide_dword(ea + 8) + ea + 8 for b in patches[register]: patch_byte(ea, b) ea += 1 if ea % 4 != 0: ea += 2 patch_dword(ea, address) elif pop[:3] == '\x5d\xf8\x04': register = ord(pop[3]) &gt;&gt; 4 if register in patches: address = get_wide_dword(ea + 8) + ea + 8 for b in patches[register]: patch_byte(ea, b) ea += 1 patch_dword(ea, address) else: print "POP instruction not found" else: print "Wrong operand type on +4:", get_operand_type(ea + 4, 0) else: print "Unable to detect first instructions"</span></span></code> </pre> <br> æˆ‘ä»¬å°†å…‰æ ‡æ”¾åœ¨è¦æ›¿æ¢çš„ç»“æ„çš„å¼€å¤´-0xB4B2-å¹¶è¿è¡Œè„šæœ¬ï¼š <br><br><img src="https://habrastorage.org/webt/lv/mp/oo/lvmpoow5agndjnbbl-t3imyaisq.jpeg"><br><br> é™¤äº†ä»£ç ä¸­å·²ç»æåˆ°çš„æ„é€ ä¹‹å¤–ï¼Œè¿™é‡Œè¿˜æœ‰ï¼š <br><br><img src="https://habrastorage.org/webt/dk/nn/rw/dknnrwaye18zzz0xipny0_gdqfq.png"><br><br> ä¸å‰é¢çš„æƒ…å†µä¸€æ ·ï¼Œåœ¨BLXæŒ‡ä»¤ä¹‹åï¼Œæœ‰ä¸€ä¸ªåç§»é‡ï¼š <br><br><img src="https://habrastorage.org/webt/fn/bw/uz/fnbwuzpo3qw1hp3vd9rvr2xfq1k.jpeg"><br><br> æˆ‘ä»¬å°†åç§»é‡ç§»åˆ°LRçš„åœ°å€ï¼Œå°†å…¶æ·»åŠ åˆ°LRå¹¶è½¬åˆ°é‚£é‡Œã€‚  0x72044 + 0xC = 0x72050ã€‚ æ­¤è®¾è®¡çš„è„šæœ¬éå¸¸ç®€å•ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">put_unconditional_branch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(source, destination)</span></span></span><span class="hljs-function">:</span></span> offset = (destination - source - <span class="hljs-number"><span class="hljs-number">4</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset &gt; <span class="hljs-number"><span class="hljs-number">2097151</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> offset &lt; <span class="hljs-number"><span class="hljs-number">-2097152</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> RuntimeError(<span class="hljs-string"><span class="hljs-string">"Invalid offset"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> offset &gt; <span class="hljs-number"><span class="hljs-number">1023</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> offset &lt; <span class="hljs-number"><span class="hljs-number">-1024</span></span>: instruction1 = <span class="hljs-number"><span class="hljs-number">0xf000</span></span> | ((offset &gt;&gt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) instruction2 = <span class="hljs-number"><span class="hljs-number">0xb800</span></span> | (offset &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) patch_word(source, instruction1) patch_word(source + <span class="hljs-number"><span class="hljs-number">2</span></span>, instruction2) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: instruction = <span class="hljs-number"><span class="hljs-number">0xe000</span></span> | (offset &amp; <span class="hljs-number"><span class="hljs-number">0x7ff</span></span>) patch_word(source, instruction) ea = here() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> get_wide_word(ea) == <span class="hljs-number"><span class="hljs-number">0xb503</span></span>: <span class="hljs-comment"><span class="hljs-comment">#PUSH {R0,R1,LR} ea1 = ea + 6 if get_wide_word(ea + 2) == 0xbf00: #NOP ea1 += 2 offset = get_wide_dword(ea1) put_unconditional_branch(ea, (ea1 + offset) &amp; 0xffffffff) else: print "Unable to detect first instruction"</span></span></code> </pre> <br> è„šæœ¬çš„ç»“æœï¼š <br><br><img src="https://habrastorage.org/webt/tm/fq/yo/tmfqyogtdhbje0atjckosbrgide.jpeg"><br><br> åœ¨åŠŸèƒ½ä¸­ä¿®è¡¥äº†æ‰€æœ‰å†…å®¹ä¹‹åï¼Œæ‚¨å¯ä»¥å°†IDAæŒ‡å‘å…¶çœŸæ­£çš„èµ·ç‚¹ã€‚ å®ƒä¼šåˆ†æ®µæ”¶é›†æ‰€æœ‰åŠŸèƒ½ä»£ç ï¼Œå¹¶ä¸”å¯ä»¥ä½¿ç”¨HexRayså¯¹å…¶è¿›è¡Œåç¼–è¯‘ã€‚ <br><br><h3> è§£ç å­—ç¬¦ä¸² </h3><br> æˆ‘ä»¬ä»UCæµè§ˆå™¨çš„<i>libsgmainso-6.4.36.so</i>åº“ä¸­äº†è§£äº†å¦‚ä½•å¤„ç†æœºå™¨ä»£ç æ··æ·†ï¼Œå¹¶è·å¾—äº†<i>JNI_OnLoad</i>å‡½æ•°çš„ä»£ç ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">real_JNI_OnLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JavaVM *vm)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> result; <span class="hljs-comment"><span class="hljs-comment">// r0 jclass clazz; // r0 MAPDST int v4; // r0 JNIEnv *env; // r4 int v6; // [sp-40h] [bp-5Ch] int v7; // [sp+Ch] [bp-10h] v7 = *(_DWORD *)off_8AC00; if ( !vm ) goto LABEL_39; sub_7C4F4(); env = (JNIEnv *)sub_7C5B0(0); if ( !env ) goto LABEL_39; v4 = sub_72CCC(); sub_73634(v4); sub_73E24(&amp;unk_83EA6, &amp;v6, 49); clazz = (jclass)((int (__fastcall *)(JNIEnv *, int *))(*env)-&gt;FindClass)(env, &amp;v6); if ( clazz &amp;&amp; (sub_9EE4(), sub_71D68(env), sub_E7DC(env) &gt;= 0 &amp;&amp; sub_69D68(env) &gt;= 0 &amp;&amp; sub_197B4(env, clazz) &gt;= 0 &amp;&amp; sub_E240(env, clazz) &gt;= 0 &amp;&amp; sub_B8B0(env, clazz) &gt;= 0 &amp;&amp; sub_5F0F4(env, clazz) &gt;= 0 &amp;&amp; sub_70640(env, clazz) &gt;= 0 &amp;&amp; sub_11F3C(env) &gt;= 0 &amp;&amp; sub_21C3C(env, clazz) &gt;= 0 &amp;&amp; sub_2148C(env, clazz) &gt;= 0 &amp;&amp; sub_210E0(env, clazz) &gt;= 0 &amp;&amp; sub_41B58(env, clazz) &gt;= 0 &amp;&amp; sub_27920(env, clazz) &gt;= 0 &amp;&amp; sub_293E8(env, clazz) &gt;= 0 &amp;&amp; sub_208F4(env, clazz) &gt;= 0) ) { result = (sub_B7B0(env, clazz) &gt;&gt; 31) | 0x10004; } else { LABEL_39: result = -1; } return result; }</span></span></code> </pre> <br> è¯·ä»”ç»†è€ƒè™‘ä»¥ä¸‹å‡ è¡Œï¼š <br><br><pre> <code class="cpp hljs"> sub_73E24(&amp;unk_83EA6, &amp;v6, <span class="hljs-number"><span class="hljs-number">49</span></span>); clazz = (jclass)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> (__fastcall *)(JNIEnv *, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> *))(*env)-&gt;FindClass)(env, &amp;v6);</code> </pre> <br>  <i>sub_73E24</i>å‡½æ•°æ˜¾å¼è§£å¯†ç±»åç§°ã€‚<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½œä¸ºæ­¤å‡½æ•°çš„å‚æ•°ï¼Œä¼ é€’äº†ç±»ä¼¼äºåŠ å¯†æ•°æ®çš„æŒ‡é’ˆï¼Œç¼“å†²åŒºå’Œæ•°å­—ã€‚æ˜¾ç„¶ï¼Œåœ¨è°ƒç”¨è¯¥å‡½æ•°ä¹‹åï¼Œç¼“å†²åŒºå°†</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŒ…å«ä¸€æ¡</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">è§£å¯†çš„è¡Œï¼Œ</font><i><font style="vertical-align: inherit;">å› ä¸º</font></i><font style="vertical-align: inherit;">å®ƒå°†ä¼ é€’ç»™</font><i><font style="vertical-align: inherit;">FindClass</font></i><font style="vertical-align: inherit;">å‡½æ•°</font><font style="vertical-align: inherit;">ï¼Œè¯¥</font><font style="vertical-align: inherit;">å‡½æ•°</font><font style="vertical-align: inherit;">å°†ç±»åä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚å› æ­¤ï¼Œæ•°å­—æ˜¯ç¼“å†²åŒºçš„å¤§å°æˆ–å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚è®©æˆ‘ä»¬å°è¯•ç ´è¯‘ç±»çš„åç§°ï¼Œå®ƒåº”è¯¥å‘Šè¯‰æˆ‘ä»¬æˆ‘ä»¬æ˜¯å¦æœç€æ­£ç¡®çš„æ–¹å‘å‰è¿›ã€‚è®©æˆ‘ä»¬</font><i><font style="vertical-align: inherit;">ä»”ç»†çœ‹çœ‹sub_73E24ä¸­</font></i><font style="vertical-align: inherit;">ä¼šå‘ç”Ÿä»€ä¹ˆ</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font></font></i> <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_73E56</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> __int8 *in, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">unsigned</span></span></span></span><span class="hljs-function"><span class="hljs-params"> __int8 *out, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">size_t</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v4; <span class="hljs-comment"><span class="hljs-comment">// r6 int v7; // r11 int v8; // r9 int v9; // r4 size_t v10; // r5 int v11; // r0 struc_1 v13; // [sp+0h] [bp-30h] int v14; // [sp+1Ch] [bp-14h] int v15; // [sp+20h] [bp-10h] v4 = 0; v15 = *(_DWORD *)off_8AC00; v14 = 0; v7 = sub_7AF78(17); v8 = sub_7AF78(size); if ( !v7 ) { v9 = 0; goto LABEL_12; } (*(void (__fastcall **)(int, const char *, int))(v7 + 12))(v7, "DcO/lcK+h?m3c*q@", 16); if ( !v8 ) { LABEL_9: v4 = 0; goto LABEL_10; } v4 = 0; if ( !in ) { LABEL_10: v9 = 0; goto LABEL_11; } v9 = 0; if ( out ) { memset(out, 0, size); v10 = size - 1; (*(void (__fastcall **)(int, unsigned __int8 *, size_t))(v8 + 12))(v8, in, v10); memset(&amp;v13, 0, 0x14u); v13.field_4 = 3; v13.field_10 = v7; v13.field_14 = v8; v11 = sub_6115C(&amp;v13, &amp;v14); v9 = v11; if ( v11 ) { if ( *(_DWORD *)(v11 + 4) == v10 ) { qmemcpy(out, *(const void **)v11, v10); v4 = *(_DWORD *)(v9 + 4); } else { v4 = 0; } goto LABEL_11; } goto LABEL_9; } LABEL_11: sub_7B148(v7); LABEL_12: if ( v8 ) sub_7B148(v8); if ( v9 ) sub_7B148(v9); return v4; }</span></span></code> </pre> <br>  <i>sub_7AF78</i>         (      ).     :     <i>Â«DcO/lcK+h?m3c*q@Â»</i> ( ,   ),   â€”  .       ,    <i>sub_6115C</i> .         3. ,      . <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_611B4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(struc_1 *a1, _DWORD *a2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v3; <span class="hljs-comment"><span class="hljs-comment">// lr unsigned int v4; // r1 int v5; // r0 int v6; // r1 int result; // r0 int v8; // r0 *a2 = 820000; if ( a1 ) { v3 = a1-&gt;field_14; if ( v3 ) { v4 = a1-&gt;field_4; if ( v4 &lt; 0x19 ) { switch ( v4 ) { case 0u: v8 = sub_6419C(a1-&gt;field_0, a1-&gt;field_10, v3); goto LABEL_17; case 3u: v8 = sub_6364C(a1-&gt;field_0, a1-&gt;field_10, v3); goto LABEL_17; case 0x10u: case 0x11u: case 0x12u: v8 = sub_612F4( a1-&gt;field_0, v4, *(_QWORD *)&amp;a1-&gt;field_8, *(_QWORD *)&amp;a1-&gt;field_8 &gt;&gt; 32, a1-&gt;field_10, v3, a2); goto LABEL_17; case 0x14u: v8 = sub_63A28(a1-&gt;field_0, v3); goto LABEL_17; case 0x15u: sub_61A60(a1-&gt;field_0, v3, a2); return result; case 0x16u: v8 = sub_62440(a1-&gt;field_14); goto LABEL_17; case 0x17u: v8 = sub_6226C(a1-&gt;field_10, v3); goto LABEL_17; case 0x18u: v8 = sub_63530(a1-&gt;field_14); LABEL_17: v6 = 0; if ( v8 ) { *a2 = 0; v6 = v8; } return v6; default: LOWORD(v5) = 28032; goto LABEL_5; } } } } LOWORD(v5) = -27504; LABEL_5: HIWORD(v5) = 13; v6 = 0; *a2 = v5; return v6; }</span></span></code> </pre> <br>    switch   ,      3.  case 3:   <i>sub_6364C</i>    ,       , . .    .     <i>sub_6364C</i> ,      RC4. <br><br>      .    .   : <i>com/taobao/wireless/security/adapter/JNICLibrary</i> . å¤ªå¥½äº†ï¼    . <br><br><h3>   </h3><br>     <i>RegisterNatives</i> ,      <i>doCommandNative</i> .  ,   <i>JNI_OnLoad,</i>     <i>sub_B7B0</i> : <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_B7F6</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JNIEnv *env, jclass clazz)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> signature[<span class="hljs-number"><span class="hljs-number">41</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// [sp+7h] [bp-55h] char name[16]; // [sp+30h] [bp-2Ch] JNINativeMethod method; // [sp+40h] [bp-1Ch] int v8; // [sp+4Ch] [bp-10h] v8 = *(_DWORD *)off_8AC00; decryptString((unsigned __int8 *)&amp;unk_83ED9, (unsigned __int8 *)name, 0x10u);// doCommandNative decryptString((unsigned __int8 *)&amp;unk_83EEA, (unsigned __int8 *)signature, 0x29u);// (I[Ljava/lang/Object;)Ljava/lang/Object; method.name = name; method.signature = signature; method.fnPtr = sub_B69C; return ((int (__fastcall *)(JNIEnv *, jclass, JNINativeMethod *, int))(*env)-&gt;RegisterNatives)(env, clazz, &amp;method, 1) &gt;&gt; 31; }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®é™…ä¸Šï¼Œè¿™é‡Œæ³¨å†Œäº†ä¸€ä¸ªåä¸º</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">doCommandNative</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„æœ¬åœ°æ–¹æ³•</font><font style="vertical-align: inherit;">ã€‚ç°åœ¨æˆ‘ä»¬çŸ¥é“ä»–çš„åœ°å€ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ä»–çš„å·¥ä½œã€‚</font></font><br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> __<span class="hljs-function"><span class="hljs-function">fastcall </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doCommandNative</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(JNIEnv *env, jobject obj, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> command, jarray args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v5; <span class="hljs-comment"><span class="hljs-comment">// r5 struc_2 *a5; // r6 int v9; // r1 int v11; // [sp+Ch] [bp-14h] int v12; // [sp+10h] [bp-10h] v5 = 0; v12 = *(_DWORD *)off_8AC00; v11 = 0; a5 = (struc_2 *)malloc(0x14u); if ( a5 ) { a5-&gt;field_0 = 0; a5-&gt;field_4 = 0; a5-&gt;field_8 = 0; a5-&gt;field_C = 0; v9 = command % 10000 / 100; a5-&gt;field_0 = command / 10000; a5-&gt;field_4 = v9; a5-&gt;field_8 = command % 100; a5-&gt;field_C = env; a5-&gt;field_10 = args; v5 = sub_9D60(command / 10000, v9, command % 100, 1, (int)a5, &amp;v11); } free(a5); if ( !v5 &amp;&amp; v11 ) sub_7CF34(env, v11, &amp;byte_83ED7); return v5; }</span></span></code> </pre> <br>    ,       ,       .      10601. <br><br>    ,       : <i>command / 10000</i> , <i>command % 10000 / 100</i>  <i>command % 10</i> , . .,   , 1, 6  1.   ,     <i>JNIEnv</i>  ,  ,      .      (  N1, N2  N3)   . <br><br>  : <br><br><img src="https://habrastorage.org/webt/xg/jk/l1/xgjkl1uhzmibo-nhmha3kpivf5a.png"><br><br>     <i>JNI_OnLoad</i> . <br>      .        .  â€”   .    ,       ,    ,       (   ,        ). <br><br><h3>   </h3><br>    ,    : 0x5F1AC.    :  UC Browser      . <br><br>     ,     Java-,  <br>     0x4D070.         . <br><br>   R7  R4  : <br><br><img src="https://habrastorage.org/webt/7i/fx/86/7ifx86mr4yph41jsxukpjqvxmfa.png"><br><br>     R11: <br><br><img src="https://habrastorage.org/webt/fa/62/6j/fa626jaylcaaewtslff_-byaseo.jpeg"><br><br>     ,  : <br><br><img src="https://habrastorage.org/webt/co/rk/s1/corks1o2dp75elfvdsxjimrohuo.png"><br><br>        ,   R4.   230 . <br><br> æ€ä¹ˆåŠå‘¢ï¼Ÿ   IDA,    switch: Edit -&gt; Other -&gt; Specify switch idiom. <br><br><img src="https://habrastorage.org/webt/36/uu/xn/36uuxnabf3xesptr8qisxzzfutk.jpeg"><br><br>   . ,    ,        <i>sub_6115C</i> : <br><br><img src="https://habrastorage.org/webt/-d/pt/3a/-dpt3akb_yckinmdheczkktzlem.jpeg"><br><br>   switch,    case 3      RC4.           ,   <i>doCommandNative</i> . ,      <i>magicInt</i>   16.   case â€“      ,     . <br><br><img src="https://habrastorage.org/webt/rn/_1/i4/rn_1i4avl8oki83hslk5u19ygoe.jpeg"><br><br>  AES! <br><br>  ,    : ,  , ,   (       AES).      -    <i>sub_6115C</i> ,       ,     ,        . <br><br><h3>  </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸ºäº†ä¸ä»¥æ±‡ç¼–è¯­è¨€æ‰‹åŠ¨ç¼–å†™æ‰€æœ‰è¡¥ä¸ä»£ç ï¼Œæ‚¨å¯ä»¥è¿è¡ŒAndroid Studioï¼Œåœ¨å…¶ä¸­ç¼–å†™ä¸€ä¸ªå‡½æ•°ä»¥æ¥æ”¶ä¸æˆ‘ä»¬çš„è§£å¯†å‡½æ•°ç›¸åŒçš„å‚æ•°ï¼Œç„¶åå°†å…¶å†™å…¥æ–‡ä»¶ä¸­ï¼Œç„¶åå°†å…¶å¤åˆ¶ç²˜è´´åˆ°ç¼–è¯‘å™¨å°†ç”Ÿæˆçš„ä»£ç ä¸­ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬æ¥è‡ªUCæµè§ˆå™¨å›¢é˜Ÿçš„æœ‹å‹ä¹Ÿâ€œæ³¨æ„â€æ·»åŠ ä»£ç çš„ä¾¿åˆ©æ€§ã€‚æˆ‘ä»¬è®°å¾—åœ¨æ¯ä¸ªå‡½æ•°çš„å¼€å¤´ï¼Œæˆ‘ä»¬éƒ½æœ‰åƒåœ¾ä»£ç ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°å°†å…¶æ›¿æ¢ä¸ºå…¶ä»–ä»£ç ã€‚éå¸¸æ–¹ä¾¿ï¼š)æ²¡é”™ï¼Œåœ¨ç›®æ ‡å‡½æ•°çš„å¼€å¤´ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜å‚¨å°†æ‰€æœ‰å‚æ•°ä¿å­˜åˆ°æ–‡ä»¶çš„ä»£ç ã€‚æˆ‘å¿…é¡»å°†å…¶åˆ†æˆå¤šä¸ªéƒ¨åˆ†å¹¶ä½¿ç”¨ç›¸é‚»å‡½æ•°çš„åƒåœ¾å—ã€‚å…±æœ‰å››ä¸ªéƒ¨åˆ†ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€éƒ¨åˆ†ï¼š</font></font><br><br><img src="https://habrastorage.org/webt/hy/lk/qr/hylkqrhqgyei6qjdj6ayvgivpqu.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åœ¨ARMä½“ç³»ç»“æ„ä¸­ï¼Œå‡½æ•°çš„å‰å››ä¸ªå‚æ•°é€šè¿‡å¯„å­˜å™¨R0-R3ä¼ é€’ï¼Œå…¶ä½™ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰é€šè¿‡å †æ ˆä¼ é€’ã€‚åœ¨å¯„å­˜å™¨LRä¸­ï¼Œè¿”å›åœ°å€è¢«å‘é€ã€‚æ‰€æœ‰è¿™äº›éƒ½éœ€è¦ä¿ç•™ï¼Œä»¥ä¾¿å‡½æ•°åœ¨è½¬å‚¨å…¶å‚æ•°åå¯ä»¥æ­£å¸¸å·¥ä½œã€‚æˆ‘ä»¬è¿˜éœ€è¦ä¿å­˜åœ¨è¯¥è¿‡ç¨‹ä¸­å°†ä½¿ç”¨çš„æ‰€æœ‰å¯„å­˜å™¨ï¼Œå› æ­¤æˆ‘ä»¬æ‰§è¡ŒPUSH.W {R0-R10ï¼ŒLR}ã€‚åœ¨R7ä¸­ï¼Œæˆ‘ä»¬è·å–é€šè¿‡å †æ ˆä¼ é€’ç»™å‡½æ•°çš„å‚æ•°åˆ—è¡¨çš„åœ°å€ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fopen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åŠŸèƒ½ï¼Œ</font><font style="vertical-align: inherit;">ä»¥â€œ abâ€æ¨¡å¼</font><font style="vertical-align: inherit;">æ‰“å¼€æ–‡ä»¶</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ data / local / tmp / aes</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å³æ·»åŠ ã€‚åœ¨R0ä¸­ï¼Œæˆ‘ä»¬åŠ è½½æ–‡ä»¶åçš„åœ°å€ï¼Œåœ¨R1ä¸­-æŒ‡ç¤ºæ¨¡å¼çš„è¡Œçš„åœ°å€ã€‚ç„¶ååƒåœ¾ä»£ç ç»“æŸï¼Œå› æ­¤è½¬åˆ°ä¸‹ä¸€ä¸ªå‡½æ•°ã€‚ä¸ºäº†ä½¿å®ƒç»§ç»­å·¥ä½œï¼Œæˆ‘ä»¬é¦–å…ˆç»•è¿‡äº†åƒåœ¾è½¬ç§»åˆ°å®å‡½æ•°ä»£ç çš„è¿‡æ¸¡ï¼Œå¹¶æ·»åŠ äº†è¡¥ä¸çš„å»¶ç»­æ¥ä»£æ›¿åƒåœ¾ã€‚</font></font><br><br><img src="https://habrastorage.org/webt/68/ss/kf/68sskfcymjorl_flpf8mg9wwej4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç§°fopen</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><i><font style="vertical-align: inherit;">aes</font></i></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å‡½æ•°çš„å‰ä¸‰ä¸ªå‚æ•°</font><font style="vertical-align: inherit;">çš„ç±»å‹ä¸º</font><i><font style="vertical-align: inherit;">int</font></i><font style="vertical-align: inherit;">ã€‚ç”±äºæˆ‘ä»¬ä»ä¸€å¼€å§‹å°±å°†å¯„å­˜å™¨ä¿å­˜åˆ°å †æ ˆä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°†</font><font style="vertical-align: inherit;">å †æ ˆä¸Šçš„åœ°å€</font><font style="vertical-align: inherit;">ä¼ é€’ç»™</font><i><font style="vertical-align: inherit;">fwrite</font></i><font style="vertical-align: inherit;">å‡½æ•°</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æœ‰ä¸‰ä¸ªç»“æ„ï¼Œå…¶ä¸­åŒ…å«æ•°æ®çš„å¤§å°ä»¥åŠæŒ‡å‘å¯†é’¥ï¼Œåˆå§‹åŒ–å‘é‡å’ŒåŠ å¯†æ•°æ®çš„æ•°æ®çš„æŒ‡é’ˆã€‚</font></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><i><font style="vertical-align: inherit;"></font></i><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/webt/d1/yt/iz/d1ytiz_jx7byflntqxxec2nece0.jpeg"><br><br><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/webt/me/vy/kz/mevykztpkcwdr6xkpnenauxqccs.jpeg"><br><br>    ,        <i>aes</i> . <br><br>  APK   , ,   /, . ,    ,     .       ,       .    - ,       .   ,  UC Browser    ,     ,  ,     :    onCreate  . <br><br><pre> <code class="plaintext hljs"> const/16 v1, 0x62 new-array v1, v1, [B fill-array-data v1, :encrypted_data const/16 v0, 0x1f invoke-static {v0, v1}, Lcom/uc/browser/core/d/c/g;-&gt;j(I[B)[B move-result-object v1 array-length v2, v1 invoke-static {v2}, Ljava/lang/String;-&gt;valueOf(I)Ljava/lang/String; move-result-object v2 const-string v0, "ololo" invoke-static {v0, v2}, Landroid/util/Log;-&gt;d(Ljava/lang/String;Ljava/lang/String;)I</code> </pre> <br> , , , .  NullPointerException, . .   null. <br><br>        ,     : Â«META-INF/Â»  ".RSA". ,    .      .   ,    ,   ,      .     ,   Â«META-INF/Â»  Â«BLABLINF/Â»,       APK     . <br><br> , , , . å®¾æœï¼   ! <br><br><h3> MitM </h3><br>      ,  .       CBC. <br><br><img src="https://habrastorage.org/webt/9k/m7/un/9km7unymy_ybx1lwnflfbqd36ke.png"><br><br>  URL , -   MD5, Â«extract_unzipsizeÂ»  . : MD5  ,    .        .  ,     ,   Intent      Â«PWNED!Â».      : <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">puds.ucweb.com/upgrade/index.xhtml</a></i>    .    MD5 (    ),       . <br><br>      ,    . , - <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»–ä¸å–œæ¬¢ </font><font style="vertical-align: inherit;">åˆ†æè¿™ç§æ··ä¹±æ ¼å¼çš„ç»“æœæ˜¯ï¼ŒæœåŠ¡å™¨ä»åœ¨ä¼ è¾“å½’æ¡£æ–‡ä»¶çš„å¤§å°ï¼š</font></font><br><br><img src="https://habrastorage.org/webt/e2/-v/ua/e2-vuahng86h0bt0vm84f3xhqrg.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å®ƒæ˜¯ç”¨LEB128ç¼–ç çš„ã€‚</font><font style="vertical-align: inherit;">ä¿®è¡¥ç¨‹åºä¹‹åï¼Œå¸¦æœ‰åº“çš„å­˜æ¡£çš„å¤§å°å‘ç”Ÿäº†ä¸€äº›å˜åŒ–ï¼Œå› æ­¤æµè§ˆå™¨ç¡®å®šå­˜æ¡£çš„ä¸‹è½½ä¸æ­£ç¡®ï¼Œç»è¿‡å¤šæ¬¡å°è¯•åå‡ºç°äº†é”™è¯¯ã€‚</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æˆ‘ä»¬æ›´æ­£äº†æ¡£æ¡ˆçš„å¤§å°...è€Œä¸”-èƒœåˆ©ï¼</font><font style="vertical-align: inherit;">:)è§†é¢‘ä¸Šçš„ç»“æœã€‚</font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://www.youtube.com/watch?v=Nfns7uH03J8</font></font></a> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> å¼€å‘äººå‘˜çš„åæœå’Œå“åº” </font></font></h3><br>           UC Browser,      .       ,      .   â€”    ,         ,      ,   . <br><br>     UC Browser      ,       ,   -     .             .       ,  ,  ,   . 27   <br>    UC Browser 12.10.9.1193,      HTTPS: <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">puds.ucweb.com/upgrade/index.xhtml</a></i> . <br><br>  ,  Â«Â»          PDF         Â«, -   !Â».       PDF  ,      ,            Google Play. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN451936/">https://habr.com/ru/post/zh-CN451936/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN451926/index.html">å…³äº130ä¸ªæµä¹‹åçš„å®æ—¶ä»£ç </a></li>
<li><a href="../zh-CN451928/index.html">å¦‚ä½•åœ¨AMPé¡µé¢ä¸Šè®¾ç½®ç½‘ç»œåˆ†æ</a></li>
<li><a href="../zh-CN451930/index.html">æ¥¼æ¢¯é—´ç…§æ˜çš„è‡ªåŠ¨åŒ–</a></li>
<li><a href="../zh-CN451932/index.html">PHç¬¬9å¤©ï¼šæ¬¢è¿æ¥åˆ°å®‰å…¨å¼€å‘éƒ¨åˆ†</a></li>
<li><a href="../zh-CN451934/index.html">äºšå†å±±å¤§Â·æ‹‰å§†ç™»ï¼ˆAlexander Lamdenï¼‰ï¼šâ€œä»»ä½•ä¸€å—é“éƒ½æœ‰ç‰¹è‰²â€</a></li>
<li><a href="../zh-CN451938/index.html">ä½å›¾ç´¢å¼•ï¼šé‡æ€§æœç´¢</a></li>
<li><a href="../zh-CN451942/index.html">åœ¨éæ´²å¼€è½¦å¦‚ä½•æ‹¯æ•‘æ•°åƒäººçš„ç”Ÿå‘½</a></li>
<li><a href="../zh-CN451944/index.html">2019å¹´ï¼šDEXå¹´ï¼ˆå»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ï¼‰</a></li>
<li><a href="../zh-CN451948/index.html">ä¸‰ä¸ªå¢¨ç›’çš„æ•…äº‹</a></li>
<li><a href="../zh-CN451950/index.html">è™šæ‹Ÿç”µå‚ã€‚ æœ‰å¯èƒ½ç®¡ç†â€œç»¿è‰²â€èƒ½æºå—ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>