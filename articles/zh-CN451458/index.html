<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§ ğŸ™ğŸ¼ ğŸ³ æˆ‘ä»¬é…¿é€ ä¸€ä¸ªæ¸¸æˆå¼€å‘è€…ã€‚ ç¬¬ä¸€éƒ¨åˆ† ğŸŒ“ ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ â“‚ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¼•è¨€ 
 æ•…äº‹å§‹äºåŸºäºåŒºå—é“¾çš„é»‘å®¢é©¬æ‹‰æ¾ã€‚ åœ¨æ´»åŠ¨å¼€å§‹æ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªäººï¼Œä»–ä»¥ä¸šä½™çˆ±å¥½æ¥åˆ¶ä½œæ£‹ç›˜å•†åŠ¡æ¸¸æˆï¼ˆæˆ‘åœ¨å…¶ä¸­ä¸€æ¬¾æ¸¸æˆçš„æµ‹è¯•ä¸­ï¼‰ï¼Œæˆ‘ä»¬ä¸€èµ·åˆä½œï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå›¢é˜Ÿï¼Œä»–ä»¬åœ¨å‘¨æœ«ä¸ä»–ä»¬â€œç›²ç›®â€äº†ä¸€ä¸ªç®€å•çš„æˆ˜ç•¥æ¸¸æˆã€‚ é»‘å®¢é©¬æ‹‰æ¾è¿‡å»äº†ï¼Œä½†çƒ­æƒ…ä¾ç„¶å­˜åœ¨ã€‚ æˆ‘ä»¬æƒ³åˆ°äº†å…³äºå¹¸ç¦ï¼Œä¸–ç•Œç¤¾åŒºå’Œé€‰ä¸¾çš„å¤šäººçº¸ç‰Œæ¸¸æˆçš„æƒ³...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æˆ‘ä»¬é…¿é€ ä¸€ä¸ªæ¸¸æˆå¼€å‘è€…ã€‚ ç¬¬ä¸€éƒ¨åˆ†</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451458/"><img src="https://habrastorage.org/webt/kj/iq/cp/kjiqcpn8xsrxhus_hsclhpi9w_w.jpeg" align="left"><h2>  <font color="#292e5b">å¼•è¨€</font> </h2><br> æ•…äº‹å§‹äºåŸºäºåŒºå—é“¾çš„é»‘å®¢é©¬æ‹‰æ¾ã€‚ åœ¨æ´»åŠ¨å¼€å§‹æ—¶ï¼Œæˆ‘é‡åˆ°äº†ä¸€ä¸ªäººï¼Œä»–ä»¥ä¸šä½™çˆ±å¥½æ¥åˆ¶ä½œæ£‹ç›˜å•†åŠ¡æ¸¸æˆï¼ˆæˆ‘åœ¨å…¶ä¸­ä¸€æ¬¾æ¸¸æˆçš„æµ‹è¯•ä¸­ï¼‰ï¼Œæˆ‘ä»¬ä¸€èµ·åˆä½œï¼Œæ‰¾åˆ°äº†ä¸€ä¸ªå›¢é˜Ÿï¼Œä»–ä»¬åœ¨å‘¨æœ«ä¸ä»–ä»¬â€œç›²ç›®â€äº†ä¸€ä¸ªç®€å•çš„æˆ˜ç•¥æ¸¸æˆã€‚ é»‘å®¢é©¬æ‹‰æ¾è¿‡å»äº†ï¼Œä½†çƒ­æƒ…ä¾ç„¶å­˜åœ¨ã€‚ æˆ‘ä»¬æƒ³åˆ°äº†å…³äºå¹¸ç¦ï¼Œä¸–ç•Œç¤¾åŒºå’Œé€‰ä¸¾çš„å¤šäººçº¸ç‰Œæ¸¸æˆçš„æƒ³æ³•ã€‚ <br><br> åœ¨ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†åæ˜ æˆ‘ä»¬åˆ›å»ºæ¸¸æˆçš„é“è·¯ï¼Œå¹¶æè¿°æˆ‘ä»¬å·²ç»è¸ä¸Šçš„è€™å­ï¼Œå¹¶å°†åœ¨å‰è¿›ä¸­ä¸æ–­å‰è¿›ã€‚ <br clear="all"> æ ¹æ®å‰Šå‡å°†æ˜¯ï¼š <br><br><ul><li> æ¸¸æˆæ€»ç»“ </li><li>å¦‚ä½•å†³å®šå¦‚ä½•åšåç«¯ã€‚ å®ƒä¼šåœ¨å“ªé‡Œâ€œå±…ä½â€ï¼Œä»¥ä¾¿åœ¨å¼€å‘é˜¶æ®µä¸æ”¯ä»˜è´¹ç”¨ </li><li> å¼€å‘çš„ç¬¬ä¸€æ­¥-ç©å®¶èº«ä»½éªŒè¯å’Œé…å¯¹ç»„ç»‡ </li><li> è¿›ä¸€æ­¥çš„è®¡åˆ’ </li></ul><a name="habracut"></a><br><h2>  <font color="#292e5b">æ¸¸æˆæ˜¯å…³äºä»€ä¹ˆçš„</font> </h2><br> äººç±»å¯¹ä¸–ç•Œå¤§æˆ˜ï¼Œèµ„æºæ¯ç«­å’ŒæŒç»­ç«äº‰æ„Ÿåˆ°åŒå€¦ã€‚ å…³é”®æ´¾ç³»åŒæ„ä½¿ç”¨ç°ä»£æŠ€æœ¯é€‰æ‹”ä¸€ä¸ªé¢†å¯¼å±‚ã€‚ åœ¨æŒ‡å®šçš„æ—¶é—´ï¼Œä¸–ç•Œé€‰æ°‘å¿…é¡»å†³å®šé€‰æ‹©å“ªä¸€ä¸ªåˆ†æ•°æ¥ç»Ÿæ²»ä¸‹ä¸€ä¸ªåƒå¹´ã€‚ å…³é”®æ´¾ç³»è¿›è¡Œäº†â€œè¯šå®â€çš„æƒåŠ›æ–—äº‰ã€‚ åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªç©å®¶ä»£è¡¨ä¸€ä¸ªåˆ†æ•°ã€‚ <br><br> è¯¥çº¸ç‰Œæ¸¸æˆä¸é€‰ä¸¾æœ‰å…³ã€‚ æ¯ä¸ªæ´¾ç³»éƒ½æœ‰è¿›è¡Œé€‰ä¸¾çš„é¢„ç®—ï¼Œæ”¶å…¥æ¥æºå¯ä»¥å¢åŠ é¢„ç®—å¹¶å¼€å§‹æŠ•ç¥¨ã€‚ åœ¨æ¸¸æˆå¼€å§‹æ—¶ï¼Œæ··åˆäº†å¸¦æœ‰åŠ¨ä½œå¡çš„å¥—ç‰Œï¼Œå¹¶å‘æ¯ä½å‚ä¸è€…å‘è¡Œäº†4å¼ å¡ã€‚ æ¯å›åˆï¼Œç©å®¶æœ€å¤šå¯ä»¥æ‰§è¡Œä¸¤ä¸ªæ¸¸æˆåŠ¨ä½œã€‚ è¦ä½¿ç”¨è¯¥å¡ï¼Œç©å®¶å°†å…¶æ”¾åœ¨æ¡Œä¸Šï¼Œå¹¶åœ¨å¿…è¦æ—¶æŒ‡å®šç›®æ ‡å¹¶ä»é¢„ç®—ä¸­æ‰£é™¤ä½¿ç”¨å¡çš„è´¹ç”¨ã€‚ ä¸€è½®ç»“æŸåï¼Œç©å®¶åªèƒ½ä¿ç•™ä¸€å¼ æœªä½¿ç”¨çš„å¡ã€‚ åœ¨æ¯ä¸ªå›åˆå¼€å§‹æ—¶ï¼Œç©å®¶ä¼šä»å¥—ç‰Œä¸­è·å–å¡ç‰Œï¼Œå› æ­¤ï¼Œåœ¨æ¯ä¸ªå›åˆå¼€å§‹æ—¶ï¼Œæ¯ä¸ªç©å®¶æ‰‹ä¸­éƒ½ä¼šæœ‰4å¼ åŠ¨ä½œå¡ã€‚ <br><br> åœ¨ç¬¬3ã€6å’Œ9è½®ç»“æŸæ—¶ï¼Œä»æ¸¸æˆä¸­åˆ é™¤ç¥¨æ•°æœ€å°‘çš„ç©å®¶ã€‚ å¦‚æœå¤šä¸ªç©å®¶çš„æœ€å°ç¥¨æ•°ç›¸åŒï¼Œé‚£ä¹ˆæ‰€æœ‰å…·æœ‰æ­¤ç»“æœçš„ç©å®¶å°†ä»æ¸¸æˆä¸­æ·˜æ±°ã€‚ è¿™äº›çƒå‘˜çš„å£°éŸ³è¿›å…¥äº†é€‰æ°‘çš„æ•´ä½“è§†é‡ã€‚ <br><br> åœ¨ç¬¬12è½®ç»“æŸæ—¶ï¼Œè·èƒœè€…æ˜¯å¾—ç¥¨æœ€å¤šçš„äººã€‚ <br><br><h2>  <font color="#292e5b">ä¸ºåç«¯é€‰æ‹©å·¥å…·</font> </h2><br> ä»æ¸¸æˆæè¿°å¦‚ä¸‹ï¼š <br><br><ol><li> è¿™æ˜¯å¤šäººæ¸¸æˆ </li><li> æœ‰å¿…è¦ä»¥æŸç§æ–¹å¼è¯†åˆ«ç©å®¶å¹¶ç®¡ç†å¸æˆ· </li><li> ç¤¾äº¤å…ƒç´ çš„å­˜åœ¨å°†æœ‰ç›Šäºæ¸¸æˆ-æœ‹å‹ï¼Œç¤¾åŒºï¼ˆæ°æ—ï¼‰ï¼ŒèŠå¤©ï¼Œæˆå°±ï¼ˆæˆå°±ï¼‰ </li><li> æ’è¡Œæ¦œå’Œå©šä»‹åŠŸèƒ½å°†æ˜¯å¿…éœ€çš„ã€‚ </li><li> æ¯”èµ›ç®¡ç†åŠŸèƒ½åœ¨å°†æ¥ä¼šå¾ˆæœ‰ç”¨ </li><li> å‡è®¾æ¸¸æˆæ˜¯çº¸ç‰Œæ¸¸æˆï¼Œæ‚¨éœ€è¦ç®¡ç†çº¸ç‰Œç›®å½•ï¼Œæ‚¨å¯èƒ½éœ€è¦å­˜å‚¨å¯ä¾›ç©å®¶ä½¿ç”¨çš„çº¸ç‰Œå’Œå·²ç¼–è¯‘çš„å¥—ç‰Œ </li><li> å°†æ¥å¯èƒ½éœ€è¦æ¸¸æˆå†…ç»æµï¼ŒåŒ…æ‹¬æ¸¸æˆå†…è´§å¸ï¼Œè™šæ‹Ÿå•†å“ï¼ˆå¡ï¼‰äº¤æ¢ </li></ol><br> é€šè¿‡æŸ¥çœ‹éœ€æ±‚åˆ—è¡¨ï¼Œæˆ‘ç«‹å³å¾—å‡ºç»“è®ºï¼Œåœ¨åˆæœŸé˜¶æ®µåˆ›å»ºè‡ªå·±çš„åç«¯æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå¹¶å‘Googleå¯»æ±‚äº†å…¶ä»–é€‰æ‹©ã€‚ å› æ­¤ï¼Œæˆ‘å‘ç°æœ‰ä¸“é—¨çš„äº‘æ¸¸æˆåç«¯ï¼Œå…¶ä¸­PlayFabï¼ˆç”±Microsoftè´­ä¹°ï¼‰å’ŒGameSparksï¼ˆç”±Amazonè´­ä¹°ï¼‰è„±é¢–è€Œå‡ºã€‚ <br><br> é€šå¸¸ï¼Œå®ƒä»¬åœ¨åŠŸèƒ½ä¸Šç›¸ä¼¼å¹¶ä¸”æ»¡è¶³åŸºæœ¬éœ€æ±‚ã€‚ æ­¤å¤–ï¼Œå®ƒä»¬çš„å†…éƒ¨ä½“ç³»ç»“æ„éå¸¸ä¸åŒï¼Œç›¸åŒä»»åŠ¡çš„è§£å†³æ–¹å¼ä¹Ÿç•¥æœ‰ä¸åŒï¼Œå¹¶ä¸”ç‰¹å¾ä¸­çš„æ˜¾å¼å¯¹åº”å…³ç³»å¾ˆéš¾è¿½è¸ªã€‚ ä»¥ä¸‹æ˜¯æ¯ä¸ªå¹³å°çš„æ­£é¢å’Œè´Ÿé¢ç‰¹å¾ä»¥åŠæœ‰å…³é€‰æ‹©ä¸»é¢˜çš„æ³¨æ„äº‹é¡¹ã€‚ <br><br><h3>  <font color="#9cc2ce">Playfab</font> </h3><br> æ­£é¢ç‰¹å¾ï¼š <br><br><ul><li> æ¥è‡ªä¸åŒæ¸¸æˆçš„å¸æˆ·åˆå¹¶ä¸ºä¸€ä¸ªä¸»å¸æˆ· </li><li> æ— éœ€å•è¡Œä»£ç å³å¯æè¿°æ¸¸æˆç»æµï¼ŒåŒ…æ‹¬å‘å•ç‹¬çš„è™šæ‹Ÿå•†åº—å®šä»· </li><li> å‹å¥½çš„ç”¨æˆ·ç•Œé¢ </li><li> å¾®è½¯æ”¶è´­åæ”¶è´­äº§å“ </li><li> ç”±Indie Studioè®¢é˜…åˆ¶ä½œçš„æ‰€æœ‰æƒæˆæœ¬ä¸º99ç¾å…ƒï¼ˆæœ€é«˜10ä¸‡MAUï¼‰ï¼Œåˆ‡æ¢åˆ°ä¸“ä¸šç‰ˆæ—¶ï¼Œä¸€åƒMAUè®¢é˜…çš„æˆæœ¬ä¸º8ç¾å…ƒï¼ˆæœ€ä½å¸æˆ·ä¸º300ç¾å…ƒï¼‰ </li></ul><br> ç¼ºç‚¹ï¼š <br><br><ul><li> æ¸¸æˆæ•°æ®çš„å­˜å‚¨å—åˆ°ä¸¥æ ¼é™åˆ¶ï¼Œä¾‹å¦‚ï¼Œå…è´¹è®¢é˜…ä»¥å­˜å‚¨ç‰¹å®šæ¸¸æˆä¼šè¯çš„æ•°æ®ï¼ˆå¦‚æœæˆ‘æ­£ç¡®ç†è§£ä¸€åˆ‡ï¼Œåˆ™ä½¿ç”¨å®ä½“ç»„è¿›è¡Œæ­¤æ“ä½œï¼‰3ä¸ª500å­—èŠ‚çš„æ’æ§½å¯ç”¨ </li><li> è¦ç»„ç»‡å¤šäººæ¸¸æˆï¼Œæ‚¨éœ€è¦è¿æ¥ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ï¼Œè¿™äº›æœåŠ¡å™¨å°†å¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„äº‹ä»¶å¹¶è®¡ç®—æ¸¸æˆé€»è¾‘ã€‚ è¿™æ˜¯ç¡¬ä»¶ä¸Šçš„Photonæˆ–Azure Thunderheadï¼Œå¹¶ä¸”æ‚¨ä¸ä»…éœ€è¦ç»„ç»‡æœåŠ¡å™¨ï¼Œè€Œä¸”è¿˜éœ€è¦å°†æ‚¨çš„è®¢é˜…è‡³å°‘å‡çº§åˆ°Indie Studio </li><li> æœ‰å¿…è¦å¿å—è¿™æ ·çš„äº‹å®ï¼Œå³äº‘ä»£ç æ²¡æœ‰è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Œä¹Ÿæ²¡æœ‰åŠæ³•é—¯å…¥æ¨¡å—ï¼ˆæˆ–æ‰¾ä¸åˆ°ï¼‰ï¼Ÿ </li><li> æ²¡æœ‰æ™®é€šçš„è°ƒè¯•å™¨ï¼Œæ‚¨åªèƒ½åœ¨CloudScriptä¸­ç¼–å†™æ—¥å¿—å¹¶æŸ¥çœ‹ </li></ul><br><h3>  <font color="#9cc2ce">æ¸¸æˆå…¬å›­</font> </h3><br> æ­£é¢ç‰¹å¾ï¼š <br><br><ul><li> æ¸¸æˆæ•°æ®å­˜å‚¨ã€‚ è¯¥å¹³å°ä¸ä»…å¯ä»¥åœ¨è®¸å¤šåœ°æ–¹ä¿å­˜æ•°æ®ï¼ˆå¸¸è§„æ¸¸æˆå…ƒæ•°æ®ï¼Œè™šæ‹Ÿå•†å“ï¼Œç©å®¶ä¸ªäººèµ„æ–™ï¼Œå¤šäººæ¸¸æˆä¼šè¯ç­‰ï¼‰ï¼Œè€Œä¸”è¿˜æä¾›äº†æœªé™„å¸¦ä»»ä½•å†…å®¹çš„å®Œå–„çš„æ•°æ®åº“å³æœåŠ¡ï¼Œæ­¤å¤–ï¼ŒMongoDBå’ŒRediså‡å¯ç«‹å³ç”¨äºä¸åŒç±»å‹çš„æ•°æ®ã€‚ åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œæ‚¨å¯ä»¥å­˜å‚¨10 MBï¼Œåœ¨æˆ˜æ–—ä¸­å¯ä»¥å­˜å‚¨10 GB </li><li> å…è´¹è®¢é˜…ï¼ˆå¼€å‘ï¼‰ä¸­æä¾›å¤šäººæ¸¸æˆï¼ŒåŒæ—¶é™åˆ¶ä¸º10ä¸ªåŒæ—¶è¿æ¥å’Œæ¯ç§’10ä¸ªè¯·æ±‚ </li><li> æ–¹ä¾¿ä½¿ç”¨CloudCodeï¼ŒåŒ…æ‹¬ç”¨äºæµ‹è¯•å’Œè°ƒè¯•çš„å†…ç½®å·¥å…·ï¼ˆTest Harnessï¼‰ </li></ul><br> ç¼ºç‚¹ï¼š <br><br><ul><li> è‡ªä»äºšé©¬é€Šï¼ˆ2018å¹´å†¬å­£ï¼‰è´­ä¹°è¯¥å·¥å…·ä»¥æ¥ï¼Œè¿™ç§æ„Ÿè§‰ä¸€ç›´åœæ»ä¸å‰ï¼Œæ²¡æœ‰åˆ›æ–° </li><li> å†æ¬¡ï¼Œåœ¨æ”¶è´­äºšé©¬é€Šä¹‹åï¼Œå…³ç¨å˜å¾—æ›´ç³Ÿï¼›æ›´æ—©ä¹‹å‰ï¼Œæœ‰å¯èƒ½å…è´¹ä½¿ç”¨å¤šè¾¾10,000 MAUçš„ç”Ÿäº§é‡ </li><li> æ‹¥æœ‰çš„ç”Ÿäº§æˆæœ¬ä»$ 300å¼€å§‹ï¼ˆæ ‡å‡†è®¢é˜…ï¼‰ </li></ul><br><h3>  <font color="#9cc2ce">æ„Ÿè¨€</font> </h3><br> é¦–å…ˆï¼Œæ‚¨å¿…é¡»æ£€æŸ¥æ¸¸æˆçš„æ¦‚å¿µã€‚ ä¸ºæ­¤ï¼Œæˆ‘æƒ³æ„å»ºæ²¡æœ‰ç°é‡‘æŠ•èµ„çš„æ£æ£’å’Œé€æ˜èƒ¶å¸¦çš„åŸå‹ï¼Œå¹¶å¼€å§‹æ¸¸æˆæœºåˆ¶çš„æ¸¸æˆæµ‹è¯•ã€‚ å› æ­¤ï¼Œé¦–å…ˆï¼Œåœ¨é€‰æ‹©æ—¶ï¼Œæˆ‘å¢åŠ äº†å…è´¹è®¢é˜…å¼€å‘å’Œæµ‹è¯•æœºåˆ¶çš„æœºä¼šã€‚ <br>  GameSparksæ»¡è¶³æ­¤æ¡ä»¶ï¼Œä½†PlayFabä¸æ»¡è¶³ï¼Œå› ä¸ºæ‚¨å°†éœ€è¦ä¸€å°æœåŠ¡å™¨æ¥å¤„ç†æ¸¸æˆå®¢æˆ·ç«¯çš„äº‹ä»¶å’Œä¸€ä¸ªç‹¬ç«‹å·¥ä½œå®¤çº§åˆ«çš„è®¢é˜…ï¼ˆ99ç¾å…ƒï¼‰ã€‚ <br><br> åŒæ—¶ï¼Œæˆ‘æ¥å—äºšé©¬é€Šä¸å¼€å‘GameSparksçš„é£é™©ï¼Œè¿™æ„å‘³ç€å®ƒå¯èƒ½â€œæ­»äº¡â€ã€‚ è€ƒè™‘åˆ°ä»ç„¶å­˜åœ¨çš„ç”Ÿäº§æˆæœ¬ï¼Œæˆ‘è°¨è®°å¯èƒ½éœ€è¦è¿ç§»åˆ°å¦ä¸€ä¸ªå¹³å°æˆ–æˆ‘è‡ªå·±çš„åç«¯ã€‚ <br><br><h2>  <font color="#292e5b">å¼€å‘çš„ç¬¬ä¸€æ­¥</font> </h2><br><h3>  <font color="#9cc2ce">è¿æ¥å’Œè®¤è¯</font> </h3><br> å› æ­¤ï¼Œåœ¨åŸå‹å¼€å‘é˜¶æ®µï¼Œé€‰æ‹©æƒå°±è½åœ¨äº†GameSparksä¸Šä½œä¸ºåç«¯ã€‚ ç¬¬ä¸€æ­¥æ˜¯å­¦ä¹ å¦‚ä½•è¿æ¥åˆ°å¹³å°å¹¶éªŒè¯æ’­æ”¾å™¨ã€‚ é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œå®‰è£…æ¸¸æˆåï¼Œç”¨æˆ·åº”è¯¥æ— éœ€æ³¨å†Œå’ŒSMSå³å¯ç«‹å³ç©æ¸¸æˆã€‚ ä¸ºæ­¤ï¼ŒGameSparksæä¾›äº†é€šè¿‡è°ƒç”¨DeviceAuthenticationRequestæ–¹æ³•æ¥åˆ›å»ºåŒ¿åé…ç½®æ–‡ä»¶çš„é€‰é¡¹ï¼Œç¨åï¼Œæ‚¨å¯ä»¥åœ¨åŒ¿åé…ç½®æ–‡ä»¶çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡è¿æ¥åˆ°æ‚¨çš„Googleå¸æˆ·æ¥åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„é…ç½®æ–‡ä»¶ã€‚ <br><br> è€ƒè™‘åˆ°æˆ‘æœ‰å¤§è„‘çš„TDDï¼Œæˆ‘é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªæµ‹è¯•ä»¥å°†å®¢æˆ·ç«¯è¿æ¥åˆ°æ¸¸æˆã€‚ ç”±äºå°†æ¥éœ€è¦ä½¿ç”¨JSç¼–å†™CloudCodeï¼Œå› æ­¤æˆ‘å°†ä½¿ç”¨mocha.jså’Œchai.jsåœ¨JSä¸­è¿›è¡Œé›†æˆæµ‹è¯•ã€‚ ç¬¬ä¸€æ¬¡æµ‹è¯•ç»“æœå¦‚ä¸‹ï¼š <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> expect = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"chai"</span></span>).expect; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> GameClientModule = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"../src/gameClient"</span></span>); describe(<span class="hljs-string"><span class="hljs-string">"Integration test"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.timeout(<span class="hljs-number"><span class="hljs-number">0</span></span>); it(<span class="hljs-string"><span class="hljs-string">"should connect client to server"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gameClient = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameClientModule.GameClient(); expect(gameClient.connected()).is.false; <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient.connect(); expect(gameClient.connected()).is.true; }); })</code> </pre> <br> é»˜è®¤æƒ…å†µä¸‹ï¼Œmocha.jsä¸­çš„è¶…æ—¶ä¸º2ç§’ï¼Œç”±äºæµ‹è¯•æ˜¯é›†æˆçš„ï¼Œæˆ‘ç«‹å³ä½¿å…¶è¶…æ—¶ã€‚ åœ¨æµ‹è¯•ä¸­ï¼Œæˆ‘åˆ›å»ºäº†ä¸€ä¸ªå°šæœªå®ç°çš„æ¸¸æˆå®¢æˆ·ç«¯ï¼Œæ£€æŸ¥æ˜¯å¦ä¸æœåŠ¡å™¨æ²¡æœ‰è¿æ¥ï¼Œè°ƒç”¨å‘½ä»¤è¿æ¥åˆ°åç«¯ï¼Œå¹¶éªŒè¯å®¢æˆ·ç«¯æ˜¯å¦å·²æˆåŠŸè¿æ¥ã€‚ <br><br> ä¸ºäº†ä½¿æµ‹è¯•å˜ä¸ºç»¿è‰²ï¼Œæ‚¨éœ€è¦ä¸‹è½½GameSparks JS SDKå¹¶å°†å…¶æ·»åŠ åˆ°é¡¹ç›®ä¸­ï¼Œå¹¶è¿æ¥å…¶ä¾èµ–é¡¹ï¼ˆcrypto-jså’Œwsï¼‰ï¼Œå¹¶ä¸”å½“ç„¶è¦å®ç°GameClientModuleï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> GameSparks = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"../gamesparks-javascript-sdk-2018-04-18/gamesparks-functions"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> config = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"./config.json"</span></span>); exports.GameClient = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gamesparks = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameSparks(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.connected = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> (gamesparks.connected === <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.connect = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ gamesparks.initPreview({ <span class="hljs-attr"><span class="hljs-attr">key</span></span>: config.gameApiKey, <span class="hljs-attr"><span class="hljs-attr">secret</span></span>: config.credentialSecret, <span class="hljs-attr"><span class="hljs-attr">credential</span></span>: config.credential, <span class="hljs-attr"><span class="hljs-attr">onInit</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> resolve(), <span class="hljs-attr"><span class="hljs-attr">onMessage</span></span>: onMessage, <span class="hljs-attr"><span class="hljs-attr">onError</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function">) =&gt;</span></span> reject(error), <span class="hljs-attr"><span class="hljs-attr">logger</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log }); }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onMessage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"GAME onMessage: "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(message)); } }</code> </pre><br> åœ¨æ¸¸æˆå®¢æˆ·ç«¯çš„å¼€å§‹å®æ–½ä¸­ï¼Œéœ€è¦ä»é…ç½®ä¸­è¯»å–æŠ€æœ¯æˆæƒä»¥ä»å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºåˆ›å»ºè¿æ¥æ‰€éœ€çš„å¯†é’¥ã€‚ è¿æ¥æ–¹æ³•åŒ…è£…äº†SDKä¸­çš„ç›¸åŒå­—æ®µã€‚ æœ€é‡è¦çš„äº‹æƒ…å‘ç”Ÿåœ¨connectæ–¹æ³•ä¸­ï¼Œå®ƒè¿”å›å¸¦æœ‰æˆåŠŸè¿æ¥æˆ–é”™è¯¯çš„å›è°ƒçš„promiseï¼Œè¿˜å°†onMessageå¤„ç†ç¨‹åºç»‘å®šåˆ°åŒä¸€å›è°ƒã€‚  onMessageå°†å……å½“åç«¯çš„æ¶ˆæ¯å¤„ç†ç®¡ç†å™¨ï¼Œç°åœ¨è®©å®ƒå°†æ¶ˆæ¯è®°å½•åˆ°æ§åˆ¶å°ã€‚ <br><br> çœ‹èµ·æ¥å·¥ä½œå·²ç»å®Œæˆï¼Œä½†æ˜¯æµ‹è¯•ä»ç„¶æ˜¯çº¢è‰²çš„ã€‚ äº‹å®è¯æ˜ï¼ŒGameSparks JS SDKä¸èƒ½ä¸node.jsä¸€èµ·ä½¿ç”¨ï¼›å°±å®ƒè€Œè¨€ï¼Œå®ƒç¼ºå°‘æµè§ˆå™¨ä¸Šä¸‹æ–‡ã€‚ è®©ä»–è®¤ä¸ºè¯¥èŠ‚ç‚¹æ˜¯ç½‚ç²Ÿä¸Šçš„Chromeã€‚ æˆ‘ä»¬è½¬åˆ°gamesparks.jsï¼Œå¹¶åœ¨å¼€å§‹æ—¶æ·»åŠ ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> === <span class="hljs-string"><span class="hljs-string">'object'</span></span> &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports) { <span class="hljs-comment"><span class="hljs-comment">// node.js var navigator = { userAgent: "Chrome/73.0.3683.103", vendor: "Google Inc.", platform: "Mac" }; var window = {}; window.setInterval = setInterval; // &lt;&lt;&lt;   KeepAlive  }</span></span></code> </pre><br> æµ‹è¯•å˜æˆç»¿è‰²ï¼Œç»§ç»­è¿›è¡Œã€‚ <br><br> å¦‚æˆ‘ä¹‹å‰æ‰€å†™ï¼Œç©å®¶åº”è¯¥èƒ½å¤Ÿåœ¨è¿›å…¥æ¸¸æˆåç«‹å³å¼€å§‹æ¸¸æˆï¼Œè€Œæˆ‘æƒ³å¼€å§‹åœ¨æ´»åŠ¨ä¸­ç§¯ç´¯åˆ†ææ•°æ®ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ç»‘å®šåˆ°è®¾å¤‡æ ‡è¯†ç¬¦æˆ–éšæœºç”Ÿæˆçš„æ ‡è¯†ç¬¦ã€‚ æ£€æŸ¥è¿™å°†æ˜¯è¿™æ ·çš„æµ‹è¯•ï¼š <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"should auth two anonymous players"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gameClient1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameClientModule.GameClient(); expect(gameClient1.playerId).is.undefined; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gameClient2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameClientModule.GameClient(); expect(gameClient2.playerId).is.undefined; <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient1.connect(); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient1.authWithCustomId(<span class="hljs-string"><span class="hljs-string">"111"</span></span>); expect(gameClient1.playerId).is.equals(<span class="hljs-string"><span class="hljs-string">"5b5f5614031f5bc44d59b6a9"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient2.connect(); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient2.authWithCustomId(<span class="hljs-string"><span class="hljs-string">"222"</span></span>); expect(gameClient2.playerId).is.equals(<span class="hljs-string"><span class="hljs-string">"5b5f6ddb031f5bc44d59b741"</span></span>); });</code> </pre><br> æˆ‘å†³å®šç«‹å³æ£€æŸ¥2ä¸ªå®¢æˆ·ç«¯ï¼Œä»¥ç¡®ä¿æ¯ä¸ªå®¢æˆ·ç«¯åœ¨åç«¯åˆ›å»ºè‡ªå·±çš„é…ç½®æ–‡ä»¶ã€‚ ä¸ºæ­¤ï¼Œæ¸¸æˆå®¢æˆ·ç«¯éœ€è¦ä¸€ç§æ–¹æ³•ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­å°†æŸä¸ªæ ‡è¯†ç¬¦ä¼ è¾“åˆ°GameSparksçš„å¤–éƒ¨ï¼Œç„¶åæ£€æŸ¥å®¢æˆ·ç«¯æ˜¯å¦å·²è”ç³»æ‰€éœ€çš„ç©å®¶èµ„æ–™ã€‚ é¢„å…ˆåœ¨GameSparksé—¨æˆ·ä¸Šå‡†å¤‡çš„ä¸ªäººèµ„æ–™ã€‚ <br><br> è¦åœ¨GameClientä¸­å®æ–½ï¼Œè¯·æ·»åŠ ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.playerId = <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.authWithCustomId = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">customId</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> requestData = { <span class="hljs-string"><span class="hljs-string">"deviceId"</span></span>: customId , <span class="hljs-string"><span class="hljs-string">"deviceOS"</span></span>: <span class="hljs-string"><span class="hljs-string">"NodeJS"</span></span> } sendRequest(<span class="hljs-string"><span class="hljs-string">"DeviceAuthenticationRequest"</span></span>, requestData) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (response.userId) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.playerId = response.userId; resolve(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { reject(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(response)); } }) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); }); }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">requestType, requestData</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function">) </span></span>{ gamesparks.sendWithData(requestType, requestData, (response) =&gt; resolve(response)); }); }</code> </pre><br> å®æ–½è¦å½’ç»“ä¸ºå‘é€DeviceAuthenticationRequestè¯·æ±‚ï¼Œä»å“åº”ä¸­æ¥æ”¶æ’­æ”¾å™¨çš„æ ‡è¯†ç¬¦å¹¶å°†å…¶æ”¾ç½®åœ¨å®¢æˆ·ç«¯çš„å±æ€§ä¸­ã€‚ ç«‹å³ï¼Œä½¿ç”¨å¦ä¸€ç§æ–¹æ³•ï¼Œè¯¥åŠ©æ‰‹ä½¿ç”¨è¯·æ±‚ä¸­çš„åŒ…è£…å°†è¯·æ±‚å‘é€åˆ°GameSparksã€‚ <br><br> è¿™ä¸¤ä¸ªæµ‹è¯•éƒ½æ˜¯ç»¿è‰²çš„ï¼Œä»ç„¶éœ€è¦æ·»åŠ è¿æ¥çš„å…³é—­å’Œé‡æ„ã€‚ <br> åœ¨GameClientä¸­ï¼Œæˆ‘æ·»åŠ äº†ä¸€ç§æ–¹æ³•æ¥å…³é—­ä¸æœåŠ¡å™¨çš„è¿æ¥ï¼ˆæ–­å¼€è¿æ¥ï¼‰ï¼Œå¹¶ç»“åˆconnectå’ŒauthWithCustomIdçš„connectAsAnonymousã€‚ ä¸€æ–¹é¢ï¼ŒconnectAsAnonymousè¿åäº†å•ä¸€è´£ä»»åŸåˆ™ï¼Œä½†ä¼¼ä¹å¹¶æ²¡æœ‰è¿åâ€¦â€¦åŒæ—¶ï¼Œå®ƒè¿˜å¢åŠ äº†å¯ç”¨æ€§ï¼Œå› ä¸ºåœ¨æµ‹è¯•ä¸­é€šå¸¸éœ€è¦å¯¹å®¢æˆ·ç«¯è¿›è¡Œèº«ä»½éªŒè¯ã€‚ æ‚¨å¦‚ä½•çœ‹å¾…ï¼Ÿ <br><br> åœ¨æµ‹è¯•ä¸­ï¼Œä»–æ·»åŠ äº†ä¸€ä¸ªå·¥å‚æ–¹æ³•åŠ©æ‰‹ï¼Œè¯¥åŠ©æ‰‹åˆ›å»ºæ¸¸æˆå®¢æˆ·ç«¯çš„æ–°å®ä¾‹å¹¶å°†å…¶æ·»åŠ åˆ°å·²åˆ›å»ºå®¢æˆ·ç«¯çš„æ•°ç»„ä¸­ã€‚ åœ¨ç‰¹æ®Šçš„mochaå¤„ç†ç¨‹åºä¸­ï¼Œå¯¹æ•°ç»„ä¸­çš„å®¢æˆ·ç«¯æ¯æ¬¡è¿è¡Œæµ‹è¯•åï¼Œæˆ‘éƒ½è°ƒç”¨æ–­å¼€è¿æ¥æ–¹æ³•å¹¶æ¸…é™¤æ­¤æ•°ç»„ã€‚ æˆ‘è¿˜ä¸å–œæ¬¢ä»£ç ä¸­çš„â€œé­”æœ¯å­—ç¬¦ä¸²â€ï¼Œæ‰€ä»¥æˆ‘æ·»åŠ äº†ä¸€ä¸ªå¸¦æœ‰æµ‹è¯•ä¸­ä½¿ç”¨çš„è‡ªå®šä¹‰æ ‡è¯†ç¬¦çš„å­—å…¸ã€‚ <br><br> æœ€ç»ˆä»£ç å¯ä»¥åœ¨å­˜å‚¨åº“ä¸­æŸ¥çœ‹ï¼Œæˆ‘å°†åœ¨æœ¬æ–‡ç»“å°¾å¤„æä¾›è¯¥é“¾æ¥ã€‚ <br><br><h3>  <font color="#9cc2ce">æ¸¸æˆæœç´¢ç»„ç»‡ï¼ˆå¯¹æ¥ä¼šï¼‰</font> </h3><br> æˆ‘å°†å¯åŠ¨é…å¯¹åŠŸèƒ½ï¼Œè¿™å¯¹å¤šäººæ¸¸æˆéå¸¸é‡è¦ã€‚ å½“æˆ‘ä»¬åœ¨æ¸¸æˆä¸­æŒ‰â€œæŸ¥æ‰¾æ¸¸æˆâ€æŒ‰é’®æ—¶ï¼Œè¯¥ç³»ç»Ÿå¼€å§‹å·¥ä½œã€‚ å¥¹ä¼šé€‰æ‹©ç«äº‰å¯¹æ‰‹æˆ–é˜Ÿå‹ï¼Œæˆ–ä¸¤è€…ï¼ˆå–å†³äºæ¸¸æˆï¼‰ã€‚ é€šå¸¸ï¼Œåœ¨è¿™æ ·çš„ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªç©å®¶éƒ½æœ‰ä¸€ä¸ªæ•°å­—æŒ‡ç¤ºå™¨MMRï¼ˆé…æ¯”ï¼‰-ç©å®¶çš„ä¸ªäººè¯„åˆ†ï¼Œç”¨äºé€‰æ‹©å…·æœ‰ç›¸åŒæŠ€èƒ½æ°´å¹³çš„å…¶ä»–ç©å®¶ã€‚ <br><br> ä¸ºäº†æµ‹è¯•æ­¤åŠŸèƒ½ï¼Œæˆ‘æå‡ºäº†ä»¥ä¸‹æµ‹è¯•ï¼š <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"should find match"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gameClient1 = newGameClient(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gameClient2 = newGameClient(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gameClient3 = newGameClient(); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient1.connectAsAnonymous(playerCustomIds.id1); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient2.connectAsAnonymous(playerCustomIds.id2); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient3.connectAsAnonymous(playerCustomIds.id3); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient1.findStandardMatch(); expect(gameClient1.state) .is.equals(GameClientModule.GameClientStates.MATCHMAKING); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient2.findStandardMatch(); expect(gameClient2.state) .is.equals(GameClientModule.GameClientStates.MATCHMAKING); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> gameClient3.findStandardMatch(); expect(gameClient3.state) .is.equals(GameClientModule.GameClientStates.MATCHMAKING); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> sleep(<span class="hljs-number"><span class="hljs-number">3000</span></span>); expect(gameClient1.state) .is.equals(GameClientModule.GameClientStates.CHALLENGE); expect(gameClient1.challenge, <span class="hljs-string"><span class="hljs-string">"challenge"</span></span>).is.not.undefined; expect(gameClient1.challenge.challengeId).is.not.undefined; expect(gameClient2.state) .is.equals(GameClientModule.GameClientStates.CHALLENGE); expect(gameClient2.challenge.challengeId) .is.equals(gameClient1.challenge.challengeId); expect(gameClient3.state) .is.equals(GameClientModule.GameClientStates.CHALLENGE); expect(gameClient3.challenge.challengeId) .is.equals(gameClient1.challenge.challengeId); });</code> </pre><br> ä¸‰ä¸ªå®¢æˆ·ç«¯å·²è¿æ¥åˆ°æ¸¸æˆï¼ˆå°†æ¥ï¼Œè¿™æ˜¯æ£€æŸ¥æŸäº›æƒ…å†µçš„å¿…è¦æœ€ä½è¦æ±‚ï¼‰ï¼Œå¹¶å·²æ³¨å†Œä»¥æœç´¢æ¸¸æˆã€‚ åœ¨æœåŠ¡å™¨ä¸Šæ³¨å†Œç¬¬ä¸‰ä¸ªç©å®¶åï¼Œä¾¿å½¢æˆäº†ä¸€ä¸ªæ¸¸æˆä¼šè¯ï¼Œç©å®¶å¿…é¡»è¿æ¥åˆ°è¯¥æ¸¸æˆã€‚ åŒæ—¶ï¼Œå®¢æˆ·ç«¯çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå¹¶ä¸”å‡ºç°å…·æœ‰ç›¸åŒæ ‡è¯†ç¬¦çš„æ¸¸æˆä¼šè¯çš„ä¸Šä¸‹æ–‡ã€‚ <br><br> é¦–å…ˆï¼Œå‡†å¤‡åç«¯ã€‚ åœ¨GameSparksä¸­ï¼Œæœ‰ä¸€ä¸ªç°æˆçš„ç”¨äºè‡ªå®šä¹‰æ¸¸æˆæœç´¢çš„å·¥å…·ï¼Œå¯åœ¨â€œé…ç½®å™¨-&gt;åŒ¹é…â€è·¯å¾„ä¸­ä½¿ç”¨ã€‚ æˆ‘åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œç„¶åç»§ç»­è¿›è¡Œè®¾ç½®ã€‚ é™¤äº†æ ‡å‡†å‚æ•°ï¼ˆä¾‹å¦‚ä»£ç ï¼Œæ¯”èµ›çš„åç§°å’Œæè¿°ï¼‰å¤–ï¼Œè¿˜æ˜¾ç¤ºäº†è‡ªå®šä¹‰æ¸¸æˆæ¨¡å¼æ‰€éœ€çš„æœ€å°å’Œæœ€å¤§ç©å®¶æ•°ã€‚ æˆ‘å°†ä»£ç â€œ StandardMatchâ€åˆ†é…ç»™åˆ›å»ºçš„æ¯”èµ›ï¼Œå¹¶æŒ‡ç¤º2åˆ°3çš„ç©å®¶äººæ•°ã€‚ <br><br> ç°åœ¨ï¼Œæ‚¨éœ€è¦åœ¨â€œé˜ˆå€¼â€éƒ¨åˆ†ä¸­é…ç½®é€‰æ‹©ç©å®¶çš„è§„åˆ™ã€‚ å¯¹äºæ¯ä¸ªé˜ˆå€¼ï¼Œå°†æŒ‡ç¤ºå…¶ä½œç”¨æ—¶é—´ï¼Œç±»å‹ï¼ˆç»å¯¹ï¼Œç›¸å¯¹å’Œç™¾åˆ†æ¯”ï¼‰å’Œè¾¹ç•Œã€‚ <br><br><img src="https://habrastorage.org/webt/tn/xb/i0/tnxbi0kpa9lb3gwhb3hlbpgs9og.png"><br><br> å‡è®¾æŸä¸ªMMRä¸º19çš„ç©å®¶å¼€å§‹æœç´¢ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå‰10ç§’å°†æ˜¯å…¶ä»–MMRä¸º19åˆ°21çš„ç©å®¶çš„é€‰æ‹©ã€‚å¦‚æœæœªé€‰æ‹©è¯¥ç©å®¶ï¼Œåˆ™ä¼šæ¿€æ´»ç¬¬äºŒä¸ªæœç´¢è¾¹æ¡†ï¼Œè¿™ä¼šå°†æœç´¢èŒƒå›´ä»16ä¸ªæ‰©å±•åˆ°æ¥ä¸‹æ¥çš„20ç§’ï¼ˆ 19-3ï¼‰è‡³22ï¼ˆ19 + 3ï¼‰ã€‚ æ¥ä¸‹æ¥ï¼ŒåŒ…æ‹¬ç¬¬ä¸‰ä¸ªé˜ˆå€¼ï¼Œåœ¨æ­¤é˜ˆå€¼å†…è¿›è¡Œçš„æœç´¢å°†åœ¨14ï¼ˆ19-25ï¼…ï¼‰åˆ°29ï¼ˆ19 + 50ï¼…ï¼‰çš„èŒƒå›´å†…è¿›è¡Œ30ç§’çš„æœç´¢ï¼Œè€Œå¦‚æœå·²ç´¯ç§¯äº†æ‰€éœ€çš„æœ€å°‘ç©å®¶æ•°ç›®ï¼Œåˆ™è®¤ä¸ºæ¯”èµ›å·²å®Œæˆï¼ˆæ¥å—æœ€ä½åˆ†æ•°ï¼‰ç©å®¶ï¼‰ <br><br> å®é™…ä¸Šï¼Œè¯¥æœºåˆ¶æ›´ä¸ºå¤æ‚ï¼Œå› ä¸ºå®ƒè€ƒè™‘äº†è®¾æ³•åŠ å…¥ç‰¹å®šæ¯”èµ›çš„æ‰€æœ‰ç©å®¶çš„MMRã€‚ å½“éœ€è¦è¿›è¡Œæ¸¸æˆçš„è¯„åˆ†æ¨¡å¼æ—¶ï¼Œæˆ‘å°†åˆ†æè¿™äº›ç»†èŠ‚ï¼ˆæœ¬æ–‡ä¸­ä¸ä»‹ç»ï¼‰ã€‚ å¯¹äºæˆ‘ä¸æ‰“ç®—ä½¿ç”¨MMRçš„æ ‡å‡†æ¸¸æˆæ¨¡å¼ï¼Œæˆ‘åªéœ€è¦ä¸€ä¸ªé˜ˆå€¼å³å¯ã€‚ <br><br> é€‰æ‹©æ‰€æœ‰ç©å®¶åï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªæ¸¸æˆä¼šè¯å¹¶å°†å…¶è¿æ¥åˆ°è¯¥ç©å®¶ã€‚ åœ¨GameSparksä¸­ï¼Œæ¸¸æˆä¼šè¯åŠŸèƒ½æ˜¯â€œæŒ‘æˆ˜â€ã€‚ ä½œä¸ºè¯¥å®ä½“çš„ä¸€éƒ¨åˆ†ï¼Œå­˜å‚¨æ¸¸æˆä¼šè¯æ•°æ®ï¼Œå¹¶åœ¨æ¸¸æˆå®¢æˆ·ç«¯ä¹‹é—´äº¤æ¢æ¶ˆæ¯ã€‚ è¦åˆ›å»ºæ–°å‹çš„æŒ‘æˆ˜ï¼Œæ‚¨éœ€è¦éµå¾ªâ€œ Configurator-&gt; Challengesâ€çš„è·¯å¾„ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªä»£ç ä¸ºâ€œ StandardChallengeâ€çš„æ–°ç±»å‹ï¼Œå¹¶æŒ‡å‡ºè¿™ç§ç±»å‹çš„æ¸¸æˆä¼šè¯æ˜¯åŸºäºå›åˆçš„ï¼Œå³ ç©å®¶è½®æµï¼Œè€Œä¸æ˜¯åŒæ—¶è½®æµã€‚  GameSparksåŒæ—¶æ§åˆ¶ç€ç§»åŠ¨é¡ºåºã€‚ <br><br> ä¸ºäº†è®©å®¢æˆ·æ³¨å†Œä»¥æœç´¢æ¸¸æˆï¼Œæ‚¨å¯ä»¥ä½¿ç”¨MatchmakingRequestç±»å‹çš„è¯·æ±‚ï¼Œä½†æˆ‘ä¸å»ºè®®æ‚¨è¿™æ ·åšï¼Œå› ä¸ºè¦æ±‚ç©å®¶çš„MMRå€¼ä½œä¸ºå‚æ•°ä¹‹ä¸€ã€‚ è¿™å¯èƒ½å¯¼è‡´æ¸¸æˆå®¢æˆ·ç«¯æ¬ºè¯ˆï¼Œå¹¶ä¸”å®¢æˆ·ç«¯ä¸åº”è¯¥çŸ¥é“ä»»ä½•MMRï¼Œè¿™æ˜¯ä¸€é¡¹åç«¯ä¸šåŠ¡ã€‚ ä¸ºäº†æ­£ç¡®æ³¨å†Œæ¸¸æˆæœç´¢ï¼Œæˆ‘ä»å®¢æˆ·ç«¯åˆ›å»ºäº†ä¸€ä¸ªä»»æ„äº‹ä»¶ã€‚ è¿™æ˜¯åœ¨â€œé…ç½®å™¨-&gt;äº‹ä»¶â€éƒ¨åˆ†ä¸­å®Œæˆçš„ã€‚ æˆ‘å°†æ­¤äº‹ä»¶ç§°ä¸ºæ²¡æœ‰å±æ€§çš„FindStandardMatchã€‚ ç°åœ¨ï¼Œæ‚¨éœ€è¦é…ç½®å¯¹æ­¤äº‹ä»¶çš„å“åº”ï¼Œä¸ºæ­¤ï¼Œæˆ‘å°†è½¬åˆ°äº‘ä»£ç çš„â€œ Configurator-&gt; Cloud Codeâ€éƒ¨åˆ†ï¼Œåœ¨â€œ Eventsâ€éƒ¨åˆ†ä¸­ä¸ºFindStandardMatchç¼–å†™ä»¥ä¸‹å¤„ç†ç¨‹åºï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matchRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SparkRequests.MatchmakingRequest(); matchRequest.matchShortCode = <span class="hljs-string"><span class="hljs-string">"StandardMatch"</span></span>; matchRequest.skill = <span class="hljs-number"><span class="hljs-number">0</span></span>; matchRequest.Execute();</code> </pre><br> è¯¥ä»£ç åœ¨StandardMatchä¸­æ³¨å†Œäº†ä¸€ä¸ªMMRä¸º0çš„ç©å®¶ï¼Œå› æ­¤ï¼Œæ³¨å†Œç”¨äºæœç´¢æ ‡å‡†æ¸¸æˆçš„ä»»ä½•ç©å®¶éƒ½é€‚åˆåˆ›å»ºæ¸¸æˆä¼šè¯ã€‚ åœ¨é€‰æ‹©ç­‰çº§æ¯”èµ›æ—¶ï¼Œå¯èƒ½ä¼šå¸å¼•ç©å®¶èµ„æ–™çš„ç§äººæ•°æ®ä»¥è·å¾—æ­¤ç±»æ¯”èµ›çš„MMRã€‚ <br><br> å½“æœ‰è¶³å¤Ÿçš„ç©å®¶å¼€å§‹æ¸¸æˆä¼šè¯æ—¶ï¼ŒGameSparkså°†å‘æ‰€æœ‰é€‰å®šçš„ç©å®¶å‘é€MatchFoundMessageæ¶ˆæ¯ã€‚ åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥è‡ªåŠ¨ç”Ÿæˆæ¸¸æˆä¼šè¯å¹¶å‘å…¶ä¸­æ·»åŠ ç©å®¶ã€‚ ä¸ºæ­¤ï¼Œåœ¨â€œç”¨æˆ·æ¶ˆæ¯-&gt; MatchFoundMessageâ€ä¸­æ·»åŠ ä»£ç ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> matchData = Spark.getData(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Spark.getPlayer().getPlayerId() != matchData.participants[<span class="hljs-number"><span class="hljs-number">0</span></span>].id) { Spark.exit(); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> challengeCode = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> accessType = <span class="hljs-string"><span class="hljs-string">"PRIVATE"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (matchData.matchShortCode) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"StandardMatch"</span></span>: challengeCode = <span class="hljs-string"><span class="hljs-string">"StandardChallenge"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: Spark.exit(); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> createChallengeRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SparkRequests.CreateChallengeRequest(); createChallengeRequest.challengeShortCode = challengeCode; createChallengeRequest.accessType = accessType; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tomorrow = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(); tomorrow.setDate(tomorrow.getDate() + <span class="hljs-number"><span class="hljs-number">1</span></span>); createChallengeRequest.endTime = tomorrow.toISOString(); createChallengeRequest.usersToChallenge = []; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> participants = matchData.participants; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> numberOfPlayers = participants.length; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; i &lt; numberOfPlayers; i++) { createChallengeRequest.usersToChallenge.push(participants[i].id) } createChallengeRequest.Send();</code> </pre><br> ä»£ç é¦–å…ˆæ£€æŸ¥å®ƒæ˜¯å¦æ˜¯å‚ä¸è€…åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå‚ä¸è€…ã€‚ æ¥ä¸‹æ¥ï¼Œä»£è¡¨ç¬¬ä¸€ä¸ªç©å®¶ï¼Œåˆ›å»ºStandardChallengeçš„å®ä¾‹ï¼Œå¹¶é‚€è¯·å…¶ä½™ç©å®¶ã€‚ é‚€è¯·çš„ç©å®¶ä¼šæ”¶åˆ°ä¸€ä¸ªChallengeIssuedMessageæ¶ˆæ¯ã€‚ åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥è®¾æƒ³å½“å®¢æˆ·ç«¯ä¸Šæ˜¾ç¤ºåŠ å…¥æ¸¸æˆé‚€è¯·å¹¶éœ€è¦é€šè¿‡å‘é€AcceptChallengeRequestè¿›è¡Œç¡®è®¤æ—¶çš„è¡Œä¸ºï¼Œæˆ–è€…æ‚¨å¯ä»¥ä»¥é™é»˜æ–¹å¼æ¥å—é‚€è¯·ã€‚ å› æ­¤ï¼Œæˆ‘å°†è¿™æ ·åšï¼Œä¸ºæ­¤ï¼Œåœ¨â€œç”¨æˆ·æ¶ˆæ¯-&gt; ChallengeIssuedMessageâ€ä¸­ï¼Œæˆ‘å°†æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> challangeData = Spark.getData(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> acceptChallengeRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SparkRequests.AcceptChallengeRequest(); acceptChallengeRequest.challengeInstanceId = challangeData.challenge.challengeId; acceptChallengeRequest.message = <span class="hljs-string"><span class="hljs-string">"Joining"</span></span>; acceptChallengeRequest.SendAs(Spark.getPlayer().getPlayerId());</code> </pre><br> ä¸‹ä¸€æ­¥ï¼ŒGameSparkså°†è°ƒåº¦ChallengeStartedMessageäº‹ä»¶ã€‚ è¯¥äº‹ä»¶çš„å…¨å±€å¤„ç†ç¨‹åºï¼ˆâ€œ Global Messages-&gt; ChallengeStartedMessageâ€ï¼‰æ˜¯åˆå§‹åŒ–æ¸¸æˆä¼šè¯çš„ç†æƒ³åœºæ‰€ï¼Œåœ¨å®ç°æ¸¸æˆé€»è¾‘æ—¶ï¼Œæˆ‘ä¼šæ³¨æ„è¿™ä¸€ç‚¹ã€‚ <br><br> å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºçš„æ—¶æœºå·²åˆ°ã€‚ å®¢æˆ·ç«¯æ¨¡å—ä¸­çš„æ›´æ”¹ï¼š <br><br><pre> <code class="javascript hljs">exports.GameClientStates = { <span class="hljs-attr"><span class="hljs-attr">IDLE</span></span>: <span class="hljs-string"><span class="hljs-string">"Idle"</span></span>, <span class="hljs-attr"><span class="hljs-attr">MATCHMAKING</span></span>: <span class="hljs-string"><span class="hljs-string">"Matchmaking"</span></span>, <span class="hljs-attr"><span class="hljs-attr">CHALLENGE</span></span>: <span class="hljs-string"><span class="hljs-string">"Challenge"</span></span> } exports.GameClient = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = exports.GameClientStates.IDLE; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.challenge = <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onMessage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (message[<span class="hljs-string"><span class="hljs-string">"@class"</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">".MatchNotFoundMessage"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = exports.GameClientStates.IDLE; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">".ChallengeStartedMessage"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = exports.GameClientStates.CHALLENGE; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.challenge = message.challenge; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"GAME onMessage: "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(message)); } } onMessage = onMessage.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.findStandardMatch = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> eventData = { <span class="hljs-attr"><span class="hljs-attr">eventKey</span></span>: <span class="hljs-string"><span class="hljs-string">"FindStandardMatch"</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { sendRequest(<span class="hljs-string"><span class="hljs-string">"LogEventRequest"</span></span>, eventData) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">response</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!response.error) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = exports.GameClientStates.MATCHMAKING; resolve(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(response.error); reject(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(response)); } }) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); reject(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(error)); }); }); } }</code> </pre><br> æ ¹æ®æµ‹è¯•ï¼Œå®¢æˆ·ç«¯ä¸Šå‡ºç°äº†ä¸¤ä¸ªå­—æ®µ-çŠ¶æ€å’ŒæŒ‘æˆ˜ã€‚  onMessageæ–¹æ³•å·²ç»è·å¾—äº†æœ‰æ„ä¹‰çš„å¤–è§‚ï¼Œç°åœ¨å“åº”æœ‰å…³æ¸¸æˆä¼šè¯å¼€å§‹çš„æ¶ˆæ¯ä»¥åŠæ— æ³•è¿›è¡Œæ¸¸æˆçš„æ¶ˆæ¯ã€‚ è¿˜æ·»åŠ äº†findStandardMatchæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†ç›¸åº”çš„è¯·æ±‚å‘é€åˆ°åç«¯ã€‚ æµ‹è¯•æ˜¯ç»¿è‰²çš„ï¼Œä½†æˆ‘å¾ˆæ»¡æ„ï¼Œå·²ç»æŒæ¡äº†æ¸¸æˆçš„é€‰æ‹©ã€‚ <br><br><h2>  <font color="#292e5b">æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼Ÿ</font> </h2><br> åœ¨ä»¥ä¸‹æ–‡ç« ä¸­ï¼Œæˆ‘å°†æè¿°å¼€å‘æ¸¸æˆé€»è¾‘çš„è¿‡ç¨‹ï¼Œä»åˆå§‹åŒ–æ¸¸æˆä¼šè¯åˆ°å¤„ç†ç§»åŠ¨ã€‚ æˆ‘å°†åˆ†æå­˜å‚¨ä¸åŒç±»å‹æ•°æ®çš„åŠŸèƒ½-æ¸¸æˆå…ƒæ•°æ®çš„æè¿°ï¼Œæ¸¸æˆä¸–ç•Œçš„ç‰¹å¾ï¼Œæ¥è‡ªæ¸¸æˆä¼šè¯çš„æ•°æ®ä»¥åŠæœ‰å…³ç©å®¶çš„æ•°æ®ã€‚ æ¸¸æˆé€»è¾‘å°†é€šè¿‡ä¸¤ç§æµ‹è¯•æ¥å¼€å‘-å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘å°†æŒ‰</a>ä¸æ–‡ç« ç›¸å…³çš„éƒ¨åˆ†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸Šè½½githubä¸Šçš„æºä»£ç </a> ã€‚ <br><br> æœ‰ä¸€ç§ç†è§£ï¼Œä¸ºäº†æœ‰æ•ˆåœ°å¼€å‘ä¸€æ¬¾æ¸¸æˆï¼Œæ‚¨éœ€è¦æ‰©å±•æˆ‘ä»¬çš„å‘çƒ§å‹å›¢é˜Ÿã€‚ è‰ºæœ¯å®¶/è®¾è®¡å¸ˆå³å°†åŠ å…¥ã€‚ è¿˜æœ‰Unity3Dçš„ä¸“å®¶ï¼Œä»–å°†æˆä¸ºç§»åŠ¨å¹³å°çš„é¢†å¯¼è€…ï¼Œè¿˜æœ‰å¾…è§‚å¯Ÿã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN451458/">https://habr.com/ru/post/zh-CN451458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN451446/index.html">äº§å“å¼€å‘è§†è§‰è¾…åŠ©ï¼šè®¾è®¡</a></li>
<li><a href="../zh-CN451448/index.html">ä¸ºä»€ä¹ˆå¯èƒ½éœ€è¦ä¸è¿½è¸ª</a></li>
<li><a href="../zh-CN451452/index.html">Build2019ï¼Œäº†è§£æˆ‘ä»¬æ‰€è§</a></li>
<li><a href="../zh-CN451454/index.html">æˆ‘ä»¬æ›´æ”¹é€šçŸ¥åº”ç”¨ç¨‹åºiOSçš„å†…å®¹</a></li>
<li><a href="../zh-CN451456/index.html">ä¿„ç½—æ–¯AERODISKå­˜å‚¨ï¼šè´Ÿè½½æµ‹è¯•ã€‚ å‹ç¼©IOPS</a></li>
<li><a href="../zh-CN451460/index.html">æœ±è‰å¨…åœ¨è¿·å®«ä¸­</a></li>
<li><a href="../zh-CN451462/index.html">åœ¨Laravelä¸­ä½¿ç”¨æ´»é¡µå¤¹ç¼–å†™æ›´å°‘é‡å¤çš„ä»£ç </a></li>
<li><a href="../zh-CN451464/index.html">å‰ç«¯æ¯å‘¨æ‘˜è¦ï¼ˆ2019å¹´5æœˆ6æ—¥è‡³12æ—¥ï¼‰</a></li>
<li><a href="../zh-CN451466/index.html">graphql-é™·é˜±</a></li>
<li><a href="../zh-CN451468/index.html">ä¸Šå‘¨ç¬¬364æœŸï¼ˆ2019å¹´5æœˆ6æ—¥è‡³12æ—¥ï¼‰çš„å‰ç«¯ä¸–ç•Œæ‘˜è¦</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>