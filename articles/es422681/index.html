<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçüéì üèáüèª üë©‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë® Integraci√≥n de SAP y Python o c√≥mo tomar datos de SAP m√°s f√°cilmente üëâüèæ ü§∞üèº üå©Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Buenas tardes, Habr! 

 Quiero compartir la experiencia de una tarea interesante sobre c√≥mo interactuar f√°cilmente con los sistemas SAP utilizando Pyt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Integraci√≥n de SAP y Python o c√≥mo tomar datos de SAP m√°s f√°cilmente</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422681/">  Buenas tardes, Habr! <br><br>  Quiero compartir la experiencia de una tarea interesante sobre c√≥mo interactuar f√°cilmente con los sistemas SAP utilizando Python, no importa qu√© m√≥dulo o versi√≥n de la plataforma. <br><br>  Si solo la soluci√≥n t√©cnica es interesante, omita todas las letras y vea un ejemplo de implementaci√≥n. <br><br><h3>  Letras de canciones </h3><br>  Todo se redujo al hecho de que uno de los clientes necesitaba descargar datos de su sistema SAP ERP, manipulando ya creaba informes y enviaba correos electr√≥nicos a las personas interesadas por correo electr√≥nico, as√≠ como otras acciones. <br><br>  En realidad, cuando discutimos la soluci√≥n de tal problema, nosotros, como contratista, propusimos varias opciones y una de las m√°s obvias es hacerlo todo con la ayuda de la funcionalidad interna de SAP, de una manera simple entre los "zapadores" para Zed, todos con ABAP. <br><br>  Lo primero que encontramos fue el criterio para seleccionar datos que no son completamente transparentes de las palabras del cliente, a saber, los datos de qu√© tablas, por qu√©, por qu√©, qu√© acciones se deben realizar con ellos.  Si da un ejemplo, entonces el cliente necesitaba descargar la asistencia de los empleados de la oficina, con datos en el contexto de las hojas de tiempo y las vacaciones.  Tambi√©n fue necesario crear informes sobre el desempe√±o de los empleados con an√°lisis de su tiempo en el lugar de trabajo, no entrar√© en detalles, pero dir√© que la cantidad de tiempo invertido afecta la productividad, pero para averiguarlo, debe calcular la cantidad de tiempo en el trabajo con el resultado del trabajo y mucho otro  Este es solo un ejemplo de un informe, y el cliente gener√≥ mucho durante las discusiones. <br><br>  Despu√©s de largas conversaciones, nos dimos cuenta de que SAP Query o BI \ BO podr√≠an convertirse en una soluci√≥n, pero el cliente no estaba muy satisfecho con el costo estimado de la soluci√≥n y no con la flexibilidad m√°s conveniente. <br><a name="habracut"></a><br><h3>  Soluci√≥n Python </h3><br>  Entonces pens√© en mi propia cabeza acerca de un art√≠culo sobre un recurso sobre la biblioteca pyrfc y, como no hab√≠a sido programador de Python, pero hab√≠a le√≠do sobre eso una vez, decid√≠ estudiarlo en casa y, para mi sorpresa, era un aficionado a gusto. de este lenguaje de programaci√≥n descubr√≠ que conectarse a cualquier sistema SAP es incre√≠blemente simple; adem√°s, lleva 20 minutos. <br><br>  Veinte minutos CARL !!! <br><br>  Imagine que puede configurar la interfaz de conexi√≥n con el sistema SAP ERP sin utilizar buses de datos y todo tipo de PI \ XI en tan poco tiempo. <br><br><h3>  Implementaci√≥n </h3><br>  Finalmente, asegur√°ndome de que esta es una soluci√≥n que funciona y satisface al cliente, estudi√© varias plataformas (la estudi√©, le√≠ cada 10 minutos), eleg√≠ la plataforma Odoo, entre otras cosas, ya que es m√°s f√°cil de implementar y tiene todas las propiedades necesarias, como: Bueno interfaz, sistema de derechos de acceso, aplicaci√≥n m√≥vil, servidor de correo, buena interfaz de base de datos (psql). <br><br>  Adem√°s, todo es muy simple. <br><br>  Instale <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Odoo</a> en la m√°quina virtual del cliente (tom√© la versi√≥n 8) porque  es el m√°s simple en este momento, s√© que la versi√≥n 12 ya es, pero la tarea no requiere todos los nuevos productos geniales. <br><br>  Instal√≥ todas las bibliotecas necesarias, en particular pyrfc, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace a un art√≠culo sobre instalaci√≥n y conexi√≥n</a> . <br><br>  Adem√°s, solo era necesario escribir un peque√±o m√≥dulo en la propia plataforma Odoo, para conectividad, y ten√≠a muchas herramientas para visualizar datos. <br><br>  Con√©ctese al sistema del cliente: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyrfc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Connection user = <span class="hljs-string"><span class="hljs-string">'user'</span></span> passwd = <span class="hljs-string"><span class="hljs-string">'secretuser'</span></span> saprouter = <span class="hljs-string"><span class="hljs-string">'/H/192.168.0.140/S/3297'</span></span> conn = Connection(user=user, passwd=password, mshost=<span class="hljs-string"><span class="hljs-string">'CLient'</span></span>, msserv=<span class="hljs-string"><span class="hljs-string">'192.168.0.140'</span></span>, sysid=<span class="hljs-string"><span class="hljs-string">'01'</span></span>, group=<span class="hljs-string"><span class="hljs-string">"SPACE"</span></span>, saprouter=saprouter, client=<span class="hljs-string"><span class="hljs-string">'900'</span></span>)</code> </pre> <br>  Llame a BAPI para obtener informaci√≥n del usuario. <br><br><pre> <code class="python hljs">b_result = conn.call(<span class="hljs-string"><span class="hljs-string">'BAPI_USER_GET_DETAIL'</span></span>, USERNAME = <span class="hljs-string"><span class="hljs-string">'user'</span></span>, CACHE_RESULTS = <span class="hljs-string"><span class="hljs-string">' '</span></span>)</code> </pre><br>  Cambio de usuario <br><br><pre> <code class="python hljs">updated_address[<span class="hljs-string"><span class="hljs-string">'CITY'</span></span>] = <span class="hljs-string"><span class="hljs-string">u'Moscow'</span></span> r = conn.call(<span class="hljs-string"><span class="hljs-string">'BAPI_USER_CHANGE'</span></span>, USERNAME=<span class="hljs-string"><span class="hljs-string">'user'</span></span>, ADDRESS=updated_address)</code> </pre><br>  La herramienta m√°s importante para obtener datos de SAP, cuando se trata de tablas, es el m√≥dulo funcional RFC_READ_TABLE, hay otros m√≥dulos en la plataforma SAP que se pueden invocar, debe haber una configuraci√≥n en ellos que diga que se pueden invocar usando RFC. <br><br>  Por ejemplo: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pyrfc <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Connection, ABAPApplicationError, ABAPRuntimeError, LogonError, CommunicationError <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ConfigParser <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pprint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PrettyPrinter <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: config = ConfigParser() config.read(<span class="hljs-string"><span class="hljs-string">'sapnwrfc.cfg'</span></span>) - <span class="hljs-comment"><span class="hljs-comment"># ,        SAP ERP params_connection = config._sections['connection'] conn = Connection(**params_connection) #    options = [{ 'TEXT': "FCURR = 'USD'"}] pp = PrettyPrinter(indent=4) ROWS_AT_A_TIME = 10 rowskips = 0 while True: print u"----Begin of Batch---" result = conn.call('RFC_READ_TABLE', \ QUERY_TABLE = 'TCURR', \ OPTIONS = options, \ ROWSKIPS = rowskips, ROWCOUNT = ROWS_AT_A_TIME) pp.pprint(result['DATA']) rowskips += ROWS_AT_A_TIME if len(result['DATA']) &lt; ROWS_AT_A_TIME: break except CommunicationError: print u"Could not connect to server." raise except LogonError: print u"Could not log in. Wrong credentials?" raise except (ABAPApplicationError, ABAPRuntimeError): print u"An error occurred." raise</span></span></code> </pre><br><h3>  Resultado </h3><br>  En esta imagen, una lista de informes que se descargan mediante este m√©todo y un ejemplo de uno de ellos. <br><br><img src="https://habrastorage.org/webt/ws/jk/sp/wsjkspjwwobeqnjznhaudqgw8do.jpeg"><br><br><h3>  Resumen </h3><br>  En general, este m√©todo abre grandes oportunidades para reemplazar herramientas SAP muy costosas y otras por otras m√°s flexibles y abiertas. <br><br>  Los ejemplos de c√≥digo se toman de fuentes abiertas.  No tengo derechos para usar el c√≥digo del cliente en el art√≠culo, y no soy un programador de Python, podr√≠a haber cometido un error en alguna parte. <br><br>  Quiero agregar que ya utilizamos esta herramienta en una amplia gama de tareas relacionadas con el c√°lculo de KPI, enviando datos a otras fuentes (sitios web, bases de datos de proveedores y clientes), enviando informaci√≥n de sistemas basados ‚Äã‚Äãen datos de SAP y mucho m√°s. <br>  En general, esa oportunidad fue un descubrimiento para m√≠, si alguien tiene una experiencia similar, me encantar√≠a escuchar. <br><br>  PD: No abord√© el problema de las licencias, por lo que no puedo decir con certeza nada sobre este tema. <br>  Gracias <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlace Habr</a> <br>  Sinceramente, Consultor SAP </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422681/">https://habr.com/ru/post/es422681/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422669/index.html">Oracle vs PostgreSQL. Por qu√© elegir Oracle podr√≠a ser una decisi√≥n inteligente</a></li>
<li><a href="../es422671/index.html">5G puede reemplazar cables, pero no en todas partes</a></li>
<li><a href="../es422675/index.html">Hecho en el espacio: qui√©n har√° la fibra en la ISS</a></li>
<li><a href="../es422677/index.html">Tres meses despu√©s: c√≥mo GDPR afect√≥ las cookies</a></li>
<li><a href="../es422679/index.html">Problemas imaginarios: la raz√≥n del mal software</a></li>
<li><a href="../es422683/index.html">En los EE. UU., Dos comerciantes establecieron una empresa de corretaje falso para robar dinero de inversores novatos</a></li>
<li><a href="../es422685/index.html">Reloj inteligente Samsung Galaxy Watch: actualizaci√≥n de Android Wear OS a Tizen OS - experiencia personal</a></li>
<li><a href="../es422687/index.html">Mensajeros en peligro</a></li>
<li><a href="../es422689/index.html">Detecci√≥n de color de autom√≥viles utilizando redes neuronales y TensorFlow</a></li>
<li><a href="../es422691/index.html">La c√°mara h√≠brida y el LIDAR mejoran las capacidades de los robom√≥viles, complementando la informaci√≥n sobre el mundo exterior.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>