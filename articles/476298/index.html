<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>锔   Repase las espinas para bicicletas, primera parte: aprenda los conceptos b谩sicos de la personalizaci贸n del depurador de Visual Studio usando complementos す  </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Una de las innovaciones de Visual Studio 2012 fue acompa帽ada por la aparici贸n de un nuevo depurador personalizado llamado Concord. Su sistema de compo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Repase las espinas para bicicletas, primera parte: aprenda los conceptos b谩sicos de la personalizaci贸n del depurador de Visual Studio usando complementos</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476298/"><img src="https://habrastorage.org/webt/kl/8o/1x/kl8o1xvmgggvg_ssk6tb72xz6se.png" align="right">  Una de las innovaciones de Visual Studio 2012 fue acompa帽ada por la aparici贸n de un nuevo depurador personalizado llamado Concord.  Su sistema de componentes permite que los complementos VSIX personalicen el comportamiento del depurador y escriban nuevas herramientas sensibles al contexto que pueden usar el depurador para sus necesidades.  Su API proporciona muchas caracter铆sticas de QOL, como la coordinaci贸n entre el c贸digo administrado / no administrado, la integraci贸n perfecta con un proceso remoto / depurado localmente, y m谩s.  De hecho, 隆casi todo lo que se puede hacer en el IDE se puede hacer mediante programaci贸n utilizando la API de Concord!  Cambie los valores de variables espec铆ficas sobre la marcha, llame a funciones a pedido (隆o haga que el programa salte llamadas a ellas!), 隆Los complementos pueden buscar por PDB (!), Paso a paso e incluso modificaci贸n de c贸digo!  Abra el gato y aprender谩 sobre estas innovaciones poco conocidas en el campo de la construcci贸n de bicicletas. <br><a name="habracut"></a><br>  Probablemente deber铆as comenzar desde el principio.  El depurador detecta los componentes leyendo informaci贸n del archivo <i>vsdconfig al</i> que hace referencia el manifiesto del complemento VSIX.  A su vez, <i>vsdconfig</i> indica qu茅 interfaces est谩n implementadas por los componentes del complemento y c贸mo encontrar estos componentes (enlace a un archivo .dll, indicando la clase o, en el caso de la implementaci贸n nativa, indicando CLSID. Dar茅 ejemplos en C #).  Adem谩s, se indica un identificador 煤nico (GUID) para cada componente, as铆 como su "nivel".  Un nivel es lo que determina en qu茅 orden se procesar谩n los complementos, as铆 como en el contexto de qu茅 proceso se cargar谩 esta implementaci贸n, en el proceso IDE o en el proceso de la aplicaci贸n depurada.  Esto se debe al hecho de que algunas funcionalidades solo pueden funcionar en el contexto de un IDE, y viceversa, solo en el contexto de un proceso depurado.  Algunas funciones API funcionan de la misma manera all铆 y all谩.  Por lo tanto, varios componentes tienen sus propias reglas de dise帽o, ya que pueden depender de los elementos existentes del depurador, ubicados en sus niveles fijos.  Para evitar incidentes, recomiendo RTFM (https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.debugger.componentinterfaces?view=visualstudiosdk-2017) y experimentos independientes en una caja de arena separada, lo que no ser谩 una pena elimine si sucede algo (esto est谩 conectado, de nuevo, con un matiz as铆; en algunos casos, ni siquiera est谩 claro por qu茅 el ensamblaje o tipo no se est谩 cargando, porque todav铆a no pude encontrar d贸nde aparecer铆an los registros que se帽alar铆an el problema de forma estable. Error, por ejemplo, con referencia a una dependencia que no se puede cargar en el proceso de destino, puede aparecer en la salida st  di-, o no. S茅 akuratno, tomar compromete frecuentes, <s>y no sentarse detr谩s de la rueda de borracho).</s> <br><br>  La lista de niveles es la siguiente (dar茅 el texto en ingl茅s para que el lector no tenga incidentes al cometer actos RFTM): <br><br>  Niveles de componentes IDE (valores&gt; 100,000): <br><div class="scrollable-table"><table><tbody><tr><th>  Componente </th><th>  Nivel de componente </th></tr><tr><td>  AD7 AL </td><td>  1,000,000,000 </td></tr><tr><td>  Proveedor de desmontaje </td><td>  9,998,000 </td></tr><tr><td>  Consulta de pila: componentes que desean consultar la pila de llamadas </td><td>  9,997,000 </td></tr><tr><td>  Proveedor de pila </td><td>  9,996,000 </td></tr><tr><td>  Filtro de pila: nivel donde las pilas se pueden filtrar y anotar </td><td>  9,995,000 </td></tr><tr><td>  Gerente de punto de interrupci贸n </td><td>  9,994,000 </td></tr><tr><td>  Evaluaci贸n de expresi贸n IDE </td><td>  9,992,000 </td></tr><tr><td>  Symbol Stack Walkers - caminantes de pila que necesitan acceso a s铆mbolos </td><td>  9,991,000 </td></tr><tr><td>  IDE SymbolProvider: componentes que proporcionan informaci贸n de s铆mbolos al resto del depurador.  La ruta del s铆mbolo no debe usarse por debajo de este nivel. </td><td>  1,999,000 </td></tr></tbody></table></div><br>  Niveles de componentes del proceso de destino (valores &lt;99.999): <br><div class="scrollable-table"><table><tbody><tr><th>  Componente </th><th>  Nivel de componente </th></tr><tr><td>  Monitor Symbol Provider: proveedores de s铆mbolos cuando el estado simb贸lico se construye en la computadora de destino (ej .: int茅rprete, c贸digo compilado / emitido din谩micamente) </td><td>  75,000 </td></tr><tr><td>  Procesador de condici贸n de punto de interrupci贸n: este nivel es para procesar condiciones de punto de interrupci贸n, como expresiones de condici贸n y recuentos de aciertos.  Por debajo de este punto, todos los eventos de punto de interrupci贸n f铆sico ser谩n visibles independientemente de si tienen o no condiciones falsas. </td><td>  70,000 </td></tr><tr><td>  Supervisar proveedor de tareas: este es el nivel para la miner铆a de datos de tareas en el proceso de destino </td><td>  65,500 </td></tr><tr><td>  Evaluador de expresi贸n de monitor </td><td>  65,000 </td></tr><tr><td>  Coordinaci贸n de monitores: componentes que arbitran entre los distintos monitores para escalones, puntos de interrupci贸n por direcci贸n nativa, recorrido de pila, etc. </td><td>  60,000 </td></tr><tr><td>  Monitorear caminantes de pila </td><td>  55,000 </td></tr><tr><td>  Monitor de depuraci贸n personalizado: reservado para monitores de depuraci贸n de terceros que desean utilizar los servicios proporcionados por los monitores de depuraci贸n est谩ndar. </td><td>  40,500 </td></tr><tr><td>  Runtime Debug Monitor: proporciona inspecci贸n de datos y control de ejecuci贸n para c贸digo administrado / nativo / script </td><td>  40,000 </td></tr><tr><td>  Monitor de depuraci贸n base </td><td>  10,000 </td></tr><tr><td>  Servicios de supervisi贸n de depuraci贸n base: proporciona servicios de utilidad para supervisar la supervisi贸n de depuraci贸n (por ejemplo, creaci贸n de procesos), as铆 como servicios de depuraci贸n previa (por ejemplo: enumeraci贸n de procesos) </td><td>  1,000 </td></tr></tbody></table></div><br>  A continuaci贸n, en orden, el proceso de creaci贸n de un proyecto.  Si no hubiera matices importantes, podr铆a describir este proceso m铆nimamente o omitirlo, pero las realidades son completamente diferentes: necesitamos una serie de dependencias de la biblioteca, as铆 como una herramienta para crear archivos de configuraci贸n, que por alguna raz贸n no se distribuye con VisualStudio, pero est谩 disponible solo con nuget.  De hecho, ahora necesitamos pasar a la esencia.  El proceso de creaci贸n y configuraci贸n de un proyecto se estructura de la siguiente manera: <br><br><ol><li>  Abra Visual Studio.  En mi caso, 2017 Community Edition </li><li>  Proyecto VSIX ( <i>Visual C # -&gt;</i> pesta帽a <i>Extensibilidad</i> , o mediante b煤squeda).  Llam茅moslo "HelloVSIX" </li><li>  Agregue un nuevo proyecto de biblioteca de clases en soluci贸n y ll谩melo "DebuggeePlugin" </li><li>  Ponemos la referencia en el proyecto "DebuggeePlugin" en el proyecto "HelloVSIX" </li><li>  Ponemos la referencia al ensamblado "Microsoft.VisualStudio.Debugger.Engine" en el proyecto DebuggeePlugin </li><li>  Agregue la referencia para el paquete nuget Microsoft.VSSDK.Debugger.VSDConfigTool al proyecto "DebuggeePlugin".  Esta es nuestra herramienta para generar configuraciones VSD. </li></ol><br>  Ahora, estamos listos para hacer que nuestro complemento haga algo 煤til.  Hagamos lo m谩s simple que se puede hacer: dejar que muestre un cuadro de mensaje que dice "Hola VSIX" cuando el proceso de destino se encuentra con un punto de entrada.  Para hacer esto, necesitamos crear una clase que implemente la interfaz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">IDkmEntryPointNotification</a> , as铆 como completar varios archivos de configuraci贸n.  Agregue una nueva clase p煤blica llamada DkmEntryPointNotificationService, y herede la interfaz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">IDkmEntryPointNotification</a> , y deje la implementaci贸n predeterminada por ahora: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger.ComponentInterfaces; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">DebuggeePlugin</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DkmEntryPointNotificationService</span></span> : <span class="hljs-title"><span class="hljs-title">IDkmEntryPointNotification</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotImplementedException(); } } }</code> </pre> <br>  Agregue el archivo "DkmEntryPointNotificationService.vsdconfigxml" al proyecto "DebuggeePlugin".  Para cada clase declarada que deber铆a recibir notificaciones a trav茅s de implementaciones de las interfaces de espacio de nombres Microsoft.VisualStudio.Debugger.ComponentInterfaces, debe tener dicho archivo.  Por cierto, es posible implementar varias interfaces de este tipo a la vez en una clase.  Ahora necesitamos cambiar la acci贸n de compilaci贸n de nuestro archivo ".vsdconfigxml".  Para hacer esto, debe editar manualmente el archivo del proyecto (en serio).  Descargamos el proyecto DebuggeePlugin y lo abrimos con el editor de estudio.  Necesitamos encontrar la siguiente etiqueta XLM: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">None</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre><br>  y mueva esta etiqueta a su propio ItemGroup, cambiando el tipo de None a VsdConfigXmlFiles: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VsdConfigXmlFiles</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Include</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DkmEntryPointNotificationService.vsdconfigxml"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ItemGroup</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Puede guardar y volver a cargar el proyecto. <br><br>  Ahora, ve a las configuraciones.  Lo primero que debe hacer: si el archivo vsdconfig.xsd se agrega al proyecto DebuggeePlugin, entonces debe eliminarse.  Lo reemplazaremos ahora, porque es m谩s f谩cil trabajar con texto sin formato.  Abra DkmEntryPointNotificationService.vsdconfigxml y reemplace el texto con lo siguiente: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.microsoft.com/vstudio/vsdconfig/2008"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"422413E1-450E-40A6-AE24-7E80A81CC668"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ComponentLevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">^_^quotquot^_^</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">AssemblyName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.DkmEntryPointNotificationService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NoFilter</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Interface</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IDkmEntryPointNotification"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InterfaceGroup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Implements</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ManagedComponent</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  En cualquiera de estos archivos, se nos solicitar谩 que indiquemos lo siguiente: <br><br><ol><li>  ComponentId: este valor se puede generar utilizando la herramienta de generaci贸n de GUID (Herramientas -&gt; CreateGUID) </li><li>  ComponentLevel es el nivel de nuestro componente en la jerarqu铆a.  Consulte la tabla anterior y la informaci贸n de ayuda sobre MSDN para seleccionar el rango de valores deseado. </li><li>  Assemblyname es el nombre de nuestro ensamblado (隆no es una soluci贸n!).  En este caso, habr谩 un DebuggeePlugin </li><li>  Nombre de clase: debe indicarse, incluido el espacio de nombres en el que se encuentra la clase.  En este caso, DebuggeePlugin.DkmEntryPointNotificationService </li><li>  Matriz InterfaceGroup: cada entrada en ella indica una interfaz implementada por este componente.  Dentro de cada nodo de InterfaceGroup, debe haber un subnodo que indique las interfaces comunes a todos, en este grupo, filtro, pero sobre filtros m谩s adelante.  Ahora solo tenemos un nodo de interfaz y lleva el nombre de la interfaz IdkmEntryPointNotification.  Si tuvi茅ramos varias interfaces, habr铆a varios nodos de interfaz. </li></ol><br>  Perm铆tame recordarle que para cada clase que deber铆a recibir notificaciones del depurador, debe haber dicho archivo.  Pero la diversi贸n no termina ah铆.  Cada uno de estos archivos, posteriormente, se recopila en un archivo .vsdconfig en el directorio de salida del proyecto.  Y deben referenciarse en el manifiesto del complemento.  Esto se hace de la siguiente manera: <br><br><ol><li>  Despu茅s de haber generado el archivo ".vsdconfigxml", debemos ... recopilar la soluci贸n una vez, de lo contrario no tendremos ning煤n archivo .vsdconfig en el directorio de salida del proyecto) </li><li>  Despu茅s de eso, abra el editor de texto para el archivo source.extension.vsixmanifest y agregue el siguiente c贸digo antes de cerrar la etiqueta PackageManifest: </li></ol><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Assets</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Asset</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggerEngineExtension"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">d:Source</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"File"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DebuggeePlugin.vsdconfig"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Assets</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Si, despu茅s de las acciones completadas, el archivo "DebuggeePlugin.vsdconfig" aparece en el proyecto HelloVSIX, debe <b>RETIRARSE DEL PROYECTO</b> y la soluci贸n debe recopilarse nuevamente, de lo contrario no se actualizar谩. <br><br>  隆El trabajo preparatorio ha terminado!  Puede comenzar a depurar nuestro complemento.  Esto se realiza mediante el lanzamiento de una instancia experimental de VisualStudio (para proyectos VSIX, este es el objetivo de depuraci贸n predeterminado, por lo que no son necesarios pasos adicionales).  En realidad, hacemos clic en Debug-&gt; StartDebugging y vemos una instancia experimental de VisualStudio.  En 茅l, por defecto, nuestro complemento ya deber铆a estar instalado.  Puede verificar esto a trav茅s del men煤 Herramientas-&gt; Extensiones y actualizaciones. <br><br>  Debido al hecho de que implementamos la interfaz IDkmEntryPointNotification, tendremos que crear un proyecto de prueba en una instancia experimental de VisualStudio.  En realidad, creamos un nuevo proyecto, seleccionamos <b>C ++ -&gt; Aplicaci贸n de consola</b> (elija C ++, porque los siguientes ejemplos contendr谩n detalles espec铆ficos de C ++), <b>ll谩melo VSIXTestApp</b> , ejecute sin ning煤n cambio, recopile y vea que nuestra instancia experimental dej贸 de lanzar una excepci贸n dentro del m茅todo DebuggeePlugin. DkmEntryPointNotificationService.OnEntryPoint.  Genial  Ahora necesita mostrar el cuadro de mensaje.  Para hacer esto, es necesario agregar las siguientes referencias al proyecto DebuggeePlugin: <br><br><ul><li>  Microsoft.VisualStudio.Shell.15.0 </li><li>  Microsoft.VisualStudio.Shell.Interop </li><li>  Microsoft.VisualStudio.Shell.Interop.8.0 </li><li>  Microsoft.VisualStudio.OLE.Interop </li></ul><br>  Agregue dos usos al comienzo del archivo DkmEntryPointNotificationService.cs: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell.Interop;</code> </pre><br>  Y agregue una llamada al m茅todo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">VsShellUtilities.ShowMessageBox</a> en el m茅todo DkmEntryPointNotificationService.OnEntryPoint: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Debugger.ComponentInterfaces; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.VisualStudio.Shell.Interop; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Text; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading.Tasks; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">DebuggeePlugin</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DkmEntryPointNotificationService</span></span> : <span class="hljs-title"><span class="hljs-title">IDkmEntryPointNotification</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEntryPoint</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DkmProcess process, DkmThread thread, DkmEventDescriptor eventDescriptor</span></span></span><span class="hljs-function">)</span></span> { VsShellUtilities.ShowMessageBox(Microsoft.VisualStudio.Shell.ServiceProvider.GlobalProvider, <span class="hljs-string"><span class="hljs-string">"Hello VSIX"</span></span>, <span class="hljs-string"><span class="hljs-string">"Hello VSIX"</span></span>, OLEMSGICON.OLEMSGICON_INFO, OLEMSGBUTTON.OLEMSGBUTTON_OK, OLEMSGDEFBUTTON.OLEMSGDEFBUTTON_FIRST); } } }</code> </pre><br>  Reconstruimos, lanzamos una instancia experimental del estudio, lanzamos un proyecto de prueba y 隆listo! <br><br>  隆Vemos que la instancia de prueba del estudio cre贸 MessageBox! <br><br><img src="https://habrastorage.org/webt/2c/a7/fd/2ca7fdpdvkt3z_fscr76xskl7rk.png"><br><br>  驴Y qu茅, de hecho, se beneficia? <br><br>  Aqu铆 aprendimos c贸mo configurar un proyecto VSIX que contenga un complemento para el depurador de Visual Studio, teniendo en cuenta la mayor铆a de los matices que se interpusieron en el camino del resultado.  Este es el punto de partida para un trabajo m谩s detallado.  En el pr贸ximo art铆culo, le mostrar茅 otro punto importante: c贸mo se realiza la comunicaci贸n entre el IDE y los componentes de destino de depuraci贸n. <br><br>  Para obtener m谩s ayuda sobre el uso de la API de Concord, puede consultar no solo MSDN, sino tambi茅n los siguientes repositorios de Microsoft en el github: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">github.com/microsoft/PTVS</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" rel="nofollow">github.com/Microsoft/ConcordExtensibilitySamples</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/476298/">https://habr.com/ru/post/476298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../476288/index.html">Los 5 principales marcos JS para el desarrollo front-end en 2020. Parte 2</a></li>
<li><a href="../476290/index.html">Manejo de errores en Express</a></li>
<li><a href="../476292/index.html">SVG o lienzo?</a></li>
<li><a href="../476294/index.html">Red de juegos distribuidos como alternativa a GFN: c贸mo y por qu茅 puede despegar, donde ya funciona en la Federaci贸n Rusa</a></li>
<li><a href="../476296/index.html">21 de noviembre, Product Engineering MeetUp: 驴Qui茅n es un ingeniero de producto?</a></li>
<li><a href="../476300/index.html">La revista Tram es una estrella de la vanguardia de los ni帽os rusos que brilla intensamente y se desvaneci贸 r谩pidamente</a></li>
<li><a href="../476304/index.html">Autenticaci贸n de hardware del dispositivo Linux en sistemas de nivel superior</a></li>
<li><a href="../476306/index.html">Instrucciones de TelegramBot para crear funcionalidades b谩sicas para el bot. (Parte 1)</a></li>
<li><a href="../476308/index.html">Las 5 mejores pr谩cticas de desarrollo de software a seguir en 2020</a></li>
<li><a href="../476310/index.html">CRM de rostro humano</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>