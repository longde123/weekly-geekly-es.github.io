<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСйЁЯП╛тАНЁЯОУ ЁЯШ╖ ЁЯез рджреАрдк рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдирд╛: рдордХрдбрд╝рд┐рдпреЛрдВ рдХреЛ рдХреИрд╕реЗ рдЪрд▓рдирд╛ рд╕рд┐рдЦрд╛рдПрдВ ЁЯСйтАНтЭдя╕ПтАНЁЯТЛтАНЁЯСи ЁЯС░ЁЯП╛ ЁЯСИЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЖрдЬ рдореИрдВ рдЖрдкрдХреЛ рдмрддрд╛рдКрдВрдЧрд╛ рдХрд┐ рдХреИрд╕реЗ рдореИрдВрдиреЗ рд░реЛрдмреЛрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реБрджреГрдвреАрдХрд░рдг рдХреЗ рдЧрд╣рди рд╢рд┐рдХреНрд╖рдг рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ред рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдореИрдВ рдЖрдкрдХреЛ рдмрддрд╛рддрд╛ рд╣реВрдБ рдХрд┐ "рдд...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рджреАрдк рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдирд╛: рдордХрдбрд╝рд┐рдпреЛрдВ рдХреЛ рдХреИрд╕реЗ рдЪрд▓рдирд╛ рд╕рд┐рдЦрд╛рдПрдВ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483078/"><iframe width="560" height="315" src="https://www.youtube.com/embed/rxWmEnWR3jw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  рдЖрдЬ рдореИрдВ рдЖрдкрдХреЛ рдмрддрд╛рдКрдВрдЧрд╛ рдХрд┐ рдХреИрд╕реЗ рдореИрдВрдиреЗ рд░реЛрдмреЛрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕реБрджреГрдвреАрдХрд░рдг рдХреЗ рдЧрд╣рди рд╢рд┐рдХреНрд╖рдг рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ред  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдореИрдВ рдЖрдкрдХреЛ рдмрддрд╛рддрд╛ рд╣реВрдБ рдХрд┐ "рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХреЗ рд╕рд╛рде рдмреНрд▓реИрдХ рдмреЙрдХреНрд╕" рдХреИрд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛рдП, рдЬреЛ рдЗрдирдкреБрдЯ рдкрд░ рд░реЛрдмреЛрдЯ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рддрд╛ рд╣реИ рдЬреЛ рдЗрд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рдкрд░ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рд╕рдорд╛рдзрд╛рди рдХрд╛ рдореВрд▓ рд╣реИ <b>рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдПрдХреНрдЯрд░ рдХреНрд░рд┐рдЯрд┐рдХ</b> (рдП 2 рд╕реА) рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо, <b>рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдПрдбрд╡рд╛рдВрдЯреЗрдЬ</b> рдПрд╕реНрдЯреАрдореЗрд╢рди (рдЬреАрдПрдИ) рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реНрдХреЛрд░ред </p><br><p>  рдХрдЯ рдХреЗ рддрд╣рдд, рдЧрдгрд┐рдд, рдПрдХ TensorFlow рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди, рдФрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдбреЗрдореЛ рдиреАрдЪреЗ рдЖрдПред </p><br><a name="habracut"></a><p>  рд╕рд╛рдордЧреНрд░реА: </p><br>  - <a href="https://habr.com/ru/post/483078/">рдЪреБрдиреМрддреА</a> <br>  - <a href="https://habr.com/ru/post/483078/">рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдирд╛ рдХреНрдпреЛрдВ?</a> <br>  - <a href="https://habr.com/ru/post/483078/">рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдиреЗ рдХрд╛ рд╡рд┐рд╡рд░рдг</a> <br>  - <a href="https://habr.com/ru/post/483078/">рдиреАрддрд┐ рдврд╛рд▓</a> <br>  - <a href="https://habr.com/ru/post/483078/">рд╡рд┐рдХрд░реНрдг рдЧреМрд╕рд┐рдпрди рдиреАрддрд┐рдпрд╛рдБ</a> <br>  - <a href="https://habr.com/ru/post/483078/">рдЖрд▓реЛрдЪрдирд╛ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рд╡рд┐рдЪрд░рдг рдХреЛ рдХрдо рдХрд░реЗрдВ</a> <br>  - <a href="https://habr.com/ru/post/483078/">рдиреБрдХрд╕рд╛рди</a> <br><p>  - <a href="https://habr.com/ru/post/483078/">рдирд┐рд╖реНрдХрд░реНрд╖</a> </p><br><a name="problem"></a><h2>  рдХрд╛рд░реНрдп </h2><br><p>  рдЗрд╕ рд▓реЗрдЦ рдореЗрдВ, рд╣рдо рд░реЛрдмреЛрдЯ рдХреЛ рдореНрдпреВрдЬреЛрдХреЛ рд╕рд┐рдореБрд▓реЗрд╢рди рдореЗрдВ рдЪрд▓рдирд╛ рд╕рд┐рдЦрд╛рдПрдВрдЧреЗред  рд╣рдо рд░реЛрдмреЛрдЯ рдореЙрдбрд▓ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдФрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреЗ рд▓рд┐рдП рдкрд╛рдпрдерди рдЗрдВрдЯрд░рдлреЗрд╕ рдХреЗ рд╕рд╛рде рдХрджрдо рдХрд╛ рд╡рд░реНрдгрди рдЫреЛрдбрд╝ рджреЗрдВрдЧреЗ, рдХреНрдпреЛрдВрдХрд┐  рд╡рд╣рд╛рдБ рдХреБрдЫ рднреА рджрд┐рд▓рдЪрд╕реНрдк рдирд╣реАрдВ рд╣реИред  рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рдХреЗрд╡рд▓ рдореНрдпреВрдЬрд┐рдХреЛ рдореЗрдВ рдбреЗрдореЛ рдФрд░ <a href="https://gym.openai.com/envs/">рдЬрд┐рдо рдУрдкрдирдПрдЖрдИ</a> рдореЗрдВ рдореНрдпреВрдЬрд┐рдХреЛ рдХреЗ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рд╕реНрд░реЛрддреЛрдВ рдХреЛ <a href="https://gym.openai.com/envs/">рджреЗрдЦреЗрдВ</a> ред </p><br><p>  рдЗрдирдкреБрдЯ рдкрд░, рдПрдЬреЗрдВрдЯ рдХреЗ рдкрд╛рд╕ рдореНрдпреВрдЬреЛрдХреЛ рд╕реЗ рдХрдИ рдирдВрдмрд░ рд╣реЛрдВрдЧреЗ: рд░рд┐рд╢реНрддреЗрджрд╛рд░ рд╕реНрдерд┐рддрд┐, рд░реЛрдЯреЗрд╢рди рдХреЗ рдХреЛрдг, рдЧрддрд┐, рд░реЛрдмреЛрдЯ рдХреЗ рд╢рд░реАрд░ рдХреЗ рдХреБрдЫ рд╣рд┐рд╕реНрд╕реЛрдВ рдХрд╛ рддреНрд╡рд░рдг, рдЖрджрд┐ред  рдХреБрд▓ рдореЗрдВ, ~ 800 рд╕реБрд╡рд┐рдзрд╛рдУрдВ рдХрд╛ рдХреНрд░рдоред  рд╣рдо рдбреАрдк рд▓рд░реНрдирд┐рдВрдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рд╕рдордЭ рдирд╣реАрдВ рдкрд╛рдПрдВрдЧреЗ рдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЙрдирдХрд╛ рдХреНрдпрд╛ рдорддрд▓рдм рд╣реИред  рдореБрдЦреНрдп рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕реЗрдЯ рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрдЧреА рддрд╛рдХрд┐ рдПрдЬреЗрдВрдЯ рд╕рдордЭ рд╕рдХреЗ рдХрд┐ рдЙрд╕рдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИред </p><br><p>  рдЖрдЙрдЯрдкреБрдЯ рдкрд░ рд╣рдо 18 рдирдВрдмрд░реЛрдВ рдХреА рдЙрдореНрдореАрдж рдХрд░реЗрдВрдЧреЗ - рд░реЛрдмреЛрдЯ рдХреА рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рдХреА рдбрд┐рдЧреНрд░реА рдХреА рд╕рдВрдЦреНрдпрд╛, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдЯрд┐рдХрд╛ рдХрд╛ рд░реЛрдЯреЗрд╢рди рдХреЛрдг рдЬрд┐рд╕ рдкрд░ рдЕрдВрдЧ рддрдп рд╣реЛ рдЧрдП рд╣реИрдВред </p><br><p>  рдЕрдВрдд рдореЗрдВ, рдПрдЬреЗрдВрдЯ рдХрд╛ рд▓рдХреНрд╖реНрдп рдПрдкрд┐рд╕реЛрдб рдХреЗ рд▓рд┐рдП рдХреБрд▓ <b>рдЗрдирд╛рдо</b> рдХреЛ рдЕрдзрд┐рдХрддрдо рдХрд░рдирд╛ рд╣реИред  рдпрджрд┐ рд░реЛрдмреЛрдЯ рдХреНрд░реИрд╢ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдпрд╛ 3000 рдХрджрдо (15 рд╕реЗрдХрдВрдб) рдмреАрдд рдЪреБрдХреЗ рд╣реИрдВ рддреЛ рд╣рдо рдПрдкрд┐рд╕реЛрдб рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░ рджреЗрдВрдЧреЗред  рдкреНрд░рддреНрдпреЗрдХ рдЪрд░рдг рдирд┐рдореНрди рд╕реВрддреНрд░ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдПрдЬреЗрдВрдЯ рдХреЛ рдкреБрд░рд╕реНрдХреГрдд рдХрд░реЗрдЧрд╛: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдИ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбрдмреНрд▓реНрдпреВ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рд╕реА </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдУ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореАрдЯрд░ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдореАрдЯрд░ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрди </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдбреА </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mrow" id="MJXp-Span-13"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;">рдИ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18"><font style="vertical-align: inherit;">рдПрдо </font></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;">рдПрдХ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;">рдЯреА </font></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;">рдПрдЪ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;">рдУ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;">рдкреА </font></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;">рдПрдо </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27"><font style="vertical-align: inherit;">рдПрдХ </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;">рдЯреА </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;">рдПрдЪ </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;">рдмреА </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;">рдмреА </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mrow" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33"><font style="vertical-align: inherit;">рдИ</font></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35"><font style="vertical-align: inherit;"> рдПрди </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;">рдИ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;">рдбрдмреНрд▓реНрдпреВ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;">рд╕реА </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;">рдУ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;">рдореАрдЯрд░ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;">рдореАрдЯрд░ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;">рдПрдХ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;">рдПрди </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;">рдбреА </font></span><span class="MJXp-mrow" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;">рдЖрд░ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;">рдПрдо </font></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;">рдПрдХ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;">рдЯреА </font></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;">рдПрдЪ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;">рдУ </font></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;">рдкреА </font></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58"><font style="vertical-align: inherit;">рдПрдо </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;">рдПрдХ </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;">рдЯреА </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;">рдПрдЪ </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;">рдмреА </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;">рдмреА </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mrow" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65"><font style="vertical-align: inherit;">рдЖрд░</font></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"> рдЖрд░ </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-68" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">рдЯреА</font></span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"> = </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71"><font style="vertical-align: inherit;">рдбреА </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72"><font style="vertical-align: inherit;">рдИ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;">рдПрд▓ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74"><font style="vertical-align: inherit;">рдЯреА </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;">рдПрдХ </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76"><font style="vertical-align: inherit;">рдПрдХреНрд╕ </font></span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">* </font></span><span class="MJXp-mn" id="MJXp-Span-78"><font style="vertical-align: inherit;">1000 </font></span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">+ </font></span><span class="MJXp-mn" id="MJXp-Span-80"><font style="vertical-align: inherit;">0.5</font></span></font><span class="MJXp-mrow" id="MJXp-Span-13"><span class="MJXp-mtext" id="MJXp-Span-14">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mtext" id="MJXp-Span-17">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-24"><span class="MJXp-mtext" id="MJXp-Span-25">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-27"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33"><font style="vertical-align: inherit;"></font></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-34">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-45"><span class="MJXp-mtext" id="MJXp-Span-46">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mrow" id="MJXp-Span-48"><span class="MJXp-mtext" id="MJXp-Span-49">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-56"><span class="MJXp-mtext" id="MJXp-Span-57">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65"><font style="vertical-align: inherit;"></font></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-68" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-69" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-70">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-78"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-79" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-80"><font style="vertical-align: inherit;"></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="95.81ex" height="2.419ex" viewBox="0 -780.1 41251.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6E" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-65" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-77" x="1317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-63" x="2033" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6F" x="2467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6D" x="2952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6D" x="3831" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="4709" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6E" x="5239" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-64" x="5839" y="0"></use><g transform="translate(6363,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-45" x="250" y="0"></use></g><g transform="translate(7377,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6F" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-70" x="3081" y="0"></use><g transform="translate(3585,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-45" x="3455" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6E" x="15432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-65" x="16032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-77" x="16499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-63" x="17215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6F" x="17649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6D" x="18134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6D" x="19013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="19891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6E" x="20421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-64" x="21021" y="0"></use><g transform="translate(21545,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-52" x="250" y="0"></use></g><g transform="translate(22554,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6F" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-70" x="3081" y="0"></use><g transform="translate(3585,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-52" x="3455" y="0"></use></g></g><g transform="translate(30354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-3D" x="31438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-44" x="32745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-65" x="33573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6C" x="34040" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="34338" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="34700" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-78" x="35229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2217" x="36024" y="0"></use><g transform="translate(36747,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-30" x="1501" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2B" x="38971" y="0"></use><g transform="translate(39972,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-35" x="779" y="0"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ newcommand {\ E} {\ mathop {\ mathbb {E}}} \ newcommand {\ R} {\ mathop {\ mathbb {R}}} r_t = \ Delta x * 1000 + 0.5 </script></p><p>  рдпрд╛рдиреА  рдПрдЬреЗрдВрдЯ рдХрд╛ рд▓рдХреНрд╖реНрдп рдЙрд╕рдХреЗ рд╕рдордиреНрд╡рдп рдХреЛ рдмрдврд╝рд╛рдПрдЧрд╛ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">рдПрдХреНрд╕</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> x </script>  рдФрд░ рдкреНрд░рдХрд░рдг рдХреЗ рдЕрдВрдд рддрдХ рдЧрд┐рд░ рдирд╣реАрдВ рд╣реИред </p><br><p>  рддреЛ, рдХрд╛рд░реНрдп рд╕реЗрдЯ рд╣реИ: <b>рдлрд╝рдВрдХреНрд╢рди</b> рдХреЛ <b>рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП</b> <math> </math><b><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mtext" id="MJXp-Span-84">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">i</span><span class="MJXp-mo" id="MJXp-Span-87" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-88">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-91" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-92">800</span></span></span><span class="MJXp-mtext" id="MJXp-Span-93">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">o</span><span class="MJXp-mtext" id="MJXp-Span-96">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-99" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-100">18</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.301ex" height="2.78ex" viewBox="0 -935.7 7018.6 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-70" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-69" x="753" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-3A" x="1376" y="0"></use><g transform="translate(2183,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-38"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-30" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-30" x="1001" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="4354" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6F" x="4715" y="0"></use><g transform="translate(5451,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,362)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-38" x="500" y="0"></use></g></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ pi: \ R ^ {800} \ to \ R ^ {18} </script></b>   <b>рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдПрдкрд┐рд╕реЛрдб рдХреЗ рд▓рд┐рдП рдЗрдирд╛рдо рд╕рдмрд╕реЗ рдмрдбрд╝рд╛ рд╣реЛрдЧрд╛</b> ред  рдпрд╣ рдмрд╣реБрдд рд╕рд╣реА рдирд╣реАрдВ рд╣реИ?  :) рдЖрдЗрдП рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ <b>рджреАрдк рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдирд╛</b> рдЗрд╕ рдХрд╛рд░реНрдп рдХреЛ рдХреИрд╕реЗ <b>рд╕рдВрднрд╛рд▓рддрд╛ рд╣реИ</b> ред </p><br><a name="why-rl"></a><h2>  рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдирд╛ рдХреНрдпреЛрдВ? </h2><br><p>  рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рд░реЛрдмреЛрдЯреЛрдВ рдХреА рдЧрддрд┐ рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдзреБрдирд┐рдХ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╢рд╛рд╕реНрддреНрд░реАрдп рд░реЛрдмреЛрдЯрд┐рдХреНрд╕ рдкреНрд░рдерд╛рдУрдВ рд╕реЗ рдорд┐рд▓рдХрд░ рдмрдирддрд╛ рд╣реИ рдЬреЛ <b>рдЗрд╖реНрдЯрддрдо рдирд┐рдпрдВрддреНрд░рдг</b> рдФрд░ <b>рдкреНрд░рдХреНрд╖реЗрдкрд╡рдХреНрд░ рдЕрдиреБрдХреВрд▓рди</b> : LQR, QP, рдЙрддреНрддрд▓ рдЕрдиреБрдХреВрд▓рди рд╣реИред  рдФрд░ рдкрдврд╝реЗрдВ: <a href="https://dspace.mit.edu/handle/1721.1/110533">рдПрдЯрд▓рд╕ рдкрд░ рдмреЛрд╕реНрдЯрди рдбрд╛рдпрдиреЗрдорд┐рдХреНрд╕ рдЯреАрдо рдкреЛрд╕реНрдЯ</a> </p><br><p>  рдпреЗ рддрдХрдиреАрдХ рдПрдХ рддрд░рд╣ рдХреА "рд╣рд╛рд░реНрдбрдХреЛрдбрд┐рдВрдЧ" рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдЙрдиреНрд╣реЗрдВ рдирд┐рдпрдВрддреНрд░рдг рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдореЗрдВ рд╕реАрдзреЗ рдХрд╛рд░реНрдп рдХреЗ рдХрдИ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреА рд╢реБрд░реВрдЖрдд рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рдЙрдирдореЗрдВ рдХреЛрдИ рд╕реАрдЦрдиреЗ рдХреА рдкреНрд░рдгрд╛рд▓реА рдирд╣реАрдВ рд╣реИ - рдЕрдиреБрдХреВрд▓рди "рдореМрдХреЗ рдкрд░" рд╣реЛрддрд╛ рд╣реИред </p><br><p>  рджреВрд╕рд░реА рдУрд░, рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдирд╛ (рдЗрд╕рдХреЗ рдмрд╛рдж рдЖрд░рдПрд▓) рдХреЛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдореЗрдВ рдкрд░рд┐рдХрд▓реНрдкрдирд╛рдУрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рд╕реЗ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рд╕рдорд╛рдзрд╛рди рдЕрдзрд┐рдХ рд╕рд╛рдорд╛рдиреНрдп рдФрд░ рдорд╛рдкрдиреАрдп рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред </p><br><a name="rl-formulation"></a><h2>  рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдиреЗ рдХрд╛ рд╡рд┐рд╡рд░рдг </h2><br><img src="https://habrastorage.org/webt/i8/gl/yf/i8glyfujascwmexl2qu6sypmpt0.png"><br><p>  <a href="https://simple.wikipedia.org/wiki/Reinforcement_learning"><i>рд╕реНрд░реЛрдд</i></a> </p><br><p>  рдЖрд░рдПрд▓ рд╕рдорд╕реНрдпрд╛ рдореЗрдВ, рд╣рдо рдПрдЬреЗрдВрдЯ рдФрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдХреА рдмрд╛рддрдЪреАрдд рдХреЛ рдЬреЛрдбрд╝реЗ рдХреЗ рдПрдХ рдЕрдиреБрдХреНрд░рдо <b>(рд░рд╛рдЬреНрдп, рдЗрдирд╛рдо)</b> рдФрд░ рдЙрдирдХреЗ рдмреАрдЪ рдХреЗ рдмрджрд▓рд╛рд╡реЛрдВ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдирддреЗ рд╣реИрдВ - <b>рдХрд╛рд░реНрд░рд╡рд╛рдИ</b> ред </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-101"><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-107">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-109">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">w</span><span class="MJXp-mrow" id="MJXp-Span-119"><span class="MJXp-msubsup" id="MJXp-Span-120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;">0</span></span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-126" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-127" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-130" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-132">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">w</span><span class="MJXp-mrow" id="MJXp-Span-144"><span class="MJXp-msubsup" id="MJXp-Span-145"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-147" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-148">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-151" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mtext" id="MJXp-Span-152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">w</span><span class="MJXp-mrow" id="MJXp-Span-164"><span class="MJXp-msubsup" id="MJXp-Span-165"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-167" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">n</span><span class="MJXp-mo" id="MJXp-Span-169">тИТ</span><span class="MJXp-mn" id="MJXp-Span-170">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-171" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-174" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">n</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="70.384ex" height="2.66ex" viewBox="0 -832 30304 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-28" x="0" y="0"></use><g transform="translate(389,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-30" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-29" x="1312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-78" x="1952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="2524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-69" x="2976" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-67" x="3321" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-68" x="3802" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="4378" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="4740" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="5269" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="5721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6F" x="6172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-77" x="6658" y="0"></use><g transform="translate(7374,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-30" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-28" x="8358" y="0"></use><g transform="translate(8747,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-31" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2C" x="9671" y="0"></use><g transform="translate(10116,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-31" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-29" x="11021" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-78" x="11661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="12233" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-69" x="12685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-67" x="13030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-68" x="13511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="14087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="14449" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="14978" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="15430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6F" x="15881" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-77" x="16367" y="0"></use><g transform="translate(17083,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-31" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2E" x="18067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2E" x="18512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2E" x="18957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-78" x="19652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="20225" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-69" x="20676" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-67" x="21022" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-68" x="21502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-74" x="22079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="22440" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="22970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="23421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6F" x="23873" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-77" x="24358" y="0"></use><g transform="translate(25075,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-31" x="1379" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-28" x="27033" y="0"></use><g transform="translate(27423,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6E" x="663" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-2C" x="28417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-72" x="28862" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMATHI-6E" x="29313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=https://habr.com/ru/post/483078/&amp;xid=17259,15700022,15700043,15700186,15700190,15700259,15700271,15700302&amp;usg=ALkJrhhZht70pnL-CoADBgW8a2KHTKtCqw#MJMAIN-29" x="29914" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> (s_0) \ xrightarrow {a_0} (s_1, r_1) \ xrightarrow {a_ {1}} ... \ xrightarrow {a_ {n-1}} (s_n, rn) </script></p><p>  рд╢рдмреНрджрд╛рд╡рд▓реА рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ: </p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-179"><span class="MJXp-mtext" id="MJXp-Span-180">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">i</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-186" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-187"><span class="MJXp-mo" id="MJXp-Span-188" style="margin-left: 0.278em; margin-right: 0.278em;">ред</span></span><span class="MJXp-msubsup" id="MJXp-Span-189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-191" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-192" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> \ pi (a_tред s_t) </script>  - <b>рдиреАрддрд┐</b> , рдПрдЬреЗрдВрдЯ рд╡реНрдпрд╡рд╣рд╛рд░ рд░рдгрдиреАрддрд┐, рд╕рд╢рд░реНрдд рд╕рдВрднрд╛рд╡реНрдпрддрд╛, </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-193"><span class="MJXp-msubsup" id="MJXp-Span-194"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-196" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mtext" id="MJXp-Span-197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">m</span><span class="MJXp-mtext" id="MJXp-Span-201">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">i</span><span class="MJXp-mo" id="MJXp-Span-204" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-205">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">t</span><span class="MJXp-mrow" id="MJXp-Span-210"><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-214" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> a_t \ sim \ pi (\ cdot | s_t) </script>  - рд╡рд┐рддрд░рдг рд╕реЗ <b>рдХрд╛рд░реНрд░рд╡рд╛рдИ</b> рдХреЛ рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЪрд░ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-216"><span class="MJXp-mtext" id="MJXp-Span-217">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ pi </script>  ред <br>  <i>рд╣рдо рдиреАрддрд┐ рдХреЛ рдПрдХ рдХрд╛рд░реНрдп рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВ</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-220"><span class="MJXp-mtext" id="MJXp-Span-221">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">i</span><span class="MJXp-mo" id="MJXp-Span-224" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mrow" id="MJXp-Span-225"><span class="MJXp-mo" id="MJXp-Span-226" style="margin-left: 0.278em; margin-right: 0.278em;">рд╕</span></span><span class="MJXp-mrow" id="MJXp-Span-227"><span class="MJXp-mo" id="MJXp-Span-228" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-229"><span class="MJXp-mo" id="MJXp-Span-230" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-231"><span class="MJXp-mo" id="MJXp-Span-232" style="margin-left: 0.278em; margin-right: 0.278em;">реЗ</span></span><span class="MJXp-mrow" id="MJXp-Span-233"><span class="MJXp-mo" id="MJXp-Span-234" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-235"><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-237"><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0.278em; margin-right: 0.278em;">рд╕</span></span><span class="MJXp-mrow" id="MJXp-Span-239"><span class="MJXp-mo" id="MJXp-Span-240" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-241"><span class="MJXp-mo" id="MJXp-Span-242" style="margin-left: 0.278em; margin-right: 0.278em;">реВ</span></span><span class="MJXp-mrow" id="MJXp-Span-243"><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0.278em; margin-right: 0.278em;">рдП</span></span><span class="MJXp-mrow" id="MJXp-Span-245"><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0.278em; margin-right: 0.278em;">рдХ</span></span><span class="MJXp-mrow" id="MJXp-Span-247"><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-249"><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-251"><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-253"><span class="MJXp-mo" id="MJXp-Span-254" style="margin-left: 0.278em; margin-right: 0.278em;">рд╕</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> \ pi: рд╕реНрдЯреЗрдЯреНрд╕ рдЯреВ рдПрдХреНрдЯреНрд╕ </script></i>   <i>, рд▓реЗрдХрд┐рди рд╣рдо рдПрдЬреЗрдВрдЯ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╕реНрдЯреЛрдЪрд╕реНрдЯрд┐рдХ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рдЬреЛ <b>рдЕрдиреНрд╡реЗрд╖рдг рдХреА</b> рд╕реБрд╡рд┐рдзрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ <b>рд╣реИ</b> ред</i>  <i>рдпрд╛рдиреА</i>  <i>рдХреБрдЫ рд╕рдВрднрд╛рд╡рдирд╛ рдХреЗ рд╕рд╛рде рд╣рдо рдЙрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдПрдЬреЗрдВрдЯ рдЪреБрдирддрд╛ рд╣реИред</i> </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-255"><span class="MJXp-msubsup" id="MJXp-Span-256"><span class="MJXp-mtext" id="MJXp-Span-257" style="margin-right: 0.05em;">&nbsp;</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-258" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-259">рдд</span></span></span><span class="MJXp-mrow" id="MJXp-Span-260"><span class="MJXp-mo" id="MJXp-Span-261" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mrow" id="MJXp-Span-262"><span class="MJXp-mo" id="MJXp-Span-263" style="margin-left: 0.278em; margin-right: 0.278em;">рдК</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> \ _ рддрд╛рдК </script>  - рдПрдЬреЗрдВрдЯ, рдЕрдиреБрдХреНрд░рдо рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдХреНрд╖реЗрдкрд╡рдХреНрд░ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдпрд╛ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-264"><span class="MJXp-mo" id="MJXp-Span-265" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-266"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-268" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-269" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-270"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-272" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-273" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-274" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-275" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-276" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-277" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-279" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-280" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-281" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> (s_1, s_2, ..., s_n) </script>  ред </li></ul><br><p>  рдПрдЬреЗрдВрдЯ рдХрд╛ рдХрд╛рд░реНрдп <b>рдЕрдкреЗрдХреНрд╖рд┐рдд рд░рд┐рдЯрд░реНрди</b> рдХреЛ рдЕрдзрд┐рдХрддрдо рдХрд░рдирд╛ <b>рд╣реИ</b> : </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-282"><span class="noError" id="MJXp-Span-283" style="display: inline-block;">J&nbsp;(\&nbsp;pi)&nbsp;=&nbsp;\&nbsp;E&nbsp;_&nbsp;{\&nbsp;_&nbsp;tau&nbsp;\&nbsp;sim&nbsp;\&nbsp;pi}&nbsp;[R&nbsp;(\&nbsp;tau)]&nbsp;=&nbsp;\&nbsp;E&nbsp;_&nbsp;{\&nbsp;_&nbsp;tau&nbsp;\&nbsp;sim&nbsp;\&nbsp;pi}&nbsp;\&nbsp;рдмрд╛рдПрдБ&nbsp;[\&nbsp;sum_&nbsp;{t&nbsp;=&nbsp;0}&nbsp;^&nbsp;n_t&nbsp;\&nbsp;right&nbsp;]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> J (\ pi) = \ E _ {\ _ tau \ sim \ pi} [R (\ tau)] = \ E _ {\ _ tau \ sim \ pi} \ рдмрд╛рдПрдБ [\ sum_ {t = 0} ^ n_t \ right ] </script></p><p>  рдЕрдм рд╣рдо RL рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЦреЛрдЬреЗрдВ: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-284"><span class="MJXp-mtext" id="MJXp-Span-285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">p</span><span class="MJXp-msubsup" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-289" style="vertical-align: 0.5em;">тИЧ</span></span><span class="MJXp-mo" id="MJXp-Span-290" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">g</span><span class="MJXp-mtext" id="MJXp-Span-294">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">p</span><span class="MJXp-msubsup" id="MJXp-Span-301"><span class="MJXp-mrow" id="MJXp-Span-302" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">x</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-306" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">J</span><span class="MJXp-mo" id="MJXp-Span-310" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">i</span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> \ pi ^ * = arg \ mathop {max} _ \ pi J (\ pi) </script></p><p>  рдЬрд╣рд╛рдБ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-315"><span class="MJXp-mtext" id="MJXp-Span-316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">p</span><span class="MJXp-msubsup" id="MJXp-Span-318"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-320" style="vertical-align: 0.5em;">тИЧ</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ pi ^ * </script>  рдЗрд╖реНрдЯрддрдо рдиреАрддрд┐ рд╣реИред </p><br><p>  OpenAI рд╕реЗ рд╕рд╛рдордЧреНрд░реА рдореЗрдВ рдФрд░ рдкрдврд╝реЗрдВ: <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro.html">OpenAI Spinning Up</a> </p><br><a name="policy-gradient"></a><h2>  рдиреАрддрд┐ рдврд╛рд▓ </h2><br><p>  рдпрд╣ рдЙрд▓реНрд▓реЗрдЦрдиреАрдп рд╣реИ рдХрд┐ рдЕрдиреБрдХреВрд▓рди рд╕рдорд╕реНрдпрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдЖрд░рдПрд▓ рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдПрдХ рдХрдареЛрд░ рдмрдпрд╛рди рд╣рдореЗрдВ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЬреНрдЮрд╛рдд рдЕрдиреБрдХреВрд▓рди рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рджреЗрддрд╛ рд╣реИред  рдЬрд░рд╛ рдХрд▓реНрдкрдирд╛ рдХрд░реЗрдВ рдХрд┐ рдпрджрд┐ рд╣рдо <b>рдореЙрдбрд▓ рдорд╛рдкрджрдВрдбреЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрдкреЗрдХреНрд╖рд┐рдд рд░рд┐рдЯрд░реНрди рдЧреНрд░реЗрдбрд┐рдПрдВрдЯ рд▓реЗ</b> рд╕рдХрддреЗ <b>рд╣реИрдВ</b> рддреЛ рдпрд╣ рдХрд┐рддрдирд╛ рдЕрдЪреНрдЫрд╛ рд╣реЛрдЧрд╛: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-321"><span class="MJXp-mtext" id="MJXp-Span-322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-323">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">l</span><span class="MJXp-msubsup" id="MJXp-Span-327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-329" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">J</span><span class="MJXp-mo" id="MJXp-Span-336" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-337">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">p</span><span class="MJXp-msubsup" id="MJXp-Span-339"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-341" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">a</span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> \ nabla_ \ theta J (\ pi_ \ theta) </script>  ред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рддрд░рд╛рдЬреВ рдХреЛ рдЕрджреНрдпрддрди рдХрд░рдиреЗ рдХрд╛ рдирд┐рдпрдо рд╕рд░рд▓ рд╣реЛрдЧрд╛: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-348"><span class="MJXp-mtext" id="MJXp-Span-349">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-354">a</span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-356">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-359">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">t</span><span class="MJXp-msubsup" id="MJXp-Span-361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-363" style="vertical-align: -0.4em;"><span class="MJXp-mrow" id="MJXp-Span-364"><span class="MJXp-mo" id="MJXp-Span-365">рдк</span></span><span class="MJXp-mrow" id="MJXp-Span-366"><span class="MJXp-mo" id="MJXp-Span-367">реБ</span></span><span class="MJXp-mrow" id="MJXp-Span-368"><span class="MJXp-mo" id="MJXp-Span-369">рд░</span></span><span class="MJXp-mrow" id="MJXp-Span-370"><span class="MJXp-mo" id="MJXp-Span-371">рд╛</span></span><span class="MJXp-mrow" id="MJXp-Span-372"><span class="MJXp-mo" id="MJXp-Span-373">рди</span></span><span class="MJXp-mrow" id="MJXp-Span-374"><span class="MJXp-mo" id="MJXp-Span-375">рд╛</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-376" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-377">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">a</span><span class="MJXp-mtext" id="MJXp-Span-383">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">l</span><span class="MJXp-msubsup" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-390" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">J</span><span class="MJXp-mo" id="MJXp-Span-397" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-398">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">p</span><span class="MJXp-msubsup" id="MJXp-Span-400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-402" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">a</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-15"> \ theta = \ theta_ {рдкреБрд░рд╛рдирд╛} + \ Alpha \ nabla_ \ theta J (\ pi_ \ theta) </script></p><p>  рдпрд╣ рд╕рднреА <b>рдиреАрддрд┐рдЧрдд рдврд╛рд▓</b> рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдареАрдХ-рдареАрдХ рд╡рд┐рдЪрд╛рд░ рд╣реИред  рдЗрд╕ рдврд╛рд▓ рдХрд╛ рд╕рдЦреНрдд рдирд┐рд╖реНрдХрд░реНрд╖ рдХреБрдЫ рд╣рдж рддрдХ рдХрдЯреНрдЯрд░ рд╣реИред  рд╣рдо рдЗрд╕реЗ рдпрд╣рд╛рдВ рдирд╣реАрдВ рд▓рд┐рдЦреЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">OpenAI рд╕реЗ рдЕрджреНрднреБрдд рд╕рд╛рдордЧреНрд░реА рдХреЗ</a> рд▓рд┐рдП рдПрдХ рд▓рд┐рдВрдХ рдЫреЛрдбрд╝ <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">рджреЗрдВрдЧреЗ</a> ред  рдврд╛рд▓ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-409"><span class="noError" id="MJXp-Span-410" style="display: inline-block;">\&nbsp;nabla_&nbsp;\&nbsp;theta&nbsp;J&nbsp;(\&nbsp;pi_&nbsp;\&nbsp;theta)&nbsp;=&nbsp;\&nbsp;E&nbsp;_&nbsp;{\&nbsp;_&nbsp;tau&nbsp;\&nbsp;sim&nbsp;\&nbsp;pi_&nbsp;\&nbsp;theta}&nbsp;\&nbsp;left&nbsp;[\&nbsp;sum_&nbsp;{t&nbsp;=&nbsp;0}&nbsp;^&nbsp;T&nbsp;\&nbsp;nabla_&nbsp;\&nbsp;theta&nbsp;\&nbsp;log&nbsp;\&nbsp;pi_&nbsp;\&nbsp;theta&nbsp;(a_t_)&nbsp;|&nbsp;s_t)&nbsp;R&nbsp;(\&nbsp;tau)&nbsp;\&nbsp;right]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ _ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t_) | s_t) R (\ tau) \ right] </script></p><p>  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдорд╛рд░реЗ рдореЙрдбрд▓ рдХрд╛ <b>рдиреБрдХрд╕рд╛рди</b> рдЗрд╕ рддрд░рд╣ рд╣реЛрдЧрд╛: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-411"><span class="MJXp-mrow" id="MJXp-Span-412"><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0.278em; margin-right: 0.278em;">рд╣</span></span><span class="MJXp-mrow" id="MJXp-Span-414"><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mrow" id="MJXp-Span-416"><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0.278em; margin-right: 0.278em;">рди</span></span><span class="MJXp-mrow" id="MJXp-Span-418"><span class="MJXp-mo" id="MJXp-Span-419" style="margin-left: 0.278em; margin-right: 0.278em;">рд┐</span></span><span class="MJXp-mo" id="MJXp-Span-420" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-421" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-mtext" id="MJXp-Span-422">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425">g</span><span class="MJXp-mo" id="MJXp-Span-426" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-427">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">p</span><span class="MJXp-msubsup" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-431" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-435">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">a</span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-440" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-441"><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-443"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-445" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-446" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">R</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-450">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">u</span><span class="MJXp-mo" id="MJXp-Span-454" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-17"> рд╣рд╛рдирд┐ = - \ log (\ pi_ \ theta (a_t | s_t)) R (\ tou) </script></p><p>  рдЙрд╕рдХреЛ рдпрд╛рдж рдХрд░реЛ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456">R</span><span class="MJXp-mo" id="MJXp-Span-457" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-458">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">u</span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-463" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-464">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">u</span><span class="MJXp-msubsup" id="MJXp-Span-467"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">t</span><span class="MJXp-mo" id="MJXp-Span-471">=</span><span class="MJXp-mn" id="MJXp-Span-472">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-474"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-476" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> R (\ tau) = \ sum_ {t = 0} ^ T r_t </script>  , рдФрд░ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-477"><span class="MJXp-mtext" id="MJXp-Span-478">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">p</span><span class="MJXp-msubsup" id="MJXp-Span-480"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-481" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-482" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">a</span><span class="MJXp-mo" id="MJXp-Span-488" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-491" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-492"><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-494"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-496" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-497" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ pi_ \ theta (a_t | s_t) </script>  - рдпрд╣ рдЙрд╕ рд╕рдордп рд╣рдорд╛рд░реЗ рдореЙрдбрд▓ рдХрд╛ рдЖрдЙрдЯрдкреБрдЯ рд╣реИ рдЬрдм рд╡рд╣ рдЕрдВрджрд░ рдереА <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-498"><span class="MJXp-msubsup" id="MJXp-Span-499"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-501" style="vertical-align: -0.4em;">t</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> s_t </script>  ред  рдЗрд╕ рддрдереНрдп рдХреЗ рдХрд╛рд░рдг рдорд╛рдЗрдирд╕ рджрд┐рдЦрд╛рдИ рджрд┐рдпрд╛ рдХрд┐ рд╣рдо рдЕрдзрд┐рдХрддрдо рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-502"><span class="MJXp-mrow" id="MJXp-Span-503"><span class="MJXp-mo" id="MJXp-Span-504" style="margin-left: 0.278em; margin-right: 0.278em;">рдЬ</span></span><span class="MJXp-mrow" id="MJXp-Span-505"><span class="MJXp-mo" id="MJXp-Span-506" style="margin-left: 0.278em; margin-right: 0.278em;">реЗ</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> рдЬреЗ </script>  ред  рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди, рд╣рдо рдмреИрдЪреЛрдВ рдкрд░ рдЧреНрд░реЗрдбрд┐рдПрдВрдЯ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЙрдиреНрд╣реЗрдВ <b>рд╡рд┐рдЪрд░рдг</b> рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬреЛрдбрд╝реЗрдВрдЧреЗ (рд╕реНрдЯреЛрдХреЗрд╕реНрдЯрд┐рдХ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рдХрд╛рд░рдг рдбреЗрдЯрд╛ рд╢реЛрд░)ред </p><br><p>  рдпрд╣ рдПрдХ рдХрд╛рд░реНрдпрд╢реАрд▓ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рд╣реИ рдЬрд┐рд╕реЗ <b>REINFORCE</b> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдФрд░ рд╡рд╣ рдЬрд╛рдирддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рд╕рд░рд▓ рд╡рд╛рддрд╛рд╡рд░рдг рдХреЗ рд▓рд┐рдП рд╕рдорд╛рдзрд╛рди рдХреИрд╕реЗ рдЦреЛрдЬрдирд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <a href="https://gym.openai.com/envs/CartPole-v1/">"рдХрд╛рд░реНрдЯрдкреЛрд▓-рд╡реА 2"</a> ред </p><br><p>  рдПрдЬреЗрдВрдЯ рдХреЛрдб рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ: </p><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActorNetworkDiscrete</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">20</span></span>, activation=tf.nn.relu) output_linear = tf.layers.dense(l1, units=action_space) output = tf.nn.softmax(output_linear) self.action_op = tf.squeeze(tf.multinomial(logits=output_linear,num_samples=<span class="hljs-number"><span class="hljs-number">1</span></span>), axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Training output_log = tf.nn.log_softmax(output_linear) self.weight_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.action_ph = tf.placeholder(shape=[None], dtype=tf.int32) action_one_hot = tf.one_hot(self.action_ph, action_space) responsible_output_log = tf.reduce_sum(output_log * action_one_hot, axis=1) self.loss = -tf.reduce_mean(responsible_output_log * self.weight_ph) optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate) self.update_op = optimizer.minimize(self.loss) actor = ActorNetworkDiscrete()</span></span></code> </pre> <br><p>  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдЗрд╕ рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдХрд╛ рдПрдХ рдЫреЛрдЯрд╛ рдмреЛрдзрдХ рд╣реИ: (рдЕрд╡рд▓реЛрдХрди_рдХреНрд╖реЗрддреНрд░, 10, рдХреНрд░рд┐рдпрд╛_рдХреНрд╖реЗрддреНрд░) [рдХрд╛рд░реНрдЯрдкреЛрд▓ рдХреЗ рд▓рд┐рдП рдпрд╣ рд╣реИ (4, 10, 2)]ред  <b>tf.multinomial рдЖрдк</b> рдмреЗрддрд░рддреАрдм рдврдВрдЧ рд╕реЗ рднрд╛рд░рд┐рдд рдПрдХ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдПрдХ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs">action = sess.run(actor.action_op, feed_dict={actor.state_ph: observation})</code> </pre><br><p>  рдФрд░ рдЗрд╕рд▓рд┐рдП рд╣рдо рдЙрд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдХрд░реЗрдВрдЧреЗ: </p><br><pre> <code class="python hljs">batch_generator = generate_batch(environments, batch_size=batch_size) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm_notebook(range(epochs_number)): batch = next(batch_generator) <span class="hljs-comment"><span class="hljs-comment"># Remainder: batch item consists of [state, action, total reward] # Train actor _, actor_loss = sess.run([actor.update_op, actor.loss], feed_dict={actor.state_ph: batch[:, 0], actor.action_ph: batch[:, 1], actor.weight_ph: batch[:, 2]})</span></span></code> </pre><br><p>  рдмреИрдЪ рдЬрдирд░реЗрдЯрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдореЗрдВ рдПрдЬреЗрдВрдЯ рдЪрд▓рд╛рддрд╛ рд╣реИ рдФрд░ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ рдЬрдорд╛ рдХрд░рддрд╛ рд╣реИред  рдмреИрдЪ рдХреЗ рддрддреНрд╡ рдЗрд╕ рддрд░рд╣ рдХреЗ рд╣реЛрддреЗ рд╣реИрдВ: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-507"><span class="MJXp-mo" id="MJXp-Span-508" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-512" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-515" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-516" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">R</span><span class="MJXp-mo" id="MJXp-Span-518" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-519">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">u</span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> (s_t, a_t, R (\ tau)) </script>  ред </p><br><p>  рдПрдХ рдЕрдЪреНрдЫрд╛ рдЬрдирд░реЗрдЯрд░ рд▓рд┐рдЦрдирд╛ рдПрдХ рдЕрд▓рдЧ рдХрд╛рд░реНрдп рд╣реИ, рдЬрд╣рд╛рдВ рдореБрдЦреНрдп рдХрдард┐рдирд╛рдИ рдПрдХрд▓ рд╕рд┐рдореБрд▓реЗрд╢рди рдЪрд░рдг (рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдореНрдпреВрдЬреЛ) рдХреА рддреБрд▓рдирд╛ рдореЗрдВ <b>sess.run ()</b> рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рд╕рд╛рдкреЗрдХреНрд╖ рдЙрдЪреНрдЪ рд▓рд╛рдЧрдд рд╣реИред  рдХрд╛рдо рдХреЛ рдЧрддрд┐ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдЗрд╕ рддрдереНрдп рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдмреИрдЪреЛрдВ рдкрд░ рдЪрд▓рддреЗ рд╣реИрдВ, рдФрд░ рдХрдИ рд╕рдорд╛рдирд╛рдВрддрд░ рд╡рд╛рддрд╛рд╡рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  <b>рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдХреНрд░рдорд┐рдХ рд░реВрдк рд╕реЗ рдЙрдиреНрд╣реЗрдВ рдПрдХ рдзрд╛рдЧреЗ рдореЗрдВ рд▓реЙрдиреНрдЪ рдХрд░рдиреЗ рд╕реЗ рдПрдХрд▓ рд╡рд╛рддрд╛рд╡рд░рдг рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рддреНрд╡рд░рдг рд╣реЛрдЧрд╛ред</b> </p><br><div class="spoiler">  <b class="spoiler_title">OpenAI рдмреЗрд╕рд▓рд╛рдЗрди рд╕реЗ DummyVecEnv рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рдЬреЗрдирд░реЗрдЯрд░ рдХреЛрдб</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Vectorized environments with gym-like interface from baselines.common.vec_env.subproc_vec_env import SubprocVecEnv from baselines.common.vec_env.dummy_vec_env import DummyVecEnv def make_env(env_id, seed): def _f(): env = gym.make(env_name) env.reset() # Desync environments for i in range(int(200 * seed // environments_count)): env.step(env.action_space.sample()) return env return _f envs = [make_env(env_name, seed) for seed in range(environments_count)] # Can be switched to SubprocVecEnv to parallelize on cores # (for computationally heavy envs) envs = DummyVecEnv(envs) # Source: # https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py def discount_cumsum(x, coef): """ magic from rllab for computing discounted cumulative sums of vectors. input: vector x, [x0, x1, x2] output: [x0 + discount * x1 + discount^2 * x2, x1 + discount * x2, x2] """ return scipy.signal.lfilter([1], [1, float(-coef)], x[::-1], axis=0)[::-1] def generate_batch(envs, batch_size, replay_buffer_size): envs_number = envs.num_envs observations = [[0 for i in range(observation_space)] for i in range(envs_number)] # [state, action, discounted reward-to-go] replay_buffer = np.empty((0,3), np.float32) # [state, action, reward] rollout lists for every environment instance rollouts = [np.empty((0, 3)) for i in range(envs_number)] while True: history = {'reward': [], 'max_action': []} replay_buffer = replay_buffer[batch_size:] # Main sampling cycle while len(replay_buffer) &lt; replay_buffer_size: # Here policy acts in environments. Note that it chooses actions for all # environments in one batch, therefore expensive sess.run is called once. actions = sess.run(actor.action_op, feed_dict={actor.state_ph: observations}) observations_old = observations observations, rewards, dones, _ = envs.step(actions) history['max_action'].append(np.abs(actions).max()) time_point = np.array(list(zip(observations_old, actions, rewards))) for i in range(envs_number): # Regular python-like append rollouts[i] = np.append(rollouts[i], [time_point[i]], axis=0) # Process done==True environments if dones.all(): print('WARNING: envs are in sync!! This makes sampling inefficient!') done_indexes = np.arange(envs_number)[dones] for i in done_indexes: rewards_trajectory = rollouts[i][:, 2].copy() history['reward'].append(rewards_trajectory.sum()) rollouts[i][:, 2] = discount_cumsum(rewards_trajectory, coef=discount_factor) replay_buffer = np.append(replay_buffer, rollouts[i], axis=0) rollouts[i] = np.empty((0, 3)) # Shuffle before yield to become closer to iid np.random.shuffle(replay_buffer) # Truncate replay_buffer to get the most relevant feedback from environment replay_buffer = replay_buffer[:replay_buffer_size] yield replay_buffer[:batch_size], history # Make a test yield a = generate_batch(envs, 8, 64) # Makes them of equal lenght for i in range(10): next(a) next(a)[0]</span></span></code> </pre></div></div><br><p>  рдкрд░рд┐рдгрд╛рдореА рдПрдЬреЗрдВрдЯ рд╡рд╛рддрд╛рд╡рд░рдг <b>рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рд╕реАрдорд┐рдд рд╕реНрдерд╛рди рдХреЗ</b> рд╕рд╛рде рдЦреЗрд▓ рд╕рдХрддрд╛ рд╣реИред  рдпрд╣ рдкреНрд░рд╛рд░реВрдк рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдЙрдкрдпреБрдХреНрдд рдирд╣реАрдВ рд╣реИред  рд░реЛрдмреЛрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдПрдЬреЗрдВрдЯ рдХреЛ рдПрдХ рд╡реЗрдХреНрдЯрд░ рдЬрд╛рд░реА рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-525"><span class="MJXp-mtext" id="MJXp-Span-526">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-527"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-529" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ R ^ n </script>  рдЬрд╣рд╛рдБ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-530"><span class="MJXp-mrow" id="MJXp-Span-531"><span class="MJXp-mo" id="MJXp-Span-532" style="margin-left: 0.278em; margin-right: 0.278em;">рдП</span></span><span class="MJXp-mrow" id="MJXp-Span-533"><span class="MJXp-mo" id="MJXp-Span-534" style="margin-left: 0.278em; margin-right: 0.278em;">рди</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> рдПрди </script>  - рд╕реНрд╡рддрдВрддреНрд░рддрд╛ рдХреА рдбрд┐рдЧреНрд░реА рдХреА рд╕рдВрдЦреНрдпрд╛ред  ( <a href="https://arxiv.org/abs/1910.07113">рдпрд╛ рдЖрдк рдПрдХреНрд╢рди рд╕реНрдкреЗрд╕ рдХреЛ рдЕрдВрддрд░рд╛рд▓ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрд╕рддрдд рдЖрдЙрдЯрдкреБрдЯ рдХреЗ рд╕рд╛рде рдПрдХ рдХрд╛рд░реНрдп рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ</a> ) </p><br><a name="diagonal-gaussian-policies"></a><h2>  рд╡рд┐рдХрд░реНрдг рдЧреМрд╕рд┐рдпрди рдиреАрддрд┐рдпрд╛рдБ </h2><br><p>  <b>рдбрд╛рдпрдЧреЛрдирд▓ рдЧреЙрд╕рд┐рдпрди рдиреАрддрд┐рдпреЛрдВ рдХреЗ</b> рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рд╕рд╛рд░ рдореЙрдбрд▓ рдХреЗ рд▓рд┐рдП n-рдЖрдпрд╛рдореА рд╕рд╛рдорд╛рдиреНрдп рд╡рд┐рддрд░рдг рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХрд╛ рдЙрддреНрдкрд╛рджрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ, рдЕрд░реНрдерд╛рддреН <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-535"><span class="MJXp-msubsup" id="MJXp-Span-536"><span class="MJXp-mtext" id="MJXp-Span-537" style="margin-right: 0.05em;">&nbsp;</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-538" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-539">рдо</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-540"><span class="MJXp-mrow" id="MJXp-Span-541" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-542" style="margin-left: 0.278em; margin-right: 0.278em;">реБ</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-543" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mrow" id="MJXp-Span-544"><span class="MJXp-mo" id="MJXp-Span-545" style="margin-left: 0.278em; margin-right: 0.278em;">рде</span></span><span class="MJXp-mrow" id="MJXp-Span-546"><span class="MJXp-mo" id="MJXp-Span-547" style="margin-left: 0.278em; margin-right: 0.278em;">реА</span></span><span class="MJXp-mrow" id="MJXp-Span-548"><span class="MJXp-mo" id="MJXp-Span-549" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-550"><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ _рдореБ_ \ рдереАрдЯрд╛ </script>  - рдЪрдЯрд╛рдИред  рдкреНрд░рддреАрдХреНрд╖рд╛ рдФрд░ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-552"><span class="MJXp-msubsup" id="MJXp-Span-553"><span class="MJXp-mtext" id="MJXp-Span-554" style="margin-right: 0.05em;">&nbsp;</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-555" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-556">рд╕</span></span></span><span class="MJXp-mrow" id="MJXp-Span-557"><span class="MJXp-mo" id="MJXp-Span-558" style="margin-left: 0.278em; margin-right: 0.278em;">рд┐</span></span><span class="MJXp-mrow" id="MJXp-Span-559"><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0.278em; margin-right: 0.278em;">рдЧ</span></span><span class="MJXp-mrow" id="MJXp-Span-561"><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-563"><span class="MJXp-mo" id="MJXp-Span-564" style="margin-left: 0.278em; margin-right: 0.278em;">рдо</span></span><span class="MJXp-msubsup" id="MJXp-Span-565"><span class="MJXp-mrow" id="MJXp-Span-566" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-568" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mrow" id="MJXp-Span-569"><span class="MJXp-mo" id="MJXp-Span-570" style="margin-left: 0.278em; margin-right: 0.278em;">рде</span></span><span class="MJXp-mrow" id="MJXp-Span-571"><span class="MJXp-mo" id="MJXp-Span-572" style="margin-left: 0.278em; margin-right: 0.278em;">реА</span></span><span class="MJXp-mrow" id="MJXp-Span-573"><span class="MJXp-mo" id="MJXp-Span-574" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-575"><span class="MJXp-mo" id="MJXp-Span-576" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> \ _ рд╕рд┐рдЧреНрдорд╛_ \ рдереАрдЯрд╛ </script>  - рдорд╛рдирдХ рд╡рд┐рдЪрд▓рдиред  <b>рдЬреИрд╕реЗ рд╣реА рдПрдЬреЗрдВрдЯ рдХреЛ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рд╣рдо рдЗрди рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдореЙрдбрд▓ рд╕реЗ рдкреВрдЫреЗрдВрдЧреЗ рдФрд░ рдЗрд╕ рд╡рд┐рддрд░рдг рд╕реЗ рдПрдХ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЪрд░ рд▓реЗрдВрдЧреЗред</b>  рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рдПрдЬреЗрдВрдЯ рдХреЛ рдмрд╛рд╣рд░ рдХрд░ рджрд┐рдпрд╛ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-577"><span class="MJXp-mtext" id="MJXp-Span-578">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-579"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580" style="margin-right: 0.05em;">R</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-581" style="vertical-align: 0.5em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ R ^ n </script>  рдФрд░ рдЗрд╕реЗ рд╕реНрдЯреЛрдХреЗрд╕реНрдЯрд┐рдХ рдмрдирд╛ рджрд┐рдпрд╛ред  рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдЖрдЙрдЯрдкреБрдЯ рдкрд░ рд╡рд┐рддрд░рдг рд╡рд░реНрдЧ рдХреЛ рддрдп рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдЧрдгрдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-582"><span class="MJXp-mtext" id="MJXp-Span-583">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">g</span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-588">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">p</span><span class="MJXp-msubsup" id="MJXp-Span-590"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-592" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-593">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">a</span><span class="MJXp-mo" id="MJXp-Span-598" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-601" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-602"><span class="MJXp-mo" id="MJXp-Span-603" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-606" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-608" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \ log (\ pi_ \ theta (a_t | s_t)) </script>  рдФрд░ рдЗрд╕рд▓рд┐рдП рдиреАрддрд┐ рдврд╛рд▓ред </p><br><p>  рдиреЛрдЯ: рддрдп рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-609"><span class="MJXp-msubsup" id="MJXp-Span-610"><span class="MJXp-mtext" id="MJXp-Span-611" style="margin-right: 0.05em;">&nbsp;</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-612" style="vertical-align: -0.4em;"><span class="MJXp-mo" id="MJXp-Span-613">рд╕</span></span></span><span class="MJXp-mrow" id="MJXp-Span-614"><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0.278em; margin-right: 0.278em;">рд┐</span></span><span class="MJXp-mrow" id="MJXp-Span-616"><span class="MJXp-mo" id="MJXp-Span-617" style="margin-left: 0.278em; margin-right: 0.278em;">рдЧ</span></span><span class="MJXp-mrow" id="MJXp-Span-618"><span class="MJXp-mo" id="MJXp-Span-619" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-620"><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0.278em; margin-right: 0.278em;">рдо</span></span><span class="MJXp-msubsup" id="MJXp-Span-622"><span class="MJXp-mrow" id="MJXp-Span-623" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-624" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-625" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mrow" id="MJXp-Span-626"><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0.278em; margin-right: 0.278em;">рде</span></span><span class="MJXp-mrow" id="MJXp-Span-628"><span class="MJXp-mo" id="MJXp-Span-629" style="margin-left: 0.278em; margin-right: 0.278em;">реА</span></span><span class="MJXp-mrow" id="MJXp-Span-630"><span class="MJXp-mo" id="MJXp-Span-631" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-632"><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ _ рд╕рд┐рдЧреНрдорд╛_ \ рдереАрдЯрд╛ </script>  рд╣рд╛рдЗрдкрд░рдкрд░рдореАрдЯрд░ рдХреЗ рд░реВрдк рдореЗрдВ, рдЬрд┐рд╕рд╕реЗ рдЖрдЙрдЯрдкреБрдЯ рдЖрдпрд╛рдо рдХрдо рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдЕрднреНрдпрд╛рд╕ рд╕реЗ рдкрддрд╛ рдЪрд▓рддрд╛ рд╣реИ рдХрд┐ рдЗрд╕рд╕реЗ рдмрд╣реБрдд рдиреБрдХрд╕рд╛рди рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди, рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рд╕реАрдЦрдиреЗ рдХреЛ рд╕реНрдерд┐рд░ рдХрд░рддрд╛ рд╣реИред </p><br><p>  <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro.html">рд╕реНрдЯреЛрдХреЗрд╕реНрдЯрд┐рдХ рдиреАрддрд┐ рдкрд░ рдЕрдзрд┐рдХ рдкрдврд╝реЗрдВ</a> ред </p><br><p>  рдПрдЬреЗрдВрдЯ рдХреЛрдб: </p><br><pre> <code class="python hljs">epsilon = <span class="hljs-number"><span class="hljs-number">1e-8</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gaussian_loglikelihood</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, mu, log_std)</span></span></span><span class="hljs-function">:</span></span> pre_sum = <span class="hljs-number"><span class="hljs-number">-0.5</span></span> * (((x - mu) / (tf.exp(log_std) + epsilon))**<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">2</span></span> * log_std + np.log(<span class="hljs-number"><span class="hljs-number">2</span></span> * np.pi)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.reduce_sum(pre_sum, axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ActorNetworkContinuous</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.tanh) l2 = tf.layers.dense(l1, units=<span class="hljs-number"><span class="hljs-number">50</span></span>, activation=tf.nn.tanh) l3 = tf.layers.dense(l2, units=<span class="hljs-number"><span class="hljs-number">25</span></span>, activation=tf.nn.tanh) mu = tf.layers.dense(l3, units=action_space) log_std = tf.get_variable(name=<span class="hljs-string"><span class="hljs-string">'log_std'</span></span>, initializer=<span class="hljs-number"><span class="hljs-number">-0.5</span></span> * np.ones(action_space, std = tf.exp(log_std) self.action_op = mu + tf.random.normal(shape=tf.shape(mu)) * std <span class="hljs-comment"><span class="hljs-comment"># Training self.weight_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.action_ph = tf.placeholder(shape=[None, action_space], dtype=tf.float32) action_logprob = gaussian_loglikelihood(self.action_ph, mu, log_std) self.loss = -tf.reduce_mean(action_logprob * self.weight_ph) optimizer = tf.train.AdamOptimizer(learning_rate=actor_learning_rate) self.update_op = optimizer.minimize(self.loss)</span></span></code> </pre><br><p>  рдкреНрд░рд╢рд┐рдХреНрд╖рдг рднрд╛рдЧ рдЕрд▓рдЧ рдирд╣реАрдВ рд╣реИред </p><br><p>  рдЕрдм рд╣рдо рдЕрдВрдд рдореЗрдВ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХреИрд╕реЗ REINFORCE рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдп рдХреЗ рд╕рд╛рде рд╕рд╛рдордирд╛ рдХрд░реЗрдЧрд╛ред  рдЗрд╕рдХреЗ рдмрд╛рдж, рдПрдЬреЗрдВрдЯ рдХрд╛ рд▓рдХреНрд╖реНрдп рджрд╛рдИрдВ рдУрд░ рдмрдврд╝рдирд╛ рд╣реИред </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/eH8cFxYHhQg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  рдзреАрд░реЗ-рдзреАрд░реЗ рд▓реЗрдХрд┐рди рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдЕрдкрдиреЗ рд▓рдХреНрд╖реНрдп рдХреА рдУрд░ рдмрдврд╝ рд░рд╣рд╛ рд╣реИред </p><br><h3>  рдкреБрд░рд╕реНрдХреГрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдиреЗ </h3><br><p>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рд╣рдорд╛рд░реЗ рдЧреНрд░реЗрдбрд┐рдПрдВрдЯ рдореЗрдВ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рджрд╕реНрдп рд╣реИрдВред  рд╣рд░ рдХрджрдо рдкрд░ рдирдорд╕реНрдХрд╛рд░ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-634"><span class="MJXp-mrow" id="MJXp-Span-635"><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-637"><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.278em; margin-right: 0.278em;">реА</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> рдЯреА </script>  рдЬрдм рд▓рдШреБрдЧрдгрдХ рдХреЗ рд╡рдЬрди рдХреЛ рдХрдо рдХрд░рддреЗ рд╣реБрдП, рд╣рдо <b>рдкреВрд░реЗ рдкреНрд░рдХреНрд╖реЗрдкрд╡рдХреНрд░ рдХреЗ рд▓рд┐рдП</b> рдХреБрд▓ рдЗрдирд╛рдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЕрддреАрдд рд╕реЗ рдЕрдкрдиреА рдЙрдкрд▓рдмреНрдзрд┐рдпреЛрдВ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдПрдЬреЗрдВрдЯ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдирд╛ред  рдЧрд▓рдд рд▓рдЧрддрд╛ рд╣реИ, рд╣реИ рдирд╛?  рдЗрд╕рд▓рд┐рдП рдпрд╣ </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-639"><span class="noError" id="MJXp-Span-640" style="display: inline-block;">\&nbsp;nabla_&nbsp;\&nbsp;theta&nbsp;J&nbsp;(\&nbsp;pi_&nbsp;\&nbsp;theta)&nbsp;=&nbsp;\&nbsp;E&nbsp;_&nbsp;{\&nbsp;_&nbsp;tau&nbsp;\&nbsp;sim&nbsp;\&nbsp;pi_&nbsp;\&nbsp;theta}&nbsp;\&nbsp;left&nbsp;[\&nbsp;sum_&nbsp;{t&nbsp;=&nbsp;0}&nbsp;^&nbsp;T&nbsp;\&nbsp;nabla_&nbsp;\&nbsp;theta&nbsp;\&nbsp;log&nbsp;\&nbsp;pi_&nbsp;\&nbsp;theta&nbsp;(a_t_)&nbsp;|&nbsp;s_t)&nbsp;\&nbsp;sum_&nbsp;{t&nbsp;'=&nbsp;0}&nbsp;^&nbsp;T&nbsp;r_&nbsp;{t'}&nbsp;\&nbsp;right]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ _ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t_) | s_t) \ sum_ {t '= 0} ^ T r_ {t'} \ right] </script></p><p>  рдпрд╣ рдмрди рдЬрд╛рдПрдЧрд╛ </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-641"><span class="noError" id="MJXp-Span-642" style="display: inline-block;">\&nbsp;nabla_&nbsp;\&nbsp;theta&nbsp;J&nbsp;(\&nbsp;pi_&nbsp;\&nbsp;theta)&nbsp;=&nbsp;\&nbsp;E&nbsp;_&nbsp;{\&nbsp;_&nbsp;tau&nbsp;\&nbsp;sim&nbsp;\&nbsp;pi_&nbsp;\&nbsp;theta}&nbsp;\&nbsp;left&nbsp;[\&nbsp;sum_&nbsp;{t&nbsp;=&nbsp;0}&nbsp;^&nbsp;T&nbsp;\&nbsp;nabla_&nbsp;\&nbsp;theta&nbsp;\&nbsp;log&nbsp;\&nbsp;pi_&nbsp;\&nbsp;theta&nbsp;(a_t_)&nbsp;|&nbsp;s_t)&nbsp;\&nbsp;sum_&nbsp;{t&nbsp;'=&nbsp;t}&nbsp;^&nbsp;T&nbsp;r_&nbsp;{t'}&nbsp;\&nbsp;right]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> \ nabla_ \ theta J (\ pi_ \ theta) = \ E _ {\ _ tau \ sim \ pi_ \ theta} \ left [\ sum_ {t = 0} ^ T \ nabla_ \ theta \ log \ pi_ \ theta (a_t_) | s_t) \ sum_ {t '= t} ^ T r_ {t'} \ right] </script></p><p>  10 рдЕрдВрддрд░ рдЦреЛрдЬреЗрдВ :) </p><br><p>  рдЬрдмрдХрд┐ рдЗрди рд╕рджрд╕реНрдпреЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдЧрдгрд┐рддреАрдп рд░реВрдк рд╕реЗ рдХреБрдЫ рднреА рдирд╣реАрдВ рдмрд┐рдЧрд╛рдбрд╝рддреА рд╣реИ, рдпрд╣ рд╣рдорд╛рд░реЗ рд▓рд┐рдП рдмрд╣реБрдд рд╢реЛрд░ рдХрд░рддрд╛ рд╣реИред  рдЕрдм, рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди, рдПрдЬреЗрдВрдЯ рдХреЗрд╡рд▓ рдЙрди рдкреБрд░рд╕реНрдХрд╛рд░реЛрдВ рдкрд░ рдзреНрдпрд╛рди рджреЗрдЧрд╛ рдЬреЛ рдЙрдиреНрд╣реЗрдВ <b>рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЗ рдмрд╛рдж</b> рдорд┐рд▓реЗ рдереЗред </p><br><p>  рдЗрд╕ рд╕реБрдзрд╛рд░ рдХреЗ рдХрд╛рд░рдг, рдФрд╕рдд рдЗрдирд╛рдо рдмрдврд╝рд╛ рд╣реИред  рдкреНрд░рд╛рдкреНрдд рдПрдЬреЗрдВрдЯреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдиреЗ рдЕрдкрдиреЗ рд▓рдХреНрд╖реНрдп рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП forelimbs рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реАрдЦрд╛: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/8sN-VaQsnVU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="add-critic"></a><h2>  рдЖрд▓реЛрдЪрдирд╛ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рд╡рд┐рдЪрд░рдг рдХреЛ рдХрдо рдХрд░реЗрдВ </h2><br><p>  рдЖрдЧреЗ рдХреЗ рд╕реБрдзрд╛рд░реЛрдВ рдХрд╛ рд╕рд╛рд░ рдорд╛рдзреНрдпрдо рдХреЗ рд░рд╛рдЬреНрдпреЛрдВ рдХреЗ рдмреАрдЪ рд╕реНрдЯреЛрдХреЗрд╕реНрдЯрд┐рдХ рд╕рдВрдХреНрд░рдордг рдХреЗ рдХрд╛рд░рдг рдЙрддреНрдкрдиреНрди рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рд╢реЛрд░ (рд╡рд┐рдЪрд░рдг) рдореЗрдВ рдХрдореА рд╣реИред </p><br><p>  рдпрд╣ рд╣рдореЗрдВ рдПрдХ <b>рдореЙрдбрд▓</b> рдЬреЛрдбрд╝рдиреЗ рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛, рдЬреЛ рд░рд╛рдЬреНрдп рд╕реЗ рд╢реБрд░реВ рд╣реЛрдиреЗ рд╡рд╛рд▓реЗ рдПрдЬреЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рд╛рдкреНрдд <b>рдкреБрд░рд╕реНрдХрд╛рд░реЛрдВ рдХреА рдФрд╕рдд рд░рд╛рд╢рд┐ рдХреА рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА рдХрд░реЗрдЧрд╛</b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-643"><span class="MJXp-mrow" id="MJXp-Span-644"><span class="MJXp-mo" id="MJXp-Span-645" style="margin-left: 0.278em; margin-right: 0.278em;">рдП</span></span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0.278em; margin-right: 0.278em;">рд╕</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> рдПрд╕ </script>  рдкреНрд░рдХреНрд╖реЗрдкрд╡рдХреНрд░ рдХреЗ рдЕрдВрдд рддрдХ, рдЕрд░реНрдерд╛рддреНред  рдорд╛рди рд╕рдорд╛рд░реЛрд╣ред </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-648"><span class="MJXp-msubsup" id="MJXp-Span-649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-651" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">i</span><span class="MJXp-mo" id="MJXp-Span-654" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">s</span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-657" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-658">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-661" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-662">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-664">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">u</span><span class="MJXp-mtext" id="MJXp-Span-666">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">m</span><span class="MJXp-mtext" id="MJXp-Span-670">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-673">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">t</span><span class="MJXp-mo" id="MJXp-Span-678" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">R</span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-681">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">u</span><span class="MJXp-mo" id="MJXp-Span-685" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-686"><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-690" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-691" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">s</span><span class="MJXp-mtext" id="MJXp-Span-693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">t</span><span class="MJXp-mo" id="MJXp-Span-699" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-700">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">t</span><span class="MJXp-mrow" id="MJXp-Span-705"><span class="MJXp-mo" id="MJXp-Span-706" style="margin-left: 0em; margin-right: 0.111em;">тИТ</span><span class="MJXp-mrow" id="MJXp-Span-707"><span class="MJXp-mo" id="MJXp-Span-708" style="margin-left: 0.278em; margin-right: 0.278em;">рдо</span></span><span class="MJXp-mrow" id="MJXp-Span-709"><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mrow" id="MJXp-Span-711"><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.278em; margin-right: 0.278em;">рди</span></span><span class="MJXp-mrow" id="MJXp-Span-713"><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0.278em; margin-right: 0.278em;">рдл</span></span><span class="MJXp-mrow" id="MJXp-Span-715"><span class="MJXp-mo" id="MJXp-Span-716" style="margin-left: 0.278em; margin-right: 0.278em;">рд╝</span></span><span class="MJXp-mrow" id="MJXp-Span-717"><span class="MJXp-mo" id="MJXp-Span-718" style="margin-left: 0.278em; margin-right: 0.278em;">рдВ</span></span><span class="MJXp-mrow" id="MJXp-Span-719"><span class="MJXp-mo" id="MJXp-Span-720" style="margin-left: 0.278em; margin-right: 0.278em;">рдХ</span></span><span class="MJXp-mrow" id="MJXp-Span-721"><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-723"><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0.278em; margin-right: 0.278em;">рд╢</span></span><span class="MJXp-mrow" id="MJXp-Span-725"><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0.278em; margin-right: 0.278em;">рди</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> V ^ \ pi (s) = \ E _ {\ tau \ sim \ pi} \ left [R (\ tau) | s_0 = s \ right] \ text {- рдорд╛рди рдлрд╝рдВрдХреНрд╢рди} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-727"><span class="MJXp-msubsup" id="MJXp-Span-728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-730" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">i</span><span class="MJXp-mo" id="MJXp-Span-733" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">s</span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-737">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-740" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-741">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">u</span><span class="MJXp-mtext" id="MJXp-Span-745">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">m</span><span class="MJXp-mtext" id="MJXp-Span-749">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-752">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">t</span><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">R</span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-760">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">u</span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-765"><span class="MJXp-mo" id="MJXp-Span-766" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-769" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">s</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-773"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-775" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">a</span><span class="MJXp-mtext" id="MJXp-Span-778">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">t</span><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-785">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-788">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">t</span><span class="MJXp-mrow" id="MJXp-Span-790"><span class="MJXp-mo" id="MJXp-Span-791" style="margin-left: 0em; margin-right: 0.111em;">тИТ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">n</span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">e</span><span class="MJXp-mo" id="MJXp-Span-804" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> Q ^ \ pi (s) = \ E _ {\ tau \ sim \ pi} \ left [R (\ tau) | s_0 = s, a_0 = a \ right] \ text {- Action-Value =} </script></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-805"><span class="MJXp-msubsup" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807" style="margin-right: 0.05em;">A</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-808" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">i</span><span class="MJXp-mo" id="MJXp-Span-811" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">s</span><span class="MJXp-mo" id="MJXp-Span-813" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-817" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-818">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">i</span><span class="MJXp-mo" id="MJXp-Span-820" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">s</span><span class="MJXp-mo" id="MJXp-Span-822" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">a</span><span class="MJXp-mo" id="MJXp-Span-824" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-825" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-msubsup" id="MJXp-Span-826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-828" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">i</span><span class="MJXp-mo" id="MJXp-Span-831" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">s</span><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-834">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">t</span><span class="MJXp-mrow" id="MJXp-Span-839"><span class="MJXp-mo" id="MJXp-Span-840" style="margin-left: 0em; margin-right: 0.111em;">тИТ</span><span class="MJXp-mrow" id="MJXp-Span-841"><span class="MJXp-mo" id="MJXp-Span-842" style="margin-left: 0.278em; margin-right: 0.278em;">рд▓</span></span><span class="MJXp-mrow" id="MJXp-Span-843"><span class="MJXp-mo" id="MJXp-Span-844" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mrow" id="MJXp-Span-845"><span class="MJXp-mo" id="MJXp-Span-846" style="margin-left: 0.278em; margin-right: 0.278em;">рдн</span></span><span class="MJXp-mrow" id="MJXp-Span-847"><span class="MJXp-mo" id="MJXp-Span-848" style="margin-left: 0.278em; margin-right: 0.278em;">рдл</span></span><span class="MJXp-mrow" id="MJXp-Span-849"><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0.278em; margin-right: 0.278em;">рд╝</span></span><span class="MJXp-mrow" id="MJXp-Span-851"><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0.278em; margin-right: 0.278em;">рдВ</span></span><span class="MJXp-mrow" id="MJXp-Span-853"><span class="MJXp-mo" id="MJXp-Span-854" style="margin-left: 0.278em; margin-right: 0.278em;">рдХ</span></span><span class="MJXp-mrow" id="MJXp-Span-855"><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-857"><span class="MJXp-mo" id="MJXp-Span-858" style="margin-left: 0.278em; margin-right: 0.278em;">рд╢</span></span><span class="MJXp-mrow" id="MJXp-Span-859"><span class="MJXp-mo" id="MJXp-Span-860" style="margin-left: 0.278em; margin-right: 0.278em;">рди</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> A ^ \ pi (s), Q ^ \ pi (s, a) -V ^ \ pi (s) \ text {- рд▓рд╛рдн рдлрд╝рдВрдХреНрд╢рди} </script></p><p>  рдорд╛рди рдлрд╝рдВрдХреНрд╢рди рдЕрдкреЗрдХреНрд╖рд┐рдд рд╡рд╛рдкрд╕реА рджрд┐рдЦрд╛рддрд╛ рд╣реИ рдпрджрд┐ рд╣рдорд╛рд░реА рдиреАрддрд┐ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рд░рд╛рдЬреНрдп рд╕реЗ рдЦреЗрд▓ рд╢реБрд░реВ рдХрд░рддреА рд╣реИред  рдХреНрдпреВ-рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд╕рд╛рде рднреА рдРрд╕рд╛ рд╣реА рд╣реИ, рдмрд╕ рдмрд╣реБрдд рдкрд╣рд▓реЗ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдХреЛ рдареАрдХ рдХрд░реЗрдВред </p><br><h3>  рдЖрд▓реЛрдЪрдирд╛ рдЬреЛрдбрд╝реЗрдВ </h3><br><p>  рдЗрдирд╛рдо-рджрд░-рдЧреЛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп рдпрд╣ рдврд╛рд▓ рдХреИрд╕реА рджрд┐рдЦрддреА рд╣реИ: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-861"><span class="MJXp-mtext" id="MJXp-Span-862">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">l</span><span class="MJXp-msubsup" id="MJXp-Span-867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-869" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">a</span><span class="MJXp-mtext" id="MJXp-Span-875">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">g</span><span class="MJXp-mtext" id="MJXp-Span-879">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">p</span><span class="MJXp-msubsup" id="MJXp-Span-881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-883" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">a</span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-892" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-893"><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-895"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-897" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-898" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-899">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901">u</span><span class="MJXp-msubsup" id="MJXp-Span-902"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-904"><span class="MJXp-msup" id="MJXp-Span-905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-907" style="vertical-align: 0.5em;">тА▓</span></span><span class="MJXp-mo" id="MJXp-Span-908">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-911"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-913" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-916" style="vertical-align: 0.5em;">тА▓</span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \ nabla_ \ theta \ log \ pi_ \ theta (a_t | s_t) \ sum_ {t '= t} ^ T r_ {t'} </script></p><p>  рдЕрдм рд▓рдШреБрдЧрдгрдХ рдХреЗ рдврд╛рд▓ рдХреЗ рд▓рд┐рдП рдЧреБрдгрд╛рдВрдХ рдорд╛рди рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдирдореВрдиреЗ рд╕реЗ рдЕрдзрд┐рдХ рдХреБрдЫ рдирд╣реАрдВ рд╣реИред </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-917"><span class="MJXp-mtext" id="MJXp-Span-918">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">u</span><span class="MJXp-msubsup" id="MJXp-Span-921"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-923"><span class="MJXp-msup" id="MJXp-Span-924"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-926" style="vertical-align: 0.5em;">тА▓</span></span><span class="MJXp-mo" id="MJXp-Span-927">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-932" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-933"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-935" style="vertical-align: 0.5em;">тА▓</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">m</span><span class="MJXp-msubsup" id="MJXp-Span-940"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-942" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">i</span><span class="MJXp-mo" id="MJXp-Span-945" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-946"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-948" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-949" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> \ sum_ {t '= t} ^ T r_ {t'} \ sim V ^ \ pi (s_t) </script></p><p>  рд╣рдо рдПрдХ рд╡рд┐рд╢реЗрд╖ рдкреНрд░рдХреНрд╖реЗрдкрд╡рдХреНрд░ рд╕реЗ рдПрдХ рдирдореВрдиреЗ рдХреЗ рд╕рд╛рде рд▓рдШреБрдЧрдгрдХ рдврд╛рд▓ рдХрд╛ рд╡рдЬрди рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдЕрдЪреНрдЫрд╛ рдирд╣реАрдВ рд╣реИред  <b>рд╣рдо рдХреБрдЫ рдореЙрдбрд▓ рдХреЗ рд╕рд╛рде рдорд╛рди-рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдЕрдиреБрдорд╛рдирд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ, рдФрд░ рдЗрд╕рд╕реЗ рдЖрд╡рд╢реНрдпрдХ рдореВрд▓реНрдп рдкреВрдЫрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рд╡рд┐рдЪрд░рдг рдХреЛ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред</b>  рд╣рдо рдЗрд╕ рдореЙрдбрд▓ рдХреЛ <b>рдЖрд▓реЛрдЪрдХ (рдХреНрд░рд┐рдЯрд┐рдХ)</b> рдХрд╣реЗрдВрдЧреЗ рдФрд░ рд╣рдо рдЗрд╕реЗ рдиреАрддрд┐ рдХреЗ рд╕рдорд╛рдирд╛рдВрддрд░ рдЕрдзреНрдпрдпрди рдХрд░реЗрдВрдЧреЗред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдврд╛рд▓ рд╕реВрддреНрд░ рдХреЗ рд░реВрдк рдореЗрдВ рд▓рд┐рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-950"><span class="MJXp-mtext" id="MJXp-Span-951">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">l</span><span class="MJXp-msubsup" id="MJXp-Span-956"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-958" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">a</span><span class="MJXp-mtext" id="MJXp-Span-964">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">g</span><span class="MJXp-mtext" id="MJXp-Span-968">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">p</span><span class="MJXp-msubsup" id="MJXp-Span-970"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-972" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">a</span><span class="MJXp-mo" id="MJXp-Span-978" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-979"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-981" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-982"><span class="MJXp-mo" id="MJXp-Span-983" style="margin-left: 0.278em; margin-right: 0.278em;">ред</span></span><span class="MJXp-msubsup" id="MJXp-Span-984"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-986" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-988">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">u</span><span class="MJXp-msubsup" id="MJXp-Span-991"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-993"><span class="MJXp-msup" id="MJXp-Span-994"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-996" style="vertical-align: 0.5em;">тА▓</span></span><span class="MJXp-mo" id="MJXp-Span-997">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1000"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1002" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1005" style="vertical-align: 0.5em;">тА▓</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1006">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1007"><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0.278em; margin-right: 0.278em;">рд▓</span></span><span class="MJXp-mrow" id="MJXp-Span-1009"><span class="MJXp-mo" id="MJXp-Span-1010" style="margin-left: 0.278em; margin-right: 0.278em;">рдЧ</span></span><span class="MJXp-mrow" id="MJXp-Span-1011"><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0.278em; margin-right: 0.278em;">рдн</span></span><span class="MJXp-mrow" id="MJXp-Span-1013"><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0.278em; margin-right: 0.278em;">рдЧ</span></span><span class="MJXp-mtext" id="MJXp-Span-1015">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">l</span><span class="MJXp-msubsup" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021" style="margin-right: 0.05em;">a</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1022" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">t</span><span class="MJXp-msup" id="MJXp-Span-1027"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028" style="margin-right: 0.05em;">a</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1029" style="vertical-align: 0.5em;">тА▓</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">g</span><span class="MJXp-mtext" id="MJXp-Span-1034">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">p</span><span class="MJXp-msubsup" id="MJXp-Span-1036"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1038" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">a</span><span class="MJXp-mo" id="MJXp-Span-1044" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1045"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1047" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mrow" id="MJXp-Span-1048"><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0.278em; margin-right: 0.278em;">ред</span></span><span class="MJXp-msubsup" id="MJXp-Span-1050"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1052" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055" style="margin-right: 0.05em;">V</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1056" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1057">|</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1058">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">i</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1062">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">u</span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> \ nabla_ \ theta \ log \ pi_ \ theta (a_tред s_t) \ sum_ {t '= t} ^ T r_ {t'} \ рд▓рдЧрднрдЧ \ nabla_ \ theta's log \ pi_ \ theta (a_tред s_t) V ^ | \ pi (\ tau) </script></p><p>  рд╣рдордиреЗ рд╡рд┐рдЪрд░рдг рдХреЛ рдХрдо рдХрд┐рдпрд╛, рд▓реЗрдХрд┐рди рд╕рд╛рде рд╣реА, рд╣рдордиреЗ рдЕрдкрдиреЗ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдореЗрдВ <b>рдкреВрд░реНрд╡рд╛рдЧреНрд░рд╣</b> рдкреЗрд╢ рдХрд┐рдпрд╛, рдХреНрдпреЛрдВрдХрд┐ рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рд╕рдиреНрдирд┐рдХрдЯрди рддреНрд░реБрдЯрд┐рдпрд╛рдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд▓реЗрдХрд┐рди рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕рдордЭреМрддрд╛ рдЕрдЪреНрдЫрд╛ рд╣реИред  рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдореЗрдВ рдРрд╕реА рд╕реНрдерд┐рддрд┐рдпреЛрдВ рдХреЛ <b><a href="https://towardsdatascience.com/understanding-the-bias-variance-tradeoff-165e6942b229">рдкреВрд░реНрд╡рд╛рдЧреНрд░рд╣-рдкрд░рд┐рд╡рд░реНрддрди рд╡реНрдпрд╛рдкрд╛рд░</a></b> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдЖрд▓реЛрдЪрдХ рдкрд░реНрдпрд╛рд╡рд░рдг рдореЗрдВ рдПрдХрддреНрд░ рдХрд┐рдП рдЧрдП рдЗрдирд╛рдо-рдЯреВ-рдЧреЛ рдирдореВрдиреЛрдВ рдкрд░ рдореВрд▓реНрдп-рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рддрд┐рдЧрдорди рд╕рд┐рдЦрд╛рдПрдЧрд╛ред  рдПрдХ рддреНрд░реБрдЯрд┐ рд╕рдорд╛рд░реЛрд╣ рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдо рдПрдордПрд╕рдИ рд▓реЗрддреЗ рд╣реИрдВред  рдпрд╛рдиреА  рдиреБрдХрд╕рд╛рди рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1067"><span class="MJXp-mrow" id="MJXp-Span-1068"><span class="MJXp-mo" id="MJXp-Span-1069" style="margin-left: 0.278em; margin-right: 0.278em;">рд╣</span></span><span class="MJXp-mrow" id="MJXp-Span-1070"><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mrow" id="MJXp-Span-1072"><span class="MJXp-mo" id="MJXp-Span-1073" style="margin-left: 0.278em; margin-right: 0.278em;">рди</span></span><span class="MJXp-mrow" id="MJXp-Span-1074"><span class="MJXp-mo" id="MJXp-Span-1075" style="margin-left: 0.278em; margin-right: 0.278em;">рд┐</span></span><span class="MJXp-mo" id="MJXp-Span-1076" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1078"><span class="MJXp-mrow" id="MJXp-Span-1079" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">V</span></span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1081" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">p</span><span class="MJXp-msubsup" id="MJXp-Span-1083"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1085" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">i</span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1090"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1092" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1094" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-mtext" id="MJXp-Span-1095">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">u</span><span class="MJXp-msubsup" id="MJXp-Span-1098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1100"><span class="MJXp-msup" id="MJXp-Span-1101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1103" style="vertical-align: 0.5em;">тА▓</span></span><span class="MJXp-mo" id="MJXp-Span-1104">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1109" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1112" style="vertical-align: 0.5em;">тА▓</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1113"><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1115" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1116">$</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> рд╣рд╛рдирд┐ = ({V} ^ \ pi_ \ psi (s_t) - \ sum_ {t '= t} ^ T r_ {t'}) ^ $ </script></p><p>  рдЖрд▓реЛрдЪрдирд╛ рдХреЛрдб: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CriticNetwork</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.state_ph = tf.placeholder(tf.float32, shape=[<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, observation_space]) l1 = tf.layers.dense(self.state_ph, units=<span class="hljs-number"><span class="hljs-number">100</span></span>, activation=tf.nn.tanh) l2 = tf.layers.dense(l1, units=<span class="hljs-number"><span class="hljs-number">50</span></span>, activation=tf.nn.tanh) l3 = tf.layers.dense(l2, units=<span class="hljs-number"><span class="hljs-number">25</span></span>, activation=tf.nn.tanh) output = tf.layers.dense(l3, units=<span class="hljs-number"><span class="hljs-number">1</span></span>) self.value_op = tf.squeeze(output, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>) <span class="hljs-comment"><span class="hljs-comment"># Training self.value_ph = tf.placeholder(shape=[None], dtype=tf.float32) self.loss = tf.losses.mean_squared_error(self.value_ph, self.value_op) optimizer = tf.train.AdamOptimizer(learning_rate=critic_learning_rate) self.update_op = optimizer.minimize(self.loss)</span></span></code> </pre><br><p>  рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдЪрдХреНрд░ рдЕрдм рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs">batch_generator = generate_batch(envs, batch_size=batch_size) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> tqdm_notebook(range(epochs_number)): batch = next(batch_generator) <span class="hljs-comment"><span class="hljs-comment"># Remainder: batch item consists of [state, action, value, reward-to-go] # Train actor _, actor_loss = sess.run([actor.update_op, actor.loss], feed_dict={actor.state_ph: batch[:, 0], actor.action_ph: batch[:, 1], actor.weight_ph: batch[:, 2]}) # Train critic for j in range(10): _, critic_loss = sess.run([critic.update_op, critic.loss], feed_dict={critic.state_ph: batch[:, 0], critic.value_ph: batch[:, 3]})</span></span></code> </pre><br><p>  рдЕрдм рдмреИрдЪ рдореЗрдВ рдПрдХ рдФрд░ рдореВрд▓реНрдп, рдореВрд▓реНрдп, рдЬрдирд░реЗрдЯрд░ рдореЗрдВ рдЖрд▓реЛрдЪрдХ рджреНрд╡рд╛рд░рд╛ рдЧрдгрдирд╛ рдХреА рдЬрд╛рддреА рд╣реИред <br>  рдпрд╛рдиреА  рдмреИрдЪ рдХрд╛ рдкреНрд░рдХрд╛рд░ рдпрд╣ рд╣реИ: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1117"><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1121" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1122" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1125" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1129" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">p</span><span class="MJXp-msubsup" id="MJXp-Span-1131"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132" style="margin-right: 0.05em;">i</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1133" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136">i</span><span class="MJXp-mo" id="MJXp-Span-1137" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1140" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1141" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1142" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1143">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">u</span><span class="MJXp-msubsup" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1148"><span class="MJXp-msup" id="MJXp-Span-1149"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1151" style="vertical-align: 0.5em;">тА▓</span></span><span class="MJXp-mo" id="MJXp-Span-1152">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">t</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1155"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1157" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-1158"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159" style="margin-right: 0.05em;">t</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1160" style="vertical-align: 0.5em;">тА▓</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1161" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> (s_t, a_t, V ^ \ pi_ \ psi (s_t), \ sum_ {t '= t} ^ T r_ {t'}) </script>  ред </p><br><p>  рдЪрдХреНрд░ рдореЗрдВ, <b>рдЖрд▓реЛрдЪрдХ рдХреЛ рдЕрднрд┐рд╕рд░рдг рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг</b> рд╕реЗ рдХреБрдЫ рднреА рд╕реАрдорд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЧреНрд░реЗрдбрд┐рдПрдВрдЯ рд╡рдВрд╢ рдХреЗ рдХрдИ рдХрджрдо рдЙрдард╛рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдореВрд▓реНрдп рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрдиреБрдорд╛рди рдореЗрдВ рд╕реБрдзрд╛рд░ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдкреВрд░реНрд╡рд╛рдЧреНрд░рд╣ рдХрдо рд╣реЛрддреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЛ рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмрдбрд╝реЗ рдмреИрдЪ рдЖрдХрд╛рд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  <b>рд╕реАрдЦрдиреЗ рдХреА рдиреАрддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдХ рд╕рдорд╛рди рдХрдерди рд╕рддреНрдп рдирд╣реАрдВ рд╣реИред</b>  рдЗрд╕реЗ рд╕реАрдЦрдиреЗ рдХреЗ рдорд╛рд╣реМрд▓ рд╕реЗ рддреБрд░рдВрдд рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдорд┐рд▓рдиреА рдЪрд╛рд╣рд┐рдП, рдЕрдиреНрдпрдерд╛ рд╣рдо рдЦреБрдж рдХреЛ рдРрд╕реА рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рд╣рдо рдЙрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдиреАрддрд┐ рдХреЛ рдареАрдХ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдирд╣реАрдВ рдХрд┐рдП рдЧрдП рдереЗред  рдЗрд╕ рд╕рдВрдкрддреНрддрд┐ рд╡рд╛рд▓реЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ <b>рдСрди-рдкреЙрд▓рд┐рд╕реА</b> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><h3>  рдкреЙрд▓рд┐рд╕реА рдЧреНрд░реЗрдЬреБрдПрдЯреНрд╕ рдореЗрдВ рдмреЗрд╕рд▓рд╛рдЗрди </h3><br><p>  рдпрд╣ рджрд┐рдЦрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдЧреНрд░реЗрдбрд┐рдПрдВрдЯ рдореЗрдВ рдЕрдиреНрдп рдЙрдкрдпреЛрдЧреА рдХрд╛рд░реНрдпреЛрдВ рдХреА рдПрдХ рд╡рд┐рд╕реНрддреГрдд рдХрдХреНрд╖рд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рд╣реИ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1162"><span class="MJXp-mrow" id="MJXp-Span-1163"><span class="MJXp-mo" id="MJXp-Span-1164" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-mrow" id="MJXp-Span-1165"><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0.278em; margin-right: 0.278em;">реА</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> рдЯреА </script>  ред  рдРрд╕реЗ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ <b>рдЖрдзрд╛рд░ рд░реЗрдЦрд╛</b> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  ( <a href="https://spinningup.openai.com/en/latest/spinningup/rl_intro3.html">рдЗрд╕ рддрдереНрдп рдХрд╛ рдирд┐рд╖реНрдХрд░реНрд╖</a> ) рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрд╛рд░реНрдп рдЖрдзрд╛рд░рднреВрдд рдХрд╛рд░реНрдп рдХрд░рддреЗ рд╣реИрдВ: </p><br><img src="https://habrastorage.org/webt/c8/ah/l7/c8ahl70po6_pgcud0jxdfbmubi8.png"><br><p>  <i>рд╕реНрд░реЛрдд: <a href="https://arxiv.org/pdf/1506.02438.pdf">рдЬреАрдПрдИ рдкреЗрдкрд░</a></i> </p><br><p>  рд╡рд┐рднрд┐рдиреНрди рдЖрдзрд╛рд░рднреВрдд рдХрд╛рд░реНрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкрд░рд┐рдгрд╛рдо рджреЗрддреЗ рд╣реИрдВред  рдПрдХ рдирд┐рдпрдо рдХреЗ рд░реВрдк рдореЗрдВ, рд╕рдмрд╕реЗ рдмрдбрд╝рд╛ рд▓рд╛рдн <b>рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдлрд╝рдВрдХреНрд╢рди</b> рдФрд░ рдЗрд╕рдХреЗ рдЕрдиреБрдорд╛рдиреЛрдВ рджреНрд╡рд╛рд░рд╛ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдЗрд╕рдХреЗ рдкреАрдЫреЗ рдереЛрдбрд╝рд╛ рдЕрдВрддрд░реНрдЬреНрдЮрд╛рди рднреА рд╣реИред  рдЬрдм рд╣рдо рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо рдЙрд╕ рдЕрдиреБрдкрд╛рдд рдореЗрдВ рдПрдЬреЗрдВрдЯ рдХреЛ рдареАрдХ рдХрд░рддреЗ рд╣реИрдВ, рдЬреЛ рдПрдЬреЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рдХреА рдЧрдИ рдХрд╛рд░реНрд░рд╡рд╛рдИ рд╕реЗ рдФрд╕рдд рд╕реЗ рдЬреНрдпрд╛рджрд╛ рдмреЗрд╣рддрд░ рдпрд╛ рдЦрд░рд╛рдм рд╣реЛрддрд╛ рд╣реИред  рдФрд░ рдПрдЬреЗрдВрдЯ <b>рдЬрд┐рддрдирд╛</b> рдмреЗрд╣рддрд░ рдкрд░реНрдпрд╛рд╡рд░рдг рдореЗрдВ рдЦреЗрд▓рддрд╛ рд╣реИ, <b>рдЙрд╕рдХреЗ рдорд╛рдирдХ рдЙрддрдиреЗ</b> рд╣реА <b>рдКрдВрдЪреЗ рд╣реЛрддреЗ рдЬрд╛рддреЗ рд╣реИрдВ</b> ред  рдЖрджрд░реНрд╢ рдПрдЬреЗрдВрдЯ рдЕрдЪреНрдЫрд╛ рдЦреЗрд▓реЗрдЧрд╛ рдФрд░ рдЕрдкрдиреЗ рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░реЗрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдПрдбрд╡рд╛рдВрдЯреЗрдЬ 0 рдХреЗ рдмрд░рд╛рдмрд░ рд╣реИ рдФрд░ рдЗрд╕рд▓рд┐рдП, 0 рдХреЗ рдмрд░рд╛рдмрд░ рдЧреНрд░реЗрдбрд┐рдПрдВрдЯ рд╣реИред </p><br><h3>  рд╡реИрд▓реНрдпреВ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓рд╛рдн рдореВрд▓реНрдпрд╛рдВрдХрди </h3><br><p>  рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛ рдпрд╛рдж рдХрд░реЗрдВ: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1167"><span class="MJXp-msubsup" id="MJXp-Span-1168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169" style="margin-right: 0.05em;">A</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1170" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">i</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">s</span><span class="MJXp-mo" id="MJXp-Span-1175" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178" style="margin-right: 0.05em;">Q</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1179" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">i</span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">s</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">a</span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-msubsup" id="MJXp-Span-1188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189" style="margin-right: 0.05em;">V</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1190" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">i</span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">s</span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1196">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">t</span><span class="MJXp-mrow" id="MJXp-Span-1201"><span class="MJXp-mo" id="MJXp-Span-1202" style="margin-left: 0em; margin-right: 0.111em;">тИТ</span><span class="MJXp-mrow" id="MJXp-Span-1203"><span class="MJXp-mo" id="MJXp-Span-1204" style="margin-left: 0.278em; margin-right: 0.278em;">рд▓</span></span><span class="MJXp-mrow" id="MJXp-Span-1205"><span class="MJXp-mo" id="MJXp-Span-1206" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mrow" id="MJXp-Span-1207"><span class="MJXp-mo" id="MJXp-Span-1208" style="margin-left: 0.278em; margin-right: 0.278em;">рдн</span></span><span class="MJXp-mrow" id="MJXp-Span-1209"><span class="MJXp-mo" id="MJXp-Span-1210" style="margin-left: 0.278em; margin-right: 0.278em;">рдл</span></span><span class="MJXp-mrow" id="MJXp-Span-1211"><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0.278em; margin-right: 0.278em;">рд╝</span></span><span class="MJXp-mrow" id="MJXp-Span-1213"><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0.278em; margin-right: 0.278em;">рдВ</span></span><span class="MJXp-mrow" id="MJXp-Span-1215"><span class="MJXp-mo" id="MJXp-Span-1216" style="margin-left: 0.278em; margin-right: 0.278em;">рдХ</span></span><span class="MJXp-mrow" id="MJXp-Span-1217"><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-1219"><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0.278em; margin-right: 0.278em;">рд╢</span></span><span class="MJXp-mrow" id="MJXp-Span-1221"><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0.278em; margin-right: 0.278em;">рди</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-43"> A ^ \ pi (s), Q ^ \ pi (s, a) -V ^ \ pi (s) \ text {- рд▓рд╛рдн рдлрд╝рдВрдХреНрд╢рди} </script></p><p>  рдпрд╣ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдХреИрд╕реЗ рд╕реАрдЦрд╛ рдЬрд╛рдПред  рдмрдЪрд╛рд╡ рдХреЗ рд▓рд┐рдП рдПрдХ рдЯреНрд░рд┐рдХ рдЖрдПрдЧреА, рдЬреЛ рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЧрдгрдирд╛ рдХреЛ рд╡реИрд▓реНрдпреВ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЧрдгрдирд╛ рдореЗрдВ рдХрдо рдХрд░ рджреЗрдЧреАред </p><br><p>  рдкрд░рд┐рднрд╛рд╖рд┐рдд <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1223"><span class="MJXp-mtext" id="MJXp-Span-1224">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1228">t</span><span class="MJXp-msubsup" id="MJXp-Span-1229"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1233" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1236" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1237" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">V</span><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1240"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1242" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">t</span><span class="MJXp-mo" id="MJXp-Span-1244">+</span><span class="MJXp-mn" id="MJXp-Span-1245">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">V</span><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1250"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1252" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ delta_t ^ V = r_t + V (s_ {t + 1}) - V (s_t) </script>  - рдЕрд╕реНрдерд╛рдпреА рдЕрдВрддрд░ рдЕрд╡рд╢рд┐рд╖реНрдЯ ( <b>рдЯреАрдбреА-рдЕрд╡рд╢рд┐рд╖реНрдЯ</b> )ред  рдпрд╣ рдХрд╣рдирд╛ рдореБрд╢реНрдХрд┐рд▓ рдирд╣реАрдВ рд╣реИ рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ рдПрдХ рд╕рдорд╛рд░реЛрд╣ рдХрд╛ рдлрд╛рдпрджрд╛ рд╣реЛрддрд╛ рд╣реИ: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1254"><span class="MJXp-mtext" id="MJXp-Span-1255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">E</span><span class="MJXp-mtext" id="MJXp-Span-1257">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">t</span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1263">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">t</span><span class="MJXp-msubsup" id="MJXp-Span-1268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">t</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1272">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">t</span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1279" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1280">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">E</span><span class="MJXp-mtext" id="MJXp-Span-1282">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286">t</span><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1288"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1290" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1291" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">V</span><span class="MJXp-mo" id="MJXp-Span-1293" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1296" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">t</span><span class="MJXp-mo" id="MJXp-Span-1298">+</span><span class="MJXp-mn" id="MJXp-Span-1299">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1300" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1301" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">V</span><span class="MJXp-mo" id="MJXp-Span-1303" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1306" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1308">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">t</span><span class="MJXp-mo" id="MJXp-Span-1314" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1315" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">E</span><span class="MJXp-mtext" id="MJXp-Span-1318">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1320">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322">t</span><span class="MJXp-mo" id="MJXp-Span-1323" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">Q</span><span class="MJXp-mo" id="MJXp-Span-1325" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1328" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1329" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1332" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1334" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">V</span><span class="MJXp-mo" id="MJXp-Span-1336" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1339" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1341">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">t</span><span class="MJXp-mo" id="MJXp-Span-1347" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1348" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">A</span><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1351"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1353" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1354" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1357" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1358" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-45"> \ E \ left [\ delta ^ V_t \ right] = \ E \ left [r_t + V (s_ {t + 1}) - V (s_t) \ right] = \ E \ left [Q (s_t, a_t) -V (s_t) \ right] = A (s_t, a_t) </script></p><p>  рдЗрд╕ рддрд░рд╣ рдХрд╛ рдПрдХ рд╡реИрдЪрд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рдЬрдЯрд┐рд▓ рдмрджрд▓рд╛рд╡ рдХреЛрдб рдореЗрдВ рдЗрддрдирд╛ рдмрдбрд╝рд╛ рдмрджрд▓рд╛рд╡ рдирд╣реАрдВ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдХрд╕рд╛рддрд╛ рд╣реИред  рдЕрдм, рдорд╛рди рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдореВрд▓реНрдпрд╛рдВрдХрди рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп, рдЖрд▓реЛрдЪрдХ рдиреАрддрд┐ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХ рд▓рд╛рдн рдореВрд▓реНрдпрд╛рдВрдХрди рдкреНрд░рд╕реНрддреБрдд рдХрд░реЗрдЧрд╛ред </p><br><p>  рдкрд░рд┐рдгрд╛рдореА рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЛ <b>рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдПрдХреНрдЯрд░-рдХреНрд░рд┐рдЯрд┐рдХ</b> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">estimate_advantage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(states, rewards)</span></span></span><span class="hljs-function">:</span></span> values = sess.run(critic.value_op, feed_dict={critic.state_ph: states}) deltas = rewards - values deltas = deltas + np.append(values[<span class="hljs-number"><span class="hljs-number">1</span></span>:], np.array([<span class="hljs-number"><span class="hljs-number">0</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> deltas, values</code> </pre><br><p>  рдкреНрд░рд╛рдкреНрдд рдПрдЬреЗрдВрдЯреЛрдВ рдХреЛ рдЖрддреНрдорд╡рд┐рд╢реНрд╡рд╛рд╕ рд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдФрд░ рдЕрдВрдЧреЛрдВ рдХреЗ рд╕рдордХрд╛рд▓рд┐рдХ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/GCbPl3dOLmQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд рд▓рд╛рдн рдЕрдиреБрдорд╛рди </h3><br><p>  рдПрдХ рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рд╣рд╛рд▓рд┐рдпрд╛ рд▓реЗрдЦ (2018), " <a href="https://arxiv.org/pdf/1506.02438.pdf">рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд рд▓рд╛рдн рдЖрдХрд▓рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЙрдЪреНрдЪ-рдЖрдпрд╛рдореА рдирд┐рд░рдВрддрд░ рдирд┐рдпрдВрддреНрд░рдг</a> ", рдореВрд▓реНрдп рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдПрдбрд╡рд╛рдВрдЯреЗрдЬ рдХрд╛ рдФрд░ рднреА рдЕрдзрд┐рдХ рдХреБрд╢рд▓ рдореВрд▓реНрдпрд╛рдВрдХрди рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдЕрдзрд┐рдХ рд╡рд┐рдЪрд░рдг рдХреЛ рдХрдо рдХрд░рддрд╛ рд╣реИ: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1359"><span class="MJXp-msubsup" id="MJXp-Span-1360"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1361" style="margin-right: 0.05em;">A</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1363"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1364">G</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">E</span><span class="MJXp-mo" id="MJXp-Span-1367">(</span><span class="MJXp-mtext" id="MJXp-Span-1368">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1369">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">a</span><span class="MJXp-mo" id="MJXp-Span-1374">,</span><span class="MJXp-mtext" id="MJXp-Span-1375">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1377">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1378">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">a</span><span class="MJXp-mo" id="MJXp-Span-1382">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1383" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1384">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1386">u</span><span class="MJXp-msubsup" id="MJXp-Span-1387"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-1393">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390">l</span><span class="MJXp-mo" id="MJXp-Span-1391">=</span><span class="MJXp-mn" id="MJXp-Span-1392">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1394">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">y</span><span class="MJXp-mo" id="MJXp-Span-1399" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1400">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1403">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">a</span><span class="MJXp-mtext" id="MJXp-Span-1406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">a</span><span class="MJXp-msubsup" id="MJXp-Span-1413"><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1415" style="vertical-align: 0.5em;">l</span></span><span class="MJXp-mtext" id="MJXp-Span-1416">&nbsp;</span><span class="MJXp-mrow" id="MJXp-Span-1417"><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0.278em; margin-right: 0.278em;">рдб</span></span><span class="MJXp-mrow" id="MJXp-Span-1419"><span class="MJXp-mo" id="MJXp-Span-1420" style="margin-left: 0.278em; margin-right: 0.278em;">реЗ</span></span><span class="MJXp-mrow" id="MJXp-Span-1421"><span class="MJXp-mo" id="MJXp-Span-1422" style="margin-left: 0.278em; margin-right: 0.278em;">рд▓</span></span><span class="MJXp-mrow" id="MJXp-Span-1423"><span class="MJXp-mo" id="MJXp-Span-1424" style="margin-left: 0.278em; margin-right: 0.278em;">реН</span></span><span class="MJXp-mrow" id="MJXp-Span-1425"><span class="MJXp-mo" id="MJXp-Span-1426" style="margin-left: 0.278em; margin-right: 0.278em;">рдЯ</span></span><span class="MJXp-msubsup" id="MJXp-Span-1427"><span class="MJXp-mrow" id="MJXp-Span-1428" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1430"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">t</span><span class="MJXp-mo" id="MJXp-Span-1432">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">l</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-46"> A_t ^ {GAE (\ gamma, \ lambda)} = \ sum_ {l = 0} ^ \ infty (\ gamma \ lambda) ^ l \ рдбреЗрд▓реНрдЯрд╛ ^ V_ {t + l} </script></p><p>  рдЬрд╣рд╛рдВ: </p><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1435"><span class="MJXp-mtext" id="MJXp-Span-1436">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">t</span><span class="MJXp-msubsup" id="MJXp-Span-1441"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442" style="margin-right: 0.05em;">a</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1444">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">t</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1445" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1447" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1448" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1449" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">V</span><span class="MJXp-mo" id="MJXp-Span-1451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1452"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1454" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1455">t</span><span class="MJXp-mo" id="MJXp-Span-1456">+</span><span class="MJXp-mn" id="MJXp-Span-1457">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1458" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1459" style="margin-left: 0.267em; margin-right: 0.267em;">тИТ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">V</span><span class="MJXp-mo" id="MJXp-Span-1461" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1464" style="vertical-align: -0.4em;">t</span></span><span class="MJXp-mo" id="MJXp-Span-1465" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ delta_t ^ V = r_t + V (s_ {t + 1}) - V (s_t) </script>  - рдЯреАрдбреА-рдЕрд╡рд╢рд┐рд╖реНрдЯ, </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1466"><span class="MJXp-mrow" id="MJXp-Span-1467"><span class="MJXp-mo" id="MJXp-Span-1468" style="margin-left: 0.278em; margin-right: 0.278em;">рдЧ</span></span><span class="MJXp-mrow" id="MJXp-Span-1469"><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span><span class="MJXp-mrow" id="MJXp-Span-1471"><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0.278em; margin-right: 0.278em;">рдо</span></span><span class="MJXp-mrow" id="MJXp-Span-1473"><span class="MJXp-mo" id="MJXp-Span-1474" style="margin-left: 0.278em; margin-right: 0.278em;">рд╛</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> рдЧрд╛рдорд╛ </script>  - рдбрд┐рд╕реНрдХрд╛рдЙрдВрдЯ рдлреИрдХреНрдЯрд░ (рд╣рд╛рдЗрдкрд░рдкрд░рдореАрдЯрд░), </li><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1475"><span class="MJXp-mtext" id="MJXp-Span-1476">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1477">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1479">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1481">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> \ lambda </script>  - рд╣рд╛рдЗрдкрд░рдкрд░рдореАрдЯрд░ред </li></ul><br><p>  рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХреЛ рдкреНрд░рдХрд╛рд╢рди рдореЗрдВ рд╣реА рдкрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">discount_cumsum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, coef)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Source: # https://github.com/openai/spinningup/blob/master/spinup/algos/ppo/core.py """ magic from rllab for computing discounted cumulative sums of vectors. input: vector x, [x0, x1, x2] output: [x0 + discount * x1 + discount^2 * x2, x1 + discount * x2, x2] """ return scipy.signal.lfilter([1], [1, float(-coef)], x[::-1], axis=0)[::-1] def estimate_advantage(states, rewards): values = sess.run(critic.value_op, feed_dict={critic.state_ph: states}) deltas = rewards - values deltas = deltas + discount_factor * np.append(values[1:], np.array([0])) advantage = discount_cumsum(deltas, coef=lambda_factor * discount_factor) return advantage, values</span></span></code> </pre><br><p>  рдПрдХ рдЫреЛрдЯреЗ рдмреИрдЪ рдЖрдХрд╛рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреБрдЫ рд╕реНрдерд╛рдиреАрдп рдСрдкреНрдЯрд┐рдорд╛ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣рд╛рдБ, рдПрдЬреЗрдВрдЯ рдПрдХ рдкрдВрдЬрд╛ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдкрдВрдЬрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдмрд╛рдХреА рдХреЛ рдзрдХреНрдХрд╛ рджреЗрддрд╛ рд╣реИ: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3f4rRbqnuxg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  рдпрд╣рд╛рдВ, рдПрдЬреЗрдВрдЯ рдЬрдВрдк рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рдЖрдпрд╛ рдерд╛, рд▓реЗрдХрд┐рди рдмрд╕ рдЕрдВрдЧреЛрдВ рдХреЗ рд╕рд╛рде рдЬрд▓реНрджреА рд╕реЗ рдКрдБрдЧрд▓реА рдХрд░ рд░рд╣рд╛ рдерд╛ред  рдФрд░ рдЖрдк рдпрд╣ рднреА рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рд╡рд╣ рдХреИрд╕рд╛ рдмрд░реНрддрд╛рд╡ рдХрд░рддрд╛ рд╣реИ, рдЕрдЧрд░ рд╡рд╣ рд╣рд┐рдЪрдХрд┐рдЪрд╛рддрд╛ рд╣реИ, рддреЛ рд╡рд╣ рдЪрд╛рд░реЛрдВ рдУрд░ рдШреВрдореЗрдЧрд╛ рдФрд░ рджреМрдбрд╝рддрд╛ рд░рд╣реЗрдЧрд╛: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/O5aJoj16ZDM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдПрдЬреЗрдВрдЯ, рд╡рд╣ рд▓реЗрдЦ рдХреЗ рдмрд╣реБрдд рд╢реБрд░реБрдЖрдд рдореЗрдВ рд╣реИред  рд╕реНрдерд┐рд░ рдХреВрдж, рдЬрд┐рд╕рдХреЗ рджреМрд░рд╛рди рд╕рднреА рдЕрдВрдЧ рд╕рддрд╣ рд╕реЗ рдмрд╛рд╣рд░ рдЖрддреЗ рд╣реИрдВред  рд╕рдВрддреБрд▓рди рдХреА рд╡рд┐рдХрд╕рд┐рдд рдХреНрд╖рдорддрд╛ рдПрдЬреЗрдВрдЯ рдХреЛ рддреНрд░реБрдЯрд┐ рд╣реЛрдиреЗ рдкрд░ рдкреВрд░реНрдг рдЧрддрд┐ рд╕реЗ рдкреНрд░рдХреНрд╖реЗрдкрд╡рдХреНрд░ рдХреЛ рд╕рд╣реА рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ: </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xT9KKnpxxo8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="pitfalls"></a><h2>  рдиреБрдХрд╕рд╛рди </h2><br><p>  рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЗ рд╕реНрдерд╛рди рдХреЗ рдЖрдпрд╛рдо рдХреЗ рд▓рд┐рдП рдкреНрд░рд╕рд┐рджреНрдз рд╣реИ рдЬрд┐рд╕реЗ рдмрдирд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЧреИрд░-рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЖрд░рдПрд▓ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдПрдХ рдирдП рд╕реНрддрд░ рдкрд░ рд▓реЗ рдЬрд╛рддрд╛ рд╣реИред </p><br><img src="https://habrastorage.org/webt/rq/w0/fl/rqw0flwtyhb3getoyjwyraaf7na.png"><br><p>  <a href="http://ai.stanford.edu/~zayd/why-is-machine-learning-hard.html"><i>рд╕реНрд░реЛрдд</i></a> </p><br><p>  рдпрд╣рд╛рдВ рд╡рд┐рдХрд╛рд╕ рдХреЗ рджреМрд░рд╛рди рдЖрдиреЗ рд╡рд╛рд▓реА рдХрдард┐рдирд╛рдЗрдпреЛрдВ рдХрд╛ рд╕рд╛рдордирд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </p><br><ol><li>  рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╣рд╛рдЗрдкрд░рдкрд░рдореЗрдЯрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдЖрд╢реНрдЪрд░реНрдпрдЬрдирдХ рд░реВрдк рд╕реЗ рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рд╣реИред  3e-4 рд╕реЗ 1e-4 рдореЗрдВ рд╕реАрдЦрдиреЗ рдХреА рджрд░ рдХреЛ рдмрджрд▓рддреЗ рд╕рдордп рд╕реАрдЦрдиреЗ рдХреА рдЧреБрдгрд╡рддреНрддрд╛ рдореЗрдВ рдмрджрд▓рд╛рд╡ рдЖрдпрд╛ред  рдФрд░ рддрд╕реНрд╡реАрд░ рдореМрд▓рд┐рдХ рд░реВрдк рд╕реЗ рдмрджрд▓ рдЧрдИ - рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЧреИрд░-рдЕрднрд┐рд╕рд░рдг рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╕реЗ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдЬреЛ рд╡реАрдбрд┐рдпреЛ рдореЗрдВ рд╣реИред </li><li>  рдмреИрдЪ рдХрд╛ рдЖрдХрд╛рд░ рдбреАрдПрд▓ рдХреЗ рдЕрдиреНрдп рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рд╕рдорд╛рди рдирд╣реАрдВ рд╣реИред  рдпрджрд┐ рдЫрд╡рд┐ рд╡рд░реНрдЧреАрдХрд░рдг рдореЗрдВ рдЖрдк рдЕрдкрдиреЗ рдЖрдк рдХреЛ 32-256 рдмреИрдЪ рдХреЗ рдЖрдХрд╛рд░ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдкрд░рд┐рдгрд╛рдо рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЗрд╕реЗ рдмрдврд╝рд╛рдиреЗ рд╕реЗ рдирд╣реАрдВ рдмрджрд▓реЗрдЧрд╛, рддреЛ рд╣рдорд╛рд░реЗ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╣рдЬрд╛рд░, 3000 рдХрд╛рдо рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрдЧрд╛ред рдФрд░ рдлрд┐рд░ рд╕реЗ рдПрдХ рдЕрдЪреНрдЫрд╛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдореЗрдВ рдЕрднрд┐рд╕рд░рдг рдХреА рдХрдореА рд╕реЗред </li><li>  рд╕реАрдЦрдирд╛ рдХрдИ рдмрд╛рд░ рдЪрд▓рд╛рдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрддрд╛ рд╣реИ, рдХрднреА-рдХрднреА рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдмреАрдЬ рднрд╛рдЧреНрдпрд╢рд╛рд▓реА рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИред </li><li>  рдРрд╕реЗ рдЬрдЯрд┐рд▓ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рд╕реАрдЦрдирд╛ рдмрд╣реБрдд рд╕рдордп рд▓реЗрддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рдЧрддрд┐ рдПрдХ рд╕рдорд╛рди рдирд╣реАрдВ рд╣реЛрддреА рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, 8 рдШрдВрдЯреЗ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╕реАрдЦрд╛, рдЬрд┐рдирдореЗрдВ рд╕реЗ 3 рдиреЗ рдпрд╛рджреГрдЪреНрдЫрд┐рдХ рдЖрдзрд╛рд░ рд░реЗрдЦрд╛ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЦрд░рд╛рдм рдкрд░рд┐рдгрд╛рдо рджрд┐рдЦрд╛рдпрд╛ред  рдЗрд╕рд▓рд┐рдП, рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рддреЗ рд╕рдордп, рдПрдХ рдЫреЛрдЯреЗ рд╕реЗ рд╢реБрд░реВ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реЛрддрд╛ рд╣реИ, рдЬреИрд╕реЗ рдЬрд┐рдо рд╕реЗ рдЦрд┐рд▓реМрдирд╛ рд╡рд╛рддрд╛рд╡рд░рдгред <img src="https://habrastorage.org/webt/ol/ml/yx/olmlyxvpvt8lroty8kllva2igz4.png"></li><li>  рд╣рд╛рдЗрдкрд░рдкрд░рдореЗрдЯрд░реНрд╕ рдФрд░ рдореЙрдбрд▓ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдЦреЛрдЬрдиреЗ рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рддрд░реАрдХрд╛ рд╕рдВрдмрдВрдзрд┐рдд рд▓реЗрдЦреЛрдВ рдФрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░ рдЭрд╛рдВрдХрдирд╛ рд╣реЛрдЧрд╛ред  (рдореБрдЦреНрдп рдмрд╛рдд рдпрд╣ рд╣реИ рдХрд┐ рдкреАрдЫреЗ рд╣рдЯрдирд╛ рдирд╣реАрдВ рд╣реИ) </li></ol><br><p>  рдЖрдк рдЗрд╕ рд▓реЗрдЦ рд╕реЗ рдбреАрдк рдЖрд░рдПрд▓ рдХреА рдмрд╛рд░реАрдХрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВ: <a href="https://www.alexirpan.com/2018/02/14/rl-hard.html">рдбреАрдк рд░рд┐рдирдлреЛрд░реНрд╕ рд▓рд░реНрдирд┐рдВрдЧ рдЗрдЬрд╝ рдиреЙрдЯ рд╡рд░реНрдХ</a> ред </p><br><a name="conclusion"></a><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><p>  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИред  рдлрдВрдХреНрд╢рди рдорд┐рд▓рд╛ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1483"><span class="MJXp-mtext" id="MJXp-Span-1484">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1485">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">i</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-1488">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1491" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1492">800</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1493">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">o</span><span class="MJXp-mtext" id="MJXp-Span-1496">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498" style="margin-right: 0.05em;">R</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1499" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1500">18</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> \ pi: \ R ^ {800} \ to \ R ^ {18} </script>  , рд╕рдВрдпрдд рдФрд░ рдЖрддреНрдорд╡рд┐рд╢реНрд╡рд╛рд╕ рд╕реЗ рд░реЛрдмреЛрдЯ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдПрдХ рддрд╛рд░реНрдХрд┐рдХ рдирд┐рд░рдВрддрд░рддрд╛ A2C, PPO рдФрд░ TRPO рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреЗ рдХрд░реАрдмреА рд░рд┐рд╢реНрддреЗрджрд╛рд░реЛрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рд╣реЛрдЧрд╛ред  рд╡реЗ <b>рдирдореВрдирд╛ рджрдХреНрд╖рддрд╛ рдореЗрдВ</b> рд╕реБрдзрд╛рд░ рдХрд░рддреЗ рд╣реИрдВ, рдЕрд░реНрдерд╛рддреНред  рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдЕрднрд┐рд╕рд░рдг рд╕рдордп, рдФрд░ рд╡реЗ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИрдВред  рдпрд╣ рдкреАрдкреАрдУ + рдСрдЯреЛрдореИрдЯрд┐рдХ рдбреЛрдореЗрди рд░реЗрдВрдбрдорд╛рдЗрдЬреЗрд╢рди рдерд╛ рдЬрд┐рд╕рдиреЗ рд╣рд╛рд▓ рд╣реА рдореЗрдВ <a href="https://openai.com/blog/solving-rubiks-cube/">рдПрдХ рд░реЛрдмреЛрдЯ рдкрд░ рд░реВрдмрд┐рдХ рдХреНрдпреВрдм рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд┐рдпрд╛</a> ред </p><br><p>  рдпрд╣рд╛рдВ рдЖрдк рд▓реЗрдЦ рд╕реЗ рдХреЛрдб рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ: <a href="https://github.com/LeonidMurashov/advantage-actor-critic-gae">рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА</a> ред </p><br><p>  рдореБрдЭреЗ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдЖрдкрдХреЛ рдпрд╣ рд▓реЗрдЦ рдЕрдЪреНрдЫрд╛ рд▓рдЧрд╛ рд╣реЛрдЧрд╛ рдФрд░ рдЗрд╕рд╕реЗ рдкреНрд░реЗрд░рд┐рдд рдереЗ рдХрд┐ рдЖрдЬ рдбреАрдк рд░реЗрдирдлреЛрд░реНрд╕ рд▓рд░реНрдирд┐рдВрдЧ рдХреНрдпрд╛ рдХрд░ рд╕рдХрддрд╛ рд╣реИ </p><br><p>  <b>рдЖрдкрдХрд╛ рдзреНрдпрд╛рди рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж!</b> </p><br><h2>  рдЙрдкрдпреЛрдЧреА рд▓рд┐рдВрдХ: </h2><br><ul><li>  <a href="https://spinningup.openai.com/en/latest/index.html">рджреАрдк рдЖрд░рдПрд▓ рдореЗрдВ рдХрддрд╛рдИ рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ!</a> </li><li>  <a href="http://rail.eecs.berkeley.edu/deeprlcourse-fa17/index.html">рд╕реАрдПрд╕ 294: рдбреАрдк рд░рд┐рдирдлреЛрд░реНрд╕ рд▓рд░реНрдирд┐рдВрдЧ, рдлреЙрд▓ 2017</a> </li><li>  <a href="http://rail.eecs.berkeley.edu/deeprlcourse/">рд╕реАрдПрд╕ 285: рдбреАрдк рд░рд┐рдирдлреЛрд░реНрд╕рдореЗрдВрдЯ рд▓рд░реНрдирд┐рдВрдЧ, рдбрд┐рд╕реАрдЬрди рдореЗрдХрд┐рдВрдЧ рдПрдВрдб рдХрдВрдЯреНрд░реЛрд▓</a> </li><li>  <a href="https://arxiv.org/pdf/1506.02438.pdf">рд╕рд╛рдорд╛рдиреНрдпреАрдХреГрдд рд▓рд╛рдн рдПрд╕реНрдЯрд┐рдореЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП рдЙрдЪреНрдЪ-рдЖрдпрд╛рдореА рдирд┐рд░рдВрддрд░ рдирд┐рдпрдВрддреНрд░рдг</a> </li><li>  <a href="https://github.com/openai/baselines/">OpenAI рдмреЗрд╕рд▓рд╛рдЗрди: рд╕реБрджреГрдвреАрдХрд░рдг рд╕реАрдЦрдиреЗ рдХреЗ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдХреА рдЙрдЪреНрдЪ рдЧреБрдгрд╡рддреНрддрд╛ рд╡рд╛рд▓реЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</a> </li></ul><br><p>  <i>рдЗрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ рдорджрдж рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://habr.com/ru/users/pinkotter/" class="user_link">рдкрд┐рдВрдХреЛрдЯреНрдЯрд░</a> , <a href="https://habr.com/ru/users/vambala/" class="user_link">рд╡рд╛рдордмрд╛рд▓рд╛</a> , <a href="https://habr.com/ru/users/andrey_probochkin/" class="user_link">рдПрдВрдбреНрд░реА_рдкреНрд░реЛрдмреЛрдЪреНрдХрд┐рди</a> , <a href="https://habr.com/ru/users/pollyfom/" class="user_link">рдкреЙрд▓реАрдлреЙрдо</a> рдФрд░ <a href="https://habr.com/ru/users/suriknik/" class="user_link">рд╕реБрд░рд┐рдХрдирд┐рдХ</a> рдХреЛ рдзрдиреНрдпрд╡рд╛рджред</i> <br>  <i>рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, <a href="https://habr.com/ru/users/vambala/" class="user_link">рд╡рдореНрдмрд╛рд▓рд╛</a> рдФрд░ <a href="https://habr.com/ru/users/andrey_probochkin/" class="user_link">andrey_probochkin рдХреЗ</a> рд▓рд┐рдП рдПрдХ рд╢рд╛рдВрдд MuJoCo рд╡рд╛рддрд╛рд╡рд░рдг рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдПред</i> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi483078/">https://habr.com/ru/post/hi483078/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi483064/index.html">рд╕рднреА рдХреИрдирди рдкрд░ рд╕рдмрд╕реЗ рдЫреЛрдЯреЗ рдЙрд░реНрдл тАЛтАЛрдЫреЛрдЯреЗ рдмреНрд▓реЙрдЧ рдХреЗ рд▓рд┐рдП Vue</a></li>
<li><a href="../hi483066/index.html">рдмрд┐рд▓ рдЧреЗрдЯреНрд╕ рдХреА рдкрд╛рд░рдВрдкрд░рд┐рдХ 5 рдкреБрд╕реНрддрдХреЗрдВ</a></li>
<li><a href="../hi483068/index.html">рд▓реЛрдХрдкреНрд░рд┐рдп рд╡рд┐рд░реЛрдзреА рдзреЛрдЦрд╛ рдмреИрдЯрд▓рдИ рдХреА рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ</a></li>
<li><a href="../hi483074/index.html">TensorRT 6.xxx - рдбреАрдк рд▓рд░реНрдирд┐рдВрдЧ рдореЙрдбрд▓ (рдСрдмреНрдЬреЗрдХреНрдЯ рдбрд┐рдЯреЗрдХреНрд╢рди рдФрд░ рд╕реЗрдЧрдореЗрдВрдЯреЗрд╢рди) рдХреЗ рд▓рд┐рдП рдЙрдЪреНрдЪ рдкреНрд░рджрд░реНрд╢рди</a></li>
<li><a href="../hi483076/index.html">2020 рдореЗрдВ рдПрдВрдбреНрд░реЙрдЗрдб рдРрдк рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП рд╢реАрд░реНрд╖ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рднрд╛рд╖рд╛рдПрдВ</a></li>
<li><a href="../hi483082/index.html">рднреЗрджреНрдпрддрд╛ рд╢рд┐рдХрд╛рд░ 7% рдЕрдзрд┐рдХ рдкреНрд░рднрд╛рд╡реА рд╣реИ</a></li>
<li><a href="../hi483084/index.html">рдЯреНрд░реИрдХрд┐рдВрдЧ рдлрдВрдХреНрд╢рди рд╡рд╛рд▓рд╛ рдХреИрдорд░рд╛</a></li>
<li><a href="../hi483086/index.html">2019 рдХреЗ рдкрд░рд┐рдгрд╛рдо: рд░реВрд╕реА рдирд┐рд╡реЗрд╢рдХреЛрдВ рдХреЗ рд▓рд┐рдП рдХреМрди рд╕реА рд╕рдВрдкрддреНрддрд┐ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд▓рд╛рднрджрд╛рдпрдХ рд░рд╣реА</a></li>
<li><a href="../hi483094/index.html">рдЬрдм рдореИрдВрдиреЗ Microsoft рдХреЗ рд░реВрд╕реА рдХрд╛рд░реНрдпрд╛рд▓рдп рдХрд╛ рджреМрд░рд╛ рдХрд┐рдпрд╛ рддреЛ рдореИрдВрдиреЗ рдЕрдкрдиреЗ рд╕рдкрдиреЗ рдХреЛ рдХреИрд╕реЗ рд╕рд╛рдХрд╛рд░ рдХрд┐рдпрд╛</a></li>
<li><a href="../hi483110/index.html">рд░реЛрд╕реНрддреЛрд╡-рдСрди-рдбреЙрди: рдЖрдИрдЯреА рдХрдВрдкрдирд┐рдпреЛрдВ, рд╕рдореБрджрд╛рдпреЛрдВ рдФрд░ 2019 рдореЗрдВ рдШрдЯрдирд╛рдУрдВ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>