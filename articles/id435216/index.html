<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ß üëåüèæ üëµüèΩ Cara membuat 200 dari dua baris kode, dan mengapa Anda perlu melakukan ini üë®üèø‚Äçüîß ‚õàÔ∏è üßëüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo semuanya. 


 Saya (kami, sebagai perusahaan) menyelesaikan platform dari pemasok, platform adalah plugin untuk WordPress. Saya kenal dengan fron...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara membuat 200 dari dua baris kode, dan mengapa Anda perlu melakukan ini</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435216/"><p>  Halo semuanya. </p><br><p>  Saya (kami, sebagai perusahaan) menyelesaikan platform dari pemasok, platform adalah plugin untuk WordPress.  Saya kenal dengan frontend, JS, HTML hanya sejauh, oleh karena itu, <strong>solusi di atas mungkin tidak terpelajar, tetapi esensi dari artikel ini bukan itu</strong> . </p><br><p>  Intinya adalah untuk menunjukkan dengan jelas mengapa kadang-kadang alih-alih dua baris kode, itu adalah keputusan yang tepat untuk menulis dua ratus. </p><br><p>  Pengembang awal, dan pengembang dengan pengalaman yang pemikiran seperti itu tampaknya diragukan, saya bertanya di bawah kucing. </p><a name="habracut"></a><br><h2 id="vvedenie">  Pendahuluan </h2><br><p>  Membaca artikel tanpa membaca komentar dalam kode tidak masuk akal, karena komentar dalam kode tidak digandakan dalam teks artikel dan teks artikel menyiratkan bahwa pembaca telah membaca komentar. </p><br><h2 id="zadacha">  Tantangan </h2><br><p>  Itu perlu untuk membuat perubahan pada JS, saya membuat perubahan dalam file terpisah, sehingga sesedikit mungkin "mencemari" kode sumber penyedia platform, sehingga di masa depan akan lebih mudah untuk mengadaptasi pembaruan dari sumber platform. </p><br><p>  Dengan demikian, kode fungsi baru ada di file baru yang perlu dimuat di halaman. </p><br><p> Tugas: diperlukan untuk memuat file tertentu saat memuat halaman. </p><br><h2 id="pervyy-blin-komom">  Pancake pertama kental </h2><br><pre><code class="xml hljs">+<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"e-cryptex.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> +<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wp-content/themes/tol-child/js/child_realforex.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  (baris dengan "+" adalah baris baru dalam kode sumber) </p><br><p>  Solusinya diuji untuk halaman utama dan berfungsi di sana, kemudian ternyata untuk halaman dengan alamat example.com/about, solusinya tidak berfungsi, karena browser sedang mencoba memuat example.com/about/e-cryptex.js dan browser menerima kesalahan 404 , karena file tersebut benar-benar di root - example.com/e-cryptex.js. </p><br><h2 id="vtoroy-variant">  Opsi kedua </h2><br><p>  Saya melihat bagaimana pengembang platform menempel pada halaman: </p><br><pre> <code class="php hljs">wp_register_script(FILE-ID,FILE-PATH); wp_enqueue_script(FILE-ID);</code> </pre> <br><p>  File dilampirkan menggunakan fungsionalitas WordPress - ok, mari kita lakukan hal yang sama: </p><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// : -&lt;script src="e-cryptex.js"&gt;&lt;/script&gt; -&lt;script src="wp-content/themes/tol-child/js/child_realforex.js"&gt;&lt;/script&gt; //  : +</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">&lt;?php</span></span></span><span class="hljs-comment"> +const E_CRYPTEX_JS ='e-cryptex_js'; +wp_register_script(E_CRYPTEX_JS,'/e-cryptex.js',array(),null); +wp_enqueue_script(E_CRYPTEX_JS); +const CHILD_REALFOREX_JS = 'child_realforex_js'; +wp_register_script( + CHILD_REALFOREX_JS, + '/wp-content/themes/tol-child/js/child_realforex.js', + array(E_CRYPTEX_JS), + null); +wp_enqueue_script(CHILD_REALFOREX_JS); +</span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br><p>  (baris dengan "+" adalah baris baru dalam kode sumber, baris dengan "-" adalah baris yang dihapus dari kode sumber). </p><br><p>  Diperiksa - berfungsi, kira-kira. </p><br><p>  Ada dua baris - menjadi 12, semua dalam file yang sama. </p><br><h2 id="refaktoring">  Refactoring </h2><br><p>  Saya melihat kode ini, dan indera kecantikan saya memberontak: </p><br><ul><li>  seseorang yang tidak terbiasa dengan WordPress tidak akan mengerti apa pun - Anda harus masuk ke direktori untuk memahami tujuan fungsi wp_register_script () dan wp_enqueue_script () </li><li>  jelas hal yang sama dilakukan dua kali berturut-turut, argumennya hanya berbeda - KERING dilanggar </li></ul><br><p>  Ok, refactor. </p><br><p>  Pertama, kami membuat kelas (satu file), dan kedua, kami menghubungkan dan menggunakan kelas (kami mengubah file lain). </p><br><h3 id="delaem-klass">  Buat kelas </h3><br><pre> <code class="php hljs">+<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Migesco</span></span></span><span class="hljs-class"> </span></span>{ + + <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SCRIPT = <span class="hljs-string"><span class="hljs-string">'script'</span></span>; + <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SOURCE = <span class="hljs-string"><span class="hljs-string">'source'</span></span>; + <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DEPENDENCY = <span class="hljs-string"><span class="hljs-string">'dependency'</span></span>; + <span class="hljs-comment"><span class="hljs-comment">//   ,      'configuration.js', //     ""   . + static function attachConfigurationJS(){ + $configurationFiles = array( + array(Migesco::SCRIPT =&gt; 'configuration.js', + Migesco::SOURCE=&gt;'/configuration.js')); + Migesco::includeScriptFiles($configurationFiles); + } //              + static function includeScriptFiles($scriptFiles){ + foreach ($scriptFiles as $scriptFile){ + $dependency = array_key_exists(self::DEPENDENCY,$scriptFiles) + ? $scriptFile[self::DEPENDENCY] + : array(); + self::includeScript($scriptFile[self::SCRIPT],$scriptFile[self::SOURCE],$dependency); + } + } //    , //    "",     // (     ) + static function includeScript($id,$source,$dependency){ + wp_register_script($id,$source,$dependency,null); + wp_enqueue_script($id); + } +}</span></span></code> </pre> <br><h3 id="podklyuchaem-i-ispolzuem">  Kami terhubung dan menggunakan </h3><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">//: -const E_CRYPTEX_JS ='e-cryptex_js'; -wp_register_script(E_CRYPTEX_JS,'/e-cryptex.js',array(),null); -wp_enqueue_script(E_CRYPTEX_JS); -const CHILD_REALFOREX_JS = 'child_realforex_js'; -wp_register_script( - CHILD_REALFOREX_JS, - '/wp-content/themes/tol-child/js/child_realforex.js', - array(E_CRYPTEX_JS), - null); -wp_enqueue_script(CHILD_REALFOREX_JS); // : //  +require_once(ABSPATH . 'configuration.php'); //  +const ECRYPTEX_JS = 'cryptex'; +const TRADEROOM_SCRIPT_FILES = array( + array(Migesco::SCRIPT =&gt; ECRYPTEX_JS, + Migesco::SOURCE=&gt;'/e-cryptex.js'), + array(Migesco::SCRIPT =&gt; 'child_realforex', + Migesco::SOURCE=&gt;'/wp-content/themes/tol-child/js/child_realforex.js', + Migesco::DEPENDENCY =&gt;ECRYPTEX_JS) +); +Migesco::includeScriptFiles(TRADEROOM_SCRIPT_FILES); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br><p>  Ada 12 baris kode sumber dalam satu file, ada 35, dan di dua (mendukungnya nanti, cari batang di mana lagi untuk memperbaikinya, agar tidak melupakan apa pun, tidak ketinggalan, tidak ketinggalan). </p><br><h2 id="i-eschyo-raz-refaktring">  Dan refactoring lagi </h2><br><p>  Melihat kode baru: </p><br><ul><li>  beberapa metode statis </li><li>  beberapa konstanta ... </li></ul><br><p>  terlihat canggung!  Saya ingat saran berikut: "jika konstruktor tidak memiliki argumen, apakah kelas seperti itu diperlukan?" </p><br><p>  Mari kita membuat ulang, tetapi kelas normal, dengan konstruktor dan metode normal. </p><br><h3 id="klass">  Kelas </h3><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// : -class Migesco { - - const SCRIPT = 'script'; - const SOURCE = 'source'; - const DEPENDENCY = 'dependency'; - - static function attachConfigurationJS(){ - $configurationFiles = array( - array(Migesco::SCRIPT =&gt; 'configuration.js', - Migesco::SOURCE=&gt;'/configuration.js')); - Migesco::includeScriptFiles($configurationFiles); - } - static function includeScriptFiles($scriptFiles){ - foreach ($scriptFiles as $scriptFile){ - $dependency = array_key_exists(self::DEPENDENCY,$scriptFiles) - ? $scriptFile[self::DEPENDENCY] - : array(); - self::includeScript($scriptFile[self::SCRIPT],$scriptFile[self::SOURCE],$dependency); - } - } - static function includeScript($id,$source,$dependency){ - wp_register_script($id,$source,$dependency,null); - wp_enqueue_script($id); - } -} //: //      : //   //   //    //       +namespace Migesco; + + //      html- +class Configurator +{ //               + static function attachConfigurationJS() + { + $configurationFiles = array( + (new WebResource('configuration.js'))-&gt;setSource('/configuration.js')); + self::attachFiles($configurationFiles); + } + //      html- + static function attachFiles($resourceList) + { + (new Registrar($resourceList))-&gt;toRegistrate(); + } +} + //      html- +class Registrar +{ //     + public $list = array(); //     private (   ) + /** @var WebResource $resource */ + public $resource = null; + + public function __construct($list) + { + $isArray = is_array($list); + if ($isArray) { + $this-&gt;list = $list; + } + } + //      WordPress + function registerScript() + { + wp_register_script( + $this-&gt;resource-&gt;getName(), + $this-&gt;resource-&gt;getSource(), + $this-&gt;resource-&gt;getDependency(), + null); + } + //     + function enqueueScript() + { + wp_enqueue_script($this-&gt;resource-&gt;getName()); + } + //      + function toRegistrate() + { + $result = false; + foreach ($this-&gt;list as $resource) { + /** @var WebResource $resource */ + $isResource = $resource instanceof WebResource; + if ($isResource) { + $this-&gt;resource = $resource; + $this-&gt;registerScript(); + $this-&gt;enqueueScript(); + + $result = true; + } + } + return $result; + } +} + //     +class WebResource +{ //    + public $source = ''; //   + public $name = ''; //   + public $dependency = array(); + + public function __construct($name) + { + $this-&gt;setName($name); + } + + /** + * @param string $source + * @return WebResource + */ + public function setSource($source) + { + $this-&gt;source = strval($source); + return $this; + } + + /** + * @param string $name + * @return WebResource + */ + public function setName($name) + { + $this-&gt;name = strval($name); + return $this; + } + + /** + * @param array $dependency + * @return WebResource + */ + public function setDependency($dependency) + { + $isArray = is_array($dependency); + if ($isArray) { + $this-&gt;dependency = $dependency; + } + return $this; + } + + /** + * @return string + */ + public function getSource() + { + return $this-&gt;source; + } + + /** + * @return string + */ + public function getName() + { + return $this-&gt;name; + } + + /** + * @return array + */ + public function getDependency() + { + return $this-&gt;dependency; + } +}</span></span></code> </pre> <br><h3 id="ispolzovanie">  Gunakan </h3><br><pre> <code class="php hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">// : -const TRADEROOM_SCRIPT_FILES = array( - array(Migesco::SCRIPT =&gt; ECRYPTEX_JS, - Migesco::SOURCE=&gt;'/e-cryptex.js'), - array(Migesco::SCRIPT =&gt; 'child_realforex', - Migesco::SOURCE=&gt;'/wp-content/themes/tol-child/js/child_realforex.js', - Migesco::DEPENDENCY =&gt;ECRYPTEX_JS) -); -Migesco::includeScriptFiles(TRADEROOM_SCRIPT_FILES); // : +$traderoomScriptFiles = array( + (new Migesco\WebResource(ECRYPTEX_JS)) + -&gt;setSource('/e-cryptex.js'), + (new Migesco\WebResource('child_realforex')) + -&gt;setSource('/wp-content/themes/tol-child/js/child_realforex.js') + -&gt;setDependency(array(ECRYPTEX_JS)) +); +Migesco\Configurator::attachFiles($traderoomScriptFiles); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br><p>  Anda dapat melakukan refactoring lagi (platform berjalan pada PHP 5.6 - Saya ingin mengatur jenisnya di mana-mana, tetapi sayangnya Anda tidak bisa, Anda dapat membuat kelas statis Configurator lebih manusiawi, misalnya, menginisialisasi dari daftar file - sumber daya web dan metode attachFiles statis), tetapi hal-hal ideal untuk dunia ideal, kita hidup di dunia nyata, dan itu membuat koreksi sendiri - waktu yang dihabiskan untuk tugas tersebut - mengerjakan tugas dihentikan. </p><br><p>  Total: ada 35 baris dalam sumber dalam dua file, menjadi ~ 170, juga dalam dua file. </p><br><h2 id="chto-my-poluchili-">  Apa yang kita dapatkan? </h2><br><ol><li>  Sekarang Anda tidak perlu masuk ke bantuan WordPress untuk memahami tujuan dari parameter "fungsi". </li><li>  Sekarang kami memiliki pembungkus untuk menghubungkan file dan kami tanpa kesulitan dapat mengubah algoritma untuk menghubungkan file - kami tidak perlu mengedit semua panggilan ke wp_register_script dan wp_enqueue_script </li><li>  Sekarang kita dapat mengubah WordPress menjadi apa saja dan hanya kelas yang harus menulis ulang <br>  Registrar, tidak perlu mengganti semua panggilan wp_register_script dan wp_enqueue_script dan ikuti logika WordPress. </li></ol><br><p>  Apakah itu sepadan? </p><br><p>  Masing-masing memiliki pendekatan sendiri untuk mendukung basis kode dan pendapatnya sendiri. </p><br><p>  Jawaban saya adalah ya. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id435216/">https://habr.com/ru/post/id435216/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id435206/index.html">Eropa menyetujui arahan hak cipta - mengapa platform streaming menentang</a></li>
<li><a href="../id435208/index.html">Internet hal-hal ... yang menangis untuk UI / UX yang bagus</a></li>
<li><a href="../id435210/index.html">Pekerjaan Xamarin dengan C SDK</a></li>
<li><a href="../id435212/index.html">Bagaimana melupakan kartu nama kertas di tahun baru</a></li>
<li><a href="../id435214/index.html">Linux 4.20 dirilis - apa yang telah berubah di versi kernel baru</a></li>
<li><a href="../id435220/index.html">Kotlin Native: melacak file</a></li>
<li><a href="../id435224/index.html">Cara berkomunikasi di kantor berbahasa Inggris: 14 idiom yang bermanfaat</a></li>
<li><a href="../id435226/index.html">Kembalikan data dari awal</a></li>
<li><a href="../id435228/index.html">Kubernetes cluster untuk $ 20 per bulan</a></li>
<li><a href="../id435234/index.html">Lebih cerdas, lebih jauh, lebih tepatnya: bagaimana AI mengubah penerbangan ke ruang angkasa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>