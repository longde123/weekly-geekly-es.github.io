<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèº‚ÄçüöÄ ü§±üèΩ üí¶ Blockchain: o que devemos construir PoC? üë©üèæ‚Äçüéì üòì üé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Os olhos t√™m medo e as m√£os co√ßam! 

 Nos artigos anteriores, descobrimos as tecnologias nas quais as blockchains s√£o constru√≠das (para o que devemos ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Blockchain: o que devemos construir PoC?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466157/">  <i>Os olhos t√™m medo e as m√£os co√ßam!</i> <br><br>  Nos artigos anteriores, descobrimos as tecnologias nas quais as blockchains s√£o constru√≠das (para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">que devemos construir uma blockchain?</a> ) E os casos que podem ser implementados com a ajuda deles (para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">que devemos construir um caso?</a> ).  √â hora de trabalhar com as m√£os!  Para a implementa√ß√£o de pilotos e PoC (Prova de Conceito), eu prefiro usar nuvens, porque  eles podem ser acessados ‚Äã‚Äãde qualquer lugar do mundo e, muitas vezes, voc√™ n√£o precisa gastar muito tempo na instala√ß√£o tediosa do ambiente, porque  Existem configura√ß√µes predefinidas.  Ent√£o, vamos fazer algo simples, por exemplo, uma rede para transferir moedas entre os participantes e cham√°-lo modestamente de Citcoin.  Para isso, usaremos a nuvem IBM e o Hyperledger Fabric da blockchain universal.  Primeiro, vamos ver por que o Hyperledger Fabric √© chamado de blockchain universal. <br><br><img src="https://habrastorage.org/webt/f6/tc/q3/f6tcq3wp6dn1kaity-mtv9xkkik.png" alt="imagem"><br><a name="habracut"></a><br><h2>  Hyperledger Fabric - uma blockchain universal </h2><br>  De um modo geral, o sistema universal de informa√ß√£o √©: <br><br><ul><li>  Um conjunto de servidores e um n√∫cleo de software que executa a l√≥gica de neg√≥cios; </li><li>  Interfaces para interagir com o sistema; </li><li>  Meios para registro, autentica√ß√£o e autoriza√ß√£o de dispositivos / pessoas; </li><li>  Banco de dados armazenando dados operacionais e de arquivamento: </li></ul><br><img src="https://habrastorage.org/webt/ha/dt/cr/hadtcr9siyz1oy-ouwou9gwhyzs.png" alt="imagem"><br><br>  A vers√£o oficial do que √© o Hyperledger Fabric pode ser lida no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site</a> e, resumidamente, o Hyperledger Fabric √© uma plataforma de c√≥digo-fonte aberto que permite criar blockchains fechados e executar contratos inteligentes arbitr√°rios escritos nas linguagens de programa√ß√£o JS and Go.  Vamos dar uma olhada na arquitetura do Hyperledger Fabric em detalhes e garantir que seja um sistema universal que tenha apenas as especificidades de armazenamento e grava√ß√£o de dados.  A especificidade √© que os dados, como em todas as cadeias de bloco, s√£o armazenados em blocos que s√£o colocados na cadeia de blocos somente se os participantes alcan√ßaram consenso e ap√≥s a grava√ß√£o os dados n√£o podem ser discretamente corrigidos ou exclu√≠dos. <br><br><h2>  Arquitetura de malha Hyperledger </h2><br>  O diagrama mostra a arquitetura do Hyperledger Fabric: <br><br><img src="https://habrastorage.org/webt/lt/av/n_/ltavn_otc0ix7lspm1wqvvz2zl4.png" alt="imagem"><br><br>  <b>Organiza√ß√µes</b> - as organiza√ß√µes cont√™m pares, ou seja,  O blockchain existe devido ao apoio das organiza√ß√µes.  Diferentes organiza√ß√µes podem ser membros do mesmo canal. <br><br>  <b>Canal</b> - uma estrutura l√≥gica que une pares em grupos, ou seja,  Blockchain est√° definido.  O Hyperledger Fabric pode processar simultaneamente v√°rias blockchains com l√≥gica de neg√≥cios diferente. <br><br>  <b>O Member Services Provider (MSP)</b> √© uma CA (Autoridade de Certifica√ß√£o) para emitir identidade e atribuir fun√ß√µes.  Para criar um n√≥, voc√™ precisa interagir com o MSP. <br><br>  <b>N√≥s de mesmo n√≠vel</b> - verifique as transa√ß√µes, armazene o blockchain, execute contratos inteligentes e interaja com os aplicativos.  Os pares t√™m uma identidade (certificado digital) que emite um MSP.  Ao contr√°rio da rede Bitcoin ou Etherium, onde todos os n√≥s s√£o iguais, nos n√≥s do Hyperledger Fabric desempenham diferentes fun√ß√µes: <br><br><ul><li>  O par pode estar <b>endossando o par</b> (EP) e executar contratos inteligentes. </li><li>  <b>Confirmando ponto</b> (CP) - salve apenas dados no blockchain e atualize o ‚Äúestado mundial‚Äù. </li><li>  <b>Ponto de ancoragem</b> (AP) - se v√°rias organiza√ß√µes participam do blockchain, os pares de ancoragem s√£o usados ‚Äã‚Äãpara se comunicar entre eles.  Cada organiza√ß√£o deve ter um ou mais pares de √¢ncora.  Com a ajuda da AP, qualquer colega da organiza√ß√£o pode obter informa√ß√µes sobre todos os colegas de outras organiza√ß√µes.  O <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">protocolo de fofocas √©</a> usado para sincronizar informa√ß√µes entre pontos de acesso. </li><li>  <b>Par L√≠der</b> - se a organiza√ß√£o tiver v√°rios colegas, apenas o l√≠der receber√° blocos do servi√ßo de pedidos e os entregar√° aos outros colegas.  Um l√≠der pode ser definido estaticamente ou selecionado dinamicamente pelos colegas de uma organiza√ß√£o.  O protocolo de fofocas tamb√©m √© usado para sincronizar as informa√ß√µes do l√≠der. </li></ul><br>  <b>Ativos</b> s√£o entidades de valor que s√£o armazenadas na blockchain.  Mais especificamente, esses s√£o dados de valor-chave no formato JSON.  S√£o esses dados que s√£o registrados no Blockchain.  Eles t√™m uma hist√≥ria que √© armazenada no blockchain e o estado atual, que √© armazenado no banco de dados de estado mundial.  As estruturas de dados s√£o preenchidas aleatoriamente, dependendo das tarefas de neg√≥cios.  N√£o h√° campos obrigat√≥rios, a √∫nica recomenda√ß√£o √© que os ativos tenham um propriet√°rio e sejam valiosos. <br><br>  <b>Raz√£o</b> - consiste no blockchain "Blockchain" e no banco de dados "Word state", que armazena o estado atual dos ativos.  O estado mundial usa LevelDB ou CouchDB. <br><br>  <b>Contrato inteligente</b> - usando contratos inteligentes, a l√≥gica de neg√≥cios do sistema √© implementada.  No Hyperledger Fabric, contratos inteligentes s√£o chamados chaincode.  Com a ajuda do c√≥digo de c√≥digo, ativos e transa√ß√µes sobre eles s√£o definidos.  Falando em linguagem t√©cnica, contratos inteligentes s√£o m√≥dulos de software implementados nas linguagens de programa√ß√£o JS ou Go. <br><br>  <b>Pol√≠tica de endosso</b> - para cada c√≥digo de c√≥digo, voc√™ pode especificar quantas pol√≠ticas e de quem deseja esperar confirma√ß√µes para a transa√ß√£o.  Se a pol√≠tica n√£o for definida, ser√° usada por padr√£o: "a transa√ß√£o deve ser confirmada por qualquer membro de qualquer organiza√ß√£o no canal".  Exemplos de pol√≠ticas: <br><br><ul><li>  Qualquer administrador da organiza√ß√£o deve confirmar a transa√ß√£o; </li><li>  Qualquer membro ou cliente da organiza√ß√£o deve confirmar; </li><li>  Deve confirmar qualquer organiza√ß√£o de pares. </li></ul><br>  <b>Servi√ßo de pedidos</b> - empacota transa√ß√µes em blocos e envia pares ao canal.  Garante a entrega de mensagens a todos os colegas da rede.  Para sistemas industriais, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">intermedi√°rio de mensagens Kafka √©</a> usado para desenvolver e testar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Solo</a> . <br><br><h2>  Callflow </h2><br><img src="https://habrastorage.org/webt/we/9m/wt/we9mwttlva0u7k0-zv2r6998rss.png" alt="imagem"><br><br><ul><li>  O aplicativo interage com o Hyperledger Fabric usando o Go, Node.js ou Java SDK; </li><li>  O cliente cria uma transa√ß√£o tx e a envia para endossar pares; </li><li>  O par verifica a assinatura do cliente, conclui a transa√ß√£o e envia a assinatura de endosso de volta ao cliente.  O Chaincode √© executado apenas no ponto de endosso e o resultado de sua execu√ß√£o √© enviado a todos os pontos.  Esse algoritmo de trabalho √© chamado de consenso em PBFT (Practical Byzantine Fault Tolerant).  Difere da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BFT cl√°ssica</a> , pois a mensagem √© enviada e a confirma√ß√£o n√£o √© esperada de todos os participantes, mas apenas de um conjunto espec√≠fico; </li><li>  Depois que o cliente recebe o n√∫mero de respostas correspondentes √† pol√≠tica de endosso, envia a transa√ß√£o ao servi√ßo de pedidos; </li><li>  O servi√ßo de pedidos forma um bloco e o envia a todos os pares comprometedores.  O servi√ßo de pedidos fornece grava√ß√£o sequencial de blocos, o que exclui o chamado garfo de contabilidade ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">consulte a se√ß√£o "Garfos"</a> ); </li><li>  Os pares recebem um bloco, verifique a pol√≠tica de endosso novamente, escreva o bloco na blockchain e altere o estado no banco de dados "World state". </li></ul><br>  I.e.  acontece a separa√ß√£o de fun√ß√µes entre os n√≥s.  Isso fornece escalabilidade e seguran√ßa de blockchain: <br><br><ul><li>  Os contratos inteligentes (c√≥digo de conduta) executam o endosso de pares.  Isso garante a confidencialidade dos contratos inteligentes, como  Ele n√£o √© armazenado por todos os participantes, mas apenas pelo endosso de colegas. </li><li>  A encomenda deve funcionar rapidamente.  Isso √© garantido pelo fato de que Ordering forma apenas um bloco e o envia para um conjunto fixo de pares l√≠deres. </li><li>  Os pares comprometidos armazenam apenas o blockchain - pode haver muitos deles e eles n√£o exigem muita energia e trabalho instant√¢neo. </li></ul><br>  Para obter mais informa√ß√µes sobre as solu√ß√µes arquitet√¥nicas do Hyperledger Fabric e por que funciona dessa maneira, consulte aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Origens da arquitetura</a> ou aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Hyperledger Fabric: um sistema operacional distribu√≠do para blockchains permitidos</a> . <br><br>  Portanto, o Hyperledger Fabric √© um sistema verdadeiramente universal com o qual voc√™ pode: <br><br><ul><li>  Implementar l√≥gica de neg√≥cios arbitr√°ria usando o mecanismo de contrato inteligente; </li><li>  Escreva e receba dados de um banco de dados blockchain no formato JSON; </li><li>  Forne√ßa e verifique o acesso √† API usando a Autoridade de Certifica√ß√£o. </li></ul><br>  Agora que descobrimos as especificidades do Hyperledger Fabric, vamos finalmente fazer algo √∫til! <br><br><h2>  Expand Blockchain </h2><br><h3>  Declara√ß√£o do problema </h3><br>  A tarefa √© implementar a rede Citcoin com as seguintes fun√ß√µes: criar uma conta, obter um saldo, reabastecer a conta, transferir moedas de uma conta para outra.  Vamos desenhar um modelo de objeto, que iremos implementar em um contrato inteligente.  Portanto, teremos contas identificadas por nomes e que cont√™m um saldo e uma lista de contas.  Contas e uma lista de contas s√£o em termos de ativos do Hyperledger Fabric.  Consequentemente, eles t√™m um hist√≥rico e status atual.  Vou tentar desenh√°-lo claramente: <br><br><img src="https://habrastorage.org/webt/wj/vx/uc/wjvxuc7wn8q8z8ob7efborjwfeu.png" alt="imagem"><br><br>  As figuras superiores s√£o o estado atual, armazenado no banco de dados do Estado Mundial.  Abaixo deles est√£o as figuras que mostram a hist√≥ria que √© armazenada na blockchain.  O estado atual dos ativos √© alterado pelas transa√ß√µes.  O ativo √© alterado apenas em sua totalidade, portanto, como resultado da transa√ß√£o, um novo objeto √© criado e o valor atual do ativo entra no hist√≥rico. <br><br><h3>  IBM Cloud </h3><br>  Criamos uma conta na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nuvem IBM</a> .  Para usar a plataforma blockchain, √© necess√°rio atualiz√°-la para Pay-as-you-go.  Esse processo pode n√£o ser r√°pido, porque  A IBM solicita informa√ß√µes adicionais e as verifica manualmente.  Do ponto de vista positivo, posso dizer que a IBM possui bons materiais de treinamento que permitem implantar o Hyperledger Fabric em sua nuvem.  Gostei da seguinte s√©rie de artigos e exemplos: <br><br><ul><li>  <a href="">Crie uma rede blockchain b√°sica usando a plataforma Blockchain</a> </li><li>  <a href="">Criar e executar um contrato inteligente de blockchain</a> </li><li>  <a href="">Emitir eventos da Plataforma Blockchain</a> </li></ul><br>  A seguir, s√£o capturas de tela da plataforma IBM Blockchain.  Esta n√£o √© uma instru√ß√£o para criar uma blockchain, mas simplesmente uma demonstra√ß√£o do escopo da tarefa.  Assim, para nossos prop√≥sitos, criamos uma organiza√ß√£o: <br><br><img src="https://habrastorage.org/webt/vw/gr/co/vwgrcodh-v21eslmmfe_1nkruhk.png" alt="imagem"><br><br>  Nele, criamos n√≥s: CA do ordenador, CA Org1, Par do ordenador: <br><br><img src="https://habrastorage.org/webt/f7/1x/g2/f71xg2fhmy258ihqyaunufjgas4.png" alt="imagem"><br><br>  Iniciamos usu√°rios: <br><br><img src="https://habrastorage.org/webt/1t/k5/_i/1tk5_ihjhcimki8xaeuxenwszh0.png" alt="imagem"><br><br>  Crie um canal e chame-o de citcoin: <br><br><img src="https://habrastorage.org/webt/hv/y-/av/hvy-av3p4pjrpgonz47bcj0qebq.png" alt="imagem"><br><br>  Em ess√™ncia, o Channel √© uma blockchain, ent√£o come√ßa com um bloco zero (bloco Genesis): <br><br><img src="https://habrastorage.org/webt/9x/n0/c0/9xn0c0ihpxzmytycm9olkqi6klm.png" alt="imagem"><br><br><h3>  Escrevendo um contrato inteligente </h3><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* * Citcoin smart-contract v1.5 for Hyperledger Fabric * (c) Alexey Sushkov, 2019 */</span></span> <span class="hljs-string"><span class="hljs-string">'use strict'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { Contract } = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fabric-contract-api'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> maxAccounts = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CitcoinEvents</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Contract</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> instantiate(ctx) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.info(<span class="hljs-string"><span class="hljs-string">'instantiate'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> emptyList = []; <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> ctx.stub.putState(<span class="hljs-string"><span class="hljs-string">'accounts'</span></span>, Buffer.from(<span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.stringify(emptyList))); } <span class="hljs-comment"><span class="hljs-comment">// Get all accounts async GetAccounts(ctx) { // Get account list: let accounts = '{}' let accountsData = await ctx.stub.getState('accounts'); if (accountsData) { accounts = JSON.parse(accountsData.toString()); } else { throw new Error('accounts not found'); } return accountsData.toString() } // add a account object to the blockchain state identifited by their name async AddAccount(ctx, name, balance) { // this is account data: let account = { name: name, balance: Number(balance), type: 'account', }; // create account: await ctx.stub.putState(name, Buffer.from(JSON.stringify(account))); // Add account to list: let accountsData = await ctx.stub.getState('accounts'); if (accountsData) { let accounts = JSON.parse(accountsData.toString()); if (accounts.length &lt; maxAccounts) { accounts.push(name); await ctx.stub.putState('accounts', Buffer.from(JSON.stringify(accounts))); } else { throw new Error('Max accounts number reached'); } } else { throw new Error('accounts not found'); } // return object return JSON.stringify(account); } // Sends money from Account to Account async SendFrom(ctx, fromAccount, toAccount, value) { // get Account from let fromData = await ctx.stub.getState(fromAccount); let from; if (fromData) { from = JSON.parse(fromData.toString()); if (from.type !== 'account') { throw new Error('wrong from type'); } } else { throw new Error('Accout from not found'); } // get Account to let toData = await ctx.stub.getState(toAccount); let to; if (toData) { to = JSON.parse(toData.toString()); if (to.type !== 'account') { throw new Error('wrong to type'); } } else { throw new Error('Accout to not found'); } // update the balances if ((from.balance - Number(value)) &gt;= 0 ) { from.balance -= Number(value); to.balance += Number(value); } else { throw new Error('From Account: not enought balance'); } await ctx.stub.putState(from.name, Buffer.from(JSON.stringify(from))); await ctx.stub.putState(to.name, Buffer.from(JSON.stringify(to))); // define and set Event let Event = { type: "SendFrom", from: from.name, to: to.name, balanceFrom: from.balance, balanceTo: to.balance, value: value }; await ctx.stub.setEvent('SendFrom', Buffer.from(JSON.stringify(Event))); // return to object return JSON.stringify(from); } // get the state from key async GetState(ctx, key) { let data = await ctx.stub.getState(key); let jsonData = JSON.parse(data.toString()); return JSON.stringify(jsonData); } // GetBalance async GetBalance(ctx, accountName) { let data = await ctx.stub.getState(accountName); let jsonData = JSON.parse(data.toString()); return JSON.stringify(jsonData); } // Refill own balance async RefillBalance(ctx, toAccount, value) { // get Account to let toData = await ctx.stub.getState(toAccount); let to; if (toData) { to = JSON.parse(toData.toString()); if (to.type !== 'account') { throw new Error('wrong to type'); } } else { throw new Error('Accout to not found'); } // update the balance to.balance += Number(value); await ctx.stub.putState(to.name, Buffer.from(JSON.stringify(to))); // define and set Event let Event = { type: "RefillBalance", to: to.name, balanceTo: to.balance, value: value }; await ctx.stub.setEvent('RefillBalance', Buffer.from(JSON.stringify(Event))); // return to object return JSON.stringify(from); } } module.exports = CitcoinEvents;</span></span></code> </pre> <br>  Intuitivamente, tudo deve ficar claro aqui: <br><br><ul><li>  Existem v√°rias fun√ß√µes (AddAccount, GetAccounts, SendFrom, GetBalance, RefillBalance) que o programa de demonstra√ß√£o chamar√° usando a API do Hyperledger Fabric. </li><li>  As fun√ß√µes SendFrom e RefillBalance geram eventos (Event) que o programa de demonstra√ß√£o receber√°. </li><li>  Fun√ß√£o instanciada - √© chamada uma vez durante a instancia√ß√£o de um contrato inteligente.  Na verdade, ele √© chamado n√£o uma vez, mas toda vez que uma vers√£o de um contrato inteligente √© alterada.  Portanto, inicializar a lista com uma matriz vazia √© uma m√° ideia, porque  Agora, ao alterar a vers√£o de um contrato inteligente, perderemos a lista atual.  Mas nada, estou apenas aprendendo). </li><li>  Contas e uma lista de contas (contas) s√£o estruturas de dados JSON.  Para manipula√ß√£o de dados, JS √© usado. </li><li>  Voc√™ pode obter o valor atual de um ativo chamando a fun√ß√£o getState e atualiz√°-lo usando putState. </li><li>  Ao criar uma conta, a fun√ß√£o AddAccount √© chamada, na qual √© feita uma compara√ß√£o com o n√∫mero m√°ximo de contas na blockchain (maxAccounts = 5).  E h√° um batente (notado?), O que leva a um aumento infinito no n√∫mero de contas.  Tais erros devem ser evitados) </li></ul><br>  Em seguida, fa√ßa o upload do contrato inteligente para o Channel e instale-o: <br><br><img src="https://habrastorage.org/webt/ew/3a/ok/ew3aok9gsgrcaadaor-b0xwxllg.png" alt="imagem"><br><br>  Examinamos a transa√ß√£o para instalar o Smart Contract: <br><br><img src="https://habrastorage.org/webt/om/m4/x9/omm4x9np0s1i8wjki6guvvyc46o.png" alt="imagem"><br><br>  Analisamos os detalhes sobre o nosso canal: <br><br><img src="https://habrastorage.org/webt/tj/bd/eb/tjbdebruoky86aiwhx5t7ayqljq.png" alt="imagem"><br><br>  Como resultado, obtemos o seguinte diagrama de rede blockchain na nuvem IBM.  H√° tamb√©m um programa de demonstra√ß√£o em execu√ß√£o na nuvem Amazon em um servidor virtual (consulte a pr√≥xima se√ß√£o para obter detalhes): <br><br><img src="https://habrastorage.org/webt/bx/sb/1s/bxsb1s6s0c36u_2vh0lmjqmqj9u.png" alt="imagem"><br><br><h2>  Criando uma GUI para chamadas de API do Hyperledger Fabric </h2><br>  O Hyperledger Fabric possui uma API que pode ser usada para: <br><br><ul><li>  Canal de cria√ß√µes; </li><li>  Conex√µes de pares ao canal; </li><li>  Instala√ß√£o e instancia√ß√£o de contratos inteligentes no canal; </li><li>  Chamada de transa√ß√£o; </li><li>  Solicite informa√ß√µes sobre o blockchain. </li></ul><br><h3>  Desenvolvimento de aplica√ß√µes </h3><br>  Em nosso programa de demonstra√ß√£o, usaremos a API apenas para invocar transa√ß√µes e solicitar informa√ß√µes, porque  J√° tomamos as etapas restantes usando a plataforma blockchain da IBM.  Escrevemos uma GUI usando uma pilha de tecnologia padr√£o: Express.js + Vue.js + Node.js.  Voc√™ pode escrever um artigo separado sobre como come√ßar a criar aplicativos da web modernos.  Aqui deixarei um link para a s√©rie de palestras que mais gostei: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Full Stack Web App usando Vue.js e Express.js</a> .  O resultado √© um aplicativo cliente-servidor com uma interface gr√°fica familiar no estilo de design de materiais do Google.  A API REST entre o cliente e o servidor consiste em v√°rias chamadas: <br><br><ul><li>  HyperledgerDemo / v1 / init - inicializa o blockchain; </li><li>  HyperledgerDemo / v1 / accounts / list - obtenha uma lista de todas as contas </li><li>  HyperledgerDemo / v1 / account? Name = Bob &amp; balance = 100 - crie uma conta Bob; </li><li>  HyperledgerDemo / v1 / info? Account = Bob - obt√©m informa√ß√µes sobre a conta de Bob; </li><li>  HyperledgerDemo / v1 / transaction? From = Bob &amp; para = Alice &amp; volume = 2 - transfira duas moedas de Bob para Alice; </li><li>  HyperledgerDemo / v1 /connect - feche a conex√£o com o blockchain. </li></ul><br>  Coloquei a descri√ß√£o da API com exemplos no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site do Postman</a> , um programa conhecido para testar a API HTTP. <br><br><h3>  Aplicativo de demonstra√ß√£o do Amazon Cloud </h3><br>  O aplicativo foi carregado na Amazon, porque  At√© agora, a IBM falhou ao atualizar minha conta e permitir a cria√ß√£o de servidores virtuais.  Como a cereja anexou o dom√≠nio: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.citcoin.info</a> .  Vou manter o servidor ligado por um tempo e depois deslig√°-lo, porque  os centavos de aluguel est√£o pingando e as moedas de citcoin ainda n√£o foram citadas na bolsa) Coloquei capturas de tela da demonstra√ß√£o no artigo para que a l√≥gica do trabalho seja clara.  O aplicativo de demonstra√ß√£o pode: <br><br><ul><li>  Inicialize o blockchain; </li><li>  Crie uma conta (mas agora n√£o crie uma nova conta, porque o n√∫mero m√°ximo de contas prescritas no contrato inteligente foi atingido no blockchain); </li><li>  Obtenha uma lista de contas; </li><li>  Transferir moedas de citcoin entre Alice, Bob e Alex; </li><li>  Receba eventos (mas agora n√£o h√° como mostrar eventos, portanto, para simplificar, a interface informa que os eventos n√£o s√£o suportados); </li><li>  A√ß√µes de log. </li></ul><br>  Primeiro, inicialize o blockchain: <br><br><img src="https://habrastorage.org/webt/o8/j5/te/o8j5tev3u9drgclmlfzluoys-e4.png" alt="imagem"><br><br>  Em seguida, inicie sua conta, n√£o brinque com o saldo: <br><br><img src="https://habrastorage.org/webt/e1/eo/ck/e1eockzjedclvktadadhnbsgkem.png" alt="imagem"><br><br>  Temos uma lista de todas as contas dispon√≠veis: <br><br><img src="https://habrastorage.org/webt/_0/ih/o-/_0iho-vlhsg0v6abggskdshpmow.png" alt="imagem"><br><br>  Selecionamos o remetente e o destinat√°rio, obtemos seus saldos.  Se o remetente e o destinat√°rio forem iguais, a conta ser√° reabastecida: <br><br><img src="https://habrastorage.org/webt/c7/go/vu/c7govuxmtn4wkcc_4byqz5dzgd8.png" alt="imagem"><br><br>  No log, monitoramos a execu√ß√£o das transa√ß√µes: <br><br><img src="https://habrastorage.org/webt/lw/sj/tb/lwsjtbmwe8oplpok_mg8ocvjirq.png" alt="imagem"><br><br>  Na verdade, com um programa de demonstra√ß√£o, √© tudo.  Em seguida, voc√™ pode ver nossa transa√ß√£o na blockchain: <br><br><img src="https://habrastorage.org/webt/cp/cu/ik/cpcuikr02wqi_nwht9liarcpkhk.png" alt="imagem"><br><br>  E a lista geral de transa√ß√µes: <br><br><img src="https://habrastorage.org/webt/_z/1t/ej/_z1tejxfntvmmqugqzf04plkrae.png" alt="imagem"><br><br>  Com isso, conclu√≠mos com sucesso a implementa√ß√£o do PoC para criar a rede Citcoin.  O que mais precisa ser feito para que o Citcoin se torne uma rede de transfer√™ncia de moedas completa?  S√≥ um pouco: <br><br><ul><li>  No est√°gio de cria√ß√£o de uma conta, implemente a gera√ß√£o de uma chave p√∫blica / privada.  A chave privada deve ser armazenada no usu√°rio da conta, p√∫blica na blockchain. </li><li>  Fa√ßa uma transfer√™ncia de moeda na qual uma chave p√∫blica √© usada para identificar o usu√°rio, n√£o um nome. </li><li>  Criptografe transa√ß√µes que v√£o do usu√°rio para o servidor com sua chave privada. </li></ul><br><h2>  Conclus√£o </h2><br>  Implementamos a rede Citcoin com fun√ß√µes: adicionar uma conta, obter um saldo, reabastecer sua conta, transferir moedas de uma conta para outra.  Ent√£o, quanto nos custou construir PoC? <br><br><ul><li>  Precisamos estudar blockchain em geral e Hyperledger Fabric em particular; </li><li>  Aprenda a usar as nuvens IBM ou Amazon; </li><li>  Aprenda a linguagem de programa√ß√£o JS e alguma estrutura da Web; </li><li>  Se alguns dados precisarem ser armazenados n√£o no blockchain, mas em um banco de dados separado, aprenda a integrar, por exemplo, ao PostgreSQL; </li><li>  E por √∫ltimo mas n√£o menos importante - sem o conhecimento do Linux no mundo moderno, em lugar nenhum!) </li></ul><br>  Claro, n√£o ci√™ncia de foguetes, mas voc√™ precisa suar! <br><br><h3>  Fontes do GitHub </h3><br>  Ele colocou o c√≥digo fonte no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> .  Uma breve descri√ß√£o do reposit√≥rio: <br>  Diret√≥rio " <b>servidor</b> " - servidor Node.js. <br>  Diret√≥rio " <b>cliente</b> " - cliente Node.js. <br>  O diret√≥rio " <b>blockchain</b> " (valores e chaves de par√¢metros, √© claro, s√£o inoperantes e s√£o dados apenas como exemplo): <br><br><ul><li>  contrato - fonte do contrato inteligente </li><li>  wallet - chaves de usu√°rio para usar a API do Hyperledger Fabric. </li><li>  * .cds - vers√µes compiladas de contratos inteligentes </li><li>  Arquivos * .json - arquivos de configura√ß√£o de amostra para usar a API do Hyperledger Fabric </li></ul><br>  <b><font color="#B22222">√â s√≥ o come√ßo!</font></b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466157/">https://habr.com/ru/post/pt466157/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466147/index.html">Gerenciador de exibi√ß√£o de dados reativa. 1. Introdu√ß√£o</a></li>
<li><a href="../pt466149/index.html">Criando um s√≠mbolo de conector com texto "din√¢mico" no OrCAD</a></li>
<li><a href="../pt466151/index.html">Investiga√ß√£o: programas estranhos no Registro de software dom√©stico</a></li>
<li><a href="../pt466153/index.html">Criando um documento narrativo de design de miss√£o de jogo usando o exemplo de Last of Us</a></li>
<li><a href="../pt466155/index.html">Arquitetura e recursos da grade de dados Tarantool</a></li>
<li><a href="../pt466159/index.html">Por que a velocidade √© importante em uma troca moderna e como superar os concorrentes: 3 maneiras pr√°ticas</a></li>
<li><a href="../pt466165/index.html">Como a intelig√™ncia artificial ajuda a gerenciar projetos</a></li>
<li><a href="../pt466169/index.html">Oferta especial para estudantes trabalhadores da JetBrains</a></li>
<li><a href="../pt466171/index.html">Cinco raz√µes para escolher o JUG.EKB</a></li>
<li><a href="../pt466179/index.html">fform: React & JSONSchema - flexibilidade m√°xima</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>