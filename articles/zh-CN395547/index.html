<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙌🏻 🧑🏼‍🤝‍🧑🏻 🕴🏿 Symantec / Norton Antivirus多个关键漏洞 🍸 💃🏾 🐇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="已经发布了适用于所有版本防病毒软件的有效利用程序。GPL下借用代码的事实被揭示
 
 
 昨天，来自Google Project Zero黑客的Tavis Ormandy 发布了有关Symantec防病毒程序中众多漏洞的公开信息，包括远程执行代码漏洞。
 
 一些专家说，鉴于计算机上安装的防病毒程序...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Symantec / Norton Antivirus多个关键漏洞</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/395547/"><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">已经发布了适用于所有版本防病毒软件的有效利用程序。</font><font style="vertical-align: inherit;">GPL下借用代码的事实被揭示</font></font></h3><br>
<img src="https://habrastorage.org/files/bf8/e9c/a2b/bf8e9ca2bd75423b977548077c4710b8.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
昨天，来自Google Project Zero黑客的Tavis Ormandy </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">发布了</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关Symantec防病毒程序中众多漏洞的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">公开</font></a><font style="vertical-align: inherit;">信息，包括远程执行代码漏洞。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
一些专家说，鉴于计算机上安装的防病毒程序在系统中的最大特权级别，它可能会成为附加的攻击媒介，即系统整体安全性的附加漏洞。 Symantec的示例尽可能清楚地说明了这一点。在某些情况下，在Windows下，恶意代码会直接加载到操作系统的内核中，从而导致内核内存损坏。</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symantec程序使用相同的内核，因此上述方法适用于所有Symantec程序，包括以Norton品牌出售的防病毒软件。</font><font style="vertical-align: inherit;">其中包括：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Norton Security，Norton 360和其他Norton旧产品（所有平台）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Endpoint Protection（所有版本，所有平台）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Email Security（所有平台）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection Engine（所有平台）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection for SharePoint服务器</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有其他</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
零项目的Tavis Ormandy公开了一些漏洞的示例，以便每个人都了解问题的实质。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于防病毒软件，问题在于它们如何扫描由</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">等打包程序打包的可执行文件</font><font style="vertical-align: inherit;">。要扫描此类文件，防病毒程序使用特殊的文件解压缩程序将文件恢复为原始格式。这对于标准包装工有帮助，但对于其他包装工，您必须求助于仿真。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tavis Ormandy写道，所有这些方法都不必要地复杂且极易受攻击，因为很难确保此类代码的安全性。 “我们建议使用</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">沙盒</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全开发生命周期</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">但供应商常常在这里偷工减料，” Thevis写道。</font><font style="vertical-align: inherit;">因此，拆包程序成为漏洞的巨大来源，就像</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Comodo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ESET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kaspersky</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fireeye</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">许多其他公司一样</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
对于Symantec，情况甚至更糟，因为在其程序中，</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">拆包</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">程序</font><i><font style="vertical-align: inherit;">在内核中工作</font></i><font style="vertical-align: inherit;">！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
例如，</font><font style="vertical-align: inherit;">如果</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">SizeOfRawData</font></a><font style="vertical-align: inherit;">值</font><font style="vertical-align: inherit;">大于</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">SizeOfImage</font></a><font style="vertical-align: inherit;">，则它的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASPack</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">解包程序将</font><font style="vertical-align: inherit;">允许</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">少量</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">缓冲区溢出</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">发生这种情况时，Symantec使用以下命令将“额外”字节传输到缓冲区</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"></font><code>memcpy</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">因此，我们可以使用此方法轻松地运行任意代码以在内核级别执行：</font></font><br>
<br>
<pre><code class="hljs lisp">    char *buf = malloc(<span class="hljs-name"><span class="hljs-name">SizeOfImage</span></span>)<span class="hljs-comment"><span class="hljs-comment">;</span></span><font></font>
<font></font>
    memcpy(<span class="hljs-name"><span class="hljs-name">&amp;buf</span></span>[DataSection-&gt;VirtualAddress],<font></font>
           DataSection-&gt;PointerToRawData,<font></font>
           SectionSizeOnDisk)<span class="hljs-comment"><span class="hljs-comment">;</span></span></code></pre><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bug Tracker</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
中更详细地描述了漏洞CVE-2016-2208 </font><font style="vertical-align: inherit;">。在Linux，macOS和Unix操作系统上，它会导致Symantec或Norton进程中出现干净的根级溢出，而在Windows上，它将导致内核内存损坏。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
由于Symantec使用特殊的驱动程序拦截所有系统中断，以利用此漏洞，因此只需通过电子邮件或利用漏洞的链接向受害者发送文件即可。受害者不需要打开文件或跟随链接，</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">防病毒将自行执行所有操作</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这样，即使安装了Symantec / Norton防病毒软件，该蠕虫也可以自动传播到所有系统！</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
因此，您可以轻松感染企业局域网中的大量计算机。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
奇怪的是，在公共领域发布信息之前，塔维斯·奥曼迪（Tavis Ormandy）通过电子邮件将其利用受密码保护的zip存档发送给安全部门，并且该密码在信件的正文中指出。但是安装了“安全功能”的邮件服务器赛门铁克从消息文本中提取了密码，并将其应用于归档文件，并</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">研究漏洞利用代码时使其</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">自身崩溃</font></a><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tavis Ormandy还讨论了解析PowerPoint文件和其他Microsoft Office文件中的漏洞，以及启发式引擎Bloodhound Heuristics（高级启发式保护）中的漏洞。利用</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">发布的</font></a><font style="vertical-align: inherit;">源代码</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">这是一种100％有效的利用程序，可与Norton Antivirus和Symantec Endpoint的标准配置一起使用，并且</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅在您通过邮件发送链接或在网页上发布链接时才</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">起作用</font><font style="vertical-align: inherit;">（不需要打开它）。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在这种情况下，以下产品容易受到攻击（此处未列出所有潜在易受攻击的Symantec程序，该漏洞很有可能在其他产品中也起作用）：</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">诺顿防病毒软件（Mac，Windows）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Endpoint（Mac，Windows，Linux，Unix）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Scan Engine（所有平台）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">赛门铁克云/ NAS保护引擎（所有平台）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Email Security（所有平台）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Symantec Protection for SharePoint / Exchange / Notes / etc（所有平台）</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">所有其他Symantec / Norton Carrier，Enterprise，SMB，Home和其他防病毒程序</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有其他</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
在Windows下，这会导致在具有root用户特权的其他操作系统中在SYSTEM级别执行代码。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Symantec的某些程序不会自动更新，因此系统管理员需要采取紧急措施来保护其网络。</font><font style="vertical-align: inherit;">赛门铁克的官方信息在</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这里</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
UPD </font><font style="vertical-align: inherit;">正如</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事实证明</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，赛门铁克借用开源库和libmspack unrarsrc码-并更新他们最少七年！</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN395547/">https://habr.com/ru/post/zh-CN395547/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN395537/index.html">标记它</a></li>
<li><a href="../zh-CN395539/index.html">我们使用MP8036multi模块冲泡啤酒</a></li>
<li><a href="../zh-CN395541/index.html">一部登陆欧洲和月球的太空服-应该是什么？首席最终前沿设计设计师访谈</a></li>
<li><a href="../zh-CN395543/index.html">俄罗斯建立了一个开放的近地物体基地</a></li>
<li><a href="../zh-CN395545/index.html">诺夫哥罗德考古学家发现了一个未知的古老俄罗斯诅咒</a></li>
<li><a href="../zh-CN395549/index.html">人类真的变得愚蠢吗？</a></li>
<li><a href="../zh-CN395551/index.html">区块链-新的Google</a></li>
<li><a href="../zh-CN395555/index.html">Viv是个人助理的新时代。Siri的创建者Doug Kittlaus的访谈</a></li>
<li><a href="../zh-CN395557/index.html">＃2视频滑块控制单元</a></li>
<li><a href="../zh-CN395559/index.html">莫斯科-澄清海航班延误</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>