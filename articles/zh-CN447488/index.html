<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â˜¸ï¸ ğŸ¤³ğŸ» ğŸ•‘ ä½¿ç”¨Ghidraæ‰“ç ´ç®€å•çš„è£‚ç¼-ç¬¬2éƒ¨åˆ† ğŸ‘¨ğŸ¼â€ğŸŒ¾ ğŸ âš¾ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æœ¬æ–‡çš„ç¬¬ä¸€éƒ¨åˆ†ä¸­ ï¼Œæˆ‘ä»¬ä½¿ç”¨Ghidraè‡ªåŠ¨åˆ†æäº†ä¸€ä¸ªç®€å•çš„ç ´è§£ç¨‹åºï¼ˆè¯¥ç¨‹åºæ˜¯ä»cramess.oneä¸‹è½½çš„ï¼‰ã€‚ æˆ‘ä»¬åœ¨åç¼–è¯‘å™¨æ¸…å•ä¸­æ‰¾å‡ºäº†å¦‚ä½•é‡å‘½åâ€œéš¾ä»¥ç†è§£â€çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿˜äº†è§£äº†â€œé¡¶å±‚â€ç¨‹åºçš„ç®—æ³•ï¼Œå³ è¿™æ˜¯ç”±mainï¼ˆï¼‰å®Œæˆçš„ã€‚ 

 æ­£å¦‚æˆ‘æ‰€æ‰¿è¯ºçš„é‚£æ ·ï¼Œåœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†åˆ†æ_constr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä½¿ç”¨Ghidraæ‰“ç ´ç®€å•çš„è£‚ç¼-ç¬¬2éƒ¨åˆ†</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447488/"> åœ¨æœ¬æ–‡çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬ä¸€éƒ¨åˆ†ä¸­</a> ï¼Œæˆ‘ä»¬ä½¿ç”¨Ghidraè‡ªåŠ¨åˆ†æäº†ä¸€ä¸ªç®€å•çš„ç ´è§£ç¨‹åºï¼ˆè¯¥ç¨‹åºæ˜¯ä»cramess.oneä¸‹è½½çš„ï¼‰ã€‚ æˆ‘ä»¬åœ¨åç¼–è¯‘å™¨æ¸…å•ä¸­æ‰¾å‡ºäº†å¦‚ä½•é‡å‘½åâ€œéš¾ä»¥ç†è§£â€çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿˜äº†è§£äº†â€œé¡¶å±‚â€ç¨‹åºçš„ç®—æ³•ï¼Œå³ è¿™æ˜¯ç”±<b>mainï¼ˆï¼‰</b>å®Œæˆçš„ã€‚ <br><br> æ­£å¦‚æˆ‘æ‰€æ‰¿è¯ºçš„é‚£æ ·ï¼Œåœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†åˆ†æ<strong>_construct_keyï¼ˆï¼‰</strong>å‡½æ•°ï¼Œæˆ‘ä»¬å‘ç°è¯¥å‡½æ•°è´Ÿè´£è¯»å–ä¼ è¾“åˆ°ç¨‹åºçš„äºŒè¿›åˆ¶æ–‡ä»¶å¹¶æ£€æŸ¥è¯»å–çš„æ•°æ®ã€‚ <br><a name="habracut"></a><br><h2> ç¬¬5æ­¥-_construct_keyï¼ˆï¼‰å‡½æ•°æ¦‚è¿° </h2><br> è®©æˆ‘ä»¬ç«‹å³æŸ¥çœ‹æ­¤åŠŸèƒ½çš„å®Œæ•´æ¸…å•ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ¸…å•_construct_keyï¼ˆï¼‰</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> ** __cdecl _construct_key(FILE *param_1) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iVar1; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> sVar2; uint uVar3; uint local_3c; byte local_36; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> local_35; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> local_34; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *local_30 [<span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *local_20; undefined4 local_19; undefined local_15; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **local_14; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> local_10; local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)__prepare_key(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (local_14 == (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>) { local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { local_19 = <span class="hljs-number"><span class="hljs-number">0</span></span>; local_15 = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_19,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,param_1); iVar1 = _text((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *)&amp;local_19,*(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iVar1 == <span class="hljs-number"><span class="hljs-number">0</span></span>) { _text(local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); _text(local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((*(<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>) == <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp;&amp; (*(<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(local_14[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">5</span></span>)) { local_30[<span class="hljs-number"><span class="hljs-number">0</span></span>] = *local_14; local_30[<span class="hljs-number"><span class="hljs-number">1</span></span>] = *local_14 + <span class="hljs-number"><span class="hljs-number">0x10c</span></span>; local_30[<span class="hljs-number"><span class="hljs-number">2</span></span>] = *local_14 + <span class="hljs-number"><span class="hljs-number">0x218</span></span>; local_30[<span class="hljs-number"><span class="hljs-number">3</span></span>] = *local_14 + <span class="hljs-number"><span class="hljs-number">0x324</span></span>; local_20 = *local_14 + <span class="hljs-number"><span class="hljs-number">0x430</span></span>; local_10 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (local_10 &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { local_35 = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_35,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (*local_30[local_10] != local_35) { _free_key(local_14); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } local_36 = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_36,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (local_36 == <span class="hljs-number"><span class="hljs-number">0</span></span>) { _free_key(local_14); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } *(uint *)(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>) = (uint)local_36; _text(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,*(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> *)(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>),param_1); sVar2 = _text(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (sVar2 != *(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> *)(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>)) { _free_key(local_14); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } local_3c = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_3c,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); local_3c = local_3c + <span class="hljs-number"><span class="hljs-number">7</span></span>; uVar3 = _text(param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (local_3c &lt; uVar3) { _free_key(local_14); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } *(uint *)(local_30[local_10] + <span class="hljs-number"><span class="hljs-number">0x108</span></span>) = local_3c; _text(param_1,local_3c,<span class="hljs-number"><span class="hljs-number">0</span></span>); local_10 = local_10 + <span class="hljs-number"><span class="hljs-number">1</span></span>; } local_34 = <span class="hljs-number"><span class="hljs-number">0</span></span>; _text(&amp;local_34,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (*(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> *)(*local_14 + <span class="hljs-number"><span class="hljs-number">0x53c</span></span>) == local_34) { _text(<span class="hljs-string"><span class="hljs-string">"Markers seem to still exist"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _free_key(local_14); local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _free_key(local_14); local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { _free_key(local_14); local_14 = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> local_14; }</code> </pre> <br></div></div><br> ä½¿ç”¨æ­¤å‡½æ•°ï¼Œæˆ‘ä»¬å°†ä¸ä»¥å‰ä½¿ç”¨<strong>mainï¼ˆï¼‰ä¸€æ ·è¿›è¡Œæ“ä½œ</strong> -é¦–å…ˆï¼Œæˆ‘ä»¬å°†éå†â€œéšè—çš„â€å‡½æ•°è°ƒç”¨ã€‚ ä¸å‡ºæ‰€æ–™ï¼Œæ‰€æœ‰è¿™äº›åŠŸèƒ½å‡æ¥è‡ªæ ‡å‡†Cåº“ï¼Œæˆ‘å°†ä¸å†æè¿°é‡å‘½ååŠŸèƒ½çš„è¿‡ç¨‹-å¦‚æœ‰å¿…è¦ï¼Œè¯·è¿”å›æœ¬æ–‡çš„ç¬¬ä¸€éƒ¨åˆ†ã€‚ é‡å‘½åçš„ç»“æœæ˜¯â€œå‘ç°â€äº†ä»¥ä¸‹æ ‡å‡†åŠŸèƒ½ï¼š <br><br><ul><li> ææƒ§ï¼ˆï¼‰ </li><li>  strncmpï¼ˆï¼‰ </li><li> æƒŠå‘†äº†ï¼ˆï¼‰ </li><li>  ftellï¼ˆï¼‰ </li><li>  fseekï¼ˆï¼‰ </li><li> æ”¾å…¥ï¼ˆï¼‰ </li></ul><br> æˆ‘ä»¬é€šè¿‡æ·»åŠ ç´¢å¼•2é‡å‘½åäº†ä»£ç ä¸­çš„ç›¸åº”åŒ…è£…å‡½æ•°ï¼ˆåç¼–è¯‘å™¨æ— è€»åœ°éšè—åœ¨<strong>_text</strong>åé¢çš„åŒ…è£…å‡½æ•°ï¼‰ï¼ˆè¿™æ ·å°±ä¸ä¼šä¸åŸå§‹Cå‡½æ•°æ··æ·†ï¼‰ã€‚ è¿™äº›åŠŸèƒ½å‡ ä¹å…¨éƒ¨ç”¨äºå¤„ç†æ–‡ä»¶æµã€‚ æ¯«ä¸å¥‡æ€ª-å¿«é€Ÿæµè§ˆä¸€ä¸‹ä»£ç è¶³ä»¥äº†è§£å®ƒä»æ–‡ä»¶ä¸­é¡ºåºè¯»å–æ•°æ®ï¼ˆæ–‡ä»¶çš„æè¿°ç¬¦ä½œä¸ºå”¯ä¸€å‚æ•°ä¼ é€’ç»™å‡½æ•°ï¼‰å¹¶å°†è¯»å–çš„æ•°æ®ä¸<strong>local_14</strong>å­—èŠ‚çš„æŸäº›äºŒç»´æ•°ç»„è¿›è¡Œ<strong>æ¯”è¾ƒ</strong> ã€‚ <br><br> å‡è®¾æ­¤æ•°ç»„åŒ…å«ç”¨äºå¯†é’¥éªŒè¯çš„æ•°æ®ã€‚ è°ƒç”¨å®ƒï¼Œè¯´å‡º<strong>key_array</strong> ã€‚ ç”±äºHydraä¸ä»…å…è®¸æ‚¨é‡å‘½åå‡½æ•°ï¼Œè€Œä¸”è¿˜å¯ä»¥é‡å‘½åå˜é‡ï¼Œå› æ­¤æˆ‘ä»¬å°†ä½¿ç”¨æ­¤åç§°ï¼Œå¹¶å°†éš¾ä»¥ç†è§£çš„<strong>local_14</strong>é‡å‘½åä¸ºæ›´æ˜“äºç†è§£çš„<strong>key_array</strong> ã€‚ æ­¤æ“ä½œä¸åŠŸèƒ½ç›¸åŒï¼šé€šè¿‡é¼ æ ‡å³é”®èœå•ï¼ˆ <strong>Rename local</strong> ï¼‰æˆ–é”®ç›˜ä¸Šçš„<strong>L</strong>é”®ã€‚ <br><br> å› æ­¤ï¼Œåœ¨å£°æ˜å±€éƒ¨å˜é‡ä¹‹åï¼Œç«‹å³<strong>è°ƒç”¨</strong>æŸä¸ªå‡½æ•°<strong>_prepare_keyï¼ˆï¼‰</strong> ï¼š <br><br><pre> <code class="cpp hljs">key_array = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)__prepare_key(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key_array == (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>) { key_array = (<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; }</code> </pre><br> æˆ‘ä»¬å°†è¿”å›<strong>_prepare_keyï¼ˆï¼‰</strong> ï¼Œè¿™æ˜¯è°ƒç”¨å±‚æ¬¡ç»“æ„ä¸­çš„ç¬¬ä¸‰å±‚åµŒå¥—ï¼š <strong>mainï¼ˆï¼‰-&gt; _construct_keyï¼ˆï¼‰-&gt; _prepare_keyï¼ˆï¼‰</strong> ã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬æ¥å—å®ƒåˆ›å»ºå¹¶ä»¥æŸç§æ–¹å¼åˆå§‹åŒ–æ­¤â€œæµ‹è¯•â€äºŒç»´æ•°ç»„ã€‚ å¹¶ä¸”åªæœ‰å½“è¯¥æ•°ç»„ä¸ä¸ºç©ºæ—¶ï¼Œè¯¥å‡½æ•°æ‰èƒ½ç»§ç»­å…¶å·¥ä½œï¼Œå¦‚ä¸Šè¿°æ¡ä»¶ä¹‹åç«‹å³ç”±<b>else</b>å—æ‰€è¯æ˜çš„é‚£æ ·ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œç¨‹åºä»æ–‡ä»¶ä¸­è¯»å–å‰4ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸<b>key_array</b>æ•°ç»„çš„ç›¸åº”éƒ¨åˆ†è¿›è¡Œæ¯”è¾ƒã€‚  ï¼ˆä¸‹é¢çš„ä»£ç æ˜¯é‡å‘½ååçš„ä»£ç ï¼ŒåŒ…æ‹¬<b>local_19</b>å˜é‡<b>ï¼Œ</b>æˆ‘å°†å…¶é‡å‘½åä¸º<b>first_4bytes</b> ã€‚ï¼‰ <br><br><pre> <code class="cpp hljs">first_4bytes = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*   4    */</span></span> fread2(&amp;first_4bytes,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,param_1); <span class="hljs-comment"><span class="hljs-comment">/*   key_array[1][0...3] */</span></span> iVar1 = strncmp2((<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *)&amp;first_4bytes,*(<span class="hljs-keyword"><span class="hljs-keyword">char</span></span> **)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-number"><span class="hljs-number">4</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iVar1 == <span class="hljs-number"><span class="hljs-number">0</span></span>) { ... }</code> </pre><br> å› æ­¤ï¼Œä»…åœ¨å‰4ä¸ªå­—èŠ‚é‡åˆæ—¶ï¼ˆè¯·è®°ä½ï¼‰ï¼Œæ‰ä¼šæ‰§è¡Œè¿›ä¸€æ­¥çš„æ‰§è¡Œã€‚ ç„¶åï¼Œæˆ‘ä»¬ä»æ–‡ä»¶ä¸­è¯»å–2ä¸ª2å­—èŠ‚çš„å—ï¼ˆå¹¶å°†ç›¸åŒçš„<b>key_array</b>ç”¨ä½œå†™å…¥æ•°æ®çš„ç¼“å†²åŒºï¼‰ï¼š <br><br><pre> <code class="cpp hljs">fread2(key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1); fread2(key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,param_1);</code> </pre><br> å†è¯´ä¸€æ¬¡-è¯¥åŠŸèƒ½ä»…åœ¨ä¸‹ä¸€ä¸ªæ¡ä»¶ä¸ºtrueæ—¶æ‰èµ·ä½œç”¨ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((*(<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>) == <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp;&amp; (*(<span class="hljs-keyword"><span class="hljs-keyword">short</span></span> *)(key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>) == <span class="hljs-number"><span class="hljs-number">5</span></span>)) { <span class="hljs-comment"><span class="hljs-comment">//   ... }</span></span></code> </pre><br> å¾ˆå®¹æ˜“çœ‹å‡ºï¼Œä¸Šé¢è¯»å–çš„2å­—èŠ‚å—ä¸­çš„ç¬¬ä¸€ä¸ªåº”ä¸ºæ•°å­—5ï¼Œç¬¬äºŒä¸ªåº”ä¸ºæ•°å­—4ï¼ˆ <b>short</b>å‹æ•°æ®ç±»å‹åœ¨32ä½å¹³å°ä¸Šä»…å ç”¨2ä¸ªå­—èŠ‚ï¼‰ã€‚ <br><br> æ¥ä¸‹æ¥æ˜¯è¿™ä¸ªï¼š <br><br><pre> <code class="cpp hljs">local_30[<span class="hljs-number"><span class="hljs-number">0</span></span>] = *key_array; <span class="hljs-comment"><span class="hljs-comment">// .. key_array[0] local_30[1] = *key_array + 0x10c; local_30[2] = *key_array + 0x218; local_30[3] = *key_array + 0x324; local_20 = *key_array + 0x430;</span></span></code> </pre><br> åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°<b>local_30</b>æ•°ç»„ï¼ˆå£°æ˜ä¸ºchar * local_30 [4]ï¼‰åŒ…å«<b>key_array</b>æŒ‡é’ˆçš„åç§»é‡ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œ <b>local_30</b>æ˜¯æ ‡è®°è¡Œçš„æ•°ç»„ï¼Œå¯èƒ½ä¼šå°†æ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–åˆ°å…¶ä¸­ã€‚ åœ¨æ­¤å‡è®¾ä¸‹ï¼Œæˆ‘å°†<b>local_30</b>é‡<b>å‘½å</b>ä¸º<b>markers</b> ã€‚ åœ¨è¿™éƒ¨åˆ†ä»£ç ä¸­ï¼Œåªæœ‰æœ€åä¸€è¡Œçœ‹èµ·æ¥æœ‰äº›å¯ç–‘ï¼Œå…¶ä¸­æœ€åä¸€ä¸ªåç§»é‡çš„åˆ†é…ï¼ˆç´¢å¼•ä¸º0x430ï¼Œå³1072ï¼‰ä¸æ˜¯ç”±ä¸‹ä¸€ä¸ª<b>markers</b>å…ƒç´ æ‰§è¡Œï¼Œè€Œæ˜¯ç”±å•ç‹¬çš„<b>local_20</b>å˜é‡ï¼ˆ <b>char *</b> ï¼‰æ‰§è¡Œã€‚ ä½†æ˜¯æˆ‘ä»¬ä¼šæ‰¾å‡ºç­”æ¡ˆçš„ï¼Œä½†æ˜¯ç°åœ¨-è®©æˆ‘ä»¬ç»§ç»­å§ï¼ <br><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç­‰å¾…ä¸€ä¸ªå‘¨æœŸï¼š <br><br><pre> <code class="cpp hljs"> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">// local_10   i while (i &lt; 5) { // ... i = i + 1; }</span></span></code> </pre><br> å³ ä»0åˆ°4ï¼ˆå«4ï¼‰ä»…è¿›è¡Œ5æ¬¡è¿­ä»£ã€‚ åœ¨å¾ªç¯ä¸­ï¼Œç«‹å³å¼€å§‹è¯»å–æ–‡ä»¶å¹¶æ£€æŸ¥æ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„<b>markers</b>æ•°ç»„ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> c_marker = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   local_35 /*  .    */ fread2(&amp;c_marker, 1, 1, param_1); if (*markers[i] != c_marker) { /*    -      */ _free_key(key_array); return (char **)0x0; }</span></span></code> </pre><br> å³ï¼Œå°†æ–‡ä»¶ä¸­çš„ä¸‹ä¸€ä¸ªå­—èŠ‚è¯»å…¥<b>c_marker</b>å˜é‡ï¼ˆåœ¨åŸå§‹åç¼–è¯‘ä»£ç ä¸­ä¸º<b>local_35</b> ï¼‰ï¼Œå¹¶æ£€æŸ¥æ˜¯å¦ä¸ith <b>markers</b>å…ƒç´ çš„ç¬¬ä¸€ä¸ªå­—ç¬¦<b>ç›¸ç¬¦</b> ã€‚ å¦‚æœä¸åŒ¹é…ï¼Œåˆ™å°†<b>key_array</b>æ•°ç»„æ¸…é›¶ï¼Œå¹¶è¿”å›ä¸€ä¸ªç©ºçš„åŒæŒ‡é’ˆã€‚ æ²¿ç€ä»£ç è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬çœ‹åˆ°åªè¦è¯»å–çš„æ•°æ®ä¸éªŒè¯æ•°æ®ä¸åŒ¹é…ï¼Œå°±ä¼šå®Œæˆæ­¤æ“ä½œã€‚ <br><br> ä½†æ˜¯åœ¨è¿™é‡Œï¼Œæ­£å¦‚ä»–ä»¬æ‰€è¯´ï¼Œâ€œç‹—è¢«åŸ‹äº†â€ã€‚ è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹è¿™ä¸ªå‘¨æœŸã€‚ æˆ‘ä»¬å‘ç°ï¼Œå®ƒæœ‰5æ¬¡è¿­ä»£ã€‚ æ‚¨å¯ä»¥é€šè¿‡æŸ¥çœ‹æ±‡ç¼–ä»£ç æ¥æ£€æŸ¥æ˜¯å¦éœ€è¦ï¼š <br><br><img src="https://habrastorage.org/webt/si/b4/q8/sib4q8jsxe2zyxpxi2gcwy0vfba.png"><br><br><img src="https://habrastorage.org/webt/tr/8q/oh/tr8qoh9ayg-7v9t6rv1vwtsuy_c.png"><br><br> ç¡®å®ï¼ŒCMPå‘½ä»¤å°†<b>local_10</b>å˜é‡çš„å€¼ï¼ˆæˆ‘ä»¬å·²ç»æœ‰äº†<b>i</b> ï¼‰ä¸æ•°å­—4è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœè¯¥å€¼<i>å°äºæˆ–ç­‰äº</i> 4ï¼ˆJLEå‘½ä»¤ï¼‰ï¼Œåˆ™è½¬æ¢ä¸ºæ ‡ç­¾<b>LAB_004017eb</b> ï¼Œå³ å¾ªç¯çš„å¼€å§‹ã€‚ å³  <b>i</b> = 0ã€1ã€2ã€3å’Œ4æ—¶å°†æ»¡è¶³æ¡ä»¶-ä»…5æ¬¡è¿­ä»£ï¼ ä¸€åˆ‡éƒ½ä¼šå¥½èµ·æ¥ï¼Œä½†æ˜¯<b>æ ‡è®°</b>ä¹Ÿä¼šé€šè¿‡å¾ªç¯ä¸­çš„è¯¥å˜é‡ç´¢å¼•ï¼Œæ¯•ç«Ÿï¼Œæ­¤æ•°ç»„ä»…ç”¨4ä¸ªå…ƒç´ å£°æ˜ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *markers [<span class="hljs-number"><span class="hljs-number">4</span></span>];</code> </pre><br> å› æ­¤ï¼Œæ˜¾ç„¶æœ‰äººè¯•å›¾æ¬ºéª—æŸäººï¼š)è¿˜è®°å¾—å—ï¼Œæˆ‘è¯´è¿™å¥è¯å€¼å¾—æ€€ç–‘å—ï¼Ÿ <br><br><pre> <code class="cpp hljs">local_20 = *key_array + <span class="hljs-number"><span class="hljs-number">0x430</span></span>;</code> </pre><br> å°±è¿™æ ·ï¼ åªéœ€æŸ¥çœ‹å‡½æ•°çš„æ•´ä¸ªæ¸…å•ï¼Œç„¶åå°è¯•æ‰¾åˆ°è‡³å°‘ä¸€ä¸ªå¯¹<b>local_20</b>å˜é‡çš„å¼•ç”¨ã€‚ å¥¹ä¸åœ¨é‚£é‡Œï¼ æˆ‘ä»¬ç”±æ­¤å¾—å‡ºç»“è®ºï¼šè¯¥åç§»é‡ä¹Ÿåº”å­˜å‚¨åœ¨<b>markers</b>æ•°ç»„ä¸­ï¼Œå¹¶ä¸”æ•°ç»„æœ¬èº«åº”åŒ…å«5ä¸ªå…ƒç´ ã€‚ è®©æˆ‘ä»¬ä¿®å¤å®ƒã€‚ è½¬åˆ°å˜é‡å£°æ˜ï¼Œ <b>æŒ‰Ctrl + L</b> ï¼ˆé‡æ–°è¾“å…¥å˜é‡ï¼‰ï¼Œç„¶åå°†æ•°ç»„çš„å¤§å°æ›´æ”¹ä¸º5ï¼š <br><br><img src="https://habrastorage.org/webt/t0/sq/xw/t0sqxw-hbw5dqo9mca3m43r5cei.png"><br><br> åšå®Œäº† å‘ä¸‹æ»šåŠ¨åˆ°å°†æŒ‡é’ˆåç§»é‡åˆ†é…ç»™<b>æ ‡è®°</b>çš„ä»£ç ï¼Œç„¶å-loå’Œç§ç§ï¼  -éš¾ä»¥ç†è§£çš„é¢å¤–å˜é‡æ¶ˆå¤±äº†ï¼Œä¸€åˆ‡éƒ½å‡†å¤‡å°±ç»ªï¼š <br><br><pre> <code class="cpp hljs">markers[<span class="hljs-number"><span class="hljs-number">0</span></span>] = *key_array; markers[<span class="hljs-number"><span class="hljs-number">1</span></span>] = *key_array + <span class="hljs-number"><span class="hljs-number">0x10c</span></span>; markers[<span class="hljs-number"><span class="hljs-number">2</span></span>] = *key_array + <span class="hljs-number"><span class="hljs-number">0x218</span></span>; markers[<span class="hljs-number"><span class="hljs-number">3</span></span>] = *key_array + <span class="hljs-number"><span class="hljs-number">0x324</span></span>; markers[<span class="hljs-number"><span class="hljs-number">4</span></span>] = *key_array + <span class="hljs-number"><span class="hljs-number">0x430</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   ...   !</span></span></code> </pre><br> æˆ‘ä»¬è¿”å›<b>whileå¾ªç¯</b> ï¼ˆåœ¨æºä»£ç ä¸­ï¼Œè¿™å¾ˆå¯èƒ½æ˜¯<b>é’ˆå¯¹çš„</b> ï¼Œä½†æˆ‘ä»¬ä¸åœ¨ä¹ï¼‰ã€‚ æ¥ä¸‹æ¥ï¼Œå†æ¬¡è¯»å–æ–‡ä»¶ä¸­çš„å­—èŠ‚å¹¶æ£€æŸ¥å…¶å€¼ï¼š <br><br><pre> <code class="cpp hljs">byte n_strlen1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   local_36 /*  .    */ fread2(&amp;n_strlen1,1,1,param_1); if (n_strlen1 == 0) { /*      */ _free_key(key_array); return (char **)0x0; }</span></span></code> </pre><br> ç¡®å®šï¼Œæ­¤<b>n_strlen1</b>å¿…é¡»ä¸ºéé›¶ã€‚ æ€ä¹ˆäº† æ‚¨ç°åœ¨å°†çœ‹åˆ°ï¼Œä½†æ˜¯åŒæ—¶æ‚¨å°†ç†è§£ä¸ºä»€ä¹ˆæˆ‘ç»™æ­¤å˜é‡æŒ‡å®šä»¥ä¸‹åç§°ï¼š <br><br><pre> <code class="cpp hljs"> <span class="hljs-comment"><span class="hljs-comment">/*   n_strlen1)  (markers[i] + 0x104) */</span></span> *(uint *)(markers[i] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>) = (uint)n_strlen1; <span class="hljs-comment"><span class="hljs-comment">/*    (n_strlen1)  (--&gt;  ?) */</span></span> fread2(markers[i] + <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,*(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> *)(markers[i] + <span class="hljs-number"><span class="hljs-number">0x104</span></span>),param_1); n_strlen2 = strlen2(markers[i] + <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   sVar2 if (n_strlen2 != *(size_t *)(markers[i] + 0x104)) { /*    (n_strlen2)  == n_strlen1 */ _free_key(key_array); return (char **)0x0; }</span></span></code> </pre><br> æˆ‘æ·»åŠ äº†ä¸€äº›æ³¨é‡Šï¼Œæ‰€æœ‰å†…å®¹éƒ½åº”è¯¥æ¸…æ¥šã€‚ ä»æ–‡ä»¶ä¸­è¯»å–<b>N_strlen1</b>ä¸ªå­—èŠ‚ï¼Œå¹¶å°†å…¶ä½œä¸ºå­—ç¬¦åºåˆ—ï¼ˆå³å­—ç¬¦ä¸²ï¼‰ä¿å­˜åˆ°<b>æ ‡è®°[i]</b>æ•°ç»„ä¸­-å³ï¼Œåœ¨ç›¸åº”çš„â€œåœæ­¢ç¬¦å·â€ä¹‹åï¼Œè¿™äº›æ ‡è®°å·²ä»<b>key_array</b>å†™å…¥é‚£é‡Œã€‚ åœ¨<b>æ ‡è®°[i]</b>ä¸­å°†å€¼<b>n_strlen1</b>ä¿å­˜åœ¨åç§»é‡0x104ï¼ˆ260ï¼‰å¤„åœ¨è¿™é‡Œæ²¡æœ‰ä»»ä½•ä½œç”¨ï¼ˆè¯·å‚è§ä¸Šé¢ä»£ç çš„ç¬¬ä¸€è¡Œï¼‰ã€‚ å®é™…ä¸Šï¼Œå¯ä»¥æŒ‰ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–æ­¤ä»£ç ï¼ˆå½“ç„¶ï¼Œåœ¨æºä»£ç ä¸­å°±æ˜¯è¿™ç§æƒ…å†µï¼‰ï¼š <br><br><pre> <code class="cpp hljs">fread2(markers[i] + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>) n_strlen1, param_1); n_strlen2 = strlen2(markers[i] + <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (n_strlen2 != (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>) n_strlen1) { ... }</code> </pre><br> å®ƒè¿˜æ£€æŸ¥è¯»å–è¡Œçš„é•¿åº¦æ˜¯å¦ä¸º<b>n_strlen1</b> ã€‚ é‰´äºæ­¤å‚æ•°å·²ä¼ é€’ç»™<b>fread</b>å‡½æ•°ï¼Œè¿™ä¼¼ä¹æ˜¯ä¸å¿…è¦çš„ï¼Œä½†æ˜¯<b>fread</b>è¯»å–çš„å­—èŠ‚æ•°ä¸è¶…è¿‡æŒ‡å®šçš„å­—èŠ‚æ•°ï¼Œå¹¶ä¸”è¯»å–çš„å­—èŠ‚æ•°å¯ä»¥å°‘äºæŒ‡ç¤ºçš„å­—èŠ‚æ•°ï¼Œä¾‹å¦‚åœ¨æ»¡è¶³æ–‡ä»¶ç»“æŸæ ‡è®°ï¼ˆEOFï¼‰çš„æƒ…å†µä¸‹ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰å†…å®¹éƒ½æ˜¯ä¸¥æ ¼çš„ï¼šæ–‡ä»¶ä¸­æŒ‡å‡ºäº†è¡Œçš„é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œç„¶åè¡Œæœ¬èº«å°±è¡Œäº†-æ°å¥½æ˜¯5æ¬¡ã€‚ ä½†æ˜¯æˆ‘ä»¬æ­£åœ¨è¶…è¶Šè‡ªå·±ã€‚ <br><br> è¿›ä¸€æ­¥çŒå…¥æ­¤ä»£ç ï¼ˆæˆ‘ä¹Ÿç«‹å³è¯„è®ºäº†ï¼‰ï¼š <br><br><pre> <code class="cpp hljs">uint n_pos = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   local_3c /*  .    */ fread2(&amp;n_pos,1,1,param_1); /*   7 */ n_pos = n_pos + 7; /*     */ uint n_filepos = ftell2(param_1); //   uVar3 if (n_pos &lt; n_filepos) { /* n_pos   &gt;= n_filepos */ _free_key(key_array); return (char **)0x0; }</span></span></code> </pre><br> è¿™é‡Œä»ç„¶æ›´ç®€å•ï¼šæˆ‘ä»¬ä»æ–‡ä»¶ä¸­å–å‡ºä¸‹ä¸€ä¸ªå­—èŠ‚ï¼ŒåŠ 7ï¼Œç„¶åå°†ç»“æœå€¼ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ftellï¼ˆï¼‰</a>å‡½æ•°è·å¾—çš„æ–‡ä»¶æµä¸­çš„å½“å‰å…‰æ ‡ä½ç½®è¿›è¡Œæ¯”è¾ƒã€‚  <b>n_pos</b>çš„å€¼å¿…é¡»ä¸å°äºå…‰æ ‡ä½ç½®ï¼ˆå³è·æ–‡ä»¶å¼€å¤´çš„å­—èŠ‚åç§»é‡ï¼‰ã€‚ <br><br> å¾ªç¯çš„æœ€åä¸€è¡Œï¼š <br><br><pre> <code class="cpp hljs">fseek2(param_1,n_pos,<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><br> å³ é€šè¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">fseekï¼ˆï¼‰</a>å‡½æ•°å°†æ–‡ä»¶å…‰æ ‡ï¼ˆä»å¤´å¼€å§‹ï¼‰é‡æ–°æ’åˆ—åˆ°<b>n_pos</b>æŒ‡ç¤ºçš„ä½ç½®ã€‚ å¥½çš„ï¼Œæˆ‘ä»¬åœ¨å¾ªç¯ä¸­æ‰§è¡Œæ‰€æœ‰è¿™äº›æ“ä½œ5æ¬¡ã€‚  <b>_construct_keyï¼ˆï¼‰</b>å‡½æ•°<b>ä»¥</b>ä»¥ä¸‹ä»£ç <b>ç»“å°¾</b> ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i_lastmarker = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   local_34 /*   4    (int32) */ fread2(&amp;i_lastmarker,4,1,param_1); if (*(int *)(*key_array + 0x53c) == i_lastmarker) { /*    == key_array[0][1340] ...   :) */ puts2("Markers seem to still exist"); } else { _free_key(key_array); key_array = (char **)0x0; }</span></span></code> </pre><br> å› æ­¤ï¼Œæ–‡ä»¶ä¸­çš„æœ€åä¸€ä¸ªæ•°æ®å—åº”ä¸º4å­—èŠ‚æ•´æ•°å€¼ï¼Œå¹¶ä¸”åº”ç­‰äº<b>key_array [0] [1340]ä¸­çš„å€¼</b> ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†åœ¨æ§åˆ¶å°ä¸­æ”¶åˆ°ç¥è´ºæ¶ˆæ¯ã€‚ å¦åˆ™ï¼Œç©ºæ•°ç»„ä»ä¼šè¿”å›è€Œæ²¡æœ‰ä»»ä½•èµèµï¼šï¼‰ <br><br><h2> æ­¥éª¤6-__prepare_keyï¼ˆï¼‰å‡½æ•°æ¦‚è¿° </h2><br> æˆ‘ä»¬åªå‰©ä¸‹ä¸€ä¸ªæœªæ±‡ç¼–çš„å‡½æ•°<b>__prepare_keyï¼ˆï¼‰</b> ã€‚ æˆ‘ä»¬å·²ç»çŒœåˆ°ï¼ŒéªŒè¯æ•°æ®æ˜¯ä»¥<b>key_array</b>æ•°ç»„çš„å½¢å¼ç”Ÿæˆçš„ï¼Œç„¶ååœ¨<b>_construct_keyï¼ˆï¼‰</b>å‡½æ•°ä¸­ä½¿ç”¨å®ƒæ¥éªŒè¯æ–‡ä»¶ä¸­çš„æ•°æ®ã€‚ ä»ç„¶éœ€è¦æ‰¾å‡ºé‚£é‡Œçš„æ•°æ®ï¼ <br><br> æˆ‘å°†ä¸è¯¦ç»†åˆ†ææ­¤å‡½æ•°ï¼Œå¹¶åœ¨æ‰€æœ‰å¿…è¦çš„å˜é‡é‡å‘½ååç«‹å³ç»™å‡ºå¸¦æœ‰æ³¨é‡Šçš„å®Œæ•´åˆ—è¡¨ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">__Prepare_keyï¼ˆï¼‰å‡½æ•°æ¸…å•</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> ** __prepare_key(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> **key_array; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> *pvVar1; <span class="hljs-comment"><span class="hljs-comment">/* key_array = new char*[2]; // 2 4-  (char*) */</span></span> key_array = (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> **)calloc2(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (key_array == (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>) { key_array = (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> **)<span class="hljs-number"><span class="hljs-number">0x0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { pvVar1 = calloc2(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0x540</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* key_array[0] = new char[1340] */</span></span> *key_array = pvVar1; pvVar1 = calloc2(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>); <span class="hljs-comment"><span class="hljs-comment">/* key_array[1] = new char[8] */</span></span> key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] = pvVar1; <span class="hljs-comment"><span class="hljs-comment">/* "VOID" */</span></span> *(undefined4 *)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x404024</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 5  4 (2- ) */</span></span> *(undefined2 *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">4</span></span>) = <span class="hljs-number"><span class="hljs-number">5</span></span>; *(undefined2 *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-number"><span class="hljs-number">6</span></span>) = <span class="hljs-number"><span class="hljs-number">4</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* key_array[0][0] = 'b' */</span></span> *(undefined *)*key_array = <span class="hljs-number"><span class="hljs-number">0x62</span></span>; *(undefined4 *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x104</span></span>) = <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 'W' */</span></span> *(undefined *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x218</span></span>) = <span class="hljs-number"><span class="hljs-number">0x57</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 'p' */</span></span> *(undefined *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x324</span></span>) = <span class="hljs-number"><span class="hljs-number">0x70</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 'l' */</span></span> *(undefined *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x10c</span></span>) = <span class="hljs-number"><span class="hljs-number">0x6c</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* 152 ( ASCII) */</span></span> *(undefined *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x430</span></span>) = <span class="hljs-number"><span class="hljs-number">0x98</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*   = 1122 (int32) */</span></span> *(undefined4 *)((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)*key_array + <span class="hljs-number"><span class="hljs-number">0x53c</span></span>) = <span class="hljs-number"><span class="hljs-number">0x462</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> key_array; }</code> </pre><br></div></div><br> å”¯ä¸€å€¼å¾—è€ƒè™‘çš„åœ°æ–¹æ˜¯æ­¤è¡Œï¼š <br><br><pre> <code class="cpp hljs">*(undefined4 *)key_array[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">0x404024</span></span>;</code> </pre><br> æˆ‘å¦‚ä½•ç†è§£è¿™æ˜¯â€œ VOIDâ€è¡Œï¼Ÿ äº‹å®æ˜¯0x404024æ˜¯æŒ‡å‘<b>.rdata</b>èŠ‚çš„ç¨‹åºåœ°å€ç©ºé—´ä¸­çš„åœ°å€ã€‚ åŒå‡»è¯¥å€¼ï¼Œæˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°å…¶ä¸­çš„å†…å®¹ï¼š <br><br><img src="https://habrastorage.org/webt/8a/eu/0j/8aeu0jkpr-ea7euhrlcgvm0rxq8.png"><br><br> é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¯ä»¥ä»æ­¤è¡Œçš„æ±‡ç¼–ä»£ç ä¸­ç†è§£ç›¸åŒçš„å†…å®¹ï¼š <br><br> <code>004015da c7 00 24 MOV dword ptr [EAX], .rdata = 56h V <br> 40 40 00 <br></code> <br> å¯¹åº”VOIDè¡Œçš„æ•°æ®åœ¨<b>.rdata</b>èŠ‚çš„æœ€å¼€å§‹ï¼ˆç›¸å¯¹äºç›¸åº”åœ°å€çš„é›¶åç§»ï¼‰ã€‚ <br><br> å› æ­¤ï¼Œåœ¨æ­¤å‡½æ•°çš„å‡ºå£å¤„ï¼Œåº”ä½¿ç”¨ä»¥ä¸‹æ•°æ®å½¢æˆä¸€ä¸ªäºŒç»´æ•°ç»„ï¼š <br><br> <code>[0] [0]:'b' [268]:'l' [536]:'W' [804]:'p' [1072]:152 [1340]:1122 <br> [1] [0-3]:"VOID" [4-5]:5 [6-7]:4 <br></code> <br><h2> æ­¥éª¤7-ä¸ºç ´è§£å‡†å¤‡äºŒè¿›åˆ¶æ–‡ä»¶ </h2><br> ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹åˆæˆäºŒè¿›åˆ¶æ–‡ä»¶äº†ã€‚ æˆ‘ä»¬æ‰‹ä¸­çš„æ‰€æœ‰åˆå§‹æ•°æ®ï¼š <br>  1ï¼‰éªŒè¯æ•°æ®ï¼ˆâ€œåœæ­¢ç¬¦å·â€ï¼‰åŠå…¶åœ¨éªŒè¯æ•°ç»„ä¸­çš„ä½ç½®ï¼› <br>  2ï¼‰æ–‡ä»¶ä¸­çš„æ•°æ®é¡ºåº <br><br> è®©æˆ‘ä»¬æ ¹æ®<b>_construct_keyï¼ˆï¼‰</b>å‡½æ•°çš„ç®—æ³•æ¢å¤è¦æŸ¥æ‰¾çš„æ–‡ä»¶çš„ç»“æ„ã€‚ å› æ­¤ï¼Œæ–‡ä»¶ä¸­çš„æ•°æ®é¡ºåºå¦‚ä¸‹ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ¡£æ¡ˆç»“æ„</b> <div class="spoiler_text"><ol><li>  4ä¸ªå­—èŠ‚== key_array [1] [0 ... 3] ==â€œ VOIDâ€ </li><li>  2ä¸ªå­—èŠ‚== key_array [1] [4] == 5 </li><li>  2ä¸ªå­—èŠ‚== key_array [1] [6] == 4 </li><li>  1ä¸ªå­—èŠ‚== key_array [0] [0] =='b'ï¼ˆä»¤ç‰Œï¼‰ </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆä¸‹ä¸€è¡Œé•¿åº¦ï¼‰== n_strlen1 </li><li>  n_strlen1ä¸ªå­—èŠ‚==ï¼ˆä»»ä½•å­—ç¬¦ä¸²ï¼‰== n_strlen1 </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆ+7 ==ä¸‹ä¸€ä¸ªä»¤ç‰Œï¼‰== n_pos </li><li>  1ä¸ªå­—èŠ‚== key_array [0] [0] =='l'ï¼ˆä»¤ç‰Œï¼‰ </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆä¸‹ä¸€è¡Œé•¿åº¦ï¼‰== n_strlen1 </li><li>  n_strlen1ä¸ªå­—èŠ‚==ï¼ˆä»»ä½•å­—ç¬¦ä¸²ï¼‰== n_strlen1 </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆ+7 ==ä¸‹ä¸€ä¸ªä»¤ç‰Œï¼‰== n_pos </li><li>  1ä¸ªå­—èŠ‚== key_array [0] [0] =='W'ï¼ˆä»¤ç‰Œï¼‰ </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆä¸‹ä¸€è¡Œé•¿åº¦ï¼‰== n_strlen1 </li><li>  n_strlen1ä¸ªå­—èŠ‚==ï¼ˆä»»ä½•å­—ç¬¦ä¸²ï¼‰== n_strlen1 </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆ+7 ==ä¸‹ä¸€ä¸ªä»¤ç‰Œï¼‰== n_pos </li><li>  1ä¸ªå­—èŠ‚== key_array [0] [0] =='p'ï¼ˆä»¤ç‰Œï¼‰ </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆä¸‹ä¸€è¡Œé•¿åº¦ï¼‰== n_strlen1 </li><li>  n_strlen1ä¸ªå­—èŠ‚==ï¼ˆä»»ä½•å­—ç¬¦ä¸²ï¼‰== n_strlen1 </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆ+7 ==ä¸‹ä¸€ä¸ªä»¤ç‰Œï¼‰== n_pos </li><li>  1ä¸ªå­—èŠ‚== key_array [0] [0] == 152ï¼ˆä»¤ç‰Œï¼‰ </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆä¸‹ä¸€è¡Œé•¿åº¦ï¼‰== n_strlen1 </li><li>  n_strlen1ä¸ªå­—èŠ‚==ï¼ˆä»»ä½•å­—ç¬¦ä¸²ï¼‰== n_strlen1 </li><li>  1ä¸ªå­—èŠ‚==ï¼ˆ+7 ==ä¸‹ä¸€ä¸ªä»¤ç‰Œï¼‰== n_pos </li><li>  4ä¸ªå­—èŠ‚==ï¼ˆkey_array [1340]ï¼‰== 1122 </li></ol><br></div></div><br> ä¸ºäº†æ¸…æ¥šèµ·è§ï¼Œæˆ‘åœ¨Excelä¸­ä½¿ç”¨æ‰€éœ€æ–‡ä»¶çš„æ•°æ®åˆ¶ä½œäº†è¿™æ ·çš„å¹³æ¿ç”µè„‘ï¼š <br><br><img src="https://habrastorage.org/webt/kr/i-/7a/kri-7arjlro0ye_los64uhakbfq.png"><br><br> åœ¨ç¬¬7è¡Œ-å­—ç¬¦æœ¬èº«å’Œæ•°å­—å½¢å¼çš„æ•°æ®æœ¬èº«ï¼Œåœ¨ç¬¬6è¡Œ-åå…­è¿›åˆ¶è¡¨ç¤ºå½¢å¼ï¼Œåœ¨ç¬¬8è¡Œ-æ¯ä¸ªå…ƒç´ çš„å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ï¼Œåœ¨ç¬¬9è¡Œ-ç›¸å¯¹äºæ–‡ä»¶å¼€å¤´çš„åç§»é‡ã€‚ æ­¤è§†å›¾éå¸¸æ–¹ä¾¿ï¼Œå› ä¸º å…è®¸æ‚¨åœ¨ä»¥åçš„æ–‡ä»¶ä¸­è¾“å…¥ä»»ä½•è¡Œï¼ˆç”¨é»„è‰²å¡«å……æ ‡è®°ï¼‰ï¼Œè€Œè¿™äº›è¡Œçš„é•¿åº¦å€¼ä»¥åŠä¸‹ä¸€ä¸ªåœæ­¢ç¬¦å·çš„ä½ç½®åç§»æ˜¯æ ¹æ®ç¨‹åºç®—æ³•è¦æ±‚é€šè¿‡å…¬å¼è‡ªåŠ¨è®¡ç®—çš„ã€‚ ä¸Šæ–¹ï¼ˆç¬¬1-4è¡Œï¼‰ <b>æ˜¾ç¤º</b>äº†<b>key_array</b>æ£€æŸ¥æ•°ç»„çš„ç»“æ„ã€‚ <br><br>  excelæœ¬èº«ä»¥åŠè¯¥æ–‡ç« çš„å…¶ä»–æºææ–™éƒ½å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨è¿™é‡Œ</a>ä¸‹è½½ã€‚ <br><br><h3> äºŒè¿›åˆ¶æ–‡ä»¶ç”Ÿæˆå’ŒéªŒè¯ </h3><br> å‰©ä¸‹çš„å”¯ä¸€äº‹æƒ…å°±æ˜¯ä»¥äºŒè¿›åˆ¶æ ¼å¼ç”Ÿæˆæ‰€éœ€çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶æä¾›ç»™æˆ‘ä»¬çš„ç ´è§£ç¨‹åºã€‚ ä¸ºäº†ç”Ÿæˆæ–‡ä»¶ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„Pythonè„šæœ¬ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">ç”Ÿæˆæ–‡ä»¶çš„è„šæœ¬</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sys, os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> subprocess out_str = [<span class="hljs-string"><span class="hljs-string">'!'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>, <span class="hljs-string"><span class="hljs-string">' solved'</span></span>, <span class="hljs-string"><span class="hljs-string">' this'</span></span>, <span class="hljs-string"><span class="hljs-string">' crackme!'</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(file_path)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(file_path, <span class="hljs-string"><span class="hljs-string">'wb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> outfile: outfile.write(<span class="hljs-string"><span class="hljs-string">'VOID'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'2h'</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) outfile.write(<span class="hljs-string"><span class="hljs-string">'b'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">0</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">0</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos = <span class="hljs-number"><span class="hljs-number">10</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">0</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(<span class="hljs-string"><span class="hljs-string">'l'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">1</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">1</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos += <span class="hljs-number"><span class="hljs-number">3</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">1</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(<span class="hljs-string"><span class="hljs-string">'W'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">2</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">2</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos += <span class="hljs-number"><span class="hljs-number">3</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">2</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(<span class="hljs-string"><span class="hljs-string">'p'</span></span>.encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">3</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">3</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos += <span class="hljs-number"><span class="hljs-number">3</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">3</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, <span class="hljs-number"><span class="hljs-number">152</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, len(out_str[<span class="hljs-number"><span class="hljs-number">4</span></span>]))) outfile.write(out_str[<span class="hljs-number"><span class="hljs-number">4</span></span>].encode(<span class="hljs-string"><span class="hljs-string">'ascii'</span></span>)) pos += <span class="hljs-number"><span class="hljs-number">3</span></span> + len(out_str[<span class="hljs-number"><span class="hljs-number">4</span></span>]) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, pos - <span class="hljs-number"><span class="hljs-number">6</span></span>)) outfile.write(struct.pack(<span class="hljs-string"><span class="hljs-string">'i'</span></span>, <span class="hljs-number"><span class="hljs-number">1122</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> err: print(err) <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(sys.argv) != <span class="hljs-number"><span class="hljs-number">2</span></span>: print(<span class="hljs-string"><span class="hljs-string">'USAGE: {this_script.py} path_to_crackme[.exe]'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> os.path.isfile(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>]): print(<span class="hljs-string"><span class="hljs-string">'File "{}" unavailable!'</span></span>.format(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> file_path = os.path.splitext(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>])[<span class="hljs-number"><span class="hljs-number">0</span></span>] + <span class="hljs-string"><span class="hljs-string">'.dat'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: write_file(file_path) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: outputstr = subprocess.check_output(<span class="hljs-string"><span class="hljs-string">'"{}" -f "{}"'</span></span>.format(sys.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>], file_path), stderr=subprocess.STDOUT) print(outputstr.decode(<span class="hljs-string"><span class="hljs-string">'utf-8'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exception <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> err: print(err) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: main()</code> </pre><br></div></div><br> è¯¥è„šæœ¬å°†ç ´è§£çš„è·¯å¾„ä½œä¸ºå•ä¸ªå‚æ•°ï¼Œç„¶åä½¿ç”¨ç›¸åŒç›®å½•ä¸­çš„å¯†é’¥ç”Ÿæˆä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ç›¸åº”çš„å‚æ•°è°ƒç”¨ç ´è§£ï¼Œå°†ç¨‹åºè¾“å‡ºè½¬æ¢ä¸ºæ§åˆ¶å°ã€‚ <br><br> è¦å°†æ–‡æœ¬æ•°æ®è½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œè¯·ä½¿ç”¨<b>struct</b>åŒ…ã€‚  <b>packï¼ˆï¼‰</b>æ–¹æ³•å…è®¸æ‚¨ä»¥æŒ‡ç¤ºæ•°æ®ç±»å‹çš„æ ¼å¼ï¼ˆâ€œ Bâ€ =â€œå­—èŠ‚â€ï¼Œâ€œ iâ€ = intç­‰ï¼‰æ¥å†™å…¥äºŒè¿›åˆ¶æ•°æ®ï¼Œè¿˜å¯ä»¥æŒ‡å®šåºåˆ—ï¼ˆâ€œ&gt;â€ =â€œ Big -endianâ€œï¼Œâ€ &lt;â€œ =â€ Little-endianâ€œï¼‰ã€‚ é»˜è®¤é¡ºåºæ˜¯å°ç«¯ã€‚ å› ä¸º æˆ‘ä»¬å·²ç»åœ¨ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ç¡®å®šè¿™æ­£æ˜¯æˆ‘ä»¬çš„æƒ…å†µï¼Œç„¶åä»…æŒ‡å‡ºç±»å‹ã€‚ <br><br> æ‰€æœ‰ä»£ç ä½œä¸ºä¸€ä¸ªæ•´ä½“é‡ç°äº†æˆ‘ä»¬å‘ç°çš„ç¨‹åºç®—æ³•ã€‚ ä½œä¸ºæˆåŠŸæ‰“å°çš„è¡Œï¼Œæˆ‘æŒ‡å®šâ€œæˆ‘è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼â€  ï¼ˆæ‚¨å¯ä»¥ä¿®æ”¹æ­¤è„šæœ¬ï¼Œä»¥ä¾¿å¯ä»¥æŒ‡å®šä»»ä½•è¡Œï¼‰ã€‚ <br><br> æ£€æŸ¥è¾“å‡ºï¼š <br><br><img src="https://habrastorage.org/webt/th/mx/pz/thmxpzy22t8leydwou56w3emrze.png"><br><br> ä¸‡å²ï¼Œä¸€åˆ‡æ­£å¸¸ï¼ å› æ­¤ï¼Œæˆ‘ä»¬èŠ±äº†ç‚¹åŠŸå¤«å¹¶æ•´ç†äº†å‡ ä¸ªåŠŸèƒ½ï¼Œä¾¿èƒ½å¤Ÿå®Œå…¨æ¢å¤ç¨‹åºç®—æ³•å¹¶å¯¹å…¶è¿›è¡Œâ€œç ´è§£â€ã€‚ å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„ç ´è§£ç¨‹åºï¼Œä¸€ä¸ªæµ‹è¯•ç¨‹åºï¼Œç”šè‡³æ˜¯ç¬¬äºŒä¸ªéš¾åº¦çº§åˆ«ï¼ˆè¯¥ç«™ç‚¹æä¾›çš„5ä¸ªéš¾åº¦çº§åˆ«ï¼‰ã€‚ å®é™…ä¸Šï¼Œæˆ‘ä»¬å°†å¤„ç†å¤æ‚çš„è°ƒç”¨å±‚æ¬¡ç»“æ„ï¼Œå…¶ä¸­åŒ…æ‹¬æ•°åç§åŠŸèƒ½-æ•°ç™¾ç§åŠŸèƒ½ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹-æ•°æ®çš„åŠ å¯†éƒ¨åˆ†ï¼Œåƒåœ¾ä»£ç å’Œå…¶ä»–æ··æ·†æŠ€æœ¯ï¼Œç›´è‡³å†…éƒ¨è™šæ‹Ÿæœºå’ŒPä»£ç çš„ä½¿ç”¨â€¦â€¦ä½†æ˜¯æ­£å¦‚ä»–ä»¬æ‰€è¯´ï¼Œè¿™å·²ç»ä¸€ä¸ªå®Œå…¨ä¸åŒçš„æ•…äº‹ã€‚ <br><br>  <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡ç« çš„ææ–™ã€‚</a></b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN447488/">https://habr.com/ru/post/zh-CN447488/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN447474/index.html">ç”¨äºHarwell Dekatronè®¡ç®—æœºå¤åˆ¶å“çš„å¾®å‹åŠŸèƒ½åè¿›åˆ¶æ¨¡æ‹Ÿç‰©ï¼Œä¸ä»…</a></li>
<li><a href="../zh-CN447476/index.html">åœ¨Sublime Textä¸­è®¾ç½®LaTeX</a></li>
<li><a href="../zh-CN447478/index.html">ä¸å˜æ€§å’Œä¿¡ä»»æ„Ÿæ˜¯å›¢é˜Ÿå‘å±•çš„åŸºç¡€</a></li>
<li><a href="../zh-CN447480/index.html">2019å¹´å®‡å®™èˆªè¡Œæ—¥ï¼šå„åŸå¸‚æ´»åŠ¨</a></li>
<li><a href="../zh-CN447482/index.html">ç½‘ç»œæ³•å­¦é™¢ã€‚ 5å¤©æ•°å­—æ³•å¾‹å¯†é›†</a></li>
<li><a href="../zh-CN447490/index.html">å¦‚ä½•æé«˜è‹±è¯­å†™ä½œé£æ ¼ï¼š5ä¸ªæŠ€å·§</a></li>
<li><a href="../zh-CN447494/index.html">å¯æŒç»­å‘å±•GANå­¦ä¹ ï¼ˆæ·±å…¥ç ”ç©¶ï¼‰</a></li>
<li><a href="../zh-CN447496/index.html">é€šè¿‡websocketsç®¡ç†Raspberry</a></li>
<li><a href="../zh-CN447498/index.html">JPoint 2019çš„ç…§ç‰‡æŠ¥å‘Š+åœ£å½¼å¾—å ¡çš„Joker 2019å…¬å‘Š</a></li>
<li><a href="../zh-CN447500/index.html">ä¸ºä»€ä¹ˆè¿è¥å•†ä¼šè¢«eSIMå“åˆ°</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>