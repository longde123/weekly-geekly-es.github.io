<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äç‚öïÔ∏è ‚ÜïÔ∏è üëáüèª uWSGI para ajudar nas m√©tricas. Relat√≥rio Yandex ‚õπüèΩ üëáüèæ üöß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Outro dia, o Moscow Python Meetup # 66 foi realizado - a comunidade continua discutindo ferramentas relevantes que aprimoram a linguagem e a adaptam a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>uWSGI para ajudar nas m√©tricas. Relat√≥rio Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/462697/">  Outro dia, o Moscow Python Meetup # 66 foi realizado - a comunidade continua discutindo ferramentas relevantes que aprimoram a linguagem e a adaptam a diferentes ambientes.  Inclusive na reuni√£o, meu relat√≥rio foi feito.  Meu nome √© Nail, estou usando o Yandex.Connect. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/oh/bd/zt/ohbdztka-hxtbhnhb8gz2g1ohmc.jpeg"></a> <br><br>  A hist√≥ria que preparei foi sobre o uWSGI.  Este √© um servidor de aplicativos da web multifuncional e todos os aplicativos modernos s√£o acompanhados por m√©tricas.  Tentei mostrar como os recursos do uWSGI podem ajudar na coleta de m√©tricas. <br><br><a name="habracut"></a>  - Ol√° pessoal, fico feliz em receber todos voc√™s nas paredes do Yandex.  √â bom que tantas pessoas tenham visto meus e outros relat√≥rios, que tantas pessoas estejam interessadas e morem em Python.  Sobre o que √© o meu relat√≥rio?  √â chamado de "uWSGI para ajudar nas m√©tricas".  Vou falar um pouco sobre mim.  Estou no Python h√° seis anos, trabalho na equipe Yandex.Connect, estamos escrevendo uma plataforma de neg√≥cios que fornece servi√ßos Yandex desenvolvidos internamente para usu√°rios de terceiros, ou seja, para todos.  Qualquer pessoa ou organiza√ß√£o pode usar os produtos desenvolvidos pela Yandex para si pr√≥prios, para seus pr√≥prios fins. <br><br>  Falaremos sobre m√©tricas, como obt√™-las, como usamos em nossa equipe o uWSGI como uma ferramenta para obter m√©tricas, como isso nos ajuda.  Depois, vou contar uma pequena hist√≥ria de otimiza√ß√£o. <br><br>  Algumas palavras sobre m√©tricas.  Como voc√™ sabe, o desenvolvimento de um aplicativo moderno √© imposs√≠vel sem testes.  √â estranho se algu√©m desenvolve seus aplicativos sem testes.  Ao mesmo tempo, parece-me que a opera√ß√£o de um aplicativo moderno √© imposs√≠vel sem m√©tricas.  Nossa aplica√ß√£o √© um organismo vivo.  Uma pessoa pode tomar algumas m√©tricas, como press√£o, freq√º√™ncia card√≠aca, - o aplicativo tamb√©m possui indicadores nos quais estamos interessados ‚Äã‚Äãe gostar√≠amos de observar.  Ao contr√°rio de uma pessoa que geralmente usa essas m√©tricas vitais quando se sente mal, no caso de um aplicativo, sempre podemos execut√°-las. <br><br><img src="https://habrastorage.org/webt/gm/3s/oi/gm3soikaaai-tmfoi6mf7_u3waq.jpeg"><br><br>  Por que estamos fazendo m√©tricas?  A prop√≥sito, quem usa m√©tricas?  Espero que, depois do meu relat√≥rio, haja mais m√£os e as pessoas se interessem e comecem a coletar m√©tricas, que entendam que isso √© necess√°rio e √∫til. <br><br>  Ent√£o, por que precisamos de m√©tricas?  Antes de tudo, vemos o que est√° acontecendo com o sistema, destacamos alguns indicadores normativos para o nosso sistema e entendemos se vamos al√©m desses indicadores durante o processo de inscri√ß√£o ou n√£o.  Voc√™ pode observar algum comportamento anormal do sistema, por exemplo, um aumento no n√∫mero de erros, entender o que h√° de errado com o sistema, diante de nossos usu√°rios e receber mensagens sobre incidentes n√£o dos usu√°rios, mas do sistema de monitoramento.  Com base nas m√©tricas, podemos configurar alertas e receber sms, cartas, chamadas, como desejar. <br><br><img src="https://habrastorage.org/webt/sw/1a/ru/sw1arunikx2d6u7ngqaiofuqfvo.jpeg"><br><br>  O que s√£o, em regra, m√©tricas?  Estes s√£o alguns n√∫meros, talvez um contador que cres√ßa monotonamente.  Por exemplo, o n√∫mero de solicita√ß√µes.  Alguns valores unit√°rios que mudam no tempo aumentam ou diminuem.  Um exemplo √© o n√∫mero de tarefas em uma fila.  Ou histogramas - valores que caem em alguns intervalos, os chamados cestos.  Como regra, √© conveniente ler esses dados relacionados ao tempo e descobrir em qual intervalo de tempo quantos valores se encaixam. <br><br><img src="https://habrastorage.org/webt/ba/in/dk/baindkmahmhfz9-wq20ahlm4oyg.jpeg"><br><br>  Que tipo de m√©trica podemos usar?  Vou me concentrar no desenvolvimento de aplicativos da Web, pois est√° mais perto de mim.  Por exemplo, podemos gravar o n√∫mero de solicita√ß√µes, nossos terminais, o tempo de resposta de nossos terminais, os c√≥digos de resposta de servi√ßos relacionados, se formos a eles e tivermos uma arquitetura de microsservi√ßo.  Se usarmos o cache, poderemos entender a efici√™ncia do cache de falha ou acerto, entender a distribui√ß√£o dos tempos de resposta dos servidores de terceiros e, por exemplo, do banco de dados.  Mas, para visualizar as m√©tricas, voc√™ precisa colet√°-las de alguma forma. <br><br><img src="https://habrastorage.org/webt/4f/x3/9a/4fx39auteviuwx9dfiefacsjz_q.jpeg"><br><br>  Como podemos colet√°-los?  Existem v√°rias op√ß√µes.  Quero falar sobre a primeira op√ß√£o - um esquema de envio.  Em que consiste? <br><br>  Suponha que recebamos uma solicita√ß√£o de um usu√°rio.  Localmente, com nosso aplicativo, instalamos algum tipo, geralmente um agente push.  Digamos que temos um Docker, existe um aplicativo e um agente push ainda permanece em paralelo.  O agente de envio recebe o valor das m√©tricas localmente, de alguma forma, armazena em buffer, faz lotes e as envia para o sistema de armazenamento de m√©tricas. <br><br>  Qual √© a vantagem de usar esquemas push?  Podemos enviar alguma m√©trica diretamente para o sistema de m√©trica a partir do aplicativo, mas, ao mesmo tempo, obtemos algum tipo de intera√ß√£o de rede, lat√™ncia e sobrecarga para coletar m√©tricas.  No caso de um cliente push local, isso √© nivelado. <br><br><img src="https://habrastorage.org/webt/n5/ff/o7/n5ffo732rxl3styovoxwmjnffim.jpeg"><br><br>  Outra op√ß√£o √© um esquema de recebimento.  Com o esquema pull, temos o mesmo cen√°rio.  Uma solicita√ß√£o do usu√°rio chega at√© n√≥s, de alguma forma a mantemos em casa.  E ent√£o, com uma certa frequ√™ncia - uma vez por segundo, uma vez por minuto, conforme necess√°rio - o sistema de coleta de m√©tricas chega a um endpoint especial de nossa aplica√ß√£o e utiliza esses indicadores. <br><br><img src="https://habrastorage.org/webt/ob/xy/88/obxy88kzj0owhgydp-kr02gisx0.jpeg"><br><br>  Outra op√ß√£o s√£o os logs.  Todos escrevemos logs e os enviamos para algum lugar.  Nada nos impede de pegar esses logs, de algum modo process√°-los e obter m√©tricas com base nos logs. <br><br>  Por exemplo, escrevemos o fato da solicita√ß√£o de um usu√°rio no log e, em seguida, coletamos os logs, hop-hop, contados.  Um exemplo t√≠pico √© o ELK (Elasticsearch, Logstash, Kibana). <br><br><img src="https://habrastorage.org/webt/qb/r1/ji/qbr1ji36v03ahocy3_hj5wy7ihs.jpeg"><br><br>  Como isso funciona conosco?  A Yandex possui sua pr√≥pria infraestrutura, seu pr√≥prio sistema de coleta de m√©tricas.  Ela espera uma resposta padronizada para um identificador que implementa um esquema de recebimento.  Al√©m disso, temos uma nuvem interna onde lan√ßamos nosso aplicativo.  E tudo isso √© integrado em um √∫nico sistema.  Fazendo o upload para a nuvem, simplesmente indicamos: "V√° para esta caneta e obtenha as m√©tricas". <br><br><img src="https://habrastorage.org/webt/p7/ug/ls/p7uglskaraaguno_ngqnemhmbgc.jpeg"><br><br>  Aqui est√° um exemplo de resposta para o esquema pull que nosso sistema de coleta de m√©tricas espera. <br><br>  Para n√≥s mesmos na equipe, decidimos escolher uma maneira mais adequada para n√≥s, para destacar v√°rios crit√©rios pelos quais escolheremos a melhor op√ß√£o para n√≥s.  Efici√™ncia √© a rapidez com que podemos obter no sistema m√©trico uma demonstra√ß√£o do fato de qualquer a√ß√£o.  Depend√™ncia - se precisamos instalar ferramentas adicionais ou configurar a infraestrutura para obter a m√©trica.  E versatilidade - como esse m√©todo √© adequado para diferentes tipos de aplica√ß√µes. <br><br><img src="https://habrastorage.org/webt/h2/ao/s4/h2aos4jq6iboqpi9ze3254om0rs.jpeg"><br><br>  Foi o que conseguimos no final.  Embora, de acordo com os crit√©rios de efici√™ncia e versatilidade, o esquema de push ganhe.  Mas estamos desenvolvendo um aplicativo da Web e nossa nuvem j√° possui uma infraestrutura pronta para trabalhar com essa tarefa, por isso decidimos escolher um esquema pull para n√≥s mesmos.  N√≥s falaremos sobre ela. <br><br>  Para dar algo ao esquema pull, precisamos pr√©-agreg√°-lo em algum lugar, salv√°-lo.  Nosso sistema de monitoramento entra em puxadores a cada cinco segundos.  Onde podemos salvar?  Localmente na sua mem√≥ria ou em um armazenamento de terceiros. <br><br><img src="https://habrastorage.org/webt/pa/ft/sb/paftsbyryl5ojm43di6mhwrxge4.jpeg"><br><br>  Se salvarmos localmente, como regra, isso √© adequado para o caso de um processo.  E n√≥s, em nosso uWSGI, executamos v√°rios processos em paralelo.  Ou podemos usar algum tipo de armazenamento compartilhado.  O que vem √† nossa mente com a palavra "armazenamento compartilhado"?  Esse √© algum tipo de banco de dados Redis, Memcached, relacionais ou n√£o relacionais, ou mesmo um arquivo. <br><br><img src="https://habrastorage.org/webt/ms/um/fb/msumfb5j3za1j6b7qxrklpnvww8.jpeg"><br><br>  Sobre o uWSGI.  Deixe-me lembr√°-lo daqueles que o usam pouco ou raramente: o uWSGI √© um servidor de aplicativos da web que permite executar aplicativos Python sob voc√™.  Ele implementa a interface, o protocolo uWSGI.  Este protocolo est√° descrito no PEP 333, que voc√™ est√° interessado, voc√™ pode ler. <br><br><img src="https://habrastorage.org/webt/vg/ke/yy/vgkeyyiamyh4dfcbclpg-rhi17m.jpeg"><br><br>  Tamb√©m nos ajudar√° a escolher a melhor solu√ß√£o Yandex.Tank.  Esta √© uma ferramenta de teste de carga, permite que voc√™ projete nosso aplicativo com v√°rios perfis de carga e cria belos gr√°ficos.  Ou funciona no console, como voc√™ gosta. <br><br><img src="https://habrastorage.org/webt/vl/79/jq/vl79jqtqnv8hgqvjeqhetqdzhpi.jpeg"><br><br>  Os experimentos.  Vamos criar uma aplica√ß√£o sint√©tica para nossos testes sint√©ticos, vamos revesti-la com um tanque.  O aplicativo uWSGI ter√° um conflito simples com 10 trabalhadores. <br><br><img src="https://habrastorage.org/webt/nk/ui/s4/nkuis4s4fgzpkj7tmvlchyn0dr4.jpeg"><br><br>  Aqui est√° o nosso aplicativo Flask.  A carga √∫til que nosso aplicativo executa, emularemos um loop vazio. <br><br><img src="https://habrastorage.org/webt/sc/d5/qt/scd5qtepls29c1u46xknxbcwfxm.jpeg"><br><br>  Disparamos e o Yandex.Tank nos fornece um desses gr√°ficos.  O que ele est√° mostrando?  Percentis de tempos de resposta.  A linha inclinada s√£o os RPS que est√£o crescendo e os histogramas s√£o os percentis em que nosso servidor da Web se encaixa sob essa carga. <br><br>  Tomaremos essa op√ß√£o como refer√™ncia e veremos como as diferentes op√ß√µes para armazenar m√©tricas afetam o desempenho. <br><br><img src="https://habrastorage.org/webt/9d/j2/x_/9dj2x_mwlyb7ovl-e9y24nkey1c.jpeg"><br><br>  A op√ß√£o mais simples √© usar o PostgreSQL.  Como trabalhamos com o PostgreSQL, n√≥s o temos.  Vamos usar o que j√° est√° pronto. <br><br>  Digamos que temos um r√≥tulo no PostgreSQL no qual simplesmente incrementamos o contador. <br><br><img src="https://habrastorage.org/webt/_7/zx/ja/_7zxjarhpil1cwhzw2q-b1j48rg.jpeg"><br><br>  J√° em pequenas quantidades de RPS, vemos uma forte degrada√ß√£o do desempenho.  Pode-se dizer apenas enorme. <br><br><img src="https://habrastorage.org/webt/ox/c7/tm/oxc7tm1_kizqnqdli6rkzunqeau.jpeg"><br><br>  A pr√≥xima op√ß√£o √© Redis.  Mas aqui estamos mais espertos: instalamos localmente e o utilizamos n√£o pela rede, mas pelo soquete Unix.  Aumente tamb√©m o contador. <br><br><img src="https://habrastorage.org/webt/6k/zv/wv/6kzvwvil-aitqzp2rdys3ggjz5e.jpeg"><br><br>  N√≥s obtemos o histograma dos tempos de resposta na sa√≠da.  Vemos que as coisas est√£o melhores aqui, mas em algum momento chegamos a uma prateleira e, em seguida, a produtividade n√£o est√° mais aumentando.  Essa op√ß√£o parece mais ideal, mas queremos fazer ainda melhor. <br><br><img src="https://habrastorage.org/webt/ts/xs/m7/tsxsm7cnr7qsk0-aydibqnsmobg.jpeg"><br><br>  Aqui o uWSGI, uma combina√ß√£o real, vem em nosso aux√≠lio.  Existem muitos m√≥dulos diferentes.  Mule para executar subprocessos, estrutura de cache, cron, subsistema de m√©tricas e sistema de alerta.  "Sistema de m√©tricas do subsistema" - parece promissor. <br><br><img src="https://habrastorage.org/webt/xt/rd/ip/xtrdipfn_v0kmanjjipkuc2fd_w.jpeg"><br><br>  Ela sabe como adicionar algum tipo de m√©trica, aumentar o contador, diminuir o contador, multiplicar, dividir - o que seu cora√ß√£o desejar. <br><br>  O √∫nico subsistema de m√©tricas n√£o pode fornecer exatamente as m√©tricas incorporadas a ele. <br><br>  Por que isso √© importante para n√≥s?  Como voc√™ viu anteriormente, temos uma maneira de fornecer estat√≠sticas em um formato espec√≠fico, e v√°rios trabalhadores est√£o em execu√ß√£o.  N√£o sabemos quais funcion√°rios receber√£o a solicita√ß√£o, mas, para retornar todas as m√©tricas, precisamos criar algum tipo de registro de nomes e, de alguma forma, embaralh√°-lo entre os processos.  Isso √© grande coisa, eu quero evitar isso.  O que mais n√≥s temos? <br><br><img src="https://habrastorage.org/webt/tu/st/ir/tustir9lyytiuq5noxzeosk7uyq.jpeg"><br><br>  Claro, subsistema de cache.  E aqui vemos: ele pode fazer quase a mesma coisa e tamb√©m √© capaz de fornecer os nomes das chaves armazenadas no cache.  √â disso que voc√™ precisa. <br><br><img src="https://habrastorage.org/webt/4l/le/um/4lleum60xf9n635wiue31dvaptk.jpeg"><br><br>  O subsistema de cache √© um cache incorporado ao uWSGI.  Um m√≥dulo r√°pido e seguro para threads, que √© um armazenamento comum de valores-chave. <br><br><img src="https://habrastorage.org/webt/gf/a3/w4/gfa3w4hje0atgnlctpzdr6n1hcg.jpeg"><br><br>  Mas, como esse √© um cache, existe um segundo problema bem conhecido: como nomear uma vari√°vel e como invalidar o cache?  No nosso caso, vamos ver quais s√£o as configura√ß√µes de cache padr√£o.  Possui restri√ß√µes no comprimento da chave.  No nosso caso, esse √© o nome da m√©trica.  O padr√£o √© 2048 bytes.  E voc√™ pode aumentar a configura√ß√£o, se necess√°rio.  O n√∫mero de elementos que ele armazena por padr√£o √© 65.536. Parece que esse valor deve ser suficiente para todos.  √â improv√°vel que algu√©m colete um n√∫mero t√£o grande de m√©tricas de seu aplicativo. <br><br>  E ttl por padr√£o √© 0. Ou seja, os valores dos caches armazenados n√£o s√£o invalidados por tempo.  Assim, podemos obt√™-los do cache e envi√°-los ao sistema de m√©tricas. <br><br><img src="https://habrastorage.org/webt/nb/q8/zu/nbq8zuosdcqk0rss824oiweqifc.jpeg"><br><br>  Novamente, a op√ß√£o √© um aplicativo que usa a caixa uWSGI. <br><br><img src="https://habrastorage.org/webt/v6/ri/fb/v6rifbjrax-igqz5bfpn2m5powu.jpeg"><br><br>  Aqui est√£o os resultados do bombardeio deste aplicativo. <br><br><img src="https://habrastorage.org/webt/qs/dg/0-/qsdg0-_dj_bqttsbdoewg5rcps8.jpeg"><br><br>  O resultado sem m√©tricas, se com uWSGI, com um alongamento, parece quase o mesmo. <br><br><img src="https://habrastorage.org/webt/lw/xp/xz/lwxpxzc2jf-hyfnx4fcysnfmrfi.jpeg"><br><br>  Como voc√™ pode ver, no caso do uWSGI, perdemos apenas 5% do desempenho em rela√ß√£o √† vers√£o "vanilla" sem m√©tricas.  Outras op√ß√µes t√™m um rebaixamento bastante significativo e, portanto, como resultado da vota√ß√£o do espectador, o uWSGI vence. <br><br><img src="https://habrastorage.org/webt/xw/sg/hf/xwsghfrlb5z8kwt_kzv4mgvxjhe.jpeg"><br><br>  Como aplicamos isso?  Escrevemos uma pequena biblioteca, um inv√≥lucro em torno do uWSGI.  Por exemplo, instalamos uma inst√¢ncia da nossa biblioteca e aqui adicionamos a m√©trica "Tempo de consulta no banco de dados" como exemplo. <br><br><img src="https://habrastorage.org/webt/jh/k2/qa/jhk2qajtaazyhqvckbyi63r8iiy.jpeg"><br><br>  Tamb√©m estamos interessados ‚Äã‚Äãem acompanhar como o cache funciona.  Simplesmente redefinimos os m√©todos da mem√≥ria do cliente, economizamos tempo para receber dados, tempo para fazer o download e o n√∫mero de acertos e falhas do cache. <br><br><img src="https://habrastorage.org/webt/6r/cy/v7/6rcyv7zh51cjphtabkfhwwgjui4.jpeg"><br><br>  Como fazemos isso dentro da biblioteca?  Para enviar os valores, obtemos os nomes das chaves armazenadas no cache, as executamos e simplesmente as fornecemos no formato desejado para o terminal. <br><br><img src="https://habrastorage.org/webt/3g/ts/y-/3gtsy-g-qfq9ro1h71j_pjkhtk0.jpeg"><br><br>  Como resultado, obtemos um gr√°fico, neste caso, √© o percentil 99 do tempo de acesso ao cache, leitura e grava√ß√£o. <br><br><img src="https://habrastorage.org/webt/ho/fg/td/hofgtdq1ewg1qoqabjpid3ukpds.jpeg"><br><br>  Ou, como op√ß√£o, o n√∫mero de solicita√ß√µes de servi√ßos de terceiros √† nossa API. <br><br><img src="https://habrastorage.org/webt/dk/ba/zw/dkbazwujnh0sq9uf2uyj6wmgy_o.jpeg"><br><br>  Temos hist√≥rias de fracasso e sucesso.  Come√ßamos a adicionar cada vez mais m√©tricas e tivemos uma queda no desempenho.  As pr√≥prias m√©tricas nos ajudaram.  Se voc√™ coletar m√©tricas, poder√° ver que algo est√° errado.  Portanto, tamb√©m recomendo que voc√™ analise retrospectivamente as m√©tricas que acumulou ao longo da semana, m√™s e seis meses.  E veja qual tend√™ncia seu aplicativo est√° mostrando em quais indicadores.  Percebemos que come√ßamos a descansar no c√°lculo das m√©tricas. <br><br><img src="https://habrastorage.org/webt/if/k_/uc/ifk_ucasa_eegw5jangcb-oudwm.jpeg"><br><br>  A cria√ß√£o de perfil nos ajudou.  Aqui voc√™ v√™ um flamegraph, que mostra visualmente quantas chamadas de v√°rias fun√ß√µes foram realizadas durante o processo, chamadas que deram a maior contribui√ß√£o no tempo.  Percebemos que n√£o nos sa√≠mos muito bem na primeira vers√£o usando pickle.  Dentro da nossa biblioteca, ela passou um tempo consider√°vel em conserva. <br><br><img src="https://habrastorage.org/webt/kd/xn/nm/kdxnnm1oaklpbbsdoiw48yljkc8.jpeg"><br><br>  Recusamos a decapagem, transferimos para a cashe inc, medimos tudo, ficou mais r√°pido. <br><br><img src="https://habrastorage.org/webt/fp/v_/qe/fpv_qetjlbsj1dcgt4wo2z3xr2q.jpeg"><br><br>  Na nova implementa√ß√£o, passamos a maior parte do tempo trabalhando com o cache, n√£o com a decapagem. <br><br><img src="https://habrastorage.org/webt/ju/x2/cs/jux2cs4k52ekeeqalcaeltpawkc.jpeg"><br><br>  Por que estou lhe dizendo isso?  Pe√ßo que voc√™ comece a coletar m√©tricas, observando m√©tricas e se concentrando nas m√©tricas.  Ao escolher uma op√ß√£o de cole√ß√£o de m√©tricas poss√≠vel, compare as op√ß√µes e veja qual √© a melhor para voc√™.  E, claro, o perfil √© bom.  Se voc√™ perceber que algo est√° errado, algo est√° diminuindo a velocidade - perfil. <br><br>  Obrigado a todos!  Como prometi, refer√™ncias: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Yandex.Tank</a> , </li><li>  utilit√°rio de cria√ß√£o de perfil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">py-spy</a> escrito em Rust, </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio de</a> Alexander Koshelev sobre o uso do uWSGI. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt462697/">https://habr.com/ru/post/pt462697/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt462687/index.html">Novo painel de controle de hospedagem do ISPsystem: como ver</a></li>
<li><a href="../pt462689/index.html">DISKOBALL: competi√ß√µes de lan√ßamento de HDD, 23 de agosto de Moscou</a></li>
<li><a href="../pt462691/index.html">Como migrar do AD para o LDAP ao usar o Zimbra</a></li>
<li><a href="../pt462693/index.html">No caminho para aplica√ß√µes dur√°veis ‚Äã‚Äãcom o gerador de site est√°tico PSKOV como exemplo</a></li>
<li><a href="../pt462695/index.html">Material como WebComponents</a></li>
<li><a href="../pt462699/index.html">Malha de servi√ßo, "Plano de dados" e "Plano de controle" (plano de dados da malha de servi√ßo x plano de controle)</a></li>
<li><a href="../pt462701/index.html">Biblioteca de gerador de c√≥digo Assembler para microcontroladores AVR. Parte 2</a></li>
<li><a href="../pt462703/index.html">A catraca ‚Äúmais barata‚Äù na R√∫ssia controlada a partir de um smartphone</a></li>
<li><a href="../pt462705/index.html">Os 5 principais erros nos meus aplicativos ReactJS</a></li>
<li><a href="../pt462707/index.html">Kubernetes lan√ßa ferramentas de desenvolvedor de aplicativos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>