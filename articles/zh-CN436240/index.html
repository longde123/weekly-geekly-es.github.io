<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💪🏻 🕵🏻 ™️ 自动化VS混乱 🧛🏼 🤷🏿 👴🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="IT技术的发展允许控制巨大的数据流。 企业有很多IT解决方案：CRM，ERP，BPM，会计系统，或者至少是Excel和Word。 公司也不同。 一些公司由许多分支机构组成。 让我们命名为“金字塔”。 金字塔存在用于IT系统堆的数据同步问题。 各分支机构的软件供应商和版本差异很大。 此外，管理公司会不...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>自动化VS混乱</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436240/"><img src="https://habrastorage.org/webt/hj/s8/mq/hjs8mq4n1zefsd8fipawzx7j6ok.jpeg" alt="图片"><br><br>  IT技术的发展允许控制巨大的数据流。 企业有很多IT解决方案：CRM，ERP，BPM，会计系统，或者至少是Excel和Word。 公司也不同。 一些公司由许多分支机构组成。 让我们命名为“金字塔”。 金字塔存在用于IT系统堆的数据同步问题。 各分支机构的软件供应商和版本差异很大。 此外，管理公司会不断修改报告要求，从而导致分支机构遭受挫败攻击。 这是一个有关我偶然遇到的项目的故事，该项目需要系统化和自动化。 低预算和紧迫的期限限制了大多数现有工业解决方案的使用，但为创造力开辟了空间。 <br><a name="habracut"></a><br><h2> 通用格式 </h2><br> 客户公司设置了一个任务，从所有分支机构收集报告数据。 让我解释一下挑战的规模-有数十种系统，包括这两种系统：自制系统和SAP等怪兽。 <br><br> 一份报告可能包含以下人员的数据：会计师，修理工，公关经理，EMERCOM和气象学家。 <br><br> 在项目开始之前，大部分数据已作为Word / Excel附件通过电子邮件发送给总公司。 向前看，它就像是手​​动完成的日落：数据是由经过专门研究的人员手动处理的，并放入了两个系统中。 最后，有数十份报告构成了管理决策的基础。 <br><br> 使用的文件格式-xlsx / docx提示了方法的选择。 甚至旧版软件也支持将数据上传到这些格式。 至少复制粘贴可以成为分支机构的最后选择。 <br><br> 因此，我们自以为是的计划是： <br><br><ol><li> 描述每个报告的结构和时间表。 </li><li> 向分支机构提供报告规定。 分支机构应使用现有软件通过电子邮件发送报告。 如果没有软件，请像以前一样手动发送报告。 </li><li> 开发系统，该系统： </li></ol><br><ul><li> 从电子邮件收件箱中提取正确的文档； </li><li> 从文档中提取数据； </li><li> 将提取的数据写入DB，并惩罚违反法规的人。 </li></ul><br><img src="https://habrastorage.org/webt/is/7j/jm/is7jjmttswxfhyiieqcz5cepmha.png" alt="图片"><br><h2> 实作 </h2><br><h3> 非发展问题 </h3><br> 事实证明，在需求收集阶段，没有报告结构的描述。 没事 报告结构存储在一些员工的脑海中，并作为民间故事进行口头传递。 通过一些努力解决了该问题，但真正的挑战始于稍后的数据交换阶段。 <br><br><h3> 第一期 </h3><br>  Beta版本发布后的几天里，我们发现了文档结构和文档模型之间的差距。 数据质量不佳：报告数量不一致，列混淆或命名不正确。 这些问题主要发生在收集和手动发送数据的分支机构中。 <br><br> 解决方案-实施三步验证： <br><br><ol><li> 为分支机构提供具有由Excel工具修复的结构的xlsx示例。 这些样本中只有可用的单元格是数据输入。 一些单元格需要其他验证：类型，总和的收敛性等。 </li><li> 提取时进行数据验证。 例如，比较Word段落中的当前日期和日期，对Excel文档进行数据算术验证（如果xlsx工具无法设置）。 </li><li> 提取后进行深度数据分析。 例如，与上一期间相比，关键指标可检测到重大偏差。 </li></ol><br><h3> 第二期 </h3><br> 系统地违反了数据传输时间表或无良的破坏企图：“我们从不向任何人发送任何数据，这就是您的本事……”，“我发送了所有信息！ 准时！ 可能是因为延迟问题导致您没有得到它。” <br><br> 反馈成为解决方案。 如果计划发生违规，该软件会自动通知分支机构的负责人。 <br><br> 一段时间后，反馈模块连接到数据质量检查模块和最终报告生成模块。 这样分支立即接收到自己数据的摘要以及与“邻居分支”的比较。 因此，对于分支机构来说，为什么要谴责它是显而易见的。 <br><br><h2> 开发模块 </h2><br> 报告模板配置工具，它描述： <br><br><ul><li> 识别报告的属性； </li><li> 传输规则； </li><li> 数据提取算法； </li><li> 其他属性，例如验证和存储数据的代码路径。 </li></ul><br> 一种电子邮件应用程序，可将附件移动到隔离的存储区（沙盒）并存储与信件相关的信息； <br><br> 附件解析器，用于标识报告并提取数据。 <br><br><img src="https://habrastorage.org/webt/ym/iu/c5/ymiuc5d4tevhe9cnbkslpuj9fu8.png" alt="图片"><br><br><h3> 配置工具 </h3><br> 从历史上看，带有报告的信件会发送到公用电子邮件地址，以及许多其他重要或不重要的信件。 因此，我们需要使用属性来识别报告附件的类型。 电子邮件正文中某些文档名称或文本的使用对于发送者来说是不可靠和不舒服的。 这就是为什么我们决定仅由内容确定报告标识的原因。 <br><br> 头脑风暴产生了许多属性，可根据内容识别报告类型：单元格文本颜色，字体等。 但是最正确的方法是在某个单元格（“槽”）或Excel的单元格数组中存在子字符串。 对于Word，我们使用段落或标题。 <br><br> 我们为“广告位”添加了简单的比较逻辑：“相等”，“不相等”，“更多”，“更少”，等等。  Excel报告示例：在A2-E4范围内，单元格文本应等于“每日设备负荷报告”。 <br><br><img src="https://habrastorage.org/webt/r6/qf/qq/r6qfqqfzfos5m--nb5wnkucwu0g.png" alt="图片"><br><br> 我们以类似的方式为数据的开头和结尾配置了搜索区域。 <br><br> 以下是数据结尾的搜索条件示例：“一行2空行”。 <br><br><img src="https://habrastorage.org/webt/jc/pu/ok/jcpuokqbs80ari66rbcfs82pljw.png" alt="图片"><br><br> 其他一些设置：允许的发件人列表，文档类型（Excel / Word），数据导出路径。 <br><br> 输出是描述报告的JSON结构（模板）。 <br><br><h3> 电子邮件申请 </h3><br> 此应用程序是电子邮件收件箱阅读器，可将所有附件放入沙箱，保存电子邮件属性，将附件设置为解析队列。 <br><br> 我们面临2个安全问题： <br><br><ol><li> 如果报表中的分支名称被（或没有）意外地替换为另一个分支名称怎么办？ </li><li> 如果入侵者发送报告怎么办？ </li></ol><br> 通过检查分支发送者的电子邮件地址和报告正文中指定的分支名称，可以解决第一个问题。 <br><br> 使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SPF</a>解决了第二个问题。 <br><br><h3> 附件解析器 </h3><br> 几乎所有的Word和Excel解析库仅支持某些版本/扩展名。 这就是为什么我们决定使用“ Libre Office”转换将文件转换为单一格式的原因。 例如输入：odt，doc，docx（2007、2010、2013）...转换为docx（2016）。 <br><br> 转换后： <br><br><ol><li> 我们根据基本属性（例如Word或Excel，发件人属于允许列表）过滤出一系列报告模板； </li><li> 使用其余模板威胁报告； </li><li> 如果报告与模板匹配-提取数据并将其传输到存储库。 </li></ol><br><h2> 履历表 </h2><br> 我们做到了！ <br><br> 经过两个月的艰苦努力，总公司开始定期接收所有分支机构的报告数据。 <br><br> 数据质量和完整性比以前更好。 已实现的软件释放了人力资源，这些人力资源可在年底前偿还项目成本。 <br><br> 对于我们自己，我们了解到集成过程并不总是很痛苦，并且已经确定了成功的主要方面： <br><br><ol><li> 我们没有进入分支机构的内部系统； </li><li> 我们确定并批准了统一的报告结构和转让时间表； </li><li> 我们通过内置验证为每种报告类型制作了输出样本； </li><li> 我们使用了最常见的数据传递方式-电子邮件。 </li></ol><br> 最后，这种方法有两个主要缺点： <br><br><ol><li> 数据传输速度慢； </li><li> 数据包的大小不应大于平均电子邮件附件的大小。 </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN436240/">https://habr.com/ru/post/zh-CN436240/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN436230/index.html">如何控制您的网络基础架构。 第三章 网络安全。 第二部分</a></li>
<li><a href="../zh-CN436232/index.html">心灵感应策略</a></li>
<li><a href="../zh-CN436234/index.html">Haskell应用解析器</a></li>
<li><a href="../zh-CN436236/index.html">我们使用数据科学来确定客户的生命周期</a></li>
<li><a href="../zh-CN436238/index.html">使用GitHub OAuth和Dex在Kubernetes中进行身份验证</a></li>
<li><a href="../zh-CN436242/index.html">YOLO和其他宽松方法</a></li>
<li><a href="../zh-CN436244/index.html">劳伦斯教授的新大脑</a></li>
<li><a href="../zh-CN436246/index.html">现代汽车工程-02.关于操作系统的论文</a></li>
<li><a href="../zh-CN436248/index.html">卡尔曼滤波</a></li>
<li><a href="../zh-CN436250/index.html">吸血鬼头目脱离上下文或为何总是失败</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>