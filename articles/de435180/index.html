<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äçüî¨ üòö üëéüèæ Serverlose REST-API "auf dem Knie in 5 Minuten" üï≥Ô∏è üë©üèΩ‚Äç‚úàÔ∏è üéóÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! Heute setzen wir die Diskussion √ºber die M√∂glichkeiten fort, die Amazon Web Services uns bietet, und wie diese M√∂glichkeiten zur L√∂sung vo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Serverlose REST-API "auf dem Knie in 5 Minuten"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435180/">  Hallo Habr!  Heute setzen wir die Diskussion √ºber die M√∂glichkeiten fort, die Amazon Web Services uns bietet, und wie diese M√∂glichkeiten zur L√∂sung von Anwendungsproblemen genutzt werden k√∂nnen. <br><br>  In einem einfachen Beispiel werden wir in Betracht ziehen, in wenigen Minuten unsere eigene serverlose, automatisch skalierbare REST-API mit Fallanalyse zu erstellen - um eine Liste f√ºr eine Ressource zu erhalten. <br><br>  Interessant?  Dann geh unter den Schnitt! <br><br><img src="https://habrastorage.org/webt/o1/lo/od/o1loodoauwe328yyywvsjwxbhpu.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">(Quelle)</a> <br><a name="habracut"></a><br><h2>  Anstatt mitzumachen </h2><br>  Wir werden keine Datenbanken verwenden, um das Beispiel zu analysieren. Stattdessen ist unsere Informationsquelle eine Nur-Text-Datei in AWS S3. <br><br><ul><li>  Angenommen, wir haben in AWS S3 eine Textdatei mit Headern und ein Prozess schreibt Informationen in diese. </li><li>  Wir werden eine Cloud-API erstellen, die eine JSON-Antwort als GET-Anforderung mit dem √ºbergebenen Parameter zur√ºckgibt. </li><li>  Gleichzeitig m√ºssen Sie sich abh√§ngig von der Komplexit√§t der Aufgaben und damit den gestiegenen Anforderungen an die Verarbeitungsleistung von Ressourcen keine Sorgen machen, weil  Der Dienst ist vollst√§ndig automatisch skalierbar.  Dies bedeutet, dass Sie keine Verwaltung, Serverzuweisung und -verwaltung ben√∂tigen. Laden Sie einfach Ihren Code hoch und f√ºhren Sie ihn aus. </li></ul><br><h2>  Architektur des in Entwicklung befindlichen Systems </h2><br><img src="https://habrastorage.org/webt/jm/7r/yb/jm7ryb1z30xucimouckrlyitm6a.png"><br><br>  Verwendete Amazon Web Services-Komponenten: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Amazon S3</b></a> - Objektspeicher, mit dem Sie nahezu unbegrenzt viele Informationen speichern k√∂nnen; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>AWS Identity and Access Management (IAM)</b></a> - Ein Service, mit dem der Zugriff auf AWS-Services und -Ressourcen sicher gesteuert werden kann.  Mit IAM k√∂nnen Sie AWS-Benutzer und -Gruppen erstellen, verwalten, verwalten und mithilfe von Berechtigungen den Zugriff auf AWS-Ressourcen gew√§hren oder verweigern. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>AWS Lambda</b></a> ist ein Dienst, mit dem Sie Code ausf√ºhren k√∂nnen, ohne Server zu sichern und zu konfigurieren.  Die gesamte Rechenleistung wird f√ºr jeden Anruf automatisch skaliert.  Die Geb√ºhr wird basierend auf der Anzahl der Funktionsanforderungen und ihrer Dauer berechnet, d. H.  Zeit, in der der Code ausgef√ºhrt wird. <br><blockquote>  Die Stufe des freien Zugriffs (Free Tier) impliziert 1 Million Anfragen pro Monat f√ºr kostenlosen und 400.000 Gbit / s.  Unterst√ºtzte Sprachen: Node.js, Java, C #, Go, Python, Ruby, PowerShell </blockquote>  .  Wir werden Python verwenden: <br><br><ul><li>  Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>boto3-</b></a> Bibliothek ist ein AWS SDK f√ºr Python, mit dem Sie mit verschiedenen Amazon-Diensten interagieren k√∂nnen. </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Amazon API Gateway</b></a> ist ein vollst√§ndig verwalteter Entwicklerdienst zum Erstellen, Ver√∂ffentlichen, Verwalten, √úberwachen und Sichern von APIs in jeder Gr√∂√üenordnung.  Zus√§tzlich zur M√∂glichkeit, mehrere Versionen derselben API (Stufen) zum Debuggen, Verfeinern und Testen zu verwenden, k√∂nnen Sie mit dem Dienst serverlose REST-APIs mit AWS Lambda erstellen.  Lambda f√ºhrt Code in einer leicht zug√§nglichen Computerinfrastruktur aus, sodass keine Serververteilung, -skalierung und -verwaltung erforderlich ist. <br><blockquote>  Die kostenlose Stufe f√ºr die HTTP / REST-API umfasst eine Million API-Aufrufe pro Monat f√ºr 12 Monate </blockquote></li></ul><br><h2>  Datenaufbereitung </h2><br>  Eine Textdatei mit einer Registerkarte wird als Feldtrennzeichen als Informationsquelle zum Generieren von Antworten auf eine GET REST-Anforderung verwendet.  Die Informationen sind f√ºr dieses Beispiel jetzt nicht mehr wichtig, aber f√ºr die weitere Verwendung der API habe ich die Tabelle des aktuellen Handels mit auf russische Rubel lautenden Anleihen vom Quik-Handelsterminal heruntergeladen, in bonds.txt gespeichert und diese Datei in einem speziell erstellten AWS S3-Bucket abgelegt. <br><br>  Ein Beispiel f√ºr die empfangenen Informationen ist in der folgenden Abbildung dargestellt: <br><br> <a href=""><img src="https://habrastorage.org/webt/ua/yl/na/uaylnacmex2xuts2gnqstudoxii.jpeg"></a> <br><br>  Als N√§chstes m√ºssen Sie eine Funktion schreiben, die Informationen aus der Datei bonds.txt liest, analysiert und auf Anfrage ausgibt.  AWS Lambda wird damit gut zurechtkommen.  Zun√§chst m√ºssen Sie jedoch eine neue Rolle erstellen, mit der die erstellte Lambda-Funktion Informationen aus dem in AWS S3 befindlichen Bucket lesen kann. <br><br><h2>  Erstellen Sie Rollen f√ºr AWS Lambda </h2><br><ol><li>  Wechseln Sie in der AWS-Verwaltungskonsole zum AWS IAM-Dienst und klicken Sie dann auf der Registerkarte "Rollen" auf die Schaltfl√§che "Rolle erstellen". <br><br><div class="spoiler">  <b class="spoiler_title">Hinzuf√ºgen einer neuen Rolle</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/bz/wl/n9/bzwln9pjpdlusmo8cgwv7csvey8.jpeg"><br></div></div></li><li>  Die Rolle, die wir jetzt erstellen, wird von AWS Lambda verwendet, um Informationen aus AWS S3 zu lesen.  W√§hlen Sie daher im n√§chsten Schritt "Typ des vertrauensw√ºrdigen Dienstes ausw√§hlen" -&gt; "Aws-Dienst" und "W√§hlen Sie den Dienst aus, der diese Rolle verwendet" -&gt; "Lambda" und klicken Sie auf die Schaltfl√§che "Weiter: Berechtigungen". <br><br><div class="spoiler">  <b class="spoiler_title">Lambda-Servicerolle</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mq/bh/ik/mqbhikgn46p9m4ul1ulytb1etpk.jpeg"><br></div></div></li><li>  Jetzt m√ºssen Sie die Zugriffsrichtlinien f√ºr die AWS-Ressourcen festlegen, die in der neu erstellten Rolle verwendet werden.  Weil  Die Liste der Richtlinien ist sehr beeindruckend. Wenn Sie den Filter f√ºr Richtlinien verwenden, geben Sie "S3" an.  Als Ergebnis erhalten wir eine gefilterte Liste f√ºr den S3-Dienst.  Aktivieren Sie das Kontrollk√§stchen neben der Richtlinie "AmazonS3ReadOnlyAccess" und klicken Sie auf die Schaltfl√§che "Weiter: Tags". <br><br><div class="spoiler">  <b class="spoiler_title">Richtlinien f√ºr Rollen</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ix/nz/jk/ixnzjk8y4wkt3xo6sntt_ss_q04.jpeg"><br></div></div></li><li>  Der Schritt (Tags hinzuf√ºgen (optional)) ist optional, Sie k√∂nnen jedoch bei Bedarf Tags f√ºr Rollen angeben.  Wir werden dies nicht tun und mit dem n√§chsten Schritt fortfahren - Vorschau.  Hier m√ºssen Sie den Rollennamen "ForLambdaS3-ReadOnly" festlegen, eine Beschreibung hinzuf√ºgen und auf die Schaltfl√§che "Rolle erstellen" klicken. <br><br><div class="spoiler">  <b class="spoiler_title">Titelrollen</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/pf/lc/cj/pflccjxy1lmfker-x-_jmb00m7e.jpeg"><br></div></div></li></ol><br>  Alles, die Rolle wurde geschaffen und wir k√∂nnen sie f√ºr die weitere Arbeit verwenden. <br><br><h2>  Erstellen Sie eine neue Funktion in AWS Lambda </h2><br><ol><li>  Gehen Sie zum AWS Lambda-Service und klicken Sie auf die Schaltfl√§che "Funktion erstellen": <br><br><div class="spoiler">  <b class="spoiler_title">Funktionserstellung</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/lb/9g/mq/lb9gmqf_f2wkakv3y3ta-xgpr_u.jpeg"><br></div></div><br>  F√ºllen Sie alle Felder aus, wie im folgenden Screenshot gezeigt: <br><br><ul><li>  Name - "getAllBondsList"; </li><li>  Laufzeit - "Python 3.6" </li><li>  Rolle - "W√§hlen Sie eine vorhandene Rolle" </li><li>  Bestehende Rolle - hier w√§hlen wir die Rolle aus, die wir oben erstellt haben - ForLambdaS3-ReadOnly </li></ul><br><div class="spoiler">  <b class="spoiler_title">Name und Wahl der Rolle</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/g7/7y/od/g77yodilqokdh3rmtmwk1arsh80.jpeg"><br></div></div></li><li>  Es bleibt nur, den Funktionscode zu schreiben und seine Leistung bei verschiedenen Testl√§ufen zu √ºberpr√ºfen.  Es ist zu beachten, dass die Hauptkomponente jeder Lambda-Funktion (wenn Sie Python verwenden) die boto3-Bibliothek ist: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> boto3 s3 = boto3.resource(<span class="hljs-string"><span class="hljs-string">'s3'</span></span>) bucket = s3.Bucket(<span class="hljs-string"><span class="hljs-string">'your-s3-bucket'</span></span>) obj = bucket.Object(key = <span class="hljs-string"><span class="hljs-string">'bonds.txt'</span></span>) response = obj.get()</code> </pre> <br>  Die Grundidee unserer Python-Funktion lautet wie folgt: <br><br><ul><li>  √ñffnen Sie die Datei bonds.txt. </li><li>  Spalten√ºberschriften lesen; </li><li>  Rekorde nach Seiten brechen (in unserem Fall 10 Sammlungen); </li><li>  W√§hlen Sie die gew√ºnschte Seite aus. </li><li>  Ordnen Sie den Namen der Spalten und Datens√§tze zu. </li><li>  Geben Sie das Ergebnis in Form von Sammlungen an. </li></ul><br>  Wir werden nicht viel Zeit f√ºr den Funktionscode selbst und die technische Implementierung aufwenden, hier ist alles ziemlich einfach und der vollst√§ndige Code ist in meinem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> verf√ºgbar. <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, len(lines_proc)): d = dict((<span class="hljs-string"><span class="hljs-string">u''</span></span>.join(key), <span class="hljs-string"><span class="hljs-string">u''</span></span>.join(value)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (key, value) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(headers, lines_proc[i].split(<span class="hljs-string"><span class="hljs-string">"\t"</span></span>))) response_body.append(d) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">'statusCode'</span></span>: <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-string"><span class="hljs-string">'page'</span></span> : num_page, <span class="hljs-string"><span class="hljs-string">'body'</span></span>: response_body }</code> </pre><br>  F√ºgen Sie den Code (oder schreiben Sie Ihren eigenen :)) in den Block ‚ÄûFunktionscode‚Äú ein und klicken Sie auf die Schaltfl√§che ‚ÄûSpeichern‚Äú in der oberen rechten Ecke des Bildschirms. <br><br><div class="spoiler">  <b class="spoiler_title">Code einf√ºgen</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/py/v7/bz/pyv7bzmaokoa7dxmgc-auhuji7q.jpeg"><br></div></div></li><li>  Erstellen Sie Testereignisse.  Nach dem Einf√ºgen des Codes steht die Funktion zum Starten und Testen zur Verf√ºgung.  Klicken Sie auf die Schaltfl√§che ‚ÄûTest‚Äú und erstellen Sie einige Testereignisse: Starten Sie die Funktion lambda_handler mit verschiedenen Parametern.  N√§mlich: <br><br><ul><li>  Starten einer Funktion mit dem Parameter 'Seite': '100'; </li><li>  Starten einer Funktion mit dem Parameter 'page': '1000000'; </li><li>  Starten einer Funktion mit dem Parameter 'page': 'bla-bla-bla'; </li><li>  Ausf√ºhren einer Funktion ohne den Parameter 'page'. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Testereignis Seite 100</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/f4/lc/s8/f4lcs8v_qj_nmzetyijk0ybngp4.jpeg"><br></div></div><br>  Starten der erstellten Funktion mit dem Senden der Testereignisseite == 100. Wie aus dem folgenden Screenshot ersichtlich, hat die Funktion erfolgreich funktioniert und den Status 200 (OK) sowie eine Sammlung von Sammlungen zur√ºckgegeben, die der hundertsten Seite geteilter Daten mit Paginierung entsprechen. <br><br><div class="spoiler">  <b class="spoiler_title">Testereignis ausl√∂sen Seite 100</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/of/7e/1b/of7e1bgnqpk63gugwnletylpxzk.jpeg"><br></div></div><br>  F√ºr die Reinheit des Experiments werden wir ein weiteres Testereignis starten - "PageBlaBlaBla".  In diesem Fall gibt die Funktion das Ergebnis mit dem Code 415 und einem Kommentar zur√ºck, dass die Richtigkeit der √ºbergebenen Parameter √ºberpr√ºft werden muss: <br><br><div class="spoiler">  <b class="spoiler_title">Testereignis PageBlaBlaBla</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/sp/qt/op/spqtopae3qqqroxxpwmhcdmdmu8.jpeg"><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Ausl√∂sen des PageBlaBlaBla-Ereignisses</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/v3/ms/3x/v3ms3x0jd9pyucqqmnb4qqnful4.jpeg"><br></div></div><br></li></ol><br><h2>  API-Erstellung </h2><br>  Nachdem alle anderen F√§lle getestet wurden und das Verst√§ndnis besteht, dass die Lambda-Funktion wie erwartet funktioniert, erstellen wir die API.  Erstellen Sie einen Zugriffspunkt auf die oben erstellte Lambda-Funktion und richten Sie zus√§tzlich den Schutz vor unerw√ºnschten Starts mithilfe des API-Schl√ºssels ein. <br><br><ul><li>  Wechseln Sie zum AWS API Gateway-Dienst.  Klicken Sie auf die Schaltfl√§che API erstellen und legen Sie den API-Namen fest - getAllBondsList <br><br><div class="spoiler">  <b class="spoiler_title">Erstellen Sie eine neue API</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yc/1q/7z/yc1q7zqud7q7m_fu7gibtsql9-w.jpeg"><br></div></div></li><li>  F√ºgen Sie die GET-Methode zur neu erstellten API hinzu.  W√§hlen Sie dazu Aktionen -&gt; Methode erstellen, w√§hlen Sie die GET-Methode in der Dropdown-Liste aus und klicken Sie auf das H√§kchen <br><br><div class="spoiler">  <b class="spoiler_title">Neue GET-Methode</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/7j/6j/df/7j6jdfyvpyvhzhfv3yjxewkc0lk.jpeg"><br></div></div><br>  Als n√§chstes geben wir an, dass die GET-Methode unsere Lambda-Funktion getAllBondsList verwendet.  W√§hlen Sie es aus und klicken Sie auf die Schaltfl√§che Speichern. <br><br><div class="spoiler">  <b class="spoiler_title">Lambda-Funktionsbindung</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zi/8e/5l/zi8e5ly5xby143omz8p_-oxk4x0.jpeg"><br></div></div></li><li>  Lassen Sie uns unsere API bereitstellen und dabei die URL zum Aufrufen der API erhalten. <br>  Klicken Sie auf Aktionen -&gt; API bereitstellen und dann auf Bereitstellungsphase -&gt; Neue Phase <br><blockquote>  Es ist m√∂glich, die API in verschiedenen Phasen bereitzustellen, und Sie k√∂nnen diese Phasen nach Belieben aufrufen (z. B. DEV / QA / PROD).  Wir werden sofort auf PROD bereitstellen. </blockquote><div class="spoiler">  <b class="spoiler_title">API bereitstellen</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ok/vb/gm/okvbgmwxrrzzcilnvzwisbeoqw4.jpeg"><br></div></div><br>  Nach der Bereitstellung ist ein Link zum Starten der neu erstellten API verf√ºgbar.  Wir werden zu dieser URL in der Adressleiste des Browsers gehen (oder den Befehl curl im Terminal ausf√ºhren) - wir erhalten einen API-Aufruf und starten als Ergebnis die Lambda-Funktion: <br><br><div class="spoiler">  <b class="spoiler_title">API-URL</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/y3/ok/1e/y3ok1esjw61-xjp7uzql21cxdxa.jpeg"><br></div></div><br>  Ich werde die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Postman-</a> Anwendung verwenden, um das AWS API Gateway zu demonstrieren.  Darin k√∂nnen Sie den Betrieb der API ganz bequem debuggen und testen. <br><br><div class="spoiler">  <b class="spoiler_title">Erster API-Test</b> <div class="spoiler_text">  Kopieren Sie die URL von der PROD-Phase zu Postman und senden Sie eine GET-Anfrage an unsere API: <br><br> <a href=""><img src="https://habrastorage.org/webt/bo/ku/3x/boku3xlj9kkoknm0wfnax1ninqg.jpeg"></a> <br><br>  Es scheint etwas schiefgegangen zu sein ... Die GET-Anforderung gab eine JSON-Antwort mit Code 400 und einen Hinweis zur√ºck, dass der Page-Parameter in der API-Aufrufanforderung nicht festgelegt wurde.  Unterst√ºtzung f√ºr Anforderungsparameter zur API hinzuf√ºgen. <br></div></div></li><li>  Unterst√ºtzung f√ºr √ºbergebene Parameter in der Anfrage. <br>  Wir kehren zu den Einstellungen der GET-Anforderung zur√ºck und gehen zum Schritt Methodenanforderung. <br><br><div class="spoiler">  <b class="spoiler_title">Methodenanforderung</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/di/yi/oo/diyioox34z86tv41lrp0oqw8tu4.jpeg"><br></div></div><br>  In den detaillierten Einstellungen der Methodenanforderung m√ºssen Sie den Block URL Query String Parameters erweitern, einen neuen Parameter "page" hinzuf√ºgen und erforderlich machen: <br><br><div class="spoiler">  <b class="spoiler_title">Hinzuf√ºgen eines Parameters</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/j2/rj/gc/j2rjgcaffqvrmq6a6rrh7znhimy.jpeg"><br></div></div><br>  Wir kehren zur Seite Methodenausf√ºhrung zur√ºck und gehen zur Integrationsanforderung.  Wir gehen zum Ende der Seite und √∂ffnen den Block "Mapping Templates".  W√§hlen Sie "Wenn keine Vorlagen definiert sind (empfohlen)" aus, geben Sie im Feld "Inhaltstyp" <b>application / json an</b> und klicken Sie auf das H√§kchen.  Wir scrollen die Seite unten nach unten und geben den Code in das Textfeld ein, wie im Bild unten gezeigt.  Klicken Sie anschlie√üend auf die Schaltfl√§che Speichern. <br><br><div class="spoiler">  <b class="spoiler_title">Methodenanforderung</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ue/s3/y5/ues3y5vyonxozczm7onfg2-351s.jpeg"><br></div></div><br>  Nachdem wir zuvor die API-Bereitstellung durchgef√ºhrt haben, √ºberpr√ºfen wir sie erneut, wobei jedoch der Parameter "page" √ºbergeben wird: <br><br> <a href=""><img src="https://habrastorage.org/webt/s5/-3/v_/s5-3v_kqnx5k3drotwwhw4mltf4.jpeg"></a> <br><br>  Es ist ein Erfolg!  Jetzt hat die Anfrage erfolgreich geklappt und uns die auf der zehnten Seite enthaltenen Sammlungen zur√ºckgegeben!  Hurra! </li><li>  Es bleibt nur, um unsere API vor unerw√ºnschten Angriffen von au√üen zu sch√ºtzen. <br><br>  Dazu m√ºssen Sie die API so konfigurieren, dass beim Zugriff ein geheimer Schl√ºssel erforderlich ist, der an den Header √ºbergeben wird. <br><br>  Gehen Sie zu den API-Schl√ºsseln und erstellen Sie eine neue Reihe von API-Schl√ºsseln - KeyForBondsList. <br><br><div class="spoiler">  <b class="spoiler_title">API-Schl√ºssel</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/su/na/ba/sunaba6acca0mmout5n1yu4xyd8.jpeg"><br></div></div><br>  Nachdem der API-Schl√ºssel erfolgreich erstellt wurde, m√ºssen Sie angeben, dass f√ºr die getAllBondsList-API der API-Schl√ºssel im Anforderungsheader √ºbergeben werden muss.  Binden Sie eine bestimmte KeyForBondsList an die getAllBondsList-API. <br><br>  Kehren wir zu den Einstellungen f√ºr die GET-Anforderung in Method Request zur√ºck und √§ndern Sie den Parameter API Key Required von false in true.  Jetzt erfordert die API die √úbertragung des API-Schl√ºssels. <br><br><div class="spoiler">  <b class="spoiler_title">API-Schl√ºssel erforderlich</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/dn/gu/sy/dngusygxk5h50j4qnbcxt3umkbs.jpeg"><br></div></div><br>  Gehen Sie zu Nutzungsplan und erstellen Sie einen neuen Plan f√ºr die Verwendung der API. <br><br>  Erstens geben wir ihm einen Namen und eine Beschreibung, und zweitens k√∂nnen Sie hier Grenzen f√ºr den Start der API festlegen, z. B. nicht mehr als einen Start pro Sekunde usw. <br><br><div class="spoiler">  <b class="spoiler_title">Nutzungsplan erstellen</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/zl/-3/y9/zl-3y9ruwexssvl3jzpzlocfqpe.jpeg"><br></div></div><br>  Klicken Sie auf Weiter und gehen Sie zur n√§chsten Seite, auf der Sie die Stufen der API mit dem Nutzungsplan verbinden m√ºssen: <br><br><div class="spoiler">  <b class="spoiler_title">Eine Phase an einen Nutzungsplan binden</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/lh/q8/m0/lhq8m0te7ejfwkjz1sftxwznz24.jpeg"><br></div></div><br>  Auf der n√§chsten Seite binden wir die API-Schl√ºssel an den Plan zur Verwendung der API.  Klicken Sie auf die Schaltfl√§che API-Schl√ºssel zum Nutzungsplan hinzuf√ºgen und suchen Sie die erstellten API-Schl√ºssel in den vorherigen Schritten nach Namen: <br><br><div class="spoiler">  <b class="spoiler_title">API-Schl√ºssel an Nutzungsplan binden</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/y2/p0/8c/y2p08c59ly3trqt6kjhlbud2tmg.jpeg"><br></div></div><br>  Nachdem wir die Bereitstellung durchgef√ºhrt und den GET-Aufruf unserer API erneut ausgef√ºhrt haben, erhalten wir die Antwort: "Verboten", weil  Dem Anforderungsheader fehlt der API-Schl√ºssel: <br><br> <a href=""><img src="https://habrastorage.org/webt/oy/z9/39/oyz939fbfo9e6g-xpbujygkhj3o.jpeg"></a> <br><br>  Versuchen wir, es durch Kopieren von den API-Schl√ºsseln -&gt; KeyForBondsList -&gt; API-Schl√ºssel -&gt; Anzeigen und Einf√ºgen in den entsprechenden Abschnitt der Anforderung mit dem Schl√ºssel "x-api-key" hinzuzuf√ºgen: <br><br> <a href=""><img src="https://habrastorage.org/webt/vc/ml/l5/vcmll5c2bbyazujggy7orazylbm.jpeg"></a> <br><br>  Alles hat geklappt!  Diesmal gibt die Anforderung problemlos Daten zur√ºck. Der API-Aufruf ist sicher und durch den geheimen API-Schl√ºssel vor Eindringlingen gesch√ºtzt. </li></ul><br><h2>  Schlussfolgerungen und Zusammenfassung </h2><br>  In diesem Artikel haben wir uns mit der Erstellung einer serverlosen, automatisch skalierbaren REST-API mithilfe von Amazon Cloud-Diensten befasst.  Der Artikel war nicht der kleinste, aber ich habe versucht, den gesamten Prozess der Erstellung der API so weit wie m√∂glich zu erkl√§ren und die gesamte Abfolge von Aktionen zu erstellen. <br><br>  Ich bin sicher, dass Sie nach ein oder zwei Wiederholungen der im Artikel beschriebenen Schritte Ihre Cloud-APIs in 5 Minuten oder noch schneller erh√∂hen k√∂nnen. <br><br>  Aufgrund seiner relativen Einfachheit, Preisg√ºnstigkeit und Leistung bietet der AWS API Gateway-Service Entwicklern zahlreiche M√∂glichkeiten zur Verwendung in der Arbeit und in kommerziellen Projekten.  Um das theoretische Material in diesem Artikel zu konsolidieren, melden Sie sich f√ºr ein kostenloses Jahresabonnement f√ºr Amazon Web Services an und f√ºhren Sie die oben genannten Schritte aus, um eine REST-API zu erstellen. <br><br>  Bei Fragen und Anregungen stehe ich Ihnen gerne zur Verf√ºgung.  Ich freue mich auf Ihre Kommentare zum Artikel und w√ºnsche Ihnen viel Erfolg! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de435180/">https://habr.com/ru/post/de435180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de435170/index.html">Ein Blick auf das Apple Watch EKG f√ºr jemanden, der sich interessiert</a></li>
<li><a href="../de435172/index.html">Oculus GoBlack - wie man Oculus Go verbessert</a></li>
<li><a href="../de435174/index.html">Unreal Engine 4 - brennender Shader</a></li>
<li><a href="../de435176/index.html">DEFCON 21. Passw√∂rter allein reichen nicht aus, oder warum wird die Festplattenverschl√ºsselung unterbrochen und wie kann dies behoben werden? Teil 1</a></li>
<li><a href="../de435178/index.html">DEFCON 21. Passw√∂rter allein reichen nicht aus, oder warum wird die Festplattenverschl√ºsselung unterbrochen und wie kann dies behoben werden? Teil 2</a></li>
<li><a href="../de435182/index.html">Studie: Der HDD-Markt wird bis 2021 um ein Drittel schrumpfen</a></li>
<li><a href="../de435184/index.html">K√ºnstliche Intelligenz lernte 6 Jahre vor der Diagnose, die Alzheimer-Krankheit im Gehirn zu finden</a></li>
<li><a href="../de435186/index.html">Rolls-Royce entwickelt das schnellste Elektroflugzeug der Welt</a></li>
<li><a href="../de435190/index.html">Google hat es geschafft, √ºber Irland und Bermuda Steuern von 22,7 Milliarden US-Dollar abzuziehen</a></li>
<li><a href="../de435194/index.html">Vereinfachen Sie das Schreiben eines Lebenslaufs eines Entwicklers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>