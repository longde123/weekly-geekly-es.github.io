<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👼🏻 🖐️ 🧗🏼 Otomatisasi proses bisnis di Excel atau cara menyelamatkan seorang gadis dari pemrosesan 🚵🏽 🤳🏻 🎂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pacar saya terlibat dalam pembelian di jaringan distribusi. Baru-baru ini, perusahaan telah mengalami pengurangan besar, sehingga jumlah pekerjaan per...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Otomatisasi proses bisnis di Excel atau cara menyelamatkan seorang gadis dari pemrosesan</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447346/">  Pacar saya terlibat dalam pembelian di jaringan distribusi.  Baru-baru ini, perusahaan telah mengalami pengurangan besar, sehingga jumlah pekerjaan per karyawan telah meningkat secara dramatis.  Karena itu, ia harus tetap bekerja, kadang-kadang bahkan keluar pada hari Sabtu.  Rekan-rekannya memiliki masalah yang sama. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/725/1cf/243/7251cf24339c88fbb1448a17850bb254.jpg" alt="gambar"><br><br>  Tentang keputusan yang memungkinkan pacar saya pulang tepat waktu, Anda dapat membaca di bawah potongan. <br><a name="habracut"></a><br>  Selain itu, sebagian besar dari apa yang mereka lakukan dapat diotomatisasi: menerima data dari depan, mengisi dokumen excel, memperbarui data di depan, dll. <br><br>  Hal paling masuk akal yang bisa dilakukan dalam situasi ini adalah menulis pernyataan kerja tentang pengembangan fungsionalitas yang diperlukan dan meneruskannya kepada pengembang melalui otoritas.  Namun, pengurangan mempengaruhi semua orang, termasuk pengembang.  Akibatnya, mereka tidak memiliki sumber daya yang cukup untuk mengimplementasikan otomatisasi ini.  Dan perusahaan tidak berencana untuk membeli sistem RPA khusus di masa mendatang. <br><br>  Selain itu, peningkatan pemantauan terhadap apa yang dilakukan karyawan di tempat kerja dan dalam aplikasi apa mereka bekerja. <br><br>  Berdasarkan hasil dari semua keadaan yang merugikan ini dan keinginan saya yang luar biasa untuk membantu, saya memutuskan untuk menulis fungsi untuk Excel di VBA, berkat yang memungkinkan untuk mengotomatiskan operasi rutin pacar saya dan rekan-rekannya. <br><br><h3>  Persyaratan produk </h3><br>  Sebagai titik awal, saya memilih tugas yang menghabiskan sebagian besar waktunya menurut perasaannya.  Sebagai bagian dari tugas ini, gadis itu membutuhkan: <br><br><ul><li>  Transfer nomor artikel dari file excel ke bar pencarian sistem front-office; </li><li>  Untuk artikel ini, dari hasil pencarian, dapatkan pembelian, harga jual, sejumlah nilai tambahan; </li><li>  Memproses data yang dikumpulkan dalam excel untuk membuat harga produk akhir; </li><li>  Unggah harga kembali ke sistem. </li><li>  Membongkar dan memuat data berikutnya per hari membutuhkan waktu sekitar 3 jam. </li></ul><br>  Mengingat bahwa pacar saya tidak memiliki pengetahuan pemrograman, maka perlu untuk membuat alat dengan antarmuka yang sederhana dan akrab dalam bentuk fungsi di excel.  Urutan tindakan harus didefinisikan hanya sebagai urutan fungsi.  Singkatnya, <b>CIUMAN</b> . <br><br>  Berdasarkan kasus ini, saya membentuk persyaratan fungsional berikut: <br><br><ul><li>  Kontrol mouse (gerakkan, keystroke) untuk menyorot elemen yang sesuai pada layar; </li><li>  Simulasikan penekanan tombol pada keyboard untuk memasukkan data; </li><li>  Transfer data dari Excel ke aplikasi pihak ketiga; </li><li>  Mengambil data dari aplikasi di Excel; </li><li>  Melakukan operasi yang sama saat menarik formula di Excel. </li></ul><br><h3>  Mouse dan kesulitan pertama </h3><br>  Sebelum memindahkan kursor ke mana saja, Anda harus memahami persis ke mana harus memindahkannya.  Menurut saya yang paling tepat dalam situasi ini adalah hanya mengingat posisi kursor ketika elemen tersebut melebihi elemen tertentu.  Untuk mengingat koordinat, saya menggunakan fungsi GetCursorPos dari perpustakaan user32. <br><br>  Nah, kami punya koordinatnya, sekarang akan menyenangkan untuk mengingatnya.  Ya, tidak ada yang rumit, saya pikir, hitung saja satu atau dua sel dari sel aktif dan tuliskan koordinat X dan Y. Namun, ActiveCell.Offset (0, 1). Nilai = x tidak berfungsi.  Nilai tidak berubah.  Dan sebagai akibat dari eksekusi, kesalahan.  Setelah memeriksa berbagai asumsi, ternyata bahwa mengubah nilai pada lembar mengarah ke penghitungan ulang seluruh lembar, dan karenanya rumus yang menyebabkan penghitungan ini.  Untuk mengatasi pembatasan ini, alih-alih panggilan langsung dari fungsi tindakan tertentu, Anda perlu mengganti panggilan ini dengan Evaluate, yang memungkinkan kami mencapai hasil yang diinginkan. <br><br>  Hasilnya adalah fungsi PrintCursorPosition (), yang direkam dalam dua sel di sebelah kanan posisi kursor pada saat fungsi dieksekusi.  Itu perlu untuk mengetik PrintCursorPosition () di area untuk memasukkan formula, pindahkan kursor dan tekan enter pada keyboard. <br><br>  Untuk memindahkan mouse, saya menggunakan SetCursorPos dari pustaka user32 yang sama.  Untuk menggunakan fungsi ini, ia harus melewati nilai koordinat x dan y yang sebelumnya disimpan sebagai input.  Menggunakan SetCursorPosition (x, y), saya dapat memindahkan kursor ke koordinat yang tersimpan sebelumnya.  Hasil yang terlihat pertama.  Hore! <br><br>  Untuk mensimulasikan tindakan mouse, saya menggunakan mouse_event dari perpustakaan user32 yang sama.  Dengan mengedarkan bendera tombol ke input, saya dapat mensimulasikan penekanan tombol yang sesuai.  Awalnya, saya berencana untuk menulis satu fungsi MouseButtonPrees (flag), di mana flag adalah penunjukan tombol yang ditekan, tetapi setelah demonstrasi pertama, gadis itu menyadari bahwa lebih baik untuk mengganti grup fungsi LeftClick (), RightClick () dan DoubleClick ().  Pendekatan ini memudahkan untuk membaca fungsi yang dihasilkan. <br><br><h3>  Keyboard </h3><br>  Di VBA, ada pernyataan SendKeys yang melakukan semua tindakan yang diperlukan.  Teks dengan mudah diteruskan ke fungsi dengan merujuk ke sel dan memenuhi tanpa masalah.  Namun, menekan tombol khusus (Enter, Tab, Alt, Ctrl, panah keyboard, dll.) Menyebabkan penolakan (untuk menekannya, perlu untuk menuliskannya dalam kurung keriting {ENTER}).  Oleh karena itu, untuk yang paling sering digunakan, saya menulis fungsi seperti PressEnter ().  Untuk yang jarang digunakan, saya membuat lembar contekan di dokumen yang sama. <br><br>  Informasi ditransfer antara sistem dan Excel melalui penyalinan ke buffer dan menempel dari buffer.  Menyalin ke buffer pada dasarnya dilakukan dengan mensimulasikan menekan Control + C, setelah itu data dari buffer dibawa ke MSForms.DataObject dan dipindahkan ke sel tertentu. <br><br><h3>  Masalah pengujian dan kinerja </h3><br>  Masalahnya segera dimulai. <br><br>  Proses penulisan urutan tindakan skrip terdiri dari menyusun kelompok tindakan kecil dan menggabungkannya menjadi satu.  Tetapi ketika beralih ke sel bebas, seluruh urutan segera berhasil, yang sangat menjengkelkan, terutama jika waktu yang dibutuhkan untuk kelompok tindakan untuk mengambil lebih dari 10 detik.  Untuk mengatasi masalah ini, saya memeriksa keberadaan dalam teks formula dari sel aktif dari nama fungsi.  Itu membantu. <br><br>  Selain itu, selama pengujian, ia menambahkan fungsi tunggu WaitS (detik) dan WaitMS (milidetik), untuk melacak apa yang berhasil dan apa yang tidak.  Ini didasarkan pada Sleep dari perpustakaan kernel32.  Perbedaan antara WaitS dan WaitMS adalah bahwa dalam waktu WaitMS dalam milidetik, dan dalam WaitS dalam detik. <br><br>  Masalah lain adalah eksekusi fungsi yang tidak konsisten ketika ditarik ke dalam sel.  Ini disebabkan oleh perhitungan Excel yang tidak sinkron.  Dia mendistribusikan perhitungan setiap sel ke prosesor yang berbeda.  Akibatnya, urutan ini pertama kali dieksekusi di sel dua, lalu di kelima, lalu di ketiga, dll.  Selain itu, urutannya sendiri dilakukan dari awal hingga akhir tanpa masalah.  Untuk menghilangkan perilaku ini, saya mematikan perhitungan multi-utas di pengaturan Excel (Pengaturan Excel -&gt; Tingkat Lanjut -&gt; Rumus). <br><br><h3>  Hasil </h3><br>  Setelah menjelaskan cara bekerja dengan semua ini dan belajar cara menggunakannya, ia melepaskan pacarnya untuk mengotomatiskan proses di perusahaan dengan cara yang tidak tahu berterima kasih. <br><br>  Berkat otomatisasi seperti itu, ternyata mengurangi waktu dari tiga jam menjadi 30 menit.  Pada saat yang sama, otomatisasi memungkinkan untuk sedikit mengubah pendekatan pada proses mengunggah dan mengunduh data.  Sekarang bongkar muat terjadi pada saat pacar saya pergi makan siang dan memuat di malam hari.  Dengan demikian, kita dapat mengatakan bahwa bebannya berkurang hampir setengah hari kerja, yang memungkinkan pacar saya pulang tepat waktu dan kita dapat melakukan lebih banyak hal menarik daripada otomatisasi. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id447346/">https://habr.com/ru/post/id447346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id447334/index.html">Contoh strategi konten untuk mempromosikan toko suku cadang senjata online</a></li>
<li><a href="../id447336/index.html">Memantau Sumber Daya Kubernetes Cluster</a></li>
<li><a href="../id447338/index.html">Intel 0x7E3 Musim Panas Magang Menunggu Siswa</a></li>
<li><a href="../id447342/index.html">Piramida Non-Mars: Mempelajari Bentuk Cluster Nanokristalin di bawah Lapisan Graphene</a></li>
<li><a href="../id447344/index.html">Fitur baru di Webmaster</a></li>
<li><a href="../id447348/index.html">Sebuah studi tentang konektivitas mata uang dunia melalui korelasi tingkat absolut</a></li>
<li><a href="../id447350/index.html">Pertemuan Sistem Operasi Robot Rusia 2019</a></li>
<li><a href="../id447352/index.html">Parsing: Apa itu Ekspresi Redundan dalam Bahasa Inggris</a></li>
<li><a href="../id447354/index.html">Metode universal untuk memecahkan masalah pada contoh puzzle "12 koin, 3 penimbangan"</a></li>
<li><a href="../id447356/index.html">Topik Top 3D Expo: Pencetakan 3D dalam penyetelan otomatis, Artem Solomnikov, Imprint</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>