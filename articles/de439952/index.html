<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôçüèΩ ‚öîÔ∏è ü§ûüèæ Hosten von Node.js https-Server mit automatisch aktualisiertem SSL in der Cloud und wie ich den Entwicklungszyklus einrichte (+ git, reagieren) ü§º ‚úçÔ∏è üë≥üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vorwort 
 Zun√§chst wollte ich eines Tages eine Anwendung erstellen. Dieser Wunsch entstand, weil ich gerne lese, aber es gibt einfach keine normalen B...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hosten von Node.js https-Server mit automatisch aktualisiertem SSL in der Cloud und wie ich den Entwicklungszyklus einrichte (+ git, reagieren)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439952/"><h2>  Vorwort </h2><br>  Zun√§chst wollte ich eines Tages eine Anwendung erstellen.  Dieser Wunsch entstand, weil ich gerne lese, aber es gibt einfach keine normalen Buchaggregatoren im riesigen russischen Internet.  Aus dem Schmerz heraus, nach etwas zum Lesen zu suchen und zu versuchen, sich an den Namen des Buches zu erinnern, das ich k√ºrzlich gelesen habe, und an das Kapitel, bei dem ich angehalten habe, entstand der Wunsch, eine Webanwendung zu erstellen, in der all dies m√∂glich und bequem w√§re.  Es ist erw√§hnenswert, dass keine Erfahrung in Entwicklung, Programmierung usw.  Ich hatte keine, meine Arbeit ist damit √ºberhaupt nicht verbunden.  Trotzdem √ºberwand das Verlangen die Faulheit und entwickelte sich zu konkreten Handlungen, einer Art Hobby. <br><br>  Ich werde nicht sagen, wie ich Javascript, node.js, Reaktion, HTML, CSS usw. studiert habe. Wir werden zu dem √ºbergehen, worauf ich gerade gekommen bin, was ich mit Ihnen teilen m√∂chte und nat√ºrlich konstruktive Kritik an Spezialisten h√∂ren. <br><br>  Wie viele andere habe ich auf localhost auf meinem eigenen PC trainiert: 3000, Front / Back-Ends erstellt, gesetzt, mit API gearbeitet usw., aber ich war immer besorgt dar√ºber, wie ich das alles sp√§ter auf das Hosting √ºbertragen kann?  Wird es funktionieren?  Wird es aus diesem Grund notwendig sein, den Code neu zu schreiben?  <b>Und was am wichtigsten ist: Ist es m√∂glich, alles so zu konfigurieren, dass ich von jedem PC aus an der Anwendung arbeiten und alles problemlos auf das Hosting in der Produktion √ºbertragen kann?</b>  <b>Ich werde dar√ºber sprechen.</b> <br><a name="habracut"></a><br><h2>  Hosting-Wahl </h2><br>  F√ºr mein Hobby war ich bereit, 10 US-Dollar im Monat auszugeben, und entschied mich f√ºr das Hosting, bei dem ich in Zukunft bleiben wollte.  Wie gesagt, vorher hatte ich 0 Erfahrung, auch mit Site-Hosting.  Ich habe Folgendes versucht und abgelehnt: <br><br>  <b>Jelastic</b> : sch√∂ne und benutzerfreundliche Oberfl√§che, alles scheint intuitiv, skalierbar und verst√§ndlich zu sein.  Trotzdem hatte ich Schwierigkeiten beim Einrichten (nginx wollte aus irgendeinem Grund nicht von vps aus arbeiten, nur mit ihrem separaten Modul) und beim Verbinden von SSL (und automatischer Aktualisierung) mit der russischsprachigen Domain mit Standardmitteln (sie versprachen, den Fehler zu beheben, aber ich m√∂chte nicht warten) <br><br>  <b>Cloud-Hosting REG.RU</b> : Ich habe genau dort auch eine Domain, daher schien die L√∂sung logisch, aber PostgreSQL war nicht separat konfiguriert. Da ich mich nicht an die Datenbankverwaltung wenden wollte, suchte ich weiter. <br><br>  <b>AWS und Google Clouds</b> : Ich habe es versucht, alles scheint in Ordnung zu sein, aber ich erinnerte mich an unsere ‚Äûwunderbaren‚Äú Gesetze und die Anforderung, Benutzerdaten auf Servern in der Russischen F√∂deration zu speichern.  Leider hatten diese Leute keine Server in der Russischen F√∂deration.  Kein Anwalt, sondern aus S√ºnde beschlossen, nach Clouds mit Servern in der Russischen F√∂deration zu suchen.  <b>Wenn es unwahrscheinlich ist, dass Ihre Bewerbung Probleme mit dem Gesetz hat, ist dies eine gute Wahl.</b> <br><br>  Obwohl es in der Russischen F√∂deration Clouds mit Servern gab, wollte ich immer noch etwas, das mich davon abh√§lt, in die PostgreSQL-Administration einzutauchen.  Der Impuls kam vor nicht allzu langer Zeit auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yandex.Wolken</a> , die verf√ºgbar wurden, habe ich versucht, es scheint, dass alles einfach und bequem ist, also habe ich vorerst bei ihnen angehalten.  Es ist erw√§hnenswert, dass das PostgreSQL-Hosting sofort mit 1core und 4 GB RAM geliefert wird, was ungef√§hr 2.000 Rubel pro Monat kostet. F√ºr die Zeit der Entwicklung und der geringen Auslastung plane ich, PostgreSQL auf VPS f√ºr ~ 300r auszuf√ºhren und die Datenbank mit erh√∂hter Auslastung zu √ºbertragen und zuzulassen Yandex ist mit der Verwaltung und Aktualisierung besch√§ftigt. <br><br><h2>  Yandex.Cloud einrichten </h2><br><h3>  Virtuelle private Cloud </h3><br>  1) Erstellen Sie ein Verzeichnis f√ºr Ihre Site: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/35e/3de/581/35e3de5819d0344d34cc9a03251cbf65.png" alt="Bild"><br><br>  2) Erstellen Sie eine virtuelle private Cloud: <br><br>  Die Hauptsache, die er mir derzeit gibt, ist die IP, um von au√üen auf die erstellte Ressource zuzugreifen.  Ich habe mich oberfl√§chlich mit Subnetzen, Zonen, Isolation und Fehlertoleranz vertraut gemacht, wenn n√∂tig, werde ich aufholen. <br><br>  3) Erstellen Sie ein Subnetz und weisen Sie ihm eine interne IP zu (so wie ich es verstehe, handelt es sich um ein lokales Netzwerk). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f25/42d/f6c/f2542df6c7141d6e96738f6f1d3e6cf1.png" alt="Bild"><br><br>  4) Gehen Sie zur Registerkarte IP und reservieren Sie sich eine statische IP. <br><br>  Darauf werden wir uns von zu Hause und anderen Orten aus verbinden.  Sie k√∂nnen wahrscheinlich mit Dynamic arbeiten, aber ich habe nicht verstanden, in welchen F√§llen sich dies √§ndert. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/47c/ef6/265/47cef626515785d83ba86cb6f5f8c185.png" alt="Bild"><br><br><h3>  Cloud berechnen </h3><br>  Hier werden wir Berechnungen haben :) Das hei√üt, wir werden eine virtuelle Maschine mit Linux erstellen (ich habe Ubuntu 18.04 gew√§hlt), node.js-Anwendungen und postgreSQL installieren. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/293/e0c/265293e0c462dd9dd2452874799c2157.png" alt="Bild"><br><br>  Wir klicken, um eine VM zu erstellen, und schrauben alle Einstellungen auf ein Minimum ab, da w√§hrend der Entwicklung keine Last entsteht (wenn unsere Anwendung ver√∂ffentlicht wird, drehen Sie sie ein wenig weiter, und wir werden sie anhand der Grafiken √ºberwachen). <br><br><h4>  Ssh </h4><br>  Der Problempunkt, auf den ich zu diesem Zeitpunkt gesto√üen bin, ist SSH: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/687/476/389/68747638934544e751f6a0b21f43e683.png" alt="Bild"><br><br>  Was es war und warum ich keine Ahnung hatte, ging ich zum Lernen.  Es stellte sich heraus, dass dies nur eine Zugriffsmethode ist, jedoch nicht √ºber das Kennwort, sondern √ºber den generierten SSH-Schl√ºssel.  Laden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Putty</a> herunter und installieren Sie es, um es tats√§chlich zu generieren. <br><br>  F√ºhren Sie C: \ Programme \ PuTTY \ puttygen.exe aus <br><br><img src="https://habrastorage.org/getpro/habr/post_images/333/03a/e02/33303ae02d9b14983cf0627087dfd8ee.png" alt="Bild"><br><br>  Wir dr√ºcken die Generieren-Taste und bewegen die Maus, um der generierten Taste Zuf√§lligkeit zu verleihen (so wie ich es verstehe).  Kopieren Sie als N√§chstes die Zeile, die mit ssh-rsa beginnt, irgendwo in die Textdatei und klicken Sie auf Privaten Schl√ºssel speichern, √ñffentlichen Schl√ºssel speichern.  Der in die Textdatei kopierte Schl√ºssel wird in das SSH-Feld des Schl√ºssels der Yandex Yandex-Seite eingef√ºgt.  Wir geben root als Login an, andernfalls haben Sie keinen Zugriff, wenn Sie mit dem Grafikdateisystem der Anwendung arbeiten, √ºber das Sie von zu Hause / von der Arbeit aus eine Verbindung zur Cloud herstellen (m√∂glicherweise gibt es einen Weg, aber ich habe ihn nicht verstanden). <br>  <b>Wie von andreymal festgestellt, ist es besser, root nicht zu verwenden, damit chinesische Bots das Passwort f√ºr Ihre Cloud nicht abrufen. Da Yandex.cloud jedoch nur √ºber SSH-Zugriff verf√ºgt, k√∂nnen Sie so leben.</b> <b><br><br></b>  <b>Eine Anwendung auf einem Hosting sollte ausschlie√ülich von einem Nicht-Root-Benutzer gestartet werden, damit Angreifer keinen sch√§dlichen Code durch m√∂gliche Schwachstellen in Ihrer Anwendung ausf√ºhren k√∂nnen.</b> <b><br></b> <br><br><h3>  Wir stellen von einem PC aus eine Verbindung zur Cloud her und w√§hlen einen kostenlosen SSH-Client aus </h3><br>  Mit dem Standard-Putty k√∂nnen Sie nur in der Befehlszeile arbeiten. Da ich mit dem Windows-Benutzer nicht vertraut bin, habe ich nach einem Client mit einem Pseudo-Explorer gesucht.  Zuerst habe ich Mobaxterm ausprobiert, aber nach einiger Zeit der Inaktivit√§t wird es heruntergefahren, der Explorer friert vollst√§ndig ein. Jetzt arbeite ich mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bitvise ssh</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sehe</a> bisher keine Probleme wie Mobaxterm. <br><br><h3>  Konfigurieren Sie bitvise ssh </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/8a2/019/f4c/8a2019f4cafa7b44ef72286664175010.png" alt="Bild"><br><br>  Geben Sie hier im Feld Server&gt; Host unsere externe IP-Cloud an.  Port 22. Klicken Sie auf Client Key Manager&gt; Importieren und geben Sie den zuvor generierten privaten Schl√ºssel an.  M√∂glicherweise ben√∂tigen Sie noch einen Schl√ºsselbegriff. W√§hlen Sie etwas aus, das Sie nicht vergessen werden.  Schlie√üen Sie dieses Fenster und geben Sie den Benutzernamen im Authentifizierungsfeld an: root, Methodenver√∂ffentlichungsschl√ºssel, Clientschl√ºssel - w√§hlen Sie den zuvor importierten aus.  Klicken Sie auf Anmelden. Wenn wir alles richtig gemacht haben, stellen Sie eine Verbindung zur Cloud her: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b4b/e6a/a9d/b4be6aa9df15651829c0b23749f18b41.png" alt="Bild"><br><br><h2>  Installieren Sie Node.js. </h2><br>  Hier empfehle ich die Anweisungen von digitalocean.com zu verwenden, sie sind sehr detailliert und viele sind in russischer Sprache.  Normalerweise google ich "digitalocean ubuntu 18.04 node.js" oder was auch immer Sie dort installieren oder konfigurieren m√∂chten. <br><br>  Wie Sie Node.js installieren, lesen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br>  Kurz gesagt, wir gehen zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nodeource</a> (hier k√∂nnen die neuesten Versionen von node.js installiert werden) und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bl√§ttern</a> hier durch: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3ad/aa7/0c9/3adaa70c90a1466c1a55b71eb25f2105.png" alt="Bild"><br><br>  Kopieren Sie die Befehle und f√ºhren Sie sie nacheinander aus: <br><br><pre><code class="javascript hljs">curl -sL https:<span class="hljs-comment"><span class="hljs-comment">//deb.nodesource.com/setup_11.x | sudo -E bash - sudo apt-get install -y nodejs</span></span></code> </pre> <br>  Wir √ºberpr√ºfen, wie es vom Team eingerichtet wurde <br><br><pre> <code class="javascript hljs">nodejs -v</code> </pre> <br>  Wir werden die Version von node.js sehen <br><br><pre> <code class="javascript hljs">npm -v</code> </pre> <br>  Wir sehen die Version des Paketmanagers f√ºr node.js. <br><br>  Wechseln Sie als N√§chstes zum Ordner / opt / mysuperapp (my_super_app_name - Sie m√ºssen diesen Ordner erstellen).  Das opt-Verzeichnis wurde nach langem googeln als Speicherort der Anwendung ausgew√§hlt, "wo es angebracht ist, die node.js-Dateien der Anwendung in ubuntu abzulegen". <br><br>  Erstellen Sie abschlie√üend die Datei server.js, die der Einstiegspunkt der Anwendung sein wird, und f√ºgen Sie dort den einfachen Servercode in node.js ein: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> http = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'http'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hostname = <span class="hljs-string"><span class="hljs-string">'localhost'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> port = <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> server = http.createServer(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) =&gt;</span></span> { res.statusCode = <span class="hljs-number"><span class="hljs-number">200</span></span>; res.setHeader(<span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>, <span class="hljs-string"><span class="hljs-string">'text/plain'</span></span>); res.end(<span class="hljs-string"><span class="hljs-string">'Hello World!\n'</span></span>); }); server.listen(port, hostname, () =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Server running at http://</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${hostname}</span></span></span><span class="hljs-string">:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${port}</span></span></span><span class="hljs-string">/`</span></span>); });</code> </pre> <br>  Port 80 ist f√ºr http-Anfragen, 443 f√ºr https.  W√§hrend wir einen Server auf http haben. <br><br>  Wir speichern alles und f√ºhren den Befehl aus: <br><br><pre> <code class="plaintext hljs">node server.js</code> </pre> <br>  In der Konsole sollte die Zeile "Server l√§uft auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">localhost</a> : 80 /" angezeigt werden. <br><br>  Jetzt k√∂nnen Sie einen Browser √∂ffnen, eine externe IP eingeben (die in der Yandex-Cloud Ihrer Ubuntu-VM) und wir sehen "Hallo Welt!" <br><br><h2>  Wir machen alles bequem oder den Entwicklungszyklus mit git </h2><br>  Alles scheint zu funktionieren, aber wir werden nicht die ganze Zeit daran arbeiten, eine Verbindung zur Cloud herzustellen.  Au√üerdem werden wir in Zukunft pl√∂tzlich nicht mehr alleine arbeiten. <br><br><h2>  Github </h2><br>  Github ist der Ort, an dem der Code unserer Anwendung liegen wird.  Kurz gesagt, das Arbeitsprinzip f√ºr eine Person lautet wie folgt: <br><br><ul><li>  Wir entwickeln unsere Anwendung auf einem Heim-PC. </li><li>  Wir speichern und entladen den Code auf Github mit einem Klick. </li><li>  Laden Sie auf dem Hosting oder auf einem anderen PC unsere Anwendung von github herunter, starten Sie den Server neu (falls er gehostet wird) und die neue Version unserer Webanwendung ist im World Wide Web verf√ºgbar. </li></ul><br>  Alles ist schnell, einfach und bequem. <br><br>  Registrieren Sie sich tats√§chlich bei Github und erstellen Sie ein privates Repository f√ºr unsere Anwendung (es steht nur uns zur Verf√ºgung): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a10/e93/4b3/a10e934b3516444c1c8aad1b45035494.png" alt="Bild"><br><br>  Kopieren Sie die Zeile <a href="">github.com/ReTWi/mysuperapp.git</a> , um die Anwendung herunterzuladen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/465/959/824/4659598241a27171fbbaa8e61c3a66c2.png" alt="Bild"><br><br><ol><li>  Wir kehren zur Bitvise-Befehlszeile zur√ºck und stoppen die Anwendung durch Dr√ºcken von Strg + C (falls dies noch funktioniert). </li><li>  Wechseln Sie in das Verzeichnis / opt und l√∂schen Sie den Ordner mit der von uns erstellten Anwendung </li></ol><br>  Git wird verwendet, um unsere Anwendung auf github und von dort auf ein Hosting oder einen anderen PC hochzuladen.  Git ist ein separates Diskussionsthema, also lassen Sie uns zun√§chst darauf eingehen. <br>  Installieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">git auf dem Hosting</a> mit den folgenden Befehlen: <br><br><pre> <code class="javascript hljs">sudo apt update sudo apt install git</code> </pre> <br>  √úberpr√ºfen Sie, ob alles gut etabliert ist: <br><br><pre> <code class="javascript hljs">git --version</code> </pre> <br>  Die Git-Version sollte erscheinen. <br><br>  Wir geben die Git-Daten ein (ich habe nicht verstanden, warum, aber anscheinend gibt es einige langweilige Warnungen). <br><br><pre> <code class="javascript hljs">git config --global user.name <span class="hljs-string"><span class="hljs-string">"Your Name"</span></span> git config --global user.email <span class="hljs-string"><span class="hljs-string">"youremail@domain.com"</span></span></code> </pre> <br>  Schlie√ülich laden wir unsere Anwendung mit dem folgenden Befehl auf das Hosting hoch: <br>  (Es sollte einen Link zu Ihrer Bewerbung geben.) <br><br><pre> <code class="javascript hljs">git clone https:<span class="hljs-comment"><span class="hljs-comment">//github.com/ReTWi/mysuperapp.git</span></span></code> </pre> <br>  Eine neue mysuperapp wird im Verzeichnis / opt angezeigt, in dem sich unsere von github heruntergeladenen Anwendungsdateien befinden. <br><br>  Jetzt ist es Zeit, dasselbe f√ºr den PC zu wiederholen und die PC-Kette zu schlie√üen (anders) -&gt; Github -&gt; Hosting <br><br>  Installieren Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">node.js auf dem PC</a> . <br><br><h2>  Visual Studio Code </h2><br>  W√§hlen Sie zun√§chst den Quellcode-Editor aus, in dem wir arbeiten werden.  Ich habe mich f√ºr Visual Studio-Code entschieden, damit er einfach und bequem ist, viele Plugins enth√§lt und Sie die Synchronisierung von Einstellungen konfigurieren k√∂nnen, wenn Sie mit mehreren Ger√§ten arbeiten.  Tats√§chlich laden wir den freigegebenen Anwendungsordner herunter, installieren ihn, starten ihn und w√§hlen ihn aus, da der Git-Klon einen eigenen f√ºr uns erstellt. <br><br>  Die Plugins, die ich benutze, sind wie folgt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7e5/5c2/17f/7e55c217f685490573a70f44970e0780.png" alt="Bild"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Installieren Sie git f√ºr PC</a> . <br>  √ñffnen Sie eine Konsole in VScode mit Strg + Umschalt + `oder Terminal&gt; Neues Terminal <br><br>  <i>R√ºckzug:</i> <i><br><br></i>  <i>In der Windows-Konsole ist es schlecht mit russischen Zeichen, so dass es keine Risse gibt, die Sie zum √ñffnen von Datei&gt; Einstellungen&gt; Einstellungen ben√∂tigen. Geben Sie terminal.integrated.shellArgs.windows in das Feld ein und klicken Sie auf</i> <i><br><br><img src="https://habrastorage.org/getpro/habr/post_images/a70/787/6a5/a707876a56e4c0a2b601358d4aa7caf1.png" alt="Bild"><br><br></i>  <i>Und f√ºgen Sie die Zeile "terminal.integrated.shellArgs.windows" hinzu: ["-NoExit", "/ c", "chcp 65001"],</i> <i><br><br><img src="https://habrastorage.org/getpro/habr/post_images/57d/217/da6/57d217da62d4189b8640eb854f07a8a0.png" alt="Bild"></i> <br><br>  Wiederholen Sie den Befehl, um Dateien von github herunterzuladen: <br><br><pre> <code class="javascript hljs">git clone https:<span class="hljs-comment"><span class="hljs-comment">//github.com/ReTWi/mysuperapp.git</span></span></code> </pre> <br>  Klicken Sie in VScode auf Datei&gt; Ordner √∂ffnen und √∂ffnen Sie den Ordner unserer Anwendung. <br><br>  Erstellen Sie die Datei server.js mit demselben einfachen Servercode: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> http = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'http'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hostname = <span class="hljs-string"><span class="hljs-string">'localhost'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> port = <span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> server = http.createServer(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) =&gt;</span></span> { res.statusCode = <span class="hljs-number"><span class="hljs-number">200</span></span>; res.setHeader(<span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>, <span class="hljs-string"><span class="hljs-string">'text/plain'</span></span>); res.end(<span class="hljs-string"><span class="hljs-string">'Hello World!\n'</span></span>); }); server.listen(port, hostname, () =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Server running at http://</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${hostname}</span></span></span><span class="hljs-string">:</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${port}</span></span></span><span class="hljs-string">/`</span></span>); });</code> </pre> <br>  Installieren Sie nodemon, um den Server automatisch neu zu starten, wenn √Ñnderungen am Code vorgenommen werden: <br><br><pre> <code class="javascript hljs">npm i nodemon -g</code> </pre> <br>  i - kurz f√ºr install <br>  g - globale Installation (verf√ºgbar in der Konsole) und nicht nur f√ºr unsere Anwendung. <br><br>  F√ºhren Sie den folgenden Befehl aus: <br><br><pre> <code class="javascript hljs">nodemon server.js</code> </pre> <br>  √ñffnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">localhost</a> : 80 / im Browser oder einfach localhost: 80 und sehen Sie Hello World. <br><br>  Jetzt ist es Zeit, unsere PC-Kette&gt; Github&gt; Hosting zu besuchen. <br><br>  Laden Sie den Github-Desktop f√ºr mehr Komfort herunter, verbinden Sie Ihr Github-Konto, klicken Sie auf die Datei zum Hinzuf√ºgen eines lokalen Repositorys und geben Sie das Verzeichnis unserer Anwendung an. <br><br>  In der Anwendung sehen wir die √Ñnderungen, die wir gegen√ºber der von Github heruntergeladenen Version vorgenommen haben (wir haben server.js hinzugef√ºgt): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/568/3d0/52b/5683d052b9fbba8fe609035fd8ba253f.png" alt="Bild"><br><br>  Klicken Sie auf "Commit to Master"&gt; "Push Origin", um Dateien vom PC auf Github herunterzuladen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eeb/234/bf6/eeb234bf61a0ed5b2708b196e32da7d8.png" alt="Bild"><br><br>  Wir gehen zu unserem Github-Konto im Browser und sehen die heruntergeladene Datei server.js: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e6/cf8/e1b/1e6cf8e1b08c5a15d596193dd8b0efb3.png" alt="Bild"><br><br>  Lassen Sie uns etwas mehr √ºben, in VScode ersetzen wir die Zeile "res.end ('Hello World! \ N');"  zu "res.end ('OmNomNom');".  Wir werden sehen, dass der Server selbst neu gestartet wurde: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8c8/8cc/a53/8c88cca53e4d8d15632cc49e183817e7.png" alt="Bild"><br><br>  Wir werden im Browser nachsehen, welche √Ñnderungen wir dort "OmNomNom" vorgenommen haben. <br><br>  Desktop Github zeigt uns auch, dass wir die Zeile ge√§ndert haben: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/020/39b/7a0/02039b7a00fabe3c07037f6a356c1919.png" alt="Bild"><br><br>  Klicken Sie erneut auf Commit to Master&gt; Push Origin, um Dateien an Github zu senden. <br><br>  Wechseln Sie zur Hosting-Befehlszeile. <br><br>  Wir stoppen unsere Anwendung, wenn sie noch ausgef√ºhrt wird (Strg + C). <br><br>  Laden Sie unsere aktualisierte Anwendung mit den folgenden Befehlen herunter: <br><br><pre> <code class="javascript hljs">git config credential.helper store git pull</code> </pre><br>  Der erste speichert unsere Daten, damit Sie Ihr Login und Passwort nicht st√§ndig eingeben m√ºssen.  In Zukunft wird uns Git Pull ausreichen. <br><br>  Installieren Sie pm2 - √§hnlich wie nodemon, nur f√ºr das Hosting: <br><br><pre> <code class="javascript hljs">npm i pm2 -g</code> </pre> <br>  Starten wir die Anwendung mit pm2, wodurch unser Server beim n√§chsten Git-Pull auf dem Hosting neu gestartet wird: <br><br><pre> <code class="javascript hljs">pm2 start server.js --watch</code> </pre> <br>  √ñffnen Sie den Browser in unserer externen IP-Cloud und sehen Sie sich unser ‚ÄûOmNomNom‚Äú an. <br><br>  Daher haben wir die Arbeitskette mit der Anwendung und deren schnelle Bereitstellung auf dem Hosting geschlossen. <br><br><h2>  Wir erstellen tempor√§re SSL-Zertifikate f√ºr HTTPS auf localhost und Hosting </h2><br>  Wir gehen auf die Seite <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zerossl.com</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/151/be3/00c/151be300c4226e87b30b7f4735e09c83.png" alt="Bild"><br><br>  Geben Sie im Feld Domains, IP ... zuerst localhost ein, klicken Sie auf 2 Dateien generieren und laden Sie sie herunter: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8a1/b4d/24a/8a1b4d24a65f44c3ba5a604a569e1811.png" alt="Bild"><br><br>  Wir speichern sie in unserem Projekt im Ordner ssl / localhost. <br><br>  Wiederholen Sie den Vorgang f√ºr die externe IP Cloud und speichern Sie sie in ssl / myapp. <br><br><h2>  Starten Sie einen komplexeren https-Server node.js </h2><br>  Anwendungsstruktur: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/330/6da/e58/3306dae5836d651136b030b2cc64041e.png" alt="Bild"><br><br><ul><li>  Kunde - hier liegt unser Frontend.  Ich habe reagiert </li><li>  Protokolle - Protokolle beim Hosting werden hier gel√∂scht </li><li>  node_modules - node.js Module </li><li>  privat - Ihre privaten Dateien speichere ich dort SSH-Zugriff auf die Cloud </li><li>  Server ist dein Backend </li><li>  ssl - ssl-Zertifikate f√ºr die Arbeit mit https auf localhost und Hosting </li><li>  .babelrc - Webpack'om-Anwendung reagiert auf Build-Einstellungen (erm√∂glicht die Verwendung modernerer JS bei der Entwicklung des Frontends) </li><li>  .gitignore - Dateien, die nicht nach github verschoben werden (git scheint sie nicht zu sehen) </li><li>  client.js - Einstiegspunkt zum Generieren einer Reaktionsassemblierung </li><li>  package.json - die von Ihnen verwendeten node_modeles und verschiedene Befehlsausschnitte. </li><li>  package-lock.json - √Ñnderungen in den Modulen (so wie ich es verstehe, pr√ºft die Datei, ob dieselben Module auf Ihrem Hosting und auf Ihrem PC installiert sind). </li><li>  pm2-watch.json - pm2 Starteinstellungen f√ºr das Hosting </li><li>  README.md - Abdeckung f√ºr Github </li><li>  server.js - der Ausgangspunkt unseres Backend Node.js-Servers </li><li>  webpack.config.js - Build-Konfiguration reagieren </li></ul><br><h3>  .gitignore </h3><br>  Hier geben wir die Dateien / Ordner an, die wir nicht auf github hochladen m√∂chten.  Sie werden nur auf diesem Ger√§t sein und Git wird ihre √Ñnderungen nicht verfolgen / anzeigen.  √ñffnen und einf√ºgen: <br><br><pre> <code class="javascript hljs">/node_modules/ <span class="hljs-regexp"><span class="hljs-regexp">/logs/</span></span>* # exception to the rule !logs/.gitkeep /public/react_bundle.js /public/isProd.js</code> </pre> <br>  Da github keine leeren Ordner entl√§dt, k√∂nnen Sie beispielsweise etwas in eine leere .gitkeep-Datei einf√ºgen.  Speichern Sie die Datei und schlie√üen Sie sie. <br><br><h3>  package.json </h3><br>  √ñffnen und f√ºgen Sie Folgendes ein (nach // hinzugef√ºgten Kommentaren) <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"myapp"</span></span>, <span class="hljs-comment"><span class="hljs-comment">//    "version": "1.0.0", "description": "OmNomNom", "main": "server.js", "scripts": { "server": "pm2 start pm2-watch.json", //  npm run server     "client": "webpack -w --mode development", //  npm client    .        ,   . "client-prod": "webpack --mode production", //     production "client-analyze": "webpack --mode production --analyze true" //     production       .    }, "repository": { "type": "git", "url": "git+https://github.com/myapp/knigam.git" //     github }, "author": "rtw", "license": "UNLICENSED", //     ( ) "bugs": { "url": https://github.com/myapp/knigam.git" }, "homepage": "https://github.com/myapp/knigam.git#readme", "dependencies": { "@babel/core": "^7.2.2", //  js  frontend "@babel/plugin-transform-runtime": "^7.2.0", //  js  frontend "@babel/preset-env": "^7.3.1", //  js  frontend "@babel/preset-react": "^7.0.0", //  js  frontend "ajv": "^6.8.1", //    "babel-loader": "^8.0.5", //  js  frontend "babel-plugin-styled-components": "^1.10.0", //   styled-components "css-loader": "^2.1.0", //   webpack'om css "fastify": "^2.0.0-rc.6", //  express,      "fastify-cookie": "^2.1.6", //    "fastify-static": "^2.2.0", //     "moment": "^2.24.0", //    "pg": "^7.8.0", //    "pino": "^5.11.1", //   postgreSQL  node.js "pino-pretty": "^2.5.0", //     "react": "^16.8.1", // Frontend .      Vue.js,    .      ,     "react-dom": "^16.8.1", // React     "style-loader": "^0.23.1", //   webpack'om ,    "styled-components": "^4.1.3", // CSS in JS,           "webpack": "^4.29.3", //    "webpack-bundle-analyzer": "^3.0.3", //       "webpack-cli": "^3.2.3" //    ,     } }</span></span></code> </pre><br>  Ich werde mich auf zwei Haupt-Frameworks / Bibliotheken konzentrieren, die f√ºr die Anwendung ausgew√§hlt wurden: <br>  Fastify wurde als Alternative zu express.js gew√§hlt, da das erste bereits experimentelle Unterst√ºtzung f√ºr htpp2 hat, es sich aktiv entwickelt und es scheint mir, dass es mehr Zukunft hat als express.js, das sehr langsam geworden ist und sich irgendwie entwickelt.  Auf der anderen Seite arbeitet express.js schon lange und es wird f√ºr Sie einfacher sein, Informationen dar√ºber zu finden. <br><br>  React wurde gew√§hlt, weil es f√ºr mich einfacher war, damit zu arbeiten, alles zu verstehen und mit meinen eigenen H√§nden zu versuchen.  Vue - es schien etwas mit seinen eigenen Regeln, Richtungen.  In Vue kann es zwar notwendig sein, etwas weniger mit den eigenen H√§nden zu schreiben, aber da der Schwerpunkt auf dem Training und f√ºr eine Person liegt, die zuvor nicht programmiert hat, war die Reaktion irgendwie einfacher. <br><br>  Wir speichern die Datei package.json und installieren alle in Abh√§ngigkeiten angegebenen Module mit dem folgenden Befehl: <br><br><pre> <code class="javascript hljs">npm i</code> </pre> <br>  Wir werden einen Ordner node_modules haben, in dem sich alle Module f√ºr unsere Anwendung befinden. <br><br>  client - w√§hrend der leere Ordner <br>  Protokolle - in der .gitkeep-Datei liegt, so dass der Ordner zum Hosting migriert wird und die Protokolle dort erfolgreich abgelegt werden.  W√§hrend der Entwicklung geben wir alles auf der Konsole aus. <br><br><h3>  √ñffentlichkeit </h3><br>  Hier liegen die statischen Dateien unserer Seite, Bilder dort, Favoriten usw. <br>  Lassen Sie uns auf zwei Dateien eingehen: <br>  index.html: <br><br><pre> <code class="javascript hljs">&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;base href="/" /&gt; &lt;meta charset="UTF-8" /&gt; &lt;title&gt;MyApp&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id="cookies"&gt;    react_bundle   &lt;/div&gt; &lt;noscript &gt;:       Javscript&lt;/noscript &gt; &lt;script src="react_bundle.js"&gt;&lt;/script&gt; &lt;/body&gt; &lt;/html&gt;</code> </pre> <br>  - Hier haben wir ein Reaktions-Frontend geladen und durch seine ID in ein Tag gerendert. <br><br>  isProd.js enth√§lt eine einzelne Zeile "module.exports = false" <br>  Da es sich um .gitignore-Ausnahmen handelt, ist es nicht portierbar.  Dementsprechend setzen wir es auf dem PC auf false und auf dem Hosting auf true.  Dann verwenden wir diese Datei, um zu verstehen, in welcher Umgebung wir uns gerade befinden (Entwicklung / Produktion).  Es schien mir am bequemsten, au√üerdem k√∂nnen Sie den Code w√§hrend der Entwicklung teilweise √§ndern und den Betrieb von Modulen in der Produktion √ºberpr√ºfen. <br><br>  ssl - In den Ordnern localhost und myapp befinden sich zuvor gespeicherte Zertifikate <br><br><h3>  .babelrc </h3><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"presets"</span></span>: [ [ <span class="hljs-string"><span class="hljs-string">"@babel/preset-env"</span></span>, { <span class="hljs-string"><span class="hljs-string">"targets"</span></span>: { <span class="hljs-string"><span class="hljs-string">"browsers"</span></span>: [<span class="hljs-string"><span class="hljs-string">"&gt;0.25%"</span></span>, <span class="hljs-string"><span class="hljs-string">"not ie 11"</span></span>, <span class="hljs-string"><span class="hljs-string">"not op_mini all"</span></span>] } } ], <span class="hljs-string"><span class="hljs-string">"@babel/preset-react"</span></span> ], <span class="hljs-string"><span class="hljs-string">"plugins"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"babel-plugin-styled-components"</span></span>, <span class="hljs-string"><span class="hljs-string">"@babel/plugin-transform-runtime"</span></span> ] }</code> </pre><br>  Einstellungen zum Erstellen unseres react_bundle mit Browserunterst√ºtzung, die von mehr als 0,25% der Benutzer verwendet wird. <br><br><h3>  client.js </h3><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { render } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-dom'</span></span> render(<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">!!</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span>, <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'cookies'</span></span>))</code> </pre> <br><br>  Rendert unser Frontend in einem Div mit einem Cookie-Tag. <br><br>  pm2-watch.json - Erm√∂glicht das Ausf√ºhren des Servers mit dem Befehl "npm run server" auf dem Hosting, wobei √Ñnderungen im Code verfolgt und automatisch neu gestartet werden. <br><br><h3>  webpack.config.js </h3><br>  Builder f√ºr Reaktoranwendungen: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> webpack = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack'</span></span>), path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>), BundleAnalyzerPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'webpack-bundle-analyzer'</span></span>).BundleAnalyzerPlugin <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">env, argv</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> prod = argv.mode == <span class="hljs-string"><span class="hljs-string">'production'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> config = { <span class="hljs-attr"><span class="hljs-attr">entry</span></span>: <span class="hljs-string"><span class="hljs-string">'./client.js'</span></span>, <span class="hljs-attr"><span class="hljs-attr">output</span></span>: { <span class="hljs-attr"><span class="hljs-attr">path</span></span>: path.resolve(<span class="hljs-string"><span class="hljs-string">'./public'</span></span>), <span class="hljs-attr"><span class="hljs-attr">filename</span></span>: <span class="hljs-string"><span class="hljs-string">'react_bundle.js'</span></span> }, <span class="hljs-attr"><span class="hljs-attr">module</span></span>: { <span class="hljs-attr"><span class="hljs-attr">rules</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.(js|jsx)$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">exclude</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/node_modules/</span></span>, <span class="hljs-attr"><span class="hljs-attr">loader</span></span>: <span class="hljs-string"><span class="hljs-string">'babel-loader'</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">test</span></span>: <span class="hljs-regexp"><span class="hljs-regexp">/\.css$/</span></span>, <span class="hljs-attr"><span class="hljs-attr">use</span></span>: [<span class="hljs-string"><span class="hljs-string">'style-loader'</span></span>, <span class="hljs-string"><span class="hljs-string">'css-loader'</span></span>] } ] }, <span class="hljs-attr"><span class="hljs-attr">resolve</span></span>: { <span class="hljs-attr"><span class="hljs-attr">alias</span></span>: { <span class="hljs-attr"><span class="hljs-attr">client</span></span>: path.resolve(<span class="hljs-string"><span class="hljs-string">'./client/shared'</span></span>), <span class="hljs-attr"><span class="hljs-attr">public</span></span>: path.resolve(<span class="hljs-string"><span class="hljs-string">'./public'</span></span>) } }, <span class="hljs-attr"><span class="hljs-attr">plugins</span></span>: [ argv.analyze ? <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BundleAnalyzerPlugin() : <span class="hljs-literal"><span class="hljs-literal">false</span></span>, prod ? <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.optimize.AggressiveMergingPlugin() : <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> webpack.ContextReplacementPlugin(<span class="hljs-regexp"><span class="hljs-regexp">/moment[\/\\]locale$/</span></span>, /ru/) ].filter(<span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span>), <span class="hljs-attr"><span class="hljs-attr">optimization</span></span>: { <span class="hljs-attr"><span class="hljs-attr">minimize</span></span>: prod ? <span class="hljs-literal"><span class="hljs-literal">true</span></span> : <span class="hljs-literal"><span class="hljs-literal">false</span></span> }, <span class="hljs-attr"><span class="hljs-attr">performance</span></span>: { <span class="hljs-attr"><span class="hljs-attr">hints</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> config }</code> </pre><br>  Kurz gesagt, er √∂ffnet die Datei client.js und alles, was sich darin befindet, sammelt react_bundle und legt sie im √∂ffentlichen Ordner ab, von wo aus sie √ºber die ge√∂ffnete index.html geladen wird. <br><br><h3>  server.js </h3><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> isProd = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./public/isProd'</span></span>), fs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs'</span></span>), log = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./server/logger'</span></span>), path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>) <span class="hljs-comment"><span class="hljs-comment">//   node.js,      process.on('unhandledRejection', (reason, promise) =&gt; { log.error({ reason, promise }, '  unhandledRejection') }) process.on('uncaughtException', err =&gt; { log.error({ err }, '  uncaughtException') }) // Redirect server from http port 80 to https 443 const fastifyHttp = require('fastify')({ logger: log, ignoreTrailingSlash: true }) fastifyHttp.listen(80, '::', (err, address) =&gt; { if (err) { log.error({ err, address }, '   HTTP ') } else { log.warn('Http c ') } }) // Let's Encrypt challenge fastifyHttp.get('/.well-known/acme-challenge/:file', (req, res) =&gt; { let stream = fs.createReadStream( path.join(__dirname + '/ssl/.well-known/acme-challenge/' + req.params.file) ) res.type('text/html').send(stream) }) fastifyHttp.get('/*', (req, res) =&gt; { res.redirect(301, 'https://' + req.headers.host + req.raw.url) }) fastifyHttp.get('/', (req, res) =&gt; { res.redirect(301, 'https://' + req.headers.host + req.raw.url) }) //  let fastifyOptions = { logger: log, ignoreTrailingSlash: true, http2: true } fastifyOptions.https = isProd ? { allowHTTP1: true, key: fs.readFileSync('./ssl/myapp/key.txt'), cert: fs.readFileSync('./ssl/myapp/crt.txt') } : { allowHTTP1: true, key: fs.readFileSync('./ssl/localhost/cert.key'), cert: fs.readFileSync('./ssl/localhost/cert.pem') } const fastify = require('fastify')(fastifyOptions) fastify.listen(443, '::', (err, address) =&gt; { if (err) { log.error({ err, address }, '   ') } else { log.warn( `   ${ isProd ? '' : ' ' }` ) } }) //  fastify.setSchemaCompiler(schema =&gt; { return ajv.compile(schema) }) //  fastify fastify.setErrorHandler((err, req, res) =&gt; { log.error({ err, req }, 'fastify errorHandler') //     if (err.validation) { return res.send({ error: '   ' }) } else { return res.send({ error: ' errorHandler' }) } }) //   fastify.register(require('fastify-static'), { root: path.join(__dirname, './public') }) //  fastify.register(require('fastify-cookie'), err =&gt; { if (err) log.error({ err }, 'fastify-cookie') }) //       /   //       index.html,     //        api,   GET /api/userdata fastify.setNotFoundHandler((req, res) =&gt; { res.sendFile('index.html') }) // Routes fastify.register( async openRoutes =&gt; { //    openRoutes.register(require('./server/api/open')) openRoutes.register(async withSession =&gt; { //         //    , : ///withSession.addHook('preHandler', async (req, res) =&gt; { // if (!(await sessionManagerIsOk(req, res))) return // }) withSession.register(require('./server/api/with_session')) }) }, { prefix: '/api' } //    )</span></span></code> </pre><br><h3>  Serverordner </h3><br>  Hier liegt das Backend und alle Wege. <br>  logger.js - Abh√§ngig von der Umgebung protokolliert isProd entweder in der Konsole oder in Errors.log <br><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> pino = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'pino'</span></span>), isProd = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'../public/isProd'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> logOptions = isProd ? { <span class="hljs-attr"><span class="hljs-attr">level</span></span>: <span class="hljs-string"><span class="hljs-string">'warn'</span></span>, <span class="hljs-comment"><span class="hljs-comment">//   timestamp: () =&gt; { return ',"time":"' + new Date() + '"' } } : { level: 'warn', prettifier: require('pino-pretty'), prettyPrint: { levelFirst: true, translateTime: true } } let dest = isProd ? pino.destination('./logs/errors.log') : pino.destination(1) let log = pino(logOptions, dest) module.exports = log</span></span></code> </pre><br>  server / api / <br>  open.js - f√ºgen Sie hier unsere Pfade hinzu. <br><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">'use strict'</span></span> <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fastify, options, next</span></span></span><span class="hljs-function">) </span></span>{ fastify.route({ <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'GET'</span></span>, <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-attr"><span class="hljs-attr">handler</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (req, res) =&gt; { res.send(<span class="hljs-string"><span class="hljs-string">'api / route'</span></span>) } }) fastify.route({ <span class="hljs-attr"><span class="hljs-attr">method</span></span>: <span class="hljs-string"><span class="hljs-string">'GET'</span></span>, <span class="hljs-attr"><span class="hljs-attr">url</span></span>: <span class="hljs-string"><span class="hljs-string">'/hi'</span></span>, <span class="hljs-attr"><span class="hljs-attr">handler</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (req, res) =&gt; { res.send(<span class="hljs-string"><span class="hljs-string">'api / route hi'</span></span>) } }) next() }</code> </pre> <br>  Nachdem wir alles auf Localhost eingerichtet und √ºberpr√ºft haben, laden wir einfach alles auf github hoch und ziehen von dort aus git zum Hosting.  Auf dem Hosting m√ºssen lediglich die Module node.js mit dem Befehl ‚Äûnpm i‚Äú installiert und die Datei isProd.js erstellt werden <br><br><h2>  SSL wird automatisch aktualisiert </h2><br>  Wenn Sie eine Domain kaufen und an die IP-Cloud binden, ein Beispiel f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anweisungen f√ºr REG.RU</a> , k√∂nnen Sie automatisch aktualisiertes kostenloses SSL auf dem Server installieren, damit die Site √ºber https funktioniert. <br><br>  Unser Server arbeitet ohne Nginx.  Wir werden es m√∂glicherweise in Zukunft als Load Balancer oder als schnelleren HTTP-Server f√ºr die Verteilung statischer Dateien ben√∂tigen, aber bisher sehe ich keine Notwendigkeit daf√ºr.  Wir brauchen noch keinen Lastausgleich, aber ich habe keine Vergleiche hinsichtlich der Verteilungsgeschwindigkeit der Statik gefunden. <br><br>  Erstellen Sie vor der Installation im SSL-Ordner den bekannten Ordner und darin die Acme-Challenge.  Es stellt sich heraus, dass /opt/myapp/ssl/.well-known/acme-challenge <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klicken Sie auf den Link,</a> um automatisch aktualisiertes SSL auf einem Server mit node.js ohne nginx zu installieren.  F√ºhren Sie die folgenden Befehle in der Hosting-Konsole aus: <br><br><pre> <code class="javascript hljs">sudo apt-get update sudo apt-get install software-properties-common sudo add-apt-repository universe sudo add-apt-repository ppa:certbot/certbot sudo apt-get update sudo apt-get install certbot sudo certbot certonly</code> </pre><br>  Wir w√§hlen die zweite √úberpr√ºfungsmethode aus, mit der eine bestimmte Datei im Ordner /opt/myapp/ssl/.well-known/acme-challenge abgelegt wird. Nach Best√§tigung des Besitzers des Servers wird sie gel√∂scht. <br><br>  Wir geben unsere Domain auf Anfrage an, zum Beispiel: "example.com" und den Pfad zum SSL-Ordner unserer Anwendung (der Server ist so konfiguriert, dass er die vom Bot erstellte Datei liefert) "/ opt / myapp / ssl". <br><br>  Der Bot konfiguriert die Cron-Task selbst so, dass das Zertifikat vor Ablauf innerhalb von 90 Tagen erneuert wird. <br><br>  Ich h√§tte nicht gedacht, dass es so lange dauern w√ºrde, alles zu schreiben. Um 4 Uhr morgens h√§tte ich schon etwas verpassen k√∂nnen: / <br><br>  Interessant ist die Meinung der Habrachianer und Spezialisten, die diese Leinwand beherrschen oder einzelne Punkte lesen.  Wie ist Ihr Entwicklungszyklus aufgebaut?  Gibt es Punkte, in denen ich mich irre oder das Falsche tue? </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439952/">https://habr.com/ru/post/de439952/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439942/index.html">Docker: Was jeder .NET-Entwickler wissen muss</a></li>
<li><a href="../de439944/index.html">SAPUI5 f√ºr Dummies Teil 5: Eine vollst√§ndige Schritt-f√ºr-Schritt-√úbung</a></li>
<li><a href="../de439946/index.html">Warum haben wir uns f√ºr Electron entschieden?</a></li>
<li><a href="../de439948/index.html">Intel SVT-AV1: Open Source AV1-Encoder f√ºr hohe Beanspruchung</a></li>
<li><a href="../de439950/index.html">3. Turing-Test: Teilnahmebedingungen und Preise f√ºr die Gewinner</a></li>
<li><a href="../de439958/index.html">CodeFest X 30. bis 31. M√§rz. Zuk√ºnftiger Abschnitt</a></li>
<li><a href="../de439962/index.html">Wir arbeiten mit Atlassian Service Desk zusammen und nutzen das Riada Insight-Plug-In optimal - einen Bericht vom Treffen der Atlassian User Group</a></li>
<li><a href="../de439964/index.html">Runc CVE-2019-5736 Sicherheitsanf√§lligkeit in einem Host</a></li>
<li><a href="../de439966/index.html">Einfacher Parser f√ºr arithmetische Operationen</a></li>
<li><a href="../de439968/index.html">Generationsraum und Opportunity Space</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>