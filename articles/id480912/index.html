<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äç‚öïÔ∏è ü§öüèª üôçüèº Dap beraksi. Menulis TodoMVC. Bagian 1 üöç üí∞ ‚ûñ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel pertama tentang dap , jelas, tidak menjadi kesuksesan tulisan saya: sebagian besar komentar mengenai hal itu bermuara pada "niasilil" dan "nia...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dap beraksi. Menulis TodoMVC. Bagian 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/480912/"> <a href="https://habr.com/ru/post/478330/">Artikel</a> pertama tentang <a href="https://dap.js.org/" rel="nofollow">dap</a> , jelas, tidak menjadi kesuksesan tulisan saya: sebagian besar komentar mengenai hal itu bermuara pada "niasilil" dan "niasilil, tetapi saya mengutuk."  Dan hadiah untuk satu <s>-</s> satunya komentar tingkat atas yang konstruktif diberikan kepada <a href="https://habr.com/en/users/oldvitus/" class="user_link">OldVitus</a> , untuk saran untuk menunjukkan yang dap menggunakan TodoMVC sebagai contoh, sehingga ada sesuatu yang bisa dibandingkan.  Apa yang akan saya lakukan di artikel ini. <br><br>  <a href="http://todomvc.com/" rel="nofollow">TodoMVC</a> , jika ada yang tidak tahu, ini adalah dunia panggilan-UI standar, yang memungkinkan Anda untuk membandingkan solusi untuk masalah yang sama - "daftar tugas" bersyarat - menggunakan kerangka kerja yang berbeda.  Tugas, dengan semua kesederhanaannya ( <a href="https://dap.js.org/samples/todo.html" rel="nofollow">solusi pada dap</a> break "dalam satu layar"), sangat ilustratif.  Oleh karena itu, dengan menggunakan contohnya, saya akan mencoba menunjukkan bagaimana tugas-tugas khas untuk web front-end diimplementasikan menggunakan dap. <br><br>  Saya tidak mencari dan mempelajari deskripsi formal masalah, tetapi memutuskan untuk membalik salah satu contoh.  Backend untuk artikel ini tidak menarik bagi kami, jadi kami tidak akan menulisnya sendiri, tetapi gunakan <a href="https://todo-backend-express.herokuapp.com/" rel="nofollow">salah satu yang sudah jadi</a> dari situs <a href="https://www.todobackend.com/" rel="nofollow">www.todobackend.com</a> , dan dari sana kami akan mengambil <a href="https://todo-backend-express.herokuapp.com/" rel="nofollow">contoh klien</a> dan <a href="" rel="nofollow">file CSS</a> standar. <br><br>  Untuk menggunakan dap, Anda tidak perlu mengunduh dan menginstal apa pun.  Tidak ada <code>npm install</code> dan itu saja.  Tidak diperlukan untuk membuat proyek apa pun dengan struktur direktori tertentu, manifesto, dan atribut keberhasilan TI lainnya.  Editor dan peramban teks yang cukup.  Untuk men-debug permintaan XHR, Anda juga mungkin memerlukan server web - yang cukup sederhana, seperti <a href="https://chrome.google.com/webstore/detail/web-server-for-chrome/ofhbbkphhbklhfoeikjpcbhemlocgigb" rel="nofollow">ekstensi</a> untuk Chrome ini.  Seluruh frontend kami akan terdiri dari satu file .html (tentu saja, mengacu pada skrip engine-dap dan ke file CSS TodoMVC standar) <br><br>  Jadi, dari awal. <br><a name="habracut"></a><br><h2>  1. Buat file .html </h2><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Todo -- dap sample<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">rel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"stylesheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://www.todobackend.com/client/css/vendor/todomvc-common.css"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://dap.js.org/0.4.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-comment"><span class="actionscript"><span class="hljs-comment">//   dap </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Persiapan html biasa di mana kami menyertakan file-CSS, silakan disediakan oleh situs <a href="https://www.todobackend.com/" rel="nofollow">www.todobackend.com</a> dan mesin-dap, tidak kalah ramah disediakan oleh situs <a href="https://dap.js.org/" rel="nofollow">dap.js.org</a> <br><br><h2>  2. Salin struktur DOM dari contoh aslinya </h2><br>  Untuk menggunakan file CSS standar tanpa perubahan, kami akan mematuhi struktur DOM yang sama dengan <a href="https://todo-backend-express.herokuapp.com/" rel="nofollow">contoh aslinya</a> .  Buka di browser Chrome, tekan Ctr + Shift + I, pilih tab Elements dan lihat bahwa aplikasi itu sendiri ada di bagian elemen <code>section id="todo-app"&gt;</code> <br><br><img src="https://habrastorage.org/webt/3d/ks/mq/3dksmqoxzyif_tgnxfc3v-wf_us.png"><br><br>  Dengan membuka subtree ini satu per satu, kami menulis ulang strukturnya menjadi file .html kami.  Sekarang kita hanya membuat sketsa dengan cepat, dan tidak menulis kode, jadi kita hanya menulis tanda tangan elemen dalam 'tanda kutip tunggal', dan dalam tanda kurung anak-anak mereka.  Jika tidak ada anak, kami menggambar tanda kurung kosong.  Kami memantau indeks dan keseimbangan kurung. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   dap '#todoapp'( '#header'( 'H1'() 'INPUT#new-todo placeholder="What needs to be done?" autofocus'() ) '#main'( '#toggle-all type=checkbox'() 'UL#todo-list'( 'LI'( 'INPUT.toggle type=checkbox'() 'LABEL'() 'BUTTON.destroy'() ) ) ) '#footer'( '#todo-count'() 'UL#filters'( 'LI'() ) '#clear-completed'() ) )</span></span></code> </pre><br>  Catatan: elemen berulang (misalnya, ini adalah elemen <code>LI</code> ) kami menulis ke struktur sekali, bahkan jika ada beberapa di antaranya dalam aslinya;  jelas ini adalah array dari pola yang sama. <br><br>  Format tanda tangan, saya pikir, dapat dimengerti oleh siapa saja yang menulis HTML dan CSS dengan tangan mereka, jadi saya tidak akan membahasnya secara rinci untuk saat ini.  Saya hanya bisa mengatakan bahwa tag ditulis dalam huruf kapital, dan tidak adanya tag setara dengan keberadaan tag DIV.  Kelimpahan # -elements (dengan id) di sini disebabkan oleh spesifikasi file CSS yang disertakan, yang terutama menggunakan pemilih-id. <br><br><h2>  3. Ingat bahwa program dap adalah Javascript </h2><br>  Untuk menyelamatkan kami dari tanda kurung yang tidak perlu dalam kode, mesin dap menyuntikkan beberapa metode langsung ke <code>String.prototype</code> (Saya menyadari bahwa menerapkan metode Anda di objek standar adalah ayahay, tapi ... singkatnya, kami telah lulus), yang mengubah string tanda tangan menjadi dap templat.  Salah satu metode tersebut adalah <code>.d(rule, ...children)</code> .  Argumen pertama yang dibutuhkan adalah aturan generasi ( <i>d-rule</i> ), dan sisanya dari argumen adalah jumlah anak yang sewenang-wenang. <br><br>  Berdasarkan pengetahuan baru ini, kami menambahkan kode kami sehingga alih-alih setiap brace pembuka, kami memiliki urutan <code>.d(""</code> , dan sebelum setiap kutipan tunggal dibuka, kecuali yang pertama, ada koma. Life hack: Anda dapat menggunakan penggantian otomatis. <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'#todoapp'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'#header'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'H1'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ,<span class="hljs-string"><span class="hljs-string">'INPUT#new-todo placeholder="What needs to be done?" autofocus'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ) ,<span class="hljs-string"><span class="hljs-string">'#main'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'#toggle-all type=checkbox'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ,<span class="hljs-string"><span class="hljs-string">'UL#todo-list'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'INPUT.toggle type=checkbox'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ,<span class="hljs-string"><span class="hljs-string">'LABEL'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ,<span class="hljs-string"><span class="hljs-string">'BUTTON.destroy'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ) ) ) ,<span class="hljs-string"><span class="hljs-string">'#footer'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'#todo-count'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ,<span class="hljs-string"><span class="hljs-string">'UL#filters'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ) ,<span class="hljs-string"><span class="hljs-string">'#clear-completed'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span>) ) )</code> </pre><br>  Voila!  Kami mendapat pohon panggilan ke metode <code>.d</code> , yang siap untuk berubah menjadi template dap.  String kosong <code>""</code> adalah benih aturan-d di masa depan, dan anak-anak adalah argumen yang dipisahkan oleh koma.  Secara formal, ini adalah program dap yang valid, meski belum sepenuhnya dengan knalpot yang kita butuhkan.  Tapi itu sudah bisa diluncurkan!  Untuk melakukan ini, setelah braket root penutup, tambahkan metode <code>.RENDER()</code> .  Metode ini, seperti namanya, membuat templat yang dihasilkan. <br><br>  Jadi, pada tahap ini, kami memiliki file .html dengan konten ini: <br><br><pre> <code class="javascript hljs">&lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;Todo -- dap sample&lt;/title&gt; &lt;link rel="stylesheet" href="https://www.todobackend.com/client/css/vendor/todomvc-common.css"/&gt; &lt;script src="https://dap.js.org/0.4.js"&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;script&gt; '#todoapp'.d("" ,'#header'.d("" ,'H1'.d("") ,'INPUT#new-todo placeholder="What needs to be done?" autofocus'.d("") ) ,'#main'.d("" ,'#toggle-all type=checkbox'.d("") ,'UL#todo-list'.d("" ,'LI'.d("" ,'INPUT.toggle type=checkbox'.d("") ,'LABEL'.d("") ,'BUTTON.destroy'.d("") ) ) ) ,'#footer'.d("" ,'#todo-count'.d("") ,'UL#filters'.d("" ,'LI'.d("") ) ,'#clear-completed'.d("") ) ) .RENDER() //   dap   &lt;/script&gt; &lt;/body&gt; &lt;/html&gt;</code> </pre><br>  Anda dapat <a href="http://dap.js.org/samples/tutorial/3.html" rel="nofollow">membukanya di browser</a> untuk memastikan bahwa elemen DOM dihasilkan, gaya CSS diterapkan, tetap hanya untuk mengisi templat ini dengan data. <br><br><h2>  4. Dapatkan data </h2><br>  Kami pergi ke <a href="https://todo-backend-express.herokuapp.com/" rel="nofollow">halaman asli</a> , buka tab Network di alat, aktifkan filter XHR, dan lihat dari mana data berasal dan dalam bentuk apa. <br><br><img src="https://habrastorage.org/webt/vf/ff/4l/vfff4lreh7nhj6jpgb8re83wb-s.png"><br><br><img src="https://habrastorage.org/webt/qi/lh/ga/qilhganpuhmmtevpnyuytm1uadu.png"><br><br>  Baik, baik.  Daftar yang harus dilakukan diambil langsung dari <a href="https://todo-backend-express.herokuapp.com/" rel="nofollow">todo-backend-express.herokuapp.com</a> sebagai json array objek.  Bagus <br><br>  Untuk menerima data, dap memiliki konverter bawaan <code>:query</code> yang secara asinkron "mengubah" URL menjadi data yang diterima darinya.  Kami tidak akan menulis URL itu sendiri secara langsung dalam aturan, tetapi kami akan menetapkannya dengan <code>todos</code> konstan;  maka seluruh desain data mining akan terlihat seperti ini: <br><br><pre> <code class="javascript hljs">todos:query</code> </pre><br>  dan tulis konstanta <code>todos</code> itu sendiri di kamus - di bagian <code>.DICT</code> , tepat sebelum <code>.RENDER()</code> : <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'#todoapp'</span></span>.d(<span class="hljs-string"><span class="hljs-string">""</span></span> ... ) .DICT({ <span class="hljs-attr"><span class="hljs-attr">todos</span></span> : <span class="hljs-string"><span class="hljs-string">"https://todo-backend-express.herokuapp.com/"</span></span> }) .RENDER()</code> </pre><br>  Setelah menerima array <code>todos</code> , kami membuat daftar tugas dari itu: untuk setiap kasus kami mengambil nama dari bidang <code>.title</code> dan menulisnya ke elemen <code>LABEL</code> , dan dari bidang <code>.completed</code> mengambil tanda "kelengkapan" dan menulis ke properti yang <code>checked</code> dari <code>checked</code> elemen <code>INPUT.toggle</code> .  Ini dilakukan seperti ini: <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'UL#todo-list'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"*@ todos:query"</span></span> <span class="hljs-comment"><span class="hljs-comment">//  *       ,'LI'.d("" ,'INPUT.toggle type=checkbox'.d("#.checked=.completed") // #  " " ,'LABEL'.d("! .title") //  !      ,'BUTTON.destroy'.d("") ) )</span></span></code> </pre><br>  Kami memperbarui halaman kami di browser dan ... jika Anda memulainya dari sistem file, maka tidak ada yang terjadi.  Masalahnya adalah browser modern tidak mengizinkan permintaan XHR lintas-domain dari dokumen lokal. <br><br><img src="https://habrastorage.org/webt/tm/fy/bi/tmfybiqw7s2geblqodepfg7k7lk.png"><br><br>  Saatnya menonton laman kami melalui http - menggunakan server web lokal apa pun.  Baik, atau jika Anda tidak siap untuk menulis dap dengan tangan Anda sendiri, lihat versi berurutan halaman menggunakan tautan saya (jangan lupa untuk melihat sumbernya - di Chrome ini dilakukan dengan menggunakan Ctrl + U) <br><br>  Jadi, kita <a href="http://dap.js.org/samples/tutorial/4.html" rel="nofollow">pergi ke halaman kita di http: //</a> dan melihat bahwa datanya datang, daftar sedang dibangun.  Hebat!  Anda telah menguasai <code>*</code> dan operator <code>!</code>  , konverter <code>:query</code> , konstanta dan akses ke bidang elemen array saat ini.  Lihat lagi kode yang dihasilkan.  Apakah Anda masih merasa tidak dapat membaca? <br><br><h2>  5. Tambahkan status </h2><br>  Mungkin Anda sudah mencoba mengklik tanda centang di daftar yang harus dilakukan.  Kotak centang itu sendiri berubah warna, tetapi, tidak seperti aslinya, elemen induk <code>LI</code> tidak mengubah gayanya ("pekerjaan yang diselesaikan" harus menjadi abu-abu dan dicoret, tetapi ini tidak terjadi) - hal-hal tidak mengubah <i>keadaan</i> mereka.  Tetapi elemen-elemen ini belum memiliki keadaan dan, karenanya, tidak dapat mengubahnya.  Sekarang kita akan memperbaikinya. <br><br>  Tambahkan status "selesai" ke elemen <code>LI</code> .  Untuk melakukan ini, tentukan <i>variabel state</i> <code>$completed</code> <i>completion</i> dalam d-rule-nya.  Untuk <code>INPUT.toggle</code> , yang dapat mengubah status ini, kami akan menetapkan aturan reaksi yang sesuai ( <i>ui-rule</i> ), yang akan mengatur variabel <code>$completed</code> sesuai dengan tanda bendernya sendiri yang <code>checked</code> (‚Äúdaw diaktifkan‚Äù).  Bergantung pada status <code>$completed</code> elemen <code>LI</code> akan mengaktifkan atau menonaktifkan kelas CSS "selesai". <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'UL#todo-list'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"*@ todos:query"</span></span> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$completed=.completed"</span></span><span class="hljs-comment"><span class="hljs-comment">//  ,    .completed ,'INPUT.toggle type=checkbox' .d("#.checked=.completed") //       .ui("$completed=#.checked") //    $completed ,'LABEL'.d("! .title") ,'BUTTON.destroy'.d("") ) .a("!? $completed") //     $completed,    css- completed )</span></span></code> </pre><br>  Manipulasi seperti ini dengan kelas CSS adalah hal yang cukup umum, jadi ada operator khusus untuk mereka !? <br>  Harap dicatat bahwa kami melakukan ini di <i>a-rule</i> (dari kata akumulasi).  Kenapa tidak di d-rule?  Perbedaan antara kedua jenis aturan ini adalah ketika memperbarui, aturan-d sepenuhnya membangun kembali konten elemen, menghapus yang lama dan yang baru lagi, sedangkan aturan-a tidak menyentuh konten elemen yang ada, tetapi "menambahkan" hasilnya pada apa yang sudah ada.  Mengubah atribut tunggal elemen <code>LI</code> tidak memerlukan restrukturisasi sisa isinya, sehingga lebih rasional untuk melakukan ini dalam aturan-a. <br><br>  Kami melihat <a href="http://dap.js.org/samples/tutorial/5-1.html" rel="nofollow">hasilnya</a> .  Sudah lebih baik: mengklik pada kotak centang mengubah keadaan item yang harus dilakukan, dan sesuai dengan keadaan ini, gaya visual elemen berubah.  Tetapi masih ada masalah: jika daftar tugas yang diselesaikan pada awalnya hadir, mereka tidak akan berwarna abu-abu, karena secara default a-rule tidak dieksekusi ketika elemen dihasilkan.  Untuk menjalankannya bahkan selama pembangkitan, kita menambahkan operator <code>a!</code> Pada aturan-d dari elemen <code>LI</code> <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$completed=.completed; a!"</span></span> <span class="hljs-comment"><span class="hljs-comment">//      $completed    a-</span></span></code> </pre><br>  <a href="http://dap.js.org/samples/tutorial/5-2.html" rel="nofollow">Kami melihat</a> .  Baiklah  Dengan status <code>$completed</code> tahu.  Kasing yang telah selesai distilisasi dengan benar, baik pada saat boot awal maupun selama perpindahan manual berikutnya. <br><br><h2>  6. Mengedit nama kasus </h2><br>  Kembali ke <a href="https://todo-backend-express.herokuapp.com/" rel="nofollow">aslinya</a> .  Dengan mengklik dua kali pada nama case, mode pengeditan diaktifkan, di mana nama ini dapat diubah.  Itu diimplementasikan sedemikian rupa sehingga templat mode tampilan ‚Äúview‚Äù (dengan daw, judul dan tombol hapus) sepenuhnya tersembunyi, dan elemen <code>INPUT class="edit"</code> ditampilkan.  Kami akan melakukannya sedikit berbeda - kami hanya akan menyembunyikan elemen <code>LABEL</code> , karena dua elemen lainnya tidak mengganggu pengeditan kami.  Cukup tambahkan kelas <code>view</code> ke elemen <code>LABEL</code> . <br><br>  Untuk kondisi "editing", tentukan variabel <code>$editing</code> dalam elemen <code>LI</code> .  Awalnya, ini (keadaan) diatur ulang, <code>dblclick</code> dengan <code>dblclick</code> pada elemen <code>LABEL</code> , dan mati ketika elemen <code>INPUT.edit</code> tidak fokus.  Jadi kami menulis: <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$completed=.completed $editing=; a!"</span></span> <span class="hljs-comment"><span class="hljs-comment">//       ,'INPUT.toggle type=checkbox' .d("#.checked=.completed") .ui("$completed=#.checked") ,'LABEL.view' .d("? $editing:!; ! .title") //  $editing ,     .e("dblclick","$editing=`yes") //  dblclick  $editing ,'INPUT.edit' .d("? $editing; !! .title@value") //  $editing  .ui(".title=#.value") //  .title   change (ui     INPUT) .e("blur","$editing=") //  $editing   blur ,'BUTTON.destroy'.d("") ).a("!? $completed $editing") //   $completed  $editing  css-  'LI'</span></span></code> </pre><br>  Sekarang kita <a href="http://dap.js.org/samples/tutorial/6.html" rel="nofollow">bisa</a> mengedit nama-nama kasing. <br><br><h2>  7. Mengirim data ke server </h2><br>  Oke, kita sudah bisa mengedit hal-hal di browser, tetapi perubahan ini juga harus ditransfer ke server.  Kami melihat bagaimana yang asli melakukannya: <br><br><img src="https://habrastorage.org/webt/jd/r5/bw/jdr5bwsa8yi7wu4sbwxqr3bwcdi.png"><br><br>  Perubahan dikirim ke server menggunakan metode PATCH dengan URL tertentu dari formulir <code>http://todo-backend-express.herokuapp.com/28185</code> , yang, jelas, unik untuk setiap kasus.  URL ini ditunjukkan oleh server di bidang <code>.url</code> untuk setiap kasus dalam daftar.  Artinya, semua yang diperlukan dari kami untuk memperbarui kasus di server adalah mengirim permintaan PATCH ke alamat yang ditentukan dalam bidang <code>.url</code> , dengan data yang diubah dalam format JSON: <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'INPUT.edit'</span></span> .d(<span class="hljs-string"><span class="hljs-string">"? $editing; !! .title@value"</span></span>) .ui(<span class="hljs-string"><span class="hljs-string">".title=#.value; (@method`PATCH .url (@Content-type`application/json)@headers (.title):json.encode@body):query"</span></span>) .e(<span class="hljs-string"><span class="hljs-string">"blur"</span></span>,<span class="hljs-string"><span class="hljs-string">"$editing="</span></span>)</code> </pre><br>  Di sini kami menggunakan konverter yang sama <code>:query</code> , tetapi dalam versi yang lebih rinci.  Ketika <code>:query</code> diterapkan ke string sederhana, string ini diperlakukan sebagai URL dan permintaan GET dijalankan.  Jika <code>:query</code> menerima objek yang kompleks, seperti dalam kasus ini, <code>:query</code> memperlakukannya sebagai deskripsi terperinci dari permintaan yang berisi bidang <code>.method</code> , <code>.url</code> , <code>.headers</code> , dan <code>.body</code> , dan menjalankan permintaan sesuai dengan mereka.  Di sini, segera setelah memperbarui <code>.title</code> mengirim permintaan PATCH ke server dengan <code>.title</code> diperbarui ini <br><br>  Namun ada nuansa.  Kami mendapatkan bidang <code>.url</code> dari server, tampilannya seperti ini: <code>http://todo-backend-express.herokuapp.com/28185</code> , yaitu protokol http: // hardcode di dalamnya jika klien kami juga membuka melalui http: // maka semuanya baik-baik saja.  Tetapi jika klien terbuka melalui https: //, maka muncul masalah: untuk alasan keamanan, browser memblokir http-traffic dari sumber https. <br><br>  Itu dipecahkan secara sederhana: jika Anda menghapus protokol dari <code>.url</code> , permintaan akan melewati protokol halaman.  Jadi mari kita lakukan: tulis konverter yang sesuai - <code>dehttp</code> , dan kita akan melewati <code>.url</code> melaluinya.  Konverter khusus (dan fungsi lainnya) <code>.FUNC</code> di bagian <code>.FUNC</code> : <br><br><pre> <code class="javascript hljs"> .ui(<span class="hljs-string"><span class="hljs-string">".title=#.value; (@method`PATCH .url:dehttp (@Content-type`application/json)@headers (.title):json.encode@body):query"</span></span>) ... .FUNC({ <span class="hljs-attr"><span class="hljs-attr">convert</span></span>:{ <span class="hljs-comment"><span class="hljs-comment">//  -         dehhtp: url=&gt;url.replace(/^https?\:/,'')//    URL } })</span></span></code> </pre><br>  Masuk akal juga untuk menempatkan objek header di kamus sehingga dapat digunakan di pertanyaan lain: <br><br><pre> <code class="javascript hljs"> .ui(<span class="hljs-string"><span class="hljs-string">".title=#.value; (@method`PATCH .url:dehttp headers (.title):json.encode@body):query"</span></span>) ... .DICT({ <span class="hljs-attr"><span class="hljs-attr">todos</span></span> : <span class="hljs-string"><span class="hljs-string">"//todo-backend-express.herokuapp.com/"</span></span>, <span class="hljs-attr"><span class="hljs-attr">headers</span></span>: {<span class="hljs-string"><span class="hljs-string">"Content-type"</span></span>:<span class="hljs-string"><span class="hljs-string">"application/json"</span></span>} })</code> </pre><br>  Nah, untuk feng shui penuh, kita akan menggunakan properti lain yang berguna dari konverter <code>:query</code> - pengkodean otomatis dari tubuh permintaan di json sesuai dengan <code>Content-type:application/json</code> header.  Akibatnya, aturannya akan terlihat seperti ini: <br><br><pre> <code class="javascript hljs"> .ui(<span class="hljs-string"><span class="hljs-string">".title=#.value; (@method`PATCH .url:dehttp headers (.title)):query"</span></span>)</code> </pre><br>  Jadi, <a href="http://dap.js.org/samples/tutorial/7-2.html" rel="nofollow">lihat</a> .  Oke, nama case sekarang berubah tidak hanya di browser, tetapi juga di server.  Tapi!  Tidak hanya nama kasus dapat berubah, tetapi juga status penyelesaiannya - <code>completed</code> .  Jadi, itu juga perlu dikirim ke server. <br>  Anda dapat menambahkan permintaan PATCH yang sama ke elemen <code>INPUT.toggle</code> , cukup kirim <code>(.completed)</code> alih-alih <code>(.completed)</code> : <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'INPUT.toggle type=checkbox'</span></span> .d(<span class="hljs-string"><span class="hljs-string">"#.checked=.completed"</span></span>) .ui(<span class="hljs-string"><span class="hljs-string">"$completed=#.checked; (@method`PATCH .url:dehttp headers (.completed:?)):query"</span></span>)</code> </pre><br>  Dan Anda dapat menempatkan permintaan PATCH ini "out of brackets": <br><br><pre> <code class="javascript hljs"> ,<span class="hljs-string"><span class="hljs-string">'LI'</span></span>.d(<span class="hljs-string"><span class="hljs-string">"$completed=.completed $editing= $patch=; a!"</span></span> <span class="hljs-comment"><span class="hljs-comment">// $patch - ""   ,'INPUT.toggle type=checkbox' .d("#.checked=.completed") .ui("$patch=($completed=#.checked)") //   $patch  completed ,'LABEL.view' .d("? $editing:!; ! .title") .e("dblclick","$editing=`yes") ,'INPUT.edit' .d("? $editing; !! .title@value") .ui("$patch=(.title=#.value)") //   $patch  title .e("blur","$editing=") ,'BUTTON.destroy'.d("") ) .a("!? $completed $editing") //  $patch  ,   ,   .u("? $patch; (@method`PATCH .url:dehttp headers $patch@):query $patch=")</span></span></code> </pre><br>  Ini masalahnya.  Aturan reaksi termasuk dalam kelompok "aturan atas", yang dieksekusi "dari bawah ke atas" - dari turunan ke induk, ke akar itu sendiri (urutan ini dapat diinterupsi jika perlu).  Ini agak seperti acara pop-up di DOM.  Oleh karena itu, beberapa fragmen dari reaksi umum terhadap beberapa keturunan dapat diberikan kepada leluhur yang sama. <br><br>  Secara khusus, dalam kasus kami, keuntungan dari delegasi tersebut tidak terlalu terlihat, tetapi jika ada lebih banyak bidang yang dapat diedit, maka menempatkan permintaan besar ini (berdasarkan standar, tentu saja) ke dalam satu aturan umum akan sangat membantu menjaga kode tetap sederhana dan mudah dibaca.  Jadi saya merekomendasikannya. <br><br>  <a href="http://dap.js.org/samples/tutorial/7-3.html" rel="nofollow">Kami melihat</a> : Sekarang perubahan nama dan perubahan status dikirim ke server. <br><br>  Di artikel selanjutnya, jika Anda tertarik, pertimbangkan untuk menambah, menghapus, dan memfilter kasing.  Sementara itu, Anda dapat melihat <a href="https://dap.js.org/samples/todo.html" rel="nofollow">hasil akhir</a> dan contoh kode dap lainnya di <a href="https://dap.js.org/docs/" rel="nofollow">dap.js.org/docs</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id480912/">https://habr.com/ru/post/id480912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id480900/index.html">Bawa kembali bayiku! (Kisah N.-F)</a></li>
<li><a href="../id480902/index.html">Fitur Pemantauan PostgreSQL Postgres_exporter Baru</a></li>
<li><a href="../id480904/index.html">PHP Microservice Framework: Lingkungan Pengembangan untuk Swoft</a></li>
<li><a href="../id480906/index.html">Menulis game python sederhana</a></li>
<li><a href="../id480910/index.html">Cara membuat kelas tes dasar untuk tes Selenium dan menginisialisasi melalui JUnit RuleChain</a></li>
<li><a href="../id480914/index.html">Layanan microser untuk pemula</a></li>
<li><a href="../id480918/index.html">Kualitas Kode Apache Hadoop: Produksi VS Tes</a></li>
<li><a href="../id480920/index.html">Uji sakelar TP-Link dengan PoE jarak jauh. Dan sedikit tentang peningkatan model lama</a></li>
<li><a href="../id480922/index.html">Evgeny Usvitsky: "Semua orang di dunia tahu di mana mendapatkan geodata secara bebas - hanya di OSM"</a></li>
<li><a href="../id480924/index.html">Bagaimana dan mengapa pembuat remake MediEvil mendesain ulang bos sekte permainan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>