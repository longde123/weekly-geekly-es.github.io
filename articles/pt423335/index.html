<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèø‚Äçü§ù‚Äçüë©üèæ üçÑ üèùÔ∏è Como vencer o clique em Y. Direct e AdWords por 600 mil rublos por m√™s ü§∞üèæ ‚õ∞Ô∏è üñ±Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nos √∫ltimos seis meses, conseguimos derrotar o "clique" de nossa publicidade contextual com um or√ßamento de 1 milh√£o de rublos por m√™s. 

 A chave par...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como vencer o clique em Y. Direct e AdWords por 600 mil rublos por m√™s</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423335/">  Nos √∫ltimos seis meses, conseguimos derrotar o "clique" de nossa publicidade contextual com um or√ßamento de 1 milh√£o de rublos por m√™s. <br><br>  A chave para derrotar a fraude foi o monitoramento por minuto do tr√°fego, com notifica√ß√µes de altera√ß√µes anormais e desativa√ß√£o de an√∫ncios problem√°ticos pela API, al√©m de v√°rios relat√≥rios que refletem a situa√ß√£o em tempo real. <br><br><img src="https://habrastorage.org/webt/ss/cg/tk/sscgtkndx4m1wahkipwk1ozgxwk.png"><br>  <font color="#7c8792">Figura 1. Gr√°fico do n√∫mero de visitantes por palavras-chave por decaminas</font> <br><br><h2>  <font color="#3e6c9a">Como voc√™ sabe que est√° sendo atacado?</font> </h2><br>  <b>Um dos primeiros sinais de um "clique" de publicidade ser√° um aumento na porcentagem de reembolsos por fraude no Yandex.Direct e no AdWords.</b> <br><blockquote>  ‚ÄúNo Yandex Direct, as despesas de fraude s√£o automaticamente devolvidas ao saldo da campanha publicit√°ria.  O n√∫mero de cliques eliminados pelo sistema antifraude √© exibido nos relat√≥rios "estat√≠sticas di√°rias" "estat√≠sticas gerais" na linha "cliques inv√°lidos para todo o per√≠odo selecionado". </blockquote>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ajuda J. Dirija "cliques inv√°lidos"</a> . <br><br>  No Google AdWords, a exibi√ß√£o do n√≠vel de "cliques inv√°lidos" pode ser ativada na guia "colunas": <br><br><img src="https://habrastorage.org/webt/kf/0y/sp/kf0ysp3nbfkov-ypcrfcc1sbmgw.png"><br>  <font color="#7c8792">Figura 2. Colunas personalizadas com um n√≠vel de "clique inv√°lido" no AdWords</font> <br><br>  No nosso caso, com um n√≠vel m√©dio de " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cliques inv√°lidos</a> " no Yandex.Direto ‚âà 10%, o Yandex repentinamente come√ßou a devolver 40% do or√ßamento de publicidade e, ap√≥s um m√™s, 54%. <br><a name="habracut"></a><br>  <b>O pr√≥ximo sinal de uma fraude √© um aumento n√£o razo√°vel no n√∫mero de transi√ß√µes e fortes mudan√ßas nos indicadores comportamentais para v√°rios grupos de an√∫ncios.</b> <br><br>  Observamos que, para v√°rias palavras-chave que nunca tiveram mais de 200 visitantes por dia, surgiram repentinamente picos de at√© 3.000 visitantes.  De fato, o or√ßamento, nos dias de tais atividades, poderia ir para uma campanha publicit√°ria se n√£o fosse interrompido a tempo. <br><br><img src="https://habrastorage.org/webt/dy/dj/37/dydj375imemm0ytnqa6ttkesya8.png"><br>  <font color="#7c8792">Figura 3. Crescimento irracional do tr√°fego para um grupo de an√∫ncios espec√≠fico no Direct</font> <br><br><h2>  <font color="#3e6c9a">Yandex e Google n√£o protegem contra fraudes</font> </h2><br>  Basta ler a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">discuss√£o sobre o n√≠vel de fraude na publicidade contextual</a> no Direct Club oficial para garantir que muitos anunciantes percam dinheiro por causa de fraude. <br><br>  O Google reconhece oficialmente os erros de seu sistema de seguran√ßa e fornece aos anunciantes "Reivindica√ß√µes de reembolso" (retorno do or√ßamento).  Segundo as estat√≠sticas do servi√ßo ClickSease, o Google Ads retorna uma m√©dia de 12% do or√ßamento de publicidade. <br><br><div class="spoiler">  <b class="spoiler_title">Como reembolsar parte do dinheiro por um clique no Google AdWords</b> <div class="spoiler_text">  Voc√™ deve enviar uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reclama√ß√£o sobre "cliques inv√°lidos"</a> ao Google AdWords, ap√≥s o qual ser√° reembolsado com ‚âà 12% do dinheiro gasto.  Al√©m disso, o servi√ßo ClickSease envia automaticamente solicita√ß√µes semelhantes de reembolso a cada 2 meses ao Google. <br><br>  No nosso caso, o Google AdWords primeiro reconheceu 18% do tr√°fego como " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">inv√°lido</a> " e devolveu o dinheiro por eles. Quando enviamos a reclama√ß√£o de "solicita√ß√µes de reembolso", o Google reembolsou outros 13% do or√ßamento. <br></div></div><br>  O Yandex n√£o reconhece a vulnerabilidade de seus pr√≥prios filtros de prote√ß√£o e reclama√ß√µes sobre casos √≥bvios de fraude, envia uma resposta de modelo de que o problema est√° no anunciante e em seu site. <br><br>  No nosso caso, a porcentagem de "cliques inv√°lidos" no relat√≥rio da Y. Direct nunca subiu acima dos 50% cobi√ßados por qualquer uma das campanhas de publicidade, mesmo nos dias das explos√µes mais violentas, quando 80% do or√ßamento "se fundiram" no grupo de an√∫ncios geralmente pouco popular sem chamadas e aplica√ß√µes. <br><br><img src="https://habrastorage.org/webt/6h/4u/ef/6h4uefov0nkyjh0n3wpuii9qb0q.png"><br>  <font color="#7c8792">Figura 4. O n√≠vel de "cliques inv√°lidos" em uma das campanhas no Direct</font> <br><br><h2>  <font color="#3e6c9a">Que n√≠vel de ataque encontramos?</font> </h2><br>  O tr√°fego de fraudes foi direcionado para quatro linhas de neg√≥cios em duas cidades.  Ao conectar novas campanhas de publicidade ou iniciar campanhas h√° muito tempo, em poucas horas o "clique" tamb√©m foi redistribu√≠do. <br><br>  A fraude de cliques n√£o estava vinculada ao tempo e a redistribui√ß√£o do or√ßamento, por exemplo, √† noite, n√£o teve efeito: ainda recebemos nosso volume de tr√°fego restante.  "Clicar" estava igualmente ativo na YAN, na pesquisa Yandex e na Rede de Display do Google. <br><br>  No site, os bots simulavam o comportamento do usu√°rio, navegavam pelas se√ß√µes do site, selecionavam o texto, rolavam naturalmente e moviam o cursor. <br><br><h2>  <font color="#3e6c9a">Existem rem√©dios prontos?</font> </h2><br>  Todos os servi√ßos de prote√ß√£o contra fraudes por clique t√™m apenas uma ferramenta de luta direta - isso est√° bloqueando endere√ßos IP ou sites de posicionamento suspeitos nas campanhas Ya.Direct e AdWords. <br><br>  Caso IPs din√¢micos sejam usados ‚Äã‚Äãcontra voc√™, qualquer servi√ßo de controle de fraude de cliques estar√° sempre um passo atr√°s dos golpistas ao bloque√°-los por IP: o bot j√° far√° v√°rios cliques no seu an√∫ncio quando o servi√ßo colocar na lista negra esse IP e pare de exibir an√∫ncios nele.  Al√©m disso, depois que um software fraudulento n√£o conseguir ver seus an√∫ncios, ele simplesmente mudar√° o endere√ßo IP, ID do hardware e continuar√° suas a√ß√µes. <br><br>  Ao atacar an√∫ncios na GDN ou YAN, geralmente s√£o usados ‚Äã‚Äãv√°rios canais, e os sistemas de prote√ß√£o autom√°tica n√£o conseguem detectar sites suspeitos de bloqueio. <br><br>  Vamos voltar ao bloqueio de IP - aqui chegamos √† parte mais interessante: se o AdWords permitir bloquear at√© 500 endere√ßos IP, o <u>Yandex Direct poder√° bloquear apenas 25 endere√ßos IP exclusivos</u> por campanha publicit√°ria!  Uma lista negra t√£o pequena de endere√ßos IP n√£o √© mais relevante, pois agora voc√™ pode comprar com seguran√ßa 500 endere√ßos IPv4 por 10 mil rublos e contornar essa limita√ß√£o. <br><br>  Existem duas maneiras de se proteger de "cliques" de alto n√≠vel: <br><br><ol><li>  aprenda a n√£o exibir an√∫ncios para usu√°rios ou bots fraudulentos, para os quais voc√™ precisa encontrar certos "padr√µes" em seu comportamento e caracter√≠sticas; <br></li><li>  interrompa temporariamente grupos de an√∫ncios e palavras-chave espec√≠ficos que est√£o sendo segmentados. <br></li></ol><br><h2>  <font color="#3e6c9a">Corte parte da audi√™ncia para economizar a maior parte</font> </h2><br>  Se voc√™ aprender a n√£o exibir publicidade de clique para bots ou usu√°rios fraudulentos, eles n√£o poder√£o prejudicar. <br><br>  Voc√™ sempre pode rastrear padr√µes semelhantes de comportamento e padr√µes, por exemplo, que a fraude geralmente √© executada no Windows 7 das 5:00 √†s 9:00 em Moscou e define o ajuste de lance para -100% para um p√∫blico semelhante em todas as campanhas publicit√°rias atacadas.  A funcionalidade dos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ajustes</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lance no Google AdWords √©</a> bastante extensa, o que n√£o pode ser dito sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ajustes no Yandex Direct</a> . <br><br><h3>  Estamos √† procura de padr√µes de fraude atrav√©s de servi√ßos de seguran√ßa </h3><br>  Para ter uma id√©ia de como exatamente eles est√£o nos atacando e rastrear manualmente padr√µes em tr√°fego fraudulento, conectamos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">servi√ßo</a> antifraude russo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ClickFrog</a> .  O produto √© conhecido por todos h√° muito tempo, popular no ambiente de CPA e assim por diante. <br><br>  O ClickFrog provou rapidamente uma completa incapacidade: <br><br><ol><li>  por dia alocou n√£o mais de 40 endere√ßos IP suspeitos, com tr√°fego do Direct a 3.000 mil cliques por dia e, mesmo reconhecido pela Yandex, 1300 cliques "deixados" por dia; <br></li><li>  a principal ferramenta para proteger o servi√ßo √© o bloqueio pelo endere√ßo IP, cujo comando √© enviado via API para J. Direct, no entanto, assim que a lista negra de 25 endere√ßos IP √© preenchida, √© necess√°rio excluir manualmente os √∫ltimos IPs em cada campanha de publicidade e aguardar o preenchimento da pr√≥xima lista. ent√£o em um c√≠rculo. <br></li></ol><br>  Em seguida, instalamos o c√≥digo do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ClickSease</a> , um servi√ßo americano voltado para o AdWords e que ainda n√£o trabalha com o Yandex.Direct.  A prop√≥sito, o servi√ßo tem, diferentemente do ClickFrog, um per√≠odo de teste gratuito de 2 semanas. <br><br>  O ClickSease acabou sendo mais √∫til: come√ßou a capturar 300-400 IPs fraudulentos exclusivos por dia.  Para cada servi√ßo IP bloqueado, fornece estat√≠sticas: <br><br><ul><li>  Fornecedor de Servi√ßos Internet </li><li>  a plataforma a partir da qual a transi√ß√£o ocorreu; </li><li>  sistema operacional </li><li>  ID do dispositivo exclusivo </li><li>  hora da primeira e da √∫ltima transi√ß√£o; </li><li>  regi√£o. </li></ul><br>  No relat√≥rio ClickSease, conseguimos identificar padr√µes na fraude: <br><ul><li>  em 81% dos casos, o dispositivo simula um sistema operacional m√≥vel: Android ou iOS; </li><li>  em 59% dos casos, a localiza√ß√£o geogr√°fica do endere√ßo IP n√£o se aplica a Moscou, com a fraude direcionada a Moscou. </li></ul><br><h3>  Procurando padr√µes manualmente em fraudes </h3><br>  No entanto, mesmo esses padr√µes √≥bvios n√£o foram suficientes para reduzir os danos causados ‚Äã‚Äãpor fraudes, e eu n√£o queria desativar os an√∫ncios para celular.  Geralmente, os servi√ßos s√£o capazes de fornecer id√©ias para identificar padr√µes semelhantes de fraude e, ent√£o, voc√™ precisa detectar a fraude no Metric (no caso de um ataque ao Direct) e selecion√°-la em um segmento separado do Yandex Audience para an√°lise e bloqueio adicionais. <br><br><img src="https://habrastorage.org/webt/p3/op/ya/p3opya9dpzuhirhhz0_wfdeywf8.png"><br>  <font color="#7c8792">Figura 5. Um exemplo de an√°lise de tr√°fego por faixas et√°rias no Metric para pesquisar padr√µes de fraude</font> <br><br>  Fatias de tr√°fego para ajudar a identificar padr√µes de fraude: <br><ul><li>  din√¢mica do p√∫blico-alvo por faixas et√°rias; </li><li>  din√¢mica de interesses de longo prazo dos usu√°rios; </li><li>  din√¢mica de dispositivos e sistemas operacionais. </li></ul><br>  <b>No caso do Google AdWords, a contramedida √© clara:</b> <br><br><ol><li>  definimos um segmento de p√∫blico "infectado" por fraude; </li><li>  Definimos ajustes de lance de -100% para o segmento selecionado; </li><li>  Monitoramos mudan√ßas nos indicadores: convers√£o, tempo no site, profundidade de visualiza√ß√£o, taxa de rejei√ß√£o. </li></ol><br>  <b>No Yandex Direct, a mec√¢nica da luta √© mais complexa e dividida em duas op√ß√µes:</b> <br><br>  a) voc√™ conseguiu encontrar um padr√£o √≥bvio de fraude relacionado a sexo, idade ou mobilidade: <br><br><ol><li>  definimos um ajuste de lance de -50% ou -100% para o segmento selecionado; </li><li>  Monitoramos a mudan√ßa nos principais indicadores. </li></ol><br>  b) n√£o foram encontrados padr√µes √≥bvios: <br><br><ol><li>  selecionamos o tr√°fego de fraude em um segmento <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Yandex.Audience</a> separado (por exemplo, voc√™ sabia que de 1 a 20 de outubro n√£o poderia haver 5.000 cliques em um grupo de an√∫ncios, que sempre tinha mais de 30 visitas por dia) </li><li>  por meio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">do Yandex,</a> criamos um segmento de usu√°rios semelhante √† nossa fraude; </li><li>  defina um ajuste de lance de -100% para um segmento de p√∫blico-alvo criado manualmente; </li><li>  Testamos cuidadosamente a redu√ß√£o nas taxas de publicidade para segmentos criados pela Yandex. </li></ol><br><h2>  <font color="#3e6c9a">Crie gr√°ficos que mostrem fraudes</font> </h2><br>  <b>A fraude sempre gera focos e picos √≥bvios</b> , seja um software obscuro com uma imita√ß√£o do comportamento de um usu√°rio real ou de um grupo de freelancers que executam a tarefa t√©cnica. <br><br><img src="https://habrastorage.org/webt/go/o2/al/goo2alj10gtzlycltq5rje0hoji.png"><br>  <font color="#7c8792">Figura 6. Gr√°fico do n√∫mero de visitantes por palavras-chave por decaminas</font> <br><br>  A fraude ocorre de maneira desigual por v√°rios motivos: <br><ul><li>  Para facilitar o ataque, voc√™ precisa ter informa√ß√µes confidenciais e saber quem, quando e quantos cliques seus an√∫ncios fazem; </li><li>  o software age em movimentos bruscos e, no minuto, 10 minutos e, √†s vezes, no gr√°fico hor√°rio, suas a√ß√µes ser√£o impressionantes; </li><li>  mesmo que ‚Äúcrian√ßas em idade escolar‚Äù trabalhem contra voc√™ em quadros de avisos, eles agem em uma tarefa espec√≠fica com um algoritmo, e as anomalias geradas por eles ser√£o f√°ceis de rastrear. </li></ul><br>  Se voc√™ aprender a encontrar e eliminar rapidamente os focos, poder√° reduzir significativamente os danos causados ‚Äã‚Äãpela fraude.  No nosso caso, um sinal √≥bvio foi um aumento anormal no n√∫mero de cliques na publicidade contextual em 10 minutos espec√≠ficos ou em um minuto para algumas palavras-chave. <br><br>  Para visualiza√ß√£o, o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Google Data Studio √©</a> mais adequado, pois apenas o Analytics consegue coletar dados detalhados no tempo por 1 e 10 minutos, e o Metrika, ao criar relat√≥rios sobre dekomints, fornece indicadores incorretos. <br><br><div class="spoiler">  <b class="spoiler_title">Como criar gr√°ficos em 10 minutos, e n√£o de hora em hora, no Google Data Studio</b> <div class="spoiler_text">  Por padr√£o, no Analytics ou no Data Studio, voc√™ n√£o pode criar gr√°ficos por minuto ou por 10 minutos, mas isso pode ser feito da seguinte maneira no Date Studio: <br><br>  Etapa 1. Abra a edi√ß√£o do campo <br><br><img src="https://habrastorage.org/webt/sy/y2/1v/syy21vr-evstitegmwu-ivqreh8.png"><br><br>  Etapa 2. Crie c√≥pias dos seguintes campos: Ano, M√™s do ano, Dia do m√™s, Hora, Minuto e nomeie-os, por exemplo, Ano (dia), M√™s do ano (dia) e assim por diante.  Tamb√©m nos campos copiados, voc√™ deve alterar o Tipo do formato de data e hora para "n√∫mero", conforme mostrado na figura. <br><br><img src="https://habrastorage.org/webt/zj/3a/a6/zj3aa66qqh0eq42cyc-ajbujxzm.png"><br>  <font color="#7c8792">Etapa 2. Altere o tipo do campo copiado de "data" para "n√∫mero"</font> <br><br>  Etapa 3. Crie um novo campo no qual escrevemos a seguinte f√≥rmula: Ano (dia) * 10000000 + M√™s do ano (dia) * 100000 + Dia do m√™s (dia) * 1000 + Hora (dia) * 10 + PISO (Minuto (dia) / 10) <br><br><img src="https://habrastorage.org/webt/ud/mm/8o/udmm8oej5cb9ysefk3zpmka2rvs.png"><br>  <font color="#7c8792">Etapa 3. Crie um campo calculado "Tempo por 10 minutos"</font> <br><br>  Etapa 4. Salvamos o campo criado, retornamos √† lista de todos os campos e encontramos nosso novo campo "Tempo por 10 minutos (decamenut)".  √â necess√°rio alterar seu tipo de "N√∫mero" para "Data e hora", como mostrado na figura, e depois atribuir o tipo "N√∫mero" de volta a este campo. <br><br><img src="https://habrastorage.org/webt/7f/bi/hh/7fbihh4hc4yss02cqsfra1ljfta.png"><br>  <font color="#7c8792">Etapa 4. Crie um campo calculado "Tempo por 10 minutos"</font> <br><br>  Etapa 5. Crie um "Gr√°fico combinado" e defina nosso novo campo "Tempo por 10 minutos" como par√¢metro, conforme mostrado na figura.  Feito. <br><br><img src="https://habrastorage.org/webt/rq/o5/hy/rqo5hybxbnptkakzlyrs4rclzqu.png"><br>  <font color="#7c8792">Etapa 5. Crie um "gr√°fico de combina√ß√£o"</font> <br></div></div><br><br><h2>  <font color="#3e6c9a">Configurar notifica√ß√µes nos surtos de fraude</font> </h2><br>  Para n√£o acompanhar todos os casos de fraude manualmente, fiz um relat√≥rio no Planilhas Google, que atualiza os dados a cada minuto e notifica o in√≠cio da fraude. <br><br>  O Planilhas Google suporta a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">API de relat√≥rios principais</a> , que pode ser acessada atrav√©s do Editor de scripts no Planilhas. <br><br>  Etapa 1. Acesse o editor de scripts para acessar o Analytics <br><br><img src="https://habrastorage.org/webt/fe/6t/r-/fe6tr-kjvklwxovqwutpmuvbvcc.png"><br>  <font color="#7c8792">Figura 7. Editor de scripts para acessar a API de relat√≥rios principais do Analytics via Google Tables</font> <br><br>  Etapa 2. Escrevemos uma solicita√ß√£o de API ao Analytics para receber dados sobre os indicadores necess√°rios (por exemplo, o n√∫mero de usu√°rios que clicaram em publicidade paga a cada minuto do dia, como no nosso caso). <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo do Script do Google para solicitar dados do Analytics no Planilhas Google</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">runDemo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstProfile = getFirstProfile(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> results = getReportDataForProfile(firstProfile); outputToSpreadsheet(results); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error) { Browser.msgBox(error.message); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFirstProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> accounts = Analytics.Management.Accounts.list(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (accounts.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstAccountId = accounts.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>].getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> webProperties = Analytics.Management.Webproperties.list(firstAccountId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (webProperties.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstWebPropertyId = webProperties.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>].getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profiles = Analytics.Management.Profiles.list(firstAccountId, firstWebPropertyId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (profiles.getItems()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> firstProfile = profiles.getItems()[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> firstProfile; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No views (profiles) found.'</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No webproperties found.'</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'No accounts found.'</span></span>); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getReportDataForProfile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">firstProfile</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> profileId = firstProfile.getId(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tableId = <span class="hljs-string"><span class="hljs-string">'ga:'</span></span> + profileId; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> startDate = <span class="hljs-string"><span class="hljs-string">"today"</span></span>; <span class="hljs-comment"><span class="hljs-comment">// getLastNdays(14)  2 weeks (a fortnight) ago. var endDate = "today"; //getLastNdays(0)  Today. var optArgs = { 'dimensions': 'ga:date,ga:hour,ga:minute,ga:sourceMedium', // Comma separated list of dimensions. 'sort': 'ga:date,ga:hour,ga:minute', // Sort by sessions descending, then keyword. //'segment': 'dynamic::ga:isMobile==Yes', // Process only mobile traffic. 'filters': 'ga:sourceMedium==yandex / cpc', 'start-index': '1', 'max-results': '10000' // Display the first 250 results. }; // Make a request to the API. var results = Analytics.Data.Ga.get( tableId, // Table id (format ga:xxxxxx). startDate, // Start-date (format yyyy-MM-dd). endDate, // End-date (format yyyy-MM-dd). 'ga:users', // Comma seperated list of metrics. optArgs); if (results.getRows()) { return results; } else { throw new Error('No views (profiles) found'); } } function getLastNdays(nDaysAgo) { var today = new Date(); var before = new Date(); before.setDate(today.getDate() - nDaysAgo); return Utilities.formatDate(before, 'GMT', 'yyyy-MM-dd'); } function outputToSpreadsheet(results) { var sheets = SpreadsheetApp.getActiveSpreadsheet(); var sheet = sheets.getSheetByName("coeff1"); var range = sheet.getRange('A:E'); range.clear(); // Print the headers. var headerNames = []; for (var i = 0, header; header = results.getColumnHeaders()[i]; ++i) { headerNames.push(header.getName()); } sheet.getRange(1, 1, 1, headerNames.length) .setValues([headerNames]); // Print the rows of data. sheet.getRange(2, 1, results.getRows().length, headerNames.length) .setValues(results.getRows()); }</span></span></code> </pre> <br></div></div><br><br>  Etapa 3. Definimos o gatilho para atualizar dados a cada minuto: <br><br><img src="https://habrastorage.org/webt/bu/-f/lq/bu-flq0ftubu0wa1lcqxw1uilz0.png"><br>  <font color="#7c8792">Figura 8. Solicitamos novos dados a cada minuto para uma resposta r√°pida a fraudes</font> <br><br>  Etapa 4. Criamos uma tabela din√¢mica a partir da planilha atualizada com os dados necess√°rios uma vez por minuto e analisamos esses indicadores para configurar gatilhos para notifica√ß√µes por email ou desativar grupos de an√∫ncios usando a API Yandex.Direct ou o AdWords. <br><br><img src="https://habrastorage.org/webt/ha/ba/-g/haba-goptrqk9xjgxrge_wjqqjs.png" alt="imagem">  <font color="#7c8792">Figura 9. Um exemplo de configura√ß√£o de f√≥rmulas para notifica√ß√µes de anomalia</font> <br><br><div class="spoiler">  <b class="spoiler_title">Um exemplo do meu c√≥digo do Google Script para enviar notifica√ß√µes por email</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ss = SpreadsheetApp.getActiveSpreadsheet(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sheet = ss.getSheetByName(<span class="hljs-string"><span class="hljs-string">"notification"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> range = sheet.getRange(<span class="hljs-string"><span class="hljs-string">"D2:E4"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// The row and column here are relative to the range // getCell(1,1) in this code returns the cell at B2, B2 var cell = range.getCell(1, 2); Logger.log(cell.getValue()); if (cell.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell.getValue(), "Check me "+range.getCell(1, 1).getValue()); } else { } var cell2 = range.getCell(2, 2); Logger.log(cell2.getValue()); if (cell2.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell2.getValue(), "Check me "+range.getCell(2, 1).getValue()); } else { } var cell3 = range.getCell(3, 2); Logger.log(cell3.getValue()); if (cell3.getValue() !== "no") { MailApp.sendEmail("your_email@yandex.ru", "Fraud notification "+cell3.getValue(), "Check me "+range.getCell(3, 1).getValue()); } else { } }</span></span></code> </pre> <br></div></div><br><h2>  <font color="#3e6c9a">Bottom line: como vencer o clique</font> </h2><br>  A luta contra a fraude por clique pode ser dividida em tr√™s grupos: <br><br>  a) A√ß√µes proativas: <br><ul><li>  desligamento de "sites polu√≠dos"; </li><li>  Desativar publicidade para um p√∫blico com sinais de fraude para voc√™, por exemplo, para pessoas em tablets de S√£o Petersburgo (par√¢metros mais complexos de bloqueio podem ser usados ‚Äã‚Äãnas listas do AdWords e nos segmentos M√©tricos); </li><li>  ajuste de lance para segmentos de p√∫blico-alvo semelhantes a segmentos de fraude (segmentos "parecidos" s√£o criados nas listas Y. Audi√™ncias e Google); </li><li>  bloquear fraudes por m√°scaras de rede IP (dispon√≠vel apenas no Google AdWords). </li></ul><br>  b) A√ß√µes preventivas: <br><ul><li>  Relat√≥rios de reembolsos de or√ßamento para o AdWords e o Direct </li><li>  a investiga√ß√£o de "quem ordenou o ataque contra voc√™"; </li><li>  agrupamento de grupos de an√∫ncios suspeitos e frequentemente atacados em uma √∫nica campanha publicit√°ria; </li><li>  "Armadilhas" para os bots mais simples, como bot√µes ocultos no site que s√£o vis√≠veis apenas para o bot e, quando clicados, entram na lista. </li></ul><br>  c) A√ß√µes ‚Äúpost factum‚Äù: <br><ul><li>  bloqueio por endere√ßos IP; </li><li>  desconex√£o r√°pida de centros de cliques: palavras-chave, grupos de an√∫ncios, campanhas publicit√°rias, segmentos de p√∫blico-alvo. </li></ul><br><img src="https://habrastorage.org/webt/lh/kt/qu/lhktquoljkgpshxr78ig6mspa4q.png" alt="imagem"><br>  <font color="#7c8792">Figura 10. Prote√ß√£o contra clique fraudulento</font> <br><br>  <b>Links √∫teis:</b> <b><br></b> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Biblioteca da</a> API de relat√≥rios principais </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Query Explorer</a> para comandos convenientes da API de teste; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criamos scripts para automatizar o trabalho com aplicativos do Google</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Automatize o Planilhas Google</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Analytics Intelligence</a> , para perguntar ao bot do Analytics: - "Mas houve alguma anomalia no tr√°fego pago no ano passado?"  - e obtenha uma resposta clara. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Como descobrir quem ordenou o ataque ao seu an√∫ncio</b> <div class="spoiler_text">  Qualquer competidor adequado minimizar√° seus danos ao atacar outros: <br><br><ol><li>  primeiro, o atacante tentar√° n√£o mostrar seu an√∫ncio nas dire√ß√µes em que o ataque est√° acontecendo no momento, para n√£o mesclar sua CTR e aumentar seu CPC; <br></li><li>  segundo, um concorrente inescrupuloso selecionar√° essas palavras-chave para o ataque, segundo as quais ele pode parar de exibir seus an√∫ncios sem causar muitos danos a si mesmo. <br></li></ol><br>  No nosso caso, o concorrente tamb√©m come√ßou a clicar em fraudes em quatro dire√ß√µes em duas cidades, por isso n√£o foi dif√≠cil calcul√°-las. <br><br>  Para facilitar a an√°lise dos concorrentes com os quais voc√™ interage, voc√™ pode ver todos os an√∫ncios concorrentes inclu√≠dos para cada palavra-chave na interface Yandex.Direct: <br><br><img src="https://habrastorage.org/webt/w2/_t/4p/w2_t4p4zpj0imyxdogo7saha0sg.png"><br>  <font color="#7c8792">Figura 9. Todos os an√∫ncios concorrentes por palavra-chave</font> <br></div></div><br><br>  <b>Quem tamb√©m enfrentou o clique de publicidade contextual - escreva nos coment√°rios, tentaremos ajudar um ao outro!</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt423335/">https://habr.com/ru/post/pt423335/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt423317/index.html">Por que homem Scala?</a></li>
<li><a href="../pt423319/index.html">Integra√ß√£o de c√≥digo Vivaldi. Nossos desenvolvedores dizem</a></li>
<li><a href="../pt423321/index.html">Protegendo reposit√≥rios GitHub de confirma√ß√µes maliciosas</a></li>
<li><a href="../pt423323/index.html">"Voc√™ precisa ter pregui√ßa de se tornar um bom testador."</a></li>
<li><a href="../pt423329/index.html">Preparando-se para uma entrevista com uma empresa Big Five</a></li>
<li><a href="../pt423337/index.html">Como fazer amigos PHPstorm, xDebug e ramifica√ß√µes remotas compiladas pelo Docker? Muito simples ...</a></li>
<li><a href="../pt423339/index.html">Existe vida no Windows 98, parte um - sobre hardware</a></li>
<li><a href="../pt423341/index.html">Sob press√£o do p√∫blico, a Sony admitiu que os trabalhos de Bach n√£o pertencem a ela.</a></li>
<li><a href="../pt423343/index.html">Valores culturais feitos de pl√°stico come√ßam a decair</a></li>
<li><a href="../pt423345/index.html">La√ßo de medo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>