<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî£ ü§πüèΩ üßïüèº M√©taprogrammation JavaScript üÜó ü§∑üèø üë®üèø‚Äçü§ù‚Äçüë®üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La m√©taprogrammation est un type de programmation associ√© √† la cr√©ation de programmes qui g√©n√®rent d'autres programmes √† la suite de leur travail, ou ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>M√©taprogrammation JavaScript</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/docsvision/blog/417097/"><blockquote>  La m√©taprogrammation est un type de programmation associ√© √† la cr√©ation de programmes qui g√©n√®rent d'autres programmes √† la suite de leur travail, ou des programmes qui se modifient pendant l'ex√©cution.  (Wikipedia) </blockquote><p>  Dans un langage plus simple, la m√©taprogrammation dans JavaScript peut √™tre consid√©r√©e comme un m√©canisme qui vous permet d'analyser et de modifier le programme en temps r√©el en fonction de toute action.  Et, tr√®s probablement, vous les utilisez d'une mani√®re ou d'une autre pour √©crire des scripts tous les jours. </p><a name="habracut"></a><br><p>  JavaScript, de par sa nature, est un langage dynamique tr√®s puissant et vous permet d'√©crire facilement du code flexible: </p><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   save-    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> comment = { <span class="hljs-attr"><span class="hljs-attr">authorId</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">comment</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> comment) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> pascalCasedName = name.slice(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).toUpperCase() + name.slice(<span class="hljs-number"><span class="hljs-number">1</span></span>); comment[<span class="hljs-string"><span class="hljs-string">`save</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${pascalCasedName}</span></span></span><span class="hljs-string">`</span></span>] = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   } } comment.saveAuthorId(); //  authorId comment.saveComment(); //  comment</span></span></code> </pre> <br><p>  Un code similaire pour la cr√©ation dynamique de m√©thodes dans d'autres langues peut tr√®s souvent n√©cessiter une syntaxe ou une API sp√©ciale pour cela.  Par exemple, PHP est √©galement un langage dynamique, mais il n√©cessitera plus d'efforts: </p><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Comment</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $authorId; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $comment; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($authorId, $comment)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;authorId = $authorId; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;comment = $comment; } <span class="hljs-comment"><span class="hljs-comment">//       public function __call($methodName, $arguments) { foreach (get_object_vars($this) as $fieldName =&gt; $fieldValue) { $saveMethodName = "save" . strtoupper($fieldName[0]) . substr($fieldName, 1); if ($methodName == $saveMethodName) { //   } } } } $comment = new Comment(1, ''); $comment-&gt;saveAuthorId(); //  authorId $comment-&gt;saveComment(); //  comment</span></span></code> </pre> <br><p>  En plus de la syntaxe flexible, nous avons √©galement un tas de fonctions utiles pour √©crire du code dynamique: Object.create, Object.defineProperty, Function.apply et bien d'autres. </p><br><p>  Consid√©rez-les plus en d√©tail. </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">G√©n√©ration de code</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Travailler avec des fonctions</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Travailler avec des objets</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API Reflect</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symboles</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Proxy</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Conclusion</a> </li></ol><br><h2 id="1-generaciya-koda">  1. G√©n√©ration de code </h2><br><p>  L'outil standard pour ex√©cuter dynamiquement du code est la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">eval</a> , qui vous permet d'ex√©cuter du code √† partir de la cha√Æne pass√©e: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">eval</span></span>(<span class="hljs-string"><span class="hljs-string">'alert("Hello, world")'</span></span>);</code> </pre> <br><p>  Malheureusement, eval a de nombreuses nuances: </p><br><ul><li>  si notre code est √©crit en mode strict ('use strict'), alors les variables d√©clar√©es dans eval ne seront pas visibles dans le code eval appelant.  En m√™me temps, le code lui-m√™me dans eval peut toujours changer les variables externes. </li><li>  le code dans eval peut √™tre ex√©cut√© √† la fois dans le contexte global (s'il est appel√© via window.eval) et dans le contexte de la fonction √† l'int√©rieur de laquelle l'appel a √©t√© effectu√© (si juste eval, sans fen√™tre). </li><li>  des probl√®mes peuvent survenir en raison de la minification JS, lorsque les noms de variables sont remplac√©s par des noms plus courts pour r√©duire la taille.  Le code transmis sous forme de cha√Æne √† eval ne touche g√©n√©ralement pas le minifieur, c'est pourquoi nous pouvons commencer √† acc√©der √† des variables externes en utilisant d'anciens noms non minimis√©s, ce qui entra√Ænera des erreurs subtiles. </li></ul><br><p>  Il existe une excellente alternative √† la r√©solution de ces probl√®mes: la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nouvelle fonction</a> . </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hello = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Function</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'alert("Hello, " + name)'</span></span>); hello(<span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-comment"><span class="hljs-comment">// alert("Hello, ");</span></span></code> </pre> <br><p>  Contrairement √† eval, nous pouvons toujours passer explicitement les param√®tres √† travers les arguments d'une fonction et lui donner dynamiquement le contexte de celle-ci (via <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function.apply</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function.call</a> ).  De plus, la fonction cr√©√©e est toujours appel√©e dans la port√©e globale. </p><br><p>  Autrefois, eval √©tait souvent utilis√© pour changer dynamiquement le code, comme  JavaScript avait tr√®s peu de m√©canismes de r√©flexion et il √©tait impossible de se passer d'eval.  Mais dans la norme de langage moderne, beaucoup plus de fonctionnalit√©s de haut niveau sont apparues et eval est maintenant utilis√© beaucoup moins souvent. </p><br><h2 id="2-rabota-s-funkciyami">  2. Travailler avec des fonctions </h2><br><p>  JavaScript nous fournit de nombreux excellents outils pour travailler dynamiquement avec les fonctions, nous permettant √† la fois d'obtenir diverses informations sur la fonction lors de l'ex√©cution et de la modifier: </p><br><ul><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function.length</a> - vous permet de conna√Ætre le nombre d'arguments d'une fonction: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> func = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, surname</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${surname}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${name}</span></span></span><span class="hljs-string">`</span></span>) }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(func.length) <span class="hljs-comment"><span class="hljs-comment">// 2</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function.apply</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function.call</a> - vous permettent de changer dynamiquement le contexte de cette fonction: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> person = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">introduce</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">` </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string">`</span></span>; } } person.introduce(); <span class="hljs-comment"><span class="hljs-comment">//   person.introduce.call({ name: '' }); //  </span></span></code> </pre> <br><p>  Ils ne diff√®rent les uns des autres que par le fait que, dans Function.apply, les arguments de la fonction sont servis sous forme de tableau et dans Function.call, s√©par√©s par des virgules.  Cette fonctionnalit√© √©tait souvent utilis√©e auparavant pour transmettre une liste d'arguments √† la fonction sous forme de tableau.  Un exemple courant est la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Math.max</a> (par d√©faut, elle ne peut pas fonctionner avec les tableaux): </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]); <span class="hljs-comment"><span class="hljs-comment">// 4</span></span></code> </pre> <br><p>  Avec l'av√®nement du nouvel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">op√©rateur de spread,</a> vous pouvez simplement √©crire ceci: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(...[<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]); <span class="hljs-comment"><span class="hljs-comment">// 4</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function.bind</a> - vous permet de cr√©er une copie d'une fonction √† partir d'une fonction existante, mais avec un contexte diff√©rent: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> person = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">introduce</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">` </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.name}</span></span></span><span class="hljs-string">`</span></span>; } } person.introduce(); <span class="hljs-comment"><span class="hljs-comment">//   const introduceEgor = person.introduce.bind({ name: '' }); introduceEgor(); //  </span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function.caller</a> - vous permet d'obtenir la fonction appelante.  <strong>Il n'est pas recommand√© de l'utiliser</strong> , car il est absent de la norme de langue et ne fonctionnera pas en mode strict.  Cela √©tait d√ª au fait que si divers moteurs JavaScript impl√©mentent l'optimisation d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">appel de queue</a> d√©crite dans la sp√©cification de langage, alors appeler Function.caller peut commencer √† produire des r√©sultats incorrects.  Exemple d'utilisation: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(a.caller == b); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ a(); } b(); <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function.toString</a> - Renvoie une repr√©sentation sous forme de cha√Æne de la fonction.  Il s'agit d'une fonctionnalit√© tr√®s puissante qui vous permet d'examiner √† la fois le contenu d'une fonction et ses arguments: </p><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getFullName = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, surname, middlename</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${surname}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${name}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${middlename}</span></span></span><span class="hljs-string">`</span></span>); } getFullName.toString() <span class="hljs-comment"><span class="hljs-comment">/* * "(name, surname, middlename) =&gt; { * console.log(`${surname} ${name} ${middlename}`); * }" */</span></span></code> </pre> <br><p>  Apr√®s avoir re√ßu une repr√©sentation sous forme de cha√Æne d'une fonction, nous pouvons l'analyser et l'analyser.  Cela peut √™tre utilis√©, par exemple, pour extraire les noms des arguments de fonction et, selon le nom, remplacer automatiquement le param√®tre souhait√©.  En g√©n√©ral, il existe deux fa√ßons d'analyser: </p><br><ul><li>  Analyser un tas d'habitu√©s et nous obtenons un niveau de fiabilit√© acceptable (peut ne pas fonctionner si nous ne couvrons pas tous les types possibles d'entr√©es de fonction). </li><li>  Nous obtenons la repr√©sentation sous forme de cha√Æne de la fonction et la mettons dans l'analyseur JavaScript fini (par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">esprima</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">gland</a> ), puis nous travaillons avec l'AST structur√©.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exemple d'analyse AST via esprima.</a>  Je peux √©galement conseiller un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bon rapport sur les analyseurs</a> d'Alexei Okhrimenko. </li></ul><br></li></ul><br><p>  Exemples simples avec analyse r√©guli√®re des fonctions: </p><br><div class="spoiler">  <b class="spoiler_title">Obtention d'une liste d'arguments de fonction</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *    . * @param fn  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getFunctionParams = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fn</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> COMMENTS = <span class="hljs-regexp"><span class="hljs-regexp">/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,\)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,\)]*))/gm</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DEFAULT_PARAMS = <span class="hljs-regexp"><span class="hljs-regexp">/=[^,]+/gm</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FAT_ARROW = <span class="hljs-regexp"><span class="hljs-regexp">/=&gt;.*$/gm</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ARGUMENT_NAMES = <span class="hljs-regexp"><span class="hljs-regexp">/([^\s,]+)/g</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> formattedFn = fn .toString() .replace(COMMENTS, <span class="hljs-string"><span class="hljs-string">""</span></span>) .replace(FAT_ARROW, <span class="hljs-string"><span class="hljs-string">""</span></span>) .replace(DEFAULT_PARAMS, <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> params = formattedFn .slice(formattedFn.indexOf(<span class="hljs-string"><span class="hljs-string">"("</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>, formattedFn.indexOf(<span class="hljs-string"><span class="hljs-string">")"</span></span>)) .match(ARGUMENT_NAMES); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> params || []; }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getFullName = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, surname, middlename</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(surname + <span class="hljs-string"><span class="hljs-string">' '</span></span> + name + <span class="hljs-string"><span class="hljs-string">' '</span></span> + middlename); }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(getFunctionParams(getFullName)); <span class="hljs-comment"><span class="hljs-comment">// ["name", "surname", "middlename"]</span></span></code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><div class="spoiler">  <b class="spoiler_title">Obtenir la fonction corporelle</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *     . * @param fn  */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> getFunctionBody = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fn</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> restoreIndent = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">body</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> lines = body.split(<span class="hljs-string"><span class="hljs-string">"\n"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bodyLine = lines.find(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">line</span></span></span><span class="hljs-function"> =&gt;</span></span> line.trim() !== <span class="hljs-string"><span class="hljs-string">""</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> indent = <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span> bodyLine !== <span class="hljs-string"><span class="hljs-string">"undefined"</span></span> ? <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/[ \t]*/</span></span></span></span><span class="hljs-function"><span class="hljs-params">.exec(bodyLine</span></span></span><span class="hljs-function">) || [])[0] : ""; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">indent</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">indent</span></span></span><span class="hljs-function"> || ""; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">lines</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">map</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">line =&gt; line.replace(indent, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">)).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">join</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"\n"</span></span></span></span></span><span class="hljs-function">); }; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fnStr</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fn</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rawBody</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fnStr</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">substring</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> fnStr.indexOf(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"{"</span></span></span></span></span><span class="hljs-function">) + 1, </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">fnStr</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">lastIndexOf</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"}"</span></span></span></span></span><span class="hljs-function">) ); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">indentedBody</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">restoreIndent</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">rawBody</span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">trimmedBody</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">indentedBody</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">replace</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/^\s+|\s+$/g</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">return</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">trimmedBody</span></span></span><span class="hljs-function">; }; //       </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">getFullName</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">const</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">getFullName</span></span></span><span class="hljs-function"> = (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, surname, middlename</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(surname + <span class="hljs-string"><span class="hljs-string">' '</span></span> + name + <span class="hljs-string"><span class="hljs-string">' '</span></span> + middlename); }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(getFunctionBody(getFullName));</code> </pre> <br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><p>  Il est important de noter que lorsque vous utilisez le minifieur, le code lui-m√™me √† l'int√©rieur de la fonction analys√©e et ses arguments peuvent √™tre optimis√©s et, par cons√©quent, modifi√©s. </p><br><h2 id="3-rabota-s-obektami">  3. Travailler avec des objets </h2><br><p>  JavaScript a un objet Object global qui contient de nombreuses m√©thodes pour travailler dynamiquement avec des objets. </p><br><p>  La plupart de ces m√©thodes existent depuis longtemps dans la langue et sont largement utilis√©es. </p><br><h3 id="svoystva-obekta">  Propri√©t√©s des objets </h3><br><ul><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.assign</a> - pour copier facilement les propri√©t√©s d'un ou plusieurs objets vers l'objet sp√©cifi√© par le premier param√®tre: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign({}, { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">c</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> }) <span class="hljs-comment"><span class="hljs-comment">// {a: 1, b: 2, c: 3}</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.keys</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.values</a> - renvoie soit une liste de cl√©s, soit une liste de valeurs d'objets: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">c</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.keys(obj)); <span class="hljs-comment"><span class="hljs-comment">// ["a", "b", "c"] console.log(Object.values(obj)); // [1, 2, 3]</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.entries</a> - retourne une liste de ses propri√©t√©s au format <em>[[key1, value1], [key2, value2]]</em> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">c</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj)); <span class="hljs-comment"><span class="hljs-comment">// [["a", 1], ["b", 2], ["c", 3]]</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.prototype.hasOwnProperty</a> - V√©rifie si une propri√©t√© est contenue dans un objet (pas dans sa cha√Æne de prototype): </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; obj.__proto__ = { <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(obj.hasOwnProperty(<span class="hljs-string"><span class="hljs-string">'a'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// true console.log(obj.hasOwnProperty('b')) // false</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.getOwnPropertyNames</a> - renvoie une liste de ses propres propri√©t√©s, y compris √† la fois √©num√©r√©es et non √©num√©r√©es: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(obj, <span class="hljs-string"><span class="hljs-string">'c'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">enumerable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }); <span class="hljs-comment"><span class="hljs-comment">//    for (let key in obj) { console.log(key); } // "a", "b" console.log(Object.getOwnPropertyNames(obj)); // [ "a", "b", "c" ]</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.getOwnPropertySymbols</a> - renvoie une liste de ses propres caract√®res (contenus dans l'objet, et non dans sa cha√Æne prototype): </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = {}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">'a'</span></span>); obj[a] = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertySymbols(obj)); <span class="hljs-comment"><span class="hljs-comment">// [ Symbol(a) ]</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.prototype.propertyIsEnumerable</a> - v√©rifie si une propri√©t√© est √©num√©rable (par exemple, est disponible dans les boucles for-in, for-of): </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> arr = [ <span class="hljs-string"><span class="hljs-string">' '</span></span> ]; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr.propertyIsEnumerable(<span class="hljs-number"><span class="hljs-number">0</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// true ‚Äî  ' '   console.log(arr.propertyIsEnumerable('length')); // false ‚Äî  length   </span></span></code> </pre> <br></li></ul><br><h3 id="deskriptory-svoystv-obekta">  Descripteurs de propri√©t√©s d'objet </h3><br><p>  Les descripteurs vous permettent d'affiner les param√®tres de propri√©t√©.  En les utilisant, nous pouvons facilement cr√©er nos propres intercepteurs lors de la lecture / √©criture de toute propri√©t√© (getters et setters - get / set), rendre les propri√©t√©s immuables ou non √©num√©rables, et un certain nombre d'autres choses. </p><br><ul><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.defineProperty</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.defineProperties</a> - cr√©e un ou plusieurs descripteurs de propri√©t√©.  Cr√©ez votre propre descripteur avec getter et setter: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">surname</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperty(obj, <span class="hljs-string"><span class="hljs-string">'fullname'</span></span>, { <span class="hljs-comment"><span class="hljs-comment">//     fullname get: function() { return `${this.name} ${this.surname}`; }, //     fullname (     delete obj.fullname) set: function(value) { const [name, surname] = value.split(' '); this.name = name; this.surname = surname; }, }); console.log(obj.fullname); //   obj.fullname = ' '; console.log(obj.name); //  console.log(obj.surname); // </span></span></code> </pre> <br><p>  Dans l'exemple ci-dessus, la propri√©t√© fullname n'avait pas sa propre valeur, mais fonctionnait dynamiquement avec les propri√©t√©s name et patronyme.  Il n'est pas n√©cessaire de d√©finir √† la fois un getter et un setter - nous ne pouvons laisser que le getter et obtenir une propri√©t√© en lecture seule.  Ou nous pouvons ajouter une action suppl√©mentaire dans le setter avec la d√©finition de la valeur, par exemple, la journalisation. <br>  En plus des propri√©t√©s get / set, les descripteurs ont plusieurs autres propri√©t√©s √† configurer: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = {}; <span class="hljs-comment"><span class="hljs-comment">//      get/set,       value.    get/set  value.   ‚Äî undefined. Object.defineProperty(obj, 'name', { value: '' }); // ,         (for-in, for-of, Object.keys).   ‚Äî false. Object.defineProperty(obj, 'a', { enumerable: true }); //         defineProperty     delete.   ‚Äî false. Object.defineProperty(obj, 'b', { configurable: false }); //      .   ‚Äî false. Object.defineProperty(obj, 'c', { writable: true });</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.getOwnPropertyDescriptor</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.getOwnPropertyDescriptors</a> - vous permettent d'obtenir le descripteur d'objet souhait√© ou leur liste compl√®te: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(obj, <span class="hljs-string"><span class="hljs-string">"a"</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { configurable: true, enumerable: true, value: 1, writable: true } /** * { * a: { configurable: true, enumerable: true, value: 1, writable: true }, * b: { configurable: true, enumerable: true, value: 2, writable: true } * } */ console.log(Object.getOwnPropertyDescriptors(obj));</span></span></code> </pre> <br></li></ul><br><h3 id="sozdanie-ogranicheniy-pri-rabote-s-obektami">  Cr√©ation de restrictions lors de l'utilisation d'objets </h3><br><ul><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.freeze</a> - "fige" les propri√©t√©s d'un objet.  La cons√©quence d'un tel ¬´gel¬ª est l'immuabilit√© compl√®te des propri√©t√©s de l'objet - elles ne peuvent pas √™tre modifi√©es et supprim√©es, de nouvelles ajout√©es, les descripteurs modifi√©s: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.freeze({ <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }); <span class="hljs-comment"><span class="hljs-comment">//       ,       . obj.a = 2; obj.b = 3; console.log(obj); // { a: 1 } console.log(Object.isFrozen(obj)) // true</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.seal</a> - "scelle" les propri√©t√©s d'un objet.  L'√©tanch√©it√© est similaire √† Object.freeze, mais pr√©sente un certain nombre de diff√©rences.  Nous, comme dans Object.freeze, interdisons l'ajout de nouvelles propri√©t√©s, la suppression de celles existantes, la modification de leurs descripteurs, mais en m√™me temps, nous pouvons modifier les valeurs des propri√©t√©s: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.seal({ <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }); obj.a = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  a   2 //     ,       . obj.b = 3; console.log(obj); // { a: 2 } console.log(Object.isSealed(obj)) // true</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.preventExtensions</a> - interdit l'ajout de nouvelles propri√©t√©s / descripteurs: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.preventExtensions({ <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }); obj.a = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       ,       . obj.b = 3; console.log(obj); // { a: 2 } console.log(Object.isExtensible(obj)) // false</span></span></code> </pre> <br></li></ul><br><h3 id="prototipy-obektov">  Prototypes d'objets </h3><br><ul><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.create</a> - pour cr√©er un objet avec le prototype sp√©cifi√© dans le param√®tre.  Cette fonctionnalit√© peut √™tre utilis√©e √† la fois pour l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">h√©ritage de prototypes</a> et pour cr√©er des objets "propres", sans propri√©t√©s d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.prototype</a> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> pureObj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(<span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.getPrototypeOf</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.setPrototypeOf</a> - pour obtenir / modifier le prototype d'un objet: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> duck = {}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bird = {}; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.setPrototypeOf(duck, bird); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(duck) === bird); <span class="hljs-comment"><span class="hljs-comment">// true console.log(duck.__proto__ === bird); // true</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.prototype.isPrototypeOf</a> - V√©rifie si l'objet actuel est contenu dans la cha√Æne de prototype d'un autre: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> duck = {}; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> bird = {}; duck.__proto__ = bird; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(bird.isPrototypeOf(duck)); <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre> <br></li></ul><br><h2 id="4-reflect-api">  4. Reflect API </h2><br><p>  Avec l'av√®nement d'ES6, un objet global <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reflect</a> a √©t√© ajout√© √† JavaScript pour stocker diverses m√©thodes li√©es √† la r√©flexion et √† l'introspection. </p><br><p>  La plupart de ses m√©thodes sont le r√©sultat du transfert de m√©thodes existantes d'objets globaux tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Function</a> vers un espace de noms s√©par√© avec un peu de refactoring pour une utilisation plus confortable. </p><br><p>  Le transfert de fonctions vers l'objet Reflect a non seulement facilit√© la recherche des m√©thodes de r√©flexion n√©cessaires et a donn√© une plus grande s√©mantique, mais a √©galement √©vit√© les situations d√©sagr√©ables lorsque notre objet ne contient pas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.prototype</a> dans son prototype, mais nous voulons utiliser les m√©thodes √† partir de l√†: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); obj.qwerty = <span class="hljs-string"><span class="hljs-string">'qwerty'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(obj.__proto__) <span class="hljs-comment"><span class="hljs-comment">// null console.log(obj.hasOwnProperty('qwerty')) // Uncaught TypeError: obj.hasOwnProperty is not a function console.log(obj.hasOwnProperty === undefined); // true console.log(Object.prototype.hasOwnProperty.call(obj, 'qwerty')); // true</span></span></code> </pre> <br><p>  La refactorisation a rendu le comportement des m√©thodes plus explicite et monotone.  Par exemple, si auparavant, lors de l'appel d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.defineProperty</a> sur une valeur incorrecte (comme un nombre ou une cha√Æne), une exception √©tait lev√©e, mais en m√™me temps, l'appel d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.getOwnPropertyDescriptor</a> sur un descripteur d'objet inexistant retournait silencieusement ind√©fini, alors les m√©thodes similaires de Reflect l√®vent toujours des exceptions pour les donn√©es incorrectes . </p><br><p>  Plusieurs nouvelles m√©thodes ont √©galement √©t√© ajout√©es: </p><br><ul><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reflect.construct</a> est une alternative plus pratique √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Object.create</a> , qui permet non seulement de cr√©er un objet avec le prototype sp√©cifi√©, mais aussi de l'initialiser imm√©diatement: </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Person</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, surname</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.formatParam(name); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.surname = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.formatParam(surname); } Person.prototype.formatParam = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">param</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> param.slice(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).toUpperCase() + param.slice(<span class="hljs-number"><span class="hljs-number">1</span></span>).toLowerCase(); } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> oldPerson = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(Person.prototype); <span class="hljs-comment"><span class="hljs-comment">// {} Person.call(oldPerson, '', ''); // {name: "", surname: ""} const newPerson = Reflect.construct(Person, ['', '']); // {name: "", surname: ""}</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reflect.ownKeys</a> - renvoie un tableau de propri√©t√©s appartenant √† l'objet sp√©cifi√© (et non aux objets de la cha√Æne de prototype): </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> person = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">surname</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; person.__proto__ = { <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">30</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Reflect</span></span>.ownKeys(person)); <span class="hljs-comment"><span class="hljs-comment">// ["name", "surname"]</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reflect.deleteProperty</a> - une alternative √† l'op√©rateur de <em>suppression</em> , faite sous la forme d'une m√©thode: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> person = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">surname</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> person.name; <span class="hljs-comment"><span class="hljs-comment">// person = {surname: ""} Reflect.deleteProperty(person, 'surname'); // person = {}</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reflect.has</a> - une alternative √† l'op√©rateur <em>in</em> , faite sous la forme d'une m√©thode: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> person = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">surname</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'name'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> person); <span class="hljs-comment"><span class="hljs-comment">// true console.log(Reflect.has(person, 'name')); // true</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reflect.get</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reflect.set</a> - pour lire / modifier les propri√©t√©s des objets: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> person = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">surname</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Reflect</span></span>.get(person, <span class="hljs-string"><span class="hljs-string">'name'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">//  Reflect.set(person, 'surname', '') // person = {name: "", surname: ""}</span></span></code> </pre> <br></li></ul><br><p>  Plus de d√©tails sur les changements peuvent √™tre trouv√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . </p><br><h3 id="reflect-metadata">  Refl√©ter les m√©tadonn√©es </h3><br><p>  En plus des m√©thodes d'objet Reflect r√©pertori√©es ci-dessus, il existe une proposition exp√©rimentale pour lier facilement diverses m√©tadonn√©es √† des objets. </p><br><p>  Les m√©tadonn√©es peuvent √™tre toute information utile qui n'est pas directement li√©e √† l'objet, par exemple: </p><br><ul><li>  TypeScript, lorsque l'indicateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">emitDecoratorMetadata</a> est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">activ√©,</a> √©crit des informations sur les types dans les m√©tadonn√©es, vous permettant d'y acc√©der au moment de l'ex√©cution.  De plus, ces informations peuvent √™tre obtenues par la conception cl√©: type: <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> typeData = Reflect.getMetadata(<span class="hljs-string"><span class="hljs-string">"design:type"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>, propertyName);</code> </pre> </li><li>  La biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">InversifyJS</a> populaire pour le contr√¥le d'inversion stocke diverses informations sur les relations d√©crites dans les m√©tadonn√©es. </li></ul><br><p>  √Ä l'heure actuelle, ce <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">polyfill est</a> utilis√© pour fonctionner dans les navigateurs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">.</a> </p><br><h2 id="5-simvoly-symbols">  5. Symboles </h2><br><p>  Les symboles sont un nouveau type de donn√©es immuable, principalement utilis√© pour cr√©er des noms uniques pour les identificateurs de propri√©t√© d'objet.  Nous avons la possibilit√© de cr√©er des personnages de deux mani√®res: </p><br><ol><li><p>  Symboles locaux - le texte des param√®tres de la fonction Symbole n'affecte pas l'unicit√© et n'est n√©cessaire que pour le d√©bogage: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sym1 = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sym2 = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(sym1 == sym2); <span class="hljs-comment"><span class="hljs-comment">// false</span></span></code> </pre> <br></li><li><p>  Caract√®res globaux - les caract√®res sont stock√©s dans le registre global, donc les caract√®res avec la m√™me cl√© sont √©gaux: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sym3 = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.for(<span class="hljs-string"><span class="hljs-string">'name'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sym4 = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.for(<span class="hljs-string"><span class="hljs-string">'name'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> sym5 = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.for(<span class="hljs-string"><span class="hljs-string">'other name'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(sym3 == sym4); <span class="hljs-comment"><span class="hljs-comment">// true,        'name' console.log(sym3 == sym5); // false,    </span></span></code> </pre> <br></li></ol><br><p>  La possibilit√© de cr√©er de tels identifiants nous permet de ne pas avoir peur de remplacer une propri√©t√© dans un objet qui nous est inconnu.  Cette qualit√© permet aux cr√©ateurs de la norme d'ajouter facilement de nouvelles propri√©t√©s standard aux objets, sans rompre la compatibilit√© avec diverses biblioth√®ques existantes (qui pourraient d√©j√† d√©finir la m√™me propri√©t√©) et le code utilisateur.  Par cons√©quent, il existe un certain nombre de symboles standard et certains d'entre eux offrent de nouvelles opportunit√©s de r√©flexion: </p><br><ul><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.iterator</a> - vous permet de cr√©er vos propres r√®gles pour it√©rer des objets en utilisant l' <em>op√©rateur</em> <em>for-of</em> ou <em>... spread</em> : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> arr = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//       arr[Symbol.iterator] = function() { const self = this; let pos = this.length - 1; return { next() { if (pos &gt;= 0) { return { done: false, value: self[pos--] }; } else { return { done: true }; } } } }; console.log([...arr]); // [3, 2, 1]</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.hasInstance</a> est une m√©thode qui d√©termine si un constructeur reconna√Æt un objet comme son instance.  Utilis√© par l'op√©rateur instanceof: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyArray</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> [<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.hasInstance](instance) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.isArray(instance); } } <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log([] <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> MyArray); <span class="hljs-comment"><span class="hljs-comment">// true</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.isConcatSpreadable</a> - Indique si le tableau doit s'aplatir lorsqu'il est concat√©n√© dans Array.concat: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> firstArr = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secondArr = [<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>]; firstArr.concat(secondArr); <span class="hljs-comment"><span class="hljs-comment">// [1, 2, 3, 4, 5, 6] secondArr[Symbol.isConcatSpreadable] = false; console.log(firstArr.concat(secondArr)); // [1, 2, 3, [4, 5, 6]]</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.species</a> - vous permet de sp√©cifier quel constructeur sera utilis√© pour cr√©er des objets d√©riv√©s √† l'int√©rieur de la classe. <br>  Par exemple, nous avons une classe Array standard pour travailler avec des tableaux et elle a une m√©thode .map qui cr√©e un nouveau tableau bas√© sur celui actuel.  Pour savoir quelle classe utiliser pour cr√©er ce nouveau tableau, Array appelle <em>this.constructor [Symbol.species]</em> comme ceci: </p><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.prototype.map = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">cb</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ArrayClass = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.constructor[<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.species]; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayClass(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.length); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.forEach(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value, index, arr</span></span></span><span class="hljs-function">) =&gt;</span></span> { result[index] = cb(value, index, arr); }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><p>  Ainsi, en rempla√ßant Symbol.species, nous pouvons cr√©er notre propre classe pour travailler avec des tableaux et dire que toutes les m√©thodes standard comme .map, .reduce, etc. ne renvoient pas une instance de la classe Array, mais une instance de notre classe: </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyArray</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Array</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> get [<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.species]() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> arr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyArray(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// [1, 2, 3] console.log(arr instanceof MyArray); // true console.log(arr instanceof Array); // true //   Array.map     Array,    Symbol.species  this      MyArray const doubledArr = arr.map(x =&gt; x * 2); console.log(doubledArr instanceof MyArray); // true console.log(doubledArr instanceof Array); // true</span></span></code> </pre> <br><p>  Bien s√ªr, cela fonctionne non seulement avec les tableaux, mais aussi avec d'autres classes standard.  De plus, m√™me si nous cr√©ons simplement notre propre classe avec des m√©thodes qui retournent de nouvelles instances de la m√™me classe, nous devons utiliser this.constructor [Symbol.species] pour obtenir une r√©f√©rence au constructeur. </p><br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.toPrimitive</a> - vous permet de sp√©cifier comment convertir notre objet en une valeur primitive.  Si auparavant, pour r√©duire √† une primitive, nous devions utiliser toString avec valueOf, maintenant tout peut √™tre fait dans une m√©thode pratique: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> figure = { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, [<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.toPrimitive](hint) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hint === <span class="hljs-string"><span class="hljs-string">'string'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (hint === <span class="hljs-string"><span class="hljs-string">'number'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.id; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">// default return this.name; } } } console.log(`${figure}`); // hint = string console.log(+figure); // hint = number console.log(figure + ''); // hint = default</span></span></code> </pre> <br></li><li><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.match</a> - vous permet de cr√©er vos propres classes de gestionnaire pour la m√©thode de la fonction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">String.prototype.match</a> : </p><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StartAndEndsWithMatcher</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(value) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } [<span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>.match](str) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> startsWith = str.startsWith(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> endsWith = str.endsWith(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (startsWith &amp;&amp; endsWith) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> testMatchResult = <span class="hljs-string"><span class="hljs-string">'||'</span></span>.match(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StartAndEndsWithMatcher(<span class="hljs-string"><span class="hljs-string">'|'</span></span>)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(testMatchResult); <span class="hljs-comment"><span class="hljs-comment">// ["|"] const catMatchResult = '|'.match(new StartAndEndsWithMatcher('|')); console.log(catMatchResult) // null</span></span></code> </pre> <br><p>     ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.replace</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.search</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Symbol.split</a>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">String.prototype</a> . </p><br></li></ul><br><p>  ,   (  reflect-metadata   )         .  -   ,    ,       .        : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> validationRules = <span class="hljs-built_in"><span class="hljs-built_in">Symbol</span></span>(<span class="hljs-string"><span class="hljs-string">'validationRules'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> person = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-attr"><span class="hljs-attr">surname</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> }; person[validationRules] = { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: [<span class="hljs-string"><span class="hljs-string">'max-length-256'</span></span>, <span class="hljs-string"><span class="hljs-string">'required'</span></span>], <span class="hljs-attr"><span class="hljs-attr">surname</span></span>: [<span class="hljs-string"><span class="hljs-string">'max-length-256'</span></span>] };</code> </pre> <br><h2 id="6-proksi-proxy"> 6.  (Proxy) </h2><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Proxy</a>    ,    Reflect API  Symbols  ES6,       //  ,  ,       .  ,  <em>   </em> . </p><br><p>           ,    data-binding  MobX  React, Vue  .       . </p><br><p>  : </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> formData = { <span class="hljs-attr"><span class="hljs-attr">login</span></span>: <span class="hljs-string"><span class="hljs-string">'User'</span></span>, <span class="hljs-attr"><span class="hljs-attr">password</span></span>: <span class="hljs-string"><span class="hljs-string">'pass'</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> proxyFormData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Proxy</span></span>(formData, { set(target, name, value) { target[name] = value; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.forceUpdate(); <span class="hljs-comment"><span class="hljs-comment">//   React- } }); //       forceUpdate()    React proxyFormData.login = 'User2'; //     ,   -      proxyFormData.age = 20;</span></span></code> </pre> <br><p>        ,  /: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> formData = { <span class="hljs-attr"><span class="hljs-attr">login</span></span>: <span class="hljs-string"><span class="hljs-string">'User'</span></span>, <span class="hljs-attr"><span class="hljs-attr">password</span></span>: <span class="hljs-string"><span class="hljs-string">'pass'</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> proxyFormData = {}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> param <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> formData) { <span class="hljs-built_in"><span class="hljs-built_in">Reflect</span></span>.defineProperty(proxyFormData, <span class="hljs-string"><span class="hljs-string">`__private__</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${param}</span></span></span><span class="hljs-string">`</span></span>, { <span class="hljs-attr"><span class="hljs-attr">value</span></span>: formData[param], <span class="hljs-attr"><span class="hljs-attr">enumerable</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">configurable</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }); <span class="hljs-built_in"><span class="hljs-built_in">Reflect</span></span>.defineProperty(proxyFormData, param, { <span class="hljs-attr"><span class="hljs-attr">get</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[<span class="hljs-string"><span class="hljs-string">`__private__</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${param}</span></span></span><span class="hljs-string">`</span></span>]; }, <span class="hljs-attr"><span class="hljs-attr">set</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[<span class="hljs-string"><span class="hljs-string">`__private__</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${param}</span></span></span><span class="hljs-string">`</span></span>] = value; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.forceUpdate(); <span class="hljs-comment"><span class="hljs-comment">//   React- }, enumerable: true, configurable: true }); } //       forceUpdate()    React proxyFormData.login = 'User2'; //                  -  Reflect.defineProperty proxyFormData.age = 20;</span></span></code> </pre> <br><p>          -,     ‚Äî   Proxy            (  ,       ),    /             ,           <em>delete obj[name]</em> . </p><br><h2 id="7-zaklyuchenie"> 7.  </h2><br><p> JavaScript        ,           ECMAScript 4,             .               ,   . </p><br><p>             <a href="">  </a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">You Don't Know JS</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr417097/">https://habr.com/ru/post/fr417097/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr417085/index.html">Les navigateurs coupent le son dans votre application WebRTC. Arr√™te quoi?</a></li>
<li><a href="../fr417087/index.html">HPE Digitize 2018: √©v√©nement et diffusion en direct</a></li>
<li><a href="../fr417089/index.html">Ordinateur quantique: un photon pour tout gouverner</a></li>
<li><a href="../fr417091/index.html">Cr√©ez un shader d'eau de dessin anim√© pour le Web. 3e partie</a></li>
<li><a href="../fr417093/index.html">Interrupteurs tactiles avec Modbus: pourquoi sont-ils n√©cessaires et comment les appliquer dans un appartement intelligent</a></li>
<li><a href="../fr417099/index.html">Comment ai-je √©crit la biblioth√®que C ++ 11 standard ou pourquoi boost est si effrayant. Chapitre 2</a></li>
<li><a href="../fr417101/index.html">D√©finition de pr√™t - ce que nous avons oubli√© de dire</a></li>
<li><a href="../fr417103/index.html">Spark SQL. Un peu sur l'optimiseur de requ√™tes</a></li>
<li><a href="../fr417105/index.html">Impression sur une imprimante 3D. Exp√©riences secr√®tes de 3Dtool</a></li>
<li><a href="../fr417107/index.html">Cr√©ateur du jeu en mode True: d√©couvrez () la programmation gamedev, les probl√®mes VR et les simulations ML</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>