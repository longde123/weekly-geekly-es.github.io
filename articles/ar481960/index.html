<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โซ๏ธ ๐ ๐งข 2. ูููุฉ ูุฑูุฉ: ุชุญููู ุณุฌูุงุช ุงูุฃูู. Logstash ๐ ๐๐ฟ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูู ุงูููุงูุฉ ุงูุฃุฎูุฑุฉ ุ ุงูุชูููุง ุจูููุฉ ELK ุนู ููุชุฌุงุช ุงูุจุฑูุฌูุงุช ุงูุชู ุชุชููู ูููุง. ูุชุชูุซู ุงููููุฉ ุงูุฃููู ุงูุชู ููุงุฌููุง ุงููููุฏุณ ุนูุฏ ุงูุนูู ูุน ููุฏุณ ELK ูู ุฅุฑุณุงู ุณ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>2. ูููุฉ ูุฑูุฉ: ุชุญููู ุณุฌูุงุช ุงูุฃูู. Logstash</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tssolution/blog/481960/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/st/sv/rn/stsvrnlxabc4ixpjalmugzema-g.png"><br><br>  ูู <a href="https://habr.com/ru/company/tssolution/blog/480570/">ุงูููุงูุฉ</a> ุงูุฃุฎูุฑุฉ <a href="https://habr.com/ru/company/tssolution/blog/480570/">ุ</a> ุงูุชูููุง <b>ุจูููุฉ ELK</b> ุนู ููุชุฌุงุช ุงูุจุฑูุฌูุงุช ุงูุชู ุชุชููู ูููุง.  ูุชุชูุซู ุงููููุฉ ุงูุฃููู ุงูุชู ููุงุฌููุง ุงููููุฏุณ ุนูุฏ ุงูุนูู ูุน ููุฏุณ ELK ูู ุฅุฑุณุงู ุณุฌูุงุช ููุชุฎุฒูู ูู elasticsearch ููุฒูุฏ ูู ุงูุชุญููู.  ููุน ุฐูู ุ ูุฐุง ููุท ุจุงููููุงุช ุ ูููู elasticsearch ุจุชุฎุฒูู ุงูุณุฌูุงุช ูู ุดูู ูุณุชูุฏุงุช ุชุญุชูู ุนูู ุญููู ูููู ูุนููุฉ ุ ููุง ูุนูู ุฃู ุงููููุฏุณ ูุฌุจ ุฃู ูุณุชุฎุฏู ุฃุฏูุงุช ูุชููุนุฉ ูุชุญููู ุงูุฑุณุงูุฉ ุงูุชู ูุชู ุฅุฑุณุงููุง ูู ุงูุฃูุธูุฉ ุงูููุงุฆูุฉ.  ูููู ุงูููุงู ุจุฐูู ุจุนุฏุฉ ุทุฑู - ุนู ุทุฑูู ูุชุงุจุฉ ุงูุจุฑูุงูุฌ ุจููุณู ุ ูุงูุฐู ุณูุถูู ูุณุชูุฏุงุช ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุฃู ุงุณุชุฎุฏุงู ุญููู ุฌุงูุฒุฉ.  ูู ูุฐู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ ุ ุณููุธุฑ ุฅูู ุญู <b>Logstash</b> ุ ููู ุฌุฒุก ูู ููุฏุณ ELK.  ุณูุฑู ููู ููููู ุฅุฑุณุงู ุงูุณุฌูุงุช ูู ุงูุฃูุธูุฉ ุงูุทุฑููุฉ ุฅูู Logstash ุ ุซู ุณูููู ุจุชูููู ููู ุงูุชูููู ููุชุญููู ูุฅุนุงุฏุฉ ุงูุชูุฌูู ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช Elasticsearch.  ููููุงู ุจุฐูู ุ ุฎุฐ ุงูุณุฌูุงุช ูู ุฌุฏุงุฑ ุงูุญูุงูุฉ Check Point ููุธุงู ูุงุฑุฏ. <br><a name="habracut"></a><br>  ูุฌุฒุก ูู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ ุ ูุง ูุชู ุงุนุชุจุงุฑ ุชุซุจูุช ููุฏุณ ELK ุ ูุธุฑูุง ููุฌูุฏ ุนุฏุฏ ูุจูุฑ ูู ุงูููุงูุงุช ุญูู ูุฐุง ุงูููุถูุน ุ ุณููุธุฑ ูู ูููู ุงูุชูููู. <br><br>  ูููุถุน ุฎุทุฉ ุนูู ูุชูููู Logstash: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญูู ูู ุฃู elasticsearch ุณููุจู ุงูุณุฌูุงุช (ุงูุชุญูู ูู ุตุญุฉ ุงููููุงุก ูุงูุงููุชุงุญ). </li><li style=";text-align:right;direction:rtl"> ูุญู ูููุฑ ูู ููููุฉ ุฅุฑุณุงู ุงูุฃุญุฏุงุซ ุฅูู Logstash ูุงุฎุชูุงุฑ ุงูุทุฑููุฉ ูุชูููุฐูุง. </li><li style=";text-align:right;direction:rtl">  ุชูููู ุงูุฅุฏุฎุงู ูู ููู ุงูุชูููู Logstash. </li><li style=";text-align:right;direction:rtl">  ูููู ุจุชูููู ุงูุฅุฎุฑุงุฌ ูู ููู ุงูุชูููู Logstash ูู ูุถุน ุงูุชุตุญูุญ ูููู ููู ุชุจุฏู ุฑุณุงูุฉ ุงูุณุฌู. </li><li style=";text-align:right;direction:rtl">  ุชูููู ูุฑุดุญ. </li><li style=";text-align:right;direction:rtl">  ุชูููู ุงูุฅุฎุฑุงุฌ ุงูุตุญูุญ ูู ElasticSearch. </li><li style=";text-align:right;direction:rtl">  ุชุทูู Logstash. </li><li style=";text-align:right;direction:rtl">  ุชุญูู ูู ุณุฌูุงุช ูู Kibana. </li></ol><br>  ูููุธุฑ ูู ูู ุนูุตุฑ ุจูุฒูุฏ ูู ุงูุชูุตูู: <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุชุญูู ูู ุฃู elasticsearch ุณููุจู ุงูุณุฌูุงุช </h3><br>  ููููุงู ุจุฐูู ุ ููููู ุงุณุชุฎุฏุงู ุงูุฃูุฑ curl ููุชุญูู ูู ุงููุตูู ุฅูู Elasticsearch ูู ุงููุธุงู ุงูุฐู ุชู ูุดุฑ Logstash ุนููู.  ุฅุฐุง ููุช ุจุชูููู ุงููุตุงุฏูุฉ ุ ุซู ูุฑุฑ ุงููุณุชุฎุฏู / ูููุฉ ุงููุฑูุฑ ูู ุฎูุงู curl ุ ูุญุฏุฏ ุงููููุฐ 9200 ุฅุฐุง ูู ุชูู ุจุชุบููุฑู.  ุฅุฐุง ุธูุฑุช ุฅุฌุงุจุฉ ูุซู ุงูุฅุฌุงุจุฉ ุฃุฏูุงู ุ ูุณูุชู ุชุฑุชูุจ ูู ุดูุก. <br><br><pre style=";text-align:right;direction:rtl"><code class="javascript hljs">[elastic@elasticsearch ~]$ curl -u &lt;&lt;user_name&gt;&gt; : &lt;&lt;password&gt;&gt; -sS -XGET "&lt;&lt;ip_address_elasticsearch&gt;&gt;:9200" { "name" : "elastic-1", "cluster_name" : "project", "cluster_uuid" : "sQzjTTuCR8q4ZO6DrEis0A", "version" : { "number" : "7.4.1", "build_flavor" : "default", "build_type" : "rpm", "build_hash" : "fc0eeb6e2c25915d63d871d344e3d0b45ea0ea1e", "build_date" : "2019-10-22T17:16:35.176724Z", "build_snapshot" : false, "lucene_version" : "8.2.0", "minimum_wire_compatibility_version" : "6.8.0", "minimum_index_compatibility_version" : "6.0.0-beta1" }, "tagline" : "You Know, for Search" } [elastic@elasticsearch ~]$</code> </pre> <br>  ุฅุฐุง ูู ุชุชู ุงูุฅุฌุงุจุฉ ุ ููููู ุฃู ูููู ููุงู ุนุฏุฉ ุฃููุงุน ูู ุงูุฃุฎุทุงุก: ุนูููุฉ elasticsearch ูุง ุชุนูู ุ ุฃู ุงููููุฐ ุงูุฎุงุทุฆ ูุญุฏุฏ ุ ุฃู ุงููููุฐ ูุญุธูุฑ ุจุฌุฏุงุฑ ุญูุงูุฉ ุนูู ุงูุฎุงุฏู ุญูุซ ุชู ุชุซุจูุช elasticsearch. <br><br><h3 style=";text-align:right;direction:rtl">  ููุฑ ูู ููููุฉ ุฅุฑุณุงู ุงูุณุฌูุงุช ุฅูู Logstash ูู ุฌุฏุงุฑ ุงูุญูุงูุฉ ูููุทุฉ ุงูุชูุชูุด </h3><br>  ุจุงุณุชุฎุฏุงู ุฎุงุฏู ุฅุฏุงุฑุฉ Check Point ุ ููููู ุฅุฑุณุงู ุงูุณุฌูุงุช ุฅูู Logstash ุนุจุฑ syslog ุจุงุณุชุฎุฏุงู ุงูุฃุฏุงุฉ ุงููุณุงุนุฏุฉ log_exporter ุ ูููููู ุงูุชุนุฑู ุนูููุง ูู ูุฐู <a href="https://habr.com/ru/company/tssolution/blog/431146/">ุงูููุงูุฉ</a> ุจูุฒูุฏ ูู ุงูุชูุตูู ุ ูููุง ุณูุชุฑู ุงูุฃูุฑ ุงูุฐู ููุดุฆ ุงูุฏูู ููุท: <br><br>  cp_log_export ุฅุถุงูุฉ ุงุณู check_point_syslog ุงูุฎุงุฏู ุงููุณุชูุฏู &lt;&lt;ip_address_logstash&gt;&gt; ุจุฑูุชูููู 5555 ูุชูุณูู ุจุฑูุชูููู TCP ุงููุณุชูุฏู ููููุงูุฐ ุงูุนุงูุฉ ูุถุน ุดุจู ููุญุฏ <br><br>  &lt;&lt;ip_address_logstash&gt;&gt; - ุนููุงู ุงูุฎุงุฏู ุญูุซ ูุชู ุชุดุบูู Logstash ุ ุงููุฏู 5555 - ุงููููุฐ ุงูุฐู ุณูุฑุณู ุฅููู ุงูุณุฌูุงุช ุ ูุฅุฑุณุงู ุงูุณุฌูุงุช ุนุจุฑ tcp ููููู ุชุญููู ุงูุฎุงุฏู ุ ูุฐูู ูู ุจุนุถ ุงูุญุงูุงุช ูููู ุถุจุท udp ุฃูุซุฑ ุตุญุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุชูููู INPUT ูู ููู ุงูุชูููู Logstash </h3><br><img src="https://habrastorage.org/webt/kj/ns/qh/kjnsqhfoxgr7fqtku2tpgibgh5y.png"><br><br>  ุจุดูู ุงูุชุฑุงุถู ุ ููุฌุฏ ููู ุงูุชูููู ูู ุงูุฏููู /etc/logstash/conf.d/.  ูุชููู ููู ุงูุชูููู ูู 3 ุฃุฌุฒุงุก ุฐุงุช ูุนูู: INPUT ุ FILTER ุ OUTPUT.  ูู <b>INPUT ุ</b> ูุดูุฑ ุฅูู ุฃูู ุณูุฃุฎุฐ ุงููุธุงู ุงูุณุฌูุงุช ููู ุ ูู <b>FILTER ูููู</b> ุจุชุญููู ุงูุณุฌู - ุชูููู ููููุฉ ุชูุณูู ุงูุฑุณุงูุฉ ุฅูู ุญููู ูููู ุ ูู <b>OUTPUT ูููู</b> ุจุชูููู ุฏูู ุงูุฅุฎุฑุงุฌ - ุญูุซ ุณูุชู ุฅุฑุณุงู ุงูุณุฌูุงุช ุงูุชู ุชู ุชุญููููุง. <br><br>  ุฃููุงู ุ ูู ุจุชูููู INPUT ุ ููุฑ ูู ุจุนุถ ุงูุฃููุงุน ุงูุชู ูุฏ ุชููู - ููู ู tcp ู exe. <br><br>  <b>ุจุฑูุงูุฌ ุงูุชุนุงูู ุงูููู:</b> <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">input { tcp { port =&gt; <span class="hljs-number"><span class="hljs-number">5555</span></span> host =&gt; โ<span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.205</span></span>โ type =&gt; <span class="hljs-string"><span class="hljs-string">"checkpoint"</span></span> mode =&gt; <span class="hljs-string"><span class="hljs-string">"server"</span></span> } }</code> </pre><br>  ุงููุถุน =&gt; "ุงูุฎุงุฏู" <br>  ูููู ุฃู Logstash ููุจู ุงูุงุชุตุงูุงุช. <br><br>  ูููุงุก =&gt; 5555 <br>  ุงููุถูู =&gt; "10.10.1.205" <br>  ูุญู ููุจู ุงูุงุชุตุงูุงุช ุฅูู ุนููุงู IP 10.10.1.205 (Logstash) ุ ุงููููุฐ 5555 - ูุฌุจ ุงูุณูุงุญ ุจุงููููุฐ ุจูุงุณุทุฉ ุณูุงุณุฉ ุฌุฏุงุฑ ุงูุญูุงูุฉ. <br><br>  ุงูุชุจ =&gt; "ููุทุฉ ุชูุชูุด" <br>  ูููู ุจุชูููุฒ ุงููุณุชูุฏ ุ ููู ููุงุณุจ ุฌุฏูุง ุฅุฐุง ูุงู ูุฏูู ุงูุนุฏูุฏ ูู ุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ.  ูู ูุง ููู ุ ููู ุงุชุตุงู ุ ููููู ูุชุงุจุฉ ุงูููุชุฑ ุงูุฎุงุต ุจู ุจุงุณุชุฎุฏุงู ุงูุจูุงุก ุงูููุทูู if. <br><br>  <b>ููู:</b> <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">input { file { path =&gt; <span class="hljs-string"><span class="hljs-string">"/var/log/openvas_report/*"</span></span> type =&gt; <span class="hljs-string"><span class="hljs-string">"openvas"</span></span> start_position =&gt; <span class="hljs-string"><span class="hljs-string">"beginning"</span></span> } }</code> </pre><br>  ูุตู ุงูุฅุนุฏุงุฏุงุช: <br>  path =&gt; "/ var / log / openvas_report / *" <br>  ุญุฏุฏ ุงูุฏููู ุงูุฐู ูุฌุจ ุฃู ุชูุฑุฃ ููู ุงููููุงุช. <br><br>  ุงูุชุจ =&gt; "openvas" <br>  ููุน ุงูุญุฏุซ. <br><br>  start_position =&gt; "ุจุฏุงูุฉ" <br>  ุนูุฏ ุชุบููุฑ ุงูููู ุ ูููู ุจูุฑุงุกุฉ ุงูููู ุจุงููุงูู ุ ุฅุฐุง ููุช ุจุชุนููู "ุงูููุงูุฉ" ุ ูุฅู ุงููุธุงู ููุชุธุฑ ุธููุฑ ุฅุฏุฎุงูุงุช ุฌุฏูุฏุฉ ูู ููุงูุฉ ุงูููู. <br><br>  <b>ุฅูุณูู:</b> <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">input { exec { command =&gt; <span class="hljs-string"><span class="hljs-string">"ls -alh"</span></span> interval =&gt; <span class="hljs-number"><span class="hljs-number">30</span></span> } }</code> </pre><br>  ูู ูุฐุง ุงูุฅุฏุฎุงู ุ (ููุท!) ูุชู ุชุดุบูู ุฃูุฑ shell ููุชู ุงูุชูุงู ุงูุฅุฎุฑุงุฌ ุงูุฎุงุต ุจู ูู ุฑุณุงูุฉ ุณุฌู. <br><br>  command =&gt; "ls -alh" <br>  ุงููุฑูู ุงูุฐู ููููุง ุงูุงูุชุงุฌ. <br><br>  ุงููุงุตู =&gt; 30 <br>  ุงุณุชุฏุนุงุก ุงูุฃูุงูุฑ ุงููุงุตู ูู ุซูุงู. <br><br>  ูู ุฃุฌู ุงูุญุตูู ุนูู ุณุฌูุงุช ูู ุฌุฏุงุฑ ุงูุญูุงูุฉ ุ ูุญู <b>ูุตู</b> ูุฑุดุญ <b>tcp</b> ุฃู <b>udp</b> ุ ุงุนุชูุงุฏูุง ุนูู ููููุฉ ุฅุฑุณุงู ุงูุณุฌูุงุช ุฅูู Logstash. <br><br><h3 style=";text-align:right;direction:rtl">  ูููู ุจุชูููู ุงูุฅุฎุฑุงุฌ ูู ููู ุงูุชูููู Logstash ูู ูุถุน ุงูุชุตุญูุญ ูููู ููู ุชุจุฏู ุฑุณุงูุฉ ุงูุณุฌู </h3><br>  ุจุนุฏ ุฃู ูููุง ุจุชูููู INPUT ุ ูุญุชุงุฌ ุฅูู ููู ุดูู ุฑุณุงูุฉ ุงูุณุฌู ุ ูุงูุฃุณุงููุจ ุงูุชู ูุฌุจ ุงุณุชุฎุฏุงููุง ูุชูููู ูุฑุดุญ (ูุญูู) ุงูุณุฌูุงุช. <br><br>  ููููุงู ุจุฐูู ุ ุณูู ูุณุชุฎุฏู ูุฑุดุญูุง ูุนุฑุถ ุงููุชูุฌุฉ ูู stdout ูุนุฑุถ ุงูุฑุณุงูุฉ ุงูุฃุตููุฉ ุ ุณูุจุฏู ููู ุงูุชูููู ุจุงููุงูู ูู ุงูููุช ุงูุญุงูู ููุง ููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">input { tcp { port =&gt; <span class="hljs-number"><span class="hljs-number">5555</span></span> type =&gt; <span class="hljs-string"><span class="hljs-string">"checkpoint"</span></span> mode =&gt; <span class="hljs-string"><span class="hljs-string">"server"</span></span> host =&gt; โ<span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.205</span></span>โ } } output { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [type] == <span class="hljs-string"><span class="hljs-string">"checkpoint"</span></span> { stdout { codec=&gt; json } } }</code> </pre><br>  ูููู ุจุชุดุบูู ุงูุฃูุฑ ููุชุญูู: <br>  sudo / usr / share / logstash / bin // logstash -f /etc/logstash/conf.d/checkpoint.conf <br>  ูุฑู ุงููุชูุฌุฉ ุ ุงูุตูุฑุฉ ูุงุจูุฉ ููููุฑ: <br><br> <a href=""><img src="https://habrastorage.org/webt/is/ow/a-/isowa-1j75fxrivpctqdjtvn_x8.png"></a> <br><br>  ุฅุฐุง ููุช ุจูุณุฎู ุ ูุณูุจุฏู ููุฐุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">action=\"Accept\" conn_direction=\"Internal\" contextnum=\"1\" ifdir=\"outbound\" ifname=\"bond1.101\" logid=\"0\" loguid=\"{0x5dfb8c13,0x5,0xfe0a0a0a,0xc0000000}\" origin=\"10.10.10.254\" originsicname=\"CN=ts-spb-cpgw-01,O=cp-spb-mgmt-01.tssolution.local.kncafb\" sequencenum=\"8\" time=\"1576766483\" version=\"5\" context_num=\"1\" dst=\"10.10.10.10\" dst_machine_name=\"ts-spb-dc-01@tssolution.local\" layer_name=\"TSS-Standard Security\" layer_name=\"TSS-Standard Application\" layer_uuid=\"dae7f01c-4c98-4c3a-a643-bfbb8fcf40f0\" layer_uuid=\"dbee3718-cf2f-4de0-8681-529cb75be9a6\" match_id=\"8\" match_id=\"33554431\" parent_rule=\"0\" parent_rule=\"0\" rule_action=\"Accept\" rule_action=\"Accept\" rule_name=\"Implicit Cleanup\" rule_uid=\"6dc2396f-9644-4546-8f32-95d98a3344e6\" product=\"VPN-1 &amp; FireWall-1\" proto=\"17\" s_port=\"37317\" service=\"53\" service_id=\"domain-udp\" src=\"10.10.1.180\" ","type":"qqqqq","host":"10.10.10.250","@version":"1","port":50620}{"@timestamp":"2019-12-19T14:50:12.153Z","message":"time=\"1576766483\" action=\"Accept\" conn_direction=\"Internal\" contextnum=\"1\" ifdir=\"outbound\" ifname=\"bond1.101\" logid=\"0\" loguid=\"{0x5dfb8c13,</code> </pre><br>  ุจุงููุธุฑ ุฅูู ูุฐู ุงูุฑุณุงุฆู ุ ูููู ุฃู ุงูุณุฌูุงุช ููุง ุงููููุฐุฌ: field = value ุฃู key = value ุ ููุง ูุนูู ุฃู ุงููุฑุดุญ ุงูุฐู ูุณูู kv ููุงุณุจ.  ูู ุฃุฌู ุงุฎุชูุงุฑ ุงููุฑุดุญ ุงูููุงุณุจ ููู ุญุงูุฉ ูุญุฏุฏุฉ ุ ุณูููู ูู ุงูุฌูุฏ ุฃู ุชุชุนุฑู ุนูููุง ูู ุงููุซุงุฆู ุงูุชูููุฉ ุ ุฃู ุชุณุฃู ุตุฏูููุง. <br><br><h3 style=";text-align:right;direction:rtl">  ุชุฎุตูุต ูุฑุดุญ </h3><br>  ูู ุงููุฑุญูุฉ ุงูุฃุฎูุฑุฉ ุ ุงุฎุชุงุฑูุง kv ุ ุซู ูุชู ุชูุฏูู ุชูููู ูุฐุง ุงูููุชุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">filter { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [type] == <span class="hljs-string"><span class="hljs-string">"checkpoint"</span></span>{ kv { value_split =&gt; <span class="hljs-string"><span class="hljs-string">"="</span></span> allow_duplicate_values =&gt; <span class="hljs-literal"><span class="hljs-literal">false</span></span> } } }</code> </pre><br>  ูุฎุชุงุฑ ุงูุฑูุฒ ุงูุฐู ููุณู ุจู ุงูุญูู ูุงููููุฉ - "=".  ุฅุฐุง ูุงู ูุฏููุง ููุณ ุงูุฅุฏุฎุงูุงุช ูู ุงูุณุฌู ุ ูุฅููุง ูุญูุธ ูุซูููุง ูุงุญุฏูุง ููุท ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุฅูุง ูุณูู ุชุญุตู ุนูู ูุฌููุนุฉ ูู ููุณ ุงูููู ุ ุฃู ุฅุฐุง ุชููููุง ุงูุฑุณุงูุฉ "foo = some foo = some" ุ ูุงูุชุจ ููุท foo = some. <br><br><h3 style=";text-align:right;direction:rtl">  ุชูููู ุงูุฅุฎุฑุงุฌ ุงูุตุญูุญ ูู ElasticSearch </h3><br>  ุจุนุฏ ุชูููู ุงูููุชุฑ ุ ููููู ุชุญููู ุงูุณุฌูุงุช ุฅูู ูุงุนุฏุฉ ุจูุงูุงุช <b>elasticsearch</b> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">output { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [type] == <span class="hljs-string"><span class="hljs-string">"checkpoint"</span></span> { elasticsearch { hosts =&gt; [<span class="hljs-string"><span class="hljs-string">"10.10.1.200:9200"</span></span>] index =&gt; <span class="hljs-string"><span class="hljs-string">"checkpoint-%{+YYYY.MM.dd}"</span></span> user =&gt; <span class="hljs-string"><span class="hljs-string">"tssolution"</span></span> password =&gt; <span class="hljs-string"><span class="hljs-string">"cool"</span></span> } } }</code> </pre><br>  ุฅุฐุง ุชู ุชูููุน ุงููุณุชูุฏ ุจููุน ููุทุฉ ุงูุชูุชูุด ุ ุงุญูุธ ุงูุญุฏุซ ูู ูุงุนุฏุฉ ุจูุงูุงุช elasticsearch ุ ุงูุชู ุชูุจู ุงูุงุชุตุงูุงุช ูู 10.10.1.200 ุฅูู ุงููููุฐ 9200 ุจุดูู ุงูุชุฑุงุถู.  ูุชู ุญูุธ ูู ูุซููุฉ ูู ููุฑุณ ูุนูู ุ ูู ูุฐู ุงูุญุงูุฉ ูููู ุจุญูุธ ูู "ููุทุฉ ุชูุชูุด" ุงูููุฑุณ + + ุงูุชุงุฑูุฎ ุงูุญุงูู.  ูููู ุฃู ูุญุชูู ูู ููุฑุณ ุนูู ูุฌููุนุฉ ูุญุฏุฏุฉ ูู ุงูุญููู ุ ุฃู ูุชู ุฅูุดุงุคู ุชููุงุฆููุง ุนูุฏูุง ูุธูุฑ ุญูู ุฌุฏูุฏ ูู ุงูุฑุณุงูุฉ ุ ููููู ุนุฑุถ ุฅุนุฏุงุฏุงุช ุงูุญูู ูููุนูุง ูู ุงูุชุนูููุงุช. <br><br>  ุฅุฐุง ููุช ูุฏ ููุช ุจุชูููู ุงููุตุงุฏูุฉ (ุณููุธุฑ ูุงุญููุง) ุ ููุฌุจ ุชุญุฏูุฏ ุฃุฑุตุฏุฉ ุงููุชุงุจุฉ ุฅูู ููุฑุณ ูุนูู ุ ูู ูุฐุง ุงููุซุงู ุชููู "tssolution" ูุน ูููุฉ ุงููุฑูุฑ "cool".  ููููู ุงูุชูููุฒ ุจูู ุญููู ุงููุณุชุฎุฏู ูู ูุชุงุจุฉ ุงูุณุฌูุงุช ุฅูู ููุฑุณ ูุนูู ููุท ูููุณ ุฃูุซุฑ. <br><br><h3 style=";text-align:right;direction:rtl">  ุฅุทูุงู Logstash. </h3><br>  ููู ุชูููู Logstash: <br><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">input { tcp { port =&gt; <span class="hljs-number"><span class="hljs-number">5555</span></span> type =&gt; <span class="hljs-string"><span class="hljs-string">"checkpoint"</span></span> mode =&gt; <span class="hljs-string"><span class="hljs-string">"server"</span></span> host =&gt; โ<span class="hljs-number"><span class="hljs-number">10.10</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.205</span></span>โ } } filter { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [type] == <span class="hljs-string"><span class="hljs-string">"checkpoint"</span></span>{ kv { value_split =&gt; <span class="hljs-string"><span class="hljs-string">"="</span></span> allow_duplicate_values =&gt; <span class="hljs-literal"><span class="hljs-literal">false</span></span> } } } output { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [type] == <span class="hljs-string"><span class="hljs-string">"checkpoint"</span></span> { elasticsearch { hosts =&gt; [<span class="hljs-string"><span class="hljs-string">"10.10.1.200:9200"</span></span>] index =&gt; <span class="hljs-string"><span class="hljs-string">"checkpoint-%{+YYYY.MM.dd}"</span></span> user =&gt; <span class="hljs-string"><span class="hljs-string">"tssolution"</span></span> password =&gt; <span class="hljs-string"><span class="hljs-string">"cool"</span></span> } } }</code> </pre><br>  ุชุญูู ูู ููู ุงูุชูููู ููุชุฌููุน ุงูุตุญูุญ: <br>  / usr / share / logstash / bin // logstash -f checkpoint.conf <br><img src="https://habrastorage.org/webt/lb/1v/w5/lb1vw57djb7xm_lohxwbvzuygwy.png"><br><br>  ูุจุฏุฃ ุนูููุฉ Logstash: <br>  sudo systemctl ุจุฏุก logstash <br><br>  ุชุญูู ูู ุฃู ุงูุนูููุฉ ูุฏ ุจุฏุฃุช: <br>  sudo systemctl ุญุงูุฉ ุงูุณุฌู <br><br><img src="https://habrastorage.org/webt/nh/ug/jw/nhugjwysxvwiras5r34w8ajqlxc.png"><br><br>  ุชุญูู ููุง ุฅุฐุง ูุงู ุงูููุจุณ ูุฏ ุงุฑุชูุน: <br>  netstat-nat | grep 5555 <br><br><img src="https://habrastorage.org/webt/n4/xn/jg/n4xnjgwriabmksyhvdfbskgkeau.png"><br><br><h3 style=";text-align:right;direction:rtl">  ุชุญูู ูู ุณุฌูุงุช ูู Kibana. </h3><br>  ุจุนุฏ ุจุฏุก ูู ุดูุก ุ ุงูุชูู ุฅูู Kibana - ุงูุชุดู ุ ุชุฃูุฏ ูู ุฃู ูู ุดูุก ุชู ุชููููู ุจุดูู ุตุญูุญ ุ ูุฅู ุงูุตูุฑุฉ ูุงุจูุฉ ููููุฑ! <br><br> <a href=""><img src="https://habrastorage.org/webt/dx/4c/mg/dx4cmgg4v5fld2r6ignxbqyqsew.png"></a> <br><br>  ุฌููุน ุงูุณุฌูุงุช ูู ููุงููุง ููููููุง ุฃู ูุฑู ูู ุงูุญููู ูููููุง! <br><br><h3 style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h3><br>  ุฏุฑุณูุง ููููุฉ ูุชุงุจุฉ ููู ุชูููู Logstash ุ ููุชูุฌุฉ ูุฐูู ุญุตููุง ุนูู ูุญูู ูุฌููุน ุงูุญููู ูุงูููู.  ุงูุขู ูููููุง ุงูุนูู ูุน ุงูุจุญุซ ูุงูุชุฎุทูุท ูุญููู ูุนููุฉ.  ุนูุงูุฉ ุนูู ุฐูู ุ ุณููุธุฑ ูู ุงูุชุตูุฑ ูู Kibana ุ ูุฅูุดุงุก ููุญุฉ ูุนูููุงุช ุจุณูุทุฉ.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃูู ูุฌุจ ุฅุถุงูุฉ ููู ุชูููู Logstash ุจุงุณุชูุฑุงุฑ ูู ุจุนุถ ุงูููุงูู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุนูุฏูุง ูุฑูุฏ ุงุณุชุจุฏุงู ูููุฉ ุงูุญูู ูู ุฑูู ุฅูู ูููุฉ.  ูู ุงูููุงูุงุช ุงููุงุญูุฉ ุ ุณููุนู ุฐูู ุทูุงู ุงูููุช. <br><br>  ูุฐุง ุชุฑูุจูุง ( <a href="https://t.me/tssolution">Telegram</a> ุ <a href="https://www.facebook.com/groups/tssolution.info/">Facebook</a> ุ <a href="https://vk.com/ts_solution">VK</a> ุ <a href="https://tssolution.ru/blog">TS Solution Blog</a> )ุ <a href="https://zen.yandex.ru/id/5c7d2162fa818600ae386a52">Yandex.Zen</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar481960/">https://habr.com/ru/post/ar481960/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar481950/index.html">ุงูุจุฑูุงูุฌ ุงูุชุนูููู: ุฑุฏ ุงููุนู ุงูุชูููุฏ ุงูุฑุจูุน</a></li>
<li><a href="../ar481952/index.html">ููุชุงุดู ูููุชูู ุจุฌุฏ ุ ุจุงุด ูุงููุฌุงุฒุฑ ุงูุชูููููุฌูุฉ</a></li>
<li><a href="../ar481954/index.html">ููู ูููุงุฐุง ูููููู ุงุฎุชุฑุงู VR</a></li>
<li><a href="../ar481956/index.html">ุจุญุซุง ุนู ูุจุฑูุฌ ููููุฏ. ุงูุณุนู ุงูุณูุฉ ุงูุฌุฏูุฏุฉ</a></li>
<li><a href="../ar481958/index.html">ุนูุฏูุง ุชููู ุฃุญุฏ ุงููููุนูู ูู mail.ru ุฃู ููููุฉ ุนุจูุฑ ุฏุจุงุจุฉ T-34 ูู ุฎูุงู ูุงุฌูุฉ ุจุฑูุฏ</a></li>
<li><a href="../ar481964/index.html">ููููุฉ ุชูุธูู ุงูุฅุตุฏุงุฑ</a></li>
<li><a href="../ar481970/index.html">"ุชูุณููุงุช ุงูุตูุช ุงูููุณูุฉ ูุงููุณุงุฆุท": ุจุฏุงูุฉ ุนุตุฑ ุงูุตูุช ุงููุถุบูุท ุฃู "ุงูุชุบููุฑ ุงูุฃูู" ูุจูุฑุงุช</a></li>
<li><a href="../ar481974/index.html">ุงุฎุชุจุงุฑ ุงูุจุทูุฎ ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ: ุชุทููุฑ ูุงูู. ุฏูุฑุฉ ูู ุงูููุงุฐุฌ ุฅูู ุงูุชุทุจูู. ูู ุฌูุฌู ุงููุนุจ</a></li>
<li><a href="../ar481978/index.html">ููููุฉ ุชูุธูู ุงูุนูู ุงููุนุงู ููุฑูู ุงูุชุฎุทูุท ุงูููุฒุน</a></li>
<li><a href="../ar481980/index.html">ููู ูููุง ุจุชุญุณูู ุงููุตูุต ูู ุงููุญุฏุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>