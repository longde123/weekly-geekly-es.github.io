<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ผ๐ฝ ๐๐พ ๐๐ป ุฌุนู ูุญุฑุฑ JaCarta ๐ ๐๏ธ ๐ฑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content=""ุฃุณุชุทูุน ุฃู ุฃููู ุดูุฆูุง ูุงุญุฏูุง ููุท ุนู ููููุฉ ุงูุธูุงู: ููุงู ุญูููุฉ ูููุงู ุธูุงููุง ุ ูุฐุง ูู ุฌููุฑ ูู ุดูุก. ูู ุงูุนุงูู ุงูุญูููู ุ ูุง ููุฌุฏ ุณูู Amber ุ ุงููุฏููุฉ ุงูุญููู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุฌุนู ูุญุฑุฑ JaCarta</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441476/" style=";text-align:right;direction:rtl">  <i>"ุฃุณุชุทูุน ุฃู ุฃููู ุดูุฆูุง ูุงุญุฏูุง ููุท ุนู ููููุฉ ุงูุธูุงู: ููุงู ุญูููุฉ ูููุงู ุธูุงููุง ุ</i>  <i>ูุฐุง ูู ุฌููุฑ ูู ุดูุก.</i>  <i>ูู ุงูุนุงูู ุงูุญูููู ุ ูุง ููุฌุฏ ุณูู Amber ุ ุงููุฏููุฉ ุงูุญููููุฉ ุนูู ุงูุฃุฑุถ ุงูุญููููุฉ ุ ูุงูุชู ูุชู ูููุง ุฌูุน ูู ุดูุก.</i>  <i>ูููููุฉ ุงูุธูุงู ููุณุช ุณูู ุงููุงููุงูุฉ ูููุงูุน.</i>  <i>ููุง ููููู ุฃูุถูุง ุงูุนุซูุฑ ุนูู ูู ุดูุก - ูููู ุณูููู ุธูุงููุง ุ ุงูุนูุงุณูุง ูุดูููุง ูููุงูุน.</i>  <i>ูุญูุท ููููุฉ ุงูุธูุงู ุงูุนูุจุฑ ูู ุฌููุน ุงูุฌูุงุช.</i>  <i>ูุฎุงุฑุฌูุง ุ ุชุณูุฏ ุงูููุถู.</i>  <i>ูู ุดูุก ูููู ูู ุงูุทุฑูู ูู ุงูุนูุจุฑ ุฅูู ููููุฉ ุงูููุถู ".</i> <br>  ุฑูุฌุฑ Zhelyazny.  ุชุณุนุฉ ุฃูุฑุงุก ุนูุจุฑ <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/hi/kl/ek/hiklekzlry8wpcjn7hg3nroukac.jpeg"></div><br>  ุจุฏุฃ ูู ุฐูู ุจุงูุญุงุฌุฉ ุฅูู ุงูุนูู ุจุงุณุชุฎุฏุงู ููุณ ุงูููุชุงุญ ุนูู etoken ูู ูุญุทุงุช ุนูู ูุฎุชููุฉ ุนู ุจูุนุฏ (ุณุชููู USB ุนุจุฑ IP ุจุงูุธุฉ ุงูุซูู ูุจุนุถ ุงูุฑููุฒ) ูุฑุบุจุชู ุงููุจูุฑุฉ ูู ูุชุญ ูุฐุง ุงูุนุงูู ุงููุบูู.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุตุงุฏูุช</a> ุงูุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">habr.com/post/276057</a> ุงูุฐู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุญุธู</a> ูุคููู ุจุงุญุชุฑุงู ูุจูุฑ ุ ูู ูุดุฑูุนู ุชู ุงุณุชุฎุฏุงู ุฌุฒุก ูุจูุฑ ูู ุงููุธุงุฆู ุงูุชู ุนูุณูุง (ุงูููุฏ ููุชูุญ).  ุตุญูุญ ุ ููุง ุงุชุถุญ ุ ูู ุดูุก ูุนูู ูุน etsdk.dll ูุนูู ููุท ูุน ุงูุณูู ุงูุฃุฒุฑู.  ูุฐูู ุ ุจุงููุณุจุฉ ูู JaCarta ุ ูุงู ูุง ุจุฏ ูู ุฅุนุงุฏุฉ ูุชุงุจุฉ ูุธุงุฆู ุฌุฏูุฏุฉ ุ ููุงู ูุชุนูู ุชุญุฑูุฑ ุจุนุถูุง. <br><br>  ููุชูุฌุฉ ููุจุญุซ ุงูุทููู ุ ุธูุฑ ูุญุฑุฑ JaCarta - ุจุฑูุงูุฌ ูุนุฑุถ ููุณูุญ ูู ุจุชุญุฑูุฑ ุงูููุงูุงุช (ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ุชุณูู ุจูุง ูุงุฆูุงุช ูุธุงู ุงููููุงุช ุงูุฑูุฒูุฉ ูู ุงููุซุงุฆู ุงูุฑุณููุฉ ุ ูุงูุชู ุชุดูุฑ ูููุง ูุจุฏู ุฅูู ุงูุฒูุงู ูุนุฏู ุงููุงูุนูุฉ) ุนูู ุงูุฑููุฒ ุงููููุฒุฉ ูู ุนูุงุก ุงูุฏูู ุ ุจูุง ูู ุฐูู ุงูุฃุญุฏุซ ูููุง. <br><a name="habracut"></a><br>  ูุชููุฑ ุชุทุจูู ููุงุซู ูู Rutoken ุจุดูู ุนุงู ูุฌุฒุก ูู Rutoken SDK (ูุญุฑุฑ Rutoken) ุ ููู ุจุงููุณุจุฉ ุฅูู ุนูุงุก ุงูุฏูู ุ ููู ููุณ ููุฌูุฏูุง ุนูู ุงูุฃูู ูู ุงููุฌุงู ุงูุนุงู ุ ุนูู ุงูุฑุบู ูู ุฃูู ูุจู ุญูุงูู 15 ุนุงููุง ุ ูุงุณุชูุงุฏุงู ุฅูู ุงููุซุงุฆู ุงูุชู ุชู ุงูุนุซูุฑ ุนูููุง ุนูู ุงูุฅูุชุฑูุช ุ ูุงู (ETEditor). <br><br>  ุงูุจุฑูุงูุฌ ููุชูุจ ูู Autoit ุ ุชู ุงุฎุชุจุงุฑู ุจุงุณุชุฎุฏุงู EToken PRO Java 72 K ุ ู JaCarta LT ุ ู JaCarta Pro ุ ู JaCarta GOST-2. <br><br>  ูู ูุนูู ุงูุจุฑูุงูุฌ ุฅุฐุง ุชู ุชุซุจูุช ุจุฑุงูุฌ ุชุดุบูู Rutoken ุนูู ุงูููุจููุชุฑ (ูู ุงูุถุฑูุฑู ุฃู ูููู ูุฏู EToken ุฃู Ja Carta ุฑูู ุงููุงุฑุฆ 0). <br><br>  ููุณุจุจ ููุณู ุ ูุฌุจ ุชูุตูู ุฑูุฒ ูููุฒ ูุงุญุฏ ููุท ููุชุดุบูู ุงูุตุญูุญ. <br><br>  ูุณุชุฎุฏู ุงูุจุฑูุงูุฌ ุงููุตู ููุงููุงุช ูุธุงู Window $ ุ ูุชู ุงุฎุชุจุงุฑู ููุท ูุน ุนุงุฆูุฉ ูุธุงู ุงูุชุดุบูู ูุฐู. <br><br>  <b>ููุนูู ุ ุชุญุชุงุฌ ุฅูู ุชุซุจูุช "JaCarta Single Client"</b> (ุชูุฒูู ูุฌุงูู ูู ูููุน ุงูุดุฑูุฉ ุงููุตูุนุฉ) ุ ูุนูุฏูุง ุชููู ุจุชุซุจูุชู ุ ูุฅู ุงูุฅุตุฏุงุฑ ุงูุฃุญุฏุซ ุจุดูู ููุญูุธ ูู etsdk.dll ู jcFS.dll ุงูุฐู ูุญุชูู ุนูู ูุธุงุฆู JaCarta File System (ูุดุจู ุฅูู ุญุฏ ุจุนูุฏ ุชูู ุงูููุฌูุฏุฉ ูู etsdk.dll ุ ูููู ูู jcFS ููุงู ูุธุงุฆู ุฃูุซุฑ ุจูุซูุฑ ูุงูุชู ุจุฏูููุง ุณูููู ูู ุงููุณุชุญูู ุงูุนูู ูุน ุจุนุถ jakarts ุงูุญุฏูุซุฉ ุ ูุซู GOST-2).  ูุน ุชุซุจูุช ุงูุนููู ุงูููุญุฏ ุ ูู ุงูุทุจูุนู ุฃูุง ูููู ูู ุงูุถุฑูุฑู ุงูุจุญุซ ููุถุน ูุฐุง dll ูู ุงููุฌูุฏ ูุน ุงูุจุฑูุงูุฌ ุ ูุฅูุง ุ ูุน ุชุซุจูุช ุจุฑูุงูุฌ ุงูุชุดุบูู ูููุน ูุนูู ูู ุงูุฑูุฒ ุงููููุฒ ุ ูุฌุจ ุฃู ูููู ูุฐุง dll ูู ูุฌูุฏ ุงูุจุฑูุงูุฌ. <br><br>  ูุชู ูุตู ุฌููุน ูุธุงุฆู jcFS ุจุงูุชูุตูู ุนูู ูููุน ุงูุดุฑูุฉ ุงููุตูุนุฉ ุ ูููู ูุน ุฐูู ุ ูุฌุจ ุชุญุฏูุฏ ุจุนุถ ูุนููุงุช ูุฐู ุงููุธุงุฆู ุจุดูู ุชุฌุฑูุจู. <br><br>  ูููุตูู ุฅูู ุงูุฏููู ุงูุฌุฐุฑ ููุฑูุฒ ุงููููุฒ ุ ูุฌุจ ุนููู ุงุณุชุฏุนุงุก ูุธููุฉ ETRootDirOpen ุฃู JCRootDirOpen (ููู ููุณู ุ ุญูุซ ุฃู ุงูุฃููู ูู dll ุชุณุชุฏุนู ุงูุซุงููุฉ ุ ููุฐุง ุตุญูุญ ุจุงููุณุจุฉ ูุฌููุน ุงููุธุงุฆู ุชูุฑูุจูุง ุ ูููู ููุงู ุจุนุถ ุงูุงุณุชุซูุงุกุงุช ุงูููููุฉ) ูุน ูุนุฑู ุจุงุฆุน 0 (ุณูุณูุญ ุงูุซูุงุจุช ูุซู 0xF007 ุดุงูุฏ ุงูุฃุฏูุฉ ุงููุฑุฏูุฉ ููุท ูู eToken ุงููุฏููุฉ ุงูุชู ุชุฎุฒู ููุงุชูุญ ุงูุจููู ุงูุชู ุชู ุฅูุดุงุคูุง ุจุงุณุชุฎุฏุงู ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ูุซู PKIAdmin ู MessagePRO). <br><br>  ุงูููุฒุฉ ุงููููุฉ ุงูุชุงููุฉ ูู jakarta ุงูุญุฏูุซุฉ ูู ุงูุญุงุฌุฉ ุฅูู ูุนุฑูุฉ ูุนุฑู ุงูุชุทุจูู ุงูุตุบูุฑ ุงููุซุจุช ุนูู ุงูุฑูุฒ ุงููููุฒ ุ ูุธููุฉ JCSelectApplet ูู ุงููุณุคููุฉ ุนู ูุฐุง. <br><br>  ุนุงุฏุฉู ูุง ุชุญุชูู ุงูุฑููุฒ ุงููุฏููุฉ ุนูู ุจุฑูุงูุฌ ุตุบูุฑ ุงูุชุฑุงุถู ุ ููุง ููุทูุจ ุงุณุชุฏุนุงุก ูุฐู ุงููุธููุฉ ุชุญุฏูุฏูุง ุ ูููู ุจุงููุณุจุฉ ุฅูู jakarts ุงูุฌุฏูุฏุฉ ูุงูุฌุฏูุฏุฉ ูุณุจููุง ุฏูู ูุนุฑูุฉ ูุนุฑู ุงูุชุทุจูู ุงูุตุบูุฑ ุ ูุตุจุญ ุงูุนูู ุงูุฅุถุงูู ูุณุชุญูููุง.  ุงุณุชุฏุนุงุก ุฌููุน ุงููุธุงุฆู ุงูุชู ุชุชููู ูุนูููุงุช ูู ุงูุฑูุฒ ุงููููุฒ ูู ูุฐู ุงูุญุงูุฉ ุจุฅุฑุฌุงุน ุฎุทุฃ.  ูู ูุดุฑูุนู ุ ูู ูุฐู ุงูุญุงูุฉ ุ ูุชู ุชูููุฐ ุงูููุฉ ุงูุบุงุดูุฉ ุฐุงุช ุงููุฑุญูุชูู (ุงูุฑูุฒ ุงููููุฒ ูุณุชุฌูุจ ุฏุงุฆููุง ููุนุฑููู ุ ูููู ูุนูู ูุงุญุฏ ูููู ููุท) ูุนุฑู ูุงููุฒูุฏ ูู ุงูุนูู ูุน ุงููููุฉ ุงููุทููุจุฉ. <br><br>  ูุชู ุนุฑุถ ุฌููุน ุงููุนูููุงุช ูู ูุงูุฐุฉ ุงูุฅุฎุฑุงุฌ ุงูููุฌูุฏุฉ ุชุญุช ุดุฌุฑุฉ ุงูุฏููู. <br>  ุชู ุฅุฏุฎุงู ุฑูุฒ PIN ุ ููุง ูุชู ุนุฑุถ ูุนูููุงุช ุญูู ุงููุญุงููุงุช ุงููุชุจููุฉ ูุฅุฏุฎุงูู. <br>  ูุชู ุนุฑุถ ูุญุชููุงุช ุงูุฏูุงุฆู ูุงููุนูููุงุช ุงูููุฌุฒุฉ ุญูู ุงููููุงุช: ุงูุงุณู ุ ุณูุงุก ูุงู ุงูููู ูู ูุนูููุงุช ุฎุงุตุฉ ุ ูู ุฑูุฒ PIN ุฎุงุต - ุงูุญุฑู p: (ุงูููู ุนุงู ุจุนุฏู ุ ุงููุญุฏุฉ ุฎุงุตุฉ) ูุญุฌู ุงูููู ุจุงูุจุงูุช ุจุนุฏ "s:".  ูุชู ูุชุญ ุงูููู ุจุงูููุฑ ุงููุฒุฏูุฌ. <br><br>  ููููู ุนุฑุถ ูุญุชููุงุช ุงููููุงุช ุงูุฑูุฒูุฉ ููุณุฎูุง ุฅุฐุง ูุฒู ุงูุฃูุฑ ุฅูู ุงููุฎุฒู ุงููุคูุช ุจุชูุณูู ุณุฏุงุณู ุนุดุฑู ุฃู ุญูุธูุง ูู ุดูู ุซูุงุฆู ุฅูู ุฌูุงุฒ ููุจููุชุฑ. <br><br>  ููููู ุฃูุถูุง ุชุบููุฑ ูุญุชููุงุช ุงูููู ูุชุญุฏูุฏ "ุญูุธ ุงูุชุบููุฑุงุช" ูู ุงููุงุฆูุฉ (ูุฌุจ ุฅุฏุฎุงู ุฑูุฒ PIN ุฃููุงู ุ ุฅุฐุง ูู ูุชู ุฅุฏุฎุงูู ุ ุณูุชู ุนุฑุถ ุฑุณุงูุฉ ููุงุณุจุฉ ุ ููู ูุฐู ุงูุญุงูุฉ ูููู ุงุฎุชูุงุฑ ุงูุจูุงูุงุช ุงูุชู ุชู ุชุญุฑูุฑูุง ููุณุฎูุง ุฅูู ุงูุญุงูุธุฉ). <br><br>  ูุญุฐู ููู ุ ุญุฏุฏู ูุงููุฑ ููู "ุญุฐู" ุ ูุจุนุฏ ุฐูู ุณุชุธูุฑ ูุงูุฐุฉ ุชุฃููุฏ. <br><br>  ูุญุชูู ูุธุงู ูููุงุช JaCarta ุนูู ููุฒุฉ ูุซูุฑุฉ ููุงูุชูุงู ุ ููู ููุฌูุฏุฉ ุนูู ุฌููุน ุงูุฑููุฒ ุงูุชู ุงุฎุชุจุฑุชูุง.  ุฅุฐุง ููุช ุจุฅูุดุงุก ุฏููู ุฃู ุนุฏุฉ ุฃุฏูุฉ ุจุฏูู ูููุงุช ุนูู ุงูุฑูุฒ ุงููููุฒ ุ ุฃุซูุงุก ุงูุฌูุณุฉ ุงูุชุงููุฉ ููุนูู ูุน ุงูุฑูุฒ ุงููููุฒ ุ ูุฅููุง ุณุชุฎุชูู ุ ุนูู ูุง ูุจุฏู ุจูุฐู ุงูุทุฑููุฉ ุ ูุชููู ูุธุงู ุงููููุงุช ุญูุธ ุฐุงูุฑุฉ ุงูุฑูุฒ ุงููููุฒ ูุชูุธูู ุฌููุน ุงูุจูุงูุงุช ุงูููููุฉ. <br><br>  ูุฐูู ุ ุนูุฏ ุงูููุฑ ููู ุงูุฒุฑ "ุฅูุดุงุก" ูู ุงูุจุฑูุงูุฌ ุ ูุชู ุฅูุดุงุก ุณูุณูุฉ ุนูู ุงูููุฑ ูู ุฏููู ุฃู ุฏููููู ูููู.  ุนูู ุชุฏุงุฎู ุงูุฏูุงุฆู ูู ุงูุจุฑูุงูุฌ ุงุซููู ุ ูููุณ ุญุณุงุจ ุงูุฌุฐุฑ.  ูู ุงูุฏููู ุงูุฌุฐุฑ ุ ููููู ููุท ุฅูุดุงุก ุฃุฏูุฉ ุ ูููู ููุณ ูููุงุช. <br>  ูุจู ุฅูุดุงุก ุฃู ุชุญุฑูุฑ ุฃู ุญุฐู ููุงูุงุช ุ ูุฌุจ ุฅุฏุฎุงู ุฑูุฒ PIN. <br><br>  ููุงุญุธุฉ ูููุฉ ุฌุฏุง ุญูู ุฃุณูุงุก ุงูุฏููู! <br><br>  ุนูู ุงูุฑููุฒ ุงููููุฒุฉ ุญูุซ ูุชู ุฅูุดุงุก ุงููุญุชูู ูู ูุจู ุงูุดุฑูุฉ ุงููุตูุนุฉ ุ ููู ุชุดุงูุฏ ุงูุฏูุงุฆู ุจููุณ ุงูุงุณู ุ ุฃูููุง ูุงูุช.  ูุฐุง ุจุณุจุจ ููุฒุงุช ูุธุงู ุงููููุงุช. <br><br>  ุงูุชุฑุถ ุฃู ูุฏููุง ุงูููุงู ุงูุชุงูู ุนูู ุงูุฑูุฒ ุงููููุฒ: // <u>0001</u> / A001 / 0008 (ุฃู ุ ุงููุฌูุฏ 0001 ููุฌูุฏ ูู ุงูุฏููู ุงูุฌุฐุฑ ุ ูุงููุฌูุฏ A001 ููู ุ ูุงูููู 0008 ููุฌูุฏ ููู) ุ ููุญู ููุดุฆ ููุงููุง ุฌุฏูุฏูุง ุนูู ุงูุฑูุฒ ุงููููุฒ: // CC00 / <u>0001/1010</u> .  ุนูุฏ ุงููุตูู ุฅูู ุงูููู 1010 ุ ุณูุจุฏุฃ ุงูุจุญุซ ุนู ุงูุฏููู 0001 ุ ูุงูุฐู ููุน ูู ุงูุฌุฐุฑ ูุณูุชู ุงูุนุซูุฑ ุนููู ุฃููุงู ุ ูููู ูุง ููุฌุฏ ูุซู ูุฐุง ุงูููู ููู.  ูุชูุฌุฉ ูุฐูู ุ ุชููู ุงูุฏุงูุฉ ุจุฅุฑุฌุงุน False ูููุฏุงู ุงูููุงู ุ ูุง ููููู ุงููุตูู ุฅูููุง ูุญุฐููุง ุฃูุถูุง.  ุงูุชููุฆุฉ ุงูุฑูุฒ ุงููููุฒ ููุท ุณูู ูุณุงุนุฏ. <br><br>  ูู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃู EToken PRO ู JA Carta Pro ุ ุงููุฐุงู ูุฎุชููุงู ููุท ูู ุงููุธูุฑ ุ ูุฏููู ูููุงุช ุงููุธุงู ูู ุงูุฏููู ุงูุฌุฐุฑ (ูุชู ุนุฑุถูุง ุนูู ุงูุดุงุดุฉ) ุ ุญูุซ ูุชู ุชุฎุฒูู ุชุฌุฒุฆุฉ ุงูุฑูุฒ ุงูุณุฑู ุงูุฎุงุต ุจู ุ ูุชุบููุฑ ุฎููุท ุงููููุงุช ูุฐู ุฅูู ุญูููุฉ ุฃู ุงูุชูููุถ ูุตุจุญ ูุณุชุญููุงู (ุฑูุฒ ุงูุชุนุฑูู ุงูุดุฎุตู ูุตุจุญ ุบูุฑ ุตุญูุญ) ูุจุนุฏ ุฐูู ููุท ุงูุชููุฆุฉ ุณุชุณุงุนุฏ. <br><br>  ูููุง ูุชุนูู ุจุงูููุงุชูุญ ุงูุฎุงุตุฉ ุ ูุงู ูู ุงููููู ุฅูุดุงุก ูุง ููู: ุฅุฐุง ุชู ุชุฎุฒูู ุญุงููุฉ ุชู ุฅูุดุงุคูุง ุจูุงุณุทุฉ ูููุฑ ุชุดููุฑ ุชุงุจุน ูุฌูุฉ ุฎุงุฑุฌูุฉ ุ ูุซู CryptoPro ุ ุนูู ุงูุฑูุฒ ุงููููุฒ ุ ูุณูุชู ุชูููุฑ ุฌููุน ูุญุชููุงุชู ุ ุจูุง ูู ุฐูู ุงูููุงุชูุญ ุงูุฎุงุตุฉ ุ ุฅูู ูุฌุฑุฏ ูุญุฑู ุฃูุฑุงุต ูุญููู ุจุฑูุฒ PIN (ููุง ูู ููุถุญ ูู ุงูุตูุฑุฉ).  ุฅุฐุง ุชู ุฅูุดุงุก ุฒูุฌ ุงูููุงุชูุญ ุนูู ูุชู ุงูุฑูุฒ ุงููููุฒ ุจุงุณุชุฎุฏุงู PKCS11 ุ ููู ุชุชููุฑ ุณูู ุงูุดูุงุฏุฉ ูุงูููุชุงุญ ุงูุนูููู. <br><br>  ูุธุฑูุง ูุฃู ูุฐุง ุจุฑูุงูุฌ ุชุฌุฑูุจู ุ ูุง ุฃูุตู ุจุงุณุชุฎุฏุงูู ูุน ุฑููุฒ ุชุญุชูู ุนูู ููุงุชูุญ EDS ุตุงูุญุฉ ุ ุญูุซ ูุชู ุชูููุฐ ุฌููุน ุงูุนูููุงุช ููููุง ูุฎูู ุงููุฌุฑุจ ููุฎุงุทุฑู.  ูููุทุจู ูุฐุง ุจุดูู ุฎุงุต ุนูู ุฅูุดุงุก ููุงูุงุช ุฌุฏูุฏุฉ ุ ููู ุจุนุถ ุงูุญุงูุงุช ูุตุนุจ ุงูุชูุจุค ุจุงููุชูุฌุฉ. <br><br>  ุชู ุงูุญุตูู ุนูู ุฌููุน ุงููุนูููุงุช ูุฅูุดุงุก ุงูุจุฑูุงูุฌ ูู ุงููุตุงุฏุฑ ุงูููุชูุญุฉ ุ ูุงูุบุฑุถ ูู ุฅูุดุงุฆู ูู ุงูุจุญุซ ุงูุจุญุช. <br><br>  ุงูุณููุงุฑูู ููุณู <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">JACartaEditor.au3</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="vbscript hljs">#include &lt;GUIConstantsEx.au3&gt; #include &lt;WindowsConstants.au3&gt; #include &lt;EditConstants.au3&gt; #include &lt;TreeViewConstants.au3&gt; #include &lt;GuiTreeView.au3&gt; #include &lt;GuiMenu.au3&gt; #include &lt;MsgBoxConstants.au3&gt; #include &lt;StaticConstants.au3&gt; #include &lt;GuiButton.au3&gt; #NoTrayIcon ;  jcFS.dll <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> $ETSdkDll=DllOpen(<span class="hljs-comment"><span class="hljs-comment">'jcFS.dll') Func ETTokenLock($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLock', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenUnLock($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenUnLock', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETReadersEnumOpen() Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETReadersEnumOpen', _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETReadersEnumNext($EnumId) Local $Reader=DllStructCreate('CHAR name[260]; BYTE etoken;') Local $CallRes=DllCall($ETSdkDll,'WORD','ETReadersEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Reader) _ ) Local $Result[2]=[ DllStructGetData($reader,'name'), _ DllStructGetData($reader,'etoken')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func ETReadersEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETReadersEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenBind($ReaderName) Local $In=DllStructCreate('BYTE['&amp;(StringLen($ReaderName)+1)&amp;']') Local $Out=DllStructCreate('DWORD') DllStructSetData($In,1,$ReaderName) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenBind', _ 'PTR',DllStructGetPtr($Out), _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETTokenRebind($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenRebind', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenUnbind($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenUnbind', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenLogin($BindId,$Pin='') Local $In=DllStructCreate('BYTE['&amp;(StringLen($Pin)+1)&amp;']') DllStructSetData($In,1,$Pin) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLogin', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenPinChange($BindId,$Pin) Local $In=DllStructCreate('CHAR['&amp;(StringLen($Pin)+1)&amp;']') DllStructSetData($In,1,$Pin) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenPinChange', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenLogout($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLogout', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETRootDirOpen($BindId,$Dir=0xF007) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETRootDirOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$BindId, _ 'DWORD',$Dir _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirOpen($Dir,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$Dir, _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirCreate($Dir,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirCreate', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$Dir, _ 'DWORD',$DirId, _ 'DWORD',0 _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirGetInfo($DirId) Local $Out=DllStructCreate('WORD wDirName; WORD wSize') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirGetInfo', _ 'DWORD',$DirId, _ 'PTR',DllStructGetPtr($Out) _ ) Local $Result[2]=[ DllStructGetData($Out,'wDirName'), _ DllStructGetData($Out,'wSize')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func ETDirClose($DirId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirClose', _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETDirDelete($DirId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirDelete', _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETDirEnumOpen($DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirEnumOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirEnumNext($EnumId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETDirEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETDirEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETFileOpen($File,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId, _ 'DWORD',$File _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFileCreate($File,$DirId,$Size,$Private=0) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileCreate', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId, _ 'DWORD',$File, _ 'DWORD',$Size, _ 'DWORD',$Private _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFileGetInfo($FileId) Local $Out=DllStructCreate('WORD name;WORD private;WORD;WORD size') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileGetInfo', _ 'DWORD',$FileId, _ 'PTR',DllStructGetPtr($Out) _ ) Local $Result[3]=[ DllStructGetData($Out,'name'), _ DllStructGetData($Out,'private'), _ DllStructGetData($Out,'size')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func ETFileRead($FileId) Local $FileInfo=ETFileGetInfo($FileId) If @error Then Return SetError(@error,0,False) Local $Out=DllStructCreate('BYTE ['&amp;$FileInfo[2]&amp;']') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileRead', _ 'DWORD',$FileId, _ 'DWORD',0, _ 'DWORD',0xFFFF, _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$FileInfo[2] _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFileWrite($FileId,$Data,$Pos=0) $Data=Binary($Data) Local $DataSize=BinaryLen($Data) Local $In=DllStructCreate('BYTE['&amp;$DataSize&amp;']') DllStructSetData($In,1,$Data) Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileWrite', _ 'DWORD',$FileId, _ 'DWORD',$Pos, _ 'PTR',DllStructGetPtr($In), _ 'DWORD',$DataSize _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETFileClose($FileId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileClose', _ 'DWORD',$FileId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETFileDelete($FileId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETFileDelete', _ 'DWORD',$FileId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETFilesEnumOpen($DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFilesEnumOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFilesEnumNext($EnumId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETFilesEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETFilesEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','ETFilesEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func ETTokenLabelGet($BindId) Local $Out1=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLabelGet', _ 'DWORD',$BindId, _ 'PTR',0, _ 'PTR',DllStructGetPtr($Out1) _ ) If $CallRes[0] Then Return SetError($CallRes[0],0,False) Local $Out2=DllStructCreate('CHAR['&amp;DllStructGetData($Out1,1)&amp;']') $CallRes=DllCall($ETSdkDll,'WORD','ETTokenLabelGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out2), _ 'PTR',DllStructGetPtr($Out1) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out2,1) EndFunc Func ETTokenIDGet($BindId) Local $Out1=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenIDGet', _ 'DWORD',$BindId, _ 'PTR',0, _ 'PTR',DllStructGetPtr($Out1) _ ) If $CallRes[0] Then Return SetError($CallRes[0],0,False) Local $Out2=DllStructCreate('CHAR['&amp;DllStructGetData($Out1,1)&amp;']') $CallRes=DllCall($ETSdkDll,'WORD','ETTokenIDGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out2), _ 'PTR',DllStructGetPtr($Out1) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out2,1) EndFunc Func ETTokenMaxPinGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenMaxPinGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETTokenMinPinGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','ETTokenMinPinGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func ETSelectApplet($BindId, $Applet) Local $In=DllStructCreate('DWORD') DllStructSetData($In,1,$Applet) Local $CallRes=DllCall($ETSdkDll,'WORD','ETSelectApplet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Applet) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCSelectApplet($BindId, $Applet) Local $In=DllStructCreate('WORD') DllStructSetData($In,1,$Applet) Local $CallRes=DllCall($ETSdkDll,'WORD','JCSelectApplet', _ 'DWORD',$BindId, _ 'WORD',$Applet _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCReadersEnumOpen() Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCReadersEnumOpen', _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCReadersEnumNext($EnumId) Local $Reader=DllStructCreate('CHAR name[260]; BYTE etoken;') Local $CallRes=DllCall($ETSdkDll,'WORD','JCReadersEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Reader) _ ) Local $Result[2]=[ DllStructGetData($reader,'name'), _ DllStructGetData($reader,'etoken')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func JCReadersEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCReadersEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenBind($ReaderName) Local $In=DllStructCreate('CHAR['&amp;(StringLen($ReaderName)+1)&amp;']') Local $Out=DllStructCreate('DWORD') DllStructSetData($In,1,$ReaderName) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenBind', _ 'PTR',DllStructGetPtr($Out), _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCTokenRebind($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenRebind', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenUnbind($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenUnbind', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenLogin($BindId,$Pin) Local $In=DllStructCreate('CHAR['&amp;(StringLen($Pin)+1)&amp;']') DllStructSetData($In,1,$Pin) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLogin', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenPinChange($BindId,$Pin) Local $In=DllStructCreate('CHAR['&amp;(StringLen($Pin)+1)&amp;']') DllStructSetData($In,1,$Pin) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenPinChange', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($In) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenLogout($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLogout', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCRootDirOpen($BindId,$Dir=0) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCRootDirOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$BindId, _ 'WORD',$Dir _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirOpen($Dir,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$Dir, _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirCreate($Dir,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirCreate', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$Dir, _ 'DWORD',$DirId, _ 'DWORD',0 _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirGetInfo($DirId) Local $Out=DllStructCreate('BYTE[8]') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirGetInfo', _ 'DWORD',$DirId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirClose($DirId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirClose', _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCDirDelete($DirId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirDelete', _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCDirEnumOpen($DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirEnumOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirEnumNext($EnumId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCDirEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCDirEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCFileOpen($File,$DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId, _ 'DWORD',$File _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFileCreate($File,$DirId,$Size,$Private=0) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileCreate', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId, _ 'DWORD',$File, _ 'DWORD',$Size, _ 'DWORD',$Private _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFileGetInfo($FileId) Local $Out=DllStructCreate('WORD name;WORD private;WORD;WORD size') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileGetInfo', _ 'DWORD',$FileId, _ 'PTR',DllStructGetPtr($Out) _ ) Local $Result[3]=[ DllStructGetData($Out,'name'), _ DllStructGetData($Out,'private'), _ DllStructGetData($Out,'size')] Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :$Result EndFunc Func JCFileRead($FileId) Local $FileInfo=JCFileGetInfo($FileId) If @error Then Return SetError(@error,0,False) Local $Out=DllStructCreate('BYTE ['&amp;$FileInfo[2]&amp;']') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileRead', _ 'DWORD',$FileId, _ 'DWORD',0, _ 'DWORD',0xFFFF, _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$FileInfo[2] _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFileWrite($FileId,$Data,$Pos=0) $Data=Binary($Data) Local $DataSize=BinaryLen($Data) Local $In=DllStructCreate('BYTE['&amp;$DataSize&amp;']') DllStructSetData($In,1,$Data) Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileWrite', _ 'DWORD',$FileId, _ 'DWORD',$Pos, _ 'PTR',DllStructGetPtr($In), _ 'DWORD',$DataSize _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCFileClose($FileId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileClose', _ 'DWORD',$FileId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCFileDelete($FileId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCFileDelete', _ 'DWORD',$FileId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCFilesEnumOpen($DirId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFilesEnumOpen', _ 'PTR',DllStructGetPtr($Out), _ 'DWORD',$DirId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFilesEnumNext($EnumId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCFilesEnumNext', _ 'DWORD',$EnumId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCFilesEnumClose($EnumId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCFilesEnumClose', _ 'DWORD',$EnumId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenLabelGet($BindId) Local $Out1=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLabelGet', _ 'DWORD',$BindId, _ 'PTR',0, _ 'PTR',DllStructGetPtr($Out1) _ ) If $CallRes[0] Then Return SetError($CallRes[0],0,False) Local $Out2=DllStructCreate('CHAR['&amp;DllStructGetData($Out1,1)&amp;']') $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLabelGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out2), _ 'PTR',DllStructGetPtr($Out1) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out2,1) EndFunc Func JCTokenIDGet($BindId) Local $Out1=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenIDGet', _ 'DWORD',$BindId, _ 'PTR',0, _ 'PTR',DllStructGetPtr($Out1) _ ) If $CallRes[0] Then Return SetError($CallRes[0],0,False) Local $Out2=DllStructCreate('CHAR['&amp;DllStructGetData($Out1,1)&amp;']') $CallRes=DllCall($ETSdkDll,'WORD','JCTokenIDGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out2), _ 'PTR',DllStructGetPtr($Out1) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out2,1) EndFunc Func JCTokenMaxPinGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenMaxPinGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCTokenMinPinGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenMinPinGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc Func JCTokenUnLock($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenUnLock', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenLock($BindId) Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenLock', _ 'DWORD',$BindId _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :True EndFunc Func JCTokenPinAttemptsGet($BindId) Local $Out=DllStructCreate('DWORD') Local $CallRes=DllCall($ETSdkDll,'WORD','JCTokenPinAttemptsGet', _ 'DWORD',$BindId, _ 'PTR',DllStructGetPtr($Out) _ ) Return $CallRes[0] _ ?SetError($CallRes[0],0,False) _ :DllStructGetData($Out,1) EndFunc ;  Opt("GUIOnEventMode", 1) Dim $BindId, $filelog, $Result, $DirIdRoot=False, $Edit, $msg, $Fileinfo, $treeview, $generalitem, $displayitem, $diritem, $Edit, $SrcSubId, $Output, $pinbutton, $hPinWin, $PinEdit, $pinokbutton, $pincancelbutton, $Pin, $Edit1, $Reader, $Applet, $AppletID, $text, $CreateDirWin Global $Dir1, $Dir2 Dim $hParentWin, $hChildWin, $sItemText, $folderbutton, $filebutton, $deletebutton, $CreateFileWin, $FileEdit, $fileokbutton, $filecancelbutton, $publicbutton, $privatebutton, $sizefile Dim $hFile, $hMain Global Enum $idSave= 1000, $Save Dim $Appname = 'JaCarta Editor' ;  applet ID  Func Applet() GUICtrlSetData($Output, '  applet ID... '&amp;@CRLF,1) Local $Result, $AppletTemp= 0 For $Applet = 0 To 65535 Step 1 $Result = 0 $Result=JCSelectApplet($BindId,$Applet) ; 0x2001 PROJAVA  E-token, 0x1002 PRO, 0x1001 R2, 0x2202 GOST, 0x2205 DATASTORE, 0x2206 -2, 0x2201, 0x2204 ( JaCarta) If $Result = True Then $AppletTemp=$Applet $AppletID=$Applet ExitLoop EndIf Next Local $Id=ETTokenLabelGet($BindId) if $Id= False Then For $Applet=$AppletTemp+1 To 65535 Step 1 $Result=0 $Result=JCSelectApplet($BindId,$Applet) If $Result = True Then ExitLoop EndIf Next EndIf JCSelectApplet($BindId,$Applet) GUICtrlSetData($Output, 'Select applet 0x'&amp;hex($Applet,4)&amp;@CRLF,1) $AppletID=$Applet EndFunc ;      Func PrintDir($Id,$Prefix) Local $EnumId=ETDirEnumOpen($Id) While 1 Local $dir=ETDirEnumNext($EnumId) If @error Then ExitLoop Local $DirId=ETDirOpen($dir,$Id) Local $Dirinfo $Dirinfo=ETDirGetInfo($DirId) Local $Dirtext='(dir)'&amp;hex($dir,4) $diritem = _GUICtrlTreeView_AddChild($treeview,$Prefix, $Dirtext) PrintDir($DirId,$diritem) ETDirClose($DirId) WEnd ETDirEnumClose($EnumId) $EnumId=ETFilesEnumOpen($Id) While 1 Local $file=ETFilesEnumNext($EnumId) If @error Then ExitLoop Local $FileId=ETFileOpen($file,$Id) $Fileinfo=ETFileGetInfo($FileId) Local $filetext='(file)'&amp;hex($file,5)&amp;' '&amp;'p: '&amp;$Fileinfo[1]&amp;' s: '&amp;$Fileinfo[2]&amp;@CRLF _GUICtrlTreeView_AddChild($treeview,$Prefix,$filetext) WEnd ETFilesEnumClose($EnumId) EndFunc ;         Func List() GUICtrlSetData($Output, '') Local $text Local $EnumId=ETReadersEnumOpen() GUICtrlSetData($Output, '   :'&amp;@CRLF,1) While 1 $Reader=ETReadersEnumNext($EnumId) If @error Then ExitLoop GUICtrlSetData($Output, $Reader[0]&amp;@CRLF,1) WEnd ETReadersEnumClose($EnumId) Local $EnumId=ETReadersEnumOpen() $Reader=ETReadersEnumNext($EnumId) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) GUICtrlSetData($Output, '  '&amp;$Reader[0]&amp;@CRLF,1) ;    ID ,    AppletID $Result=ETTokenIDGet($BindId) if $Result= False Then if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) Else Applet() EndIf EndIf $Result=ETTokenIDGet($BindId) $text=$Reader[0]&amp;' ID '&amp;$Result $generalitem = _GUICtrlTreeView_AddChild($treeview,0,$text) $Result=ETTokenLabelGet($BindId) GUICtrlSetData($Output, 'Label: '&amp;$Result&amp;@CRLF,1) $DirIdRoot=ETRootDirOpen($BindId,0) ;0xF007   0x0001    $Result=JCTokenPinAttemptsGet($BindId) ;       If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result ) Else GUICtrlSetData($Output, 'Login OK'&amp;@CRLF,1) EndIf EndIf $Result=JCTokenPinAttemptsGet($BindId) GUICtrlSetData($Output, '   PIN : '&amp;$Result&amp;@CRLF,1) PrintDir($DirIdRoot,0) ETTokenUnbind($BindId) ETReadersEnumClose($EnumId) EndFunc ;     Func onClose() GUISetState(@SW_HIDE, $hPinWin) GUISetState(@SW_HIDE, $hChildWin) GUISetState(@SW_HIDE, $CreateFileWin) if @GUI_WinHandle=$hParentWin Then Exit EndIf EndFunc ;     Func onPin() GUISetState(@SW_SHOW, $hPinWin ) EndFunc ;       Func onPinOK() $Pin=GUICtrlRead($PinEdit) GUISetState(@SW_HIDE, $hPinWin) _GUICtrlTreeView_DeleteAll ($treeview) List() EndFunc ;    Func onPinCancel() GUISetState(@SW_HIDE, $hPinWin) EndFunc ;  Func Delete() If $Pin=0 Then MsgBox(0x10,$Appname,'      ' ) Else Local $hItem = _GUICtrlTreeView_GetSelection($treeview) Local $Del = _GUICtrlTreeView_GetText($treeview, $hItem) if _GUICtrlTreeView_GetChildren($treeview, $hItem)=False Then $Del=StringTrimLeft ( $Del, 6 ) Local $p=0 $p=StringInStr ($Del,"p:") $Del=StringMid ( $Del, 1, $p-2 ) if MsgBox(4 + 32, $Appname, ' '&amp; $Del &amp;' ?') = 6 Then Local $DirID=_GUICtrlTreeView_GetParentHandle($treeview, $hItem) Local $Dir= _GUICtrlTreeView_GetText($treeview, $DirID) $Dir=StringTrimLeft ( $Dir, 5 ) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) EndIf If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result) EndIf EndIf Local $HDir=GetDir(ETRootDirOpen($BindId,0), $Dir) Local $DELFile =JCFileOpen(Dec ($Del), $HDir) JCFileDelete($DELFile ) ETDirClose($HDir) ETTokenUnbind($BindId) _GUICtrlTreeView_DeleteAll ($treeview) List() EndIf Else MsgBox(0x10,$Appname,'           ' ) EndIf EndIf EndFunc ;     Func onFileCreate() If $Pin=0 Then MsgBox(0x10,$Appname,'      ' ) Else Local $hItem = _GUICtrlTreeView_GetSelection($treeview) Local $FileText = 0, $Dir1=0, $Dir2=0 $FileText = _GUICtrlTreeView_GetText($treeview, $hItem) ;      if StringLen($FileText) &gt;20 Then GUICtrlSetData($FileEdit, '') GUICtrlSetData($FileEdit, '//',0) Else $Dir1=StringTrimLeft ( $FileText, 5 ) Local $ParentID=_GUICtrlTreeView_GetParentHandle($treeview, $hItem) Local $ParentDir= _GUICtrlTreeView_GetText($treeview, $ParentID) if StringInStr ($ParentDir,"Dir")=0 Then $ParentDir='' GUICtrlSetData($FileEdit, '') GUICtrlSetData($FileEdit, '//'&amp;$Dir1&amp;'/',0) Else $Dir2=StringTrimLeft ( $ParentDir, 5 ) $Dir2='/'&amp;$Dir2 GUICtrlSetData($FileEdit, '') GUICtrlSetData($FileEdit, '/'&amp;$Dir2&amp;'/'&amp;$Dir1&amp;'/',0) EndIf EndIf GUISetState(@SW_SHOW, $CreateFileWin) EndIf EndFunc ;   Func onFileCancel() GUISetState(@SW_HIDE, $CreateFileWin) EndFunc ;   Func onFileOK() Local $filename=GUICtrlRead($FileEdit) Local $isPrivate=_GUICtrlButton_GetCheck($privatebutton) Local $fileSize=GUICtrlRead($sizefile) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) EndIf If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result ) EndIf EndIf Local $rootdir=ETRootDirOpen($BindId,0) Local $text=StringTrimLeft ( $filename, 2 ) Local $text1=StringLeft($text, 4) $dir1=JCDirOpen(Dec ($text1), $rootdir) if $dir1=false Then $dir1= ETDirCreate(Dec ($text1), $rootdir) EndIf if StringLen($text) &gt;12 Then $text=StringTrimLeft ( $text, 5 ) $text1=StringLeft($text, 4) $dir2=JCDirOpen(Dec ($text1), $dir1) if $dir2=false Then $dir2= ETDirCreate(Dec ($text1), $dir1) EndIf $text=StringTrimLeft ( $text, 5 ) Local $DstFile=JCFileCreate(Dec ($text),$Dir2,$fileSize,$isPrivate) JCFileClose($DstFile) Else $text=StringTrimLeft ( $text, 5 ) Local $DstFile=JCFileCreate(Dec ($text),$Dir1,$fileSize,$isPrivate) JCFileClose($DstFile) EndIf ETTokenUnbind($BindId) GUISetState(@SW_HIDE, $CreateFileWin) GUISetState(@SW_SHOW, $hParentWin) _GUICtrlTreeView_DeleteAll ($treeview) List() EndFunc ;     Func SaveFile() If $Pin=0 Then MsgBox(0x10,$Appname,'      ' ) Else Local $filebody=GUICtrlRead($Edit1) Local $hItem = _GUICtrlTreeView_GetSelection($treeview) Local $FileEd = _GUICtrlTreeView_GetText($treeview, $hItem) $FileEd=StringTrimLeft ( $FileEd, 6 ) Local $p=0 $p=StringInStr ($FileEd,"p:") $FileEd=StringMid ( $FileEd, 1, $p-2 ) Local $DirID=_GUICtrlTreeView_GetParentHandle($treeview, $hItem) Local $Dir= _GUICtrlTreeView_GetText($treeview, $DirID) $Dir=StringTrimLeft ( $Dir, 5 ) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) EndIf If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result) EndIf EndIf Local $HDir=GetDir(ETRootDirOpen($BindId,0), $Dir) Local $File=JCFileOpen(Dec ($FileEd),$HDir) Local $Data =Binary('0x' &amp; $filebody) JCFileWrite($File, $Data) JCFileClose($File) ETDirClose($HDir) ETTokenUnbind($BindId) GUISetState(@SW_HIDE, $hChildWin) _GUICtrlTreeView_DeleteAll ($treeview) List() EndIf EndFunc ;       Func SaveFileAs() Local $varFile = 0 $varFile = FileSaveDialog( " ", @MyDocumentsDir &amp; "\", "  (*.bin)", 16,'',$hParentWin) If StringLen($varFile) &gt; 3 Then Local $filedest $filedest = FileOpen($varFile, 17) ; Check if file open If $filedest = -1 Then MsgBox(0, "Error", "Unable to open file.") Exit EndIf FileWrite($filedest, $text) FileClose($filedest) EndIf EndFunc ;        Func WM_COMMAND($hWnd, $iMsg, $wParam, $lParam) #forceref $hWnd, $iMsg, $lParam Switch $wParam Case $Save SaveFile() Case $idSave SaveFileAs() EndSwitch EndFunc ;==&gt;WM_COMMAND ;   Func GUIInit() $hParentWin= GUICreate($Appname, 560, 400) GUISetOnEvent($GUI_EVENT_CLOSE,'onClose') ;   $treeview = GUICtrlCreateTreeView(6, 6, 400, 300, BitOR($TVS_HASBUTTONS, $TVS_HASLINES, $TVS_LINESATROOT, $TVS_DISABLEDRAGDROP, $TVS_SHOWSELALWAYS), $WS_EX_CLIENTEDGE) $Output = GUICtrlCreateEdit("" , 6, 320, 400, 70, $ES_AUTOVSCROLL + $WS_VSCROLL + $ES_NOHIDESEL + $ES_WANTRETURN) $pinbutton = GUICtrlCreateButton("&amp; PIN ", 430, 20, 100, 50) $filebutton = GUICtrlCreateButton("&amp;", 430, 80, 100, 50) $deletebutton = GUICtrlCreateButton("&amp;", 430, 140, 100, 50) ;     $hPinWin = GUICreate(' PIN ', 200, 200, -1, -1, $WS_SYSMENU, -1, $hParentWin) $PinEdit = GUICtrlCreateInput ("" , 50, 40, 100, 25, $ES_PASSWORD + $ES_NOHIDESEL + $ES_WANTRETURN) $pinokbutton = GUICtrlCreateButton("&amp;OK", 20, 100, 60, 40) $pincancelbutton = GUICtrlCreateButton("&amp;", 110, 100, 60, 40) ;   $CreateFileWin = GUICreate('   ', 340, 350, -1, -1, $WS_SYSMENU, -1, $hParentWin) $FileEdit = GUICtrlCreateInput ("" , 50, 70, 230, 25) $fileokbutton= GUICtrlCreateButton("&amp;OK", 70, 240, 60, 40) $filecancelbutton = GUICtrlCreateButton("&amp;", 210, 240, 60, 40) $publicbutton= _GUICtrlButton_Create($CreateFileWin, "Public", 100, 120, 50, 30, $BS_AUTORADIOBUTTON, 0) $privatebutton=_GUICtrlButton_Create($CreateFileWin, "Private", 160, 120, 50, 30, $BS_AUTORADIOBUTTON, 0) _GUICtrlButton_SetCheck($publicbutton, $BST_CHECKED) Local $label=GUICtrlCreateLabel('      hex  1001 ', 70, 20, 170, 40, $SS_CENTER) $sizefile = GUICtrlCreateInput ("10" , 220, 175, 50, 20) Local $label1=GUICtrlCreateLabel('    ', 20, 180, 200, 60, $SS_CENTER) ;   $hChildWin = GUICreate($sItemText, 300, 230, -1, -1, $WS_SYSMENU, -1, $hParentWin) $Edit1 = GUICtrlCreateEdit("", 10, 10, 240, 160, $ES_AUTOVSCROLL + $WS_VSCROLL + $ES_NOHIDESEL + $ES_WANTRETURN) ;   ""     $hFile = _GUICtrlMenu_CreateMenu () _GUICtrlMenu_InsertMenuItem ($hFile, 0, ' ...', $idSave) _GUICtrlMenu_InsertMenuItem ($hFile, 1, ' ', $Save) $hMain = _GUICtrlMenu_CreateMenu () _GUICtrlMenu_InsertMenuItem ($hMain, 0, '', 0, $hFile) _GUICtrlMenu_SetMenu ($hChildWin, $hMain) ;  GUICtrlSetOnEvent($filebutton,'onFileCreate') GUICtrlSetOnEvent($deletebutton,'Delete') GUICtrlSetOnEvent($pinbutton,'onPin') GUICtrlSetOnEvent($pinokbutton,'onPinOK') GUICtrlSetOnEvent($pincancelbutton,'onPinCancel') GUICtrlSetOnEvent($fileokbutton,'onFileOK') GUICtrlSetOnEvent($filecancelbutton,'onFileCancel') GUISetOnEvent($GUI_EVENT_CLOSE,'onClose') GUISetState(@SW_SHOW, $hParentWin) GUIRegisterMsg(0x0111, "WM_COMMAND") EndFunc ;    GUIInit() List() ;          GUIRegisterMsg($WM_NOTIFY, "MY_WM_NOTIFY") Global $iDoubleClick = 0 Func MY_WM_NOTIFY($hWnd, $Msg, $wParam, $lParam) Local $tagNMHDR, $vEvent Switch $wParam Case $treeview $tagNMHDR = DllStructCreate("int;int;int", $lParam) If @error Then Return $vEvent = DllStructGetData($tagNMHDR, 3) If $vEvent = $NM_DBLCLK Then $iDoubleClick = 1 EndIf EndSwitch $tagNMHDR = 0 EndFunc ;==&gt;MY_WM_NOTIFY ;  ,      Func GetDir( $Id,$Dir_Id) Local $DirId=0 Local $DirResult=0 Local $EnumId=ETDirEnumOpen($Id) While 1 Local $dir=ETDirEnumNext($EnumId) If @error Then ExitLoop $DirId=ETDirOpen($dir,$Id) if hex($dir,4)=$Dir_Id Then $DirResult=$DirId ExitLoop EndIf $DirResult=GetDir( $DirId, $Dir_Id) ETDirClose($DirId) WEnd ETDirEnumClose($EnumId) Return $DirResult EndFunc ;            Func ListFile($file, $Dir_Id) $BindId=ETTokenBind($Reader[0]) $Result=JCTokenLock($BindId) if $AppletID&lt;&gt;0 Then JCSelectApplet($BindId,$AppletID) EndIf If $Pin &lt;&gt; 0 Then $Result=JCTokenLogin($BindId,$Pin) If $Result=False Then $Result=JCTokenPinAttemptsGet($BindId) MsgBox(0x10,$Appname,' PIN '&amp;@CRLF&amp;'   PIN : '&amp;$Result ) EndIf EndIf if StringLen($Dir_Id)&gt;10 Then $HDir=ETRootDirOpen($BindId,0) Else Local $HDir=GetDir(ETRootDirOpen($BindId,0), $Dir_Id) EndIf $SrcSubId=JCFileOpen(Dec ($file), $HDir) $text=JCFileRead($SrcSubId) GUICtrlSetData($Edit1, hex($text)) JCFileClose($SrcSubId) ETDirClose($HDir) ETTokenUnbind($BindId) EndFunc ;          While 1 if $iDoubleClick Then Local $hItem = _GUICtrlTreeView_GetSelection($treeview) if _GUICtrlTreeView_GetChildren($treeview, $hItem)=False Then Local $hItem = _GUICtrlTreeView_GetSelection($treeview) $sItemText = _GUICtrlTreeView_GetText($treeview, $hItem) if StringInStr ($sItemText,"Dir")=0 Then Local $text1=0 $text1=StringTrimLeft ( $sItemText, 6 ) Local $p=0 $p=StringInStr ($text1,"p:") $sItemText=0 $sItemText=StringMid ( $text1, 1, $p-2 ) GUISetState(@SW_SHOW, $hChildWin) GUISetOnEvent($GUI_EVENT_CLOSE,'onClose') Local $DirID=_GUICtrlTreeView_GetParentHandle($treeview, $hItem) Local $Dir= _GUICtrlTreeView_GetText($treeview, $DirID) $text1=StringTrimLeft ( $Dir, 5 ) $Dir=$text1 ListFile($sItemText, $Dir) EndIf EndIf $iDoubleClick = 0 EndIf WEnd</span></span></code> </pre> <br></div></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุตุงุฏุฑ ุงููุนูููุงุช</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุตุฏุงุฑ ุฏููู ูุทูุฑู eToken 3.50 (ุฏูุณูุจุฑ 2003)</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar441476/">https://habr.com/ru/post/ar441476/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar441456/index.html">ุณุช ูุตุต ููู ุชู ุงุนุงุฏุฉ ูุชุงุจุฉ ุงูููุฏ ูู ุงูุตูุฑ</a></li>
<li><a href="../ar441458/index.html">ุงูุฃุณูุญุฉ ุงูุขููุฉ ูุงููุชูุงุนุจูู - ุฃุฎุจุฑูู ุจูุง ููุนูู ูุฎุชุจุฑ ุงูุฑูุจูุชุงุช ุงูุชุงุจุน ูุฌุงูุนุฉ ITMO</a></li>
<li><a href="../ar441460/index.html">ูููู ุชุฑู ุชุนููู ุชูููููุฌูุง ุงููุนูููุงุชุ</a></li>
<li><a href="../ar441468/index.html">ุณูููู Facebook ุจุฅุบูุงู ุจุฑูุงูุฌ ุงูุชุฌุณุณ VPN Onavo ุงูุฎุงุต ุจู</a></li>
<li><a href="../ar441472/index.html">ุชุฏุฑุณ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุฑุณู ุงูุชูุงุตูู ุงูููููุฏุฉ ูู ุตูุฑุฉ ุงููุงุณ</a></li>
<li><a href="../ar441478/index.html">ูุนุจุฉ ุชูุงุนููุฉ ุนูู XSLT</a></li>
<li><a href="../ar441482/index.html">ุงูุชุณูุณู ุงูุฒููู ุงูุฌุฏูุฏ ูุฃููู ุงููุญูุท ุงููุงุฏุฆ</a></li>
<li><a href="../ar441484/index.html">ุนุงุฑุถ ููุธูู Microsoft ุงุณุชุฎุฏุงู HoloLens ูู ุงูุฌูุด ุ ูุฃู ุงูุญุฑุจ ุชุชุญูู ุฅูู ูุนุจุฉ ููุจููุชุฑ</a></li>
<li><a href="../ar441490/index.html">ูุง ุงูุฐู ุชุจุญุซ ุนูู ุนูุฏ ุงุฎุชูุงุฑ ูุงุฑุฆ - ุฃูุธูุฉ ุงูุชุดุบูู ูุงูุฃุฌูุฒุฉ</a></li>
<li><a href="../ar441496/index.html">ุงูุตูุช ุนูู ุงูุณูู: ุชุงุฑูุฎ ุงูุชูุบุฑุงู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>