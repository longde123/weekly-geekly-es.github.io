<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧕🏼 🛀🏿 ⛽️ Farberkennung von Autos mit neuronalen Netzen und TensorFlow 👲🏻 🤙 🤛🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo, mein Name ist Roman Lapin, ich bin ein Student im zweiten Jahr an der Fakultät der Hochschule für Allgemeine und Angewandte Physik der UNN. Die...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Farberkennung von Autos mit neuronalen Netzen und TensorFlow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/422689/"><img src="https://habrastorage.org/webt/ay/jz/uv/ayjzuvpfvae66prncupgndyiwpc.jpeg"><br><br>  Hallo, mein Name ist Roman Lapin, ich bin ein Student im zweiten Jahr an der Fakultät der Hochschule für Allgemeine und Angewandte Physik der UNN.  Dieses Jahr habe ich es geschafft, durch die Auswahl zu kommen und an der Arbeit der Intel Summer School in Nischni Nowgorod teilzunehmen.  Meine Aufgabe war es, die Farbe des Autos mithilfe der Tensorflow-Bibliothek zu bestimmen, an der ich mit meinem Mentor und Ingenieur des ICV-Teams Alexei Sidnev zusammengearbeitet habe. <br>  Und das habe ich bekommen. <br><a name="habracut"></a><br>  Diese Aufgabe hat mehrere Aspekte: <br><br><ol><li>  Das Auto kann wie beim KDPV in mehreren Farben lackiert werden.  Und in einem der Datensätze hatten wir zum Beispiel ein getarntes Auto. </li><li>  Abhängig von der Beleuchtung und der Kamera, die Bilder von den Ereignissen auf der Straße macht, sehen Autos derselben Farbe sehr unterschiedlich aus.  Die "beleuchteten" Autos können einen sehr kleinen Teil haben, der der "wahren" Farbe des Autos entspricht. </li></ol><br><h2>  <font color="#0071c5">Autofarberkennung</font> </h2><br>  Die Farbe des Autos ist eine ziemlich seltsame Substanz.  Der Hersteller hat ein klares Verständnis dafür, welche Farbe das Auto hat, das er produziert, zum Beispiel: Phantom, Eis, schwarze Perle, Pluto, Limette, Krypton, Angkor, Karneol, Platin, Blau.  Die Verkehrspolizei hat eine Meinung zu den Farben von Autos eher konservativ und sehr begrenzt.  Jede einzelne Person hat eine subjektive Wahrnehmung von Farbe (Sie können sich an die beliebte Geschichte über die Farbe des Kleides erinnern).  Daher haben wir uns entschlossen, wie folgt zu markieren. <br><br>  Auf jedem Bild wurden die Koordinaten der Eckpunkte der angrenzenden Rechtecke um die Autos herum markiert (im Folgenden werde ich die englische Version verwenden - <i>Auto-Begrenzungsrahmen</i> ) und in ihnen befinden sich die Bereiche, die die Farbe der Fahrzeuge am besten beschreiben ( <i>Farbkasten</i> ).  Die Anzahl der letzteren entspricht der Farbe des Autos ( <i>n</i> x <i>Farbfeld</i> - n-farbiges Auto). <br><br>  Im Folgenden werden die Autonummern für die Möglichkeit der Veröffentlichung von Fotos im öffentlichen Bereich verwischt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mh/p7/z5/mhp7z5aebrmyfhgw-cack-fm8zi.png" alt="Bild"></div><br>  <i>Kennzeichnung des Fahrzeugdatensatzes</i> <br><br>  In Zukunft haben wir mit zwei Farbräumen - RGB und LAB - mit den Klassen 8 bzw. 810/81 gearbeitet.  Um die Ergebnisse verschiedener Ansätze zu vergleichen, haben wir 8 Klassen in RGB verwendet, um die Farbe zu bestimmen, die durch Teilen des BGR-Würfels in 8 gleiche kleine Würfel erhalten werden.  Sie können leicht als gebräuchliche Namen bezeichnet werden: weiß, schwarz, rot, grün, blau, pink, gelb, cyan.  Um den Fehler einer Methode zu bewerten, haben wir bereits den LAB-Farbraum verwendet, in dem der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abstand</a> zwischen den Farben bestimmt wird. <br><br>  Es gibt zwei intuitive Möglichkeiten, die Farbe anhand des <i>Farbfelds</i> zu bestimmen: mittlere oder mittlere Farbe.  Da sich im <i>Farbfeld</i> jedoch Pixel in verschiedenen Farben befinden, wollte ich wissen, wie genau jeder dieser beiden Ansätze funktioniert. <br><br>  Für 8 RGB-Farben für jedes <i>Farbfeld</i> jeder Maschine im Datensatz haben wir die durchschnittliche Pixelfarbe und den Median ermittelt. Die Ergebnisse sind in den folgenden Abbildungen dargestellt.  Die „wahren“ Farben sind in den Linien markiert, dh die Farben, die in den Spalten als Durchschnitt bzw. als Median definiert sind - Farben, die im Prinzip gefunden werden.  Beim Hinzufügen einer Maschine zur Tabelle wurde die Anzahl der Pixel jeder Farbe auf ihre Anzahl normalisiert, d. H. Die Summe aller der Zeile hinzugefügten Werte war gleich eins. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ic/q-/ep/icq-ep_xxwuaiuuec8bordv3_cu.png" alt="Bild"></div><br>  <i>Untersuchung der Genauigkeit der Bestimmung der Farbe einer Maschine als durchschnittliche Farbe der Pixelfarbe 'abox.</i>  <i>Durchschnittliche Genauigkeit: <b>75%</b></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/at/b3/wm/atb3wmizgurxd0gemdqiltoj62w.png" alt="Bild"></div><br>  <i>Untersuchung der Genauigkeit der Bestimmung der Farbe einer Maschine als Medianfarbe von Pixeln in einem Farbfeld.</i>  <i>Durchschnittliche Genauigkeit: <b>76%</b></i> <br><br>  Wie Sie sehen können, gibt es keinen besonderen Unterschied zwischen den Methoden, was auf ein gutes Markup hinweist.  In Zukunft haben wir den Median verwendet, weil er das beste Ergebnis zeigte. <br>  Die Farbe des Fahrzeugs wird anhand des Bereichs innerhalb des <i>Begrenzungsrahmens</i> des <i>Fahrzeugs bestimmt</i> . <br><br><h2>  <font color="#0071c5">Benötigen Sie Netzwerke?</font> </h2><br>  Die Frage ist unvermeidlich: Werden neuronale Netze wirklich benötigt, um eine intuitiv einfache Aufgabe zu lösen?  Vielleicht können Sie die mittlere oder mittlere Farbe von Pixeln in einem <i>Auto-Begrenzungsrahmen</i> auf die gleiche Weise nehmen?  Die folgenden Abbildungen zeigen das Ergebnis dieses Ansatzes.  Wie später gezeigt wird, ist es schlechter als das Verfahren unter Verwendung neuronaler Netze. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/an/bl/o8/anblo8jtdfojv3v7b1yd_bt5zzi.png" alt="Bild"></div><br>  <i>Die Verteilung des Anteils von Fahrzeugen mit dem L2-Fehlerwert im LAB-Bereich zwischen der als Durchschnitt definierten Farbfeldfarbe und der Fahrzeugbegrenzungsfeldfarbe des Wertes dieses Fehlers</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="Bild"></div><br>  <i>Verteilung des Anteils von Fahrzeugen mit dem L2-Fehlerwert im LAB-Raum zwischen dem als Median definierten Farbfeld und der Farbe des <i>Fahrzeugbegrenzungsrahmens</i> aus dem Wert dieses Fehlers</i> <br><br><h2>  <font color="#0071c5">Beschreibung der Herangehensweise an die Aufgabe</font> </h2><br>  In unserer Arbeit haben wir die Resnet-10-Architektur verwendet, um Funktionen hervorzuheben.  Um ein Label- und Multilabel-Problem zu lösen, wurden die Aktivierungsfunktionen von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Softmax</a> bzw. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sigmoid</a> ausgewählt. <br>  Ein wichtiges Thema war die Wahl der Metrik, anhand derer wir unsere Ergebnisse vergleichen konnten.  Bei Aufgaben mit einem Label können Sie die Klasse auswählen, die der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">maximalen Antwort entspricht</a> .  Eine solche Lösung funktioniert jedoch offensichtlich nicht bei Maschinen mit mehreren Etiketten / Farben, da argmax eine wahrscheinlichste Farbe erzeugt.  Die Metrik <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">L1</a> hängt von der Anzahl der Klassen ab und kann daher auch nicht zum Vergleich aller Ergebnisse verwendet werden.  Daher wurde beschlossen, die Flächenmetrik unter der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ROC-Kurve</a> (ROC AUC - Fläche unter der Kurve) als universell und allgemein anerkannt zu betrachten. <br><br>  Wir haben in zwei Farbräumen gearbeitet.  Das erste ist Standard- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">RGB</a> , in dem wir 8 Klassen ausgewählt haben: Wir haben den RGB-Würfel in 8 identische Subwürfel unterteilt: Weiß, Schwarz, Rot, Grün, Blau, Rosa, Gelb, Cyan.  Eine solche Aufteilung ist sehr grob, aber einfach. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vq/4z/pd/vq4zpd9edgxx4m9z0cnk-8jso2i.png" alt="Bild"></div><br>  <i>Teilen Sie den RGB-Farbraum in 8 Bereiche auf</i> <br><br>  Darüber hinaus haben wir Studien mit dem LAB-Farbraum durchgeführt, bei denen die Partition in 810 Klassen unterteilt wurde.  Warum so viel?  LAB wurde eingeführt, nachdem der amerikanische Wissenschaftler <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">David MacAdam</a> festgestellt hatte, dass es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Farbbereiche</a> gibt, die für das menschliche Auge nicht sichtbar sind ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">MacAdam-Ellipsen</a> ).  LAB wurde so gebaut, dass diese Ellipsen darin das Aussehen von Kreisen hatten (im Abschnitt konstanter L - Helligkeit). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-1/y5/q9/-1y5q9owfaqva2sd7sxy45auef0.png" alt="Bild"></div><br>  <i>MacAdam-Ellipsen und LAB-Farbraum ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quelle</a> )</i> <br><br>  Insgesamt gibt es 81 Kreise im Abschnitt solcher Kreise. Wir haben Schritt 10 in Bezug auf den Parameter L (von 0 bis 100) ausgeführt und 810 Klassen erhalten.  Zusätzlich führten wir ein Experiment mit einer Konstanten L und entsprechend 81 Klassen durch. <br><br><h2>  <font color="#0071c5">RGB und LAB</font> </h2><br>  Die folgenden Ergebnisse wurden für das 8-Klassen-Problem und den RGB-Raum erhalten: <br><table><tbody><tr><th>  Aktivierungsfunktion </th><th>  Multilabel-Aufgabe </th><th>  ROC AUC </th></tr><tr><td>  Softmax </td><td>  - - </td><td>  0,97 </td></tr><tr><td>  Sigmoid </td><td>  ✓ </td><td>  0,88 </td></tr></tbody></table>  <i>Farberkennungsergebnistabelle für Maschinen in einem 8-Klassen-Problem</i> <br><br>  Es scheint, dass das Ergebnis für die Multilabel-Aufgabe bereits recht gut ist.  Um diese Annahme zu überprüfen, haben wir eine Fehlermatrix erstellt, die 0,55 als Schwellenwert für die Wahrscheinlichkeit verwendet.  Das heißt,  Wenn dieser Wert in der Wahrscheinlichkeit für die entsprechende Farbe überschritten wird, gehen wir davon aus, dass die Maschine in dieser Farbe lackiert ist.  Trotz der Tatsache, dass der Schwellenwert niedrig genug gewählt wird, können typische Fehler bei der Bestimmung der Farbe des Autos gesehen und Schlussfolgerungen gezogen werden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5s/5q/9t/5s5q9tyt_8nbe4c0vb-mgxtoday.png" alt="Bild"></div><br>  <i>Farberkennungsergebnistabelle für Autos im Problem der 8. Klasse</i> <br><br>  Schauen Sie sich einfach die Linien an, die den Farben Grün oder Rosa entsprechen, um sicherzustellen, dass das Modell alles andere als perfekt ist.  Auf die Frage, warum mit einem großen metrischen Wert ein so seltsames erfolgloses Ergebnis erzielt wird, werden wir zurückkommen und sofort darauf hinweisen: Wenn nur 8 Klassen betrachtet werden, fällt eine große Anzahl von Farben in die Klassen „Weiß“ und „Schwarz“, daher ein solches Ergebnis . <br><br>  Deshalb werden wir uns dem LAB-Farbraum zuwenden und dort forschen. <br><table><tbody><tr><th>  Aktivierungsfunktion </th><th>  Multilabel-Aufgabe </th><th>  ROC AUC </th></tr><tr><td>  Softmax </td><td>  - - </td><td>  0,915 </td></tr><tr><td>  Sigmoid </td><td>  ✓ </td><td>  0,846 </td></tr></tbody></table>  <i>Maschinelle Farberkennungsergebnistabelle im Problem der 810-Klasse</i> <br><br>  Das Ergebnis ist geringer, was logisch ist, da die Anzahl der Klassen um zwei Größenordnungen gestiegen ist.  Ausgehend vom Sigmoid-Ergebnis haben wir versucht, unser Modell zu verbessern. <br><br><h2>  <font color="#0071c5">LAB: Experimente mit unterschiedlichen Gewichten</font> </h2><br>  Zuvor wurden alle Versuche mit Einheitsgewichten in der Verlustfunktion ( <i>Verlust</i> ) durchgeführt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ox/u5/af/oxu5afajo-qngyg1t6tdml1sdxo.png" alt="Bild"></div><br><br>  Hier ist GT Grundwahrheit, W ist Gewicht. <br><br>  Sie können eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entfernung in den</a> LAB-Farbraum eingeben.  Nehmen wir an, wir haben eine Einheit in GT.  Dann entspricht es einem rechteckigen Parallelepiped im LAB-Farbraum.  Dieses Parallelepiped (genauer gesagt sein Zentrum) wird in einem anderen Abstand von allen anderen Parallelepipeds (wiederum deren Zentren) entfernt.  Abhängig von dieser Entfernung können Sie mit den folgenden Skalen experimentieren: <br><br>  a) Null anstelle einer Einheit in GT, und wenn sie sich von ihr entfernt - eine Gewichtszunahme; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/in/ql/zsinql6ut3hucnr3ytrvkc0xxqi.png" alt="Bild"></div><br><br>  b) Umgekehrt ist es anstelle einer Einheit in GT eine Einheit, wenn sie entfernt wird, ist es ein Gewichtsverlust; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/-l/oo/8v-looj6mqsgrtzvz9elevykcak.png" alt="Bild"></div><br><br>  c) Option a) plus ein kleines Gaußsches Additiv mit einer Amplitude von ½ anstelle einer Einheit in GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/qy/ac/yxqyac6ks3cvy10qh6lilp4ib0q.png" alt="Bild"></div><br><br>  d) Option a) plus ein kleines Gaußsches Additiv mit einer Amplitude von 1 anstelle einer Einheit in GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ep/0s/01/ep0s01rau7n0oiak71zjkp5vhxg.png" alt="Bild"></div><br><br>  e) Option b) mit einem kleinen Additiv bei maximalem Abstand von der Einheit in GT. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ff/9q/ft/ff9qftnoidusfhdhz1p9jjoqwi0.png" alt="Bild"></div><br><br>  Die letzte Version der Skalen, mit denen wir Experimente durchgeführt haben, ist, wie wir es nannten, dreifaches Gauß, nämlich drei Normalverteilungen mit Zentren anstelle von Einheiten im GT sowie in größter Entfernung von ihnen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/jr/kb/qkjrkbhyxschjibmya3xt3hik9y.png" alt="Bild"></div><br>  <i>Drei Normalverteilungen konzentrierten sich auf die Einheiten im GT und in größter Entfernung von ihnen</i> <br><br>  Es muss genauer erklärt werden.  Sie können die beiden am weitesten entfernten Parallelepipeds und damit die Klassen auswählen und sie in der Entfernung vom Original vergleichen.  Für die Klasse, die der fernen entspricht, wird die Verteilungsamplitude auf 0,8 gesetzt, und für die zweite Klasse ist sie m-mal kleiner, wobei m das Verhältnis der Entfernung von der Quelle zur fernen Ferne zur Entfernung zwischen der Quelle und der nahen ist. <br><br>  Die Ergebnisse sind in der Tabelle aufgeführt.  Aufgrund der Tatsache, dass es in den Skalen von Option a) keine Gewichte gab - nur für Einheiten in GT war das Ergebnis noch schlechter als der Startpunkt, da das Netzwerk erfolgreiche Farbdefinitionen nicht berücksichtigte und schlechter lernte.  Die Varianten der Gewichte b) und e) stimmten praktisch überein, daher stimmte das Ergebnis auf ihnen überein.  Der größte Anstieg der Prozentpunkte gegenüber dem ursprünglichen Ergebnis wurde durch die Variante der Gewichte f) - Dreifachgauß gezeigt. <br><table><tbody><tr><th>  Aktivierungsfunktion </th><th>  Anzahl der Klassen </th><th>  Gewichtetyp </th><th>  ROC AUC </th></tr><tr><td rowspan="5">  Sigmoid </td><td rowspan="5">  810 </td><td>  a) </td><td>  0,844 </td></tr><tr><td>  b), e) </td><td>  0,848 </td></tr><tr><td>  c) </td><td>  0,888 </td></tr><tr><td>  d) </td><td>  0,879 </td></tr><tr><td>  f) </td><td>  0,909 </td></tr></tbody></table>  <i>Farberkennungsergebnisse von Maschinen der Klasse 810 mit unterschiedlichen Gewichtsoptionen</i> <br><br><h2>  <font color="#0071c5">LAB: Experimentieren mit neuen Labels</font> </h2><br>  Also haben wir Experimente mit unterschiedlichen Gewichtsgewichten durchgeführt.  Dann haben wir uns entschlossen, die Gewichte als eins zu belassen und die Beschriftungen zu ändern, die auf die Verlustfunktion übertragen werden und zur Optimierung des Netzwerks verwendet werden.  Wenn vorher die Bezeichnungen mit GT übereinstimmten, entschieden sie sich jetzt, wieder Gaußsche Verteilungen mit Zentren an der Stelle von Einheiten in GT zu verwenden: <br><br>  Die Motivation für diese Entscheidung ist wie folgt.  Tatsache ist, dass mit normalen Etiketten alle Autos in Datensätzen in eine feste Anzahl von Klassen fallen, weniger als 810, sodass das Netzwerk lernt, die Farbe von Autos nur dieser Klassen zu bestimmen.  Mit neuen Etiketten fallen Werte ungleich Null in alle Klassen, und wir können eine Erhöhung der Genauigkeit bei der Bestimmung der Farbe des Autos erwarten.  Wir haben mit zwei Sigma (Standardabweichungen) für die obigen Gaußschen Verteilungen experimentiert: 41,9 und 20,9.  Warum so?  Das erste Sigma wird wie folgt gewählt: Der Mindestabstand zwischen den Klassen (28) wird genommen und das Sigma wird aus der Bedingung bestimmt, dass die Verteilung in der Klasse neben dem GT'noye zweimal abnimmt.  Und das zweite Sigma ist nur zweimal kleiner als das erste. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jk/z4/xq/jkz4xqdkl-nwecfnttwzuhwgyuo.png" alt="Bild"></div><br>  <i>Verteilung von Autos mit Trainingsdatensätzen nach Klassen mit unterschiedlichen Verlustbezeichnungen</i> <br><br>  In der Tat war es möglich, das Ergebnis mit einem solchen Trick weiter zu verbessern, wie in der Tabelle gezeigt.  Als Ergebnis erreichte die Bestimmungsgenauigkeit 0,955! <br><table><tbody><tr><th>  Aktivierungsfunktion </th><th>  Anzahl der Klassen </th><th>  Etikettentyp </th><th>  Gewichtetyp </th><th>  ROC AUC </th></tr><tr><td rowspan="4">  Sigmoid </td><td rowspan="4">  810 </td><td>  üblich </td><td>  diejenigen </td><td>  0,846 </td></tr><tr><td>  üblich </td><td>  drei Gauß </td><td>  0,909 </td></tr><tr><td>  neu, σ <sub>1</sub> </td><td rowspan="2">  drei Gauß </td><td>  0,955 </td></tr><tr><td>  neu, σ <sub>2</sub> </td><td>  0,946 </td></tr></tbody></table>  <i>Farberkennungsergebnisse für Maschinen der Klasse 810: mit normalen Etiketten und Einheitsgewichten, mit normalen Etiketten und Gewichten in Form von dreifachem Gauß, mit neuen Etiketten und Einheitsgewichten</i> <br><br><h2>  <font color="#0071c5">LAB: 81</font> </h2><br>  Wenn wir über erfolglose Experimente sprechen, müssen wir den Versuch erwähnen, ein Netzwerk mit 81 Klassen und einem konstanten Parameter L zu trainieren. Bei früheren Experimenten haben wir festgestellt, dass die Helligkeit vom Netzwerk ziemlich genau bestimmt wird, und wir haben beschlossen, nur die Parameter a und b zu trainieren (so) nannte die anderen beiden Koordinaten in LAB).  Leider war die Idee, den Parameter L am Ausgang des Netzwerks als Durchschnitt für den <i>Begrenzungsrahmen</i> des <i>Autos festzulegen,</i> abgestürzt, und die tatsächliche Farbe und damit die definierte Farbe waren sehr unterschiedlich, obwohl das Netzwerk in der Lage war, perfekt im Flugzeug zu trainieren und einen größeren Wert in Bezug auf die Metrik zu zeigen. <br><br><h2>  <font color="#0071c5">Vergleich mit der Lösung eines Problems ohne Verwendung neuronaler Netze</font> </h2><br>  Kehren wir jetzt zum Anfang zurück und vergleichen wir, was mit uns passiert ist, mit der Erkennung der Farbe des Autos ohne Verwendung neuronaler Netze. <br>  Die Ergebnisse sind in den folgenden Abbildungen dargestellt.  Es ist zu sehen, dass der Peak dreimal so hoch geworden ist und die Anzahl der Autos mit einem großen Fehler zwischen der wahren und einer bestimmten Farbe erheblich abgenommen hat. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="Bild"></div><br>  <i>Die Verteilung des Anteils von Fahrzeugen mit dem L2-Fehlerwert im LAB-Raum zwischen dem als Median definierten Farbfarbbegrenzungsrahmen und der Fahrzeugbegrenzungsrahmenfarbe des Wertes dieses Fehlers</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6j/wr/b5/6jwrb5imhzh2rbvnaxrgzedf0p8.png" alt="Bild"></div><br>  <i>Verteilung des Anteils von Fahrzeugen mit dem L2-Fehlerwert im LAB-Raum zwischen der Farbe am Ausgang des neuronalen Netzes und der Farbe des Fahrzeugbegrenzungsrahmens des Werts dieses Fehlers</i> <br><br><h2>  <font color="#0071c5">Beispiele</font> </h2><br>  Das Folgende sind Beispiele für die Erkennung von Fahrzeugfarben.  Das erste ist, dass die schwarze Maschine (ein typischer Fall) als schwarz erkannt wird und der Abstand im LAB-Raum zwischen der wahren Farbe und der spezifischen (18.16) geringer ist als der Mindestabstand zwischen den Klassen (28).  In der zweiten Abbildung konnte das Netzwerk nicht nur feststellen, dass das Auto beleuchtet war (es besteht eine hohe Wahrscheinlichkeit, dass es einer der Klassen weißer Farben entspricht), sondern auch seine tatsächliche Farbe (Silber).  Die ebenfalls beleuchtete Maschine aus der folgenden Abbildung wurde vom Netzwerk jedoch nicht als rot erkannt.  Das Netzwerk konnte die Farbe des in der folgenden Abbildung gezeigten Autos nicht bestimmen, was sich aus der Tatsache ergibt, dass die Wahrscheinlichkeiten für alle Farben zu klein sind. <br><br>  In vielerlei Hinsicht war die Aufgabe auf die Notwendigkeit zurückzuführen, mehrfarbige Autos zu erkennen.  Die letzte Abbildung zeigt ein zweifarbiges schwarz-gelbes Auto.  Das Netzwerk erkannte am wahrscheinlichsten die schwarze Farbe, was wahrscheinlich auf das Überwiegen von Maschinen dieser und ähnlicher Farben im Trainingsdatensatz zurückzuführen ist, und die gelbe Farbe, die nahezu wahr ist, stieg in die Top 3 ein. <br><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/ro/l7/re/rol7re300p2hf30rtsvaiyfbi20.png" align="right" alt="Bild"></th><th><img src="https://habrastorage.org/webt/n8/ig/cl/n8igclilt4ep3qlmipvt9rmbt5w.png" align="left" alt="Bild"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/o5/pf/fj/o5pffjzvnat7mouv8yhf-kuzs3g.png" align="right" alt="Bild"></th><th><img src="https://habrastorage.org/webt/vn/ml/wa/vnmlwawbhys7tkvrwquwc6bttsw.png" align="left" alt="Bild"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/jh/mi/hs/jhmihs9rnoqounq2ostwq8iz1q0.png" align="right" alt="Bild"></th><th><img src="https://habrastorage.org/webt/pv/sg/ft/pvsgftesuo5lmmy_gvuzsj-rg4o.png" align="left" alt="Bild"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/f7/uj/p3/f7ujp3uavgqz6aobfa_hbk6xpos.png" align="right" alt="Bild"></th><th><img src="https://habrastorage.org/webt/0c/mo/l1/0cmol16qj3ghtsc49jqag2dy8yc.png" align="left" alt="Bild"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/dd/hi/th/ddhithwwjdez_q6sr8xa9cwcs-i.png" align="right" alt="Bild"></th><th><img src="https://habrastorage.org/webt/gg/hf/px/gghfpxgurqddwvldmop4t1zszfo.png" align="left" alt="Bild"></th></tr></tbody></table><br><h2>  <font color="#0071c5">ROC-Kurve: Visualisierung und Probleme</font> </h2><br>  Am Ausgang haben wir also ein ziemlich hohes metrisches Ergebnis erhalten.  Die folgende Abbildung zeigt ROC-Kurven zum Lösen eines Problems mit 8 Klassen und für ein Problem mit 810 Klassen sowie Lösungen ohne Verwendung neuronaler Netze.  Es ist ersichtlich, dass das Ergebnis geringfügig von dem zuvor ausgeschriebenen abweicht.  Die vorherigen Ergebnisse wurden mit TensorFlow erhalten, die folgenden Grafiken wurden mit dem Scikit-Learn-Paket erhalten. <br><table><tbody><tr><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/zm/ib/yqzmib4v_0jaco5torqqvu0fdmo.png" alt="Bild"></div></th><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/k0/nb/gn/k0nbgn7ows7rcx-q3so38ugg_dw.png" alt="Bild"></div></th></tr></tbody></table>  <i>ROC-Kurve für verschiedene Optionen zur Lösung des Problems.</i>  <i>Rechts ist die obere linke Ecke des linken Diagramms</i> <br><br>  Sie können beliebige feste Zahlen als Schwellenwerte verwenden (z. B. nimmt Tensorflow, wenn Sie den entsprechenden Parameter auf 50 setzen, in gleichen Intervallen die gleiche Anzahl von Schwellenwerten von 0 bis 1 an), Sie können die Werte am Ausgang des Netzwerks verwenden oder sie von unten einschränken, um sie nicht zu berücksichtigen zum Beispiel Werte in der Größenordnung von 10 <sup>-4</sup> .  Das Ergebnis des letzteren Ansatzes ist in der folgenden Abbildung dargestellt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fb/2c/b2/fb2cb2dxnaxvjjtywmlbdb-xs54.png" alt="Bild"></div><br>  <i>ROC-Kurve für mehrere Optionen zur Lösung des Problems mit einem Schwellenwert von 10 <sup>-4</sup></i> <br><br>  Es ist ersichtlich, dass alle Kurven, die der Lösung des Problems unter Verwendung neuronaler Netze entsprechen, charakteristischerweise besser (höher) sind als die Lösung des Problems ohne sie, aber Sie können nicht die definitiv beste Kurve zwischen den ersten wählen.  Je nachdem, welchen Schwellenwert der Benutzer wählt, entsprechen unterschiedliche Kurven unterschiedlichen optimalen Lösungen für das Problem.  Daher haben wir einerseits einen Ansatz gefunden, der es uns ermöglicht, die Farbe der Maschine genau zu bestimmen und eine hohe Metrik zu zeigen, andererseits haben wir gezeigt, dass die Grenze noch nicht erreicht wurde und die Metrik der Fläche unter der ROC-Kurve ihre Nachteile hat. <br><br>  Bereit, Fragen zu beantworten und Kommentare in den Kommentaren anzuhören. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de422689/">https://habr.com/ru/post/de422689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de422679/index.html">Imaginäre Probleme - der Grund für schlechte Software</a></li>
<li><a href="../de422681/index.html">SAP- und Python-Integration oder einfacheres Abrufen von Daten aus SAP</a></li>
<li><a href="../de422683/index.html">In den USA gründeten zwei Händler eine gefälschte Maklerfirma, um Geld von unerfahrenen Investoren zu stehlen</a></li>
<li><a href="../de422685/index.html">Smart Watch Samsung Galaxy Watch: Upgrade von Android Wear OS auf Tizen OS - persönliche Erfahrung</a></li>
<li><a href="../de422687/index.html">Boten in Gefahr</a></li>
<li><a href="../de422691/index.html">Die Hybridkamera und das Lidar verbessern die Fähigkeiten von Robomobilen und ergänzen Informationen über die Außenwelt</a></li>
<li><a href="../de422693/index.html">Plugin-Team zum Konfigurieren von JavaFX-Komponenten in einer Desktop-Anwendung</a></li>
<li><a href="../de422697/index.html">Webpack 4 und Aufteilen der Konfigurationsdatei in Module</a></li>
<li><a href="../de422699/index.html">Eine geschlossene Lücke bestätigt die Unwirklichkeit der Quantenwelt</a></li>
<li><a href="../de422701/index.html">Deep Learning und OpenVINO Toolkit. Stellen Sie eine Frage an einen Intel-Experten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>