<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏼‍💻 🚺 🐌 Tingkatkan kepadatan kontainer pada suatu simpul menggunakan teknologi PFCACHE 👰🏻 🤙🏽 👨🏻‍🍳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salah satu tujuan penyedia hosting adalah pembuangan peralatan yang ada semaksimal mungkin untuk memberikan layanan berkualitas kepada pengguna akhir....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tingkatkan kepadatan kontainer pada suatu simpul menggunakan teknologi PFCACHE</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rusonyx/blog/444696/"><img src="https://habrastorage.org/webt/a-/fc/i7/a-fci74gdtqxnzgdn7b_q41lr3k.jpeg"><br><br>  Salah satu tujuan penyedia hosting adalah pembuangan peralatan yang ada semaksimal mungkin untuk memberikan layanan berkualitas kepada pengguna akhir.  Sumber daya dari server akhir selalu terbatas, namun, jumlah layanan klien yang dihosting, dan dalam kasus kami, kami berbicara tentang VPS, dapat sangat bervariasi.  Baca tentang cara mendapatkan pohon Natal dan makan burger di bawah kucing. <a name="habracut"></a><br><br>  Mengkonsolidasikan VPS pada sebuah node sedemikian rupa sehingga klien tidak merasa ini sama sekali membantu banyak untuk meningkatkan kinerja ekonomi penyedia hosting.  Tentu saja, sebuah simpul tidak boleh retak pada lapisan jika kontainer dijejalkan ke bola mata, dan semua klien segera merasakan adanya lonjakan beban. <br><br>  <b>Berapa banyak VPS dapat ditempatkan pada satu node tergantung pada banyak faktor, seperti jelas:</b> <br><br><ol><li>  Karakteristik besi dari simpul itu sendiri </li><li>  Ukuran VPS </li><li>  Pola pemuatan VPS </li><li>  Teknologi Perangkat Lunak Yang Membantu Mengoptimalkan Kepadatan </li></ol><br>  Dalam hal ini, kami akan membagikan pengalaman kami menggunakan teknologi Pfcache untuk Virtuozzo. <br>  Kami menggunakan cabang ke-6, tetapi semua yang dikatakan benar untuk cabang ke-7. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pfcache</a> adalah mekanisme Virtuozzo yang membantu menduplikasi IOPS dan RAM dalam wadah, mengalokasikan file yang sama dalam wadah ke zona bersama yang terpisah. <br><br>  <b>Bahkan, itu terdiri dari:</b> <br><br><ol><li>  Kode kernel </li><li>  Daemon ruang pengguna </li><li>  Utilitas ruang pengguna </li></ol><br>  Di sisi simpul, kami menyoroti seluruh bagian di mana file akan dibuat bahwa semua VPS pada node akan langsung digunakan.  Perangkat ploop block sudah terpasang di bagian ini.  Selanjutnya, pada awal wadah, menerima referensi ke bagian ini: <br><br><pre><code class="plaintext hljs">[root@pcs13 ~]# cat /proc/mounts ... /dev/ploop62124p1 /vz/pfcache ext4 rw,relatime,barrier=1,data=ordered,balloon_ino=12 0 0 ... /dev/ploop22927p1 /vz/root/418 ext4 rw,relatime,barrier=1,data=ordered,balloon_ino=12,pfcache_csum,pfcache=/vz/pfcache 0 0 /dev/ploop29642p1 /vz/root/264 ext4 rw,relatime,barrier=1,data=ordered,balloon_ino=12,pfcache_csum,pfcache=/vz/pfcache 0 0 ...</code> </pre> <br>  Berikut ini contoh statistik jumlah file pada salah satu node kami: <br><br><pre> <code class="plaintext hljs">[root@pcs13 ~]# find /vz/pfcache -type f | wc -l 45851 [root@pcs13 ~]# du -sck -h /vz/pfcache 2.4G /vz/pfcache 2.4G total</code> </pre><br>  <b>Prinsip pfcache adalah sebagai berikut:</b> <br><br><ul><li>  Daemon ruang-pengguna Pfcached menentukan hash sha-1 file dalam atribut xattr dari file ini.  File tidak diproses semua, tetapi hanya di direktori / usr, / bin, / usr / sbin, / sbin, / lib, / lib64 </li><li>  Kemungkinan besar file dalam direktori ini akan "dibagikan" dan akan digunakan oleh beberapa kontainer; </li><li>  Pfcached secara berkala mengumpulkan statistik tentang membaca file dari kernel, menganalisisnya, dan menambahkan file ke cache jika penggunaannya sering; </li><li>  Direktori ini mungkin berbeda, dan dikonfigurasikan dalam file konfigurasi. </li><li>  Saat membaca file, diperiksa apakah berisi hash yang ditentukan dalam atribut xattr yang diperluas.  Jika berisi, file "umum" dibuka, bukan file kontainer.  Substitusi ini terjadi tanpa disadari oleh kode kontainer, dan bersembunyi di kernel; </li><li>  Saat menulis ke file, hash tidak valid.  Dengan demikian, pada pembukaan berikutnya, file kontainer akan dibuka langsung, dan bukan cache-nya. </li></ul><br>  Dengan menyimpan file yang dibagikan dalam cache halaman dari / vz / pfcache, kami menyimpan cache ini dan juga menyimpan IOPS. Alih-alih membaca sepuluh file dari disk, kami membaca file yang langsung masuk ke cache halaman. <br><br><pre> <code class="plaintext hljs">struct inode { ... struct file *i_peer_file; ... }; struct address_space { ... struct list_head i_peer_list; ... }</code> </pre><br>  Daftar VMA untuk file tetap sama (memori deduplicate) dan lebih jarang membaca dari disk (save iops).  "Dana bersama" kami di-host di SSD - keuntungan tambahan dalam kecepatan. <br><br>  Contoh untuk caching file / bin / bash: <br><br><pre> <code class="plaintext hljs">[root@pcs13 ~]# ls -li /vz/root/2388/bin/bash 524650 -rwxr-xr-x 1 root root 1021112 Oct 7 2018 /vz/root/2388/bin/bash [root@pcs13 ~]# pfcache dump /vz/root/2388 | grep 524650 8e3aa19fdc42e87659746f6dc8ea3af74ab30362 i:524650 g:1357611108 f:CP [root@pcs13 ~]# sha1sum /vz/root/2388/bin/bash 8e3aa19fdc42e87659746f6dc8ea3af74ab30362 /vz/root/2388/bin/bash [root@pcs13 /]# getfattr -ntrusted.pfcache /vz/root/2388/bin/bash # file: vz/root/2388/bin/bash trusted.pfcache="8e3aa19fdc42e87659746f6dc8ea3af74ab30362" [root@pcs13 ~]# sha1sum /vz/pfcache/8e/3aa19fdc42e87659746f6dc8ea3af74ab30362 8e3aa19fdc42e87659746f6dc8ea3af74ab30362 /vz/pfcache/8e/3aa19fdc42e87659746f6dc8ea3af74ab30362</code> </pre><br>  Kami menghitung efisiensi penggunaan dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">skrip yang sudah jadi</a> . <br><br>  Script ini melewati semua kontainer pada node, menghitung file cache dari masing-masing container. <br><br><pre> <code class="plaintext hljs">[root@pcs16 ~]# /pcs/distr/pfcache-examine.pl ... Pfcache cache uses 831 MB of memory Total use of pfcached files in containers is 39837 MB of memory Pfcache effectiveness: 39006 MB</code> </pre><br>  Jadi, kami menyimpan sekitar 40 gigabytes file dalam wadah dari memori, mereka akan dimuat dari cache. <br><br>  Agar mekanisme ini bekerja lebih baik, perlu untuk menempatkan VPS "identik" maksimum pada node.  Sebagai contoh, mereka yang pengguna tidak memiliki akses root dan di mana lingkungan dari gambar diperluas dikonfigurasi. <br><br>  Anda dapat mengatur operasi pfcache melalui file konfigurasi <br>  /etc/vz/pfcache.conf <br><br>  MINSIZE, MAXSIZE - ukuran file minimum / maksimum untuk caching <br>  TIMEOUT - batas waktu antara upaya cache <br><br>  Daftar parameter lengkap dapat ditemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di tautan</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id444696/">https://habr.com/ru/post/id444696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id444686/index.html">Waves Smart Asset: Daftar Hitam dan Putih, Perdagangan Interval</a></li>
<li><a href="../id444688/index.html">Tolong berhenti berbicara tentang template Repositori dengan Eloquent</a></li>
<li><a href="../id444690/index.html">Bagaimana peneliti Uber menerapkan dan mengukur pengetahuan perilaku manusia</a></li>
<li><a href="../id444692/index.html">MOSDROID # 16 Sulphur di Redmadrobot</a></li>
<li><a href="../id444694/index.html">Seperti yang kami prediksi arus keluar, mendekatinya sebagai bencana alam</a></li>
<li><a href="../id444700/index.html">Basis data acak. Kualitas Data Oracle Enterprise - Perisai dan Pedang untuk Penyimpanan Perusahaan</a></li>
<li><a href="../id444704/index.html">Peluang nanoCAD SPDS Situs konstruksi dalam proyek konstruksi dan rekonstruksi dalam kondisi sempit</a></li>
<li><a href="../id444706/index.html">Foto Facebook 3D Di Dalam: Parallax Shaders</a></li>
<li><a href="../id444708/index.html">Aplikasi PentQL dengan GraphQL</a></li>
<li><a href="../id444710/index.html">Memahami Protokol Konsensus Stellar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>