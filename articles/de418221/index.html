<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎼 👨🏼‍⚖️ 🧤 MIT-Kurs "Computer Systems Security". Vorlesung 6: „Chancen“, Teil 3 👨🏼‍🌾 🚺 🏇🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Massachusetts Institute of Technology. Vorlesung # 6.858. "Sicherheit von Computersystemen." Nikolai Zeldovich, James Mickens. 2014 Jahr 
 Computer Sy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MIT-Kurs "Computer Systems Security". Vorlesung 6: „Chancen“, Teil 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418221/"><h3>  Massachusetts Institute of Technology.  Vorlesung # 6.858.  "Sicherheit von Computersystemen."  Nikolai Zeldovich, James Mickens.  2014 Jahr </h3><br>  Computer Systems Security ist ein Kurs zur Entwicklung und Implementierung sicherer Computersysteme.  Die Vorträge behandeln Bedrohungsmodelle, Angriffe, die die Sicherheit gefährden, und Sicherheitstechniken, die auf jüngsten wissenschaftlichen Arbeiten basieren.  Zu den Themen gehören Betriebssystemsicherheit, Funktionen, Informationsflussmanagement, Sprachsicherheit, Netzwerkprotokolle, Hardwaresicherheit und Sicherheit von Webanwendungen. <br><br>  Vorlesung 1: „Einführung: Bedrohungsmodelle“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 2: „Kontrolle von Hackerangriffen“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 3: „Pufferüberläufe: Exploits und Schutz“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 4: „Trennung von Privilegien“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 5: „Woher kommen Sicherheitssysteme?“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> <br>  Vorlesung 6: „Chancen“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <a name="habracut"></a><br><br>  <b>Zielgruppe:</b> Wenn diese <b>UID</b> nur Lesezugriff auf diese Datei bietet und Sie auch über einen Dateideskriptor verfügen, können Sie dann die Berechtigung zum Lesen dieser Datei erhalten, wenn Sie die <b>UID</b> verlieren? <br><br>  <b>Professor:</b> Ja, da es in Katalogen erscheinen wird.  Denn sobald Sie die Funktion zur Datei hinzufügen, ist es soweit.  Es steht Ihnen mit besonderen Privilegien usw. offen.  Das Problem ist jedoch, dass sie dieses hybride Design haben. <br><br>  Das heißt, sie sagen - Sie können Verzeichnissen wirklich Funktionen hinzufügen und eine neue Datei öffnen, während Sie parallel arbeiten.  Möglicherweise fügen Sie die Funktion einem Verzeichnis wie <b>/ etc hinzu</b> , haben jedoch keinen obligatorischen Zugriff auf alle Dateien im Verzeichnis <b>/ etc.</b>  Sobald Sie jedoch in den Funktionsmodus wechseln, können Sie versuchen, diese Dateien zu öffnen, da Sie wissen, dass Sie Zugriff auf das Verzeichnis <b>/ etc haben</b> .  Immerhin ist es bereits geöffnet. Warum geben Sie mir keine Datei mit dem Namen <b>"Passwort"</b> in diesem Verzeichnis? <br><br><img src="https://habrastorage.org/webt/8y/ew/2d/8yew2dwzcw7lpgl31ttm1ayzj6g.jpeg"><br><br>  Und dann muss der Kernel entscheiden, ob Sie die Datei in diesem Verzeichnis im Lese- oder Schreibmodus öffnen dürfen oder was Sie haben.  Ich denke, dies ist der einzige Ort, an dem Sie dieses externe Privileg noch benötigen, da sie versucht haben, ein kompatibles Design zu erstellen, bei dem sie nicht zu natürliche Semantik verwendeten, um den Betrieb von Verzeichnissen zu beschreiben.  Dies scheint der einzige Ort zu sein, an dem die Prinzipien zum Einrichten eines <b>Unix-</b> Dateisystems erhalten bleiben. <br><br>  <b>Teilnehmerin:</b> Gibt es noch andere solche Orte? <br><br>  <b>Professor:</b> gute Frage.  Ich denke, ich muss ihren vorherigen Quellcode abrufen, um herauszufinden, was passiert, aber die meisten anderen Situationen erfordern keine <b>UID-</b> Überprüfung.  Weil es zum Beispiel nicht für Netzwerke verwendet wird.  Dies sind wahrscheinlich die üblichen Dateisystemvorgänge. Wenn Sie ein gemeinsam genutztes Speichersegment haben, öffnen Sie es einfach und fertig. <br><br>  <b>Zielgruppe:</b> Können Sie bitte noch einmal erklären, wie genau die Benutzer-ID lautet, wenn Sie über die Funktion " <b>Fähigkeit"</b> verfügen? <br><br>  <b>Professor:</b> Dies ist wichtig, wenn Sie die Möglichkeit haben, zu katalogisieren.  Die Frage ist, was bietet Ihnen diese Gelegenheit?  Betrachten Sie eine Interpretation, zum Beispiel den Status der Fähigkeiten eines sauberen Systems, nicht <b>Capsicum</b> .  Wenn Sie in einem solchen System die Möglichkeit haben, ein Verzeichnis zu erstellen, haben Sie bedingungslosen Zugriff auf alle Dateien in diesem Verzeichnis. <br><br>  Unter <b>Unix ist</b> dies normalerweise nicht der Fall.  Sie können das Verzeichnis als <b>/ etc</b> öffnen, es enthält jedoch viele Systemdateien, in denen vertrauliche Informationen gespeichert werden können, z. B. der private Schlüssel des Servers.  Die Tatsache, dass Sie dieses Verzeichnis öffnen und durchblättern können, bedeutet nicht, dass Sie keine Dateien in diesem Verzeichnis öffnen können.  Wenn Sie also Zugriff auf das Verzeichnis haben, haben Sie Zugriff auf die Dateien. <br><br>  Wenn Sie in <b>Capsicum</b> das Verzeichnis <b>/ etc</b> öffnen und dann in den Funktionsmodus wechseln, geschieht Folgendes.  Sie sagen: „Ich weiß nicht, was dieses Verzeichnis ist.  Ich füge nur einen Dateideskriptor hinzu. "  Es gibt eine Datei namens "Schlüssel".  Warum öffnen Sie diese Datei nicht <b>"Schlüssel"</b> ?  Nur weil Sie in diesem Moment wahrscheinlich nicht möchten, dass dieser funktionsbasierte Prozess diese Datei öffnet, weil Sie sie nicht benötigen.  Auf diese Weise können Sie jedoch <b>Unix-</b> Berechtigungen für die Datei umgehen. <br><br>  Daher denke ich, dass die Autoren dieses Artikels die Entwicklung eines Systems, das bestehende Sicherheitsmechanismen nicht verletzt, sorgfältig angegangen sind. <br><br>  <b>Teilnehmerin:</b> Das heißt, Sie sagen, dass Sie in einigen Fällen eine Kombination dieser beiden Sicherheitsfaktoren verwenden können?  Das heißt, obwohl der Benutzer die Datei im Verzeichnis ändern kann, hängt es von seiner Benutzer-ID ab, auf welche Dateien er zugreift. <br><br>  <b>Professor:</b> Ja genau.  In der Praxis müssen Sie in <b>Capsicum</b> vor dem Wechseln in den Funktionsmodus erraten, welche Dateien Sie möglicherweise später benötigen.  Möglicherweise benötigen Sie gemeinsam genutzte Bibliotheken, Textdateien, Vorlagen, Netzwerkverbindungen usw.  Deshalb öffnen Sie dies alles im Voraus.  Und es ist nicht immer notwendig zu wissen, welche Datei Sie benötigen.  Also haben diese Leute es so gemacht, dass Sie einfach den Dateideskriptor des Verzeichnisses öffnen und die Dateien anzeigen können, die Sie später benötigen.  Es kann jedoch sein, dass diese Dateien nicht über dieselben Berechtigungen verfügen wie Sie.  Genau aus diesem Grund wird eine Kombination aus zwei Sicherheitsfaktoren verwendet - Überprüfung der Funktionen und der Benutzer- <b>UID</b> .  Dies ist also Teil des Kernel-Mechanismus. <br><br><img src="https://habrastorage.org/webt/xk/zu/ea/xkzueav2oq8qjqezg3f7hrzvemc.jpeg"><br><br>  Warum brauchen sie eine Bibliothek wie <b>libcapsicum</b> ?  Ich denke, es gibt zwei wichtige Dinge, die sie in dieser Bibliothek unterstützen. <br><br>  Eine davon ist, dass sie eine Funktion namens <b>lch_start implementieren</b> , die Sie anstelle der Funktion <b>cap_enter</b> verwenden sollten.  Eine weitere Funktion von <b>libcapsicum</b> ist das Konzept von fd-Listen, mit denen Dateideskriptoren nach Zahlen übergeben werden.  Der Zweck dieser <b>FD-Listen ist</b> leicht zu erklären.  Dies ist im Grunde eine Verallgemeinerung der Verwaltung und Übergabe von Dateideskriptoren durch <b>Unix</b> zwischen Prozessen.  Unter herkömmlichem <b>Unix</b> und <b>Linux</b> , das Sie heute verwenden, werden beim Starten des Prozesses einige Dateideskriptoren an dieses übergeben.  Sie öffnen einfach einige Dateideskriptoren mit ganzzahligen Werten aus dieser Tabelle und starten den untergeordneten Prozess, den Sie benötigen.  Oder Sie führen eine bestimmte Binärdatei aus, die alle diese offenen Slots in der <b>fd-</b> Tabelle erbt.  Es gibt jedoch keinen anderen guten Weg, diese Dinge zu benennen, als Zahlen als Namen zu verwenden. <br><br>  Stellen Sie sich ein Beispiel vor, in dem Steckplatz 0 für die Eingabe, Steckplatz 1 für die Ausgabe und Steckplatz 2 für das Drucken von Fehlermeldungen verwendet wird.  So funktioniert es unter <b>Unix</b> .  Und es funktioniert gut, wenn Sie nur diese drei Dateien oder drei Datenströme in den Prozess übertragen. <br><br><img src="https://habrastorage.org/webt/bn/kq/yt/bnkqytvftq_0clyfqaqlqmwlfbs.jpeg"><br><br>  In <b>Capsicum kommt es jedoch</b> vor, dass Sie viel mehr Dateideskriptoren in Ihrem Pfad „durchgehen“.  Wenn Sie also einen Dateideskriptor für einige Dateien übergeben, durchlaufen Sie einen Dateideskriptor für eine Netzwerkverbindung, einen Deskriptor für eine gemeinsam genutzte Bibliothek und so weiter.  Das Verwalten all dieser Nummern ist ziemlich mühsam.  Daher bietet <b>libcapsicum</b> tatsächlich die Möglichkeit, den Namen dieser früheren Dateideskriptoren zwischen Prozessen unter Verwendung eines hierarchischen Namens zu abstrahieren, der anstelle dieser obskuren Ganzzahlen verwendet wird. <br>  Dies ist eines der einfachen Dinge, die sie in ihrer Bibliothek bereitstellen.  Damit ich den Dateideskriptor an den Prozess übergeben und ihm einen Namen geben kann, spielt es keine Rolle, welche Nummer angegeben ist.  Diese Methode ist viel einfacher. <br><br>  Sie haben noch einen weiteren, komplizierteren Sandbox-Startmechanismus.  Dies ist <b>lch</b> , die Sandbox-Host- <b>API</b> , die verwendet wird, anstatt nur in den Modus für Funktionsfunktionen zu wechseln.  Warum brauchten sie mehr als einen einfachen Einstieg in einen Opportunity-Modus?  Was stört Sie normalerweise beim Erstellen einer Sandbox? <br><br>  <b>Zielgruppe:</b> Wahrscheinlich löscht <b>lch</b> alle geerbten Dinge, um einen "sauberen" Start des Systems zu gewährleisten. <br><br>  <b>Professor:</b> Ja.  Ich denke, dass sie sich Sorgen machen, alles zu berücksichtigen, auf das die Sandbox Zugriff hat.  Die Sache ist, wenn Sie nur <b>cap_enter</b> auf der Ebene des <b>Kernelmechanismus</b> aufrufen, wird es funktionieren.  Richtig?  Es verhindert nur, dass Sie neue Möglichkeiten entdecken. <br><br>  Das Problem ist jedoch, dass möglicherweise viele Dinge vorhanden sind, auf die der Prozess bereits Zugriff hat. <br><br>  Daher denke ich, dass das einfachste Beispiel das Vorhandensein offener Dateideskriptoren ist, die Sie vergessen haben, und die einfach von diesem Prozess vererbt werden. <br><br><img src="https://habrastorage.org/webt/td/yv/dd/tdyvddlujfmx8gudizztmw9n5gm.jpeg"><br><br>  Zum Beispiel betrachteten sie <b>tcpdump</b> .  Zuerst haben sie <b>tcpdump</b> geändert, indem sie einfach <b>cap_enter aufgerufen haben,</b> noch bevor sie alle eingehenden Netzwerkverbindungen analysieren <b>wollten</b> .  In gewisser Weise funktioniert dies gut, da Sie nicht mehr <b>Capability-</b> Funktionen erhalten können.  Beim Betrachten des Deskriptors für geöffnete Dateien wurde ihnen jedoch klar, dass Sie vollen Zugriff auf das Benutzerterminal haben, da Sie einen Deskriptor für offene Dateien dafür haben.  Damit können Sie alle vom Benutzer ausgeführten Tastenanschläge und dergleichen abfangen.  Das ist also wahrscheinlich kein guter Plan für <b>tcpdump</b> .  Weil Sie nicht möchten, dass jemand Ihre Tastaturaktivität abfängt. <br><br>  Daher haben sie im Fall von <b>tcpdump</b> die Dateideskriptoren manuell geändert und ihnen einige Funktionen hinzugefügt, um die Arten von Vorgängen einzuschränken, die Sie ausführen können.  Wenn Sie sich erinnern, enthält die Funktion in <b>Capsicum</b> auch diese zusätzlichen Bits, die die Klasse von Operationen angeben, die für einen bestimmten Dateideskriptor ausgeführt werden können.  Daher nehmen sie grundsätzlich an, dass der Dateideskriptor 0 ist. Er zeigt auf das tty-Benutzerterminal.  Anfangs war es nur ein direkter Zeiger auf die <b>tty-</b> Struktur im Kernel.  Um die Art der Operationen zu begrenzen, die für diesen Deskriptor ausgeführt werden können, haben sie in der Mitte eine Zwischen-Beta-Struktur der Funktionen eingeführt.  Daher verweist der Dateideskriptor auf diese Funktionsstruktur und bereits auf die reale Datei, auf die Sie zugreifen möchten.  Und diese Fähigkeitsstruktur enthält einige einschränkende Bits oder Berechtigungen für ein Dateideskriptorobjekt, die implementiert werden können. <br><br>  Daher können Sie mit der Standarddateneingabe in <b>tcpdump</b> nichts damit anfangen.  Sie können nur sehen, dass es existiert, und das ist es.  Für den Ausgabedateideskriptor bot sich die Möglichkeit, etwas darauf zu schreiben, den Datensatz jedoch nicht zu ändern, dh die vorgenommenen Änderungen können nicht abgebrochen werden. <br><br><img src="https://habrastorage.org/webt/cg/-4/p5/cg-4p5ivw8r8yde-rotszxgxn2a.jpeg"><br><br>  Was könnten Sie sich sonst noch Sorgen machen, wenn Sie <b>die Sandbox</b> starten?  Ich denke über den Status des Dateideskriptors nach.  Ist noch etwas wichtig?  Ich denke unter <b>Unix</b> sind dies Dateideskriptoren und Speicher. <br><br>  Eine andere Sache ist, dass diese Leute besorgt sind, dass in Ihrem Adressraum möglicherweise vertrauliche Daten früher zugewiesen werden.  Und der Prozess, den Sie in der Sandbox isolieren möchten, kann den gesamten verfügbaren Speicher lesen.  Wenn es also ein Kennwort gibt, das Sie zuvor überprüft haben, wenn sich der Benutzer anmeldet und Sie den Speicher noch nicht gelöscht haben, kann dieser Prozess es lesen und etwas „Interessantes“ tun. <br><br>  Sie haben dieses Problem folgendermaßen gelöst: In <b>lch_start müssen</b> Sie ein "frisches" Programm ausführen.  Sie nehmen das Programm und packen alle Argumente, alle Dateideskriptoren, die Sie ihm bereitstellen möchten.  Anschließend starten Sie einen neuen Prozess oder starten die Neuinitialisierung des gesamten virtuellen Speicherbereichs.  Und dann besteht kein Zweifel daran, dass dieser Prozess keine zusätzlichen Berechtigungen erhält, die sich auf den Satz vertraulicher Daten auswirken.  Dies ist genau das, was Sie in Bezug auf <b>Binärnamen</b> , Argumente und Programmfunktionen an die Funktion <b>lch_start übergeben</b> haben. <br><br>  <b>Zielgruppe:</b> Was passiert, wenn der von Ihnen gestartete Prozess binäre <b>setuid = 0 enthält</b> ? <br><br>  <b>Professor:</b> Ich denke, diese Leute verwenden im Feature-Modus keine <b>Setuid-</b> Binärdateien, um seltsame Interaktionen zu vermeiden, die auftreten können.  Sie implementieren diese Regel: Sie können ein <b>setuid-</b> Programm haben, das seine Berechtigungen von der <b>setuid-</b> Binärdatei erhält, und dann <b>cap_enter</b> oder <b>lch_start aufrufen</b> .  Sobald Sie jedoch in den Funktionsmodus wechseln, können Sie keine zusätzlichen Einstellungen wiederherstellen. <br><br>  Im Prinzip könnte dies funktionieren, aber es wäre sehr seltsam.  Wenn Sie sich erinnern, ist die <b>UID</b> im Feature-Modus nur wichtig, wenn Sie Dateien in einem Verzeichnis öffnen.  Daher ist unklar, ob dies wirklich ein großartiger Plan für zusätzliche Privilegien ist oder ob es Mängel gibt. <br><br>  <b>Teilnehmerin:</b> Zuvor haben wir darüber gesprochen, warum die Bibliothek eine strikte Trennung zwischen den beiden Sicherheitsfaktoren nicht wirklich unterstützt.  Aber wir müssen <b>lch_start</b> nicht verwenden? <br><br>  <b>Professor:</b> Das stimmt.  Angenommen, Sie haben etwas wie <b>tcpdump</b> oder <b>gzip</b> - dies ist eine andere Sache, mit der sie arbeiten.  Sie gehen davon aus, dass die Anwendung wahrscheinlich nicht gefährdet ist, und es gibt einige grundlegende Funktionen der Anwendung, und Sie kümmern sich darum, wie sie sich in der Sandbox verhält.  Im Fall von <b>tcpdump werden</b> Pakete aus dem Netzwerk analysiert, im Fall von <b>gzip werden</b> Dateien entpackt.  Und bis zu einem gewissen Punkt gehen Sie davon aus, dass der Prozess alles richtig macht und es keine Schwachstellen gibt.  Daher vertrauen Sie <b>darauf</b> , dass er <b>lch_start ausführt</b> und glaubt, dass er das Image korrekt erstellt, alle Funktionen korrekt konfiguriert und sich dann auf weitere Systemaufrufe außerhalb des Funktionsmodus beschränkt. <br><br>  Und dann starten Sie gefährliche Dinge.  Aber bis dahin war die Installation korrekt und Sie haben keine Möglichkeit, aus dieser Sandbox herauszukommen.  Ich denke, Sie müssen sehen, wie Sie den Funktionsmodus für Sandbox-Anwendungen tatsächlich verwenden können. <br><br>  Also haben wir ein bisschen über <b>tcpdump gesprochen</b> .  Wie isolieren Sie diesen Prozess?  Ein weiteres interessantes Beispiel ist das Programm <b>gzip</b> , das Dateien komprimiert und dekomprimiert.  Warum machen sie sich also Sorgen um den Sandkasten?  Ich denke, sie befürchten, dass der Dekomprimierungscode möglicherweise fehlerhaft ist oder dass Fehler bei der Speicherverwaltung, der Pufferverwaltung während der Dekomprimierung usw. auftreten. <br><br><img src="https://habrastorage.org/webt/rg/0p/fj/rg0pfjhm0nsvzqfxtmemlhvwoq8.jpeg"><br><br>  Eine weitere interessante Frage ist, warum die Änderungen für <b>gzip</b> viel komplizierter erscheinen als für <b>tcpdump</b> .  Ich denke, das liegt daran, wie die Anwendung intern strukturiert ist, oder?  Wenn Sie also eine Anwendung haben, die einfach eine Datei komprimiert oder eine Datei entpackt hat, ist es normal, sie einfach zu starten, ohne sie im Funktionsmodus zu ändern.  Sie geben ihm einfach einen neuen Standard zum Entpacken von etwas, und der Standard liefert entpackte Daten am Ausgang, und dies wird gut funktionieren. <br><br>  Das Problem ist, wie es bei solchen Sandbox-Methoden fast immer der Fall ist, dass die Anwendung tatsächlich eine viel komplexere Prozesslogik aufweist.  Beispielsweise kann <b>gzip</b> mehrere Dateien gleichzeitig komprimieren und so weiter.  In diesem Fall haben Sie an der Spitze der Anwendung einen führenden Prozess, der über zusätzliche Rechte verfügt, um mehrere Dateien zu öffnen, zu packen usw.  Und die Kernlogik muss oft ein weiterer unterstützender Prozess sein.  Im Fall von <b>gzip war die</b> Anwendung nicht so strukturiert, dass Komprimierung und Dekomprimierung als separate Prozesse fungierten.  Daher mussten sie die Implementierung des <b>gzip-</b> Kernels und einige Strukturen der Anwendung selbst ändern, damit sie nicht nur einfach Daten an die Dekomprimierungsfunktion übertragen, sondern auch über einen <b>RPC-</b> Aufruf gesendet oder tatsächlich in eine Art fast Dateideskriptor geschrieben wurden.  Dies sollte verhindern, dass Probleme von Drittanbietern auftreten und praktisch ohne Berechtigungen entpackt werden.  Das einzige, was <b>gzip</b> gleichzeitig tun konnte, war, die entpackten oder komprimierten Daten an den Prozess zurückzugeben, der sie aufgerufen hat. <br><br>  Eine weitere Hausaufgabe ist, wie Sie <b>Capsicum</b> in <b>OKWS</b> tatsächlich verwenden.  Was denkst du darüber?  Wäre es hilfreich?  Würden die <b>OKWS-</b> Leute gerne auf <b>FreeBSD</b> upgraden, weil es so viel einfacher zu bedienen ist?  Wie würden Sie <b>Capsicum</b> unter <b>FreeBSD verwenden</b> ? <br><br>  <b>Teilnehmerin: Man</b> könnte einige strenge Einschränkungen aufheben. <br><br>  <b>Professor:</b> Ja, wir könnten sie vollständig durch ein Verzeichnis von Dateideskriptoren und -funktionen ersetzen.  Sie müssten keine verwirrende <b>Chroot</b> einrichten.  Anstatt <b>chroot</b> mit vielen kleinen Dingen zu verwenden, können Sie die Berechtigungen einfach sorgfältig festlegen.  Sie können einfach genau die Dateien öffnen, die Sie benötigen.  Das scheint also ein großes Plus zu sein. <br><br>  Als Nächstes haben Sie in <b>OKWS</b> den <b>OK-</b> Startdienst, mit dem alle übergeordneten Prozesse gestartet werden sollen.  Sobald sie sterben, kehrt das Signal zu <b>okld zurück</b> , um den "toten" Prozess <b>neu</b> zu starten.  Und dieses Ding müsste <b>root</b> ausführen, weil es die Prozesse in der Sandbox isolieren musste.  Es gibt jedoch eine Reihe von Dingen in <b>OKWS</b> , die mit <b>Capsicum</b> verbessert werden könnten. <br><br>  Beispielsweise könnten Sie <b>okld</b> weitaus weniger Berechtigungen gewähren.  Zum Port 80 benötigen Sie beispielsweise Root-Rechte.  Danach können Sie alles andere sicher in die Sandbox stellen, da keine Root-Rechte mehr benötigt werden.  Es ist also ziemlich cool.  Vielleicht können Sie dem Prozess sogar das Recht übertragen, auf die Anforderungen einer anderen Person zu antworten, z. B. einen Systemüberwachungsprozess, der nur diesen Prozessdeskriptor oder Prozessdeskriptor für einen untergeordneten Prozess enthält, und wenn ein solcher Prozess abstürzt, wird ein neuer gestartet.  Daher halte ich die Möglichkeit, eine Sandbox ohne Root-Rechte zu erstellen, für sehr nützlich. <br><br>  <b>Zielgruppe:</b> Sie können jedem Prozess einen Dateideskriptor zuweisen, mit dem Sie nur Einträge zum Protokoll hinzufügen können. <br><br>  <b>Professor:</b> Ja, und das ist ziemlich cool.  Wie wir letztes Mal gesagt haben, kann <b>oklogd</b> die Protokolldatei "durcheinander bringen".  Und wer weiß, was der Kernel ihm erlaubt, wenn er den Dateideskriptor der Protokolldatei selbst hat.  Wir können jedoch die Funktionen des Dateideskriptors genauer bestimmen, indem wir ihm eine Protokolldatei geben und angeben, dass er nur schreiben, aber nichts suchen kann.  Daher erhalten wir die Funktion "Nur Anhängen", wenn Sie nur ein "Schreiber" für diese Datei sind.  Es ist sehr bequem.  Sie können dem Prozess die Berechtigung zum Schreiben in die Datei erteilen, diese jedoch nicht lesen. Dies ist nur mit <b>Unix-</b> Berechtigungen sehr schwierig. <br><br>         <b>Capsicum</b> ? <br><br> <b>:</b>  , ,   ,        .     ,       ,  ,       . <br><br> : ,  .   <b>Capsicum</b> ,   ,      .           . <br><br> <b>:</b> ,     ,  okld      .      ,    . <br><br> <b>:</b>  ,      .   .     ,    ,   <b>Capability</b>      ,       .   ,     ,   ,   , ,        . <br>   ,         <b>OKWS</b> .               . , ,        ,    .    . <br><br> ,      ,   «».     ,       .  ,  ,         ,    ,       .        . <br> :    «»   ,      ,   ? <br><br> : ,   <b>FreeBSD</b>   .   ,     -   ,     .  <b>FreeBSD</b>     <b>Casper</b> ,    ,   <b>Capability</b> .            ,   «». <br><br>      - ,    ,  ,  - ,        ,  <b>Casper</b>    . <br><br><img src="https://habrastorage.org/webt/pj/hd/aw/pjhdaw8gumxqioaoawbwert89ks.jpeg"><br><br>      ,    «»     .   . ,     ,     ,   <b>Casper</b>     - . <br><br>   ,         ,       -  .    ,   <b>Unix</b>         <b>FD</b> .      ,      .  ,        ,    . <br><br>  ,       <b>FreeBSD</b> ,      <b>DNS</b> .       <b>DNS</b> -,   «».    ,    <b>tcpdump</b> .    tcpdump   ,        IP-.   ,   ,     <b>DNS</b> -. <br><br>  , ,     DNS-      DNS-,    .    <b>Casper</b> ,      DNS-. <br><br>  ,     ,   ,     Capsicum?    ?       ?       ,   ,    .         <b>Capsicum</b> ,    ? <br><br>     tcpdump  <b>GZIP</b> ,  ,   .            ? <br><br><img src="https://habrastorage.org/webt/yn/u5/ov/ynu5ovmtuqxeqgmma5p7hnhhwrg.jpeg"><br><br> <b>:</b> ,    ,   ,  . ,      <b>Capability</b> . <br><br> <b>:</b> ,  .      <b>Capsicum</b>  ,    ,    .  ,    ,        .  ,   ,   ,    ,    <b>Capsicum</b> ,   . <br><br>     ,          «». ,  <b>TCP — helper</b> , ,  , ,    .    ,  ,  ,    . <br><br> <b>:</b>  ,             . <br><br> <b>:</b> , .        . ,          .    <b>lth_start</b> ,      .  ,   ,      ,     - . <br><br>  ,   ,  Capsicum        .    ,       ,   ,             .    Unix    -    ,      . <br><br>          ,     . ,               .  ,          ,    .   ,    . <br><br> ,   Chrome      .  ,     ,       ,        Unix,  -,     <b>Unix</b> . <br><br> ,      ? <br><br> <b>:</b>            . <br><br> <b>:</b> .       .    ,    .      ,       , ,                 ,     . <br><br>     <b>Unix</b>     ,      .  ,        .    ,              .        .      ,     . <br><br>     .  <b>Linux</b>  ,  <b>setcall</b> ,     ,    .  ,    <b>Capsicum</b> ,        ,  <b>Capsicum</b>     ,     .   <b>Linux</b>  <b>setcall</b>     ,   .    ,   ,      <b>Linux</b> . <br><br> ,    —    , ,      ,     ,        .   ,      -  ,     «//»,       .        <b>Capsicum</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Hier können Sie den Prozess für eine bestimmte Datei und nicht für das gesamte Home-Verzeichnis starten. </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/MlWK2YbZRZ8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Vollversion des Kurses finden Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  Vielen Dank für Ihren Aufenthalt bei uns.  Gefällt dir unser Artikel?  Möchten Sie weitere interessante Materialien sehen?  Unterstützen Sie uns, indem Sie eine Bestellung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgeben</a> oder sie Ihren Freunden empfehlen. <b>Habr-Benutzer erhalten 30% Rabatt auf ein einzigartiges Analogon von Einstiegsservern, das wir für Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit über VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s $ 20 oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 Monate kostenlos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bei Bezahlung eines neuen Dell R630 für einen Zeitraum von sechs Monaten - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel Deca-Core Xeon E5-2630 v4 / 128 GB DDR4 / 4 x 1 TB Festplatte oder 2 x 240 GB SSD / 1 Gbit / s 10 TB - ab 99,33 USD pro Monat</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , nur bis Ende August, Bestellung kann </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hier sein</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  <b>Dell R730xd 2 mal günstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 GB DDR4 6 x 480 GB SSD 1 Gbit / s 100 TV von 249 US-Dollar</a> in den Niederlanden und den USA!</b>  Lesen Sie mehr über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Aufbau eines Infrastrukturgebäudes.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern für 9.000 Euro für einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418221/">https://habr.com/ru/post/de418221/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418211/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 4: „Privilegien teilen“, Teil 3</a></li>
<li><a href="../de418213/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 5: „Woher kommen Sicherheitssysteme?“, Teil 1</a></li>
<li><a href="../de418215/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 5: „Woher kommen Sicherheitssystemfehler?“, Teil 2</a></li>
<li><a href="../de418217/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 6: „Chancen“, Teil 1</a></li>
<li><a href="../de418219/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 6: Chancen, Teil 2</a></li>
<li><a href="../de418223/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 7: Die Native Client Sandbox, Teil 1</a></li>
<li><a href="../de418225/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 7: Native Client Sandbox Teil 2</a></li>
<li><a href="../de418227/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 7: Die Native Client Sandbox, Teil 3</a></li>
<li><a href="../de418229/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 8: Netzwerksicherheitsmodell, Teil 1</a></li>
<li><a href="../de418233/index.html">BMW Mnemonik zum Finden von Grenzwerten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>