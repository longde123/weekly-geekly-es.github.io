<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧙 🙂 👐🏼 Système de sauvegarde 🧑🏿‍🤝‍🧑🏽 💱 🌝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article fait partie d'une série sur la construction de NAS et est écrit pour un type de système spécifique. 


 La sauvegarde est la deuxième tâch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Système de sauvegarde</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421251/"><p><img src="https://habrastorage.org/webt/in/pk/uh/inpkuhyjnf8c-efshdvkj_edp7m.jpeg"></p><br><p>  Cet article fait partie d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">série sur la construction de NAS</a> et est écrit pour un type de système spécifique. </p><br><p>  La sauvegarde est la deuxième tâche principale que je voulais résoudre en utilisant le NAS, après <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le système de gestion du référentiel</a> . </p><br><p>  Sa décision a traîné en longueur ... </p><br><p>  De nombreux articles et même plusieurs livres ont déjà été écrits sur ce sujet, et de nombreux exemplaires ont été cassés lors de différends à ce sujet. </p><br><p>  Vous trouverez ci-dessous une tentative de comprendre ce tas de matériel, de le mettre dans votre tête et de construire un petit système de manière relativement compétente. </p><a name="habracut"></a><br><p>  Le système de sauvegarde (SRK) est déterminé par: </p><br><ul><li>  Politique de sauvegarde.  La politique définit les principaux buts et objectifs de la sauvegarde, ses exigences, sur la base de la liste des menaces pour chaque système de sauvegarde, et justifie également sa nécessité. </li><li>  Règlements de sauvegarde basés sur des règles.  Le règlement décrit les algorithmes de sauvegarde et de récupération responsables des sauvegardes, les conditions de stockage des sauvegardes, etc. </li><li>  Implémentation instrumentale.  En fait, logiciel et matériel. </li></ul><br><p>  Le processus de sauvegarde régulier est divisé en plusieurs parties principales: </p><br><ul><li>  Début périodique de la copie. </li><li>  Commencez la récupération à la demande. </li><li>  Test du processus de copie. </li></ul><br><p>  Points d'interface du système avec la plateforme NAS: </p><br><ul><li> <code>tank0/apps/backup</code> - stockage de <code>tank0/apps/backup</code> . </li><li>  <code>tank1/apps/backup</code> - stockage de <code>tank1/apps/backup</code> . </li><li>  <code>https://backup.NAS.cloudns.cc</code> - Interface système basée sur le Web. </li></ul><br><p>  Les référentiels de sauvegarde sont <strong>des systèmes de fichiers distincts</strong> . <br>  Cela est nécessaire car leurs options peuvent être très différentes, à la fois des systèmes de fichiers normaux et entre eux. </p><br><p>  Par exemple, si nécessaire, la déduplication au moyen de FS peut être activée et la compression peut être désactivée. </p><br><h2 id="principy-rezervnogo-kopirovaniya">  Principes de sauvegarde </h2><br><p><img src="https://habrastorage.org/webt/t-/pe/i4/t-pei4njc4jilp-l0unqmcpanho.jpeg"></p><br><p>  Il vaut la peine de comprendre que bien que je décrive ici un cas particulier de sauvegarde adapté aux besoins d'un petit réseau, les principes, les observations et les modèles sont partout communs. <br>  Dans les cas simples, certains d'entre eux peuvent être négligés, mais il est souhaitable de le savoir. </p><br><p>  Ces principes sont basés sur des politiques et des réglementations. </p><br><p>  Voici quelques principes de base: </p><br><ul><li>  <strong>3-2-1</strong> .  Effectuez au moins trois sauvegardes, dans deux formats de stockage, dont au moins une doit être stockée dans un endroit physiquement séparé.  Le principe est souhaitable à observer.  Dans mon cas, ce principe est partiellement mis en œuvre.  Premièrement, il existe trois machines différentes sur lesquelles les données sont partiellement dupliquées: NAS, travail et ordinateur portable.  Deuxièmement, la réplication vers le cloud est prévue. </li><li>  <strong>Vérifiez ce qui a été copié</strong> .  Sinon, il peut arriver qu'à un moment crucial, les données ne puissent pas être restaurées.  Vérifiez mieux tout au long du processus de récupération. </li><li>  <strong>Utilisez les bons outils pour la tâche</strong> .  Il est probable qu'avec la copie d'un parc de machines virtuelles, un système de copie de fichiers avec un agent sur une machine fonctionnera mal.  Un logiciel spécialisé copiera plus rapidement et moins cher sur les ressources de la machine.  Il est important que l'outil soit fiable et simple.  IBS n'est pas quelque chose avec lequel vous voulez habituellement creuser. </li><li>  <strong>Il vaut mieux tout copier, à l'exception évidente de l'excès</strong> .  Ou "il vaut mieux dépasser que ne pas finir".  Il sera possible de jeter l'excédent, mais si la politique inverse est utilisée, il peut être impossible de restaurer un fichier précieux que vous avez oublié de spécifier explicitement. </li><li>  <strong>Il devrait être possible de sélectionner et de restaurer rapidement les données</strong> .  Il est conseillé, "un clic", et de ne pas attendre une heure.  Officiellement, vous devez avoir un RTO suffisamment bas et un RPO suffisant.  Il est extrêmement pratique si l'IBS vous permet de restaurer accidentellement supprimé, et de choisir parmi plusieurs versions, et pas seulement la dernière (par exemple, s'il est endommagé, car les erreurs logiques ne sont pas exclues). </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">À la fin de l'article,</a> il y a des liens vers des sources que vous pouvez étudier afin de vous familiariser plus complètement avec ces points, ainsi que de lire sur d'autres. </p><br><h2 id="politika-rezervnogo-kopirovaniya">  Politique de sauvegarde </h2><br><p>  De toute évidence, l'objectif de toute sauvegarde est de réduire le coût de la destruction non planifiée des données dans les situations d'urgence. </p><br><p>  Ceci est réalisé en dupliquant les données précieuses des machines en fonctionnement vers le stockage tiers. </p><br><h3 id="zadachi-rezervnogo-kopirovaniya">  Tâches de sauvegarde </h3><br><p>  Les tâches suivantes sont définies à des fins de sauvegarde: </p><br><ul><li>  Mettez en surbrillance les données cibles. </li><li>  Enregistrement des données spécifiées pour une récupération ultérieure. </li><li>  Récupération des données enregistrées. </li><li>  Assurer la stabilité des données stockées au changement et à la destruction. </li><li>  Différenciation de l'accès aux données stockées. </li><li>  Assurer le contrôle du système et le processus de sauvegarde. </li></ul><br><h3 id="trebovaniya-k-sisteme">  Configuration requise </h3><br><p>  Plus loin dans la liste, les exigences fonctionnelles et non fonctionnelles sont mélangées: </p><br><ul><li>  La sauvegarde doit être effectuée: <br><ul><li>  Dans les délais. </li><li>  Sur demande. </li><li>  Si vous sautez le précédent. </li></ul></li><li>  La sauvegarde des données doit être effectuée au moins 1 fois par jour jusqu'à une profondeur d'un mois.  La pratique de prendre des instantanés, ainsi que d'utiliser la version précédente du système sur une machine qui fonctionne, montre que cela me suffit. </li><li>  Le temps de récupération des données ne doit pas dépasser 2 minutes pour 1 Go (la limite de bande passante réseau est de 81 s. Pour 1 Go).  Prise en compte de la bande passante LAN et de la vitesse du disque, comme facteurs limitants. </li><li>  Tous les canaux doivent être cryptés.  Les données sensibles, telles que les données d'autorisation dans les services en ligne, peuvent être enregistrées. </li><li>  Il devrait être possible de chiffrer les sauvegardes des utilisateurs avec une clé secrète sur la machine de l'utilisateur, sans possibilité de déchiffrement sur le serveur.  Ceci est important car les utilisateurs ne sont pas obligés de faire confiance au serveur du tout. </li><li>  Une copie incomplète ne devrait pas prendre beaucoup de temps, par exemple plus de 30 minutes.  Internet est utilisé pour copier des données à partir d'un ordinateur portable. </li><li>  Il devrait être possible de répliquer des copies sur le cloud (la possibilité de configurer de manière flexible la réplication pour un stockage cloud particulier) avec le cryptage des sauvegardes.  C'est aussi l'une des conséquences du «principe 3-2-1». </li><li>  Il devrait y avoir une gestion centralisée simple avec intégration dans l'interface Web. </li><li>  Un minimum d'améliorations et de paramètres complexes sur le serveur. </li></ul><br><h3 id="sostav-rezerviruemyh-resursov">  Composition des ressources réservées </h3><br><p>  Dans mon cas, c'est assez typique: </p><br><ul><li>  La principale machine de travail.  Ordinateur de bureau. </li><li>  Machine de travail mobile.  L'ordinateur portable. </li><li>  Routeur LAN.  Il stocke les paramètres réseau, qui peuvent contenir des identifiants et des mots de passe pour une connexion Internet et certains services. </li><li>  NAS  Oui, la configuration NAS est également redondante.  Malgré le fait que la plupart des FS ont des instantanés. </li></ul><br><h3 id="sostav-ugroz">  Composition de la menace </h3><br><p>  C'est où, quoi et quoi protéger et de quelle manière. </p><br><div class="spoiler">  <b class="spoiler_title">Pour ce faire, j'ai compilé un petit tableau des menaces.</b> <div class="spoiler_text"><div class="scrollable-table"><table><thead><tr><th>  Ressource </th><th>  Menace </th><th>  Solution </th></tr></thead><tbody><tr><td>  Machine principale de travail </td><td>  Corruption des données physiques </td><td>  Sauvegarde des données et paramètres clés </td></tr><tr><td>  Machine principale de travail </td><td>  Corruption partielle et imperceptible des données </td><td>  Conserver les anciennes sauvegardes pendant un certain temps </td></tr><tr><td>  Machine principale de travail </td><td>  Perte d'accès aux données </td><td>  Stockage de l'image complète de la machine, ou des <strong>paramètres, pour une rotation rapide sur une autre machine</strong> , ou duplication des fonctions sur un PC mobile </td></tr><tr><td>  Machine principale de travail </td><td>  Accès physique non autorisé aux données </td><td>  Chiffrement des données et des sauvegardes, transfert de copie chiffré </td></tr><tr><td>  Machine principale de travail </td><td>  Accès non autorisé via une violation de logiciel </td><td>  Réservation des sommes de contrôle des logiciels et rapprochement périodique, systèmes de contrôle (pas encore implémentés) </td></tr><tr><td>  Machine de travail mobile </td><td>  Perdre une voiture avec des données </td><td>  Cryptage des données, sauvegarde complète ou sauvegarde des paramètres et données clés </td></tr><tr><td>  Routeur LAN </td><td>  Destruction d'une configuration ou d'un appareil </td><td>  Redondance de configuration, redondance d'appareil possible </td></tr><tr><td>  Routeur LAN </td><td>  Perte de contrôle due au piratage </td><td>  Réservation de configuration </td></tr><tr><td>  Routeur LAN </td><td>  Corruption partielle et invisible des données </td><td>  Stockage de la somme de contrôle des logiciels et réconciliation périodique </td></tr><tr><td>  NAS </td><td>  Paramètres de service corrompus </td><td>  Réservation de réservation locale </td></tr><tr><td>  NAS </td><td>  Corruption des données physiques </td><td>  Réplication cloud </td></tr><tr><td>  NAS </td><td>  Perte d'accès au système et sauvegardes </td><td>  Réplication cloud </td></tr><tr><td>  NAS </td><td>  Accès non autorisé aux données de tiers </td><td>  Stockage et réplication des données sous forme cryptée, échange de données sous forme cryptée </td></tr><tr><td>  NAS </td><td>  Accès non autorisé de l'administrateur aux données </td><td>  Cryptage des sauvegardes sur les clés locales des machines redondantes </td></tr></tbody></table></div></div></div><br><p>  Toutes les principales menaces pesant sur l'ordinateur mobile répètent les menaces pesant sur l'ordinateur fixe. <br>  Les tablettes électroniques ne diffèrent pratiquement pas du mobile, de ce point de vue. </p><br><h3 id="dopolnitelnye-usloviya-politiki">  Conditions de politique supplémentaires </h3><br><p>  Il est conseillé de les prendre en compte: </p><br><ul><li>  Des tests de récupération réguliers doivent être effectués. </li><li>  Les procédures de reprise après incident doivent être documentées. </li><li>  Les actions doivent être réglementées en cas de défaillance secondaire: que faire si, après la restauration, le système n'est pas opérationnel ou si les données ne peuvent pas être restaurées. </li><li>  Il est nécessaire de tester si le processus de récupération dépend d'un équipement spécifique <br>  (qui peut échouer au moment de la récupération).  Dans mon cas, je ne vérifierai pas cela, limité à une simple vérification du système de base. </li><li>  Si vous disposez d'une sauvegarde complète du système, vous devez sauvegarder immédiatement après une mise à niveau substantielle. </li><li>  Si le volume cumulé de sauvegardes incrémentielles dépasse le volume de sauvegarde complète, il est rationnel d'effectuer une sauvegarde complète non planifiée.  Autrement dit, la fréquence de création de sauvegardes complètes doit être augmentée dans ce cas. </li></ul><br><p>  Je ne prends pas en compte le dernier point de la politique, car généralement mon flux de travail ne change pas, et il suffit de surveiller le volume pendant un certain temps, uniquement pour la configuration initiale. <br>  Empiriquement, il a été constaté que le schéma "mois, semaine, jour, heure" me convenait parfaitement. <br>  Pour les systèmes plus importants, vous devrez peut-être modifier la fréquence de sauvegarde de manière dynamique pour chaque système. </p><br><h2 id="reglament-rezervnogo-kopirovaniya">  Règlements de sauvegarde </h2><br><p>  Après l'élaboration d'une politique, il est possible de procéder directement à l'élaboration d'un règlement. <br>  Dans le cas général, il peut y avoir plusieurs réglementations: générales, pour les administrateurs IBS, pour les utilisateurs, pour les responsables du stockage, pour les administrateurs des systèmes cibles, etc ... <br>  Mais dans le cas d'un petit système, il s'agit généralement d'une seule personne, et donc il n'y a qu'une seule réglementation. </p><br><h3 id="zadachi-reglamenta">  Les objectifs de la réglementation </h3><br><ul><li>  Définition des procédures de sauvegarde des données. </li><li>  Définition des procédures de récupération de données. </li><li>  Définition d'une procédure de vérification de l'intégrité du système. </li><li>  Conditions de stockage de sauvegarde et exigences relatives aux supports. </li><li>  Rationaliser le travail. </li></ul><br><h3 id="primer-reglamenta">  Exemple de régulation </h3><br><p>  Sous le spoiler, vous pouvez voir à quoi ressemblent les règles dans une grande organisation, en utilisant l'exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://web.archive.org/web/20160731233007/">de la réglementation Rosreestr tirée de sources ouvertes</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Réglementation de Rosreestr.</b> <div class="spoiler_text"><h1 id="reglament-rezervnogo-kopirovaniya-dannyh-v-territorialnyh-podrazdeleniyah-rosreestra">  RÉGLEMENTATION DE LA SAUVEGARDE DES DONNÉES DANS LES DÉPARTEMENTS TERRITORIAUX DE ROSRESTR </h1><br><h2 id="oglavlenie">  Table des matières </h2><br><ol><li>  Dispositions générales </li><li>  Ordre de sauvegarde. </li><li>  Suivi des résultats. </li><li>  Support réglementaire. </li><li>  Rotation des supports de sauvegarde. </li><li>  Restaurez les informations à partir d'une sauvegarde. </li><li>  Annexe 1 </li><li>  Annexe 2 Liste des personnes responsables de la sauvegarde. </li></ol><br><h2 id="1--obschie-polozheniya">  <strong>1</strong> Général </h2><br><p>  Ce règlement établit les exigences de base pour l'organisation de la sauvegarde (récupération) des programmes et des données stockés dans les bases de données sur les serveurs de l'autorité territoriale de Rosreestr, ainsi que pour la sauvegarde du matériel. </p><br><p>  Le présent règlement vise à: </p><br><ul><li>  détermination de la catégorie des informations soumises à une sauvegarde obligatoire; </li><li>  déterminer la procédure de sauvegarde des données pour la restauration ultérieure des performances des systèmes d'information en cas de perte totale ou partielle d'informations provoquée par des pannes ou des dysfonctionnements du matériel ou des logiciels, des erreurs des utilisateurs, des urgences (incendie, catastrophes naturelles, etc.); </li><li>  déterminer la procédure de récupération des informations en cas de besoin; </li><li>  rationaliser les travaux et déterminer la responsabilité des fonctionnaires concernant la sauvegarde et la restauration des informations. </li></ul><br><p>  La sauvegarde des informations signifie la création de copies complètes des bases de données de production de l'Office pour la récupération rapide du système de gestion de l'information du Registre d'État unifié des entreprises AIS "Justice" en cas d'urgence entraînant des dommages ou des pertes de données. </p><br><p>  Toutes les bases de données de production de tous les services territoriaux de l'Office peuvent faire l'objet d'une sauvegarde. </p><br><p>  Les supports de stockage de la machine contenant une copie de sauvegarde se voient attribuer un tampon de confidentialité pour le tampon le plus élevé d'informations qu'ils contiennent. </p><br><p>  Les sauvegardes sont stockées à l'extérieur de la salle des serveurs, l'accès aux sauvegardes est limité.  La liste des personnes ayant accès aux données est établie sur la base d'une demande écrite du chef de l'unité informatique (IT), convenue avec le chef de l'unité sécurité informatique (SI).  Les droits d'accès aux moyens techniques, baies et supports de stockage réservés sont modifiés sur la base d'une demande du chef du service informatique, convenue avec le chef du service SI.  Les tentatives détectées d'accès non autorisé aux informations et au matériel réservés, ainsi que les autres violations de SI qui se sont produites pendant le processus de sauvegarde, sont signalées à l'unité SI avec une note de service pendant la journée de travail après la détection de l'événement spécifié. </p><br><h2 id="2-poryadok-rezervnogo-kopirovaniya">  <strong>2</strong> Ordre de sauvegarde </h2><br><p>  La sauvegarde est effectuée au moyen d'Oracle DBMS.  La sauvegarde peut être effectuée: </p><br><ul><li>  Manuellement - l'opérateur responsable de la sauvegarde démarre la procédure d'exportation Oracle (un exemple de démarrage de la procédure dans l'annexe 1). </li><li>  Automatiquement - le fichier exécutable qui appelle la procédure d'exportation Oracle est lancé automatiquement par le système d'exploitation selon le calendrier. </li></ul><br><p>  La sauvegarde de la base de données est effectuée au moins 1 fois par jour.  La période de stockage de la base de données de sauvegarde est d'au moins 1 mois. </p><br><p>  La stratégie de sauvegarde doit garantir la récupération synchrone des données situées dans différents schémas de base de données.  Par exemple, le schéma HED (le référentiel de documents électroniques) doit être copié simultanément avec le schéma AIS Justice. </p><br><p>  Le matériel et les moyens techniques du système de sauvegarde doivent fournir des performances suffisantes pour enregistrer les informations, à temps et à des intervalles spécifiés.  Les personnes chargées d'organiser quotidiennement la sauvegarde contrôlent la disponibilité de l'espace disque nécessaire à la sauvegarde. </p><br><h2 id="3-kontrol-rezultatov">  <strong>3</strong> Suivi des résultats </h2><br><p>  Les résultats de toutes les procédures de sauvegarde sont contrôlés par les responsables responsables spécifiés à l'annexe 2, jusqu'à 10 heures le jour ouvrable suivant la date fixée pour l'exécution de ces procédures. </p><br><p>  Si une erreur est détectée, la personne responsable du suivi des résultats le signale au service d'assistance technique du développeur au plus tard 11 heures de la journée de travail en cours. </p><br><h2 id="4-normativno-pravovoe-obespechenie">  <strong>4</strong> Assistance réglementaire </h2><br><p>  Pour organiser le processus de sauvegarde, vous devez: </p><br><ul><li>  Définissez une liste de personnes responsables de l'exécution du processus de sauvegarde et du suivi de ses résultats (annexe 2). </li><li>  Préparez et approuvez un calendrier de sauvegarde. </li><li>  Préparer et approuver les documents réglementaires internes sur la nomination des responsables de la sauvegarde des données. </li></ul><br><h2 id="5-rotaciya-nositeley-rezervnoy-kopii">  <strong>5</strong> Supports de sauvegarde rotatifs </h2><br><p>  Le système de sauvegarde doit permettre de remplacer (décharger) périodiquement les supports de sauvegarde sans perdre d'informations sur ceux-ci, et également assurer la récupération des informations actuelles des systèmes automatisés en cas de défaillance de l'un des périphériques de sauvegarde.  Toutes les procédures de chargement, de déchargement des supports du système de sauvegarde, ainsi que leur transfert vers le service de sécurité et vice versa, sont effectuées par l'administrateur de sauvegarde sur demande et en présence d'un employé responsable du service de sécurité du client (conformément à l'annexe n ° 2). </p><br><p>  En tant que nouveaux transporteurs, il est permis de réutiliser ceux pour lesquels la période de stockage des informations contenues a expiré. </p><br><p>  Les informations confidentielles provenant de supports qui ne sont plus utilisés dans le système de sauvegarde doivent être effacées à l'aide du logiciel PGP. </p><br><h2 id="6-vosstanovlenie-informacii-iz-rezervnoy-kopii">  <strong>6</strong> Restaurer les informations à partir d'une sauvegarde </h2><br><p>  Si nécessaire, la restauration des données à partir des sauvegardes est effectuée par l'employé responsable du service informatique spécifié à l'annexe n ° 2. </p><br><p>  La récupération des données à partir des sauvegardes se produit en cas de disparition ou de violation en raison d'un accès non autorisé au système, d'une exposition aux virus, d'erreurs logicielles, d'erreurs des employés et de pannes matérielles. </p><br><p>  La restauration des logiciels système et des logiciels à usage général est effectuée à partir de leurs supports conformément aux instructions du fabricant. </p><br><p>  La restauration des logiciels spécialisés est effectuée à partir des supports de distribution ou de leurs copies de sauvegarde conformément aux instructions d'installation ou de restauration de ce logiciel. </p><br><p>  Les informations qui ne sont pas liées à des bases de données en constante évolution sont restaurées à partir du support de sauvegarde.  Il utilise la dernière copie des informations. </p><br><p>  En cas de violation partielle ou de disparition des enregistrements de la base de données, la restauration est effectuée à partir de la dernière copie quotidienne non perturbée.  Toutes les informations sont restaurées à partir de la dernière copie. </p><br><h2 id="7-prilozhenie-1">  <strong>7</strong> Annexe 1 </h2><br><p>  Un exemple de démarrage de l'utilitaire d'exportation Oracle à partir de la ligne de commande: </p><br><p>  exp userid = JUST_USER / PASSWORD @ SERVER owner = (JUST_USER, HED_USER) direct = Y cohérent = statistiques Y = NONE compress = fichier N = C: \ BACKUP.DMP log = C: \ BACKUP.LOG </p><br><p>  où: </p><br><p>  JUST_USER / PASSWORD @ SERVER <em>-</em> schema_owner_name / password @ server_name; </p><br><p>  owner = (JUST_USER, HED_USER) - une liste des schémas copiés; dans cet exemple, le schéma AIS Justice et le schéma HED sont exportés simultanément; </p><br><p>  file = C: \ BACKUP.DMP <em>-</em> chemin et nom du fichier d'exportation créé; </p><br><p>  log = C: \ BACKUP.LOG <em>-</em> chemin et nom du fichier journal d'exportation créé. </p><br><h2 id="8-prilozhenie-2-perechen-lic-otvetstvennyh-za-rezervnoe-kopirovanie">  <strong>8</strong> Annexe 2. Liste des personnes responsables de la sauvegarde </h2><br><div class="scrollable-table"><table><thead><tr><th>  <strong>Non p / p</strong> </th><th>  <strong>Rôle</strong> </th><th>  <strong>Nom de l'officier responsable</strong> </th></tr></thead><tbody><tr><td>  1 </td><td>  Configuration initiale du système de sauvegarde. </td><td></td></tr><tr><td>  2 </td><td>  Apporter des modifications importantes à la configuration du système de sauvegarde. </td><td></td></tr><tr><td>  3 </td><td>  Analyse des journaux de sauvegarde, suivi de la nécessité de modifier les paramètres de sauvegarde, assurant la rotation des supports. </td><td></td></tr><tr><td>  4 </td><td>  Rotation des supports, vérification de l'exactitude de la sauvegarde, garantie que la sauvegarde est stockée à l'extérieur du bureau en cas de sinistre. </td><td></td></tr></tbody></table></div></div></div><br><p>  Vous trouverez ici un autre exemple avec une brève description. </p><br><h3 id="procedura-rezervirovaniya">  Procédure de réservation </h3><br><p>  Composition des données de sauvegarde: </p><br><ul><li>  Machines de travail: <br><ul><li>  Répertoires d'utilisateurs personnels ( <code>/home/*</code> ).         . </li><li>   . </li><li>    ,   ( <code>/opt</code> ). </li><li>   ( <code>/etc</code> ). </li><li>    . </li><li>  . </li><li>   . </li><li>   . </li></ul></li><li> : <br><ul><li>  . </li></ul></li><li> NAS: <br><ul><li>    Docker . </li><li>   . </li><li>  . </li><li>    . </li><li>  . </li><li>     Docker . </li><li>   . </li><li>    . </li></ul></li><li>  : <br><ul><li>    . </li></ul></li></ul><br><p>  : </p><br><ul><li>       . </li><li>     ,    . </li><li>          <code>/etc/apt/apt.conf.d</code> ,  ,     . </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> Mikrotik</a> . </li><li> NAS    . </li></ul><br><p>  : </p><br><ul><li>     1      .     . <br>  3 . </li><li>     1     . <br>  . </li><li>     1   . <br>  . </li><li>       . <br>  . </li><li>          . <br>    6 ,      . </li></ul><br><h3 id="procedura-vosstanovleniya">   </h3><br><p><img src="https://habrastorage.org/webt/qu/i3/il/qui3ilw9nczsm17-w7d1dwcalhy.jpeg"></p><br><ul><li>        ,  . </li><li>       ,    . </li></ul><br><p>        : </p><br><ul><li>   live . </li><li>        . </li><li>     ,  . </li></ul><br><p>  ,           Debian   (  Squeeze  2011 ),           Slackware  ReiserFS    . </p><br><p>       : </p><br><ul><li>    ,  . </li><li>       . </li><li>   ,    . </li><li>       . </li></ul><br><p> Mikrotik   ,    RouterOS . </p><br><h3 id="procedura-proverki-rabotosposobnosti">    </h3><br><ul><li>       . <br>   logcheck, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> . </li><li>          . </li></ul><br><p>       ,    . </p><br><h3 id="usloviya-hraneniya-rezervnyh-kopiy-i-trebovaniya-k-nositelyam">         </h3><br><ul><li>      . </li><li>    1        . <br>              . </li><li>  .     . </li><li>    . </li></ul><br><h2 id="resheniya-dlya-rezervnogo-kopirovaniya">     </h2><br><p>     ,       . </p><br><h3 id="trebovaniya-k-po">    </h3><br><p>      : </p><br><ul><li>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Veeam</a>     ,   ,    .     ,    Acronis,    ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </li><li>             . </li><li>          . </li></ul><br><h3 id="vybor-po">   </h3><br><p>          . <br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </p><br><div class="spoiler"> <b class="spoiler_title">  .</b> <div class="spoiler_text"><h3 id="resheniya-na-baze-unix-utilit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Solutions utilitaires Unix </font></font></h3><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions basées sur rsync, tar, rdiff-backup, etc. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne sont pas pris en compte en raison de la grande quantité de travail qui devra être fait et du manque de l'interface WEB nécessaire.</font></font></p><br><h3 id="bareoshttpswwwbareosorgen"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Breos</font></font></a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/kp/pa/7t/kppa7tts84fep2t5rfk52poagx4.png"></a> </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> BareOS (Backup Archiving Recovery Open Sourced) - fork de Bacula depuis 2010. </font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avantages: </font></font></p><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Système stable débogué. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prend en charge plusieurs types d'agents sous différents systèmes d'exploitation. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il prend en charge différents types de sauvegarde: incrémentielle, différentielle, complète. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L'interface WEB est très développée et fonctionnelle. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Configuration flexible. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe un pilote FUSE qui affiche les sauvegardes. </font></font></li><li>    Python,    Director. </li><li>       (, ). </li><li>       . </li><li>     . </li></ul><br><p>  Inconvénients: </p><br><ul><li>    . </li><li>   . </li><li>    . </li><li>   ,    . </li><li>   (500+ ),    ,          . </li></ul><br><h3 id="backuppchttpbackuppcsourceforgenet"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BackupPC</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/zi/dv/e4/zidve44-5zrteeqdkiosyigkvwu.png"></a> </p><br><p>    . </p><br><p>   : </p><br><ul><li>    . </li><li>    . </li><li>  Web-. </li><li>    . </li><li> .    ,       . </li><li>   . </li><li>   ,   SMB, rsync. </li><li>      Web-. </li><li>     ,      . </li><li>  ,  ,      . </li><li>   . </li></ul><br><p>  Inconvénients: </p><br><ul><li>   Perl,   CPAN. </li><li>    ,    ,     . <br>        ,   ,   ,     .   ,         SSH   ,   ,    , ..      . </li><li>      (  ,    ). </li></ul><br><h3 id="urbackuphttpswwwurbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">UrBackup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/u1/lo/ed/u1loed_wq1-njxjlq1f7ths2kso.png"></a> </p><br><p> -     . </p><br><p>   : </p><br><ul><li>  Configuration simple. </li><li>  Web-. </li><li>    . </li><li>      ( .. ). </li><li>   Windows, Linux, MacOS X. </li><li>    :     ,        . </li><li>     . </li><li>     . </li><li>      (,  Outlook,     ). </li><li>   .    ,       . </li><li>   (,   ..)     . </li><li>  Configuration simple. </li><li>    ,     . </li><li>     ,      . </li><li>   . </li><li>      Internet. </li><li>   (,  ) . </li><li>     . </li><li>     (,   USB ). </li><li>  . </li><li>  GUI     . </li></ul><br><p>  Inconvénients: </p><br><ul><li>   Windows,    , . </li><li>      NTFS. </li><li>  LDAP,   ,  ,   AD      . </li></ul><br><h3 id="restichttpsresticnet"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Restic</a> </h3><br><p>         . </p><br><p>   : </p><br><ul><li>  Configuration simple. </li><li>      . </li><li> .    ,       . </li><li>   / .   .    . </li><li>       .    . </li><li>   . </li><li>  FUSE ,       host/. </li></ul><br><p>  Inconvénients: </p><br><ul><li> Web- . </li><li>    RAM (~2.7GB  1TB). </li><li>   ACL   . </li><li>     RAM   . </li><li>      (     ). </li><li>       (        ).    . </li><li>       restic. </li></ul><br><h3 id="borgbackuphttpswwwborgbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BorgBackup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/a_/qp/rh/a_qprhceevkysy_nk_xg20os5x0.jpeg"></a> </p><br><p>     . </p><br><p>   : </p><br><ul><li>   . </li><li>        . </li><li>   (   Python,      C  ). </li><li> . </li><li> : LZ4, zlib, LZMA. </li><li>  FUSE ,   . </li><li>     : Linux, macOS, BSD, etc. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> Web-,   </a> . </li><li>    . </li></ul><br><p>  Inconvénients: </p><br><ul><li> Web-  . </li><li>     Windows (  Linux subsystem  cygwin). </li></ul><br><h3 id="lsyncdhttpsgithubcomaxkibelsyncd"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lsyncd</a> </h3><br><p> ,      rsync. </p><br><p>   : </p><br><ul><li>  inotify  fsevents    .     rsync   . </li><li>     rsync. </li><li>   Lua,     Lua. </li><li>      . </li><li>  . </li></ul><br><p>  Inconvénients: </p><br><ul><li>  .   Web-   . </li></ul><br><h3 id="box-backuphttpswwwboxbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Box Backup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/4e/o-/ta/4eo-taslxisuzzofmwhmmjtjxmk.png"></a> </p><br><p>       . <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> . </p><br><p>   : </p><br><ul><li>                 ,  . </li><li>  ,  TLS,   ,     SSL . </li><li>    ,   "" ,    . </li><li>      . </li><li> ,   :   ,   . </li><li>      ,    . </li><li>  . </li><li>      :     . </li><li>      RAID. </li><li>  *nix-like , Windows native, Windows cygwin. </li><li>   GUI. </li></ul><br><p>  Inconvénients: </p><br><ul><li>     ,    UID.       ,    . </li><li>  Web-. </li></ul></div></div><br><p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">UrBackup</a> . <br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </p><br><p>           . </p><br><h3 id="nastroyka-servera-urbackup">   UrBackup </h3><br><p>        ,   : </p><br><pre> <code class="plaintext hljs"># zfs create -o com.sun:auto-snapshot=false -p tank0/apps/backup # zfs set compression=on tank0/apps/backup</code> </pre> <br><p>   ,     ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  UrBackup  ZFS </a> . </p><br><p>   ,            : </p><br><pre> <code class="plaintext hljs"># zfs set dedup=on tank0/apps/backup</code> </pre> <br><p>     UrBackup  : </p><br><pre> <code class="plaintext hljs"># mkdir /tank0/docker/services/urbackup # cd /tank0/docker/services/urbackup # vim docker-compose.yml # docker-compose up -d</code> </pre> <br><p>   docker-compose  . <br>     Web-      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> . </p><br><div class="spoiler">  <b class="spoiler_title">docker-compose.yml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">version: '2' networks: docker0: external: name: docker0 services: urbackup: uroni/urbackup-server image: restart: always expose: - 55414 ports: # - 55413:55413 - 55415:55415 - 35623:35623/udp volumes: - /tank0/apps/backup/urbackup/database:/var/urbackup - /tank0/apps/backup/urbackup/backups:/backups - /tank0/apps/backup/urbackup/log:/var/log - /etc/localtime:/etc/localtime:ro networks: - docker0 environment: - VIRTUAL_HOST=backup.* - VIRTUAL_PORT=55414 - VIRTUAL_PROTO=http - CERT_NAME=NAS.cloudns.cc - TZ=Europe/Moscow</code> </pre> </div></div><br><p>  Docker  <code>uroni/urbackup-server</code>  ,      <code>tristanteu/urbackup-docker</code> . <br>       . </p><br><p> ,      : </p><br><ol><li>  .           UrBackup  LDAP . </li><li>    LDAP.  LDAP  .  "   ".  ,      . </li><li>   . </li><li>       ,  .   .     .  ,       NAS,     . </li><li>  -. </li></ol><br><p>   : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/03/xx/3d/03xx3dgvb6xtswdsfejbdakwwkg.png"></a> </p><br><p>  : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/um/0u/1h/um0u1h_i9ikrjhpgt-ppfyjubzs.png" alt="Ajouter un administrateur"></a> </p><br><p> LDAP    ,     :     ,         . </p><br><p>      : </p><br><pre> <code class="bash hljs">ou=users,dc=nas,dc=nas?memberOf,objectClass?sub?(&amp;(memberOf=cn=users_backup,ou=groups,dc=nas,dc=nas)(uid={USERNAME}))</code> </pre> <br><p>   - ,    . </p><br><p> <a href=""><img src="https://habrastorage.org/webt/az/wb/0q/azwb0qxoafmccqrzs1iyrchpi2q.png" alt="Configuration LDAP"></a> </p><br><p>     ,      ,       . <br>       ,     : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/xi/cx/vn/xicxvnphcifc4z8ocwwrem8hqei.png"></a> </p><br><p>  -: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/sp/vk/uc/spvkuc8fxj9-vxldm4k9qmb7c6o.png"></a> </p><br><p>  ,     ,        . </p><br><p> ,  UrBackup: </p><br><ul><li>  TCP 55415 —   . </li><li>  TCP 55414 — Web-  HTTP. </li><li>  TCP 55413 — Web-  FastCGI,        Web-.  Parce que    NAS  HTTP/HTTPS,    . </li><li>  TCP 35621 —           . </li><li>  UDP 35622 —       .        .      . </li><li>  TCP 35623 —              . </li><li>  UDP 35623 —    . </li></ul><br><p> ,  55415    ,   35621, 35622, 35623         . </p><br><h3 id="ustanovka-agenta">   </h3><br><p>            ,      . </p><br><p>     : </p><br><ul><li>   , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>  shell . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  GUI</a> ,    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Docker-</a> . </li></ul><br><p>   UrBackup , ..      ,            : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/-k/e3/k4/-ke3k4w2aornwpmehottv2shgxk.png" alt="Page de téléchargement de l'agent"></a> </p><br><p>      . </p><br><p>     shell : </p><br><pre> <code class="bash hljs">TF=`mktemp` &amp;&amp; wget <span class="hljs-string"><span class="hljs-string">"https://NAS.system.cloudns.cc/x?a=download_client&amp;lang=ru&amp;clientid=1&amp;authkey=KEY&amp;os=linux"</span></span> -O <span class="hljs-variable"><span class="hljs-variable">$TF</span></span> &amp;&amp; sh <span class="hljs-variable"><span class="hljs-variable">$TF</span></span>; rm <span class="hljs-variable"><span class="hljs-variable">$TF</span></span></code> </pre> <br><p>         : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># urbackupclientctl status { "capability_bits": 65548, "finished_processes": [], "internet_connected": true, "internet_status": "connected", "last_backup_time": 0, "running_processes": [], "servers": [], "time_since_last_lan_connection": 152446032 }</span></span></code> </pre> <br><p>    NAS     ,   : </p><br><ul><li>  : <code>/etc;/home;/var;/root;/tank0/apps;/tank0/docker</code> . </li><li> : <code>/tank0/apps/backup;/tank1/apps/backup;/tank0/apps/cloud/nextcloud/html/data</code> . </li></ul><br><p>       ,   ,  ,    ,  ,     . </p><br><p>  ,     ,  , "  ",  ,   : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/qr/np/ts/qrnptsrut7fv4rumu7rde8fwypm.png"></a> </p><br><p>       : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend status ● urbackupclientbackend.service - UrBackup Client backend Loaded: loaded (/lib/systemd/system/urbackupclientbackend.service; enabled; vendor preset: enabled) Active: active (running) since Mon 2019-09-30 21:55:53 MSK; 37min ago Main PID: 1694 (urbackupclientb) Tasks: 14 (limit: 4915) Memory: 13.4G CGroup: /system.slice/urbackupclientbackend.service └─1694 /usr/local/sbin/urbackupclientbackend --config /etc/default/urbackupclient --no-consoletime  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/   .djvu"  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/  .doc"  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/-.fb2"</span></span></code> </pre> <br><h3 id="problemy">  Les problèmes </h3><br><p>  , UrBackup       ,   .     . <br>    —    -,    . </p><br><div class="spoiler"> <b class="spoiler_title">    ...</b> <div class="spoiler_text"><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend status ● urbackupclientbackend.service - UrBackup Client backend Loaded: loaded (/lib/systemd/system/urbackupclientbackend.service; enabled; vendor preset: enabled) Active: active (running) since Mon 2019-09-30 20:36:54 MSK; 9s ago Main PID: 27034 (urbackupclientb) Tasks: 10 (limit: 4915) Memory: 6.1M CGroup: /system.slice/urbackupclientbackend.service └─27034 /usr/local/sbin/urbackupclientbackend --config /etc/default/urbackupclient --no-consoletime  30 20:36:54 host urbackupclientbackend[27034]: urbackupserver: Server started up successfully!  30 20:36:54 host urbackupclientbackend[27034]: FileSrv: Server started up successfully  30 20:36:54 host urbackupclientbackend[27034]: Started UrBackupClient Backend...  30 20:36:55 host urbackupclientbackend[27034]: Looking for old Sessions... 2 sessions  30 20:36:56 host urbackupclientbackend[27034]: Trying to connect to internet server "NAS.system.cloudns.cc" at port 55415  30 20:36:56 host urbackupclientbackend[27034]: Successfully connected.  30 20:36:56 host urbackupclientbackend[27034]: ERROR: Internet server auth failed. Error: Auth failed (Authkey/password wrong)  30 20:36:56 host urbackupclientbackend[27034]: InternetClient: Had an auth error  30 20:36:56 host urbackupclientbackend[27034]: ERROR: Internet server auth failed. Error: Auth failed (Authkey/password wrong)  30 20:36:56 host urbackupclientbackend[27034]: InternetClient: Had an auth error</span></span></code> </pre> </div></div><br><p>     : </p><br><pre> <code class="bash hljs">ERROR: Internet mode not enabled. Please <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"internet_mode_enabled"</span></span> to <span class="hljs-string"><span class="hljs-string">"true"</span></span>.</code> </pre> <br><p>             . </p><br><p>        : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend stop ~# rm -rf /usr/local/var/urbackup/</span></span></code> </pre> <br><p>      <code>/etc/default/urbackupclient</code> ,     . </p><br><p>          ,     <code>/usr/local/var/urbackup/data/settings.cfg</code> . </p><br><p>   ,    ,     : </p><br><pre> <code class="plaintext hljs">internet_server=NAS.system.cloudns.cc internet_server_port=55415 internet_authkey=44R3MUIdB computername=zenbook internet_mode_enabled=true</code> </pre> <br><p>   ,   ,     -. <br>  ,     ,   ,      . </p><br><h3 id="zapusk-polnogo-rezervnogo-kopirovaniya-posle-obnovleniya">       </h3><br><p>  Debian,    ,       <code>/etc/apt/apt.conf.d/80full-backup</code> : </p><br><pre> <code class="python hljs">DPkg::Post-Invoke {<span class="hljs-string"><span class="hljs-string">"test -x /usr/local/bin/urbackupclientctl &amp;&amp; /usr/local/bin/urbackupclientctl start -f || true"</span></span>; };</code> </pre> <br><h3 id="rezervnaya-kopiya-routera">    </h3><br><p>    NAS,    .  ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mtbackup</a>  SSH,    NAS. <br>    Python    ,   ,    ,    UrBakup,   . </p><br><h3 id="proverka-vosstanovleniya">   </h3><br><p>   : </p><br><ul><li> . </li><li> . </li></ul><br><p> ,     :         .  ,    . </p><br><p>    ,   : </p><br><ul><li>    . </li><li>    ,   . </li><li>    . </li><li>  ,   ,   . </li><li>    . </li><li>   . </li><li>   ,   . </li></ul><br><p>   ,   - ,     . </p><br><h2 id="oblachnye-servisy-dlya-rezervirovaniya">     </h2><br><p><img src="https://habrastorage.org/webt/ms/no/j4/msnoj4lqhhfm-keodwyhhdoaudm.jpeg"></p><br><p>       . <br>      ,        ,          . <br>       -  ,     ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Storj</a> . </p><br><h2 id="literatura">  Littérature </h2><br><p>     ,       ,     : </p><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">    debian-russian</a> .   ,  "  rsync?". </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">" "</a> . </li><li> " 3-2-1" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  Veeam</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   </a> . </li><li>  , , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> ,    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   Veeam</a> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://web.archive.org/web/20181201152034/">"    "</a>  ,  ,   . </li><li>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">" :     "</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">    </a> ,          . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">    </a> . </li></ul><br><p> ,     : </p><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">W. Curtis Preston — "Backup &amp; Recovery" — 2000</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> .. —     </a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> . — Backup  "" — 2014</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Steven Nelson — Pro Data Backup and Recovery — 2011</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dorian Cougias — The Backup Book: Disaster Recovery from Desktop to Data Center, 3 edition — 2003</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>      (2017 )  . </li></ul><br><p>      . </p><br><p>       ,          RTO, RPA, RPO. ,    ,         ,      . </p><br><p> -      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   NAS</a> , , ,   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421251/">https://habr.com/ru/post/fr421251/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421241/index.html">La Banque centrale demande le blocage avant procès des sites malveillants</a></li>
<li><a href="../fr421243/index.html">LLTR Partie 2: Algorithme pour déterminer la topologie du réseau à partir des statistiques collectées</a></li>
<li><a href="../fr421245/index.html">C #: un cas d'utilisation pour n'importe quelle tâche</a></li>
<li><a href="../fr421247/index.html">Comment transformer des graphiques en son et pourquoi en avez-vous besoin</a></li>
<li><a href="../fr421249/index.html">Pourquoi les financiers de Wall Street travaillent trop et peuvent-ils être corrigés</a></li>
<li><a href="../fr421253/index.html">Pourquoi avons-nous besoin de voitures à queue?</a></li>
<li><a href="../fr421255/index.html">Elon Musk a abandonné son projet de transformer Tesla en société privée</a></li>
<li><a href="../fr421257/index.html">Comment un réseau international de hackers a gagné 100 millions de dollars en volant des communiqués de presse</a></li>
<li><a href="../fr421259/index.html">Si vous envisagez de commencer à écrire sur Go, voici ce que vous devez savoir</a></li>
<li><a href="../fr421261/index.html">L'effet de l'acrasia: pourquoi nous ne réalisons pas nos plans, et que faire à ce sujet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>