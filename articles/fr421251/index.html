<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßô üôÇ üëêüèº Syst√®me de sauvegarde üßëüèø‚Äçü§ù‚ÄçüßëüèΩ üí± üåù</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article fait partie d'une s√©rie sur la construction de NAS et est √©crit pour un type de syst√®me sp√©cifique. 


 La sauvegarde est la deuxi√®me t√¢ch...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Syst√®me de sauvegarde</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421251/"><p><img src="https://habrastorage.org/webt/in/pk/uh/inpkuhyjnf8c-efshdvkj_edp7m.jpeg"></p><br><p>  Cet article fait partie d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">s√©rie sur la construction de NAS</a> et est √©crit pour un type de syst√®me sp√©cifique. </p><br><p>  La sauvegarde est la deuxi√®me t√¢che principale que je voulais r√©soudre en utilisant le NAS, apr√®s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le syst√®me de gestion du r√©f√©rentiel</a> . </p><br><p>  Sa d√©cision a tra√Æn√© en longueur ... </p><br><p>  De nombreux articles et m√™me plusieurs livres ont d√©j√† √©t√© √©crits sur ce sujet, et de nombreux exemplaires ont √©t√© cass√©s lors de diff√©rends √† ce sujet. </p><br><p>  Vous trouverez ci-dessous une tentative de comprendre ce tas de mat√©riel, de le mettre dans votre t√™te et de construire un petit syst√®me de mani√®re relativement comp√©tente. </p><a name="habracut"></a><br><p>  Le syst√®me de sauvegarde (SRK) est d√©termin√© par: </p><br><ul><li>  Politique de sauvegarde.  La politique d√©finit les principaux buts et objectifs de la sauvegarde, ses exigences, sur la base de la liste des menaces pour chaque syst√®me de sauvegarde, et justifie √©galement sa n√©cessit√©. </li><li>  R√®glements de sauvegarde bas√©s sur des r√®gles.  Le r√®glement d√©crit les algorithmes de sauvegarde et de r√©cup√©ration responsables des sauvegardes, les conditions de stockage des sauvegardes, etc. </li><li>  Impl√©mentation instrumentale.  En fait, logiciel et mat√©riel. </li></ul><br><p>  Le processus de sauvegarde r√©gulier est divis√© en plusieurs parties principales: </p><br><ul><li>  D√©but p√©riodique de la copie. </li><li>  Commencez la r√©cup√©ration √† la demande. </li><li>  Test du processus de copie. </li></ul><br><p>  Points d'interface du syst√®me avec la plateforme NAS: </p><br><ul><li> <code>tank0/apps/backup</code> - stockage de <code>tank0/apps/backup</code> . </li><li>  <code>tank1/apps/backup</code> - stockage de <code>tank1/apps/backup</code> . </li><li>  <code>https://backup.NAS.cloudns.cc</code> - Interface syst√®me bas√©e sur le Web. </li></ul><br><p>  Les r√©f√©rentiels de sauvegarde sont <strong>des syst√®mes de fichiers distincts</strong> . <br>  Cela est n√©cessaire car leurs options peuvent √™tre tr√®s diff√©rentes, √† la fois des syst√®mes de fichiers normaux et entre eux. </p><br><p>  Par exemple, si n√©cessaire, la d√©duplication au moyen de FS peut √™tre activ√©e et la compression peut √™tre d√©sactiv√©e. </p><br><h2 id="principy-rezervnogo-kopirovaniya">  Principes de sauvegarde </h2><br><p><img src="https://habrastorage.org/webt/t-/pe/i4/t-pei4njc4jilp-l0unqmcpanho.jpeg"></p><br><p>  Il vaut la peine de comprendre que bien que je d√©crive ici un cas particulier de sauvegarde adapt√© aux besoins d'un petit r√©seau, les principes, les observations et les mod√®les sont partout communs. <br>  Dans les cas simples, certains d'entre eux peuvent √™tre n√©glig√©s, mais il est souhaitable de le savoir. </p><br><p>  Ces principes sont bas√©s sur des politiques et des r√©glementations. </p><br><p>  Voici quelques principes de base: </p><br><ul><li>  <strong>3-2-1</strong> .  Effectuez au moins trois sauvegardes, dans deux formats de stockage, dont au moins une doit √™tre stock√©e dans un endroit physiquement s√©par√©.  Le principe est souhaitable √† observer.  Dans mon cas, ce principe est partiellement mis en ≈ìuvre.  Premi√®rement, il existe trois machines diff√©rentes sur lesquelles les donn√©es sont partiellement dupliqu√©es: NAS, travail et ordinateur portable.  Deuxi√®mement, la r√©plication vers le cloud est pr√©vue. </li><li>  <strong>V√©rifiez ce qui a √©t√© copi√©</strong> .  Sinon, il peut arriver qu'√† un moment crucial, les donn√©es ne puissent pas √™tre restaur√©es.  V√©rifiez mieux tout au long du processus de r√©cup√©ration. </li><li>  <strong>Utilisez les bons outils pour la t√¢che</strong> .  Il est probable qu'avec la copie d'un parc de machines virtuelles, un syst√®me de copie de fichiers avec un agent sur une machine fonctionnera mal.  Un logiciel sp√©cialis√© copiera plus rapidement et moins cher sur les ressources de la machine.  Il est important que l'outil soit fiable et simple.  IBS n'est pas quelque chose avec lequel vous voulez habituellement creuser. </li><li>  <strong>Il vaut mieux tout copier, √† l'exception √©vidente de l'exc√®s</strong> .  Ou "il vaut mieux d√©passer que ne pas finir".  Il sera possible de jeter l'exc√©dent, mais si la politique inverse est utilis√©e, il peut √™tre impossible de restaurer un fichier pr√©cieux que vous avez oubli√© de sp√©cifier explicitement. </li><li>  <strong>Il devrait √™tre possible de s√©lectionner et de restaurer rapidement les donn√©es</strong> .  Il est conseill√©, "un clic", et de ne pas attendre une heure.  Officiellement, vous devez avoir un RTO suffisamment bas et un RPO suffisant.  Il est extr√™mement pratique si l'IBS vous permet de restaurer accidentellement supprim√©, et de choisir parmi plusieurs versions, et pas seulement la derni√®re (par exemple, s'il est endommag√©, car les erreurs logiques ne sont pas exclues). </li></ul><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√Ä la fin de l'article,</a> il y a des liens vers des sources que vous pouvez √©tudier afin de vous familiariser plus compl√®tement avec ces points, ainsi que de lire sur d'autres. </p><br><h2 id="politika-rezervnogo-kopirovaniya">  Politique de sauvegarde </h2><br><p>  De toute √©vidence, l'objectif de toute sauvegarde est de r√©duire le co√ªt de la destruction non planifi√©e des donn√©es dans les situations d'urgence. </p><br><p>  Ceci est r√©alis√© en dupliquant les donn√©es pr√©cieuses des machines en fonctionnement vers le stockage tiers. </p><br><h3 id="zadachi-rezervnogo-kopirovaniya">  T√¢ches de sauvegarde </h3><br><p>  Les t√¢ches suivantes sont d√©finies √† des fins de sauvegarde: </p><br><ul><li>  Mettez en surbrillance les donn√©es cibles. </li><li>  Enregistrement des donn√©es sp√©cifi√©es pour une r√©cup√©ration ult√©rieure. </li><li>  R√©cup√©ration des donn√©es enregistr√©es. </li><li>  Assurer la stabilit√© des donn√©es stock√©es au changement et √† la destruction. </li><li>  Diff√©renciation de l'acc√®s aux donn√©es stock√©es. </li><li>  Assurer le contr√¥le du syst√®me et le processus de sauvegarde. </li></ul><br><h3 id="trebovaniya-k-sisteme">  Configuration requise </h3><br><p>  Plus loin dans la liste, les exigences fonctionnelles et non fonctionnelles sont m√©lang√©es: </p><br><ul><li>  La sauvegarde doit √™tre effectu√©e: <br><ul><li>  Dans les d√©lais. </li><li>  Sur demande. </li><li>  Si vous sautez le pr√©c√©dent. </li></ul></li><li>  La sauvegarde des donn√©es doit √™tre effectu√©e au moins 1 fois par jour jusqu'√† une profondeur d'un mois.  La pratique de prendre des instantan√©s, ainsi que d'utiliser la version pr√©c√©dente du syst√®me sur une machine qui fonctionne, montre que cela me suffit. </li><li>  Le temps de r√©cup√©ration des donn√©es ne doit pas d√©passer 2 minutes pour 1 Go (la limite de bande passante r√©seau est de 81 s. Pour 1 Go).  Prise en compte de la bande passante LAN et de la vitesse du disque, comme facteurs limitants. </li><li>  Tous les canaux doivent √™tre crypt√©s.  Les donn√©es sensibles, telles que les donn√©es d'autorisation dans les services en ligne, peuvent √™tre enregistr√©es. </li><li>  Il devrait √™tre possible de chiffrer les sauvegardes des utilisateurs avec une cl√© secr√®te sur la machine de l'utilisateur, sans possibilit√© de d√©chiffrement sur le serveur.  Ceci est important car les utilisateurs ne sont pas oblig√©s de faire confiance au serveur du tout. </li><li>  Une copie incompl√®te ne devrait pas prendre beaucoup de temps, par exemple plus de 30 minutes.  Internet est utilis√© pour copier des donn√©es √† partir d'un ordinateur portable. </li><li>  Il devrait √™tre possible de r√©pliquer des copies sur le cloud (la possibilit√© de configurer de mani√®re flexible la r√©plication pour un stockage cloud particulier) avec le cryptage des sauvegardes.  C'est aussi l'une des cons√©quences du ¬´principe 3-2-1¬ª. </li><li>  Il devrait y avoir une gestion centralis√©e simple avec int√©gration dans l'interface Web. </li><li>  Un minimum d'am√©liorations et de param√®tres complexes sur le serveur. </li></ul><br><h3 id="sostav-rezerviruemyh-resursov">  Composition des ressources r√©serv√©es </h3><br><p>  Dans mon cas, c'est assez typique: </p><br><ul><li>  La principale machine de travail.  Ordinateur de bureau. </li><li>  Machine de travail mobile.  L'ordinateur portable. </li><li>  Routeur LAN.  Il stocke les param√®tres r√©seau, qui peuvent contenir des identifiants et des mots de passe pour une connexion Internet et certains services. </li><li>  NAS  Oui, la configuration NAS est √©galement redondante.  Malgr√© le fait que la plupart des FS ont des instantan√©s. </li></ul><br><h3 id="sostav-ugroz">  Composition de la menace </h3><br><p>  C'est o√π, quoi et quoi prot√©ger et de quelle mani√®re. </p><br><div class="spoiler">  <b class="spoiler_title">Pour ce faire, j'ai compil√© un petit tableau des menaces.</b> <div class="spoiler_text"><div class="scrollable-table"><table><thead><tr><th>  Ressource </th><th>  Menace </th><th>  Solution </th></tr></thead><tbody><tr><td>  Machine principale de travail </td><td>  Corruption des donn√©es physiques </td><td>  Sauvegarde des donn√©es et param√®tres cl√©s </td></tr><tr><td>  Machine principale de travail </td><td>  Corruption partielle et imperceptible des donn√©es </td><td>  Conserver les anciennes sauvegardes pendant un certain temps </td></tr><tr><td>  Machine principale de travail </td><td>  Perte d'acc√®s aux donn√©es </td><td>  Stockage de l'image compl√®te de la machine, ou des <strong>param√®tres, pour une rotation rapide sur une autre machine</strong> , ou duplication des fonctions sur un PC mobile </td></tr><tr><td>  Machine principale de travail </td><td>  Acc√®s physique non autoris√© aux donn√©es </td><td>  Chiffrement des donn√©es et des sauvegardes, transfert de copie chiffr√© </td></tr><tr><td>  Machine principale de travail </td><td>  Acc√®s non autoris√© via une violation de logiciel </td><td>  R√©servation des sommes de contr√¥le des logiciels et rapprochement p√©riodique, syst√®mes de contr√¥le (pas encore impl√©ment√©s) </td></tr><tr><td>  Machine de travail mobile </td><td>  Perdre une voiture avec des donn√©es </td><td>  Cryptage des donn√©es, sauvegarde compl√®te ou sauvegarde des param√®tres et donn√©es cl√©s </td></tr><tr><td>  Routeur LAN </td><td>  Destruction d'une configuration ou d'un appareil </td><td>  Redondance de configuration, redondance d'appareil possible </td></tr><tr><td>  Routeur LAN </td><td>  Perte de contr√¥le due au piratage </td><td>  R√©servation de configuration </td></tr><tr><td>  Routeur LAN </td><td>  Corruption partielle et invisible des donn√©es </td><td>  Stockage de la somme de contr√¥le des logiciels et r√©conciliation p√©riodique </td></tr><tr><td>  NAS </td><td>  Param√®tres de service corrompus </td><td>  R√©servation de r√©servation locale </td></tr><tr><td>  NAS </td><td>  Corruption des donn√©es physiques </td><td>  R√©plication cloud </td></tr><tr><td>  NAS </td><td>  Perte d'acc√®s au syst√®me et sauvegardes </td><td>  R√©plication cloud </td></tr><tr><td>  NAS </td><td>  Acc√®s non autoris√© aux donn√©es de tiers </td><td>  Stockage et r√©plication des donn√©es sous forme crypt√©e, √©change de donn√©es sous forme crypt√©e </td></tr><tr><td>  NAS </td><td>  Acc√®s non autoris√© de l'administrateur aux donn√©es </td><td>  Cryptage des sauvegardes sur les cl√©s locales des machines redondantes </td></tr></tbody></table></div></div></div><br><p>  Toutes les principales menaces pesant sur l'ordinateur mobile r√©p√®tent les menaces pesant sur l'ordinateur fixe. <br>  Les tablettes √©lectroniques ne diff√®rent pratiquement pas du mobile, de ce point de vue. </p><br><h3 id="dopolnitelnye-usloviya-politiki">  Conditions de politique suppl√©mentaires </h3><br><p>  Il est conseill√© de les prendre en compte: </p><br><ul><li>  Des tests de r√©cup√©ration r√©guliers doivent √™tre effectu√©s. </li><li>  Les proc√©dures de reprise apr√®s incident doivent √™tre document√©es. </li><li>  Les actions doivent √™tre r√©glement√©es en cas de d√©faillance secondaire: que faire si, apr√®s la restauration, le syst√®me n'est pas op√©rationnel ou si les donn√©es ne peuvent pas √™tre restaur√©es. </li><li>  Il est n√©cessaire de tester si le processus de r√©cup√©ration d√©pend d'un √©quipement sp√©cifique <br>  (qui peut √©chouer au moment de la r√©cup√©ration).  Dans mon cas, je ne v√©rifierai pas cela, limit√© √† une simple v√©rification du syst√®me de base. </li><li>  Si vous disposez d'une sauvegarde compl√®te du syst√®me, vous devez sauvegarder imm√©diatement apr√®s une mise √† niveau substantielle. </li><li>  Si le volume cumul√© de sauvegardes incr√©mentielles d√©passe le volume de sauvegarde compl√®te, il est rationnel d'effectuer une sauvegarde compl√®te non planifi√©e.  Autrement dit, la fr√©quence de cr√©ation de sauvegardes compl√®tes doit √™tre augment√©e dans ce cas. </li></ul><br><p>  Je ne prends pas en compte le dernier point de la politique, car g√©n√©ralement mon flux de travail ne change pas, et il suffit de surveiller le volume pendant un certain temps, uniquement pour la configuration initiale. <br>  Empiriquement, il a √©t√© constat√© que le sch√©ma "mois, semaine, jour, heure" me convenait parfaitement. <br>  Pour les syst√®mes plus importants, vous devrez peut-√™tre modifier la fr√©quence de sauvegarde de mani√®re dynamique pour chaque syst√®me. </p><br><h2 id="reglament-rezervnogo-kopirovaniya">  R√®glements de sauvegarde </h2><br><p>  Apr√®s l'√©laboration d'une politique, il est possible de proc√©der directement √† l'√©laboration d'un r√®glement. <br>  Dans le cas g√©n√©ral, il peut y avoir plusieurs r√©glementations: g√©n√©rales, pour les administrateurs IBS, pour les utilisateurs, pour les responsables du stockage, pour les administrateurs des syst√®mes cibles, etc ... <br>  Mais dans le cas d'un petit syst√®me, il s'agit g√©n√©ralement d'une seule personne, et donc il n'y a qu'une seule r√©glementation. </p><br><h3 id="zadachi-reglamenta">  Les objectifs de la r√©glementation </h3><br><ul><li>  D√©finition des proc√©dures de sauvegarde des donn√©es. </li><li>  D√©finition des proc√©dures de r√©cup√©ration de donn√©es. </li><li>  D√©finition d'une proc√©dure de v√©rification de l'int√©grit√© du syst√®me. </li><li>  Conditions de stockage de sauvegarde et exigences relatives aux supports. </li><li>  Rationaliser le travail. </li></ul><br><h3 id="primer-reglamenta">  Exemple de r√©gulation </h3><br><p>  Sous le spoiler, vous pouvez voir √† quoi ressemblent les r√®gles dans une grande organisation, en utilisant l'exemple <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://web.archive.org/web/20160731233007/">de la r√©glementation Rosreestr tir√©e de sources ouvertes</a> . </p><br><div class="spoiler">  <b class="spoiler_title">R√©glementation de Rosreestr.</b> <div class="spoiler_text"><h1 id="reglament-rezervnogo-kopirovaniya-dannyh-v-territorialnyh-podrazdeleniyah-rosreestra">  R√âGLEMENTATION DE LA SAUVEGARDE DES DONN√âES DANS LES D√âPARTEMENTS TERRITORIAUX DE ROSRESTR </h1><br><h2 id="oglavlenie">  Table des mati√®res </h2><br><ol><li>  Dispositions g√©n√©rales </li><li>  Ordre de sauvegarde. </li><li>  Suivi des r√©sultats. </li><li>  Support r√©glementaire. </li><li>  Rotation des supports de sauvegarde. </li><li>  Restaurez les informations √† partir d'une sauvegarde. </li><li>  Annexe 1 </li><li>  Annexe 2 Liste des personnes responsables de la sauvegarde. </li></ol><br><h2 id="1--obschie-polozheniya">  <strong>1</strong> G√©n√©ral </h2><br><p>  Ce r√®glement √©tablit les exigences de base pour l'organisation de la sauvegarde (r√©cup√©ration) des programmes et des donn√©es stock√©s dans les bases de donn√©es sur les serveurs de l'autorit√© territoriale de Rosreestr, ainsi que pour la sauvegarde du mat√©riel. </p><br><p>  Le pr√©sent r√®glement vise √†: </p><br><ul><li>  d√©termination de la cat√©gorie des informations soumises √† une sauvegarde obligatoire; </li><li>  d√©terminer la proc√©dure de sauvegarde des donn√©es pour la restauration ult√©rieure des performances des syst√®mes d'information en cas de perte totale ou partielle d'informations provoqu√©e par des pannes ou des dysfonctionnements du mat√©riel ou des logiciels, des erreurs des utilisateurs, des urgences (incendie, catastrophes naturelles, etc.); </li><li>  d√©terminer la proc√©dure de r√©cup√©ration des informations en cas de besoin; </li><li>  rationaliser les travaux et d√©terminer la responsabilit√© des fonctionnaires concernant la sauvegarde et la restauration des informations. </li></ul><br><p>  La sauvegarde des informations signifie la cr√©ation de copies compl√®tes des bases de donn√©es de production de l'Office pour la r√©cup√©ration rapide du syst√®me de gestion de l'information du Registre d'√âtat unifi√© des entreprises AIS "Justice" en cas d'urgence entra√Ænant des dommages ou des pertes de donn√©es. </p><br><p>  Toutes les bases de donn√©es de production de tous les services territoriaux de l'Office peuvent faire l'objet d'une sauvegarde. </p><br><p>  Les supports de stockage de la machine contenant une copie de sauvegarde se voient attribuer un tampon de confidentialit√© pour le tampon le plus √©lev√© d'informations qu'ils contiennent. </p><br><p>  Les sauvegardes sont stock√©es √† l'ext√©rieur de la salle des serveurs, l'acc√®s aux sauvegardes est limit√©.  La liste des personnes ayant acc√®s aux donn√©es est √©tablie sur la base d'une demande √©crite du chef de l'unit√© informatique (IT), convenue avec le chef de l'unit√© s√©curit√© informatique (SI).  Les droits d'acc√®s aux moyens techniques, baies et supports de stockage r√©serv√©s sont modifi√©s sur la base d'une demande du chef du service informatique, convenue avec le chef du service SI.  Les tentatives d√©tect√©es d'acc√®s non autoris√© aux informations et au mat√©riel r√©serv√©s, ainsi que les autres violations de SI qui se sont produites pendant le processus de sauvegarde, sont signal√©es √† l'unit√© SI avec une note de service pendant la journ√©e de travail apr√®s la d√©tection de l'√©v√©nement sp√©cifi√©. </p><br><h2 id="2-poryadok-rezervnogo-kopirovaniya">  <strong>2</strong> Ordre de sauvegarde </h2><br><p>  La sauvegarde est effectu√©e au moyen d'Oracle DBMS.  La sauvegarde peut √™tre effectu√©e: </p><br><ul><li>  Manuellement - l'op√©rateur responsable de la sauvegarde d√©marre la proc√©dure d'exportation Oracle (un exemple de d√©marrage de la proc√©dure dans l'annexe 1). </li><li>  Automatiquement - le fichier ex√©cutable qui appelle la proc√©dure d'exportation Oracle est lanc√© automatiquement par le syst√®me d'exploitation selon le calendrier. </li></ul><br><p>  La sauvegarde de la base de donn√©es est effectu√©e au moins 1 fois par jour.  La p√©riode de stockage de la base de donn√©es de sauvegarde est d'au moins 1 mois. </p><br><p>  La strat√©gie de sauvegarde doit garantir la r√©cup√©ration synchrone des donn√©es situ√©es dans diff√©rents sch√©mas de base de donn√©es.  Par exemple, le sch√©ma HED (le r√©f√©rentiel de documents √©lectroniques) doit √™tre copi√© simultan√©ment avec le sch√©ma AIS Justice. </p><br><p>  Le mat√©riel et les moyens techniques du syst√®me de sauvegarde doivent fournir des performances suffisantes pour enregistrer les informations, √† temps et √† des intervalles sp√©cifi√©s.  Les personnes charg√©es d'organiser quotidiennement la sauvegarde contr√¥lent la disponibilit√© de l'espace disque n√©cessaire √† la sauvegarde. </p><br><h2 id="3-kontrol-rezultatov">  <strong>3</strong> Suivi des r√©sultats </h2><br><p>  Les r√©sultats de toutes les proc√©dures de sauvegarde sont contr√¥l√©s par les responsables responsables sp√©cifi√©s √† l'annexe 2, jusqu'√† 10 heures le jour ouvrable suivant la date fix√©e pour l'ex√©cution de ces proc√©dures. </p><br><p>  Si une erreur est d√©tect√©e, la personne responsable du suivi des r√©sultats le signale au service d'assistance technique du d√©veloppeur au plus tard 11 heures de la journ√©e de travail en cours. </p><br><h2 id="4-normativno-pravovoe-obespechenie">  <strong>4</strong> Assistance r√©glementaire </h2><br><p>  Pour organiser le processus de sauvegarde, vous devez: </p><br><ul><li>  D√©finissez une liste de personnes responsables de l'ex√©cution du processus de sauvegarde et du suivi de ses r√©sultats (annexe 2). </li><li>  Pr√©parez et approuvez un calendrier de sauvegarde. </li><li>  Pr√©parer et approuver les documents r√©glementaires internes sur la nomination des responsables de la sauvegarde des donn√©es. </li></ul><br><h2 id="5-rotaciya-nositeley-rezervnoy-kopii">  <strong>5</strong> Supports de sauvegarde rotatifs </h2><br><p>  Le syst√®me de sauvegarde doit permettre de remplacer (d√©charger) p√©riodiquement les supports de sauvegarde sans perdre d'informations sur ceux-ci, et √©galement assurer la r√©cup√©ration des informations actuelles des syst√®mes automatis√©s en cas de d√©faillance de l'un des p√©riph√©riques de sauvegarde.  Toutes les proc√©dures de chargement, de d√©chargement des supports du syst√®me de sauvegarde, ainsi que leur transfert vers le service de s√©curit√© et vice versa, sont effectu√©es par l'administrateur de sauvegarde sur demande et en pr√©sence d'un employ√© responsable du service de s√©curit√© du client (conform√©ment √† l'annexe n ¬∞ 2). </p><br><p>  En tant que nouveaux transporteurs, il est permis de r√©utiliser ceux pour lesquels la p√©riode de stockage des informations contenues a expir√©. </p><br><p>  Les informations confidentielles provenant de supports qui ne sont plus utilis√©s dans le syst√®me de sauvegarde doivent √™tre effac√©es √† l'aide du logiciel PGP. </p><br><h2 id="6-vosstanovlenie-informacii-iz-rezervnoy-kopii">  <strong>6</strong> Restaurer les informations √† partir d'une sauvegarde </h2><br><p>  Si n√©cessaire, la restauration des donn√©es √† partir des sauvegardes est effectu√©e par l'employ√© responsable du service informatique sp√©cifi√© √† l'annexe n ¬∞ 2. </p><br><p>  La r√©cup√©ration des donn√©es √† partir des sauvegardes se produit en cas de disparition ou de violation en raison d'un acc√®s non autoris√© au syst√®me, d'une exposition aux virus, d'erreurs logicielles, d'erreurs des employ√©s et de pannes mat√©rielles. </p><br><p>  La restauration des logiciels syst√®me et des logiciels √† usage g√©n√©ral est effectu√©e √† partir de leurs supports conform√©ment aux instructions du fabricant. </p><br><p>  La restauration des logiciels sp√©cialis√©s est effectu√©e √† partir des supports de distribution ou de leurs copies de sauvegarde conform√©ment aux instructions d'installation ou de restauration de ce logiciel. </p><br><p>  Les informations qui ne sont pas li√©es √† des bases de donn√©es en constante √©volution sont restaur√©es √† partir du support de sauvegarde.  Il utilise la derni√®re copie des informations. </p><br><p>  En cas de violation partielle ou de disparition des enregistrements de la base de donn√©es, la restauration est effectu√©e √† partir de la derni√®re copie quotidienne non perturb√©e.  Toutes les informations sont restaur√©es √† partir de la derni√®re copie. </p><br><h2 id="7-prilozhenie-1">  <strong>7</strong> Annexe 1 </h2><br><p>  Un exemple de d√©marrage de l'utilitaire d'exportation Oracle √† partir de la ligne de commande: </p><br><p>  exp userid = JUST_USER / PASSWORD @ SERVER owner = (JUST_USER, HED_USER) direct = Y coh√©rent = statistiques Y = NONE compress = fichier N = C: \ BACKUP.DMP log = C: \ BACKUP.LOG </p><br><p>  o√π: </p><br><p>  JUST_USER / PASSWORD @ SERVER <em>-</em> schema_owner_name / password @ server_name; </p><br><p>  owner = (JUST_USER, HED_USER) - une liste des sch√©mas copi√©s; dans cet exemple, le sch√©ma AIS Justice et le sch√©ma HED sont export√©s simultan√©ment; </p><br><p>  file = C: \ BACKUP.DMP <em>-</em> chemin et nom du fichier d'exportation cr√©√©; </p><br><p>  log = C: \ BACKUP.LOG <em>-</em> chemin et nom du fichier journal d'exportation cr√©√©. </p><br><h2 id="8-prilozhenie-2-perechen-lic-otvetstvennyh-za-rezervnoe-kopirovanie">  <strong>8</strong> Annexe 2. Liste des personnes responsables de la sauvegarde </h2><br><div class="scrollable-table"><table><thead><tr><th>  <strong>Non p / p</strong> </th><th>  <strong>R√¥le</strong> </th><th>  <strong>Nom de l'officier responsable</strong> </th></tr></thead><tbody><tr><td>  1 </td><td>  Configuration initiale du syst√®me de sauvegarde. </td><td></td></tr><tr><td>  2 </td><td>  Apporter des modifications importantes √† la configuration du syst√®me de sauvegarde. </td><td></td></tr><tr><td>  3 </td><td>  Analyse des journaux de sauvegarde, suivi de la n√©cessit√© de modifier les param√®tres de sauvegarde, assurant la rotation des supports. </td><td></td></tr><tr><td>  4 </td><td>  Rotation des supports, v√©rification de l'exactitude de la sauvegarde, garantie que la sauvegarde est stock√©e √† l'ext√©rieur du bureau en cas de sinistre. </td><td></td></tr></tbody></table></div></div></div><br><p>  Vous trouverez ici un autre exemple avec une br√®ve description. </p><br><h3 id="procedura-rezervirovaniya">  Proc√©dure de r√©servation </h3><br><p>  Composition des donn√©es de sauvegarde: </p><br><ul><li>  Machines de travail: <br><ul><li>  R√©pertoires d'utilisateurs personnels ( <code>/home/*</code> ).         . </li><li>   . </li><li>    ,   ( <code>/opt</code> ). </li><li>   ( <code>/etc</code> ). </li><li>    . </li><li>  . </li><li>   . </li><li>   . </li></ul></li><li> : <br><ul><li>  . </li></ul></li><li> NAS: <br><ul><li>    Docker . </li><li>   . </li><li>  . </li><li>    . </li><li>  . </li><li>     Docker . </li><li>   . </li><li>    . </li></ul></li><li>  : <br><ul><li>    . </li></ul></li></ul><br><p>  : </p><br><ul><li>       . </li><li>     ,    . </li><li>          <code>/etc/apt/apt.conf.d</code> ,  ,     . </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> Mikrotik</a> . </li><li> NAS    . </li></ul><br><p>  : </p><br><ul><li>     1      .     . <br>  3 . </li><li>     1     . <br>  . </li><li>     1   . <br>  . </li><li>       . <br>  . </li><li>          . <br>    6 ,      . </li></ul><br><h3 id="procedura-vosstanovleniya">   </h3><br><p><img src="https://habrastorage.org/webt/qu/i3/il/qui3ilw9nczsm17-w7d1dwcalhy.jpeg"></p><br><ul><li>        ,  . </li><li>       ,    . </li></ul><br><p>        : </p><br><ul><li>   live . </li><li>        . </li><li>     ,  . </li></ul><br><p>  ,           Debian   (  Squeeze  2011 ),           Slackware  ReiserFS    . </p><br><p>       : </p><br><ul><li>    ,  . </li><li>       . </li><li>   ,    . </li><li>       . </li></ul><br><p> Mikrotik   ,    RouterOS . </p><br><h3 id="procedura-proverki-rabotosposobnosti">    </h3><br><ul><li>       . <br>   logcheck, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> . </li><li>          . </li></ul><br><p>       ,    . </p><br><h3 id="usloviya-hraneniya-rezervnyh-kopiy-i-trebovaniya-k-nositelyam">         </h3><br><ul><li>      . </li><li>    1        . <br>              . </li><li>  .     . </li><li>    . </li></ul><br><h2 id="resheniya-dlya-rezervnogo-kopirovaniya">     </h2><br><p>     ,       . </p><br><h3 id="trebovaniya-k-po">    </h3><br><p>      : </p><br><ul><li>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Veeam</a>     ,   ,    .     ,    Acronis,    ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </li><li>             . </li><li>          . </li></ul><br><h3 id="vybor-po">   </h3><br><p>          . <br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </p><br><div class="spoiler"> <b class="spoiler_title">  .</b> <div class="spoiler_text"><h3 id="resheniya-na-baze-unix-utilit"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Solutions utilitaires Unix </font></font></h3><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions bas√©es sur rsync, tar, rdiff-backup, etc. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ne sont pas pris en compte en raison de la grande quantit√© de travail qui devra √™tre fait et du manque de l'interface WEB n√©cessaire.</font></font></p><br><h3 id="bareoshttpswwwbareosorgen"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Breos</font></font></a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/kp/pa/7t/kppa7tts84fep2t5rfk52poagx4.png"></a> </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> BareOS (Backup Archiving Recovery Open Sourced) - fork de Bacula depuis 2010. </font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Avantages: </font></font></p><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Syst√®me stable d√©bogu√©. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Prend en charge plusieurs types d'agents sous diff√©rents syst√®mes d'exploitation. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il prend en charge diff√©rents types de sauvegarde: incr√©mentielle, diff√©rentielle, compl√®te. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L'interface WEB est tr√®s d√©velopp√©e et fonctionnelle. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Configuration flexible. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe un pilote FUSE qui affiche les sauvegardes. </font></font></li><li>    Python,    Director. </li><li>       (, ). </li><li>       . </li><li>     . </li></ul><br><p>  Inconv√©nients: </p><br><ul><li>    . </li><li>   . </li><li>    . </li><li>   ,    . </li><li>   (500+ ),    ,          . </li></ul><br><h3 id="backuppchttpbackuppcsourceforgenet"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BackupPC</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/zi/dv/e4/zidve44-5zrteeqdkiosyigkvwu.png"></a> </p><br><p>    . </p><br><p>   : </p><br><ul><li>    . </li><li>    . </li><li>  Web-. </li><li>    . </li><li> .    ,       . </li><li>   . </li><li>   ,   SMB, rsync. </li><li>      Web-. </li><li>     ,      . </li><li>  ,  ,      . </li><li>   . </li></ul><br><p>  Inconv√©nients: </p><br><ul><li>   Perl,   CPAN. </li><li>    ,    ,     . <br>        ,   ,   ,     .   ,         SSH   ,   ,    , ..      . </li><li>      (  ,    ). </li></ul><br><h3 id="urbackuphttpswwwurbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">UrBackup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/u1/lo/ed/u1loed_wq1-njxjlq1f7ths2kso.png"></a> </p><br><p> -     . </p><br><p>   : </p><br><ul><li>  Configuration simple. </li><li>  Web-. </li><li>    . </li><li>      ( .. ). </li><li>   Windows, Linux, MacOS X. </li><li>    :     ,        . </li><li>     . </li><li>     . </li><li>      (,  Outlook,     ). </li><li>   .    ,       . </li><li>   (,   ..)     . </li><li>  Configuration simple. </li><li>    ,     . </li><li>     ,      . </li><li>   . </li><li>      Internet. </li><li>   (,  ) . </li><li>     . </li><li>     (,   USB ). </li><li>  . </li><li>  GUI     . </li></ul><br><p>  Inconv√©nients: </p><br><ul><li>   Windows,    , . </li><li>      NTFS. </li><li>  LDAP,   ,  ,   AD      . </li></ul><br><h3 id="restichttpsresticnet"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Restic</a> </h3><br><p>         . </p><br><p>   : </p><br><ul><li>  Configuration simple. </li><li>      . </li><li> .    ,       . </li><li>   / .   .    . </li><li>       .    . </li><li>   . </li><li>  FUSE ,       host/. </li></ul><br><p>  Inconv√©nients: </p><br><ul><li> Web- . </li><li>    RAM (~2.7GB  1TB). </li><li>   ACL   . </li><li>     RAM   . </li><li>      (     ). </li><li>       (        ).    . </li><li>       restic. </li></ul><br><h3 id="borgbackuphttpswwwborgbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BorgBackup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/a_/qp/rh/a_qprhceevkysy_nk_xg20os5x0.jpeg"></a> </p><br><p>     . </p><br><p>   : </p><br><ul><li>   . </li><li>        . </li><li>   (   Python,      C  ). </li><li> . </li><li> : LZ4, zlib, LZMA. </li><li>  FUSE ,   . </li><li>     : Linux, macOS, BSD, etc. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> Web-,   </a> . </li><li>    . </li></ul><br><p>  Inconv√©nients: </p><br><ul><li> Web-  . </li><li>     Windows (  Linux subsystem  cygwin). </li></ul><br><h3 id="lsyncdhttpsgithubcomaxkibelsyncd"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lsyncd</a> </h3><br><p> ,      rsync. </p><br><p>   : </p><br><ul><li>  inotify  fsevents    .     rsync   . </li><li>     rsync. </li><li>   Lua,     Lua. </li><li>      . </li><li>  . </li></ul><br><p>  Inconv√©nients: </p><br><ul><li>  .   Web-   . </li></ul><br><h3 id="box-backuphttpswwwboxbackuporg"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Box Backup</a> </h3><br><p> <a href=""><img src="https://habrastorage.org/webt/4e/o-/ta/4eo-taslxisuzzofmwhmmjtjxmk.png"></a> </p><br><p>       . <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> . </p><br><p>   : </p><br><ul><li>                 ,  . </li><li>  ,  TLS,   ,     SSL . </li><li>    ,   "" ,    . </li><li>      . </li><li> ,   :   ,   . </li><li>      ,    . </li><li>  . </li><li>      :     . </li><li>      RAID. </li><li>  *nix-like , Windows native, Windows cygwin. </li><li>   GUI. </li></ul><br><p>  Inconv√©nients: </p><br><ul><li>     ,    UID.       ,    . </li><li>  Web-. </li></ul></div></div><br><p>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">UrBackup</a> . <br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> . </p><br><p>           . </p><br><h3 id="nastroyka-servera-urbackup">   UrBackup </h3><br><p>        ,   : </p><br><pre> <code class="plaintext hljs"># zfs create -o com.sun:auto-snapshot=false -p tank0/apps/backup # zfs set compression=on tank0/apps/backup</code> </pre> <br><p>   ,     ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  UrBackup  ZFS </a> . </p><br><p>   ,            : </p><br><pre> <code class="plaintext hljs"># zfs set dedup=on tank0/apps/backup</code> </pre> <br><p>     UrBackup  : </p><br><pre> <code class="plaintext hljs"># mkdir /tank0/docker/services/urbackup # cd /tank0/docker/services/urbackup # vim docker-compose.yml # docker-compose up -d</code> </pre> <br><p>   docker-compose  . <br>     Web-      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> . </p><br><div class="spoiler">  <b class="spoiler_title">docker-compose.yml</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">version: '2' networks: docker0: external: name: docker0 services: urbackup: uroni/urbackup-server image: restart: always expose: - 55414 ports: # - 55413:55413 - 55415:55415 - 35623:35623/udp volumes: - /tank0/apps/backup/urbackup/database:/var/urbackup - /tank0/apps/backup/urbackup/backups:/backups - /tank0/apps/backup/urbackup/log:/var/log - /etc/localtime:/etc/localtime:ro networks: - docker0 environment: - VIRTUAL_HOST=backup.* - VIRTUAL_PORT=55414 - VIRTUAL_PROTO=http - CERT_NAME=NAS.cloudns.cc - TZ=Europe/Moscow</code> </pre> </div></div><br><p>  Docker  <code>uroni/urbackup-server</code>  ,      <code>tristanteu/urbackup-docker</code> . <br>       . </p><br><p> ,      : </p><br><ol><li>  .           UrBackup  LDAP . </li><li>    LDAP.  LDAP  .  "   ".  ,      . </li><li>   . </li><li>       ,  .   .     .  ,       NAS,     . </li><li>  -. </li></ol><br><p>   : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/03/xx/3d/03xx3dgvb6xtswdsfejbdakwwkg.png"></a> </p><br><p>  : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/um/0u/1h/um0u1h_i9ikrjhpgt-ppfyjubzs.png" alt="Ajouter un administrateur"></a> </p><br><p> LDAP    ,     :     ,         . </p><br><p>      : </p><br><pre> <code class="bash hljs">ou=users,dc=nas,dc=nas?memberOf,objectClass?sub?(&amp;(memberOf=cn=users_backup,ou=groups,dc=nas,dc=nas)(uid={USERNAME}))</code> </pre> <br><p>   - ,    . </p><br><p> <a href=""><img src="https://habrastorage.org/webt/az/wb/0q/azwb0qxoafmccqrzs1iyrchpi2q.png" alt="Configuration LDAP"></a> </p><br><p>     ,      ,       . <br>       ,     : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/xi/cx/vn/xicxvnphcifc4z8ocwwrem8hqei.png"></a> </p><br><p>  -: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/sp/vk/uc/spvkuc8fxj9-vxldm4k9qmb7c6o.png"></a> </p><br><p>  ,     ,        . </p><br><p> ,  UrBackup: </p><br><ul><li>  TCP 55415 ‚Äî   . </li><li>  TCP 55414 ‚Äî Web-  HTTP. </li><li>  TCP 55413 ‚Äî Web-  FastCGI,        Web-.  Parce que    NAS  HTTP/HTTPS,    . </li><li>  TCP 35621 ‚Äî           . </li><li>  UDP 35622 ‚Äî       .        .      . </li><li>  TCP 35623 ‚Äî              . </li><li>  UDP 35623 ‚Äî    . </li></ul><br><p> ,  55415    ,   35621, 35622, 35623         . </p><br><h3 id="ustanovka-agenta">   </h3><br><p>            ,      . </p><br><p>     : </p><br><ul><li>   , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a>  shell . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  GUI</a> ,    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Docker-</a> . </li></ul><br><p>   UrBackup , ..      ,            : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/-k/e3/k4/-ke3k4w2aornwpmehottv2shgxk.png" alt="Page de t√©l√©chargement de l'agent"></a> </p><br><p>      . </p><br><p>     shell : </p><br><pre> <code class="bash hljs">TF=`mktemp` &amp;&amp; wget <span class="hljs-string"><span class="hljs-string">"https://NAS.system.cloudns.cc/x?a=download_client&amp;lang=ru&amp;clientid=1&amp;authkey=KEY&amp;os=linux"</span></span> -O <span class="hljs-variable"><span class="hljs-variable">$TF</span></span> &amp;&amp; sh <span class="hljs-variable"><span class="hljs-variable">$TF</span></span>; rm <span class="hljs-variable"><span class="hljs-variable">$TF</span></span></code> </pre> <br><p>         : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># urbackupclientctl status { "capability_bits": 65548, "finished_processes": [], "internet_connected": true, "internet_status": "connected", "last_backup_time": 0, "running_processes": [], "servers": [], "time_since_last_lan_connection": 152446032 }</span></span></code> </pre> <br><p>    NAS     ,   : </p><br><ul><li>  : <code>/etc;/home;/var;/root;/tank0/apps;/tank0/docker</code> . </li><li> : <code>/tank0/apps/backup;/tank1/apps/backup;/tank0/apps/cloud/nextcloud/html/data</code> . </li></ul><br><p>       ,   ,  ,    ,  ,     . </p><br><p>  ,     ,  , "  ",  ,   : </p><br><p> <a href=""><img src="https://habrastorage.org/webt/qr/np/ts/qrnptsrut7fv4rumu7rde8fwypm.png"></a> </p><br><p>       : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend status ‚óè urbackupclientbackend.service - UrBackup Client backend Loaded: loaded (/lib/systemd/system/urbackupclientbackend.service; enabled; vendor preset: enabled) Active: active (running) since Mon 2019-09-30 21:55:53 MSK; 37min ago Main PID: 1694 (urbackupclientb) Tasks: 14 (limit: 4915) Memory: 13.4G CGroup: /system.slice/urbackupclientbackend.service ‚îî‚îÄ1694 /usr/local/sbin/urbackupclientbackend --config /etc/default/urbackupclient --no-consoletime  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/   .djvu"  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/  .doc"  30 22:33:48 host urbackupclientbackend[1694]: Hashing file "/home/artiom/Docs/Books/-.fb2"</span></span></code> </pre> <br><h3 id="problemy">  Les probl√®mes </h3><br><p>  , UrBackup       ,   .     . <br>    ‚Äî    -,    . </p><br><div class="spoiler"> <b class="spoiler_title">    ...</b> <div class="spoiler_text"><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend status ‚óè urbackupclientbackend.service - UrBackup Client backend Loaded: loaded (/lib/systemd/system/urbackupclientbackend.service; enabled; vendor preset: enabled) Active: active (running) since Mon 2019-09-30 20:36:54 MSK; 9s ago Main PID: 27034 (urbackupclientb) Tasks: 10 (limit: 4915) Memory: 6.1M CGroup: /system.slice/urbackupclientbackend.service ‚îî‚îÄ27034 /usr/local/sbin/urbackupclientbackend --config /etc/default/urbackupclient --no-consoletime  30 20:36:54 host urbackupclientbackend[27034]: urbackupserver: Server started up successfully!  30 20:36:54 host urbackupclientbackend[27034]: FileSrv: Server started up successfully  30 20:36:54 host urbackupclientbackend[27034]: Started UrBackupClient Backend...  30 20:36:55 host urbackupclientbackend[27034]: Looking for old Sessions... 2 sessions  30 20:36:56 host urbackupclientbackend[27034]: Trying to connect to internet server "NAS.system.cloudns.cc" at port 55415  30 20:36:56 host urbackupclientbackend[27034]: Successfully connected.  30 20:36:56 host urbackupclientbackend[27034]: ERROR: Internet server auth failed. Error: Auth failed (Authkey/password wrong)  30 20:36:56 host urbackupclientbackend[27034]: InternetClient: Had an auth error  30 20:36:56 host urbackupclientbackend[27034]: ERROR: Internet server auth failed. Error: Auth failed (Authkey/password wrong)  30 20:36:56 host urbackupclientbackend[27034]: InternetClient: Had an auth error</span></span></code> </pre> </div></div><br><p>     : </p><br><pre> <code class="bash hljs">ERROR: Internet mode not enabled. Please <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"internet_mode_enabled"</span></span> to <span class="hljs-string"><span class="hljs-string">"true"</span></span>.</code> </pre> <br><p>             . </p><br><p>        : </p><br><pre> <code class="bash hljs">~<span class="hljs-comment"><span class="hljs-comment"># service urbackupclientbackend stop ~# rm -rf /usr/local/var/urbackup/</span></span></code> </pre> <br><p>      <code>/etc/default/urbackupclient</code> ,     . </p><br><p>          ,     <code>/usr/local/var/urbackup/data/settings.cfg</code> . </p><br><p>   ,    ,     : </p><br><pre> <code class="plaintext hljs">internet_server=NAS.system.cloudns.cc internet_server_port=55415 internet_authkey=44R3MUIdB computername=zenbook internet_mode_enabled=true</code> </pre> <br><p>   ,   ,     -. <br>  ,     ,   ,      . </p><br><h3 id="zapusk-polnogo-rezervnogo-kopirovaniya-posle-obnovleniya">       </h3><br><p>  Debian,    ,       <code>/etc/apt/apt.conf.d/80full-backup</code> : </p><br><pre> <code class="python hljs">DPkg::Post-Invoke {<span class="hljs-string"><span class="hljs-string">"test -x /usr/local/bin/urbackupclientctl &amp;&amp; /usr/local/bin/urbackupclientctl start -f || true"</span></span>; };</code> </pre> <br><h3 id="rezervnaya-kopiya-routera">    </h3><br><p>    NAS,    .  ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mtbackup</a>  SSH,    NAS. <br>    Python    ,   ,    ,    UrBakup,   . </p><br><h3 id="proverka-vosstanovleniya">   </h3><br><p>   : </p><br><ul><li> . </li><li> . </li></ul><br><p> ,     :         .  ,    . </p><br><p>    ,   : </p><br><ul><li>    . </li><li>    ,   . </li><li>    . </li><li>  ,   ,   . </li><li>    . </li><li>   . </li><li>   ,   . </li></ul><br><p>   ,   - ,     . </p><br><h2 id="oblachnye-servisy-dlya-rezervirovaniya">     </h2><br><p><img src="https://habrastorage.org/webt/ms/no/j4/msnoj4lqhhfm-keodwyhhdoaudm.jpeg"></p><br><p>       . <br>      ,        ,          . <br>       -  ,     ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Storj</a> . </p><br><h2 id="literatura">  Litt√©rature </h2><br><p>     ,       ,     : </p><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">    debian-russian</a> .   ,  "  rsync?". </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">" "</a> . </li><li> " 3-2-1" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  Veeam</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   </a> . </li><li>  , , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">  </a> ,    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   Veeam</a> . </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://web.archive.org/web/20181201152034/">"    "</a>  ,  ,   . </li><li>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">" :     "</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">    </a> ,          . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">    </a> . </li></ul><br><p> ,     : </p><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">W. Curtis Preston ‚Äî "Backup &amp; Recovery" ‚Äî 2000</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> .. ‚Äî     </a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> . ‚Äî Backup  "" ‚Äî 2014</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Steven Nelson ‚Äî Pro Data Backup and Recovery ‚Äî 2011</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dorian Cougias ‚Äî The Backup Book: Disaster Recovery from Desktop to Data Center, 3 edition ‚Äî 2003</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a>      (2017 )  . </li></ul><br><p>      . </p><br><p>       ,          RTO, RPA, RPO. ,    ,         ,      . </p><br><p> -      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   NAS</a> , , ,   . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr421251/">https://habr.com/ru/post/fr421251/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421241/index.html">La Banque centrale demande le blocage avant proc√®s des sites malveillants</a></li>
<li><a href="../fr421243/index.html">LLTR Partie 2: Algorithme pour d√©terminer la topologie du r√©seau √† partir des statistiques collect√©es</a></li>
<li><a href="../fr421245/index.html">C #: un cas d'utilisation pour n'importe quelle t√¢che</a></li>
<li><a href="../fr421247/index.html">Comment transformer des graphiques en son et pourquoi en avez-vous besoin</a></li>
<li><a href="../fr421249/index.html">Pourquoi les financiers de Wall Street travaillent trop et peuvent-ils √™tre corrig√©s</a></li>
<li><a href="../fr421253/index.html">Pourquoi avons-nous besoin de voitures √† queue?</a></li>
<li><a href="../fr421255/index.html">Elon Musk a abandonn√© son projet de transformer Tesla en soci√©t√© priv√©e</a></li>
<li><a href="../fr421257/index.html">Comment un r√©seau international de hackers a gagn√© 100 millions de dollars en volant des communiqu√©s de presse</a></li>
<li><a href="../fr421259/index.html">Si vous envisagez de commencer √† √©crire sur Go, voici ce que vous devez savoir</a></li>
<li><a href="../fr421261/index.html">L'effet de l'acrasia: pourquoi nous ne r√©alisons pas nos plans, et que faire √† ce sujet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>