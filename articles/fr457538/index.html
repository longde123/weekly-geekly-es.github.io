<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🏫 🐗 ⏭️ Comment puis-je utiliser des machines virtuelles Yandex.Cloud interrompues et économiser sur la résolution de problèmes à grande échelle 👨🏼‍🔬 👩‍👩‍👧‍👧 👩🏼‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, nous voulons parler d'une fonctionnalité aussi utile de Yandex.Cloud que les machines virtuelles interrompues. Il s'agit d'une option spé...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment puis-je utiliser des machines virtuelles Yandex.Cloud interrompues et économiser sur la résolution de problèmes à grande échelle</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/457538/">  Aujourd'hui, nous voulons parler d'une fonctionnalité aussi utile de Yandex.Cloud que les machines virtuelles interrompues.  Il s'agit d'une option spéciale que vous pouvez choisir lors de la création d'une machine virtuelle pour utiliser les ressources informatiques à un prix réduit.  Quelle est la particularité des machines virtuelles interruptibles, pourquoi sont-elles moins chères que les machines normales et dans quels cas est-il judicieux de les utiliser? <br><br><img src="https://habrastorage.org/webt/ox/8d/3e/ox8d3etklg4mebfli2f7r0ofdf0.png"><br><a name="habracut"></a><br>  Les capacités de Yandex.Cloud, et plus précisément du service d'infrastructure <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex Compute Cloud</a> , sont sensiblement supérieures à celles utilisées par les utilisateurs.  Par défaut, il est supposé que les utilisateurs devraient pouvoir évoluer arbitrairement.  Au moins pour ces raisons, sans tenir compte d'autres aspects, les ressources disponibles de la plateforme cloud dépassent considérablement la demande actuelle.  C'est à ces capacités libres que les machines virtuelles interrompues sont créées. <br><br><h2>  Limitations principales </h2><br>  En bref, la nature des machines virtuelles interrompues peut être décrite comme suit: le service propose d'utiliser ses ressources informatiques gratuites à un prix inférieur, à condition que ces ressources puissent être rappelées à tout moment. <br><br>  En général, les machines virtuelles interrompues fonctionnent comme des machines virtuelles normales, mais elles ont un certain nombre de limitations: <br><br><ul><li>  Ils ne sont pas couverts par un contrat de niveau de service (SLA). </li><li>  La possibilité de créer et d'exécuter n'est pas garantie. </li><li>  Ils peuvent être contraints d'arrêter à tout moment.  La probabilité d'un arrêt est faible, mais non nulle, elle peut changer au fil du temps et varier dans différentes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">zones de disponibilité de Yandex.Cloud</a> . </li><li>  Une machine virtuelle interrompue ne peut pas devenir normale, mais une machine normale interrompue.  L'indicateur correspondant est défini une fois et ne change pas. </li><li>  La machine sera sûrement arrêtée dans un délai ne dépassant pas 24 heures. </li></ul><br>  En pratique, dans la grande majorité des cas, les machines virtuelles interrompues effectuent toutes les 24 heures prévues par les conditions de service.  Un arrêt forcé ne se produit généralement que lorsqu'un grand nombre de machines virtuelles ordinaires sont créées dans une zone de disponibilité spécifique dans un court laps de temps: un nouvel utilisateur ayant des besoins sérieux apparaît ou les utilisateurs actuels sont massivement mis à l'échelle. <br><br>  Dans le même temps, une machine virtuelle arrêtée peut être redémarrée: toutes les données sur les disques sont enregistrées à la fois lors de l'arrêt automatique et manuel. <br><br><h2>  Cas d'utilisation </h2><br>  Les limitations des machines virtuelles interrompues soulèvent une question logique: comment les appliquer si les ressources peuvent être révoquées à tout moment?  À titre d'explication, voici quelques cas d'utilisation possibles. <br><br><h3>  Traitement par lots </h3><br>  Le traitement par lots implique l'exécution parallèle d'un grand nombre de tâches gourmandes en ressources.  Cela peut être la conversion de formats de fichiers, le traitement et la reconnaissance d'images, les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">opérations ETL</a> .  L'essentiel est que dans le traitement par lots, il existe une file d'attente de travaux et un ensemble complet de processus de travail (exécuteurs) qui reçoivent des travaux de la file d'attente.  Si un exécuteur individuel exécuté sur une machine interrompue s'arrête, la tâche sera simplement transférée au prochain exécuteur.  En d'autres termes, l'arrêt d'une ou même plusieurs machines virtuelles n'aura pas d'impact négatif significatif sur le processus et le résultat du traitement. <br><br><img src="https://habrastorage.org/webt/o9/tt/ny/o9ttnycyli2d6s7sg-c9i47rusk.png"><br><br>  Lorsque nous traitons des données par lots, nous parlons de l'utilisation de dizaines de machines virtuelles.  L'utilisation de machines intermittentes permet des économies très sensibles.  Désormais, l'un des principaux consommateurs de machines virtuelles discontinues productives avec 32 cœurs est un client de longue date de Yandex.Cloud, Seismotech.  Seismotek traite les données sismiques, nécessaires à l'exploration des gisements de gaz et de pétrole.  L'exploration sismique implique de travailler avec de grands volumes d'informations.  Les données sont traitées dans une méthode par lots.  La société utilise simultanément jusqu'à 60 machines interrompues ou plus: un total de 2000 vCPU et 4000 Go de RAM. <br><br><h3>  Projets sur Hadoop </h3><br>  Hadoop est utilisé pour développer et exécuter des programmes distribués s'exécutant sur des clusters de centaines et de milliers de nœuds à faible coût.  Les mécanismes de réplication de fichiers et de redémarrage automatique des tâches effectuées sur les nœuds défaillants fournis par Hadoop assurent la stabilité d'un système distribué aux défaillances de machines individuelles.  C'est pourquoi, lorsque Hadoop est utilisé, au moins une partie des nœuds peut être facilement déployée sur des machines virtuelles interrompues.  S'ils s'arrêtent tôt, les tâches seront envoyées à d'autres nœuds. <br><br><h3>  Basculement des services Web </h3><br>  La disponibilité continue du service Web peut être assurée en utilisant un cluster.  Un cluster se compose de deux serveurs ou plus.  L'une de ses tâches dans l'application aux services Web est d'assurer un fonctionnement stable au moment des pics de charge.  Exemples typiques: sites d'achats en ligne ou sites sportifs où la croissance du trafic est liée à des dates spécifiques.  Pour les magasins, il peut s'agir de jours fériés traditionnels ou de périodes de rabais, et pour les sites liés au sport, il peut s'agir de jours d'événements lorsque des émissions ont lieu, des critiques et des reportages photo sont publiés.  À de tels moments, le volume de trafic peut augmenter considérablement. <br><br>  Le cluster doit faire face à l'afflux de visiteurs en répartissant le trafic vers différents nœuds.  Pour une période de forte croissance de charge, mais de courte durée, la tolérance aux pannes peut être fournie en ajoutant des serveurs sur des machines virtuelles arrêtées.  Cette option est peu coûteuse et fait bien son travail.  Il est important de respecter une condition: un tel cluster doit être hybride, c'est-à-dire inclure des machines virtuelles ordinaires.  Dans ce cas, même l'arrêt improbable de machines interrompues n'entraînera pas de panne de service. <br><br><h3>  Projets chez Kubernetes </h3><br>  Kubernetes automatise le déploiement, la mise à l'échelle et la gestion des applications conteneurisées sur un grand nombre de nœuds.  L'une des principales entités que l'on peut appeler le bloc de construction de Kubernetes est sous (pod).  Pod permet le lancement d'un ou plusieurs conteneurs sur un nœud.  Un nœud pour chaque foyer est sélectionné et attribué par le planificateur Kubernetes.  Si un nœud séparé avec un foyer en marche tombe en panne, le planificateur le transfère automatiquement vers un nœud qui fonctionne en mode normal.  Ce schéma de maintien de l'intégrité suggère qu'une partie des nœuds peut être hébergée dans des machines virtuelles discontinues. <br><br><h3>  Test d'intégration continue </h3><br>  La pratique de l'intégration continue est basée sur l'assemblage et les tests fréquents du projet.  Dans ce cas, des tests principalement automatisés sont utilisés.  Schématiquement, cela ressemble à ceci: un environnement de test est créé sur une machine virtuelle, la dernière version de l'application y est téléchargée, des tests automatisés sont effectués, les résultats des tests sont téléchargés, la machine virtuelle est supprimée.  En règle générale, les tests prennent plusieurs dizaines de minutes, moins souvent plusieurs heures. <br><br>  Traditionnellement, les points faibles de l'intégration continue sont considérés comme des coûts importants pour soutenir le processus d'intégration lui-même et la forte demande de ressources informatiques.  De ce point de vue et compte tenu de la durée des tests automatisés, les machines virtuelles abandonnées semblent plus que adaptées à une intégration continue.  Ils sont beaucoup moins chers et la probabilité qu'une voiture s'arrête immédiatement au moment des tests est extrêmement faible.  De plus, même si la voiture est toujours arrêtée, les dommages du point de vue de l'entreprise seront minimes. <br><br><h3>  Utiliser en conjonction avec d'autres services Yandex.Cloud </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Le service Groupes d'instances Yandex</a> vous permet de surveiller automatiquement l'état d'un groupe entier de machines virtuelles interrompues.  Il peut créer indépendamment des machines virtuelles avec les caractéristiques données, maintenir le nombre nécessaire de machines dans le groupe et redémarrer les instances interrompues si elles s'arrêtent.  Peu importe si un arrêt forcé s'est produit ou si 24 heures se sont écoulées depuis le début.  Une seule chose est importante: un redémarrage se produira s'il y a des ressources disponibles.  Les groupes d'instances Yandex rendent le travail avec des machines virtuelles interrompues plus pratique, mais ne peuvent garantir que des capacités libres existeront nécessairement dans une zone de disponibilité spécifique. <br><br><h2>  Performance économique </h2><br>  Comme nous l'avons mentionné, les machines virtuelles interruptibles peuvent réduire le coût d'utilisation des ressources informatiques.  Au sein de Yandex, nous avons commencé à travailler sur une fonction similaire il y a plusieurs années.  Pour diviser les tâches informatiques en exécutables garantis et interruptibles, des investissements considérables ont été nécessaires.  Mais cela n'a pas été vain: au final, nous avons augmenté le niveau d'utilisation utile de l'infrastructure serveur de 30-40% à 70-80%. <br><br><img src="https://habrastorage.org/webt/t5/co/jm/t5cojmli_xdhso9kjwoqbwciksk.png"><br><br>  Des fonctionnalités similaires sont désormais disponibles pour tous les utilisateurs de Yandex.Cloud en un seul clic.  Un exemple simple: si vous transférez la moitié des machines virtuelles utilisées avec une charge du noyau à cent pour cent au format d'interruption, vous pouvez économiser jusqu'à 35 à 40% du budget. <br><br>  À un coût réduit, des ressources CPU et RAM sont disponibles.  L'espace disque et les adresses IP sont payés à des tarifs réguliers.  Voici ce qu'un simple calcul montre pour la plate-forme Cascade Lake. <br><br><img src="https://habrastorage.org/webt/2z/u2/vh/2zu2vhioohfo6zfv77cl1a3lweq.png"><br><br>  Si vous le souhaitez, vous pouvez comparer le coût d'utilisation des machines virtuelles dans différents modes à l'aide d'une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">calculatrice</a> . <br><br>  Nous espérons que nous avons pu apporter un peu de clarté et donner quelques exemples utiles dans lesquels vous pouvez utiliser des machines virtuelles interruptibles pour réduire le coût des ressources informatiques sans perdre en qualité dans l'exécution des tâches. <br><br><h3>  Autres publications sur Cloud on Habré </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Architecture du service Message Queuing distribué</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Architecture de l'équilibreur de charge réseau</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MPLS est partout.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment est l'infrastructure réseau Yandex.Cloud</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment faire évoluer des bases de données sans temps d'arrêt.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Exemple de trois hôtes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex ouvre le Cloud.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Architecture de la nouvelle plateforme</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457538/">https://habr.com/ru/post/fr457538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457522/index.html">Augmentez votre service de liste de diffusion ou utilisez des solutions toutes faites? Ce que j'ai appris pendant 5 ans chez UniSender</a></li>
<li><a href="../fr457524/index.html">Caméras de profondeur - révolution silencieuse (quand les robots verront) Partie 1</a></li>
<li><a href="../fr457526/index.html">Les médias techniques comme bazar</a></li>
<li><a href="../fr457532/index.html">Il est grand temps de faire partie d'un projet open source</a></li>
<li><a href="../fr457534/index.html">Versions certifiées - le râteau que nous choisissons</a></li>
<li><a href="../fr457540/index.html">Intel Optane DC Persistent Memory, un an plus tard</a></li>
<li><a href="../fr457542/index.html">Piratage et protection des lecteurs de chiffrement LUKS</a></li>
<li><a href="../fr457546/index.html">Demo Day: pourquoi tout cela et comment le faire UPD + Broadcast</a></li>
<li><a href="../fr457548/index.html">Génération de signal PWM multiphasé sur TMS320F28027</a></li>
<li><a href="../fr457550/index.html">De quoi l'industrie numérique doit-elle être protégée</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>