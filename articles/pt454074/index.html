<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚è´ üôåüèª üôéüèΩ DynamicData: cole√ß√µes din√¢micas, arquitetura MVVM e extens√µes reativas üö• üé≤ ü§∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fevereiro de 2019 marcou o lan√ßamento do ReactiveUI 9 - a estrutura de plataforma cruzada para a cria√ß√£o de aplicativos GUI na plataforma Microsoft .N...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DynamicData: cole√ß√µes din√¢micas, arquitetura MVVM e extens√µes reativas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454074/"><p>  Fevereiro de 2019 marcou o lan√ßamento do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ReactiveUI 9</a> - a estrutura de plataforma cruzada para a cria√ß√£o de aplicativos GUI na plataforma Microsoft .NET.  O ReactiveUI √© uma ferramenta para forte integra√ß√£o de extens√µes reativas com o padr√£o de design do MVVM.  Voc√™ pode se familiarizar com a estrutura atrav√©s de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uma s√©rie de v√≠deos</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">da p√°gina de boas-vindas da documenta√ß√£o</a> .  A atualiza√ß√£o do ReactiveUI 9 inclui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">v√°rias corre√ß√µes e melhorias</a> , mas provavelmente a mais crucial e interessante √© a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">integra√ß√£o com a estrutura DynamicData</a> , permitindo que voc√™ trabalhe com cole√ß√µes din√¢micas da maneira reativa.  Vamos descobrir para que podemos usar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> e como essa poderosa estrutura reativa funciona sob o cap√¥! </p><a name="habracut"></a><br><h1 id="introduction">  1. Introdu√ß√£o </h1><br><p> Vamos primeiro determinar os casos de uso do DynamicData e descobrir o que n√£o gostamos nas ferramentas padr√£o para trabalhar com conjuntos de dados din√¢micos no espa√ßo de nome <code>System.Collections.ObjectModel</code> . </p><br><p>  O modelo MVVM, como sabemos, assume a divis√£o de responsabilidade entre a camada do modelo, a camada de apresenta√ß√£o e o modelo de apresenta√ß√£o do aplicativo, tamb√©m conhecido como modelo de exibi√ß√£o.  A camada de modelo √© representada por entidades e servi√ßos de dom√≠nio e n√£o sabe nada sobre a camada de modelo de exibi√ß√£o.  O modelo encapsula toda a l√≥gica complexa do aplicativo, enquanto o modelo de exibi√ß√£o delega opera√ß√µes para o modelo, fornecendo acesso a informa√ß√µes sobre o estado atual do aplicativo por meio de propriedades, comandos e cole√ß√µes observ√°veis ‚Äã‚Äãna exibi√ß√£o.  A ferramenta padr√£o para trabalhar com propriedades din√¢micas √© a interface <code>INotifyPropertyChanged</code> , para trabalhar com a√ß√µes do usu√°rio - <code>ICommand</code> e para trabalhar com cole√ß√µes - a interface <code>INotifyCollectionChanged</code> , al√©m de implementa√ß√µes como <code>ObservableCollection&lt;T&gt;</code> e <code>ReadOnlyObservableCollection&lt;T&gt;</code> . </p><br><img width="500" src="https://habrastorage.org/getpro/habr/post_images/504/c83/ab0/504c83ab04fe2e2d1eed037317b8aa2c.jpg"><br><p><br>  As implementa√ß√µes das interfaces <code>INotifyPropertyChanged</code> e <code>ICommand</code> geralmente dependem do desenvolvedor e da estrutura MVVM usada, mas o uso do padr√£o <code>ObservableCollection&lt;T&gt;</code> imp√µe v√°rias limita√ß√µes!  Por exemplo, n√£o podemos alterar a cole√ß√£o de um encadeamento em segundo plano sem <code>Dispatcher.Invoke</code> ou uma chamada semelhante, e isso seria super √∫til para sincronizar matrizes de dados com o servidor por meio de uma opera√ß√£o em segundo plano.  Vale ressaltar que, ao usar a arquitetura MVVM limpa, a camada de modelo n√£o deve saber nada sobre a estrutura da GUI usada e deve ser compat√≠vel com a camada de modelo na terminologia MVC ou MVP.  √â por isso que essas in√∫meras chamadas do <code>Dispatcher.Invoke</code> nos servi√ßos de dom√≠nio violam o princ√≠pio de segrega√ß√£o de responsabilidades. </p><br><p>  Obviamente, poder√≠amos declarar um evento em um servi√ßo de dom√≠nio e transmitir uma parte com itens alterados como argumentos de evento, depois assinar o evento, encapsular a <code>Dispatcher.Invoke</code> chamada por tr√°s de uma interface, para que nosso aplicativo n√£o dependa de nenhuma GUI , chame essa interface do modelo de exibi√ß√£o e modifique <code>ObservableCollection&lt;T&gt;</code> acordo, mas h√° uma maneira muito mais elegante de lidar com esses problemas sem a necessidade de reinventar a roda.  O que estamos esperando ent√£o? </p><br><h1 id="reactive-extensions-managing-observable-data-streams">  Extens√µes reativas.  Gerenciando fluxos de dados observ√°veis </h1><br><p>  Para entender completamente as abstra√ß√µes introduzidas pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> e como trabalhar com a altera√ß√£o dos conjuntos de dados reativos, vamos relembrar o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">que √© programa√ß√£o reativa e como us√°-la no contexto da plataforma Microsoft .NET e no padr√£o de design MVVM</a> .  A maneira de organizar a intera√ß√£o entre os componentes do programa pode ser interativa ou reativa.  Com a abordagem interativa, o consumidor recebe dados do produtor de forma s√≠ncrona (baseada em pull, T, IEnumerable) e com a abordagem reativa, o produtor envia os dados para o consumidor de forma ass√≠ncrona (baseada em push, Task, IObservable). </p><br><img width="500" src="https://habrastorage.org/webt/mb/ts/mj/mbtsmjfyhjqeeb4tv8ynotvkdms.png"><br><p><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A programa√ß√£o reativa</a> est√° programando com fluxos de dados ass√≠ncronos, e as extens√µes reativas s√£o a implementa√ß√£o da programa√ß√£o reativa, com base nas interfaces <code>IObservable</code> e <code>IObserver</code> do namespace System, definindo uma s√©rie de opera√ß√µes semelhantes a LINQ na interface <code>IObservable</code> , conhecidas como LINQ over Observable.  As extens√µes reativas suportam o .NET Standard e s√£o executadas onde quer que o Microsoft .NET seja executado. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/ue/qe/80/ueqe80neq0ufivj-bq5hipdrldo.gif"></a> <br><br>  O ReactiveUI oferece aos desenvolvedores de aplicativos a vantagem de usar as implementa√ß√µes reativas para as interfaces <code>ICommand</code> e <code>INotifyPropertyChanged</code> , fornecendo ferramentas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>ReactiveCommand&lt;TIn, TOut&gt;</code></a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>WhenAnyValue</code></a> .  <code>WhenAnyValue</code> permite converter uma propriedade de uma classe que implementa a interface <code>INotifyPropertyChanged</code> em um fluxo de eventos do tipo <code>IObservable&lt;T&gt;</code> , isso simplifica a implementa√ß√£o de propriedades dependentes. </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ExampleViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span> { [Reactive] <span class="hljs-comment"><span class="hljs-comment">// Attribute from the ReactiveUI.Fody package, // takes care of aspect-oriented INPC implementation // for this particular property. public string Name { get; set; } public ExampleViewModel() { // Here we subscribe to OnPropertyChanged("Name") events. this.WhenAnyValue(x =&gt; x.Name) // IObservable&lt;string&gt; .Subscribe(Console.WriteLine); } }</span></span></code> </pre> <br><p>  <code>ReactiveCommand&lt;TIn, TOut&gt;</code> permite trabalhar com um comando como com <code>IObservable&lt;TOut&gt;</code> , que √© publicado sempre que um comando conclui a execu√ß√£o.  Al√©m disso, qualquer comando possui uma propriedade <code>ThrownExceptions</code> do tipo <code>IObservable&lt;Exception&gt;</code> . </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ReactiveCommand&lt;Unit, int&gt; var command = ReactiveCommand.Create(() =&gt; 42); command // IObservable&lt;int&gt; .Subscribe(Console.WriteLine); command .ThrownExceptions // IObservable&lt;Exception&gt; .Select(exception =&gt; exception.Message) // IObservable&lt;string&gt; .Subscribe(Console.WriteLine); command.Execute().Subscribe(); // Outputs: 42</span></span></code> </pre> <br><p>  At√© o momento, trabalhamos com <code>IObservable&lt;T&gt;</code> , como em um evento que publica um novo valor do tipo <code>T</code> sempre que o estado do objeto observado √© alterado.  Simplificando, <code>IObservable&lt;T&gt;</code> √© um fluxo de eventos, uma cole√ß√£o do tipo <code>T</code> esticada no tempo. </p><br><p>  Obviamente, poder√≠amos trabalhar com cole√ß√µes com a mesma facilidade e naturalidade - sempre que uma cole√ß√£o muda, podemos publicar uma nova cole√ß√£o com elementos alterados.  Nesse caso, o valor publicado seria do tipo <code>IEnumerable&lt;T&gt;</code> ou mais especializado, e o pr√≥prio fluxo observ√°vel seria do tipo <code>IObservable&lt;IEnumerable&lt;T&gt;&gt;</code> .  Mas, como observa corretamente um leitor cr√≠tico, isso est√° repleto de problemas cr√≠ticos de desempenho, especialmente se n√£o houver uma d√∫zia de elementos em nossa cole√ß√£o, mas uma centena ou mesmo alguns milhares! </p><br><h1 id="introduction-to-dynamicdata">  Introdu√ß√£o ao DynamicData </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> √© uma biblioteca que permite usar o poder das extens√µes reativas ao trabalhar com cole√ß√µes.  O Rx √© extremamente poderoso, mas pronto para o uso n√£o fornece nada para ajudar no gerenciamento de cole√ß√µes, e o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> corrige isso.  Na maioria dos aplicativos, √© necess√°rio atualizar dinamicamente as cole√ß√µes - geralmente, uma cole√ß√£o √© preenchida com itens quando o aplicativo √© iniciado e, em seguida, a cole√ß√£o √© atualizada de forma ass√≠ncrona, sincronizando informa√ß√µes com um servidor ou banco de dados.  Os aplicativos modernos s√£o bastante complexos e geralmente √© necess√°rio criar proje√ß√µes de cole√ß√µes - filtrar, transformar ou classificar elementos.  O DynamicData foi projetado para se livrar do c√≥digo incrivelmente complexo que precisar√≠amos para gerenciar conjuntos de dados que mudam dinamicamente.  A ferramenta est√° desenvolvendo e refinando ativamente, e agora mais de 60 operadores s√£o suportados para trabalhar com cole√ß√µes. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/hn/7j/v3/hn7jv3fv1qgfxlhqrd9g6dokkao.gif"></a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> n√£o √© uma implementa√ß√£o alternativa de <code>ObservableCollection&lt;T&gt;</code> .  A arquitetura do DynamicData √© baseada principalmente em conceitos de programa√ß√£o controlados por dom√≠nio.  A ideologia de uso √© baseada no fato de voc√™ controlar uma certa fonte de dados, uma cole√ß√£o √† qual o c√≥digo respons√°vel pela sincroniza√ß√£o e muta√ß√£o de dados tem acesso.  Em seguida, voc√™ aplica uma s√©rie de operadores √† fonte de dados. Com a ajuda desses operadores, voc√™ pode transformar declarativamente os dados sem a necessidade de criar e modificar manualmente outras cole√ß√µes.  De fato, com o DynamicData, voc√™ separa as opera√ß√µes de leitura e grava√ß√£o e s√≥ pode ler de maneira reativa - portanto, as cole√ß√µes herdadas sempre permanecer√£o sincronizadas com a fonte. </p><br><p>  Em vez do <code>IObservable&lt;T&gt;</code> cl√°ssico <code>IObservable&lt;T&gt;</code> , DynamicData define opera√ß√µes em <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;</code> e <code>IObservable&lt;IChangeSet&lt;TValue, TKey&gt;&gt;</code> , em que <code>IChangeSet</code> √© um bloco contendo informa√ß√µes sobre a altera√ß√£o da cole√ß√£o, incluindo o tipo de altera√ß√£o e os elementos afetados.  Essa abordagem pode melhorar significativamente o desempenho do c√≥digo para trabalhar com cole√ß√µes, gravadas de maneira reativa.  Voc√™ sempre pode transformar <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;</code> em <code>IObservable&lt;IEnumerable&lt;T&gt;&gt;</code> , se for necess√°rio acessar todos os elementos de uma cole√ß√£o de uma vez.  Se isso parecer dif√≠cil - n√£o se preocupe, os exemplos de c√≥digo abaixo deixar√£o tudo claro! </p><br><h1 id="dynamicdata-in-action">  Dados din√¢micos em a√ß√£o </h1><br><p>  Vejamos alguns exemplos para entender melhor como o DynamicData funciona, como difere do System.Reative e quais tarefas os desenvolvedores comuns do software GUI podem ajudar a resolver.  Vamos come√ßar com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um exemplo abrangente publicado no GitHub</a> .  Neste exemplo, a fonte de dados √© <code>SourceCache&lt;Trade, long&gt;</code> contendo uma cole√ß√£o de transa√ß√µes.  O objetivo √© mostrar apenas transa√ß√µes ativas, transformar modelos em objetos proxy, classificar a cole√ß√£o. </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// The default collection from the System.Collections.ObjectModel // namespace, to which we bind XAML UI controls. ReadOnlyObservableCollection&lt;TradeProxy&gt; list; // The mutable data source, containing the list of transactions. // We can use Add, Remove, Insert and similar methods on it. var source = new SourceCache&lt;Trade, long&gt;(trade =&gt; trade.Id); var cancellation = source // Here we transform the data source to an observable change set. .Connect() // Now we have IObservable&lt;IChangeSet&lt;Trade, long&gt;&gt; here. // Filter only active transactions. .Filter(trade =&gt; trade.Status == TradeStatus.Live) // Transform the models into proxy objects. .Transform(trade =&gt; new TradeProxy(trade)) // No we have IObservable&lt;IChangeSet&lt;TrandeProxy, long&gt;&gt; // Order the trade proxies by timestamp. .Sort(SortExpressionComparer&lt;TradeProxy&gt; .Descending(trade =&gt; trade.Timestamp)) // Use the dispatcher scheduler to update the GUI. .ObserveOnDispatcher() // Bind the sorted objects to the collection from the // System.Collections.ObjectModel namespace. .Bind(out list) // Ensure that when deleting elements from the // collections, the resources will get disposed. .DisposeMany() .Subscribe();</span></span></code> </pre> <br><p>  No exemplo acima, ao alterar o <code>SourceCache</code> que √© a fonte dos dados, o <code>ReadOnlyObservableCollection</code> tamb√©m muda de acordo.  Ao mesmo tempo, ao remover itens da cole√ß√£o, o m√©todo <code>Dispose</code> ser√° chamado, a cole√ß√£o sempre ser√° atualizada apenas a partir do encadeamento da GUI e permanecer√° classificada e filtrada.  Legal, agora n√£o temos <code>Dispatcher.Invoke</code> . <code>Dispatcher.Invoke</code> chamadas e o c√≥digo √© simples e leg√≠vel! </p><br><h1 id="data-sources-sourcelist-and-sourcecache">  Fontes de dados.  SourceList e SourceCache </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O DynamicData</a> fornece duas cole√ß√µes especializadas que podem ser usadas como uma fonte de dados mut√°vel.  Essas cole√ß√µes s√£o <code>SourceList&lt;TObject&gt;</code> e <code>SourceCache&lt;TObject, TKey&gt;</code> .  √â recomend√°vel usar o <code>SourceCache</code> sempre que o <code>TObject</code> tiver uma chave exclusiva; caso contr√°rio, use o <code>SourceList</code> .  Esses objetos fornecem o familiar para a API de desenvolvedores .NET para gerenciamento de cole√ß√µes - m√©todos como <code>Add</code> , <code>Remove</code> , <code>Insert</code> .  Para converter fontes de dados em <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;</code> ou em <code>IObservable&lt;IChangeSet&lt;T, TKey&gt;&gt;</code> , use o operador <code>.Connect()</code> .  Por exemplo, se voc√™ tiver um servi√ßo que atualiza periodicamente uma cole√ß√£o de itens em segundo plano, poder√° sincronizar facilmente a lista desses itens com a GUI, sem o <code>Dispatcher.Invoke</code> e um c√≥digo semelhante: </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BackgroundService</span></span> : <span class="hljs-title"><span class="hljs-title">IBackgroundService</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Declare the mutable data source containing trades. private readonly SourceList&lt;Trade&gt; _trades; // Expose the observable change set to the outside world. // If we have more than one subscriber, it is recommended // to use the Publish() operator from reactive extensions. public IObservable&lt;IChangeSet&lt;Trade&gt;&gt; Connect() =&gt; _trades.Connect(); public BackgroundService() { _trades = new SourceList&lt;Trade&gt;(); _trades.Add(new Trade()); // Mutate the source list! // Even from the background thread. } }</span></span></code> </pre> <br><p>  Com a ajuda dos poderosos operadores DynamicData, podemos transformar <code>IObservable&lt;IChangeSet&lt;Trade&gt;&gt;</code> em <code>ReadOnlyObservableCollection</code> declarado em nosso modelo de exibi√ß√£o. </p><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TradesViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReadOnlyObservableCollection&lt;TradeVm&gt; _trades; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ReadOnlyObservableCollection&lt;TradeVm&gt; Trades =&gt; _trades; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TradesViewModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IBackgroundService background</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Connect to the data source, transform elements, bind // them to the read-only observable collection. background.Connect() .Transform(x =&gt; new TradeVm(x)) .ObserveOn(RxApp.MainThreadScheduler) .Bind(out _trades) .DisposeMany() .Subscribe(); } }</span></span></code> </pre> <br><p>  Al√©m dos operadores <code>Transform</code> , <code>Filter</code> e <code>Sort</code> , o DynamicData suporta agrupamentos, opera√ß√µes l√≥gicas, achatamento de cole√ß√µes, uso de fun√ß√µes agregadas, elimina√ß√£o de elementos id√™nticos, contagem de elementos e at√© virtualiza√ß√£o no n√≠vel do modelo de visualiza√ß√£o.  Voc√™ pode ler mais sobre todos os operadores no <a href="">README do projeto no GitHub</a> . </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/jy/6-/4a/jy6-4azw__6rou9alucffpjhkrq.gif"></a> <br><br>  Al√©m de <code>SourceList</code> e <code>SourceCache</code> , a biblioteca DynamicData inclui uma implementa√ß√£o de cole√ß√£o mut√°vel de thread √∫nico - <code>ObservableCollectionExtended</code> .  Para sincronizar duas cole√ß√µes no seu modelo de exibi√ß√£o, declare uma delas como <code>ObservableCollectionExtended</code> e a outra como <code>ReadOnlyObservableCollection</code> e, em seguida, use o operador <code>ToObservableChangeSet</code> , que faz quase a mesma coisa que o Connect, mas pretende trabalhar com a <code>ObservableCollection</code> . </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Declare the derived collection. ReadOnlyObservableCollection&lt;TradeVm&gt; _derived; // Declare and initialize the source collection. var source = new ObservableCollectionExtended&lt;Trade&gt;(); source.ToObservableChangeSet(trade =&gt; trade.Key) .Transform(trade =&gt; new TradeProxy(trade)) .Filter(proxy =&gt; proxy.IsChecked) .Bind(out _derived) .Subscribe();</span></span></code> </pre> <br><p>  O DynamicData tamb√©m oferece suporte ao rastreamento de altera√ß√µes nas classes que implementam a interface <code>INotifyPropertyChanged</code> .  Por exemplo, se voc√™ deseja receber notifica√ß√µes sempre que uma propriedade for alterada, use o operador <code>AutoRefresh</code> e passe o seletor de propriedades necess√°rio.  <code>AutoRefresh</code> e outros operadores DynamicData podem permitir que voc√™ valide sem esfor√ßo um n√∫mero gigante de formul√°rios e formul√°rios aninhados exibidos na tela! </p><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// IObservable&lt;bool&gt; var isValid = databases .ToObservableChangeSet() // Subscribe only to IsValid property changes. .AutoRefresh(database =&gt; database.IsValid) // Materialize the collection. .ToCollection() // Determine if all forms are valid. .Select(x =&gt; x.All(y =&gt; y.IsValid)); // If ReactiveUI is used, you can transform the // IObservable&lt;bool&gt; variable to a property declared // as ObservableAsPropertyHelper&lt;bool&gt;, eg IsValid. _isValid = isValid .ObserveOn(RxApp.MainThreadScheduler) .ToProperty(this, x =&gt; x.IsValid);</span></span></code> </pre> <br><p>  Voc√™ pode criar interfaces de usu√°rio complexas usando a funcionalidade DynamicData, e √© especialmente relevante para sistemas que exibem uma grande quantidade de dados em tempo real, como aplicativos de mensagens instant√¢neas e sistemas de monitoramento. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/98/nh/ws/98nhws7gl4yzk8kgcovbpvvozoi.gif"></a> <br><br></p><br><h1 id="conclusion">  Conclus√£o </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O ReactiveX</a> √© uma ferramenta poderosa que permite trabalhar com fluxos de eventos e com a interface do usu√°rio, escrever c√≥digos port√°teis e de manuten√ß√£o e resolver tarefas complexas de maneira simples e elegante.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O ReactiveUI</a> permite que desenvolvedores .NET integrem extens√µes reativas em seus projetos usando a arquitetura MVVM com implementa√ß√µes reativas de <code>INotifyPropertyChanged</code> e <code>ICommand</code> , enquanto DynamicData cuida do gerenciamento de cole√ß√µes implementando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>INotifyCollectionChanged</code></a> , expandindo os recursos de extens√µes reativas com foco no desempenho. </p><br><p>  As bibliotecas ReactiveUI e DynamicData s√£o totalmente compat√≠veis com todas as estruturas da GUI na plataforma .NET, incluindo Windows Presentation Foundation, Universal Windows Platform, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Avalonia</a> , Xamarin.Android, Xamarin Forms e Xamarin iOS.  Voc√™ pode come√ßar a estudar o DynamicData na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√°gina correspondente da documenta√ß√£o do ReactiveUI</a> .  Tamb√©m se familiarize com o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData Snippets</a> , contendo exemplos de c√≥digo para quase tudo que voc√™ pode precisar. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt454074/">https://habr.com/ru/post/pt454074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt454062/index.html">Telefone corporativo - como uma faca su√≠√ßa: para invent√°rio, bate-papo, chamadas de suporte e consultas</a></li>
<li><a href="../pt454064/index.html">A hist√≥ria n√£o contada da IA</a></li>
<li><a href="../pt454066/index.html">Como parar de esquecer os √≠ndices e come√ßar a verificar o plano de execu√ß√£o nos testes</a></li>
<li><a href="../pt454070/index.html">Escolhendo uma roda mono para pendulares</a></li>
<li><a href="../pt454072/index.html">Cinco maiores exemplos de mentiras sobre 5G</a></li>
<li><a href="../pt454076/index.html">DotNext 2019 Piter: pequeno relat√≥rio</a></li>
<li><a href="../pt454078/index.html">"Conte√∫do para celular" de gra√ßa, sem SMS e registros. Detalhes de fraude de megafone</a></li>
<li><a href="../pt454082/index.html">Ondas de pl√°stico: desastre ecol√≥gico dos oceanos</a></li>
<li><a href="../pt454084/index.html">Diretrizes ao vivo - MDX e outras estruturas</a></li>
<li><a href="../pt454086/index.html">O que o RIT ++ 2019 lembrou</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>