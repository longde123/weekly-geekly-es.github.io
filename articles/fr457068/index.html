<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸˆ ğŸ§‘ğŸ½ ğŸ‘¨ğŸ¼â€ğŸ« Files d'attente - qu'est-ce que c'est, pourquoi et comment l'utiliser? Jetez un Å“il aux fonctionnalitÃ©s d'AWS SQS ğŸŒ° ğŸ‘©ğŸ¿â€ğŸŒ¾ â†•ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="DÃ©finissons d'abord le concept de Â«file d'attenteÂ». 
 Prenez en considÃ©ration le type de file d'attente Â«FIFOÂ» (premier entrÃ© , premier sorti). Si vou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Files d'attente - qu'est-ce que c'est, pourquoi et comment l'utiliser? Jetez un Å“il aux fonctionnalitÃ©s d'AWS SQS</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457068/"><img src="https://habrastorage.org/webt/zw/yz/pq/zwyzpqk1p65bfsq6xzvqab7rt60.png"><br><h3>  <b>DÃ©finissons d'abord le concept de Â«file d'attenteÂ».</b> </h3><br>  Prenez en considÃ©ration le type de file d'attente <b>Â«FIFOÂ»</b> (premier <b>entrÃ©</b> , premier sorti).  Si vous prenez la valeur de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Wikipedia</a> - "c'est un type de donnÃ©es abstrait avec la discipline d'accÃ¨s aux Ã©lÃ©ments."  En bref, cela signifie que nous ne pouvons pas obtenir de donnÃ©es de celui-ci dans un ordre alÃ©atoire, mais uniquement rÃ©cupÃ©rer ce qui est arrivÃ© en premier. <br><br><h3>  Ensuite, vous devez dÃ©cider pourquoi ils sont nÃ©cessaires? </h3><br>  <b>1. Pour les opÃ©rations diffÃ©rÃ©es.</b>  Un exemple classique est le traitement d'image.  Par exemple, un utilisateur a tÃ©lÃ©chargÃ© une image sur le site que nous devons traiter, cette opÃ©ration prend beaucoup de temps, l'utilisateur ne veut pas attendre autant.  Par consÃ©quent, nous chargeons l'image, puis la transfÃ©rons dans la file d'attente.  Et il sera traitÃ© lorsqu'un Â«travailleurÂ» le recevra. <br><br>  <b>2. Pour gÃ©rer les charges de pointe.</b>  Par exemple, il y a une partie du systÃ¨me qui provoque parfois beaucoup de trafic et qui ne nÃ©cessite pas de rÃ©ponse instantanÃ©e.  En option, gÃ©nÃ©rer des rapports.  Lancer cette tÃ¢che dans la file d'attente - nous donnons la possibilitÃ© de la gÃ©rer avec une charge uniforme sur le systÃ¨me. <br><br>  <b>3. Ã‰volutivitÃ©.</b>  Et probablement la raison la plus importante, la file d'attente permet <br>  Ã©voluer.  Cela signifie que vous pouvez afficher plusieurs services pour le traitement en parallÃ¨le, ce qui augmentera considÃ©rablement la productivitÃ©. <br><a name="habracut"></a><br><h3>  Voyons maintenant les problÃ¨mes auxquels nous serons confrontÃ©s si nous crÃ©ons nous-mÃªmes la file d'attente: </h3><br>  <b>1. AccÃ¨s parallÃ¨le.</b>  Un seul gestionnaire peut prendre un message dans une file d'attente.  Autrement dit, si en mÃªme temps deux services demandent des messages, chacun d'eux doit renvoyer un ensemble unique de messages.  Sinon, il s'avÃ¨re qu'un message est traitÃ© deux fois.  Ce qui pourrait Ãªtre lourd. <br><br>  <b>2. Le mÃ©canisme de dÃ©duplication.</b>  Le service doit disposer d'un systÃ¨me qui protÃ¨ge la file d'attente des doublons.  Il peut y avoir une situation dans laquelle un mÃªme ensemble de donnÃ©es sera envoyÃ© Ã  la file d'attente par hasard deux fois.  En consÃ©quence, nous traiterons la mÃªme chose deux fois.  Ce qui est encore lourd. <br><br>  <b>3. MÃ©canisme de gestion des erreurs.</b>  Disons que notre service a pris trois messages de la file d'attente.  Il en a traitÃ© deux avec succÃ¨s en envoyant des demandes de suppression de la file d'attente.  Et le troisiÃ¨me qu'il n'a pas pu traiter et est mort.  Un message en cours de traitement n'est pas disponible pour les autres services.  Et il ne doit pas rester Ã©ternellement en cours de traitement.  Un tel message doit Ãªtre transmis Ã  un autre gestionnaire par une logique.  Un exemple de mise en Å“uvre de cette logique sera bientÃ´t envisagÃ© en utilisant AWS SQS (Simple Queue Service) comme exemple. <br><br><h3>  Amazon Web Services - Service de file d'attente simple </h3><br><h4>  Voyons maintenant comment SQS rÃ©sout ces problÃ¨mes et ce qu'il peut faire. </h4><br>  <b>1. AccÃ¨s parallÃ¨le.</b>  Dans la file d'attente, vous pouvez dÃ©finir le paramÃ¨tre de <b>dÃ©lai d'expiration de</b> la <b>visibilitÃ©</b> .  Il dÃ©termine la durÃ©e maximale du traitement d'un message.  Par dÃ©faut, c'est <b>30 secondes.</b>  Lorsqu'un service rÃ©cupÃ¨re un message, il est transfÃ©rÃ© Ã  l'Ã©tat <b>Â«En volÂ»</b> pendant 30 secondes.  Si pendant ce temps il n'y avait pas de commande pour supprimer ce message de la file d'attente, il revient au dÃ©but et le service suivant peut le recevoir Ã  nouveau pour traitement. <br><br>  <b>Petit travail de shemka.</b> <br><br><img src="https://habrastorage.org/webt/zx/wj/pd/zxwjpdw6hdsdw8qoinabmifuyzo.png"><br><blockquote>  <b>Remarque:</b> soyez prudent.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dans certains cas, SQS peut envoyer un message en double (article "Livraison au moins une fois").</a>  Par consÃ©quent, votre service doit Ãªtre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">idempotent</a> pour le traitement. </blockquote><br>  <b>2. MÃ©canisme de gestion des erreurs.</b>  Dans SQS, vous pouvez configurer le deuxiÃ¨me tour pour les messages "morts" (Dead Letter Queue).  Autrement dit, ceux qui n'ont pas pu traiter notre service seront envoyÃ©s dans une file d'attente distincte, dont vous pouvez disposer Ã  votre discrÃ©tion.  Vous pouvez Ã©galement dÃ©finir aprÃ¨s quoi le nombre de tentatives infructueuses le message ira dans la file d'attente "morte".  Une tentative ayant Ã©chouÃ© correspond Ã  l'expiration du "dÃ©lai d'expiration de la visibilitÃ©".  Autrement dit, si aucune demande de suppression n'a Ã©tÃ© envoyÃ©e pendant ce temps, un tel message sera considÃ©rÃ© comme non traitÃ© et retournera dans la file d'attente principale ou ira aux "morts". <br><br>  <b>3. DÃ©duplication des messages.</b>  SQS dispose Ã©galement d'un systÃ¨me de protection en double.  Chaque message a un <b>Â«ID de dÃ©duplicationÂ»</b> , SQS ne mettra pas en file d'attente un message avec <br>  rÃ©pÃ©tÃ© Â«Id de dÃ©duplicationÂ» pendant 5 minutes.  Vous devez spÃ©cifier un Â«ID de dÃ©duplicationÂ» dans chaque message ou activer la gÃ©nÃ©ration d'ID basÃ©e sur le contenu.  Cela signifie qu'un hachage gÃ©nÃ©rÃ© en fonction de votre contenu entrera dans l 'Â«ID de dÃ©duplicationÂ».  Le paramÃ¨tre <b>"DÃ©duplication basÃ©e sur le contenu".</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">En savoir plus sur la dÃ©duplication</a> <br><blockquote>  <b>Remarque:</b> soyez prudent si vous envoyez deux messages identiques dans les 5 minutes et que la <b>Â«dÃ©duplication basÃ©e sur le contenuÂ» est</b> activÃ©e <b>.</b> SQS n'ajoutera pas de deuxiÃ¨me message Ã  la file d'attente. <br></blockquote><blockquote>  <b>Remarque:</b> soyez prudent, par exemple, si la connexion est perdue sur l'appareil et qu'il ne reÃ§oit pas de rÃ©ponse et envoie ensuite une deuxiÃ¨me demande aprÃ¨s 5 minutes, un doublon sera crÃ©Ã©. <br></blockquote>  <b>4. Long scrutin.</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Long sondage</a> .  SQS prend en charge ce type de connexion avec un dÃ©lai maximal de 20 secondes.  Ce qui nous permet d'Ã©conomiser sur le trafic et les "saccades" du service. <br><br>  <b>5. Mesures.</b>  Amazon fournit Ã©galement des mÃ©triques de file d'attente dÃ©taillÃ©es.  Tels que le nombre de messages reÃ§us / envoyÃ©s / supprimÃ©s, la taille en Ko de ces messages, etc.  Vous pouvez Ã©galement connecter SQS au service de journalisation CloudWatch.  LÃ , vous pouvez voir encore plus.  LÃ  aussi, vous pouvez configurer les soi-disant <b>Â«alarmesÂ»</b> et vous pouvez configurer des actions pour tous les Ã©vÃ©nements.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">En savoir plus sur la connexion Ã  SQS.</a>  Et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation CloudWatch</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><br></a> <br><h3>  Voyons maintenant les paramÃ¨tres de la file d'attente: </h3><br><h4>  Les principaux: </h4><br>  <b>DÃ©lai de visibilitÃ© par dÃ©faut - le</b> nombre de secondes / minutes / heures pendant lesquelles le message aprÃ¨s rÃ©ception ne sera pas visible pour la rÃ©ception.  Le temps de traitement maximum est de 12 heures. <br><br>  <b>PÃ©riode de rÃ©tention des messages - le</b> nombre de secondes / minutes / heures / jours, ce qui signifie combien de temps les messages non traitÃ©s seront stockÃ©s dans la file d'attente.  Maximum - 14 jours. <br><br>  <b>Taille</b> maximale des messages <b>- taille</b> maximale des messages en Ko.  La valeur est comprise entre 1 Ko et 256 Ko. <br><br>  <b>DÃ©lai de livraison -</b> vous pouvez dÃ©finir le dÃ©lai de livraison d'un message Ã  la file d'attente.  De 0 seconde Ã  15 minutes (En fait, les messages seront dans la file d'attente, mais ne seront pas visibles pour recevoir). <br><br>  <b>Recevoir le temps d'attente des messages -</b> temps, durÃ©e de la connexion si nous utilisons Â«Interrogation longueÂ» pour recevoir de nouveaux messages. <br><br>  <b>DÃ©duplication basÃ©e sur le contenu - l'</b> indicateur, s'il est dÃ©fini sur true, un Â«ID de dÃ©duplicationÂ» sera ajoutÃ© Ã  chaque message sous la forme d'un hachage SHA-256 gÃ©nÃ©rÃ© Ã  partir du contenu. <br><br><h4>  ParamÃ¨tres de file d'attente morte </h4><br>  <b>Utiliser la stratÃ©gie de redirection - un</b> indicateur, s'il est dÃ©fini, les messages seront redirigÃ©s aprÃ¨s plusieurs tentatives. <br><br>  <b>Dead Letter Queue - le</b> nom de la file d'attente "morte" Ã  laquelle les messages bruts seront envoyÃ©s. <br><br>  <b>Maximum de rÃ©ceptions - le</b> nombre de tentatives de traitement infructueuses, aprÃ¨s quoi le message sera envoyÃ© Ã  la file d'attente "morte" <br><blockquote>  <b>Remarque: Notez</b> Ã©galement que nous pouvons envoyer tous les paramÃ¨tres principaux avec chaque message sÃ©parÃ©ment.  Par exemple, chaque message individuel peut avoir son propre <b>dÃ©lai de visibilitÃ©</b> ou <b>dÃ©lai de livraison.</b> </blockquote><h3>  Maintenant, un peu sur les messages eux-mÃªmes et leurs propriÃ©tÃ©s: </h3><br>  Un message a plusieurs paramÃ¨tres: <br><br>  <b>1. Corps du message -</b> n'importe quel texte <br>  <b>2. L'ID du groupe de messages est</b> quelque chose comme une balise, un canal, requis pour tous les messages.  Chacun de ces groupes est garanti d'Ãªtre traitÃ© en mode FIFO. <br>  <b>3. ID de dÃ©duplication de message -</b> chaÃ®ne pour identifier les doublons.  Si le mode "DÃ©duplication basÃ©e sur le contenu" est dÃ©fini, le paramÃ¨tre est facultatif. <br><br><h4>  Il existe Ã©galement des attributs de message </h4><br>  Les attributs se composent d'un nom, d'un type et d'une valeur. <br><br>  <b>1. Nom -</b> chaÃ®ne <br>  <b>2. Type -</b> il existe plusieurs types: chaÃ®ne, nombre, binaire.  Le type vient simplement sous forme de chaÃ®ne, et il est possible d'ajouter un suffixe au type.  Dans ce cas, le type viendra avec ce suffixe Ã  travers le point, par exemple string.example_postfix <br>  <b>3. Valeur -</b> chaÃ®ne <br><blockquote>  <b>Remarque:</b> veuillez noter que le nombre maximal d'attributs est de <b>10</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">DÃ©tails</a> </blockquote>  PS: cet article fournit une brÃ¨ve description de la file d'attente, ainsi qu'un peu sur les capacitÃ©s et la mÃ©canique de SQS.  L'article suivant sera consacrÃ© Ã  <b>AWS Lambda</b> , puis Ã  leur partage pratique. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457068/">https://habr.com/ru/post/fr457068/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457058/index.html">Conversion des rÃ©sultats d'impression en clics pour Google et Yandex en 2019</a></li>
<li><a href="../fr457060/index.html">Trois vidÃ©os pour les Ã©crivains iOS</a></li>
<li><a href="../fr457062/index.html">Centre de formation des cosmonautes Ã  Star City</a></li>
<li><a href="../fr457064/index.html">A la question des modules</a></li>
<li><a href="../fr457066/index.html">Comment modifier le robot FEDOR et le fauteuil de vol ISS</a></li>
<li><a href="../fr457070/index.html">Textolite au lieu de carton. Quelques mots sur le badge interactif OFFZONE 2019</a></li>
<li><a href="../fr457072/index.html">Comment rÃ©soudre un ancien problÃ¨me en utilisant ML en Python et .Net</a></li>
<li><a href="../fr457074/index.html">L'Ã©volution des dÃ©veloppeurs: Ã  quels jeux faut-il s'attendre Ã  l'avenir</a></li>
<li><a href="../fr457078/index.html">Comment transformer votre avatar Telegram en montre</a></li>
<li><a href="../fr457082/index.html">Octroi imperceptible de droits d'administrateur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>