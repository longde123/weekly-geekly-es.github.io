<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§µüèø ‚Ñ¢Ô∏è üè¥‚Äç‚ò†Ô∏è Comment automatiser avec Jenkins la cr√©ation et le roulement d'artefacts d'artefacts de mod√®le de m√©tadonn√©es pour les tables du r√©f√©rentiel üë©üèø‚Äçüéì üè¥ üë©üèΩ‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tout a commenc√© avec le fait que nous √©tions confront√©s √† la n√©cessit√© de former rapidement et correctement les structures EDWEX, JSON, DDL, puis de l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment automatiser avec Jenkins la cr√©ation et le roulement d'artefacts d'artefacts de mod√®le de m√©tadonn√©es pour les tables du r√©f√©rentiel</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rostelecom/blog/428101/">  Tout a commenc√© avec le fait que nous √©tions confront√©s √† la n√©cessit√© de former rapidement et correctement les structures EDWEX, JSON, DDL, puis de les d√©ployer sur diff√©rents contours de bases de donn√©es relationnelles.  Par contours, je veux dire des abr√©viations que tout le monde conna√Æt - DEV, TST, UAT, PRD. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/169/a9a/387/169a9a387c429ecc2c76fa39abb3527f.jpg"><br><br>  √Ä cette √©poque, nous faisions presque tout manuellement: nous avons g√©n√©r√© DDL et collect√© edwex et json en fonction des m√©tadonn√©es de la base de donn√©es Oracle.  Il existe de nombreux param√®tres d'entr√©e.  Si vous en manquez, vous formerez une entit√© incorrectement.  Et comme tout le processus de formation √©tait coh√©rent et continu, l'erreur ne sera d√©tect√©e qu'√† la toute fin.  √Ä propos de la fa√ßon dont nous avons tous automatis√© et surmont√© les erreurs, lisez sous la coupe. <br><a name="habracut"></a><br><h2>  Un peu sur l'infrastructure </h2><br>  Avant de remplir les donn√©es dans les tableaux des bases de donn√©es relationnelles, nous devons les accepter de la source - dans n'importe quel format, par exemple, dans Excel.  Les donn√©es de la source utilisant le m√©canisme interne sont transport√©es vers Hadoop (Data Lake).  Hive a install√© le module compl√©mentaire Hive - avec son aide, nous pouvons afficher le contenu des fichiers en utilisant une syntaxe de type SQL. <br><br>  Pour transf√©rer les donn√©es dans Data Lake sous forme de tableaux, nous avons besoin de json, qui sont form√©s sur la base de m√©tadonn√©es.  Pour analyser les donn√©es au format Excel, nous devons cr√©er des fichiers EDWEX.  Les fichiers EDWEX (EDW_EXTRACTOR) sont un ensemble d'artefacts qui contiennent des ensembles de tables avec le nom, ainsi que des ensembles de champs pour chacune de ces tables, qui sont form√©s sur la base de m√©tadonn√©es.  En fonction de la version du mod√®le et de l'ID source, l'ensemble de champs varie.  La formation de DDL est n√©cessaire pour cr√©er les tables elles-m√™mes dans la base de donn√©es Hive au niveau des donn√©es op√©rationnelles et dans la base de donn√©es Greenplum au niveau des donn√©es d√©taill√©es et agr√©g√©es.  Autrement dit, les donn√©es sont principalement transf√©r√©es vers Hive, si n√©cessaire, filtr√©es et transf√©r√©es vers Greenplum pour une manipulation ult√©rieure des donn√©es et la cr√©ation de vitrines bas√©es sur celle-ci. <br><br><div class="spoiler">  <b class="spoiler_title">Exemple d'artefact Edwex</b> <div class="spoiler_text">  pack - contient un ensemble de tables <br>  donn√©es - contient un ensemble de champs <br><br>  pack.edwex: <br><br><pre><code class="sql hljs">1 Table_1 User Table_1 bid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm') 2 Table_2 User Table_2 curbid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm') 3 Table_3 User Table_3 bid between to_char($fromdt,'yyyymm') and to_char($actualdt,'yyyymm')</code> </pre> <br><br>  data.edwex: <br><br><pre> <code class="sql hljs">1 1 CHARGE_ID NUMBER 38 0 1 2 SVC_ID NUMBER 38 0 1 3 VND_ID NUMBER 38 0 1 4 PRICE NUMBER 38 5 1 5 QUANTITY NUMBER 38 5 1 6 BASE NUMBER 38 5 1 7 TAX NUMBER 38 5 1 8 TOTAL NUMBER 38 5 1 9 TAX_RATE NUMBER 38 5 1 10 TAX_IN VARCHAR 1 1 11 CHARGE_KIND VARCHAR 3 1 12 PRIVILEGE_ID NUMBER 38 0 1 13 CHARGE_REF_ID NUMBER 38 0 1 14 EBID NUMBER 38 0 1 15 INVOICE_ID NUMBER 38 0 1 16 ZERO_STATE_ID NUMBER 38 0 1 17 USER_ID NUMBER 38 0 1 18 BID NUMBER 38 0 1 19 QUANTITY_REAL NUMBER 38 5 2 1 CURBID NUMBER 38 0 2 2 USER_ID NUMBER 38 0 2 3 VND_ID NUMBER 38 0 2 4 APPBID NUMBER 38 0 2 5 SVC_ID NUMBER 38 0 2 6 DEBT NUMBER 38 5 2 7 INSTDEBT NUMBER 38 5 3 1 INVOICE_ID NUMBER 38 0 3 2 INVOICE_DATE DATE 3 3 INVOICE_NUM VARCHAR 64 3 4 INVOICE_NUM_N NUMBER 38 5 3 5 BASE NUMBER 38 5 3 6 TAX NUMBER 38 5 3 7 TOTAL NUMBER 38 5 3 8 PREPAID VARCHAR 1 3 9 EXPLICIT VARCHAR 1 3 10 VND_ID NUMBER 38 0 3 11 ADV_PAYMENT_ID NUMBER 38 0 3 12 MDBID NUMBER 38 0 3 13 BID NUMBER 38 0 3 14 USER_ID NUMBER 38 0 3 15 ZERO_STATE_ID NUMBER 38 0 3 16 ACTIVE_SUM NUMBER 38 5 3 17 SPLIT_VND NUMBER 38 5 3 18 PRECREATED VARCHAR 1</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Exemple d'artefact Json</b> <div class="spoiler_text"><pre> <code class="java hljs">Table.json: { <span class="hljs-string"><span class="hljs-string">"metadata"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"true"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"svc_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"3"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"vnd_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"price"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"5"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"quantity"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"6"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"base"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"7"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"8"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"total"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"9"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax_rate"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"10"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"tax_in"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"11"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_kind"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"STRING"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"12"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"privilege_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"13"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"charge_ref_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"14"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"ebid"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"15"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"invoice_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"16"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"zero_state_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"17"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"user_id"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"18"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"bid"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"colOrder"</span></span>:<span class="hljs-string"><span class="hljs-string">"19"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>:<span class="hljs-string"><span class="hljs-string">"quantity_real"</span></span>, <span class="hljs-string"><span class="hljs-string">"dataType"</span></span>:<span class="hljs-string"><span class="hljs-string">"DECIMAL"</span></span>, <span class="hljs-string"><span class="hljs-string">"precision"</span></span>:<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"requied"</span></span>:<span class="hljs-string"><span class="hljs-string">"false"</span></span>, <span class="hljs-string"><span class="hljs-string">"keyFile"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span> } ], <span class="hljs-string"><span class="hljs-string">"ctlPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"  ctl"</span></span>, <span class="hljs-string"><span class="hljs-string">"errPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"    "</span></span>, <span class="hljs-string"><span class="hljs-string">"inPath"</span></span>:<span class="hljs-string"><span class="hljs-string">"    hdfs"</span></span>, <span class="hljs-string"><span class="hljs-string">"outSchema"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"outTable"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"isPartitioned"</span></span>:<span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"sourceId"</span></span>:<span class="hljs-string"><span class="hljs-string">"id  "</span></span> }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Exemples d'artefacts DDL</b> <div class="spoiler_text">  modifier le sch√©ma de table.GP_000001_TABLE renommer en Z_GP_000001_TABLE_20180807; <br>  cr√©er un sch√©ma de table.GP_000001_TABLE <br>  ( <br><br>  `charge_id` DECIMAL (38.0), <br>  `svc_id` DECIMAL (38.0), <br>  `vnd_id` DECIMAL (38.0), <br>  `prix` D√âCIMAL (38,5), <br>  `quantit√©` D√âCIMALE (38,5), <br>  `base` DECIMAL (38,5), <br>  `tax` DECIMAL (38.5), <br>  ¬´total¬ª D√âCIMAL (38,5), <br>  `tax_rate` DECIMAL (38.5), <br>  `tax_in` STRING, <br>  `charge_kind` STRING, <br>  `privilege_id` DECIMAL (38.0), <br>  `charge_ref_id` DECIMAL (38.0), <br>  `ebid` DECIMAL (38.0), <br>  `facture_id` DECIMAL (38.0), <br>  `zero_state_id` DECIMAL (38,0), <br>  `user_id` DECIMAL (38.0), <br>  `bid` DECIMAL (38.0), <br>  `quantity_real` DECIMAL (38,5), <br>  TIMESTAMP `load_dttm`, <br>  `src_id` SMALLINT, <br>  `package_id` BIGINT, <br>  `wf_run_id` BIGINT, <br>  `md5` STRING <br>  ) <br>  CHAMPS D√âLIMIT√âS AU FORMAT DE LIGNE TERMIN√âS PAR '\ t' <br>  ENREGISTR√â COMME INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' <br>  EMPLACEMENT 'moyen de se former en hdfs' <br>  TBLPROPERTIES ('auto.purge' = 'true', 'transient_lastDlastDdlTime' = '1489060201'); <br>  ins√©rer dans le sch√©ma.GP_000001_TABLE (`charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `prix`, <br>  `quantit√©`, <br>  `base`, <br>  `taxe`, <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `charge_kind`, <br>  `privilege_id`, <br>  `charge_ref_id`, <br>  `ebid`, <br>  `facture_id`, <br>  `zero_state_id`, <br>  `user_id`, <br>  ench√©rir <br>  `quantity_real`, <br>  `load_dttm`, <br>  `src_id`, <br>  package_id <br>  `wf_run_id`, <br>  `md5`) <br><br>  s√©lectionnez `charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `prix`, <br>  `quantit√©`, <br>  `base`, <br>  `taxe`, <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `charge_kind`, <br>  `privilege_id`, <br>  `charge_ref_id`, <br>  `ebid`, <br>  `facture_id`, <br>  `zero_state_id`, <br>  `user_id`, <br>  ench√©rir <br>  `quantity_real`, <br>  load_dttm, <br>  src_id <br>  package_id, <br>  wf_run_id, <br>  md5 du sch√©ma.Z_GP_000001_TABLE_20180807; <br><br>  modifier le sch√©ma de table.GP_000001_TABLE renommer en Z_GP_000001_TABLE_20180807; <br>  cr√©er un sch√©ma de table.GP_000001_TABLE <br>  ( <br><br>  `charge_id` DECIMAL (38.0), <br>  `svc_id` DECIMAL (38.0), <br>  `vnd_id` DECIMAL (38.0), <br>  `prix` D√âCIMAL (38,5), <br>  `quantit√©` D√âCIMALE (38,5), <br>  `base` DECIMAL (38,5), <br>  `tax` DECIMAL (38.5), <br>  ¬´total¬ª D√âCIMAL (38,5), <br>  `tax_rate` DECIMAL (38.5), <br>  `tax_in` STRING, <br>  `charge_kind` STRING, <br>  `privilege_id` DECIMAL (38.0), <br>  `charge_ref_id` DECIMAL (38.0), <br>  `ebid` DECIMAL (38.0), <br>  `facture_id` DECIMAL (38.0), <br>  `zero_state_id` DECIMAL (38,0), <br>  `user_id` DECIMAL (38.0), <br>  `bid` DECIMAL (38.0), <br>  `quantity_real` DECIMAL (38,5), <br>  TIMESTAMP `load_dttm`, <br>  `src_id` SMALLINT, <br>  `package_id` BIGINT, <br>  `wf_run_id` BIGINT, <br>  `md5` STRING <br>  ) <br>  CHAMPS D√âLIMIT√âS AU FORMAT DE LIGNE TERMIN√âS PAR '\ t' <br>  ENREGISTR√â COMME INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' <br>  EMPLACEMENT 'moyen de se former en hdfs' <br>  TBLPROPERTIES ('auto.purge' = 'true', 'transient_lastDlastDdlTime' = '1489060201'); <br>  ins√©rer dans le sch√©ma.GP_000001_CPA_CHARGE (`charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `prix`, <br>  `quantit√©`, <br>  `base`, <br>  `taxe`, <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `charge_kind`, <br>  `privilege_id`, <br>  `charge_ref_id`, <br>  `ebid`, <br>  `facture_id`, <br>  `zero_state_id`, <br>  `user_id`, <br>  ench√©rir <br>  `quantity_real`, <br>  `load_dttm`, <br>  `src_id`, <br>  package_id <br>  `wf_run_id`, <br>  `md5`) <br><br>  s√©lectionnez `charge_id`, <br>  `svc_id`, <br>  `vnd_id`, <br>  `prix`, <br>  `quantit√©`, <br>  `base`, <br>  `taxe`, <br>  `total`, <br>  `tax_rate`, <br>  `tax_in`, <br>  `charge_kind`, <br>  `privilege_id`, <br>  `charge_ref_id`, <br>  `ebid`, <br>  `facture_id`, <br>  `zero_state_id`, <br>  `user_id`, <br>  ench√©rir <br>  `quantity_real`, <br>  load_dttm, <br>  src_id <br>  package_id, <br>  wf_run_id, <br>  md5 du sch√©ma.Z_GP_000001_TABLE_20180807; <br></div></div><br><h2>  Comment automatiser </h2><br>  Pour r√©soudre le probl√®me, nous avons utilis√©: <br><br><ul><li>  Jenkins - en tant qu'orchestre et outil de mise en ≈ìuvre du processus CI. <br></li><li>  Python - il impl√©mente des fonctionnalit√©s et des tests unitaires. <br></li><li>  SQL - pour acc√©der √† la base de donn√©es de m√©tadonn√©es. <br></li><li>  Script shell - pour copier des artefacts entre des r√©pertoires et cr√©er des scripts dans des projets multi-t√¢ches ex√©cut√©s sur le serveur Jenkins. <br></li></ul><br>  Pour commencer, nous travaillons initialement avec un grand nombre de sources.Par cons√©quent, en utilisant le script Shell comme param√®tre de d√©marrage, nous transmettons les ID des sources aux fonctions SQL pour les identifier.  Les fonctions SQL r√©sultantes seront ensuite ex√©cut√©es automatiquement dans la base de donn√©es de m√©tadonn√©es.  Sur la base des m√©tadonn√©es disponibles, ces fonctions forment un fichier avec une liste de nouvelles fonctions SQL pour chacune des tables source afin que nous puissions les appeler ult√©rieurement dans le programme ex√©cutable.  Le r√©sultat de l'ex√©cution des fonctions g√©n√©r√©es est le transfert des valeurs DDL, JSON ou EDWEX au param√®tre de sortie. <br><br>  C'est l√† que Python se connecte, avec toutes les fonctionnalit√©s ex√©cutables et les tests unitaires √©crits.  Avant de d√©marrer l'un des modules de roulement des artefacts √† l'aide de tests unitaires, le transfert de param√®tres correct est v√©rifi√© pour ex√©cuter des scripts python.  Les tests v√©rifient non seulement l'exactitude des param√®tres d'entr√©e, mais √©galement leur pr√©sence dans le module de m√©tadonn√©es, les tailles des fichiers cr√©√©s et les dates de leur cr√©ation.  Les tests contr√¥lent √©galement le nombre de nouveaux artefacts cr√©√©s et le nombre d'artefacts existants.  Nous optimisons donc l'utilisation des ressources du serveur, car nous ne prenons que les nouveaux fichiers √† d√©placer et ne r√©installons pas les mod√®les existants. <br><br>  Et ce n'est qu'apr√®s avoir r√©ussi toutes les v√©rifications qu'un programme python est ex√©cut√© qui cr√©e les artefacts n√©cessaires et d√©compose le r√©sultat dans les dossiers de projet n√©cessaires sur le serveur.  Python dirige non seulement les fichiers json g√©n√©r√©s dans des r√©pertoires, mais forme √©galement des structures dans Data Lake afin que les donn√©es se chargent correctement.  Lors de la g√©n√©ration d'artefacts DDL, ils sont non seulement enregistr√©s pour une analyse et une r√©utilisation ult√©rieures, mais peuvent √©galement √™tre imm√©diatement install√©s dans la base de donn√©es √† l'aide de nouveaux mod√®les et structures sp√©cifi√©s dans le module de m√©tadonn√©es.  Cela vous permet de cr√©er des centaines de tables en peu de temps sans impliquer de travail manuel. <br><br><h2>  Et o√π est Jenkins ici? </h2><br>  Jenkins entre lorsqu'il est n√©cessaire de g√©rer visuellement tous ces processus √† l'aide d'une interface. <br><br>  Cet outil a √©t√© s√©lectionn√© car il: <br><br><ul><li>  couvre enti√®rement les besoins d'automatisation de l'assemblage et de l'installation <br></li><li>  vous permet de concevoir un m√©canisme d'assemblage d'artefacts avec la mise en ≈ìuvre du processus d'auto-test <br></li><li>  vous permet de g√©rer facilement les lancements de travaux et de surveiller l'ex√©cution √† une personne loin de la programmation <br></li><li>  vous permet de configurer le m√©canisme de journalisation de mani√®re √† ce que le r√©sultat de l'ex√©cution soit compr√©hensible pour toute personne de l'√©quipe.  Le probl√®me dans l'assembly sera explicitement indiqu√© ou le processus se terminera avec succ√®s. <br></li></ul><br>  Pour r√©soudre les t√¢ches, nous avons cr√©√© plusieurs projets multi-t√¢ches.  Ce type de projet a √©t√© utilis√©, car il peut fonctionner en parall√®le avec d'autres travaux en un seul d√©marrage.  Chacun des jobs est responsable de l'impl√©mentation de son bloc de fonctionnalit√©s.  Nous avons donc remplac√© le processus s√©quentiel d'obtention d'artefacts par des artefacts parall√®les autonomes.  Tout commence s√©par√©ment: la formation d'EDWEX, JSON, DDL, la formation de la structure dans HIVE, l'installation des structures de table dans la base de donn√©es.  Nous analysons le r√©sultat √† diff√©rentes √©tapes de la formation des artefacts et proc√©dons au lancement des actions suivantes en cas de succ√®s. <br><br>  La partie Jenkins est impl√©ment√©e sans trop de trucs.  <b>Les</b> param√®tres de <b>cha√Æne</b> ou d' <b>ex√©cution</b> sont envoy√©s √† l'entr√©e pour d√©marrer le code python.  <b>Le</b> param√®tre <b>String</b> est une fen√™tre permettant de saisir une valeur de type str avant de d√©marrer.  <b>Le</b> param√®tre <b>run</b> peut √™tre transf√©r√© √† la vol√©e vers un autre job pour ex√©cution, il suffit pour cela d'indiquer de quel projet il est n√©cessaire de prendre la variable re√ßue.  En outre, un n≈ìud est transmis en tant que param√®tre distinct pour l'ex√©cution.  Ici, le partitionnement en runtimes sur DEV, TST, UAT, PRD vient d'√™tre impl√©ment√©.  Un travail distinct a √©t√© utilis√© pour transf√©rer les fichiers EDWEX re√ßus vers SVN avec le num√©ro de r√©vision afin de pouvoir suivre les versions des structures modifi√©es. <br><br>  Un exemple d'interface dans Jenkins: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00f/250/8c5/00f2508c5c04082a8b753041e471fe14.png"><br><br>  Le r√©sultat de l'ex√©cution du travail est la cr√©ation et l'installation des artefacts n√©cessaires, leur transfert vers SVN et la formation d'un rapport HTML qui affiche le succ√®s des tests unitaires r√©ussis et les r√©sultats de l'assemblage et de l'installation des artefacts.  Les travaux peuvent √™tre ex√©cut√©s individuellement avec vos mains ou en mode automatique, apr√®s avoir pr√©alablement construit une cha√Æne d'ex√©cution. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/324/549/50f/32454950f7eb0476ca4cc753715c4472.png"><br>  <i>Architecture du m√©canisme d'assemblage et d'installation</i> <br><br><h3>  Pour r√©sumer </h3><br>  Beaucoup de travail a √©t√© fait pour automatiser la formation des artefacts.  Auparavant, vous deviez monter manuellement sur le serveur, ex√©cuter des scripts shell, puis √©tudier et modifier les donn√©es pendant longtemps avec vos mains.  Maintenant, cliquez simplement sur le bouton D√©marrer, sp√©cifiez l'ID du syst√®me source, le num√©ro de mod√®le et la boucle d'ex√©cution.  Avec l'aide de Jenkins, il a √©t√© possible de structurer et de d√©composer l'ensemble du m√©canisme d'assemblage et d'installation des artefacts en √©tapes ind√©pendantes.  Les v√©rifications n√©cessaires ont √©t√© ajout√©es avant de commencer la formation des artefacts et leur int√©gration.  Les artefacts re√ßus sont automatiquement transf√©r√©s vers SVN, ce qui simplifie le travail avec des √©quipes connexes d'analystes syst√®me et de mod√©lisateurs de donn√©es.  Des v√©rifications sont mises en ≈ìuvre pour √©viter les lancements inactifs de la formation d'artefacts et confirmer leur exactitude. <br><br>  En cons√©quence, nous avons r√©duit le processus fastidieux d'assemblage et d'installation des artefacts de mod√®le de plusieurs heures √† quelques minutes.  Et surtout, ils ont √©limin√© les erreurs dues au facteur humain, qui se sont in√©vitablement produites dans un processus de routine complexe. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428101/">https://habr.com/ru/post/fr428101/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428089/index.html">"Calendrier des testeurs" pour octobre. Commentaires: comment cela se passe</a></li>
<li><a href="../fr428091/index.html">Comment un √©tudiant stagiaire a cr√©√© le jeu vid√©o le plus populaire au monde ou l'historique des jeux Windows</a></li>
<li><a href="../fr428095/index.html">√âtude de march√© pour les studios web et les agences num√©riques</a></li>
<li><a href="../fr428097/index.html">Routage r√©cursif dans MikroTik via des passerelles attribu√©es par DHCP</a></li>
<li><a href="../fr428099/index.html">Qu'ont en commun les robes ordinaires et la prochaine √®re 5G?</a></li>
<li><a href="../fr428103/index.html">Mitap √† Saint-P√©tersbourg: ing√©nierie des donn√©es et plus</a></li>
<li><a href="../fr428105/index.html">Blogger recommande: influencer le marketing</a></li>
<li><a href="../fr428107/index.html">Conteneurisation d'applications Angular 6 SPA Template ASP .NET Core 2.1</a></li>
<li><a href="../fr428109/index.html">Mur d'entreprise</a></li>
<li><a href="../fr428111/index.html">Arithm√©tique de pr√©cision arbitraire √† Erlang</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>