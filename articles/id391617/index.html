<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👼🏻 🎂 🐑 Mengganti penyesuaian analog dengan digital pada catu daya laboratorium HY3005D 💵 🥞 🌤️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini akan membahas penggantian potensiometer standar dengan encoder mekanik EC11 (sensor sudut akumulasi) dalam unit catu daya Mastech HY3005D ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mengganti penyesuaian analog dengan digital pada catu daya laboratorium HY3005D</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/391617/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Artikel ini akan membahas penggantian potensiometer standar dengan encoder mekanik EC11 (sensor sudut akumulasi) dalam unit catu daya Mastech HY3005D menggunakan mikrokontroler PIC16F1829 dan register geser 74HC595 yang menerapkan DAC pada matriks resistor R2R</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kata Pengantar</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Beberapa tahun yang lalu, saya membeli catu daya Mastech HY3005D. Belum lama ini ada masalah dengan regulasi tegangan - lapisan grafit rheostat aus dan pengaturan tegangan yang diperlukan menjadi tugas yang sulit. Tidak ada rheostat yang cocok, dan saya memutuskan untuk tidak membeli yang serupa, tetapi untuk mengubah metode penyesuaian. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tingkat tegangan dan arus keluaran diatur oleh tegangan referensi yang dipasok ke amplifier operasional. Dengan demikian, Anda dapat sepenuhnya menyingkirkan potensiometer dengan menggantinya dengan DAC yang mampu memberikan tegangan dalam kisaran yang diinginkan.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dalam katalog microchip, saya tidak dapat menemukan mikrokontroler yang cocok yang memiliki dua DAC, dan DAC eksternal tidak memiliki label harga yang kecil dan fungsi ekstra yang terlalu banyak. </font><font style="vertical-align: inherit;">Oleh karena itu, saya memperoleh register geser 74HC595 dan resistor untuk matriks R2R. </font><font style="vertical-align: inherit;">Mikrokontroler PIC16F1829 sudah tersedia. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Agar dapat kembali ke sirkuit asli, semua perubahan diminimalkan - menggantikan unit penyesuaian yang dibuat pada papan terpisah.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi pekerjaan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rangkaian ini didasarkan pada mikrokontroler </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PIC16F1829 yang</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> beroperasi pada frekuensi 32 MHz. Frekuensi clock diatur oleh generator clock internal, menurut datasheet itu tidak terlalu akurat, tetapi untuk sirkuit ini tidak kritis. Keuntungan dari MK ini adalah adanya pull-up resistor pada semua input digital dan dua modul MSSP yang mengimplementasikan SPI. Semua 18 pin logika mikrokontroler digunakan. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pada empat register geser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">74HC595</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dan matriks R2R mengimplementasikan dua DAC 16-bit. Keuntungan dari register ini termasuk adanya register shift dan register penyimpanan yang terpisah. Ini memungkinkan Anda untuk menulis data ke register tanpa merusak nilai output saat ini. Matriks R2R dipasang pada resistor dengan kesalahan 1%. Perlu dicatat bahwa pengukuran selektif menunjukkan kesalahan tidak lebih dari 10 ohm. Awalnya, itu direncanakan untuk menggunakan 3 register, tetapi ketika kabel papan tampaknya bagi saya bukan solusi yang baik, di samping itu, perlu untuk menambahkan camilan.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Resistor pull-up yang terpasang pada MC diaktifkan pada semua input dan menyederhanakan sirkuit. Semua output dari encoders terhubung langsung ke terminal MK, total masing-masing 4 encoders memiliki dua output untuk sensor rotasi itu sendiri dan satu untuk tombol built-in. Sebanyak 12 kesimpulan MK digunakan untuk memproses input data. Bouncing kontak dihaluskan dengan kapasitas 100nF. Setelah mengubah nilai buffer arus dan tegangan 16-bit sesuai dengan data input dari enkoder, nilai-nilai tersebut ditransfer ke register geser 74HC595 melalui SPI. Untuk mengurangi waktu transfer data, dua modul SPI digunakan, yang memungkinkan data ditransmisikan secara bersamaan untuk arus dan tegangan. Setelah data ditransfer ke register, perintah dikirim untuk mentransfer data dari buffer shift ke buffer penyimpanan. Keluaran register terhubung ke matriks R2R yang bertindak sebagai pembagi untuk DAC.Tegangan keluaran dari matriks ditransmisikan ke input amplifier operasional.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tombol-tombol yang dibangun ke dalam enkoder menetapkan minimum (tombol enkoder untuk pengaturan halus) atau maksimum (tombol enkoder untuk pengaturan kasar), masing-masing, untuk arus atau tegangan.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Skema</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Di Internet, saya tidak menemukan skema yang sepenuhnya sesuai dengan skema saya, jadi saya mengambil tautan pertama. </font><font style="vertical-align: inherit;">Membuat koreksi pada inkonsistensi yang terungkap dan kemudian menambahkan perubahan. </font><font style="vertical-align: inherit;">Saya menggambar diagram blok penyesuaian di TinyCAD - unduh file </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HY3005D-regulator.dsn</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Asli</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/c04/fe1/917/c04fe19174fe4b469bd80b9a6c45139c.gif"><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah ditemukan ketidakakuratan</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/484/820/123/4848201239bc4dfd95b06a98798a6289.gif"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Skema terakhir setelah penyempurnaan </font></font><br>
<img src="https://habrastorage.org/files/b3e/41c/9f1/b3e41c9f1ed941efb654903269157775.gif"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unit portabel dengan penyesuaian (disorot dengan warna merah) ditempatkan dalam skema terpisah. </font></font><br>
<img src="https://habrastorage.org/files/306/7ff/1b6/3067ff1b6f29462ba6d4adffad1526f7.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Voltmeter digital dengan tampilan di panel depan (tidak ada pada diagram) terhubung ke konektor J3.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Komponen yang Digunakan</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Di bawah ini adalah daftar komponen yang digunakan (kasing ditunjukkan dalam tanda kurung). </font><font style="vertical-align: inherit;">Semua dibeli pada waktu yang berbeda di Cina. </font><font style="vertical-align: inherit;">Penting untuk menggunakan LED dengan karakteristik yang sama dengan yang asli </font><font style="vertical-align: inherit;">mereka berdiri seri di sirkuit keluaran amplifier operasional (saya mengambil yang sama yang berdiri di motherboard saya).</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U1: PIC16F1829I / ML mikrokontroler (QFN)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U2 - U5: register geser 74HC595BQ (DHVQFN16 atau SOT-763)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">U6: AMS1117 5V regulator tegangan linier (SOT-223)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RE1 - RE4: sensor sudut akumulasi mekanik EC11</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Matriks R1, R2 dan R2R: resistor 1 dan 2 kΩ (SMD 0402)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C1 - C12, C14-C17: Kapasitor Keramik GRM21BR71E104KA01L 100nF (SMD 0805)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C13: tantalum kapasitor 22mkF 16V (tiv B)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D1, D2: voltase panel depan / LED saat ini</font></font></li>
</ul><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biaya</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Saya membesarkan papan di Sprint Layout 6 - unduh file </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HY3005D-regulator.lay6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Sayangnya, yang asli di mana saya membuat versi saya tidak dipertahankan, dalam format lay6 sudah dengan koreksi diidentifikasi selama perakitan:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya menambahkan jumper di sebelah antarmuka firmware ke koneksi interupsi dari kendali arus lancar, karena </font><font style="vertical-align: inherit;">pemantulan kontak kapasitas penyaringan mencegah pemasangan pengontrol</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menambahkan jumper yang hilang untuk tanah di antara kedua sisi</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Memindahkan perakitan penstabil 5V ke sisi lain untuk mengurangi jumper</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menambahkan kapasitor smoothing pada saluran listrik ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">diskusi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
</ol><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foto setelah etsa dan pengeboran (versi pertama)</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/593/555/618/593555618b46cfb0ea30bc3fb40f31e6.jpg"><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/6ec/ebc/c47/6ecebcc4789fd48ab80a8ef7f690049a.jpg"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dibuat menggunakan film photoresist. </font><font style="vertical-align: inherit;">Saya menderita untuk waktu yang lama dengan kabel register kecil. </font><font style="vertical-align: inherit;">Dalam versi terakhir, ada kekurangan kecil yang harus dibersihkan setelah etsa. </font><font style="vertical-align: inherit;">Namun secara umum, dewan gagal. </font><font style="vertical-align: inherit;">Masih ada dua jumper yang cukup untuk menghubungkan tanah di sisi depan dan belakang.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah memasukkan masalah yang diidentifikasi (versi kedua)</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/450/175/2fe/4501752fed894a78be212939a76b2794.png"><br>
<img src="https://habrastorage.org/files/a69/089/610/a6908961064b4f25984f5c1ee53dd8b6.png"><br>
       0    SMD 0805.<br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Foto setelah pembukaan dan pemasangan dilakukan</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/be4/678/8d1/be46788d12079fd0ca782c1f084cf166.jpg"><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;     .   —     .          —   12.<br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Seperti yang Anda lihat, perubahannya minimal, semua konektor lama tetap tidak berubah. </font><font style="vertical-align: inherit;">Saya harus menambahkan makanan secara terpisah, karena </font><font style="vertical-align: inherit;">satu-satunya tegangan yang masuk ke papan penyesuaian 2.5V tidak cocok untuk pembagi asli. </font><font style="vertical-align: inherit;">Jika Anda melepaskan 2.5V zener diode (V5A) pada papan utama catu daya dan meletakkan jumper di tempat resistor (R1A), Anda dapat melakukannya tanpa tambahan pasokan daya 12V.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Firmware</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kode C untuk kompiler XC8. </font><font style="vertical-align: inherit;">Dijahit PICkit 3 asli.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title">config.h</b><div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// PIC16F1829 Configuration Bit Settings</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// 'C' source line config statements</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#include &lt;xc.h&gt;</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// #pragma config statements should precede project file includes.</span></span>
<span class="hljs-comment"><span class="hljs-comment">// Use project enums instead of #define for ON and OFF.</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// CONFIG1</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config FOSC = INTOSC    // Oscillator Selection (INTOSC oscillator: I/O function on CLKIN pin)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config WDTE = OFF       // Watchdog Timer Enable (WDT disabled)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config PWRTE = OFF      // Power-up Timer Enable (PWRT disabled)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config MCLRE = OFF      // MCLR Pin Function Select (MCLR/VPP pin function is digital input)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config CP = OFF         // Flash Program Memory Code Protection (Program memory code protection is disabled)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config CPD = OFF        // Data Memory Code Protection (Data memory code protection is disabled)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config BOREN = OFF      // Brown-out Reset Enable (Brown-out Reset disabled)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config CLKOUTEN = OFF   // Clock Out Enable (CLKOUT function is disabled. I/O or oscillator function on the CLKOUT pin)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config IESO = OFF       // Internal/External Switchover (Internal/External Switchover mode is disabled)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config FCMEN = OFF      // Fail-Safe Clock Monitor Enable (Fail-Safe Clock Monitor is disabled)</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// CONFIG2</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config WRT = OFF        // Flash Memory Self-Write Protection (Write protection off)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config PLLEN = OFF      // PLL Enable (4x PLL disabled)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config STVREN = ON      // Stack Overflow/Underflow Reset Enable (Stack Overflow or Underflow will cause a Reset)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config BORV = LO        // Brown-out Reset Voltage Selection (Brown-out Reset Voltage (Vbor), low trip point selected.)</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> config LVP = OFF        // Low-Voltage Programming Enable (High-voltage on MCLR/VPP must be used for programming)</span></span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title">main.c</b><div class="spoiler_text"><pre><code class="cs hljs"><span class="hljs-meta"><span class="hljs-meta">#include "config.h"</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _XTAL_FREQ 32000000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> intrinsic(_delay)</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> _delay(unsigned <span class="hljs-keyword"><span class="hljs-keyword">long</span></span>);
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __delay_us(x) _delay((unsigned long)((x)*(_XTAL_FREQ/4000000.0)))</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> __delay_ms(x) _delay((unsigned long)((x)*(_XTAL_FREQ/4000.0)))</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> TransferNotDone          !(SSP2STAT&amp;0b00000001)</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> StoreAll                 LATA4</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ResetAll                 LATC6</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageSharpCHA          RC1</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageSharpCHB          RC0</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageSharpBTN          RA2</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageSmoothCHA         RB5</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageSmoothCHB         RB4</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageSmoothBTN         RC2</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentSharpCHA          RC5</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentSharpCHB          RC4</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentSharpBTN          RC3</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentSmoothCHA         RA1</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentSmoothCHB         RA0</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentSmoothBTN         RA3</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageRateSharp         0x0100</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageRateSmooth        0x0010</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentRateSharp         0x0040</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentRateSmooth        0x0004</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageMax               0xC000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentMax               0x5000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageMin               0x0000</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentMin               0x0000</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> VoltageStart             0x1E00</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> CurrentStart             CurrentMax</span></span><font></font>
<font></font>
unsigned <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> VoltageBuff;<font></font>
unsigned <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> CurrentBuff;<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> interrupt </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tc_int</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {<font></font>
};<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SendData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {<font></font>
    SSP1BUF = VoltageBuff&gt;&gt;<span class="hljs-number"><span class="hljs-number">8</span></span>;<font></font>
    SSP2BUF = CurrentBuff&gt;&gt;<span class="hljs-number"><span class="hljs-number">8</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( TransferNotDone );<font></font>
    SSP1BUF = VoltageBuff;<font></font>
    SSP2BUF = CurrentBuff;<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( TransferNotDone );<font></font>
    StoreAll = <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
    StoreAll = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
};<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> {
    <span class="hljs-comment"><span class="hljs-comment">// Configure oscillator for 32MHz</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//             76543210</span></span>
    OSCCON     = <span class="hljs-number"><span class="hljs-number">0b11110000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B1</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Enable individual pull-ups</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//             76543210</span></span>
    OPTION_REG = <span class="hljs-number"><span class="hljs-number">0b01111111</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B1</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Configure analog port (1 - enable, 0 - disable)</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//             76543210</span></span>
    ANSELA     = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B3</span></span>
    ANSELB     = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B3</span></span>
    ANSELC     = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B3</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Reset latch</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//             76543210</span></span>
    LATA       = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B2</span></span>
    LATB       = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B2</span></span>
    LATC       = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B2</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Alternate pin function (set SDO2 on RA5)</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//             76543210</span></span>
    APFCON0    = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B2</span></span>
    APFCON1    = <span class="hljs-number"><span class="hljs-number">0b00100000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B2</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Configure digital port (1 - input, 0 - output)</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//             76543210</span></span>
    TRISA      = <span class="hljs-number"><span class="hljs-number">0b00001111</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B1</span></span>
    TRISB      = <span class="hljs-number"><span class="hljs-number">0b00110000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B1</span></span>
    TRISC      = <span class="hljs-number"><span class="hljs-number">0b00111111</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B1</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Configure input level (1 - CMOS, 0 - TTL)</span></span>
    INLVLA     = <span class="hljs-number"><span class="hljs-number">0b11000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B7</span></span>
    INLVLB     = <span class="hljs-number"><span class="hljs-number">0b00001111</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B7</span></span>
    INLVLC     = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B7</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Configure individual pull-ups (1 - enable, 0 - disable)</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//             76543210</span></span>
    WPUA       = <span class="hljs-number"><span class="hljs-number">0b00111111</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span>
    WPUB       = <span class="hljs-number"><span class="hljs-number">0b11110000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span>
    WPUC       = <span class="hljs-number"><span class="hljs-number">0b11111111</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span><font></font>
<font></font>
    ResetAll = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
    ResetAll = <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Configure SPI in master mode</span></span>
    <span class="hljs-comment"><span class="hljs-comment">//             76543210</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//SSP1ADD    = 0b00000000; //B4</span></span>
    SSP1STAT   = <span class="hljs-number"><span class="hljs-number">0b01000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span>
    SSP1CON3   = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span>
    SSP1CON1   = <span class="hljs-number"><span class="hljs-number">0b00100000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//SSP1ADD    = 0b00000000; //B4</span></span>
    SSP2STAT   = <span class="hljs-number"><span class="hljs-number">0b01000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span>
    SSP2CON3   = <span class="hljs-number"><span class="hljs-number">0b00000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span>
    SSP2CON1   = <span class="hljs-number"><span class="hljs-number">0b00100000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//B4</span></span><font></font>
<font></font>
    VoltageBuff = VoltageStart;<font></font>
    CurrentBuff = CurrentStart;<font></font>
    __delay_ms(<span class="hljs-number"><span class="hljs-number">50</span></span>);<font></font>
    SendData();<font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( <span class="hljs-number"><span class="hljs-number">1</span></span> ) {
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !VoltageSharpCHA ) {
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoltageSharpCHB ) { VoltageBuff-=VoltageRateSharp; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoltageBuff &gt; VoltageMax ) VoltageBuff = VoltageMin; }
                              <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { VoltageBuff+=VoltageRateSharp; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoltageBuff &gt; VoltageMax ) VoltageBuff = VoltageMax; }
            <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( !VoltageSharpCHA );<font></font>
            SendData();<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !VoltageSmoothCHA ) {
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoltageSmoothCHB ) { VoltageBuff-=VoltageRateSmooth; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoltageBuff &gt; VoltageMax ) VoltageBuff = VoltageMin; }
                               <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { VoltageBuff+=VoltageRateSmooth; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( VoltageBuff &gt; VoltageMax ) VoltageBuff = VoltageMax; }
            <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( !VoltageSmoothCHA ); <font></font>
            SendData();<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !CurrentSharpCHA ) {
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( CurrentSharpCHB ) { CurrentBuff-=CurrentRateSharp; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( CurrentBuff &gt; CurrentMax ) CurrentBuff = CurrentMin; }
                              <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { CurrentBuff+=CurrentRateSharp; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( CurrentBuff &gt; CurrentMax ) CurrentBuff = CurrentMax; }
            <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( !CurrentSharpCHA );<font></font>
            SendData();<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !CurrentSmoothCHA ) {
            <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( CurrentSmoothCHB ) { CurrentBuff-=CurrentRateSmooth; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( CurrentBuff &gt; CurrentMax ) CurrentBuff = CurrentMin; }
                               <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { CurrentBuff+=CurrentRateSmooth; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( CurrentBuff &gt; CurrentMax ) CurrentBuff = CurrentMax; }
            <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( !CurrentSmoothCHA );<font></font>
            SendData();<font></font>
        }<font></font>
<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !VoltageSharpBTN  ) { VoltageBuff = VoltageMax; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( !VoltageSharpBTN  ); SendData(); }
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !VoltageSmoothBTN ) { VoltageBuff = VoltageMin; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( !VoltageSmoothBTN ); SendData(); }
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !CurrentSharpBTN  ) { CurrentBuff = CurrentMax; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( !CurrentSharpBTN  ); SendData(); }
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !CurrentSmoothBTN ) { CurrentBuff = CurrentMin; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ( !CurrentSmoothBTN ); SendData(); }<font></font>
    };<font></font>
}<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Untuk nilai minimum, VoltageMin dan CurrentMin diatur ke 1, karena pada 0 di buffer, penyesuaian berhenti bekerja sampai saya mengerti di mana masalahnya. Tarif * Nilai * dipilih banyak dan paling nyaman menurut saya. Untuk metode SendData, saya tidak melewatkan variabel sebagai parameter untuk menyimpan instruksi dan memori mesin. Mode Low Voltage Firmware (LVP) harus dimatikan, jika tidak, RA3 tidak akan berfungsi sebagai input digital. Interupsi tidak digunakan, metode tc_int ada dalam kode sehingga kompiler menempatkan blok utama di awal ROM. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Untuk firmware, cukup untuk menghapus jumper, sambungkan PICkit 3 (atau programmer lain) dan lakukan firmware. Pada versi pertama tidak ada jumper pada CLK dan DAT, jadi saya harus melepas kapasitor smoothing, flash mereka dan kemudian solder kembali. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UPD:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Setelah memasang kapasitas tambahan pada saluran listrik, masalah keluarnya penghitung dari posisi nol menghilang. </font><font style="vertical-align: inherit;">Saya juga harus mengubah arah rotasi. </font><font style="vertical-align: inherit;">Rupanya, suara dari penyearah AMS1117 mencegah pengakuan yang benar dari keadaan enkoder. </font><font style="vertical-align: inherit;">Selain itu, saya menambahkan pengaturan nilai awal, sekarang tegangan default diatur ke 5 volt (arus masih maksimum). </font><font style="vertical-align: inherit;">Sebelum pengiriman data pertama, penundaan 50ms dimasukkan ke dalam register (nilai penundaan diambil dengan margin besar) untuk menunggu modul SPI diinisialisasi.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karakteristik tegangan keluaran</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Setelah perakitan akhir perangkat, pengukuran tegangan dilakukan antara kontak J4.1 - J4.2 (pengaturan tegangan) dan J4.1 - J4.7 (pengaturan saat ini). </font><font style="vertical-align: inherit;">Menurut data yang diperoleh, grafik (di bawah di bawah spoiler) dari dependensi nilai / tegangan untuk DAC diplot.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Grafik</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/2d2/2ca/05e/2d22ca05eaf84ab9bebb6ae56a42c00c.png"><br>
<img src="https://habrastorage.org/files/ef9/598/de4/ef9598de451f4cec96892e3486ada893.png"><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nilai-nilai yang dihitung dari tegangan diperoleh dengan rumus (U * D) / (2 ^ K), di mana </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
U adalah tegangan pada output register, dengan mempertimbangkan pembagi di sirkuit utama (untuk DAC saat ini - 4950mV, untuk tegangan DAC - 3550mV); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D adalah nilai desimal dari penghitung DAC; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kedalaman bit K - DAC (16 bit)</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang bisa diperbaiki</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">menambahkan nilai penghematan waktu</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ikat nilai standar ke tombol enkoder, misalnya, untuk tegangan: 3.3; </font><font style="vertical-align: inherit;">5.0; </font><font style="vertical-align: inherit;">7.5; </font><font style="vertical-align: inherit;">12V</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">untuk melindungi terhadap nilai yang tidak diketahui pada saat startup, lebih baik untuk menghubungkan MR ke 1, dan tarik OE melalui resistor ke 1 dan reset ke 0 setelah menginisialisasi MK.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ganti DAC dengan PWM dengan rantai penghalus ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LampTester</font></font></a> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> disarankan di   </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
</ul></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id391617/">https://habr.com/ru/post/id391617/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id391607/index.html">Kisah Chuwi - dari pemutar MP3 pada 2004 hingga tablet di Windows 10 pada 2016</a></li>
<li><a href="../id391609/index.html">Semua misi penelitian luar angkasa pada satu infografis.</a></li>
<li><a href="../id391611/index.html">Taman periode ayam: para ilmuwan telah menumbuhkan kaki dinosaurus pada ayam</a></li>
<li><a href="../id391613/index.html">Otoritas AS ingin mengakses data pengguna WhatsApp. Messenger memperkenalkan enkripsi lalu lintas suara</a></li>
<li><a href="../id391615/index.html">Foto dan video gerhana matahari 9 Maret 2016</a></li>
<li><a href="../id391619/index.html">Western Digital memperkenalkan HDD $ 46 dengan kapasitas 314 GB khusus untuk Raspberry Pi on Pi Day</a></li>
<li><a href="../id391621/index.html">Meja bundar di HSE: tren industri game</a></li>
<li><a href="../id391623/index.html">Teknologi yang dicuri: "benteng terbang" Uni Soviet</a></li>
<li><a href="../id391625/index.html">Бюджетный автомобиль Honda Civic LX с автопилотом по шоссе</a></li>
<li><a href="../id391631/index.html">M-commerce tumbuh 300% lebih cepat dari E-commerce</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>