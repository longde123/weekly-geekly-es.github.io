<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüè≠ üê¥ üßò Casa inteligente com Xiaomi no exemplo de uma sauna üêÄ üèÑ üéÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Existem muitas cr√≠ticas e v√≠deos na Internet sobre a constru√ß√£o de casas inteligentes. H√° uma opini√£o de que tudo isso √© muito caro e problem√°tico na ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Casa inteligente com Xiaomi no exemplo de uma sauna</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484372/">  Existem muitas cr√≠ticas e v√≠deos na Internet sobre a constru√ß√£o de casas inteligentes.  H√° uma opini√£o de que tudo isso √© muito caro e problem√°tico na organiza√ß√£o, ou seja, em geral, o destino dos geeks.  Mas o progresso n√£o est√° parado.  Os dispositivos est√£o se tornando mais baratos e funcionais, e o design e a instala√ß√£o s√£o bastante simples.  No entanto, as revis√µes concentram-se principalmente em 1-2 exemplos de uso, praticamente n√£o cobrindo nuances e n√£o criando uma imagem completa.  Portanto, neste artigo, quero fazer uma vis√£o geral do projeto conclu√≠do, demonstrar os casos de uso e as armadilhas encontradas na constru√ß√£o de uma casa inteligente com dispositivos Xiaomi no exemplo de uma sauna.  As id√©ias descritas com pequenas varia√ß√µes tamb√©m podem ser aplicadas √† automa√ß√£o do apartamento. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9h/lb/tj/9hlbtjf6rdghf--lzwsq-5bysk8.jpeg" alt="imagem"></div><br><h2>  Antecedentes ou por que tudo isso √© necess√°rio </h2><br>  Para iniciantes, um pequeno hist√≥rico para que o contexto possa ser entendido.  No in√≠cio do outono de 2018, a sauna foi conclu√≠da e colocada em opera√ß√£o.  A sauna √© uma estrutura de capital aut√¥noma com aquecimento e abastecimento de √°gua o ano todo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/wd/o5/nswdo5svyprgue1sgxhojmb83kk.jpeg" alt="imagem"></div><a name="habracut"></a><br>  Por raz√µes compreens√≠veis, ningu√©m vive permanentemente na casa de banho e n√£o controla a condi√ß√£o das instala√ß√µes.  Tanto quanto eu gostaria, visitar a casa de banhos tamb√©m n√£o √© uma ocorr√™ncia muito frequente.  Consequentemente, pensamentos sobre a cria√ß√£o de um banho "inteligente" estavam presentes desde o in√≠cio do projeto.  Primeiro, por raz√µes de seguran√ßa (inc√™ndio, inunda√ß√£o, controle de acesso).  Por exemplo, desligar o aquecimento a -35 graus fora (eu moro em Novosibirsk) √© uma situa√ß√£o muito perigosa.  No entanto, ao contr√°rio da casa principal, n√£o pensei no projeto de automa√ß√£o de banho desde o in√≠cio e n√£o fiz fia√ß√£o adicional nos lugares certos.  Por outro lado, o banho foi realizado pela Internet e a apar√™ncia dos outros dois edif√≠cios √© de videovigil√¢ncia (voc√™ pode avaliar o que est√° acontecendo visualmente). <br><br>  De volta de uma viagem de neg√≥cios em novembro de 2019, √† noite fui √† casa de banho, abri a porta da frente e fiquei chocado com o que vi.  Os LEDs do ponto Wi-Fi estavam piscando na escurid√£o e uma corrente de √°gua escorria pelos meus p√©s.  Ent√£o houve inunda√ß√µes e a energia n√£o foi cortada.  A √°gua na casa de banho √© organizada com a ajuda de seu pr√≥prio po√ßo, uma bomba submersa e um sistema de automa√ß√£o que controla o processo.  Como se viu mais tarde, um dos acess√≥rios no vaso sanit√°rio foi demolido e todos os quartos foram inundados.  Eu nunca descobri por que a automa√ß√£o era compassiva e ainda desligava, mas conseguiu bombear 15 cm de √°gua por metro quadrado 30. Estava a -14 graus fora daquele dia.  O piso quente conseguiu manter a temperatura ambiente no n√≠vel certo, mas havia 100% de umidade.  Voc√™ n√£o poderia se infiltrar na organiza√ß√£o de uma casa inteligente - voc√™ precisa come√ßar a faz√™-lo. <br><br><h2>  Escolha de dispositivos </h2><br>  Durante a constru√ß√£o da casa principal, adquiri experi√™ncia trabalhando com dispositivos Eldes (a fia√ß√£o apropriada foi criada).  Parte da automa√ß√£o √© feita no <a href="https://www.raspberrypi.org/">Raspberry PI</a> .  Outra parte √© feita nos <a href="https://www.aqara.com/us/home.html">dispositivos Xiaomi Aqara</a> .  A variante do Raspberry PI foi a que mais gostei e inicialmente a considerei para o banho.  Infelizmente, por√©m, exige muito mais esfor√ßo para se organizar.  Afinal, n√£o √© um dispositivo plug-and-play - de exerc√≠cios com ferro a escrever software para suas pr√≥prias necessidades.  Por certas raz√µes, o MajorDoMo n√£o ficou satisfeito com isso.  Atravessar o Raspberry PI, o adaptador ZigBee (para usar os sensores sem fio da Xiaomi) e o aprendizado necess√°rio do Apple HomeKit (e a interface do Apple HomeKit n√£o est√° muito feliz no momento).  N√£o havia muito tempo (eu n√£o queria que a situa√ß√£o se repetisse) e n√£o havia fia√ß√£o para cada ponto necess√°rio, ent√£o decidi fazer tudo nos dispositivos Xiaomi. <br><br>  O principal dispositivo nessa situa√ß√£o √© o hub.  No caso da Xiaomi, existem duas vers√µes do hub: Xiaomi Mi Smart Home Gateway 2 e Xiaomi Aqara Gateway.  Este √∫ltimo √© cerca de duas vezes mais caro, mais adequado para o mercado local e capaz de integrar dispositivos no Apple HomeKit.  No entanto, se voc√™ instalar o aplicativo Aqara Home e selecionar a regi√£o "R√∫ssia", no momento em que escrever essas linhas, apenas 13 dispositivos diferentes (interruptores, tomadas, sensores) estar√£o dispon√≠veis.  Se voc√™ instalar o aplicativo Xiaomi Home, selecione a regi√£o "China Continental", e haver√° centenas de dispositivos dispon√≠veis para conex√£o.  No entanto, se voc√™ selecionar a regi√£o "China Continental", n√£o poder√° conectar o soquete europeu e vice-versa.  Selecionar a regi√£o "China Continental" no aplicativo Aqara Home n√£o fornece a integridade dos dispositivos presentes no Xiaomi Home com a mesma regi√£o.  Por temer incompatibilidades, decidi parar no hub Xiaomi Mi Smart Home Gateway 2.  A prop√≥sito, o pr√≥prio hub √© uma l√¢mpada - isso pode ser levado em considera√ß√£o durante a instala√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/ul/kx/vsulkxlnghjjindbwwmxw9aemxq.jpeg" alt="imagem"></div><br>  Uma quest√£o interessante separada √© quanto tempo isso vai dar certo.  N√£o se trata apenas de sensores e baterias, mas de sincroniza√ß√£o e armazenamento de dados na nuvem.  No momento, a conta √© gratuita.  Toda a informa√ß√£o √© armazenada nos servidores Xiaomi.  Se amanh√£ os caras decidirem que os usu√°rios da R√∫ssia n√£o devem armazenar dados na regi√£o "China Continental" ou Roskomnadzor por algum motivo banir seus servidores, toda a casa inteligente corre o risco de se transformar em uma ab√≥bora.  Decidi por mim mesmo que, nesse caso, os sensores permanecer√£o e o hub ser√° substitu√≠do pelo Raspberri PI + ZigBee Adapter. <br><br><h2>  Monitorando e prevenindo vazamentos </h2><br>  O primeiro e mais importante cen√°rio de automa√ß√£o foi uma continua√ß√£o natural do problema - quando ocorre um vazamento, o suprimento de √°gua, ou seja, a bomba, deve ser desligado e um alerta de problema deve ser enviado ao telefone.  Havia dois locais de vazamento potencialmente perigosos. <br><br>  Al√©m do hub, esse cen√°rio exigia dois detectores de vazamento e um soquete inteligente montado na parede.  Os sensores de vazamento s√£o aut√¥nomos, funcionam com baterias.  O fabricante afirma que uma bateria ser√° suficiente por 2 anos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/d3/q2/btd3q2gftpvfsf_drdszmsisfwm.jpeg" alt="imagem"></div><br>  A instala√ß√£o de um soquete inteligente foi um pouco complicada pelo fato de que, sob os soquetes chineses, voc√™ precisa de soquetes quadrados, que n√£o s√£o vendidos em nossas lojas regulares (mas voc√™ pode encomend√°-los). <br><br>  Fazer furos quadrados ainda √© um prazer.  Al√©m disso, voc√™ precisa de um adaptador de forma adequada, embora tamb√©m haja uma tomada para o plugue europeu.  Atualmente, a vers√£o Aqara para o mercado local n√£o possui um soquete de parede, o que nos liga √† regi√£o "China Continental".  Como alternativa, voc√™ pode instalar uma tomada de parede normal e conectar uma tomada Xiaomi inteligente, mas isso exigiria dois adaptadores adicionais.  Outra alternativa foi um revezamento.  Mas parei em uma tomada na parede. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/rg/pg/qergpgrjkaqqosy5xr2pqc_hli8.jpeg" alt="imagem"></div><br>  No aplicativo Xiaomi Home, um soquete e um sensor foram adicionados.  Em seguida, um cen√°rio "em caso de vazamento" √© gravado para duas a√ß√µes: desligar o soquete e enviar um alerta. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p7/pj/ub/p7pjubzhpjzb6tt_aoxrdd20_fs.jpeg" alt="imagem"></div><br>  O primeiro sensor de vazamento foi instalado pr√≥ximo √† bomba (e, de fato, ao lado do cubo).  Para o teste, a √°gua foi vertida em uma pequena placa e o sensor foi baixado nela.  Realizei toda a a√ß√£o diretamente no local em que o sensor foi instalado para trazer a situa√ß√£o o mais pr√≥ximo poss√≠vel da realidade.  O teste foi bem-sucedido: o soquete foi desconectado, o alarme tocou no telefone e o hub piscou no modo de emerg√™ncia. <br><br>  O segundo detector de vazamento foi planejado para ser instalado no banheiro pr√≥ximo √† jun√ß√£o do tubo.  Mas com a instala√ß√£o, havia nuances - o hub n√£o viu o sensor, embora a dist√¢ncia fosse pequena.  A falha foi na configura√ß√£o das instala√ß√µes. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ce/33/gb/ce33gbivdrkzwq2f4t-vghi69ki.jpeg" alt="imagem"></div><br>  Entre o local de instala√ß√£o do cubo (banheiro) e o local de instala√ß√£o do segundo sensor de vazamento (banheiro), havia uma sala de vapor.  Nas melhores tradi√ß√µes, a sala de vapor era costurada em um c√≠rculo de papel alum√≠nio, criando problemas com a passagem do sinal. <br><br>  O fabricante afirma que os dispositivos s√£o capazes de formar uma rede mesh, ou seja, um dispositivo pode transmitir dados para o hub por outro dispositivo.  Vi informa√ß√µes em algum lugar em que apenas os dispositivos conectados √† rede (e n√£o alimentados por bateria) podem atuar como transmissores na rede mesh.  No entanto, foi o suficiente para eu instalar um sensor de temperatura no canto do banheiro para que o sinal do sensor de vazamento n√£o fosse mais perdido.  Talvez isso seja uma coincid√™ncia, porque um rel√© de controle de ilumina√ß√£o p√∫blica foi instalado abaixo do teto na lavanderia (talvez ele atue como um transmissor na rede de malha).  No entanto, o problema com a perda de sinal do detector de vazamento no banheiro foi resolvido.  Al√©m disso, a conex√£o do instrumento ao hub pode ser verificada pressionando o sensor centralmente.  Se tudo estiver bem, voc√™ ouvir√° as informa√ß√µes do hub em chin√™s puro (no caso do hub Aqara, a comunica√ß√£o ser√° em ingl√™s agrad√°vel). <br><br>  Uma verifica√ß√£o para verificar se a energia foi desconectada e depois ligada pela m√°quina mostra que a tomada inteligente se apaga.  H√° uma configura√ß√£o apropriada para que continue quando a energia for ligada: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7m/mp/rv/7mmprvrfrwirqrveigp5hk5rbna.jpeg" alt="imagem"></div><br>  Um sinal adicional de inunda√ß√£o foi o aumento da umidade para 100%.  Por favor, consulte a pr√≥xima se√ß√£o sobre como controlar este sinal. <br><br><h2>  Controle de fuma√ßa e temperatura </h2><br>  Uma sauna √© uma sala de risco de inc√™ndio, portanto, o pr√≥ximo cen√°rio foi determinar os sinais de inc√™ndio.  Para este cen√°rio, foram necess√°rios dois detectores de temperatura (e umidade) e de fuma√ßa. <br><br>  O sensor de fuma√ßa foi montado no teto do corredor no banheiro (na verdade, perto do fog√£o e da sa√≠da da sauna a vapor).  Al√©m disso, um dispositivo foi adicionado ao aplicativo Xiaomi Home e um script "em caso de detec√ß√£o de fuma√ßa" foi criado, seguido de uma notifica√ß√£o no telefone.  O teste foi realizado com uma partida de lareira.  O sensor lidou com sucesso com o teste.  O hub estava congelando o alarme, al√©m de um alerta sonoro estar funcionando.  O sensor em si tamb√©m era muito desagrad√°vel e emitia um bipe alto, alertando para um problema. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zg/ej/jg/zgejjg01wv9ayueq8tzptcumzs8.jpeg" alt="imagem"></div><br>  Outro sinal de fogo √© um aumento de temperatura.  Dois sensores foram instalados para monitorar a temperatura: um na sala de descanso e outro na sala de lavagem.  Em seguida, um cen√°rio "em caso de temperatura acima do ponto definido" foi configurado no aplicativo com uma notifica√ß√£o correspondente no telefone.  No momento, defini o limite de disparo para o banheiro em 30 graus (no ver√£o, provavelmente ser√° necess√°rio reconfigurar). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/0w/pj/nq0wpjrfwe3nsl6hfpnjxwsuzhq.jpeg" alt="imagem"></div><br>  Al√©m disso, foi configurado o cen√°rio "em caso de temperatura abaixo de uma predefini√ß√£o" com um limite de disparo de 18 graus e um aviso no telefone.  Se, por algum motivo, o aquecimento parar de funcionar, eu gostaria de saber o mais r√°pido poss√≠vel.  Da mesma forma, os cen√°rios "em caso de aumento de umidade" foram criados para ambos os sensores com um limite de acionamento de 70%, um aviso no telefone e o desligamento da bomba de √°gua. <br><br>  Dos bons b√¥nus em sensores de temperatura e umidade, gr√°ficos hist√≥ricos est√£o dispon√≠veis no aplicativo.  Voc√™ pode, por exemplo, determinar em quais momentos o banho foi usado para a finalidade a que se destina (picos de temperatura no gr√°fico abaixo) ou comparar se a temperatura atual √© anormal. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cf/tb/av/cftbaviejmlpp8nndfwizm6un60.jpeg" alt="imagem"></div><br><h2>  Controle de ventila√ß√£o </h2><br>  A sala de vapor possui um exaustor for√ßado.  Depois de concluir os procedimentos, √© desej√°vel arejar a sala.  A ventila√ß√£o √© ligada por meio de uma chave e a pr√≥pria ventila√ß√£o leva pelo menos 30 minutos.  No entanto, muitas vezes a sauna termina na primeira ou na segunda hora da noite.  Fazer tudo com anteced√™ncia nem sempre √© poss√≠vel, e sentar no final de mais 30 minutos e esperar a sauna a vapor - o prazer est√° abaixo da m√©dia, porque voc√™ j√° quer dormir. <br><br>  Para esse cen√°rio, precis√°vamos de um interruptor de chave da Xiaomi com montagem zero na parede e na parede.  O pre√ßo da pergunta √© de cerca de 1900 p.  Os switches est√£o dispon√≠veis na vers√£o do Aqara para o mercado local. <br><br>  No meu caso, voc√™ n√£o pode apenas substituir um comutador normal por um comutador inteligente - √© necess√°ria uma linha de energia.  Dessa forma, foi necess√°rio puxar uma linha zero para a abertura de instala√ß√£o do switch, essa foi uma boa oportunidade.  No caso de um disjuntor sem linha zero, a instala√ß√£o teria sido mais f√°cil. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q0/k2/p-/q0k2p-qvozvt_zk3e-i407jprhk.jpeg" alt="imagem"></div><br>  Ap√≥s a instala√ß√£o, o switch inteligente foi adicionado ao aplicativo como um dispositivo e o desempenho foi testado.  As configura√ß√µes do interruptor t√™m um temporizador e voc√™ pode definir o tempo de desligamento.  Ou seja, o timer de desligamento agora est√° definido para mais 30 minutos de ventila√ß√£o antes de sair da sauna e voc√™ pode ir para a cama em paz. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9e/4c/5g/9e4c5gckmsp0dsiekxkbvhk5imk.jpeg" alt="imagem"></div><br>  Outra op√ß√£o √© poss√≠vel para automatizar o processo.  Ap√≥s a conclus√£o dos procedimentos de banho, a porta da sala de vapor se abre completamente, al√©m da ventila√ß√£o.  Isso resulta em um aumento de temperatura na sala de lavagem, onde um sensor de temperatura est√° instalado.  Com base nessas leituras do sensor, √© poss√≠vel criar cen√°rios de ventila√ß√£o on / off.  Mas ainda n√£o executei essa op√ß√£o.  Al√©m disso, voc√™ pode experimentar o sensor para abrir a porta da sauna a vapor.  Mas receio que ele morra ou caia rapidamente, porque a porta √© de vidro e a sala de vapor pode ser de 120 graus. <br><br><h2>  Controle de ilumina√ß√£o p√∫blica </h2><br>  Outra tarefa que quer√≠amos automatizar era controlar a luz da rua na varanda.  Um dos cen√°rios t√≠picos √© acender a luz da varanda quando voc√™ n√£o estiver longe do pr√©dio e estiver escuro l√° fora.  A sauna est√° trancada, o interruptor da luz da rua fica dentro da sala.  Voc√™ tinha que seguir a chave para abrir a porta e acender a luz.  Desligar as luzes requer um procedimento semelhante.  Outro cen√°rio que ocorreu regularmente foi acender ou apagar as luzes na varanda quando voc√™ estava na casa principal.  Muitas vezes esqueci de apagar as luzes da varanda quando sa√≠ da sauna e descobri que j√° estava em casa: olhando pela janela ou olhando para as c√¢meras de seguran√ßa.  Naquele momento, eu geralmente relutava em ir a qualquer lugar, ent√£o as luzes continuavam acesas a noite toda. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/tg/ex/cctgexbilx-hsr-tomjp9cs0gl8.jpeg" alt="imagem"></div><br>  Um rel√© de dois canais foi adquirido para implementar essa ideia.  O pre√ßo da pergunta √© de cerca de 2000 p.  No momento, n√£o h√° rel√©s na vers√£o do Aqara para o mercado local.  Mas pode ser substitu√≠do por um interruptor de chave (√© claro que instal√°-lo na caixa do distribuidor √© um processo mais problem√°tico). <br><br>  Inicialmente, eu deveria montar o rel√© atr√°s do interruptor de chave, mas era muito dif√≠cil alcan√ßar a linha de energia (o rel√© novamente precisa de energia).  O local ideal √© a caixa de deriva√ß√£o onde a linha de energia, a linha do disjuntor e a linha das luzes da rua convergiram.  Estava sob um teto falso, por isso teve que desmontar alguns dos trilhos do carro.  Era desej√°vel pensar sobre esse assunto com anteced√™ncia.  No entanto, a instala√ß√£o foi bem sucedida.  O diagrama de fia√ß√£o √© muito mais complicado do que para soquetes e interruptores (no meu caso, quatro fios de 3 n√∫cleos e 8 terminais no pr√≥prio rel√©).  Para n√£o ficar na cabe√ßa e n√£o misturar nada, pintei o diagrama do circuito no papel antes de mont√°-lo.  Em seguida, fiz uma montagem de teste para verificar tudo: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bz/n5/gd/bzn5gdba_obeh-ja73lxl2fdvjc.jpeg" alt="imagem"></div><br>  O dispositivo foi conectado ao aplicativo e a fase de teste come√ßou.  As luzes da rua precisavam ser ligadas / desligadas com o interruptor de chave anterior e o aplicativo.  Existem duas luzes da rua, uma √† esquerda e outra √† direita.  O rel√© possui dois canais, mas n√£o fazia sentido lig√°-los separadamente.  Por outro lado, voc√™ tamb√©m n√£o deseja ativ√°-los alternadamente com dois cliques no aplicativo.  Portanto, o controle foi realizado em um canal do rel√©.  Por uma estranha coincid√™ncia, essa op√ß√£o n√£o funcionou normalmente - houve uma ader√™ncia em uma ou outra posi√ß√£o.  N√£o havia tempo para experimentos, porque o dia claro havia terminado e quer√≠amos montar o carro no teto.  Ent√£o, eu simplesmente liguei as lanternas paralelas aos dois canais e tudo funcionou como desejado.  Para fazer o comutador f√≠sico e de software funcionar como comutador de gateway, a op√ß√£o Intertravamento foi ativada nas configura√ß√µes do rel√©. <br><br>  Tamb√©m seria poss√≠vel organizar a ativa√ß√£o / desativa√ß√£o das luzes pelo temporizador.  Mas esse cen√°rio ainda n√£o era interessante. <br><br><h2>  Controle de acesso ao quarto </h2><br>  Outro momento curioso foi o controle da abertura da porta da rua.  Primeiro de tudo, para determinar e notificar que algu√©m havia esquecido essa mesma porta normalmente batendo ou deixado aberta. <br><br>  Para este cen√°rio, era necess√°rio um sensor de janela / porta aberta.  O pre√ßo da pergunta √© de cerca de 1000 p.  Existem sensores na vers√£o Aqara para o mercado local (eles t√™m bordas menos arredondadas). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pb/fy/id/pbfyidivjmpgggpxrwxowgeq-h8.jpeg" alt="imagem"></div><br>  A instala√ß√£o √© muito simples - os sensores s√£o montados em fita dupla face.  Antes da montagem, √© melhor conectar o sensor no aplicativo para ver a que dist√¢ncia o sensor √© acionado.  As instru√ß√µes dizem at√© 20 mm de folga, mas isso n√£o √© verdade, para dizer o m√≠nimo - o sensor e o √≠m√£ de resposta precisam ser montados quase de perto.  Na casa principal, a porta da garagem possui um sensor semelhante.  Existe uma veda√ß√£o de 1 cm de largura entre o trilho de guia e a porta.  A essa dist√¢ncia, o sensor mostrava uma posi√ß√£o "aberta" e o √≠m√£ de resposta precisava ser aumentado. <br><br>  Depois que um novo dispositivo for adicionado ao aplicativo, voc√™ poder√° avan√ßar para a automa√ß√£o.  Configure o cen√°rio "se a porta estiver aberta por mais de 1 minuto" com um alarme no telefone.  Na localiza√ß√£o em ingl√™s, voc√™ n√£o pode ver a parte da frase cerca de 1 minuto, mas o limite para o acionamento √© esse.  Na variante do sensor Aqara e do aplicativo Aqara Home, voc√™ pode configurar outros intervalos de disparo.  No aplicativo Xiaomi Home, infelizmente, ainda n√£o √© poss√≠vel fazer isso.  Mas a pr√°tica mostrou que o intervalo de 1 minuto √© mais que suficiente - n√£o h√° alarmes falsos, todos os alarmes estavam no caso.  Voc√™ tamb√©m pode ver os logs por sensores.  Este sensor tamb√©m n√£o √© uma exce√ß√£o.  Voc√™ pode, por exemplo, a partir do registro, para determinar quando o banho chegou (primeiro abriu a porta em um determinado dia) e quando saiu (pela √∫ltima vez que fechou a porta), estimando assim o tempo total gasto na sala. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wk/uv/ry/wkuvryxsyoah4u-7dwoj0yct9a4.jpeg" alt="imagem"></div><br><h2>  Impress√µes de uso </h2><br>  A experi√™ncia geral de explora√ß√£o √© puramente positiva.  Obviamente, existem algumas nuances menores, mas o principal objetivo da automa√ß√£o √© alcan√ßado.  Primeiro de tudo, √© a paz de esp√≠rito psicol√≥gica, confirmada pelos resultados dos testes.  Tamb√©m importante e conforto - foi recebido controle remoto da ilumina√ß√£o p√∫blica, exaustor, h√° uma luz noturna adicional.  Tendo sa√≠do de f√©rias, √© poss√≠vel lembrar e remotamente desligar a √°gua. <br><br>  Os custos de todos os dispositivos acima na forma aproximada (sem refer√™ncia a uma loja espec√≠fica) s√£o mostrados abaixo.  Ao fazer o pedido com o AliExpress, os pre√ßos diferem em uma dire√ß√£o menor. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i9/ij/pf/i9ijpffhxd2i-jaq00ieo58eupo.png" alt="imagem"></div><br>  Ao escolher um conjunto de equipamentos, voc√™ deve considerar a compatibilidade (para qual regi√£o o equipamento foi fabricado e a qual fam√≠lia pertence).  N√£o ser√° poss√≠vel criar um cen√°rio no aplicativo que, por exemplo, controle um soquete para uma regi√£o europeia de acordo com um evento de alarme de fuma√ßa (para a regi√£o da China Continental).  Se voc√™ n√£o precisa do tipo de sensor de fuma√ßa ex√≥tico, √© melhor olhar para os dispositivos Aqara no mercado local.  Afinal, o rel√© pode ser substitu√≠do, por exemplo, por um interruptor de duas teclas.  V√°rias lojas que vendem dispositivos Xiaomi parecem import√°-los em cinza (esses dispositivos s√£o para a regi√£o chinesa).  Mas, por exemplo, Svyaznoy, existem dispositivos projetados para o nosso mercado.  Al√©m da compatibilidade dos mesmos soquetes, eles tamb√©m ter√£o instru√ß√µes em ingl√™s e russo.  Abaixo est√£o fotos de dois sensores id√™nticos, mas para diferentes regi√µes: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uw/ph/x_/uwphx_titz3r1-hhwlduqxmzlwg.jpeg" alt="imagem"></div><br>  A capacidade de resposta do controle por meio de um aplicativo nem sempre √© boa.  Por exemplo, √†s vezes voc√™ pode encontrar uma situa√ß√£o em que voc√™ recebe um erro "falha na solicita√ß√£o" em vez de acender a luz uma ap√≥s a outra.  O tratamento detectado experimentalmente - descarregando o aplicativo da mem√≥ria e reiniciando-o - resolve esse problema mais rapidamente do que aguardar uma resposta na pr√≥xima tentativa.  √Äs vezes, tamb√©m h√° atrasos vis√≠veis (de at√© 20 a 30 segundos) com a atualiza√ß√£o do status de um sensor espec√≠fico.  Nesses momentos, √© melhor n√£o pressionar os bot√µes liga / desliga novamente, mas simplesmente aguardar a atualiza√ß√£o do status.  Ao iniciar o aplicativo, em algumas situa√ß√µes, voc√™ pode ver uma lista em branco em vez da lista de dispositivos.  N√£o √© necess√°rio entrar em p√¢nico - ele geralmente aparece nos pr√≥ximos segundos.  Os alertas para o telefone n√£o s√£o localizados e salvam a nomea√ß√£o correta dos pr√≥prios eventos.  Al√©m disso, os autores do aplicativo usam periodicamente o canal de alerta por push para publicidade (novamente em chin√™s).  Claro, n√£o gosto, mas n√£o tenho muita escolha. <br><br>  Espero que este artigo tenha ajudado a ter uma boa id√©ia dos recursos de v√°rios dispositivos Xiaomi para construir uma casa inteligente e cen√°rios para sua aplica√ß√£o pr√°tica.  Se voc√™ ainda tiver alguma d√∫vida, corre√ß√£o ou acr√©scimo, ficarei feliz em discuti-los nos coment√°rios. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt484372/">https://habr.com/ru/post/pt484372/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt484356/index.html">Um projeto interessante em uma equipe amig√°vel ou quanto custa o funcion√°rio certo?</a></li>
<li><a href="../pt484358/index.html">Gerenciamento de portf√≥lio em R</a></li>
<li><a href="../pt484364/index.html">Aos 26 anos, Yana Harlan lidera o desenvolvimento de um motor espacial. No pr√≥ximo ano, eles planejam lan√ß√°-lo.</a></li>
<li><a href="../pt484368/index.html">Como eu fiz um mecanismo de pesquisa para o Telegram</a></li>
<li><a href="../pt484370/index.html">Slurm SRE - aprenda a garantir a felicidade do usu√°rio</a></li>
<li><a href="../pt484374/index.html">Viagem ao centro ... imagem do docker. Ou como baixar uma imagem do registro sem janela de encaixe</a></li>
<li><a href="../pt484376/index.html">Samsung Moscow Center for Artificial Intelligence nas hist√≥rias de funcion√°rios</a></li>
<li><a href="../pt484378/index.html">SwayWM - UnixPorn voc√™ mesmo</a></li>
<li><a href="../pt484382/index.html">Algoritmo de Bellman-Ford</a></li>
<li><a href="../pt484386/index.html">Meetup sobre AWS_Ru em Raiffeisenbank</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>