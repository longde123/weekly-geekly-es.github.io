<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👊🏾 👈🏻 ⭕️ Liveprof将显示何时以及为什么您的PHP应用程序的性能发生了变化 ☝🏼 🤚🏼 ⚗️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha！ 我叫Timur Shagiakhmetov，我是Badoo的PHP开发人员。 

 应用程序性能是程序员工作质量的最重要标准之一。 在优化PHP应用程序方面，助手是探查器。 

 最近，我们讨论了用于剖析的工具。 让我提醒您：当不清楚哪些代码部分影响了响应生成时间的增加时，性能分析工具之一...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Liveprof将显示何时以及为什么您的PHP应用程序的性能发生了变化</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/436364/"><img src="https://habrastorage.org/webt/sm/5p/or/sm5porzvybv5m_8ngvmgicgmeui.jpeg"><br><br> 哈Ha！ 我叫Timur Shagiakhmetov，我是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Badoo</a>的PHP开发人员。 <br><br> 应用程序性能是程序员工作质量的最重要标准之一。 在优化PHP应用程序方面，助手是探查器。 <br><br> 最近，我们<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">讨论</a>了用于剖析的工具。 让我提醒您：当不清楚哪些代码部分影响了响应生成时间的增加时，性能分析工具之一就是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">XHProf</a> 。 这是PHP的扩展，允许您在战斗服务器上分析代码并随后对其进行改进。 <br><br> 但我也想拥有性能变化的历史记录，以便您可以跟踪性能下降的时间和影响，对吗？ 为此，大约一年前，我们开发了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Liveprof</a> ，该工具可通过界面自动分析所有请求，以分析应用程序性能的变化。 <br><br> 我们的工具使您能够分析代码任何部分的性能变化，找到最容易受到影响的地方。 同时，无需专门打开它并等待统计信息累积-它始终处于活动状态并收集所有请求中特定部分的数据。 <br><br> 在本文中，我将讨论使用此工具的实现细节和功能。 <br><a name="habracut"></a><br><h2> 关于XHProf的一些知识 </h2><br> 首先，简单介绍一下XHProf本身的功能。 这是用C编写的PHP扩展程序的探查器。 它是在Facebook上开发的，并已在公共领域发布。 它具有多个fork（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">uprofiler</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Tideways</a> ），在输出数据格式级别上完全兼容。 <br><br>  XHProf设置所有函数/方法调用的计时器。 它的使用涉及一些开销。 但是它们并不是很大，可以在生产中使用它。 <br><br>  XHProf的结果是以下格式的元素数组： <br><br><pre><code class="php hljs">$data = [ <span class="hljs-string"><span class="hljs-string">'parentMethodName==&gt;childMethodName'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'ct'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">'wt'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-string"><span class="hljs-string">'cpu'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-string"><span class="hljs-string">'mu'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">528</span></span> <span class="hljs-string"><span class="hljs-string">'pmu'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ] ];</code> </pre> <br> 在哪里 <br><br>  <code><b>parentMethodName</b></code>和<code><b>childMethodName</b></code>分别是父方法和子方法； <br>  <code><b>ct</b></code>请求上下文中的调用次数； <br>  <code><b>wt</b></code>请求执行时间（包括处理器花费的时间和等待I / O或其他服务的响应的时间）； <br>  <code><b>cpu</b></code>处理器在处理请求上花费的时间； <br>  <code><b>mu</b></code>方法调用后的内存消耗变化； <br>  <code><b>pmu</b></code>方法调用后峰值内存消耗的变化。 <br><br> 其他一些选项也是可能的。 <br><br>  XHProf还包含用于可视化由此获得的结果的工具。 对于每个概要分析操作，我们将获得一个表，其中包含每种方法的一组参数。 <br><br> 举个例子 <br><br><div class="spoiler">  <b class="spoiler_title">气泡排序结果</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArrayGenerator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRandomArray</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(int $count)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">array</span></span></span><span class="hljs-function"> </span></span>{ $array = []; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i &lt; $count; $i++) { $array[] = rand(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1000</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $array; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BubbleSorter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sort</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$array)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ $len = count($array); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i &lt; $len ; $i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($j = <span class="hljs-number"><span class="hljs-number">0</span></span>; $j &lt; $len - $i - <span class="hljs-number"><span class="hljs-number">1</span></span>; $j++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($array[$j] &gt; $array[$j + <span class="hljs-number"><span class="hljs-number">1</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;swap($array[$j], $array[$j + <span class="hljs-number"><span class="hljs-number">1</span></span>]); } } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">swap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$a, &amp;$b)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ $tmp = $a; $a = $b; $b = $tmp; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isSorted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $array)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span><span class="hljs-function"> </span></span>{ $len = count($array); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i &lt; $len - <span class="hljs-number"><span class="hljs-number">1</span></span>; $i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($array[$i] &gt; $array[$i + <span class="hljs-number"><span class="hljs-number">1</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ArrayPrinter</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(array $array, string $delimiter = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">' '</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">void</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> implode($delimiter, $array) . PHP_EOL; } } xhprof_enable(); $n = <span class="hljs-number"><span class="hljs-number">10</span></span>; $arrayGenerator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \ArrayGenerator(); $array = $arrayGenerator-&gt;getRandomArray($n); $sorter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BubbleSorter(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$sorter-&gt;isSorted($array)) { $sorter-&gt;sort($array); } $printer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> \ArrayPrinter(); $printer-&gt;print($array); $xhprof_data = xhprof_disable();</code> </pre><br></div></div><br><img src="https://habrastorage.org/webt/ip/cw/vi/ipcwviocimg7kjon1memwwziho8.png"><br><br> 您可以深入每种方法中，找出哪些方法消耗了多少资源。 <br><br> 您还可以通过突出显示最消耗资源的方法来查看调用图： <br><br><img src="https://habrastorage.org/webt/zq/yw/pl/zqywplc0eibbdxdotsr3f0bed_o.png"><br><br>  XHProf对于手动分析每个请求的性能很有用。 但是，对我们来说，了解全局也很重要。 您需要了解性能如何随时间变化。 为此，开发了一种工具，该工具可以自动模式分析查询并允许您在Web界面中分析查询。 <br><br><h2>  Liveprof：汇总结果并保留历史记录 </h2><br> 如何获取分析历史记录？ <br><br> 首先，您需要配置探查器的自动启动并保存结果。 性能不是恒定不变的，并且在发射之间会有所波动。 为了避免这种波动的影响，我们使用了几个查询的平均数据。 结果，我们获得了每个查询的汇总结果，例如，最小值，最大值，平均值和第95个百分位数。 这有助于查找可能并非为每个请求都调用的困难事物。 <br><br> 我们的工具既有优势，也有一些局限性。 <br><br><h3> 聚合器可以做什么： </h3><br><ol><li> 每N个请求自动进行性能分析。 <br></li><li> 每日汇总收集的配置文件。 <br></li><li> 能够查看由探查器测量的每个参数的变化图。 例如，上述wt，cpu，mu，pmu。 <br></li><li> 在一定时间间隔内查看任何方法的性能变化。 <br></li><li> 基于最新汇总数据的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">火焰图</a> 。 <br></li><li> 查找调用特定方法的查询 <br></li></ol><br><h3> 局限性： </h3><br><ol><li> 由于我们的工具是一个汇总的工具，因此您无法找出一个查询（例如，最慢的查询）的性能-我们将获得最后一天的平均值。 但这足以评估整体性能动态。 如果有任何请求降低了执行速度，则平均值，第95个百分位数和最大执行时间将改变。 <br></li><li> 您无法明确地恢复完整的调用堆栈，因为XHProf仅返回唯一的父子对以及已消耗资源的值之和。 <br></li><li> 请求与XHProf开销有关的运行时错误。 差别不是很大，但是在测量查询执行时间时必须考虑到这一点。 <br></li></ol><br><h3> 如何使用分析器 </h3><br><ol><li> 首先，分析器需要连接到站点或脚本。 使用该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">工具</a>最方便的方法<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">是自动启动事件探查器</a> ： <br><br><pre> <code class="plaintext hljs">php composer.phar require badoo/liveprof # Run a script to configure database LIVE_PROFILER_CONNECTION_URL=mysql://db_user:db_password@db_mysql:3306/Profiler?charset=utf8 php vendor/badoo/liveprof/bin/install.php</code> </pre><br> 它支持从5.4开始的PHP版本，并且使用时开销很小，这使您可以在战斗环境中使用它。 该工具会自动检测使用的探查器扩展名： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">XHProf</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">uprofiler</a>或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Tideways</a> 。 在启动时，您需要指定用于连接数据库和配置文件设置的参数。 <br><br> 具有默认设置的代码中的示例用法： <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> <span class="hljs-string"><span class="hljs-string">'vendor/autoload.php'</span></span>; \Badoo\LiveProfiler\LiveProfiler::getInstance()-&gt;start(); <span class="hljs-comment"><span class="hljs-comment">// Code is here</span></span></code> </pre> <br> 分析结果将保存到数据库中。 每天进行一次汇总过程。 为此，每天选择一个特定请求的所有记录，然后为每个参数计算聚合函数。 聚合功能可以扩展或重新定义。 <br><br> 现在可以使用以下内容： <br><br><ul><li> 至少每天 </li><li> 每天最多； </li><li> 日均 </li><li> 当天的百分之95。 </li></ul><br></li><li> 聚合器<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Web客户端</a>用于配置聚合和查看结果。 将其安装在Docker容器中的最简单方法是： <br><br><pre> <code class="php hljs">git <span class="hljs-keyword"><span class="hljs-keyword">clone</span></span> https:<span class="hljs-comment"><span class="hljs-comment">//github.com/badoo/liveprof-ui.git cd liveprof-ui docker-compose up web</span></span></code> </pre> </li><li> 在第一次启动之前，您需要在src / config / services.yaml配置文件中配置数据库连接参数，字段列表和使用的聚合函数。 然后执行安装脚本： <br><br><pre> <code class="php hljs">docker-compose exec web bash install.sh</code> </pre> </li><li> 必须注册自动运行的汇总和清除表冠中的旧数据的脚本： <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment"># script aggregates all profiles for previous day, add it if you don't use a queue for aggregation jobs (parameter aggregator.use_jobs_in_aggregation=false) 0 2 * * * docker-compose -f %PATH_TO_PROJECT%/docker-compose.yml run --rm --entrypoint '/usr/local/bin/php /app/bin/cli.php cron:aggregate-all-profiles' web # script removes old aggregated data, by default &gt; 200 days 0 1 * * * docker-compose -f %PATH_TO_PROJECT%/docker-compose.yml run --rm --entrypoint '/usr/local/bin/php /app/bin/cli.php cron:remove-old-profiles' web 200</span></span></code> </pre> <br></li><li> 要填充测试数据，可以运行以下脚本： <br><br><pre> <code class="php hljs">docker-compose exec web php /app/bin/cli.php example:a-week-degradation</code> </pre> </li></ol><br><h2> 接口说明 </h2><br>  Web界面位于：127.0.0.1:8000。 <br><br> 默认情况下，将打开一个包含汇总查询列表的页面。 它使查找感兴趣的查询，按任何参数对所有查询进行排序以及重新汇总特定查询以查看最新结果变得容易： <br><br><img src="https://habrastorage.org/webt/qj/-d/6b/qj-d6bj1095huwhvqmzdwim1g6k.png"><br><br> 使用该工具时，最常用的页面是列出方法和性能变化图表的页面。 它使您可以遍历调用堆栈，观察每个参数的使用情况以及特定时间间隔内的性能变化图： <br><br><img src="https://habrastorage.org/webt/-6/ag/u4/-6agu45zuu1qs77tckpkngabjwq.png"><br><br>  <i>包含完整的被调用方法列表的页面使您可以快速找到感兴趣的方法并通过转到图表页面来查看图表：</i> <br><br><img src="https://habrastorage.org/webt/nj/g-/f_/njg-f_48jsuo8mcmlxuq1ukxj_4.png"><br>  <i>上一个汇总查询的带有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">火焰图</a>的页面使您可以直观地识别最重的部分。</i> <br><br> 使用XHProf对结果的准确性施加了一些限制。 这是由于以下事实：分析器没有返回完整的调用树，而是仅返回了父子对。 而且，如果从应用程序的不同位置调用了一对方法，那么结果就是我们得到了花费的时间。 对于火焰图，您需要具有完整的调用树。 还原此类树时，参数值会在考虑父级花费的时间的情况下进行标准化。 <br><br><img src="https://habrastorage.org/webt/vp/lp/xr/vplpxry-gjd-lq774gg3ji9cooo.png"><br>  <i>包含在选定间隔内变慢的方法列表的页面。</i> <br><br> 此外，对于每种方法，您都可以查看哪个子调用对性能的影响最大。 例如，在下面的屏幕截图中，您可以看到<code>ServiceApi::getAvailableServices()</code>方法开始运行慢了116毫秒。 这样做的原因是增加了对<code>ServiceApi::getGifts()</code>的调用（更改了56毫秒），并且对<code>ServiceApi::getConfigForList()</code>方法的调用次数从1增加到了5（另外50ms）： <br><br> <a href=""><img src="https://habrastorage.org/webt/rv/mc/dd/rvmcddru-ay4x9cb45xsvey_tka.png"></a> <br><br> 如果事先不知道哪个查询的性能发生了最明显的变化，那么一个页面，其中列出了一些方法，这些方法在没有引用特定查询的情况下变得越来越慢，这将有所帮助： <br><br><img src="https://habrastorage.org/webt/-6/0b/3s/-60b3svwq_rg9z7wbzmzmpriapc.png"><br>  <i>搜索调用特定方法的查询的页面。</i> <br><br> 它允许您比较不同请求中的执行时间。 查找未使用的代码也很有用： <br><br><img src="https://habrastorage.org/webt/hq/du/lv/hqdulvav1asbj9nczgowuk1mvak.png"><br><br><h3> 定制功能 </h3><br> 该工具具有充足的自定义机会： <br><br><ul><li> 您可以添加自己的聚合函数，这些函数根据传递的参数值数组来计算特定值； <br></li><li> 您可以更改用于存储配置文件和汇总结果的数据库（现在支持SQLite，MySQL和PostgreSQL，但是可以从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Doctrine DBAL</a>可用的列表中使用其他数据库）； <br></li><li> 您可以覆盖数据库连接管理器，并实现获取数据的方法。 <br></li><li> 您可以将Web界面既用作独立项目，也可以在任何框架（例如，站点控制面板）中使用。 一个例子： <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">profileListAction</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{      &lt;i&gt;<span class="hljs-comment"><span class="hljs-comment">//Some custom logic before&lt;/i&gt;   $this-&gt;checkPermissions();   $App = new \Badoo\LiveProfilerUI\LiveProfilerUI();   $Page = $App-&gt;getPage('profile_method_list_page');   return $Page-&gt;setData($data)-&gt;render(); }</span></span></code> </pre> </li></ul><br><h2> 结论 </h2><br> 我希望我们的工具对其他开发人员有用。 无需使用其他计时器，就可以检查代码任何部分的性能更改。 由于现在您可以了解是什么因素影响了应用程序性能随时间下降的原因，这也将有助于优化过程。 <br><br> 它在GitHub上可用： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github.com/badoo/liveprof，Web</a>界面是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github.com/badoo/liveprof-ui</a> 。 <br><br> 该工具正在积极开发中，可能包含一些错误。 希望在社区的参与下，情况会更好。 该计划包括添加对XHProf之外的其他探查器的支持，以及扩展受支持数据库的列表。 <br><br> 向我们发送有关在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">电报中</a>使用，错误和提取请求的反馈和问题-直接发送到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GitHub</a> 。 我们欢迎提出意见和建议！ <br><br> 特别感谢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Gregory</a>的想法和首次实施。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN436364/">https://habr.com/ru/post/zh-CN436364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN436352/index.html">PostgreSQL新闻摘要。 第14期</a></li>
<li><a href="../zh-CN436354/index.html">美军忽视网络安全问题</a></li>
<li><a href="../zh-CN436356/index.html">[从山后有趣]我们如何停止对技术的依赖？</a></li>
<li><a href="../zh-CN436358/index.html">为什么高级开发人员教学生</a></li>
<li><a href="../zh-CN436360/index.html">Gotta Go Fast：在iOS中构建速度。 第一部分</a></li>
<li><a href="../zh-CN436370/index.html">公钥基础设施 X509 v.3根证书链</a></li>
<li><a href="../zh-CN436372/index.html">用于Unity3D的等距插件</a></li>
<li><a href="../zh-CN436374/index.html">UI和UX 2019设计趋势</a></li>
<li><a href="../zh-CN436376/index.html">全地形机器人EZ-Robot Roli Rover概述</a></li>
<li><a href="../zh-CN436378/index.html">bobaos.pub-KNX TP / UART，Raspberry Pi和Redis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>