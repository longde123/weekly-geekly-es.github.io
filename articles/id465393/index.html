<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏿‍✈️ 🏂 🤽🏿 Daya Baterai untuk Perangkat MySensors 🦁 👲🏿 💏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Musik ini akan bertahan selamanya jika saya mengganti baterai (C) 





 Opus ini didedikasikan untuk penelitian saya tentang kekuatan perangkat nirka...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Daya Baterai untuk Perangkat MySensors</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465393/"><p>  <em>Musik ini akan bertahan selamanya jika saya mengganti baterai (C)</em> </p><br><p><img src="https://habrastorage.org/webt/ut/-j/xu/ut-jxulgxugkbo3hrs8ax8metkg.jpeg"></p><br><p>  Opus ini didedikasikan untuk penelitian saya tentang kekuatan perangkat nirkabel otonom yang merupakan bagian dari sistem rumah pintar MySensors. </p><br><h2 id="sperva-byl-litiy">  Pertama ada lithium ... </h2><br><p>  Sebaliknya, baterai lithium-ion dan lithium-polimer. </p><br><p> Untuk waktu yang lama, baterai dari gadget lama ini terakumulasi dalam sebuah kotak.  Saya pikir - ini dia, kekuatan universal untuk semua mikrokontroler berukuran kecil.  Selain itu, tegangan 3.3-4.2V sangat baik untuk AVR, serta untuk semua jenis ESP dan STM.  Untuk keandalan, Anda dapat menempatkan stabilisator LDO dari daya yang diperlukan dan mendapatkan 3,3 stabil untuk MK dan seluruh perangkat. </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/webt/sl/by/e1/slbye1sktidu-9qymebtsw7gwzy.jpeg"></p><br><p>  Tapi ternyata, tidak semuanya baik-baik saja. </p><br><ol><li>  Baterai perlu diisi.  Untuk melakukan ini, Anda perlu membuatnya dapat dilepas, atau menambahkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">modul pengisian daya</a> ke perangkat Anda, yang, pada gilirannya, memberi tambahan biaya, dimensi, dan lubang pengisian daya pada case.  Dan tidak selalu nyaman untuk mengisi daya perangkat, misalnya, sensor cuaca di luar jendela. </li><li>  Baterai lithium (seperti kebanyakan catu daya pada umumnya) tidak cocok untuk digunakan pada suhu rendah.  Pada sensor cuaca yang terpasang pada jendela, di musim dingin, baterai langsung tenggelam dalam cuaca beku. </li><li>  Selama operasi jangka panjang, jika tegangan baterai tidak dipantau tepat waktu, Anda dapat melepaskannya "ke nol", yaitu, di bawah nilai yang diizinkan, yang dijamin dapat membunuhnya.  Jadi, Anda perlu perlindungan terhadap kelebihan muatan. </li><li>  Berbagai ukuran dan kapasitas baterai secara signifikan membatasi pengulangan perangkat dalam penutup yang identik.  Dan cadangan baterai lama dengan cepat berakhir - sebagai akibatnya, perlu untuk membeli di tempat yang baru.  Dan, ternyata, biaya sumber daya seperti itu ternyata sangat sedikit dan menambahkan setidaknya $ 2 untuk biaya masing-masing perangkat (dan memperhitungkan papan pengisian dan banyak lagi).  Terlebih lagi, tidak ada penghematan dari daya isi ulang, karena sebagian besar pengendali otonom mengkonsumsi sangat sedikit energi dan dapat bekerja selama berbulan-bulan tanpa pengisian ulang. </li></ol><br><p>  NiMH dan baterai AA / AAA lainnya bahkan lebih buruk.  Mereka perlu diisi dalam pengisi daya khusus, mereka memiliki "efek memori" dan tegangan awalnya rendah (1,2-1,3V), dan ketika dihubungkan secara seri karena perbedaan dalam resistansi internal, salah satu baterai dapat habis lebih dari yang lain, yang lagi-lagi menyebabkan pembusukan. </p><br><h2 id="i-vnov-litiy-">  Dan lagi, lithium ... </h2><br><p>  Sekarang ada baterai lithium 3.0V bulat berukuran kecil, yang saya memutuskan untuk meninggalkan baterai yang berubah-ubah dan mahal. </p><br><p>  Baterai CR2032 digunakan di sejumlah besar komputer BIOS, meter listrik, dan perangkat lain dengan RTC, jam tangan, kalkulator, dan berbagai mainan.  Dengan dimensi kecil dan harga murah, mereka memiliki tegangan 3.0V, yang cukup memadai untuk MK dan kapasitas yang layak 200-250mA / jam untuk dimensi mereka. </p><br><p><img src="https://habrastorage.org/webt/-x/4l/rx/-x4lrx1wg7c5gxmliml_lufiuyi.jpeg"></p><br><p>  Tapi sekali lagi, masalah.  Faktanya.  bahwa arus searah baterai tersebut hanya 0,4mA.  Jika Anda memuatnya dengan arus yang lebih tinggi, tegangan baterai akan turun, meskipun kemudian sebagian atau sepenuhnya pulih.  Mode tidur khas Mysensor mengkonsumsi beberapa microamp.  Tetapi dalam mode transfer - sudah sekitar 15-20mA.  Pada saat yang sama, versi baru dari pustaka MySensors memaksa perangkat untuk mengirim banyak paket - ping, salam, presentasi, mencari gateway atau router, yang menghasilkan pengoperasian modul radio yang panjang, kadang-kadang beberapa detik.  Pada tegangan sekitar 2V, NRF24L01 Cina murah mulai gagal, dan kadang-kadang bahkan tidak mungkin untuk membuatnya menjadi mode sleep () sleep dari MySensors. </p><br><p>  Hasilnya, semuanya berfungsi dengan baik pada baterai baru, tetapi saat baterai habis, masalah komunikasi meningkat, modul radio mulai membanjiri lebih banyak di udara, meningkatkan pelepasan baterai.  Pada akhirnya, tegangan turun ke titik di mana seluruh perangkat berhenti tidur, dan kemudian reboot siklus terjadi hingga baterai benar-benar habis. </p><br><p>  Tergantung pada pabrikan dan "kesegaran" baterai, perangkat dapat bekerja dari beberapa hari hingga sebulan.  Jika Anda membeli baterai murah di aliexpress, maka ada lotre.  Transisi ke CR2450 dan CR2477 yang lebih luas menghemat sedikit, tetapi mereka tidak tahu bagaimana memberi arus lebih dari 0,5mA untuk waktu yang lama. </p><br><p>  Untuk sementara saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bereksperimen dengan boost converter</a> , yang memungkinkan baterai mempertahankan tegangan operasi normal untuk MK hingga remah-remah energi terakhir, tetapi mereka memiliki arus diam yang kecil, tetapi tidak nol, yang mengurangi masa pakai keseluruhan. </p><br><h2 id="palchiki---mizinchiki">  Jari kelingking - jari kelingking </h2><br><p><img src="https://habrastorage.org/webt/ym/3r/sp/ym3rsphakzuewavswscm7ot7vvi.jpeg"></p><br><p>  Saatnya untuk tenang dan mengadopsi pengalaman China "maju", untuk memberi daya pada semua perangkat Anda dari tiga AAA (baterai tidak termasuk).  Namun dia memutuskan untuk mencari solusi dengan setidaknya dua baterai 1,5 volt. </p><br><p>  Saya berhenti pada skema seperti itu dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">stabilisator NCP1400 yang meningkat</a> : </p><br><p><img src="https://habrastorage.org/webt/zy/bv/ii/zybviid6dds-ng2kwivuenh9gli.jpeg"></p><br><p>  Dua baterai AAA alkaline yang terhubung seri pada awalnya memberikan 2.7-3.1V pada akhir periode produksi, mengurangi tegangan menjadi 1-2V </p><br><p>  Ketika NCP1400 mati (level rendah pada input kontrol), daya baterai segera pergi ke MC melalui kumparan L1 dan Schottky diode D1 dengan penurunan tegangan minimum sekitar 0,1V.  Jika level tinggi diterapkan pada input kontrol, maka penstabil NCP1400 akan dimulai dan memberikan tegangan 3,3V ke MK dengan total tegangan baterai 0,8V hingga 3,1V. </p><br><h4 id="algoritm-raboty-takoy">  Algoritma operasi adalah sebagai berikut: </h4><br><ol><li>  Waktu utama controller berada di PowerDownMode, semua periferal, termasuk NRF24, dinonaktifkan atau juga dalam mode daya rendah. </li><li>  MC meninggalkan mode tidur dengan gangguan dari penghitung waktu atau oleh gangguan eksternal (misalnya, di sakelar dengan gangguan dari tombol), tegangan suplai VCC (fungsi bawaan pengontrol AVR) diukur. </li><li>  Jika tegangan suplai lebih besar dari 3V (atau tegangan lainnya cukup untuk operasi periferal yang stabil), maka NCP1400 tidak memulai dan semua pemrosesan dilakukan pada tegangan suplai ini sampai siklus tidur berikutnya. </li><li>  Jika tegangan lebih rendah dari 3V, stabilizer NCP1400 dinyalakan, tegangan suplai diatur ke 3.3V, semua pemrosesan rutin perangkat dilakukan, termasuk mengirim data melalui NRF24 </li><li>  Selanjutnya, jika tegangan di atas 1,7V (tegangan yang cukup untuk keluar dari mode tidur MC), NCP1400 dimatikan sampai siklus bangun berikutnya. </li><li>  Jika tegangannya kurang dari 1,7 (tegangan minimum MK), maka NCP1400 tidak mati sampai pengontrol reboot atau sampai tegangan suplai turun di bawah 0.8V (voltase NCP1400) </li></ol><br><div class="spoiler">  <b class="spoiler_title">Sketsa algoritma ini</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MY_RF24_CE_PIN 9 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MY_RF24_CS_PIN 10 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MY_RF24_POWER_PIN 8 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> MY_RADIO_NRF24 #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;MySensors.h&gt; #define PIN_NCP1400 2 #define CHILD_ID_VCC 0 MyMessage msgVcc(CHILD_ID_VCC, V_VOLTAGE); bool low_power = false; int readVcc(); // void before(){ pinMode(PIN_NCP1400,OUTPUT); digitalWrite(PIN_NCP1400,HIGH); } void presentation(){ sendSketchInfo("NCP1400 test", "1.0"); present(CHILD_ID_VCC, S_MULTIMETER,"mV"); } // void loop(){ int vcc = 1000; if( low_power == false ){ vcc = readVcc(); digitalWrite(PIN_NCP1400,HIGH); //  NRF1400 } if( vcc &lt; 1700 )low_power = true; //      NRF1400 send(msgVcc.set(vcc)); //  VCC if( low_power == false )digitalWrite(PIN_NCP1400,LOW); //  NRF1400 sleep( 300000 ); //      5  } /** *     VCC  */ int readVcc() { long result; // Read 1.1V reference against AVcc ADMUX = _BV(REFS0) | _BV(MUX3) | _BV(MUX2) | _BV(MUX1); delay(2); // Wait for Vref to settle ADCSRA |= _BV(ADSC); // Convert while (bit_is_set(ADCSRA,ADSC)); result = ADCL; result |= ADCH&lt;&lt;8; result = (1100L * 1023)/result; return((int)result); }</span></span></span></span></code> </pre> </div></div><br><h2 id="testirovanie">  Pengujian </h2><br><p>  Dan bagaimana kita menangani konsumsi saat ini dalam praktek?  Saya menghubungkan sirkuit saya ke LBP dan melakukan pengukuran konsumsi arus dan tegangan output. </p><br><p><img src="https://habrastorage.org/webt/ti/ss/_z/tiss_zsvv77ac2gpbmcmkigrwge.jpeg"></p><br><p>  Pemalasan arus dengan NCP1400 dimatikan dan tegangan input 1-3 V adalah 0,3 μA.  Bahkan lebih rendah dari yang dinyatakan oleh datasheet 0.5mkA (atau mungkin pada kisaran ini perangkat saya memberikan kesalahan besar).  Tetapi dengan stabilizer dinyalakan tanpa beban, arus berubah menjadi besar secara tak terduga - lebih dari 0,3 mA.  Ternyata pull-up resistor R1 menyebabkan konsumsi besar.  Mengganti peringkat R1 dari 10K ke 150K, saya mendapat 30 μA pada tegangan input 3.0 V dan 44 μA pada 1.0 V. </p><br><p>  Jika Anda benar-benar menghapus resistor R1, maka stabilizer jika tidak menghubungkan input ini ke MC akan terus mengkonsumsi dengan 2V yang masuk sekitar 11 μA. <br>  Sekarang saya menghubungkan mikrokontroler dengan NRF24L01 dan sensor HUD21, bekerja sesuai dengan algoritma yang dijelaskan di atas: </p><br><ul><li>  Tegangan input 3.0V - mode aktif (NCP1400 aktif) 32mA, mode tidur (NCP1400 mati) 9mkA </li><li>  Tegangan input 2.0V - mode aktif (NCP1400 aktif) 51mA, mode tidur (NCP1400 mati) 6mA </li><li>  Tegangan input 1,7V - mode aktif (NCP1400 aktif) 63mA, mode tidur (NCP1400 mati) 5.6mA </li><li>  Tegangan input 1.0V - NCP1400 terus menyala - mode tidur 197mkA </li><li>  Tegangan input 0,5V - NCP1400 terus menyala - 397μA mode tidur </li></ul><br><p>  Konsumsi baterai aktif meningkat ketika daya berkurang.  Tegangan 1,7V dipilih secara eksperimental.  Di bawah nilai ini, mikrokontroler mungkin sudah tidak bekerja secara stabil.  Ketika tegangan baterai turun di bawah ambang batas ini, stabilizer NCP1400 tidak lagi mati dan konsumsi dalam mode tidur cukup tinggi.  Dalam mode ini, baterai tidak akan bertahan lama, tetapi akan ada cukup waktu untuk menggantinya. </p><br><h2 id="voploschenie-v-zheleze">  Perwujudan di kelenjar </h2><br><p>  Dirancang papan daya universal untuk perangkat rumah pintar saya </p><br><p><img src="https://habrastorage.org/webt/q5/gv/io/q5gviogxu9mb_biahhyvvdv0bpo.jpeg"></p><br><p><img src="https://habrastorage.org/webt/eg/da/sc/egdasc6nwhiv_frbsr_glatlqsy.jpeg"></p><br><p>  Dan meskipun perangkat yang dibuat tidak sekompak baterai lithium, hasilnya cukup baik bagi saya.  terutama mengingat biaya baterai alkaline di toko-toko Galomart, Kastorama, Leroyle, dll. </p><br><p><img src="https://habrastorage.org/webt/zp/vw/sm/zpvwsmw1ocdc7plhi0pupkqhmww.jpeg"></p><br><p>  Saat ini, saya beroperasi di rumah lebih dari selusin perangkat berbeda untuk memantau suhu, kelembaban tanah, dll. Dalam sistem MuSensors / MajorDoMo. </p><br><p>  Baca lebih lanjut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di blog saya</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id465393/">https://habr.com/ru/post/id465393/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id465373/index.html">Bukan review dari ASUS ZenBook Pro 15 UX580GE - hampir setahun dengan hampir teratas</a></li>
<li><a href="../id465375/index.html">Penjualan server khusus di Belanda dan Moskow</a></li>
<li><a href="../id465377/index.html">Lakukan sendiri Skype</a></li>
<li><a href="../id465379/index.html">Kontrol pompa insulin nirkabel yang berdiri sendiri di rumah</a></li>
<li><a href="../id465391/index.html">Mengikuti jejak gerakan Scala Rusia. Bagian 1</a></li>
<li><a href="../id465395/index.html">Apa perbedaan utama antara Dependency Injection dan Service Locator?</a></li>
<li><a href="../id465397/index.html">Bagaimana penerjemah Nitro muncul, yang membantu pengembang dalam pelokalan dan dukungan teknis</a></li>
<li><a href="../id465399/index.html">Menyebarkan penyimpanan yang didistribusikan oleh CEPH dan menghubungkannya ke Kubernetes</a></li>
<li><a href="../id465401/index.html">5 Kegiatan untuk Mempercepat Pemecahan Masalah di Tim TI Apa Pun</a></li>
<li><a href="../id465403/index.html">Achtung! Kamera baru di jalan atau informasi terbaru tentang radar dan detektor radar</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>