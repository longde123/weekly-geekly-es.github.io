<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçüç≥ üò® üöç El cifrado de clave predeterminado de OpenSSH es peor que ninguno üéûÔ∏è ‚õ≤Ô∏è ü§õüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los autores de este art√≠culo argumentan en contra de los mecanismos est√°ndar de cifrado de claves en OpenSSH. 


 Los atacantes utilizaron recientemen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>El cifrado de clave predeterminado de OpenSSH es peor que ninguno</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/wirex/blog/419829/">  <i>Los autores de este art√≠culo argumentan en contra de los mecanismos est√°ndar de cifrado de claves en OpenSSH.</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6k/km/om/6kkmom9aovguj47f3092gm95xlw.jpeg"></div><br>  Los atacantes utilizaron recientemente el paquete npm eslint-scope para robar tokens npm de los directorios de inicio de los usuarios.  A la luz de este evento, comenzamos a verificar otras vulnerabilidades similares y pensamos en c√≥mo reducir los riesgos y las consecuencias de tales incidentes. <br><br>  La mayor√≠a de nosotros tenemos a mano una clave RSA SSH.  Esta clave le da al propietario una variedad de privilegios: como regla, se usa para acceder al entorno de producci√≥n o en GitHub.  A diferencia de los tokens nmp, las claves SSH est√°n encriptadas y, por lo tanto, generalmente se acepta que no suceder√° nada malo, incluso si caen en las manos equivocadas.  ¬øPero es realmente as√≠?  Averig√ºemos <a name="habracut"></a><br><br><blockquote><code>user@work /tmp $ ssh-keygen <br> Generating public/private rsa key pair. <br> Enter file in which to save the key (/home/user/.ssh/id_rsa): mykey <br> ... <br> user@work /tmp $ head -n 5 mykey <br> -----BEGIN RSA PRIVATE KEY----- <br> Proc-Type: 4,ENCRYPTED <br> DEK-Info: AES-128-CBC,CB973D5520E952B8D5A6B86716C6223F <br> <br> +5ZVNE65kl8kwZ808e4+Y7Pr8IFstgoArpZJ/bkOs7rB9eAfYrx2CLBqLATk1RT/</code> </blockquote> <br>  Esta clave est√° encriptada, como lo indica una de las primeras l√≠neas del archivo.  Adem√°s, al principio no hay una clave de codificaci√≥n MII - base64 utilizada en RSA.  Y, por supuesto, ¬°AES te llama la atenci√≥n!  Est√° bien, ¬øverdad?  Y CBC, a primera vista, con un vector de inicializaci√≥n aleatorio.  No hay c√≥digo de autenticaci√≥n (MAC).  Bueno, entonces, no habr√° ataque de or√°culo de relleno, ¬øverdad? <br><br>  Descubrir lo que realmente significa el contenido de DEK-Info no es tan simple.  Una b√∫squeda de la palabra clave "DEK-Info" en el repositorio de openssh-portable muestra solo ejemplos de claves.  Pero el punto aqu√≠ es que la clave AES no es m√°s que un simple hash MD5 (contrase√±a || vector de inicializaci√≥n [: 8]).  Y esto es malo, porque las mejores pr√°cticas para almacenar contrase√±as dicen que las contrase√±as en su forma pura, debido a su baja entrop√≠a, son material de cifrado incorrecto.  Y para hacerlo mejor, necesita una funci√≥n costosa como Argon2.  Pero MD5, a diferencia de este √∫ltimo, es f√°cil de calcular. <br><br>  El √∫nico punto positivo en este esquema es que la sal se coloca despu√©s de la contrase√±a, por lo tanto, no funcionar√° para calcular el estado intermedio MD5 (IV [8:]) y encontrar las contrase√±as basadas en √©l.  Pero esto es un peque√±o consuelo, especialmente en una era en la que las m√°quinas que hacen miles de millones de llamadas MD5 por segundo est√°n disponibles para nosotros, m√°s de lo que las contrase√±as pueden generar. <br><br>  Quiz√°s se pregunte c√≥mo vivi√≥ OpenSSH para ver esto.  Lamentablemente, la respuesta es simple: la herramienta de l√≠nea de comandos OpenSSL inicialmente us√≥ este esquema por defecto, y simplemente se convirti√≥ en la norma. <br><br>  Al final, se hace realidad que las claves cifradas con contrase√±a est√°ndar no son mejores que las claves no cifradas normales simplemente porque el mecanismo de cifrado no es efectivo.  Sin embargo, hablar√≠amos a√∫n m√°s audaces: son peores.  Y es f√°cil discutir. <br><br>  Es poco probable que muchas personas usen un administrador de contrase√±as para almacenar la contrase√±a de la clave SSH.  M√°s bien, el usuario simplemente lo recordar√°.  Y, dado que esta es una de las combinaciones memorizadas, es probable que el usuario ya la haya usado en otro lugar.  Quiz√°s incluso coincida con la contrase√±a de usuario del dispositivo.  Es bastante posible adivinarlo (su funci√≥n formativa es demasiado poco confiable), y si se conoce la contrase√±a, probablemente pueda verificarla con la clave p√∫blica. <br><br>  No hay quejas sobre el par de claves RSA: la √∫nica pregunta es los m√©todos de cifrado sim√©trico de la clave privada.  Es imposible llevar a cabo el ataque descrito anteriormente, conociendo solo la clave p√∫blica. <br><br><h3>  ¬øC√≥mo puedo arreglar la situaci√≥n? </h3><br>  OpenSSH proporciona un nuevo formato de clave para usar.  Por nuevo se entiende introducido en 2013.  Este formato utiliza bcrypt_pbkdf, que es esencialmente un bcrypt de complejidad fija implementado bajo el est√°ndar PBKDF2. <br><br>  Convenientemente, usted recibe autom√°ticamente una clave en un nuevo formato cuando genera claves Ed25519, porque el antiguo formato de clave SSH no admite nuevos tipos de claves.  Esto es bastante extra√±o, porque en realidad no necesitamos el formato de clave para determinar c√≥mo funciona la serializaci√≥n Ed25519, ya que el propio Ed25519 establece el trabajo de serializaci√≥n.  Pero si realmente necesita una buena funci√≥n formativa, entonces no puede molestarse con tales peque√±eces.  Como resultado, una de las respuestas es <i>ssh-keygen -t ed25519</i> . <br><br>  Si, por razones de compatibilidad, debe cumplir con RSA, puede usar ssh-keygen -o.  Por lo tanto, se puede obtener un nuevo formato incluso para los viejos tipos de claves.  Puede actualizar las claves antiguas con el comando <i>ssh-keygen -p -o -f key name</i> .  Si sus claves viven en Yubikey o tarjetas inteligentes, entonces estas enmiendas ya se han tenido en cuenta. <br><br>  De una forma u otra, nos esforzamos por una salida m√°s √≥ptima.  Por un lado, hay un buen ejemplo de aws-vault, en el que la informaci√≥n de credenciales se movi√≥ del disco a los llaveros.  Hay otro enfoque: mover el desarrollo a entornos compartidos.  Finalmente, la mayor√≠a de las nuevas empresas deber√≠an considerar abandonar el almacenamiento a largo plazo de claves SSH y mudarse a un centro de certificaci√≥n SSH con un tiempo de almacenamiento de claves limitado junto con un sistema de inicio de sesi√≥n √∫nico.  Desafortunadamente, en el caso de GitHub, este enfoque no es posible. <br><br>  <b>PD:</b> Es dif√≠cil verificar esta informaci√≥n en una fuente autorizada, pero si la memoria nos sirve bien, el par√°metro versionado en las claves privadas del formato OpenSSH PEM solo afecta el m√©todo de cifrado.  Sin embargo, esto no juega ning√∫n papel: el problema es la funci√≥n de formaci√≥n de claves, y creemos que este es otro argumento en contra de discutir los protocolos en partes.  Habr√° una publicaci√≥n separada sobre este tema en nuestro blog. <br><br>  Y finalmente, un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace</a> a la clave completa.  Esto es en caso de que est√© configurado para hackear algo hoy. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/files/4bd/bf6/597/4bdbf659775744b1bdbb4d8a00a0a980.png" alt="imagen"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es419829/">https://habr.com/ru/post/es419829/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es419815/index.html">Secretos de tolerancia a fallas de nuestra oficina principal</a></li>
<li><a href="../es419817/index.html">Lanzamiento del cl√∫ster RabbitMQ en Kubernetes</a></li>
<li><a href="../es419819/index.html">Biomarcadores del envejecimiento. Fragilidad de panel. Parte 2</a></li>
<li><a href="../es419823/index.html">D√∫o inusual: frases de contrase√±a e im√°genes mnemot√©cnicas</a></li>
<li><a href="../es419825/index.html">Probar el rendimiento de varios tipos de unidades en un entorno virtual</a></li>
<li><a href="../es419831/index.html">C√≥mo funciona JS: elementos personalizados</a></li>
<li><a href="../es419833/index.html">Trabajo remoto, como funciona</a></li>
<li><a href="../es419835/index.html">C√≥mo motivar a los autores, negociar con expertos y, en general, escribir buenos art√≠culos.</a></li>
<li><a href="../es419837/index.html">Yo, RoboLoyer, o c√≥mo buscar anomal√≠as en los documentos.</a></li>
<li><a href="../es419839/index.html">Hack de cajeros autom√°ticos de bajo nivel NCR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>