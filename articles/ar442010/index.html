<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ฝ ๐ฉ๐พโ๐คโ๐จ๐ฟ ๐ค ุจูุซูู ู FPGA. ุชุฌุฑูุจ ๐ฟ๏ธ ๐ฝ ๐ฉ๐ฟโ๐ณ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุชุงุจุนุฉู ููููุงู ุงูุฃูู ุ ุฃุฑูุฏ ุฃู ุฃูุถุญ ุนูู ุณุจูู ุงููุซุงู ุฎูุงุฑูุง ููุนูู ูุน FPGA (FPGA) ูู ุจูุซูู. ุณูู ุชุบุทู ูุฐู ุงูููุงูุฉ ุฌุงูุจ ุงูุงุฎุชุจุงุฑ ุจูุฒูุฏ ูู ุงูุชูุงุตูู. ุฅุฐุง ูุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุจูุซูู ู FPGA. ุชุฌุฑูุจ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/442010/" style=";text-align:right;direction:rtl">  ูุชุงุจุนุฉู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููุงู ุงูุฃูู</a> ุ ุฃุฑูุฏ ุฃู ุฃูุถุญ ุนูู ุณุจูู ุงููุซุงู ุฎูุงุฑูุง ููุนูู ูุน FPGA (FPGA) ูู ุจูุซูู.  ุณูู ุชุบุทู ูุฐู ุงูููุงูุฉ ุฌุงูุจ ุงูุงุฎุชุจุงุฑ ุจูุฒูุฏ ูู ุงูุชูุงุตูู.  ุฅุฐุง ูุงู ุฅุทุงุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MyHDL</a> ูุณูุญ ููุฃุดุฎุงุต ุงูุฐูู ูุนูููู ุนูู ุจูุซูู ุ ูุณุชุฎุฏููู ุจูุงุก ุงูุฌููุฉ ูุงููุธุงู ุงูุฅูููููุฌููู ุงููุฃููููู ุ ุจุงููุธุฑ ุฅูู ุนุงูู FPGA ุ ูุฅู ูุทูุฑู FPGA ุฐูู ุงูุฎุจุฑุฉ ูุง ูููููู ูุนูู ุงุณุชุฎุฏุงู ุงูุซุนุจุงู.  ุชุชุดุงุจู ููุงุฐุฌ ูุตู ุงูุฃุฌูุฒุฉ ุงูุฎุงุตุฉ ุจู MyHDL ู Verilog ุ ููุนุฏ ุงุฎุชูุงุฑ ูุบุฉ ูุนููุฉ ุฃูุฑูุง ูุนุชุงุฏูุง ูุงูุฐูู.  ูุฑูุฒ Verilog / VHDL ุฅูู ุญูููุฉ ุฃู ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ุชูุช ูุชุงุจุชูุง ุจูุฐู ุงููุบุงุช ููุชุฑุฉ ุทูููุฉ ุ ููู ูู ุงููุงูุน ููุงุณูุฉ ููุตู ุงููุนุฏุงุช ุงูุฑูููุฉ.  ุจูุซูู ุ ููุจุชุฏุฆ ูู ูุฐุง ุงููุฌุงู ุ ูููู ุฃู ุชุชูุงูุณ ูู ูุชุงุจุฉ ุจูุฆุงุช ุงูุงุฎุชุจุงุฑ.  ููุถู ุฌุฒุก ูุจูุฑ ูู ููุช ูุทูุฑ FPGA ูู ุงุฎุชุจุงุฑ ุชุตุงูููู.  ุจุนุฏ ุฐูู ุ ุฃุฑูุฏ ุฃู ุฃูุถุญ ูุน ูุซุงู ููู ูุชู ุฐูู ูู ุจูุซูู ูุน MyHDL. <br><br>  ุงูุชุฑุถ ุฃู ููุงู ูููุฉ ููุตู ุฌูุงุฒ ูุนูู ูุน ุงูุฐุงูุฑุฉ ุนูู FPGA.  ูู ุฃุฌู ุงูุจุณุงุทุฉ ุ ุณุขุฎุฐ ุงูุฐุงูุฑุฉ ุงูุชู ุชุชุตู ุจุงูุฃุฌูุฒุฉ ุงูุฃุฎุฑู ูู ุฎูุงู ูุงุฌูุฉ ูุชูุงุฒูุฉ (ูููุณ ูู ุฎูุงู ูุงุฌูุฉ ุชุณูุณููุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ I2C).  ูุซู ูุฐู ุงูุฏูุงุฆุฑ ุงูุตุบูุฑุฉ ููุณุช ุนูููุฉ ุฏุงุฆููุง ูุธุฑูุง ูุญูููุฉ ุฃู ุงูุนุฏูุฏ ูู ุงููุณุงููุฑ ูุทููุจุฉ ููุนูู ูุนูุง ุ ููู ูุงุญูุฉ ุฃุฎุฑู ุ ูุชู ุชูููุฑ ุชุจุงุฏู ุฃุณุฑุน ูุฃุณูู ูููุนูููุงุช.  ุนูู ุณุจูู ุงููุซุงู ุ 1645RU1U ุงููุญููุฉ ููุธุงุฆุฑูุง. <br><br><img src="https://habrastorage.org/webt/e6/hh/ls/e6hhlsa3yvrcdjdzke3dc_jaxby.png"><br><a name="habracut"></a><br><h1 style=";text-align:right;direction:rtl">  ูุตู ุงููุญุฏุฉ </h1><br>  ูุจุฏู ุงูุณุฌู ููุง ููู: FPGA ูุนุทู ุนููุงู ุฎููุฉ 16 ุจุช ุ ุจูุงูุงุช 8 ุจุช ุ ูููุฏ ุฅุดุงุฑุฉ ูุชุงุจุฉ WE (ุชูููู ุงููุชุงุจุฉ).  ููุฐ ุชูููู OE (ุชูููู ุงูุฅุฎุฑุงุฌ) ู CE (ุชูููู ุงูุดุฑูุญุฉ) ุฏุงุฆููุง ุ ุชุญุฏุซ ุงููุฑุงุกุฉ ุนูุฏ ุชุบููุฑ ุนููุงู ุงูุฎููุฉ.  ูููู ุงูููุงู ุจุงููุชุงุจุฉ ูุงููุฑุงุกุฉ ุจุงูุชุชุงุจุน ูู ุนุฏุฉ ุฎูุงูุง ูุชุชุงููุฉ ุ ุจุฏุกูุง ูู ุนููุงู adr_start ูุญุฏุฏ ุ ูุชู ุชุณุฌููู ุนูู ุงูุญุงูุฉ ุงูุฃูุงููุฉ ูุฅุดุงุฑุฉ adr_write ุ ูุฎููุฉ ูุงุญุฏุฉ ูู ุนููุงู ุชุนุณูู (ูุตูู ุนุดูุงุฆู). <br><br>  ูู MyHDL ุ ูุจุฏู ุงูููุฏ ููุฐุง (ุชุฃุชู ุฅุดุงุฑุงุช ุงููุชุงุจุฉ ูุงููุฑุงุกุฉ ูู ุงูููุทู ุงูุนูุณู): <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> myhdl <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * @block <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ram_driver</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data_in, data_out, adr, adr_start, adr_write, data_memory, read, write, we)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#     mem_z = data_memory.driver() #      @always(adr_write.posedge, write.posedge, read.negedge) def write_start_adr(): if adr_write: #    adr.next = adr_start else: #    / adr.next = adr + 1 @always(write) def write_data(): if not write: mem_z.next = data_in we.next = 0 #    ,    else: mem_z.next = None #        data_out.next = data_memory we.next = 1 return write_data, write_start_adr</span></span></code> </pre> <br>  ุฅุฐุง ุชู ุชุญููููุง ุฅูู Verilog ุจุงุณุชุฎุฏุงู ุงููุธููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convert</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(hdl)</span></span></span><span class="hljs-function">:</span></span> data_memory = TristateSignal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">8</span></span>:]) data_in = Signal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">8</span></span>:]) data_out = Signal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">8</span></span>:]) adr = Signal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">16</span></span>:]) adr_start = Signal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">16</span></span>:]) adr_write = Signal(bool(<span class="hljs-number"><span class="hljs-number">0</span></span>)) read, write, we = [Signal(bool(<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">3</span></span>)] inst = ram_driver(data_in, data_out, adr, adr_start, adr_write, data_memory, read, write, we) inst.convert(hdl=hdl) convert(hdl=<span class="hljs-string"><span class="hljs-string">'Verilog'</span></span>)</code> </pre> <br>  ุซู ูุญุตู ุนูู ูุง ููู: <br><pre style=";text-align:right;direction:rtl"> <code class="vhdl hljs">`timescale <span class="hljs-number"><span class="hljs-number">1</span></span>ns/<span class="hljs-number"><span class="hljs-number">10</span></span>ps module ram_driver ( data_in, data_out, adr, adr_start, adr_write, data_memory, read, write, we ); input [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] data_in; output [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] data_out; reg [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] data_out; output [<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] adr; reg [<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] adr; input [<span class="hljs-number"><span class="hljs-number">15</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] adr_start; input adr_write; <span class="hljs-keyword"><span class="hljs-keyword">inout</span></span> [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] data_memory; wire [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] data_memory; input read; input write; output we; reg we; reg [<span class="hljs-number"><span class="hljs-number">7</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] mem_z; assign data_memory = mem_z; always @(write) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>: RAM_DRIVER_WRITE_DATA <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((!write)) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> mem_z &lt;= data_in; we &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> mem_z &lt;= <span class="hljs-symbol"><span class="hljs-symbol">'bz</span></span>; data_out &lt;= data_memory; we &lt;= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> always @(posedge adr_write, posedge write, negedge read) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span>: RAM_DRIVER_WRITE_START_ADR <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (adr_write) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> adr &lt;= adr_start; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> adr &lt;= (adr + <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> endmodule</code> </pre> <br>  ููุณ ูู ุงูุถุฑูุฑู ุชุญููู ูุดุฑูุน ุฅูู Verilog ูููุญุงูุงุฉ ุ ูุณุชููู ูุฐู ุงูุฎุทูุฉ ูุทููุจุฉ ูููุงุด FPGA. <br><br><h1 style=";text-align:right;direction:rtl">  ุงูููุฐุฌุฉ </h1><br>  ุจุนุฏ ูุตู ุงูููุทู ุ ูุฌุจ ุงูุชุญูู ูู ุงููุดุฑูุน.  ููููู ุชูููุฏ ููุณู ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุญุงูุงุฉ ุชุฃุซูุฑุงุช ุงููุฏุฎูุงุช ูุฑุคูุฉ ุงุณุชุฌุงุจุฉ ุงููุญุฏุฉ ูู ูุฎุทุท ุงูููุช.  ูููู ูุน ูุฐุง ุงูุฎูุงุฑ ุ ูููู ูู ุงูุตุนุจ ุงูุชูุจุค ุจุชูุงุนู ุงููุญุฏุฉ ุงูููุทูุฉ ุงูุฎุงุตุฉ ุจู ูุน ุดุฑูุญุฉ ุฐุงูุฑุฉ.  ูุฐูู ุ ููุชุญูู ุงููุงูู ูู ุชุดุบูู ุงูุฌูุงุฒ ุงูุฐู ุชู ุฅูุดุงุคู ุ ุชุญุชุงุฌ ุฅูู ุฅูุดุงุก ูููุฐุฌ ุฐุงูุฑุฉ ูุงุฎุชุจุงุฑ ุงูุชูุงุนู ุจูู ูุฐูู ุงูุฌูุงุฒูู. <br><br>  ูุธุฑูุง ูุฃู ุงูุนูู ูุชู ูู python ุ ูุฅู ุงููุงููุณ ุงููุนูู (ุงููุงููุณ) ูุดูุฑ ุฅูู ููุณู ูุทุฑุงุฒ ุงูุฐุงูุฑุฉ.  ุงูุจูุงูุงุช ุงูุชู ูุชู ุชุฎุฒูููุง ุนูู ุฃููุง {key: value} ุ ููู ูุฐู ุงูุญุงูุฉ {address: data}. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">memory = { <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-number"><span class="hljs-number">456</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-number"><span class="hljs-number">789</span></span> } memory[<span class="hljs-number"><span class="hljs-number">0</span></span>] &gt;&gt; <span class="hljs-number"><span class="hljs-number">123</span></span> memory[<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt;&gt; <span class="hljs-number"><span class="hljs-number">456</span></span></code> </pre> <br>  ููุบุฑุถ ููุณู ุ ูููู ููุน ุจูุงูุงุช ุงููุงุฆูุฉ ููุงุณุจูุง ุ ุญูุซ ูููู ููู ุนูุตุฑ ุฅุญุฏุงุซูุงุชู โโุงูุฎุงุตุฉ ุงูุชู ุชุดูุฑ ุฅูู ูููุน ุงูุนูุตุฑ ูู ุงููุงุฆูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">memory = [<span class="hljs-number"><span class="hljs-number">123</span></span>, <span class="hljs-number"><span class="hljs-number">456</span></span>, <span class="hljs-number"><span class="hljs-number">789</span></span>] memory[<span class="hljs-number"><span class="hljs-number">0</span></span>] &gt;&gt; <span class="hljs-number"><span class="hljs-number">123</span></span> memory[<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt;&gt; <span class="hljs-number"><span class="hljs-number">456</span></span></code> </pre> <br>  ูุจุฏู ุฃู ุงุณุชุฎุฏุงู ุงูููุงููุณ ููุญุงูุงุฉ ุงูุฐุงูุฑุฉ ูู ุงูุฃูุถู ุจุงููุธุฑ ุฅูู ุฒูุงุฏุฉ ูุถูุญ ุงูุฑุคูุฉ. <br><br>  ูุจุฏุฃ ูุตู shell test (ูู ุงูููู test_seq_access.py) ุจุงูุฅุนูุงู ุนู ุงูุฅุดุงุฑุงุช ูุชููุฆุฉ ุงูุญุงูุงุช ุงูุฃูููุฉ ูุฑูููุง ูู ูุธููุฉ ุจุฑูุงูุฌ ุชุดุบูู ุงูุฐุงูุฑุฉ ุงูููุถุญ ุฃุนูุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@block def testbench(): data_memory = TristateSignal(intbv(0)[8:]) data_in = Signal(intbv(0)[8:]) data_out = Signal(intbv(0)[8:]) adr = Signal(intbv(0)[16:]) adr_start = Signal(intbv(20)[16:]) adr_write = Signal(bool(0)) read, write, we = [Signal(bool(1)) for i in range(3)] ram = ram_driver(data_in, data_out, adr, adr_start, adr_write, data_memory, read, write, we)</span></span></code> </pre> <br>  ูููุง ููู ูุตู ููููุฐุฌ ุงูุฐุงูุฑุฉ.  ุชุชู ุชููุฆุฉ ุงูุญุงูุงุช ุงูุฃูููุฉ ุ ุงูุชุฑุงุถููุง ุ ูุชู ููุก ุงูุฐุงูุฑุฉ ุจููู ุตูุฑูุฉ.  ูุตุฑ ุทุฑุงุฒ ุงูุฐุงูุฑุฉ ุนูู 128 ุฎููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">memory = {i: intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">128</span></span>)}</code> </pre> <br>  ููุตู ุณููู ุงูุฐุงูุฑุฉ: ุนูุฏูุง ูููู ูู ุงูุญุงูุฉ ุงูููุฎูุถุฉ ุ ุงูุชุจ ุงููููุฉ ูู ุงูุณุทุฑ ุฅูู ุนููุงู ุงูุฐุงูุฑุฉ ุงูููุงุจู ุ ูุฅูุง ูุฅู ุงููููุฐุฌ ูุนุทู ุงููููุฉ ูู ุงูุนููุงู ุงููุญุฏุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">mem_z = data_memory.driver() @always_comb <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">access</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> we: memory[int(adr.val)] = data_memory.val <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> we: data_out.next = memory[int(adr.val)] mem_z.next = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span></code> </pre> <br>  ุซู ุ ูู ููุณ ุงููุธููุฉ ุ ููููู ูุตู ุณููู ุฅุดุงุฑุงุช ุงูุฅุฏุฎุงู (ูู ุญุงูุฉ ุงููุชุงุจุฉ / ุงููุฑุงุกุฉ ุงููุชุณูุณูุฉ): ูุชู ุชุณุฌูู ุนููุงู ุงูุจุฏุงูุฉ โ ุชุณุฌูู 8 ุฎูุงูุง ูุนูููุงุช โ ุชุณุฌูู ุงูุนููุงู โ ูุฑุงุกุฉ 8 ุฎูุงูุง ูุนูููุงุช ูุณุฌูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@instance def stimul(): init_adr = random.randint(0, 50) #   yield delay(100) write.next = 1 adr_write.next = 1 adr_start.next = init_adr #   yield delay(100) adr_write.next = 0 yield delay(100) for i in range(8): # 8    write.next = 0 data_in.next = random.randint(0, 100) yield delay(100) write.next = 1 yield delay(100) adr_start.next = init_adr #   adr_write.next = 1 yield delay(100) adr_write.next = 0 yield delay(100) for i in range(8): #   read.next = 0 yield delay(100) read.next = 1 yield delay(100) raise StopSimulation return stimul, ram, access</span></span></code> </pre> <br>  ุชุดุบูู ุงููุญุงูุงุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">tb = testbench() tb.config_sim(trace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) tb.run_sim()</code> </pre> <br>  ุจุนุฏ ุจุฏุก ุชุดุบูู ุงูุจุฑูุงูุฌ ุ ูุชู ุฅูุดุงุก ููู testbench_seq_access.vcd ูู ูุฌูุฏ ุงูุนูู ุ ููุชุญู ูู gtkwave: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">gtkwave testbench_seq_access.vcd</code> </pre> <br>  ููุญู ูุฑู ุงูุตูุฑุฉ: <br><br><img src="https://habrastorage.org/webt/io/ak/oc/ioakocq8btz-hdlk_-m7xzeshse.jpeg"><br><br>  ุชู ูุฑุงุกุฉ ุงููุนูููุงุช ุงููุณุฌูุฉ ุจูุฌุงุญ. <br><br>  ููููู ูุดุงูุฏุฉ ูุญุชููุงุช ุงูุฐุงูุฑุฉ ุนู ุทุฑูู ุฅุถุงูุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ ุฅูู testbench: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key, value <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> memory.items(): print(<span class="hljs-string"><span class="hljs-string">'adr:{}'</span></span>.format(key), <span class="hljs-string"><span class="hljs-string">'data:{}'</span></span>.format(value))</code> </pre> <br>  ูุธูุฑ ุงูุชุงูู ูู ูุญุฏุฉ ุงูุชุญูู: <br><br><img src="https://habrastorage.org/webt/js/sb/ly/jssbly6h3kodhjqrw7ih9mtzamg.jpeg"><br><br><h1 style=";text-align:right;direction:rtl">  ุงุฎุชุจุงุฑ </h1><br>  ุจุนุฏ ุฐูู ุ ููููู ุฅุฌุฑุงุก ุงูุนุฏูุฏ ูู ุงูุงุฎุชุจุงุฑุงุช ุงูุขููุฉ ูุน ุฒูุงุฏุฉ ุนุฏุฏ ุงูุฎูุงูุง ุงููุงุจูุฉ ูููุฑุงุกุฉ / ุงููุงุจูุฉ ูููุฑุงุกุฉ.  ููููุงู ุจุฐูู ุ ุชุชู ุฅุถุงูุฉ ุนุฏุฉ ุฏูุฑุงุช ุงุฎุชุจุงุฑ ูููุงููุณ ููููุฉ ุฅูู testbench ุ ุญูุซ ุชุชู ุฅุถุงูุฉ ุงููุนูููุงุช ุงูููุชูุจุฉ ูุงููุงุจูุฉ ูููุฑุงุกุฉ ูุงูุชุฃููุฏ ุ ููุง ูุคุฏู ุฅูู ุญุฏูุซ ุฎุทุฃ ุฅุฐุง ูุงู ุงูููุงููุณ ุบูุฑ ูุชุณุงููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@instance def stimul(): for time in range(100): temp_mem_write = {} temp_mem_read = {} init_adr = random.randint(0, 50) yield delay(100) write.next = 1 adr_write.next = 1 adr_start.next = init_adr yield delay(100) adr_write.next = 0 yield delay(100) for i in range(64): write.next = 0 data_in.next = random.randint(0, 100) temp_mem_write[i] = int(data_in.next) yield delay(100) write.next = 1 yield delay(100) adr_start.next = init_adr adr_write.next = 1 yield delay(100) adr_write.next = 0 yield delay(100) for i in range(64): read.next = 0 temp_mem_read[i] = int(data_out.val) yield delay(100) read.next = 1 yield delay(100) assert temp_mem_write == temp_mem_read, "   " for key, value in memory.items(): print('adr:{}'.format(key), 'data:{}'.format(value)) raise StopSimulation return stimul, ram, access</span></span></code> </pre><br>  ุจุนุฏ ุฐูู ุ ููููู ุฅูุดุงุก ุงุฎุชุจุงุฑ ุขุฎุฑ ูุงุฎุชุจุงุฑ ุงูุนูููุฉ ูู ูุถุน ุงููุตูู ุงูุนุดูุงุฆู: test_random_access.py. <br><br>  ุชุชุดุงุจู ููุฑุฉ ุงูุงุฎุชุจุงุฑ ุงูุซุงูู: ููุชุจ ูุนูููุงุช ุนุดูุงุฆูุฉ ุนูู ุนููุงู ุนุดูุงุฆู ููุถูู ุฒูุฌูู {address: data} ุฅูู ูุงููุณ temp_mem_write.  ุซู ููุชู ุญูู ุงูุนูุงููู ุงูููุฌูุฏุฉ ูู ูุฐุง ุงููุงููุณ ูููุฑุฃ ุงููุนูููุงุช ูู ุงูุฐุงูุฑุฉ ุ ูุฏุฎููุง ูู ูุงููุณ temp_mem_read.  ููู ุงูููุงูุฉ ูุน ุจูุงุก ุงูุชุฃููุฏ ุ ูุชุญูู ูู ูุญุชููุงุช ุงูููุงููุณ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> myhdl <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ram_driver <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ram_driver @block <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testbench_random_access</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> data_memory = TristateSignal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">8</span></span>:]) data_in = Signal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">8</span></span>:]) data_out = Signal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">8</span></span>:]) adr = Signal(intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">16</span></span>:]) adr_start = Signal(intbv(<span class="hljs-number"><span class="hljs-number">20</span></span>)[<span class="hljs-number"><span class="hljs-number">16</span></span>:]) adr_write = Signal(bool(<span class="hljs-number"><span class="hljs-number">0</span></span>)) read, write, we = [Signal(bool(<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">3</span></span>)] ram = ram_driver(data_in, data_out, adr, adr_start, adr_write, data_memory, read, write, we) memory ={i:intbv(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">128</span></span>)} mem_z = data_memory.driver() @always_comb <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">access</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> we: memory[int(adr.val)] = data_memory.val <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> we: data_out.next = memory[int(adr.val)] mem_z.next = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> @instance <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stimul</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">10</span></span>): temp_mem_write = {} temp_mem_read = {} <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">64</span></span>): write.next = <span class="hljs-number"><span class="hljs-number">1</span></span> adr_write.next = <span class="hljs-number"><span class="hljs-number">1</span></span> adr_start.next = random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">126</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) adr_write.next = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) write.next = <span class="hljs-number"><span class="hljs-number">0</span></span> data_in.next = random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>) temp_mem_write[int(adr_start.val)] = int(data_in.next) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) write.next = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> temp_mem_write.keys(): adr_start.next = key adr_write.next = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) adr_write.next = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) read.next = <span class="hljs-number"><span class="hljs-number">0</span></span> temp_mem_read[key] = int(data_out.val) <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) read.next = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> delay(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> temp_mem_write == temp_mem_read, <span class="hljs-string"><span class="hljs-string">'  random access'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> StopSimulation <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stimul, ram, access tb = testbench_random_access() tb.config_sim(trace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) tb.run_sim()</code> </pre> <br>  ูุฏู Python ุนุฏุฉ ุฃุทุฑ ูุฃุชูุชุฉ ุชูููุฐ ุงูุงุฎุชุจุงุฑ.  ุณูู ุขุฎุฐ pytest ููุจุณุงุทุฉ ุ ูุฌุจ ุฃู ูุชู ุชุซุจูุชู ูู ููุทุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">pip3 install pytest</code> </pre> <br>  ุนูุฏูุง ูุชู ุชุดุบูู ุงูุฃูุฑ "pysest" ูู ูุญุฏุฉ ุงูุชุญูู ุ ูุฅู ุฅุทุงุฑ ุงูุนูู ุณูู ูุฌุฏ ููููุฐ ูู ุงููููุงุช ูู ูุฌูุฏ ุงูุนูู ูุน "test_ *" ุจุฃุณูุงุฆูู. <br><br><img src="https://habrastorage.org/webt/pv/sz/zr/pvszzr_l6vdb6hnfn1pwkelu5vo.jpeg"><br><br>  ุชู ุงูุงูุชูุงุก ูู ุงูุงุฎุชุจุงุฑุงุช ุจูุฌุงุญ.  ุณุฃุฎุทุฆ ูู ูุตู ุงูุฌูุงุฒ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@block def ram_driver(data_in, data_out, adr, adr_start, adr_write, data_memory, read, write, we): mem_z = data_memory.driver() @always(adr_write.posedge, write.posedge, read.negedge) def write_start_adr(): if adr_write: adr.next = adr_start else: adr.next = adr + 1 @always(write) def write_data(): if not write: mem_z.next = data_in we.next = 1 #  ,    else: mem_z.next = None data_out.next = data_memory we.next = 1</span></span></code> </pre> <br>  ุฃุฌุฑู ุงูุงุฎุชุจุงุฑุงุช: <br><br><img src="https://habrastorage.org/webt/q7/f3/4b/q7f34bqhdrvwapsxawc_sdquxdu.jpeg"><br><br>  ููุง ูู ูุชููุน ุ ูู ููุง ุงูุงุฎุชุจุงุฑูู ุ ุชู ุงุนุชุจุงุฑ ุงููุนูููุงุช ุงูุฃูููุฉ (ุงูุฃุตูุงุฑ) ุ ุฃู ุฃูู ูู ูุชู ุชุณุฌูู ูุนูููุงุช ุฌุฏูุฏุฉ. <br><br><h1 style=";text-align:right;direction:rtl">  ุงูุฎุงุชูุฉ </h1><br>  ูุชูุญ ูู ุงุณุชุฎุฏุงู python ูุน myHDL ุฃุชูุชุฉ ุงุฎุชุจุงุฑ ุงูุจุฑุงูุฌ ุงูุซุงุจุชุฉ ุงููุทูุฑุฉ ูู ุฃุฌู FPGAs ูุฅูุดุงุก ุฃู ุจูุฆุฉ ุงุฎุชุจุงุฑ ุชูุฑูุจูุง ุจุงุณุชุฎุฏุงู ุงูุฅููุงูุงุช ุงูุบููุฉ ูู ูุบุฉ ุจุฑูุฌุฉ python. <br><br>  ูุนุชุจุฑ ุงูููุงู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูุญุฏุฉ ููุทูุฉ ุชุนูู ูุน ุงูุฐุงูุฑุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุฅูุดุงุก ูููุฐุฌ ุงูุฐุงูุฑุฉ ุ </li><li style=";text-align:right;direction:rtl">  ุฎูู ุญุงูุฉ ุงูุงุฎุชุจุงุฑ ุ </li><li style=";text-align:right;direction:rtl">  ุงุฎุชุจุงุฑ ุงูุฃุชูุชุฉ ูุน ุฅุทุงุฑ pytest. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar442010/">https://habr.com/ru/post/ar442010/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar441998/index.html">"ูุงุฒุช ุงูุญุงููุงุช ูู ุงููุนุฑูุฉ ุ ููููุง ุฎุณุฑุช ุงูุญุฑุจ ุนูู ุงูุนูุงุฑุฉ ุจุฏูู ุฎุงุฏู" - ุณุงูููู ูุงุฑุฏูู</a></li>
<li><a href="../ar442002/index.html">ุฅุฏุฎุงู ุงูุนุตุจูุฉ ODE</a></li>
<li><a href="../ar442004/index.html">ุขุซุงุฑ ุชุตููุฉ SVG. ุงูุฌุฒุก 7. ุฅูู ุงูุฃูุงู</a></li>
<li><a href="../ar442006/index.html">ุฅุฏุงุฑุฉ ุงููููุงุช ุฎุทุฃ - ุงูุฌุฒุก 2: ุชุญูุฉ ูู ุงูุฎุฑุงุก</a></li>
<li><a href="../ar442008/index.html">k3s ูู Kubernetes ุตุบูุฑุฉ ูููููุง ูุนุชูุฏุฉ ูู ูุจู Rancher Labs</a></li>
<li><a href="../ar442012/index.html">ุงูุชุฌุฑุจุฉ: ูููู ุจุฌูุน ุฏููู ุงููุญุฏุงุช ุงูุชู ุฃุตุฏุฑุช ุฌูุงุฒ ุณูุฑ</a></li>
<li><a href="../ar442014/index.html">ุฃุนูู ุงููุจูู 2.2: ุฑูุฒ ุงูุขูุฉ ุฃูุซุฑ ููุงุกุฉ ุ ูุฏุนู ูุฌููุนุฉ ุงูุญุฑูู</a></li>
<li><a href="../ar442016/index.html">ุงููุชุณูููู ุฃุณูุฃ ูู ุงูููุญุฉ ุ ุฃู ููููุฉ ุญูุงูุฉ ุชุทุจููุงุช ุงูููุจ</a></li>
<li><a href="../ar442018/index.html">ูุงููู ุงูุฑุจูุน ูู ุญูุซ ุงูุฏุณุชูุฑ. ููุงุฐุง ูููู</a></li>
<li><a href="../ar442020/index.html">ุจุฑูุงูุฌ ุชุฑููุฒ AV1 ุฌุฏูุฏ: ุชุณุฑูุน ุชุญููู ุงูููุฏูู ูู ุงููุชุตูุญ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>