<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöß üíÆ ‚úåüèø Acidentes ajudam voc√™ a aprender üöæ üßùüèΩ üï•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nos √∫ltimos 3 anos, mais de mil incidentes de diferentes graus √©picos ocorreram no Contour. Os motivos s√£o diferentes: por exemplo, 36% s√£o causados ‚Äã...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Acidentes ajudam voc√™ a aprender</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/458924/">  Nos √∫ltimos 3 anos, mais de mil incidentes de diferentes graus √©picos ocorreram no Contour.  Os motivos s√£o diferentes: por exemplo, 36% s√£o causados ‚Äã‚Äãpor vers√µes de baixa qualidade e 14% - devido √† manuten√ß√£o de ferro no data center.  De onde v√™m as estat√≠sticas?  Ap√≥s cada incidente, um relat√≥rio √© escrito - post mortem.  Eles foram escritos pelos engenheiros de servi√ßo que responderam √† notifica√ß√£o do acidente e foram os primeiros a entender suas causas.  Post-mortem s√£o analisadas, identificadas e eliminadas as causas dos incidentes, para que no futuro esses incidentes n√£o ocorram.  Mas esse nem sempre foi o caso. <br><br>  <strong>Alexey Kirpichnikov</strong> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">BeeVee</a> ) programa em Yandex desde 2008.  O engarrafamento, trabalhou em projetos especiais de esportes, foi o l√≠der da equipe do back-end Yandex.Taxi.  Desde 2014, ele participa do DevOps e da infraestrutura em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Kontur</a> - ele desenvolve ferramentas que facilitam a vida dos desenvolvedores das equipes de produtos.  A id√©ia de escrever e analisar t√≥picos post-mortem surgiu h√° cinco anos e, durante esse per√≠odo, os t√≥picos post-mortem estavam repletos de modelos, gloss√°rio, memorandos, capturas de tela e an√°lises.  Mas isso n√£o √© o mais dif√≠cil - <strong>foi mais dif√≠cil superar a in√©rcia, os medos e o mal-entendido sobre o significado dos relat√≥rios de incidentes entre os engenheiros</strong> .  O que finalmente aconteceu e que benef√≠cio irrepar√°vel a "an√°lise do sof√°" pode fazer √© decifrar o relat√≥rio de Alexey. <br><br><img src="https://habrastorage.org/webt/ur/pv/rw/urpvrwxzfruc7xv3b7vzpmn-eqc.jpeg"><br>  <i>Observe - sob as pernas da mesa de diferentes comprimentos, existem os livros "M√©tricas", "Testes" e "Implementar".</i> <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tuSZq4rW8TQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Em Kontur, ap√≥s a contrata√ß√£o, eles d√£o um conjunto de lembran√ßas: uma caneta, uma caneca, um caderno.  Eu vim para a SKB Kontur para uma nova equipe de infraestrutura h√° 5 anos, quando a empresa completou 25 anos. <br><br><img src="https://habrastorage.org/webt/5l/-o/ov/5l-oovwyznszo5q4di-2zjn4cp0.jpeg"><br><br>  O contorno daqueles tempos, e agora tamb√©m, √© uma empresa de produtos na qual v√°rias dezenas de produtos desenvolveram o mesmo n√∫mero de equipes, independentes entre si em termos de escolha de tecnologias e ferramentas. <br><br>  Naquela √©poca, li pela primeira vez o ‚ÄúProjeto '' Phoenix ''‚Äù e fui inspirado pelas novas id√©ias das pr√°ticas de DevOps.  Comecei a escrever minhas id√©ias para melhorias em um caderno, e agora √© um artefato com manchas de caf√© e registros hist√≥ricos. <br><br><ul><li>  ‚Äú <strong>Monitorando!</strong>  Vamos colocar o Grafana, coletar m√©tricas e criar gr√°ficos.  Vamos entender melhor o que est√° acontecendo na produ√ß√£o ".  Para 2014, essa √© uma ideia nova e relativamente nova e uma s√≥lida pr√°tica de DevOps. ‚Äù </li><li>  " <strong>Travamento autom√°tico!"</strong>  Quantos arquivos zip podem ser carregados na pasta compartilhada, descompacte-os no servidor e execute exe no agendador de tarefas do Windows?  "Vamos introduzir um sistema de implanta√ß√£o industrial e lan√ßar vers√µes atrav√©s dele, CI!" </li><li>  ‚Äú <strong>Post-mortem</strong> !  Se houver algum tipo de acidente na produ√ß√£o, vamos descobrir o que foi, descobrir o motivo, escrever um relat√≥rio e alterar nossos processos de desenvolvimento, teste e IC para que n√£o ocorram esses incidentes no futuro ‚Äù </li></ul><br>  Por cinco anos, avan√ßamos em todas essas √°reas.  Temos nosso pr√≥prio sistema de alerta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Moira</a> , sistema de orquestra√ß√£o de aplicativos e v√°rias ferramentas.  Por√©m, de todas as op√ß√µes acima, <strong>escrever relat√≥rios de incidentes acabou sendo a pr√°tica de engenharia mais dif√≠cil de implementar</strong> .  Os engenheiros adoram todos os tipos de ferramentas - fixam algum tipo de sistema ou IC de hospedagem, escrevem algo, automatizam e n√£o gostam de escrever relat√≥rios, embora essa pr√°tica seja de grande utilidade. <br><br>  Vou contar como implementamos os sistemas post-mortem e quais os benef√≠cios que obtemos.  Talvez o nosso rake ajude a avan√ßar mais r√°pido e a encher menos cones.  Antes de come√ßar a falar sobre post-mortem, entenderemos a defini√ß√£o. <br><br><h2>  O que √© um incidente? </h2><br>  Qual destes √© o incidente? <br><br><ul><li>  Exemplo No. 1.  Em uma plataforma de blog com um milh√£o de usu√°rios, como resultado de algum tipo de erro, todas as entradas de um usu√°rio s√£o perdidas. </li><li>  Exemplo No. 2.  O servi√ßo para funcion√°rios do escrit√≥rio funciona nos dias √∫teis das 9 √†s 6 e, outras vezes, n√£o h√° usu√°rios.  O servi√ßo ficou indispon√≠vel na noite de s√°bado a domingo por duas horas consecutivas, ningu√©m notou. </li><li>  Exemplo No. 3.  A Grafana com m√©tricas de produ√ß√£o caiu 15 minutos.  Na produ√ß√£o, nada quebrou, mas os gr√°ficos n√£o estavam dispon√≠veis. </li></ul><br>  Para entender o que √© esse fakapy, passamos √† experi√™ncia dos gurus - Google, Atlassian, PagerDuty.  Os gurus sabem como preparar turnos, engenheiros de plant√£o e como escrever relat√≥rios para entend√™-los.  Seus guias on-line t√™m defini√ß√µes de incidentes. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Defini√ß√£o</a> do PagerDuty. <br><blockquote>  Um incidente √© qualquer interrup√ß√£o ou degrada√ß√£o n√£o planejada de um servi√ßo que afeta a disponibilidade do servi√ßo para os usu√°rios.  Um incidente grave √© aquele que requer uma resposta coordenada de v√°rias equipes. </blockquote><br>  Parece l√≥gico, mas a defini√ß√£o √© vaga.  Na pr√°tica, ajuda pouco a entender o que √© um incidente e o que n√£o √©. <br><br>  O livro <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Engenharia de confiabilidade</a> do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site</a> do Google tem crit√©rios claros: <br><br><ul><li>  Os usu√°rios notaram a degrada√ß√£o do servi√ßo. </li><li>  Qualquer dado foi perdido. </li><li>  Foi necess√°ria a interven√ß√£o do engenheiro de servi√ßo, por exemplo, para reverter manualmente a libera√ß√£o. </li><li>  Resolver o problema levou muito tempo.  Se um problema foi resolvido em 2 horas e, em seguida, uma semana foi gasta nele - este √© um incidente que requer investiga√ß√£o. </li><li>  O monitoramento n√£o funcionou.  Por exemplo, voc√™ aprendeu sobre um problema com os usu√°rios. </li></ul><br>  Contour n√£o possui uma defini√ß√£o publicada de fakap, mas formulamos nossos pr√≥prios crit√©rios para determinar o que constitui um incidente. <br><br>  <strong>Usu√°rios externos ou internos notaram uma degrada√ß√£o do servi√ßo</strong> .  O exemplo 3 com Grafana, que estava, √© um incidente claro.  A produ√ß√£o n√£o parou e os usu√°rios externos n√£o perceberam isso, mas, apesar disso, para o Contour √© um fakap, pois as ferramentas internas n√£o funcionaram. <br><br>  <strong>Sorte</strong> .  No exemplo n¬∫ 2, o servi√ßo para funcion√°rios de escrit√≥rio ficava por duas horas √† noite - teve sorte por cair √† noite.  Na pr√≥xima vez, pode ser azarado e, portanto, o incidente noturno tamb√©m exige julgamento, como se tivesse acontecido durante o dia. <br><br>  <strong>O incidente diz respeito a v√°rias equipes</strong> .  Tomamos essa defini√ß√£o do PagerDuty.  A an√°lise de um incidente √© um bom motivo para v√°rias equipes trabalharem juntas.  A cultura ‚ÄúDa nossa parte, a bala voou, mas algo quebrou para voc√™ - a culpa √© sua‚Äù √© erradicada por uma an√°lise conjunta. <br><br>  <strong>Pelo menos um engenheiro considera isso um incidente</strong> .  A defini√ß√£o mais vaga, mas tamb√©m a mais importante.  Uma regra simples: se o engenheiro acredita que vale a pena o relat√≥rio, ent√£o vale a pena o relat√≥rio.  Se voc√™ assusta que os engenheiros come√ßar√£o a escrever relat√≥rios para qualquer pessoa e chamarem qualquer coisinha de acidente, isso n√£o √© verdade.  <strong>Engenheiros s√£o pessoas razo√°veis, confie neles.</strong> <br><br>  Com a defini√ß√£o e os diferentes tipos de danos resolvidos.  Vamos passar a como se beneficiar de incidentes. <br><br><h2>  Qual √© o uso do fakap? </h2><br>  As instru√ß√µes simples que darei mais adiante, voc√™ pode se inscrever, mesmo sem passar pelo artigo at√© o final.  Mas ainda leia at√© o fim. <br><br><h3>  Instru√ß√£o cl√°ssica </h3><br>  Encontre os culpados primeiro.  Em seguida, fa√ßa o trabalho ‚Äúeducacional‚Äù com os engenheiros. <br><br><ul><li>  Pe√ßa para ter mais cuidado da pr√≥xima vez. </li><li>  Se n√£o ajudar, envie-o para cursos de reciclagem.  Talvez eles aprendam a ter mais cuidado l√°. </li><li>  Se isso n√£o ajudar, retire os autores do trabalho com partes cr√≠ticas do sistema.  Pare de deixar os desenvolvedores entrarem em produ√ß√£o se eles mexerem l√° em cima. </li><li>  Se nada ajudar, demitir os maus e contratar os competentes. </li></ul><br><blockquote>  Se a instru√ß√£o o incomoda, s√£o boas not√≠cias. </blockquote><br>  Essa abordagem √© considerada tradicional para empresas cl√°ssicas de orienta√ß√£o vertical, com um chefe que repreende a todos e pode demiti-lo.  Um dos fundamentos do movimento DevOps e da ideologia DevOps √© a mudan√ßa das organiza√ß√µes verticalmente integradas para as horizontais, com maior confian√ßa nos funcion√°rios. <br><br>  Ilustrarei essa mudan√ßa de paradigma com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">instru√ß√µes de</a> John Alspaw, um dos l√≠deres do movimento DevOps, que anteriormente trabalhava para CTO na Etsy.  A instru√ß√£o foi retirada de seu artigo can√¥nico de 2013, Blameless Post Mortem e uma cultura justa. <br><br>  Pergunte aos engenheiros: <br><br><ul><li>  quais eventos eles observaram; </li><li>  quando e quais a√ß√µes foram tomadas; </li><li>  que resultado era esperado dessas a√ß√µes; </li><li>  de que suposi√ß√µes vieram; </li><li>  conforme entendido pela sequ√™ncia de eventos que ocorreram. </li></ul><br><blockquote>  Os engenheiros precisam ser solicitados sem amea√ßa de puni√ß√£o. </blockquote><br>  Esta √© a principal coisa na recomenda√ß√£o de John. <br><br>  A amea√ßa de puni√ß√£o: reciclagem, elimina√ß√£o da produ√ß√£o ou demiss√£o, motiva as pessoas a mentir.  E a verdade √© importante para n√≥s.  Relat√≥rio de incidentes - esse √© o elo de feedback muito ausente no processo de desenvolvimento e coloca√ß√£o de recursos em produ√ß√£o. <br><br>  No antigo paradigma, os desenvolvedores desenvolveram, jogaram a nave por cima dos cercados para os engenheiros de opera√ß√µes e, de alguma forma, tentaram faz√™-la funcionar.  Eles ficam aborrecidos com qualquer atualiza√ß√£o, porque ela pode quebrar tudo, e os engenheiros come√ßaram tudo com tanta dificuldade. <br><br><img src="https://habrastorage.org/webt/vu/l6/lo/vul6locumgejop93bd_wec32vgu.jpeg"><br><br><blockquote>  O processo de feedback ajuda a mudar o processo, a infraestrutura, as ferramentas e a abordagem de desenvolvimento para que haja menos falhas na produ√ß√£o. </blockquote><br>  Isso convencer√° os l√≠deres de equipe e os gerentes de desenvolvimento da utilidade do post-mortem.  Mas o problema √© que √© dif√≠cil conseguir que os engenheiros fa√ßam o que consideram in√∫til e in√∫til.  Temos uma cultura de engenharia em nossa empresa e n√£o posso simplesmente aceitar o decreto do CEO e exigir que todos escrevam post-mortem.  Eu preciso convencer os engenheiros disso. <br><br><img src="https://habrastorage.org/webt/r_/bx/z6/r_bxz6wh5wxshbqejunizuaspxk.jpeg"><br><br>  Como "vender" a id√©ia de engenheiros post-mortem para engenheiros?  Para contornar as obje√ß√µes, mostrar por que o post-mortem √© legal, demonstrar o benef√≠cio dos relat√≥rios, que isso n√£o √© apenas um cancelamento de assinatura, se apenas o chefe estiver atrasado. <br><br><h2>  Obje√ß√£o No. 1: Uma vez </h2><br>  Este √© o primeiro problema do engenheiro que desmonta o fakap - a guerra vai acabar, ent√£o conversaremos!  Quando um fakap ocorre, quero corrigi-lo rapidamente, mas n√£o quero escrever relat√≥rios chatos e incompreens√≠veis e longos. <br><br>  Para resolver o problema, h√° um truque de vida, como escrever algo certo durante um acidente.  Ele foi popularizado por Artemy Lebedev: <br><blockquote>  ‚ÄúExiste uma maneira simples de organizar o tempo - o m√©todo‚Äú jeepeg progressivo ‚Äù.  A qualquer momento, qualquer projeto est√° 100% pronto, embora possa ser 4% mais desenvolvido.  Dependendo do tempo dispon√≠vel, o projeto pode ser elaborado at√© um pixel ou pode ser deixado no est√°gio de desenho conceitual. ‚Äù </blockquote><br>  Ilustrarei o m√©todo jeepeg progressivo usando uma figura.  Em uma Internet lenta, uma imagem n√£o √© baixada imediatamente, mas em etapas. <br><br><img src="https://habrastorage.org/webt/ug/af/nu/ugafnukcgr0qse0ffzyd1_og898.jpeg"><br><br>  Durante um inc√™ndio, voc√™ n√£o precisa escrever um relat√≥rio longo e legal.  √â o suficiente para voc√™ no canto superior esquerdo.  Basta marcar as coisas que ser√£o dif√≠ceis de recuperar da mem√≥ria.  N√£o tente escrever um texto liter√°rio coerente no momento em que tudo estiver danificado na produ√ß√£o. <br><br><blockquote>  Execute uma a√ß√£o simples - anote a cronologia dos eventos. </blockquote><br><h3>  Linha do tempo </h3><br>  A linha do tempo √© muito dif√≠cil de restaurar, se n√£o for gravada imediatamente.  Um exemplo de uma grava√ß√£o de um post-mortem real no circuito. <br><br><pre><code class="plaintext hljs">15.01.18 17:25 YEKT    PrefixSearch  50   . ,     .</code> </pre> <br>  Esta √© uma observa√ß√£o curta e simples, com registro de data e hora.  De acordo com essa cronologia, mais tarde √© f√°cil restaurar a sequ√™ncia de eventos e encontrar a causa do colapso.  Mas se voc√™ n√£o gravar nada diretamente durante um inc√™ndio, ser√° dif√≠cil ou imposs√≠vel restaurar os eventos posteriormente. <br><br><h3>  Screenshots </h3><br>  Uma coisa √∫til, especialmente ao trabalhar com um site ou aplicativo de desktop.  √Äs vezes, a situa√ß√£o √© dif√≠cil de descrever em palavras, e uma captura de tela √© apenas um clique de uma tecla de acesso. <br><br><img src="https://habrastorage.org/webt/a5/vw/ek/a5vwektoqktqkzwwatkfkirlbdk.jpeg"><br><br>  A primeira obje√ß√£o deu certo.  Gravando informa√ß√µes m√≠nimas, um pequeno relat√≥rio durante o incidente n√£o √© dif√≠cil e n√£o ocupa um tempo valioso.  Quando tudo termina, ele precisa ser conclu√≠do e executado em um documento compreens√≠vel e coerente. <br><br><h2>  Obje√ß√£o n¬∫ 2: Pregui√ßa </h2><br>  Voc√™ n√£o dormiu por dois dias e consertou um acidente grave, ficando fatalmente para tr√°s em todas as tarefas que iria realizar esta semana.  Mas acontece que algo mais precisa ser feito, mas o fogo j√° foi extinto!  Neste momento, a pregui√ßa inimagin√°vel alcan√ßa. <br><br>  Para derrotar completamente o problema n√£o vai funcionar.  Mas voc√™ pode facilitar seu trabalho com anteced√™ncia. <br><br><h3>  Padr√£o </h3><br>  Este √© o primeiro e mais importante.  H√° um grande medo de um documento vazio que precise ser preenchido com texto significativo.  √â muito mais f√°cil se o modelo estiver preparado.  Geralmente consiste de se√ß√µes e perguntas nelas.  N√≥s inserimos as respostas para as perguntas em cada se√ß√£o e o modelo √© preenchido. <br><br>  Os modelos de relat√≥rio de incidentes s√£o grandes.  Leia sobre eles em detalhes com o guru.  Todos os documentos e livros a que me refiro cont√™m padr√µes de incidentes usados ‚Äã‚Äãpelas empresas.  Em nossa experi√™ncia, posso adicionar o seguinte. <br><br><h3>  Crie um memorando com exemplos </h3><br>  Nosso modelo possui uma se√ß√£o "Dano" com subse√ß√µes. <br><br>  <strong>Se√ß√£o "Avalia√ß√£o qualitativa".</strong>  Descreve o que o engenheiro v√™ √† sua frente quando preenche esta parte do modelo: <br><br><ul><li>  que funcionalidade n√£o funcionou, por quanto tempo e para quem; </li><li>  se houve perda ou corrup√ß√£o de dados. </li></ul><br>  Tendo alcan√ßado esse lugar no modelo, o engenheiro escreve: "H√° um milh√£o de usu√°rios em nossa plataforma de blog, perdemos todas as entradas de um deles".  Isso √© muito mais f√°cil do que escrever um ensaio do zero, como em uma li√ß√£o de literatura. <br><br>  <strong>Se√ß√£o "Quantifica√ß√£o":</strong> <br><br><ul><li>  quantos pedidos desapareceram; </li><li>  quanta lat√™ncia cresceu nas m√©tricas de aplicativos e aplicativos de clientes; </li><li>  quantas chamadas s√£o perdidas; </li><li>  O tamanho da fila para suporte t√©cnico do usu√°rio para o problema. </li></ul><br>  Um conjunto de tais perguntas √© o padr√£o. <br><br>  Um exemplo de um dos modelos conclu√≠dos. <br><br><img src="https://habrastorage.org/webt/kv/4o/yq/kv4oyqs_2ukhu-o1hdrxgtc01s8.jpeg"><br><br><h3>  Adicionar gloss√°rio </h3><br>  Outro truque da vida para relat√≥rios de acidentes, que eu n√£o vi no livro com o guru.  Ao escrever um relat√≥rio, √© conveniente usar termos que voc√™ conhece bem.  Por exemplo, se eu trabalho com o Grafite, em que m√©tricas s√£o armazenadas, sei bem o que √© "retransmiss√£o".  Mas o engenheiro que ler√° o relat√≥rio em um ano pode n√£o estar familiarizado com o termo.  √â improv√°vel que ele consiga ler o relat√≥rio, que consiste em palavras desconhecidas.  Por outro lado, se todos os termos e defini√ß√µes forem constantemente inclu√≠dos no relat√≥rio, a pregui√ßa simplesmente o assusta e o relat√≥rio n√£o ser√° conclu√≠do. <br><br><blockquote>  Escreva um pequeno gloss√°rio descrevendo todos os termos usados ‚Äã‚Äãno relat√≥rio. </blockquote><br><img src="https://habrastorage.org/webt/it/fm/6z/itfm6zuhzxdahe90n6fqvaifhz0.jpeg"><br><br><h3>  Copiar todos os artefatos </h3><br>  Se voc√™ anexar artefatos ao relat√≥rio: capturas instant√¢neas no Grafana, o hist√≥rico de mensagens no bate-papo, no qual o incidente foi analisado com outros engenheiros, fa√ßa c√≥pias.  As m√©tricas t√™m a capacidade de "apodrecer" e os bate-papos mudam.  H√° um ano, voc√™ estava no Slack, agora no Telegram - o link do bate-papo est√° desatualizado e n√£o funciona, e as m√©tricas de reten√ß√£o caem - elas s√£o armazenadas por um ano. <br><br><blockquote>  Copiar artefatos - esse truque de vida facilita o preenchimento de relat√≥rios. </blockquote><br><h2>  Obje√ß√£o n¬∫ 3: ningu√©m ler√° </h2><br>  A maior e incompreens√≠vel pergunta feita pelos engenheiros √©: "Quem ler√° esses relat√≥rios?"  Suponha que eu superei a pregui√ßa e escrevi uma cronologia de eventos durante o acidente.  Depois, reuniu for√ßas e acrescentou um relat√≥rio de v√°rias p√°ginas sobre o que aconteceu e as causas do acidente.  Mas se n√£o houver um entendimento de quem ler√° tudo isso e quem se beneficiar√°, n√£o haver√° desejo de preencher relat√≥rios. <br><br><blockquote>  Post-mortem √© um feedback no processo de melhoria cont√≠nua dos processos de desenvolvimento. </blockquote><br>  Em qualquer livro de guru, por exemplo, no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Atlassian Incident Handbook</a> , est√° escrito que, de acordo com os resultados de cada post-mortem, √© necess√°rio: <br><br><ul><li>  formular tarefas em desenvolvimento; </li><li>  crie tarefas no rastreador de erros a partir do qual seus desenvolvedores as levar√£o; </li><li>  coloque links post-mortem para essas tarefas. </li></ul><br>  <strong>O feedback est√° fechado</strong> : aqui est√° um post-mortem, aqui nele <strong>itens de a√ß√£o</strong> - tarefas que precisam ser conclu√≠das para que o acidente n√£o aconte√ßa novamente.  As tarefas caem no backlog da equipe, a equipe as desenvolve, lan√ßa - novamente o fakap e post mortem.  A roda do samsara se fechou. <br><br>  √â nisso que todos os gurus convergem.  N√£o h√° o que discutir - os benef√≠cios s√£o √≥bvios. <br><br>  Um exemplo de tarefas de itens de a√ß√£o de um post-mortem real. <br><br><img src="https://habrastorage.org/webt/bi/rh/-u/birh-ug-du80xmxqt3eqvdrdst8.jpeg"><br><br>  Mas n√≥s da Kontur adicionamos um analista a isso. <br><br><h2>  An√°lise de sof√° </h2><br>  Costum√°vamos analisar o incidente isoladamente.  A falha ocorreu por conta pr√≥pria em uma equipe, em um sistema de hospedagem - algo quebrou, n√≥s corrigimos. <br><br>  Mas h√° muitos incidentes.  Nos √∫ltimos tr√™s anos, mais de 1.000 relat√≥rios de incidentes foram acumulados no circuito.  Gostaria de saber se √© poss√≠vel se beneficiar de toda a massa de relat√≥rios acumulados, e n√£o apenas de cada um individualmente.  √â poss√≠vel, com base nisso, calcular as estat√≠sticas do sistema e ver o que melhorar no sistema como um todo. <br><br>  Uma equipe de infraestrutura especial trabalha em Kontur, que se dedica √† an√°lise post-mortem e publica os resultados e conclus√µes com base em toda a massa de relat√≥rios acumulados.  Chamamos isso de "an√°lise do sof√°".  Darei fragmentos de um dos artigos da equipe, que √© publicado em nossa rede interna para funcion√°rios. <br><br>  O que analisamos na an√°lise de sof√°? <br><br><h3>  Dura√ß√£o Fakap </h3><br><br><img src="https://habrastorage.org/webt/2b/yq/wz/2byqwzifhia0nzxypk0eqmqrdh8.jpeg"><br><br>  <em>No diagrama, al√©m da √∫ltima coluna, onde o tempo √© desconhecido, existem mais dois picos √≥bvios.</em> <br><br>  <strong>Dura√ß√£o da ordem de uma hora</strong> - barras laranja e vermelhas.  Passou a maior parte do tempo transmitindo informa√ß√µes sobre o que aconteceu, desde o engenheiro que percebeu o acidente at√© o engenheiro que sabe como corrigi-lo.  <strong>O problema √© a comunica√ß√£o</strong> . <br><br>  Se consertarmos nossas ferramentas para que o engenheiro que resolve o problema receba as informa√ß√µes mais rapidamente, a dura√ß√£o dos fakaps e os danos deles ser√£o bastante reduzidos.  Isso √© algo que n√£o reconhecer√≠amos olhando para qualquer fakap individualmente. <br><br>  <strong>Dura√ß√£o cerca de 12 horas</strong> - uma coluna amarela.  A explica√ß√£o para o fato de que existem muitos fakaps que duram mais de 12 horas √© simples: eles lan√ßaram o lan√ßamento √† noite e pela manh√£ chegaram os usu√°rios e tudo quebrou.  A conclus√£o do que fazer para reduzir o n√∫mero de fakaps √© √≥bvia. <br><br><h3>  Dano de qualidade </h3><br><img src="https://habrastorage.org/webt/js/l0/i9/jsl0i9hoqlos7n2uloqh0nnki_y.jpeg"><br><br>  O dano qualitativo √© dividido em v√°rias categorias.  Os tr√™s principais incluem: <br><br><ul><li>  inacessibilidade, erros; </li><li>  freios, lat√™ncia aumentada; </li><li>  comportamento incorreto vis√≠vel. </li></ul><br>  Segundo a an√°lise, a grande maioria desses erros.  Por um lado, s√£o boas not√≠cias.  Tr√™s tipos dos erros mais comuns s√£o f√°ceis de detectar - ajustamos as m√©tricas √† lat√™ncia e ao n√∫mero de erros e notamos rapidamente essas coisas. <br><br>  A m√° not√≠cia √© que existem muitos desses erros.  Esses s√£o erros t√©cnicos simples, o que significa que poder√≠amos melhorar algo nos testes de dutos, realizar mais testes de estresse e melhorar o sistema de monitoramento. <br><br><h3>  Triggers </h3><br>  Foi isso que levou diretamente √† avaria, ou seja, n√£o a causa raiz do acidente, mas a ‚Äúgota d'√°gua‚Äù: os troncos encheram o disco e, por isso, tudo quebrou, liberou - tudo explodiu. <br><br><img src="https://habrastorage.org/webt/vi/u5/iy/viu5iyoxhj_ykvpg9itnr-7qy0u.jpeg"><br><br>  Em primeiro lugar, est√° a "instala√ß√£o de atualiza√ß√£o".  Esse motivo nos permite entender onde devemos investir como equipe de infraestrutura.  Por exemplo, para melhorar o sistema de implanta√ß√£o e introduzir uma implanta√ß√£o can√°ria.  Este √© o ponto de esfor√ßo que ter√° o maior impacto na qualidade de nossos sistemas. <br><br><blockquote>  Esse √© o objetivo de todas as an√°lises - entender onde uma pequena equipe de infraestrutura deve investir agora nas condi√ß√µes de recursos limitados. </blockquote><br>  O que melhorar - alerta ou implanta√ß√£o?  O que fazer - hospedagem ou a beleza dos gr√°ficos? <br><br>  Aqui est√° outro bom insight.  Em segundo lugar, ‚Äúa causa √© desconhecida‚Äù.  Este √© um indicador de relat√≥rios ruins de relat√≥rios de incidentes. <br><br><h3>  Poss√≠veis "p√≠lulas" </h3><br>  Isso permite uma solu√ß√£o t√©cnica simples para reduzir o n√∫mero de acidentes de um determinado tipo.  Por exemplo, sabemos que as coisas mais importantes que reduzem o n√∫mero de fakaps s√£o as notifica√ß√µes do sistema de monitoramento.  Se houvesse mais alertas no monitoramento desses eventos, quantos incidentes poder√≠amos impedir?  Porcentagem indica quanto: <br><br><ul><li>  no n√∫mero de erros de HTTP do cliente - 10%; </li><li>  na apar√™ncia de novos tipos de erros nos logs: instala√ß√£o, configura√ß√µes de notifica√ß√£o - 8%; </li><li>  nos recursos do sistema: CPU, mem√≥ria, disco, threads, GC - 6%. </li></ul><br>  Se o alerta fosse configurado corretamente e o engenheiro desejado recebesse uma notifica√ß√£o no prazo, 24% dos incidentes n√£o ocorreriam ou teriam uma dura√ß√£o muito menor.  Esta conclus√£o pode ser feita com base na an√°lise de toda a massa de incidentes. <br><br>  Aqui vou anunciar novamente nosso sistema de alerta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Moira</a> , que est√° localizado em c√≥digo aberto. <br><br><img src="https://habrastorage.org/webt/fz/yu/tb/fzyutbmpcgj2xnarmqhxwnqbrjk.jpeg"><br><br>  Se voc√™ possui grafite, pode fazer o download e us√°-lo.  Espero que haja menos incidentes. <br><br><h3>  Recomenda√ß√µes </h3><br>  Recomenda√ß√µes organizacionais que a equipe pode seguir e tamb√©m reduzir o n√∫mero de acidentes.  Nosso top 3. <br><br><ul><li>  <strong>A semelhan√ßa dos sites de teste e combate</strong> .  5% dos incidentes ocorreram devido ao fato de o local do teste n√£o ser suficientemente semelhante ao do combate. </li><li>  <strong>Compatibilidade com vers√µes anteriores em libera√ß√µes</strong> .  O lan√ßamento foi deflacionado, n√£o era compat√≠vel com o anterior, surgiram migra√ß√µes de dados - 4% dos erros. </li><li>  <strong>Recusa de lan√ßamentos noturnos</strong> .  Se voc√™ parar de espalhar lan√ßamentos que quebram, √† noite, outros 4% dos incidentes desaparecer√£o. </li></ul><br>  Enfatizo que isso n√£o √© uma instru√ß√£o, mas uma hist√≥ria sobre como coletamos an√°lises.  Suas an√°lises podem ser diferentes. <br><br><h2>  Como escrever </h2><br>  Se voc√™ perceber que a an√°lise de incidentes √© uma coisa interessante e precisar escrever relat√≥rios, eu mostrarei como faz√™-lo. <br><br><h3>  Publicar post-mortem e tarefas em um rastreador de erros </h3><br>  No rastreador de erros, ao contr√°rio do Google Docs ou Wiki, existem campos fixos para os quais voc√™ pode definir um conjunto de valores.  Isso facilita a an√°lise das estat√≠sticas gr√°ficas posteriormente. <br><br>  No livro do SRE, o Google fornece um modelo no Google Docs, no qual eles escrevem relat√≥rios em seus documentos internos.  N√£o consigo imaginar como podemos coletar as an√°lises que coletamos de documentos n√£o estruturados do Google. <br><br>  Escrevemos relat√≥rios no mesmo rastreador de erros que as principais tarefas, porque podemos conectar a tarefa ao post-mortem.  Vamos dar uma olhada no post-mortem e ver imediatamente quais tarefas est√£o fechadas, quais n√£o est√£o e quais est√£o por fazer. <br><br><h3>  Crie campos especiais </h3><br>  Eu j√° falei sobre campos especiais.  N√≥s temos o seguinte. <br><br><ul><li>  O in√≠cio e o fim do fakap podem ser analisados ‚Äã‚Äãautomaticamente.  Se voc√™ colocar carimbos de data e hora leg√≠veis por m√°quina, poder√° plotar a dura√ß√£o do fakap. </li><li>  O in√≠cio e o fim da investiga√ß√£o. </li><li>  Gatilho  Configure uma lista suspensa de gatilhos, √© mais conveniente. </li><li>  Como observado. </li><li>  Danos quantitativos e qualitativos. </li><li>  Equipes e servi√ßos afetados. </li></ul><br>  Todos os dados de campos especiais permitem entender como sua infraestrutura funciona. <br><br>  Um exemplo de nosso relat√≥rio completo de incidentes. <br><br><img src="https://habrastorage.org/webt/2r/dk/c3/2rdkc3flemuokdisdblhr6ls0cg.jpeg"><br><br>  Os campos da coluna da direita s√£o apenas preenchidos atrav√©s da sele√ß√£o nas listas suspensas. <br><br><h3>  Re√∫na uma equipe de engenheiros que se preocupam com a qualidade </h3><br>  Para obter relat√≥rios que ajudar√£o voc√™ a entender como desenvolver sua infraestrutura, voc√™ precisar√° de pessoas que se preocupem com a qualidade de seus servi√ßos.  N√£o necessariamente ser√£o os engenheiros envolvidos na an√°lise em tempo integral apenas post-mortem.  √â importante que essas pessoas estejam muito preocupadas com o que est√° acontecendo.  De tempos em tempos eles se re√∫nem, analisam toda a massa de incidentes, escrevem grandes artigos e trazem benef√≠cios - feche o c√≠rculo de feedback. <br><br>  Nossa equipe se chama Q-team - da palavra "Quality".  Possui 3 pessoas - um dos engenheiros mais talentosos da empresa que trabalha em infraestrutura. <br><br><h2>  Total </h2><br>  <strong>Leia o guru - os artigos de</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">John Allspaw</a> e os livros de gerenciamento de incidentes: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Engenharia de Confiabilidade do Site</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Processo PagerDuty Post-Mortem</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Atlassian Incident Handbook</a> . <br><br>  E quando voc√™ vier trabalhar amanh√£, <strong>d√™ os primeiros passos</strong> : <br><br><ul><li>  iniciar um projeto para fakaps no bugtracker no qual voc√™ realiza tarefas; </li><li>  use qualquer modelo - n√£o tente escrever o seu, use o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nosso</a> ou no Google no SRE; </li><li>  quando algo explodir, basta escrever. </li></ul><br>  Nesse momento em que voc√™ escreve o primeiro, o segundo e o terceiro relat√≥rios, voc√™ n√£o ter√° uma an√°lise bonita com colunas multicoloridas.  Mas, depois de um ano ou dois, quando os dados foram acumulados, voc√™ olha para tr√°s e agradece a si mesmo pela primeira etapa. <br><br><blockquote>  Esperamos que voc√™ se lembre e agrade√ßa a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Alexei</a> pela hist√≥ria dessa experi√™ncia.  E, por sua vez, tentaremos coletar novos relat√≥rios √∫teis no programa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DevOpsConf</a> , recomenda√ß√µes das quais voc√™ pode aplicar.  A confer√™ncia ser√° realizada de 30 a 1 de <strong>setembro de 2019</strong> , at√© 20 de agosto, ainda estamos aguardando inscri√ß√µes dos apoiadores do DevOps, mas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">12</a> j√° foram aprovadas, ou seja, a competi√ß√£o ser√° mais pr√≥xima do prazo. <br><br>  Se voc√™ deseja compartilhar sua experi√™ncia, decida-se e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">envie seus resumos</a> .  Se voc√™ deseja receber not√≠cias do programa, assine nosso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">canal de</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">boletim</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">telegrama</a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt458924/">https://habr.com/ru/post/pt458924/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt458914/index.html">O que (n√£o) voc√™ precisa saber para criar jogos no Unity</a></li>
<li><a href="../pt458916/index.html">Sob o cap√¥ do React. Escrevemos nossa implementa√ß√£o do zero</a></li>
<li><a href="../pt458918/index.html">O que voc√™ pode aprender com o design de jogos hiper-casuais</a></li>
<li><a href="../pt458920/index.html">Confer√™ncia para f√£s do DevOps</a></li>
<li><a href="../pt458922/index.html">Como passar do ESXi para o KVM / LXD e n√£o enlouquecer</a></li>
<li><a href="../pt458926/index.html">Trag√©dia n√£o vem sozinha</a></li>
<li><a href="../pt458928/index.html">XLNet vs BERT</a></li>
<li><a href="../pt458930/index.html">Como os alunos da Perm chegaram √†s finais do campeonato internacional de an√°lise de dados da Data Mining Cup 2019</a></li>
<li><a href="../pt458932/index.html">Yota - ou como voc√™ pode descobrir tudo</a></li>
<li><a href="../pt458934/index.html">Implantando aplicativos em v√°rios clusters Kubernetes com o Helm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>