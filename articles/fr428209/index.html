<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ò¢Ô∏è üî≥ ‚úçüèª Livre de recettes du d√©veloppeur: recettes de conception pilot√©e par domaine (partie 2, structure et interaction) üìè üë®üèΩ‚Äçüî¨ üé†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√©sentation 


 Dans le premier article, nous avons soulign√© la port√©e des pratiques indiqu√©es, pour quels projets elles peuvent √™tre appliqu√©es et p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Livre de recettes du d√©veloppeur: recettes de conception pilot√©e par domaine (partie 2, structure et interaction)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428209/"><p><img src="https://habrastorage.org/webt/fr/vw/on/frvwonyhe7k6st_x65v67hcbrcs.jpeg" alt="ddd-header"></p><br><h1 id="vvedenie">  Pr√©sentation </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dans le premier article,</a> nous avons soulign√© la port√©e des pratiques indiqu√©es, pour quels projets elles peuvent √™tre appliqu√©es et pour lesquelles elles ne devraient pas l'√™tre. </p><br><p> Dans cet article, je voudrais donner un bref aper√ßu des principes de base de DDD, ainsi que partager mon exp√©rience personnelle avec leur application.  Nous parlerons plus en d√©tail de la communication et des approches structurelles avec des exemples de leur mise en ≈ìuvre. </p><br><p>  Dans l'article suivant, j'√©crirai les combinaisons possibles des mod√®les de conception appliqu√©s en tenant compte de leur impl√©mentation, et finalement je donnerai un exemple d'impl√©mentation sp√©cifique d'un petit microservice. </p><a name="habracut"></a><br><h1 id="ddd">  DDD </h1><br><p>  Rappelez-vous la d√©finition pr√©c√©dente: </p><br><blockquote>  La conception pilot√©e par domaine (DDD) est une approche du d√©veloppement logiciel pour la satisfaction globale des besoins, en liant √©troitement la mise en ≈ìuvre aux principaux mod√®les commerciaux en constante √©volution. </blockquote><p>  Le livre de r√©f√©rence qui d√©crit la pratique de la construction de syst√®mes complexes est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Domain Driven Dedign</a> (Big Blue Book) d'Eric Evans.  Si vous lisez un article de synth√®se sur ce sujet, vous le savez d√©j√†.  Au moment o√π vous utilisez DDD dans la pratique, vous devrez le lire.  Ce n'est pas le livre le plus facile √† lire: </p><br><blockquote>  La source canonique de DDD est le livre d'Eric Evans.  Ce n'est pas le plus facile √† lire dans la litt√©rature sur les logiciels, mais c'est l'un de ces livres qui rembourse amplement un investissement substantiel. <br><br>  Martin Fowler: 15 janvier 2014 </blockquote><p>  Si vous faites d√©filer le contenu du livre, il vous semblera pas tout √† fait structur√©.  Mais la carte nous aidera. <br><img src="https://habrastorage.org/webt/oh/5e/tj/oh5etj1mf-uvet2bdyn7y1olj8k.png" alt="Carte ddd"></p><br><p>  Sur la carte figurent les pratiques que nous examinerons aujourd'hui. </p><br><p>  La port√©e des pratiques couvertes dans le livre est √©norme.  La port√©e des pratiques qui peuvent √™tre appliqu√©es en dehors de ce livre est encore plus grande.  Avant de mettre en service au moins une partie d'entre eux, identifiez vos objectifs.  Je vais donner mon propre exemple. </p><br><ul><li>  Augmentez la productivit√©. </li><li>  √âcrivez du code compr√©hensible. </li><li>  Mise √† l'√©chelle au niveau du d√©veloppement logiciel. </li></ul><br><h2 id="edinyy-yazyk">  Langue unique </h2><br><p>  Le d√©veloppement de logiciels conduit rarement √† la cr√©ation de quelque chose de nouveau, en r√®gle g√©n√©rale, il s'agit d'une simulation de quelque chose d'existant. </p><br><blockquote>  Un mod√®le est une repr√©sentation d'un objet r√©el, qui comprend uniquement les propri√©t√©s et fonctions n√©cessaires. </blockquote><p>  Nous ne pouvons pas cr√©er un produit logiciel qui couvre tout le domaine.  Il est possible de n'en reproduire que la partie qui reproduira les fonctionnalit√©s n√©cessaires. </p><br><p>  Un bon exemple de mod√®le serait une carte topographique.  C'est un mod√®le de terrain.  La carte ne contient pas de prairies de champs et de rivi√®res, elle ne refl√®te que l'emplacement des objets r√©els les uns par rapport aux autres. </p><br><p>  Pour construire un mod√®le clair et clair pour tout le monde, vous devez parler la m√™me langue.  Non seulement Eric Evans nous le dit, mais aussi le bon sens.  Si les programmeurs utilisent leurs termes et commercialisent leur propre ¬´argot¬ª, les premiers ne comprendront tout simplement pas ce qui doit √™tre fait.  Dans ce cas, les entreprises ne pourront pas r√©aliser le co√ªt r√©el du d√©veloppement de l'une ou l'autre ¬´fonctionnalit√©¬ª.  Combien de fois avez-vous entendu: "Oui, c'est juste un bouton √† ajouter"? </p><br><p>  Votre objectif en tant que concepteur de syst√®me devrait √™tre d'obtenir la meilleure compr√©hension mutuelle de toute l'√©quipe.  Comment y parvenir?  Commencez √† parler.  Si les gens commencent √† communiquer dans un groupe proche, ils ont un certain ensemble de termes g√©n√©ralement accept√©s.  Dans diff√©rentes entreprises, le processus d'introduction d'un langage commun est susceptible d'√™tre diff√©rent.  Il peut s'agir soit d'une d√©cision volontaire ou d'une proc√©dure d√©mocratique.  La langue peut √™tre indiqu√©e explicitement, et elle n'est pas entr√©e explicitement, auquel cas ils commencent simplement √† la parler.  Une bonne technique pour introduire un langage commun est la documentation g√©n√©rale. </p><br><h3 id="kak-vesti-dokumentaciyu-proekta">  Comment conserver la documentation du projet </h3><br><ol><li>  Toute communication entre l'entreprise et le d√©veloppement devrait am√©liorer votre mod√®le. </li><li>  Apr√®s la r√©union, enregistrez le r√©sultat sous forme de documentation (artefact Scrum) et montrez cette documentation √† tous les participants au processus de d√©veloppement. </li><li>  Utilisez une seule langue dans la documentation. </li><li>  Le plus important: ne perdez pas de temps sur la documentation.  Vous devez encore √©crire du code, et la documentation sera r√©√©crite plusieurs fois, d√©penser des ressources co√ªte cher.  Au lieu de jouer longtemps avec l'application de cartographie UML, utilisez une serviette, un stylo et un appareil photo sur votre t√©l√©phone. </li><li>  La documentation requiert de la discipline, vous ne pouvez pas l'√©crire de temps en temps. </li><li>  S√©parez la documentation: <br><ul><li> Commentaires dans le code - d√©crivez des moments incompr√©hensibles directement dans le code, laissez <code>#ODO:</code> (supprimez lors de la fusion du code dans master).  Exprimez votre opinion dans les commentaires, par exemple, vous devez utiliser l'une ou l'autre b√©quille lorsque vous travaillez avec du code legasy. </li><li>  Les commentaires sur le projet <code>README.md</code> dans le r√©pertoire racine de votre projet doivent contenir des informations techniques: comment d√©marrer le projet, comment ex√©cuter des tests, etc.  C'est √©galement une bonne id√©e d'obtenir une carte o√π vous avez tous les projets et sur quels serveurs ils s'ex√©cutent.  Enregistrez s√©par√©ment tous les accords accept√©s. </li><li>  Et surtout, la base de connaissances.  Une collection de documents d√©crivant les processus commerciaux, c'est la partie des documents qui est disponible pour vous et pour l'entreprise. </li></ul></li><li>  La principale erreur de ceux qui √©crivent de la documentation est la redondance.  N'essayez pas de tout couvrir et de tout, ne transmettez que le sens g√©n√©ral.  La documentation doit compl√©ter votre projet, mais ne doit en aucun cas le remplacer.  N'√©crivez pas tous les termes qui sont seulement ambigus.  Si une d√©finition prend plus de deux phrases, c'est une mauvaise d√©finition. </li></ol><br><p>  Exemple de documentation: </p><br><pre> <code class="markdown hljs"><span class="hljs-section"><span class="hljs-section">#         . # :  : -    - email -  ## : ###        ,     email  ,    1  (      email  ). ###           .          email . ###  email  email     .    ,    email.   . ###       ,     ,    .   . ###      email,    ,       .   2 . ###                  .    ,     ,             .</span></span></code> </pre><br><p>  Notez que dans cet exemple nous n'avons pas sp√©cifi√© de dictionnaire explicite, n√©anmoins nous avons fix√© le concept d' <em>Utilisateur</em> , <em>Autorisation</em> , <em>Enregistrement</em> .  La r√©daction de cette documentation ne prendra pas plus de 20 minutes √† l'expert. </p><br><p>  Pour une personne qui n'est pas experte dans le domaine, le processus de r√©daction de la documentation est per√ßu comme quelque chose de compliqu√©.  Il est n√©cessaire de s√©parer la collecte des connaissances et l'enregistrement des connaissances collect√©es. <code> !=  +  .</code> </p><br><blockquote>  "Ce que vous appelez l'univers", a d√©clar√© le quatri√®me, "est, en fait, une accumulation de mondes qui, comme la peau d'un arc, sont les uns au-dessus des autres et sont progressivement s√©par√©s les uns des autres." <br><br>  - Exceptionnellement clairement indiqu√©!  - admir√© les abderites.  - √âtonnamment clair!  "Ils pensaient comprendre le philosophe, car ils savaient tr√®s bien ce qu'√©tait l'oignon." <br><br>  Histoire d'Aberdeen, Cristov Martin Wieland </blockquote><br><h2 id="ogranichennyy-konteksty-i-domeny">  Contextes et domaines limit√©s </h2><br><p>  Imaginez que nous agissions en tant que concepteur d'une startup progressive.  Nous aimons tous la pizza refroidie, maudissant les coursiers et remplissant des formulaires sur le site pendant des heures.  Par cons√©quent, nous avons cr√©√© une merveilleuse startup ¬´Quatre tortues et un rat¬ª: </p><br><ul><li>  Il y a un site sur lequel les pizzerias sont enregistr√©es et affichent leurs plats r√©els. </li><li>  Ces pizzerias n'ont pas leur propre service de messagerie. </li><li>  Il y a des clients qui ne peuvent pas atteindre la pizzeria, mais ils sont pr√™ts √† passer une commande via le site Web ou l'application mobile. </li><li>  ¬´Fonction¬ª tueur: les courriers ne sont pas du personnel sp√©cialement embauch√©, mais des gens ordinaires qui se sont inscrits via l'application mobile </li><li>  Les courriers re√ßoivent des ordres, apr√®s leur ex√©cution ils re√ßoivent le paiement du travail effectu√©. </li><li>  Il faut plus de temps pour attendre de tels courriers, mais la livraison, et par cons√©quent la pizza, est moins ch√®re. </li></ul><br><p>  Rappelons la documentation que nous avons d√©crite dans le chapitre pr√©c√©dent.  L√†, dans notre dictionnaire unique, le terme <em>enregistrement a √©t√© utilis√©</em> .  Mais dans ce projet, nous en avons plusieurs: </p><br><ul><li>  Inscription client </li><li>  Inscription √† la pizzeria </li><li>  Inscription par messagerie </li><li>  Enregistrement de la commande </li></ul><br><p>  Une langue unifi√©e appartient √† un contexte limit√©.  Le domaine de la documentation ci-dessus est ¬´Syst√®me d'autorisation¬ª.  Essayons d'allouer des domaines pour notre startup. </p><br><p>  Mais avant de commencer, regardons un peu la terminologie sur ce qu'est un domaine et ce qu'est un contexte limit√©. </p><br><blockquote>  Domaine (Domain) - une repr√©sentation d'une structure d'entreprise r√©elle qui r√©sout un probl√®me sp√©cifique. </blockquote><p>  Par exemple: syst√®me logistique, syst√®me de paiement, syst√®me d'autorisation, syst√®me de gestion des commandes. </p><br><p>  Le domaine est divis√© en sous-domaines, qui d√©crivent des structures plus petites, par exemple: un panier de commandes, un syst√®me de construction de routes. </p><br><p>  Chaque domaine a un domaine de responsabilit√© limit√© - des fonctionnalit√©s limit√©es. </p><br><blockquote>  Contexte d√©limit√© - un ensemble de restrictions de domaine qui aide le domaine √† se concentrer sur une seule t√¢che pour sa meilleure solution. </blockquote><p>  J'aime pr√©senter ce terme comme une telle abstraction.  Un domaine est un cercle.  Un contexte restreint est un cercle. </p><br><p><img src="https://habrastorage.org/webt/nf/nm/jz/nfnmjzlgui85mvfatppogqv-kdq.jpeg" alt="Contexte de domaine"></p><br><p>  M√™me dans la terminologie DDD, le noyau est allou√©. </p><br><blockquote>  Le c≈ìur (domaine principal) - le domaine le plus important qui caract√©rise le plus votre entreprise. </blockquote><p>  Ainsi, les domaines du projet "Quatre tortues et un rat": </p><br><p>  <strong>Travailler avec une pizzeria</strong> (Pizzarias) </p><br><p>  <em>Contexte</em> : b2b tout ce qui concerne les pizzerias </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  enregistrement de nouvelles pizzerias </li><li>  ajouter un assortiment </li><li>  mise √† jour de l'√©tat de la disponibilit√© d'un produit </li></ul><br><p>  <strong>Travailler avec le client</strong> (Clients) </p><br><p>  <em>Contexte</em> : b2c, tout ce qui concerne le travail avec les pizzerias </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  voir l'assortiment </li><li>  mat√©riel d'information </li></ul><br><p>  <strong>Travailler avec des coursiers</strong> (syst√®me de livraison) </p><br><p>  <em>Contexte</em> : b2e, tout ce qui concerne le travail avec les coursiers </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  inscription par messagerie </li><li>  affectation des t√¢ches </li><li>  enregistrement des demandes de retrait des fonds gagn√©s par le courrier. </li></ul><br><p>  Syst√®me de commande </p><br><p>  <em>Contexte</em> : noyau.  Vous permet de coordonner tous les domaines individuels, offrant un cycle complet de la r√©ception d'une commande √† la livraison de pizza √† l'utilisateur.  Ce n'est pas un artiste, mais joue le r√¥le d'un chef d'orchestre. </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  acceptation de la commande </li><li>  ex√©cution d'ordres </li><li>  suivi de l'√©tat des commandes </li></ul><br><p>  <strong>Syst√®me de r√®glement</strong> (facturation) </p><br><p>  <em>Contexte</em> : contient toutes les transactions financi√®res.  Il fournit une interaction avec le centre de traitement. </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  accepter de l'argent pour les commandes </li><li>  donner de l'argent aux coursiers pour le travail accompli </li></ul><br><p>  <strong>Syst√®me de statistiques</strong> </p><br><p>  <em>Contexte</em> : La collecte et le traitement (non la publication) d'informations analytiques. </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  statistiques sur les fonds </li><li>  statistiques d'application </li></ul><br><p>  <strong>Syst√®me de gestion</strong> (panneau de <strong>gestion</strong> ) </p><br><p>  <em>Contexte</em> : La publication d'informations analytiques.  Bo√Æte √† outils des d√©cisions de gestion. </p><br><ul><li>  analyse bas√©e sur les statistiques collect√©es </li><li>  pr√©-mod√©ration des paiements aux coursiers </li></ul><br><p>  En fonction des domaines, cartographions-les. </p><br><blockquote>  Une carte de domaine (Context map) est un outil graphique qui vous permet de d√©crire les relations entre les domaines individuels. </blockquote><p><img src="https://habrastorage.org/webt/p1/ks/po/p1kspot2qqut90gzcn1b9fhxyn8.png" alt="Context-map"></p><br><p>  La carte montre les liens entre les domaines.  Cette carte est tr√®s superficielle, mais le sujet n'est pas bien compris.  Ceci est la premi√®re esquisse, r√©√©criture dont vous obtiendrez le r√©sultat attendu. </p><br><p>  La chose la plus importante sur la carte est que nous voyons des connexions entre les domaines.  Une telle structure s'int√®gre tr√®s bien dans l'architecture de microservices: </p><br><blockquote>  Le principe principal de l'architecture des microservices: faible connectivit√© et forte adh√©rence. </blockquote><p>  Ce principe est donn√© dans le livre de Sam Newman - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cr√©ation de microservices</a> , c'est le deuxi√®me livre que vous devrez lire pour commencer √† utiliser concr√®tement les approches d√©crites dans cet article.  Ce que cela signifie: les domaines doivent √™tre faiblement coupl√©s, mais √©troitement li√©s en interne. </p><br><p>  La traduction de ces termes est tir√©e de la traduction officielle russe et refl√®te peut-√™tre mal le sens transmis.  Dans les termes originaux, cela ressemble √†: faible couplage (connectivit√©, engagement, adh√©rence, conjugaison), haute coh√©sion (connectivit√©, r√©sistance). </p><br><h2 id="praktika-realizacii-domennogo-razdelenie">  Pratique de mise en ≈ìuvre du partage de domaine </h2><br><p>  Je voudrais partager mon exp√©rience personnelle - un ensemble de d√©cisions √©clair√©es.  Je ne vous invite pas √† utiliser ces solutions.  Mais ils peuvent √™tre un bon choix si vous ne savez pas par o√π commencer.  Avec une exp√©rience personnelle, les outils seront davantage adapt√©s √† vos besoins. </p><br><p>  Les grands principes qui nous ont guid√©s: </p><br><ul><li>  La simplicit√© de la solution.  Faites des choses complexes simples, pas simples compliqu√©es. </li><li>  Pragmatisme  Vous devez toujours regarder la situation et, en l‚Äôabsence de solution existante, en d√©velopper une nouvelle.  Essayez de tout caract√©riser, mais √©vitez le dogmatisme. </li><li>  Code! = Documentation.  Le code est des instructions pour la machine, la documentation est une instruction pour les personnes.  Pas besoin de les confondre et de les distribuer les uns apr√®s les autres. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SOLIDE</a> </li></ul><br><h3 id="kak-realizovat-domeny">  Comment impl√©menter des domaines? </h3><br><p>  Il est tr√®s pratique de s√©lectionner des domaines en tant que microservices s√©par√©s. </p><br><blockquote>  Les microservices sont une application distincte qui impl√©mente la logique d'un domaine. </blockquote><p>  Dans le d√©veloppement DDD, le principe d'allocation d'un microservice dans une application distincte sera un contexte limit√©.  Cela ne remet pas en cause le principe technique de la s√©paration des services (si cela est d√ª √† la n√©cessit√© d'assurer des performances √©lev√©es).  Mais le principe contextuel sera dominant et contraignant. </p><br><h3 id="kak-vydelit-svyazi-mezhdu-domenami">  Comment mettre en √©vidence la relation entre les domaines? </h3><br><p>  Les relations entre les domaines sont toujours une API.  Il peut s'agir d'API json RESTful, gRPC, AMPQ.  Dans le cadre de cet article, nous ne comparerons pas un protocole √† un autre et mettrons en avant leurs avantages et inconv√©nients, chacun ayant son propre champ d'application.  Mais tout de m√™me, arr√™tons-nous sur les recommandations g√©n√©rales: </p><br><p>  <strong>Soyez flexible dans le choix d'un protocole et rigide dans l'uniformit√© de sa mise en ≈ìuvre.</strong> </p><br><p>  Choisissez un protocole pour chaque paire de domaines individuellement, n'essayez pas d'utiliser http partout, vous aurez peut-√™tre besoin de files d'attente asynchrones quelque part et les avantages d'AMPQ deviendront √©vidents pour vous.  N'ignorez pas cette opportunit√© car vous avez RESTful partout. </p><br><p>  En revanche, si vous impl√©mentez RESTful json, utilisez une norme de structuration des donn√©es.  Vous pouvez prendre par exemple jsonapi ou openapi.  Si pour une raison quelconque, des solutions toutes faites ne vous conviennent pas et que vous sentez que vous pouvez d√©velopper votre norme, la d√©crire et l'utiliser.  Mais utilisez-le partout, ne reproduisez pas les normes "zoo".  Si vous devez communiquer avec un syst√®me externe o√π ils ne connaissent rien √† vos normes, √©crivez un adaptateur de microservice. </p><br><p><img src="https://habrastorage.org/webt/cz/ff/go/czffgobmp7v9lr2pzkjx0-3y5xq.png" alt="Adapt adaptateur"></p><br><h3 id="kak-realizovat-sabdomeny">  Comment impl√©menter des sous-domaines? </h3><br><p>  En tant que modules s√©par√©s dans un microservice. </p><br><blockquote>  Un module est une impl√©mentation d'un sous-domaine, en pla√ßant la logique dans un espace de noms distinct (espace de noms) au sein d'un microservice unique. </blockquote><p>  √Ä quoi tout cela ressemble-t-il?  Regardons un exemple.  Comme nous nous en souvenons, nous avons un domaine de syst√®me de livraison - ce domaine a trois sous-domaines: </p><br><ul><li>  inscription par messagerie </li><li>  √©mission de t√¢ches (t√¢ches) </li><li>  enregistrement des demandes de retrait des fonds gagn√©s par le courrier (retrait) </li><li>  v√©rifier que votre microservice fonctionne, outil technique auxiliaire (healt_checker) </li></ul><br><p>  Imaginez tout cela sous la forme d'une structure de dossiers: </p><br><pre> <code class="bash hljs">$ tree --dirsfirst delivery_system delivery_system ‚îú‚îÄ‚îÄ app/ ‚îÇ ‚îú‚îÄ‚îÄ health_checker/ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îú‚îÄ‚îÄ registrations/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ forms/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ interactor/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ validations/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îÇ ‚îú‚îÄ‚îÄ tasks ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ queries/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îÇ ‚îî‚îÄ‚îÄ withdrawals ‚îÇ ‚îú‚îÄ‚îÄ entities/ ‚îÇ ‚îú‚îÄ‚îÄ forms/ ‚îÇ ‚îú‚îÄ‚îÄ repositories/ ‚îÇ ‚îú‚îÄ‚îÄ interactor/ ‚îÇ ‚îú‚îÄ‚îÄ services/ ‚îÇ ‚îú‚îÄ‚îÄ validations/ ‚îÇ ‚îú‚îÄ‚îÄ endpoints.rb ‚îÇ ‚îî‚îÄ‚îÄ helpers.rb ‚îú‚îÄ‚îÄ config/ ‚îú‚îÄ‚îÄ db/ ‚îú‚îÄ‚îÄ docs/ ‚îú‚îÄ‚îÄ lib/ ‚îÇ ‚îú‚îÄ‚îÄ schemas/ ‚îÇ ‚îî‚îÄ‚îÄ values/ ‚îú‚îÄ‚îÄ public ‚îú‚îÄ‚îÄ specs ‚îú‚îÄ‚îÄ config.ru ‚îú‚îÄ‚îÄ Gemfile ‚îú‚îÄ‚îÄ Gemfile.lock ‚îú‚îÄ‚îÄ Rakefile ‚îî‚îÄ‚îÄ README.md</code> </pre> <br><p>  Chaque dossier dans le r√©pertoire <code>apps/</code> impl√©mente l'un ou l'autre sous-domaine, au sein de chaque domaine, il existe diff√©rents mod√®les: <code>entities</code> , <code>forms</code> , <code>services</code> , etc. Nous examinerons en d√©tail chacun des mod√®les appliqu√©s dans l'un des prochains articles. </p><br><p>  Chacun de ces mod√®les est impl√©ment√© dans l'espace de noms correspondant (espace de noms).  Par exemple, un formulaire pour cr√©er une demande de paiement √† un coursier: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrawal</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#   module Forms #  class Create end end end</span></span></span></span></code> </pre> <br><h3 id="kak-realizovat-svyazi-mezhdu-sabdomeny">  Comment impl√©menter la communication entre les sous-domaines? </h3><br><p>  Regardons un exemple sp√©cifique.  Nous avons un compte de messagerie: <code>Registrations::Entities::Account</code> .  Il fait r√©f√©rence au sous-domaine <code>Registrations</code> - car nous consid√©rons ce domaine non pas comme un processus d'enregistrement, mais plut√¥t comme un tableau de compte et un livre d'enregistrement, comme indiqu√© dans notre documentation commerciale. </p><br><p>  Nous avons deux <em>processus</em> dans l'ex√©cution desquels nous acc√©dons √† ce compte. </p><br><ul><li>  Cr√©er un compte (inscription) </li><li>  Cr√©ation d'une demande de retrait de fonds gagn√©s par un coursier (Wihtdrawal) </li></ul><br><p>  Comme nous le voyons, ces deux processus appartiennent √† des sous-domaines diff√©rents - Enregistrement et Wihtdrawal. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrwals</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateOrder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations::Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Dans le premier cas, un appel √† la classe sera impl√©ment√© via un appel √† <code>Entities::Account</code> .  Et dans le second cas, via un appel explicite √† <code>Registrations::Entities::Account</code> .  C'est-√†-dire  si nous sp√©cifions explicitement un sous-domaine, alors la classe provient d'un autre sous-domaine et nous indiquons donc clairement la connexion. </p><br><p>  Si la classe ne s'applique explicitement √† aucun des sous-domaines, il est logique de la d√©placer vers le dossier <code>lib/</code> .  En r√®gle g√©n√©rale, ce sont des classes qui impl√©mentent le mod√®le ¬´ValueObject¬ª.  Nous examinerons ce mod√®le plus en d√©tail dans l'un des articles suivants. </p><br><h2 id="realizaciya-cherez-model">  Mise en ≈ìuvre √† travers le mod√®le. </h2><br><p>  Pour citer Eric Evans: </p><br><blockquote>  Si l'architecture du programme, ou du moins une partie centrale de celui-ci, ne correspond pas √† la structure du mod√®le de domaine, alors un tel mod√®le est pratiquement inutile et le bon fonctionnement du programme doit √©galement √™tre remis en question.  Dans le m√™me temps, les relations trop complexes entre les mod√®les et les fonctions dans l'architecture logicielle sont difficiles √† comprendre et, en pratique, elles sont difficiles √† maintenir √† mesure que l'architecture change. </blockquote><p>  Rappelons l'exemple d'un bon mod√®le que j'ai d√©j√† cit√© au d√©but de cet article - une carte topographique.  Notre objectif est de pouvoir trouver rapidement la distance entre deux colonies.  Nous pourrions utiliser un tableau de r√©f√©rence montrant deux points entre les villes.  Et nous pouvons utiliser la carte.  L√† et l√†, nous obtenons le m√™me r√©sultat √† peu pr√®s en m√™me temps.  Mais la carte est plus compacte, elle affiche plus pr√©cis√©ment le sujet, elle est plus universelle.  La carte en tant que mod√®le est incroyablement expressive.  Et si nous la consid√©rons dans le cadre de cette t√¢che, alors mesurer la distance est plus pratique sur la carte que sur le territoire lui-m√™me, qu'elle refl√®te.  Un mod√®le qui refl√®te un domaine peut le surpasser dans certaines propri√©t√©s.  C'est vraiment incroyable. </p><br><p>  La mise en ≈ìuvre du mod√®le est toujours un processus cr√©atif avec des r√©sultats impr√©visibles.  La qualit√© de votre code n'est pas sa performance, ni sa complexit√©, c'est la simplicit√© et l'expressivit√©.  Am√©liorez-le gr√¢ce √† une refactorisation constante, rendez-le flexible et supprimez tout ce qui n'est pas n√©cessaire.  S√©parez la couche qui sera responsable de la logique m√©tier du mod√®le des couches dont le besoin est d√ª √† la mise en ≈ìuvre technique.  La fa√ßon dont nous avons r√©ussi √† le faire sera d√©crite plus loin. </p><br><hr><br><div class="spoiler">  <b class="spoiler_title">Sources d'inspiration</b> <div class="spoiler_text"><ul><li>  Conception orient√©e probl√®me, Eric J. Evans </li><li>  Cr√©ation de microservices, Sam Newman </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://gorodinski.com/blog/2013/04/29/sub-domains-and-bounded-contexts-in-domain-driven-design-ddd/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://martinfowler.com/bliki/BoundedContext.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://habr.com/post/316438/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://dotnetcodr.com/2015/08/06/domain-driven-design-with-web-api-revisited-part-1-introduction/</a> </li><li>  Histoire d'Aberdeen, Cristov Martin Wieland </li></ul><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428209/">https://habr.com/ru/post/fr428209/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428193/index.html">√Ä propos des tourn√©es</a></li>
<li><a href="../fr428197/index.html">Finances personnelles efficaces. Niveau 1</a></li>
<li><a href="../fr428201/index.html">Trous de taupe en JavaScript</a></li>
<li><a href="../fr428203/index.html">Nous regardons les graphiques: estimations et pr√©visions pour le march√© du cloud computing, donn√©es en 2018</a></li>
<li><a href="../fr428205/index.html">Lifehacks NaviHaka</a></li>
<li><a href="../fr428211/index.html">Le livre ¬´Architecture √©volutive. Soutien au changement continu "</a></li>
<li><a href="../fr428213/index.html">Comment interpr√©ter les pr√©dictions de mod√®le dans SHAP</a></li>
<li><a href="../fr428217/index.html">Millions d'appels vid√©o par jour ou ¬´Appelle maman!¬ª</a></li>
<li><a href="../fr428219/index.html">D'o√π est venue la pratique de la r√©installation massive de personnel qualifi√©?</a></li>
<li><a href="../fr428221/index.html">G√©n√©ration AI de visages r√©alistes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>