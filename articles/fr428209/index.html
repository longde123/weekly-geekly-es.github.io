<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â˜¢ï¸ ğŸ”³ âœğŸ» Livre de recettes du dÃ©veloppeur: recettes de conception pilotÃ©e par domaine (partie 2, structure et interaction) ğŸ“ ğŸ‘¨ğŸ½â€ğŸ”¬ ğŸ </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PrÃ©sentation 


 Dans le premier article, nous avons soulignÃ© la portÃ©e des pratiques indiquÃ©es, pour quels projets elles peuvent Ãªtre appliquÃ©es et p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Livre de recettes du dÃ©veloppeur: recettes de conception pilotÃ©e par domaine (partie 2, structure et interaction)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428209/"><p><img src="https://habrastorage.org/webt/fr/vw/on/frvwonyhe7k6st_x65v67hcbrcs.jpeg" alt="ddd-header"></p><br><h1 id="vvedenie">  PrÃ©sentation </h1><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dans le premier article,</a> nous avons soulignÃ© la portÃ©e des pratiques indiquÃ©es, pour quels projets elles peuvent Ãªtre appliquÃ©es et pour lesquelles elles ne devraient pas l'Ãªtre. </p><br><p> Dans cet article, je voudrais donner un bref aperÃ§u des principes de base de DDD, ainsi que partager mon expÃ©rience personnelle avec leur application.  Nous parlerons plus en dÃ©tail de la communication et des approches structurelles avec des exemples de leur mise en Å“uvre. </p><br><p>  Dans l'article suivant, j'Ã©crirai les combinaisons possibles des modÃ¨les de conception appliquÃ©s en tenant compte de leur implÃ©mentation, et finalement je donnerai un exemple d'implÃ©mentation spÃ©cifique d'un petit microservice. </p><a name="habracut"></a><br><h1 id="ddd">  DDD </h1><br><p>  Rappelez-vous la dÃ©finition prÃ©cÃ©dente: </p><br><blockquote>  La conception pilotÃ©e par domaine (DDD) est une approche du dÃ©veloppement logiciel pour la satisfaction globale des besoins, en liant Ã©troitement la mise en Å“uvre aux principaux modÃ¨les commerciaux en constante Ã©volution. </blockquote><p>  Le livre de rÃ©fÃ©rence qui dÃ©crit la pratique de la construction de systÃ¨mes complexes est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Domain Driven Dedign</a> (Big Blue Book) d'Eric Evans.  Si vous lisez un article de synthÃ¨se sur ce sujet, vous le savez dÃ©jÃ .  Au moment oÃ¹ vous utilisez DDD dans la pratique, vous devrez le lire.  Ce n'est pas le livre le plus facile Ã  lire: </p><br><blockquote>  La source canonique de DDD est le livre d'Eric Evans.  Ce n'est pas le plus facile Ã  lire dans la littÃ©rature sur les logiciels, mais c'est l'un de ces livres qui rembourse amplement un investissement substantiel. <br><br>  Martin Fowler: 15 janvier 2014 </blockquote><p>  Si vous faites dÃ©filer le contenu du livre, il vous semblera pas tout Ã  fait structurÃ©.  Mais la carte nous aidera. <br><img src="https://habrastorage.org/webt/oh/5e/tj/oh5etj1mf-uvet2bdyn7y1olj8k.png" alt="Carte ddd"></p><br><p>  Sur la carte figurent les pratiques que nous examinerons aujourd'hui. </p><br><p>  La portÃ©e des pratiques couvertes dans le livre est Ã©norme.  La portÃ©e des pratiques qui peuvent Ãªtre appliquÃ©es en dehors de ce livre est encore plus grande.  Avant de mettre en service au moins une partie d'entre eux, identifiez vos objectifs.  Je vais donner mon propre exemple. </p><br><ul><li>  Augmentez la productivitÃ©. </li><li>  Ã‰crivez du code comprÃ©hensible. </li><li>  Mise Ã  l'Ã©chelle au niveau du dÃ©veloppement logiciel. </li></ul><br><h2 id="edinyy-yazyk">  Langue unique </h2><br><p>  Le dÃ©veloppement de logiciels conduit rarement Ã  la crÃ©ation de quelque chose de nouveau, en rÃ¨gle gÃ©nÃ©rale, il s'agit d'une simulation de quelque chose d'existant. </p><br><blockquote>  Un modÃ¨le est une reprÃ©sentation d'un objet rÃ©el, qui comprend uniquement les propriÃ©tÃ©s et fonctions nÃ©cessaires. </blockquote><p>  Nous ne pouvons pas crÃ©er un produit logiciel qui couvre tout le domaine.  Il est possible de n'en reproduire que la partie qui reproduira les fonctionnalitÃ©s nÃ©cessaires. </p><br><p>  Un bon exemple de modÃ¨le serait une carte topographique.  C'est un modÃ¨le de terrain.  La carte ne contient pas de prairies de champs et de riviÃ¨res, elle ne reflÃ¨te que l'emplacement des objets rÃ©els les uns par rapport aux autres. </p><br><p>  Pour construire un modÃ¨le clair et clair pour tout le monde, vous devez parler la mÃªme langue.  Non seulement Eric Evans nous le dit, mais aussi le bon sens.  Si les programmeurs utilisent leurs termes et commercialisent leur propre Â«argotÂ», les premiers ne comprendront tout simplement pas ce qui doit Ãªtre fait.  Dans ce cas, les entreprises ne pourront pas rÃ©aliser le coÃ»t rÃ©el du dÃ©veloppement de l'une ou l'autre Â«fonctionnalitÃ©Â».  Combien de fois avez-vous entendu: "Oui, c'est juste un bouton Ã  ajouter"? </p><br><p>  Votre objectif en tant que concepteur de systÃ¨me devrait Ãªtre d'obtenir la meilleure comprÃ©hension mutuelle de toute l'Ã©quipe.  Comment y parvenir?  Commencez Ã  parler.  Si les gens commencent Ã  communiquer dans un groupe proche, ils ont un certain ensemble de termes gÃ©nÃ©ralement acceptÃ©s.  Dans diffÃ©rentes entreprises, le processus d'introduction d'un langage commun est susceptible d'Ãªtre diffÃ©rent.  Il peut s'agir soit d'une dÃ©cision volontaire ou d'une procÃ©dure dÃ©mocratique.  La langue peut Ãªtre indiquÃ©e explicitement, et elle n'est pas entrÃ©e explicitement, auquel cas ils commencent simplement Ã  la parler.  Une bonne technique pour introduire un langage commun est la documentation gÃ©nÃ©rale. </p><br><h3 id="kak-vesti-dokumentaciyu-proekta">  Comment conserver la documentation du projet </h3><br><ol><li>  Toute communication entre l'entreprise et le dÃ©veloppement devrait amÃ©liorer votre modÃ¨le. </li><li>  AprÃ¨s la rÃ©union, enregistrez le rÃ©sultat sous forme de documentation (artefact Scrum) et montrez cette documentation Ã  tous les participants au processus de dÃ©veloppement. </li><li>  Utilisez une seule langue dans la documentation. </li><li>  Le plus important: ne perdez pas de temps sur la documentation.  Vous devez encore Ã©crire du code, et la documentation sera rÃ©Ã©crite plusieurs fois, dÃ©penser des ressources coÃ»te cher.  Au lieu de jouer longtemps avec l'application de cartographie UML, utilisez une serviette, un stylo et un appareil photo sur votre tÃ©lÃ©phone. </li><li>  La documentation requiert de la discipline, vous ne pouvez pas l'Ã©crire de temps en temps. </li><li>  SÃ©parez la documentation: <br><ul><li> Commentaires dans le code - dÃ©crivez des moments incomprÃ©hensibles directement dans le code, laissez <code>#ODO:</code> (supprimez lors de la fusion du code dans master).  Exprimez votre opinion dans les commentaires, par exemple, vous devez utiliser l'une ou l'autre bÃ©quille lorsque vous travaillez avec du code legasy. </li><li>  Les commentaires sur le projet <code>README.md</code> dans le rÃ©pertoire racine de votre projet doivent contenir des informations techniques: comment dÃ©marrer le projet, comment exÃ©cuter des tests, etc.  C'est Ã©galement une bonne idÃ©e d'obtenir une carte oÃ¹ vous avez tous les projets et sur quels serveurs ils s'exÃ©cutent.  Enregistrez sÃ©parÃ©ment tous les accords acceptÃ©s. </li><li>  Et surtout, la base de connaissances.  Une collection de documents dÃ©crivant les processus commerciaux, c'est la partie des documents qui est disponible pour vous et pour l'entreprise. </li></ul></li><li>  La principale erreur de ceux qui Ã©crivent de la documentation est la redondance.  N'essayez pas de tout couvrir et de tout, ne transmettez que le sens gÃ©nÃ©ral.  La documentation doit complÃ©ter votre projet, mais ne doit en aucun cas le remplacer.  N'Ã©crivez pas tous les termes qui sont seulement ambigus.  Si une dÃ©finition prend plus de deux phrases, c'est une mauvaise dÃ©finition. </li></ol><br><p>  Exemple de documentation: </p><br><pre> <code class="markdown hljs"><span class="hljs-section"><span class="hljs-section">#         . # :  : -    - email -  ## : ###        ,     email  ,    1  (      email  ). ###           .          email . ###  email  email     .    ,    email.   . ###       ,     ,    .   . ###      email,    ,       .   2 . ###                  .    ,     ,             .</span></span></code> </pre><br><p>  Notez que dans cet exemple nous n'avons pas spÃ©cifiÃ© de dictionnaire explicite, nÃ©anmoins nous avons fixÃ© le concept d' <em>Utilisateur</em> , <em>Autorisation</em> , <em>Enregistrement</em> .  La rÃ©daction de cette documentation ne prendra pas plus de 20 minutes Ã  l'expert. </p><br><p>  Pour une personne qui n'est pas experte dans le domaine, le processus de rÃ©daction de la documentation est perÃ§u comme quelque chose de compliquÃ©.  Il est nÃ©cessaire de sÃ©parer la collecte des connaissances et l'enregistrement des connaissances collectÃ©es. <code> !=  +  .</code> </p><br><blockquote>  "Ce que vous appelez l'univers", a dÃ©clarÃ© le quatriÃ¨me, "est, en fait, une accumulation de mondes qui, comme la peau d'un arc, sont les uns au-dessus des autres et sont progressivement sÃ©parÃ©s les uns des autres." <br><br>  - Exceptionnellement clairement indiquÃ©!  - admirÃ© les abderites.  - Ã‰tonnamment clair!  "Ils pensaient comprendre le philosophe, car ils savaient trÃ¨s bien ce qu'Ã©tait l'oignon." <br><br>  Histoire d'Aberdeen, Cristov Martin Wieland </blockquote><br><h2 id="ogranichennyy-konteksty-i-domeny">  Contextes et domaines limitÃ©s </h2><br><p>  Imaginez que nous agissions en tant que concepteur d'une startup progressive.  Nous aimons tous la pizza refroidie, maudissant les coursiers et remplissant des formulaires sur le site pendant des heures.  Par consÃ©quent, nous avons crÃ©Ã© une merveilleuse startup Â«Quatre tortues et un ratÂ»: </p><br><ul><li>  Il y a un site sur lequel les pizzerias sont enregistrÃ©es et affichent leurs plats rÃ©els. </li><li>  Ces pizzerias n'ont pas leur propre service de messagerie. </li><li>  Il y a des clients qui ne peuvent pas atteindre la pizzeria, mais ils sont prÃªts Ã  passer une commande via le site Web ou l'application mobile. </li><li>  Â«FonctionÂ» tueur: les courriers ne sont pas du personnel spÃ©cialement embauchÃ©, mais des gens ordinaires qui se sont inscrits via l'application mobile </li><li>  Les courriers reÃ§oivent des ordres, aprÃ¨s leur exÃ©cution ils reÃ§oivent le paiement du travail effectuÃ©. </li><li>  Il faut plus de temps pour attendre de tels courriers, mais la livraison, et par consÃ©quent la pizza, est moins chÃ¨re. </li></ul><br><p>  Rappelons la documentation que nous avons dÃ©crite dans le chapitre prÃ©cÃ©dent.  LÃ , dans notre dictionnaire unique, le terme <em>enregistrement a Ã©tÃ© utilisÃ©</em> .  Mais dans ce projet, nous en avons plusieurs: </p><br><ul><li>  Inscription client </li><li>  Inscription Ã  la pizzeria </li><li>  Inscription par messagerie </li><li>  Enregistrement de la commande </li></ul><br><p>  Une langue unifiÃ©e appartient Ã  un contexte limitÃ©.  Le domaine de la documentation ci-dessus est Â«SystÃ¨me d'autorisationÂ».  Essayons d'allouer des domaines pour notre startup. </p><br><p>  Mais avant de commencer, regardons un peu la terminologie sur ce qu'est un domaine et ce qu'est un contexte limitÃ©. </p><br><blockquote>  Domaine (Domain) - une reprÃ©sentation d'une structure d'entreprise rÃ©elle qui rÃ©sout un problÃ¨me spÃ©cifique. </blockquote><p>  Par exemple: systÃ¨me logistique, systÃ¨me de paiement, systÃ¨me d'autorisation, systÃ¨me de gestion des commandes. </p><br><p>  Le domaine est divisÃ© en sous-domaines, qui dÃ©crivent des structures plus petites, par exemple: un panier de commandes, un systÃ¨me de construction de routes. </p><br><p>  Chaque domaine a un domaine de responsabilitÃ© limitÃ© - des fonctionnalitÃ©s limitÃ©es. </p><br><blockquote>  Contexte dÃ©limitÃ© - un ensemble de restrictions de domaine qui aide le domaine Ã  se concentrer sur une seule tÃ¢che pour sa meilleure solution. </blockquote><p>  J'aime prÃ©senter ce terme comme une telle abstraction.  Un domaine est un cercle.  Un contexte restreint est un cercle. </p><br><p><img src="https://habrastorage.org/webt/nf/nm/jz/nfnmjzlgui85mvfatppogqv-kdq.jpeg" alt="Contexte de domaine"></p><br><p>  MÃªme dans la terminologie DDD, le noyau est allouÃ©. </p><br><blockquote>  Le cÅ“ur (domaine principal) - le domaine le plus important qui caractÃ©rise le plus votre entreprise. </blockquote><p>  Ainsi, les domaines du projet "Quatre tortues et un rat": </p><br><p>  <strong>Travailler avec une pizzeria</strong> (Pizzarias) </p><br><p>  <em>Contexte</em> : b2b tout ce qui concerne les pizzerias </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  enregistrement de nouvelles pizzerias </li><li>  ajouter un assortiment </li><li>  mise Ã  jour de l'Ã©tat de la disponibilitÃ© d'un produit </li></ul><br><p>  <strong>Travailler avec le client</strong> (Clients) </p><br><p>  <em>Contexte</em> : b2c, tout ce qui concerne le travail avec les pizzerias </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  voir l'assortiment </li><li>  matÃ©riel d'information </li></ul><br><p>  <strong>Travailler avec des coursiers</strong> (systÃ¨me de livraison) </p><br><p>  <em>Contexte</em> : b2e, tout ce qui concerne le travail avec les coursiers </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  inscription par messagerie </li><li>  affectation des tÃ¢ches </li><li>  enregistrement des demandes de retrait des fonds gagnÃ©s par le courrier. </li></ul><br><p>  SystÃ¨me de commande </p><br><p>  <em>Contexte</em> : noyau.  Vous permet de coordonner tous les domaines individuels, offrant un cycle complet de la rÃ©ception d'une commande Ã  la livraison de pizza Ã  l'utilisateur.  Ce n'est pas un artiste, mais joue le rÃ´le d'un chef d'orchestre. </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  acceptation de la commande </li><li>  exÃ©cution d'ordres </li><li>  suivi de l'Ã©tat des commandes </li></ul><br><p>  <strong>SystÃ¨me de rÃ¨glement</strong> (facturation) </p><br><p>  <em>Contexte</em> : contient toutes les transactions financiÃ¨res.  Il fournit une interaction avec le centre de traitement. </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  accepter de l'argent pour les commandes </li><li>  donner de l'argent aux coursiers pour le travail accompli </li></ul><br><p>  <strong>SystÃ¨me de statistiques</strong> </p><br><p>  <em>Contexte</em> : La collecte et le traitement (non la publication) d'informations analytiques. </p><br><p>  <em>Sous</em> - <em>domaines</em> : </p><br><ul><li>  statistiques sur les fonds </li><li>  statistiques d'application </li></ul><br><p>  <strong>SystÃ¨me de gestion</strong> (panneau de <strong>gestion</strong> ) </p><br><p>  <em>Contexte</em> : La publication d'informations analytiques.  BoÃ®te Ã  outils des dÃ©cisions de gestion. </p><br><ul><li>  analyse basÃ©e sur les statistiques collectÃ©es </li><li>  prÃ©-modÃ©ration des paiements aux coursiers </li></ul><br><p>  En fonction des domaines, cartographions-les. </p><br><blockquote>  Une carte de domaine (Context map) est un outil graphique qui vous permet de dÃ©crire les relations entre les domaines individuels. </blockquote><p><img src="https://habrastorage.org/webt/p1/ks/po/p1kspot2qqut90gzcn1b9fhxyn8.png" alt="Context-map"></p><br><p>  La carte montre les liens entre les domaines.  Cette carte est trÃ¨s superficielle, mais le sujet n'est pas bien compris.  Ceci est la premiÃ¨re esquisse, rÃ©Ã©criture dont vous obtiendrez le rÃ©sultat attendu. </p><br><p>  La chose la plus importante sur la carte est que nous voyons des connexions entre les domaines.  Une telle structure s'intÃ¨gre trÃ¨s bien dans l'architecture de microservices: </p><br><blockquote>  Le principe principal de l'architecture des microservices: faible connectivitÃ© et forte adhÃ©rence. </blockquote><p>  Ce principe est donnÃ© dans le livre de Sam Newman - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CrÃ©ation de microservices</a> , c'est le deuxiÃ¨me livre que vous devrez lire pour commencer Ã  utiliser concrÃ¨tement les approches dÃ©crites dans cet article.  Ce que cela signifie: les domaines doivent Ãªtre faiblement couplÃ©s, mais Ã©troitement liÃ©s en interne. </p><br><p>  La traduction de ces termes est tirÃ©e de la traduction officielle russe et reflÃ¨te peut-Ãªtre mal le sens transmis.  Dans les termes originaux, cela ressemble Ã : faible couplage (connectivitÃ©, engagement, adhÃ©rence, conjugaison), haute cohÃ©sion (connectivitÃ©, rÃ©sistance). </p><br><h2 id="praktika-realizacii-domennogo-razdelenie">  Pratique de mise en Å“uvre du partage de domaine </h2><br><p>  Je voudrais partager mon expÃ©rience personnelle - un ensemble de dÃ©cisions Ã©clairÃ©es.  Je ne vous invite pas Ã  utiliser ces solutions.  Mais ils peuvent Ãªtre un bon choix si vous ne savez pas par oÃ¹ commencer.  Avec une expÃ©rience personnelle, les outils seront davantage adaptÃ©s Ã  vos besoins. </p><br><p>  Les grands principes qui nous ont guidÃ©s: </p><br><ul><li>  La simplicitÃ© de la solution.  Faites des choses complexes simples, pas simples compliquÃ©es. </li><li>  Pragmatisme  Vous devez toujours regarder la situation et, en lâ€™absence de solution existante, en dÃ©velopper une nouvelle.  Essayez de tout caractÃ©riser, mais Ã©vitez le dogmatisme. </li><li>  Code! = Documentation.  Le code est des instructions pour la machine, la documentation est une instruction pour les personnes.  Pas besoin de les confondre et de les distribuer les uns aprÃ¨s les autres. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SOLIDE</a> </li></ul><br><h3 id="kak-realizovat-domeny">  Comment implÃ©menter des domaines? </h3><br><p>  Il est trÃ¨s pratique de sÃ©lectionner des domaines en tant que microservices sÃ©parÃ©s. </p><br><blockquote>  Les microservices sont une application distincte qui implÃ©mente la logique d'un domaine. </blockquote><p>  Dans le dÃ©veloppement DDD, le principe d'allocation d'un microservice dans une application distincte sera un contexte limitÃ©.  Cela ne remet pas en cause le principe technique de la sÃ©paration des services (si cela est dÃ» Ã  la nÃ©cessitÃ© d'assurer des performances Ã©levÃ©es).  Mais le principe contextuel sera dominant et contraignant. </p><br><h3 id="kak-vydelit-svyazi-mezhdu-domenami">  Comment mettre en Ã©vidence la relation entre les domaines? </h3><br><p>  Les relations entre les domaines sont toujours une API.  Il peut s'agir d'API json RESTful, gRPC, AMPQ.  Dans le cadre de cet article, nous ne comparerons pas un protocole Ã  un autre et mettrons en avant leurs avantages et inconvÃ©nients, chacun ayant son propre champ d'application.  Mais tout de mÃªme, arrÃªtons-nous sur les recommandations gÃ©nÃ©rales: </p><br><p>  <strong>Soyez flexible dans le choix d'un protocole et rigide dans l'uniformitÃ© de sa mise en Å“uvre.</strong> </p><br><p>  Choisissez un protocole pour chaque paire de domaines individuellement, n'essayez pas d'utiliser http partout, vous aurez peut-Ãªtre besoin de files d'attente asynchrones quelque part et les avantages d'AMPQ deviendront Ã©vidents pour vous.  N'ignorez pas cette opportunitÃ© car vous avez RESTful partout. </p><br><p>  En revanche, si vous implÃ©mentez RESTful json, utilisez une norme de structuration des donnÃ©es.  Vous pouvez prendre par exemple jsonapi ou openapi.  Si pour une raison quelconque, des solutions toutes faites ne vous conviennent pas et que vous sentez que vous pouvez dÃ©velopper votre norme, la dÃ©crire et l'utiliser.  Mais utilisez-le partout, ne reproduisez pas les normes "zoo".  Si vous devez communiquer avec un systÃ¨me externe oÃ¹ ils ne connaissent rien Ã  vos normes, Ã©crivez un adaptateur de microservice. </p><br><p><img src="https://habrastorage.org/webt/cz/ff/go/czffgobmp7v9lr2pzkjx0-3y5xq.png" alt="Adapt adaptateur"></p><br><h3 id="kak-realizovat-sabdomeny">  Comment implÃ©menter des sous-domaines? </h3><br><p>  En tant que modules sÃ©parÃ©s dans un microservice. </p><br><blockquote>  Un module est une implÃ©mentation d'un sous-domaine, en plaÃ§ant la logique dans un espace de noms distinct (espace de noms) au sein d'un microservice unique. </blockquote><p>  Ã€ quoi tout cela ressemble-t-il?  Regardons un exemple.  Comme nous nous en souvenons, nous avons un domaine de systÃ¨me de livraison - ce domaine a trois sous-domaines: </p><br><ul><li>  inscription par messagerie </li><li>  Ã©mission de tÃ¢ches (tÃ¢ches) </li><li>  enregistrement des demandes de retrait des fonds gagnÃ©s par le courrier (retrait) </li><li>  vÃ©rifier que votre microservice fonctionne, outil technique auxiliaire (healt_checker) </li></ul><br><p>  Imaginez tout cela sous la forme d'une structure de dossiers: </p><br><pre> <code class="bash hljs">$ tree --dirsfirst delivery_system delivery_system â”œâ”€â”€ app/ â”‚ â”œâ”€â”€ health_checker/ â”‚ â”‚ â””â”€â”€ endpoints.rb â”‚ â”œâ”€â”€ registrations/ â”‚ â”‚ â”œâ”€â”€ entities/ â”‚ â”‚ â”œâ”€â”€ forms/ â”‚ â”‚ â”œâ”€â”€ repositories/ â”‚ â”‚ â”œâ”€â”€ interactor/ â”‚ â”‚ â”œâ”€â”€ services/ â”‚ â”‚ â”œâ”€â”€ validations/ â”‚ â”‚ â”œâ”€â”€ endpoints.rb â”‚ â”‚ â””â”€â”€ helpers.rb â”‚ â”œâ”€â”€ tasks â”‚ â”‚ â”œâ”€â”€ entities/ â”‚ â”‚ â”œâ”€â”€ queries/ â”‚ â”‚ â”œâ”€â”€ repositories/ â”‚ â”‚ â”œâ”€â”€ endpoints.rb â”‚ â”‚ â””â”€â”€ helpers.rb â”‚ â””â”€â”€ withdrawals â”‚ â”œâ”€â”€ entities/ â”‚ â”œâ”€â”€ forms/ â”‚ â”œâ”€â”€ repositories/ â”‚ â”œâ”€â”€ interactor/ â”‚ â”œâ”€â”€ services/ â”‚ â”œâ”€â”€ validations/ â”‚ â”œâ”€â”€ endpoints.rb â”‚ â””â”€â”€ helpers.rb â”œâ”€â”€ config/ â”œâ”€â”€ db/ â”œâ”€â”€ docs/ â”œâ”€â”€ lib/ â”‚ â”œâ”€â”€ schemas/ â”‚ â””â”€â”€ values/ â”œâ”€â”€ public â”œâ”€â”€ specs â”œâ”€â”€ config.ru â”œâ”€â”€ Gemfile â”œâ”€â”€ Gemfile.lock â”œâ”€â”€ Rakefile â””â”€â”€ README.md</code> </pre> <br><p>  Chaque dossier dans le rÃ©pertoire <code>apps/</code> implÃ©mente l'un ou l'autre sous-domaine, au sein de chaque domaine, il existe diffÃ©rents modÃ¨les: <code>entities</code> , <code>forms</code> , <code>services</code> , etc. Nous examinerons en dÃ©tail chacun des modÃ¨les appliquÃ©s dans l'un des prochains articles. </p><br><p>  Chacun de ces modÃ¨les est implÃ©mentÃ© dans l'espace de noms correspondant (espace de noms).  Par exemple, un formulaire pour crÃ©er une demande de paiement Ã  un coursier: </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrawal</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#   module Forms #  class Create end end end</span></span></span></span></code> </pre> <br><h3 id="kak-realizovat-svyazi-mezhdu-sabdomeny">  Comment implÃ©menter la communication entre les sous-domaines? </h3><br><p>  Regardons un exemple spÃ©cifique.  Nous avons un compte de messagerie: <code>Registrations::Entities::Account</code> .  Il fait rÃ©fÃ©rence au sous-domaine <code>Registrations</code> - car nous considÃ©rons ce domaine non pas comme un processus d'enregistrement, mais plutÃ´t comme un tableau de compte et un livre d'enregistrement, comme indiquÃ© dans notre documentation commerciale. </p><br><p>  Nous avons deux <em>processus</em> dans l'exÃ©cution desquels nous accÃ©dons Ã  ce compte. </p><br><ul><li>  CrÃ©er un compte (inscription) </li><li>  CrÃ©ation d'une demande de retrait de fonds gagnÃ©s par un coursier (Wihtdrawal) </li></ul><br><p>  Comme nous le voyons, ces deux processus appartiennent Ã  des sous-domaines diffÃ©rents - Enregistrement et Wihtdrawal. </p><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccount</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Withdrwals</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">module</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serivices</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateOrder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">call</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">account</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Registrations::Entities::Account</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span></span></code> </pre> <br><p>  Dans le premier cas, un appel Ã  la classe sera implÃ©mentÃ© via un appel Ã  <code>Entities::Account</code> .  Et dans le second cas, via un appel explicite Ã  <code>Registrations::Entities::Account</code> .  C'est-Ã -dire  si nous spÃ©cifions explicitement un sous-domaine, alors la classe provient d'un autre sous-domaine et nous indiquons donc clairement la connexion. </p><br><p>  Si la classe ne s'applique explicitement Ã  aucun des sous-domaines, il est logique de la dÃ©placer vers le dossier <code>lib/</code> .  En rÃ¨gle gÃ©nÃ©rale, ce sont des classes qui implÃ©mentent le modÃ¨le Â«ValueObjectÂ».  Nous examinerons ce modÃ¨le plus en dÃ©tail dans l'un des articles suivants. </p><br><h2 id="realizaciya-cherez-model">  Mise en Å“uvre Ã  travers le modÃ¨le. </h2><br><p>  Pour citer Eric Evans: </p><br><blockquote>  Si l'architecture du programme, ou du moins une partie centrale de celui-ci, ne correspond pas Ã  la structure du modÃ¨le de domaine, alors un tel modÃ¨le est pratiquement inutile et le bon fonctionnement du programme doit Ã©galement Ãªtre remis en question.  Dans le mÃªme temps, les relations trop complexes entre les modÃ¨les et les fonctions dans l'architecture logicielle sont difficiles Ã  comprendre et, en pratique, elles sont difficiles Ã  maintenir Ã  mesure que l'architecture change. </blockquote><p>  Rappelons l'exemple d'un bon modÃ¨le que j'ai dÃ©jÃ  citÃ© au dÃ©but de cet article - une carte topographique.  Notre objectif est de pouvoir trouver rapidement la distance entre deux colonies.  Nous pourrions utiliser un tableau de rÃ©fÃ©rence montrant deux points entre les villes.  Et nous pouvons utiliser la carte.  LÃ  et lÃ , nous obtenons le mÃªme rÃ©sultat Ã  peu prÃ¨s en mÃªme temps.  Mais la carte est plus compacte, elle affiche plus prÃ©cisÃ©ment le sujet, elle est plus universelle.  La carte en tant que modÃ¨le est incroyablement expressive.  Et si nous la considÃ©rons dans le cadre de cette tÃ¢che, alors mesurer la distance est plus pratique sur la carte que sur le territoire lui-mÃªme, qu'elle reflÃ¨te.  Un modÃ¨le qui reflÃ¨te un domaine peut le surpasser dans certaines propriÃ©tÃ©s.  C'est vraiment incroyable. </p><br><p>  La mise en Å“uvre du modÃ¨le est toujours un processus crÃ©atif avec des rÃ©sultats imprÃ©visibles.  La qualitÃ© de votre code n'est pas sa performance, ni sa complexitÃ©, c'est la simplicitÃ© et l'expressivitÃ©.  AmÃ©liorez-le grÃ¢ce Ã  une refactorisation constante, rendez-le flexible et supprimez tout ce qui n'est pas nÃ©cessaire.  SÃ©parez la couche qui sera responsable de la logique mÃ©tier du modÃ¨le des couches dont le besoin est dÃ» Ã  la mise en Å“uvre technique.  La faÃ§on dont nous avons rÃ©ussi Ã  le faire sera dÃ©crite plus loin. </p><br><hr><br><div class="spoiler">  <b class="spoiler_title">Sources d'inspiration</b> <div class="spoiler_text"><ul><li>  Conception orientÃ©e problÃ¨me, Eric J. Evans </li><li>  CrÃ©ation de microservices, Sam Newman </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://gorodinski.com/blog/2013/04/29/sub-domains-and-bounded-contexts-in-domain-driven-design-ddd/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://martinfowler.com/bliki/BoundedContext.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://habr.com/post/316438/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://dotnetcodr.com/2015/08/06/domain-driven-design-with-web-api-revisited-part-1-introduction/</a> </li><li>  Histoire d'Aberdeen, Cristov Martin Wieland </li></ul><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428209/">https://habr.com/ru/post/fr428209/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428193/index.html">Ã€ propos des tournÃ©es</a></li>
<li><a href="../fr428197/index.html">Finances personnelles efficaces. Niveau 1</a></li>
<li><a href="../fr428201/index.html">Trous de taupe en JavaScript</a></li>
<li><a href="../fr428203/index.html">Nous regardons les graphiques: estimations et prÃ©visions pour le marchÃ© du cloud computing, donnÃ©es en 2018</a></li>
<li><a href="../fr428205/index.html">Lifehacks NaviHaka</a></li>
<li><a href="../fr428211/index.html">Le livre Â«Architecture Ã©volutive. Soutien au changement continu "</a></li>
<li><a href="../fr428213/index.html">Comment interprÃ©ter les prÃ©dictions de modÃ¨le dans SHAP</a></li>
<li><a href="../fr428217/index.html">Millions d'appels vidÃ©o par jour ou Â«Appelle maman!Â»</a></li>
<li><a href="../fr428219/index.html">D'oÃ¹ est venue la pratique de la rÃ©installation massive de personnel qualifiÃ©?</a></li>
<li><a href="../fr428221/index.html">GÃ©nÃ©ration AI de visages rÃ©alistes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>