<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤷🏿 👴🏿 🌗 Cara mengubah ponsel cerdas menjadi meja kas lengkap 🎂 👨‍👩‍👦 ↔️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Setiap hari di toko kami melihat meja kas yang berbeda - semua jenis solusi tertanam dengan tombol misterius. Di belakang meja kas seperti itu ada kas...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara mengubah ponsel cerdas menjadi meja kas lengkap</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/moysklad/blog/462993/"><p>  Setiap hari di toko kami melihat meja kas yang berbeda - semua jenis solusi tertanam dengan tombol misterius.  Di belakang meja kas seperti itu ada kasir yang berteriak "Galya, kami telah membatalkan."  Ini tidak nyaman untuk kasir dan pembeli. </p><br><p>  Antarmuka checkout menjadi lebih ramah pengguna dari waktu ke waktu, dan Gali sudah kurang dibutuhkan, tetapi checkout masih tetap merupakan artefak rumit dan kompleks. </p><br><p><img src="https://habrastorage.org/webt/zq/bc/ia/zqbcia27fpbw0x-pgb09nk2khtw.png"></p><br><p>  Nama saya Vladimir Sarbeev, saya adalah pengembang Android di MySklad.  Dan saya yakin bahwa mesin kasir bisa ringkas dan nyaman.  Selain itu, Anda dapat mengubah ponsel cerdas Anda menjadi kasir. </p><a name="habracut"></a><br><p>  Di MyStore, kami telah membuat aplikasi seluler Kassa MyStore.  Ini adalah box office lengkap di dalam smartphone. </p><br><p>  Kerjanya seperti ini: setelah otorisasi, kasir dapat membuka dan menutup shift, menjual barang secara langsung atau dengan reservasi, memperhitungkan uang tunai.  Anda dapat menghubungkan perangkat yang diperlukan untuk bekerja ke Kasir.  Mereka ada di foto: </p><br><p><img src="https://habrastorage.org/webt/wp/_t/8k/wp_t8kkm69mpwtht7fb7d6a36nq.png"><br>  <em>1 - box office Atol Sigma 10;</em>  <em>2 - aplikasi tidak didukung, integrasi dengan karyawan</em> <br>  <em>3 - kantor tiket Atol 11F;</em>  <em>4 - terminal Verifone VX820;</em>  <em>5 - terminal PAX S90</em> <br>  <em>6 - box office Shtrikh-Nano-F;</em>  <em>7 - kantor tiket Atol 15F;</em>  <em>8 - box office Bar-ON-LINE</em> <br>  <em>9 - pemindai barcode;</em>  <em>10 - terminal PayMe;</em>  <em>11 - meja kas MSPOS-K</em> </p><br><p>  Smartphone itu sendiri tidak dapat mencetak tanda terima uang tunai dan menerima pembayaran dengan kartu kredit, sehingga meja kas dan terminal pembayaran diperlukan.  Pemindai perangkat keras diperlukan jika kamera ponsel cerdas tidak cocok untuk penggantian penuh pemindai kode batang. </p><br><h2 id="vsevidyaschee-oko">  Mata yang melihat semuanya </h2><br><p>  Bahkan sebelum rilis Cash desk MySklad, kami memutuskan bahwa kamera adalah kamera, tetapi pengguna mungkin memiliki pemindai kode batang perangkat keras yang ingin ia gunakan. </p><br><p>  Kami dapat bekerja dengan pemindai dalam bentuk HID (perangkat antarmuka manusia) biasa.  Setelah membaca barcode, kami mendapatkan urutan karakter dari pemindai.  Ini mungkin integrasi yang paling mudah.  Yang paling sederhana, jika bukan dua "tetapi". </p><br><p>  Pertama, menjadi "out of the box" pemindai mungkin tidak mengirimkan apa pun yang seharusnya.  Kedua, tidak semua model pemindai memberi sinyal kepada kami bahwa pembacaan barcode sudah selesai. </p><br><p>  "Tetapi" yang pertama diselesaikan dengan sederhana: jika pemindai mulai mengirimkan bukan apa yang seharusnya dipindai, Anda perlu menemukan instruksi untuk pemindai dan mengkonfigurasinya menggunakan barcode layanan.  Biasanya, instruksi lengkap di atas kertas atau dalam bentuk elektronik dari pabrikan.  Setelah menjelaskan pengaturan yang tersedia, itu berisi barcode yang memindai dalam urutan yang diinginkan.  Jadi, Anda dapat mengkonfigurasi pemindai sesuai kebutuhan. </p><br><p>  "Tapi" kedua adalah masalah yang lebih serius.  Kebun binatang pemindai sangat luas, dan tidak semua perangkat menunjukkan akhir baris baca.  Ada dua opsi untuk menyelesaikan masalah ini.  Yang pertama adalah menggunakan barcode layanan yang sama untuk mengatur pengaturan yang akan mengirimkan karakter pemisah baris setelah membaca.  Jika Anda tidak beruntung dengan model dan opsi pertama tidak cocok, Anda dapat mengatur akhiran pemindai.  Menggunakan barcode layanan, tambahkan karakter di akhir urutan baca yang digunakan untuk menangkap input. </p><br><h2 id="podklyuchaem-kassu">  Kami menghubungkan meja kas </h2><br><p> Jadi, aplikasi ada di sana, pemindai barcode terhubung, tetapi kami masih tidak dapat mencetak cek.  Untuk ini kita perlu box office itu sendiri.  Di MySklad kami mendukung KKT Atol dan Shtrikh, juga MSPOS, saya akan menceritakannya di artikel lain. </p><br><p>  Ketika datang ke integrasi dengan kasir, jumlah kode besi mulai tumbuh tanpa bisa dielakkan.  Kami memutuskan untuk menempatkan semua pekerjaan dengan peralatan yang terhubung ke perpustakaan yang terpisah.  Aplikasi mesin kasir itu sendiri telah menjadi klien menarik perpustakaan melalui gradle. </p><br><p>  Tergantung pada modelnya, Anda dapat terhubung melalui USB, Bluetooth atau Wi-Fi.  Dan juga menurut protokol UART, yang merupakan kopling kaku dari mesin kasir dan perangkat Android dalam satu kasus.  Juga, vendor yang berbeda secara radikal berbeda dalam implementasi menghubungkan klien ke checkout.  Java wrapper di atas pustaka .so asli, add-on di atas pustaka jPOS open source dan bahkan inti fiskal diakses melalui layanan dengan antarmuka AIDL (bahasa definisi antarmuka Android). </p><br><p>  Pada upaya pertama untuk mengintegrasikan satu perangkat dari satu produsen, kami puas dengan skema interaksi Perangkat KKM: </p><br><p><img src="https://habrastorage.org/webt/jz/tz/my/jztzmyluw0ilashos-8utonzj9m.png"></p><br><p>  Tetapi dengan mempertimbangkan jumlah implementasi driver, metode koneksi dan keseragaman fungsionalitas, kami memutuskan untuk memikirkan kembali bekerja dengan perangkat keras.  Akibatnya, skema sebelumnya sampai pada formulir ini: </p><br><p><img src="https://habrastorage.org/webt/5s/l1/sz/5sl1szcf5jfdhbrvs0r7uebkpek.png"></p><br><p>  <em>T adalah pembungkus driver tingkat rendah khusus</em> </p><br><p>  Pengelola Perangkat menyembunyikan implementasi koneksi dari klien.  Cukuplah untuk membuat wizard koneksi, yang mengharuskan Anda untuk secara berurutan memilih pabrikan kasir, jenis koneksi, dan menentukan pengaturan.  Dalam kasus koneksi yang berhasil, ia mengembalikan kepada kita objek yang mengimplementasikan antarmuka KKMDevice. </p><br><p>  KKMDevice menyembunyikan detail bekerja dengan driver vendor individu.  Wrappers dari masing-masing pabrikan tertentu berisi tautan ke driver T dan delegasi yang mengimplementasikan serangkaian fungsi tertentu.  Misalnya, FiscalDelegate, NonFiscalDelegate, DeviceInfoDelegate. </p><br><p>  Saya akan mencatat beberapa poin umum integrasi: </p><br><ul><li>  Pastikan untuk tetap mengikuti pembaruan driver.  Selain perbaikan bug dan peningkatan kecepatan, lompatan kualitas sering terjadi.  Percayalah, transisi dari perintah HEX tingkat rendah ke antarmuka seperti Java, dan dari itu ke tugas json sangat memudahkan pekerjaan dan membuat kode lebih dimengerti. </li><li>  Untuk durasi operasi, blokir UI dengan bilah kemajuan.  Tanda itu mengatakan bahwa tombol "Bayar" ditekan beberapa kali berturut-turut dengan PKC yang terhubung adalah pertanda kritik dalam pelacak tugas. </li><li>  Pastikan semua operasi dengan CCP dilakukan secara berurutan.  Perlombaan aliran yang “berhasil” dapat menghentikan KKT, sementara bilah kemajuan berputar pada saat yang sama juga merupakan aplikasi. </li><li>  Jika Anda perlu mengkonfigurasi transfer data ke operator data fiskal, saya menyarankan Anda untuk memilih jumlah maksimum parameter dari daftar yang telah ditentukan.  Karena memasukkan data secara manual dengan drive fiskal militer adalah cara yang bagus untuk menembak diri sendiri, tetapi di sisi pengguna saat menggunakan aplikasi. </li></ul><br><p>  Drive fiskal adalah perangkat yang mengumpulkan dan memproses informasi tentang operasi perdagangan.  Mungkin harganya lebih mahal daripada box office itu sendiri.  Jika drive tidak dikonfigurasikan dengan benar, proses zeroing mungkin diperlukan.  Untuk melakukan ini, buka box office, segera garansi terbang. </p><br><h2 id="ekvayring">  Mengakuisisi </h2><br><p>  Jadi, kami memiliki antarmuka meja kas, kami dapat memindai barang dengan barcode dan mencetak cek.  Tetap menambah kemampuan membayar dengan kartu. </p><br><p>  Aplikasi kami mengintegrasikan dukungan untuk terminal PayMe dan Inpas.  Yang pertama terhubung melalui Bluetooth, sedangkan yang terakhir dapat dihubungkan melalui USB atau melalui Wi-Fi. </p><br><p>  Skema koneksi untuk terminal pembayaran sangat mirip dengan menghubungkan CCP, kecuali diperlukan otorisasi tambahan. </p><br><p>  Tetapi ada perbedaan serius - dalam menangani perilaku abnormal perangkat.  Jadi di PKC, operasi apa pun berhasil atau tidak.  Jika operasi gagal, Anda dapat mencoba lagi atau membatalkannya.  Segala sesuatu yang lain terjadi tanpa intervensi. </p><br><p>  Dalam hal terminal, perlu untuk memantau kemungkinan gangguan dari proses pembayaran pada setiap langkah.  Kartu bank mungkin tidak dipertimbangkan atau akan ada cukup dana pada kartu tersebut.  Anda tidak bisa menunggu respons dari bank atau menunggu, tetapi dapatkan kode HTTP 5xx sebagai tanggapan.  Dan pada salah satu tahap koneksi mungkin jatuh. </p><br><p>  Selain itu, Anda tidak akan dapat merilis aplikasi yang berfungsi dengan baik dengan dukungan terminal Inpas tanpa sertifikasi.  Sertifikasi mencakup memeriksa ketersediaan dan operasi yang benar dari semua operasi pengguna terminal dan peristiwa pemrosesan seperti terputusnya jaringan setelah pembeli telah memasang kartu ke terminal. </p><br><p>  Saat menguji terminal, Anda harus mempertimbangkan bank atau sistem pembayaran yang dipasangkan dengannya.  Dalam beberapa kasus, bahkan dalam mode pengembangan, uang dikembalikan hanya melalui akun pribadi akun, dan tidak secara otomatis. </p><br><p>  Anda juga perlu ingat bahwa bank juga mengambil bagian dalam proses pembayaran.  Misalnya, tidak adanya slip-cek dapat terjadi jika tidak ada pengaturan yang diperlukan dalam rekening pribadi bank. </p><br><h2 id="zaklyuchenie">  Kesimpulan </h2><br><p>  Menghubungkan berbagai perangkat ke aplikasi Android adalah proses yang rumit namun menarik.  Kami berbicara tentang dia secara keseluruhan, untuk menggambarkan semua hambatan, tentu saja, tidak realistis. </p><br><p>  Jika Anda memiliki pertanyaan, saya akan dengan senang hati menjawabnya di komentar.  Jika pertanyaan diketik dalam artikel terpisah, tulis :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id462993/">https://habr.com/ru/post/id462993/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id462977/index.html">Mempercepat Proses SDM Rutin dan RPA dan BluePrism</a></li>
<li><a href="../id462979/index.html">Cheat sheet for trainee: pemecahan masalah langkah demi langkah pada wawancara Google</a></li>
<li><a href="../id462983/index.html">Voice for game dev: bagaimana kami mengembangkan pencarian suara "Lovecraft World"</a></li>
<li><a href="../id462989/index.html">BERT Conversasional - Pelajari Jaringan Saraf dalam Bahasa Media Sosial</a></li>
<li><a href="../id462991/index.html">Mengendarai gelombang web 3.0</a></li>
<li><a href="../id462997/index.html">Mitap dari Masyarakat Penguji Anonim # 7 - laporan dari pertemuan tersebut</a></li>
<li><a href="../id463001/index.html">Menguji infrastruktur Anda sebagai kode dengan Pulumi. Bagian 1</a></li>
<li><a href="../id463005/index.html">Keamanan ASMR</a></li>
<li><a href="../id463009/index.html">Evolusi Penjualan di Perusahaan N</a></li>
<li><a href="../id463011/index.html">Jangan membuang akustik lama Kehidupan baru akustik lama</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>