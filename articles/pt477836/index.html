<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõåüèº ü§ó üßï Como testamos o WD ActiveScale P100 para nosso armazenamento S3 ü§Ωüèº üçú üîº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Periodicamente testamos novo hardware e software para uso em nossos servi√ßos. Voc√™ sempre quer mais recursos por um pre√ßo razo√°vel. Hoje vou contar co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como testamos o WD ActiveScale P100 para nosso armazenamento S3</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/477836/">  Periodicamente testamos novo hardware e software para uso em nossos servi√ßos.  Voc√™ sempre quer mais recursos por um pre√ßo razo√°vel.  Hoje vou contar como entendemos o dispositivo Western Digital ActiveScale P100 e tentamos experiment√°-lo para nosso armazenamento S3. <br><br>  Imediatamente um pequeno aviso: testamos o produto em termos de uso em um servi√ßo p√∫blico.  Talvez algumas fun√ß√µes, interessantes e importantes para uso privado, tenham sido deixadas de lado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gv/3r/w8/gv3rw8w72ap3doe1cynul2fb_rw.jpeg"></div><br>  <i>Este √© o ActiveScale P100 em abril de 2019 antes da instala√ß√£o no data center OST.</i> <br><br>  Agora, o nosso <a href="https://www.dtln.ru/uslugi/datamanagement/odw">S3</a> √© executado no Cloudian HyperStore 7.1.5.  Esta vers√£o oferece 98% de compatibilidade com APIs da Amazon.  A solu√ß√£o atual tem tudo o que precisamos como prestador de servi√ßos e nossos clientes; portanto, procuramos alternativas. <a name="habracut"></a><br><br>  Desta vez, a solu√ß√£o de software e hardware Western Digital ActiveScale caiu em nossas m√£os.  O fornecedor o posiciona como uma solu√ß√£o para organizar um cluster S3. <br><br>  √â assim que parece: <br><br><img src="https://habrastorage.org/webt/g3/6g/cb/g36gcb-oacoww2pa1zqifnxjrti.png"><br>  <i>ActiveScale P100 instalado em uma das salas do data center OST.</i> <br><br>  As tr√™s principais unidades s√£o n√≥s de controle.  As seis unidades a seguir s√£o n√≥s para armazenar dados.  Cada um dos seis n√≥s cont√©m 12 discos de 10 TB cada.  720 TB total de capacidade "bruta".  O complexo tamb√©m inclui 2 dispositivos de rede.  Para cada n√≥ - 2 links de 10G.  No total, essa decis√£o leva 11 unidades no rack. <br><br>  Executamos o ActiveScale por meio de testes de carga: um script gerou um n√∫mero diferente de arquivos de tamanhos diferentes, tentou carreg√°-los no modo de thread √∫nico e multithread e registramos o tempo de execu√ß√£o dos comandos para carregar e excluir arquivos.  Este teste foi artificial: foi realizado em um computador com uma unidade SSD, uma grande quantidade de mem√≥ria e um processador com uma frequ√™ncia de 3,2 GHz, com uma largura de canal limitada de 100 Mb / s.  No entanto, temos os resultados de um teste semelhante para a solu√ß√£o atual e os resultados obtidos foram mais do que dentro das nossas expectativas. <br><br><div class="scrollable-table"><table><tbody><tr><td>  Teste <br></td><td>  Tamanho do objeto <br></td><td>  N√∫mero de objetos <br></td><td>  N√∫mero de threads <br></td><td>  Velocidade m√©dia <br></td><td>  Tempo de carregamento <br></td><td>  Tempo de remo√ß√£o * <br></td></tr><tr><td>  1 <br></td><td>  10 Kb <br></td><td>  100.000 <br></td><td>  1 <br></td><td>  104 kb / s <br></td><td>  2 h 40 m <br></td><td>  6 m 58 s <br></td></tr><tr><td>  2 <br></td><td>  10 Kb <br></td><td>  100.000 <br></td><td>  20 <br></td><td>  11 MB / s <br></td><td>  35 m 4 s <br></td><td>  11 m 38 s <br></td></tr><tr><td>  3 <br></td><td>  1 Mb <br></td><td>  100.000 <br></td><td>  1 <br></td><td>  5 MB / s <br></td><td>  5 h 55 m <br></td><td>  7 m 16 s <br></td></tr><tr><td>  4 <br></td><td>  1 Mb <br></td><td>  100.000 <br></td><td>  20 <br></td><td>  11 MB / s <br></td><td>  2 h 27 min <br></td><td>  7 m 26 s <br></td></tr><tr><td>  5 <br></td><td>  10 GB <br></td><td>  1 <br></td><td>  1 <br></td><td>  10 MB / s <br></td><td>  16 m 5 s <br></td><td>  3 s <br></td></tr><tr><td>  6 <br></td><td>  10 GB <br></td><td>  1 <br></td><td>  20 <br></td><td>  10 MB / s <br></td><td>  16 m 2 s <br></td><td>  3 s <br></td></tr></tbody></table></div>  <i>Resultados do teste de estresse.</i> <i><br><br></i>  <i>* Ao excluir um objeto, apenas √© marcado para exclus√£o.</i>  <i>A remo√ß√£o em si ocorre uma vez por dia.</i>  <i>Quando o cluster est√° quase cheio, isso pode complicar o gerenciamento da capacidade, pois n√£o h√° informa√ß√µes atualizadas sobre os recursos utilizados.</i> <br><br>  A compatibilidade do Amazon S3 foi testada de maneiras padr√£o.  <a href="">Aqui est√°</a> um dos testes que eu usei. <br><br>  No momento do teste, t√≠nhamos a documenta√ß√£o mais b√°sica, ent√£o lidamos com o dispositivo dessa ‚Äúcaixa preta‚Äù por conta pr√≥pria - por meio da interface da web administrativa, API e acesso f√≠sico. <br><br><h3>  O que foi encontrado dentro </h3><br>  <b>Interface de administra√ß√£o</b>  Na p√°gina principal, resuma informa√ß√µes sobre tamanhos de cluster e m√©tricas de trabalho, estat√≠sticas sobre objetos, usu√°rios, buckets, pol√≠ticas de armazenamento. <br><br><img src="https://habrastorage.org/webt/nv/kk/yc/nvkkycjcqzdkpmxwj4sdxpufolq.png"><br><br>  <b>Interface do usu√°rio</b>  No servi√ßo S3, √© necess√°rio para que o administrador do lado do cliente possa adicionar / remover usu√°rios, gerar chaves de acesso para eles, cotar usu√°rios etc. O P100 n√£o o possui, mas ap√≥s o feedback, o fornecedor planeja implement√°-lo. <br><br>  <b>Gerenciamento de usu√°rio / fun√ß√£o.</b>  Para organizar um servi√ßo p√∫blico, precisamos da capacidade de criar usu√°rios com direitos de acesso diferentes.  O P100 possui limita√ß√µes significativas a esse respeito: <br><br><ul><li>  Voc√™ pode criar apenas um usu√°rio do sistema, ou seja, um administrador de cluster.  Mais - somente atrav√©s da integra√ß√£o com o Active Directory. </li><li>  Os usu√°rios n√£o podem ser agrupados e atribu√≠dos a um administrador.  Na verdade, isso impossibilita a presta√ß√£o de um servi√ßo p√∫blico. </li><li>  o usu√°rio n√£o pode ser exclu√≠do permanentemente; portanto, se o novo usu√°rio estiver com o mesmo login, voc√™ precisar√° ser criativo. </li><li>  A defini√ß√£o de cotas para usu√°rios (volume, n√∫mero de transa√ß√µes etc.) √© poss√≠vel apenas atrav√©s da CLI. </li></ul><br>  <b>Faturamento.</b>  O P100 est√° pronto para uso, e essa √© a maior desvantagem para n√≥s, como prestadores de servi√ßos.  Temos um produto comercial e precisamos cobrar de alguma forma os clientes.  O P100 possui registros estat√≠sticos que podem ser removidos a cada hora atrav√©s do painel de administra√ß√£o.  Teoricamente, voc√™ pode analis√°-los, extrair os dados necess√°rios e fazer um c√°lculo sobre eles.  Mas esses logs s√£o armazenados apenas 30 dias.  O que fazer em situa√ß√µes em que no m√™s de 31 dias ou o cliente pede para verificar novamente a conta nos meses anteriores n√£o est√° claro. <br><br>  <b>Definindo suas pr√≥prias regras para armazenar objetos.</b>  O P100 j√° chegou at√© n√≥s com as seguintes configura√ß√µes: arquivos menores que o chunk (20 Kb) s√£o armazenados no modo de <a href="https://habr.com/ru/post/141487/">c√≥digo de apagamento (EC)</a> 6 + 2.  Arquivos maiores que chunk s√£o armazenados no modo EC 13 + 4.  O pr√≥prio P100 determina o tamanho do arquivo e seleciona o modo apropriado. <br><br>  Por um lado, o P100 tem mais op√ß√µes.  Por outro lado, todas as configura√ß√µes de regras de armazenamento para o fator de replica√ß√£o e o c√≥digo de apagamento s√£o poss√≠veis apenas no est√°gio de implanta√ß√£o do cluster.  Mais tarde, durante a opera√ß√£o, n√£o √© mais poss√≠vel adicionar novas regras de armazenamento de dados ou alterar as existentes.  Ao expandir o cluster, isso deve ser feito para que a efici√™ncia e a confiabilidade do armazenamento sejam ideais. <br><br><img src="https://habrastorage.org/webt/ri/f0/kv/rif0kvhc-ajofhymolphcme1psg.png"><br>  <i>Tabela de desempenho de armazenamento do C√≥digo Erasure.</i> <br><br>  <b>CLI nativo \ AdminAPI.</b>  Para gerenciar o cluster, o P100 possui uma CLI, mas ela √© escrita e testada apenas para o Ubuntu (usamos o Red Hat).  Ele n√£o oferece vantagens significativas sobre a intera√ß√£o por meio de solicita√ß√µes de curl (colocar, receber, postar), mas existem alguns recursos para gerenciar o cluster. <br><br>  <b>Suporte para API b√°sica do AWS S3 e AWS CLI.</b>  Este √© apenas um indicador de compatibilidade com a API da Amazon.  Simplificando, √© poss√≠vel usar os comandos do Amazon S3 nesta solu√ß√£o.  De acordo com a experi√™ncia, em m√©dia, esse indicador varia em algum lugar na faixa de 50 a 70%. <br><br>  O P100 obteve 58% de acordo com os resultados do teste.  N√£o foi poss√≠vel realizar testes de compatibilidade na atribui√ß√£o de direitos de acesso a objetos individuais, pois na solu√ß√£o P100 voc√™ pode atribuir acesso geral apenas a um bucket, e n√£o a um objeto separado.  Tamb√©m n√£o h√° IAM (Identity and Access Management).  Como resultado, a compatibilidade est√° mais pr√≥xima de 50%. <br><br><img src="https://habrastorage.org/webt/xy/-q/d6/xy-qd6ev4kzjd4znhvtsr3snvck.png"><br>  <i>A partir dos resultados do teste.</i> <br><br>  <b>Gerenciamento de sistema operacional.</b>  De acordo com a especifica√ß√£o, aparece o ActiveScale OS 5.x. De acordo com os logs e pastas dispon√≠veis atrav√©s da interface da Web, descobri que provavelmente √© baseado em uma distribui√ß√£o Debian.  Durante o teste, n√£o foi poss√≠vel encontrar maneiras de atualiza√ß√µes autogerenciadas, como instalar atualiza√ß√µes cr√≠ticas de seguran√ßa, seus agentes de monitoramento e assim por diante.  Definitivamente, entre em contato com o suporte t√©cnico da P100 com a sa√≠da de uma pessoa especialmente treinada. <br><br>  <b>O n√∫mero de bucket por usu√°rio.</b>  Nesses servi√ßos, o usu√°rio geralmente pode criar at√© 100 buckets, uma esp√©cie de "pasta" para armazenar arquivos.  No caso geral, isso √© suficiente, mas a pr√°tica mostra que n√£o h√° muitos baldes.  No P100, o balde 100 √© o m√°ximo.  Em nossa solu√ß√£o atual, o usu√°rio pode criar 1000 baldes. <br><br>  <b>Definindo direitos de acesso a bucket e objetos.</b>  No P100, voc√™ pode dar acesso a um intervalo espec√≠fico, mas n√£o a um objeto espec√≠fico.  O √∫ltimo √© frequentemente usado pelos usu√°rios, pois permite definir limites para o n√∫mero de downloads e a hora em que ele pode ser baixado. <br><br>  <b>Estat√≠sticas de cluster / usu√°rio / intervalo.</b>  Precisamos dessas informa√ß√µes para rastrear a ocupa√ß√£o do cluster e n√£o perder o momento em que chegamos ao teto por recursos. <br><br>  Na interface, voc√™ pode ver estat√≠sticas quase em tempo real sobre usu√°rios e buckets (as informa√ß√µes s√£o atualizadas uma vez por hora). <br><br><img src="https://habrastorage.org/webt/xj/ai/bq/xjaibqqw9gdv07yzza2kzjeaok4.png"><br><br>  Ele pode ser baixado por meio de um dep√≥sito especial do sistema, mas no formul√°rio baixado, em vez de por email ou nome de usu√°rio, haver√° um UUID; portanto, voc√™ precisa comparar de alguma forma que tipo de usu√°rio est√° se escondendo atr√°s de UUIDs espec√≠ficos.  Isso n√£o √© um problema se houver 10 usu√°rios, mas se houver mais? <br><br>  <b>Autodiagn√≥stico.</b>  O P100 pode interrogar via SNMP toda a pe√ßa de ferro inclu√≠da no cluster e exibi-la no painel.  Por exemplo, voc√™ pode ver a plenitude e a temperatura dos discos, o uso da mem√≥ria etc. <br><br><img src="https://habrastorage.org/webt/pd/qa/vl/pdqavlm376zmqdizh6izrlvjax4.png"><br>  <i>Informa√ß√µes sobre o estado do n√≥ do sistema.</i> <br><br><img src="https://habrastorage.org/webt/h8/t1/hz/h8t1hzlznyaquktbmfrd1gbqdvs.png"><br>  <i>Informa√ß√µes sobre o status dos discos.</i>  <i>Quando uma unidade falha, voc√™ pode ativar a luz de fundo para encontrar e substituir rapidamente.</i> <br><br><img src="https://habrastorage.org/webt/gc/82/1v/gc821vydlpzudaueudlaushnuu4.png"><br>  <i>Par√¢metros para carregar a CPU e a mem√≥ria no cluster.</i> <br><br>  <b>Registrando a√ß√µes do usu√°rio.</b>  N√£o est√° l√°, o que significa que n√£o √© f√°cil entender as situa√ß√µes de "quem excluiu o arquivo e o excluiu". <br><br>  <b>Suporte SSE / SSE-C.</b>  O P100 suporta criptografia, mas com limita√ß√µes: voc√™ precisa solicitar uma chave de licen√ßa separada, e isso √© um dinheiro extra. <br><br>  <b>Balanceador de carga.</b>  √â embutido, presumivelmente vale HAProxy.  Voc√™ precisa configur√°-lo ao m√≠nimo: basta especificar os endere√ßos IP de entrada e sa√≠da. <br><br>  <b>Automa√ß√£o de processos de entrada / sa√≠da de n√≥s ou discos nos n√≥s.</b>  Ajuda quando um n√≥ quebra em um cluster e precisa ser desativado.  Agora, para essas situa√ß√µes, temos uma solu√ß√£o pronta.  Eu n√£o encontrei esse mecanismo no P100, voc√™ s√≥ pode desativar um n√≥ separado pela interface da web administrativa.  Provavelmente, voc√™ precisar√° convidar o engenheiro do fornecedor. <br><br>  <b>Dispositivo S3 Gate.</b>  Esta solu√ß√£o de software permite implantar ftp / nfs / samba-gate no lado do cliente e soltar os arquivos que devem estar no S3 l√°.  Uma coisa conveniente se o usu√°rio final n√£o souber usar o S3.  Infelizmente, o P100 n√£o possui isso a bordo. <br><br>  <b>Portas de aplicativos em funcionamento.</b>  No P100, apenas as portas padr√£o do S3 est√£o dispon√≠veis - 80, 443. <br><br>  <b>Documenta√ß√£o do usu√°rio.</b>  Existe apenas documenta√ß√£o da API. <br><br>  <b>Documenta√ß√£o administrativa.</b>  Fornecido pelo fornecedor, mediante solicita√ß√£o. <br><br><h3>  N√£o testado, mas declarado pelo fornecedor </h3><br>  <b>V√°rios pontos finais.</b>  Chegamos com uma instala√ß√£o pronta, onde apenas um ponto de extremidade por cluster j√° estava configurado.  A altera√ß√£o falhou. <br><br>  <b>Reserva geogr√°fica.</b>  Essa op√ß√£o permite replicar dados em tr√™s sites e alternar clientes para sites de backup.  Como t√≠nhamos apenas um cluster, n√£o foi poss√≠vel testar. <br><br>  <b>Integra√ß√£o com o AD.</b>  Declarado, mas n√£o usamos o AD em rela√ß√£o ao S3, portanto n√£o testamos. <br><br><h3>  Conclus√µes </h3><br>  Em geral, o WD ActiveScale P100 deixou uma impress√£o positiva: ele funciona ‚Äúfora da caixa‚Äù, rapidamente e ao mesmo tempo √© muito aceit√°vel.  No entanto, esta √© uma solu√ß√£o privada que ainda n√£o pode ser usada para criar um servi√ßo p√∫blico S3.  Aqui est√° a principal coisa que n√£o tivemos o suficiente: <br><br><ul><li>  n√£o h√° como criar grupos de usu√°rios e definir um administrador para eles; </li><li>  sem interface gr√°fica com o usu√°rio; </li><li>  sem cobran√ßa; </li><li>  inclus√£o de fun√ß√µes adicionais somente atrav√©s de um apelo ao fornecedor; </li><li>  a incapacidade de manter pol√≠ticas de armazenamento diferentes e atribu√≠-las a diferentes grupos de usu√°rios no mesmo cluster, dependendo das tarefas atuais. </li></ul><br>  De acordo com os resultados do teste, o fornecedor aceitou todos os desejos.  Talvez em um futuro pr√≥ximo um deles seja realizado. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt477836/">https://habr.com/ru/post/pt477836/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt477818/index.html">Como se tornar um cientista de dados em 2019</a></li>
<li><a href="../pt477820/index.html">VMware, Hyper-V, OpenStack, Kubernetes, Swarm - monitorando a partir de uma √∫nica interface no Quest Foglight</a></li>
<li><a href="../pt477826/index.html">Vis√£o geral e compara√ß√£o das tecnologias V2X</a></li>
<li><a href="../pt477832/index.html">Como se dar bem com a gera√ß√£o Z</a></li>
<li><a href="../pt477834/index.html">Princ√≠pios para a constru√ß√£o de sistemas de an√°lise de streaming</a></li>
<li><a href="../pt477838/index.html">Analisador est√°tico PVS-Studio como ferramenta de prote√ß√£o contra vulnerabilidades de dia zero</a></li>
<li><a href="../pt477840/index.html">Analisador de c√≥digo est√°tico PVS-Studio como prote√ß√£o contra vulnerabilidades de dia zero</a></li>
<li><a href="../pt477844/index.html">5 etapas da ideia √† aplica√ß√£o pr√°tica de aprendizado de m√°quina com o SAP Data Intelligence</a></li>
<li><a href="../pt477846/index.html">Resumo de eventos para profissionais de RH em TI de dezembro de 2019</a></li>
<li><a href="../pt477848/index.html">O pequeno segredo de um grande cora√ß√£o: o primeiro cardiograma de baleia azul da hist√≥ria</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>