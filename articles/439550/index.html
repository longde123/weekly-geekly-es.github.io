<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëµüèø üì† üë®üèº‚Äçüíª Hackquest 2018. Resultados y rese√±as. D√≠a 1-3 üë®üèø‚Äç‚öïÔ∏è üçÇ üßëüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Siete d√≠as de la hackquest anual: siete tareas que deben resolverse para obtener entradas gratuitas para Zeronights. En este art√≠culo, le sugerimos qu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hackquest 2018. Resultados y rese√±as. D√≠a 1-3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/439550/">  Siete d√≠as de la hackquest anual: siete tareas que deben resolverse para obtener entradas gratuitas para Zeronights.  En este art√≠culo, le sugerimos que se familiarice con las decisiones de algunos de ellos y que conozca los nombres de los ganadores.  Por conveniencia, dividiremos la publicaci√≥n en dos partes. <br><br><img src="https://habrastorage.org/webt/jj/qb/xq/jjqbxqnsrm-seiggaml7mqlmu8a.jpeg"><br><a name="habracut"></a><br><h2>  Contenido </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">D√≠a1.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Galois</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">D√≠a2.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Blackanwyte</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">D√≠a 3</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Abr√°zame</a> </li></ul><br><img src="https://habrastorage.org/webt/6y/ly/bk/6ylybk2aipk3tm8um1mfhesupa4.jpeg"><br><br><h2><a name="Galois"></a>  D√≠a1.  Galois </h2><br>  Para obtener ayuda en la preparaci√≥n de esta tarea, gracias <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">REhints</a> . <br>  <i>"El desaf√≠o es tan f√°cil como el siguiente: descargue el binario (pase: infectado), realice ingenier√≠a inversa y recupere dos secretos que el binario aceptar√°.</i>  <i>Cada secreto es una cadena ASCII.</i>  <i>Tendr√≠a que resolver la primera etapa primero antes de atacar la segunda.</i>  <i>¬°Buena suerte y que Galois est√© contigo!</i> <br><br>  Para obtener la bandera, se deben ingresar dos valores secretos secuencialmente: <br><br><img src="https://habrastorage.org/webt/2f/nh/ph/2fnhphrqml3heam7sitcp_nekgk.png" alt="imagen"><br><br>  Por las l√≠neas de los mensajes nos metemos en la funci√≥n: <br><br><div class="spoiler">  <b class="spoiler_title">DialogFunc</b> <div class="spoiler_text"><pre><code class="python hljs">BOOL __stdcall DialogFunc(HWND hWnd, UINT a2, WPARAM a3, LPARAM a4) { HWND v5; // eax HWND v6; // eax HWND v7; // eax HWND v8; // eax HWND v9; // eax HWND v10; // eax CHAR v11; // [esp+<span class="hljs-number"><span class="hljs-number">0</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-5</span></span>Ch] CHAR String[<span class="hljs-number"><span class="hljs-number">20</span></span>]; // [esp+<span class="hljs-number"><span class="hljs-number">2</span></span>Ch] [ebp<span class="hljs-number"><span class="hljs-number">-30</span></span>h] struct tagRECT Rect; // [esp+<span class="hljs-number"><span class="hljs-number">40</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-1</span></span>Ch] UINT v14; // [esp+<span class="hljs-number"><span class="hljs-number">50</span></span>h] [ebp-Ch] HDC hdc; // [esp+<span class="hljs-number"><span class="hljs-number">54</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-8</span></span>h] unsigned int i; // [esp+<span class="hljs-number"><span class="hljs-number">58</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-4</span></span>h] v14 = a2; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( a2 == <span class="hljs-number"><span class="hljs-number">20</span></span> ) { hdc = (HDC)a3; GetClientRect(hWnd, &amp;Rect); SetMapMode(hdc, <span class="hljs-number"><span class="hljs-number">8</span></span>); SetWindowExtEx(hdc, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); SetViewportExtEx(hdc, Rect.right, Rect.bottom, <span class="hljs-number"><span class="hljs-number">0</span></span>); FillRect(hdc, &amp;Rect, hbr); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( v14 == <span class="hljs-number"><span class="hljs-number">272</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( v14 != <span class="hljs-number"><span class="hljs-number">273</span></span> || HIWORD(a3) ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (unsigned __int16)a3 == <span class="hljs-number"><span class="hljs-number">1</span></span> ) { EndDialog(hWnd, (unsigned __int16)a3); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (unsigned __int16)a3 != <span class="hljs-number"><span class="hljs-number">1002</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (unsigned __int16)a3 == <span class="hljs-number"><span class="hljs-number">1004</span></span> ) { sub_42E7C0(&amp;v11, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">42</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( GetDlgItemTextA(hWnd, <span class="hljs-number"><span class="hljs-number">1005</span></span>, &amp;v11, <span class="hljs-number"><span class="hljs-number">42</span></span>) &lt;= <span class="hljs-number"><span class="hljs-number">0x27</span></span> &amp;&amp; (unsigned __int8)sub_42CEF0(&amp;v11) ) { v9 = GetDlgItem(hWnd, <span class="hljs-number"><span class="hljs-number">1004</span></span>); EnableWindow(v9, <span class="hljs-number"><span class="hljs-number">0</span></span>); v10 = GetDlgItem(hWnd, <span class="hljs-number"><span class="hljs-number">1005</span></span>); EnableWindow(v10, <span class="hljs-number"><span class="hljs-number">0</span></span>); MessageBoxW(hWnd, L<span class="hljs-string"><span class="hljs-string">"Good job!"</span></span>, L<span class="hljs-string"><span class="hljs-string">"Success"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } MessageBoxW(hWnd, L<span class="hljs-string"><span class="hljs-string">"Keep trying!"</span></span>, L<span class="hljs-string"><span class="hljs-string">"Rejected"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( GetDlgItemTextA(hWnd, <span class="hljs-number"><span class="hljs-number">1001</span></span>, String, <span class="hljs-number"><span class="hljs-number">18</span></span>) != <span class="hljs-number"><span class="hljs-number">16</span></span> || !(unsigned __int8)sub_4014E0(String) ) { MessageBoxW(hWnd, L<span class="hljs-string"><span class="hljs-string">"Keep trying!"</span></span>, L<span class="hljs-string"><span class="hljs-string">"Rejected"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } v5 = GetDlgItem(hWnd, <span class="hljs-number"><span class="hljs-number">1002</span></span>); EnableWindow(v5, <span class="hljs-number"><span class="hljs-number">0</span></span>); v6 = GetDlgItem(hWnd, <span class="hljs-number"><span class="hljs-number">1001</span></span>); EnableWindow(v6, <span class="hljs-number"><span class="hljs-number">0</span></span>); v7 = GetDlgItem(hWnd, <span class="hljs-number"><span class="hljs-number">1005</span></span>); EnableWindow(v7, <span class="hljs-number"><span class="hljs-number">1</span></span>); v8 = GetDlgItem(hWnd, <span class="hljs-number"><span class="hljs-number">1004</span></span>); EnableWindow(v8, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">0x28</span></span>; ++i ) *((_BYTE *)&amp;dword_442780 + i) ^= String[(signed int)i % <span class="hljs-number"><span class="hljs-number">16</span></span>]; MessageBoxW(hWnd, L<span class="hljs-string"><span class="hljs-string">"Stage #2 unlocked!"</span></span>, L<span class="hljs-string"><span class="hljs-string">"Accepted"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; }</code> </pre> <br></div></div><br>  Para llegar a <b>"Etapa # 2 desbloqueado!"</b>  , debe pasar la prueba en la funci√≥n <code>sub_4014E0</code> (longitud de cadena - 16 caracteres).  Y antes del <b>"¬°Buen trabajo!"</b>  - una comprobaci√≥n m√°s en <code>sub_42CEF0</code> (la longitud de la segunda l√≠nea es inferior a 40 caracteres). <br><br><h4>  Etapa # 1 </h4><br><pre> <code class="python hljs">char __cdecl sub_4014E0(char *a1) { int v1; // ecx unsigned __int128 var_1018[<span class="hljs-number"><span class="hljs-number">256</span></span>]; // [esp+<span class="hljs-number"><span class="hljs-number">0</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-1018</span></span>h] unsigned __int128 var_18; // [esp+<span class="hljs-number"><span class="hljs-number">1000</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-18</span></span>h] int v5; // [esp+<span class="hljs-number"><span class="hljs-number">1010</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-8</span></span>h] char v6; // [esp+<span class="hljs-number"><span class="hljs-number">1017</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-1</span></span>h] sub_438740(<span class="hljs-number"><span class="hljs-number">0x1018</span></span>u, v1); sub_43A460(var_1018, xmmword_4427A8, <span class="hljs-number"><span class="hljs-number">0x1000</span></span>u); sub_4010E0(a1, var_1018); sub_401250(var_1018, &amp;var_18); v5 = sub_438845(var_18, &amp;xmmword_442770, <span class="hljs-number"><span class="hljs-number">0x10</span></span>u); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !v5 ) v6 = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v6; }</code> </pre> <br>  Debajo del depurador, puede verificar que <code>sub_43A460</code> copia datos de: <br><img src="https://habrastorage.org/webt/ic/vj/ev/icvjevuzpvv54fktt0jfvxtaqow.jpeg" alt="imagen"><br><br>  Y <code>sub_438845</code> compara el valor con: <br> <code>.data:00442770 xmmword_442770 9698CA91EE29902C60D377C981589205h</code> <br> <br>  Los datos se presentan en forma de n√∫meros de 128 bits, porque result√≥ ser m√°s conveniente en el curso de un an√°lisis posterior. <br><br><div class="spoiler">  <b class="spoiler_title">Sub_4010E0 funci√≥n</b> <div class="spoiler_text"><pre> <code class="python hljs">void __cdecl sub_4010E0(unsigned __int128 *a1, unsigned __int128 *a2) { signed int i; // [esp+<span class="hljs-number"><span class="hljs-number">4</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-8</span></span>h] signed int j; // [esp+<span class="hljs-number"><span class="hljs-number">8</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-4</span></span>h] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">128</span></span>; ++i ) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">128</span></span>; ++j ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (*((_DWORD *)a1 + (j &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) &gt;&gt; (j &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>)) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !((*((_DWORD *)a1 + ((j + <span class="hljs-number"><span class="hljs-number">1</span></span>) % <span class="hljs-number"><span class="hljs-number">128</span></span> &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) &gt;&gt; ((j + <span class="hljs-number"><span class="hljs-number">1</span></span>) % <span class="hljs-number"><span class="hljs-number">128</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>)) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) ) *((_DWORD *)&amp;a2[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + ((j + <span class="hljs-number"><span class="hljs-number">128</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; ((j + <span class="hljs-number"><span class="hljs-number">-128</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { *((_DWORD *)&amp;a2[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + (j &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; (j &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>)); *((_DWORD *)&amp;a2[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + ((j + <span class="hljs-number"><span class="hljs-number">128</span></span>) &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; ((j + <span class="hljs-number"><span class="hljs-number">-128</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>)); } } } }</code> </pre> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">La misma funci√≥n en una forma algo simplificada</b> <div class="spoiler_text"><pre> <code class="python hljs">void __cdecl sub_4010E0(unsigned __int128 *a1, unsigned __int128 *a2) { signed int i; // [esp+<span class="hljs-number"><span class="hljs-number">4</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-8</span></span>h] signed int j; // [esp+<span class="hljs-number"><span class="hljs-number">8</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-4</span></span>h] signed int j_1; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">128</span></span>; ++i ) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">128</span></span>; ++j ) { j_1 = (j + <span class="hljs-number"><span class="hljs-number">1</span></span>) % <span class="hljs-number"><span class="hljs-number">128</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( (*((_DWORD *)a1 + j / <span class="hljs-number"><span class="hljs-number">32</span></span>) &gt;&gt; (j % <span class="hljs-number"><span class="hljs-number">32</span></span>)) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( !((*((_DWORD *)a1 + j_1 / <span class="hljs-number"><span class="hljs-number">32</span></span>) &gt;&gt; (j_1 % <span class="hljs-number"><span class="hljs-number">32</span></span>)) &amp; <span class="hljs-number"><span class="hljs-number">1</span></span>) ) *((_DWORD *)&amp;a2[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + <span class="hljs-number"><span class="hljs-number">4</span></span> + j / <span class="hljs-number"><span class="hljs-number">32</span></span>) &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; (j % <span class="hljs-number"><span class="hljs-number">32</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { *((_DWORD *)&amp;a2[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + j / <span class="hljs-number"><span class="hljs-number">32</span></span>) &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; (j % <span class="hljs-number"><span class="hljs-number">32</span></span>)); *((_DWORD *)&amp;a2[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + <span class="hljs-number"><span class="hljs-number">4</span></span> + j / <span class="hljs-number"><span class="hljs-number">32</span></span>) &amp;= ~(<span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; (j % <span class="hljs-number"><span class="hljs-number">32</span></span>)); } } } }</code> </pre> <br></div></div><br>  Para cada par de n√∫meros de 128 bits tratados por el segundo argumento, el ciclo recorre 128 bits de la cadena de entrada (el primer argumento) y, si el bit es 0, restablece los bits correspondientes (esencialmente realiza la operaci√≥n AND).  Para el segundo n√∫mero de un par de bits, tambi√©n se restablece si el siguiente bit de la secuencia es 0. <br>  En python, se ve m√°s o menos as√≠: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sub_4010E0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a1, a2)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">128</span></span>): a2[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] &amp;= a1 a2[<span class="hljs-number"><span class="hljs-number">2</span></span> * i + <span class="hljs-number"><span class="hljs-number">1</span></span>] &amp;= a1 &amp; (a1 &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Funci√≥n sub_401250</b> <div class="spoiler_text"><pre> <code class="python hljs">void __cdecl sub_401250(unsigned __int128 *a1, unsigned __int128 *a2) { signed int k; // [esp+<span class="hljs-number"><span class="hljs-number">4</span></span>h] [ebp-Ch] signed int j; // [esp+<span class="hljs-number"><span class="hljs-number">8</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-8</span></span>h] signed int i; // [esp+Ch] [ebp<span class="hljs-number"><span class="hljs-number">-4</span></span>h] *(_QWORD *)a2 = <span class="hljs-number"><span class="hljs-number">0</span></span>i64; *((_QWORD *)a2 + <span class="hljs-number"><span class="hljs-number">1</span></span>) = <span class="hljs-number"><span class="hljs-number">0</span></span>i64; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">128</span></span>; ++i ) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( j = <span class="hljs-number"><span class="hljs-number">0</span></span>; j &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; ++j ) *((_DWORD *)&amp;a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + j) ^= *((_DWORD *)&amp;a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i + <span class="hljs-number"><span class="hljs-number">1</span></span>] + j); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ( k = <span class="hljs-number"><span class="hljs-number">0</span></span>; k &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; ++k ) *((_DWORD *)&amp;a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + k) ^= *((_DWORD *)&amp;a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] + k + <span class="hljs-number"><span class="hljs-number">2</span></span>); LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) ^= DWORD1(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]); LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) ^= LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>; LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) ^= LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>; LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) ^= LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>; LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) ^= LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) &gt;&gt; <span class="hljs-number"><span class="hljs-number">2</span></span>; LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) ^= LODWORD(a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i]) &gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( a1[<span class="hljs-number"><span class="hljs-number">2</span></span> * i] &amp; <span class="hljs-number"><span class="hljs-number">1</span></span> ) *((_DWORD *)a2 + (i &gt;&gt; <span class="hljs-number"><span class="hljs-number">5</span></span>)) |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; (i &amp; <span class="hljs-number"><span class="hljs-number">0x1F</span></span>); } }</code> </pre> <br></div></div><br>  La funci√≥n pliega cada par resultante en un bit, realizando un XOR entre todos los bits.  Recibi√≥ 128 bits y form√≥ un n√∫mero en comparaci√≥n con el dado. <br><br>  Para encontrar una soluci√≥n, usamos el solucionador z3. <br><br><div class="spoiler">  <b class="spoiler_title">Con reemplazos simples en un cuaderno, convertimos la matriz xmmword_4427A8 en un sistema (los ceros y los de la izquierda son el n√∫mero xmmword_442770)</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> z3 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * init(<span class="hljs-string"><span class="hljs-string">'../'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xor_bits</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> x = Extract(<span class="hljs-number"><span class="hljs-number">63</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, x) ^ Extract(<span class="hljs-number"><span class="hljs-number">127</span></span>, <span class="hljs-number"><span class="hljs-number">64</span></span> ,x) x = Extract(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, x) ^ Extract(<span class="hljs-number"><span class="hljs-number">63</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>, x) x = Extract(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, x) ^ Extract(<span class="hljs-number"><span class="hljs-number">31</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>, x) x = Extract(<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, x) ^ Extract(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, x) x = Extract(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, x) ^ Extract(<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, x) x = Extract(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, x) ^ Extract(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Extract(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, x) ^ Extract(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, x) x = BitVec(<span class="hljs-string"><span class="hljs-string">'x'</span></span>, <span class="hljs-number"><span class="hljs-number">128</span></span>) s = Solver() <span class="hljs-comment"><span class="hljs-comment"># 0x9698CA91EE29902C60D377C981589205 s.add(1 == xor_bits(BitVecVal(0x23B617F87A29, 128) &amp; x) ^ xor_bits(BitVecVal(0x19203F83800, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1091, 128) &amp; x) ^ xor_bits(BitVecVal(0x0, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xC1C283565E, 128) &amp; x) ^ xor_bits(BitVecVal(0xC001020E, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x2C1A78A0, 128) &amp; x) ^ xor_bits(BitVecVal(0x4083800, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1B, 128) &amp; x) ^ xor_bits(BitVecVal(0x1, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x2BD, 128) &amp; x) ^ xor_bits(BitVecVal(0x1C, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x6434999B6302B0DBCA8123800BE, 128) &amp; x) ^ xor_bits(BitVecVal(0x10088921001049C000018001E, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x613, 128) &amp; x) ^ xor_bits(BitVecVal(0x1, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x16129091D4A1C4, 128) &amp; x) ^ xor_bits(BitVecVal(0x2000000C000C0, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x91, 128) &amp; x) ^ xor_bits(BitVecVal(0x0, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x76749651E3D6AD117C5AF, 128) &amp; x) ^ xor_bits(BitVecVal(0x12300200E1C204003C087, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x42FED750966FE5, 128) &amp; x) ^ xor_bits(BitVecVal(0x7E43000227E0, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x19D096E5D570B, 128) &amp; x) ^ xor_bits(BitVecVal(0xC00260C0301, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x2BD67AA37EC064C89AF12D97, 128) &amp; x) ^ xor_bits(BitVecVal(0x1C238013E40204008700483, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x3372FB29B7426152C739DB374312B, 128) &amp; x) ^ xor_bits(BitVecVal(0x1307900930020004318C91301001, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x56D0FAF2FF, 128) &amp; x) ^ xor_bits(BitVecVal(0x24078707F, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x5AAEFBCEFB063DB41635, 128) &amp; x) ^ xor_bits(BitVecVal(0x80679C679021C900210, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x6388B6598BDD29D10862B2D9DC0B95, 128) &amp; x) ^ xor_bits(BitVecVal(0x180120881CC00C000201048CC0180, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1BB63AF4CE98D27, 128) &amp; x) ^ xor_bits(BitVecVal(0x19218704608403, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x5D4D30E2F6807C1D, 128) &amp; x) ^ xor_bits(BitVecVal(0xC04106072003C0C, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x71AE40387FEFC85, 128) &amp; x) ^ xor_bits(BitVecVal(0x108600183FE7C00, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1E320DC34999A60A93AE, 128) &amp; x) ^ xor_bits(BitVecVal(0x61004C1008882000186, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x2F52, 128) &amp; x) ^ xor_bits(BitVecVal(0x700, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xB9D4158F29C2CAEC9, 128) &amp; x) ^ xor_bits(BitVecVal(0x18C0008700C040640, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x6347962CDB1BC, 128) &amp; x) ^ xor_bits(BitVecVal(0x10382044909C, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xA2FF40, 128) &amp; x) ^ xor_bits(BitVecVal(0x7F00, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x6, 128) &amp; x) ^ xor_bits(BitVecVal(0x0, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x21FFD0D835722CFF409DD38B2E11, 128) &amp; x) ^ xor_bits(BitVecVal(0xFFC0481030047F000CC1810600, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x466DC3, 128) &amp; x) ^ xor_bits(BitVecVal(0x224C1, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x45D44FF2, 128) &amp; x) ^ xor_bits(BitVecVal(0xC007F0, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x13ACE, 128) &amp; x) ^ xor_bits(BitVecVal(0x1846, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x3FB1EAE727AD49CCA3, 128) &amp; x) ^ xor_bits(BitVecVal(0xF90E063038400C401, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xB35AD528D, 128) &amp; x) ^ xor_bits(BitVecVal(0x110840004, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x135AB5C363654340F464007DC58, 128) &amp; x) ^ xor_bits(BitVecVal(0x10810C1212001007020003CC08, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x405E95920EEE57BE0E0A51677D05, 128) &amp; x) ^ xor_bits(BitVecVal(0xE00800666039E060000233C00, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xB4DEE4643A9F3218C6, 128) &amp; x) ^ xor_bits(BitVecVal(0x104E6020180F100842, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x678D930A747F3D1CCCC727B, 128) &amp; x) ^ xor_bits(BitVecVal(0x3848100303F1C0C4443039, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x2DB2654501D47A394DC9A, 128) &amp; x) ^ xor_bits(BitVecVal(0x490200000C0381804C08, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xE86CDA733EA, 128) &amp; x) ^ xor_bits(BitVecVal(0x202448311E0, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x13124A8FCA2ADE475, 128) &amp; x) ^ xor_bits(BitVecVal(0x1000007C0004E030, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x44F8BC5F2E3551A9F94F8B2221EF6F3, 128) &amp; x) ^ xor_bits(BitVecVal(0x781C0F06100080F807810000E7271, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x27274, 128) &amp; x) ^ xor_bits(BitVecVal(0x3030, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x3558FA658C2, 128) &amp; x) ^ xor_bits(BitVecVal(0x87820840, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1C4CDE17C7DE9258195055E9265D221, 128) &amp; x) ^ xor_bits(BitVecVal(0x4044E03C3CE0008080000E0020C000, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x760DB29068A310965, 128) &amp; x) ^ xor_bits(BitVecVal(0x12049000200100020, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x5F6FB1F353B814B83DFAB039F, 128) &amp; x) ^ xor_bits(BitVecVal(0xF2790F1019800181CF81018F, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xBC0919D732BD93E1E7977D3B7B, 128) &amp; x) ^ xor_bits(BitVecVal(0x1C0008C3101C81E0E3833C1939, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x5D31D733E3387235ECC, 128) &amp; x) ^ xor_bits(BitVecVal(0xC10C311E1183010E44, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x2F6A4694FA4052C180C72D95FF, 128) &amp; x) ^ xor_bits(BitVecVal(0x72002007800004080430480FF, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xFFBC69460FD68BE9D350, 128) &amp; x) ^ xor_bits(BitVecVal(0x3F9C200207C201E0C100, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x14BDFBEFE7, 128) &amp; x) ^ xor_bits(BitVecVal(0x1CF9E7E3, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x253F95DEE35BCE76A0EA615EB11D698, 128) &amp; x) ^ xor_bits(BitVecVal(0x1F80CE6109C6320060200E100C208, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x161B1831E960, 128) &amp; x) ^ xor_bits(BitVecVal(0x2090810E020, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xE60, 128) &amp; x) ^ xor_bits(BitVecVal(0x220, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x1, 128) &amp; x) ^ xor_bits(BitVecVal(0x0, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x27A34B, 128) &amp; x) ^ xor_bits(BitVecVal(0x38101, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x2A6578A4772D94E8, 128) &amp; x) ^ xor_bits(BitVecVal(0x20380033048060, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x27D96036E73482CFEBC7, 128) &amp; x) ^ xor_bits(BitVecVal(0x3C8201263100047E1C3, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xF7D2916E7B86CBC1EAA90C6D91CBD6D2, 128) &amp; x) ^ xor_bits(BitVecVal(0x33C00026398241C0E000042480C1C240, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x7F5C045BF883B66C591E7D63, 128) &amp; x) ^ xor_bits(BitVecVal(0x1F0C0009F8019224080E3C21, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x230C9D771C, 128) &amp; x) ^ xor_bits(BitVecVal(0x1040C330C, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x65C3, 128) &amp; x) ^ xor_bits(BitVecVal(0xC1, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xA0F976CAC739C6EA72493E20A84D29, 128) &amp; x) ^ xor_bits(BitVecVal(0x7832404318C26030001E00000400, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x5C14054D9, 128) &amp; x) ^ xor_bits(BitVecVal(0xC0000048, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xB36DDC2F, 128) &amp; x) ^ xor_bits(BitVecVal(0x1124CC07, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x204B38A49FB9E97EFBE5E5, 128) &amp; x) ^ xor_bits(BitVecVal(0x118000F98E03E79E0E0, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x2B98A6879C51C9A3FC98297AC62FAAE5, 128) &amp; x) ^ xor_bits(BitVecVal(0x18802038C00C081FC08003842078060, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x102B85, 128) &amp; x) ^ xor_bits(BitVecVal(0x180, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x13EEC3E9B7A62DE368BF9, 128) &amp; x) ^ xor_bits(BitVecVal(0x1E641E0938204E1201F8, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x52225B78259, 128) &amp; x) ^ xor_bits(BitVecVal(0x938008, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x16C9B2152C1AD870E0D19D979D3158F8, 128) &amp; x) ^ xor_bits(BitVecVal(0x24090000408483060408C838C100878, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x3D6A84016CE76CDF9788C6CF07988A, 128) &amp; x) ^ xor_bits(BitVecVal(0xC2000002463244F83804247038800, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x45B1FFF0C4B02E1605, 128) &amp; x) ^ xor_bits(BitVecVal(0x90FFF04010060200, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x4A67A61, 128) &amp; x) ^ xor_bits(BitVecVal(0x23820, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x6E, 128) &amp; x) ^ xor_bits(BitVecVal(0x6, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1D6BB8D17902FB4A8F, 128) &amp; x) ^ xor_bits(BitVecVal(0x42198403800790007, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x8FA1BC3BDBC15350, 128) &amp; x) ^ xor_bits(BitVecVal(0x7809C19C9C00100, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x168, 128) &amp; x) ^ xor_bits(BitVecVal(0x20, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xBBE7539D2F7076F4CE1FCC1EF3CA8EB, 128) &amp; x) ^ xor_bits(BitVecVal(0x19E3018C07303270460FC40E71C0061, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x1DC9E17, 128) &amp; x) ^ xor_bits(BitVecVal(0x4C0E03, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x8985169ABA2ED, 128) &amp; x) ^ xor_bits(BitVecVal(0x80020818064, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xE1BBE1C0CD10, 128) &amp; x) ^ xor_bits(BitVecVal(0x2099E0C04400, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x7D371F4E0F5F0BF3F03955, 128) &amp; x) ^ xor_bits(BitVecVal(0x1C130F06070F01F1F01800, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x3C0E6DF6B620EE, 128) &amp; x) ^ xor_bits(BitVecVal(0xC0624F2120066, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x856D694, 128) &amp; x) ^ xor_bits(BitVecVal(0x24200, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xE, 128) &amp; x) ^ xor_bits(BitVecVal(0x2, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1CF36E1E92DDA26711DF8173584D, 128) &amp; x) ^ xor_bits(BitVecVal(0x471260E004C802300CF80310804, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x8CDA56927574B1719C6698849, 128) &amp; x) ^ xor_bits(BitVecVal(0x4480200303010308C2208000, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x18F63280A9C35EAE, 128) &amp; x) ^ xor_bits(BitVecVal(0x72100000C10E06, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x1B6D7D560CA2D83B5146C79, 128) &amp; x) ^ xor_bits(BitVecVal(0x1243C02040048190002438, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x7D5EC3A7E8F086BD8C888FB73A7AA, 128) &amp; x) ^ xor_bits(BitVecVal(0x1C0E4183E070021C8400079318380, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x3E, 128) &amp; x) ^ xor_bits(BitVecVal(0xE, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x71C2EA7DD6721FBB31A755F7F0, 128) &amp; x) ^ xor_bits(BitVecVal(0x10C0603CC2300F99108300F3F0, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x1D8006A2ECC30EC6E96060612484CB, 128) &amp; x) ^ xor_bits(BitVecVal(0x48002006441064260202020000041, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x40D7BF53BD2B, 128) &amp; x) ^ xor_bits(BitVecVal(0x439F019C01, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x31B9C7CE6BA08F87CBB, 128) &amp; x) ^ xor_bits(BitVecVal(0x98C3C621800783C19, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x3, 128) &amp; x) ^ xor_bits(BitVecVal(0x0, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x389D589A2F5D200CF, 128) &amp; x) ^ xor_bits(BitVecVal(0x80C0808070C00047, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x66E1D, 128) &amp; x) ^ xor_bits(BitVecVal(0x260C, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xAE40064FE2D6E6, 128) &amp; x) ^ xor_bits(BitVecVal(0x6000207E04262, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0xB2F81EBF410D713BCBE, 128) &amp; x) ^ xor_bits(BitVecVal(0x10780E1F00043019C1E, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xA487A1A738B137F6E5F0A12285E4, 128) &amp; x) ^ xor_bits(BitVecVal(0x38083181013F260F0000000E0, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xEF2F92935FDEFCBF4D5822E, 128) &amp; x) ^ xor_bits(BitVecVal(0x270780010FCE7C1F0408006, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x3A4B402B51711661FBC7B32BE93, 128) &amp; x) ^ xor_bits(BitVecVal(0x801000100300220F9C39101E01, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x35DD6F859D74F, 128) &amp; x) ^ xor_bits(BitVecVal(0xCC27808C307, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x21F407CE26E40E2, 128) &amp; x) ^ xor_bits(BitVecVal(0xF003C60260060, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x375BF3A, 128) &amp; x) ^ xor_bits(BitVecVal(0x309F18, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x181A253BC548D3FBC8AE18E23, 128) &amp; x) ^ xor_bits(BitVecVal(0x80019C00041F9C00608601, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1F509272889043217CFC56, 128) &amp; x) ^ xor_bits(BitVecVal(0x7000030000001003C7C02, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x22054C3647A1536F25EBA457C, 128) &amp; x) ^ xor_bits(BitVecVal(0x4120380012700E18003C, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x153BFBDD, 128) &amp; x) ^ xor_bits(BitVecVal(0x19F9CC, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x9D2B6EBF232E4A9, 128) &amp; x) ^ xor_bits(BitVecVal(0xC01261F0106000, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xA52B, 128) &amp; x) ^ xor_bits(BitVecVal(0x1, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x330D8F33869AED44B8A5255, 128) &amp; x) ^ xor_bits(BitVecVal(0x1048711820864001800000, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x17CBFC73336, 128) &amp; x) ^ xor_bits(BitVecVal(0x3C1FC31112, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x8D6AF39F592011E48AA7CB4B, 128) &amp; x) ^ xor_bits(BitVecVal(0x420718F080000E00003C101, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x14A33B1D24F27764FB0656A8CF, 128) &amp; x) ^ xor_bits(BitVecVal(0x1190C007033207902020047, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xED0C2, 128) &amp; x) ^ xor_bits(BitVecVal(0x24040, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1480871DCFB0535517EBBFB28DCA6, 128) &amp; x) ^ xor_bits(BitVecVal(0x30CC790010003E19F9004C02, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x56D11B00CAFA443E11C9393D655A2375, 128) &amp; x) ^ xor_bits(BitVecVal(0x24009004078001E00C0181C20080130, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xD2CA4211947191AE2C9B9F70FE7, 128) &amp; x) ^ xor_bits(BitVecVal(0x4000008030808604098F307E3, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x12EEF0835, 128) &amp; x) ^ xor_bits(BitVecVal(0x6670010, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x297C1A8D8, 128) &amp; x) ^ xor_bits(BitVecVal(0x3C08048, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xAF5FBBA6506348A9199FC, 128) &amp; x) ^ xor_bits(BitVecVal(0x70F998200210000088FC, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x82FE3E666BB603B908E800, 128) &amp; x) ^ xor_bits(BitVecVal(0x7E1E2221920198006000, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0xB72AF73E919A14C2273070ED5C1DC, 128) &amp; x) ^ xor_bits(BitVecVal(0x1300731E00880040031030640C0CC, 128) &amp; x &amp; RotateRight(x,1))) s.add(0 == xor_bits(BitVecVal(0x1FBD2A505F0CA679799, 128) &amp; x) ^ xor_bits(BitVecVal(0x79C00000F040238388, 128) &amp; x &amp; RotateRight(x,1))) s.add(1 == xor_bits(BitVecVal(0x1D0F097C310F92E3C2BF8D42, 128) &amp; x) ^ xor_bits(BitVecVal(0x407003C10078061C01F8400, 128) &amp; x &amp; RotateRight(x,1))) print(s.check()) model = s.model() print(model)</span></span></code> </pre> <br></div></div><br>  Al convertir los bits encontrados en una cadena, obtenemos la primera clave: <b>ItWasJustAWarmUp</b> . <br><br><h4>  Etapa # 2 </h4><br><pre> <code class="python hljs">bool __cdecl sub_42CEF0(char *a1) { bool result; // al __int64 v2; // [esp+<span class="hljs-number"><span class="hljs-number">0</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-3</span></span>Ch] __int64 v3; // [esp+<span class="hljs-number"><span class="hljs-number">8</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-34</span></span>h] __int64 v4; // [esp+<span class="hljs-number"><span class="hljs-number">10</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-2</span></span>Ch] __int64 v5; // [esp+<span class="hljs-number"><span class="hljs-number">18</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-24</span></span>h] __int64 v6; // [esp+<span class="hljs-number"><span class="hljs-number">20</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-1</span></span>Ch] int v7; // [esp+<span class="hljs-number"><span class="hljs-number">28</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-14</span></span>h] int v8; // [esp+<span class="hljs-number"><span class="hljs-number">2</span></span>Ch] [ebp<span class="hljs-number"><span class="hljs-number">-10</span></span>h] int v9; // [esp+<span class="hljs-number"><span class="hljs-number">30</span></span>h] [ebp-Ch] int v10; // [esp+<span class="hljs-number"><span class="hljs-number">34</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-8</span></span>h] int v11; // [esp+<span class="hljs-number"><span class="hljs-number">38</span></span>h] [ebp<span class="hljs-number"><span class="hljs-number">-4</span></span>h] v6 = *(_QWORD *)a1; v5 = *((_QWORD *)a1 + <span class="hljs-number"><span class="hljs-number">1</span></span>); v4 = *((_QWORD *)a1 + <span class="hljs-number"><span class="hljs-number">2</span></span>); v3 = *((_QWORD *)a1 + <span class="hljs-number"><span class="hljs-number">3</span></span>); v2 = *((_QWORD *)a1 + <span class="hljs-number"><span class="hljs-number">4</span></span>); (**off_444360)(off_444360, &amp;v6, <span class="hljs-number"><span class="hljs-number">0</span></span>, off_44435C); (**off_444360)(off_444360, &amp;v5, <span class="hljs-number"><span class="hljs-number">0</span></span>, off_44435C); (**off_444360)(off_444360, &amp;v4, <span class="hljs-number"><span class="hljs-number">0</span></span>, off_44435C); (**off_444360)(off_444360, &amp;v3, <span class="hljs-number"><span class="hljs-number">0</span></span>, off_44435C); (**off_444360)(off_444360, &amp;v2, <span class="hljs-number"><span class="hljs-number">0</span></span>, off_44435C); v11 = <span class="hljs-number"><span class="hljs-number">0</span></span>; result = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( v6 == qword_442780 ) { v10 = <span class="hljs-number"><span class="hljs-number">8</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( v5 == __PAIR__(*((_DWORD *)&amp;qword_442780 + <span class="hljs-number"><span class="hljs-number">3</span></span>), *((_DWORD *)&amp;qword_442780 + <span class="hljs-number"><span class="hljs-number">2</span></span>)) ) { v9 = <span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( v4 == __PAIR__(*((_DWORD *)&amp;qword_442780 + <span class="hljs-number"><span class="hljs-number">5</span></span>), *((_DWORD *)&amp;qword_442780 + <span class="hljs-number"><span class="hljs-number">4</span></span>)) ) { v8 = <span class="hljs-number"><span class="hljs-number">24</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( v3 == __PAIR__(*((_DWORD *)&amp;qword_442780 + <span class="hljs-number"><span class="hljs-number">7</span></span>), *((_DWORD *)&amp;qword_442780 + <span class="hljs-number"><span class="hljs-number">6</span></span>)) ) { v7 = <span class="hljs-number"><span class="hljs-number">32</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( v2 == __PAIR__(*((_DWORD *)&amp;qword_442780 + <span class="hljs-number"><span class="hljs-number">9</span></span>), *((_DWORD *)&amp;qword_442780 + <span class="hljs-number"><span class="hljs-number">8</span></span>)) ) result = <span class="hljs-number"><span class="hljs-number">1</span></span>; } } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br>  La cadena ingresada se representa como cinco n√∫meros de 64 bits, cuyo resultado de conversi√≥n se compara con la matriz. <br><img src="https://habrastorage.org/webt/ty/ha/jq/tyhajqtv8_mz7hpk5asznucoxmc.jpeg" alt="imagen"><br>  Caminando debajo del depurador, vemos la siguiente secuencia de llamadas a funciones: <br><img src="https://habrastorage.org/webt/wn/ak/ob/wnakobxcpuzp-h7rt9bkawfjtzq.jpeg"><br>  Hasta ahora est√° claro que el tercer argumento se pasa a lo largo de la cadena de llamadas, a veces el m√≥dulo 2 se pliega con una unidad, a veces con el siguiente bit de la cadena de entrada (aunque algunos bits, por ejemplo, el primero, se omiten). <br><br>  Veamos d√≥nde se produce la conversi√≥n del n√∫mero convertido, colocando un punto de interrupci√≥n en el registro en los bytes de memoria correspondientes: <br><img src="https://habrastorage.org/webt/gw/l0/r2/gwl0r2lmdcwn_pp7whwkzjosju0.jpeg" alt="imagen"><br>  Es decir  el bit del n√∫mero se reemplaza con el valor del tercer argumento, su valor anterior se pasa (a veces invertido).  Se puede suponer que se produce la siguiente conversi√≥n: <br><pre> <code class="python hljs">a3 = xor_all_bits(input &amp; x) ^ y; output = ((input &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) ^ z) | a3;</code> </pre> <br><ul><li>  x define bits que no se omitieron en el primer paso; </li><li>  y depende de cu√°ntas veces se haya agregado una unidad (m√≥dulo 2); </li><li>  z corresponde a los bits invertidos en el segundo paso. </li></ul><br>  Para determinar las constantes desconocidas, obtenemos los valores convertidos para cero y n√∫meros con un conjunto de bits.  Para hacer esto, defina un contador <pre> <code class="python hljs">extern i; i = <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre>  y en la funci√≥n <code>sub_428FD0</code> antes de la siguiente ronda, colocamos un punto de interrupci√≥n con una condici√≥n que imprimir√° el valor del n√∫mero despu√©s de la llamada a la funci√≥n, establecer√° su pr√≥ximo valor y repetir√° la llamada a la funci√≥n. <br><pre> <code class="python hljs">print(Qword(Qword(ebp+<span class="hljs-number"><span class="hljs-number">8</span></span>))), i=i+<span class="hljs-number"><span class="hljs-number">1</span></span>, (i&lt;<span class="hljs-number"><span class="hljs-number">64</span></span>)?patch_qword(Qword(ebp+<span class="hljs-number"><span class="hljs-number">8</span></span>), __int64(<span class="hljs-number"><span class="hljs-number">1</span></span>) &lt;&lt; i)^(eip=<span class="hljs-number"><span class="hljs-number">0x428FE0</span></span>):<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  Se obtuvieron los siguientes valores: <br><img src="https://habrastorage.org/webt/bx/l0/lx/bxl0lxsriocb2s4hhvxdydbk36o.jpeg"><br>  De: <br><ul><li>  x = 0x11CE9E8E6CF2B888 </li><li>  y = 1 </li><li>  z = 0x8E2B550A6AEDD63A </li></ul><br>  Entonces, en Python, la funci√≥n de conversi√≥n se ve as√≠: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">xor_bits</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> a = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> x != <span class="hljs-number"><span class="hljs-number">0</span></span>: a ^= x &amp; <span class="hljs-number"><span class="hljs-number">1</span></span> x &gt;&gt;= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> x = ((x &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFFFFFFFFFFFFFFFF</span></span>) | xor_bits(x &amp; <span class="hljs-number"><span class="hljs-number">0x8e2b550a6aedd63a</span></span>) ^ <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x ^ <span class="hljs-number"><span class="hljs-number">0x11CE9E8E6CF2B888</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">64</span></span>): x = round(x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x</code> </pre> <br>  Y lo contrario a √©l: <br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rev_round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> x ^= <span class="hljs-number"><span class="hljs-number">0x11CE9E8E6CF2B888</span></span> a = x &amp; <span class="hljs-number"><span class="hljs-number">1</span></span> x &gt;&gt;= <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> xor_bits(x &amp; <span class="hljs-number"><span class="hljs-number">0x8e2b550a6aedd63a</span></span>) ^ <span class="hljs-number"><span class="hljs-number">1</span></span> != a: x |= <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">63</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decrypt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">64</span></span>): x = rev_round(x) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x</code> </pre> <br>  Aplicando la conversi√≥n a n√∫meros de la matriz <code>qword_442780</code> , obtenemos la cadena deseada: <b>YourReversingSkillsAreImpressive_zN2018</b> . <br><img src="https://habrastorage.org/webt/ct/pe/k1/ctpek1wbafy9dmddkek-seha5ec.jpeg"><br><h2><a name="Blackanwyte"></a>  D√≠a2.  Blackanwyte </h2><br>  Para obtener ayuda en la preparaci√≥n de la tarea, agradezca a Vlad Roskov de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">@leetmore</a> . <br><br><img src="https://habrastorage.org/webt/2j/b6/jx/2jb6jxqibzghaejpjnnslctsrzy.jpeg"><br><br>  Al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">hacer clic</a> en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">enlace,</a> vemos lo siguiente: <br><br><img src="https://habrastorage.org/webt/lg/ud/fw/lgudfwphldfkvxegz3u3mwekqw4.png"><br><br>  Se nos pide que ingresemos un c√≥digo promocional.  Veamos qu√© archivos se cargan cuando se abre la p√°gina. <br><br><img src="https://habrastorage.org/webt/lp/oa/nj/lpoanjncuynhc9iqgcdelygqdnm.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">Despu√©s de mirar whitebox.js encontramos una funci√≥n que verifica el c√≥digo promocional:</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/a3/sk/m1/a3skm1x5oulubi8gvp8bmong2k4.jpeg"><br></div></div><br>  En la variable <code>c</code> , se lee el texto ingresado;  comprueba si coincide con la expresi√≥n regular "/ \ d + - \ w + /", por lo que el c√≥digo promocional debe tener la forma "1234-ABCD".  A continuaci√≥n, el n√∫mero se convierte en binario, los ceros corresponden a "N" y las unidades - "Z".  Despu√©s de reorganizar los n√∫meros de la matriz <code>f</code> , en un ciclo de 4 letras de la cadena resultante, se toma el hash md5, y sus primeros cuatro caracteres se verifican con los caracteres correspondientes de la cadena "7177a294cfa7b53371776be5cfa74ddf". <br><br><div class="spoiler">  <b class="spoiler_title">Para obtener el n√∫mero correcto, escriba un peque√±o gui√≥n.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/iu/6t/ox/iu6toxic-6hujej3fmgqhnt0-xy.jpeg"><br></div></div><br>  Como resultado, obtenemos el n√∫mero requerido, la primera parte de nuestro c√≥digo promocional: 234082018. <br><br><img src="https://habrastorage.org/webt/d0/bm/d4/d0bmd4x5dp5dl0v7v6tlcizq5mk.jpeg"><br><br>  Pasamos la primera parte de la prueba.  Pasemos a la segunda: <br><br><img src="https://habrastorage.org/webt/6x/xu/7n/6xxu7nweyyite9y2y5f9hjoibiy.jpeg"><br><br>  Se puede ver que el valor devuelto por la funci√≥n <code>blackbox_check</code> est√° marcado, y si no se produce ning√∫n error, y es igual a "elee757bc7fd00d5", se env√≠a al servidor.  Sin embargo, en el archivo whitebox.js no se menciona <code>blackbox_check</code> , por lo que es hora de abrir blackbox.js. <br><br><div class="spoiler">  <b class="spoiler_title">Despu√©s de que el editor de texto logr√≥ abrir un archivo largo, vemos la funci√≥n blackbox_check que necesitamos en √©l, y en √©l una l√≠nea interesante (22).</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/yf/ik/hr/yfikhrvtzkiuainayygm7zmtpzm.jpeg"><br></div></div><br>  En Google, aprendemos que nos enfrentamos a un emulador escrito en Javascript. <br>  El byte del archivo ejecutable se almacena en el <code>code</code> variable, la l√≠nea 32 registra el c√≥digo promocional en la memoria y la l√≠nea 33 establece la direcci√≥n de la pila.  De la l√≠nea 41 se puede ver que el archivo comienza, comenzando con la direcci√≥n "0x080485E0". <br><br><div class="spoiler">  <b class="spoiler_title">Guarde el archivo ejecutable y vea qu√© contiene usando la IDA.</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ts/xr/wp/tsxrwpqe4drqooxfsv-4pnhy9ey.jpeg"><br></div></div><br>  Pasemos a blackbox_check.  Aqu√≠ vemos alg√∫n tipo de funci√≥n hash.  Despu√©s de varios intentos fallidos de encontrar oportunidades para la vulnerabilidad bruta r√°pida u otras vulnerabilidades en el algoritmo, notamos que el b√∫fer en el que se copia la parte de la l√≠nea despu√©s del gui√≥n se limita a solo 256 caracteres. <br><br><div class="spoiler">  <b class="spoiler_title">blackbox_check</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/_y/ga/i_/_ygai_3gdoxtiq9v5z_jp5segfq.jpeg"><br></div></div><br>  Verificamos con checksec y vemos que la pila es ejecutable: <br>  <i><b>Nota</b> : en la captura de pantalla y en el texto del autor de la vraytap hay discrepancias sobre si la pila es ejecutable.</i>  <i>De hecho, el c√≥digo se puede ejecutar.</i> <br><img src="https://habrastorage.org/webt/xp/2m/iw/xp2miw48fql0_ebvvrxgkzlvf6c.jpeg"><br><br>  Teniendo en cuenta que ya sabemos la direcci√≥n en la pila donde se escribir√° nuestra l√≠nea, depende de usted anotar los bytes de la l√≠nea "e1ee757bc7fd00d5" a la direcci√≥n deseada. <br><br><img src="https://habrastorage.org/webt/oy/zu/jg/oyzujgg7ljwhiydheuayv3b_xwa.jpeg"><br><br>  Enviamos la l√≠nea resultante a trav√©s de la consola y recogemos la bandera: <br><br><div class="spoiler">  <b class="spoiler_title">Cadena buscada</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mc/s5/qn/mcs5qnf4-sw7hsxlhgfw_awa-4a.jpeg"><br><img src="https://habrastorage.org/webt/zh/x0/eu/zhx0euqyzkz0gvwtqdgbz_yn7g4.jpeg"><br></div></div><br>  L√≠nea <b>buscada</b> : <b>Bl4CK_0r_wYT3_It5_z3r0Ni6hT</b> <br><br><img src="https://habrastorage.org/webt/pv/-y/as/pv-yas9adiclz53msvbznnvnwsi.jpeg"><br><br><h2><a name="Padme"></a>  D√≠a 3  Abr√°zame </h2><br>  <i>Hola, este grupo todav√≠a usa un sistema de mensajer√≠a antiguo.</i>  <i>Asumimos que los miembros tienen m√°s de treinta a√±os y esa es su criptograf√≠a.</i>  <i>Intenta encontrar defectos all√≠.</i>  <i>Su sistema de mensajer√≠a est√° en 51.15.79.170 ¬øY sabes qu√©?</i>  <i>Podr√≠amos interceptar una parte de su solicitud de autenticaci√≥n.</i> <i><br></i>  <i>Puede utilizar ytW81KkHaGOnaqiG7Gr4AA ==: XXnpfKJoUCufBm2ztTXGCN6wgqLeScU8 + XlL7Co5oHg =</i> <br><br>  1. Recib√≠ un error 403 despu√©s de publicar la cadena "ytW81KkHaGOnaqiG7Gr4AA ==: XXnpfKJoUCufBm2ztTXGCN6wgqLeScU8 + XlL7Co5oHg =".  Si cambia algunas letras, a√∫n recibe el error 403, cambia el recuento de letras, recibe el error 500.  Despu√©s de algunas investigaciones, me di cuenta de que la primera parte deber√≠a tener 16 bytes de longitud en forma decodificada en base64, y la segunda parte debe contener algunos bloques de 16 bytes cada uno. Seems first part is IV and second part ‚Äì encoded data in CBC mode, and according to task name ‚Äûpad‚Äù it is padding oracle attack. <br><br> 2. Lets change last byte in base64 decoded form of second part (01.php script, total 256 possibilities). For one case instead of ‚Äú403‚Äù error I have received message ‚ÄûSir, your message is incorrect or it is not 48 bytes long‚Äù <br><br><div class="spoiler"> <b class="spoiler_title">01.php script</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $s = <span class="hljs-string"><span class="hljs-string">"7177a294cfa7b53371776be5cfa74ddf"</span></span>; $r = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($i=<span class="hljs-number"><span class="hljs-number">0</span></span>;$i&lt;<span class="hljs-number"><span class="hljs-number">32</span></span>;$i+=<span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($j=<span class="hljs-number"><span class="hljs-number">0</span></span>;$j&lt;<span class="hljs-number"><span class="hljs-number">16</span></span>;$j++) { $a = sprintf(<span class="hljs-string"><span class="hljs-string">"%04b"</span></span>, $j); $a = str_replace(<span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-string"><span class="hljs-string">"Z"</span></span>, $a); $a = str_replace(<span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"N"</span></span>, $a); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (substr(md5($a), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>) == substr($s, $i, <span class="hljs-number"><span class="hljs-number">4</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($j == <span class="hljs-number"><span class="hljs-number">16</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">"Error 1: {$i}"</span></span>); $r .= $a; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> md5($r).<span class="hljs-string"><span class="hljs-string">": "</span></span>.$r.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; } $p = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-number"><span class="hljs-number">22</span></span>,<span class="hljs-number"><span class="hljs-number">30</span></span>,<span class="hljs-number"><span class="hljs-number">25</span></span>,<span class="hljs-number"><span class="hljs-number">23</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">11</span></span>,<span class="hljs-number"><span class="hljs-number">24</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">31</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span>,<span class="hljs-number"><span class="hljs-number">27</span></span>,<span class="hljs-number"><span class="hljs-number">28</span></span>,<span class="hljs-number"><span class="hljs-number">18</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">21</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">8</span></span>,<span class="hljs-number"><span class="hljs-number">13</span></span>,<span class="hljs-number"><span class="hljs-number">17</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>,<span class="hljs-number"><span class="hljs-number">19</span></span>,<span class="hljs-number"><span class="hljs-number">29</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">26</span></span>,<span class="hljs-number"><span class="hljs-number">14</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>); $s = str_repeat(<span class="hljs-string"><span class="hljs-string">"_"</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($i=<span class="hljs-number"><span class="hljs-number">0</span></span>;$i&lt;<span class="hljs-number"><span class="hljs-number">32</span></span>;$i++) $s[$p[$i]] = $r[$i]; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $s.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $a = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($i=<span class="hljs-number"><span class="hljs-number">0</span></span>;$i&lt;<span class="hljs-number"><span class="hljs-number">32</span></span>;$i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($s[$i] == <span class="hljs-string"><span class="hljs-string">'Z'</span></span>) $a += (<span class="hljs-number"><span class="hljs-number">1</span></span>&lt;&lt;$i); } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $a.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>;</code> </pre> <br></div></div><br> 3. Lets decrypt message from task using padding oracle attack (scripts 02.php and 02b.php) ‚Äì I have received string ‚ÄúNever gonna give you up\nNever go‚Äù. <br><br><div class="spoiler"> <b class="spoiler_title">02.php script</b> <div class="spoiler_text"> &lt;?php <br> $a = ‚ÄûytW81KkHaGOnaqiG7Gr4AA==:XXnpfKJoUCufBm2ztTXGCN6wgqLeScU8+XlL7Co5oHg=‚Äú; <br> $a = explode(¬ª:", $a); <br> $a[0] = base64_decode($a[0]); <br> $a[1] = base64_decode($a[1]); <br> file_put_contents(¬´01.bin¬ª, $a[0].$a[1]); <br><br> $s = $a[1]; <br> $known = ""; <br> for($i=1;$i&lt;=16;$i++) <br>  { <br><br> for($j=0;$j&lt;256;$j++) <br>  { <br> $iv = str_repeat(¬´A¬ª, 16-$i).((chr($j).$known) ^ str_repeat(chr($i), $i)); <br> if (($r = send($iv, substr($s, 0, 16))) !== false) <br>  { <br> echo $r."\r\n"; <br> $known = chr($j).$known; <br> echo bin2hex($known)." ".($known ^ substr($a[0], -$i))."\r\n"; <br> break; <br> } <br> } <br> if ($j == 256) die(¬´Error 1: {$i}¬ª); <br> } <br><br> function send($a, $b) <br>  { <br> $data = base64_encode($a).":".base64_encode($b); <br><br> $s = ¬´POST / HTTP/1.0\r\n¬ª; <br> $s.= ¬´Host: 51.15.79.170\r\n¬ª; <br> $s.= ¬´Content-Length: ¬ª.strlen($data)."\r\n"; <br> $s.= ¬´User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\n¬ª; <br> $s.= "\r\n"; <br> $s.= $data; <br><br> $r = ""; <br> do {$socket = <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">fsockopen</a> (¬´51.15.79.170¬ª, 80);} while(!$socket); <br> fwrite($socket, $s); <br> while(!@feof($socket)) $r .= fread($socket, 4096); <br> fclose($socket); <br><br> if (strpos($r, ¬´500 INTERNAL SERVER ERROR¬ª)) die(¬´Error 2: {$data}¬ª); <br><br> return (strpos($r, ¬´403 FORBIDDEN¬ª) !== false)?false:$r; <br> } <br><br></div></div><br><div class="spoiler"> <b class="spoiler_title">Never gonna give you up</b> <div class="spoiler_text"> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:49:08 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 0f0cc904c9a68b038e65 gonna give <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:49:25 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 270f0cc904c9a68b038e65 gonna give <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:50:10 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> db270f0cc904c9a68b038e65 r gonna give <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:51:11 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> b1db270f0cc904c9a68b038e65 er gonna give <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:52:15 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> cab1db270f0cc904c9a68b038e65 ver gonna give <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:53:19 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> b0cab1db270f0cc904c9a68b038e65 ever gonna give <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:54:15 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 84b0cab1db270f0cc904c9a68b038e65 Never gonna give <br></div></div><br><div class="spoiler"> <b class="spoiler_title">02b.php script</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $a = <span class="hljs-string"><span class="hljs-string">"ytW81KkHaGOnaqiG7Gr4AA==:XXnpfKJoUCufBm2ztTXGCN6wgqLeScU8+XlL7Co5oHg="</span></span>; $a = explode(<span class="hljs-string"><span class="hljs-string">":"</span></span>, $a); $a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = base64_decode($a[<span class="hljs-number"><span class="hljs-number">0</span></span>]); $a[<span class="hljs-number"><span class="hljs-number">1</span></span>] = base64_decode($a[<span class="hljs-number"><span class="hljs-number">1</span></span>]); file_put_contents(<span class="hljs-string"><span class="hljs-string">"01.bin"</span></span>, $a[<span class="hljs-number"><span class="hljs-number">0</span></span>].$a[<span class="hljs-number"><span class="hljs-number">1</span></span>]); $s = substr($a[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">16</span></span>); $iv2 = substr($a[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); $known = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($i=<span class="hljs-number"><span class="hljs-number">1</span></span>;$i&lt;=<span class="hljs-number"><span class="hljs-number">16</span></span>;$i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($j=<span class="hljs-number"><span class="hljs-number">0</span></span>;$j&lt;<span class="hljs-number"><span class="hljs-number">256</span></span>;$j++) { $iv = str_repeat(<span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>-$i).((chr($j).$known) ^ str_repeat(chr($i), $i)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (($r = send($iv, substr($s, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>))) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $r.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $known = chr($j).$known; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> bin2hex($known).<span class="hljs-string"><span class="hljs-string">" "</span></span>.($known ^ substr($iv2, -$i)).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($j == <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">"Error 1: {$i}"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($a, $b)</span></span></span><span class="hljs-function"> </span></span>{ $data = base64_encode($a).<span class="hljs-string"><span class="hljs-string">":"</span></span>.base64_encode($b); $s = <span class="hljs-string"><span class="hljs-string">"POST / HTTP/1.0\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"Host: 51.15.79.170\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"Content-Length: "</span></span>.strlen($data).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $s.= $data; $r = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> {$socket = @fsockopen(<span class="hljs-string"><span class="hljs-string">"51.15.79.170"</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>);} <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!$socket); fwrite($socket, $s); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!@feof($socket)) $r .= fread($socket, <span class="hljs-number"><span class="hljs-number">4096</span></span>); fclose($socket); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($r, <span class="hljs-string"><span class="hljs-string">"500 INTERNAL SERVER ERROR"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">"Error 2: {$data}"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (strpos($r, <span class="hljs-string"><span class="hljs-string">"403 FORBIDDEN"</span></span>) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)?<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>:$r; }</code> </pre> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">Never go</b> <div class="spoiler_text"> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:50:12 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 67 o <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:51:11 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> a167 go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:51:14 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 15a167 go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:52:30 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> c715a167 r go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:53:57 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> d6c715a167 er go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:54:15 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 1bd6c715a167 ver go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:54:28 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 631bd6c715a167 ever go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:55:21 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> d1631bd6c715a167 Never go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:55:43 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 21d1631bd6c715a167 <br> Never go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:55:47 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 2021d1631bd6c715a167 p <br> Never go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:55:51 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 1d2021d1631bd6c715a167 up <br> Never go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:56:07 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 821d2021d1631bd6c715a167 up <br> Never go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:56:08 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 09821d2021d1631bd6c715a167 u up <br> Never go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:56:52 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 8609821d2021d1631bd6c715a167 ou up <br> Never go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:56:52 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 008609821d2021d1631bd6c715a167 you up <br> Never go <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 21:57:10 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 7d008609821d2021d1631bd6c715a167 you up <br> Never go <br></div></div><br> 4. Ok, seems the message was truncated (should be 48 bytes long). Using google I have found some song with full phase " <b>Never gonna give you up\nNever gonna let you down</b> ‚Äù. Lets encrypt it using padding oracle attack from last block till first block and iv (scripts 05.php and 04_brute.php). <br><br><div class="spoiler"> <b class="spoiler_title">04_brute.php script</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $a = <span class="hljs-string"><span class="hljs-string">"ytW81KkHaGOnaqiG7Gr4AA==:XXnpfKJoUCufBm2ztTXGCN6wgqLeScU8+XlL7Co5oHg="</span></span>; $a = explode(<span class="hljs-string"><span class="hljs-string">":"</span></span>, $a); $a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = base64_decode($a[<span class="hljs-number"><span class="hljs-number">0</span></span>]); $a[<span class="hljs-number"><span class="hljs-number">1</span></span>] = base64_decode($a[<span class="hljs-number"><span class="hljs-number">1</span></span>]); file_put_contents(<span class="hljs-string"><span class="hljs-string">"01.bin"</span></span>, $a[<span class="hljs-number"><span class="hljs-number">0</span></span>].$a[<span class="hljs-number"><span class="hljs-number">1</span></span>]); $s = hex2bin(<span class="hljs-string"><span class="hljs-string">"ff4fba7f36536f04bd0a3f77b8b06dde"</span></span>); $known = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($i=<span class="hljs-number"><span class="hljs-number">1</span></span>;$i&lt;=<span class="hljs-number"><span class="hljs-number">16</span></span>;$i++) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>($j=<span class="hljs-number"><span class="hljs-number">0</span></span>;$j&lt;<span class="hljs-number"><span class="hljs-number">256</span></span>;$j++) { $iv = str_repeat(<span class="hljs-string"><span class="hljs-string">"A"</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>-$i).((chr($j).$known) ^ str_repeat(chr($i), $i)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (($r = send($iv, substr($s, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>))) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $r.<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $known = chr($j).$known; <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> bin2hex($known).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($j == <span class="hljs-number"><span class="hljs-number">256</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">"Error 1: {$i}"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($a, $b)</span></span></span><span class="hljs-function"> </span></span>{ $data = base64_encode($a).<span class="hljs-string"><span class="hljs-string">":"</span></span>.base64_encode($b); $s = <span class="hljs-string"><span class="hljs-string">"POST / HTTP/1.0\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"Host: 51.15.79.170\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"Content-Length: "</span></span>.strlen($data).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $s.= $data; $r = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> {$socket = @fsockopen(<span class="hljs-string"><span class="hljs-string">"51.15.79.170"</span></span>, <span class="hljs-number"><span class="hljs-number">80</span></span>);} <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!$socket); fwrite($socket, $s); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!@feof($socket)) $r .= fread($socket, <span class="hljs-number"><span class="hljs-number">4096</span></span>); fclose($socket); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (strpos($r, <span class="hljs-string"><span class="hljs-string">"500 INTERNAL SERVER ERROR"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">"Error 2: {$data}"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (strpos($r, <span class="hljs-string"><span class="hljs-string">"403 FORBIDDEN"</span></span>) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>)?<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>:$r; }</code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title">05.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $a = <span class="hljs-string"><span class="hljs-string">"ytW81KkHaGOnaqiG7Gr4AA==:XXnpfKJoUCufBm2ztTXGCN6wgqLeScU8+XlL7Co5oHg="</span></span>; $a = explode(<span class="hljs-string"><span class="hljs-string">":"</span></span>, $a); $a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = base64_decode($a[<span class="hljs-number"><span class="hljs-number">0</span></span>]); $a[<span class="hljs-number"><span class="hljs-number">1</span></span>] = base64_decode($a[<span class="hljs-number"><span class="hljs-number">1</span></span>]); $Q = <span class="hljs-string"><span class="hljs-string">"Never gonna give you up\nNever gonna let you down"</span></span>.str_repeat(<span class="hljs-string"><span class="hljs-string">"\x10"</span></span>, <span class="hljs-number"><span class="hljs-number">0x10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> strlen($Q).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $e1 = substr($a[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); $d1 = $a[<span class="hljs-number"><span class="hljs-number">0</span></span>] ^ <span class="hljs-string"><span class="hljs-string">"Never gonna give"</span></span>; $e2 = $d1 ^ substr($Q, <span class="hljs-number"><span class="hljs-number">48</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> bin2hex($e2).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $d2 = hex2bin(<span class="hljs-string"><span class="hljs-string">"9e3d4885d3be30498069cfc4992e73df"</span></span>); $e3 = $d2 ^ substr($Q, <span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> bin2hex($e3).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $d3 = hex2bin(<span class="hljs-string"><span class="hljs-string">"df36d50a16261f0ef36f4912ca900ab1"</span></span>); $e4 = $d3 ^ substr($Q, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> bin2hex($e4).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $d4 = hex2bin(<span class="hljs-string"><span class="hljs-string">"20c3540ec72fa0b486b5f0c868218360"</span></span>); $e5 = $d4 ^ substr($Q, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">16</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> bin2hex($e5).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $a[<span class="hljs-number"><span class="hljs-number">0</span></span>] = $e5; $a[<span class="hljs-number"><span class="hljs-number">1</span></span>] = $e4.$e3.$e2.$e1; $data = base64_encode($a[<span class="hljs-number"><span class="hljs-number">0</span></span>]).<span class="hljs-string"><span class="hljs-string">":"</span></span>.base64_encode($a[<span class="hljs-number"><span class="hljs-number">1</span></span>]); $s = <span class="hljs-string"><span class="hljs-string">"POST / HTTP/1.0\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"Host: 51.15.79.170\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"Content-Length: "</span></span>.strlen($data).<span class="hljs-string"><span class="hljs-string">"\r\n"</span></span>; $s.= <span class="hljs-string"><span class="hljs-string">"User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:62.0) Gecko/20100101 Firefox/62.0\r\n"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//$s.= "Content-Type: application/x-www-form-urlencoded\r\n"; $s.= "\r\n"; $s.= $data; $socket = fsockopen("51.15.79.170", 80); fwrite($socket, $s); while(!@feof($socket)) echo fread($socket, 4096); fclose($socket);</span></span></code> </pre> <br></div></div><br><div class="spoiler"> <b class="spoiler_title">20c3540ec72fa0b486b5f0c868218360</b> <div class="spoiler_text"> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:51:49 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br>  60 60 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:52:05 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 8360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:52:15 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:52:52 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 68218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:53:56 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:55:08 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:56:09 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:57:05 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 86b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:58:03 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> b486b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:58:59 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> a0b486b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Tue, 23 Oct 2018 23:59:05 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 2fa0b486b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Wed, 24 Oct 2018 00:00:08 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> c72fa0b486b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Wed, 24 Oct 2018 00:00:10 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 0ec72fa0b486b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Wed, 24 Oct 2018 00:00:21 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> 540ec72fa0b486b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Wed, 24 Oct 2018 00:01:21 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> c3540ec72fa0b486b5f0c868218360 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Wed, 24 Oct 2018 00:01:34 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 57 <br> Connection: close <br><br> Sir, your message is incorrect or it is not 48 bytes long <br> <b>20c3540ec72fa0b486b5f0c868218360</b> <br></div></div><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> 64 <br> 94a0daa1cb371f1cd914d9b69b139e75 <br> f05329a5bfdb4469f906bae4fd4104b1 <br> ff4fba7f36536f04bd0a3f77b8b06dde <br> 6ea6226bb50fc7dbe8db91e80f48f505 <br> HTTP/1.1 200 OK <br> Server: nginx/1.10.3 (Ubuntu) <br> Date: Wed, 24 Oct 2018 00:01:51 GMT <br> Content-Type: text/html; charset=utf-8 <br> Content-Length: 73 <br> Connection: close <br><br> Okey, I see you're from 80's, get in <br> &lt; <b>Wh4t_1f_R1ck_A3tl3y_Sm0ke_Cannab1s</b> &gt; <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/439550/">https://habr.com/ru/post/439550/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../439538/index.html">Programaci√≥n de la sociedad</a></li>
<li><a href="../439540/index.html">Etherblade.net - proyecto de c√≥digo abierto para crear un encapsulador de tr√°fico ethernet en FPGA (primera parte)</a></li>
<li><a href="../439542/index.html">Nintendo deja en claro que solo la pirater√≠a puede guardar el historial de videojuegos</a></li>
<li><a href="../439544/index.html">Colonia Cap√≠tulo 24: Partida</a></li>
<li><a href="../439546/index.html">¬øSue√±an los androides con el punk el√©ctrico? C√≥mo ense√±√© a una red neuronal a escribir m√∫sica</a></li>
<li><a href="../439552/index.html">Extensiones maliciosas de Chrome</a></li>
<li><a href="../439556/index.html">TDMS Fairway. Metodolog√≠as PMBOK y organizaciones de dise√±o rusas.</a></li>
<li><a href="../439558/index.html">Nuevo tel√©fono viejo. Reinventar el tel√©fono PSTN</a></li>
<li><a href="../439560/index.html">Adaptador Ethereum blockchain para la plataforma de datos InterSystems IRIS</a></li>
<li><a href="../439562/index.html">Configure el cl√∫ster Kubernetes HA en metal desnudo con kubeadm. Parte 1/3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>