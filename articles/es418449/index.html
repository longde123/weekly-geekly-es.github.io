<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë¶‚Äçüë¶ üñäÔ∏è üì¢ M√≥dulos binarios para Python üï¥Ô∏è üë©‚Äçüè≠ üë©üèæ‚Äçüè≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Python es asombroso. Decimos "instalaci√≥n de pip" y muy probablemente se entregar√° la biblioteca necesaria. Pero a veces la respuesta ser√°: "error de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>M√≥dulos binarios para Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/418449/">  Python es asombroso.  Decimos "instalaci√≥n de pip" y muy probablemente se entregar√° la biblioteca necesaria.  Pero a veces la respuesta ser√°: "error de compilaci√≥n", porque hay m√≥dulos binarios.  Sufren alg√∫n tipo de dolor en casi todos los lenguajes modernos, porque hay muchas arquitecturas, algo debe ensamblarse para una m√°quina espec√≠fica, algo debe vincularse con otras bibliotecas.  En general, una pregunta interesante pero poco estudiada: ¬øc√≥mo se pueden hacer y qu√© problemas hay?  Dmitry Zhiltsov ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">zaabjuda</a> ) intent√≥ responder esta pregunta en MoscowPython Conf el a√±o pasado. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/P7ihyyIDtME" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Debajo del corte est√° la versi√≥n de texto del informe de Dmitry.  Consideremos brevemente cu√°ndo se necesitan m√≥dulos binarios y cu√°ndo es mejor abandonarlos.  Analicemos las reglas que deben seguirse al escribirlas.  Considere cinco posibles opciones de implementaci√≥n: <br><br><ul><li>  Extensi√≥n nativa C / C ++ </li><li>  Swig </li><li>  Cython </li><li>  Tipos </li><li>  Herrumbre </li></ul><br>  <strong>Sobre el orador</strong> : Dmitry Zhiltsov se ha desarrollado durante m√°s de 10 a√±os.  Trabaja en CIAN como arquitecto de sistemas, es decir, es responsable de soluciones t√©cnicas y control de tiempos.  En mi vida logr√© probar ensamblador, Haskell, C, y durante los √∫ltimos 5 a√±os he estado programando activamente en Python. <a name="habracut"></a><br><br><h2>  Acerca de la empresa <br></h2><br>  Muchos de los que viven en Mosc√∫ y alquilan viviendas probablemente conocen CIAN.  CYAN es de 7 millones de compradores e inquilinos por mes.  Todos estos usuarios cada mes, utilizando nuestro servicio, encuentran un lugar para vivir. <br><br>  Alrededor del 75% de los moscovitas conocen nuestra empresa, y esto es muy bueno.  En San Petersburgo y Mosc√∫, somos pr√°cticamente considerados monopolistas.  En este momento, estamos tratando de ingresar a las regiones y, por lo tanto, el desarrollo ha crecido 8 veces en los √∫ltimos 3 a√±os.  Esto significa que el equipo aument√≥ 8 veces, la velocidad de entrega de valores al usuario aument√≥ 8 veces, es decir  de una idea de producto a c√≥mo la mano de un ingeniero despleg√≥ una construcci√≥n a producci√≥n.  Aprendimos en nuestro gran equipo a desarrollarnos muy r√°pidamente y a comprender muy r√°pidamente lo que est√° sucediendo en este momento, pero hoy hablaremos un poco sobre otra cosa. <br><br>  Hablar√© sobre m√≥dulos binarios.  Ahora casi el 50% de las bibliotecas de Python tienen alg√∫n tipo de m√≥dulos binarios.  Y result√≥ que muchas personas no est√°n familiarizadas con ellos y creen que esto es algo trascendental, algo oscuro e innecesario.  Y otras personas sugieren escribir mejor un microservicio separado y no usar m√≥dulos binarios. <br><br>  El art√≠culo constar√° de dos partes. <br><br><ol><li> Mi experiencia: por qu√© son necesarios, cu√°ndo se usan mejor y cu√°ndo no. <br></li><li>  Herramientas y tecnolog√≠as con las que puede implementar un m√≥dulo binario para Python. <br></li></ol><br><h2>  ¬øPor qu√© se necesitan m√≥dulos binarios? <br></h2><br>  Todos sabemos perfectamente que Python es un lenguaje interpretado.  Es casi el m√°s r√°pido de los idiomas interpretados, pero, desafortunadamente, su <strong>velocidad no siempre es suficiente</strong> para c√°lculos matem√°ticos pesados.  Inmediatamente surge el pensamiento de que C ser√° m√°s r√°pido. <br><br>  Pero Python tiene un dolor m√°s: es <strong>GIL</strong> .  Se ha escrito una gran cantidad de art√≠culos sobre √©l y se han realizado informes sobre c√≥mo evitarlo. <br><br>  Tambi√©n necesitamos extensiones binarias para <strong>reutilizar la l√≥gica</strong> .  Por ejemplo, encontramos una biblioteca que tiene toda la funcionalidad que necesitamos y por qu√© no usarla.  Es decir, no necesita volver a escribir el c√≥digo, solo tomamos el c√≥digo terminado y lo reutilizamos. <br><br>  Mucha gente cree que al usar extensiones binarias puede <strong>ocultar el c√≥digo fuente</strong> .  La pregunta es muy, muy controvertida, por supuesto, con la ayuda de algunas perversiones salvajes esto se puede lograr, pero no hay una garant√≠a del 100%.  Lo m√°ximo que puede obtener es no dejar que el cliente se descompile y vea qu√© sucede en el c√≥digo que pas√≥. <br><br><h3>  ¬øCu√°ndo se necesitan realmente las extensiones binarias? <br></h3><br>  Sobre la velocidad y Python est√° claro: cuando alguna funci√≥n funciona muy lentamente y ocupa el 80% del tiempo de ejecuci√≥n de todo el c√≥digo, comenzamos a pensar en escribir una extensi√≥n binaria.  Pero para tomar tales decisiones, debe comenzar, como dijo un famoso orador, pensar con el cerebro. <br><br>  Para escribir extensiones de extensi√≥n, se debe tener en cuenta que esto, en primer lugar, ser√° largo.  Primero necesitas "lamer" tus algoritmos, es decir  ver si hay jambas. <br><br><blockquote>  En el 90% de los casos, despu√©s de una verificaci√≥n exhaustiva del algoritmo, la necesidad de escribir algunas extensiones desaparece. <br></blockquote><br>  El segundo caso donde realmente se necesitan extensiones binarias es el <strong>uso de subprocesos m√∫ltiples para operaciones simples</strong> .  Ahora, esto no es tan relevante, pero a√∫n permanece en la empresa sangrienta, en algunos integradores de sistemas, donde Python 2.6 todav√≠a est√° escrito.  No hay asincron√≠a, e incluso para cosas simples, por ejemplo, subir un mont√≥n de im√°genes, aumenta el subprocesamiento m√∫ltiple.  Parece que inicialmente esto no incurre en ning√∫n gasto de red, pero cuando cargamos la imagen en el b√∫fer, llega el malogrado GIL y comienzan algunos tipos de frenos.  Como muestra la pr√°ctica, tales cosas se resuelven mejor usando bibliotecas de las que Python no sabe nada. <br><br>  Si necesita implementar alg√∫n protocolo espec√≠fico, puede ser conveniente crear un c√≥digo C / C ++ simple y deshacerse de mucho dolor.  Lo hice en mi tiempo en un operador de telecomunicaciones, ya que no hab√≠a una biblioteca preparada, tuve que escribirla yo mismo.  Pero repito, ahora esto no es muy relevante, porque hay asincio, y para la mayor√≠a de las tareas es suficiente. <br><br>  Sobre <strong>operaciones</strong> obviamente <strong>dif√≠ciles,</strong> ya dije de antemano.  Cuando tiene bloqueos, matrices grandes y similares, tiene sentido que necesite hacer una extensi√≥n a C / C ++.  Quiero se√±alar que algunas personas piensan que no necesitamos extensiones binarias aqu√≠, es mejor hacer un microservicio en alg√∫n " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lenguaje s√∫per r√°pido</a> " y transferir matrices enormes a trav√©s de la red.  No, es mejor no hacer eso. <br><br>  Otro buen ejemplo cuando pueden e incluso deben tomarse es cuando tiene una <strong>l√≥gica establecida del m√≥dulo</strong> .  Si tiene alg√∫n tipo de m√≥dulo Python en su empresa o si ya existe una biblioteca durante 3 a√±os, hay cambios en ella una vez al a√±o y luego 2 l√≠neas, entonces ¬øpor qu√© no convertirla en una biblioteca C normal si hay recursos y tiempo libres?  Como m√≠nimo, obtenga un aumento en la productividad.  Y tambi√©n se entender√° que si se necesitan algunos cambios cardinales en la biblioteca, entonces esto no es tan simple y, tal vez, valga la pena pensar de nuevo con el cerebro y usar esta biblioteca de una manera diferente. <br><br><h3>  5 reglas de oro <br></h3><br>  Deriv√© estas reglas en mi pr√°ctica.  Se refieren no solo a Python, sino tambi√©n a otros lenguajes para los que puede usar extensiones binarias.  Puedes discutir con ellos, pero tambi√©n puedes pensar y traer los tuyos. <br><br><ol><li>  <strong>Solo funciones de exportaci√≥n</strong> .  Crear clases en Python en bibliotecas binarias lleva bastante tiempo: debe describir muchas interfaces, debe revisar mucha integridad de referencia en el m√≥dulo en s√≠.  Es m√°s f√°cil escribir una peque√±a interfaz para la funci√≥n. <br></li><li>  <strong>Use clases de envoltura</strong> .  Algunos son muy aficionados a la POO y realmente quieren clases.  En cualquier caso, incluso si estas no son clases, es mejor simplemente escribir un contenedor Python: crear una clase, definir un m√©todo de clase o un m√©todo regular, llamar a funciones nativas de C / C ++.  Como m√≠nimo, esto ayuda a mantener la integridad de la arquitectura de datos.  Si usa alg√∫n tipo de extensi√≥n de terceros C / C ++ que no puede arreglar, entonces en el contenedor puede hackearlo para que todo funcione. <br></li><li>  <strong>No puede pasar argumentos de Python a una extensi√≥n; esto</strong> ni siquiera es una regla, sino un requisito.  En algunos casos, esto puede funcionar, pero generalmente es una mala idea.  Por lo tanto, en su c√≥digo, primero debe hacer un controlador que convierta el tipo de Python a tipo C. Y solo despu√©s de eso llame a cualquier funci√≥n nativa que ya funcione con el tipo s.  El mismo controlador recibe una respuesta de una funci√≥n ejecutable y la transforma en tipos de datos Python, y la arroja en c√≥digo Python. <br></li><li>  <strong>Tener en cuenta la recolecci√≥n de basura</strong> .  Python tiene un GC bien conocido, y no debes olvidarte de √©l.  Por ejemplo, pasamos un gran texto por referencia e intentamos encontrar alguna palabra en la biblioteca.  Queremos paralelizar esto, pasamos el enlace a esta √°rea de memoria y al lanzamiento de varios hilos.  En este momento, el GC simplemente toma y decide que nada m√°s se refiere a este objeto y lo elimina del √°rea de memoria.  En el mismo c√≥digo, solo obtenemos una referencia nula, y esto generalmente es un error de segmentaci√≥n.  No debemos olvidarnos de tal caracter√≠stica del recolector de basura y pasar los tipos de datos m√°s simples a las bibliotecas de caracteres: char, integer, etc. <br><br>  Por otro lado, el idioma en el que se escribe la extensi√≥n puede tener su propio recolector de basura.  La combinaci√≥n de Python y la biblioteca de C # es un dolor en este sentido. <br></li><li>  <strong>Defina expl√≠citamente los argumentos de la funci√≥n exportada</strong> .  Con esto, quiero decir que estas funciones deber√°n ser anotadas cualitativamente.  Si aceptamos la funci√≥n PyObject, y en cualquier caso la aceptaremos en nuestra biblioteca, entonces necesitaremos indicar expl√≠citamente qu√© argumentos pertenecen a qu√© tipos.  Esto es √∫til porque si pasamos el tipo de datos incorrecto, obtendremos un error en la biblioteca.  Es decir, lo necesita para su conveniencia. <br></li></ol><br><h3>  Arquitectura de extensi√≥n binaria <br></h3><br><img src="https://habrastorage.org/webt/xq/q1/-0/xqq1-0l_omlmuok-v8yqryqkvku.png"><br><br>  En realidad, no hay nada complicado en la arquitectura de las extensiones binarias.  Hay Python, hay una funci√≥n de llamada que aterriza en un contenedor que llama de forma nativa al c√≥digo.  Esta llamada a su vez aterriza en una funci√≥n que se exporta a Python y que puede llamar directamente.  Es en esta funci√≥n que necesita convertir los tipos de datos a los tipos de datos de su idioma.  Y solo despu√©s de que esta funci√≥n nos haya traducido todo, llamamos a la funci√≥n nativa, que hace la l√≥gica principal, devuelve el resultado en la direcci√≥n opuesta y lo arroja a Python, traduciendo los tipos de datos nuevamente. <br><br><h2>  Tecnologia y Herramientas <br></h2><br>  La forma m√°s famosa de escribir extensiones binarias es la extensi√≥n Native C / C ++.  Solo porque es la tecnolog√≠a est√°ndar de Python. <br><br><h3>  Extensi√≥n nativa C / C ++ <br></h3><br>  Python se implementa en C, y los m√©todos y estructuras de python.h se usan para escribir extensiones.  Por cierto, esto tambi√©n es bueno porque es muy f√°cil implementarlo en un proyecto existente.  Es suficiente especificar xt_modules en setup.py y decir que para compilar el proyecto necesita compilar tales fuentes con tales indicadores de compilaci√≥n.  A continuaci√≥n se muestra un ejemplo. <br><br><pre><code class="cpp hljs">name = <span class="hljs-string"><span class="hljs-string">'DateTime.mxDateTime.mxDateTime'</span></span> src = <span class="hljs-string"><span class="hljs-string">'mxDateTime/mxDateTime.c'</span></span> extra_compile_args=[<span class="hljs-string"><span class="hljs-string">'-g3'</span></span>, <span class="hljs-string"><span class="hljs-string">'-o0'</span></span>, <span class="hljs-string"><span class="hljs-string">'-DDEBUG=2'</span></span>, <span class="hljs-string"><span class="hljs-string">'-UNDEBUG'</span></span>, <span class="hljs-string"><span class="hljs-string">'-std=c++11'</span></span>, <span class="hljs-string"><span class="hljs-string">'-Wall'</span></span>, <span class="hljs-string"><span class="hljs-string">'-Wextra'</span></span>] setup ( ... ext_modules = [(name, { <span class="hljs-string"><span class="hljs-string">'sources'</span></span>: [src], <span class="hljs-string"><span class="hljs-string">'include_dirs'</span></span>: [<span class="hljs-string"><span class="hljs-string">'mxDateTime'</span></span>] , extra_compile_args: extra_compile_args } )] )</code> </pre> <br>  Ventajas de la extensi√≥n nativa C / C ++ <br><br><ul><li>  Tecnolog√≠a nativa </li><li>  Se integra f√°cilmente en el ensamblaje del proyecto. </li><li>  La mayor cantidad de documentaci√≥n. </li><li>  Le permite crear sus propios tipos de datos. </li></ul><br>  Contras de la extensi√≥n nativa C / C ++ <br><br><ul><li>  Alto umbral de entrada. </li><li>  Se requiere conocimiento de C. </li><li>  Boost.Python. </li><li>  Falla de segmentaci√≥n. </li><li>  Dificultades en la depuraci√≥n. </li></ul><br>  Seg√∫n esta tecnolog√≠a, se escribe una gran cantidad de documentaci√≥n, tanto en publicaciones est√°ndar como en publicaciones de blog.  Una gran ventaja es que podemos hacer nuestros propios tipos de datos de Python y construir nuestras clases. <br><br>  Este enfoque tiene grandes desventajas.  En primer lugar, es el umbral de entrada: no todos conocen C lo suficiente como para codificar la producci√≥n.  Debe comprender que para esto no es suficiente leer el libro y ejecutarlo para escribir extensiones nativas.  Si quieres hacer esto, entonces: primero, aprende C;  luego comience a escribir utilidades de comando;  solo despu√©s de eso proceda a escribir extensiones. <br><br>  Boost.Python es muy bueno para C ++, le permite abstraer casi por completo de todos estos contenedores que usamos en Python.  Pero el inconveniente, creo, es que debes sudar mucho para tomar parte e importarlo al proyecto sin descargar todo el Boost. <br><br>  Al enumerar las dificultades en la depuraci√≥n en las desventajas, quiero decir que ahora todos est√°n acostumbrados a usar un depurador gr√°fico, y con los m√≥dulos binarios, tal cosa no funcionar√°.  Lo m√°s probable es que necesite instalar GDB con un complemento para Python. <br><br>  Veamos un ejemplo de c√≥mo creamos esto. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Python.h&gt; static PyObject*addList_add(Pyobject* self, Pyobject* args){ PyObject * listObj; if (! PyARg_Parsetuple( args, "", &amp;listObj)) return NULL; long length = PyList_Size(listObj) int i, sum =0; //   return Py_BuildValue("i", sum); }</span></span></span></span></code> </pre><br>  Para comenzar, incluimos los archivos de encabezado de Python.  Despu√©s de eso, describimos la funci√≥n addList_add que usar√° Python.  Lo m√°s importante es nombrar la funci√≥n correctamente, en este caso addList es el nombre del m√≥dulo, _add es el nombre de la funci√≥n que se utilizar√° en Python.  Pasamos el m√≥dulo PyObject y pasamos los argumentos usando PyObject tambi√©n.  Despu√©s de eso, realizamos verificaciones est√°ndar.  En este caso, estamos tratando de analizar el argumento de la tupla y decir que es un objeto; la "O" literal debe especificarse expl√≠citamente.  Despu√©s de eso, sabemos que pasamos listObj como un objeto, e intentamos averiguar su longitud utilizando m√©todos est√°ndar de Python: PyList_Size.  Tenga en cuenta que aqu√≠ todav√≠a no podemos usar llamadas de llamada para averiguar la longitud de este vector, sino usar la funcionalidad de Python.  Omitimos la implementaci√≥n, despu√©s de lo cual es necesario devolver todos los valores a Python.  Para hacer esto, llame a Py_BuildValue, especifique qu√© tipo de datos estamos devolviendo, en este caso "i" es un n√∫mero entero y la variable suma en s√≠. <br><br>  En este caso, todos entienden: encontramos la suma de todos los elementos de la lista.  Vamos un poco m√°s all√°. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt; length; i++){ <span class="hljs-comment"><span class="hljs-comment">//     //   Python- PyObject* temp = PyList_GetItem(listObj, i); //  ,      //     C long long elem= PyLong_AsLong(temp); sum += elem; }</span></span></code> </pre><br>  Esto es lo mismo; por el momento, listObj es un objeto Python.  Y en este caso, estamos tratando de tomar los elementos de la lista.  Python.h tiene todo lo que necesitas para esto. <br><br>  Despu√©s de que tenemos temperatura, tratamos de lanzarlo demasiado.  Y solo despu√©s de eso puedes hacer algo en C. <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//  static char addList_docs[] = "add( ): add all elements of the list\n"; //    static PyMethodDef addList_funcs[] = { {"add", (PyCFunction)addList_add, METH_VARARGS, addList_docs}, {NULL, NULL, 0, NULL} };</span></span></code> </pre><br>  Despu√©s de haber implementado toda la funci√≥n, es necesario escribir documentaci√≥n.  <strong>La documentaci√≥n siempre es buena</strong> , y este kit de herramientas tiene todo para un mantenimiento conveniente.  Despu√©s de la convenci√≥n de nomenclatura, nombramos el m√≥dulo addList_docs y guardamos la descripci√≥n all√≠.  Ahora necesita registrar el m√≥dulo, para esto hay una estructura especial PyMethodDef.  Al describir las propiedades, decimos que la funci√≥n se exporta a Python con el nombre "add", que esta funci√≥n llama PyCFunction.  METH_VARARGS significa que una funci√≥n puede tomar cualquier cantidad de variables.  Tambi√©n escribimos l√≠neas adicionales y describimos una verificaci√≥n est√°ndar, en caso de que solo import√°ramos el m√≥dulo, pero no utiliz√°ramos ning√∫n m√©todo para que no se cayera. <br><br>  Despu√©s de anunciar todo esto, intentamos hacer un m√≥dulo.  Creamos un m√≥dulo de definici√≥n y ponemos todo lo que hemos hecho all√≠. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PyModuleDef</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">moduledef</span></span></span><span class="hljs-class"> = {</span></span> PyModuleDef_HEAD_INIT, <span class="hljs-string"><span class="hljs-string">"addList example module"</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, adList_funcs, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> };</code> </pre><br>  PyModuleDef_HEAD_INIT es una constante est√°ndar de Python que siempre debe usar.  -1 indica que no es necesario asignar memoria adicional en la etapa de importaci√≥n. <br><br>  Cuando creamos el m√≥dulo en s√≠, necesitamos inicializarlo.  Python siempre est√° buscando init, as√≠ que cree una PyInit_addList para addList.  Ahora desde la estructura ensamblada, puede llamar a PyModule_Create y finalmente crear el m√≥dulo en s√≠.  A continuaci√≥n, agregue la metainformaci√≥n y devuelva el m√≥dulo en s√≠. <br><br><pre> <code class="cpp hljs">PyInit_addList(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>){ PyObject *<span class="hljs-keyword"><span class="hljs-keyword">module</span></span> = PyModule_Create(&amp;mdef); If (<span class="hljs-keyword"><span class="hljs-keyword">module</span></span> == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; PyModule_AddStringConstant(<span class="hljs-keyword"><span class="hljs-keyword">module</span></span>, <span class="hljs-string"><span class="hljs-string">"__author__"</span></span>, <span class="hljs-string"><span class="hljs-string">"Bruse Lee&lt;brus@kf.ch&gt;:"</span></span>); PyModule_addStringConstant (Module, <span class="hljs-string"><span class="hljs-string">"__version__"</span></span>, <span class="hljs-string"><span class="hljs-string">"1.0.0"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">module</span></span>; }</code> </pre><br>  Como ya habr√°s notado, hay muchas cosas por transformar.  Siempre debe recordar Python cuando escribimos en C / C ++. <br><br>  Es por eso que, para facilitar la vida de un programador mortal com√∫n, hace unos 15 a√±os, apareci√≥ la tecnolog√≠a SWIG. <br><br><h3>  Swig <br></h3><br>  Esta herramienta le permite abstraer de enlaces de Python y escribir c√≥digo nativo.  Tiene los mismos pros y contras que Native C / C ++, pero hay excepciones. <br><br>  SWIG Pros: <br><br><ul><li>  Tecnolog√≠a estable </li><li>  Una gran cantidad de documentaci√≥n. </li><li>  Res√∫menes de enlace a Python. </li></ul><br>  Contras de SWIG: <br><br><ul><li>  Configuraci√≥n larga </li><li>  Conocimiento C. </li><li>  Falla de segmentaci√≥n. </li><li>  Dificultades en la depuraci√≥n. </li><li>  La complejidad de la integraci√≥n en el montaje del proyecto. </li></ul><br>  El primer inconveniente es que <strong>mientras lo configura, perder√° la raz√≥n</strong> .  Cuando lo configur√© por primera vez, pas√© un d√≠a y medio incluso para lanzarlo.  Entonces, por supuesto, es m√°s f√°cil.  SWIG 3.x se ha vuelto m√°s f√°cil. <br><br>  Para no entrar m√°s en el c√≥digo, considere el esquema general de SWIG. <br><br><img src="https://habrastorage.org/webt/93/4h/ul/934huleqgml-qurdnxrw8k0gjes.png"><br><br>  example.c es un m√≥dulo C que no sabe nada sobre Python.  Hay un archivo de interfaz example.i, que se describe en el formato SWIG.  Despu√©s de eso, ejecute la utilidad SWIG, que crea example_wrap.c desde el archivo de interfaz; este es el mismo contenedor que sol√≠amos hacer con nuestras manos.  Es decir, SWIG simplemente crea un contenedor de archivos para nosotros, el llamado puente.  Despu√©s de eso, usando GCC, compilamos dos archivos y obtenemos dos archivos de objeto (example.o y example_wrap.o) y solo entonces creamos nuestra biblioteca.  Todo es simple y claro. <br><br><h3>  Cython <br></h3><br>  Andrey Svetlov hizo un excelente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">informe</a> en MoscowPython Conf, as√≠ que solo dir√© que esta es una tecnolog√≠a popular con buena documentaci√≥n. <br><br>  Cython Pros: <br><br><ul><li>  Tecnolog√≠a popular </li><li>  Bastante estable </li><li>  Se integra f√°cilmente en el ensamblaje del proyecto. </li><li>  Buena documentaci√≥n </li></ul><br>  Contras de Cython: <br><br><ul><li>  Sintaxis propia </li><li>  Conocimiento C. </li><li>  Falla de segmentaci√≥n. </li><li>  Dificultades en la depuraci√≥n. </li></ul><br>  Contras, como siempre, es.  La principal es su propia sintaxis, que es similar a C / C ++, y muy similar a Python. <br><br>  Pero quiero se√±alar que el c√≥digo Python se puede acelerar usando Cython escribiendo c√≥digo nativo. <br><br><img src="https://habrastorage.org/webt/tk/8t/sh/tk8tshw1gla6nevwcjda4c9iq20.png"><br><br>  Como puede ver, hay muchos decoradores, y esto no es muy bueno.  Si desea utilizar Cython, consulte el informe de Andrei Svetlov. <br><br><h3>  CTypes <br></h3><br>  CTypes es la biblioteca est√°ndar de Python que funciona con la interfaz de funci√≥n externa.  FFI es una biblioteca de bajo nivel.  Esta es una tecnolog√≠a nativa, se usa terriblemente a menudo en c√≥digo, con su ayuda es f√°cil de implementar multiplataforma. <br><br>  Pero FFI conlleva muchos gastos generales porque todos los puentes, todos los controladores en tiempo de ejecuci√≥n se crean din√°micamente.  Es decir, cargamos la biblioteca din√°mica, y Python en este momento no sabe qu√© es la biblioteca.  Solo cuando se llama a una biblioteca en la memoria, estos puentes se construyen din√°micamente. <br><br>  Pros de CTypes: <br><br><ul><li>  Tecnolog√≠a nativa </li><li>  F√°cil de usar en c√≥digo. </li><li>  F√°cil de implementar multiplataforma. </li><li>  Puedes usar casi cualquier idioma. </li></ul><br>  Contras CTypes: <br><br><ul><li>  Lleva por encima. </li><li>  Dificultades en la depuraci√≥n. </li></ul><br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ctypes <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-comment"><span class="hljs-comment">#load the shared object file Adder = CDLL('./adder.so') #Calculate factorial res_int = adder.fact(4) print("Fact of 4 = " + str(res_int))</span></span></code> </pre><br>  Tomaron adder.so y lo llamaron en tiempo de ejecuci√≥n.  Incluso podemos pasar los tipos nativos de Python. <br><br>  Despu√©s de todo esto, la pregunta es: "¬øDe alguna manera es complicado, en todas partes C, qu√© hacer?". <br><br><h3>  Herrumbre <br></h3><br>  Hubo un tiempo en que no le prest√© la atenci√≥n adecuada al idioma, pero ahora pr√°cticamente recurro a √©l. <br><br>  Pros de √≥xido: <br><br><ul><li>  Lenguaje seguro </li><li>  Potentes garant√≠as est√°ticas de comportamiento correcto. </li><li>  Se integra f√°cilmente en las compilaciones de proyectos ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">PyO3</a> ). </li></ul><br>  Contras de √≥xido: <br><br><ul><li>  Alto umbral de entrada. </li><li>  Configuraci√≥n larga </li><li>  Dificultades en la depuraci√≥n. </li><li>  Hay poca documentaci√≥n. </li><li>  En algunos casos, gastos generales. </li></ul><br>  Rust es un lenguaje seguro con prueba autom√°tica de trabajo.  La sintaxis en s√≠ y el preprocesador del lenguaje en s√≠ no permiten que se cometa un error expl√≠cito.  Al mismo tiempo, se centra en la variabilidad, es decir, debe procesar cualquier resultado de la ejecuci√≥n de la rama de c√≥digo. <br><br>  Gracias al equipo de PyO3, hay buenas carpetas de Python para Rust y herramientas para integrarse en el proyecto. <br><br>  En el lado negativo, supongo que para un programador no preparado, lleva mucho tiempo configurarlo.  Poca documentaci√≥n, pero en lugar de contras, no tenemos una falla de segmentaci√≥n.  En Rust, en el buen sentido, en el 99% de los casos, un programador puede obtener una falla de segmentaci√≥n solo si indica expl√≠citamente desempaquetado y simplemente lo calific√≥. <br><br>  Un peque√±o ejemplo de c√≥digo, el mismo m√≥dulo que examinamos antes. <br><br><pre> <code class="rust hljs"><span class="hljs-meta"><span class="hljs-meta">#![feature(proc_macro)]</span></span> <span class="hljs-meta"><span class="hljs-meta">#[macro_use]</span></span> <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">crate</span></span> pyo3; Use pyo3::prelude::*; <span class="hljs-comment"><span class="hljs-comment">/// Module documentation string 1 #[py::modinit(_addList)] fn init(py: Python, m: PyModule) -&gt; PyResult &lt;()&gt;{ py_exception!(_addList, EmptyListError); /// Function documentation string 1 #[pufn(m, "run", args= "*", kwargs="**" )] fn run_py(_py: Python, args: &amp;PyTuple, kwargs: Option&lt;&amp;PyDict&gt;) -&gt; PyResult&lt;()&gt; { run(args, kwargs) } #[pyfn(m, "run", args="*", kwatgs="**")] fn run_py(_py: Python, args: &amp;PyTuple, kwargs: Option&lt;&amp;PyDict&gt;) -&gt; PyResult&lt;()&gt;{ run(args,kwargs) } #[pyfn(m,"add")] fn add(_py: Python, py_list: &amp;PyList) -&gt; PyResult&lt;i32&gt;{ let mut sum : i32 = 0 match py_list.len() { /// Some code Ok(sum) } Ok(()) }</span></span></code> </pre><br>  El c√≥digo tiene una sintaxis espec√≠fica, pero te acostumbras muy r√°pidamente.  De hecho, todo es igual aqu√≠.  Usando macros hacemos modinit, que para nosotros hace todo el trabajo adicional de generar todo tipo de aglutinantes para Python.  Recuerda que dije, debes hacer un envoltorio de controlador, aqu√≠ es lo mismo.  run_py convierte tipos, luego llamamos al c√≥digo nativo. <br><br>  Como puede ver, para exportar alguna funci√≥n, hay az√∫car sint√°ctico.  Simplemente decimos que necesitamos la funci√≥n add y no describimos ninguna interfaz.  Aceptamos list, que es exactamente py_list, no Object, porque Rust en s√≠ mismo configurar√° las carpetas necesarias en el momento de la compilaci√≥n.  Si pasamos el tipo de datos incorrecto, como en las extensiones de extensi√≥n, se producir√° un TypeError.  Despu√©s de obtener la lista, comenzamos a procesarla. <br><br>  Veamos con m√°s detalle lo que est√° empezando a hacer. <br><br><pre> <code class="rust hljs"><span class="hljs-meta"><span class="hljs-meta">#[pyfn(m, </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"add"</span></span></span><span class="hljs-meta">, py_list=</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"*"</span></span></span><span class="hljs-meta">)]</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span></span>(_py: Python, py_list: &amp;PyList) -&gt; PyResult&lt;<span class="hljs-built_in"><span class="hljs-built_in">i32</span></span>&gt; { <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> py_list.len() { <span class="hljs-number"><span class="hljs-number">0</span></span> =&gt;<span class="hljs-literal"><span class="hljs-literal">Err</span></span>(EmptyListError::new(<span class="hljs-string"><span class="hljs-string">"List is empty"</span></span>)), _ =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-keyword"><span class="hljs-keyword">mut</span></span> sum : <span class="hljs-built_in"><span class="hljs-built_in">i32</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> py_list.iter() { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> temp:<span class="hljs-built_in"><span class="hljs-built_in">i32</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> item.extract() { <span class="hljs-literal"><span class="hljs-literal">Ok</span></span>(v) =&gt; v, <span class="hljs-literal"><span class="hljs-literal">Err</span></span>(_) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> err_msg: <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">format!</span></span>(<span class="hljs-string"><span class="hljs-string">"List item {} is not int"</span></span>, item); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">Err</span></span>(ItemListError::new(err_msg)) } }; sum += temp; } <span class="hljs-literal"><span class="hljs-literal">Ok</span></span>(sum) } } }</code> </pre><br>  El mismo c√≥digo que estaba en C / C ++ / Ctypes, pero solo en Rust.  All√≠ intent√© lanzar PyObject a alg√∫n tipo de largo.  ¬øQu√© pasar√≠a si pudi√©ramos hacer una lista, a excepci√≥n de los n√∫meros, obtendr√≠amos una cadena?  S√≠, obtendr√≠amos un SystemEerror.  En este caso, a trav√©s de <strong>let mut</strong> sum <strong>: i32 =</strong> 0;  Tambi√©n estamos tratando de obtener un valor de la lista y enviarlo a i32.  Es decir, no podremos escribir este c√≥digo sin item.extract (), inconscientemente y emitirlo al tipo deseado.  Cuando escribimos i32, en el caso de un error Rust, en la etapa de compilaci√≥n dir√°: "Manejar el caso cuando no sea i32".  En este caso, si tenemos i32, devolvemos un valor, si es un error, lanzamos una excepci√≥n. <br><br><h2>  Que elegir <br></h2><br>  Despu√©s de este breve recorrido, ¬øqu√© elegir al final? <br><br>  La respuesta realmente es a su gusto y color. <br><br>  No promover√© ninguna tecnolog√≠a espec√≠fica. <br><br><img src="https://habrastorage.org/webt/hu/kt/bn/huktbnnsqfoydatdp7gzsisysjg.png"><br><br>  Simplemente resuma lo que se dijo: <br><br><ul><li>  En el caso de SWIG y C / C ++, debe conocer muy bien C / C ++, comprender que el desarrollo de este m√≥dulo generar√° una sobrecarga adicional.  Pero se utilizar√° un m√≠nimo de herramientas, y trabajaremos en la tecnolog√≠a nativa de Python, que es compatible con los desarrolladores. </li><li>  En el caso de Cython, tenemos un peque√±o umbral de entrada, tenemos una alta velocidad de desarrollo, y tambi√©n este es un generador de c√≥digo ordinario. </li><li>  A expensas de CTypes, quiero advertirle sobre la sobrecarga relativamente grande.  La carga din√°mica de bibliotecas, cuando no sabemos qu√© tipo de biblioteca es, puede generar muchos problemas. </li><li>  Aconsejar√≠a a Rust que tome a alguien que no conozca bien C / C ++.  El √≥xido en la producci√≥n realmente conlleva los menores problemas. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Enlaces utiles</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/zaabjuda/moscowpythonconf2017</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://docs.python.org/3/extending/building.html</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://cython.org</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://docs.python.org/376/library/ctypes.html</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://www.swig.org</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://www.rust-land.org/en-US/</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/PyO3</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://www.youtube.com/watch?v=5-WoT4X17sk</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://packaging.python.org/tutorials/distributing-packages/#platformwheels</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://github.com/PushAMP/pamagent</a> (ejemplo de combate de uso compartido) </div></div><br><blockquote>  Llamada para papeles <br><br>  Aceptamos aplicaciones para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Moscow Python Conf ++</a> hasta el 7 de septiembre: escriba de esta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">forma</a> simple que sepa sobre Python que realmente necesita compartir con la comunidad. <br><br>  Para aquellos que est√°n m√°s interesados ‚Äã‚Äãen escuchar, puedo hablar sobre informes geniales. <br><br><ul><li>  <strong>A Donald Whyte</strong> le encanta hablar sobre acelerar las matem√°ticas en Python y est√° preparando una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nueva historia</a> para nosotros: c√≥mo hacer que las matem√°ticas sean 10 veces m√°s r√°pidas utilizando bibliotecas populares, trucos e insidiosidad, y el c√≥digo es claro y compatible. <br></li><li>  <strong>¬°Artyom Malyshev ha</strong> reunido todos sus muchos a√±os de experiencia en el desarrollo de Django y est√° presentando una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">gu√≠a de informes</a> sobre el marco!  Todo lo que sucede entre recibir una solicitud HTTP y enviar una p√°gina web terminada: exponer magia, un mapa de los mecanismos internos del marco y muchos consejos √∫tiles para sus proyectos. <br></li></ul><br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es418449/">https://habr.com/ru/post/es418449/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es418439/index.html">Conceptos b√°sicos de aplicaciones web progresivas</a></li>
<li><a href="../es418441/index.html">Conceptos b√°sicos de escalada de privilegios de Windows</a></li>
<li><a href="../es418443/index.html">GObject: encapsulaci√≥n, instanciaci√≥n, introspecci√≥n</a></li>
<li><a href="../es418445/index.html">Canales de Django: la respuesta a la web moderna</a></li>
<li><a href="../es418447/index.html">Por qu√© Mosc√∫ Python Conf es ahora ++</a></li>
<li><a href="../es418451/index.html">Lecciones de impresi√≥n 3D. Soporte efectivo y cambio de altura de capa en la pr√°ctica desde 3Dtool</a></li>
<li><a href="../es418453/index.html">Las observaciones de GRAVEDAD validan a√∫n m√°s la relatividad general</a></li>
<li><a href="../es418455/index.html">Webinar abierto "Especialista en el tim√≥n: primera experiencia y errores"</a></li>
<li><a href="../es418457/index.html">Mensaje de agradecimiento: d√≠a del administrador del sistema</a></li>
<li><a href="../es418459/index.html">Desarrollo de escalador LVDS con dos interfaces DisplayPort</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>