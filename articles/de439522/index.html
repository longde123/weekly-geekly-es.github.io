<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ú≥Ô∏è üè§ üö≥ DNS-Rebinding in 2k19 oder wie man wirklich schwitzt, indem man eine Pornoseite besucht üê∑ ‚ôêÔ∏è üéÉ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo allerseits! Heute m√∂chten wir √ºber einen alten und fast vergessenen Angriff namens DNS-Rebinding sprechen. Das erste Gespr√§ch dar√ºber begann im ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DNS-Rebinding in 2k19 oder wie man wirklich schwitzt, indem man eine Pornoseite besucht</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/fbk_cs/blog/439522/"><p><img src="https://habrastorage.org/webt/ro/dg/v9/rodgv9iuu_71gel5eqwpydcaj9m.jpeg"></p><br><p>  Hallo allerseits!  Heute m√∂chten wir √ºber einen alten und fast vergessenen Angriff namens DNS-Rebinding sprechen.  Das erste Gespr√§ch dar√ºber begann im Jahr 2007, aber Experten aus dem Bereich der praktischen Informationssicherheit haben es im Zusammenhang mit den Besonderheiten der Durchf√ºhrung dieses Angriffs sowie mit wenig greifbaren Konsequenzen, wie es damals schien, nicht geb√ºhrend ber√ºcksichtigt.  Heute werden wir versuchen, sie vom Gegenteil zu √ºberzeugen, und Sie insbesondere, indem wir zeigen, dass dieser Angriff in der modernen Welt einen zweiten Wind gefunden hat und nicht mehr so ‚Äã‚Äãharmlos erscheint. </p><a name="habracut"></a><br><h2 id="chto-takoe-dns-rebinding">  Was ist DNS-Neubindung? </h2><br><p>  Betrachten Sie das folgende Schema: </p><br><p><img src="https://habrastorage.org/webt/sr/w6/i8/srw6i8sjgtnecyqfkq6sfndcvrs.png"></p><br><p>  Wir haben einen Computer eines Opfers mit IP 192.168.0.2 im lokalen Netzwerk und einen Router mit der IP-Adresse 192.168.0.1.  Das Ziel des Angreifers, der den Server mit der Adresse 13.37.13.37 und dem Domainnamen hacker.com verwaltet (auch unser eigener DNS-Server mit Informationen zur Domain dreht sich auf dem ip-shnik), besteht darin, Zugriff auf den Router im lokalen Netzwerk zu erhalten. </p><br><p>  Um die DNS-Rebinding-Technik verwenden zu k√∂nnen, m√ºssen wir das Opfer auf unsere sch√§dliche Website locken.  Angenommen, es ist uns gelungen. </p><br><p>  Lassen Sie uns nun im Detail untersuchen, wie der Angriff funktioniert. </p><br><p>  Zun√§chst greift der Browser mit einer A-Record-Anfrage auf die DNS-Server zu: </p><br><p><img src="https://habrastorage.org/webt/ry/op/4y/ryop4y_9c5m0goj-iygirncutbm.png"></p><br><p>  Die Kette der DNS-Server f√ºhrt zu unserem Server, der wiederum eine Standardantwort mit der wahren IP-Adresse der sch√§dlichen Site ausgibt und auch die TTL angibt, die wir in diesem Fall ben√∂tigen 59. </p><br><p><img src="https://habrastorage.org/webt/18/yt/k9/18ytk9njpok5flotf7axbydovpy.png"></p><br><p>  Als N√§chstes stellt der Browser eine Standard-HTTP-Anforderung f√ºr die empfangene IP. </p><br><p><img src="https://habrastorage.org/webt/lc/e8/xd/lce8xd7yfinhsyodhqxtpa8yerm.png"></p><br><p>  In der n√§chsten Phase antwortet der Server mit einer HTML-Seite mit Javascript-Code, der auf unsere eigene Domain zugreift. </p><br><p><img src="https://habrastorage.org/webt/ix/r6/h1/ixr6h19bqirekyafut2tlstyfgc.png"></p><br><p>  Bis die TTL abl√§uft und sich der Benutzer auf der Site befindet, wird das oben empfangene Javascript ausgef√ºhrt.  Sobald die TTL beendet ist, fordert der Browser erneut einen A-Datensatz an. </p><br><p><img src="https://habrastorage.org/webt/-n/1b/dx/-n1bdxxgxatewjyou0gdfxkiv1w.png"></p><br><p>  Zu diesem Zeitpunkt wird unser Javascript weiterhin ausgef√ºhrt, und der von uns verwaltete DNS-Server antwortet mit einem A-Eintrag mit einer IP-Adresse aus dem lokalen Netzwerk, das der Angreifer erreichen m√∂chte. </p><br><p><img src="https://habrastorage.org/webt/mw/pg/lc/mwpglcv_8-ydxsitnzv86gugvqo.png"></p><br><p>  Da die Dom√§ne, der Port und das Protokoll unver√§ndert bleiben, wird die SOP nicht verletzt. Infolgedessen greift der Browser auf die Dom√§ne pew.hacker.com zu, klopft jedoch bereits an den begehrten und unerreichbaren Router. </p><br><p><img src="https://habrastorage.org/webt/-c/df/qk/-cdfqkxy1xyjp6gftrd9wmtg6wy.png"></p><br><p>  Infolgedessen erhalten wir ruhig eine Antwort vom Router und leiten sie an uns weiter, indem wir die entsprechende Funktionalit√§t in den zuvor geladenen Javascript-Code einbetten. </p><br><p><img src="https://habrastorage.org/webt/se/5o/wf/se5owf2cq4n0o8kzxdu-d583kno.png"></p><br><p><img src="https://habrastorage.org/webt/f4/s2/br/f4s2brt6sckd8lf6__rlrpdw5me.png"></p><br><p>  Fassen wir also Folgendes zusammen: </p><br><ul><li>  Der Benutzer besucht die Site und erh√§lt eine echte IP-Adresse und eine kurze TTL </li><li>  Auf der Site ruft der Browser dieselbe Domain an, in der sich der Benutzer befindet.  Sobald der Cache abl√§uft, fordert der Browser erneut die Dom√§nen-IP an. </li><li>  Au√üerdem gibt unser DNS-Server anstelle der tats√§chlichen Adresse die IP-Adresse des internen Dienstes (in unserem Fall des Routers) aus. </li><li>  Nachdem die Anforderung √ºber die Dom√§ne an den Router gesendet wurde, wird das Ergebnis von dem vom Benutzer vorinstallierten Javascript an uns gesendet. </li></ul><br><p>  Wir haben es herausgefunden!  Viele haben m√∂glicherweise eine vern√ºnftige Frage: ‚ÄûNa und?‚Äú, Denn f√ºr den Betrieb m√ºssen Sie die internen IP-Adressen der Dienste kennen, den Benutzer f√ºr eine bestimmte Zeit behalten usw. </p><br><p>  Ja, mit dem Aufkommen von Streaming-Diensten, Video-Hosting, guten alten Pornoseiten und anderen Plattformen, auf denen die Leute lange Zeit h√§ngen, hat der Angreifer genug Zeit, um den Angriff auszuf√ºhren.  Die Adressen sind h√§ufig Standard oder leicht vorhersehbar. </p><br><p>  Aber das ist alles in der Theorie, aber was in der Praxis?  Wir haben die 4 wichtigsten Bereiche im Jahr 2019 ausgew√§hlt, in denen es Vorf√§lle im Zusammenhang mit dem DNS-Rebinding-Angriff gab. Dies sind: </p><br><ul><li>  IoT </li><li>  Krypto-Geldb√∂rsen </li><li>  Desktop-Anwendungen </li><li>  Wolken </li></ul><br><p>  Schauen wir uns jedes Thema der Reihe nach an und finden heraus, ob wirklich alles so harmlos ist. </p><br><h2 id="iot">  Iot </h2><br><h3 id="google-home">  Google nach Hause </h3><br><p><img src="https://habrastorage.org/webt/xk/uj/oh/xkujohaktco1mi9aau3im3fjk7e.png"></p><br><p>  Google Home ist ein intelligenter Assistent von Google.  Dieses Ger√§t verf√ºgt (oder hatte in der Vergangenheit) √ºber eine API, f√ºr die keine Authentifizierung zur Steuerung des Ger√§ts erforderlich ist.  Es bietet eine Reihe von Funktionen, wie zum Beispiel: </p><br><ul><li>  Inhalte abspielen </li><li>  Scannen </li><li>  Starten Sie neu </li><li>  Verbindung zu WIFI-Netzen usw. </li></ul><br><p>  Beispiel f√ºr ein Angriffsszenario: Ein Angreifer kann einen Benutzer dekanonymisieren, indem er die Koordinaten der n√§chsten WIFI-Punkte ermittelt.  Nat√ºrlich kann Sie kein VPN retten. </p><br><h3 id="sonos-wifi-speakers">  Sonos WLAN-Lautsprecher </h3><br><p><img src="https://habrastorage.org/webt/mw/bo/xr/mwboxrh0zhpjewbcxgrw6kn4krg.png"></p><br><p>  Diese Spalten von Sonos rufen einen Webserver im lokalen UPnP-Netzwerk auf, der Zugriff auf eine Reihe interessanter Seiten bietet: </p><br><ul><li>  192.168.1.76:1400/support/review - spuckt die Ausgabe einiger UNIX-Befehle aus </li><li>  192.168.1.76:1400/tools - Erm√∂glicht das Ausf√ºhren einiger UNIX-Befehle </li></ul><br><p>  In diesem Fall kann der Angreifer den Befehl traceroute ausf√ºhren, um die Topologie des internen Netzwerks zu scannen. </p><br><h3 id="radio-thermostat-ct50">  Funkthermostat CT50 </h3><br><p><img src="https://habrastorage.org/webt/0f/uh/b9/0fuhb9kozjqucxdf9v-qxz1rvgc.png"></p><br><p>  Dies ist einer unserer Lieblingsf√§lle.  Dieses Thermostatmodell verf√ºgt auch √ºber eine API ohne Autorisierung und erm√∂glicht Ihnen folgende √Ñnderungen: </p><br><ul><li>  Klimamodus </li><li>  Temperatur </li><li>  Hintergrundbeleuchtungsmodus und andere Einstellungen </li></ul><br><p>  Infolgedessen kann ein Angreifer seinem Opfer viel Schwei√ü einbringen, aber im Ernst, ein solcher Angriff auf einen Thermostat, beispielsweise in einer medizinischen Einrichtung, kann zu ziemlich unangenehmen Konsequenzen f√ºhren. </p><br><h3 id="roku-tv">  Roku TV </h3><br><p><img src="https://habrastorage.org/webt/h3/7g/2d/h37g2dtzcz-6yiq0wqjuytjl0rw.png"></p><br><p>  Roku-Fernseher haben immer noch das gleiche Problem - eine API ohne Authentifizierung. </p><br><p>  Mit der API k√∂nnen Sie: </p><br><ul><li>  F√ºhren Sie verschiedene Anwendungen aus </li><li>  Inhalte abspielen </li><li>  F√ºhren Sie Suchabfragen auf dem System usw. durch. </li></ul><br><p>  In diesem Fall ist das Maximum, das den Benutzer bedroht, das Auslaufen sensibler Daten, was ebenfalls unangenehm ist. </p><br><h3 id="lyuboy-wi-fi-router">  Beliebiger WIFI-Router </h3><br><p><img src="https://habrastorage.org/webt/c_/nk/xe/c_nkxekprqwfkc8uzoj1theepz0.png"></p><br><p>  Fast jeder hat heute dieses IoT-Ger√§t.  Es ist kein Geheimnis, dass viele normale Benutzer die Standardkennw√∂rter in den Admin-Panels ihrer Router nicht √§ndern.  Mit Hilfe der DNS-Neubindung hindert uns nichts daran, uns mit Standardanmeldeinformationen anzumelden und Zugriff auf das Admin-Panel zu erhalten.  Wenn die lokale IP nicht gefunden werden kann, hilft WebRTC. </p><br><h3 id="itog-po-iot">  IoT-Zusammenfassung </h3><br><p>  Wir heben einige der Funktionen hervor, die die DNS-Neubindung bei der Arbeit mit IoT bietet: </p><br><ul><li>  F√§higkeit, Benutzer zu dekanonymisieren </li><li>  M√∂glichkeit zum Scannen eines lokalen Netzwerks </li><li>  Benutzer verspotten </li><li>  Alles, abh√§ngig von der Funktionalit√§t des IoT-Ger√§ts </li></ul><br><h2 id="crypto-wallets">  Krypto-Geldb√∂rsen </h2><br><h3 id="geth">  Geth </h3><br><p>  Lassen Sie uns nun √ºber Kryptow√§hrungsbrieftaschen sprechen.  Der erste untersuchte Fall ist ein Kunde f√ºr Ethereum-Geldb√∂rsen namens Geth.  Hier befindet sich die B√ºchse der Pandora im JSON-RPC-Dienst.  Lassen Sie uns zun√§chst herausfinden, was es ist.  JSON-RPC ist ein Remoteprozeduraufrufprotokoll im JSON-Format.  Es sieht alles ungef√§hr so ‚Äã‚Äãaus: </p><br><p><img src="https://habrastorage.org/webt/5x/lj/0u/5xlj0ui1rjzvur8roy4oflnpsiu.png"></p><br><p> Die meisten Clients f√ºhren diesen Dienst auf localhost: 8545 aus und bieten wiederum eine Reihe interessanter Funktionen wie <code>eth_sendTransaction</code> usw. </p><br><p>  Nun ein Beispiel, wie Sie sein Guthaben und seine Brieftaschenadresse ohne Wissen des Benutzers und mithilfe des DNS-Rebinding-Angriffs abrufen k√∂nnen: </p><br><p><img src="https://habrastorage.org/webt/je/oj/om/jeojomqmheqktoigqvdzftukgky.png"></p><br><h3 id="eosio-keosd-wallet">  EOSIO Keosd Brieftasche </h3><br><p>  Als n√§chstes haben wir einen Kunden f√ºr EOSIO-Wallets.  Keosd selbst startet auf localhost: 8900 und signiert nach Eingabe der Autorisierungsdaten automatisch 15 Minuten lang alle Anwendungsaktionen.  Nachdem Sie sich mit der API befasst haben, finden Sie wieder interessante Funktionen.  Aus Gr√ºnden der √úbersichtlichkeit k√∂nnen Sie mithilfe der unten gezeigten Anforderung den √∂ffentlichen Schl√ºssel des Benutzers abrufen: </p><br><p><img src="https://habrastorage.org/webt/eu/8o/w0/eu8ow0zlacnzorfnqy_mwf1adpc.png"></p><br><h3 id="itog-po-crypto-wallets">  Zusammenfassung der Crypto-Geldb√∂rsen: </h3><br><ul><li>  Ein Angreifer kann Benutzergeld stehlen </li><li>  Ein Angreifer kann verschiedene Benutzereinstellungen √§ndern </li><li>  die F√§higkeit, den Benutzer zu dekanonymisieren </li></ul><br><h2 id="desktop-applications">  Desktop-Anwendungen </h2><br><h3 id="transmission-client">  √úbertragungsclient </h3><br><p>  Ich m√∂chte den Block von Vorf√§llen im Zusammenhang mit Desktop-Anwendungen mit einer relativ sensationellen Sicherheitsanf√§lligkeit im Transmission-Torrent-Client starten. </p><br><p>  Hier liegt das Problem in demselben JSON-RPC, den wir etwas h√∂her untersucht haben.  In diesem Fall k√∂nnen Sie die Benutzereinstellungen √§ndern, z. B. den Ordner zum Herunterladen von Dateien √§ndern: </p><br><p><img src="https://habrastorage.org/webt/km/ot/fr/kmotfrugolntjfkm9l9s-obaw6g.png"></p><br><p>  Einerseits scheint es nichts Ernstes zu sein, aber wenn Sie anstelle des Ordners die vom Angreifer kontrollierte smb-Freigabe angeben (wenn der Client den Windows-Client verwendet), k√∂nnen Sie den Benutzer-Hash abfangen, der in Zukunft verwendet werden kann. </p><br><h3 id="utorrent-web-client">  uTorrent Web Client </h3><br><p>  Dieser Kamerad hat in seinem Arsenal denselben JSON-RPC-Dienst, mit dem Sie Benutzerkonfigurationsdateien √§ndern und Dateien herunterladen k√∂nnen. </p><br><p>  In diesem Fall ist eine Authentifizierung erforderlich, die Anmeldeinformationen sind jedoch unter <code>http://localhost:19575/users.conf</code> .  Wie kann das genutzt werden? </p><br><p>  Stellen Sie zun√§chst die folgende Anfrage: </p><br><p><img src="https://habrastorage.org/webt/zw/hd/c5/zwhdc5xvr-guzsxhnbpddipajck.png"></p><br><p>  Nach Erhalt des Tokens √§ndern wir den Download-Ordner in den Ordner, in dem sich die Programme befinden, die beim Systemstart ausgef√ºhrt werden: </p><br><p><img src="https://habrastorage.org/webt/wm/qm/ds/wmqmdsmi-zd-t4s3jhg-ehs71um.png"></p><br><p>  Und schlie√ülich geben wir den Befehl zum Herunterladen der erforderlichen Nutzdaten: </p><br><p><img src="https://habrastorage.org/webt/z_/n7/rf/z_n7rfmj1ot8lnyc5op7yukhmn0.png"></p><br><p>  Infolgedessen wird <code>evil.exe</code> nach dem n√§chsten Neustart gestartet. </p><br><h3 id="minikube">  Minikube </h3><br><p>  Minikube ist ein Befehlszeilenprogramm zum Konfigurieren und Ausf√ºhren eines Single-Mode-Kubernetes-Clusters in einer virtuellen Maschine auf dem lokalen Computer. </p><br><p>  Es h√§ngt immer an 192.168.99.100 und die webbasierte Schnittstelle ist an Port 3000 verf√ºgbar.  Infolgedessen hat ein Angreifer die M√∂glichkeit, einen sch√§dlichen Container mit einem freigegebenen Ordner f√ºr das Hauptsystem zu erstellen. </p><br><p>  Zun√§chst m√ºssen Sie das csrf-Token erhalten. </p><br><p><img src="https://habrastorage.org/webt/p1/km/nr/p1kmnrq8b3wpp_gvlijlyw-dctg.png"></p><br><p>  Als n√§chstes m√ºssen Sie einen Container erstellen und dazu die folgende Anfrage senden: </p><br><p><img src="https://habrastorage.org/webt/zo/yw/hb/zoywhbt3hwo_prfodgovvznth-e.png"></p><br><p>  Mal sehen, was er macht.  Darin geben wir an, dass wir beim Starten des Containers die Reverse-Shell weiterleiten und auch den Benutzerordner vom Hauptsystem aus einbinden m√ºssen: </p><br><p><img src="https://habrastorage.org/webt/rr/ll/jl/rrlljlnmmi_0fsb_slpehnzpoh4.png"></p><br><h3 id="ruby-on-rails">  Ruby on Rails </h3><br><p>  F√ºr das Ruby on Rails-Framework gibt es ein Juwel, mit dem Sie Ruby-Code direkt im Browser ausf√ºhren k√∂nnen. </p><br><p><img src="https://habrastorage.org/webt/hj/ij/yn/hjijync3otkaeg025phetqwedcm.png"></p><br><p>  Versuchen wir herauszufinden, was wir daf√ºr brauchen. </p><br><p>  Zuerst m√ºssen wir zu einer nicht existierenden Seite gehen: </p><br><p><img src="https://habrastorage.org/webt/kr/tn/xh/krtnxhmsl0ebss-4smhhd2otbzq.png"></p><br><p>  Als n√§chstes versuchen wir, √ºber den Browser auf die Konsole zuzugreifen: </p><br><p><img src="https://habrastorage.org/webt/ou/bg/wp/oubgwpkdiof-enlikzm0sq0djns.png"></p><br><p>  Nun, schlie√ülich bilden wir eine Anfrage zum Starten der Taschenrechneranwendung (in diesem Beispiel der Vektor f√ºr MAC OS X): </p><br><p><img src="https://habrastorage.org/webt/hq/kl/eg/hqklegn3xqxh-zgkhk-yv1mrrlw.png"></p><br><h3 id="blizzard-desktop-application">  Blizzard-Desktop-Anwendung </h3><br><p>  Nicht nur Entwickler und regul√§re Benutzer sind anf√§llig f√ºr Angriffe wie DNS-Rebinding, sondern auch Gamer.  Hier tritt erneut ein JSON-RPC-Dienstproblem auf, das in diesem Fall auf localhost an Port 1120 auftritt.  Der Dienst erm√∂glicht es, Aktualisierungen vorzunehmen, Einstellungen zu √§ndern und andere verschiedene Wartungsoptionen. </p><br><p>  In diesem Fall wird die Authentifizierung unterst√ºtzt, aber das √úbergeben durch Anfordern von localhost ist nicht schwierig: </p><br><p><img src="https://habrastorage.org/webt/j-/vy/my/j-vymyf0n5t-wtfnwwl4azfjptc.png"></p><br><p>  Als Ergebnis k√∂nnen Sie etwas √Ñhnliches erreichen: </p><br><p><img src="https://habrastorage.org/webt/o2/iz/wk/o2izwke9cng_-db0zz2chaxpwe8.png"></p><br><p>  Weitere Details finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </p><br><h3 id="itog-po-desktop-application">  Zusammenfassung der Desktop-Anwendungen: </h3><br><ul><li>  Ein Angreifer kann RCE auf dem Hauptsystem erhalten (vergessen Sie auch nicht VM Escape). </li><li>  Ein Angreifer kann Zugriff auf vertrauliche Daten usw. erhalten. </li></ul><br><h2 id="clouds">  Wolken </h2><br><p>  Nun, und schlie√ülich bleibt das Interessanteste - die Wolken.  Unter dem Strich werden Cloud-Dienste h√§ufig zum Hosten von Software verwendet, mit der Benutzer analysiert werden, die auf die Site kommen.  Klicken Sie beispielsweise mit einem kopflosen Browser auf den Link in der Referer-Kopfzeile, um die Ressource zu kritzeln, von der aus der Client zur Site gegangen ist.  Dieser Angriffsvektor kann auch verwendet werden, da ein kopfloser Browser im Wesentlichen ein vollwertiger Webbrowser ohne grafische Oberfl√§che ist, der jedoch DOM, JS und alles andere unterst√ºtzt. </p><br><p>  Was k√∂nnen wir in diesem Fall tun, wenn wir zu unseren Widdern zur√ºckkehren?  In der Tat m√ºssen wir f√ºr einen Angriff den Benutzer (in diesem Fall den Bot) auf der Seite verz√∂gern.  Nun, daf√ºr k√∂nnen wir ein Bild auf der Seite verwenden, das eine Inhaltsl√§nge mehr hat, als es tats√§chlich ist.  Infolgedessen wird der Bot denken, dass das Bild noch nicht hochgeladen wurde und auf unserer Seite verweilt, und dann verwenden wir unsere Standard-DNS-Rebinding-Technik. </p><br><p>  Da wir Anfragen von einem Proxy senden, k√∂nnen wir daher viele lustige Dinge tun.  Zum Beispiel: </p><br><ul><li>  Internes Netzwerk scannen </li><li>  bei internen Diensten anmelden (theoretisch) </li><li>  Autorisierungsdaten von anderen Diensten usw. stehlen. </li></ul><br><p>  Gehen wir direkt zu Amazon.  AWS EC2 verf√ºgt √ºber Funktionen wie den Instanzmetadatendienst.  Damit kann jede EC2-Entit√§t die REST-API unter 169.254.169.254 verwenden, die Informationen zur Instanz anzeigt. </p><br><p>  Hier ist beispielsweise eine kurze Liste √§hnlicher Dienste f√ºr verschiedene Clouds: </p><br><ul><li>  <strong>AWS</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://169.254.169.254/latest/user-data</a> </li><li>  <strong>Google Cloud</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://169.254.169.254/computeMetadata/v1/</a> </li><li>  <strong>Digital Ocean</strong> <a href="">http://169.254.169.254/metadata/v1.json</a> </li><li>  <strong>OpenStack / RackSpace</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://169.254.169.254/openstack</a> </li><li>  <strong>Azure</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://169.254.169.254/metadata/instance</a> </li><li>  <strong>Oracle Cloud</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://169.254.169.254/opc/v1/instance/</a> </li></ul><br><p>  Schauen wir uns nun einen Fall an, in dem wir uns AWS hingeben. </p><br><p>  Lassen Sie den Bot zun√§chst eine Anfrage an die API stellen: </p><br><p><img src="https://habrastorage.org/webt/z1/-o/is/z1-ois7mddxwr0p5g5uluv7r8fa.png"></p><br><p>  In der Antwort k√∂nnen wir vertrauliche Informationen erhalten, z. B. Credits in einem Skript, das beim Starten des Computers ausgef√ºhrt wird: </p><br><p><img src="https://habrastorage.org/webt/7j/hh/9d/7jhh9dzzznnbn6telzsx0thw4aa.png"></p><br><p>  Als n√§chstes k√∂nnen wir den Namen des Knotens herausziehen, mit dem wir weiter arbeiten werden: </p><br><p><img src="https://habrastorage.org/webt/e0/30/-w/e030-wpnsjyjtp75xssqozkyreg.png"></p><br><p>  Als n√§chstes werden wir den folgenden Aufruf mit dem bereits bekannten Namen und - Bingo machen! </p><br><p><img src="https://habrastorage.org/webt/cx/c1/x4/cxc1x4gdjj2_zmbws1n7rwmjkas.png"></p><br><p><img src="https://habrastorage.org/webt/re/cb/el/recbelcpwknvcdfx9qqcum90spw.png"></p><br><p>  Wir haben verschiedene Benutzerinformationen erhalten, z. B. AccessKeyId, SecretAccessKey, Token usw. </p><br><p>  Nachdem wir diese Daten erhalten haben, k√∂nnen wir sie f√ºr die Autorisierung √ºber den Konsolenclient verwenden: </p><br><p><img src="https://habrastorage.org/webt/iz/sk/oq/izskoqkfrdvdg0ovbnf578vqhhg.png"></p><br><h3 id="obschiy-itog">  Das Gesamtergebnis: </h3><br><p>  Lassen Sie uns die allgemeinen Schwachstellen hervorheben, die wir bei der Verwendung eines DNS-Rebinding-Angriffs festgestellt haben: </p><br><ul><li>  API ohne Authentifizierung </li><li>  Lokale Dienste ohne Authentifizierung </li><li>  Zu anfordernder Host-Parameter wird ignoriert </li><li>  Verwenden von http anstelle von https </li></ul><br><p>  Trotz verschiedener Argumente von Experten auf dem Gebiet der praktischen Informationssicherheit wird ein Angriff dieser Art im Zeitalter von IoT, Cloud-Diensten, Kryptow√§hrungen usw. neu geboren, obwohl der Client auf der Seite des Angreifers verz√∂gert werden muss, weil in der Welt der Online-Kinos Video-Hosting und andere Dienste, die dem Benutzer Inhalte bereitstellen, ist nicht schwer zu tun.  Seien Sie daher vorsichtig, wenn Sie in der Online-Welt reisen, einen anderen intelligenten Assistenten kaufen und nat√ºrlich bei der Entwicklung. </p><br><h3 id="istochniki">  Quellen: </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://medium.com/@brannondorsey/attacking-private-networks-from-the-internet-with-dns-rebinding-ea7098a2d325</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://blog.hacker.af/how-your-ethereum-can-be-stolen-using-dns-rebinding</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://medium.com/coinmonks/the-call-is-coming-from-inside-the-house-dns-rebinding-in-eosio-keosd-wallet-e11deae05974</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/transmission/transmission/pull/468</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://labs.mwrinfosecurity.com/advisories/minikube-rce/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http://benmmurphy.github.io/blog/2016/07/11/rails-webconsole-dns-rebinding/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://bugs.chromium.org/p/project-zero/issues/detail?id=1471&amp;desc=3#maincol</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=https://labs.mwrinfosecurity.com/blog/from-">https://labs.mwrinfosecurity.com/blog/from-http-referer-to-aws-security-credentials/</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de439522/">https://habr.com/ru/post/de439522/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de439512/index.html">Das Alter der Dinosaurier oder die gesetzlich gepr√ºfte R√ºckversicherung?</a></li>
<li><a href="../de439514/index.html">Tarantool-Replikation: Konfiguration und Verwendung</a></li>
<li><a href="../de439516/index.html">00110001 00110100 00101110 00110000 00110010</a></li>
<li><a href="../de439518/index.html">GeekUniversity Aktualisiertes Webentwicklungs-Schulungsprogramm: Weitere Praktiken und F√§lle f√ºr Delivery Clubs</a></li>
<li><a href="../de439520/index.html">Proof-of-Stake: Neues Gesch√§ftsmodell im Jahr 2019?</a></li>
<li><a href="../de439524/index.html">Fortnite ist die Zukunft, aber aus eher unerwarteten Gr√ºnden</a></li>
<li><a href="../de439526/index.html">Telekommunikationsbetreiber werden ‚ÄûFeldversuche‚Äú zum Nachhaltigkeitsgesetz von Runet durchf√ºhren</a></li>
<li><a href="../de439528/index.html">Keine Kosten f√ºr die Anrufverfolgung</a></li>
<li><a href="../de439532/index.html">Was ist neu in JavaScript ES2019?</a></li>
<li><a href="../de439534/index.html">Ertragsprogrammierung und Einsatz von Drohnen in der √ñlf√∂rderung - 10 Vortr√§ge von der GIS Tech Russia-Konferenz</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>