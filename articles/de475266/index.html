<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî≠ üë©üèº‚Äçüç≥ üëÇ Wir kehren mobile 1s unter Android um. So f√ºgen Sie ein wenig Funktionalit√§t hinzu und lassen ein paar Abende aus üôèüèø üë∑üèª üíÇ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich muss gleich sagen, dass es trotz des lauten Titels des Artikels, wie man denkt, √ºberhaupt keinen direkten Hardcore geben wird. Und trotz der Tatsa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir kehren mobile 1s unter Android um. So f√ºgen Sie ein wenig Funktionalit√§t hinzu und lassen ein paar Abende aus</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475266/"><p>  Ich muss gleich sagen, dass es trotz des lauten Titels des Artikels, wie man denkt, √ºberhaupt keinen direkten Hardcore geben wird.  Und trotz der Tatsache, dass das Zur√ºcksetzen meistens mit Informationssicherheit verbunden ist, wird es wieder nichts Vergleichbares geben, da keinerlei Schutzma√ünahmen umgangen werden mussten (mit Ausnahme einer kleinen Einschr√§nkung).  Es gibt keine von ihnen.  Mobile 1s ist ein kostenloses Produkt, in das keine Schecks, Schutzma√ünahmen und kostenpflichtigen Funktionen integriert sind. </p><br><p>  Deshalb appelliere ich an diejenigen, die hoffen, den Einsatz von Deobfuscatoren, den Einsatz von Frida / Xposed und anderer kniffliger Software zu sehen - Sie werden nichts Interessantes f√ºr sich finden.  Hier verwenden wir nur apktool, baksmali, apksigner, adb, jadx, console, text editor, javac, d8 und alles. </p><br><p> Ich m√∂chte auch diejenigen im Voraus entt√§uschen, die auf eine gr√ºndliche Analyse der Plattform oder ihrer starken Modifikation gewartet haben.  Es werden nur kleine √Ñnderungen an wenigen Dateien vorgenommen, und tats√§chlich sind sogar diese wenigen Dateien, die ich nicht gr√ºndlich ausgearbeitet habe, ganz oben. </p><a name="habracut"></a><br><h1 id="s-chego-vse-nachalos">  Wie alles begann </h1><br><p>  Ich erz√§hle dir ein bisschen, warum ich pl√∂tzlich auf die Idee gekommen bin, f√ºr 1s in das Handy zu steigen.  Im Moment mache ich seit einem Jahr native Entwicklung f√ºr Android, aber vorher habe ich 4 Jahre als Programmierer gearbeitet und in den letzten eineinhalb Jahren haben wir oft speziell mit der mobilen Plattform gearbeitet.  Trotz der Tatsache, dass sie die Grundbed√ºrfnisse befriedigte, hatte sie auch eine Menge Minuspunkte (zus√§tzlich zur Programmiersprache).  Insbesondere war es unm√∂glich, eine externe Bibliothek zumindest mit regelm√§√üigen Mitteln und mit unserem damaligen Wissensspeicher menschlich einzubetten.  Sehr traurig war zum Beispiel auch die Funktionalit√§t, Beschriftungen auf einer Karte anzuzeigen.  Die gesamte M√∂glichkeit der Konfiguration bestand darin, Text f√ºr Beschriftungen anzugeben, wenn Sie darauf tippen.  Zu dieser Zeit war der einzige Weg, dies irgendwie zu umgehen, die Verwendung des speziellen Objekts ‚ÄûHTML-Dokumentfeld‚Äú, aber es gab Probleme damit.  Zum Zeitpunkt der Arbeit mit 1s steckte mein gesamtes Wissen in der nativen Entwicklung f√ºr Android in einem HelloWorld-Paar, sodass ich nicht einmal daran gedacht habe, das Mobiltelefon mit 1s umzukehren. Entweder haben wir verschiedene Fragen von Kunden zur nicht standardm√§√üigen Erweiterung von 1s nicht gel√∂st oder wir sahen sehr einfache native Die Anwendungen, die daneben platziert und schief in 1s integriert wurden (und die 1s-Lizenzvereinbarung scheint √Ñnderungen auf der Plattform selbst zu untersagen). </p><br><p>  Der erste Grund f√ºr 1c-Umkehrung war, dass ich mich daf√ºr interessierte und wusste, was ich mit der aktuellen Wissensbasis anfangen kann.  Ich muss sofort sagen, dass die Erfahrung der einheimischen Entwicklung nicht zu sagen war, was ben√∂tigt wird, in der t√§glichen Arbeit wird fast nichts von dem, was im Folgenden beschrieben wird, nicht gefunden.  Im Prinzip w√§re also wahrscheinlich jeder durchschnittliche 1snik, der mehrere Tage / Wochen sitzt, in der Lage, alles herauszufinden. </p><br><p>  Der zweite Grund ist, dass ich nur versuchen wollte, die apk anderer Leute auszuw√§hlen, weil mir vorher diese ziemlich breite Wissensschicht gefehlt hat, und da ich irgendwo anfangen musste, fiel es mir nur 1s ein. </p><br><h1 id="pervye-shagi">  Erste Schritte </h1><br><p>  Als erstes habe ich die apk-Datei der Anwendung einfach mit der Maus auf das AndroidStudio-Fenster gezogen, auch wenn die Idee, 1s umzukehren, nur vage in meinem Kopf verirrt war.  Ich m√∂chte gleich sagen, dass ich ein wenig traurig war, weil der Gro√üteil des 1c-Codes in C ++ geschrieben ist und in .so-Bibliotheken liegt, und es schwieriger ist, sie umzukehren, und es war nicht interessant.  Aber die classes.dex-Datei hat meine Aufmerksamkeit vollst√§ndig auf sich gezogen, zumal ich aufgrund ihrer bescheidenen Gr√∂√üe davon ausgehen konnte, dass es leicht sein w√ºrde, sie umzukehren.  Im Allgemeinen stellte sich heraus, dass dies so war.  Eine interessante Folge der Tatsache, dass der Gro√üteil des Codes in C ++ darin besteht, dass viele Methoden und Klassen die Verarbeitung mit ProGuard vermieden haben.  Es ist schwierig, eine Interop mit einem minimierten Code durchzuf√ºhren;). </p><br><div class="spoiler">  <b class="spoiler_title">Folgendes habe ich im Studiofenster gesehen (die x86-Version wurde zerlegt, damit sie mit dem Emulator und nicht mit dem realen Ger√§t funktioniert)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ry/dx/6l/rydx6lnrt7oix0nqa63bftv2-8y.png"></p></div></div><br><p>  Wie Sie im obigen Screenshot sehen k√∂nnen, wurde die Anwendung kaum verkleinert (hinsichtlich der Umbenennung von Klassen und Methoden).  Au√üerdem k√∂nnen Sie feststellen, dass Java nur sehr wenig Code enth√§lt und Bibliotheken daher fast den gesamten Speicherplatz belegen. </p><br><p>  Nachdem ich die Klassenliste f√ºr einige Zeit gepusht hatte, sah ich eine merkw√ºrdige MapImpl-Klasse, die den Verdacht aufkommen lie√ü, dass er f√ºr eine solch traurige Situation verantwortlich war, als er die Anzeige von Etiketten anpasste. </p><br><div class="spoiler">  <b class="spoiler_title">MapImpl-Struktur</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ya/rl/xh/yarlxho_dqjalx6euv2g57bddn8.png"></p></div></div><br><p>  Die Liste der Methoden und deren Signaturen weckte die Hoffnung, dass alles sehr einfach sein w√ºrde, und ich beschloss, mich mit dem SMALI-Code zu befassen. Dann wurde ich sehr angespannt und las die Liste der SMALI-Befehle und wie man sie liest / schreibt.  Zu diesem Zeitpunkt entschied ich jedoch, dass die Angelegenheit einfach und kurzlebig zu sein verspricht, und dementsprechend ist es hier eine Gelegenheit, mit dem Umkehren herumzuspielen.  Nachdem ich mich entschlossen hatte, ein paar N√§chte damit zu verbringen (wie grausam ich mich geirrt hatte), ging ich mit ruhiger Seele ins Bett. </p><br><h1 id="stroyu-plany">  Pl√§ne machen </h1><br><p>  Nachdem ich morgens aufgewacht war, entschied ich, dass es bis zu diesem Zeitpunkt besser war, die L√∂sung des Problems mit kleinen Schritten zu erreichen, da ich mich noch nicht einmal mit der Substitution von Ressourcen in Anwendungen befasst hatte, nicht mit √Ñnderungen in der Logik.  Danach habe ich mir eine kurze Liste von Schritten gemacht, die mich mit meinen Bearbeitungen in Form einer funktionierenden mobilen Plattform zum Endpunkt meiner Reise f√ºhren sollten.  Diese Liste war wie folgt: </p><br><ol><li>  Bereiten Sie die 1c-Konfiguration f√ºr die mobile Plattform vor, die zwei Beschriftungen auf der Karte anzeigt. </li><li>  Entpacke das apk der mobilen Plattform, packe ohne √Ñnderungen, stelle sicher, dass die Konfiguration funktioniert. </li><li>  Nehmen Sie kleine √Ñnderungen an SMALI-Dateien vor, die fast nichts √§ndern, aber in den Protokollen zu sehen sind, oder √§ndern Sie die Arbeitslogik. Stellen Sie sicher, dass sie funktionieren. </li><li>  √úbernehmen Sie kleine Aktivit√§ten mit einer Karte in Java oder schreiben Sie eine Aktivit√§t mit derselben Oberfl√§che. Ersetzen Sie Aktivit√§ten in der Anwendung, ohne die Funktionalit√§t zu √§ndern.  Wenn die erste zu faul oder zu kompliziert ist, schreiben Sie alternativ eine Klasse, die einen Teil der Arbeit f√ºr MapImpl erledigt, und f√ºgen Sie ihren Methoden einen Aufruf von smali MapImpl hinzu. </li><li>  Schreiben Sie diesen Artikel (Ich wollte schon lange etwas schreiben, aber andere Ideen brauen sich immer noch in meinem Kopf auf, aber dann schien es, dass dies endlich ein ziemlich w√ºrdiges Thema war.) </li></ol><br><p>  Na ja, zumindest mit dem ersten Absatz hatte ich keine Probleme.  Ich habe die kostenlose Lernversion der Plattform heruntergeladen, die mobile Plattform heruntergeladen und alles auf meinem Computer bereitgestellt (1C, haben Sie bereits eine Schulungsversion f√ºr Linux, ich habe nur einen weiteren Impuls, Windows zu verlassen, und jetzt muss ich etwas daran arbeiten).  Die Konfiguration ist sehr einfach. Beim Start wird die ShowOnMap () -Funktion aufgerufen, die zwei Punkte auf der Karte √ºbertr√§gt.  Das ist alles. </p><br><p>  Aber mit dem zweiten Punkt wurde es wegen meines Analphabetentums trauriger.  Aber was da war, die Probleme waren mit allen Punkten au√üer dem ersten. </p><br><h1 id="perepakovyvayu-prilozhenie-bez-izmeneniy-koda">  Ich packe die Anwendung neu, ohne den Code zu √§ndern </h1><br><p>  Google hat mir sofort mitgeteilt, dass es ein so hervorragendes Tool f√ºr ApK-Tools gibt, mit dem zwei Befehle ApK-Dateien in .smali-Dateien analysieren und von diesen wieder abrufen k√∂nnen.  Ich habe beschlossen, es zu benutzen.  Ich habe apk mit folgendem Befehl entpackt (obwohl ich zeitweise einen Teil der Arbeit unter Linux gemacht habe, gebe ich alle Befehle f√ºr Windows): </p><br><pre><code class="plaintext hljs">apktool.bat d .\sourceApk\1cem-x86.apk -o .\build\unpacked</code> </pre> <br><p>  und bekam das entpackte verzeichnis, in dem sich eine menge dateien befand, mit denen man in zukunft arbeiten sollte.  Apk mit dem befehl zur√ºck gepackt </p><br><pre> <code class="plaintext hljs">apktool.bat b .\build\unpacked -o .\build\1cem-x86.apk</code> </pre> <br><p>  Versucht, es auf einem Emulator zu installieren </p><br><pre> <code class="plaintext hljs">adb install .\build\1cem-x86.apk</code> </pre> <br><p>  Ich habe folgende Fehlermeldung erhalten: </p><br><pre> <code class="plaintext hljs">Performing Streamed Install adb: failed to install .\build\1cem-x86.apk: Failure [INSTALL_PARSE_FAILED_NO_CERTIFICATES: Failed to collect certificates from /data/app/vmdl1115375036.tmp/base.apk: Attempt to get length of null array]</code> </pre> <br><p>  Generell war es notwendig, der Basis mehr Aufmerksamkeit zu schenken.  Nat√ºrlich wusste ich, dass es Signaturen gibt und dass sie in Vertrieb und Freigabe unterteilt sind, aber ich wusste nicht, dass Anwendungen √ºberhaupt nicht ohne Signaturen installiert werden.  Ich beschloss, meine Debit-Signatur zu verwenden und das apk-Team zu unterzeichnen </p><br><pre> <code class="plaintext hljs">apksigner.bat sign --ks C:\Users\neikist\.android\debug.keystore .\build\1cem-x86.apk</code> </pre> <br><p>  Ich konnte die Anwendung ausf√ºhren.  Richtig, statt einer Karte mit zwei Punkten wartete ein grauer Bildschirm mit einer Google-Signatur auf mich.  Nach dem Kratzen der R√ºbe entschied ich, dass der Schl√ºssel f√ºr Google Maps von 1s verwendet wird, was mit meiner Signatur nicht funktioniert.  Daher habe ich in der Entwicklerkonsole auf der Google-Website ein neues Projekt f√ºr die Arbeit mit Google Maps-API auf Android erstellt, einen API-Schl√ºssel erhalten, den ich in der Zeile "res / values ‚Äã‚Äã/ strings.xml" in "google_maps_key" angegeben und meinen Freigabeschl√ºssel zu den Berechtigungen f√ºr das Projekt hinzugef√ºgt habe .  Ich habe die apk neu gepackt und signiert, sie gestartet und endlich hat alles wieder funktioniert. </p><br><h1 id="dobavlyayu-svoi-logi">  Ich f√ºge meine Protokolle hinzu </h1><br><p>  Als n√§chstes wollte ich den Start der Anwendung automatisieren und die 1c-Konfiguration zur Plattform hinzuf√ºgen.  Manuell, nach jeder Bearbeitung, w√§re dies immer noch ein Chaos. </p><br><p>  Zuerst habe ich gegoogelt und versucht, die Dienstprogramme "jadx" oder "dex2jar" zu verwenden, um mich nicht mit dem Lesen von "smali" zu besch√§ftigen, sondern um den vertrauten Java-Code zu lesen, aber aus irgendeinem Grund funktionierten sie nicht (sp√§ter gelang es jadx, sich auf eine Art Schamanismus einzulassen).  Ich musste smali zerlegen, da es sich als nicht so schrecklich herausstellte, wie ich bef√ºrchtet hatte. </p><br><p>  Um zu verstehen, wie die mobile Plattform einen Befehl von der Desktop-Plattform zum Starten der Konfiguration erh√§lt, wenn eine Verbindung √ºber ADB hergestellt wird, habe ich beschlossen, die Einstiegspunkte der Anwendung zu √ºberpr√ºfen und die Ausgabe den Protokollen mit Absichten und anderen n√ºtzlichen Informationen hinzuzuf√ºgen.  Ich habe mich entschieden, mit der Anwendung ( <code>com.e1c.mobile.E1cApplication</code> ) und der Aktivit√§t mit <code>android.intent.action.MAIN</code> im Intent-Filter ( <code>com.e1c.mobile.App</code> ) zu beginnen.  Ich habe mich auch f√ºr den Empf√§nger <code>com.e1c.mobile.Starter</code> mit einem interessanten Absichtsfilter f√ºr <code>com.e1c.mobile.START_TEMPLATE</code> und <code>com.e1c.mobile.START_CMD</code> .  Es ist der Tatsache sehr √§hnlich, dass er Absichten mit 1s-Befehlen akzeptiert und es ist er, der die Konfiguration von der Schablone aus startet. </p><br><p>  Leider konnte ich in <code>E1cApplication</code> nichts Interessantes <code>E1cApplication</code> . Alles, was dort passiert, ist, Ihren Handler auf Caches zu installieren. </p><br><p>  Aber in den beiden anderen Klassen, <code>Starter</code> und <code>App</code> , gab es viel mehr Informationen und es stellte sich als sehr n√ºtzlich heraus.  Die <code>App.onCreate(Landroid/os/Bundle;)V</code> Methode ist ziemlich umfangreich, daher werde ich sie nicht <code>App.onCreate(Landroid/os/Bundle;)V</code> , sondern nur die Teile, die mich interessieren. </p><br><div class="spoiler">  <b class="spoiler_title">App onCreate Method Slice</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">invoke-virtual {p0}, Lcom/e1c/mobile/App;-&gt;getIntent()Landroid/content/Intent; #     p1 move-result-object p1 new-instance v0, Ljava/lang/StringBuilder; invoke-direct {v0}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V invoke-virtual {v0, p0}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/Object;)Ljava/lang/StringBuilder; const-string v1, ".onCreate() " invoke-virtual {v0, v1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/String;)Ljava/lang/StringBuilder; invoke-virtual {v0, p1}, Ljava/lang/StringBuilder;-&gt;append(Ljava/lang/Object;)Ljava/lang/StringBuilder; invoke-virtual {v0}, Ljava/lang/StringBuilder;-&gt;toString()Ljava/lang/String; move-result-object v0 # ,  ? invoke-static {v0}, Lcom/e1c/mobile/Utils;-&gt;V(Ljava/lang/String;)V</code> </pre> </div></div><br><p>  Aus dem obigen Codeabschnitt ist ersichtlich, dass die Anwendung die Absicht empf√§ngt, eine Verkn√ºpfung dazu in das Register <code>p1</code> einf√ºgt, sie √ºber <code>StringBuilder</code> an den Klassen- und <code>StringBuilder</code> anf√ºgt und <code>V(Ljava/lang/String;)V</code> der <code>Utils</code> Klasse an die statische Methode <code>V(Ljava/lang/String;)V</code> .  Anscheinend eine Art eigener Logger.  Danach wird die Absicht auf zus√§tzliche Daten √ºberpr√ºft und, falls verf√ºgbar, <code>Uri</code> abgerufen, woraus wiederum eine Zeichenfolge von der <code>getQuery()</code> -Methode abgerufen und an die <code>Starter</code> Klasse √ºbergeben wird.  <code>onCreate</code> habe keine weitere Studie zu <code>onCreate</code> . Ich habe einen Blick darauf <code>onCreate</code> und sichergestellt, dass die Aktionen ziemlich <code>onCreate</code> sind.  Es sei denn, die Ansicht scheint programmgesteuert von einer v√∂llig anderen Klasse erstellt worden zu sein, anstatt <code>LayoutInflater</code> , aber ich habe nicht sehr tief <code>LayoutInflater</code> , sodass alles m√∂glich ist und nicht so, wie ich dachte.  Die n√§chste Klasse, in die ich gegangen bin, ist <code>Starter</code> .  Gl√ºcklicherweise wurde er im Aktivismus erw√§hnt und interessierte mich f√ºr das Manifest. </p><br><p>  Leider hat sich herausgestellt, dass die von der Aktivit√§t aufgerufene Methode nativ ist ( <code>.method static native startCmd(Ljava/lang/String;)V</code> ). Daher habe ich die <code>onRecieve</code> Methode <code>onRecieve</code> (in der die Anwendung die Ereignisse akzeptiert, f√ºr die sie abonniert ist).  Ich werde den Code nicht <code>V(Ljava/lang/String;)V</code> , ich war daran interessiert, dass die Absicht auch mit der <code>V(Ljava/lang/String;)V</code> Methode der <code>Utils</code> Klasse protokolliert wird.  Es hat sich herausgestellt, dass es ausreicht, dieser Methode einen kleinen kleinen Code hinzuzuf√ºgen. Au√üerdem werde ich meine Protokolle an den Stellen abrufen, an denen die Plattformentwickler sie erstellt haben.  Als ich in die Utils-Klasse ging, sah ich sofort 2 leere Methoden, V und W. Anscheinend sind sie leer, weil sie beim Kompilieren der Release-Version herausgeschnitten wurden.  Ich habe dem Standard <code>android.utils.Log</code> eine Aufzeichnung der √ºbergebenen Zeichenfolge <code>android.utils.Log</code> .  √Ñndern Sie dazu die Anzahl der erforderlichen lokalen Register von 0 auf 1 (f√ºr die Tag-Zeile), <code>v0</code> diese Zeichenfolge in das Register <code>v0</code> und registrieren Sie den Aufruf an die <code>Log</code> Methoden </p><br><div class="spoiler">  <b class="spoiler_title">Implementierung der Methoden W und V</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> .method public static V(Ljava/lang/String;)V .locals 1 const-string v0, "neikist_V" invoke-static {v0, p0}, Landroid/util/Log;-&gt;v(Ljava/lang/String;Ljava/lang/String;)I return-void .end method .method public static W(Ljava/lang/String;)V .locals 1 const-string v0, "neikist_W" invoke-static {v0, p0}, Landroid/util/Log;-&gt;w(Ljava/lang/String;Ljava/lang/String;)I return-void .end method</code> </pre> </div></div><br><p>  Ich habe Mobile von 1s Desktop 1s gestartet und die folgenden Protokolle erhalten </p><br><div class="spoiler">  <b class="spoiler_title">Ergebnisse starten</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: com.e1c.mobile.Starter@139df1c.onReceive( android.app.ReceiverRestrictedContext@346b725, Intent { act=com.e1c.mobile.START_TEMPLATE flg=0x400010 cmp=com.e1c.mobile/.Starter (has extras) } ) 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: context.getPackageName() = com.e1c.mobile 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: intent.getAction() = com.e1c.mobile.START_TEMPLATE 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: App.sActivity = null 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: templatePath = /sdcard/Download/mobilegeoMA/1cema.xml 2019-10-25 19:21:31.537 29960-29960/? V/neikist_V: debugUrl = tcp://127.0.0.1:1560 2019-10-25 19:21:42.216 29960-29960/com.e1c.mobile V/neikist_V: com.e1c.mobile.App@423609b.onCreate() Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.e1c.mobile/.App bnds=[35,252][237,505] } 2019-10-25 19:21:42.651 29960-29960/com.e1c.mobile V/neikist_V: com.e1c.mobile.App$4@4c70381.run() adMobAppId = ca-app-pub-3940256099942544~3347511713 2019-10-25 19:21:42.687 29960-30009/com.e1c.mobile V/neikist_V: App.requestPermission() shouldShowRequestPermissionRationale = false 2019-10-25 19:21:46.138 29960-30009/com.e1c.mobile V/neikist_V: App.isLowBattery() sLastBatteryPercent = 1.0</code> </pre> </div></div><br><p>  Wie Sie sehen, gibt es alle notwendigen Informationen, um den Start der Anwendung √ºber adb zu automatisieren.  Zu diesem Zeitpunkt hatte ich allerdings einen doppelten Gesichtsausdruck.  Zuerst habe ich endlich die Schl√ºssel abgeholt, mit denen jadx die √úbersetzung in Java gemeistert hat (es ist klar, dass ich trotzdem auf smali schreiben m√ºsste, aber immer noch).  Und das zweite Problem war die Tatsache, dass ich erkannte, dass ich die Entwicklerplattform vergeblich qu√§lte (nur f√ºr die Entwicklung und das Debuggen von Konfigurationen erforderlich). Es w√§re richtiger, den Release-Build von 1s-Anwendungen r√ºckg√§ngig zu machen, und es gibt halbfertige Gradle-Projekte f√ºr die Assemblierung. Es gibt eine Datei mit einer Liste von Abh√§ngigkeiten und anderen Br√∂tchen.  Ich war ein bisschen traurig dar√ºber - und beschloss trotzdem zu beenden, was ich angefangen hatte.  Jedenfalls mache ich das alles f√ºr den Fan, aber nicht f√ºr den praktischen Nutzen. </p><br><h1 id="zapusk-platformy-cherez-adb">  Plattformstart √ºber adb </h1><br><p>  Ich entschied mich, die Installation zu automatisieren und √ºber die ADB-Anwendung mit Gradle zu starten.  Wie auch immer, zu diesem Zeitpunkt hatte ich bereits eine kleine Liste von Shuffles geschrieben (Entpacken, Kopieren ge√§nderter Ressourcen und SMALI-Dateien in das Verzeichnis mit der entpackten Anwendung, Verpackung, Signatur, in der Tat sind alle Aufgaben nur L√§ufer f√ºr Konsolenbefehle).  Zu den vorhandenen Aufgaben wurden die folgenden Befehle hinzugef√ºgt </p><br><pre> <code class="plaintext hljs"> adb install ./build/1cem-x86.apk adb shell pm grant com.e1c.mobile android.permission.READ_EXTERNAL_STORAGE adb push src/1cConfiguration /storage/emulated/0/Download adb shell am start -n com.e1c.mobile/.App -a android.intent.action.MAIN -c android.intent.category.LAUNCHER adb shell am broadcast -n com.e1c.mobile/.Starter -a com.e1c.mobile.START_TEMPLATE -e templatepath /storage/emulated/0/Download/1cConfiguration/1cema.xml</code> </pre> <br><p>  Mit der obigen Befehlsfolge installieren wir apk, erteilen der installierten Anwendung die Berechtigung zum Lesen des Datentr√§gers, kopieren die 1s-Konfiguration auf das Ger√§t und geben Befehle zum Starten von 1s und Laden der Konfiguration.  Das funktioniert √ºbrigens nicht bei allen Android-Versionen, aber ich habe es auf der API 28 getestet, und dementsprechend macht diese Sequenz alles richtig.  Bei j√ºngeren Versionen kann es zu Problemen bei der Vergabe von Rechten kommen. </p><br><h1 id="vnedryayus-v-obrabotku-dannyh-ot-1s-i-modificiruyu-metki">  Ich bin an der Datenverarbeitung von 1s beteiligt und √§ndere Tags </h1><br><p>  Hier hatte ich mehrere M√∂glichkeiten zur Weiterentwicklung von Veranstaltungen. </p><br><ol><li>  Ich ordne MapImpl.smali direkt an, was eine ziemlich schwierige Aufgabe sein sollte, wenn man bedenkt, dass die Bibliothek f√ºr die Arbeit mit Google Maps ziemlich stark verkleinert ist und ich alles in der kleinen Syntax schreiben m√ºsste. </li><li>  Ich verwende die MapImpl.java-Datei, die ich dank jadx erhalten habe, √§ndere sie, verwende die Klassen, die ich verwende, um sie durch Stubs zu ersetzen, destilliere in smali, ersetze die Datei und packe sie.  Die Option schien mir angespannt, da es wirklich weh tat, viele Stecker zu haben, au√üerdem gab es Probleme mit einigen von ihnen, die ich nicht ausw√§hlen wollte. </li><li>  Ich kombiniere die Ans√§tze 1 und 2, f√ºge die Aufrufe einer speziellen Erweiterungsklasse MapImplExtenstion.java in den SMALI-Code ein, der einen Teil der Logik erweitert. Aus diesem Grund habe ich diese Option gew√§hlt, weil sie einfacher als die erste und zweite Option ist und mir sogar etwas komplizierter erscheint als Option 4. aber weniger m√ºhsam (ja, tr√§ume, naiv). </li><li>  Ersetzen Sie in der Regel Google Maps durch etwas anderes, z. B. Yandex.  Um die gesamte Arbeit in einem anderen Projekt zu erledigen, wiederholen Sie einfach die MapImpl-Signaturen, minimieren Sie das Entpacken und legen Sie die fertigen SMALI-Dateien ab, bevor Sie die Anwendung an die entsprechenden Stellen packen.  Es gibt keine Probleme mit verkleinerten Bibliotheken, aber ich m√ºsste mich registrieren, um einen Schl√ºssel f√ºr Karten zu erhalten, ein separates Projekt zu erstellen, Ressourcen zu verbinden und vieles mehr. </li><li>  Wie Option 4, aber ersetzen Sie Google durch ... Google.  Aber hier hatte ich den Verdacht, dass es m√∂glich sein w√ºrde, 1 in 1 Karten sdk zu verkleinern, und es gab keine Lust zu experimentieren. </li></ol><br><p>  Nach der dritten Option habe ich in src zwei Unterverzeichnisse erstellt: java f√ºr MapImplExtenstion.java und stubJava f√ºr Dateien, die nur zum Kompilieren ben√∂tigt werden.  Da ich mich entschlossen habe, die Labels ein wenig zu optimieren, haben mich die folgenden beiden Bereiche interessiert: </p><br><div class="spoiler">  <b class="spoiler_title">Felder Xj: Ljava / util / ArrayList und Xk: Ljava / util / ArrayList</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> .field private final Xj:Ljava/util/ArrayList; .annotation system Ldalvik/annotation/Signature; value = { "Ljava/util/ArrayList&lt;", "Lcom/google/android/gms/maps/model/LatLng;", "&gt;;" } .end annotation .end field .field private Xk:Ljava/util/ArrayList; .annotation system Ldalvik/annotation/Signature; value = { "Ljava/util/ArrayList&lt;", "Lcom/google/android/gms/maps/model/MarkerOptions;", "&gt;;" } .end annotation .end field</code> </pre> </div></div><br><p>  Unter Verwendung von jadx zum Dekompilieren in Java habe ich in dekompiliertem Code eine Methode gefunden, die daf√ºr verantwortlich ist, sie zu f√ºllen </p><br><div class="spoiler">  <b class="spoiler_title">KN-Methode</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kN</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Bundle extras = getIntent().getExtras(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (extras != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Sd = extras.getLong(<span class="hljs-string"><span class="hljs-string">"native"</span></span>); String[] stringArray = extras.getStringArray(<span class="hljs-string"><span class="hljs-string">"titles"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[] doubleArray = extras.getDoubleArray(<span class="hljs-string"><span class="hljs-string">"coords"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (doubleArray != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; doubleArray.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; stringArray.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i2 = i * <span class="hljs-number"><span class="hljs-number">2</span></span>; LatLng latLng = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LatLng(doubleArray[i2], doubleArray[i2 + <span class="hljs-number"><span class="hljs-number">1</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Xj.add(latLng); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Xk.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions().c(latLng).dS(stringArray[i])); } } } }</code> </pre></div></div><br><p>  Dementsprechend hat die MapImplExtension-Klasse die ArrayList [] -kN-Methode (String [] -Titel, double [] -Koordinaten) hinzugef√ºgt, die im ersten Element des Arrays eine Liste zur√ºckgibt, die in Xj und im zweiten eine Liste f√ºr Xk platziert werden muss. </p><br><div class="spoiler">  <b class="spoiler_title">Klasse MapImplExtension</b> <div class="spoiler_text"><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.e1c.mobile; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.ArrayList; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.android.gms.maps.model.LatLng; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.android.gms.maps.model.MarkerOptions; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MapImplExtension</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> MapImpl mapImpl; MapImplExtension(MapImpl mapImpl){ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.mapImpl = mapImpl; } ArrayList[] kN(String[] titles, <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>[] coordinates) { ArrayList[] result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList[<span class="hljs-number"><span class="hljs-number">2</span></span>]; ArrayList&lt;LatLng&gt; xj = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); ArrayList&lt;MarkerOptions&gt; xk = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); result[<span class="hljs-number"><span class="hljs-number">0</span></span>] = xj; result[<span class="hljs-number"><span class="hljs-number">1</span></span>] = xk; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> coordinatesOffset; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (coordinates != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; coordinates.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; titles.length; i++) { coordinatesOffset = i * <span class="hljs-number"><span class="hljs-number">2</span></span>; LatLng latlng = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> LatLng(coordinates[coordinatesOffset], coordinates[coordinatesOffset + <span class="hljs-number"><span class="hljs-number">1</span></span>]); xj.add(latlng); xk.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions().c(latlng).dS(<span class="hljs-string"><span class="hljs-string">" \n"</span></span> + titles[i])); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre></div></div><br><p>  Kompiliert mit den folgenden Befehlen, zuerst in class, dann in dex, dann in smali dekompiliert, um dann zusammen mit den restlichen Dateien zu packen </p><br><pre> <code class="plaintext hljs"> javac -encoding UTF-8 -d .\build -source 1.8 -target 1.8 -sourcepath .\src\stubJava .\src\java\com\e1c\mobile\MapImplExtenstion.java d8.bat .\build\com\e1c\mobile\MapImplExtension.class --output .\build java -jar C:\Path\to\baksmali\baksmali.jar d .\build\classes.dex -o .\build\unpackedOwn</code> </pre> <br><p>  Das Erweiterungsfeld des Typs unserer neuen Klasse wurde zu MapImpl.smali hinzugef√ºgt und die Initialisierung hinzugef√ºgt </p><br><div class="spoiler">  <b class="spoiler_title">Ein Feld hinzuf√ºgen</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#    .field private extension:Lcom/e1c/mobile/MapImplExtension; #  ,  return-void new-instance v0, Lcom/e1c/mobile/MapImplExtension; invoke-direct {v0, p0}, Lcom/e1c/mobile/MapImplExtension;-&gt;&lt;init&gt;(Lcom/e1c/mobile/MapImpl;)V iput-object v0, p0, Lcom/e1c/mobile/MapImpl;-&gt;extension:Lcom/e1c/mobile/MapImplExtension;</code> </pre> </div></div><br><p>  Au√üerdem wurde die Verarbeitung in der MapImpl-Datenklasse von 1s durch die Verarbeitung in der MapImplExtension-Klasse ersetzt </p><br><div class="spoiler">  <b class="spoiler_title">√Ñnderungen in MapImpl.kN ()</b> <div class="spoiler_text"><pre> <code class="plaintext hljs"> # v0 - ; v1 - ; v2 - extension; #  MapImplExtension.kN(...) iget-object v2, p0, Lcom/e1c/mobile/MapImpl;-&gt;extension:Lcom/e1c/mobile/MapImplExtension; invoke-virtual {v2, v1, v0}, Lcom/e1c/mobile/MapImplExtension;-&gt;kN([Ljava/lang/String;[D)[Ljava/util/ArrayList; # v0 -   ; v1 - | ; v2 -    move-result-object v0 const/4 v2, 0x0 aget-object v1, v0, v2 iput-object v1, p0, Lcom/e1c/mobile/MapImpl;-&gt;Xj:Ljava/util/ArrayList; const/4 v2, 0x1 aget-object v1, v0, v2 iput-object v1, p0, Lcom/e1c/mobile/MapImpl;-&gt;Xk:Ljava/util/ArrayList;</code> </pre> </div></div><br><p>  Nachdem ich die Anwendung gepackt und gestartet hatte, sah ich voller Freude, dass alles funktionierte.  Im Moment habe ich jedoch noch nichts unternommen, um die Funktionen der mobilen Plattform zu erweitern.  Nur die √úberschriften der Marken auf der Karte ge√§ndert.  Da ich das Image der Tags √§ndern wollte, brach ich ab und vergrub es ziemlich lange in den Quellen und der Dokumentation. </p><br><h1 id="dobavlenie-novoy-funkcionalnosti">  Neue Funktionalit√§t hinzuf√ºgen </h1><br><p>  Zun√§chst eine kleine Erkl√§rung, wie der Marker f√ºr das Etikett gesetzt wird.  Die <code>MarkerOptions</code> Klasse verf√ºgt √ºber ein <code>public MarkerOptions icon (BitmapDescriptor iconDescriptor)</code> an das das von einer der statischen Methoden der <code>BitmapDescriptorFactory</code> Klasse erstellte Objekt <code>BitmapDescriptorFactory</code> wird. </p><br><p>  Und hier wartete tats√§chlich ein Mist auf mich.  Da 1c dieses Gesch√§ft nicht nutzt, wurden die entsprechenden Klassen bei der Minifizierung einfach herausgeschnitten.  Ich musste sie wiederherstellen, und es war schmerzhaft und lang.  Genauer gesagt, die Klassen waren da, aber sie wurden umbenannt und enthielten nicht die erforderlichen Methoden.  Indem ich die Art der gesamten Bibliothek f√ºr die Arbeit mit Karten ausw√§hlte - anhand von Signaturen und Konstanten - fand ich die Entsprechung der Bibliotheksklassen zu Anwendungsklassen heraus, f√ºgte die erforderlichen Methoden und Felder hinzu, baute sie neu auf und war froh, dass diese Suche endlich abgeschlossen war, da sie schlie√ülich funktionierte, wenn auch nicht vom ersten Versuch an (mehrmals gem√§ht mit Unterschriften und verwirrten reduzierten Klassen). </p><br><div class="spoiler">  <b class="spoiler_title">Das Ergebnis (√§u√üerlich nicht sehr beeindruckend).</b>  <b class="spoiler_title">Zwei Punkte mit den Koordinaten (45; 45) und (46; 46)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/pv/cz/lu/pvczlujpmwuu2y2bauzieeszkby.png"></p></div></div><br><p>  Da das Volumen des ge√§nderten Codes ziemlich gro√ü ist - ich werde es nicht in den Artikel aufnehmen, werde ich nur Signatur√§nderungen geben.  Wenn sich jemand f√ºr alle √Ñnderungen interessiert, die ich in diesem Schritt vorgenommen habe, k√∂nnen Sie sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dieses Commit</a> ansehen. </p><br><pre> <code class="java hljs">   Lcom/google/android/gms/maps/model/MarkerOptions -   .<span class="hljs-function"><span class="hljs-function">method </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">icon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Lcom/google/android/gms/maps/model/a;)</span></span></span><span class="hljs-function">Lcom/google/android/gms/maps/model/MarkerOptions</span></span>;   com.google.android.gms.internal.fh   : <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzb</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zza</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>; <span class="hljs-function"><span class="hljs-function">b </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zzc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> RemoteException</span></span>;   com.google.android.gms.internal.fj     h       com.google.android.gms.maps.model.b (BitmapDescriptorFactory)    <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromResource</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromAsset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromPath</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultMarker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">defaultMarker</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> a </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fromBitmap</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap)</span></span></span><span class="hljs-function">      MapImplExtension.java   xk.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(new MarkerOptions()</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">c</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(latlng)</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dS</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"  "</span></span></span></span><span class="hljs-function"><span class="hljs-params"> + titles[i])</span></span></span><span class="hljs-function">)</span></span>;     MarkerOptions markerOptions = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MarkerOptions() .c(latlng) .dS(<span class="hljs-string"><span class="hljs-string">"  "</span></span> + titles[i]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//      markerOptions.icon(b.defaultMarker(b.HUE_YELLOW)); } xk.add(markerOptions);</span></span></code> </pre><br><p>  Zusammenfassend war die Erfahrung sehr interessant.  Zumindest f√ºr mich.  Ich half beim Herausfinden einiger Werkzeuge, lernte etwas mehr √ºber die Arbeit des Android und das Bytecode-Format f√ºr Dalvik / Art. Die Erfahrung mit der Auswahl von minimiertem Code w√§re auch n√ºtzlich (es gab bereits einen Fall, in dem ich in der Release-Version von R8 Klassenfelder herausschnitt, die zu diesem Zeitpunkt nur von der Methode verwendet wurden Ich habe es herausgefunden, jetzt w√ºrde es keine Probleme verursachen). </p><br><p>  Wenn jemand daran interessiert ist, alles selbst zu wiederholen und m√∂glicherweise noch mehr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufzuheben, habe ich auf Github</a> alle Quellen zusammen mit einem krummen Gradle-Skript gepostet, das sich aus der modifizierten Original-Apk zusammensetzt. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de475266/">https://habr.com/ru/post/de475266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de475250/index.html">Als Redash ein Problem bemerkte und behebte, das zu einer Verschlechterung der Python-Code-Leistung f√ºhrte</a></li>
<li><a href="../de475254/index.html">AERODISK vAIR-Architektur oder Merkmale der nationalen Clusterbildung</a></li>
<li><a href="../de475260/index.html">Der Unterschied zwischen einer asynchronen Funktion und einer Funktion, die ein Versprechen zur√ºckgibt</a></li>
<li><a href="../de475262/index.html">Die Verdauung von frischen Materialien aus der Welt des Frontends f√ºr die letzte Woche Nr. 388 (4. - 10. November 2019)</a></li>
<li><a href="../de475264/index.html">Schn√ºffler, die es k√∂nnten: Wie die FakeSecurity-Familie Online-Shops infizierte</a></li>
<li><a href="../de475270/index.html">SwiftUI: Erweiterbare / reduzierbare Abschnitte in der Listenansicht erstellen</a></li>
<li><a href="../de475272/index.html">Migration auf asynchrone Infrastruktur in Rust</a></li>
<li><a href="../de475276/index.html">Wie schreibe ich richtig behaupten</a></li>
<li><a href="../de475278/index.html">Wie man einen Hacker anschaut, w√§hrend ein Hacker einen anschaut</a></li>
<li><a href="../de475280/index.html">Cisco Passw√∂rter, DNS Zonen Migration, keine LDAP Anfragen, wir sammeln Ethernet Pakete. Probleme in einem Netzwerk mit r0ot-mi l√∂sen. Teil 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>