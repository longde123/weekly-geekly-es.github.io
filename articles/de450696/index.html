<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçº üë®üèΩ‚Äçü§ù‚Äçüë®üèª üíÉ CRUD Widget Generator f√ºr Yii ‚å®Ô∏è üôÑ ü¶ä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Was haben Kommentare zum Artikel √ºber Habr√© und zus√§tzliche Optionen beim Autokauf gemeinsam? 



 Unter dem Gesichtspunkt der Datenmodellierung sind ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CRUD Widget Generator f√ºr Yii</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450696/">  Was haben Kommentare zum Artikel √ºber Habr√© und zus√§tzliche Optionen beim Autokauf gemeinsam? <br><br><img src="https://habrastorage.org/webt/4x/ex/_2/4xex_2tbdcc_iwesc63zed-dqzm.png"><br><br>  Unter dem Gesichtspunkt der Datenmodellierung sind beide "verschachtelte" Entit√§ten, die unabh√§ngig vom √ºbergeordneten Objekt keine unabh√§ngige Bedeutung haben. <br><br>  In Yii ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">PHP-Framework</a> ) gibt es Gii - einen integrierten Codegenerator, mit dem Sie mithilfe weniger Datenklicks grundlegende CRUD-Schnittstellen mithilfe eines Datenmodells erstellen k√∂nnen. Dies beschleunigt die Entwicklung erheblich, gilt jedoch nur f√ºr unabh√§ngige Entit√§ten wie den Artikel oder die Maschine in den obigen Beispielen. <br><br>  Es w√§re gro√üartig, etwas √Ñhnliches f√ºr "verschachtelte" Datenobjekte generieren zu k√∂nnen, oder?  Jetzt - Sie k√∂nnen, willkommen bei kat f√ºr Details. <br><a name="habracut"></a><br>  F√ºr die Ungeduldigsten am Ende des Artikels werden Anweisungen f√ºr einen schnellen Start gegeben. <br><br>  Und f√ºr diejenigen, die an dem Artikel interessiert sind, werden Aspekte von einer Gesch√§ftsanwendung bis zu einem internen Ger√§t ber√ºcksichtigt: <br><br><ul><li>  Business Case: Posting nach Thema <br><ul><li>  Die Liste der Hauptthemen </li><li>  Liste verwandter Beitr√§ge </li></ul></li><li>  Unter der Haube: ein Gii-Generator basierend auf CRUD <br><ul><li>  Gii Generator Vorlage </li><li>  Widget-Basisklasse </li><li>  Integrierte Fassadensteuerung </li></ul></li><li>  Schnellstart <br><ul><li>  √úber Support und Entwicklung </li></ul></li></ul><br><h2>  Business Case: Posting nach Thema </h2><br>  Vielleicht Kommentare zu einem Habr und einem schlechten Beispiel seitdem  sind oft n√ºtzlicher als der Artikel selbst, aber in jedem Fall gibt es bei der Entwicklung einer Anwendung h√§ufig Situationen, in denen ein bestimmtes Objekt des Datenmodells f√ºr den Benutzer als unabh√§ngige Einheit von geringem Interesse ist. <br><br>  Stellen Sie sich eine vereinfachte Gesch√§ftsaufgabe vor: Erstellen einer Website zum Ver√∂ffentlichen von Nachrichten, die nach verschiedenen Themen gruppiert sind. <br><br>  Die Site sollte die folgenden Schnittstellen haben: <br><br><ol><li>  Die Hauptseite - sollte in Zukunft verschiedene Widgets unterst√ºtzen, aber in der aktuellen Implementierungsphase gibt es nur eines: eine Liste von Themen, die nach bestimmten Kriterien gefiltert werden. </li><li>  Vollst√§ndige Liste der Themen - eine vollst√§ndige Liste der Themen in Tabellenform; </li><li>  Themenseite - Informationen zum Thema und eine Liste der darin ver√∂ffentlichten Beitr√§ge. </li></ol><br>  Ziemlich normal, oder? <br><br>  Schauen wir uns das Datenmodell an: <br><br><img src="https://habrastorage.org/webt/f0/db/dp/f0dbdpmz9gbbxhsmxhu7vmzurem.png"><br><br>  Auch keine √úberraschungen.  Zwei Klassen von Modellen enthalten unsere Gesch√§ftslogik: <br><br><ul><li>  <b>Themenklasse</b> - Daten zum Thema, Validierung, eine Liste der darin enthaltenen Beitr√§ge sowie eine separate Methode, die eine Liste der Themen zur√ºckgibt, die nach den Kriterien f√ºr das Widget auf der Hauptseite gefiltert sind. </li><li>  Die <b>Post-</b> Klasse besteht nur aus Daten und Validierung. </li></ul><br>  Die Anwendung wird von zwei Controllern bedient: <br><br><ul><li>  <b>SiteController</b> - Standardseiten (√ºber uns, Kontakte usw.), Autorisierung (nicht nach technischen Spezifikationen erforderlich, aber wir wissen etwas) und Index - die Hauptseite.  Weil  Wir erwarten in Zukunft viele verschiedene Widgets. Es ist sinnvoll, die Hauptseite in diesem Controller zu belassen und nicht auf ein bestimmtes Modell zu √ºbertragen. </li><li>  <b>TopicController</b> ist eine Standardaktion: <b>Auflisten</b> , Erstellen, Bearbeiten, Anzeigen und L√∂schen von Themen. </li></ul><br>  M√∂glicherweise k√∂nnen Sie auch einen <b>PostController</b> generieren - zu Verwaltungszwecken und / oder zum Kopieren und Einf√ºgen von Codeteilen in benutzerdefinierte Widgets. Lassen Sie dies jedoch au√üerhalb des Geltungsbereichs dieses Artikels. <br>  Bisher kann der gr√∂√üte Teil des Codes mit gii generiert werden, was die Entwicklung beschleunigt und Risiken reduziert (weniger manueller Code = weniger Fehlerwahrscheinlichkeit). <br><br>  Zwei Fragen bleiben offen: <br><br><ol><li>  Wie kann ich eine gefilterte Themenliste auf der Hauptseite anzeigen? </li><li>  Wie zeige ich eine Liste der Beitr√§ge nach Thema an? </li></ol><br>  Wenn Sie sie mit einem automatischen Generator l√∂sen k√∂nnen, ist dies eine solide Leistung. <br><br><h3>  Die Liste der Hauptthemen </h3><br>  Die Hauptseite, die von der Site- / Indexadresse bereitgestellt wird, sollte eine Liste von Themen enthalten, die nach einem vorgegebenen Kriterium gefiltert werden.  Filterkriterien haben wir als Teil der Gesch√§ftslogik in das Modell aufgenommen. <br><br>  F√ºr die Anzeige gibt es mehrere Implementierungsoptionen. <br><br>  Das erste, schmutzige und schnelle, ist, alles direkt in der Ansichtsdatei ( <b>views / site / index.php</b> ) zu erledigen: <br><br><ol><li>  <b>ActiveDataProvider</b> erstellen; </li><li>  F√ºllen Sie es mit Daten aus dem <b>Themenmodell</b> . </li><li>  Anzeige mit einem Standard- <b>ListView</b> / <b>GridView-</b> Widget, wobei die erforderlichen Felder manuell angegeben werden. </li></ol><br>  Sie k√∂nnen ein wenig weiter gehen und alles in eine separate Ansichtsdatei packen, z. B. <b>views / site / _topic-list-widget.php</b> , und das Rendern aus der <b>Hauptdatei</b> aufrufen.  Dies gibt ein wenig mehr Verwaltbarkeit und Erweiterbarkeit, aber es sieht immer noch ziemlich schmutzig aus. <br><br>  Die meisten von uns erstellen wahrscheinlich ein separates Widget gem√§√ü allen Regeln in einem separaten Namespace ( <b>App \ Widgets</b> oder <b>App \ Komponenten</b> f√ºr die <b>Basisvorlage</b> - abh√§ngig von der verwendeten Version), in dem die Erstellung von <b>ActiveDataProvider</b> nach Modell zusammengefasst und in einem separaten angezeigt wird Einreichung.  Sie m√ºssen dieses Widget nur noch von der Hauptseite aus aufrufen.  Diese L√∂sung ist unter dem Gesichtspunkt der Klassenzerlegung, Verwaltbarkeit und Erweiterbarkeit des Codes am korrektesten. <br><br>  Aber scheint der Code dieses Widgets den Code von <b>TopicController</b> in Bezug auf die Behandlung von <b>actionIndex</b> <b>()</b> sehr oft zu wiederholen?  Und es ist so √§rgerlich, diesen Code manuell zu schreiben. <br><br>  Es w√§re viel besser, diesen Code automatisch zu generieren und dann einfach das fertige Widget aufzurufen: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= \app\widgets\TopicControllerWidget::widget([ <span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'query'</span></span> =&gt; app\models\Topic::findBySomeSpecificCriteria() ], ]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br><h3>  Liste verwandter Beitr√§ge </h3>  Die Seite zum Anzeigen des von der <b>Themen- / Ansichtsadresse</b> bereitgestellten <b>Themas</b> sollte Informationen zum Thema selbst und eine Liste der darin ver√∂ffentlichten Nachrichten enthalten.  Wir erhalten die Liste der Nachrichten f√ºr das Thema im Modell automatisch, wenn wir die Beziehungen zwischen den Tabellen korrekt konfiguriert haben, sodass nur die Anzeigefrage √ºbrig bleibt. <br><br>  In Analogie zur gefilterten Themenliste haben wir fast die gleichen Optionen. <br><br>  Die erste besteht darin, alles im Code der Ansichtsdatei zu tun, um das Thema anzuzeigen ( <b>views / topic / view.php</b> ): <br><br><ol><li>  <b>ActiveDataProvider</b> erstellen; </li><li>  F√ºllen Sie es mit Daten aus dem Modell <b>$ model-&gt; getPosts ()</b> ; </li><li>  Anzeige mit einem Standard- <b>ListView</b> / <b>GridView-</b> Widget, wobei die erforderlichen Felder manuell angegeben werden. </li></ol><br>  Die zweite besteht darin, diesen Code in eine separate Pr√§sentationsdatei zu isolieren: <b>views / topic / _posts-list-widget.php</b> , nur um kein Dorn im Auge zu sein - die Wiederverwendung irgendwo schl√§gt immer noch fehl. <br><br>  Das dritte ist ein vollwertiges Widget, das den Code des bedingten <b>PostControllers</b> im <b>actionIndex</b> <b>() - Teil</b> weitgehend dupliziert, jedoch manuell geschrieben. <br><br>  Oder generieren Sie den Code automatisch und rufen Sie das fertige Widget auf: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([ <span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'query'</span></span> =&gt; $model-&gt;getPosts(), ], ]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><h2>  Unter der Haube: ein Gii-Generator basierend auf CRUD </h2><br>  Die Gesch√§ftsaufgabe wird definiert, die Anforderungen f√ºr das generierte Widget werden umrissen, wir werden herausfinden, wie genau wir es generieren werden.  Gii hat bereits einen Generator f√ºr den CRUD-Controller.  F√ºr ein CRUD-Widget m√ºssen wir einen neuen Generator erstellen, der auf dem vorhandenen basiert. <br><br>  Ein paar Links zur Dokumentation vor dem Start - es ist auch n√ºtzlich, wenn Sie Ihre eigene Erweiterung schreiben m√∂chten: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yii Erweiterung</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yii gii Vorlage</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yii gii Generator</a> . </li></ul><br>  Offensichtlich sind alle Funktionen in der Yii-Erweiterung enthalten, die √ºber Composer installiert wird und in den Herstellerordner Ihres Projekts gelangt. <br><br>  Die Erweiterung besteht aus drei Teilen: <br><br><ol><li>  Das <b>Templates / Crud-Verzeichnis,</b> das die Gii-Generator-Vorlage enth√§lt. </li><li>  <b>Controller.php-</b> Datei - integrierter Fassadencontroller f√ºr Widget-Aufrufe; </li><li>  Die Datei <b>Widget.php</b> ist die Basisklasse f√ºr alle generierten Widgets. </li></ol><br><img src="https://habrastorage.org/webt/uh/le/4c/uhle4cnzxzmubqgtoitn3ox5b_u.png"><br><br><h3>  Gii Generator Vorlage </h3><br>  Die Erweiterung muss Code generieren, daher ist ihr zentraler Teil der Gii-Generator. <br><br>  Zun√§chst wurde angenommen, dass es zur Implementierung der Erweiterung ausreichen w√ºrde, eine eigene Vorlage f√ºr den integrierten CRUD-Controller-Generator zu schreiben.  Aus diesem Grund wird das Verzeichnis √ºbrigens als Vorlagen und nicht als Generatoren bezeichnet.  Es stellte sich jedoch heraus, dass der CRUD-Controller-Generator eine sehr intensive Validierung der Eingabedaten durchf√ºhrt, die es nicht erm√∂glichte, viele Anforderungen zu implementieren, z. B. die Klasse f√ºr die Vererbung zu √§ndern.  Daher enth√§lt die Erweiterung einen vollwertigen Generator und nicht nur eine Vorlage. <br><br>  Der Gii-Generator besteht aus folgenden Teilen (alle befinden sich im Verzeichnis templates / crud): <br><br><ul><li>  Das <b>Standardverzeichnis</b> ist eine Vorlage, in der die ganze Magie passiert: Jede Datei in diesem Verzeichnis entspricht einer generierten Datei in Ihrem Projekt. </li><li>  Datei <b>form.php</b> - Wie Sie <b>anhand</b> des Namens erraten k√∂nnen, ist dies ein Formular zur Eingabe von Generierungsparametern (Klassennamen usw.). </li><li>  File <b>Generator.php</b> - Ein Generationsorchester, das Daten aus dem Formular empf√§ngt, validiert und anschlie√üend die Vorlagendateien nacheinander aufruft, um das Ergebnis zu erstellen. </li></ul><br>  Die <b>Dateien</b> <b>Generator.php</b> und <b>form.php</b> enthalten haupts√§chlich kosmetische √Ñnderungen gegen√ºber den Originaldateien des CRUD-Generators: Dateinamen, Validierung, Beschreibungen und Eingabeaufforderungstexte usw. <br><br>  Vorlagendateien sind f√ºr die generierte Ansicht und den Widget-Code selbst verantwortlich.  Zun√§chst ist die Datei <b>templates / crud / default / controller.php</b> wichtig, die f√ºr die direkte Generierung der der Controller-Klasse entsprechenden Widget-Klasse aus dem urspr√ºnglichen Generator verantwortlich ist. <br><br>  Das Widget sollte dieselben Aktionen wie der CRUD-Controller haben, sie werden jedoch etwas anders generiert.  Die folgenden Beispiele zeigen das Ergebnis der Generierung mit Kommentaren: <br><br><ul><li>  actionIndex - Anstelle der bedingungslosen Ausgabe aller Modelle akzeptiert die Methode den Parameter $ query. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($query)</span></span></span><span class="hljs-function"> </span></span>{ $dataProvider = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActiveDataProvider([ <span class="hljs-string"><span class="hljs-string">'query'</span></span> =&gt; $query, ]); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'index'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'dataProvider'</span></span> =&gt; $dataProvider, ]); }</code> </pre> </li><li>  actionCreate und actionUpdate - Im Erfolgsfall geben sie anstelle einer Umleitung einfach den Erfolgscode zur√ºck. Die weitere Verarbeitung erfolgt durch die integrierte Fassadensteuerung. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Post(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($model-&gt;load(Yii::$app-&gt;request-&gt;post()) &amp;&amp; $model-&gt;save()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'success'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'create'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'model'</span></span> =&gt; $model, ]); }</code> </pre> <br></li><li>  actionDelete - unterst√ºtzt die GET-Methode zum Anzeigen des L√∂sch-Widgets (standardm√§√üig - eine Schaltfl√§che) und POST zum Ausf√ºhren der Aktion.  Bei Erfolg wird auch keine Umleitung durchgef√ºhrt, sondern ein Code zur√ºckgegeben. <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">actionDelete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id)</span></span></span><span class="hljs-function"> </span></span>{ $model = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;findModel($id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Yii::$app-&gt;request-&gt;method == <span class="hljs-string"><span class="hljs-string">'GET'</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;render(<span class="hljs-string"><span class="hljs-string">'delete'</span></span>, [ <span class="hljs-string"><span class="hljs-string">'model'</span></span> =&gt; $model, ]); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { $model-&gt;delete(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'success'</span></span>; } }</code> </pre> </li></ul><br>  Schlie√ülich enthalten Ansichtsdateien die folgenden grundlegenden √Ñnderungen: <br><br><ul><li>  Alle Header wurden in h2 anstelle von h1 √ºbersetzt. </li><li>  Der Code, der f√ºr die Anzeige des Titels der Seite und f√ºr Breadcrumbs verantwortlich ist, wurde entfernt. Das Widget sollte diese Dinge nicht beeinflussen. </li><li>  Das Erstellen und Bearbeiten von Modellen erfolgt √ºber ein modales Fenster (integriertes modales Widget). </li><li>  L√∂sch-Widget-Vorlage hinzugef√ºgt - mit einer gro√üen roten Schaltfl√§che. </li></ul><br><h3>  Widget-Basisklasse </h3><br>  Wenn der Generator seine Arbeit beendet hat, erstellt er eine Widget-Klasse im Anwendungsnamespace.  Die Vererbungskette sieht folgenderma√üen aus: F√ºr die Anwendung generierte Widgets werden vom <b>Basiserweiterungs-</b> Widget class <b>\ ianikanov \ wce \ Widget</b> geerbt, das wiederum vom Basis-Yii-Widget class <b>\ yii \ base \ Widget geerbt wird</b> . <br><br>  Die Basisklasse des Erweiterungs-Widgets l√∂st die folgenden Aufgaben: <br><br><ol><li>  Definiert zwei Hauptfelder: $ action und $ params, √ºber die die Steuerung aus der aufrufenden Ansicht an das Widget √ºbertragen wird. </li><li>  Definiert eine Reihe von Standardparametern, die in der generierten Klasse √ºberschrieben werden k√∂nnen, z. B. den Pfad zu den Ansichtsdateien des Widgets, den Namen und den Pfad zur Fassadensteuerung (siehe unten) und Fehlermeldungen. </li><li>  Definiert Standardparameter beim Rendern von Ansichten: render und renderFile; </li><li>  Bietet eine Ereignisinfrastruktur √§hnlich der Controller-Infrastruktur, sodass Standardfilter wie <b>AccessControl</b> und <b>VerbFilter funktionieren</b> . </li><li>  Definiert eine Ausf√ºhrungsmethode, die all dies zusammen sammelt. </li></ol><br><h3>  Integrierte Fassadensteuerung </h3>  Es gibt keine Probleme bei der Anzeige dieser Daten - Widgets sind f√ºr diesen Zweck vorgesehen.  F√ºr die Bearbeitung ben√∂tigen Sie jedoch einen Controller.  Generieren Sie f√ºr jedes Widget einen eindeutigen Controller - seine gesamte Essenz geht verloren.  Die Verwendung einer Standard-CRUD ist nicht immer relevant, und ich m√∂chte nicht auf den zus√§tzlichen Start von gii angewiesen sein.  Daher wurde die Option mit einer universellen, integrierten Steuerungsfassade verwendet. <br><br>  Dieser Controller ist in der Anwendungszuordnung √ºber die Konfigurationsdatei registriert und enth√§lt nur eine Methode - actionIndex, die die folgenden Aktionen ausf√ºhrt: <br><br><ol><li>  Akzeptiert eine Anfrage von einem Kunden; </li><li>  √úbertr√§gt die Kontrolle an die entsprechende Widget-Klasse. </li><li>  Behandelt Gesch√§ftsfehler aufgrund des Widgets. </li><li>  Leitet zur√ºck zur Hauptanwendung. </li></ol><br>  Vielleicht ist es wichtiger anzugeben, was dieser Controller NICHT tut: <br><br><ol><li>  Die Zugriffsebenen werden nicht √ºberpr√ºft. Diese Logik geh√∂rt zu bestimmten Widgets. </li><li>  Es werden keine Eingabemanipulationen durchgef√ºhrt. Die Parameter werden unver√§ndert an das Widget √ºbergeben. </li><li>  Die Ausgabe wird nur manipuliert, um nach einem vordefinierten Erfolgscode zu suchen. </li></ol><br>  Mit diesem Ansatz k√∂nnen Sie die Vielseitigkeit der Fassade beibehalten und die Implementierung der Gesch√§ftsanforderungen, einschlie√ülich der Sicherheitsanforderungen, des Anwendungsanwendungscodes √ºberlassen. <br><br><h2>  Schnellstart </h2>  Die gesch√§ftliche Herausforderung ist klar, bereit zu beginnen?  Die Verwendung der Erweiterung umfasst vier Schritte: <br><br><ol><li>  Installation; </li><li>  Konfiguration; </li><li>  Generation; </li><li>  Anwendung. </li></ol><br>  Die Installation der Erweiterung erfolgt mit Composer: <br><br><pre> <code class="bash hljs">php composer.phar require --prefer-dist ianikanov/yii2-wce <span class="hljs-string"><span class="hljs-string">"dev-master"</span></span></code> </pre> <br>  Als N√§chstes m√ºssen Sie mehrere √Ñnderungen an der Anwendungskonfigurationsdatei vornehmen. <br><br>  F√ºgen Sie zun√§chst einen Verweis auf den Gii-Generator hinzu: <br><br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (YII_ENV_DEV) { $config[<span class="hljs-string"><span class="hljs-string">'modules'</span></span>][<span class="hljs-string"><span class="hljs-string">'gii'</span></span>] = [ <span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'yii\gii\Module'</span></span>, <span class="hljs-string"><span class="hljs-string">'allowedIPs'</span></span> =&gt; [<span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>, <span class="hljs-string"><span class="hljs-string">'::1'</span></span>, <span class="hljs-string"><span class="hljs-string">'192.168.0.*'</span></span>, <span class="hljs-string"><span class="hljs-string">'192.168.178.20'</span></span>], <span class="hljs-string"><span class="hljs-string">'generators'</span></span> =&gt; [ <span class="hljs-comment"><span class="hljs-comment">//here 'widgetCrud' =&gt; [ 'class' =&gt; '\ianikanov\wce\templates\crud\Generator', 'templates' =&gt; [ 'WCE' =&gt; '@vendor/ianikanov/yii2-wce/templates/crud/default', // template name ], ], ], ]; }</span></span></code> </pre> <br>  Zweitens f√ºgen Sie der Karte den integrierten Fassadencontroller hinzu: <br><br><pre> <code class="php hljs">$config = [ ... <span class="hljs-string"><span class="hljs-string">'controllerMap'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'wce-embed'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'\ianikanov\wce\Controller'</span></span>, ], ... ];</code> </pre> <br>  Damit ist die Installation und Konfiguration abgeschlossen. <br><br>  So generieren Sie ein Widget: <br><br><ol><li>  √ñffnen Sie gii; </li><li>  W√§hlen Sie "CRUD Controller Widget"; </li><li>  F√ºllen Sie die Formularfelder aus. </li><li>  Code anzeigen und generieren. </li></ol><br>  Um das Widget verwenden zu k√∂nnen, muss es durch Angabe von Aktion und Parametern aufgerufen werden - fast so, wie der Controller aufgerufen wird. <br><br>  Widget zum Anzeigen der Modellliste: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([ <span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'index'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span> =&gt; [ <span class="hljs-string"><span class="hljs-string">'query'</span></span> =&gt; $otherModel-&gt;getPosts(), ], ]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Widget zum Anzeigen eines Modells: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([<span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'view'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span> =&gt; [<span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $post_id]]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Widget zur Modellerstellung (Schaltfl√§che + Formular in Modal eingeschlossen): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([<span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'create'</span></span>]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Modellwechsel-Widget (Schaltfl√§che + Formular in Modal eingeschlossen): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([<span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'update'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span>=&gt;[<span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $post_id]]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Widget zum Entfernen von Modellen (Schaltfl√§che): <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span>= app\widgets\PostControllerWidget::widget([<span class="hljs-string"><span class="hljs-string">'action'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'delete'</span></span>, <span class="hljs-string"><span class="hljs-string">'params'</span></span>=&gt;[<span class="hljs-string"><span class="hljs-string">'id'</span></span> =&gt; $post_id]]) <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Der Code des Widgets und aller Ansichten geh√∂rt zur Anwendung und kann leicht ge√§ndert werden - alles ist genau das gleiche wie beim Generieren des Controllers. <br><br><h3>  √úber Support und Entwicklung </h3><br>  Ein paar Worte dar√ºber, wie die Erweiterung unterst√ºtzt und weiterentwickelt wird.  Ich habe die Hauptarbeit und einige meiner Nebenprojekte (Haustierprojekte).  Diese Erweiterung ist also ein Nebenprojekt aus meinen Nebenprojekten, daher werde ich Verbesserungen nur f√ºr die Bed√ºrfnisse meiner Projekte entwickeln. <br><br>  In den besten Open Source-Traditionen ist der Code auf dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> verf√ºgbar, und ich werde ihn bei der Behebung von Fehlern unterst√ºtzen. Ich werde auch versuchen, zeitnahe √úberpr√ºfungen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">durchzuf√ºhren</a> , wenn jemand eine Pull-Anfrage senden m√∂chte. Wer also interessiert ist, macht mit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450696/">https://habr.com/ru/post/de450696/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450682/index.html">Das Buch "CSS f√ºr die Profis"</a></li>
<li><a href="../de450684/index.html">Coole Smart Jumps: Tangram Smart Rope Smart Rope Bewertung</a></li>
<li><a href="../de450686/index.html">Drei weitere nicht offensichtliche Funktionen der Zimbra Collaboration Suite, die zur Steigerung der Mitarbeiterproduktivit√§t beitragen</a></li>
<li><a href="../de450692/index.html">Wie Unternehmen 7 Tods√ºnden im Produktverkauf einsetzen</a></li>
<li><a href="../de450694/index.html">Warum Jeff Bezos empfiehlt, Fehler zu skalieren und Science-Fiction anzusehen</a></li>
<li><a href="../de450698/index.html">Zahnr√§der in Box2D</a></li>
<li><a href="../de450700/index.html">Wieder √ºber l√∂chrige Abstraktionen (oder √ºber eine unvorhersehbare Umgebung)</a></li>
<li><a href="../de450702/index.html">Der Ort ist verdammt?</a></li>
<li><a href="../de450704/index.html">Sicherheitswoche 19: Sicherheitsl√ºcken in IP-Kameras, GPS-Trackern und drahtlosen Monitoren</a></li>
<li><a href="../de450708/index.html">Python in Visual Studio Code - Ver√∂ffentlichung im April 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>