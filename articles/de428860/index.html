<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ⓜ️ 🅾️ 👆🏾 DEFCON-Konferenz 17. Lachen Sie über Ihre Viren! Teil 2 👨🏻‍💼 🕯️ 🤴🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="DEFCON-Konferenz 17. Lachen Sie über Ihre Viren! Teil 1 

 Dann können Sie es in die IDA laden und sehen, dass alles in der Tabelle der importierten A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DEFCON-Konferenz 17. Lachen Sie über Ihre Viren! Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/428860/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DEFCON-Konferenz 17. Lachen Sie über Ihre Viren!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> <br><br>  Dann können Sie es in die IDA laden und sehen, dass alles in der Tabelle der importierten Adressen gut aussieht, und wir können den Querverbindungen folgen, um den Zeiger auf die gewünschte Datei zu setzen.  So gelangen wir zum genauen Ort des abhängigen Verschlüsselungscodes. <br><br><img src="https://habrastorage.org/webt/ja/31/xh/ja31xhgboctds-lmvejfwiycixc.jpeg"><br><br>  So fanden wir mit nur wenigen Befehlen zum Speichern des Speichers den Ort, an dem sich Coreflood versteckte.  Wir haben den PE-Header zerlegt, abgerufen und eingefügt, ohne ihn überhaupt zu haben, und in weniger als 20 Sekunden eine vollständig wiederhergestellte Adresstabelle erhalten. <br><br>  Die nächste Geschichte heißt "Schatz, es tut mir leid, dich wieder zu stören - ich bin vom Internet gestochen!"  Diese Geschichte erzählt uns, dass der defekte IP-Generator Conficker.B nur einen Teil des Internets scannt.  Hier kehren wir wieder zur Rand-Funktion zurück.  Ein wichtiger Teil dieser Funktion ist die allerletzte Anweisung, die ich mit einem grünen Pfeil markiert habe - sie führt jeden Endwert in EAX mit einem Wert von 7FFF aus.  Wenn Sie mit den Prinzipien der Montage nicht vertraut sind und nicht wissen, was diese Anweisung bewirken kann, finden Sie hier eine kleine Demo dazu. <br><br><img src="https://habrastorage.org/webt/a8/dh/lj/a8dhljmvnb6hrmu1hrhyosfityw.jpeg"><a name="habracut"></a><br><br>  Wir verschieben den Maximalwert, den EAX enthalten kann, in diese Registrierung und führen die endgültige Anweisung aus.  Sie können sehen, dass es die obere Hälfte des Werts "abschneidet" und dann 7FFF subtrahiert, das im Dezimalsystem in 32767 konvertiert wird. Anscheinend haben die Autoren nicht erkannt, dass diese Einschränkung, die Windows ausführt, nicht die gewünschte Größe an die Ganzzahl zurückgibt .  Es "schneidet" es ab, so dass der Wert 7FFF nicht überschreitet, so dass ein Byte von 7F niemals größer als dieser Wert von 7F sein wird, das heißt, es wird niemals gleich 80 oder so ähnlich sein. <br><br>  Weiter links auf der Folie, die ich als "bösartige Methode" bezeichnet habe, sehen Sie den Conficker.B-Code.  Dies zeigt einen Aufruf von rand, der das erste Oktett der IP-Adresse initiiert, das nach der Rückkehr von rand gescannt werden soll.  Der folgende Rand-Systemaufruf initiiert das dritte und vierte Oktett der IP-Adresse, aber aus den oben genannten Gründen sind zwei dieser Oktette niemals größer als 7F.  Daher kann der größte Teil des Internets nicht gescannt werden, da Conficker.B diesen Algorithmus verwendet. <br><br>  Auf der rechten Seite der Folie befindet sich der Teil des Quellcodes, der den Assembler zeigt.  Es ist schwierig, auf dem Bildschirm zu lesen, aber dieses Beispiel ist öffentlich verfügbar und Sie können es online lesen, wenn Sie interessiert sind. <br><br><img src="https://habrastorage.org/webt/5u/oj/tb/5uojtbhnvqiisohatadjziviyw8.jpeg"><br><br>  Ein Link zu diesem Tool befindet sich unten auf der nächsten Folie mit dem Titel „Simulation der bösartigen Methode“.  Sie können auch sehen, dass die IP-Adresse mit PRNG generiert, aber nicht gescannt wird. <br><br><img src="https://habrastorage.org/webt/7f/bd/vf/7fbdvfj000swmtbqwf7sdddjz3o.jpeg"><br><br>  Ich möchte Brandon Enright ein großes Dankeschön sagen, der den Zeitplan für die nächste Folie erstellt hat.  Dieses Diagramm wird als "Hilbert-Kurve" bezeichnet. Jetzt vergrößere ich das Bild, damit Sie es besser auf dem Bildschirm sehen können.  Die blaue Farbe in der Grafik zeigt den Bereich der IP-Adressen an, die von Conficker.B mit diesem bösartigen Algorithmus nicht gescannt werden können.  Die dunkelrote Farbe zeigt an, was gescannt werden kann.  Sie sehen, dass die meisten Teile des Diagramms nicht dunkelrot, sondern lila sind, und Sie werden nicht sehen, warum dies geschieht, bis Sie das entsprechende Rechteck vergrößern. <br><br><img src="https://habrastorage.org/webt/h0/-y/ar/h0-yarvdaqxrhr0a078wmwxmj-c.jpeg"><br><br>  Selbst in diesem vergrößerten Rechteck sehen Sie in jedem Block / 16 viele blaue Fragmente, die dunkelrot in lila verwandeln.  Dies sind die Teile der Adressen, die Conficker.B nicht scannen kann. <br><br><img src="https://habrastorage.org/webt/jv/z0/gb/jvz0gbqxngvlelc8vzavmvgmulk.jpeg"><br><br>  Dies ist sehr interessant, da viele Leute sicher sind, dass Conficker.B "großartige Köpfe" geschaffen hat.  Vielleicht ist es das, aber diese Köpfe waren sich der Einschränkungen, die in Windows rand () bestehen, nicht bewusst. <br><br>  <b>Matthew Richard:</b> Zurück zu den Jungs, die, wie gesagt, ihre Viren nicht sehr gut verwalten. In der Internetkriminalität ähnelt dies dem Sprichwort „Mensch zu Mensch Wolf“, daher werden diese Jungs in ihren Kreisen nicht respektiert. <br><br>  Lassen Sie uns über die Hacker-Tools Neosploit sprechen, die alle "erwischt" haben.  Wir können sagen, dass das Motto der Entwickler lautete: "Danke für das Geld, jetzt ist es Zeit zu rennen."  Neosploit ist ein Toolkit zum Organisieren von Webangriffen, sodass die Leute von Cybercrime es kaufen und gegen die Leute auf dem Server konfigurieren, den Server hacken, Codes herunterladen und so weiter. <br><br><img src="https://habrastorage.org/webt/ri/s1/bf/ris1bfmqjh1vrnr2a7hohfm13hg.jpeg"><br><br>  Die Entwickler von Neosploit haben eine gute Investition getätigt, indem sie ihr Werkzeug verkauft haben, aber nicht zugelassen haben, dass es geändert, modifiziert oder in Teilen verwendet wird.  Die dritte Version dieses Toolkits wurde im April 2008 veröffentlicht, und die meisten einzigartigen Exploits sind in C geschrieben. Es handelt sich also nicht um PHP oder eine Art Mist-Webanwendung.  Kunden erhielten eine Binärdistribution mit einer Reihe von CGI-Exploits. <br><br>  Neosploit verfügt über Funktionen, die verhindern, dass Kunden Exploits aufteilen oder kürzen.  Zu diesem Zweck wurden alle Exploits im Binärformat dargestellt und mit XOR verschlüsselt.  Die Macher haben es so gemacht, dass niemand seine eigenen Exploits basierend auf Neosploit schneiden, kleben und erstellen konnte.  Es gibt 40-50-60 verschiedene Arten von Web-Angriffen, die auf gestohlenen und kopierten Codes basieren, die in ihre eigenen Exploits eingefügt wurden. Die Neosploit-Leute sind also etwas schlauer, indem sie ihre Exploits von innen verschlüsseln.  Auf dem Screenshot sehen Sie, dass sie eine Datei mit dem Schlüssel neosploit.key haben. Dies ist also eine vollständig lizenzierte Software. <br><br><img src="https://habrastorage.org/webt/fn/uj/zq/fnujzqvxmuxcczupacqnibg2udq.jpeg"><br><br>  Ich habe keinen Zweifel daran, dass sie eine Menge wirklich guter Kunden hatten, mit denen sie viel Geld verdient haben.  Ihre bekanntesten Kunden waren Torpig.  Ich denke, Sie haben von dem Mebroot-Rootkit gehört, mit dem Systeme kompromittiert wurden, um ein Botnetz-Netzwerk zu erstellen.  Aber die Macher von Neosploit hatten viele andere Kunden.  Im Mai 2008 veröffentlichten sie eine neue Verbesserung - die 3. Version ihres Toolkits.  Kunden wurden gebeten, das Exploit-Paket mit allen nachfolgenden Updates für 1000 US-Dollar im Voraus zu bezahlen.  Später werde ich ausführlicher darüber sprechen, denn jetzt werde ich feststellen, dass sie sich wirklich Sorgen um die Piraten gemacht haben und versucht haben, ihr Produkt so weit wie möglich vor ihnen zu schützen, also hat es definitiv viel Spaß gemacht. <br><br><img src="https://habrastorage.org/webt/ri/o0/gq/rio0gq0dwfkuxt4cvuiu8agdafs.jpeg"><br><br>  Sogar die Medien schrieben, dass diese Exploits überall sind.  Wir werden natürlich versuchen, den Code zu zerlegen und zu zeigen, wie Neosploit funktioniert. <br><br>  Das erste lustige, was sie taten, nachdem sie diese Reihe von Exploits von April bis Juli intensiv beworben hatten, war ihre Unterstützung vom 20. Juli 2008. Die Erklärung, die sie einfach auf ihrer Website veröffentlichten, lautete wie folgt: „Leider Eine weitere Produktunterstützung ist nicht möglich.  Wir entschuldigen uns für die Unannehmlichkeiten, aber Geschäft ist Geschäft, und die für das Projekt aufgewendete Zeit hat sich nicht gerechtfertigt.  In den letzten Monaten haben wir bis zuletzt versucht, die Kundenanforderungen zu erfüllen, aber eines Tages sollte der Support eingestellt werden.  Wir sind seit anderthalb Jahren bei Ihnen und hoffen, dass dies nicht die schlechteste Zeit für Ihr Unternehmen war.  Jetzt werden wir nicht in Ihrer Nähe sein, aber wir möchten dennoch, dass Ihr Geschäft sehr lange floriert. “  Im Allgemeinen haben wir Ihr Geld erhalten, Sie haben das Abonnement bezahlt, seien Sie also gesund! <br><br>  Sie scherzten jedoch nur und kehrten im August 2008 zurück und veröffentlichten eine völlig neue Version 3.1, die sie ihren Hauptkunden zur Verfügung stellten, was darauf hinweist, dass alle anderen Kunden ein Update erhalten, nachdem sie dafür bezahlt haben.  Dieses Update enthielt mehrere neue Exploits für Adobe PDF, Shockwave Flash und Quicktime für Firefox. <br><br>  Dann entschieden sie sich erneut, ernst zu sein und kündigten an, dass sie die Veröffentlichung von Updates tatsächlich einstellen würden, sodass alle, die ein Prepaid-Abonnement abgeschlossen hatten, es vermasselten. <br><br>  Kommen wir also zu Neosploit, diesem ziemlich coolen Kit zum Organisieren von Webangriffen.  Da die Entwickler gegen Piraten kämpften und Exploits stahlen, die kopiert und in die Kits anderer Leute eingefügt werden konnten, nahmen sie jeden Exploit in eine CGI-Datei und codierten ihn so, dass es sehr schwierig war, ihn dort herauszuholen.  C-Exploit-Binärdateien unterschieden sich geringfügig von PHP-Skripten. <br><br><img src="https://habrastorage.org/webt/ng/sh/fy/ngshfybrz6rq6bop8mraqqh2zzo.jpeg"><br><br>  Auf dem Neosploit-Blog wurde Dancho Danchevs Satz veröffentlicht, dass "jeder einen neuen Exploit erstellen kann", aber es ist ziemlich schwierig.  Ich beschloss herauszufinden, wie schwierig es war und begann, einen der Exploits zu zerlegen. <br><br>  Jeder Exploit wurde in verschlüsselter Form mit einem 3-Byte-XOR-Schlüssel gespeichert.  Für jede eingehende Anfrage wurde der Exploit entschlüsselt und dem Benutzer zur Arbeit zur Verfügung gestellt, und ein solcher Zyklus wurde ständig wiederholt. <br><br><img src="https://habrastorage.org/webt/ej/xa/xr/ejxaxrxb3favuqswsknbhqvzqxk.jpeg"><br><br>  Selbst wenn Sie den Speicher durchsuchen und den Speicherauszug entfernen könnten, ist dies immer noch recht schwierig, und Sie können trotzdem alle Exploits abrufen. Diese Puffer werden jedes Mal gelöscht. <br><br>  Wenn Sie diese Exploits kopieren und in das gewünschte Programm einfügen können, finden Sie glücklicherweise die Antwort.  Hierfür wird ein sehr leistungsfähiges Entschlüsselungswerkzeug verwendet - IDA-Scripting.  Mit ihm können Sie einen bestimmten Speicherbereich kommentieren oder sichern, Exploits aktualisieren. Dies kann nützlich sein, um mit Malware zu arbeiten, die Zeichenfolgen verwendet, die durch xor, base64 usw. kompliziert sind.  Ich habe ein IDE-Skript geschrieben, mit dem ich versucht habe, einen erfassten Speicherauszug eines verschlüsselten Exploits zu zerlegen. <br><br><img src="https://habrastorage.org/webt/ph/lh/04/phlh04jr_lkm9h6ammkwchmc5fs.jpeg"><br><br>  Es durchsucht alle verschlüsselten Objekte, sucht nach allen Aufrufen der Entschlüsselungsfunktionen, erfasst die verschlüsselten Objekte, entschlüsselt sie mit XOR und entfernt dann den Speicherauszug.  Dies ist eine Möglichkeit, aber ich denke, Sie könnten Ihr eigenes Skript schreiben, eine Anwendung, die dasselbe tut.  Wenn Sie wissen, wie Sie Neosploit neue Exploits hinzufügen können, können Sie etwas in diese Richtung tun. Sobald Sie den Speicherauszug entfernen, erkennen Sie natürlich den gesamten Klartext. Sie können ihn aus der Instrumentierung herausreißen und weiterverkaufen.  Die neuen Leute, die die Exploits entwickelten, gaben einfach auf, weil jemand gutes Geld verdiente, ohne sich um ihre Kunden zu kümmern. <br><br>  Wenn jemand den großen Hip-Hop-Philosophen Biggie Smalls von Notorius BIG gehört hat, dann kennt er sein Lied namens Ten Crack Commandments, "The Ten Commandments of Crack", das große Weisheit enthält.  Wenn Sie ein Drogendealer sind, befolgen Sie das 4-Gebot: "Setzen Sie sich niemals auf Ihren eigenen Dope, den Sie drücken."  Wahrscheinlich hat der Typ, den ich Peeper genannt habe und der seinen eigenen Schadcode verbreitet hat, dieses Lied nie gehört, weil er sein Produkt an sich selbst getestet hat. <br><br>  Sein Angriff war wie folgt.  Er schickte E-Mails, die als verschiedene Regierungsbehörden getarnt waren, und sprach Personen mit dem Namen an: „Lieber so und so, jemand hat bei der Federal Trade Commission eine Beschwerde gegen Ihr Unternehmen eingereicht. Klicken Sie hier, um ein Dokument herunterzuladen, das das Wesentliche im Detail beschreibt.“ . <br><br><img src="https://habrastorage.org/webt/pd/3e/jk/pd3ejkz0sqnukrbmaqwfa7dpcnc.jpeg"><br><br>  Dann folgte der Benutzer dem Link und versuchte, dieses Dokument herunterzuladen, und es war wirklich ein Word-Dokument im DOC-Format.  Es gab jedoch eine sehr schwierige Funktion.  Sie hatten die Möglichkeit, einfach ausführbare Dateien per Drag &amp; Drop aus einem Word-Dokument zu ziehen und dann umzubenennen. Beim Versuch, die Datei herunterzuladen, wurde jedoch die Meldung „Microsoft Word hat ein Problem festgestellt und das Dokument konnte nicht heruntergeladen werden.  Bitte doppelklicken Sie auf das Dokumentsymbol, um fortzufahren. "  Tolle Idee! <br><br><img src="https://habrastorage.org/webt/ej/5h/dq/ej5hdqstxn-ym3rh6ymrgjgdimo.jpeg"><br><br>  Natürlich haben die Leute geklickt, sie haben 6 Mal geklickt, um diese infizierte Nachricht zu erhalten, also hatte dieser Typ eine Menge Opfer.  Ich mochte diese Nachricht: "Sie haben versucht, mich auszutricksen, bla bla bla." <br><br>  Das nächste, was wir beim Verfolgen dieses Typen fanden, waren die offenen Verzeichnisse des Drop-Verzeichnisses, in denen er die erhaltenen Informationen ablegte. <br><br><img src="https://habrastorage.org/webt/-y/cf/f-/-ycff-c-idisj5uxijtbakrzvdu.jpeg"><br><br>  Vielleicht hatte er keine eigenen Tools, um sie zu verwalten, oder er fand, dass offene Verzeichnisse eine gute Sache sind, aber offene Verzeichnisse sind schlecht, wenn Sie viele Informationen speichern, die von verschiedenen Personen erhalten wurden.  Jeder Server, den er für seine "Landing" -Site konfigurieren würde, hatte ein offenes Verzeichnis, und Sie konnten einfach dort hineingehen und die Listen aller seiner Opfer und jedes einzeln anzeigen. <br><br>  In gewisser Weise war er ein guter Entwickler, weil er Qualitätscode schrieb.  Der Nachteil war jedoch, dass er bei der Adressierung seines Codes an einen Live-Server seine echte IP-Adresse verwendet hat und Sie solche Dinge nicht lange verwenden. <br><br><img src="https://habrastorage.org/webt/zz/jc/rq/zzjcrqpcs9r8e3bc-271cp3vroi.jpeg"><br><br>  Tatsächlich hatte er ein Standard-DSL-Modem, das mit der Ukraine in Kontakt trat. Er testete seinen gesamten Code und seine gesamte Malware, die eine gute Funktion namens "Follow me" oder "Follow me" hat.  Dieser Typ war damit beschäftigt, Bankdaten zu stehlen, aber manchmal wollte er nur seine Opfer beobachten, um zu sehen, was sie taten, also nannten wir ihn Peeper oder "Observer".  Er war nicht zufrieden mit der einfachen Funktionalität seiner Software, er begann sich selbst zu überwachen.  Es sieht ziemlich seltsam aus, als hätten Sie VNC-Fernzugriffsfenster auf Ihrem eigenen Computer geöffnet und sie in einer Schleife herumgeführt, um immer kleinere Bilder zu erhalten.  Tatsächlich tat er dies viele Male auf vielen "Landing" -Servern, tatsächlich war es sehr, sehr seltsam.  Wenn man also durch diese "Landungs" -Server schaut, könnte man sagen: "Oh, sieh mal, das ist ein Bild, auf dem er sich selbst beobachtet, sich selbst beobachtet, der sich selbst beobachtet." <br><br><img src="https://habrastorage.org/webt/tu/v1/6v/tuv16vk5cws25lqpqr0lymirwto.jpeg"><br><br>  "Mein Licht, Spiegel, sag mir, wer auf der Welt ist am süßesten"? <br><br>  Am meisten hat mir gefallen, was er für sich getan hat.  Er verwendete diese Follow Me-Funktion im Codeentwicklungsprozess.  Tatsächlich schrieb er den Code, beobachtete sich selbst und schickte dies alles an den Befehls- und Kontrollserver zurück.  So ermöglichte er den Beamten, die Hintertür zu durchbrechen, sein Gesicht auf den Boden zu legen und seinen Computer zu beschlagnahmen.  Kurz gesagt, nichts hilft, Sie loszuwerden, wie ein Bild eines Quellbaums, der an Ihre IP-Adresse angehängt ist. <br><br><img src="https://habrastorage.org/webt/q0/ic/f9/q0icf9sq3191sbbcj2jk27t5eiw.jpeg"><br><br>  Die letzte Malware, die wir uns ansehen werden, wird sicherlich Leute interessieren, die mit Internet Explorer 7 vertraut sind. Aber keine Sorge, Microsoft sagt, dass alles unter Kontrolle ist, vertrauen Sie ihnen! <br><br><img src="https://habrastorage.org/webt/dw/7r/2f/dw7r2f9zbestlmksm14of1q72dc.jpeg"><br><br>  Microsoft hatte also ein großes Problem mit Internet Explorer 6, da es sehr einfach war, gespeicherte Passwörter von diesem Browser zu stehlen.  Normalerweise gehen Sie zur Site, sie fragen Sie, ob Sie das Passwort speichern möchten, ein spezielles Formular wird aufgerufen, Sie antworten mit "Ja" und es wird in der Registrierung gespeichert.  Das Problem mit IE 6 war, dass Sie, wenn Sie sich als Benutzer anmelden, nur einen CryptUnprotectData () -Systemaufruf ausführen müssen, um diese Kennwörter zu entschlüsseln, die wirklich keinen Schutz haben. <br><br>  Daher liest Malware mit Benutzerrechten diese Kennwörter frei und sendet sie an den Angreifer.  Daher haben sie in IE 7 einen hervorragenden „Patch“ installiert - Passwörter wurden mit einem 128-Bit-Schlüssel verschlüsselt.  Wirklich keine knackbare Lösung! <br>  Wenn Sie genauer hinschauen, können Sie den auf der Site verfügbaren Hash sehen. Ich werde dies etwas später erklären, in dem sich eine Binärdatei befindet, die den Benutzernamen und das Passwort enthält.  Ich möchte einen anderen großen Philosophen, John Travolta, aus dem Film Swordfish zitieren.  Meine Lieblingspassage ist, wenn er dort sitzt und erklärt: "Dieser Code ist so gut, dass selbst ich ihn nicht knacken kann."  Ich denke, er hatte eine 512-Bit-Verschlüsselung im Sinn, und er, der beste Verschlüsseler der Welt, warum er eingestellt wurde, sagt, dass selbst er das nicht kann. <br><br>  Also hier ist, was Microsoft getan hat.  Sie verschlüsseln das Kennwort, für das sie einen 128-Bit-Schlüssel basierend auf dem MD5-Hash der Site generieren, für die sie dieses Kennwort speichern.  Dies scheint ziemlich vernünftig zu sein. Wenn Sie also zu <a href="">www.bank.com/login.sp</a> gehen, werden sie diese Zeile verwenden, alle Buchstaben in Kleinbuchstaben <a href="">schreiben</a> , sie dann in große Zeichen codieren und den MD5-Algorithmus verwenden, wobei diese Zeile in einen Schlüssel umgewandelt wird wird verwendet, um das Passwort in der Registrierung für den Benutzernamen zu verschlüsseln. <br><br>  Wenn Sie dann diese Site besuchen, für die ein Kennwort gespeichert ist, tun sie das Gegenteil: Der IE normalisiert die URL, transkodiert die Zeichenfolge und überprüft in der Registrierung, ob Werte für Sie gespeichert sind.  Im Detail passiert es so: <br><br><ul><li>  Lesen Sie den Hash des Registers für jede URL in index.dat. </li><li>  URL wird in Kleinbuchstaben konvertiert; </li><li>  GET-Parameter werden reduziert; </li><li>  Die URL wird in große Zeichen konvertiert. </li><li>  Wenn der Hash des URL-Werts einem beliebigen Wert im Register entspricht, werden die Daten mithilfe dieser URL entschlüsselt. </li></ul><br>  Dies scheint ziemlich vernünftig zu sein, aber wenn Sie darüber nachdenken, gibt es ein kleines Problem.  Tatsächlich gibt es zu wenig Entropie, und der Hacker kann damit leicht umgehen.  Dies ist nicht viel komplizierter als die Kennwortverschlüsselung in IE 6. <br><br>  Es zu hacken ist ziemlich einfach.  Um das Kennwort zu speichern, muss der Benutzer die Site besuchen, die dann leicht in index.dat oder im Registrierungsschlüsselabschnitt „TypedURLS“ zu finden ist.  Wenn wir nur die Vereinigten Staaten betrachten, dann gibt es ungefähr 15.000 Standorte von Banken und Kreditgenossenschaften, und Sie können sie leicht finden.  Sie kennen die Websites, für die Sie Kennwörter suchen möchten, und jede dieser Websites verfügt über Anmeldeseiten. Daher ist es einfach, eine ganze Sammlung von Schlüsseln zusammenzustellen.  Wie Sie sehen, ist der Schutz hier eindeutig unzureichend. <br><br>  Wenn Sie ein Bösewicht sind, kennen Sie wahrscheinlich viele Websites, die Kennwörter benötigen: Facebook, Myspace oder Twitter oder andere mit einer Anmeldeseite, sodass Sie diese Websites einfach herausfinden können.  Sie können den Alexa-Dienst verwenden, der eine Liste der beliebtesten Websites verwaltet und Statistiken über deren Verkehr sammelt.  Die Schlüssel sind wirklich einfach zu entschlüsseln. Sie können so etwas wie eine „Regenbogentabelle“ erstellen, die auf diesen allgemeinen Quellen basiert, und dann haben Sie alle Schlüssel, um die Passwörter zu entschlüsseln. <br><br>      ,      IE 7  :    ,     . <br><br>      ?  , .       .       ,  Mozilla Firefox,  ,           .      ,      ,     ,   «Remember My password».         .      Firefox  IE 7    ,          ,       ,   ,      . <br><br>  ,    ,        ,      . <br><br>       Laqma.   ,       ,     .     -  ,      ,  ,          command and control. <br><br><img src="https://habrastorage.org/webt/ri/uf/c3/riufc3cranwrsexq9e-h98otht4.jpeg"><br><br>     ,     .        ,     ,   PHP -,          PHP    ,    –    . <br><br>         . <br><br> <b> :</b> ,    ,    ,    .           ,    .     Laqma,   .  ,              ,  Laqma   ,        .      ,       SSDT,                IDA  - . <br>  ,         Volatility,     .       ,  Laqma,     SSDT ,     ,   .         SSDT,   ,     SSDT,       SSDT. <br><br><img src="https://habrastorage.org/webt/w3/n1/df/w3n1df_7w3g1g1oma3ab8gp-lca.jpeg"><br><br>          TOS,         win32k,         ,      .     SSDT           ,      ,     TOS   win32k. <br><br>     ,   ,     ,  , drv, .sys,              .   ,   .   ,  SSDT    .               . <br><br><img src="https://habrastorage.org/webt/9z/q7/ye/9zq7yepu35kywoygfintms0bq6k.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Vorgang wird mithilfe des SSDT-Plugins leicht automatisiert. </font><font style="vertical-align: inherit;">Sie sehen, wie BSOD auf dem Bildschirm blitzte, es funktionierte das IDA-Befehlszeilenprogramm. </font><font style="vertical-align: inherit;">Als Ergebnis der automatischen Verarbeitung wird eine IDB erstellt. Dies ist etwas automatisierter, wodurch IDB-Funktionen, die den "eingebundenen" SSDT-Funktionen entsprechen, gekennzeichnet werden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit einem kleinen Schritt erfuhren wir, welche SSDT-Funktionen mit dem Speicherauszug verknüpft sind, dem das erstellte IDB-Modul gehört, und wir konnten sie benennen, um genau zu wissen, wo in IDB gesucht werden muss, wenn ich mit dem Reverse Engineering beginne. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich hoffe du hattest Spaß!</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OeG4KBWB-EY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Vielen Dank für Ihren Aufenthalt bei uns.  Gefällt dir unser Artikel?  Möchten Sie weitere interessante Materialien sehen?  Unterstützen Sie uns, indem Sie eine Bestellung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgeben</a> oder Ihren Freunden empfehlen, einen <b>Rabatt von 30% für Habr-Benutzer auf ein einzigartiges Analogon von Einstiegsservern, das wir für Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit über VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s von $ 20 oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s bis Dezember kostenlos,</b> wenn Sie für einen Zeitraum von sechs Monaten bezahlen, können Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> bestellen. <br><br>  <b>Dell R730xd 2 mal günstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 GB DDR4 6 x 480 GB SSD 1 Gbit / s 100 TV von 249 US-Dollar</a> in den Niederlanden und den USA!</b>  Lesen Sie mehr über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Aufbau eines Infrastrukturgebäudes.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern für 9.000 Euro für einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428860/">https://habr.com/ru/post/de428860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428850/index.html">Entwicklungsmanagement in einem großen Projekt</a></li>
<li><a href="../de428852/index.html">Offene Sendung der Haupthalle HighLoad ++ 2018</a></li>
<li><a href="../de428854/index.html">So schalten Sie das Licht in einem kleinen Rechenzentrum aus: eine kostengünstige Möglichkeit, Notfälle einzusetzen</a></li>
<li><a href="../de428856/index.html">Ein wunderbarer Trick, um Open Source-Projektbetreuer zu einem Tag zu machen</a></li>
<li><a href="../de428858/index.html">DEFCON-Konferenz 17. Lachen Sie über Ihre Viren! Teil 1</a></li>
<li><a href="../de428864/index.html">Lassen Sie uns das Web wieder großartig machen</a></li>
<li><a href="../de428866/index.html">7 Designprinzipien, Einstellung zu Designtrends, UX-Designer-Portfolio, ...</a></li>
<li><a href="../de428868/index.html">Multi-Release-JARs - schlecht oder gut?</a></li>
<li><a href="../de428870/index.html">Mrr: Gesamt-FRP für React</a></li>
<li><a href="../de428872/index.html">Die Geschichte von einem Auge und 20 Operationen (nicht lesbar) oder er wollte Pilot werden, aber er durfte nicht in den Himmel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>