<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ìÇÔ∏è üÖæÔ∏è üëÜüèæ DEFCON-Konferenz 17. Lachen Sie √ºber Ihre Viren! Teil 2 üë®üèª‚Äçüíº üïØÔ∏è ü§¥üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="DEFCON-Konferenz 17. Lachen Sie √ºber Ihre Viren! Teil 1 

 Dann k√∂nnen Sie es in die IDA laden und sehen, dass alles in der Tabelle der importierten A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DEFCON-Konferenz 17. Lachen Sie √ºber Ihre Viren! Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/428860/"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DEFCON-Konferenz 17. Lachen Sie √ºber Ihre Viren!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> <br><br>  Dann k√∂nnen Sie es in die IDA laden und sehen, dass alles in der Tabelle der importierten Adressen gut aussieht, und wir k√∂nnen den Querverbindungen folgen, um den Zeiger auf die gew√ºnschte Datei zu setzen.  So gelangen wir zum genauen Ort des abh√§ngigen Verschl√ºsselungscodes. <br><br><img src="https://habrastorage.org/webt/ja/31/xh/ja31xhgboctds-lmvejfwiycixc.jpeg"><br><br>  So fanden wir mit nur wenigen Befehlen zum Speichern des Speichers den Ort, an dem sich Coreflood versteckte.  Wir haben den PE-Header zerlegt, abgerufen und eingef√ºgt, ohne ihn √ºberhaupt zu haben, und in weniger als 20 Sekunden eine vollst√§ndig wiederhergestellte Adresstabelle erhalten. <br><br>  Die n√§chste Geschichte hei√üt "Schatz, es tut mir leid, dich wieder zu st√∂ren - ich bin vom Internet gestochen!"  Diese Geschichte erz√§hlt uns, dass der defekte IP-Generator Conficker.B nur einen Teil des Internets scannt.  Hier kehren wir wieder zur Rand-Funktion zur√ºck.  Ein wichtiger Teil dieser Funktion ist die allerletzte Anweisung, die ich mit einem gr√ºnen Pfeil markiert habe - sie f√ºhrt jeden Endwert in EAX mit einem Wert von 7FFF aus.  Wenn Sie mit den Prinzipien der Montage nicht vertraut sind und nicht wissen, was diese Anweisung bewirken kann, finden Sie hier eine kleine Demo dazu. <br><br><img src="https://habrastorage.org/webt/a8/dh/lj/a8dhljmvnb6hrmu1hrhyosfityw.jpeg"><a name="habracut"></a><br><br>  Wir verschieben den Maximalwert, den EAX enthalten kann, in diese Registrierung und f√ºhren die endg√ºltige Anweisung aus.  Sie k√∂nnen sehen, dass es die obere H√§lfte des Werts "abschneidet" und dann 7FFF subtrahiert, das im Dezimalsystem in 32767 konvertiert wird. Anscheinend haben die Autoren nicht erkannt, dass diese Einschr√§nkung, die Windows ausf√ºhrt, nicht die gew√ºnschte Gr√∂√üe an die Ganzzahl zur√ºckgibt .  Es "schneidet" es ab, so dass der Wert 7FFF nicht √ºberschreitet, so dass ein Byte von 7F niemals gr√∂√üer als dieser Wert von 7F sein wird, das hei√üt, es wird niemals gleich 80 oder so √§hnlich sein. <br><br>  Weiter links auf der Folie, die ich als "b√∂sartige Methode" bezeichnet habe, sehen Sie den Conficker.B-Code.  Dies zeigt einen Aufruf von rand, der das erste Oktett der IP-Adresse initiiert, das nach der R√ºckkehr von rand gescannt werden soll.  Der folgende Rand-Systemaufruf initiiert das dritte und vierte Oktett der IP-Adresse, aber aus den oben genannten Gr√ºnden sind zwei dieser Oktette niemals gr√∂√üer als 7F.  Daher kann der gr√∂√üte Teil des Internets nicht gescannt werden, da Conficker.B diesen Algorithmus verwendet. <br><br>  Auf der rechten Seite der Folie befindet sich der Teil des Quellcodes, der den Assembler zeigt.  Es ist schwierig, auf dem Bildschirm zu lesen, aber dieses Beispiel ist √∂ffentlich verf√ºgbar und Sie k√∂nnen es online lesen, wenn Sie interessiert sind. <br><br><img src="https://habrastorage.org/webt/5u/oj/tb/5uojtbhnvqiisohatadjziviyw8.jpeg"><br><br>  Ein Link zu diesem Tool befindet sich unten auf der n√§chsten Folie mit dem Titel ‚ÄûSimulation der b√∂sartigen Methode‚Äú.  Sie k√∂nnen auch sehen, dass die IP-Adresse mit PRNG generiert, aber nicht gescannt wird. <br><br><img src="https://habrastorage.org/webt/7f/bd/vf/7fbdvfj000swmtbqwf7sdddjz3o.jpeg"><br><br>  Ich m√∂chte Brandon Enright ein gro√ües Dankesch√∂n sagen, der den Zeitplan f√ºr die n√§chste Folie erstellt hat.  Dieses Diagramm wird als "Hilbert-Kurve" bezeichnet. Jetzt vergr√∂√üere ich das Bild, damit Sie es besser auf dem Bildschirm sehen k√∂nnen.  Die blaue Farbe in der Grafik zeigt den Bereich der IP-Adressen an, die von Conficker.B mit diesem b√∂sartigen Algorithmus nicht gescannt werden k√∂nnen.  Die dunkelrote Farbe zeigt an, was gescannt werden kann.  Sie sehen, dass die meisten Teile des Diagramms nicht dunkelrot, sondern lila sind, und Sie werden nicht sehen, warum dies geschieht, bis Sie das entsprechende Rechteck vergr√∂√üern. <br><br><img src="https://habrastorage.org/webt/h0/-y/ar/h0-yarvdaqxrhr0a078wmwxmj-c.jpeg"><br><br>  Selbst in diesem vergr√∂√üerten Rechteck sehen Sie in jedem Block / 16 viele blaue Fragmente, die dunkelrot in lila verwandeln.  Dies sind die Teile der Adressen, die Conficker.B nicht scannen kann. <br><br><img src="https://habrastorage.org/webt/jv/z0/gb/jvz0gbqxngvlelc8vzavmvgmulk.jpeg"><br><br>  Dies ist sehr interessant, da viele Leute sicher sind, dass Conficker.B "gro√üartige K√∂pfe" geschaffen hat.  Vielleicht ist es das, aber diese K√∂pfe waren sich der Einschr√§nkungen, die in Windows rand () bestehen, nicht bewusst. <br><br>  <b>Matthew Richard:</b> Zur√ºck zu den Jungs, die, wie gesagt, ihre Viren nicht sehr gut verwalten. In der Internetkriminalit√§t √§hnelt dies dem Sprichwort ‚ÄûMensch zu Mensch Wolf‚Äú, daher werden diese Jungs in ihren Kreisen nicht respektiert. <br><br>  Lassen Sie uns √ºber die Hacker-Tools Neosploit sprechen, die alle "erwischt" haben.  Wir k√∂nnen sagen, dass das Motto der Entwickler lautete: "Danke f√ºr das Geld, jetzt ist es Zeit zu rennen."  Neosploit ist ein Toolkit zum Organisieren von Webangriffen, sodass die Leute von Cybercrime es kaufen und gegen die Leute auf dem Server konfigurieren, den Server hacken, Codes herunterladen und so weiter. <br><br><img src="https://habrastorage.org/webt/ri/s1/bf/ris1bfmqjh1vrnr2a7hohfm13hg.jpeg"><br><br>  Die Entwickler von Neosploit haben eine gute Investition get√§tigt, indem sie ihr Werkzeug verkauft haben, aber nicht zugelassen haben, dass es ge√§ndert, modifiziert oder in Teilen verwendet wird.  Die dritte Version dieses Toolkits wurde im April 2008 ver√∂ffentlicht, und die meisten einzigartigen Exploits sind in C geschrieben. Es handelt sich also nicht um PHP oder eine Art Mist-Webanwendung.  Kunden erhielten eine Bin√§rdistribution mit einer Reihe von CGI-Exploits. <br><br>  Neosploit verf√ºgt √ºber Funktionen, die verhindern, dass Kunden Exploits aufteilen oder k√ºrzen.  Zu diesem Zweck wurden alle Exploits im Bin√§rformat dargestellt und mit XOR verschl√ºsselt.  Die Macher haben es so gemacht, dass niemand seine eigenen Exploits basierend auf Neosploit schneiden, kleben und erstellen konnte.  Es gibt 40-50-60 verschiedene Arten von Web-Angriffen, die auf gestohlenen und kopierten Codes basieren, die in ihre eigenen Exploits eingef√ºgt wurden. Die Neosploit-Leute sind also etwas schlauer, indem sie ihre Exploits von innen verschl√ºsseln.  Auf dem Screenshot sehen Sie, dass sie eine Datei mit dem Schl√ºssel neosploit.key haben. Dies ist also eine vollst√§ndig lizenzierte Software. <br><br><img src="https://habrastorage.org/webt/fn/uj/zq/fnujzqvxmuxcczupacqnibg2udq.jpeg"><br><br>  Ich habe keinen Zweifel daran, dass sie eine Menge wirklich guter Kunden hatten, mit denen sie viel Geld verdient haben.  Ihre bekanntesten Kunden waren Torpig.  Ich denke, Sie haben von dem Mebroot-Rootkit geh√∂rt, mit dem Systeme kompromittiert wurden, um ein Botnetz-Netzwerk zu erstellen.  Aber die Macher von Neosploit hatten viele andere Kunden.  Im Mai 2008 ver√∂ffentlichten sie eine neue Verbesserung - die 3. Version ihres Toolkits.  Kunden wurden gebeten, das Exploit-Paket mit allen nachfolgenden Updates f√ºr 1000 US-Dollar im Voraus zu bezahlen.  Sp√§ter werde ich ausf√ºhrlicher dar√ºber sprechen, denn jetzt werde ich feststellen, dass sie sich wirklich Sorgen um die Piraten gemacht haben und versucht haben, ihr Produkt so weit wie m√∂glich vor ihnen zu sch√ºtzen, also hat es definitiv viel Spa√ü gemacht. <br><br><img src="https://habrastorage.org/webt/ri/o0/gq/rio0gq0dwfkuxt4cvuiu8agdafs.jpeg"><br><br>  Sogar die Medien schrieben, dass diese Exploits √ºberall sind.  Wir werden nat√ºrlich versuchen, den Code zu zerlegen und zu zeigen, wie Neosploit funktioniert. <br><br>  Das erste lustige, was sie taten, nachdem sie diese Reihe von Exploits von April bis Juli intensiv beworben hatten, war ihre Unterst√ºtzung vom 20. Juli 2008. Die Erkl√§rung, die sie einfach auf ihrer Website ver√∂ffentlichten, lautete wie folgt: ‚ÄûLeider Eine weitere Produktunterst√ºtzung ist nicht m√∂glich.  Wir entschuldigen uns f√ºr die Unannehmlichkeiten, aber Gesch√§ft ist Gesch√§ft, und die f√ºr das Projekt aufgewendete Zeit hat sich nicht gerechtfertigt.  In den letzten Monaten haben wir bis zuletzt versucht, die Kundenanforderungen zu erf√ºllen, aber eines Tages sollte der Support eingestellt werden.  Wir sind seit anderthalb Jahren bei Ihnen und hoffen, dass dies nicht die schlechteste Zeit f√ºr Ihr Unternehmen war.  Jetzt werden wir nicht in Ihrer N√§he sein, aber wir m√∂chten dennoch, dass Ihr Gesch√§ft sehr lange floriert. ‚Äú  Im Allgemeinen haben wir Ihr Geld erhalten, Sie haben das Abonnement bezahlt, seien Sie also gesund! <br><br>  Sie scherzten jedoch nur und kehrten im August 2008 zur√ºck und ver√∂ffentlichten eine v√∂llig neue Version 3.1, die sie ihren Hauptkunden zur Verf√ºgung stellten, was darauf hinweist, dass alle anderen Kunden ein Update erhalten, nachdem sie daf√ºr bezahlt haben.  Dieses Update enthielt mehrere neue Exploits f√ºr Adobe PDF, Shockwave Flash und Quicktime f√ºr Firefox. <br><br>  Dann entschieden sie sich erneut, ernst zu sein und k√ºndigten an, dass sie die Ver√∂ffentlichung von Updates tats√§chlich einstellen w√ºrden, sodass alle, die ein Prepaid-Abonnement abgeschlossen hatten, es vermasselten. <br><br>  Kommen wir also zu Neosploit, diesem ziemlich coolen Kit zum Organisieren von Webangriffen.  Da die Entwickler gegen Piraten k√§mpften und Exploits stahlen, die kopiert und in die Kits anderer Leute eingef√ºgt werden konnten, nahmen sie jeden Exploit in eine CGI-Datei und codierten ihn so, dass es sehr schwierig war, ihn dort herauszuholen.  C-Exploit-Bin√§rdateien unterschieden sich geringf√ºgig von PHP-Skripten. <br><br><img src="https://habrastorage.org/webt/ng/sh/fy/ngshfybrz6rq6bop8mraqqh2zzo.jpeg"><br><br>  Auf dem Neosploit-Blog wurde Dancho Danchevs Satz ver√∂ffentlicht, dass "jeder einen neuen Exploit erstellen kann", aber es ist ziemlich schwierig.  Ich beschloss herauszufinden, wie schwierig es war und begann, einen der Exploits zu zerlegen. <br><br>  Jeder Exploit wurde in verschl√ºsselter Form mit einem 3-Byte-XOR-Schl√ºssel gespeichert.  F√ºr jede eingehende Anfrage wurde der Exploit entschl√ºsselt und dem Benutzer zur Arbeit zur Verf√ºgung gestellt, und ein solcher Zyklus wurde st√§ndig wiederholt. <br><br><img src="https://habrastorage.org/webt/ej/xa/xr/ejxaxrxb3favuqswsknbhqvzqxk.jpeg"><br><br>  Selbst wenn Sie den Speicher durchsuchen und den Speicherauszug entfernen k√∂nnten, ist dies immer noch recht schwierig, und Sie k√∂nnen trotzdem alle Exploits abrufen. Diese Puffer werden jedes Mal gel√∂scht. <br><br>  Wenn Sie diese Exploits kopieren und in das gew√ºnschte Programm einf√ºgen k√∂nnen, finden Sie gl√ºcklicherweise die Antwort.  Hierf√ºr wird ein sehr leistungsf√§higes Entschl√ºsselungswerkzeug verwendet - IDA-Scripting.  Mit ihm k√∂nnen Sie einen bestimmten Speicherbereich kommentieren oder sichern, Exploits aktualisieren. Dies kann n√ºtzlich sein, um mit Malware zu arbeiten, die Zeichenfolgen verwendet, die durch xor, base64 usw. kompliziert sind.  Ich habe ein IDE-Skript geschrieben, mit dem ich versucht habe, einen erfassten Speicherauszug eines verschl√ºsselten Exploits zu zerlegen. <br><br><img src="https://habrastorage.org/webt/ph/lh/04/phlh04jr_lkm9h6ammkwchmc5fs.jpeg"><br><br>  Es durchsucht alle verschl√ºsselten Objekte, sucht nach allen Aufrufen der Entschl√ºsselungsfunktionen, erfasst die verschl√ºsselten Objekte, entschl√ºsselt sie mit XOR und entfernt dann den Speicherauszug.  Dies ist eine M√∂glichkeit, aber ich denke, Sie k√∂nnten Ihr eigenes Skript schreiben, eine Anwendung, die dasselbe tut.  Wenn Sie wissen, wie Sie Neosploit neue Exploits hinzuf√ºgen k√∂nnen, k√∂nnen Sie etwas in diese Richtung tun. Sobald Sie den Speicherauszug entfernen, erkennen Sie nat√ºrlich den gesamten Klartext. Sie k√∂nnen ihn aus der Instrumentierung herausrei√üen und weiterverkaufen.  Die neuen Leute, die die Exploits entwickelten, gaben einfach auf, weil jemand gutes Geld verdiente, ohne sich um ihre Kunden zu k√ºmmern. <br><br>  Wenn jemand den gro√üen Hip-Hop-Philosophen Biggie Smalls von Notorius BIG geh√∂rt hat, dann kennt er sein Lied namens Ten Crack Commandments, "The Ten Commandments of Crack", das gro√üe Weisheit enth√§lt.  Wenn Sie ein Drogendealer sind, befolgen Sie das 4-Gebot: "Setzen Sie sich niemals auf Ihren eigenen Dope, den Sie dr√ºcken."  Wahrscheinlich hat der Typ, den ich Peeper genannt habe und der seinen eigenen Schadcode verbreitet hat, dieses Lied nie geh√∂rt, weil er sein Produkt an sich selbst getestet hat. <br><br>  Sein Angriff war wie folgt.  Er schickte E-Mails, die als verschiedene Regierungsbeh√∂rden getarnt waren, und sprach Personen mit dem Namen an: ‚ÄûLieber so und so, jemand hat bei der Federal Trade Commission eine Beschwerde gegen Ihr Unternehmen eingereicht. Klicken Sie hier, um ein Dokument herunterzuladen, das das Wesentliche im Detail beschreibt.‚Äú . <br><br><img src="https://habrastorage.org/webt/pd/3e/jk/pd3ejkz0sqnukrbmaqwfa7dpcnc.jpeg"><br><br>  Dann folgte der Benutzer dem Link und versuchte, dieses Dokument herunterzuladen, und es war wirklich ein Word-Dokument im DOC-Format.  Es gab jedoch eine sehr schwierige Funktion.  Sie hatten die M√∂glichkeit, einfach ausf√ºhrbare Dateien per Drag &amp; Drop aus einem Word-Dokument zu ziehen und dann umzubenennen. Beim Versuch, die Datei herunterzuladen, wurde jedoch die Meldung ‚ÄûMicrosoft Word hat ein Problem festgestellt und das Dokument konnte nicht heruntergeladen werden.  Bitte doppelklicken Sie auf das Dokumentsymbol, um fortzufahren. "  Tolle Idee! <br><br><img src="https://habrastorage.org/webt/ej/5h/dq/ej5hdqstxn-ym3rh6ymrgjgdimo.jpeg"><br><br>  Nat√ºrlich haben die Leute geklickt, sie haben 6 Mal geklickt, um diese infizierte Nachricht zu erhalten, also hatte dieser Typ eine Menge Opfer.  Ich mochte diese Nachricht: "Sie haben versucht, mich auszutricksen, bla bla bla." <br><br>  Das n√§chste, was wir beim Verfolgen dieses Typen fanden, waren die offenen Verzeichnisse des Drop-Verzeichnisses, in denen er die erhaltenen Informationen ablegte. <br><br><img src="https://habrastorage.org/webt/-y/cf/f-/-ycff-c-idisj5uxijtbakrzvdu.jpeg"><br><br>  Vielleicht hatte er keine eigenen Tools, um sie zu verwalten, oder er fand, dass offene Verzeichnisse eine gute Sache sind, aber offene Verzeichnisse sind schlecht, wenn Sie viele Informationen speichern, die von verschiedenen Personen erhalten wurden.  Jeder Server, den er f√ºr seine "Landing" -Site konfigurieren w√ºrde, hatte ein offenes Verzeichnis, und Sie konnten einfach dort hineingehen und die Listen aller seiner Opfer und jedes einzeln anzeigen. <br><br>  In gewisser Weise war er ein guter Entwickler, weil er Qualit√§tscode schrieb.  Der Nachteil war jedoch, dass er bei der Adressierung seines Codes an einen Live-Server seine echte IP-Adresse verwendet hat und Sie solche Dinge nicht lange verwenden. <br><br><img src="https://habrastorage.org/webt/zz/jc/rq/zzjcrqpcs9r8e3bc-271cp3vroi.jpeg"><br><br>  Tats√§chlich hatte er ein Standard-DSL-Modem, das mit der Ukraine in Kontakt trat. Er testete seinen gesamten Code und seine gesamte Malware, die eine gute Funktion namens "Follow me" oder "Follow me" hat.  Dieser Typ war damit besch√§ftigt, Bankdaten zu stehlen, aber manchmal wollte er nur seine Opfer beobachten, um zu sehen, was sie taten, also nannten wir ihn Peeper oder "Observer".  Er war nicht zufrieden mit der einfachen Funktionalit√§t seiner Software, er begann sich selbst zu √ºberwachen.  Es sieht ziemlich seltsam aus, als h√§tten Sie VNC-Fernzugriffsfenster auf Ihrem eigenen Computer ge√∂ffnet und sie in einer Schleife herumgef√ºhrt, um immer kleinere Bilder zu erhalten.  Tats√§chlich tat er dies viele Male auf vielen "Landing" -Servern, tats√§chlich war es sehr, sehr seltsam.  Wenn man also durch diese "Landungs" -Server schaut, k√∂nnte man sagen: "Oh, sieh mal, das ist ein Bild, auf dem er sich selbst beobachtet, sich selbst beobachtet, der sich selbst beobachtet." <br><br><img src="https://habrastorage.org/webt/tu/v1/6v/tuv16vk5cws25lqpqr0lymirwto.jpeg"><br><br>  "Mein Licht, Spiegel, sag mir, wer auf der Welt ist am s√º√üesten"? <br><br>  Am meisten hat mir gefallen, was er f√ºr sich getan hat.  Er verwendete diese Follow Me-Funktion im Codeentwicklungsprozess.  Tats√§chlich schrieb er den Code, beobachtete sich selbst und schickte dies alles an den Befehls- und Kontrollserver zur√ºck.  So erm√∂glichte er den Beamten, die Hintert√ºr zu durchbrechen, sein Gesicht auf den Boden zu legen und seinen Computer zu beschlagnahmen.  Kurz gesagt, nichts hilft, Sie loszuwerden, wie ein Bild eines Quellbaums, der an Ihre IP-Adresse angeh√§ngt ist. <br><br><img src="https://habrastorage.org/webt/q0/ic/f9/q0icf9sq3191sbbcj2jk27t5eiw.jpeg"><br><br>  Die letzte Malware, die wir uns ansehen werden, wird sicherlich Leute interessieren, die mit Internet Explorer 7 vertraut sind. Aber keine Sorge, Microsoft sagt, dass alles unter Kontrolle ist, vertrauen Sie ihnen! <br><br><img src="https://habrastorage.org/webt/dw/7r/2f/dw7r2f9zbestlmksm14of1q72dc.jpeg"><br><br>  Microsoft hatte also ein gro√ües Problem mit Internet Explorer 6, da es sehr einfach war, gespeicherte Passw√∂rter von diesem Browser zu stehlen.  Normalerweise gehen Sie zur Site, sie fragen Sie, ob Sie das Passwort speichern m√∂chten, ein spezielles Formular wird aufgerufen, Sie antworten mit "Ja" und es wird in der Registrierung gespeichert.  Das Problem mit IE 6 war, dass Sie, wenn Sie sich als Benutzer anmelden, nur einen CryptUnprotectData () -Systemaufruf ausf√ºhren m√ºssen, um diese Kennw√∂rter zu entschl√ºsseln, die wirklich keinen Schutz haben. <br><br>  Daher liest Malware mit Benutzerrechten diese Kennw√∂rter frei und sendet sie an den Angreifer.  Daher haben sie in IE 7 einen hervorragenden ‚ÄûPatch‚Äú installiert - Passw√∂rter wurden mit einem 128-Bit-Schl√ºssel verschl√ºsselt.  Wirklich keine knackbare L√∂sung! <br>  Wenn Sie genauer hinschauen, k√∂nnen Sie den auf der Site verf√ºgbaren Hash sehen. Ich werde dies etwas sp√§ter erkl√§ren, in dem sich eine Bin√§rdatei befindet, die den Benutzernamen und das Passwort enth√§lt.  Ich m√∂chte einen anderen gro√üen Philosophen, John Travolta, aus dem Film Swordfish zitieren.  Meine Lieblingspassage ist, wenn er dort sitzt und erkl√§rt: "Dieser Code ist so gut, dass selbst ich ihn nicht knacken kann."  Ich denke, er hatte eine 512-Bit-Verschl√ºsselung im Sinn, und er, der beste Verschl√ºsseler der Welt, warum er eingestellt wurde, sagt, dass selbst er das nicht kann. <br><br>  Also hier ist, was Microsoft getan hat.  Sie verschl√ºsseln das Kennwort, f√ºr das sie einen 128-Bit-Schl√ºssel basierend auf dem MD5-Hash der Site generieren, f√ºr die sie dieses Kennwort speichern.  Dies scheint ziemlich vern√ºnftig zu sein. Wenn Sie also zu <a href="">www.bank.com/login.sp</a> gehen, werden sie diese Zeile verwenden, alle Buchstaben in Kleinbuchstaben <a href="">schreiben</a> , sie dann in gro√üe Zeichen codieren und den MD5-Algorithmus verwenden, wobei diese Zeile in einen Schl√ºssel umgewandelt wird wird verwendet, um das Passwort in der Registrierung f√ºr den Benutzernamen zu verschl√ºsseln. <br><br>  Wenn Sie dann diese Site besuchen, f√ºr die ein Kennwort gespeichert ist, tun sie das Gegenteil: Der IE normalisiert die URL, transkodiert die Zeichenfolge und √ºberpr√ºft in der Registrierung, ob Werte f√ºr Sie gespeichert sind.  Im Detail passiert es so: <br><br><ul><li>  Lesen Sie den Hash des Registers f√ºr jede URL in index.dat. </li><li>  URL wird in Kleinbuchstaben konvertiert; </li><li>  GET-Parameter werden reduziert; </li><li>  Die URL wird in gro√üe Zeichen konvertiert. </li><li>  Wenn der Hash des URL-Werts einem beliebigen Wert im Register entspricht, werden die Daten mithilfe dieser URL entschl√ºsselt. </li></ul><br>  Dies scheint ziemlich vern√ºnftig zu sein, aber wenn Sie dar√ºber nachdenken, gibt es ein kleines Problem.  Tats√§chlich gibt es zu wenig Entropie, und der Hacker kann damit leicht umgehen.  Dies ist nicht viel komplizierter als die Kennwortverschl√ºsselung in IE 6. <br><br>  Es zu hacken ist ziemlich einfach.  Um das Kennwort zu speichern, muss der Benutzer die Site besuchen, die dann leicht in index.dat oder im Registrierungsschl√ºsselabschnitt ‚ÄûTypedURLS‚Äú zu finden ist.  Wenn wir nur die Vereinigten Staaten betrachten, dann gibt es ungef√§hr 15.000 Standorte von Banken und Kreditgenossenschaften, und Sie k√∂nnen sie leicht finden.  Sie kennen die Websites, f√ºr die Sie Kennw√∂rter suchen m√∂chten, und jede dieser Websites verf√ºgt √ºber Anmeldeseiten. Daher ist es einfach, eine ganze Sammlung von Schl√ºsseln zusammenzustellen.  Wie Sie sehen, ist der Schutz hier eindeutig unzureichend. <br><br>  Wenn Sie ein B√∂sewicht sind, kennen Sie wahrscheinlich viele Websites, die Kennw√∂rter ben√∂tigen: Facebook, Myspace oder Twitter oder andere mit einer Anmeldeseite, sodass Sie diese Websites einfach herausfinden k√∂nnen.  Sie k√∂nnen den Alexa-Dienst verwenden, der eine Liste der beliebtesten Websites verwaltet und Statistiken √ºber deren Verkehr sammelt.  Die Schl√ºssel sind wirklich einfach zu entschl√ºsseln. Sie k√∂nnen so etwas wie eine ‚ÄûRegenbogentabelle‚Äú erstellen, die auf diesen allgemeinen Quellen basiert, und dann haben Sie alle Schl√ºssel, um die Passw√∂rter zu entschl√ºsseln. <br><br>      ,      IE 7  :    ,     . <br><br>      ?  , .       .       ,  Mozilla Firefox,  ,           .      ,      ,     ,   ¬´Remember My password¬ª.         .      Firefox  IE 7    ,          ,       ,   ,      . <br><br>  ,    ,        ,      . <br><br>       Laqma.   ,       ,     .     -  ,      ,  ,          command and control. <br><br><img src="https://habrastorage.org/webt/ri/uf/c3/riufc3cranwrsexq9e-h98otht4.jpeg"><br><br>     ,     .        ,     ,   PHP -,          PHP    ,    ‚Äì    . <br><br>         . <br><br> <b> :</b> ,    ,    ,    .           ,    .     Laqma,   .  ,              ,  Laqma   ,        .      ,       SSDT,                IDA  - . <br>  ,         Volatility,     .       ,  Laqma,     SSDT ,     ,   .         SSDT,   ,     SSDT,       SSDT. <br><br><img src="https://habrastorage.org/webt/w3/n1/df/w3n1df_7w3g1g1oma3ab8gp-lca.jpeg"><br><br>          TOS,         win32k,         ,      .     SSDT           ,      ,     TOS   win32k. <br><br>     ,   ,     ,  , drv, .sys,              .   ,   .   ,  SSDT    .               . <br><br><img src="https://habrastorage.org/webt/9z/q7/ye/9zq7yepu35kywoygfintms0bq6k.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Vorgang wird mithilfe des SSDT-Plugins leicht automatisiert. </font><font style="vertical-align: inherit;">Sie sehen, wie BSOD auf dem Bildschirm blitzte, es funktionierte das IDA-Befehlszeilenprogramm. </font><font style="vertical-align: inherit;">Als Ergebnis der automatischen Verarbeitung wird eine IDB erstellt. Dies ist etwas automatisierter, wodurch IDB-Funktionen, die den "eingebundenen" SSDT-Funktionen entsprechen, gekennzeichnet werden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit einem kleinen Schritt erfuhren wir, welche SSDT-Funktionen mit dem Speicherauszug verkn√ºpft sind, dem das erstellte IDB-Modul geh√∂rt, und wir konnten sie benennen, um genau zu wissen, wo in IDB gesucht werden muss, wenn ich mit dem Reverse Engineering beginne. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich hoffe du hattest Spa√ü!</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/OeG4KBWB-EY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Vielen Dank f√ºr Ihren Aufenthalt bei uns.  Gef√§llt dir unser Artikel?  M√∂chten Sie weitere interessante Materialien sehen?  Unterst√ºtzen Sie uns, indem Sie eine Bestellung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgeben</a> oder Ihren Freunden empfehlen, einen <b>Rabatt von 30% f√ºr Habr-Benutzer auf ein einzigartiges Analogon von Einstiegsservern, das wir f√ºr Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit √ºber VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s von $ 20 oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verf√ºgbar). <br><br>  <b>VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s bis Dezember kostenlos,</b> wenn Sie f√ºr einen Zeitraum von sechs Monaten bezahlen, k√∂nnen Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> bestellen. <br><br>  <b>Dell R730xd 2 mal g√ºnstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 GB DDR4 6 x 480 GB SSD 1 Gbit / s 100 TV von 249 US-Dollar</a> in den Niederlanden und den USA!</b>  Lesen Sie mehr √ºber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Aufbau eines Infrastrukturgeb√§udes.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern f√ºr 9.000 Euro f√ºr einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de428860/">https://habr.com/ru/post/de428860/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de428850/index.html">Entwicklungsmanagement in einem gro√üen Projekt</a></li>
<li><a href="../de428852/index.html">Offene Sendung der Haupthalle HighLoad ++ 2018</a></li>
<li><a href="../de428854/index.html">So schalten Sie das Licht in einem kleinen Rechenzentrum aus: eine kosteng√ºnstige M√∂glichkeit, Notf√§lle einzusetzen</a></li>
<li><a href="../de428856/index.html">Ein wunderbarer Trick, um Open Source-Projektbetreuer zu einem Tag zu machen</a></li>
<li><a href="../de428858/index.html">DEFCON-Konferenz 17. Lachen Sie √ºber Ihre Viren! Teil 1</a></li>
<li><a href="../de428864/index.html">Lassen Sie uns das Web wieder gro√üartig machen</a></li>
<li><a href="../de428866/index.html">7 Designprinzipien, Einstellung zu Designtrends, UX-Designer-Portfolio, ...</a></li>
<li><a href="../de428868/index.html">Multi-Release-JARs - schlecht oder gut?</a></li>
<li><a href="../de428870/index.html">Mrr: Gesamt-FRP f√ºr React</a></li>
<li><a href="../de428872/index.html">Die Geschichte von einem Auge und 20 Operationen (nicht lesbar) oder er wollte Pilot werden, aber er durfte nicht in den Himmel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>