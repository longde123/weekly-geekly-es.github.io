<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ€ ğŸ•“ ğŸ‘¨ğŸ½ åœ¨MacOSä¸Šå“ªé‡Œå¯ä»¥æ‰¾åˆ°DNSè®¾ç½® â›”ï¸ â†–ï¸ ğŸ‘·</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä½ å¥½ 

 æœ€è¿‘ï¼Œæˆ‘é¢ä¸´ç€è°ƒè¯•åœ¨MacOSä¸­è§£æDNSåç§°çš„è¿‡ç¨‹çš„ä»»åŠ¡ã€‚ æˆ‘æ²¡æœ‰æ‰¾åˆ°å…³äºå®ƒå¦‚ä½•å‘ç”Ÿçš„å®Œæ•´ææ–™ï¼›æˆ‘å¿…é¡»è‡ªå·±æ”¶é›†ä¿¡æ¯ã€‚ 

 è¿™æ˜¯æˆ‘ä»¬è®¾æ³•æ‰¾åˆ°çš„ã€‚ 

 å¯¹äºä¸macOSä¸­çš„DNSç›¸å…³çš„ä»»åŠ¡ï¼Œæœ‰ä¸€ä¸ªåä¸ºmDNSResponderçš„å®ˆæŠ¤ç¨‹åºè´Ÿè´£ã€‚ ä¸€ç”Ÿä¸­ç»å†äº†å†’é™©-ä»–è¢«å‘ç°çš„å®ˆæŠ¤è¿›ç¨‹ï¼ˆYo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨MacOSä¸Šå“ªé‡Œå¯ä»¥æ‰¾åˆ°DNSè®¾ç½®</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436484/"> ä½ å¥½ <br><br> æœ€è¿‘ï¼Œæˆ‘é¢ä¸´ç€è°ƒè¯•åœ¨MacOSä¸­è§£æDNSåç§°çš„è¿‡ç¨‹çš„ä»»åŠ¡ã€‚ æˆ‘æ²¡æœ‰æ‰¾åˆ°å…³äºå®ƒå¦‚ä½•å‘ç”Ÿçš„å®Œæ•´ææ–™ï¼›æˆ‘å¿…é¡»è‡ªå·±æ”¶é›†ä¿¡æ¯ã€‚ <br><br> è¿™æ˜¯æˆ‘ä»¬è®¾æ³•æ‰¾åˆ°çš„ã€‚ <br><a name="habracut"></a><br> å¯¹äºä¸macOSä¸­çš„DNSç›¸å…³çš„ä»»åŠ¡ï¼Œæœ‰ä¸€ä¸ªåä¸ºmDNSResponderçš„å®ˆæŠ¤ç¨‹åºè´Ÿè´£ã€‚ ä¸€ç”Ÿä¸­ç»å†äº†å†’é™©-ä»–è¢«å‘ç°çš„å®ˆæŠ¤è¿›ç¨‹ï¼ˆYosemiteï¼‰å–ä»£ï¼Œå®ƒç ´åäº†å¾ˆå¤šå¹¶å¸¦æ¥äº†å¾ˆå¤šé—®é¢˜ã€‚ ä¸€å¹´åï¼Œè‹¹æœå¼€å§‹æ„è¯†åˆ°å¹¶é€€å›ï¼ˆEl Capitanï¼‰æˆç†Ÿçš„mDNSResponderï¼Œè¯¥äº§å“ç«‹å³ä¿®å¤äº†å¤§çº¦300ä¸ªé”™è¯¯å¹¶æ¢å¤äº†ç¨³å®šæ€§ã€‚ <br><br>  mDNSResponderæ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Bonjourçš„</a>ä¸€éƒ¨åˆ†ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Bonjour</a>æ˜¯ä¸€å¥—æ—¨åœ¨æ— éœ€é…ç½®å³å¯åœ¨ç½‘ç»œä¸Šæ“ä½œè®¾å¤‡çš„æŠ€æœ¯ï¼Œå…¶ä¸­åŒ…æ‹¬æœç´¢æœåŠ¡ï¼Œè‡ªåŠ¨åˆ†é…åœ°å€å’Œè§£æåç§°ã€‚ å½“æ‚¨æ‹¿å‡ºiPhoneå¹¶å¯»æ‰¾Apple TVæˆ–æ‰“å°æœºæ—¶ï¼Œå°†ä½¿ç”¨Bonjourã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/th/6p/kv/th6pkv9pqosnyumxfl3x-ass-am.jpeg" alt="å›¾ç‰‡" width="400"></div><br>  Bonjourä¹Ÿåˆ†åˆ«å…·æœ‰å¼€æºä»£ç å’ŒmDNSResponderã€‚ å¦‚æœæ‚¨éœ€è¦æ·±å…¥äº†è§£æœ€ç»ˆçœŸç›¸å¹¶æ˜¾ç¤ºæ‰€æœ‰éšè—çš„å†…å®¹ï¼Œåˆ™å¯ä»¥ç®€åŒ–ä»»åŠ¡ã€‚ è¯¥å½’æ¡£æ–‡ä»¶å·²ç»å…·æœ‰é’ˆå¯¹Windowsï¼ŒPosixå’ŒVxWorksçš„ç°æˆçš„å®ç°ã€‚ <br><br> å®ˆæŠ¤ç¨‹åºå¤„ç†å•æ’­DNSå’Œå¤šæ’­DNSã€‚  UnicastDNSæ˜¯æˆ‘ä»¬ä¹ æƒ¯å¹¶çŸ¥é“çš„å¸¸ç”¨DNSã€‚  MulticastDNSæ˜¯ä¸€ç§åœ¨ä¸éœ€è¦æœåŠ¡å™¨çš„æœ¬åœ°ç½‘ç»œä¸Šä½¿ç”¨DNSçš„åè®®ã€‚ å¦‚æœè®¾å¤‡éœ€è¦å¯»æ‰¾æŸäºº-å®ƒä¼šå‘é€ä¸€ä¸ªé—®é¢˜-â€œé—®é¢˜â€å¤šæ’­æ•°æ®åŒ…ï¼Œå¹¶ä»è®¾å¤‡æ¥æ”¶å¸¦æœ‰æ‰€è¯·æ±‚åç§°çš„å“åº”ï¼ˆå¦‚æœç¡®å®å­˜åœ¨ï¼‰ã€‚ ç›¸åŒåç§°çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RFC</a>ä¸­è¯¦ç»†æè¿°äº†åè®®æœ¬èº«ã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å“åº”è€…</a> ï¼ˆç”¨äºæ”»å‡»æœ¬åœ°ç½‘ç»œçš„è½¯ä»¶ï¼‰æ»¥ç”¨çš„æ­£æ˜¯MulticastDNSçš„åŠŸèƒ½ã€‚ å‘å°„åï¼Œå®ƒä¼šé˜´é™©åœ°å¼€å§‹å“åº”æ‰€æœ‰mDNSè¯·æ±‚ï¼Œä»è€Œå¸å¼•æ¯«æ— æˆ’å¿ƒçš„å—å®³è€…ã€‚ <br><br> è¿™æ˜¯é¢˜å¤–è¯-ç°åœ¨æ˜¯ä¸»è¦é—®é¢˜-å¦‚ä½•æŸ¥çœ‹å½“å‰çš„DNSç¼“å­˜å’ŒDNSè®¾ç½®çš„ä¸€èˆ¬çŠ¶æ€ã€‚ <br><br> å› æ­¤ï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š <br><br><ol><li> åœ¨ç»ˆç«¯ä¸­ï¼Œæˆ‘ä»¬å†™ï¼š <br><br><pre><code class="bash hljs">sudo <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> config --mode <span class="hljs-string"><span class="hljs-string">"private_data:on"</span></span></code> </pre> <br> æ­¤å‘½ä»¤å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿçœ‹åˆ°è¾“å‡ºï¼Œå¦åˆ™å®ƒå°†è¢«éšè—åœ¨ä¸“ç”¨æ’ä»¶ä¸‹ </li><li> æ‰“å¼€æ§åˆ¶å°ï¼Œé€‰æ‹©æˆ‘ä»¬çš„è®¾å¤‡ï¼š <br><br><img src="https://habrastorage.org/webt/pg/0y/ub/pg0yubn1qdimnustcmublmqf-8w.png"><br><br> ç„¶ååœ¨è¿‡æ»¤å™¨ä¸­ç¼–å†™mDNSResponder <br><br><img src="https://habrastorage.org/webt/vy/nz/rq/vynzrqh4bsl-qtwj9npv9rzvevg.png"></li><li> æˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œï¼š <br><br><pre> <code class="bash hljs">sudo killall -INFO mDNSResponder</code> </pre> </li><li> è¿”å›æ§åˆ¶å°å¹¶è·å¾—ä¸€ä¸ªä¸é”™çš„è¾“å‡ºï¼Œæˆ‘ä»¬ç°åœ¨å°†å¯¹å…¶è¿›è¡Œä¸€äº›åˆ†æï¼š <br><br><img src="https://habrastorage.org/webt/xb/e1/bz/xbe1bzrop_gx2fz25_z18yqki1y.png"><br></li></ol><br>  DNSè®¾ç½®çš„çŠ¶æ€æ˜¯ä¸€å—å¤§ç”»å¸ƒï¼Œåˆ†ä¸ºå‡ éƒ¨åˆ†ã€‚ å…¶ä¸­æœ€æœ‰è¶£çš„æ˜¯ï¼š <br><br> ç¼“å­˜-DNSç¼“å­˜ç›´æ¥å­˜å‚¨åœ¨æ­¤å¤„ï¼š <br><br><pre> <code class="bash hljs">------------ Cache ------------- Slt Q TTL <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> U Type rdlen 3 4290 en0 + PTR 33 _companion-link._tcp.local. PTR VMAC._companion-link._tcp.local. 3 4273 en0 + PTR 37 _companion-link._tcp.local. PTR VMAC\032(2)._companion-link._tcp.local. 6 107951 -U- - Addr 0 isafronov-G8WP. Addr 6 107951 -U- SOA 64 . SOA a.root-servers.net. nstld.verisign-grs.com. 2019011700 1800 900 604800 86400 6 107951 -U- - AAAA 0 isafronov-G8WP. AAAA 6 107951 -U- SOA 64 . SOA a.root-servers.net. nstld.verisign-grs.com. 2019011700 1800 900 604800 86400 9 763 -U- CNAME 37 1-courier.push.apple.com. CNAME 1.courier-push-apple.com.akadns.net. 13 8819 -U- CNAME 22 ax.itunes.apple.com.edgesuite.net. CNAME a1108.gi3.akamai.net.</code> </pre> <br> æ–‡ä»¶/ etc / hostsçš„å†…å®¹-ä»¥é˜²ä¸‡ä¸€ï¼š <br><br><pre> <code class="bash hljs">--------- /etc/hosts --------- State Interface KnownUnique LO 4 localhost. Addr 127.0.0.1 KnownUnique LO 16 localhost. AAAA ::1 KnownUnique LO 4 vmware-localhost. Addr 127.0.0.1 KnownUnique LO 16 vmware-localhost. AAAA ::1 KnownUnique LO 4 broadcasthost. Addr 255.255.255.255</code> </pre> <br>  MDNSç»Ÿè®¡ä¿¡æ¯-é‡å¤çš„åç§°ï¼Œæ•°æ®åŒ…æ•°é‡ï¼Œæ¥å£äº‹ä»¶ï¼š <br><br><pre> <code class="bash hljs">--- MDNS Statistics --- Name Conflicts 0 KnownUnique Name Conflicts 0 Duplicate Query Suppressions 2045 KA Suppressions 0 KA Multiple Packets 0 Poof Cache Deletions 203 -------------------------------- Multicast packets Sent 8211 Multicast packets Received 22382 Remote Subnet packets 1 QU questions received 25960 Normal multicast questions 62197 Answers <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> questions 4259 Unicast responses 0 Multicast responses 0 Unicast response Demotions 0 -------------------------------- Sleeps 181 Wakeups 182 Interface UP events 665 Interface UP Flap events 48 Interface Down events 817 Interface DownFlap events 16 Cache refresh queries 2876 Cache refreshed 28935 Wakeup on Resolves 0</code> </pre> <br> ç½‘ç»œæ¥å£åˆ—è¡¨ï¼š <br><br><pre> <code class="bash hljs">------ Network Interfaces ------ Struct addr Registered MAC BSSID Interface Address 00007FA2FD834E00 11, 00007FA2FD834E00, v6 utun0 00:00:00:00:00:00 00:00:00:00:00:00 Active A fe80::ebfb:c666:8f7b:62ed 00007FA2FF01B800 9, 00007FA2FF01B800, v6 awdl0 DE:14:B1:E7:21:33 00:00:00:00:00:00 Active v6 AM fe80::dc14:b1ff:fee7:2133 00007FA2FD829C00 7, 0000000000000000, v4 en0 F4:5C:89:8E:9D:C1 E4:8D:8C:61:7F:5D 192.168.1.73 dormant <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> 1943 seconds 00007FA2FD00C200 13, 00007FA2FD00C200, v4 en5 42:4D:7F:A3:50:1B 00:00:00:00:00:00 Active v4 AM 169.254.150.120 00007FA2FE008C00 7, 00007FA2FE008C00, v4 en0 F4:5C:89:8E:9D:C1 E4:8D:8C:61:7F:5C Active v4 AM p 192.168.1.73</code> </pre> <br>  DNSæœåŠ¡å™¨åˆ—è¡¨ï¼š <br><br><pre> <code class="bash hljs">--------- DNS Servers(2) ---------- DNS Server . en0 127.0.0.1:53 0 Unscoped 30 18283 v4 v6 !cell !exp !clat46 !DNSSECAware DNS Server . en0 127.0.0.1:53 0 InterfaceScoped 30 18291 v4 v6 !cell !exp !clat46 !DNSSECAware v4answers 1 v6answers 1 Last DNS Trigger: 140697 ms ago</code> </pre> <br>  MacOSå­ç³»ç»Ÿçš„å†…éƒ¨å’Œå¤–éƒ¨äº¤äº’ä¸–ç•Œéå¸¸å¹¿é˜”ï¼Œå¹¶ä¸”å……æ»¡äº†ç¥ç§˜è‰²å½©ã€‚ ä½¿ç”¨åŸŸååªæ˜¯å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†ã€‚ ä¸ºäº†è¿›ä¸€æ­¥é˜…è¯»ï¼Œæˆ‘å»ºè®®ï¼š <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è‹¹æœç™½çš®ä¹¦</a> </li><li> èµ„æºç®¡ç†å™¨æ¶æ„è½¯ä»¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åšå®¢</a>å’Œ*æ“ä½œç³»ç»Ÿç‹‚çƒ­è€…Patrick Wardle </li><li> ç ”ç©¶äººå‘˜çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç½‘ç«™</a> ï¼Œä¹¦ç±å’Œå®è·µ*æ“ä½œç³»ç»ŸJohnatan Levin </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN436484/">https://habr.com/ru/post/zh-CN436484/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN436472/index.html">DEFCON 20ä¼šè®®ï¼Œåœ¨60ç§’å†…æ•è·ï¼šä»æ¥å®¾å¸æˆ·åˆ°WindowsåŸŸç®¡ç†å‘˜ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN436474/index.html">DEFCON 20ä¼šè®®ï¼Œåœ¨60ç§’å†…æ•è·ï¼šä»æ¥å®¾å¸æˆ·åˆ°WindowsåŸŸç®¡ç†å‘˜ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN436476/index.html">ä¿é™©äº‘</a></li>
<li><a href="../zh-CN436480/index.html">æˆ‘ä¸ºè‡ªå·±åˆ¶ä½œäº†ä¸€ä¸ªä¸æ‹›è˜äººå‘˜äº¤æµçš„æœºå™¨äººï¼Œæˆ‘å¾ˆå–œæ¬¢</a></li>
<li><a href="../zh-CN436482/index.html">é«˜çº§Three.jsï¼šç€è‰²å™¨æè´¨å’Œåå¤„ç†</a></li>
<li><a href="../zh-CN436486/index.html">éŸ³é¢‘æ’­å®¢å¸‚åœºæ­£åœ¨å‘ç”Ÿä»€ä¹ˆ</a></li>
<li><a href="../zh-CN436488/index.html">C ++ 14ä¸­çš„å’–å–±å’Œéƒ¨åˆ†åº”ç”¨</a></li>
<li><a href="../zh-CN436490/index.html">æ‘©æ‰˜ç½—æ‹‰è®¡åˆ’æ¨å‡ºRazr v3ç‰ˆæœ¬</a></li>
<li><a href="../zh-CN436492/index.html">æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾ç¬¬åå±ŠDIY Mitapçš„æ¼”è®²è€…2019å¹´2æœˆ17æ—¥</a></li>
<li><a href="../zh-CN436494/index.html">æ›´æ¢ç£ç›˜åŒæ—¶ä¿æŒCEPHä¸­çš„æ­£ç¡®ç¼–å·</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>