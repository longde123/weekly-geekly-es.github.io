<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Å üñêüèΩ üë©üèª‚Äç‚öñÔ∏è F√°brica de rede para o Cisco ACI Data Center - Admin Help üëäüèº üëÅ‚Äçüó® üí™üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Com esta parte m√°gica do script Cisco ACI, voc√™ pode configurar rapidamente sua rede. 

 A f√°brica de rede do data center Cisco ACI existe h√° cinco an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>F√°brica de rede para o Cisco ACI Data Center - Admin Help</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/croc/blog/455882/"><img src="https://habrastorage.org/webt/sy/ml/l2/symll2m6gww_cyira-8xkwg5i3a.jpeg"><br>  <i>Com esta parte m√°gica do script Cisco ACI, voc√™ pode configurar rapidamente sua rede.</i> <br><br>  A f√°brica de rede do data center Cisco ACI existe h√° cinco anos, mas nada foi dito sobre isso na Habr, ent√£o decidi corrigi-lo um pouco.  Por experi√™ncia pr√≥pria, vou contar a voc√™ o que √©, o que √© bom e onde √© o rake. <br><br><h3>  O que √© e de onde veio? </h3><br>  Na √©poca do an√∫ncio da ACI (Application Centric Infrastructure) em 2013, os concorrentes estavam atacando as abordagens tradicionais das redes de data center em tr√™s lados ao mesmo tempo. <br><br>  Por um lado, as solu√ß√µes SDN de ‚Äúprimeira gera√ß√£o‚Äù baseadas no OpenFlow prometiam tornar as redes mais flex√≠veis e baratas ao mesmo tempo.  A id√©ia era tomar decis√µes, tradicionalmente executadas pelo software propriet√°rio dos switches, no controlador central. <br><br>  Esse controlador teria uma vis√£o √∫nica de tudo o que estava acontecendo e, com base nisso, programaria o hardware de todos os comutadores no n√≠vel das regras para processar fluxos espec√≠ficos. <a name="habracut"></a><br>  Por outro lado, as solu√ß√µes de rede de sobreposi√ß√£o tornaram poss√≠vel implementar as pol√≠ticas de conectividade e seguran√ßa necess√°rias sem nenhuma altera√ß√£o na rede f√≠sica, construindo t√∫neis de software entre hosts virtualizados.  O exemplo mais famoso dessa abordagem foi a decis√£o da Nicira, que j√° havia sido adquirida pela VMWare por US $ 1,26 bilh√£o e deu origem ao atual VMWare NSX.  Para alguma observa√ß√£o da situa√ß√£o, Nicira foi cofundado pelas mesmas pessoas que estavam anteriormente nas origens do OpenFlow, agora dizendo que o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OpenFlow n√£o √© adequado</a> para a constru√ß√£o de uma f√°brica de data center. <br><br>  E, finalmente, os chips de comuta√ß√£o dispon√≠veis no mercado aberto (o que √© chamado sil√≠cio comercial) atingiram um grau de maturidade em que se tornaram uma amea√ßa real aos fabricantes tradicionais de comutadores.  Anteriormente, cada fornecedor desenvolvia chips para seus comutadores, mas, com o tempo, os chips de fabricantes terceirizados, principalmente da Br¬Æadcom, come√ßaram a reduzir a dist√¢ncia com os chips dos fornecedores em termos de fun√ß√µes e em rela√ß√£o pre√ßo / desempenho que excederam.  Portanto, muitos acreditavam que os dias de troca de chips de seu pr√≥prio design s√£o numerados. <br><br>  A ACI foi a "resposta assim√©trica" ‚Äã‚Äãda Cisco (ou melhor, a Insieme, fundada por seus ex-funcion√°rios), a todas as op√ß√µes acima. <br><br><h3>  Qual √© a diferen√ßa com o OpenFlow? </h3><br>  Em termos de distribui√ß√£o de fun√ß√µes, o ACI √© realmente o oposto do OpenFlow. <br>  Na arquitetura OpenFlow, o controlador √© respons√°vel por prescrever regras detalhadas (fluxos) <br>  no hardware de todos os comutadores, ou seja, em uma rede grande, ele pode ser respons√°vel por manter e, o mais importante, alterar dezenas de milh√µes de registros em centenas de pontos na rede; portanto, seu desempenho e confiabilidade na implementa√ß√£o em larga escala tornam-se um gargalo. <br><br>  A ACI usa a abordagem oposta: √© claro, tamb√©m h√° um controlador, mas os comutadores recebem pol√≠ticas declarativas de alto n√≠vel dele, e o pr√≥prio comutador os renderiza nos detalhes de configura√ß√µes espec√≠ficas no hardware.  O controlador pode ser reiniciado ou desligado completamente e nada de ruim acontecer√° √† rede, exceto, √© claro, a falta de controle no momento.  Curiosamente, h√° situa√ß√µes no ACI em que o OpenFlow ainda √© usado, mas localmente no host para programar o Open vSwitch. <br><br>  O ACI √© totalmente constru√≠do sobre o transporte de sobreposi√ß√£o baseado em VXLAN, mas ao mesmo tempo inclui o transporte IP subjacente como parte de uma √∫nica solu√ß√£o.  A Cisco chamou isso de termo "sobreposi√ß√£o integrada".  Como ponto de termina√ß√£o para sobreposi√ß√µes na ACI, na maioria dos casos, os switches de f√°brica s√£o usados ‚Äã‚Äã(eles fazem isso na velocidade do canal).  Os hosts n√£o precisam saber nada sobre a f√°brica, encapsulamentos etc., no entanto, em alguns casos (por exemplo, para conectar hosts OpenStack), o tr√°fego VXLAN tamb√©m pode ser trazido a eles. <br><br>  As sobreposi√ß√µes s√£o usadas na ACI n√£o apenas para fornecer conectividade flex√≠vel atrav√©s da rede de transporte, mas tamb√©m para transmitir meta-informa√ß√µes (√© usada, por exemplo, para aplicar pol√≠ticas de seguran√ßa). <br><br>  Os chips da Broadcom foram usados ‚Äã‚Äãanteriormente pela Cisco na s√©rie de switches Nexus 3000. A fam√≠lia Nexus 9000, lan√ßada especialmente para oferecer suporte √† ACI, implementou inicialmente um modelo h√≠brido chamado Merchant +.  O switch usou simultaneamente o novo chip Broadcom Trident 2 e o chip de desenvolvimento da Cisco que o complementa, realizando toda a magia da ACI.  Aparentemente, isso tornou poss√≠vel acelerar a sa√≠da do produto e reduzir o pre√ßo do switch para um n√≠vel pr√≥ximo aos modelos apenas para o Trident 2. Essa abordagem foi suficiente nos primeiros dois a tr√™s anos de suprimentos da ACI.  Durante esse per√≠odo, a Cisco desenvolveu e lan√ßou a pr√≥xima gera√ß√£o do Nexus 9000 em seus pr√≥prios chips, com mais desempenho e recursos, mas com o mesmo n√≠vel de pre√ßo.  As especifica√ß√µes externas em termos de intera√ß√£o na f√°brica s√£o totalmente preservadas.  Ao mesmo tempo, o preenchimento interno mudou completamente: algo como refatora√ß√£o, mas para o ferro. <br><br><h3>  Como a arquitetura Cisco ACI funciona </h3><br>  No caso mais simples, o ACI √© constru√≠do sobre a topologia da rede Clos ou, como costumam dizer, Spine-Leaf.  Os comutadores no n√≠vel da coluna vertebral podem variar de dois (ou um, se n√£o nos importamos com toler√¢ncia a falhas) a seis.  Assim, quanto mais houver, maior ser√° a toler√¢ncia a falhas (menos redu√ß√£o na largura de banda e confiabilidade no caso de um acidente ou manuten√ß√£o de uma coluna) e o desempenho geral.  Todas as conex√µes externas v√£o para comutadores de n√≠vel folha: estes s√£o os servidores, conectando-se a redes externas via L2 ou L3 e conectando controladores APIC.  Em geral, com o ACI, n√£o apenas a configura√ß√£o, mas tamb√©m a coleta de estat√≠sticas, o monitoramento de falhas e assim por diante - tudo √© feito atrav√©s da interface dos controladores, que s√£o tr√™s em implementa√ß√µes de tamanho padr√£o. <br><br>  Voc√™ n√£o precisa se conectar aos comutadores com o console, nem mesmo para iniciar a rede: o pr√≥prio controlador detecta os comutadores e coleta a f√°brica deles, incluindo as configura√ß√µes de todos os protocolos de servi√ßo; portanto, a prop√≥sito, √© muito importante registrar os n√∫meros de s√©rie do equipamento instalado durante a instala√ß√£o, para que voc√™ n√£o precise adivinhar qual comutador qual rack est√° localizado.  Para solucionar problemas, voc√™ pode conectar-se aos switches via SSH, se necess√°rio: eles usam os comandos habituais da Cisco show com bastante cuidado. <br><br>  Por dentro, a f√°brica usa transporte IP, portanto n√£o h√° Spanning Tree e outros horrores do passado: todos os links est√£o envolvidos e a converg√™ncia em caso de falhas √© muito r√°pida.  O tr√°fego de f√°brica √© transmitido atrav√©s de t√∫neis VXLAN.  Mais precisamente, a pr√≥pria Cisco chama o encapsulamento iVXLAN e difere do VXLAN usual, pois os campos reservados no cabe√ßalho da rede s√£o usados ‚Äã‚Äãpara transmitir informa√ß√µes gerais, principalmente sobre a rela√ß√£o de tr√°fego com o grupo EPG.  Isso permite implementar as regras de intera√ß√£o entre grupos no equipamento, usando seus n√∫meros da mesma maneira que os endere√ßos s√£o usados ‚Äã‚Äãnas listas de acesso comuns. <br><br>  Os t√∫neis permitem que voc√™ se estenda pelo transporte IP interno e pelos segmentos L2 e L3 (ou seja, VRF).  Nesse caso, o gateway padr√£o √© distribu√≠do.  Isso significa que cada switch est√° envolvido no roteamento do tr√°fego que entra na f√°brica.  Em termos de l√≥gica de transfer√™ncia de tr√°fego, o ACI √© semelhante a uma f√°brica baseada em VXLAN / EVPN. <br><br><h3>  Se sim, quais s√£o as diferen√ßas?  Para o resto! </h3><br>  A diferen√ßa n√∫mero um que voc√™ encontra na ACI √© como os servidores est√£o conectados √† rede.  Nas redes tradicionais, a inclus√£o de servidores f√≠sicos e m√°quinas virtuais vai para as VLANs, e tudo o mais dan√ßa delas: conectividade, seguran√ßa etc. A ACI usa um design que a Cisco chama de EPG (End-point Group), do qual n√£o h√° lugar nenhum. para fugir.  √â poss√≠vel equiparar a uma VLAN?  Sim, mas neste caso h√° uma chance de perder a maior parte do que a ACI oferece. <br><br>  Em rela√ß√£o ao EPG, todas as regras de acesso s√£o formuladas e a ACI usa o princ√≠pio de "lista branca" por padr√£o, ou seja, somente o tr√°fego √© permitido, cuja transmiss√£o √© explicitamente permitida.  Ou seja, podemos criar grupos de EPG ‚ÄúWeb‚Äù e ‚ÄúMySQL‚Äù e definir uma regra que permita a intera√ß√£o entre eles apenas na porta 3306. Isso funcionar√° sem refer√™ncia aos endere√ßos de rede e at√© dentro da mesma sub-rede! <br><br>  Temos clientes que escolheram a ACI precisamente por causa desse recurso, pois ele permite restringir o acesso entre servidores (virtuais ou f√≠sicos - n√£o importa) sem arrast√°-los entre sub-redes e, portanto, sem tocar no endere√ßamento.  Sim, sim, sabemos que ningu√©m prescreve endere√ßos IP nas configura√ß√µes de aplicativos com as m√£os, certo? <br><br>  As regras de tr√°fego da ACI s√£o chamadas de contratos.  Nesse contrato, um ou mais grupos ou n√≠veis em um aplicativo de v√°rias camadas tornam-se um provedor de servi√ßos (por exemplo, um servi√ßo de banco de dados), outros se tornam consumidores.  Um contrato pode simplesmente pular o tr√°fego ou fazer algo mais complicado, por exemplo, direcion√°-lo para um firewall ou um balanceador e tamb√©m alterar o valor de QoS. <br><br>  Como os servidores entram nesses grupos?  Se forem servidores f√≠sicos ou algo conectado √† rede existente na qual criamos o tronco da VLAN, para coloc√°-los no EPG, voc√™ precisar√° apontar para a porta do switch e a VLAN usada nela.  Como voc√™ pode ver, as VLANs aparecem onde voc√™ n√£o pode ficar sem elas. <br><br>  Se os servidores forem m√°quinas virtuais, basta referir-se ao ambiente de virtualiza√ß√£o conectado e tudo acontecer√° por si s√≥: um grupo de portas (em termos de VMWare) ser√° criado para conectar a VM, as VLANs ou VXLANs necess√°rias ser√£o atribu√≠das, elas ser√£o registradas nas portas de switch necess√°rias etc. Portanto, embora o ACI seja constru√≠do em torno de uma rede f√≠sica, as conex√µes para servidores virtuais parecem muito mais simples do que para os f√≠sicos.  A ACI j√° possui um pacote com VMWare e MS Hyper-V, al√©m de suporte para OpenStack e RedHat Virtualization.  Em algum momento, o suporte interno para plataformas de cont√™iner apareceu: Kubernetes, OpenShift, Cloud Foundry e se aplica tanto √† aplica√ß√£o de pol√≠ticas quanto ao monitoramento, ou seja, o administrador da rede pode ver imediatamente quais hosts funcionam em quais hosts e a quais grupos eles pertencem. <br><br>  Al√©m de serem inclu√≠dos em um grupo de portas espec√≠fico, os servidores virtuais possuem propriedades adicionais: nome, atributos etc., que podem ser usados ‚Äã‚Äãcomo crit√©rios para transferi-los para outro grupo, por exemplo, ao renomear uma VM ou quando ela possui uma tag adicional.  A Cisco chama esses grupos de microssegmenta√ß√£o, embora em geral o pr√≥prio design com a capacidade de criar muitos segmentos de seguran√ßa como o EPG na mesma sub-rede tamb√©m seja microssegmenta√ß√£o.  Bem, o fornecedor sabe melhor. <br><br>  Os pr√≥prios EPGs s√£o constru√ß√µes puramente l√≥gicas que n√£o est√£o vinculadas a comutadores, servidores, etc. espec√≠ficos, de modo que, com eles e constru√ß√µes baseadas neles (aplicativos e inquilinos), voc√™ pode fazer coisas dif√≠ceis de executar em redes regulares, por exemplo, para clonar.  Como resultado, digamos que √© muito f√°cil criar um clone de um ambiente produtivo para obter um ambiente de teste que seja id√™ntico ao produtivo.  Isso pode ser feito manualmente, mas melhor (e mais f√°cil) - atrav√©s da API. <br><br>  Em geral, a l√≥gica de controle no ACI √© completamente diferente do que voc√™ normalmente encontra <br>  em redes tradicionais da mesma Cisco: a interface do software √© prim√°ria e a GUI ou a CLI s√£o secund√°rias, porque funcionam atrav√©s da mesma API.  Portanto, quase todo mundo que lida com a ACI, depois de um tempo, come√ßa a navegar no modelo de objeto usado para controle e a automatizar algo para suas necessidades.  A maneira mais f√°cil de fazer isso √© no Python: existem ferramentas pr√°ticas prontas para isso. <br><br><h3>  Ancinho Prometido </h3><br>  O principal problema √© que muitas coisas no ACI s√£o feitas de maneira diferente.  Para come√ßar a trabalhar com ela normalmente, voc√™ precisa reaprender.  Isso √© especialmente verdadeiro para equipes de opera√ß√£o de rede em grandes clientes, onde os engenheiros est√£o envolvidos na ‚Äúprescri√ß√£o de VLANs‚Äù para aplicativos h√° anos.  O fato de que agora as VLANs n√£o s√£o mais VLANs e, para colocar novas redes em hosts virtualizados, voc√™ n√£o precisa criar VLANs com as m√£os, "afasta completamente" os operadores de rede tradicionais e faz com que voc√™ se apegue √†s abordagens usuais.  Deve-se notar que a Cisco tentou suavizar um pouco a p√≠lula e adicionou uma CLI "semelhante a NXOS" ao controlador, o que permite configurar a partir de uma interface semelhante aos comutadores tradicionais.  Mas ainda assim, para come√ßar a usar o ACI normalmente, voc√™ precisar√° entender como ele funciona. <br><br>  Do ponto de vista do pre√ßo em redes ACI de grande e m√©dio porte, praticamente n√£o difere das redes tradicionais nos equipamentos Cisco, porque os mesmos comutadores s√£o usados ‚Äã‚Äãpara constru√≠-las (o Nexus 9000 pode funcionar tanto na ACI quanto no modo tradicional, e agora o principal "cavalo de batalha" para novos projetos de data center).  Mas para os datacenters de dois switches, a disponibilidade dos controladores e a arquitetura Spine-Leaf, √© claro, se fazem sentir.  Uma f√°brica Mini ACI apareceu recentemente, na qual dois dos tr√™s controladores s√£o substitu√≠dos por m√°quinas virtuais.  Isso permite reduzir a diferen√ßa de custo, mas ainda permanece.  Portanto, para o cliente, a escolha √© ditada pelo quanto ele est√° interessado em fun√ß√µes de seguran√ßa, integra√ß√£o com virtualiza√ß√£o, um √∫nico ponto de gerenciamento e muito mais. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt455882/">https://habr.com/ru/post/pt455882/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt455868/index.html">Superando a Lei de Moore: Tecnologias de Transistor do Futuro</a></li>
<li><a href="../pt455872/index.html">Quais apostas a Bezos fez em 1997 para que a Amazon agora detenha 50% do mercado de com√©rcio eletr√¥nico nos EUA e 14% no mundo?</a></li>
<li><a href="../pt455874/index.html">Procedimento de notifica√ß√£o para aplicativos Electron no macOS 10.14.5</a></li>
<li><a href="../pt455878/index.html">Cen√°rios para o uso da an√°lise de v√≠deo no varejo. Seguindo os passos do Video Analytics no varejo</a></li>
<li><a href="../pt455880/index.html">Nova serializa√ß√£o pode aparecer em Java</a></li>
<li><a href="../pt455886/index.html">D√™ um nome √† estrela e ao exoplaneta no sistema HAT-P-3</a></li>
<li><a href="../pt455888/index.html">Internet para o residente de ver√£o. Parte 3. Os russos est√£o chegando</a></li>
<li><a href="../pt455890/index.html">A verdade sobre pagamentos sem contato em pulseiras fitness</a></li>
<li><a href="../pt455892/index.html">Como um programador pode se mudar para a Holanda</a></li>
<li><a href="../pt455894/index.html">Tend√™ncias Online 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>