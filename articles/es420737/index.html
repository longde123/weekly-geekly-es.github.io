<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¥üèΩ üßëüèø‚Äçü§ù‚ÄçüßëüèΩ üß§ Mini ai cup 2 o casi AgarIO: ¬øqu√© se puede hacer para ganar? üì≤ ‚òùüèΩ üíÉüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos! Esta vez quiero escribir sobre c√≥mo logr√© ganar la competencia Mini AI Cup 2 . Como en mi √∫ltimo art√≠culo , pr√°cticamente no habr√° detal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mini ai cup 2 o casi AgarIO: ¬øqu√© se puede hacer para ganar?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420737/">  Hola a todos!  Esta vez quiero escribir sobre c√≥mo logr√© ganar la competencia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Mini AI Cup 2</a> .  Como en mi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">√∫ltimo art√≠culo</a> , pr√°cticamente no habr√° detalles de implementaci√≥n.  Esta vez la tarea fue menos voluminosa, pero sin embargo, hubo muchos matices y peque√±as cosas que afectan el comportamiento del bot.  Como resultado, incluso despu√©s de casi tres semanas de trabajo activo en el bot, todav√≠a hab√≠a ideas sobre c√≥mo mejorar la estrategia. <br><br><img src="https://habrastorage.org/webt/iw/ef/hv/iwefhvnhx6m3ubjpwo_d0cgn3qi.png"><br><br>  Debajo del corte muchos gifs y tr√°fico. <br><a name="habracut"></a><br>  <i>Los persistentes lo descubrir√°n, el resto huir√° con horror (de los comentarios en la <s>breve</s> parte comprimida).</i> <br><br>  <i>Aquellos que son demasiado vagos para leer mucho pueden ir al pen√∫ltimo spoiler del art√≠culo para ver una <s>breve</s> descripci√≥n concisa del algoritmo <s>, y luego pueden comenzar a leer desde el principio</s> .</i> <br><br>  Enlace a la fuente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en el github</a> . <br><br><h3>  Selecci√≥n de herramienta </h3><br>  Como la √∫ltima vez, me llev√≥ mucho tiempo pensar por d√≥nde empezar.  La elecci√≥n fue, entre otras cosas, entre dos lenguajes: Java, familiar para m√≠, y ya bastante olvidado de los d√≠as de estudiante C ++.  Pero desde el principio me pareci√≥ que el principal obst√°culo para escribir un buen bot no ser√≠a tanto la velocidad de desarrollo como la productividad de la soluci√≥n final, sin embargo, la elecci√≥n cay√≥ en C ++. <br><br>  Despu√©s de la exitosa experiencia de usar mi propio visualizador para depurar el bot en competiciones anteriores, esta vez tampoco quer√≠a prescindir de uno.  Pero el visualizador que escrib√≠ para m√≠ en Qt para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">CodeWars</a> no me pareci√≥ una soluci√≥n ideal, y decid√≠ usar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">este</a> visualizador.  Tambi√©n se realiz√≥ bajo CodeWars, pero no requiri√≥ un procesamiento serio para su uso en esta competencia.  La relativa simplicidad de conexi√≥n y la conveniencia de invocar renderizado en cualquier parte del c√≥digo jugado a su favor. <br><br>  Como antes, realmente quer√≠a depurar cualquier tic en el juego: la capacidad de ejecutar una estrategia en un momento arbitrario del juego probado.  Dado que el visualizador de complementos no pudo resolver este problema, con la ayuda del par #ifdef (en el que tambi√©n envolv√≠ los fragmentos de c√≥digo responsables de la representaci√≥n) agregu√© a cada tick el guardado de la clase Context, que conten√≠a todos los valores necesarios de las variables del tick anterior.  En esencia, la soluci√≥n fue similar a la que us√© en Code Wizards, pero esta vez el enfoque no fue tan espont√°neo.  Despu√©s de simular todo el juego, se le pidi√≥ que ingrese el n√∫mero de la marca del juego, que debe reiniciarse.  La informaci√≥n sobre el estado de las variables antes de este tick se tom√≥ de la matriz, as√≠ como la l√≠nea recibida por la estrategia de entrada, lo que me permiti√≥ jugar los movimientos de mi estrategia en el orden necesario. <br><br><h3>  Inicio </h3><br>  El d√≠a que se abrieron las reglas, no pas√© y la primera noche mir√© lo que nos espera.  No dud√≥ en indignarse con el formato de entrada json (s√≠, es conveniente, pero algunos participantes comienzan a dominar nuevos YP viejos y olvidados en tales competiciones, y comenzar con el an√°lisis json no es el m√°s agradable), mir√≥ la extra√±a f√≥rmula de movimiento y de alguna manera comenz√≥ a formar el futuro estrategias (para entender el art√≠culo en el futuro es √∫til leer las <a href="">reglas</a> ).  Durante 2 d√≠as escrib√≠ un mont√≥n de clases como Ejection, Virus, Player y otras, leyendo json, conectando una biblioteca de un solo archivo para iniciar sesi√≥n ... Y en la tarde de la apertura de un sandbox sin clasificar, ya ten√≠a una estrategia que era casi id√©ntica en principio a C ++, pero significativamente, un c√≥digo mucho m√°s grande. <br><br>  Y luego ... comenc√© a descubrir opciones, c√≥mo desarrollarlas.  Pensamientos en ese momento: <br><br><ul><li>  La b√∫squeda de estados mundiales no puede reducirse a aquellos valores que pueden dominar el minimax y las modificaciones; </li><li>  Los campos potenciales son buenos, pero responden mal la pregunta de c√≥mo el mundo cambiar√° los pr√≥ximos n ticks; </li><li>  La gen√©tica y algoritmos similares funcionar√°n, pero solo se proporcionan 20 ms por golpe, y la profundidad de c√°lculo ser√≠a deseable, a primera vista, m√°s de lo que las sensaciones se pueden procesar con el GA.  S√≠, y puedes jugar con la selecci√≥n de par√°metros de mutaci√≥n "felices para siempre". </li></ul><br>  Definitivamente decid√≠ una cosa: necesitamos hacer una simulaci√≥n del mundo.  Despu√©s de todo, ¬øpueden los c√°lculos aproximados "vencer" a un c√°lculo fr√≠o y preciso?  Tales consideraciones, por supuesto, me llevaron a buscar en el c√≥digo que se supon√≠a que era responsable de simular el mundo en el servidor, porque esta vez se puso en el dominio p√∫blico junto con las reglas.  Despu√©s de todo, ¬øno hay nada mejor que un c√≥digo que describa con precisi√≥n las reglas del mundo? <br><br>  As√≠ que pens√© exactamente hasta que comenc√© a estudiar el c√≥digo que se supon√≠a que probar√≠a nuestros bots en el servidor y localmente.  Inicialmente, en t√©rminos de comprensi√≥n y correcci√≥n del c√≥digo, todo no era muy bueno, y los organizadores, junto con los participantes, comenzaron a procesarlo activamente.  Durante la prueba beta (capturada un par de d√≠as despu√©s), los cambios en el motor del juego fueron muy serios, y muchos no comenzaron a participar hasta el momento en que el motor de prueba no se estabiliza.  Pero al final, en mi opini√≥n, esperaron un motor que funcionara bien para un juego muy adecuado para el formato de competici√≥n.  Tampoco comenc√© a implementar enfoques serios hasta que el corredor local se estabiliz√≥, y durante la primera semana no se hizo nada m√°s sensato en mi bot, excepto el visualizador atornillado. <br><br>  En la v√≠spera del primer fin de semana en el telegrama, los organizadores crearon un grupo separado en el que se supon√≠a que las personas podr√≠an ayudar a corregir y mejorar el corredor local.  Tambi√©n particip√© en el trabajo sobre el motor del mundo.  Despu√©s de las discusiones en este chat, como prueba, realic√© 2 solicitudes de extracci√≥n a la ubicaci√≥n del corredor: ajustando la f√≥rmula de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">alimentaci√≥n</a> (y peque√±os cambios en el orden de alimentaci√≥n) a las reglas, y fusionando varias partes en un ag√°rico mientras <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">manten√≠a la inercia y el centro de masa</a> ).  Entonces comenc√© a pensar en c√≥mo insertar una f√≠sica de colisi√≥n sensata en este c√≥digo, porque la f√≠sica presente en el mundo del juego en ese momento funcionaba muy il√≥gicamente.  Como las colisiones entre los dos ag√°ricos no se describieron en las reglas, les ped√≠ a los organizadores criterios seg√∫n los cuales mi implementaci√≥n de tal l√≥gica ser√≠a aceptable.  La respuesta fue esta: los ag√°ricos en una colisi√≥n deben ser "blandos" (es decir, podr√≠an toparse un poco entre s√≠), mientras que la l√≥gica de una colisi√≥n con las paredes no debe tocarse (es decir, las paredes simplemente deben detener los ag√°ricos, pero no alejarlos).  Y mi siguiente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">solicitud de extracci√≥n</a> fue una alteraci√≥n grave de la f√≠sica. <br><br><div class="spoiler">  <b class="spoiler_title">Antes y despu√©s de la alteraci√≥n de la f√≠sica.</b> <div class="spoiler_text">  <i>Tal f√≠sica de colisi√≥n fue:</i> <br><img src="https://habrastorage.org/webt/hx/xc/ey/hxxceykf2thwuvqz9eknvhuy9rw.gif" alt="imagen"><br>  <i>Y se volvi√≥ as√≠ despu√©s de las actualizaciones:</i> <br><img src="https://habrastorage.org/webt/hu/4s/-k/hu4s-kyhokl2-0sotgkuhib2fem.gif" alt="imagen"><br></div></div><br>  Tambi√©n me gustar√≠a destacar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">esta</a> solicitud de extracci√≥n, que redujo significativamente el c√≥digo confuso con el an√°lisis de estado y una gran cantidad de errores encontrados (y potenciales) en algo mucho m√°s inteligible. <br><br><h3>  Escribir una simulaci√≥n </h3><br>  Despu√©s de llevar el c√≥digo de la configuraci√≥n regional del corredor a una forma sensata, gradualmente comenc√© a transferir el c√≥digo de simulaci√≥n del mundo desde la configuraci√≥n regional del corredor a mi bot.  En primer lugar, era, por supuesto, un c√≥digo para simular el movimiento de ag√°ricos, y al mismo tiempo un c√≥digo para calcular la f√≠sica de las colisiones.  Tom√≥ un par de tardes salvar el c√≥digo redise√±ado de la reescritura de errores (la transferencia l√≥gica no se realiz√≥ copiando el c√≥digo) y estimaciones aproximadas de la profundidad de los c√°lculos. <br><br>  La funci√≥n de calificaci√≥n para cada marca en ese momento era +1 para la comida que como y -1 para la comida que comi√≥ el enemigo, as√≠ como valores ligeramente mayores para comer los ag√°ricos del otro.  En las constantes para comer otros ag√°ricos, inicialmente hab√≠a una diferencia entre comer a mi oponente, mi oponente (y, por supuesto, una multa muy grande por comer mi √∫ltimo agarika por el oponente), as√≠ como dos oponentes diferentes entre s√≠ (despu√©s de un par de d√≠as, el √∫ltimo coeficiente se convirti√≥ en 0).  Adem√°s, la velocidad total para todos los ticks anteriores de la simulaci√≥n, cada tick se multiplic√≥ por 1 + 1e-5 para alentar a mi bot a realizar acciones m√°s √∫tiles al menos un poco antes, y al final de la simulaci√≥n, la velocidad para el √∫ltimo tick se agreg√≥ como un bono, tambi√©n muy peque√±o .  Para simular el movimiento de ag√°ricos, se seleccionaron puntos en el borde del mapa con un paso de 15 grados desde las coordenadas medias aritm√©ticas de todos mis ag√°ricos, y se seleccion√≥ un punto, al simular el movimiento en el que la funci√≥n de estimaci√≥n adquiri√≥ el mayor valor.  Y ya con una simulaci√≥n aparentemente tan primitiva y una evaluaci√≥n simple en ese momento, el bot se afianz√≥ con bastante confianza en el top 10. <br><br><div class="spoiler">  <b class="spoiler_title">Demostraci√≥n de puntos, el comando de movimiento al que el algoritmo simul√≥ originalmente</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/fy/xr/l_/fyxrl_dc2onzsfeij-vmex1qnoc.gif" alt="imagen"><br>  <i>Puntos, el comando de movimiento al que se le dio durante varias simulaciones.</i>  <i>Si se mira muy de cerca, el comando final dado a veces se cambia en relaci√≥n con los puntos que se buscan, pero estas son consecuencias de alteraciones futuras.</i> <br></div></div><br>  Durante la tarde del viernes y s√°bado, se agreg√≥ una simulaci√≥n de fusi√≥n de ag√°ricos, una simulaci√≥n de "debilitamiento" en los virus y adivinar el TTF del oponente.  El TTF del oponente era un valor calculado bastante interesante, y era posible entender en qu√© punto el oponente se dividi√≥ o lleg√≥ al virus solo al atrapar el momento del vuelo no controlado, que podr√≠a durar desde un n√∫mero muy peque√±o de ticks con una gran viscosidad y hasta el vuelo a trav√©s de todo el mapa.  Dado que las colisiones con ag√°rico pueden conducir a un ligero exceso de su velocidad m√°xima, para calcular el TTF del oponente, verifiqu√© que su velocidad en dos tics seguidos realmente corresponde a la velocidad con la que se pueden obtener dos ticks seguidos en vuelo libre (en vuelo libre, los ag√°ricos volaron estrictamente rectos y con ralentizando cada tic estrictamente igual a la viscosidad).  Esto elimin√≥ casi por completo la posibilidad de falsos positivos.  Adem√°s, durante la prueba de esta l√≥gica, not√© que un TTF m√°s grande siempre corresponde a una identificaci√≥n m√°s grande del ag√°rico (del que m√°s tarde me convenc√≠ al transferir el c√≥digo de <a href="">explosi√≥n en el virus</a> y <a href="">procesar la divisi√≥n</a> ), que tambi√©n val√≠a la pena usar. <br><br>  Despu√©s de observar las divisiones constantes en los 3 primeros (lo que les permiti√≥ recolectar alimentos significativamente en el mapa), como prueba, agregu√© un comando de divisi√≥n permanente al bot si no hab√≠a enemigo en el radio de visibilidad, y el domingo por la ma√±ana encontr√© a mi bot en la segunda l√≠nea de la clasificaci√≥n.  Manejar un pu√±ado de peque√±os ag√°ricos aument√≥ enormemente la clasificaci√≥n, pero perderlos fue mucho m√°s f√°cil si te topas con un oponente.  Y dado que el miedo a ser comido por mis ag√°ricos era muy condicional (la penalizaci√≥n era solo por comer en una simulaci√≥n, pero no por acercarse a un oponente que pod√≠a comer), lo primero fue agregar una penalizaci√≥n por cruzar con un oponente que pod√≠a comer.  Y esta misma evaluaci√≥n funcion√≥ como un bono por perseguir a un oponente.  Despu√©s de verificar el consumo de CPU con mi estrategia, decid√≠ agregar una ronda de simulaci√≥n m√°s cuando se realiz√≥ la divisi√≥n en el primer tic (esta l√≥gica, por supuesto, tambi√©n tuvo que transferirse a mi c√≥digo desde la ubicaci√≥n del corredor), y luego la simulaci√≥n fue exactamente la misma que antes .  Este tipo de l√≥gica no era muy adecuada para "disparar" al enemigo (aunque a veces por accidente se dividi√≥ en un momento muy adecuado), pero fue muy bueno para recolectar alimentos m√°s r√°pido, que era lo que toda la parte superior estaba haciendo en ese momento.  Dichas modificaciones nos permitieron ingresar la pr√≥xima semana en la primera l√≠nea de la calificaci√≥n, aunque el margen no fue significativo. <br><br>  En ese momento, esto fue suficiente, la "columna vertebral" de la estrategia se resolvi√≥, la estrategia parec√≠a bastante primitiva y ampliable.  Pero lo que realmente not√© fue el consumo de CPU y la estabilidad general del c√≥digo.  Por lo tanto, principalmente las tardes de la siguiente parte de la semana de trabajo se dedicaron a mejorar la precisi√≥n de las simulaciones (que el visualizador ayud√≥ mucho), estabilizar el c√≥digo (valgrind) y algunas optimizaciones de la velocidad del trabajo. <br><br><h3>  Vamos adelante </h3><br>  Mi siguiente estrategia enviada, que mostr√≥ un resultado significativamente mejor y se adelant√≥ a los oponentes (en ese momento), conten√≠a dos cambios significativos: agregar un campo potencial para recolectar alimentos y duplicar el n√∫mero de simulaciones si hay un oponente con un TTF desconocido cerca. <br><br>  El campo potencial para recolectar alimentos en la primera versi√≥n era bastante simple y toda su esencia era recordar alimentos que desaparecieron de la zona de visibilidad, reduciendo el potencial en aquellos lugares cerca de donde estaba el bot enemigo y reduciendo a cero en mi zona de visibilidad (con la restauraci√≥n posterior cada n garrapatas de acuerdo con las reglas).  Esto parec√≠a una mejora √∫til, pero en la pr√°ctica, en mi opini√≥n subjetiva, la diferencia era peque√±a o completamente ausente.  Por ejemplo, en tarjetas con alta inercia y velocidad, el bot a menudo saltaba la comida y luego intentaba volver a ella, mientras perd√≠a mucha velocidad.  Sin embargo, si decidiera mantener la velocidad y simplemente ignorara la comida omitida, comer√≠a mucho m√°s. <br><br><div class="spoiler">  <b class="spoiler_title">Potencial campo de recolecci√≥n de alimentos</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/aw/ae/lg/awaelgpt4zl98lgdjfr1rvk53so.gif" alt="imagen"><br>  <i>Puede prestar atenci√≥n a c√≥mo cada 40 tics el campo se vuelve un poco m√°s brillante.</i>  <i>Cada 40 ticks, el campo se actualiza de acuerdo con la forma en que se agregan los alimentos en el mapa, y la probabilidad de que aparezcan alimentos es "untada" uniformemente en todo el campo.</i>  <i>Si en esta marca vemos que hay comida que ver√≠amos en la marca anterior, la probabilidad de la aparici√≥n de esta comida no est√° "manchada" con el resto, sino que se establece por puntos espec√≠ficos (la comida aparece cada 40 marcas estrictamente sim√©tricamente).</i> <br></div></div><br>  Una utilidad subjetiva completamente diferente result√≥ ser una doble simulaci√≥n del enemigo con diferentes TTF: el m√≠nimo y el m√°ximo posible (en caso de que no conozca el TTF para todos los ag√°ricos visibles en el mapa).  Y si antes mi robot pensaba que el grupo enemigo de ag√°ricos se convertir√≠a en un todo y se mover√≠a lentamente, entonces ahora eligi√≥ el peor de los dos escenarios y no se arriesg√≥ a estar cerca del enemigo, de quien sabe menos de lo que le gustar√≠a. <br><br>  Despu√©s de obtener una ventaja significativa, trat√© de aumentarla agregando una definici√≥n del punto en el que el oponente le indica a sus ag√°ricos que se muevan, y aunque este punto se calcul√≥ en la mayor√≠a de los casos con bastante precisi√≥n, esto solo no mejor√≥ los resultados del bot.  Seg√∫n mis observaciones, se volvi√≥ a√∫n peor que el caso cuando los ag√°ricos del oponente simplemente se mov√≠an en la misma direcci√≥n y a la misma velocidad que si el oponente no hubiera hecho nada, por lo que estas ediciones se guardaron en una rama de guitarra separada hasta tiempos mejores. <br><br><div class="spoiler">  <b class="spoiler_title">La definici√≥n del equipo contrario que se utiliz√≥ m√°s tarde</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/8l/vx/ac/8lvxacnkg_w4byrrkka9znflham.gif" alt="imagen"><br>  <i>Los rayos de los ag√°ricos del oponente muestran al presunto equipo que el oponente le dio a sus ag√°ricos en la marca anterior.</i>  <i>Los rayos azules son la direcci√≥n exacta en la que el agarik cambi√≥ de direcci√≥n en el √∫ltimo tic.</i>  <i>El negro es el pretendido.</i>  <i>Era posible determinar con mayor precisi√≥n la direcci√≥n del equipo solo si el agar estaba completamente en la zona de nuestra visibilidad (era posible calcular el efecto de las colisiones sobre el cambio en su velocidad).</i>  <i>La intersecci√≥n de los rayos es el equipo previsto del oponente.</i>  <i>Gif hecho sobre la base del juego <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aicups.ru/session/200710</a> , alrededor de 3.000 ticks.</i> <br></div></div><br>  Tambi√©n hubo intentos de transferir la funci√≥n de evaluaci√≥n a la evaluaci√≥n de la masa ganada, intentos de cambiar la funci√≥n de evaluar el peligro del oponente ... Pero nuevamente, todos esos cambios en los sentimientos empeoraron a√∫n m√°s.  Lo √∫nico que fue √∫til con la funci√≥n de evaluar el peligro de estar cerca del enemigo fue otra optimizaci√≥n del rendimiento junto con extender esta estimaci√≥n a un radio mucho mayor que el radio de intersecci√≥n con el enemigo (esencialmente todo el mapa, pero con una disminuci√≥n cuadr√°tica, si se simplifica ligeramente) hacer presencia en cinco o m√°s radios del oponente en la regi√≥n de 1/25 del peligro m√°ximo de ser comido).  El √∫ltimo cambio tambi√©n no planificado condujo al hecho de que mis agariks ten√≠an mucho miedo de acercarse a un enemigo significativamente m√°s grande, as√≠ como en el caso de sus tama√±os muy superiores, estaban m√°s inclinados a moverse hacia el oponente.  Por lo tanto, result√≥ ser un reemplazo exitoso y no intensivo en recursos para el c√≥digo planeado para el futuro, que se supon√≠a que era responsable del miedo a un ataque de un oponente a trav√©s de la divisi√≥n (y un poco de ayuda en tal ataque para m√≠ m√°s adelante). <br><br>  Despu√©s de intentos largos y relativamente infructuosos de mejorar algo, volv√≠ a predecir la direcci√≥n del movimiento del oponente.  Decid√≠ probarlo si no es solo para reemplazar a los rivales ficticios, luego hice lo que hice con la opci√≥n TTF m√≠nima y m√°xima: simule dos veces y elija la mejor.  Pero para esto, la CPU podr√≠a no ser suficiente, y en muchos juegos de mi bot simplemente podr√≠an desconectarse del sistema debido a un apetito insaciable.  Por lo tanto, antes de implementar esta opci√≥n, agregu√© una definici√≥n aproximada del tiempo empleado y, si se exced√≠an los l√≠mites, comenc√© a reducir el n√∫mero de movimientos de simulaci√≥n.  Al agregar una doble simulaci√≥n del enemigo para el caso cuando conozco el lugar al que se dirige, nuevamente recib√≠ un aumento bastante serio en la mayor√≠a de los ajustes del juego, excepto en el que requiere m√°s recursos (con alta inercia / baja velocidad / baja viscosidad), que debido a una fuerte disminuci√≥n en la profundidad Las simulaciones podr√≠an empeorar a√∫n m√°s. <br><br>  Antes del comienzo de los 25k juegos de tick, se hicieron dos mejoras m√°s √∫tiles: la penalizaci√≥n por terminar la simulaci√≥n lejos del centro del mapa, as√≠ como recordar la posici√≥n anterior del oponente si dejaba la l√≠nea de visi√≥n (adem√°s de simular su movimiento en ese momento).<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La implementaci√≥n de la penalizaci√≥n para la posici√≥n final del bot en la simulaci√≥n fue un campo de peligro est√°tico precalculado con cero peligro en un radio ligeramente mayor que la mitad de la longitud del campo de juego y aumentando gradualmente a medida que te alejas del campo de juego. La aplicaci√≥n de la multa de este campo en los puntos finales de la simulaci√≥n casi no requiri√≥ una CPU y evit√≥ carreras adicionales en las esquinas, a veces salvando al enemigo de los ataques. Y la memorizaci√≥n con simulaci√≥n posterior de rivales en su mayor parte nos permiti√≥ evitar dos problemas a veces manifestados. El primer problema se presenta en el GIF a continuaci√≥n. El segundo problema era que si un enemigo m√°s grande se perd√≠a del campo de visi√≥n (por ejemplo, despu√©s de la fusi√≥n de sus partes), era posible unirse "exitosamente" en √©l, alimentando adem√°s a un oponente ya peligroso.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ejemplo de un campo de peligro al final de un giro en una esquina y garrapatas desperdiciadas</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/rc/qc/7s/rcqc7st4c0xmmzn038tl7eiuxrm.png"><br> <i>      ,         </i> <br><img src="https://habrastorage.org/webt/r_/qm/zx/r_qmzxmxzysmrityd6sld0yjhlw.gif" alt="imagen"><br> <i>  ,       .      ,      .</i> <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Adem√°s, se agregaron puntos de simulaci√≥n de movimiento a los puntos en el borde del mapa: a cada agarik de rivales y dentro de un radio de la coordenada media aritm√©tica de mi agariki cada 45 grados. </font><font style="vertical-align: inherit;">El radio se estableci√≥ en avgDistance de las coordenadas medias aritm√©ticas de mis ag√°ricos.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nuevos puntos de simulaci√≥n</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/1g/tp/s0/1gtps0pna1gmgquavh75h2ta-jc.gif" alt="imagen"><br> <i>        .       ¬´¬ª   ,   .       .</i> <br></div></div><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Preparaci√≥n final </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En el momento de la apertura de los juegos para 25k ticks y pasar a la final, ten√≠a un margen s√≥lido, pero no planeaba relajarme. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Junto con los nuevos juegos de 25k, llegaron las noticias: los juegos durante la final tambi√©n durar√°n 25k, y el l√≠mite de tiempo de la estrategia para los ticks se ha vuelto un poco m√°s. </font><font style="vertical-align: inherit;">Despu√©s de evaluar el tiempo que mi estrategia pasa en el juego en las nuevas condiciones, decid√≠ agregar otra versi√≥n de la simulaci√≥n: hacemos todo como de costumbre, pero durante la simulaci√≥n en el momento se dividen. </font><font style="vertical-align: inherit;">Esto, entre otras cosas, requer√≠a el uso de la simulaci√≥n encontrada en el paso anterior, pero con un cambio de 1 movimiento (por ejemplo, si encontramos que dividir 7 tics del actual, entonces el pr√≥ximo movimiento repetimos lo mismo, pero ya haremos la divisi√≥n en el sexto movimiento). </font><font style="vertical-align: inherit;">Esto agreg√≥ significativamente ataques agresivos a los rivales, pero se comi√≥ un poco m√°s de tiempo de estrategia.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deber√≠a haber una descripci√≥n concisa del algoritmo</font></font></b> <div class="spoiler_text"> <i>   </i> <br><br>  : <br><img src="https://habrastorage.org/webt/nr/we/mj/nrwemjif4m5vgis-dy_r6shmc3u.gif"><br><ul><li> f ‚Äî ,            ; </li><li> sim ‚Äî        (  ,  , TTF ,     ); </li><li> finalPositionFoodPotentialField ‚Äî   ,   ,    ; </li><li> finalPositionCornerDanger ‚Äî        .        ,         ; </li><li> n ‚Äî ,         .  10   50 ; </li><li> ateFood ‚Äî         i; </li><li> virusBurst ‚Äî            i; </li><li> opponentAteFood ‚Äî        i; </li><li> meAteOpponent ‚Äî      ; </li><li> opponentAteMe ‚Äî      ; </li><li> mine/opponents ‚Äî     .  Es decir          ‚Äî      ; </li><li> danger ‚Äî  ,   ,     . </li></ul><br><br><img src="https://habrastorage.org/webt/xu/0b/vq/xu0bvqxveolkicxieftkfrmuv5u.gif"><br><ul><li> moveType ‚Äî    ,        ; </li><li> max/min TTF ‚Äî   ,        TTF   (    TTF ); </li><li> dummy/aim ‚Äî      Dummy         (    ,          ). </li></ul><br><br><img src="https://habrastorage.org/webt/kr/cn/vl/krcnvlbbrj1eyfcai1abuv4o4pi.gif"><br><ul><li> destination ‚Äî ,         ; </li><li> moveTo ‚Äî  ,   n    ‚Äú   ‚Äù   ; </li><li> splitThenMove ‚Äî       split   ; </li><li> delayedSplitThenMove ‚Äî  ,  split    . </li></ul><br><br>             1 .  Es decir  splitThenMove    moveTo, delayedSplitThenMove      7  6 ,      6  5  ..     ,     ‚Äî               7 .                . <br><br>  destination : <br><ul><li>      15       ( ‚Äî  ).  24      ; </li><li>  ,       (    ); </li><li>         : </li><li> ‚Äú‚Äù     ,       ; </li><li>  8   .             . </li></ul><br>    destination     ,              . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todas las mejoras adicionales se relacionaron exclusivamente con la eficiencia de las simulaciones en caso de falta de TL: optimizaci√≥n de la secuencia de desconexi√≥n de ciertas partes de la l√≥gica dependiendo de la CPU consumida. </font><font style="vertical-align: inherit;">En la mayor√≠a de los juegos, se supon√≠a que esto no cambiar√≠a nada, pero llegar a algo m√°s correcto no funcion√≥.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puntos finales en la final</font></font></b> <div class="spoiler_text"> <i>          .  808       2424 ,     . <s>   .</s></i> <br> <a href=""><img src="https://habrastorage.org/webt/ij/bi/qf/ijbiqfz4pmd8je8ps7qfvird4pi.png"></a> <br></div></div><br><h4>  En lugar de una conclusi√≥n </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En general, el comienzo de esta competencia result√≥ bastante aceitado, pero en la primera semana y media la tarea se llev√≥ a una forma bastante jugable con la ayuda de los participantes. </font><font style="vertical-align: inherit;">Inicialmente, la tarea era muy variable, y elegir el enfoque correcto para resolverlo no parec√≠a una tarea trivial. </font><font style="vertical-align: inherit;">A√∫n m√°s interesante fue encontrar formas de mejorar el algoritmo sin volar m√°s all√° de los l√≠mites del consumo de CPU. </font><font style="vertical-align: inherit;">Muchas gracias a los organizadores por la competencia y por presentar los c√≥digos fuente del mundo para acceso abierto. </font><font style="vertical-align: inherit;">Este √∫ltimo, por supuesto, les agreg√≥ problemas al principio, pero facilit√≥ enormemente (si no es que lo dijo, lo que hizo posible en principio) que los participantes comprendieran el dispositivo del simulador mundial. </font><font style="vertical-align: inherit;">¬°Un agradecimiento especial por la oportunidad de elegir un premio! </font><font style="vertical-align: inherit;">Entonces el premio sali√≥ mucho m√°s √∫til :-) </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬øPor qu√© necesito otro MacBook?</font></font></s> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es420737/">https://habr.com/ru/post/es420737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es420715/index.html">La dura verdad sobre la severidad del aprendizaje.</a></li>
<li><a href="../es420725/index.html">C√≥mo le ense√±√© a la IA a jugar Tetris para NES. Parte 1: an√°lisis del c√≥digo del juego.</a></li>
<li><a href="../es420729/index.html">Abrir webinar "Clasificador Naive Bayes"</a></li>
<li><a href="../es420731/index.html">Zabbix con esteroides: c√≥mo funciona la plataforma de monitoreo unificado de Sbertech</a></li>
<li><a href="../es420735/index.html">Te invitamos a la final del marat√≥n Find Yourself in Digital en la oficina de Mail.Ru Group</a></li>
<li><a href="../es420739/index.html">La caja todav√≠a est√° en el mango: por qu√© en 2018 todav√≠a necesitas aprender idiomas t√∫ mismo</a></li>
<li><a href="../es420741/index.html">Hoja de trucos para programadores o "buscaremos en Google"</a></li>
<li><a href="../es420749/index.html">GitLab para Proyecto de Entrega Continua en Tecnolog√≠as InterSystems: Contenedores</a></li>
<li><a href="../es420753/index.html">Frontend de microservicios: un enfoque moderno para la separaci√≥n del frente</a></li>
<li><a href="../es420757/index.html">Concurso de programaci√≥n: Comercio (Resultados)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>