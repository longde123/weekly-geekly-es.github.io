<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐩 😯 🤰🏿 Cybergroup Turla menggunakan kampanye Metasploit in Mosquito 👨🏼‍⚖️ 😔 ✍🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Turla adalah kelompok mata-mata maya terkenal yang beroperasi setidaknya selama sepuluh tahun. Penyebutan pertama kelompok itu tertanggal 2008 dan dik...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cybergroup Turla menggunakan kampanye Metasploit in Mosquito</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/412667/"> Turla adalah kelompok mata-mata maya terkenal yang beroperasi setidaknya selama sepuluh tahun.  Penyebutan pertama kelompok itu tertanggal 2008 dan dikaitkan dengan peretasan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Departemen Pertahanan AS</a> .  Selanjutnya, Turla dikreditkan dengan banyak insiden keamanan informasi - serangan terhadap pemerintah dan industri strategis, termasuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">industri pertahanan</a> . <br><br><img src="https://habrastorage.org/webt/ap/0v/ol/ap0vol968enwh-o3wzpmde0pily.jpeg"><br><br>  Pada Januari 2018, kami menerbitkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">laporan pertama</a> kampanye distribusi pintu belakang Turla Mosquito dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">indikator infeksi baru</a> .  Kampanye ini masih aktif;  penyerang mengubah taktik untuk menghindari deteksi. <br><br>  Sejak Maret 2018, kami telah melihat perubahan signifikan dalam kampanye ini - sekarang Turla menggunakan kerangka kerja open source Metasploit untuk mendistribusikan Nyamuk.  Ini bukan pertama kalinya Turla meninggalkan alatnya sendiri - sebelumnya kami melihat penggunaan utilitas untuk mengekstraksi kredensial (Mimikatz).  Tapi perlu dicatat di sini bahwa Turla menggunakan Metasploit untuk pertama kalinya sebagai pintu belakang dari tahap pertama serangan bukannya perkembangannya, seperti <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Skipper</a> . <br><br><a name="habracut"></a><h3>  Distribusi </h3><br>  Seperti yang kami jelaskan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">laporan sebelumnya</a> , vektor infeksi perangkat target dalam kampanye Turla saat ini adalah penginstal palsu yang mengunduh salah satu halaman belakang grup bersama dengan Adobe Flash Player yang sah.  Tujuan prioritas adalah konsulat dan kedutaan besar negara-negara Eropa Timur. <br><br>  Kompromi terjadi ketika pengguna mengunduh pemasang Flash dari get.adobe.com melalui HTTP.  Lalu lintas dicegat antara perangkat akhir dan server Adobe, yang memungkinkan operator Turla untuk mengganti file yang sah dengan versi trojanized.  Gambar di bawah ini menunjukkan titik-titik di mana secara <b>teoritis</b> memungkinkan untuk mencegat lalu lintas.  <b>Harap perhatikan bahwa skenario kelima - kompromi Adobe / Akamai - dikecualikan.</b>  <b>Penyerang hanya menggunakan merek Adobe untuk menipu pengguna.</b> <br><br><img src="https://habrastorage.org/webt/nf/m7/1e/nfm71ehwwthy_sowqybn2xmnpbg.png"><br><br>  Kami tidak menetapkan titik intersepsi lalu lintas, tetapi menemukan file yang dapat dieksekusi baru yang mensimulasikan pemasang Flash yang sah, yang disebut <code>flashplayer28_xa_install.exe</code> .  Dengan demikian, metode kompromi yang asli masih digunakan. <br><br><h3>  Analisis </h3><br>  Pada awal Maret 2018, sebagai bagian dari upaya pelacakan kegiatan Turla, kami melihat perubahan dalam kampanye distribusi nyamuk.  Terlepas dari kenyataan bahwa kelompok ini tidak menggunakan alat inovatif, ini adalah perubahan besar dalam taktik, teknik, dan prosedur (TTR). <br><br>  Sebelumnya, rantai kompromi termasuk pemasang Flash palsu, mengatur ulang bootloader dan pintu belakang utama (lihat gambar di bawah). <br><br><img src="https://habrastorage.org/webt/pn/3p/jf/pn3pjfskupo5civ_zdc_rsrsxg4.png"><br><br>  Baru-baru ini, kita telah melihat bahwa cara untuk mereset backdoor terakhir telah berubah.  Pemasang palsu Flash masih terlibat dalam kampanye, tetapi alih-alih langsung menjatuhkan dua DLL jahat, ia mengeksekusi kode sandi Metasploit dan mengatur ulang atau mengunduh pemasang yang sah dari Google Drive.  Shellcode kemudian memuat Meterpreter, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">muatan Metasploit yang khas</a> , dengan mengekspos penyerang untuk mengakses sistem yang disusupi.  Akhirnya, pintu belakang nyamuk dipasang di workstation.  Skema baru ada pada gambar di bawah ini. <br><br><img src="https://habrastorage.org/webt/3b/wq/lb/3bwqlbedx5jju5brj7kssskdz0a.png"><br><br>  Sehubungan dengan penggunaan Metasploit, kita dapat mengasumsikan bahwa operator mengontrol proses secara manual.  Durasi serangan relatif singkat - pintu belakang terakhir direset dalam waktu tiga puluh menit setelah dimulainya upaya untuk berkompromi. <br><br>  Shellcode yang digunakan adalah tipikal dari Metasploit.  Itu dilindungi oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">encoder shikata_ga_nai</a> dengan tujuh iterasi.  Screenshot di bawah ini menunjukkan payload terenkripsi dan didekripsi. <br><br><img src="https://habrastorage.org/webt/1o/mi/bq/1omibquibw80gy63_0ycbiw8ing.png"><br><br><img src="https://habrastorage.org/webt/b0/et/l0/b0etl0zvxhzpqaho624c2lebvui.png"><br><br>  Setelah dekripsi, shellcode berkomunikasi dengan server C&amp;C di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">209.239.115</a> [.] 91 / 6OHEJ, yang mengontrol pemuatan shellcode tambahan.  Menurut telemetri ESET, langkah selanjutnya adalah memuat Meterpreter.  Alamat IP ini sesuai dengan domain com psikologi-blog.ezua [.], Yang telah digunakan dalam kampanye Nyamuk sejak Oktober 2017. <br><br>  Selanjutnya, pemasang Flash palsu mengunduh pemasang Adobe yang sah dari URL Google Drive dan menjalankannya sehingga pengguna tidak mencurigai apa pun. <br><br><h3>  Alat tambahan </h3><br>  Selain installer dan Meterpreter palsu baru, kami perhatikan bahwa Turla menggunakan alat tambahan: <br><br><ul><li>  Eksekusi kustom yang hanya berisi shellcode Metasploit.  Digunakan untuk mempertahankan akses ke sesi Meterpreter.  Disimpan dalam <pre>  C: \ Users \ &lt;username&gt; \ AppData \ Roaming \ Microsoft \ Windows \ Start Menu \ Program \ Startup \ msupdateconf.exe </pre>  yang memberikan ketekunan. </li><li>  Eksekusi kustom lain untuk menjalankan skrip PowerShell. </li><li>  Backdoor jscript nyamuk menggunakan Google Apps Script sebagai server C&amp;C. </li><li>  Eskalasi hak istimewa menggunakan modul Metasploit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ext_server_priv.x86.dll</a> . </li></ul><br><h3>  Kesimpulan </h3><br>  Posting ini menjelaskan evolusi kampanye distribusi Nyamuk Turla selama beberapa bulan terakhir.  Perubahan utama adalah penggunaan Metasploit, kerangka pengujian penetrasi yang populer, sebagai langkah pertama di pintu belakang Mosquito khusus. <br><br><h3>  Indikator kompromi </h3><br><img src="https://habrastorage.org/webt/z5/0b/nm/z50bnmvydvbo9msk392rv6z47p8.png"><br><br>  C&amp;C <br><br>  • <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">209.239.115</a> [.] 91 / 6OHEJ <br>  • <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">70.32.39</a> [.] 219 / n2DE3 <br><br>  Tautan ke penginstal Flash yang sah <br><br>  • <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">drive.google</a> [.] Com / uc? Authuser = 0 &amp; id = 1s4kyrwa7gCH8I5Z1EU1IZ_JaR48A7UeP &amp; export = unduh = unduh </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id412667/">https://habr.com/ru/post/id412667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id412655/index.html">Hierarki Dompet Multi-Signed (Sistem Kepercayaan)</a></li>
<li><a href="../id412657/index.html">Token atau saham utilitas: apa yang akan menjadi masa depan ICO</a></li>
<li><a href="../id412661/index.html">Bahasa Inggris untuk bekerja di pasar asing: buku teks apa yang tidak dibicarakan</a></li>
<li><a href="../id412663/index.html">AI menjual pizza atau bagaimana Voximplant berteman dengan Dialogflow</a></li>
<li><a href="../id412665/index.html">Editor Jadwal Mingguan</a></li>
<li><a href="../id412669/index.html">Manajemen waktu tidak menakutkan: bagaimana melakukan lebih banyak</a></li>
<li><a href="../id412671/index.html">BLE Console: cara yang sama sekali baru untuk berinteraksi dengan perangkat BLE</a></li>
<li><a href="../id412675/index.html">Kontrak dan alamat multisig dalam Bitcoin dan Ethereum</a></li>
<li><a href="../id412677/index.html">Matriks Ketertelusuran</a></li>
<li><a href="../id412679/index.html">Membuat aplikasi Android untuk pengenalan teks dalam 10 menit. Mobile Vision CodeLab</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>