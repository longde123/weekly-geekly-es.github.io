<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕴🏼 🙅🏻 🚵 Nous contrôlons l'éclairage de l'appartement (NooLite, Raspberry Pi et WebIOPi) 🏑 ♣️ 🦗</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je veux partager l'expérience de l'utilisation du système de maison intelligente NooLite avec le Raspberry Pi Model B (ci-après RPI ) dans un appartem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nous contrôlons l'éclairage de l'appartement (NooLite, Raspberry Pi et WebIOPi)</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/382689/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je veux partager l'expérience de l'utilisation du </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">système</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de maison intelligente </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">NooLite</font></a><font style="vertical-align: inherit;"> avec le Raspberry Pi Model B (ci-après </font></font><abbr title="Tarte aux framboises"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RPI</font></font></abbr><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) dans un appartement de deux pièces. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À propos du système NooLite ont été écrits à plusieurs reprises sur un concentrateur:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NooLite - un système d'éclairage radiocommandé ou la première étape vers une maison intelligente</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NooLite-2, ou maison intelligente pour les nuls</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recherche sur le Habr pour le tag "noolite" ou tapez dans la barre de recherche google "site: habrahabr.ru noolite"</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans cet article, je dirai:</font></font><br>
<ul>
<li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WebIOPi</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Raspbian</a>    UART     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> MT1132 NooLite</a></li>
<li>    WebIOPi      HTTP REST  GPIO UART</li>
<li>      Android     REST </li>
</ul><br>
<a name="habracut"></a><br>
<h4></h4><br>
<ul>
<li><b></b> ( ): <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RPI</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">WebIOPi</a> (UART+REST) + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">NooLite </a></li>
<li><b> </b>:   NooLite   —   </li>
<li><b></b> ( , ):   Android, WEB-,  bash shell (python script)</li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être que quelqu'un pensera: «Je ne m'embêterais pas avec RPI pour des fonctionnalités aussi simples - pour contrôler l'éclairage dans l'appartement à partir d'un téléphone mobile, mais je réaliserais tout en </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">utilisant une tasse en plastique, un caillou et un fil</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur un Arduino avec un bouclier Wi-Fi ou un simple. implémentation concise sur le microcontrôleur AVR. " </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mais, comme je ramassais déjà de la poussière sur l'étagère RPI et que le désir de créer un éclairage «intelligent» à l'aide de la plate-forme RPI, j'étais décidé à le prendre comme base. </font><font style="vertical-align: inherit;">De plus, la possibilité d'utiliser RPI offre une bonne marge pour étendre les fonctionnalités de la «maison intelligente».</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des données d'entrée</font></font></h4><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appartement 2 pièces P44T sans réparation dans un immeuble neuf</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RPI (acquis il y a deux ans pour des raisons d'intérêt)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">désir de réaliser un éclairage intelligent</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant un certain temps, je me suis penché sur différentes plates-formes et technologies de la maison intelligente.Par conséquent, le choix s'est porté sur le système NooLite, sur la base des éléments suivants:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prix adéquat par rapport à des systèmes similaires (Z-Wave, EnOcean, ZigBee)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je fais confiance aux produits fabriqués au Bélarus</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">protocole ouvert</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de nombreux exemples d'utilisation sur Internet</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">433 MHz </font><font style="vertical-align: inherit;">répandu et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ratifié par le SCRF</font></font></a><font style="vertical-align: inherit;"></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai également attiré l'attention </font><font style="vertical-align: inherit;">sur la </font><font style="vertical-align: inherit;">plate-forme </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wiren Board</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> basée sur ARM9 </font><font style="vertical-align: inherit;">pour la domotique </font><font style="vertical-align: inherit;">avec des fonctionnalités riches pour tous les besoins imaginables et inimaginables. </font><font style="vertical-align: inherit;">J'ai été particulièrement satisfait de la fonctionnalité de tueur - un module radio 433 MHz, qui dans mon cas est adapté pour contrôler les unités d'alimentation NooLite. </font><font style="vertical-align: inherit;">Mais comme j'ai déjà un RPI, nous allons continuer sur cette lancée. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour mettre en place un éclairage «intelligent» dans l'appartement, je devais résoudre les tâches suivantes:</font></font><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">déterminer le scénario d'éclairage optimal dans un appartement de deux pièces</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">définir une méthode d'intégration avec RPI et de placement à faible courant</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">choisissez un wrapper à contrôler</font></font></a><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dessiner une architecture d'interaction commune</font></font></a></li>
</ul></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">faire une liste de courses </font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordonner ce qui précède avec sa femme</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">acheter les composants nécessaires</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lier des télécommandes et déboguer l'intégration RPI&gt; NooLite</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trouver et acheter des interrupteurs appropriés pour les télécommandes</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placer des blocs d'alimentation et des interrupteurs </font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">développer une application mobile pour Android</font></font></a></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les éléments 1 et 4-6 peuvent être répétés dans un cycle. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prix ​​d'émission:</font></font></b><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RPI [1 pièce]</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Module NooLite MT1132 [1 140 ₽ X 1 pc] 1 140 ₽</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Blocs d'alimentation NL [1 240 ₽ X 11 pièces] 13 640 ₽</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panneaux de commande fixes NL [1 340 ₽ X 7 pièces] 9 380 ₽</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Porte-clés télécommande NL [1 550 ₽ X 1 pc] 1 550 ₽</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Détecteur de mouvement NL [1 550 ₽ X 1 pc] 1 550 ₽</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boîtes de montage, supports, modules clavier / bouton (commutateurs), cadres (achetés individuellement)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">amis avec une imprimante 3D - gratuitement</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total: ~ 27 000 ₽</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + contrôleur à partir de 3 000 ₽.</font></font><br>
<a name="block1"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Scénario d'éclairage d'appartement</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La disposition du gilet d'angle deux pièces P44T avec une baie vitrée est donnée ci-dessous. </font></font><br>
<img src="https://habrastorage.org/files/f24/f3a/512/f24f3a512d94401ebf9d36ae27b645a2.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est prévu de contrôler l'éclairage avec NooLite dans toutes les pièces sauf la loggia, la salle de bain et les toilettes.</font></font><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le couloir</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2 points d'éclairage avec mode relais (marche / arrêt). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Un point lumineux moins brillant doit être contrôlé par le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">capteur de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mouvement </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">PM111</font></a><font style="vertical-align: inherit;"> . Cela permettra dans l'obscurité d'éclairer le chemin du vagabond de nuit à la recherche des lumières de la faim nocturne. </font></font><br>
<img src="https://habrastorage.org/files/82b/981/6b6/82b9816b645c43f09360010da4b2d6bd.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les deux points d'éclairage doivent être contrôlés par un interrupteur fixe situé à côté de la porte d'entrée. L'interrupteur doit inclure le scénario «éteindre les lumières dans tout l'appartement». </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le capteur de mouvement thermique passe en mode veille (commence à répondre au mouvement des objets thermiques) lorsque vous définissez le niveau d'éclairage et la sensibilité requis de la pièce. Habituellement pendant la journée, il n'est pas nécessaire de faire clignoter la lumière dans le couloir pour passer. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
D'après les instructions du capteur:</font></font><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si l'éclairage près du capteur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PM111 est</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> supérieur à celui défini par le régulateur d'éclairage, le capteur est en mode veille. </font><font style="vertical-align: inherit;">Dans le même temps, sa consommation de courant est minime (moins de 1 μA) et le capteur de mouvement thermique est désactivé. </font><font style="vertical-align: inherit;">Lorsque l'éclairage tombe en dessous d'un niveau prédéterminé, le capteur passe en mode veille.</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les lumières dans les toilettes et la salle de bain sont contrôlées par un interrupteur fixe classique. </font><font style="vertical-align: inherit;">La lumière et le ventilateur dans les toilettes sont connectés via un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">relais temporisé F&amp;F PO-415</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (également biélorusses) sur un rail DIN.</font></font><br>
<img src="https://habrastorage.org/files/761/0dd/00a/7610dd00a0d14e85bfb6aad508fd7570.png"><br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Du fait de la fermeture du contact de commande 6, les contacts de relais 11, 12 sont fermés. </font><font style="vertical-align: inherit;">L'ouverture du contact de commande 6 provoque un compte à rebours du temps réglé, après quoi le fonctionnement du PO-415 s'arrête.</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le commutateur de corridor fixe doit être de type bouton-poussoir, car l'invocation d'un script implique d'appuyer sur un bouton (le script n'a pas d'états ON / OFF). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En outre, le bouton est nécessaire si nous devons éteindre la lumière déjà allumée par le capteur de mouvement, lorsque la minuterie du capteur est configurée pour ne pas éteindre la lumière pendant plusieurs minutes après avoir été déclenchée. </font><font style="vertical-align: inherit;">La clé ne rentre pas dans ce cas. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total dans le couloir:</font></font></b><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux unités de puissance de type relais 200 W ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SU111-200</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en mode relais)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un interrupteur à 3 boutons fixe (télécommande </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PK313</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bouton 1 - éclairage marche / arrêt du point lumineux 1</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bouton 2 - allumer / éteindre l'éclairage du point lumineux 2</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bouton 3 - éteindre la lumière dans tout l'appartement (script)</font></font></li>
</ul><br>
 </li>
</ul><br>
<img src="https://habrastorage.org/files/d15/e11/fde/d15e11fde6b544e0b8b4a39329018f58.png"><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuisine</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trois points d'éclairage:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lampe au dessus de la table ( </font><font style="vertical-align: inherit;">mode relais </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SU111-200</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éclairage spot en plafond tendu ( </font><font style="vertical-align: inherit;">mode relais </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SU111-200</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> )</font></font></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bande</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> LED pour éclairer la surface de travail de la cuisine ( </font><font style="vertical-align: inherit;">mode relais </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">SU111-200</font></a><font style="vertical-align: inherit;"> )</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les points d'éclairage sont contrôlés par un interrupteur à 3 boutons (télécommande </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PK311</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) situé à l'entrée de la cuisine.</font></font><br>
<img src="https://habrastorage.org/files/f5e/6db/293/f5e6db29310044d7a028093a8bf6dcfc.png"><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Séjour et balcon</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deux points d'éclairage en mode relais ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SU111-200</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">éclairage principal dans le salon</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lumière sur le balcon</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Chaque point d'éclairage est contrôlé par 2 interrupteurs:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interrupteur fixe à 2 boutons sur le balcon (télécommande </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PK313</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bouton 1 - lumière marche / arrêt sur le balcon</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bouton 2 - allumer / éteindre la lumière dans le salon</font></font></li>
</ul><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interrupteur fixe à 2 touches dans le salon ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PK314</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Remote </font><font style="vertical-align: inherit;">):</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">touche 1 - allumer / éteindre la lumière dans le salon</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">touche 2 - lumière allumée / éteinte sur le balcon</font></font></li>
</ul><br>
 </li>
</ul><br>
<img src="https://habrastorage.org/files/2cd/d9e/241/2cdd9e24183442d089566677dee0de8c.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être que quelqu'un demandera "pourquoi ne pas mettre un interrupteur à 2 touches sur le balcon comme dans le salon?" </font><font style="vertical-align: inherit;">ou "pourquoi ne pas mettre des boutons dans tout l'appartement?". </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il en est ainsi, au début, il était censé installer un interrupteur à 3 boutons avec un bouton de scénario sur le balcon, mais a ensuite changé d'avis lors du choix de la conception des interrupteurs eux-mêmes. </font><font style="vertical-align: inherit;">On a également supposé qu'il y aurait des boutons dans le couloir et dans la cuisine, et des interrupteurs à clé dans le salon, la chambre et le balcon pour préserver le design. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Plus tard, j'ai voulu atténuer la lumière avec un interrupteur près du lit, donc tout s'est mal passé. </font><font style="vertical-align: inherit;">Pour préserver la conception des disjoncteurs, j'ai dû parcourir de nombreux marchés de la construction, visiter une dizaine de sites Internet, plus à ce sujet plus loin dans la section « </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trouver et acheter des disjoncteurs adaptés aux télécommandes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ».</font></font><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chambre</font></font></h5><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Section 1 (lit)</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Habituellement, des blocs d'alimentation sont situés à chaque point d'éclairage. </font><font style="vertical-align: inherit;">Un point d'éclairage - une unité d'alimentation. </font><font style="vertical-align: inherit;">Dans mon scénario d'éclairage, il y a un écart par rapport à la logique traditionnelle. </font><font style="vertical-align: inherit;">Dans la chambre «section 1», il est censé installer une lampe avec deux blocs d'alimentation, dont l'un sera atténué. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Section 2 (baie vitrée)</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En plus des interrupteurs fixes, tous les points d'éclairage doivent être contrôlés à partir d'une télécommande de poche comme console de secours et RPI. </font><font style="vertical-align: inherit;">Pour le trousseau:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bouton A (allumer / éteindre la lumière dans le couloir et dans la cuisine)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bouton B (allumer / éteindre la lumière dans le salon et sur le balcon)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bouton C (allumer / éteindre la lumière dans la chambre)</font></font></li>
</ul><br>
<img src="https://habrastorage.org/files/a78/f82/e8d/a78f82e8da434711aa8a66d6c40d7050.png"><br>
<a name="block2"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Définition du placement à faible courant et de la méthode d'intégration NooLite C pour RPI</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je dirai tout de suite, l'intégration est simple. </font><font style="vertical-align: inherit;">NooLite possède un module </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MT1132</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Le module reçoit un paquet de contrôle via UART de certains contrôleurs, dans mon cas, c'est un RPI, transmet une commande par voie aérienne aux appareils exécutifs (blocs d'alimentation) et répond avec la construction OK / r \ n, tout est décrit dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">les instructions du module</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<table>
<tbody><tr>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tension d'alimentation du module (VCC Upit)</font></font></th>
<th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2,7-5,5 V</font></font></th>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">plage de tension d'entrée à Rx </font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 - Haut</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TTL HIGH LVL (unité logique) à Upit = 5 V</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 - Upit (5 V)</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TTL LOW LVL (zéro logique) à Upit = 5 V</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-0,8 V</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TTL HIGH LVL (unité logique) à Upit = 3,3 V</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2-3,3 V</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TTL LOW LVL (zéro logique) à Upit = 3,3 V</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0-0,8 V</font></font></td>
</tr>
<tr>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vitesse UART</font></font></td>
<td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9600 bauds</font></font></td>
</tr>
</tbody></table><br>
<img src="https://habrastorage.org/files/ffe/4ee/a4d/ffe4eea4d7a14c25ae45f94c3bef4204.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que les lignes RPART UART fonctionnent avec des niveaux TTL de 3,3 V, nous utiliserons 3,3 V comme puissance U du module. </font></font><br>
<img src="https://habrastorage.org/files/d37/959/89e/d3795989ef37427ab127ad82d02e2ed0.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez utiliser trois lignes sur le MT1132: VCC, GND et RX pour transmettre un paquet de contrôle. </font><font style="vertical-align: inherit;">Je l'ai fait lors du débogage - je n'ai pas lu la réponse "OK \ r \ n" de MT1132, il m'a suffi d'observer l'indicateur de l'unité d'alimentation connectée. </font><font style="vertical-align: inherit;">Lors de l'acceptation réussie de la commande de «liaison», un clignotement fréquent de la LED intégrée est initié sur le bloc d'alimentation. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Autre point, la puissance de l'émetteur radio avec une puissance U de 3,3 V à 3,3 mW, avec une puissance U de 5 V à 5 mW. </font><font style="vertical-align: inherit;">La distance maximale à l'unité de puissance est de 70 m.</font></font><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">À propos du package de contrôle</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le paquet de contrôle se compose de 12 octets: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ST, B0, B1, B2, B3, B4, B5, B6, B7, B8, CS, SP </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ST</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - octet de démarrage, toujours 85 </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B0..B8</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - charge utile (commandes de contrôle) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - vérifier la somme. </font><font style="vertical-align: inherit;">L'octet le moins </font><font style="vertical-align: inherit;">significatif </font><font style="vertical-align: inherit;">de la somme des 10 premiers octets (ST à B8) </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SP</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - octet d'arrêt </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Selon les instructions, j'ai écrit les octets de contrôle dont j'ai besoin: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - commande de contrôle avec des valeurs:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0 - éteignez la charge</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 - allumez la charge</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 - allumer ou éteindre la charge</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9 - découplage (démarrer le processus d'effacement de l'adresse de la mémoire du bloc d'alimentation)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">15 - liaison (enregistrer l'adresse du module dans le bloc d'alimentation)</font></font></li>
</ul><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - adresse de canal (de 0 à 31). </font><font style="vertical-align: inherit;">Seulement 32 canaux. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
autres octets par défaut à l'exception de la somme de contrôle. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - réglage du mode de transmission du module. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si la </font><font style="vertical-align: inherit;">valeur 80 (0x50) est passée </font><font style="vertical-align: inherit;">à </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">B0,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alors:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nombre de répétitions - 2</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bitrate 2-1000 bps</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode 0 - envoyer une commande</font></font></li>
</ul><br>
<img src="https://habrastorage.org/files/034/067/d82/034067d8239e4139b06ce9408ce2d87f.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En conséquence, j'ai compilé une telle </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">table</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec les packages de contrôle nécessaires pour moi.</font></font><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Placement dans le panneau électrique</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il a été décidé d'installer un courant faible dans le tableau interne:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le RPI est monté sur un rail DIN en attachant des amis imprimés sur une imprimante 3D</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Module MT1132 pour contrôler les unités de puissance par voie aérienne</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deux ~ 220 prises sur DIN pour la connexion des blocs d'alimentation d'un routeur et RPI</font></font></li>
</ul><br>
<img src="https://habrastorage.org/files/9ab/684/784/9ab6847847b94274ab95a4cdac7379b3.jpg"><br>
<a name="block3"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Débogage d'intégration et sélection de wrappers pour la gestion</font></font></h4><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conditions préalables:</font></font></b><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RPI</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Module MT1132</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fils mère à mère pour connecter les broches MT1132 et RPI GPIO</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carte SD avec n'importe quelle image RPI préinstallée</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">accès à la console RPI SHELL (bash, csh, korn, etc.) (clavier direct ou distant via SSH)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">packages de contrôle préparés</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bibliothèque pour travailler avec UART via l'en-tête GPIO dans RPI</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors de la préparation de l'image, j'ai attrapé un bogue câblé cool sur le Macbook Air lors de l'enregistrement de l'image Raspbian-wheezy sous la racine (bien que pour moi, c'est une fonctionnalité - protection supplémentaire en écriture, détrompez-vous avant d'écraser les données):</font></font><br>
<pre><code class="bash hljs">dd bs=1m <span class="hljs-keyword">if</span>=2015-02-16-raspbian-wheezy.img of=/dev/disk2</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La console a renvoyé:</font></font><br>
<pre><code class="bash hljs">dd: /dev/disk2: Permission denied </code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec le verrou retiré sur la carte SD, sous la racine et les bons mods sur / dev / disk2 .... </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, j'ai trouvé un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">métier sur ce sujet</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , quelqu'un a aidé à souffler dans la fente SD sur le coquelicot, quelqu'un a eu une machine à sous. Battre un macbook est un gaspillage aujourd'hui, et en conséquence, un petit écart m'a aidé: si la carte SD n'est pas complètement insérée, tout fonctionnera. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pendant le débogage, j'ai dû faire une ferme collective, car il n'y avait pas de connecteurs mère-mère adaptés. </font></font><br>
<img src="https://habrastorage.org/files/ebf/f89/c4f/ebff89c4f54a444da08cee2965451eda.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Étant donné que j'avais besoin d'un wrapper pour contrôler les unités d'alimentation via WEB, la possibilité de faire des demandes REST à l'avenir et une bibliothèque UART à partir d'une seule boîte - le choix s'est </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">porté</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">WebIOPi</font></a><font style="vertical-align: inherit;"> . </font></font><br>
<img src="https://habrastorage.org/files/3da/fa4/85e/3dafa485e4fe44f8b9f0c0b7bfffc282.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien que je veuille construire OpenHAB à cause de l'architecture cool. </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La plateforme d'automatisation a été décrite sur Habré</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'utiliserai certainement cette plate-forme à l'avenir, mais pour l'instant, pour ma «liste de souhaits», la plate-forme choisie est suffisante.</font></font><br>
<a name="arch"></a><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Architecture d'interaction générale</font></font></h5><br>
<img src="https://habrastorage.org/files/ebb/55d/b61/ebb55db6163f476fb505ca4e498f2d7f.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration minimale de WebIOPi</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
En utilisant les instructions fournies sur le site Web du projet:</font></font><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installer le framework WebIOPi en</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suivant ces étapes</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installation</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exécution de WebIOPi (démon)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Démarrage automatique au démarrage</font></font></li>
</ul><br>
 </li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">configurer UART</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en modifiant 3 fichiers: / etc / inittab, /boot/cmdline.txt, / etc / webiopi / config. </font><font style="vertical-align: inherit;">Pas:</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uart à bord</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration de WebIOPi</font></font></li>
</ul><br>
 </li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nous reproduisons les actions décrites dans la section</font></font><br>
 <ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Astuce Serial Loopback (envoyez-nous la «chaîne» via UART et lisez l'interface WEBIOPi dans la section Serial Monitor)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la vidéo dans la section Serial Monitor affiche le processus</font></font></li>
</ul><br>
 </li>
</ol><br>
<img src="https://habrastorage.org/files/39b/9d6/224/39b9d6224a214d16bb931577c750497c.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Installez un cavalier pour tester la boucle UART. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En utilisant la table précédemment compilée avec les packages de contrôle, nous allons écrire un simple script Python pour gérer le module à partir de RPI SHELL.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Script RPI Shell pour le module MT1132</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment">#!/usr/bin/python</span>
<span class="hljs-keyword">import</span> sys, getopt
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">main</span>(<span class="hljs-params">argv</span>):</span>
   ch = <span class="hljs-string">''</span>
   cmd = <span class="hljs-string">''</span>
   <span class="hljs-keyword">try</span>:<font></font>
      opts, args = getopt.getopt(argv,<span class="hljs-string">"h:"</span>,[<span class="hljs-string">"ch="</span>,<span class="hljs-string">"cmd="</span>])
   <span class="hljs-keyword">except</span> getopt.GetoptError:
      <span class="hljs-keyword">print</span> <span class="hljs-string">'mt1132.py --ch &lt;channel_number&gt; --cmd &lt;ON/OFF/BIND/UNBIND&gt;'</span>
      sys.exit(<span class="hljs-number">2</span>)
   <span class="hljs-keyword">for</span> opt, arg <span class="hljs-keyword">in</span> opts:
      <span class="hljs-keyword">if</span> opt == <span class="hljs-string">'-h'</span>:
         <span class="hljs-keyword">print</span> <span class="hljs-string">'mt1132.py --ch &lt;channel_number&gt; --cmd &lt;ON/OFF/BIND/UNBIND&gt;'</span><font></font>
         sys.exit()<font></font>
      <span class="hljs-keyword">elif</span> opt <span class="hljs-keyword">in</span> (<span class="hljs-string">"--ch"</span>):<font></font>
         ch = arg<font></font>
      <span class="hljs-keyword">elif</span> opt <span class="hljs-keyword">in</span> (<span class="hljs-string">"--cmd"</span>):<font></font>
         cmd = arg<font></font>
   <span class="hljs-keyword">print</span> <span class="hljs-string">'Channel: '</span>, ch
   <span class="hljs-keyword">print</span> <span class="hljs-string">'Command: '</span>, cmd
   <span class="hljs-keyword">if</span> cmd==<span class="hljs-string">'ON'</span> <span class="hljs-keyword">and</span> ch!=<span class="hljs-string">''</span>:
        <span class="hljs-keyword">if</span> ch==<span class="hljs-string">'0'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 0'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a7</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'1'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 1'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a8</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'2'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 2'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a9</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'3'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 3'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00aa</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'4'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 4'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ab</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'5'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 5'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ac</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'6'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 6'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ad</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'7'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 7'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ae</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'8'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 8'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00af</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'9'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 9'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b0</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'10'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch ON channel 10'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b1</span>, <span class="hljs-number">0x00aa</span>])
   <span class="hljs-keyword">if</span> cmd==<span class="hljs-string">'OFF'</span> <span class="hljs-keyword">and</span> ch!=<span class="hljs-string">''</span>:
        <span class="hljs-keyword">if</span> ch==<span class="hljs-string">'0'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 0'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a5</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'1'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 1'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a6</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'2'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 2'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a7</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'3'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 3'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a8</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'4'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 4'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a9</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'5'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 5'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00aa</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'6'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 6'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ab</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'7'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 7'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ac</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'8'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 8'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ad</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'9'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 9'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ae</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'10'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'Switch OFF channel 10'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ae</span>, <span class="hljs-number">0x00aa</span>])
   <span class="hljs-keyword">if</span> cmd==<span class="hljs-string">'BIND'</span> <span class="hljs-keyword">and</span> ch!=<span class="hljs-string">''</span>:
        <span class="hljs-keyword">if</span> ch==<span class="hljs-string">'0'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 0'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b4</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'1'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 1'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b5</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'2'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 2'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b6</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'3'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 3'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b7</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'4'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 4'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b8</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'5'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 5'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b9</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'6'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 6'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ba</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'7'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 7'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00bb</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'8'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 8'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00bc</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'9'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 9'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00bd</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'10'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'BIND channel 10'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00be</span>, <span class="hljs-number">0x00aa</span>])
   <span class="hljs-keyword">if</span> cmd==<span class="hljs-string">'UNBIND'</span> <span class="hljs-keyword">and</span> ch!=<span class="hljs-string">''</span>:
        <span class="hljs-keyword">if</span> ch==<span class="hljs-string">'0'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 0'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ae</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'1'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 1'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00af</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'2'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 2'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b0</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'3'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 3'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b1</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'4'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 4'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b2</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'5'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 5'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b3</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'6'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 6'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b4</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'7'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 7'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b5</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'8'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 8'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b6</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'9'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 9'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b7</span>, <span class="hljs-number">0x00aa</span>])
        <span class="hljs-keyword">elif</span> ch==<span class="hljs-string">'10'</span>:
                <span class="hljs-keyword">print</span> <span class="hljs-string">'UNBIND channel 10'</span>
                serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b8</span>, <span class="hljs-number">0x00aa</span>])
<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<font></font>
   main(sys.argv[<span class="hljs-number">1</span>:])
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour contrôler MT1132 à partir de la console shell, exécutez les commandes suivantes </font></font><br>
<pre><code class="bash hljs"><font></font>
mt1132.py --ch &lt;channel_number&gt; --cmd &lt;ON/OFF/BIND/UNBIND&gt;<font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous fixons l'API REST</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Le framework WebIOPi fournit un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">contrôle via des requêtes HTTP dans le style REST</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ce qui facilite la fixation des clients mobiles et simplifie l'interaction client-serveur. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Copiez-collez le framework API REST en utilisant le lien ci-dessus:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenez la fonction GPIO</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Définir la fonction GPIO</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenez la valeur GPIO</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Définir la valeur GPIO</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sortie d'une seule impulsion</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Séquence de bits de sortie</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PWM de sortie avec un rapport cyclique</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PWM de sortie avec un angle pour les servos</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appeler une macro sur le serveur</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Obtenir l'état / la configuration GPIO complète</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Notre cas est "Appeler une macro sur le serveur". </font><font style="vertical-align: inherit;">La description n'est pas grasse, mais suffisante pour l'expérience: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HTTP POST / macros / (macro) / (args)</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Renvoie la valeur renvoyée par la macro</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisque (macro) n'a pas encore été préparée, nous allons vérifier le REST "Get full GPIO state / configuration", et pour cela nous devons faire une requête HTTP GET / *. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ouvrons n'importe quel client API REST, j'ai utilisé le client DHC pour le navigateur Chrome. Nous essayons d'effectuer une requête REST pour obtenir l'heure actuelle. </font></font><br>
<img src="https://habrastorage.org/files/b21/fc2/c33/b21fc2c3392b49c6b4f3f36220f97268.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Configuration WebIOPi (/ etc / webiopi / config) </font></font></b><br>
<img src="https://habrastorage.org/files/9c0/861/2fa/9c08612fa2024ef892a0e31b641c90e7.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la section [DEVICES]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutez un périphérique </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">série</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (UART GPIO) - c'est notre module MT1132, où </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ttyAMA0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est le périphérique (port) que le noyau Raspbian voit, le </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">débit en bauds</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est la vitesse en Échange d'informations en bauds via cette interface UART. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
9600 bauds / (8 + 1 bit de démarrage + 1 bit d'arrêt) = 960 octets / s. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la section [SCRIPTS]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (scripts personnalisés):</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ajoutez la chaîne </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">myscrypt = /home/pi/smarthome/python/mt1132.py</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - pour connecter notre script au framework. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la section [REST]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (paramètres de contrôle GPIO via l'API REST. Facultatif): </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gpio-post-value = false - interdit de modifier les niveaux logiques BAS / HAUT sur les broches GPIO via les requêtes REST; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
gpio-post-function = false - interdit de modifier le paramètre IN / OUT sur les broches GPIO via des requêtes REST. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les paramètres restants restent inchangés. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[COAP]</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'ai pas touché, déconnecté. Bien que je ne sache pas avec quoi il est mangé et où il est utilisé. J'ai enregistré uniquement cette ligne dans ma tête: oAP - est un protocole de transfert Web spécialisé à utiliser avec des nœuds et des réseaux contraints dans le</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Internet des objets</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , conçu pour les applications de machine à machine (M2M) telles que l'énergie intelligente et l'automatisation des bâtiments. " </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Peut-être que sur Habr quelqu'un ouvre des cas utiles d'utilisation.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ajoutez des macros pour les demandes REST à un script préalablement préparé.</font></font></b><div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"># Channel 0	</span>
<span class="hljs-meta">@webiopi.macro	</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ch0</span>(<span class="hljs-params">cmd</span>):</span>
	<span class="hljs-keyword">if</span> cmd==<span class="hljs-string">'on'</span>:<font></font>
		serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a7</span>, <span class="hljs-number">0x00aa</span>])<font></font>
		webiopi.sleep(<span class="hljs-number">1</span>)<font></font>
		resp = <span class="hljs-string">'Channel: 0, Cmd: '</span> + cmd + <span class="hljs-string">', Status: '</span> + serial.readString()
	<span class="hljs-keyword">if</span> cmd==<span class="hljs-string">'off'</span>:<font></font>
		serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00a5</span>, <span class="hljs-number">0x00aa</span>])<font></font>
		webiopi.sleep(<span class="hljs-number">1</span>)<font></font>
		resp = <span class="hljs-string">'Channel: 0, Cmd: '</span> + cmd + <span class="hljs-string">', Status: '</span> + serial.readString()
	<span class="hljs-keyword">if</span> cmd==<span class="hljs-string">'unbind'</span>:<font></font>
		serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00ae</span>, <span class="hljs-number">0x00aa</span>])<font></font>
		webiopi.sleep(<span class="hljs-number">1</span>)<font></font>
		resp = <span class="hljs-string">'Channel: 0, Cmd: '</span> + cmd + <span class="hljs-string">', Status: '</span> + serial.readString()
	<span class="hljs-keyword">if</span> cmd==<span class="hljs-string">'bind'</span>:<font></font>
		serial.writeBytes([<span class="hljs-number">0x55</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00b4</span>, <span class="hljs-number">0x00aa</span>])<font></font>
		webiopi.sleep(<span class="hljs-number">1</span>)<font></font>
		resp = <span class="hljs-string">'Channel: 0, Cmd: '</span> + cmd + <span class="hljs-string">', Status: '</span> + serial.readString()
	<span class="hljs-keyword">return</span> resp 
</code></pre><br>
</div></div><br>
<h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test des demandes REST avec des macros</font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous envoyons une demande REST pour "lier l'adresse du 3ème canal NooLite MT1132 au bloc d'alimentation sur lequel la liaison est initiée" via DHC. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si le paquet de contrôle est envoyé avec succès, le module MT1132 répondra via UART TX au GPIO UART RX «OK». </font><font style="vertical-align: inherit;">En cas de succès, l'unité d'alimentation se souviendra de l'adresse du canal et clignotera intensément avec la LED verte intégrée.</font></font><br>
<img src="https://habrastorage.org/files/ea3/e94/eb7/ea3e94eb7784412f8e909c7fb5af18a6.png"><br>
<a name="block5"></a><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Client simple pour Android</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au départ, je n'avais pas prévu d'écrire une application pour Android, du fait que je n'en avais aucune idée, je comptais me limiter à un navigateur. </font><font style="vertical-align: inherit;">Puis il a accidentellement erré dans la chaîne </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Start Android</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">L'auteur, Dmitry, raconte en détail avec Andryukha comment démarrer rapidement son premier projet sous la plateforme Androyd. </font><font style="vertical-align: inherit;">Un grand merci à l'auteur pour le projet et le travail acharné! </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir regardé et terminé pas plus de vingt leçons, j'ai commencé à créer ma simple application de contrôle d'éclairage. </font><font style="vertical-align: inherit;">Pour le développement, j'ai utilisé IDE Android Studio, comme le demande Google - basé sur IntelliJ IDEA. </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interface Le</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
résultat a été une interface très ascétique:</font></font><br>
<img src="https://habrastorage.org/files/771/334/b07/771334b07db9439381afe676f597f189.png"><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">main.xml TEL QUEL</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">xmlns:android</span>=<span class="hljs-string">"http://schemas.android.com/apk/res/android"</span>
    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
    <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>
    <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl7"</span>
    <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"2dp"</span>
    <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"false"</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-comment">&lt;!-- --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"50dp"</span>
        <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1c1"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"18sp"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"110dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl4"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/white"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/white"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"18sp"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1c2"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"120dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">" "</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl4"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"2"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/white"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"18sp"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1c3"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"150dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl4"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"3"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-comment">&lt;!--  --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"110dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/black"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"16sp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/room1txt"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/room1"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/holotheme_color"</span>
            <span class="hljs-attr">android:textStyle</span>=<span class="hljs-string">"bold"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
            <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"120dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"2"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center|top"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place1txt"</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1switch1"</span>
                <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
                <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
                <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center_vertical|left"</span>
                <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@drawable/hover1"</span>
                <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
                <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>
                <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place5txt"</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1switch2"</span>
                <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
                <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center_vertical|left"</span>
                <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@drawable/hover1"</span>
                <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
                <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>
                <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place2txt"</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1switch3"</span>
                <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
                <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center_vertical|left"</span>
                <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@drawable/hover1"</span>
                <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"150dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"3"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
                <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1b1on"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1b1off"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
                <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1b2on"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1b2off"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
                <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1b3on"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r1b3off"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-comment">&lt;!--  --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"40dp"</span>
        <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"110dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"16sp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/room2txt"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/room2"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/holotheme_color"</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/black"</span>
            <span class="hljs-attr">android:textStyle</span>=<span class="hljs-string">"bold"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"120dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place1txt"</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r2switch1"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"2"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center|left"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"150dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"3"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>
                <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r2b1on"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r2b1off"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-comment">&lt;!--  --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"40dp"</span>
        <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"110dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"16sp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/room3txt"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/room3"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/black"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/holotheme_color"</span>
            <span class="hljs-attr">android:textStyle</span>=<span class="hljs-string">"bold"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"120dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place1txt"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r3switch1"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"2"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center|left"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"150dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"3"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>
                <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r3b1on"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>
                <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r3b1off"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><font></font>
<font></font>
    <span class="hljs-comment">&lt;!--    --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"110dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"16sp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/room4txt"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/room4"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/holotheme_color"</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/black"</span>
            <span class="hljs-attr">android:textStyle</span>=<span class="hljs-string">"bold"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
            <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"120dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"2"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"37dp"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place6txt"</span>
                <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4switch1"</span>
                <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
                <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
                <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center_vertical|left"</span>
                <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@drawable/hover1"</span>
                <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"37dp"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place8txt"</span>
                <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4switch3"</span>
                <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
                <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
                <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center_vertical|left"</span>
                <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@drawable/hover1"</span>
                <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
                <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"37dp"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place7txt"</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4switch2"</span>
                <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
                <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center_vertical|left"</span>
                <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@drawable/hover1"</span>
                <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"150dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"3"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
                <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"37dp"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4b1on"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4b1off"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
                <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4b3on"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4b3off"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
                <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4b2on"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r4b2off"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><font></font>
<font></font>
<font></font>
    <span class="hljs-comment">&lt;!--  --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"110dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"16sp"</span>
            <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/room5txt"</span>
            <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/room5"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/black"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/holotheme_color"</span>
            <span class="hljs-attr">android:textStyle</span>=<span class="hljs-string">"bold"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
            <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"120dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"2"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place3txt"</span>
                <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r5switch1"</span>
                <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
                <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
                <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center_vertical|left"</span>
                <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@drawable/hover1"</span>
                <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TextView</span>
                <span class="hljs-attr">android:textSize</span>=<span class="hljs-string">"13sp"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"37dp"</span>
                <span class="hljs-attr">android:textColor</span>=<span class="hljs-string">"@color/hl9"</span>
                <span class="hljs-attr">android:text</span>=<span class="hljs-string">"@string/place4txt"</span>
                <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r5switch2"</span>
                <span class="hljs-attr">android:padding</span>=<span class="hljs-string">"4dp"</span>
                <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center_vertical|left"</span>
                <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@drawable/hover1"</span>
                <span class="hljs-attr">android:clickable</span>=<span class="hljs-string">"true"</span>/&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
            <span class="hljs-attr">android:background</span>=<span class="hljs-string">"@color/hl8"</span>
            <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"vertical"</span>
            <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"150dp"</span>
            <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
            <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"3"</span>
            <span class="hljs-attr">android:gravity</span>=<span class="hljs-string">"center"</span>
            <span class="hljs-attr">android:layout_margin</span>=<span class="hljs-string">"1dp"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
                <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"36dp"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r5b1on"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r5b1off"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span>
                <span class="hljs-attr">android:orientation</span>=<span class="hljs-string">"horizontal"</span>
                <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"match_parent"</span>
                <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"37dp"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r5b2on"</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
                    <span class="hljs-attr">style</span>=<span class="hljs-string">"?android:attr/buttonStyleSmall"</span>
                    <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
                    <span class="hljs-attr">android:layout_weight</span>=<span class="hljs-string">"1"</span>
                    <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"match_parent"</span>
                    <span class="hljs-attr">android:text</span>=<span class="hljs-string">""</span>
                    <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/r5b2off"</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span><font></font>
<font></font>
<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les méthodes OnClick sont liées aux boutons.</font></font><br>
<pre><code class="java hljs"><span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{
        <span class="hljs-comment">// define the button switch that invoked the listener by id</span>
        <span class="hljs-keyword">switch</span> (v.getId()) {
            <span class="hljs-comment">// Buttons room1 </span>
            <span class="hljs-keyword">case</span> R.id.r1b1on: <span class="hljs-comment">// </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room1txt)+<span class="hljs-string">" &gt; "</span>+r1sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch4url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le commutateur définit la vue ID de l'élément bouton, affiche un message TOAST à l'écran et envoie une requête HTTP au RPI via HttpURLConnection dans AsyncTask (appelez ParseTask (). Execute ();). </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Interaction avec le backend</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
HttpURLConnection - une classe pour l'interaction via le protocole HTTP. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Classe asyncTask Méthode doInBackground - effectue des tâches lourdes dans un flux d'arrière-plan distinct et renvoie le résultat au flux d'interface utilisateur. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
HttpURLConnection est exécuté dans la méthode doInBackground. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette technique se retrouve souvent sur Internet pour implémenter l'échange de données via le protocole HTTP.</font></font><br>
<pre><code class="java hljs">webiopiurl = getString(R.string.ch4url) + <span class="hljs-string">"on"</span>;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Remplace une constante du fichier strings.xml dans les ressources du projet</font></font><br>
<pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">string</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"ch4url"</span>&gt;</span>http://192.168.1.154:8000/macros/ch4/<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, l'URL complète pour activer le canal 4 ressemble à ceci</font></font><br>
<pre><code class="html hljs xml">http://192.168.1.154:8000/macros/ch4/on
</code></pre><br>
<pre><code class="java hljs"><span class="hljs-comment">// HTTP Query to backend in REST style</span>
    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParseTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AsyncTask</span>&lt;<span class="hljs-title">Void</span>, <span class="hljs-title">Void</span>, <span class="hljs-title">String</span>&gt; </span>{<font></font>
        HttpURLConnection urlConnection = <span class="hljs-keyword">null</span>;<font></font>
        BufferedReader reader = <span class="hljs-keyword">null</span>;<font></font>
        String result = <span class="hljs-string">""</span>;<font></font>
        String BASIC_AUTH = <span class="hljs-string">"Basic "</span>
                + Base64.encodeToString((getString(R.string.login) + <span class="hljs-string">":"</span> + getString(R.string.pwd)).getBytes(), Base64.NO_WRAP);<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">doInBackground</span><span class="hljs-params">(Void... params)</span> </span>{
            <span class="hljs-comment">//    REST </span>
            <span class="hljs-keyword">try</span> {<font></font>
                URL url = <span class="hljs-keyword">new</span> URL(webiopiurl);<font></font>
                urlConnection = (HttpURLConnection) url.openConnection();<font></font>
                urlConnection.setRequestMethod(<span class="hljs-string">"POST"</span>);<font></font>
                urlConnection.setRequestProperty(<span class="hljs-string">"Authorization"</span>, BASIC_AUTH);<font></font>
                urlConnection.connect();<font></font>
                <span class="hljs-comment">//    backend webiopi</span><font></font>
                InputStream inputStream = urlConnection.getInputStream();<font></font>
                StringBuffer buffer = <span class="hljs-keyword">new</span> StringBuffer();<font></font>
                reader = <span class="hljs-keyword">new</span> BufferedReader(<span class="hljs-keyword">new</span> InputStreamReader(inputStream));<font></font>
                String line;<font></font>
                <span class="hljs-keyword">while</span> ((line = reader.readLine()) != <span class="hljs-keyword">null</span>) {<font></font>
                    buffer.append(line);<font></font>
                }<font></font>
                result = buffer.toString();<font></font>
            } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
                e.printStackTrace();<font></font>
            }<font></font>
            <span class="hljs-keyword">return</span> result;<font></font>
        }<font></font>
</code></pre><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">code MainActivity.java TEL QUEL</font></font></b><div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword">package</span> ru.bbq.smarthome_App;<font></font>
<font></font>
<span class="hljs-keyword">import</span> android.os.AsyncTask;
<span class="hljs-keyword">import</span> android.os.Bundle;
<span class="hljs-keyword">import</span> android.support.v7.app.ActionBarActivity;
<span class="hljs-keyword">import</span> android.util.Base64;
<span class="hljs-keyword">import</span> android.util.Log;
<span class="hljs-keyword">import</span> android.view.View;
<span class="hljs-keyword">import</span> android.widget.Button;
<span class="hljs-keyword">import</span> android.widget.TextView;
<span class="hljs-keyword">import</span> android.widget.Toast;<font></font>
<font></font>
<span class="hljs-keyword">import</span> java.io.BufferedReader;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.io.InputStreamReader;
<span class="hljs-keyword">import</span> java.net.HttpURLConnection;
<span class="hljs-keyword">import</span> java.net.URL;<font></font>
<font></font>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ActionBarActivity</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">View</span>.<span class="hljs-title">OnClickListener</span> </span>{
    <span class="hljs-comment">// Add logger</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String LOG_TAG = <span class="hljs-string">"my_log"</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String webiopiurl = <span class="hljs-string">""</span>;
    <span class="hljs-comment">// switch buttons</span><font></font>
    TextView r1sw1;<font></font>
    TextView r1sw2;<font></font>
    TextView r1sw3;<font></font>
    TextView r2sw1;<font></font>
    TextView r3sw1;<font></font>
    TextView r4sw1;<font></font>
    TextView r4sw2;<font></font>
    TextView r4sw3;<font></font>
    TextView r5sw1;<font></font>
    TextView r5sw2;<font></font>
    <span class="hljs-comment">// ON OFF buttons</span><font></font>
    Button r1b1on;<font></font>
    Button r1b1off;<font></font>
    Button r1b2on;<font></font>
    Button r1b2off;<font></font>
    Button r1b3on;<font></font>
    Button r1b3off;<font></font>
    Button r2b1on;<font></font>
    Button r2b1off;<font></font>
    Button r3b1on;<font></font>
    Button r3b1off;<font></font>
    Button r4b1on;<font></font>
    Button r4b1off;<font></font>
    Button r4b2on;<font></font>
    Button r4b2off;<font></font>
    Button r4b3on;<font></font>
    Button r4b3off;<font></font>
    Button r5b1on;<font></font>
    Button r5b1off;<font></font>
    Button r5b2on;<font></font>
    Button r5b2off;<font></font>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);<font></font>
        setContentView(R.layout.main);<font></font>
        <span class="hljs-comment">// find View-elements and buttons</span>
        r1sw1 = (TextView) findViewById(R.id.r1switch1); <span class="hljs-comment">// room1switch1</span>
        r1sw2 = (TextView) findViewById(R.id.r1switch2); <span class="hljs-comment">// room1switch2</span>
        r1sw3 = (TextView) findViewById(R.id.r1switch3); <span class="hljs-comment">// room1switch3</span>
        r2sw1 = (TextView) findViewById(R.id.r2switch1); <span class="hljs-comment">// room2switch1</span>
        r3sw1 = (TextView) findViewById(R.id.r3switch1); <span class="hljs-comment">// room3switch1</span>
        r4sw1 = (TextView) findViewById(R.id.r4switch1); <span class="hljs-comment">// room4switch1</span>
        r4sw2 = (TextView) findViewById(R.id.r4switch2); <span class="hljs-comment">// room4switch2</span>
        r4sw3 = (TextView) findViewById(R.id.r4switch3); <span class="hljs-comment">// room4switch3</span>
        r5sw1 = (TextView) findViewById(R.id.r5switch1); <span class="hljs-comment">// room5switch1</span>
        r5sw2 = (TextView) findViewById(R.id.r5switch2); <span class="hljs-comment">// room5switch2</span>
        r1b1on = (Button) findViewById(R.id.r1b1on);    <span class="hljs-comment">// room1 button1 ON</span>
        r1b1off = (Button) findViewById(R.id.r1b1off);  <span class="hljs-comment">// room1 button1 OFF</span>
        r1b2on = (Button) findViewById(R.id.r1b2on);    <span class="hljs-comment">// room1 button2 ON</span>
        r1b2off = (Button) findViewById(R.id.r1b2off);  <span class="hljs-comment">// room1 button2 OFF</span>
        r1b3on = (Button) findViewById(R.id.r1b3on);    <span class="hljs-comment">// room1 button3 ON</span>
        r1b3off = (Button) findViewById(R.id.r1b3off);  <span class="hljs-comment">// room1 button3 OFF</span>
        r2b1on = (Button) findViewById(R.id.r2b1on);    <span class="hljs-comment">// room2 button1 ON</span>
        r2b1off = (Button) findViewById(R.id.r2b1off);  <span class="hljs-comment">// room2 button1 OFF</span>
        r3b1on = (Button) findViewById(R.id.r3b1on);    <span class="hljs-comment">// room3 button1 ON</span>
        r3b1off = (Button) findViewById(R.id.r3b1off);  <span class="hljs-comment">// room3 button1 OFF</span>
        r4b1on = (Button) findViewById(R.id.r4b1on);    <span class="hljs-comment">// room4 button1 ON</span>
        r4b1off = (Button) findViewById(R.id.r4b1off);  <span class="hljs-comment">// room4 button1 OFF</span>
        r4b2on = (Button) findViewById(R.id.r4b2on);    <span class="hljs-comment">// room4 button2 ON</span>
        r4b2off = (Button) findViewById(R.id.r4b2off);  <span class="hljs-comment">// room4 button2 OFF</span>
        r4b3on = (Button) findViewById(R.id.r4b3on);    <span class="hljs-comment">// room4 button3 ON</span>
        r4b3off = (Button) findViewById(R.id.r4b3off);  <span class="hljs-comment">// room4 button3 OFF</span>
        r5b1on = (Button) findViewById(R.id.r5b1on);    <span class="hljs-comment">// room5 button1 ON</span>
        r5b1off = (Button) findViewById(R.id.r5b1off);  <span class="hljs-comment">// room5 button1 OFF</span>
        r5b2on = (Button) findViewById(R.id.r5b2on);    <span class="hljs-comment">// room5 button2 ON</span>
        r5b2off = (Button) findViewById(R.id.r5b2off);  <span class="hljs-comment">// room5 button2 OFF</span><font></font>
<font></font>
        <span class="hljs-comment">//assign listeners to buttons</span>
        r1b1on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r1b1off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r1b2on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r1b2off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r1b3on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r1b3off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r2b1on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r2b1off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r3b1on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r3b1off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r4b1on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r4b1off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r4b2on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r4b2off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r4b3on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r4b3off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r5b1on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r5b1off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r5b2on.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
        r5b2off.setOnClickListener(<span class="hljs-keyword">this</span>);<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// Define On ClickView method</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onClick</span><span class="hljs-params">(View v)</span> </span>{
        <span class="hljs-comment">// define the button switch that invoked the listener by id</span>
        <span class="hljs-keyword">switch</span> (v.getId()) {
            <span class="hljs-comment">// Buttons room1 </span>
            <span class="hljs-keyword">case</span> R.id.r1b1on: <span class="hljs-comment">// </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room1txt)+<span class="hljs-string">" &gt; "</span>+r1sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch4url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r1b1off: <span class="hljs-comment">// </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room1txt)+<span class="hljs-string">" &gt; "</span>+r1sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch4url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r1b2on: <span class="hljs-comment">//  </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room1txt)+<span class="hljs-string">" &gt; "</span>+r1sw2.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch3url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r1b2off: <span class="hljs-comment">//  </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room1txt)+<span class="hljs-string">" &gt; "</span>+r1sw2.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch3url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r1b3on: <span class="hljs-comment">// LED </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room1txt)+<span class="hljs-string">" &gt; "</span>+r1sw3.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch2url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r1b3off: <span class="hljs-comment">// LED </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room1txt)+<span class="hljs-string">" &gt; "</span>+r1sw3.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch2url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-comment">// Buttons room2 </span>
            <span class="hljs-keyword">case</span> R.id.r2b1on:<font></font>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room2txt)+<span class="hljs-string">" &gt; "</span>+r2sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch6url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r2b1off:<font></font>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room2txt)+<span class="hljs-string">" &gt; "</span>+r2sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch6url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-comment">// Buttons room3 </span>
            <span class="hljs-keyword">case</span> R.id.r3b1on:<font></font>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room3txt)+<span class="hljs-string">" &gt; "</span>+r3sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch5url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r3b1off:<font></font>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room3txt)+<span class="hljs-string">" &gt; "</span>+r3sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch5url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-comment">// Buttons room4 bedroom</span>
            <span class="hljs-keyword">case</span> R.id.r4b1on: <span class="hljs-comment">//    </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room4txt)+<span class="hljs-string">" &gt; "</span>+r4sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch8url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r4b1off: <span class="hljs-comment">//    </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room4txt)+<span class="hljs-string">" &gt; "</span>+r4sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch8url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r4b2on: <span class="hljs-comment">//    </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room4txt)+<span class="hljs-string">" &gt; "</span>+r4sw2.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch7url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r4b2off: <span class="hljs-comment">//    </span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room4txt)+<span class="hljs-string">" &gt; "</span>+r4sw2.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch7url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r4b3on: <span class="hljs-comment">//   dimmer</span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room4txt)+<span class="hljs-string">" &gt; "</span>+r4sw3.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch9url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r4b3off: <span class="hljs-comment">//   dimmer</span>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room4txt)+<span class="hljs-string">" &gt; "</span>+r4sw3.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch9url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-comment">// Buttons room5 corridor</span>
            <span class="hljs-keyword">case</span> R.id.r5b1on:<font></font>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room5txt)+<span class="hljs-string">" &gt; "</span>+r5sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch1url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r5b1off:<font></font>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room5txt)+<span class="hljs-string">" &gt; "</span>+r5sw1.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch1url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r5b2on:<font></font>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.bon)+<span class="hljs-string">" '"</span>+getString(R.string.room5txt)+<span class="hljs-string">" &gt; "</span>+r5sw2.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch0url) + <span class="hljs-string">"on"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">case</span> R.id.r5b2off:<font></font>
                Toast.makeText(<span class="hljs-keyword">this</span>, getString(R.string.boff)+<span class="hljs-string">" '"</span>+getString(R.string.room5txt)+<span class="hljs-string">" &gt; "</span>+r5sw2.getText()+<span class="hljs-string">"'"</span>, Toast.LENGTH_SHORT).show();<font></font>
                webiopiurl = getString(R.string.ch0url) + <span class="hljs-string">"off"</span>;
                <span class="hljs-keyword">new</span> ParseTask().execute();
                <span class="hljs-keyword">break</span>;<font></font>
        }<font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment">// HTTP Query to backend in REST style</span>
    <span class="hljs-keyword">private</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParseTask</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AsyncTask</span>&lt;<span class="hljs-title">Void</span>, <span class="hljs-title">Void</span>, <span class="hljs-title">String</span>&gt; </span>{<font></font>
        HttpURLConnection urlConnection = <span class="hljs-keyword">null</span>;<font></font>
        BufferedReader reader = <span class="hljs-keyword">null</span>;<font></font>
        String result = <span class="hljs-string">""</span>;<font></font>
        String BASIC_AUTH = <span class="hljs-string">"Basic "</span>
                + Base64.encodeToString((getString(R.string.login) + <span class="hljs-string">":"</span> + getString(R.string.pwd)).getBytes(), Base64.NO_WRAP);
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">doInBackground</span><span class="hljs-params">(Void... params)</span> </span>{
            <span class="hljs-comment">//    REST </span>
            <span class="hljs-keyword">try</span> {<font></font>
                URL url = <span class="hljs-keyword">new</span> URL(webiopiurl);<font></font>
                urlConnection = (HttpURLConnection) url.openConnection();<font></font>
                urlConnection.setRequestMethod(<span class="hljs-string">"POST"</span>);<font></font>
                urlConnection.setRequestProperty(<span class="hljs-string">"Authorization"</span>, BASIC_AUTH);<font></font>
                urlConnection.connect();<font></font>
                <span class="hljs-comment">//    backend webiopi</span><font></font>
                InputStream inputStream = urlConnection.getInputStream();<font></font>
                StringBuffer buffer = <span class="hljs-keyword">new</span> StringBuffer();<font></font>
                reader = <span class="hljs-keyword">new</span> BufferedReader(<span class="hljs-keyword">new</span> InputStreamReader(inputStream));<font></font>
                String line;<font></font>
                <span class="hljs-keyword">while</span> ((line = reader.readLine()) != <span class="hljs-keyword">null</span>) {<font></font>
                    buffer.append(line);<font></font>
                }<font></font>
                result = buffer.toString();<font></font>
            } <span class="hljs-keyword">catch</span> (Exception e) {<font></font>
                e.printStackTrace();<font></font>
            }<font></font>
            <span class="hljs-keyword">return</span> result;<font></font>
        }<font></font>
<font></font>
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onPostExecute</span><span class="hljs-params">(String str)</span> </span>{
            <span class="hljs-keyword">super</span>.onPostExecute(str);
            <span class="hljs-comment">//  ,    plain text ( JSON)</span>
            <span class="hljs-comment">//    log</span><font></font>
            Log.d(LOG_TAG, str);<font></font>
            <span class="hljs-comment">//  TOAST -   webiopi     MT1132</span><font></font>
            Toast.makeText(getApplicationContext(), str, Toast.LENGTH_SHORT).show();<font></font>
        }<font></font>
    }<font></font>
<font></font>
}<font></font>
</code></pre><br>
</div></div><br>
<a name="block4"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Trouvez et achetez des interrupteurs adaptés aux télécommandes</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur la base du scénario d'éclairage, ce projet utilise des claviers NooLite et des boutons-poussoirs / commutateurs intégrés fixes, il est nécessaire de fournir la possibilité d'installer des commutateurs avec trois modules (boutons / touches), en préservant la conception des commutateurs (tous les commutateurs doivent avoir la même apparence). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lors du choix des commutateurs, envisagez la possibilité de:</font></font><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installation de deux à trois modules à l'appui de commutateurs</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">installation de modules de boutons et de claviers</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les interrupteurs bticino livinglight conviennent à ces conditions. </font><font style="vertical-align: inherit;">Sur la photo ci-dessous, les modules assemblés avec la télécommande NooLite. </font></font><br>
<img src="https://habrastorage.org/files/f6e/6b0/d1a/f6e6b0d1a7b9428cbba0d6e6670c1cb9.jpg"><br>
<img src="https://habrastorage.org/files/57d/47e/4f9/57d47e4f9b90491980fa5cff309ec226.jpg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bloc d'alimentation au plafond lors du débogage Débogage </font></font></b> <br>
<img src="https://habrastorage.org/files/d08/495/843/d08495843ec84300bc851d70e0b011ab.jpg"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sur site </font></font></b><br>
<img src="https://habrastorage.org/files/ceb/2c6/51a/ceb2c651a47145a2b51daab51abb32d6.png"><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Panneau électrique à faible courant situé à l'intérieur</font></font></b><br>
<img src="https://habrastorage.org/files/128/1f8/00a/1281f800ac6e40dd829cdde1e7b7f3cf.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Merci de votre attention </font><font style="vertical-align: inherit;">Bonne journée!</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr382689/">https://habr.com/ru/post/fr382689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr382677/index.html">Mon Internet des objets: Guest Castle (Partie 2)</a></li>
<li><a href="../fr382679/index.html">Les astronomes ont pu obtenir des photos du lac de lave à la surface d'Io, le satellite de Jupiter</a></li>
<li><a href="../fr382681/index.html">5 heures d'approche de Soyouz sur l'ISS - dans une vidéo d'une demi-minute sur YouTube</a></li>
<li><a href="../fr382685/index.html">Regardez au-delà de l'horizon</a></li>
<li><a href="../fr382687/index.html">Des scientifiques du CERN préparent un "champ de force" pour protéger les astronautes des radiations</a></li>
<li><a href="../fr382693/index.html">Le satellite Roskosmos METEOR-M2 s'est écrasé [appareil restauré]</a></li>
<li><a href="../fr382695/index.html">Fusion générale</a></li>
<li><a href="../fr382697/index.html">Réalité virtuelle et marché de consommation</a></li>
<li><a href="../fr382699/index.html">La British Library demande de l'aide pour déchiffrer la gravure d'une épée du XIIIe siècle</a></li>
<li><a href="../fr382701/index.html">Dans le film "John Wick" fera un jeu de tir à la première personne pour les lunettes VR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>