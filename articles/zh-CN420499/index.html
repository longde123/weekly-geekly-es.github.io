<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦇 🙍🏽 ⚗️ 推荐系统剖析。 第一部分 ❄️ 🐷 🙎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我在CleverDATA担任数据科学家。 我们从事机器学习项目，开发基于机器学习的营销解决方案的最常见要求之一就是推荐模型的开发。 

 在本文中，我将讨论推荐系统，尝试对现有方法进行最全面的概述，并用手指来解释算法的工作原理。 其中一些材料基于MovieLens实验室推荐系统的良好课程（大多数人都...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>推荐系统剖析。 第一部分</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/420499/">我在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CleverDATA</a>担任数据科学家。 我们从事机器学习项目，开发基于机器学习的营销解决方案的最常见要求之一就是推荐模型的开发。 <br><br> 在本文中，我将讨论推荐系统，尝试对现有方法进行最全面的概述，并用手指来解释算法的工作原理。 其中一些材料基于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MovieLens</a>实验室推荐系统的良好课程（大多数人都对同一数据集进行推荐测试很熟悉），其余的则来自个人经验。 本文由两部分组成。 第一部分描述了问题的陈述，并给出了简单（但很流行）推荐算法的概述。 在第二篇文章中，我将讨论更高级的方法和实现的一些实际方面。 <br><br><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/getpro/habr/post_images/652/779/d2d/652779d2ded29db0c8412ad892d0df72.jpg"></a> </div>  <a href="">来源</a> <br><a name="habracut"></a><br><h3>  <font color="#0057b6">审查并陈述问题</font> </h3><br> 推荐系统的任务是在给定的时间告知用户有关他可能最感兴趣的产品。 客户收到信息，该服务从提供优质服务中获利。 服务不一定是所提供商品的直接销售。 该服务还可以从佣金中赚取收入，或者只是提高用户忠诚度，然后转化为广告和其他收入。 <br><br> 根据业务模型的不同，推荐可以作为其基础（例如，使用TripAdvisor），也可以只是一种便利的附加服务（例如，在某些在线服装店中），旨在改善客户体验并使目录导航更加完善。舒服 <br><br> 在线营销的个性化是最近十年的明显趋势。 根据<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">麦肯锡的</a>说法，亚马逊收入的35％或Netflix收入的75％来自推荐产品，并且这个百分比可能会增长。 推荐系统是关于如何使客户满意的。 <br><br> 为了说明推荐服务的全部种类，我将列出可以描述任何推荐系统的主要特征。 <br><br><ol><li>  <b>推荐主题-推荐</b>什么。 <br><br> 这里种类繁多-可以是商品（亚马逊，Ozon），文章（Arxiv.org），新闻（Surfingbird，Yandex.Zen），图像（500px），视频（YouTube，Netflix），人（Linkedin，LonelyPlanet），音乐（Last.fm，Pandora），播放列表等。 通常，您可以推荐任何东西。 <br></li><li>  <b>推荐的目的</b>是为什么推荐它。 <br><br> 例如：购买，通知，培训，建立联系。 <br></li><li>  <b>推荐的上下文</b>是用户此时正在做什么。 <br><br> 例如：看货，听音乐，与人交谈。 <br></li><li>  <b>该建议的来源</b>是谁建议： <br><br>  -观众（TripAdvisor的平均餐厅评价）， <br>  -感兴趣的用户 <br>  -专家社区（有时涉及复杂的产品，例如葡萄酒）。 <br></li><li>  <b>个性化程度</b> 。 <br><br> 非个人推荐-与其他人一样被推荐给您。 它们允许按地区或时间进行定位，但不考虑您的个人偏好。 <br><br> 一个更高级的选项是当建议使用您当前会话中的数据时。 您已经看过几种产品，在页面底部为您提供了类似的产品。 <br><br> 个人推荐会使用有关该客户的所有可用信息，包括其购买历史。 <br></li><li>  <b>透明性</b> <br><br> 如果人们确切地知道如何收到建议，他们会更信任该建议。 因此，进入“无良”系统来推广付费商品或将更昂贵的商品放在更高排名中的风险较小。 另外，一个好的推荐系统本身应该能够处理购买的评论和销售秘籍。 <br><br> 顺便提一下，操作也是无意的。 例如，当发行新的大片时，粉丝首先想到的是它，在最初的几个月中，该评级可能被大大高估了。 <br></li><li>  <b>建议的格式</b> 。 <br><br> 这可以是一个弹出窗口，在网站的特定部分中显示的排序列表，屏幕底部的功能区或其他内容。 <br></li><li>  <b>演算法</b> <br><br> 尽管有许多现有算法，但它们都可以归结为几种基本方法，稍后将对其进行描述。 最经典的算法是基于摘要的算法（非个人的），基于内容的算法（基于产品描述的模型），协作过滤（协作过滤），矩阵分解（基于矩阵分解的方法）等。 <br></li></ol><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/db2/906/6d4db2906e4c73fe2dfc75325e55157b.png" width="400"></div>  <a href="">来源</a> <br><br> 任何推荐系统的中心都是所谓的偏好矩阵。 这是一个矩阵，在该矩阵的一个轴上预留了服务的所有客户端（用户），在另一个轴上是推荐对象（项目）。 在某些对（用户，商品）的交集处，此矩阵填充有评分（等级）-这是已知的用户对产品兴趣的指标，以给定的比例（例如1到5）表示。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b9a/1cd/f0d/b9a1cdf0d459d5bd938dcd269dc04678.jpg"></div><br> 用户通常只评估目录中产品的一小部分，推荐系统的任务是汇总此信息并预测客户对其他产品一无所知的态度。 换句话说，您需要填写上图中的所有空白单元格。 <br><br> 人们的消费方式有所不同，因此不必推荐新产品。 您可以显示重复的头寸，例如以补充库存。 根据此原理，将两组商品区分开。 <br><br><ul><li>  <b>可重复的</b> 。 例如，始终需要洗发水或剃刀。 <br></li><li>  <b>独特的</b> 。 例如，很少重新获得的书籍或电影。 <br></li></ul><br> 如果不能将产品明确分配给其中一个类别，则可以单独确定重复购买的可取性（某人只能购买某个品牌的花生酱，而对于某人来说，尝试目录中的所有商品很重要）。 <br><br>  “利息”的概念也是主观的。 一些用户只需要他们最喜欢的类别中的东西（保守推荐），相反，某些用户对非标准产品或产品组（危险推荐）更敏感。 例如，视频托管可以仅向用户推荐他最喜欢的系列的新剧集，并且可以定期向他投放新节目甚至新类型。 理想情况下，您应该选择一种策略，使用客户类别的建模分别显示每个客户的建议。 <br><br> 用户评级可以通过两种方式获得： <br><br><ul><li> 明确的评分-用户放置产品评分，留下评论，喜欢该页面， <br></li><li> 隐含评分-用户没有明确表达其态度，但是可以从其行为中得出间接结论：他购买了该产品-这意味着他喜欢它，长时间阅读了说明-这意味着有兴趣，等等。 <br></li></ul><br> 当然，明确的偏好会更好-用户自己说自己喜欢。 但是，实际上，并非所有站点都提供了明确表达其兴趣的机会，并且并非所有用户都希望这样做。 两种类型的评级最经常同时使用并且可以很好地相互补充。 <br><br> 区分预测（预测感兴趣程度）和建议书本身（显示建议）这两个术语也很重要。 显示什么以及如何显示是一个单独的任务，该任务使用在“预测”步骤中获得的估计值，但是可以以不同的方式实现。 <br><br> 有时，“推荐”一词在广义上使用，指的是任何优化，无论是选择用于广告邮件的客户，确定最佳报价或只是选择与客户的最佳沟通策略。 在本文中，我将自己局限于该术语的经典定义，表示为客户选择最有趣的产品。 <br><br><h3>  <font color="#0057b6">非个性化建议</font> </h3><br> 让我们从非个性化建议开始，因为它们最容易实现。 在它们中，用户的潜在兴趣仅取决于产品的平均评分：“每个人都喜欢它，所以您会喜欢它。” 当用户未登录系统（例如同一TripAdvisor）时，大多数服务都遵循此原则。 <br><br> 推荐可以以不同的方式显示-例如在产品说明侧面的横幅（Amazon），是根据特定参数（TripAdvisor）排序的请求的结果，或者是其他方式。 <br><br> 产品评分也可以通过多种方式显示。 这可能是产品旁边的明星，喜欢的次数，正面和负面投票之间的差异（通常在论坛上进行），高收视率的比例甚至是收视率的直方图。 直方图是最有用的方法，但是它有一个缺点-当您需要列出产品时，它们很难相互比较或排序。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b73/0ea/d52/b730ead5266ac0ad83e4a22aef73e91f.jpg"></div><br><h4>  <font color="#0057b6">冷启动问题</font> </h4><br> 冷启动是一种典型情况，当尚未积累足够的数据以使推荐系统正常工作时（例如，当产品是新产品或很少购买时）。 如果仅通过三个用户（igor92，xyz_111和oleg_s）的估算值来计算平均评分，那么这种评估显然将不可靠，并且用户可以理解。 通常在这种情况下，评级是人为调整的。 <br><br> 第一种方法不是显示平均值，而是显示平滑的平均值（阻尼平均值）。 含义是：对于少量的评分，显示的评分更倾向于某种安全的“平均”指标，并且一旦收集到足够数量的新评分，“平均”调整就会停止工作。 <br><br> 另一种方法是计算每个等级的置信区间。 从数学上讲，估计数越多，平均值的变化就越小，因此，对其正确性的把握就越大。 作为等级，您可以显示例如区间的下边界（低CI界限）。 同时，很明显，这样的系统将非常保守，并且倾向于低估新产品的评级（当然，除非受到打击）。 <br><br> 由于估计值被限制在一定范围内（例如，从0到1），因此通常无法使用这种方法来计算置信区间：因为分布尾部趋于无穷大，并且区间本身具有对称性。 有另一种更准确的计算方法- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">威尔逊置信区间</a> 。 在这种情况下，获得了大约这种类型的不对称间隔。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b3/ks/rt/b3ksrtynyspkk3lnfpawslijoou.jpeg"></div><br> 在上图中，绘制了平均评分的水平评分，垂直是围绕平均值的分布。 颜色表示不同的样本大小（显然，样本越大，置信区间越小）。 <br><br> 冷启动问题与非个性化建议同样重要。 此处的一般方法是用各种启发式方法替换当前无法计数的内容（例如，用平均评分替换，使用更简单的算法或在收集数据之前完全不使用产品）。 <br><br><h4>  <font color="#0057b6">建议的相关性</font> </h4><br> 在某些情况下，考虑建议的“新鲜度”也很重要。 对于文章或论坛帖子尤其如此。 新条目通常应该排在最前面。 为此，请使用阻尼系数。 以下是一些用于计算媒体网站上文章排名的公式。 <br><br>  Hacker新闻杂志中的评分计算示例： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vc/yr/sn/vcyrsnoylizvctaq3ilbafaosbq.jpeg"></div> 其中U =赞成，D =赞成，P（惩罚）-为实施其他业务规则而进行的其他调整 <br><br>  Reddit中的评分计算： <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g-/zj/fg/g-zjfghqsstjvuryzd-b9c92hjk.jpeg"></div> 其中，U =赞成票数，D =反对票数，T =记录时间。 第一项估计“记录质量”，第二项进行时间校正。 <br><br> 显然，不存在通用公式，并且每个服务都发明了最能解决其问题的公式-对此进行了经验验证。 <br><br><h3>  <font color="#0057b6">基于内容的建议</font> </h3><br> 个人推荐建议最大程度地使用有关用户本人的信息，主要是有关其先前购买的信息。 首先是基于内容的过滤方法。 在这种方法的框架中，将产品（内容）的描述与用户根据其先前的评分获得的兴趣进行比较。 产品满足这些兴趣的程度越高，用户的潜在兴趣就越高。 这里明显的要求是，目录中的所有产品都应有描述。 <br><br> 从历史上看，基于内容的推荐的主题通常是带有非结构化描述的商品：电影，书籍，文章。 这样的标志可以是例如文本描述，评论，演员表等等。 但是，没有什么可以阻止使用普通数字或类别符号。 <br><br> 非结构化特征以典型的方式描述文本-单词空间中的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">向量</a> （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">向量空间模型</a> ）。 这样的向量的每个元素都是潜在地表征用户兴趣的特征。 类似地，乘积是相同空间中的向量。 <br><br> 当用户与系统交互时（例如，他购买了电影），他购买的商品的矢量描述被组合（概括和归一化）为单个矢量，因此，形成了他感兴趣的矢量。 此外，找到描述最接近感兴趣向量的产品，即产品，就足够了。 解决找到n个最近邻居的问题。 <br><br> 并非所有元素都是同等重要的：例如，同盟词显然不携带任何有效载荷。 因此，在确定两个向量中匹配元素的数量时，必须首先权衡所有测量的重要性。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文本挖掘中</a>众所周知的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TF-IDF</a>转换解决了此任务，该转换将更多的权重分配给稀有兴趣。 在确定两个向量的接近度时，这种兴趣的重合性比流行向量的重合性更为重要。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ns/yf/-l/nsyf-lljlfb0r7bjrc_l3xonto0.jpeg"></div><br> 此处的TF-IDF原理同样适用于普通的名义属性，例如流派，导演，语言。  TF-度量该属性对用户的重要性，IDF-度量该属性的“稀有性”。 <br><br> 有一整套类似的转换（例如BM25和类似的转换），但实质上它们都与TF-IDF重复相同的逻辑：比较产品时，稀有属性应具有更大的权重。 下图说明了TF-IDF的重量如何取决于TF和IDF。 最接近的水平轴为DF：所有产品中的属性频率，最接近的水平轴为TF：用户的属性频率对数。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/248/b71/1f2/248b711f2b0f9c813c8e88ced69bafbd.png"></div><br> 在实施过程中可以考虑一些要点。 <br><br><ul><li> 在形成商品的向量空间表示时，可以使用带状疱疹或<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">n-gram</a> （连续的单词对，三元组等）代替单个单词。 这将使模型更详细，但是培训将需要更多数据。 <br></li><li> 在产品描述的不同位置，关键字的权重可能不同（例如，电影描述可能由标题，简短描述和详细描述组成）。 <br></li><li> 来自不同用户的产品描述的权重可以不同。 例如，我们可以给具有许多评级的活跃用户更多的权重。 <br></li><li> 同样，您可以称量和乘积。 对象的平均评分越高，其重量就越大（类似于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PageRank</a> ）。 <br></li><li> 如果产品描述允许链接到外部资源，那么您可能会感到困惑，并且还分析与该产品有关的所有第三方信息。 <br></li></ul><br> 可以看出，基于内容的过滤几乎完全重复了搜索引擎（例如Yandex和Google）中使用的查询文档匹配机制。 唯一的区别在于搜索查询的形式-这里是描述用户兴趣的向量，并且包含所请求文档的关键字。 当搜索引擎开始增加个性化设置时，这种区别甚至消除了。 <br><br> 作为两个矢量接近程度的度量，最常用余弦距离。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0a6/136/c9b/0a6136c9bd4144fabc84b53b4e0b6f49.png"></div><br> 添加新评估后，兴趣向量将逐步更新（仅适用于已更改的元素）。 在重新计票时，由于偏好可能会有所不同，因此有必要给予新的估计更多的权重。 <br><br><h3>  <font color="#0057b6">协同过滤（基于用户的选项）</font> </h3><br> 这类系统在90年代开始积极发展。 作为该方法的一部分，将根据其他类似用户的兴趣来生成推荐。 这些建议是许多用户“合作”的结果。 因此，该方法的名称。 <br><br> 该算法的经典实现基于k个最近邻居的原理。 在手指上-对于每个用户，我们都会在偏好方面寻找与他最相似的k，并用有关他的邻居的已知数据来补充有关该用户的信息。 因此，举例来说，如果您知道感兴趣的邻居对这部电影“鲜血与混凝土”很满意，而您由于某种原因却没有看过电影，那么这是向您推荐这部电影供星期六观看的绝佳机会。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/it/fv/alitfv0yszejlvhji0agoy01amg.jpeg"></div><br> 上图说明了该方法的原理。 在偏好矩阵中，用户以黄色突出显示，我们要为其确定新产品（问号）的等级。 他最近的三个邻居以蓝色突出显示。 <br><br> 在这种情况下，“相似性”是兴趣“相关性”的同义词，可以用多种方式来考虑（除了皮尔逊相关性之外，还存在余弦距离，提花距离，汉明距离等）。 <br><br> 该算法的经典实现方式有一个明显的缺点-由于二次复杂度，因此在实践中不太适用。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确实，就像最近邻居的任何方法一样，它需要计算用户之间的所有成对距离（并且可能有数百万个用户）。</font><font style="vertical-align: inherit;">很容易计算出距离矩阵的计算复杂度为</font></font><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>n</mi><mn>2</mn></msup><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.072ex" height="2.901ex" viewBox="0 -935.7 3475.4 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhjCZE1j2yezvUEWFmyaN8jDu76a8w#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhjCZE1j2yezvUEWFmyaN8jDu76a8w#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhjCZE1j2yezvUEWFmyaN8jDu76a8w#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhjCZE1j2yezvUEWFmyaN8jDu76a8w#MJMAIN-32" x="849" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhjCZE1j2yezvUEWFmyaN8jDu76a8w#MJMATHI-6D" x="2207" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/lanit/blog/420499/&amp;usg=ALkJrhjCZE1j2yezvUEWFmyaN8jDu76a8w#MJMAIN-29" x="3085" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ø</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></mo><msup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ñ</font></font></mi><mn><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></mn></msup><mi><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">米</font></font></mi><mo stretchy="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></mo></math></span></span><script type="math/tex" id="MathJax-Element-1">O(n^2m)</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">其中，n是用户数，m是产品数。</font><font style="vertical-align: inherit;">对于一百万个用户，至少需要4TB来存储距离矩阵原始数据。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过购买高性能熨斗可以部分解决此问题。</font><font style="vertical-align: inherit;">但是，如果您采取明智的做法，最好将更正引入算法中：</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 并非每次购买都更新距离，而是批量更新（例如，每天一次）， </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 不要完全重新计算距离矩阵，而要逐步更新， </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 选择迭代和近似算法（例如ALS）。 </font></font><br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 为了使该算法有效，必须满足一些假设。 </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 人们的品味不会随着时间而改变（或改变，但对于每个人来说都是一样的）。 </font></font><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果人们的品味相吻合，那么他们在所有方面都相吻合。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">例如，如果两个客户喜欢同一部电影，那么他们也喜欢同一本书。</font><font style="vertical-align: inherit;">当推荐的产品均质时（例如，仅薄膜），通常会发生这种情况。</font><font style="vertical-align: inherit;">如果不是这样，那么几个客户很可能会拥有相同的食物偏好，而政治观点则正好相反-在这种情况下，该算法的有效性会降低。</font></font><br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以通过不同方式选择偏好空间中用户的邻居（他的邻居），我们将对其进行分析以生成新的推荐。通常，我们可以与系统的所有用户一起工作，可以设置某个接近度阈值，可以随机选择几个邻居，也可以选择n个最相似的邻居（这是最流行的方法）。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MovieLens作为最佳邻居数的作者为电影提供了30-50个邻居的数字，为任意推荐提供了25-100个邻居的数字。显然，如果我们带太多的邻居，我们将有更多的随机噪声机会；反之亦然，如果我们带的邻居太少，我们将获得更准确的建议，但是推荐的产品却更少。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据准备中的一个重要阶段是估算值的标准化。</font></font><br><br><h3> <font color="#0057b6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">数据标准化（缩放）</font></font></font> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">由于所有用户的评估方式都不一样-某人连续输入5个，而您很少期望某人输入4个，因此最好在计算之前对数据进行规范化，即 </font><font style="vertical-align: inherit;">导致一个单一的尺度，以便算法可以正确地相互比较。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自然地，然后需要通过逆变换将预测的估计值转换为原始比例（并且，如有必要，四舍五入到最接近的整数）。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有几种标准化方法：</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">居中（均值居中）-从用户的评分中，我们仅减去平均评分，</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*仅与非二进制矩阵有关</font></font></i> <br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标准化（z分数）-除居中外，我们还将其评分除以用户的标准偏差，</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*在此，反向转换后，评分可能会超出范围（例如，五分制评分为6），但是这种情况很少见，并且通过四舍五入到最接近的可接受估计值即可解决这些问题。</font></font></i> <br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">双重标准化-第一次将用户评分标准化，第二次-产品评分。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果电影“最佳电影”的平均评分为2.5，而用户给它的评分是5，则这是一个很强的因素，表明此类电影显然符合他的口味。</font></font><br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可以以不同的方式来考虑两个用户的偏好的“相似性”或相关性。</font><font style="vertical-align: inherit;">实际上，我们只需要比较两个向量。</font><font style="vertical-align: inherit;">我们列出了一些最受欢迎的。</font></font><br><br><ol><li>   —  ,       . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/110/e8c/698/110e8c698e7cf685c3bc2041afb25cec.png"></div><br>    —     ,      . <br><br>           50 / min(50, Rating intersection)    damping factor,       . <br></li><li>   <br><br>   —  , ..      ,     .         . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fdd/59e/325/fdd59e32550c21f7007bd4242a9a7b29.png"></div></li><li>   <br><br>    .  ,      —     ,     . <br><br><img src="https://habrastorage.org/webt/jo/s3/vn/jos3vnkilzsvrkevdfsm8xl22gq.png"><br><br>   —  ,     (..    ),       .  ,       . <br></li></ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">协作方法的一个有趣发展是所谓的基于信任的建议，该建议不仅考虑了人们根据他们的兴趣的接近程度，还考虑了他们的“社会”接近程度以及他们之间的信任程度。</font><font style="vertical-align: inherit;">例如，如果我们在Facebook上看到一个女孩定期访问带有她朋友录音的页面，那么她相信自己的音乐品味。</font><font style="vertical-align: inherit;">因此，向女孩推荐可以完全融合朋友播放列表中的新歌曲。</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/63b/62c/55e/63b62c55e1f68e966d6b4928617cc406.jpg"></div><br><h3> <font color="#0057b6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建议的理由</font></font></font> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户信任推荐系统很重要，为此，它应该简单易懂。</font><font style="vertical-align: inherit;">如有必要，应始终提供易于理解的建议解释（用英语术语解释）。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为说明的一部分，很高兴显示产品对邻居的评估，并根据该属性（例如，演员或导演）出现巧合，并在评估中显示系统的信心（信心）。</font><font style="vertical-align: inherit;">为了不使界面过载，可以将所有这些信息放入“告诉我更多”按钮。</font></font><br><br> 例如： <br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “您可能会喜欢这部电影，因为它在那儿播放……而且……” </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> “具有类似音乐品味的用户将专辑评为...满分4.5，满分5分。” </font></font></li></ul><br><h3>  <font color="#0057b6">总结</font> </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这将结束本文的第一部分。</font><font style="vertical-align: inherit;">我们检查了问题的一般陈述，讨论了非个人建议，描述了两种经典方法（基于内容的过滤和协作过滤），还涉及了证实建议的主题。</font><font style="vertical-align: inherit;">通常，这两种方法足以构建可用于生产的推荐系统。</font><font style="vertical-align: inherit;">在下一部分中，我将继续进行回顾并讨论更现代的方法，包括涉及神经网络和深度学习的方法以及混合模型。</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">同时，请参阅我们的空缺。</font></font></b> <div class="spoiler_text"><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">前端架构师</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Java开发人员（大数据）</font></font></a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Linux系统工程师</font></font></a> </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN420499/">https://habr.com/ru/post/zh-CN420499/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN420489/index.html">新的ARM处理器可以与Core i5竞争</a></li>
<li><a href="../zh-CN420491/index.html">我的战士方式，或我如何准备Sailfish生活应用程序</a></li>
<li><a href="../zh-CN420493/index.html">美国食品订购服务可以在餐馆世界中成为亚马逊吗</a></li>
<li><a href="../zh-CN420495/index.html">屏幕水渲染</a></li>
<li><a href="../zh-CN420497/index.html">蔬菜奇特性：克罗格在亚利桑那州为水果和蔬菜客户推出自助餐车</a></li>
<li><a href="../zh-CN420501/index.html">RAM中的Linux：Debirf Way 2018</a></li>
<li><a href="../zh-CN420503/index.html">JS开发人员日，不同的城市和社区-一个假期</a></li>
<li><a href="../zh-CN420505/index.html">OpenAI Five将赢得The International的专业团队吗</a></li>
<li><a href="../zh-CN420507/index.html">背景：所有人及其创作者的全球互联网</a></li>
<li><a href="../zh-CN420509/index.html">使用断言的一个明显问题</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>