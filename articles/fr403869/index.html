<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçüîß üôéüèº ü¶ã Mon exp√©rience de la cr√©ation d'une maison ¬´non intelligente¬ª üë∏üèº üë®üèº‚Äçüé§ üë®‚Äçüë©‚Äçüë¶‚Äçüë¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mon temps est venu de partager mon exp√©rience de la cr√©ation d'une maison ¬´sans smart¬ª. Je ne veux pas vraiment m'engager dans des pol√©miques sur ce q...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mon exp√©rience de la cr√©ation d'une maison ¬´non intelligente¬ª</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403869/">  Mon temps est venu de partager mon exp√©rience de la cr√©ation d'une maison ¬´sans smart¬ª.  Je ne veux pas vraiment m'engager dans des pol√©miques sur ce qu'est une maison intelligente tout de m√™me et ce qu'elle devrait pouvoir faire.  Dans mon cas, nous apprivoiserons les modules wifi Sonoff d'ITEAD et apprendrons √† allumer / √©teindre la "charge" du t√©l√©phone.  La publication expliquera comment flasher un module, connecter un capteur de temp√©rature / humidit√© au module et apprendre √† contr√¥ler le module via les applications HomeKit ("Home") et Siri.  Ajoutez √† tout cela le syst√®me de gestion domotique Smart Domoticz sur Raspberry Pi.  Ajoutez le wifi √† la machine √† caf√© et apprenez √† Siri √† ouvrir l'interphone. <br><a name="habracut"></a><br>  J'ai command√© trois modules sonoff conventionnels et un SV (tension s√ªre) pour les tests.  Au moment de la commande, le module habituel de 4,85 est toujours vert, en stock, bien que le stock semble perp√©tuel.  SV √† un prix similaire de 4,85.  Avec la livraison en Ukraine, le co√ªt total √©tait de 26 verts.  La Chine et la Chine en Afrique, en Chine, l'argent a disparu, et les marchandises ont encore trois semaines √† attendre, et peut-√™tre plus.  Vous pouvez certainement acheter en Ukraine et ne pas attendre, mais un peu plus cher. <br><br><h2>  Les joies des premiers pas vers une maison ¬´sans smart¬ª </h2><br>  Quatre modules sont venus, les habituels sont emball√©s dans des bo√Ætes, et le SV est juste dans un sac antistatique.  Le bo√Ætier et la taille ravis. <br><br><img src="https://habrastorage.org/web/b03/b90/90e/b03b9090e5f2437fa0fc84260c747fff.jpg"><br><br>  Je ne d√©crirai pas le processus d'installation du logiciel natif e-Welink et la connexion du module au r√©seau domestique, les instructions dans toutes les langues sur Internet, prenez-le - je ne veux pas. <br><br>  Sans y r√©fl√©chir √† deux fois, nous entrons dans le couloir et ajoutons ce module au plafonnier.  Le module est petit, il y a beaucoup d'espace dans la lampe.  La lumi√®re reste souvent allum√©e dans le couloir, et maintenant vous pouvez √©teindre la lumi√®re dans le lit devant le t√©l√©viseur.  L'appartement a d√©j√† √©t√© r√©par√© partout et des interrupteurs conventionnels sont install√©s.  Ne touchez pas la r√©paration et n'utilisez pas le c√¢blage existant. <br><br>  Il s'av√®re que la logique de travail suivante: <br><br>  - L'interrupteur est √©teint, alors le module ne fonctionne pas non plus; <br>  - L'interrupteur est allum√©, puis la lumi√®re peut √™tre √©teinte depuis l'application; <br>  - L'interrupteur est allum√© et la lumi√®re a √©t√© √©teinte via l'application, puis pour allumer la lumi√®re, il est n√©cessaire d'√©teindre / allumer l'interrupteur, en r√©glant d'abord le module ¬´alimentation dans la section¬ª sur ON (lorsque le module relais est allum√©, la lumi√®re s'allume). <br><br>  R√©jouis-toi. <br><br>  Le deuxi√®me module a ajout√© √† la lampe dans la chambre.  Ensuite, la lampe n'√©tait pas aussi spacieuse que dans le couloir.  J'ai d√ª limer le bo√Ætier un peu et r√©duire / couper le bouton, il ne tenait pas en hauteur.  Ensuite, le module est soigneusement cach√© dans la lampe. <br><br><h3>  On refait le switch sous le bouton </h3><br>  Les interrupteurs de la s√©rie Schneider Unica sont install√©s dans l'appartement.  Vous pouvez refaire un tel interrupteur en mettant un ressort sous la cl√© et le lieu a d√©j√† √©t√© pr√©par√© √† l'avance. <br><br>  Pendant qu'ils √©crivent sur Internet, vous pouvez essayer le ressort √† partir de stylos √† bille.  Mes tentatives pour installer un ressort √† partir d'un stylo √† bille ont √©chou√©.  Un ressort tr√®s faible et un manque de rigidit√© ram√®nent la cl√© dans sa position d'origine. <br><br>  Le ressort Schneider d'origine a les caract√©ristiques suivantes d = 3,6 mm, √©paisseur de fil 0,6 mm, hauteur 10 mm.  Je ne l'ai pas tenu moi-m√™me, je ne l'ai pas trouv√© en vente, j'ai trouv√© des informations sur le printemps sur l'un des forums. <br><br>  Apr√®s avoir fouill√© la maison, un ressort similaire a √©t√© trouv√©, assez √©lastique et ajout√© avec succ√®s √† l'interrupteur.  Sans d√©penser un sou, nous obtenons un bouton au lieu d'un interrupteur. <br><br><img src="https://habrastorage.org/web/092/72f/5ea/09272f5ea6f34969a9ce5c4774039141.jpg"><br>  <i>Il ressemble √† un interrupteur avec un ressort install√©.</i> <br><br>  Maintenant, nous avons toujours le module avec alimentation et dans le r√©seau.  Dans les param√®tres, nous d√©finissons que lorsque l'alimentation est appliqu√©e au module, le module change l'√©tat du relais. <br><br>  La logique du travail dans ce cas: <br><br>  - sur le module sonoff il y a toujours de l'alimentation, allumant et √©teignant la lumi√®re via l'application; <br>  - une pression sur le bouton coupe l'alimentation et le relais change d'√©tat dans le sens inverse. <br><br>  Nous pouvons contr√¥ler la charge √† la fois sur le commutateur et via l'application.  L'application et le module natifs fonctionnent via un serveur chinois. <br><br>  Oui, oui, je sais, pendant la nuit il y a un saut / d√©connexion, la mise sous tension et la lumi√®re s'allume.  Pendant le fonctionnement du module, cela ne s'est jamais produit auparavant, mais nous vivons en Ukraine et les gros titres sont pleins de promesses de pannes. <br><br>  Sur la table est le troisi√®me module.  O√π es-tu cher?  Et nous choisirons votre natif et nous nous moquerons! <br><br><h2>  Installer un firmware alternatif </h2><br>  Une autopsie a montr√© <s>que le patient est d√©c√©d√© d'une autopsie,</s> qu'il y a une place sous le peigne pour 5 broches. <br><br><img src="https://habrastorage.org/web/643/e5a/1f4/643e5a1f425645aab6056fce519173d8.jpg"><br><br>  Depuis le bouton sur le bo√Ætier (3,3 V Rx, Tx, GND, GPIO 14).  Fer √† souder √† la main et connectez l'adaptateur USB √† TTL.  Dans mon adaptateur usb vers ttl, il y a 3,3 V, je n'ai pas essay√© d'alimenter le module √† partir de 5 V et je ne le recommande pas. <br><br>  Vient ensuite la partie logicielle.  Il existe un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">firmware</a> pour ces modules sur le github.  Maintenant, une nouvelle version du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">firmware</a> est d√©j√† apparue.  √Ä quoi servent ces micrologiciels?  Il y a le contr√¥le Web, le protocole mqtt, OTA (Over the air) - firmware over the air.  Quant au firmware natif, le protocole mqtt dans les promesses d'ajouter, OTA est √©galement l√†, mais uniquement pour le sien.  L'inconv√©nient du firmware natif est qu'il ne fonctionne que lorsqu'il est connect√© au r√©seau mondial.  Pourquoi en avons-nous besoin?  √Ä ce stade, ce n'est pas n√©cessaire ... d'autant plus que nous ne savons pas quoi et o√π notre module envoie. <br><br>  Installez l'IDE Arduino.  J'ai install√© la version portable 1.8.1.  Le micrologiciel n√©cessite la version IDE 1.6.10 ou sup√©rieure. <br><br>  - Ajout de la prise en charge des modules ESP8266 <br>  - Installer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pubsubclient</a> <br>  ‚óã Recherchez le fichier src \ PubSubClient.h et changez la valeur de MQTT_MAX_PACKET_SIZE en 400 ou plus (maintenant les versions de Tasmot demandent une valeur de 500 ou plus). <br><br>  T√©l√©chargez le croquis, compilez-le avec les doigts crois√©s et esp√©rez que tout se passe bien.  Ce n'√©tait pas mon cas, nous avons lu l'erreur et ajout√© les biblioth√®ques n√©cessaires qui n'√©taient pas l√†.  Quelques heures de tourments et un firmware sans erreurs.  (Le probl√®me principal √©tait que j'ai install√© l'IDE Arduino sur Win XP).  Modifiez le fichier de configuration et remplissez notre firmware. <br><br>  Ce minimum que j'ai d√©cid√© dans User_config.h. <br><br><div class="spoiler">  <b class="spoiler_title">User_config.h</b> <div class="spoiler_text"><code>#define PROJECT "bath" //   -         <br> #define STA_SSID1 "your_wifi_station_id" //    <br> #define STA_PASS1 "your_pass" //     <br> #define STA_SSID2 "your_wifi_station_id_plus" //      <br> #define STA_PASS2 " " //      <br> <br> #define SYS_LOG_HOST "192.168.." //  ,    raspberry pi,    <br> //#define USE_I2C //      <br> //#define USE_IR_REMOTE <br> //#define USE_WS2812</code> <br> </div></div><br>  Selon la version, d'autres param√®tres peuvent √™tre ajout√©s que je d√©sactiverais inutilement.  Dans le dernier firmware (Tasmota), de plus en plus de param√®tres peuvent √™tre d√©finis via le menu des param√®tres Web et dupliqu√©s avec User_config.h. <br><br><h3>  Remplissage d'esquisse: </h3><br>  - coupez l'alimentation du module (de toute mani√®re appropri√©e); <br>  - maintenez le bouton sur le module et branchez l'alimentation.  Le module est pr√™t √† recevoir le firmware; <br>  - cliquez sur OK dans l'IDE et en croisant √† nouveau les doigts, nous attendons que le firmware commence le t√©l√©chargement sur le module. <br><br>  En cas d'erreur, nous v√©rifions les fils, et si tout est bien viss√© partout, ou peut-√™tre qu'il n'y a pas assez de puissance USB-to-tl et nous devons prendre une source externe.  Nous dansons avec un tambourin et r√©p√©tons la proc√©dure. <br><br>  <b>Important: l'</b> <i>alimentation du module n'est fournie que par des broches de 3,3 V.</i>  <i>Il ne peut pas √™tre connect√© √† la charge √©lectrique via l'alimentation du module lui-m√™me.</i>  <i>Les utilisateurs exp√©riment√©s √©crivent que fournir 220v au module avec le micrologiciel le transforme en brique, petite mais en brique.</i>  Je n'ai pas essay√©, je ne sais pas.  Par cons√©quent, lors du flashage du module, seuls quatre c√¢bles aux broches y sont connect√©s, et nous retirons tout le reste. <br><br>  Si tout va bien, apr√®s le red√©marrage, le module doit se connecter au point d'acc√®s, trouver l'adresse IP et y acc√©der dans le navigateur. <br><br><img src="https://habrastorage.org/web/c96/316/9a0/c963169a05594c6791d9dfdd706b365e.png"><br>  <i>L'apparence de la page de d√©marrage.</i> <br><br>  Si le module ne se connecte pas √† votre point d'acc√®s, continuez √† danser avec un tambourin.  Il existe diff√©rentes solutions, dans le cadre de cet article je ne d√©crirai pas.  J'ai v√©rifi√© les configurations et je viens de flasher √† nouveau le module. <br><br>  Nous avons maintenant un acc√®s Web au module et √† ses param√®tres, mqtt, les fils peuvent √™tre plac√©s dans un tiroir, le firmware / mise √† jour se fait par voie a√©rienne. <br><br><h3>  Et o√π est Siri? </h3><br>  Tout cela est certainement merveilleux, il est temps d'apprendre √† g√©rer ce bien depuis le t√©l√©phone.  J'ai essay√© plusieurs programmes de l'application pour iPhone et je n'ai rien obtenu d'int√©ressant.  Il a √©t√© d√©cid√© de puiser dans l'application Home ou HomeKit, qui permet √©galement de contr√¥ler les modules via Siri. <br><br>  On retrouve sur l'√©tag√®re Raspberry pi et on se connecte au r√©seau.  Dans mon cas, il y avait d√©j√† une "framboise" connect√©e au r√©seau.  Comment installer l'OS et connecter les "framboises" pour le d√©crire n'a aucun sens. <br><br>  Pour communiquer avec HomeKit, vous devez installer Homebridge.  Homebridge est un serveur NodeJS fonctionnant sur votre r√©seau local et √©mulant l'API HomeKit iOS. <br><br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get upgrade sudo apt-get install git make sudo apt-get install g++</code> </pre><br>  Selon votre syst√®me, vous devrez peut-√™tre mettre √† jour le compilateur C ++. <br><br>  Installez Nodejs.  Nous allons au magasin et s√©lectionnons la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">dist</a> appropri√©e.  Copiez l'adresse de la distribution et plus loin dans l'image <br><br><pre> <code class="bash hljs">wget https://nodejs.org/dist/v4.0.0/node-v4.0.0-linux-armv6l.tar.gz tar -xvf node-v4.0.0-linux-armv6l.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> node-v4.0.0-linux-armv6l sudo cp -R * /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/</code> </pre> <br>  J'ai install√© la v6.9.4 pour moi, maintenant il y en a de plus r√©centes. <br><br>  Ajoutez d'autres packages n√©cessaires: <br><br><pre> <code class="bash hljs">sudo apt-get install libavahi-compat-libdnssd-dev</code> </pre> <br>  Installez Homebridge lui-m√™me: <br><br><pre> <code class="bash hljs">sudo npm install -g --unsafe-perm homebridge</code> </pre><br>  Si cela ne fonctionne pas, essayez: <br><br><pre> <code class="bash hljs">sudo npm install -g --unsafe-perm homebridge hap-nodejs node-gyp <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/lib/node_modules/homebridge/ sudo npm install --unsafe-perm bignum <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/lib/node_modules/hap-nodejs/node_modules/mdns sudo node-gyp BUILDTYPE=Release rebuild</code> </pre> <br>  Apr√®s avoir install√© Homebridge, vous devez installer quelques plugins suppl√©mentaires, puis proc√©der √† la modification des param√®tres du serveur Homebridge. <br><br>  L'installation des plugins se fait de la m√™me mani√®re que le homebridge lui-m√™me <br><br><pre> <code class="bash hljs">sudo npm install -g --unsafe-perm homebridge-plugin-name</code> </pre> <br>  Nous trouvons le plugin requis dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le gestionnaire de paquets</a> .  Nous y trouvons un exemple de param√®tres qui devront √™tre ajout√©s √† nos param√®tres. <br><br>  Pour un simple interrupteur. <br><br><pre> <code class="bash hljs">npm install -g homebridge-mqttswitch</code> </pre> <br>  Acc√©dez aux param√®tres, cr√©ez, s'il n'est pas d√©j√† cr√©√©, le fichier de configuration: <br><br><pre> <code class="bash hljs">sudo nano .homebridge/config.json</code> </pre> <br>  Le fichier de configuration est le suivant: <br><br><div class="spoiler">  <b class="spoiler_title">config.json</b> <div class="spoiler_text"><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"bridge"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Homebridge"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"CC:22:3D:E3:CE:30"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"port"</span></span>: <span class="hljs-number"><span class="hljs-number">51826</span></span>, <span class="hljs-attr"><span class="hljs-attr">"pin"</span></span>: <span class="hljs-string"><span class="hljs-string">"031-45-154"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"platforms"</span></span>: [ ], <span class="hljs-attr"><span class="hljs-attr">"accessories"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"accessory"</span></span>: <span class="hljs-string"><span class="hljs-string">"mqttswitch"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"mqtt://192.168.178.123:1883"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"admin"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"password"</span></span>: <span class="hljs-string"><span class="hljs-string">"admin"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"caption"</span></span>: <span class="hljs-string"><span class="hljs-string">"room"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"topics"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"statusGet"</span></span>: <span class="hljs-string"><span class="hljs-string">"stat/sleeping/POWER"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusSet"</span></span>: <span class="hljs-string"><span class="hljs-string">"cmnd/sleeping/power"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"onValue"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"offValue"</span></span>: <span class="hljs-string"><span class="hljs-string">"0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"integerValue"</span></span>: <span class="hljs-string"><span class="hljs-string">"true"</span></span> } ] }</code> </pre><br></div></div><br>  Avant d'enregistrer le fichier de param√®tres, v√©rifiez, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Apr√®s avoir enregistr√©, essayez d'ex√©cuter: <br><br><pre> <code class="bash hljs">Homebridge</code> </pre> <br>  Si tout commence, il nous √©crira, quelque chose comme: <br><br><pre> <code class="bash hljs"> 11:27:43 PM] [] Initializing mqttswitch accessory...</code> </pre><br>  Le code 031-45-154 pour la connexion y sera indiqu√©, s'il n'a pas √©t√© modifi√© dans les param√®tres. <br><br>  Maintenant, allumez le t√©l√©phone / planest ex√©cutant iOS.  Nous trouvons l'application ¬´Home¬ª ou ¬´HomeKit¬ª ‚Üí Ajoutez un accessoire et attendez que notre accessoire ¬´Homebridge¬ª apparaisse, ajoutez-le, entrez le code, attribuez une pi√®ce pour le commutateur.  Et le tour est jou√©: ¬´Salut Siri, allume / √©teint la lumi√®re dans la pi√®ce¬ª - cela a fonctionn√©.  ¬´Hi Siri¬ª sur les t√©l√©phones de la 5e s√©rie et ci-dessous ne fonctionne que lorsqu'il est connect√© √† la charge. <br><br>  Si tout fonctionne correctement pour nous, il reste √† ajouter Homebridge au d√©marrage.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Instructions compl√®tes</a> en anglais.  Dans mon cas, via <code>init.d</code> , cr√©ez le fichier <code>sudo nano /etc/init.d/homebridge</code> <br>  Copiez le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mod√®le</a> dans un fichier de ce fichier et modifiez-le sous homebridge <br><br><div class="spoiler">  <b class="spoiler_title">/etc/init.d/homebridge</b> <div class="spoiler_text"> <code>#!/bin/sh <br> ### BEGIN INIT INFO <br> # Provides: homebridge <br> # Required-Start: $network $remote_fs $syslog <br> # Required-Stop: $remote_fs $syslog <br> # Default-Start: 2 3 4 5 <br> # Default-Stop: 0 1 6 <br> # Short-Description: Start daemon at boot time <br> # Description: Enable service provided by daemon. <br> ### END INIT INFO <br> <br> dir="/home/pi" <br> cmd="DEBUG=* /usr/local/bin/homebridge" <br> user="pi" <br></code> <br></div></div><br>  Enregistrez, quittez. <br><br><pre> <code class="bash hljs">sudo chmod 755 /etc/init.d/homebridge sudo update-rc.d homebridge defaults</code> </pre> <br>  Homebridge va maintenant d√©marrer au d√©marrage du syst√®me. <br><br><h3>  Nous fixons le capteur DHT22 (temp√©rature / humidit√©) </h3><br>  Un lecteur attentif a remarqu√© qu'il y a 5 broches sur le peigne et l'une d'entre elles est GPIO 14. Encore une fois, nous prenons le fer √† souder dans nos mains et soudons les trois fils √† 3,3 V, GND, GPIO 14 pour le capteur de temp√©rature d'humidit√© DHT22.  Vous pouvez utiliser un autre capteur (ds18b20, DHT 11 ou un autre qui est pris en charge par le firmware), mais c'√©tait DHT22 dans ma bo√Æte.  Le capteur √©tait connect√© via un connecteur, qui √©tait fix√© sur le c√¥t√© du bo√Ætier natif.  Si n√©cessaire, il sera possible de connecter un autre capteur sans scalpel et fer √† souder. <br><br><img src="https://habrastorage.org/web/b68/643/a1f/b68643a1f956407286a799bb1b03d223.jpg"><br><br>  Dans l'image, je viens de fixer le connecteur, je n'ai pas encore connect√© les fils.  Dans le firmware Sonoff-MQTT-OTA-Arduino, vous devez v√©rifier les param√®tres: <br><br><pre> <code class="hljs lisp">#define DHT_PIN <span class="hljs-number"><span class="hljs-number">14</span></span> // GPIO <span class="hljs-number"><span class="hljs-number">14</span></span> = AM2301 (<span class="hljs-name"><span class="hljs-name">Sonoff_TH10A</span></span>(<span class="hljs-number"><span class="hljs-number">16</span></span>A), Sonoff SV) #define DHT_TYPE AM2301 // DHT module type (<span class="hljs-name"><span class="hljs-name">DHT11</span></span>, DHT21, DHT22, AM2301, AM2302 or AM2321)</code> </pre> <br>  Pour le firmware Tasmota, le type de broche et de capteur peut √™tre sp√©cifi√© dans les param√®tres Web. <br><br>  Si tout est correctement connect√© et configur√©, alors en allant sur l'interface Web, nous verrons l'√©tat du relais et les lectures du capteur.  Dans les param√®tres, vous pouvez d√©finir le taux d'interrogation du capteur.  La valeur par d√©faut est 300 secondes (5 minutes). <br><br><img src="https://habrastorage.org/web/3a2/4a3/3fb/3a24a33fbb3647979f69354039fb808c.png"><br><br>  Nous plongons dans la recherche d'un plug-in pour Homebridge pour travailler avec un capteur de temp√©rature et d'humidit√©.  Nous devons maintenant afficher ces lectures en annexe.  J'ai r√©ussi √† faire tout cela, mais √† mon humble avis c'√©tait mon r√¢teau et ne devrait pas √™tre fait. <br><br>  Pourquoi?  Tout est tr√®s simple, il suffit de visser le capteur au sonoff n'a pas de sens, vous devez activer / d√©sactiver quelque chose en fonction de ces lectures.  Mais dans les param√®tres du firmware, il n'y a pas une telle possibilit√©, il est possible de configurer l'application Home / HomeKit √† de telles fins, mais vous avez besoin d'une tablette qui sera constamment √† la maison ou d'Apple TV.  La pr√©sence dans le firmware de la capacit√© de communiquer avec Domoticz m'a conduit sur cette voie √©pineuse vers l'installation du syst√®me de contr√¥le domotique Smart Home. <br><br>  Sous la forme d'une petite digression, je dirai que j'ai essay√© de connecter des plugins au homebridge qui vous permettent de transf√©rer le flux RTSP depuis une webcam.  J'ai une cam√©ra IP TOP-201 de la part de mes homologues chinois. <br><br>  Installez le plugin: <br><br><pre> <code class="bash hljs">npm install -g --unsafe-perm homebridge-camera-ffmpeg</code> </pre> <br>  Ajoutez au fichier de param√®tres: <br><br><div class="spoiler">  <b class="spoiler_title">config.json</b> <div class="spoiler_text"><pre> <code class="hljs perl"><span class="hljs-string"><span class="hljs-string">"platforms"</span></span>: [{ <span class="hljs-string"><span class="hljs-string">"platform"</span></span>: <span class="hljs-string"><span class="hljs-string">"Camera-ffmpeg"</span></span>, <span class="hljs-string"><span class="hljs-string">"cameras"</span></span>: [ { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"top-201"</span></span>, <span class="hljs-string"><span class="hljs-string">"videoConfig"</span></span>: { <span class="hljs-string"><span class="hljs-string">"source"</span></span>: <span class="hljs-string"><span class="hljs-string">"-re -i rtsp://admin@192.168.178.10:554/user=admin_password=tlJwpbo6_channel=1_stream=0.sdp?real_stream"</span></span>, <span class="hljs-string"><span class="hljs-string">"maxStreams"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">"maxWidth"</span></span>: <span class="hljs-number"><span class="hljs-number">640</span></span>, <span class="hljs-string"><span class="hljs-string">"maxHeight"</span></span>: <span class="hljs-number"><span class="hljs-number">480</span></span>, <span class="hljs-string"><span class="hljs-string">"maxFPS"</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span> } } ]</code> </pre> <br></div></div><br>  De plus, une image de l'appareil photo appara√Æt dans l'application HomeKit, mais tout cela a fonctionn√© tr√®s lentement et il n'y avait pas besoin de cet appareil photo.  Pour √©viter de charger inutilement le syst√®me, j'ai supprim√© la cam√©ra ip.  Revenons √† l'installation d'un syst√®me de gestion ¬´sans maison intelligente¬ª. <br><br><h3>  Installer et configurer Domoticz pour les modules Sonoff </h3><br>  Putty ‚Üí ssh ‚Üí et encore on cueille la framboise.  √âtonnamment, l'installation dans mon cas n'a pas n√©cessit√© de danser avec un tambourin et c'√©tait suffisant <br><br><pre> <code class="bash hljs">sudo curl -L install.domoticz.com | sudo bash</code> </pre><br>  Ajouter un d√©marrage automatique: <br><br><pre> <code class="bash hljs">sudo cp domoticz.sh /etc/init.d sudo chmod +x /etc/init.d/domoticz.sh sudo update-rc.d domoticz.sh defaults</code> </pre><br>  Si n√©cessaire, modifiez certains param√®tres: <br><br><pre> <code class="bash hljs">sudo nano /etc/init.d/domoticz.sh</code> </pre> <br>  Ouvrez l'adresse des framboises <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">192.168.xxx.xxx</a> : 8080.  Et ils devraient aller sur la page domotique.  De plus, la configuration et l'ajout de capteurs ont d√©j√† lieu via le Web. <br><br><img src="https://habrastorage.org/web/130/93c/ab8/13093cab88b54ac498fbd15d17d4536a.png"><br>  <i>Des capteurs Sonoff et un capteur de rue ont d√©j√† √©t√© ajout√©s √† la capture d'√©cran.</i> <br><br>  Pour ajouter des capteurs / commutateurs, acc√©dez √† Configuration ‚Üí mat√©riel et ajoutez Dummy (ne fait rien, utilisez uniquement les commutateurs virtuels).  Notre ¬´mannequin¬ª appara√Ætra dans la liste des appareils.  En cliquant dessus sur Cr√©er un capteur virtuel, appelez notre capteur / commutateur et s√©lectionnez le type requis dans la liste.  Maintenant, dans l'onglet Configuration ‚Üí P√©riph√©riques, un nouveau p√©riph√©rique appara√Ætra et vous pouvez maintenant y voir l'idx du p√©riph√©rique. <br><br>  Nous d√©chirons la face Web de notre commutateur / capteur et enregistrons la configuration ‚Üí domoticz ‚Üí idx de notre commutateur.  Dans le nouveau firmware Tasmota, il est possible de sp√©cifier plusieurs idx.  Pour relais / interrupteurs et s√©par√©ment pour GPIO.  Selon le module, il peut s'agir d'un capteur suppl√©mentaire ou plus, car dans la version SV, il y a en plus trois broches qui peuvent √™tre affect√©es √† leur r√¥le dans votre syst√®me (relais / capteurs). <br><br>  Dans l'ancien firmware (Sonoff-MQTT-OTA-Arduino) pour le module, je devais effectuer quelques danses avec un tambourin, afin que Domoticz puisse voir les lectures d'humidit√© et de temp√©rature.  Je pense qu'il ne sert √† rien de le d√©crire ici, pour le nouveau firmware (Tasmota) il n'est pas n√©cessaire. <br><br>  Selon les lectures d'humidit√©, vous pouvez contr√¥ler la hotte dans la salle de bain.  Lorsqu'il y a un ventilateur d'extraction, il y a suffisamment d'espace pour le module et nous avons d√©j√† tout ce dont nous avons besoin.  Il ne reste plus qu'√† ajuster le contr√¥le des lectures d'humidit√©. <br><br>  Configuration ‚Üí Plus d'options ‚Üí √âv√©nements <br><br><img src="https://habrastorage.org/web/6ec/865/203/6ec865203b894f579e3fb3c1f0d62261.png"><br><br>  En utilisant le constructeur, nous cr√©ons la logique de fonctionnement du capot (comme dans l'image).  Vous pouvez toujours sur Lua, mais ce n'est pas mon cas.  Une exp√©rience suppl√©mentaire a montr√© que 5 minutes d'interrogation du capteur sont trop grandes et je l'ai r√©duit √† 3 minutes.  Maintenant, sous la douche, lorsque l'humidit√© d√©passe 70%, la hotte se met en marche.  Par la suite, lorsqu'il est r√©duit en dessous de 45%, il s'√©teint.  Donn√©es d'humidit√© s√©lectionn√©es exp√©rimentalement.  Le seul point n√©gatif, ou ce n'est peut-√™tre pas un inconv√©nient, mais une caract√©ristique du syst√®me, si vous forcez la hotte √† √™tre allum√©e en appuyant sur un bouton, puis apr√®s 3 minutes, apr√®s avoir interrog√© le capteur d'humidit√©, le syst√®me s'√©teindra. <br><br>  Mais qu'en est-il de Siri?  Il s'est av√©r√© que tout est tr√®s simple. <br><br><pre> <code class="bash hljs">sudo npm install -g -g --unsafe-perm homebridge-edomoticz</code> </pre><br>  Et ajouter aux param√®tres <br><br><pre> <code class="bash hljs">sudo nano .homebridge/config.json</code> </pre><br><pre> <code class="hljs objectivec"> <span class="hljs-string"><span class="hljs-string">"platform"</span></span>: <span class="hljs-string"><span class="hljs-string">"mqtt"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"mqtt"</span></span>, <span class="hljs-string"><span class="hljs-string">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"mqtt://127.0.0.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"topic_prefix"</span></span>: <span class="hljs-string"><span class="hljs-string">"homebridge"</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span>: <span class="hljs-string"><span class="hljs-string">"foo"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span></code> </pre><br>  Et lorsque vous d√©marrez Homebridge, nous obtenons <br><br><pre> <code class="bash hljs">[5/8/2017, 11:42:30 PM] [eDomoticz] You have 10 devices defined <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Domoticz. [5/8/2017, 11:42:30 PM] [eDomoticz] Initializing platform accessory <span class="hljs-string"><span class="hljs-string">'bath-temp'</span></span>... [5/8/2017, 11:42:30 PM] [eDomoticz] Initializing platform accessory <span class="hljs-string"><span class="hljs-string">' '</span></span>... [5/8/2017, 11:42:30 PM] [eDomoticz] Initializing platform accessory <span class="hljs-string"><span class="hljs-string">' '</span></span>... [5/8/2017, 11:42:30 PM] [eDomoticz] Initializing platform accessory <span class="hljs-string"><span class="hljs-string">''</span></span>...</code> </pre><br>  Tous les appareils que nous avons ajout√©s √† Domotics seront d√©sormais affich√©s parmi nos appareils dans Homekit et vous pouvez les contr√¥ler via un ami Siri.  Le besoin d'autres plugins pour Homebridge a en quelque sorte disparu. <br><br>  Nous avons un tas de Domoticz-Homebridge et tout fonctionne tr√®s bien et de mani√®re stable.  D√©j√† test√© pas le premier mois. <br><br>  Un capteur de temp√©rature / humidit√© DHT22 d'anciens m√©tiers est fix√© au Raspberry pi et les donn√©es sont transmises √† narodmon.ru avec un script python toutes les 10 minutes.  Ajoutez quelques lignes √† un script existant. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#domoticz settings IP = '192.168..' #IP domoticz PORT = '8080' #port of server IDX_1 = '7' #IDX of the DHT temp sensor //‚Ä¶. ,        narodmon.ru url = 'http://{}:{}/json.htm?type=command¬∂m=udevice&amp;nvalue=0&amp;idx={}&amp;svalue={}'.format(IP, PORT, IDX_1, sensor_value_1) request = urllib2.Request(url) response = urllib2.urlopen(request)</span></span></code> </pre><br>  Dans Domoticz, nous ajoutons un capteur virtuel suppl√©mentaire.  Et maintenant, nous pouvons √©galement voir la temp√©rature et l'humidit√© dans la rue, √† la fois sur le Web sur notre page de maison locale et dans l'application iOS. <br><br>  √Ä qui mqtt est plus proche, les lectures du capteur pourraient √™tre envoy√©es via mqtt. <br><br><pre> <code class="python hljs"> playload = <span class="hljs-string"><span class="hljs-string">'{{ "idx": {} , "nvalue" : {}, "svalue" : "1" }}'</span></span>.format(IDX_1, humidity) client.publish(TOPIC_DOMOTICZ, playload, qos =<span class="hljs-number"><span class="hljs-number">0</span></span> , retain =<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) <span class="hljs-comment"><span class="hljs-comment">#publish</span></span></code> </pre><br><h2>  Ajoutez le Wifi √† la machine √† caf√©. </h2><br>  Pendant que ma machine est en r√©paration et attend que l'unit√© de commande arrive d'Allemagne, j'ai re√ßu une machine √† caf√© Delonghi en cadeau.  Sur le panneau, nous avons un bouton marche / arr√™t, pour faire un petit caf√© double et deux autres que je n'utilise pas car  Je ne fouette pas le lait avec de la vapeur, je ne bois pas de latte et autres boissons.  L'inconv√©nient est que le caf√© ne se moud pas lui-m√™me, il faut le remplir de moulu et d'une tasse. <br><br>  Pour une machine √† caf√©, j'utilise Sonoff SV.  Les broches 3,3v, Rx, Tx, GND sont sign√©es.  S√©par√©ment, le GPIO 4, 5, 14 est toujours affich√© sur la carte Micrologiciel pour la m√™me proc√©dure que celle d√©crite ci-dessus. <br><br>  Nous ouvrons l'appareil et arrivons au tableau avec des boutons. <br><br>  La carte a une alimentation de 5 V, ce qui est suffisant pour alimenter notre module sans fil sonoff sv.  Il n'a pas √©t√© difficile de trouver o√π nous avions le 5c ch√©ri. <br><br>  Appuyer sur les boutons court-circuite simplement le signal √† la masse.  Nous connectons notre module selon le sch√©ma. <br><br><img src="https://habrastorage.org/web/a3c/559/ba5/a3c559ba5c1f48d6b552aaddaa448209.png"><br><br>  Comme vous pouvez le voir sur le sch√©ma, je n'ai connect√© que deux boutons: on / off et faire du caf√©.  Par analogie, vous pourriez cr√©er tous les autres boutons.  Sur sonoff sv, nous avons une sortie 3 broches vers la carte, un relais, et vous pouvez √©galement utiliser Rx, Tx (dans le dernier firmware Tasmota). <br><br><img src="https://habrastorage.org/web/a62/efb/5b0/a62efb5b0ea54284b0406b4f16595145.png"><br><br>  Nous collectons tout selon le sch√©ma, nous trouvons un endroit appropri√© √† l'int√©rieur de la machine √† caf√©.  Dans les param√®tres du module de l'interface Web, ajoutez un deuxi√®me relais √† GPIO5.  Dans le menu "console" d√©finissez les param√®tres suivants: <br><br><pre> <code class="hljs ruby">PowerOnState <span class="hljs-number"><span class="hljs-number">0</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">/   ,     . PulseTime1 10 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   0,1 ,      PulseTime2 10 /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     1 . 1  2     .</span></span></code> </pre> <br>  Dans les param√®tres Domotics, cr√©ez deux autres ¬´capteurs virtuels¬ª et ajoutez leur idx aux param√®tres du module dans le menu des param√®tres Domotics (Configuration ‚Üí Configurer Domoticz ‚Üí IDX 1 et IDX 2). <br><br>  En cons√©quence, nous obtenons deux autres commutateurs, dont l'un appuie sur le bouton marche / arr√™t de la machine √† caf√© et le second appuie sur le bouton de pr√©paration du caf√©. <br><br>  Pour faire du caf√©, de toute fa√ßon, vous devez marcher avec vos jambes, mais vous devez verser du caf√©.  Mais allumer la machine est pratique.  √Ä partir du moment o√π vous l'allumez et avant de faire du caf√©, vous avez besoin de temps pour r√©chauffer la machine.  Par cons√©quent, assis en travaillant dans la pi√®ce, vous pouvez allumer la machine √† caf√© √† distance et apr√®s un certain temps d√©j√† pi√©tiner vos jambes et vous faire un verre. <br><br>  Il sera plus utile dans un tel interrupteur sur une machine enti√®rement automatique dans une machine √† caf√©, il suffit de penser √† mettre la tasse √† l'avance.  Nous attendons le tableau de contr√¥le. <br><br><h2>  Ajouter le wifi pour ouvrir la porte avec l'interphone Vizit </h2><br>  Dans le couloir commun, le vestibule pr√®s de l'ascenseur est ferm√© par une porte avec une serrure magn√©tique et un syst√®me d'acc√®s Vizit.  Le syst√®me a √©t√© install√© apr√®s la r√©paration et le bouton pour ouvrir la porte du vestibule de l'appartement n'a pas √©t√© maintenu.  Pour d√©marrer les invit√©s, vous devez aller √† la porte et ouvrir avec le bouton pour ouvrir la porte dans le couloir.  Unit√© de contr√¥le KTM-602M. <br><br><img src="https://habrastorage.org/web/771/ea1/9ab/771ea19abd1144e4b95e39f8ffbe2c73.jpg"><br><br>  La fermeture de OP + GND ouvre la porte / d√©connecte l'aimant pendant 7 secondes. <br><br>  Nous partageons l'alimentation du module sonoff sv et du relais en retirant deux r√©sistances, comme indiqu√© ci-dessous dans l'image. <br><br><img src="https://habrastorage.org/web/c31/85f/644/c3185f6440db4066bf6cf3fd1336d4af.png"><br><br>  On connecte OP √† l'entr√©e relais "entr√©e +", √† la sortie du relais "sortie +" on fixe GND.  Entre l'ELC et le GND de l'unit√© de contr√¥le 18v √† partir de laquelle nous alimentons le module lui-m√™me. <br><br>  Nous ajoutons la sonnette de porte ¬´cloche de porte¬ª aux Domotiks et maintenant Siri peut nous aider √† ouvrir les portes pour les invit√©s. <br><br>  L'assistant Siri reconna√Æt la commande vocale "Ouvrir la porte", mieux que "allumer la machine √† caf√©". <br><br>  Je me suis arr√™t√© l√† avec la d√©coration des modules sonoff. <br><br><h2>  Petit bonus </h2><br>  Une fois qu'un tel alcool aura disparu, nous mettrons √©galement le t√©l√©viseur sous / hors tension.  √âteindre et allumer le t√©l√©viseur n'a rien √† voir avec les modules wifi.  Le t√©l√©viseur est √† proximit√© de Raspberry Pi.  Ici, une LED IR et une paire de r√©sistances de diff√©rentes valeurs nominales nous aident.  Nous installons lirc, l√†, dans les bases de donn√©es, nous trouvons les param√®tres de votre t√©l√©commande / TV. <br><br>  Pour travailler avec Domotics, nous ex√©cutons un petit script python qui traduit nos souhaits d'allumer / √©teindre le t√©l√©viseur de mqtt √† lirc. <br><br><div class="spoiler">  <b class="spoiler_title">mqtt dans lirc</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> paho.mqtt.client <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> mqtt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json IP = <span class="hljs-string"><span class="hljs-string">'192.168..'</span></span> PORT = <span class="hljs-string"><span class="hljs-string">'1883'</span></span> device = {<span class="hljs-number"><span class="hljs-number">18</span></span> : <span class="hljs-string"><span class="hljs-string">'OpenBox'</span></span>, <span class="hljs-number"><span class="hljs-number">19</span></span> : <span class="hljs-string"><span class="hljs-string">'PHILIPS'</span></span>, <span class="hljs-number"><span class="hljs-number">22</span></span> : <span class="hljs-string"><span class="hljs-string">'air'</span></span>} TOPIC_DOMOTICZ = <span class="hljs-string"><span class="hljs-string">'domoticz/in'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(device, command)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># """ Sends IR-signal to the device """ os.system("irsend SEND_ONCE '" + device + "' '" + command + "'") # The callback for when the client receives a CONNACK response from the server. def on_connect(client, userdata, flags, rc): print("Connected with result code "+str(rc)) # Subscribing in on_connect() means that if we lose the connection and # reconnect then subscriptions will be renewed. client.subscribe(TOPIC_DOMOTICZ,0) def on_publish(client,userdata,result): #create function for callback print("data published \n") pass # The callback for when a PUBLISH message is received from the server. def on_message(client, userdata, msg): domoticz = json.loads(msg.payload) if domoticz ['idx'] in device.keys(): idx = domoticz ['idx'] dev = device [idx] command = 'KEY_POWER' send (dev, command) client = mqtt.Client() client.on_connect = on_connect client.on_message = on_message client.on_publish = on_publish client.connect(IP, PORT, 60) client.loop_forever()</span></span></code> </pre> <br></div></div><br>  Nous ajoutons √† Domoticz trois autres boutons virtuels pour le t√©l√©viseur, le r√©cepteur et le climatiseur. <br>  Ce n'est pas pratique de contr√¥ler le t√©l√©viseur √† partir du t√©l√©phone, de toute fa√ßon la t√©l√©commande est en quelque sorte apparent√©e.  Mais √©teignez la t√©l√© quand j'ai oubli√© et d√©j√† quitt√© la chambre un joli bonus. <br><br>  Un bon ajout √† tout cela est la disponibilit√© de la montre Pebble de l'application Pemoticz.  Ajout de l'adresse dans les param√®tres et l'application a tir√© tous les commutateurs.  Aucun Siri ne peut d√©sormais allumer la machine √† caf√© / ouvrir les portes et √©teindre les lumi√®res.  La montre est g√©n√©ralement √† port√©e de main et le t√©l√©phone peut ne pas √™tre √† proximit√©.  Cela a aussi ses avantages.  Je n'ai pas abord√© le sujet de la reconnaissance vocale pendant des heures √† les flasher, mais c'est √©galement possible. <br><br><img src="https://habrastorage.org/web/651/e3d/d81/651e3dd81b654be3b0fc324f44dc8b9e.png"><br><br>  Sur ce, peut-√™tre, vous pouvez terminer l'histoire "sans maison intelligente". <br><br><h2>  Conclusion </h2><br>  Sous forme de conclusion, et puis quoi? <br><br>  Liste de Todo: <br><br>  - Climatisation, il n'a pas √©t√© possible de trouver les r√©glages de la t√©l√©commande pour lirc et les premi√®res tentatives de copie de clics, n'ont pas non plus abouti.  Scier plus loin. <br>  - Nous attendons une commande de la soci√©t√© chinoise Mi c gateway et plusieurs capteurs.  Les capteurs d'ouverture de porte au moyen de manipulations d√©licates se transforment en capteurs de fuite.  Nous ajouterons √† notre syst√®me.  Lorsque les capteurs d√©clench√©s enverront des notifications au propri√©taire. <br>  "Les pens√©es s'arr√™tent l√† ..." <br><br><h3>  Sources utilis√©es </h3><br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Ex√©cution de HomeBridge sur un Raspberry Pi</a> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Wiki Sonoff-Tasmota</a> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Installation de Domoticz sur un Pi d√©j√† en cours d'ex√©cution</a> <br>  ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment: ajouter le WiFi √† votre machine √† caf√©</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr403869/">https://habr.com/ru/post/fr403869/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr403855/index.html">Apr√®s 11500 accidents, un quadricopt√®re IA a appris √† voler √† l'int√©rieur</a></li>
<li><a href="../fr403857/index.html">Oticon a introduit une technologie de conduction osseuse non implantable pour les enfants</a></li>
<li><a href="../fr403861/index.html">Quelque chose ne va pas avec Masterhost</a></li>
<li><a href="../fr403865/index.html">Ampoules LED Auchan</a></li>
<li><a href="../fr403867/index.html">Libert√© d'information</a></li>
<li><a href="../fr403871/index.html">BBC Micro - l'ordinateur qui a battu le ZX Spectrum</a></li>
<li><a href="../fr403873/index.html">Batterie solaire sur le balcon: test de batterie et BMS</a></li>
<li><a href="../fr403875/index.html">Les montres intelligentes et les r√©seaux de neurones d√©tectent la fibrillation auriculaire avec une pr√©cision de 97%</a></li>
<li><a href="../fr403877/index.html">La fus√©e ultra-lourde de la NASA augmentera ses prix d'au moins 500 millions de dollars et son lancement sera report√© d'une autre ann√©e</a></li>
<li><a href="../fr403881/index.html">La fus√©e la plus merveilleuse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>