<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍❤️‍👨 🏟️ 😲 Play商店现在接受渐进式Web应用程序（PWA） 💙 ⛓️ 🚳</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="免责声明：我不隶属于Google Play，Chrome或任何提及的公司。 这不是官方声明。 徽标和名称仅用于说明目的。 

 适用于Android的Chrome 72具有期待已久的Trusted Web Activity功能。 这意味着现在我们可以通过Google Play目录分发PWA，并可以在...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Play商店现在接受渐进式Web应用程序（PWA）</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439238/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/abc/fb9/445/abcfb9445e58d62d216cdf938abaffca.png"></div><br>  <sup>免责声明：我不隶属于Google Play，Chrome或任何提及的公司。</sup>  <sup>这不是官方声明。</sup>  <sup>徽标和名称仅用于说明目的。</sup> <br><br> 适用于Android的Chrome 72具有期待已久的Trusted Web Activity功能。 这意味着现在我们可以通过Google Play目录分发PWA，并可以在没有脱机用户界面的情况下运行Chrome来使用本机软件包！ 我花了一段时间研究此功能，并深入研究了API，但在这里我将告诉您它的含义，预期功能以及当前可用的功能。 <br><a name="habracut"></a><br><h1>  Play商店目录中的PWA </h1><br> 现在，所有用户都可以使用适用于Android的Chrome 72，并且在此版本中实现了受信任的网络活动（TWA）。 简而言之，Chrome是针对本机Android程序包离线（没有工具栏和UI）启动的。 <br><br> 首先，在目录中发布不是应该的那么简单的过程（例如，在Google Play上输入URL-应用程序将启动）。 此外，您无法使用可用的WebAPK并将应用程序发布在目录中。 它使用Java API，该Java API通过服务与Chrome交互，并且似乎处于开发的早期阶段。 因此，有很多手动操作。 <br><br> 我认为这是第一步。 当然，最好的工具包将很快出现（可能来自社区），其中包含对所有可用API的支持和一键启动。 但是，在当前API上，您可以将其发布在PWA启动器目录中。 我将分享我的经验。 <br><br> 由于某些原因，此功能尚未出现在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Chrome平台状态中</a> ，并且该文档尚未更新（超过15个月没有更新）。 <br><br>  <b>2月5日更新</b> 。  Chromium博客发布了有关TWA支持以及本文中提到的一些技术细节的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">简短说明</a> 。 <br><br>  <b>2月1日更新</b> 。  Google的首席Chrome开发人员Paul Kinlan已<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">确认</a> TWA功能<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">的</a>发布，并且该文档已被延迟：延迟的原因是，新的Chrome 72功能的许可已在最后一刻接受。 <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/TCgT8dzSiU8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i><font color="gray">来自Pete Le Page的长达一年的视频解释了TWA</font></i> <br><br><h3> 为什么要在目录中发布PWA？ </h3><br>  Karl，这是一个网络平台！ 为什么要使用目录？ <br><br> 嗯，这是一段漫长的对话，但是多年来我一直为大型和小型企业提供咨询服务，当我们考虑PWA的发展时，经常会提及应用程序目录：“我们的用户将在这里寻找应用程序”，“我们已经拥有了自己的应用程序，并且我们不想输用户，“”我们需要访问自己的API，或者“我想通过PWA获利。” <br><br> 从现在开始，可以在目录中发布PWA，也可以通过浏览器进行工作。 当然，这是一个单独的操作。  Play商店不会模仿Microsoft商店：您的PWA不会出现在商店中，除非您编译并发布APK。 <br><br><h3> 与标准PWA相比的优势 </h3><br> 除了新的分发机制和目录中的新用户（甚至包括“应用程序”部分中的Google搜索）之外，其他优点还包括： <br><br><ul><li> 可以将小部件放置在主屏幕上。 <br></li><li> 应用程序快捷方式（长按应用程序图标）以及与操作系统的其他深度集成。 <br></li><li> 在可穿戴设备或Android Auto扩展程序上使用“伴侣”。 <br></li><li> 硬重置或在新手机上备份后重新安装。 <br></li><li> 可以访问其自身功能的后台服务（与PWA的通信仍然受到限制-下文提供更多详细信息）。 <br></li><li> 营利（目前为止，下面有更多详细信息）。 <br></li><li> 一些本机屏幕上混有PWA内容。 <br></li><li> 在启动器和/或主屏幕上分发多个PWA图标，指向不同的URL（在同一主机内）。 <br></li><li> 更好的国际化支持。 </li></ul><br><h3> 什么是创新？ </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/06c/a7c/a1d/06ca7ca1d01be0f5174e371c774c6360.png"><br>  <i><font color="gray">目录中已经有一些PWA，但是现在它们更容易准备和发布。</font></i> <br><br>  Google Play商店中已经有一些PWA，例如Google Maps Go，Instagram Lite和Twitter Lite。 第一个应用程序使用某些私有版本的预TWA，后两个应用程序使用WebView，这不是理想的选择，但是是在TWA之前执行类似操作的唯一方法。 应用程序在某些事情上有很多本机代码，例如通知。 我们想以Web开发人员的身份发布PWA，也不想编写很多Java代码。 <br><br>  TWA是基于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">自定义Chrome选项卡</a>的特殊模式，从Chrome 45版本开始，该模式允许您启动应用程序内置的浏览器。 <br><br><h3>  TWA是类似于Cordova的混合框架吗？ </h3><br> 不行 使用Cordova和其他混合解决方案，通常可以提供资源（HTML，JS，CSS等）。 在APK包中。  <b>此外，引擎与此处不同，它与用户的浏览器隔离，因此它不支持会话或缓存共享。</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8c8/1a6/feb/8c81a6feb0b4e06520eac4d39ace8f66.png"></div><br>  <i><font color="gray">这是Trusted Web Activity的PWA外观。</font></i>  <i><font color="gray">我看不到配色方案的实现</font></i> <br><br> 使用“受信任的网络活动”，您无需打包资源文件（如果需要，仅打包本机组件）； 所有资源都通过服务工作者即时下载和更新。 您的PWA始终由已安装的Chrome版本及其存储，缓存和会话呈现。 因此，如果用户在网站上打开会话，然后从Play商店安装该应用程序，则该用户将已经登录到系统。 <br><br><h3>  Play商店要求 </h3><br> 用于受信任的Web操作的URL必须满足以下要求： <br><br><ul><li>  PWA标准传输（HTTPS，具有获取事件处理程序的服务工作者，带有512px图标的Web应用程序清单，background_color和其他基本属性集）。 <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Lighthouse的</a>最低性能为80/100（在Chrome开发者工具中或作为NPM CLI提供）。 <br></li><li> 所有当前的Play商店规则。 </li></ul><br> 根据<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Chromium博客文章</a> ，“不符合TWA质量要求或Play商店<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">政策的应用</a>可能会被拒绝进入或被排除。” <br><br> 我不确定Play商店质量检查小组在发布应用程序时会检查所有这些要求。 <br><br><h3>  Play商店上的PWA安全模型 </h3><br> 在将本机代码直接添加到APK之前，您的PWA将遵循浏览器安全模型，而不是本机应用程序。 由于所有内容都在浏览器的控制之下，因此用户必须知道，即使他只是安装了该应用程序，他也将在浏览器中为该主机设置会话数据，本地存储和权限。 因此，当您初次启动时，会向他们<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">显示一条微型消息“在Chrome中运行”</a> ： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5ff/8d9/1df/5ff8d91df535b119b0da91c92aca2a2b.jpg"><br><br> 此外，当用户卸载应用程序时，他将收到一条<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">警告</a> ，指出该应用程序的状态和数据在Chrome中仍然可用，因此，如有必要，请清除缓存。 在这些跟踪中，例如Web推送权限：即使用户卸载了该应用程序，他仍将继续接收推送通知。 消息被亨利·林注意到： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/547/90a/3bc/54790a3bceb7834fd83b7301866f118e.jpg"><br><br>  Chrome小组的Paul Kinlan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">告知</a>需要此类通知。 <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1092075825065873416"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><h1> 开发方法 </h1><br> 要使用TWA创建软件包，首先需要<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Android Studio</a> 。 到目前为止，所有选项都是实验性的，仅通过GitHub上的Chrome存储库中的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">代码示例</a>进行描述。 <br><br>  TWA的应用程序开发选项： <br><br><ul><li>  <b>使用</b> Chrome小组<b>的高级Java支持库</b> ：在这种情况下，您无需编写自己的Java或Kotlin代码。 创建一个Android Studio项目（或克隆一个示例），从Web应用程序清单中的AndroidManifest.xml中配置一些元数据-完成。 <br><br> 该框架将提供与TWA的连接以及用于在Android设备中创建“设置”记录的其他功能，以及提供推送通知。 现在，该库位于临时的Jitpack存储库中。 我认为将来她会搬到另一个地方。 <br></li><li>  <b>手动管理受信任的Web活动</b> 。 如果您有使用Java或Kotlin开发Android应用程序的经验，则只需手动连接PWA。 因此，您可以保留一些本机操作，仅在正确的时间打开“受信任的Web活动”。 在这种情况下，我建议研究<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">支持库，</a>并了解如何从项目连接到Chrome。 </li></ul><br>  <b>2月5日更新</b> ：TWA <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">帮助程序TrustedWebUtils的</a>文档现已在Android网站上提供。 <br><br><h3> 清单分配 </h3><br>  App Store上的PWA将不接受Web应用程序的清单； 您必须手动复制一些值。 图标是从“ res”文件夹中获取的，就像在任何本机Android应用程序中一样，方向屏蔽应在AndroidManifest活动记录中定义，等等。 <br><br> 使用支持库时，会自动创建启动画面，但不会使用清单的其他属性。 实际上，在测试中，当PWA在屏幕上打开时，我无法应用颜色主题。 <br><br><h3>  URL验证 </h3><br>  TWA仅在与应用程序进行数字域握手之后才能工作。 该机制称为“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">数字资产链接”</a> 。 它在您的主机和APK之间建立了信任关系，证明您拥有PWA，并且不会在您不拥有的Play商店中发布应用程序。 它还在站点和本机应用程序之间建立了一个数字通道，从理论上讲，它可以允许他们交换私有数据（但是今天的TWA API似乎无法实现）。 <br><br> 使用Digital Assets Links，您必须在<i>您的域</i>上载文件<i>&lt;your-domain&gt; /.well-known/assetlinks.json</i> 。 此JSON文件包含有关Android程序包的信息（例如，程序包标识符）和应用程序证书的哈希，您可以在控制台中的命令中找到这些信息。  Android软件包的主机URL上会有一个双精度。 有一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在线验证器，</a>以验证是否一切正常。 <br><br> 如果您尚未握手，则TWA将不会激活，并且您的应用程序将仅使用带有最小Chrome界面的常规Chrome自定义标签，就像<i>显示：</i> PWA中包含<i>minimal-ui</i> 。 我不太确定，但Play商店可能会拒绝未经TWA验证而仅指向常规标签的应用程序。 我不知道Chrome在什么时候执行数字资产链接验证； 如果每次访问该应用程序，它都可能成为性能问题。 我认为缓存是可行的，并且Play商店可以在批准应用程序进入目录之前对其进行检查。 让我们看看文档中将写些什么。 <br><br>  <b>有一种（不是那么简单）的机制可以绕开出于开发目的的数字资产链接认证过程，如下所述。</b> <br><br><h1> 发布申请 </h1><br> 要使用TWA发布PWA标签，您必须遵守Play商店的所有规则。 有关更多信息，请参见<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">开发者政策中心</a> 。 您还需要创建一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">发布者帐户</a> ，该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">帐户</a>的一次性费用为25美元，该应用程序的元数据，屏幕截图和营销材料。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab9/348/32a/ab934832ad79351548be8cd22bfb9026.png"><br><br><h3> 部署 </h3><br> 在Android Studio中完成开发并拥有开发者控制台帐户后，您需要创建一个APK用于生产并使用在Android Studio中创建的密钥对其进行签名。 您可以参考<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Google Play</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">应用签名服务，</a>以简化以后的流程。 <br><br><h3>  Google Play控制台 </h3><br> 没有下载这些应用程序的特定规则或过程，但是修订部门可以检测到您正在使用TWA并验证：1）Digital Assets Link是否正在工作；  2）URL通过了PWA标准（主要用于服务工作者中的获取事件处理程序）。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/365/83a/921/36583a921bd38dda3ce6af9b5103bb0f.png"><br>  <i><font color="gray">要在Play商店上发布，您必须指定很多元数据和图形资源。</font></i> <br><br><h3> 申请更新 </h3><br> 如果更改内容，则无需再次下载应用程序，除非您完全更改了应用程序（根据目录规则）。 继续通过服务工作者更新它并在服务器上更新。 仅当您要更改元数据，本机代码或图标时，才需要下载新的APK。 <br><br><h1> 局限性 </h1><br> 现在该平台具有一定的局限性，但这仅仅是开始。 希望它们会随着时间的流逝而删除。 <br><br><h3> 子文件夹中的PWA </h3><br> 如果您在主机子文件夹中发布PWA，则存在几个问题。 <br><br><ul><li>  Digital Asset Link连接整个域，而不仅仅是文件夹。 <br></li><li> 即使PWA在子文件夹中，当前的支持库似乎也可以将整个主机作为Intent（链接捕获）来处理。 </li></ul><br><h3> 没有内部应用 </h3><br> 这是Play商店本身的限制（您不能发布用于本地网络的应用程序或仅用于您和您的公司的应用程序）。 您可以使用TWA并创建将在商店外部部署的apk。 <br><br>  Digital Asset Link仅适用于公共URL，因为Chrome需要验证我们是否拥有该域，而内部URL则无法实现。 <br><br><h3> 第一次启动 </h3><br> 首次打开最近安装的应用程序时，设备上还没有应用程序文件（如果用户之前未打开PWA，则尚未注册Service Worker），因此在脱机模式下，用户将看到空白的白屏。 我认为在以后的版本中，安装应用程序后通过Chrome进行某种交换会很有用。 如果您使用TWA API而不是支持库，则会发现这种情况并通过本机API正确通知用户。 <br><br><h3> 调用本机代码 </h3><br>  TWA服务器（Chrome）和TWA客户端（我们的APK）之间已经存在双向通道。 该通道当前仅用于发送推送通知，并在本机应用程序中显示它们，而不在Chrome中显示。 <br><br> 可以简单地连接本机代码和JavaScript，使PWA可以访问本机代码，这类似于Microsoft Store中的APPX / PWA机制。 <br><br> 也许将来可能会在TWA客户端中注册Java / Kotlin类，以便在TWA模式下渲染PWA时，我们实际上可以使用JavaScript API调用它们。 <br><br> 今天，执行本地代码的唯一方法是使用Intents打开其他本地操作，然后重新打开TWA，通过URI参数发送和接收参数。 <br><br> 另外，您可以用本机代码创建某种Web服务器或WebSocket服务器并将PWA发送给它，但这很奇怪，复杂，并且可能会消耗大量电池。 但是，我们拥有一个全新的机遇世界。 让我们看看社区的想法！ <br><br><h3> 从Play商店获利 </h3><br> 如果您有付费应用程序，那么您将无法轻松地验证用户是否确实为它付费（毕竟，内容仅仅是一个URL）。 此外，如果您想使用Play商店钱包出售任何数字资源或订阅内容，那么在没有与本机代码的实际桥梁的情况下很难实施这种方案。 <br><br><h3> 侦错 </h3><br> 我不确定这是我的IDE的错误还是某种问题，但是无法通过TWA对服务工作者进行远程调试。 我可以检查窗口上下文，但不能检查服务工人。 <br><br><h3> 其他引擎 </h3><br>  TWA当前仅在Chrome上运行，但是将来，其他浏览器可能会克隆该API：例如Samsung Internet，Edge或Firefox。 <br><br>  <b>2月4日更新</b> ：TWA在其他浏览器当前正在实现的Android Custom Tab协议上运行。 因此，如果系统上安装了另一个默认浏览器，则可以使用PWA的内容打开TWA。 但是，需要其他测试才能了解其工作原理。 <br><br> 如果用户使用的是旧版的Chrome，并从Play商店安装该应用程序，该怎么办？ 在这种情况下，PWA将显示为自定义Chrome选项卡，而不是处于完全脱机模式。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7c6/a0e/7e4/7c6a0e7e4cfb1be1f72cd71a30a45b7c.png"><br>  <i><font color="gray">Play商店上的Google Maps Go已经使用了与TWA类似的功能，并且将Chrome列为工作的前提条件</font></i> <br><br> 如果用户根本没有安装Chrome，该怎么办？ 迄今为止，使用支持库时，该应用程序将完全无法运行（如果没有其他支持“自定义标签”协议的浏览器）。 如果您在本机Java / Kotlin代码中使用TWA API，则可以检查浏览器的可用性并下载其他解决方案，例如WebView，或打开浏览器。 <br><br> 尽管没有Chrome的Android设备很少见，但在某些<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">设备上</a>默认未安装，包括<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">欧洲的所有新设备</a> 。 <br><br><h3> 其他平台 </h3><br>  PWA在可穿戴操作系统（时钟）上不起作用，但是我不确定其他Android平台上正在发生什么。 可能尚无支持，但请检查一下。 我说的是Play商店中的Android TV或Chromebook。 如果您尚未测试这些平台，则可以在目录列表中禁用它们。 <br><br><h3> 与WebAPK冲突 </h3><br> 如果您是从Chrome安装的PWA，则您已经有一个由Play商店签名的用于该URL的APK，但是该目录仍会将应用程序保留在列表中，并且允许用户也进行安装。 反之亦然：从目录安装应用程序不会阻止Chrome提示用户从浏览器“添加”它。 我认为，如果WebAPK也收到数字资产链接，或者我们可以以某种方式匹配WebAPK应用程序标识符，则可以避免这种情况，但这不太可能在不久的将来发生。 让我们看看。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9c1/1fe/3a2/9c11fe3a28681544babba34025589479.png"></div><br>  <i><font color="gray">两个同时运行的星巴克应用程序：WebAPK和我们自己的APK</font></i> <br><br> 您可以阻止Chrome提供的安装WebAPK的提议，而可以使用Web应用程序清单的<i>related_applications</i>属性和<i>preferred_related_applications</i>属性从目录中显示您的应用程序。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">获取安装的相关Apps API</a>可能会在将来帮助解决此冲突。 <br><br><h1> 创建第一个PWApk </h1><br> 我知道我刚刚发明了PWApk一词，但这听起来不错，对吗？ <br><br> 几年前，我<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在本地Android Web应用程序上</a>做了一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">视频课程</a> 。 尽管PWA并非完全如此，但它有助于理解Android生态系统。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/737/af5/77f/737af577f5decf195a80d62670f783f2.png"></div><br>  <i><font color="gray">制作基于TWA的APK的最简单方法是从GitHub上的ChromeLabs存储库中克隆SVGOMG存储库示例</font></i> <br><br> 您可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">克隆git存储库</a>或开始一个新项目。 在我们的案例中，我们只是为了更好地理解该主题而启动了一个新项目。 <br><br> 在Android Studio中创建一个新项目，然后选择<i>无活动</i> ：我们将仅使用支持库中的“受信任的网络活动”。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f3/ed6/3a6/5f3ed63a6ff8edc7a331955cfc85bd9e.png"><br>  <i><font color="gray">让我们从一个空项目开始</font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">填写数据，选择项目的名称（我们将在以后进行更改）和包的名称：这将是我们在Android以及目录中的应用程序的标识符。我建议以相反的顺序使用主机名，并在末尾使用任意名称。例如，如果您拥有主机</font></font><i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mypwa.com/calculator</font></font></a></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，则该包可以称为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">com.mypwa.calculator</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为基础，适合使用API​​ 19（Android 4.4）。看来它将很快成为</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chrome所需</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的</font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;">最低版本</font></a><font style="vertical-align: inherit;">。某些TWA功能仅适用于API 23（Android 6.0），但支持库将解决此问题。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2月5日更新</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：Chrome正式宣布TWA仅适用于Android 4.4 KitKat。</font><font style="vertical-align: inherit;">因此，约有5％的活跃Android用户无法使用此功能：他们将使用自定义标签和地址栏回滚到该版本。</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/2d3/66a/8fb/2d366a8fbf19b050af01bc9e35ed5093.png"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">选择最低API级别将限制Play商店目录中提供PWA的设备列表</font></font></font></i> <br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 添加依赖 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下一步是添加TWA支持库作为依赖项，因此打开两个名为</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">build.gradle的</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font><font style="vertical-align: inherit;">：</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5fa/f6c/f11/5faf6cf11d05e2df8ed6c8eab783a8c4.png"><br> <i><font color="gray"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">两个配置文件：用于项目和Android应用程序</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们从项目文件开始。</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将以下行</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">添加到</font><i><font style="vertical-align: inherit;">allprojects&gt;存储库</font></i><font style="vertical-align: inherit;">部分</font><font style="vertical-align: inherit;">：</font></font><br><br><pre><code class="java hljs">maven { url <span class="hljs-string"><span class="hljs-string">"https://jitpack.io"</span></span> }</code> </pre> <br> 在下一步中，我们打开模块<i>build.gradle</i>并根据以下内容添加它： <br><br><pre> <code class="java hljs">implementation <span class="hljs-string"><span class="hljs-string">'com.github.GoogleChrome:custom-tabs-client:e446d08014'</span></span></code> </pre> <br><h3>  TWA设置 </h3><br> 下一步是在模块文件中设置Trusted Web Activity的PWA参数，添加<i>defaultConfig</i>部分： <br><br><pre> <code class="java hljs">manifestPlaceholders = [ hostName: <span class="hljs-string"><span class="hljs-string">"app.starbucks.com"</span></span>, defaultUrl: <span class="hljs-string"><span class="hljs-string">"https://app.starbucks.com"</span></span>, launcherName: <span class="hljs-string"><span class="hljs-string">"Starbucks"</span></span>, assetStatements: <span class="hljs-string"><span class="hljs-string">'[{ "relation": ["delegate_permission/common.handle_all_urls"], '</span></span> + <span class="hljs-string"><span class="hljs-string">'"target": {"namespace": "web", "site": "https://app.starbucks.com"}}]'</span></span> ]</code> </pre> <br> 在这里，作为示例，我将使用星巴克PWA。  assetStatements密钥将需要来自数字资产链接过程的信息。 我们现在暂时跳过这一部分。 名为<i>launcherName</i>的属性必须与Web应用程序清单中的<i>short_name</i>匹配。 <br><br><h3> 清单设置 </h3><br>  Android应用程序具有自己的清单，它们将不接受Web应用程序的清单。 所需文件位于<i>app&gt;清单</i>部分中，称为AndroidManifest.xml。 在那里，您将找到一个自动关闭的Application XML元素。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/65d/486/38c/65d48638cd9d76411f8fc935d6e3fff4.png"><br>  <i><font color="gray">默认的Android清单文件</font></i> <br><br> 在那里，我们将android：标签的值更改为<b>$ {launcherName}</b> ，这是我们在元数据中前面设置的，因此我们将获得应用程序名称的唯一真实来源。 <br><br> 下一步是从&lt;application&gt;标记开始配置此文件，以向其添加子元素，如下所示： <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asset_statements"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${assetStatements}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.support.customtabs.trusted.LauncherActivity"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${launcherName}"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.support.customtabs.trusted.DEFAULT_URL"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${defaultUrl}"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.VIEW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.DEFAULT"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.BROWSABLE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:scheme</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:host</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"${hostName}"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 下面的代码将使用支持库和Intent Filter配置TWA，以便应用程序接收到PWA和Digital Asset Link的链接。 我将跳过有关Android应用程序的详细信息。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b0/45f/bd2/5b045fbd2c03c263490b96905f79aac6.png"><br>  <i><font color="gray">该同步了</font></i> <br><br> 此时，您需要通过单击<i>立即同步</i>来命令Android Studio接受所有更改。 如果一切正确，则不会弹出错误。 <br><br><h3> 图标更换 </h3><br> 目前，该应用程序仅使用默认的Android图标，因此您需要针对不同的像素密度替换不同子文件夹中的<i>app&gt; res&gt; mipmap</i>中的所有文件。 有两种版本：正方形和圆形图标。 四舍五入出现在Android 7.1中，如果要忽略它们，请删除AndroidManifest.xml中的<i>android：roundIcon</i>链接。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/626/7c7/baf/6267c7bafb790307f16bf2c0bb8a037a.png"><br>  <i><font color="gray">您需要从清单中取出图标，并将它们复制到具有相应名称的mipmap子文件夹中</font></i> <br><br><h3> 主题设定 </h3><br> 最后，打开<i>app / res / values / styles.xml</i>并对主题进行一些更改，使其看起来像PWA： <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"AppTheme"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">parent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Theme.AppCompat.Light.NoActionBar"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimary"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorPrimary</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorPrimaryDark"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorPrimaryDark</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"colorAccent"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">@color/colorAccent</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"android:windowNoTitle"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">true</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"android:backgroundDimEnabled"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">false</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">item</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br> 您可以从<i>app / res / values / colors.xml</i>更改颜色，但是我尚未在TWA中看到此工作。 <br><br> 如果您限制清单中的方向，则可以将此限制添加到AndroidManifest.xml中的&lt;activity&gt;元素。 <br><br><h1> 准备测试了吗？ </h1><br> 我们已经准备好测试PWApk，但是在此之前，我们需要在Android测试设备或仿真器（使用Chrome 72+）中为Chrome配置TWA开发模式。 <br><br><h3>  Chrome设置 </h3><br> 确保您拥有Chrome稳定版72，并打开<i>chrome：// flags</i> 。  <i>在非根目录设备上</i>找到<i>启用命令行</i>选项，然后<i>选中复选框</i> 。 重新启动浏览器。 <br><br> 然后，我们需要将Chrome配置为要测试的主机绕过Digital Asset Link，在我们的示例中为<b>app.starbucks.com</b> 。 <br><br> 要更改Android版Chrome浏览器的命令行选项，您需要将文本文件写入Android文件系统。 最简单的方法是通过<b>adb</b> （Android调试桥），该文件应在路径（google，如果有）中注册，然后运行以下命令： <br><br><pre> <code class="bash hljs">adb shell cat /data/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/tmp/chrome-command-line _ - <span class="hljs-built_in"><span class="hljs-built_in">disable</span></span>-digital-asset-link-verification-for-url=<span class="hljs-string"><span class="hljs-string">"https://app.starbucks.com"</span></span></code> </pre> <br> 您可以使用Google提供的<a href="">简单bash脚本</a> 。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb1/285/bec/bb1285becd4651597032df751d86abcf.png"><br>  <i><font color="gray">您需要停止Chrome浏览器，以便在启动时接受新设置</font></i> <br><br> 并重新启动Chrome。 但是，不仅要从任务列表中删除该应用程序，还要从设置中删除该应用程序以强制完成整个过程（强制停止）。 在工作之前，我不得不做几次。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/590/e38/84b/590e3884b2f60cb751eb746eb24e69f1.png"><br>  <i><font color="gray">警告标志已亮起，一切顺利</font></i> <br><br> 如果一切都完成了，那么每次打开Chrome时，您都会看到有关不支持的标志的警告。 如果您从Android Studio运行该应用程序，则您的PWA将最终启动并在APK图标和名称下脱机工作。 <br><br><h1> 结论 </h1><br> 在Google Play目录中发布PWA的能力确实改变了游戏规则。 看来现在我们有一个非常早期的API版本，肯定需要做一些工作。 我真的很想能够输入我们PWA的URL并从中获取APK文件。 由于数字资产链接验证系统，这不是很简单。 只有Play商店可以使用它们生成的相同的WebAPK来执行此操作。 <br><br> 我曾经想知道<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Google是否批准PWA应用程序或对其发动战争</a> 。 但是现在，他们至少在TWA方面已经消除了怀疑。 <br><br> 我们希望Chrome 72中的TWA是漫长旅程的第一步！ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN439238/">https://habr.com/ru/post/zh-CN439238/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN439224/index.html">关于Voronoi图</a></li>
<li><a href="../zh-CN439226/index.html">Scala + MXNet =产品中带有神经元的微服务</a></li>
<li><a href="../zh-CN439232/index.html">JAMstack：如何使用Gatsby + Contentful + Netlify创建自己的博客</a></li>
<li><a href="../zh-CN439234/index.html">开源开发人员在GIF中的生活</a></li>
<li><a href="../zh-CN439236/index.html">xenvman：灵活的微服务测试环境（以及更多）</a></li>
<li><a href="../zh-CN439240/index.html">2019年1月的Joomla摘要</a></li>
<li><a href="../zh-CN439244/index.html">FAS强烈建议在俄罗斯联邦出售的智能手机和笔记本电脑上预装俄语软件</a></li>
<li><a href="../zh-CN439248/index.html">艾伦·凯：“古罗马人可以建造一台计算机吗？”</a></li>
<li><a href="../zh-CN439252/index.html">在亚美尼亚发展IT职业的6个理由</a></li>
<li><a href="../zh-CN439254/index.html">我们的一切</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>