<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ ü§∏üèΩ üë®‚Äçüë©‚Äçüë¶‚Äçüë¶ C√≥mo recopilamos datos sobre campa√±as publicitarias de plataformas en l√≠nea (el camino espinoso hacia el producto) ü§∂üèΩ üë©üèø‚Äçüè´ ü§ôüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Parece que el campo de la publicidad en l√≠nea deber√≠a ser lo m√°s tecnol√≥gico y automatizado posible. De hecho, gigantes y expertos en su campo como Ya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo recopilamos datos sobre campa√±as publicitarias de plataformas en l√≠nea (el camino espinoso hacia el producto)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dentsuaegisnetworkrussia/blog/469625/">  Parece que el campo de la publicidad en l√≠nea deber√≠a ser lo m√°s tecnol√≥gico y automatizado posible.  De hecho, gigantes y expertos en su campo como Yandex, Mail.Ru, Google y Facebook trabajan all√≠.  Pero, como result√≥, no hay l√≠mite para la perfecci√≥n y siempre hay algo para automatizar. <br><br><img src="https://habrastorage.org/webt/gg/cq/j3/ggcqj3ws0e1dpcxixrkjdez28ry.png" alt="imagen"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><i>Fuente</i></a> <br><br>  El grupo de comunicaci√≥n <b>Dentsu Aegis Network Russia</b> es el jugador m√°s grande en el mercado de publicidad digital e invierte activamente en tecnolog√≠a, tratando de optimizar y automatizar sus procesos comerciales.  Uno de los problemas no resueltos del mercado de publicidad en l√≠nea fue la tarea de recopilar estad√≠sticas sobre campa√±as publicitarias de diferentes sitios en l√≠nea.  La soluci√≥n a este problema finalmente result√≥ en la creaci√≥n del producto <b>D1.Digital</b> (le√≠do como DiVan), del que queremos hablar sobre el desarrollo. <br><a name="habracut"></a><br><h3>  Por qu√© </h3><br>  1. En el momento del inicio del proyecto, no hab√≠a un solo producto terminado en el mercado que resolviera la tarea de automatizar la recopilaci√≥n de estad√≠sticas sobre campa√±as publicitarias.  <i>Esto significa que nadie m√°s que nosotros cerrar√° nuestras necesidades.</i> <br><br>  Servicios como Improvado, Roistat, Supermetrics, SegmentStream, ofrecen integraci√≥n con sitios, redes sociales y Google Analitycs, y tambi√©n proporcionan la capacidad de crear paneles anal√≠ticos para un an√°lisis y control convenientes de campa√±as publicitarias.  Antes de comenzar a desarrollar nuestro producto, intentamos utilizar algunos de estos sistemas en nuestro trabajo para recopilar datos de sitios, pero, desafortunadamente, no pudieron resolver nuestros problemas. <br><br>  El principal problema fue que los productos probados fueron repelidos de fuentes de datos, mostrando estad√≠sticas de ubicaciones en secciones por sitios, y no permitieron la agregaci√≥n de estad√≠sticas en campa√±as publicitarias.  Este enfoque no permiti√≥ ver estad√≠sticas de diferentes sitios en un solo lugar y analizar el estado de la campa√±a en su conjunto. <br><br>  Otro factor fue que en las etapas iniciales los productos estaban orientados al mercado occidental y no admit√≠an la integraci√≥n con sitios rusos.  Y para aquellos sitios con los que se implement√≥ la integraci√≥n, no siempre se cargaron todas las m√©tricas necesarias con suficiente detalle, y la integraci√≥n no siempre fue conveniente y transparente, especialmente cuando era necesario obtener algo que no estaba en la interfaz del sistema. <br>  En general, decidimos no adaptarnos a productos de terceros, pero comenzamos a desarrollar los nuestros ... <br><br>  2. El mercado de publicidad en l√≠nea est√° creciendo a√±o tras a√±o, y en 2018, tradicionalmente super√≥ al mercado de publicidad televisiva m√°s grande en t√©rminos de presupuestos publicitarios.  <i>Entonces hay una escala</i> . <br><br>  3. A diferencia del mercado de publicidad televisiva, donde la venta de publicidad comercial est√° monopolizada, la masa de propietarios individuales de equipos publicitarios de varios tama√±os con sus oficinas de publicidad trabaja en Internet.  Como la campa√±a publicitaria, por lo general, se ejecuta en varios sitios a la vez, para comprender el estado de la campa√±a publicitaria, es necesario recopilar informes de todos los sitios y reunirlos en un informe grande que muestre la imagen completa.  <i>Por lo tanto, hay potencial para la optimizaci√≥n.</i> <br><br>  4. Nos pareci√≥ que los propietarios de inventario de publicidad en Internet ya ten√≠an una infraestructura para recopilar estad√≠sticas y mostrarlas en las oficinas de publicidad, y pod√≠an proporcionar una API para estos datos.  <i>Entonces, hay una viabilidad t√©cnica.</i>  Diremos de inmediato que no fue tan simple. <br><br>  En general, todos los requisitos previos para la implementaci√≥n del proyecto eran obvios para nosotros, y corrimos para implementar el proyecto ... <br><br><h3>  Gran plan </h3><br>  Primero, formamos una visi√≥n de un sistema ideal: <br><br><ul><li>  Deber√≠a cargar autom√°ticamente las campa√±as publicitarias del sistema corporativo 1C con sus nombres, per√≠odos, presupuestos y ubicaciones en varias plataformas. </li><li>  Para cada ubicaci√≥n dentro de la campa√±a publicitaria, todas las estad√≠sticas posibles de los sitios en los que la ubicaci√≥n est√° en curso deben descargarse autom√°ticamente, como el n√∫mero de impresiones, clics, vistas, etc. </li><li>  Algunas campa√±as publicitarias son monitoreadas por terceros mediante los llamados sistemas de publicaci√≥n de anuncios, como Adriver, Weborama, DCM, etc.  Tambi√©n hay un medidor de Internet industrial en Rusia: Mediascope.  Seg√∫n nuestra idea, los datos de monitoreo independiente e industrial tambi√©n deben cargarse autom√°ticamente en las campa√±as publicitarias correspondientes. </li><li>  La mayor√≠a de las campa√±as publicitarias en Internet est√°n dirigidas a ciertas acciones espec√≠ficas (comprar, llamar, grabar para una prueba de manejo, etc.), que se rastrean con Google Analytics, y estad√≠sticas que tambi√©n son importantes para comprender el estado de la campa√±a y deben cargarse en nuestra herramienta . </li></ul><br><h3>  El primer panqueque es grumoso </h3><br>  Teniendo en cuenta nuestro compromiso con los principios flexibles del desarrollo de software (√°gil, todas las cosas), decidimos primero desarrollar MVP y luego avanzar hacia el objetivo previsto de forma iterativa. <br>  Decidimos crear MVP sobre la base de nuestro producto <b>DANBo (Dentsu Aegis Network Board)</b> , que es una aplicaci√≥n web con informaci√≥n general sobre las campa√±as publicitarias de nuestros clientes. <br><br>  Para MVP, el proyecto se simplific√≥ al m√°ximo en t√©rminos de implementaci√≥n.  Hemos seleccionado una lista limitada de sitios para la integraci√≥n.  Estas fueron las principales plataformas, como Yandex.Direct, Yandex.Display, RB.Mail, MyTarget, Adwords, DBM, VK, FB y los principales sistemas de servidores de anuncios Adriver y Weborama. <br><br>  Para acceder a las estad√≠sticas en los sitios a trav√©s de la API, utilizamos una sola cuenta.  El gerente del grupo de clientes, que quer√≠a utilizar la recopilaci√≥n autom√°tica de estad√≠sticas sobre la campa√±a publicitaria, primero ten√≠a que delegar el acceso a las campa√±as publicitarias necesarias en los sitios a la cuenta de la plataforma. <br><br>  Luego, el usuario del sistema <b>DANBo</b> tuvo que cargar un archivo de cierto formato al sistema Excel, en el que se escribi√≥ toda la informaci√≥n sobre la ubicaci√≥n (campa√±a publicitaria, sitio, formato, per√≠odo de ubicaci√≥n, indicadores planificados, presupuesto, etc.) y los identificadores de las campa√±as publicitarias correspondientes en los sitios. y contadores en sistemas de servicio de anuncios. <br><br>  Parec√≠a, francamente, aterrador: <br><br><img src="https://habrastorage.org/webt/ie/kc/sd/iekcsdiz6k8fltryf2ydfgi-f14.png" alt="imagen"><br><br>  Los datos descargados se almacenaron en la base de datos, y luego los servicios individuales recopilaron identificadores de campa√±a de los sitios y descargaron estad√≠sticas sobre ellos. <br><br>  Se escribi√≥ un servicio de Windows por separado para cada sitio, que una vez al d√≠a estaba bajo una cuenta de servicio en la API del sitio y descargaba estad√≠sticas sobre los identificadores de campa√±a especificados.  Lo mismo sucedi√≥ con los sistemas de publicidad. <br><br>  Los datos descargados se mostraron en la interfaz en forma de un peque√±o panel autoescrito: <br><br><img src="https://habrastorage.org/webt/8n/xy/bl/8nxyblj7gcdigcrczqpryslhoue.png" alt="imagen"><br><br>  Inesperadamente para nosotros, MVP gan√≥ y comenz√≥ a descargar estad√≠sticas actuales sobre campa√±as publicitarias en Internet.  Implementamos el sistema en varios clientes, pero cuando intentamos escalar, nos encontramos con serios problemas: <br><br><ul><li>  El principal problema era la laboriosidad de preparar los datos para cargarlos en el sistema.  Adem√°s, los datos de ubicaci√≥n tuvieron que reducirse a un formato estrictamente fijo antes de la descarga.  En el archivo para cargar, era necesario registrar los identificadores de entidades de diferentes sitios.  Nos enfrentamos al hecho de que es muy dif√≠cil para los usuarios t√©cnicamente inexpertos explicar d√≥nde encontrar estos identificadores en el sitio y d√≥nde colocarlos en el archivo.  Teniendo en cuenta el n√∫mero de empleados en las divisiones que realizan campa√±as en los sitios y la rotaci√≥n, esto result√≥ en una gran cantidad de apoyo de nuestro lado, que categ√≥ricamente no nos conven√≠a. </li><li>  Otro problema era que no todas las plataformas publicitarias ten√≠an mecanismos para delegar el acceso a campa√±as publicitarias a otras cuentas.  Pero incluso si el mecanismo de delegaci√≥n estuviera disponible, no todos los anunciantes estaban dispuestos a proporcionar acceso a cuentas de terceros a sus campa√±as. </li><li>  Un factor importante fue la indignaci√≥n, que caus√≥ que los usuarios que todos los indicadores planificados y los detalles de ubicaci√≥n que ya contribuyen a nuestro sistema de contabilidad 1C se vuelvan a ingresar en <b>DANBo</b> . </li></ul><br>  Esto nos dio la idea de que la fuente principal de informaci√≥n sobre la ubicaci√≥n deber√≠a ser nuestro sistema 1C, en el que todos los datos se ingresan con precisi√≥n y a tiempo (el punto es que, en base a los datos 1C, se forman cuentas, por lo tanto, la entrada correcta de los datos en 1C es para todos en KPI).  Entonces apareci√≥ un nuevo concepto de sistema ... <br><br><h3>  Concepto </h3><br>  Lo primero que decidimos hacer fue separar el sistema de recopilaci√≥n de estad√≠sticas sobre campa√±as publicitarias en Internet en un producto separado: <b>D1.Digital</b> . <br><br>  En el nuevo concepto, decidimos cargar informaci√≥n sobre campa√±as publicitarias y ubicaciones dentro de ellas desde 1C a <b>D1.Digital</b> , y luego extraer estad√≠sticas de sitios y de sistemas AdServing a estas ubicaciones.  Se supon√≠a que esto simplificar√≠a enormemente la vida de los usuarios (y, como de costumbre, agregar√≠a trabajo a los desarrolladores) y reducir√≠a la cantidad de soporte. <br><br>  El primer problema que encontramos fue de naturaleza organizacional y estaba relacionado con el hecho de que no pod√≠amos encontrar una clave o atributo por el cual pudi√©ramos comparar entidades de diferentes sistemas con campa√±as y ubicaciones de 1C.  El hecho es que el proceso en nuestra compa√±√≠a est√° organizado de tal manera que las campa√±as publicitarias son ingresadas en diferentes sistemas por diferentes personas (reproductores multimedia, compras, etc.). <br><br>  Para resolver este problema, tuvimos que inventar una clave hash √∫nica, DANBoID, que conectar√≠a entidades en diferentes sistemas y que podr√≠a identificarse de manera bastante f√°cil e inequ√≠voca en los conjuntos de datos cargados.  Este identificador se genera en el sistema interno 1C para cada ubicaci√≥n individual y se lanza a campa√±as, ubicaciones y contadores en todas las plataformas y en todos los sistemas AdServing.  La implementaci√≥n de la pr√°ctica de colocar DANBoID en todas las ubicaciones tom√≥ algo de tiempo, pero lo hicimos :) <br><br>  Luego descubrimos que no todos los sitios tienen una API para la recopilaci√≥n autom√°tica de estad√≠sticas, e incluso aquellos que tienen una API no devuelven todos los datos necesarios. <br><br>  En esta etapa, decidimos reducir significativamente la lista de sitios para la integraci√≥n y centrarnos en los sitios principales que participan en la gran mayor√≠a de las campa√±as publicitarias.  Esta lista incluye a todos los jugadores m√°s grandes en el mercado publicitario (Google, Yandex, Mail.ru), redes sociales (VK, Facebook, Twitter), los principales sistemas de an√°lisis y AdServing (DCM, Adriver, Weborama, Google Analytics) y otras plataformas. <br><br>  La mayor parte de los sitios que seleccionamos ten√≠an una API que nos dio las m√©tricas necesarias.  En aquellos casos en que la API no estaba all√≠, o no ten√≠a los datos necesarios, utilizamos informes que llegaban diariamente por correo comercial para descargar los datos (en algunos sistemas es posible configurar dichos informes, en otros acordaron el desarrollo de dichos informes para nosotros). <br><br>  Al analizar datos de diferentes sitios, encontramos que la jerarqu√≠a de entidades no es la misma en diferentes sistemas.  Adem√°s, la informaci√≥n de diferentes sistemas debe cargarse con diferentes detalles. <br><br>  Para resolver este problema, se desarroll√≥ el concepto SubDANBoID.  La idea de SubDANBoID es bastante simple, marcamos la esencia principal de la campa√±a en el sitio con el DANBoID generado, y cargamos todas las entidades anidadas con identificadores √∫nicos del sitio y formamos el SubDANBoID de acuerdo con el principio DANBoID + identificador de la entidad anidada del primer nivel + identificador de la entidad anidada del segundo nivel + ... Este enfoque nos permiti√≥ asociarnos campa√±as publicitarias en diferentes sistemas y subir estad√≠sticas detalladas sobre ellos. <br><br>  Tambi√©n tuvimos que resolver el problema del acceso a las campa√±as en diferentes sitios.  Como escribimos anteriormente, el mecanismo de delegar el acceso a la campa√±a a una cuenta t√©cnica separada no siempre es aplicable.  Por lo tanto, tuvimos que desarrollar una infraestructura para la autorizaci√≥n autom√°tica a trav√©s de OAuth usando tokens y mecanismos de actualizaci√≥n para estos tokens. <br><br>  M√°s adelante en el art√≠culo intentaremos describir con m√°s detalle la arquitectura de la soluci√≥n y los detalles t√©cnicos de la implementaci√≥n. <br><br><h3>  Arquitectura de soluciones 1.0 </h3><br>  Al comenzar la implementaci√≥n de un nuevo producto, entendimos que era inmediatamente necesario proporcionar la posibilidad de conectar nuevos sitios, por lo que decidimos seguir el camino de la arquitectura de microservicios. <br><br>  Al dise√±ar la arquitectura, seleccionamos conectores de servicios separados para todos los sistemas externos: 1C, plataformas publicitarias y sistemas de publicaci√≥n de anuncios. <br>  La idea principal es que todos los conectores a los sitios tienen la misma API y son adaptadores que traen las API del sitio a nuestra conveniente interfaz. <br><br>  En el centro de nuestro producto hay una aplicaci√≥n web, que es un monolito, que est√° dise√±ada para que pueda desmontarse f√°cilmente en los servicios.  Esta aplicaci√≥n es responsable de procesar los datos descargados, comparar estad√≠sticas de diferentes sistemas y presentarlos a los usuarios del sistema. <br><br>  Para comunicar los conectores con una aplicaci√≥n web, tuvimos que crear un servicio adicional, al que llamamos Proxy de conector.  Realiza las funciones de Service Discovery y Task Scheduler.  Este servicio ejecuta tareas de recopilaci√≥n de datos para cada conector todas las noches.  Escribir una capa de servicio fue m√°s f√°cil que conectar un agente de mensajes, y para nosotros fue importante obtener el resultado lo m√°s r√°pido posible. <br><br>  Por simplicidad y velocidad de desarrollo, tambi√©n decidimos que todos los servicios ser√≠an una API web.  Esto hizo posible armar r√°pidamente una prueba de concepto y verificar que todo el dise√±o funcionara. <br><br><img src="https://habrastorage.org/webt/eb/_s/ui/eb_suixgwtg5u5e35t01dzqhuqw.png" alt="imagen"><br><br>  Una tarea separada, bastante dif√≠cil, fue configurar el acceso para recopilar datos de diferentes gabinetes, que, como decidimos, deber√≠an llevar a cabo los usuarios a trav√©s de una interfaz web.  Consiste en dos pasos separados: primero, el usuario a trav√©s de OAuth agrega un token para acceder a la cuenta y luego configura la recopilaci√≥n de datos para el cliente desde una cuenta espec√≠fica.  Es necesario obtener un token a trav√©s de OAuth porque, como ya escribimos, no siempre es posible delegar el acceso al gabinete deseado en el sitio. <br><br>  Para crear un mecanismo universal para elegir un gabinete de los sitios, tuvimos que agregar un m√©todo a la API de conectores que representa el esquema JSON, que se procesa en el formulario utilizando un componente JSONEditor modificado.  Por lo tanto, los usuarios pudieron elegir las cuentas desde las que descargar los datos. <br><br>  Para cumplir con los l√≠mites de solicitud que existen en los sitios, combinamos la solicitud de configuraci√≥n dentro del mismo token, pero podemos procesar diferentes tokens en paralelo. <br><br>  Elegimos MongoDB como dep√≥sito de datos descargables tanto para una aplicaci√≥n web como para conectores, lo que nos permiti√≥ no preocuparnos mucho por la estructura de datos en las etapas iniciales de desarrollo, cuando el modelo de la aplicaci√≥n cambia despu√©s de un d√≠a. <br><br>  Pronto descubrimos que no todos los datos se ajustan bien en MongoDB y, por ejemplo, las estad√≠sticas diarias son m√°s convenientes para almacenar en una base de datos relacional.  Por lo tanto, para los conectores cuya estructura de datos es m√°s adecuada para una base de datos relacional, comenzamos a usar PostgreSQL o MS SQL Server como almacenamiento. <br><br>  La arquitectura y la tecnolog√≠a seleccionadas nos permitieron construir y lanzar relativamente r√°pido el producto D1.Digital.  Durante los dos a√±os de desarrollo de productos, desarrollamos 23 conectores de sitio, adquirimos una experiencia invaluable trabajando con API de terceros, aprendimos a sortear las trampas de los diferentes sitios que cada uno ten√≠a el suyo, contribuimos al desarrollo de API al menos en 3 sitios, descargamos informaci√≥n autom√°ticamente en casi 15,000 campa√±as En m√°s de 80,000 ubicaciones, recopilamos una gran cantidad de comentarios de los usuarios sobre el producto y logramos cambiar el proceso principal del producto varias veces, en base a estos comentarios. <br><br><h3>  Arquitectura de soluciones 2.0 </h3><br>  Han pasado dos a√±os desde el inicio del desarrollo de <b>D1.Digital</b> .  El aumento constante de la carga en el sistema y la aparici√≥n de nuevas fuentes de datos revelaron gradualmente problemas en la arquitectura de la soluci√≥n existente. <br><br>  El primer problema est√° relacionado con la cantidad de datos descargados de los sitios.  Nos enfrentamos con el hecho de que recopilar y actualizar todos los datos necesarios de los sitios m√°s grandes comenz√≥ a tomar demasiado tiempo.  Por ejemplo, la recopilaci√≥n de datos en el sistema de servicio de anuncios AdRiver, con el que hacemos un seguimiento de las estad√≠sticas para la mayor√≠a de las ubicaciones, lleva aproximadamente 12 horas. <br><br>  Para resolver este problema, comenzamos a usar todo tipo de informes para descargar datos de los sitios, estamos tratando de desarrollar sus API junto con los sitios para que su velocidad satisfaga nuestras necesidades y paralelizar la carga de datos tanto como sea posible. <br><br>  Otro problema es el procesamiento de datos descargados.  Ahora, con la llegada de nuevas estad√≠sticas sobre la ubicaci√≥n, se inicia un proceso de varias etapas para volver a calcular las m√©tricas, que incluye cargar datos sin procesar, calcular m√©tricas agregadas para cada sitio, comparar datos de diferentes fuentes entre s√≠ y calcular m√©tricas resumidas para la campa√±a.  Esto provoca una gran carga en la aplicaci√≥n web, que realiza todos los c√°lculos.  Varias veces, en el proceso de recuento, la aplicaci√≥n consume toda la memoria del servidor, aproximadamente 10-15 GB, lo que tiene el efecto m√°s perjudicial en el trabajo del usuario con el sistema. <br><br>  Los problemas identificados y los planes grandiosos para el desarrollo posterior del producto nos llevaron a la necesidad de revisar la arquitectura de la aplicaci√≥n. <br><br>  Comenzamos con los conectores. <br>  Notamos que todos los conectores funcionan de acuerdo con el mismo modelo, por lo que construimos un transportador de tuber√≠a en el que para crear el conector solo ten√≠a que programar la l√≥gica de los pasos, el resto era universal.  Si necesita mejorar alg√∫n conector, lo transferiremos inmediatamente a un nuevo marco mientras finalizamos el conector. <br><br>  Paralelamente, comenzamos a colocar conectores en Docker y Kubernetes. <br>  Planeamos mudarnos a Kubernetes durante un tiempo bastante largo, experimentamos con la configuraci√≥n de CI / CD, pero comenzamos a movernos solo cuando un conector comenz√≥ a consumir m√°s de 20 GB de memoria en el servidor debido a un error, casi matando el resto de los procesos.  Durante la investigaci√≥n, el conector se reubic√≥ en el cl√∫ster de Kubernetes, donde finalmente permaneci√≥, incluso cuando se solucion√≥ el error. <br><br>  R√°pidamente, nos dimos cuenta de que Kubernetes era conveniente, y en seis meses movimos 7 conectores y Conectores Proxy al cl√∫ster de producci√≥n, que consume la mayor√≠a de los recursos. <br><br>  Siguiendo los conectores, decidimos cambiar la arquitectura del resto de la aplicaci√≥n. <br>  El principal problema fue que los datos provienen de conectores a proxies en paquetes grandes, y luego golpean en DANBoID y se transfieren a una aplicaci√≥n web central para su procesamiento.  Debido a la gran cantidad de rec√°lculos de m√©tricas, se produce una gran carga en la aplicaci√≥n. <br><br>              ,   ,   web ,    ,  ,  -    . <br><br>        2.0. <br><br>        ,   Web API   RabbitMQ   MassTransit     .       Connectors Proxy,    Connectors Hub.   ,             ,       . <br><br>   web             ,                  .             . <br><br>           Kubernetes,         . <br><br><img src="https://habrastorage.org/webt/lx/3j/tw/lx3jtwply2iyyms99xajwhtnsie.png" alt="imagen"><br><br><h3>    </h3><br> Proof-of-concept  2.0  <b>D1.Digital</b>          .    ‚Äî   20    , ,    ,     ,      . <br><br>   ,              API,    . <br><br>        ,           ,      adserving . <br><br>     ,      web ,    Kubernetes.     ,     ,     . <br><br>          ,     MongoDB.        SQL-,     ,      ,      ,     . <br><br>  ,  ,   :) <br><br> <i>  R&amp;D Dentsu Aegis Network Russia:   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">shmiigaa</a> ),   ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">hitexx</a> )</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/469625/">https://habr.com/ru/post/469625/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../469613/index.html">Sobre el sistema nacional de gesti√≥n de datos</a></li>
<li><a href="../469615/index.html">Tiempo de alta precisi√≥n: c√≥mo trabajar con fracciones de segundo en MySQL y PHP</a></li>
<li><a href="../469617/index.html">Destruye el monopolio de Estados Unidos en EDA. Innopolis da el primer paso</a></li>
<li><a href="../469619/index.html">Investigaci√≥n: si el comprador entiende que est√° hablando con el bot de chat, entonces la compra no tendr√° lugar</a></li>
<li><a href="../469623/index.html">GitLab 12.3 con firewall de aplicaciones web y an√°lisis de rendimiento</a></li>
<li><a href="../469629/index.html">El √°tomo pac√≠fico no est√° en todos los hogares: opciones inesperadas para las fuentes de energ√≠a de radion√∫clidos</a></li>
<li><a href="../469631/index.html">Acelerando en Figma. Necesita m√°s complementos</a></li>
<li><a href="../469633/index.html">Creamos un conjunto de datos para el reconocimiento de contadores en Yandex.Tolok</a></li>
<li><a href="../469635/index.html">C√≥mo funcionan las transferencias de dinero de tarjeta a tarjeta</a></li>
<li><a href="../469637/index.html">En los a√±os 90, el rapero MC Hammer desarroll√≥ el juego, pero hoy U Can't Touch This</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>