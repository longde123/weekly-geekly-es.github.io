<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•© üìî üó£Ô∏è ShIoTiny e o mundo ao redor: conectando sensores a entradas bin√°rias, rejei√ß√£o de contato e outros problemas üòÇ üßùüèæ üéÑ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pontos principais ou sobre o que √© este artigo 


 Outro artigo sobre o ShIoTiny - um controlador visualmente program√°vel baseado no chip ESP8266 . O ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ShIoTiny e o mundo ao redor: conectando sensores a entradas bin√°rias, rejei√ß√£o de contato e outros problemas</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/466231/"><img src="https://habrastorage.org/webt/3n/g5/5y/3ng55yiea33i2ft7gzbcydaenka.jpeg"><br><h4 id="osnovnye-tezisy-ili-o-chem-eta-statya">  Pontos principais ou sobre o que √© este artigo </h4><br><p>  Outro artigo sobre o <strong>ShIoTiny</strong> - um controlador visualmente program√°vel baseado no chip <strong>ESP8266</strong> .  O artigo descreve os recursos de conex√£o de sensores de v√°rios tipos √†s entradas bin√°rias do controlador <strong>ShIoTiny</strong> .  Al√©m disso, h√° respostas para v√°rias perguntas populares de leitores de artigos anteriores da s√©rie. </p><br><p>  <strong>Artigos anteriores da s√©rie</strong> <strong><br></strong> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ShIoTiny: pequena automa√ß√£o, a Internet das coisas ou "seis meses antes das f√©rias"</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ShIoTiny: n√≥s, links e eventos ou recursos de programas de desenho</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ShIoTiny: ventila√ß√£o em salas √∫midas (exemplo de projeto)</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Site do projeto</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Firmware bin√°rio, circuitos do controlador e documenta√ß√£o</a> </p><a name="habracut"></a><br><h4 id="vstuplenie-ili-otvety-na-voprosy">  Introdu√ß√£o ou respostas a perguntas </h4><br><p>  Todos os meus artigos sobre o <strong>ShIoTiny</strong> , exceto o primeiro, nasceram de perguntas de leitores que se arriscaram a experimentar o meu firmware. </p><br><p>  O fato √© que, para responder em detalhes e de uma s√≥ vez - eu n√£o tenho a oportunidade.  Um hobby √© um hobby e √© raro algu√©m dedicar tanto tempo a ele como trabalho, tarefas dom√©sticas ou crian√ßas.  Nem eu.  E as perguntas das cartas podem ser essencialmente reduzidas a v√°rias.  Portanto, √© mais f√°cil escrever um artigo que cobre v√°rias quest√µes em detalhes do que escrever uma d√∫zia de cartas. </p><br><p>  Muitas perguntas dizem respeito a como conectar sensores de v√°rios tipos e como trabalhar com eles.  Isso n√£o √© surpreendente: trabalhar com rel√©s de sa√≠da √© bastante simples.  E o que eles simplesmente n√£o querem se conectar √†s entradas!  Existem muitas op√ß√µes.  Este artigo √© dedicado a este artigo e provavelmente ser√° dedicado ao seguinte: um t√≥pico muito amplo - a conex√£o de sensores. </p><br><p>  Mas, antes de passar √† biografia do maravilhoso mundo dos sensores, permitirei que eu use o Habr como uma m√≠dia para responder √†s perguntas mais populares que eles me fazem em cartas. </p><br><p>  <strong><em>Respostas √†s perguntas mais populares dos leitores</em></strong> <strong><br></strong> </p><br><p>  Provavelmente, a pergunta mais popular √© " <strong><em>por que voc√™ n√£o suporta PWM / DS1821 / RTC ... e assim por diante?</em></strong>  "  Eu respondo.  Porque quando eu projetei o ShIoTiny, n√£o precisava.  Quanto ao PWM, simplesmente n√£o h√° lugar para coloc√°-lo na placa <strong>ShIoTiny</strong> .  N√£o h√° pernas para conectar o <strong>RTC</strong> .  E assim por diante  Mas se o projeto se desenvolver com sucesso o suficiente - farei outro dispositivo com a mesma ideologia de programa√ß√£o, mas com um conjunto diferente de perif√©ricos.  Obviamente, suportarei alguns chips adicionais no ShIoTiny, como apoiei, por exemplo, ontem o sensor de temperatura <strong>DS1820 / 22</strong> .  Mas voc√™ n√£o pode abra√ßar a imensid√£o e empurrar os in√©ditos.  A mem√≥ria do controlador, como o meu tempo, n√£o √© ilimitada. </p><br><p>  A pr√≥xima pergunta mais popular √©: ‚Äú <strong><em>Voc√™ planeja produzir em massa ShIoTiny?</em></strong>  "  Eu responderei em detalhes.  <strong><em>No momento</em></strong> eu tenho mais algumas placas e se algu√©m estiver interessado - escreva, eu enviarei.  Se eles permanecerem at√© l√°, √© claro.  Em s√©rie (ou seja, 50 a 100 pe√ßas), novamente, no momento n√£o pretendo liber√°-lo.  Simplesmente n√£o existe essa demanda, e deixar dizer que 50 placas n√£o √© t√£o f√°cil para um hobby e vai me custar muito.  Muitos v√£o querer receber uma taxa pronta - a situa√ß√£o pode mudar.  <em>Ent√£o, se n√£o tudo, depende muito da opini√£o e desejo da sociedade.</em> </p><br><p>  Outra pergunta feita com muita frequ√™ncia: ‚Äú <strong><em>onde conseguir a fonte?</em></strong>  "  Eu respondo.  Em nenhum outro lugar.  Por alguma raz√£o, ainda n√£o posso public√°-las e n√£o sei se posso no futuro pr√≥ximo. </p><br><p>  E, finalmente, perguntas sobre <strong>multicast</strong> <strong>MQTT</strong> e <strong>UDP</strong> .  Espero fazer um artigo separado sobre essas quest√µes, porque h√° muitos recursos.  Algo sobre o <strong>MQTT</strong> est√° no artigo anterior sobre o sistema de ventila√ß√£o, mas tudo √© descrito l√° em termos gerais.  E ainda - leia as instru√ß√µes.  Existem muitas respostas, embora este ainda seja um rascunho. </p><br><p>  Isso termina com perguntas populares e finalmente lida com o que este artigo foi escrito - o mundo incr√≠vel, bonito, assustador e misterioso dos sensores. </p><br><h4 id="datchik--chto-eto-i-zachem-ono">  Sensor - o que √© e por que √©? </h4><br><p>  Qualquer inscri√ß√£o em um idioma desconhecido √© apenas um padr√£o complexo para algu√©m que nunca viu letras ou hier√≥glifos.  N√£o h√° fotos para cegos.  Para os surdos, m√∫sica.  Por que eu estou?  E o fato de que a <em>informa√ß√£o</em> √© uma exibi√ß√£o condicional de um objeto ou fen√¥meno em algum meio material.  Informa√ß√µes sem um meio material n√£o existe.  Assim como a informa√ß√£o n√£o existe sem algu√©m capaz de entend√™-la. </p><br><p>  Portanto, se queremos que nosso <strong>ShIoTiny</strong> n√£o seja "cego", "surdo" e "analfabeto" - devemos ensin√°-lo a " <em>perceber</em> " e " <em>entender</em> " as informa√ß√µes sobre o mundo ao seu redor e, com base nisso, tomar certas decis√µes para gerenciar o que √© necess√°rio nos equipamentos. </p><br><p>  As informa√ß√µes sobre o mundo existem em uma ampla variedade de representa√ß√µes e em v√°rios suportes de materiais: vibra√ß√µes do ar - fluxo de som e f√≥ton - luz;  a concentra√ß√£o de vapor de √°gua no ar e a temperatura da terra;  a presen√ßa ou aus√™ncia de massa e sua magnitude.  E assim por diante  Tudo isso pode levar para n√≥s as informa√ß√µes necess√°rias para a tomada de decis√µes. </p><br><p>  Mas nosso microcontrolador <strong>ESP8266</strong> - a base do <strong>ShIoTiny</strong> - compreende apenas dois tipos de informa√ß√µes - sinais bin√°rios digitais <strong>0V</strong> - <strong>3V</strong> e sinais anal√≥gicos na faixa de <strong>0V</strong> a <strong>1V</strong> . </p><br><p>  Portanto, precisamos de " <strong>tradutores</strong> " do idioma de um fen√¥meno f√≠sico espec√≠fico ou quantidade f√≠sica para o idioma dos sinais el√©tricos que sejam compreens√≠veis para o microcontrolador <strong>ESP8266</strong> .  Esses " <strong>tradutores</strong> " s√£o chamados <strong><em>sensores</em></strong> . </p><br><p>  A rigor, no nosso caso, o <strong><em>sensor</em></strong> √© uma ferramenta t√©cnica que converte informa√ß√µes sobre o mundo circundante em sinais el√©tricos que s√£o compreens√≠veis para os componentes eletr√¥nicos do controlador <strong>ShIoTiny</strong> . </p><br><p>  Sensores s√£o diferentes.  Existem milhares e trevas.  Mas se voc√™ come√ßar a entender, tudo n√£o √© t√£o assustador.  <em>Em primeiro lugar</em> , estamos interessados ‚Äã‚Äãapenas em sensores que geram um sinal el√©trico na sa√≠da.  <em>Em segundo lugar</em> , nos limitaremos apenas a tipos populares de sensores.  E <em>terceiro</em> , na pr√°tica, n√£o existem tantos tipos de sinais gerados pelos sensores. </p><br><p>  Desde o "primeiro" - tudo est√° claro.  √â fisicamente imposs√≠vel <strong>conectar um</strong> sensor diretamente ao <strong>ShIoTiny</strong> que forne√ßa informa√ß√µes na forma mec√¢nica, hidr√°ulica ou pneum√°tica. </p><br><p>  Com "em segundo lugar" - tudo tamb√©m est√° claro.  √â improv√°vel que algu√©m conecte detectores r√°pidos espec√≠ficos de part√≠culas ou medidores de pH em um l√≠tio radioativo fundido ao <strong>ShIoTiny</strong> .  Bem, se algu√©m tiver, acho que as qualifica√ß√µes dele s√£o muito mais altas que as minhas e ele provavelmente n√£o precisar√° deste artigo.  Mas a temperatura da √°gua ou do ar, a press√£o do ar ou da √°gua, a umidade, a luz, o n√≠vel do l√≠quido ou a condi√ß√£o da porta (aberta / fechada) - tudo isso pode muito bem ser medido pelo controlador ShIoTiny nos sistemas de controle dom√©stico. </p><br><p>  N√≥s vamos lidar com o "terceiro".  Quais sinais el√©tricos s√£o geralmente emitidos por tipos comuns de sensores?  Podem ser distinguidos tr√™s tipos principais de sinais nas sa√≠das dos sensores: </p><br><p>  <strong>Sinais bin√°rios</strong>  Ou seja, sinais que possuem apenas dois n√≠veis - l√≥gico 0 ou l√≥gico 1. Os par√¢metros el√©tricos n√£o s√£o importantes - eles sempre podem ser convertidos nos n√≠veis desejados. </p><br><p>  <strong>Sinais anal√≥gicos</strong> .  Ou seja, corrente ou tens√£o, variando dependendo do par√¢metro medido em um determinado intervalo de valores. </p><br><p>  <strong>Sinais digitais</strong> .  Estes s√£o sensores que se comunicam com microcontroladores usando um protocolo espec√≠fico. </p><br><p>  Aqui, talvez, estejam todas as op√ß√µes que podem ser conectadas ao <strong>ShIoTiny</strong> .  Obviamente, tamb√©m existem sensores com sa√≠da de frequ√™ncia, sa√≠da de fase e sensores com todos os tipos de sinais de sa√≠da ex√≥ticos.  Mas como √© <strong>imposs√≠vel</strong> conect√°-los diretamente ao <strong>ShIoTiny,</strong> n√£o falaremos sobre eles agora. </p><br><h4 id="binarnye-vhody-shiotiny">  Entradas bin√°rias ShIoTiny </h4><br><p>  Vamos come√ßar com o mais simples - com as entradas bin√°rias <strong>ShIoTiny</strong> .  Eles s√£o indicados pelas <strong>entradas1</strong> , <strong>entrada2</strong> e <strong>entrada3</strong> .  Como essas entradas s√£o absolutamente id√™nticas, consideraremos a entrada <strong>Input1</strong> .  Tudo o que √© dito sobre esta entrada √© igualmente verdadeiro para as outras duas entradas bin√°rias - <strong>Entrada2</strong> e <strong>Entrada3</strong> . </p><br><p>  O <strong>circuito de</strong> entrada bin√°ria <strong>ShIoTiny √©</strong> mostrado na figura.  Fa√ßa imediatamente uma reserva, o circuito com uma pequena falha - era necess√°rio conectar um resistor de <strong>10K</strong> a um resistor de <strong>1K</strong> .  Mas isso n√£o afeta a opera√ß√£o do dispositivo e √© maravilhoso.  Ent√£o, por que existem tantos elementos em um circuito de entrada bin√°rio?  Essa pergunta tamb√©m foi feita para mim.  Vou tentar responder. </p><br><p><img src="https://habrastorage.org/webt/eo/ff/qh/eoffqhr5eib1g5jwc1wa5mojsyc.gif" alt="imagem"></p><br><p>  A entrada bin√°ria no <strong>ShIoTiny</strong> funciona em <strong>contatos</strong> " <em>secos</em> " e " <em>√∫midos</em> ".  Al√©m disso, o circuito fornece prote√ß√£o contra sobretens√£o (ou seja, se, por exemplo, 5 Volts em vez de 3 Volts chegar √† <strong>Entrada1</strong> , por exemplo). </p><br><h4 id="zaschita-binarnogo-vhoda">  Prote√ß√£o de entrada bin√°ria </h4><br><p>  <strong>A</strong> prote√ß√£o contra <strong>sobretens√£o</strong> , que √© feita em todas as entradas bin√°rias do <strong>ShIoTiny</strong> , obviamente n√£o salvar√° o controlador do burnout, se uma tens√£o de ~ 220V for aplicada √† sua entrada.  Mas, desde as entradas <strong>Input1,2,3</strong> <strong>+ 5V</strong> ou at√© <strong>+ 12V</strong> - essa prote√ß√£o economiza completamente. </p><br><p>  Essa prote√ß√£o funciona de maneira muito simples e pode ser aplicada n√£o apenas com o <strong>ESP8266</strong> , mas tamb√©m com outros microcontroladores. </p><br><p>  Considere duas op√ß√µes para a prote√ß√£o: ao aplicar tens√£o de <strong>+ 5V</strong> e <strong>-5V</strong> ao fio neutro ( <strong>terra</strong> ) √† entrada da <strong>Entrada1</strong> . </p><br><p>  Quando a tens√£o na entrada <strong>Entrada1</strong> √© normal, os diodos de prote√ß√£o <strong>D1</strong> e <strong>D2</strong> s√£o fechados, pois s√£o ligados na dire√ß√£o oposta. </p><br><p>  Assim que a tens√£o na <strong>entrada1</strong> exceder + 3V (por exemplo, <strong>reduzimos</strong> a <strong>entrada1</strong> a <strong>+ 5V</strong> ), o diodo <strong>D1</strong> abre e puxa a entrada do controlador <strong>GPIO</strong> para <strong>+3V</strong> , impedindo que a tens√£o no <strong>GPIO ESP8266</strong> suba acima de <strong>3V</strong> .  Na verdade, a tens√£o ser√° ligeiramente superior a <strong>3V</strong> (3,2V ou 3,3V) - mas isso n√£o √© importante.  A entrada do microcontrolador n√£o queima e isso √© importante. </p><br><p>  Assim que a tens√£o na <strong>Entrada1</strong> se tornar negativa (por exemplo, colocamos a entrada em curto-circuito em <strong>-5V</strong> ), o diodo <strong>D2 se</strong> abre e puxa a <strong>Entrada1</strong> para o <strong>terra</strong> <strong>0V</strong> , n√£o deixando a tens√£o na entrada <strong>GPIO ESP8266</strong> cair abaixo de <strong>0V</strong> .  Na verdade, a tens√£o ser√° ligeiramente menor que <strong>0V</strong> (-0,2V ou -0,3V) - mas isso tamb√©m n√£o √© importante.  A entrada do microcontrolador n√£o queima. </p><br><p>  O resistor <strong>1K</strong> √© um limitador de corrente para que n√£o haja curto-circuito durante a opera√ß√£o de prote√ß√£o.  As correntes atrav√©s dele s√£o pequenas.  Por exemplo, em nosso exemplo, se <strong>aplicarmos Entrada1</strong> <strong>+ 5V</strong> √† entrada, a corrente atrav√©s do resistor de <strong>1K</strong> ser√° de cerca de <strong>2mA</strong> .  Com uma tens√£o negativa de <strong>-5V</strong> na entrada <strong>Input1, a</strong> corrente atrav√©s do resistor de <strong>1K</strong> ser√° de cerca de <strong>5mA</strong> . </p><br><p>  Se algu√©m n√£o entender por que os diodos abrem e fecham, recomendo a leitura do livro <strong>"Electronics Step by Step", de R. A. Svorenya</strong> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Na Internet, √©, por exemplo, aqui</a> .  Aconselho especialmente os iniciantes - o idioma deste livro √© simples e h√° muitos exemplos. </p><br><h4 id="kakie-byvayut-kontakty">  Quais s√£o os contatos </h4><br><p>  Ent√£o, com a prote√ß√£o resolvida.  Vamos para outra quest√£o fundamental - conectar a entrada bin√°ria <strong>ShIoTiny</strong> a sensores bin√°rios. </p><br><p>  Como j√° dissemos, sensores bin√°rios s√£o sensores cuja sa√≠da possui dois estados - zero e um.  Mas isso √© l√≥gico.  E fisicamente pode haver duas op√ß√µes para as sa√≠das bin√°rias do sensor: " <strong>contato seco</strong> " e " <strong>contato √∫mido</strong> ".  Considere o que √© e com o que √© comido. </p><br><p>  Um " <strong>contato seco</strong> " √© um contato que n√£o possui sua pr√≥pria fonte de tens√£o.  Ou seja, apenas dois condutores de metal que podem ser colocados em curto e abri-los.  Esta defini√ß√£o inclui a massa de sensores - bot√µes, interruptores, sensores de flutua√ß√£o para n√≠vel de l√≠quido, interruptores de palheta (sensores de campo magn√©tico) e assim por diante.  Nos circuitos el√©tricos, <strong>os</strong> " <strong>contatos secos</strong> " <strong>normalmente abertos</strong> s√£o geralmente indicados como mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/vt/rc/ya/vtrcyaeq7yo2o4hdju-2edxx_7w.png" alt="imagem"></p><br><p>  Normalmente aberto - significa aberto quando n√£o h√° influ√™ncia externa - o bot√£o n√£o √© pressionado, o interruptor n√£o est√° ligado, o interruptor reed n√£o possui um √≠m√£ por perto ... </p><br><p>  Tamb√©m existem ‚Äú <strong>contatos secos</strong> ‚Äù <strong>normalmente fechados</strong> .  Nos circuitos el√©tricos, eles geralmente s√£o indicados como mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/ze/mj/lj/zemjljubtoz6y8gldzq6gb5qznq.png" alt="imagem"></p><br><p>  Ao contr√°rio dos " <strong>contatos secos</strong> " normalmente abertos, normalmente fechados, na aus√™ncia de influ√™ncias externas, s√£o fechados. </p><br><p>  Esses e outros " <strong>contatos secos</strong> " podem ser conectados com seguran√ßa √†s entradas <strong>Sh1oTiny do</strong> controlador <strong>Input1,2,3</strong> .  Sensores com sa√≠da do tipo <strong>contato seco</strong> s√£o <strong>conectados √†s</strong> entradas bin√°rias <strong>ShIoTiny,</strong> como mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/8j/fs/8i/8jfs8i8xydqsyuirvrrtihvotly.gif" alt="imagem"></p><br><p>  Se o " <strong>contato seco</strong> " da <strong>Entrada1</strong> for fechado, a tens√£o de aproximadamente zero volt ser√° aplicada √† entrada do controlador (mais precisamente, 0,3 Volts devido a um erro no circuito), uma vez que o " <strong>contato seco</strong> " fecha a entrada do controlador para aterrar atrav√©s de um divisor formado por resist√™ncias de <strong>1K</strong> e <strong>10K</strong> .  Nesse caso, o <em>n√≥</em> <strong>Input1</strong> configurar√° a unidade para sa√≠da. </p><br><p>  Por outro lado, se o <strong>contato seco da</strong> <strong>Entrada1 estiver</strong> aberto, aproximadamente tr√™s volts ser√£o fornecidos √† entrada do controlador, uma vez que a entrada do controlador √© puxada para a tens√£o de alimenta√ß√£o atrav√©s de um resistor de <strong>10K</strong> .  Nesse caso, o n√≥ <strong>Input1</strong> definir√° zero em sua sa√≠da. </p><br><p>  Toda esta descri√ß√£o detalhada √© para os curiosos.  Na linha inferior, temos o seguinte: se conectarmos um sensor com uma sa√≠da do tipo ‚Äú <strong>contato seco</strong> ‚Äù √† <strong>entrada1</strong> , quando o contato estiver aberto, a sa√≠da do n√≥ <strong>Input1</strong> ser√° zero e, quando o contato for fechado, a sa√≠da do mesmo n√≥ ser√° uma.  Da mesma forma para entradas e n√≥s <strong>Input2</strong> e <strong>Input3</strong> . </p><br><p>  Vamos para <strong>contatos molhados</strong> . </p><br><p>  Um " <strong>contato √∫mido</strong> " √© um contato que possui sua pr√≥pria fonte de tens√£o em pelo menos uma de suas posi√ß√µes.  Por exemplo, a sa√≠da de outro controlador ou circuito l√≥gico;  linha de energia da l√¢mpada e assim por diante.  Pode haver muitas op√ß√µes aqui.  Mas quase todos eles diretamente ou com a ajuda de v√°rios detalhes permitem a entrada <strong>das</strong> entradas bin√°rias <strong>Input1,2,3</strong> com a sa√≠da do dispositivo - ‚Äú <strong>contato molhado</strong> ‚Äù. </p><br><p>  Vamos come√ßar com o mais simples: combinar a entrada <strong>Input1</strong> com a sa√≠da do sensor ou microcircuito do tipo " <strong>coletor aberto</strong> " ou " <strong>dreno aberto</strong> ". </p><br><p>  De fato, <strong><em>no nosso caso</em></strong> , esse circuito √© completamente an√°logo √† conex√£o de um sensor com uma <strong>sa√≠da de contato seco</strong> .  Somente a fun√ß√£o do contato √© realizada pelo transistor. </p><br><p>  O esquema dessa conex√£o √© mostrado na figura.  A ess√™ncia do conceito de ‚Äú <strong>coletor aberto</strong> ‚Äù ou ‚Äú <strong>dreno aberto</strong> ‚Äù √© que o <strong>emissor</strong> (ou <strong>fonte</strong> ) do transistor de sa√≠da est√° conectado ao ‚Äú <strong>terra</strong> ‚Äù (geralmente dentro do microcircuito) e o <strong>coletor</strong> (ou <strong>dreno</strong> ) est√° conectado √† ‚Äúperna‚Äù do microcircuito e mais para nada. </p><br><p>  Como esse esquema funciona √© compreens√≠vel para um iniciante (n√£o um g√°s imagin√°rio, mas uma pessoa!).  Assim que o transistor dentro do microcircuito √© aberto, ele fecha a entrada <strong>Input1</strong> para o aterramento e tudo funciona por analogia com um contato " <strong>seco</strong> ". </p><br><img src="https://habrastorage.org/webt/tl/__/nh/tl__nhsp-3hwmb1eztprk1lxo0g.gif"><br><p>  Infelizmente, nem todos os microchips e sensores t√™m uma sa√≠da t√£o maravilhosa com um coletor ou dreno aberto.  Muitos, se n√£o a maioria dos chips e sensores, t√™m uma sa√≠da ativa.  Isso significa que, quando temos uma unidade l√≥gica na sa√≠da, a sa√≠da √© "puxada" para a tens√£o de alimenta√ß√£o e, quando um zero l√≥gico, a sa√≠da √© "puxada" para o ch√£o.  A sa√≠da desse chip √© mostrada na figura abaixo.  Claro, tudo √© simplificado. </p><br><img src="https://habrastorage.org/webt/ll/9p/ca/ll9pcawme5kebyua--xi9hscacu.gif"><br><p>  O que devemos fazer se o microcircuito ou sensor que queremos conectar √† <strong>Entrada1</strong> tiver uma sa√≠da t√£o ativa? </p><br><p>  Existem duas op√ß√µes aqui e elas dependem do valor da tens√£o de alimenta√ß√£o do microcircuito ou do sensor <strong>Vcc</strong> . </p><br><p>  Se a tens√£o de alimenta√ß√£o do chip ou do sensor <strong>Vcc</strong> for a mesma do <strong>ESP8266</strong> (ou seja, 3 Volts), voc√™ poder√° simplesmente conectar essa sa√≠da √† entrada <strong>Input1</strong> , que √© realmente mostrada na figura anterior. </p><br><p>  Mas e se a fonte de alimenta√ß√£o do sensor ou do microcircuito for <strong>+ 5V</strong> ou <strong>+ 12V</strong> ?  No nosso caso, voc√™ pode fazer isso simplesmente ativando o diodo Schottky, como mostra a figura abaixo. </p><br><img src="https://habrastorage.org/webt/xo/ig/mh/xoigmhvkz7mjgd4htvm2ygddtq8.gif"><br><p>  E mais uma nuance: todos os circuitos com um contato " <strong>√∫mido</strong> " nos d√£o um <strong>sinal inverso</strong> .  Ou seja, quando a unidade l√≥gica estiver na sa√≠da do sensor ou microcircuito, o n√≥ <strong>Input1</strong> definir√° a sa√≠da como zero.  E vice-versa.  Mas isso √© corrigido programaticamente - basta inserir o n√≥ do inversor no circuito.  Tudo isso √© mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/va/xh/te/vaxhteujl9fg9mlmom0ex2hijgm.png" alt="imagem"></p><br><p>  Na verdade, isso √© tudo que voc√™ precisa saber sobre como conectar sensores √†s entradas bin√°rias <strong>Input1,2,3</strong> . </p><br><p>  Obviamente, teoricamente, pode haver outras op√ß√µes, mas mostrei as maneiras mais simples e comuns de conectar sensores a sa√≠das como " <strong>contato seco</strong> " e sa√≠das ativas de baixa tens√£o. </p><br><h4 id="trepet-kontaktov">  Emo√ß√£o de contato </h4><br><p>  Contatos tremem.  N√£o por medo do criador do dispositivo, mas pelo fato de serem resilientes.  Quando voc√™ pressiona o bot√£o, os contatos podem abrir de 5 a 7 vezes antes de serem fechados de forma est√°vel.  O mesmo fen√¥meno ocorre quando os bot√µes s√£o liberados.  E esse fen√¥meno √© chamado - " <strong>rejei√ß√£o de contatos</strong> ". </p><br><p>  <strong>O ressalto de contato</strong> √© a maldi√ß√£o de todos os sensores de contato mec√¢nicos - interruptores, bot√µes, interruptores de palheta e assim por diante.  A conversa desagrad√°vel √© que causa cliques falsos ou lan√ßamentos falsos de um bot√£o ou contato. </p><br><p>  Existem v√°rias maneiras de lidar com esse fen√¥meno desagrad√°vel.  Provavelmente, a maneira mais antiga de lutar √© o <strong>gatilho</strong> .  Com este m√©todo, √© usado um bot√£o com um contato de comuta√ß√£o e um acionador RS normal, que s√£o ativados de acordo com o esquema, conforme mostrado na figura. </p><br><p><img src="https://habrastorage.org/webt/1s/lm/yo/1slmyoteklx46ct9nfgjt-hevtk.png" alt="imagem"></p><br><p>  Como isso funciona?  Muito simples  Um gatilho tem dois estados.  Enquanto o bot√£o est√° fechado para a entrada <strong>R do</strong> gatilho, a sa√≠da <strong>Q do</strong> gatilho √© ajustada para zero. </p><br><p>  Pressionamos o bot√£o - at√© o contato do meio tocar o fundo - nada muda, a sa√≠da do gatilho √© zero.  Assim que o contato do meio do bot√£o tocou o contato inferior do mesmo bot√£o e fechou a entrada do gatilho <strong>S</strong> no terra, um aparece na sa√≠da do gatilho.  E esta unidade permanece enquanto os contatos "chocalham".  De fato, para voltar a zero a sa√≠da do gatilho, √© necess√°rio que a entrada <strong>R</strong> do gatilho seja encurtada!  Este esquema funciona exatamente da mesma maneira quando voc√™ solta o bot√£o. </p><br><p>  Podemos fazer um circuito assim no <strong>ShIoTiny</strong> ?  Sim, n√£o tem problema!  Na figura, √© mostrado. </p><br><p><img src="https://habrastorage.org/webt/hz/p2/yg/hzp2yg7lx4zo7i6ko8lyok3iikk.png" alt="imagem"></p><br><p>  Mas gaste duas de suas tr√™s entradas em um sensor ?!  Al√©m disso, nem todos os sensores t√™m um contato de comuta√ß√£o! </p><br><p>  N√£o, seguiremos o outro caminho, como legado, a todos os engenhosos te√≥ricos V.I.  Ulyanov! </p><br><p>  A segunda, e provavelmente a mais comum hoje, a maneira de lidar com o ressalto de contato √© um <strong>filtro de software</strong> . </p><br><p>  O que est√° por tr√°s dessas palavras inteligentes?  E novamente - nada complicado.  Imagine que n√£o responderemos a mudan√ßas "curtas" no estado dos contatos.  Por exemplo, se lermos zero a partir do bot√£o, em breves unidades (digamos, a dura√ß√£o √© inferior a 0,3 segundos), <del>  vamos martelar </del>  pare de reagir.  E somente quando tivermos um bot√£o por 0,3 segundos emitiremos uma unidade continuamente - responderemos a isso.  A mesma coisa ao alterar o estado de um bot√£o de um para zero. </p><br><p>     ‚Äî    ,   .         .         RS-! </p><br><p>     ?  <strong>ShIoTiny</strong>  -,          . </p><br><p><img src="https://habrastorage.org/webt/-t/tv/hq/-ttvhqvwjzrj1_8f0rzuztiugz4.png" alt="imagem"></p><br><p>  <strong>Delay0/1</strong>      ,     <strong>0.4</strong> . </p><br><p> ,          .   ,   ,      . </p><br><h4 id="zaklyuchenie">  Conclus√£o </h4><br><p>       ,       ‚Äî ,     ,       . </p><br><p>              <strong></strong> . </p><br><p>  , , , ,    ‚Äî  : shiotiny@yandex.ru </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt466231/">https://habr.com/ru/post/pt466231/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt466215/index.html">Projeto orientado a modelo. Cria√ß√£o de um modelo confi√°vel, usando o exemplo de um trocador de calor para avia√ß√£o</a></li>
<li><a href="../pt466217/index.html">Gerando documentos usando o ONLYOFFICE DocumentBuilder</a></li>
<li><a href="../pt466223/index.html">Decomposi√ß√£o limpa</a></li>
<li><a href="../pt466227/index.html">Programa√ß√£o Orientada a N√≥s</a></li>
<li><a href="../pt466229/index.html">Como comprar dez caixas de algod√£o e n√£o cometer erros</a></li>
<li><a href="../pt466235/index.html">Munch em uma varredura equidistante e Meyerhold, que destruiu a Pra√ßa Vermelha - Denis Semenov sobre VR art</a></li>
<li><a href="../pt466237/index.html">Como o junior green escreveu seu hot-reloader</a></li>
<li><a href="../pt466247/index.html">Entrevista Introvertida</a></li>
<li><a href="../pt466249/index.html">Escrevendo uma cobra para Android em Kivy, Python</a></li>
<li><a href="../pt466251/index.html">Bombeando o projeto do Soft Launch para US $ 1 milh√£o em receita por m√™s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>