<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤜🏻 #⃣ 🧤 Muat pengujian dengan belalang. Bagian 2 👩🏻‍🏫 ⚕️ 🖖🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bagi mereka yang menyukai artikel saya sebelumnya , saya terus membagikan kesan saya tentang alat pengujian stres Locust. 

 Saya akan mencoba untuk m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Muat pengujian dengan belalang. Bagian 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/infopulse/blog/430810/">  Bagi mereka yang menyukai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel</a> saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sebelumnya</a> , saya terus membagikan kesan saya tentang alat pengujian stres Locust. <br><br>  Saya akan mencoba untuk menunjukkan dengan jelas keuntungan menulis python uji beban dengan kode di mana Anda dapat dengan mudah menyiapkan data apa pun untuk pengujian dan memproses hasilnya. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/decfhwQPd9E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br><h2>  Pemrosesan respons server </h2><br>  Terkadang dalam pengujian beban, tidak cukup hanya mendapatkan 200 OK dari server HTTP.  Terjadi, perlu untuk memeriksa isi dari respons untuk memastikan bahwa di bawah memuat server mengeluarkan data yang benar atau melakukan perhitungan yang akurat.  Hanya untuk kasus-kasus seperti itu, Locust menambahkan kemampuan untuk menimpa parameter keberhasilan respons server.  Perhatikan contoh berikut: <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> rnd <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_albums</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> photo_id = rnd.randint(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">f'/photos/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{photo_id}</span></span></span><span class="hljs-string">'</span></span>, catch_response=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, name=<span class="hljs-string"><span class="hljs-string">'/photos/[id]'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> response: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> response.status_code == <span class="hljs-number"><span class="hljs-number">200</span></span>: album_id = response.json().get(<span class="hljs-string"><span class="hljs-string">'albumId'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> album_id % <span class="hljs-number"><span class="hljs-number">10</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span>: response.success() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: response.failure(<span class="hljs-string"><span class="hljs-string">f'album id cannot be </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{album_id}</span></span></span><span class="hljs-string">'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: response.failure(<span class="hljs-string"><span class="hljs-string">f'status code is </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{response.status_code}</span></span></span><span class="hljs-string">'</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">1000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">2000</span></span></code> </pre> <br>  Itu hanya memiliki satu permintaan, yang akan membuat beban dalam skenario berikut: <br><blockquote>  Dari server, kami meminta objek foto dengan id acak dalam kisaran 1 hingga 5.000 dan memeriksa id album di objek ini, dengan asumsi bahwa itu tidak boleh kelipatan 10 <br></blockquote>  Di sini Anda dapat langsung memberikan beberapa penjelasan: <br><br><ul><li>  konstruksi mengagumkan <i>dengan request () sebagai respons:</i> Anda berhasil menggantinya dengan <i>response = request ()</i> dan bekerja secara diam-diam dengan objek respons </li><li>  URL dibentuk menggunakan sintaks format string yang ditambahkan dengan python 3.6, jika saya tidak salah - <i>f '/ photos / {photo_id}'</i> .  Di versi sebelumnya, desain ini tidak akan berfungsi! </li><li>  argumen baru yang belum pernah kami gunakan sebelumnya, <i>catch_response = Benar</i> , memberi tahu Locust bahwa kami sendiri yang akan menentukan keberhasilan respons server.  Jika Anda tidak menentukannya, maka kami akan menerima objek respons dengan cara yang sama dan dapat memproses datanya, tetapi tidak mendefinisikan ulang hasilnya.  Di bawah ini adalah contoh terperinci. </li><li>  <i>Nama</i> argumen lain <i>= '/ foto / [id]'</i> .  Diperlukan untuk mengelompokkan permintaan dalam statistik.  Nama dapat berupa teks apa pun, url berulang tidak diperlukan.  Tanpa itu, setiap permintaan dengan alamat atau parameter unik akan direkam secara terpisah.  Begini cara kerjanya: <br></li></ul><br><img src="https://habrastorage.org/webt/ai/fm/ca/aifmcaycbzv9khpohj5sxjcohgo.png"><br>  Menggunakan argumen yang sama, Anda dapat melakukan trik lain - kadang-kadang terjadi bahwa satu layanan dengan parameter yang berbeda (misalnya, konten permintaan POST yang berbeda) melakukan logika yang berbeda.  Agar hasil pengujian tidak campur aduk, Anda dapat menulis beberapa tugas terpisah, menentukan untuk masing-masing <i>nama</i> argumennya sendiri. <br><br>  Selanjutnya kita lakukan pengecekan.  Saya memiliki 2 di antaranya. Pertama, kami memverifikasi bahwa server mengembalikan jawaban jika <i>response.status_code == 200</i> : <br><br>  Jika ya, maka periksa apakah id album adalah kelipatan 10. Jika tidak kelipatan, maka tandai jawaban ini sebagai <i>respons yang</i> berhasil.success <i>()</i> <br><br>  Dalam kasus lain, kami menunjukkan mengapa respons gagal <i>response.failure ('teks kesalahan')</i> .  Teks ini akan ditampilkan pada halaman Kegagalan selama pengujian. <br><br><img src="https://habrastorage.org/webt/52/se/dt/52sedt-fqe0jhasmdnq3k94ia7m.png"><br><br>  Juga, pembaca yang penuh perhatian dapat memperhatikan tidak adanya Pengecualian yang merupakan karakteristik dari kode yang bekerja dengan antarmuka jaringan.  Memang, dalam kasus batas waktu, kesalahan koneksi dan insiden tak terduga lainnya, Locust akan menangani kesalahan dan masih mengembalikan respons, menunjukkan, bagaimanapun, status kode respons adalah 0. <br><br>  Jika kode masih melempar Pengecualian, kode itu akan ditulis ke tab Pengecualian saat runtime sehingga kami dapat menanganinya.  Situasi yang paling khas adalah bahwa json'e dari jawaban tidak mengembalikan nilai yang kita cari, tetapi kita sudah melakukan operasi berikut di atasnya. <br><br>  Sebelum menutup topik - dalam contoh saya menggunakan server json untuk kejelasan, karena lebih mudah untuk memproses tanggapan.  Tetapi dengan kesuksesan yang sama Anda dapat bekerja dengan HTML, XML, FormData, lampiran file, dan data lain yang digunakan oleh protokol berbasis HTTP. <br><br><h2>  Bekerja dengan skenario yang kompleks </h2><br>  Hampir setiap kali tugasnya adalah untuk melakukan pengujian beban aplikasi web, dengan cepat menjadi jelas bahwa tidak mungkin untuk menyediakan cakupan yang layak dengan layanan GET saja - yang hanya mengembalikan data. <br><br>  Contoh klasik: untuk menguji toko online, diharapkan bahwa pengguna <br><br><ol><li>  Membuka toko utama </li><li>  Saya mencari barang </li><li>  Rincian item yang dibuka </li><li>  Menambahkan item ke troli </li><li>  Dibayar </li></ol><br>  Dari contoh, kita dapat mengasumsikan bahwa layanan panggilan dalam urutan acak tidak akan berfungsi, hanya secara berurutan.  Selain itu, barang, keranjang, dan bentuk pembayaran mungkin memiliki pengidentifikasi unik untuk setiap pengguna. <br><br>  Menggunakan contoh sebelumnya, dengan modifikasi kecil, Anda dapat dengan mudah menerapkan pengujian skenario seperti itu.  Kami mengadaptasi contoh untuk server pengujian kami: <br><br><ol><li>  Pengguna sedang menulis posting baru. </li><li>  Pengguna menulis komentar pada posting baru </li><li>  Pengguna membaca komentar </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FlowException</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Exception)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check_flow</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># step 1 new_post = {'userId': 1, 'title': 'my shiny new post', 'body': 'hello everybody'} post_response = self.client.post('/posts', json=new_post) if post_response.status_code != 201: raise FlowException('post not created') post_id = post_response.json().get('id') # step 2 new_comment = { "postId": post_id, "name": "my comment", "email": "test@user.habr", "body": "Author is cool. Some text. Hello world!" } comment_response = self.client.post('/comments', json=new_comment) if comment_response.status_code != 201: raise FlowException('comment not created') comment_id = comment_response.json().get('id') # step 3 self.client.get(f'/comments/{comment_id}', name='/comments/[id]') if comment_response.status_code != 200: raise FlowException('comment not read') class WebsiteUser(HttpLocust): task_set = UserBehavior min_wait = 1000 max_wait = 2000</span></span></code> </pre> <br>  Dalam contoh ini, saya menambahkan kelas <b>FlowException</b> baru.  Setelah setiap langkah, jika tidak berjalan seperti yang diharapkan, saya melempar kelas pengecualian ini untuk mengganggu skrip - jika posting tidak berfungsi, maka tidak akan ada komentar, dll.  Jika diinginkan, konstruksi dapat diganti dengan pengembalian yang biasa, tetapi dalam kasus ini, saat runtime dan ketika menganalisis hasilnya, tidak akan begitu jelas di mana skrip yang dijalankan jatuh pada tab Pengecualian.  Untuk alasan yang sama, saya tidak menggunakan <b>coba ... kecuali</b> membangun. <br><br><h2>  Membuat beban menjadi realistis </h2><br>  Sekarang saya dapat dicela - dalam kasus toko semuanya benar-benar linier, tetapi contoh dengan posting dan komentar terlalu dibuat-buat - mereka membaca posting 10 kali lebih sering daripada yang mereka buat.  Secara masuk akal, mari kita membuat contoh lebih layak.  Dan setidaknya ada 2 pendekatan: <br><br><ol><li>  Anda dapat “meng-hardcode” daftar posting yang dibaca pengguna dan menyederhanakan kode pengujian jika ada kemungkinan dan fungsionalitas backend tidak bergantung pada posting tertentu </li><li>  Simpan posting yang dibuat dan baca jika tidak mungkin untuk mengatur daftar posting atau beban realistis tergantung pada posting mana yang dibaca (Saya menghapus pembuatan komentar dari contoh untuk membuat kodenya lebih kecil dan lebih visual) </li></ol><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> r <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> created_posts = [] @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_post</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> new_post = {<span class="hljs-string"><span class="hljs-string">'userId'</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'title'</span></span>: <span class="hljs-string"><span class="hljs-string">'my shiny new post'</span></span>, <span class="hljs-string"><span class="hljs-string">'body'</span></span>: <span class="hljs-string"><span class="hljs-string">'hello everybody'</span></span>} post_response = self.client.post(<span class="hljs-string"><span class="hljs-string">'/posts'</span></span>, json=new_post) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> post_response.status_code != <span class="hljs-number"><span class="hljs-number">201</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> post_id = post_response.json().get(<span class="hljs-string"><span class="hljs-string">'id'</span></span>) self.created_posts.append(post_id) @task(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_post</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(self.created_posts) == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> post_id = r.choice(self.created_posts) self.client.get(<span class="hljs-string"><span class="hljs-string">f'/posts/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{post_id}</span></span></span><span class="hljs-string">'</span></span>, name=<span class="hljs-string"><span class="hljs-string">'read post'</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">1000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">2000</span></span></code> </pre> <br>  Di kelas <b>UserBehavior,</b> saya membuat daftar <b>Created_posts</b> .  Berikan perhatian khusus - ini adalah objek dan itu tidak dibuat dalam konstruktor dari kelas <b>__init __ (),</b> oleh karena itu, tidak seperti sesi klien, daftar ini umum untuk semua pengguna.  Tugas pertama membuat posting dan menulis id ke daftar.  Yang kedua - 10 kali lebih sering, membaca satu posting yang dipilih secara acak dari daftar.  Kondisi tambahan dari tugas kedua adalah untuk memeriksa apakah ada tulisan yang dibuat. <br><br>  Jika kami ingin setiap pengguna hanya mengoperasikan dengan data mereka sendiri, kami dapat mendeklarasikannya dalam konstruktor sebagai berikut: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parent)</span></span></span><span class="hljs-function">:</span></span> super(UserBehavior, self).__init__(parent) self.created_posts = list()</code> </pre> <br><h2>  Beberapa fitur lainnya </h2><br>  Untuk peluncuran tugas berurutan, dokumentasi resmi menyarankan bahwa kami juga menggunakan anotasi tugas @seq_task (1), menentukan nomor seri tugas dalam argumen <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyTaskSequence</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSequence)</span></span></span><span class="hljs-class">:</span></span> @seq_task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">first_task</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> @seq_task(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">second_task</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> @seq_task(<span class="hljs-number"><span class="hljs-number">3</span></span>) @task(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">third_task</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre> <br>  Dalam contoh ini, setiap pengguna pertama-tama akan menjalankan <b>first_task</b> , lalu <b>second_task</b> , lalu 10 kali <b>third_task</b> . <br><br>  Terus terang, ketersediaan kesempatan seperti itu menggembirakan, tetapi, tidak seperti contoh sebelumnya, tidak jelas bagaimana mentransfer hasil dari tugas pertama ke yang kedua jika perlu. <br><br>  Juga, untuk skenario yang sangat kompleks, dimungkinkan untuk membuat set tugas bersarang, pada kenyataannya, membuat beberapa kelas TaskSet dan menghubungkan satu sama lain. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> locust <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> HttpLocust, TaskSet, task <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Todo</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> @task(<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/todos"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.interrupt() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserBehavior</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(TaskSet)</span></span></span><span class="hljs-class">:</span></span> tasks = {Todo: <span class="hljs-number"><span class="hljs-number">1</span></span>} @task(<span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">index</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) @task(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">posts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.client.get(<span class="hljs-string"><span class="hljs-string">"/posts"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebsiteUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HttpLocust)</span></span></span><span class="hljs-class">:</span></span> task_set = UserBehavior min_wait = <span class="hljs-number"><span class="hljs-number">1000</span></span> max_wait = <span class="hljs-number"><span class="hljs-number">2000</span></span></code> </pre> <br>  Dalam contoh di atas, dengan probabilitas 1 hingga 6, skrip <b>Todo</b> akan diluncurkan, dan akan dieksekusi hingga, dengan probabilitas 1 hingga 4, skrip tersebut akan kembali ke skrip <b>UserBehavior</b> .  Sangat penting bahwa Anda memiliki panggilan ke <b>self.interrupt ()</b> - tanpanya, pengujian akan fokus pada subtugas. <br><br>  Terima kasih sudah membaca.  Pada artikel terakhir saya akan menulis tentang pengujian terdistribusi dan pengujian tanpa UI, serta tentang kesulitan yang saya temui selama pengujian dengan Locust dan bagaimana cara mengatasinya. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id430810/">https://habr.com/ru/post/id430810/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id430800/index.html">Pembuatan game "Like Coins" di Godot Engine. Bagian 2</a></li>
<li><a href="../id430802/index.html">PMI RU: Studi gaji manajer proyek di Rusia untuk 2017</a></li>
<li><a href="../id430804/index.html">Baterai Tesla / Panasonic adalah baterai kendaraan listrik paling terjangkau di pasaran</a></li>
<li><a href="../id430806/index.html">Kami mulai belajar bahasa Inggris - menulis aplikasi: EWM - pengalaman dalam membuat proyek pelatihan</a></li>
<li><a href="../id430808/index.html">Teori Speaker: 16 materi tentang cara kerja speaker dan speaker</a></li>
<li><a href="../id430812/index.html">Apa yang developer.android.com bicarakan tentang RecyclerView</a></li>
<li><a href="../id430818/index.html">Akselerasi SQLAlchemy untuk Astronot Arsitektur</a></li>
<li><a href="../id430820/index.html">Black Friday 2018 - VDS di Moskow dan Amsterdam</a></li>
<li><a href="../id430822/index.html">Keamanan informasi Internet tentang hal-hal: siapa itu barangnya dan siapa tuannya?</a></li>
<li><a href="../id430824/index.html">Cari objek yang rusak dengan nomor halaman yang rusak di MS SQL Server 2005</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>