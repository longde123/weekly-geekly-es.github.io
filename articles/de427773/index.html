<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß£ üë©üèº‚Äçü§ù‚Äçüë©üèª ü•ê Ich habe eine browser√ºbergreifende Erweiterung f√ºr Registerkarten geschrieben, aber das tun Sie nicht üåã ü§≠ üïõ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eine lange, langwierige Einf√ºhrung mit einem Anspruch auf Gr√∂√üenwahn 
 Als ich entdeckte, dass wie immer etwas auf dieser Welt nicht sehr zu mir passt...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ich habe eine browser√ºbergreifende Erweiterung f√ºr Registerkarten geschrieben, aber das tun Sie nicht</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/427773/"><h3>  Eine lange, langwierige Einf√ºhrung mit einem Anspruch auf Gr√∂√üenwahn </h3><br>  Als ich entdeckte, dass wie immer etwas auf dieser Welt nicht sehr zu mir passte.  Wenn ich n√§mlich eine lange Abfrage in eine Suchmaschine auf einem Desktop-Computer eingebe und dann zu einem Tablet wechsle, kann ich mich nicht w√∂rtlich an den Text der Abfrage erinnern, um genau die gleichen Ergebnisse zu erzielen.  Alles begann so gut.  Ich sah in der Suchmaschine einen Link zur Antwort auf meine Frage und stellte fest, dass dies eine lange Lekt√ºre verspricht.  Dann schaltete ich den Computer aus und lie√ü mich mit dem Tablet auf das Sofa fallen, mit dem Gedanken, dass ich jetzt einfach alles wieder in die Suchmaschine tippe. Ich √∂ffne diesen Link jetzt auf dem Tablet und lege mich ruhig in eine bequemere Position. Ich lese ihn ... Aber nicht hier war.  Einige kleinere Abweichungen im Text - und mein Link befindet sich nicht mehr in der Suchmaschine.  Das Abspielen des Links selbst ist ebenfalls keine Option: Es ist zu lang.  Ich r√§tselte √ºber die Optionen f√ºr den Abfragetext und war fast w√ºtend dar√ºber, das Tablet zu zerbrechen.  Verdammt, ich musste aufstehen, den Computer wieder einschalten, den Browser starten und in den Verlauf eintauchen, um den genauen Text meiner Anfrage zu finden. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/96/4d/2c/964d2c1pum-7mihsz15k_6r1ayu.jpeg"></div><br>  <i>Erweiterung in Chrome und Firefox installiert</i> <br><a name="habracut"></a><br><h3>  Idee </h3><br>  Ich dachte, aber es w√§re sch√∂n, eine solche Erweiterung f√ºr den Browser zu schreiben, mit der Sie alle ge√∂ffneten Registerkarten √ºber den Server auf einen anderen Computer √ºbertragen und dort weiter mit ihnen arbeiten k√∂nnen.  Ja, einige Browser verf√ºgen bereits √ºber eine Cloud-Funktion. Sie m√ºssen sich lediglich bei beiden Ger√§ten anmelden und ... Aber das ist der Haken.  Aber was ist, wenn ich Chrome auf meinem Computer und Firefox auf meinem Tablet habe?  Und dann ... Loggen Sie sich einfach ein, ja.  Wenn ich mich noch an mein Passwort aus dem Google-Konto erinnere.  Und ich habe einfach kein Konto in Firefox.  Ich wei√ü nicht einmal, ob es dort Konten gibt.  Es gibt nat√ºrlich Cloud-Dienste von Drittanbietern, bei denen Sie sich registrieren und wahrscheinlich den gew√ºnschten Link zu sich selbst werfen k√∂nnen.  Es ist jedoch weiterhin erforderlich, sich dort zu registrieren und sich ein anderes Passwort zu merken ... Nein, das ist v√∂llig unrealistisch.  Am Ende k√∂nnen Sie sich einen Link durch die Mail werfen.  All dies dauert jedoch lange und das Kopieren und Einf√ºgen von und dann in die Adressleiste, was beispielsweise auf einem Tablet √§u√üerst unpraktisch ist.  Nein, das alles ist eine Art Unsinn ... <br><br>  Als ich auf der Couch lag, wurde mir langsam klar, dass all diese Aktionen zu viel Bewegung erfordern ... Nein, Leute, das geht nicht.  Und wenn ich verstehe, dass etwas auf dieser Welt nicht zu mir passt, setze ich mich hin, um Code zu schreiben und alles auf meine eigene Weise zu tun.  Ich dachte, dass ich in sozialen Netzwerken sowohl auf dem Tablet als auch auf dem Desktop-Computer autorisiert war.  Und das in verschiedenen Browsern, zum Beispiel auch auf demselben Computer.  Im Allgemeinen war die L√∂sung f√ºr mich offensichtlich - den Benutzer √ºber soziale Netzwerke zu authentifizieren. <br><br><h3>  Lyrischer Exkurs </h3><br>  √úbrigens, wenn ich etwas Eigenes schreibe, dann mache ich es auch auf meine eigene Weise.  Ich schreibe in reinem JavaScript in einem erweiterten Notizbuch, verwende kein Github, verwende keine Bibliotheken von Drittanbietern und verwende nicht einmal JQuery.  Daher wird es kein Tutorial zum Schreiben einer Browsererweiterung geben.  Ich werde dir das nicht beibringen.  Tu nicht so wie ich.  Ich warne Sie - das ist ein schlechtes Beispiel.  Ich m√∂chte auch allen potenziellen Kritikern davon erz√§hlen und ihre Reaktion vorwegnehmen - ja, ich stimme voll und ganz Ihrer gerechten Wut zu.  Ja, Sie k√∂nnen nicht das gesamte Skript in eine oder zwei Dateien verschieben, aber Sie m√ºssen alles wie einen Salat in viele kleine St√ºcke schneiden, damit es dann 3 Stunden lang auf einem langen, intelligenten Befehl √ºber die Befehlszeile zusammengesetzt werden kann.  Ja, Sie k√∂nnen Javascript-Code und HTML-Code nicht in einer Datei kombinieren. Es ist besser, eine andere Abstraktionsebene zu vermasseln, die sie kombiniert.  Ja, Sie k√∂nnen kein Tabellenlayout verwenden, aber verdammt, es ist Eisen!  Und noch mehr - jetzt werden sie mich verbrennen - k√∂nnen Sie innerHtml nicht verwenden und eine komplexe HTML-Struktur auf einen Schlag erstellen, aber Sie m√ºssen alle Kinder in einer Schleife anh√§ngen und trennen und jeden Handler sorgf√§ltig anh√§ngen und dann l√∂schen ... Ja, ich mache alles falsch.  S√ºndig, ich bereue.  Aber ich mache es bewusst, weil es einfacher ist.  Und wer wird mir verbieten?  Am Ende ist es nicht illegal, oder?  Ich wei√ü nicht, wie man als moderner Mod programmiert, und ich m√∂chte es nicht einmal versuchen, weil ich glaube, dass das Entwicklungsprozessdiagramm unn√∂tig kompliziert ist.  Ich bin daf√ºr, Code mit meinen H√§nden zu schreiben und ihn nicht aus den St√ºcken eines anderen zu konstruieren, ohne eine einzige Zeile zu schreiben.  Mein Code ist jedoch leichtgewichtig, muss nicht von einem speziellen Team zusammengestellt werden und funktioniert schnell.  Ich schreibe Code mit F5-Technologie.  In diesem Fall klicken Sie einfach auf den F5-Browser, um zu sehen, wie die aktuelle Version zu jedem Zeitpunkt des Entwicklungsprozesses funktioniert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rl/hq/rs/rlhqrsc-7sjls6fju4o6lmawsto.jpeg"></div><br><br>  Ich musste die Handler jedoch immer noch in einer Schleife aufh√§ngen, da sonst die Erweiterung den Test nicht besteht.  Auch in Erweiterungen, nur f√ºr den Fall, in der HTML-Indexdatei - pl√∂tzlich - sind dynamisch verbundene Skripte verboten.  Also habe ich sie √ºber das Skript-Tag verbunden. <br><br><h3>  Tab-Speicher </h3><br>  Daher habe ich beschlossen, die im Browser ge√∂ffneten Registerkarten in bestimmten Listen zu speichern, die als Computer bezeichnet werden - Heimcomputer, Arbeitscomputer, Lokaler Computer.  Lokal ist, wenn die Liste nicht auf dem Server, sondern in der Browser-Datenbank gespeichert ist und dementsprechend nur in dem Browser verwendet werden kann, in dem sie gespeichert ist.  Dies gilt f√ºr Registerkarten, die nicht zwischen verschiedenen Computern verschoben werden m√ºssen.  Nun, der Rest der Listen kann auf allen Computern und Browsern unter den von der Erweiterung unterst√ºtzten angezeigt werden. <br><br>  F√ºr jede Registerkarte kann der Benutzer einen beliebigen Textkommentar hinterlassen.  Zum Beispiel ist es f√ºr mich praktisch, mich daran zu erinnern, welche Serie ich beim Ansehen der Serie angehalten habe, und f√ºr mich selbst zu markieren, was sich auf der Seite befindet, wenn dies durch Titel und Art des Links nicht klar ist. <br><br>  Gem√§√ü der Dokumentation zum Erstellen von Erweiterungen f√ºr Chrome und Firefox sollte sich der Erweiterungscode in zwei Dateien befinden - der Hauptdatei und der Hintergrunddatei.  Das Hauptskript befasst sich mit der Anzeige der Benutzeroberfl√§che, und das Hintergrundskript kann Browser-Registerkarten steuern und Daten mit dem Server austauschen.  Das Verwalten von Registerkarten in Chrome und Firefox ist sehr √§hnlich.  Der Ereignishandler zum √ñffnen oder Schlie√üen von Registerkarten in Chrome sieht beispielsweise folgenderma√üen aus: <br><br><pre><code class="plaintext hljs">chrome.tabs.onUpdated.addListener( function(tabId, changeInfo) { });</code> </pre> <br>  Und in Firefox so: <br><br><pre> <code class="plaintext hljs">browser.tabs.onUpdated.addListener( function(tabId, changeInfo, tabInfo) { });</code> </pre> <br>  Die Funktion, mit der eine Liste aller ge√∂ffneten Registerkarten angezeigt wird, ist f√ºr beide Browser genau gleich geschrieben: <br><br><pre> <code class="plaintext hljs">chrome.tabs.query({},function(data){ });</code> </pre> <br>  Ja, ja, Chrome schreibt auch Chrome in Firefox ... usw.  Dies ist ein bisschen seltsam, aber die Tatsache, dass Browser ihre API standardisieren, ist sehr ermutigend. <br><br>  Tats√§chlich wird die gesamte Funktionalit√§t der Erweiterung durch die Verwendung mehrerer Funktionen erreicht: √ñffnen Sie das Erweiterungsfenster, indem Sie auf das entsprechende Symbol klicken, ge√∂ffnete Registerkarten lesen, die Registerkarte schlie√üen, eine neue Registerkarte erstellen, Registerkartenereignisse abh√∂ren und Daten mit dem Erweiterungsfenster austauschen.  Das ist alles.  Diese Methoden sind nur im Hintergrundskript verf√ºgbar. <br><br>  Nach dem Lesen werden die im Browser ge√∂ffneten Registerkarten an meinen Server gesendet und dort in einer regul√§ren SQL-Datenbank gespeichert.  Das Serverskript ist in PHP geschrieben.  Es gibt eine Benutzertabelle, in der Links zu Zeilen in einer anderen Tabelle gespeichert sind - der Datentabelle.  Diese Daten sind die Adressen der Seiten, ihre Namen und Textkommentare des Benutzers, die im Format von Textzeichenfolgen in einem Textfeld mit einer L√§nge von etwa einem Kilobyte gespeichert sind.  Die Daten werden unverschl√ºsselt gespeichert.  Pro Megabyte k√∂nnen ca. 1.000 Registerkarten gespeichert werden.  Pro Benutzer werden maximal 25 solcher Speicher (‚ÄûComputer‚Äú) bereitgestellt. <br><br>  Die kostenlose Version der Erweiterung beschr√§nkt den Benutzer jedoch auf zwei Speicher - Heimcomputer und Arbeitscomputer. Jeder von ihnen kann nicht mehr als 10 Registerkarten speichern.  Ich arbeite immer noch an der kostenpflichtigen Version und den Zahlungsmethoden.  Es gibt bis zu 25 ‚ÄûComputer‚Äú und jeweils bis zu 1000 Registerkarten sowie eine Auswahl an Hintergrundbildern, Symbolen und Namen f√ºr jeden Computer, hierarchischen Listen und vielem mehr. <br><br>  Es gibt ein anderes Repository - Lokaler Computer.  Hier gibt es keine Einschr√§nkungen, da die Registerkarten in der lokalen Browser-Datenbank auf dem Computer des Benutzers gespeichert sind.  Hier k√∂nnen Sie so viele Registerkarten speichern, wie Sie m√∂chten, aber nicht mehr, als die Festplatte zul√§sst.  Da die Daten nicht im lokalen Speicher, sondern in der indizierten Datenbank gespeichert sind, gibt es dort keine Begrenzung auf 5 oder einige Megabyte.  Es ist nur wichtig, dieses Repository nicht versehentlich zusammen mit dem Browserverlauf zu l√∂schen.  Ich plane auch, Registerkarten in eine Textdatei zu exportieren und zu importieren. <br><br>  Um mit indexedDB zu arbeiten, habe ich eine kleine Unterbibliothek geschrieben, die nur 106 Zeilen lang ist.  Im Gegensatz zur Datenbank auf dem Server m√ºssen hier nicht alle Daten in eine Textzeichenfolge destilliert werden, sondern k√∂nnen sofort unver√§ndert im assoziativen Array gespeichert werden.  Das Prinzip der Speicherung dort ist folgendes: Der Schl√ºssel ist der Wert.  Und der Wert kann ein riesiges assoziatives Array sein. <br><br><h3>  Benutzerauthentifizierung </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/n_/q-/iy/n_q-iys59c4pqcmjfcps0r3v-xw.jpeg"></div><br>  <i>Firefox</i> <br><br>  Die Autorisierung erfolgt, wie bereits erw√§hnt, √ºber soziale Netzwerke und auf dem Server mithilfe des OAuth-Protokolls.  Es wird weiterhin von Facebook und VKontakte unterst√ºtzt, aber ich plane, die Anzahl der Benutzerauthentifizierungsmethoden zu erh√∂hen.  Das OAuth-Serverautorisierungsschema wird in der Dokumentation f√ºr beide sozialen Netzwerke ausf√ºhrlich beschrieben, daher ist es nicht sinnvoll, ausf√ºhrlich darauf einzugehen.  Ich stelle nur fest, dass mir die Tatsache nicht gefallen hat, dass w√§hrend der Autorisierung eine neue Browser-Registerkarte ge√∂ffnet wird, auch wenn der Benutzer bereits im sozialen Netzwerk angemeldet ist und bereits die Erweiterungsrechte gew√§hrt hat.  Diese Registerkarte muss vom Hintergrunderweiterungsskript erfasst und dann geschlossen werden. Im Allgemeinen sieht sie nicht √§sthetisch ansprechend aus, keilt sich in die anderen Registerkarten ein und blinkt, wenn sie angezeigt und zerst√∂rt wird. <br><br>  Um es zu schlie√üen, m√ºssen Sie f√ºr VKontakte das Vorhandensein der Adresse im Tab-Ereignishandler √ºberpr√ºfen: <br><br><pre> <code class="plaintext hljs">oauth.vk.com/blank.html</code> </pre> <br>  Und f√ºr Facebook: <br><br><pre> <code class="plaintext hljs">https://www.facebook.com/connect/blank.html</code> </pre> <br>  Und nur f√ºr den Fall: <br><br><pre> <code class="plaintext hljs">facebook.com/connect/login_success.html</code> </pre> <br>  Daher habe ich zun√§chst eine Erweiterungsassembly an den Google Web Store gesendet, in der die Autorisierung auf dem Client mit einem vorl√§ufigen Pull-up des entsprechenden sozialen Netzwerks f√ºr Client-Javascript-API durchgef√ºhrt wurde.  Da die Erweiterung auf dem Benutzer installiert ist und ich sie auf meinem Server autorisieren muss, habe ich au√üerdem im Erweiterungsskript im i-frame HTML von meinem Server abgerufen, aber bereits die API f√ºr soziale Netzwerke darin abgerufen ... <br><br>  Und das Datenaustauschschema mit dem Server war so.  Eine Erweiterungsindexseite sendet einen Befehl (z. B. Klickinformationen) an ein Hintergrunderweiterungsskript.  Hintergrundskript mit postMessage sendet Daten an i-frame html.  I-Frame sendet Daten an das PHP-Skript auf dem Server.  Der Server antwortet im i-Frame, der i-Frame antwortet im Hintergrundskript, das Hintergrundskript antwortet im Index, der Benutzer sieht die Antwort.  Puh ... und vor allem - es hat alles funktioniert! <br><br>  Im Allgemeinen hat dies nicht funktioniert.  Google hat meine Erweiterung mit einer Reihe von Formulierungen versehen, unter denen es etwas Unbestimmtes gab, das besagt, dass Ihre Erweiterung nicht unseren Sicherheitsrichtlinien entspricht.  Durch Korrespondenz mit dem Support konnte ich Einzelheiten erreichen.  Sie mochten n√§mlich nicht die Tatsache, dass die Erweiterung HTML und JS von Servern von Drittanbietern abruft ... Im Allgemeinen musste ich die Client-Autorisierung erhalten und zum Server zur√ºckkehren.  Ja, das Senden einer http-Post-Anfrage von einem Hintergrunderweiterungsskript direkt an Ihren Server hat sich jedoch als zul√§ssig erwiesen.  Na ja, okay.  Das ist noch besser.  Es stellte sich heraus, dass es k√ºrzer war und keine JavaScript-API aus sozialen Netzwerken abgerufen werden musste - dies ist eine zus√§tzliche Wartezeit f√ºr den Benutzer. <br><br><h3>  Registerkarten anzeigen </h3><br>  Zur√ºck zu den Erweiterungsoptionen.  Die Liste der Registerkarten selbst besteht aus einer Reihe von Zeilen, in denen zuerst das Bildfavicon, dann der Seitentitel und schlie√ülich der Link angezeigt werden.  Was nicht in die angegebene Zeilengr√∂√üe auf dem Bildschirm passt, wird zugeschnitten.  Die Datenbank wird jedoch vollst√§ndig gespeichert.  Au√üerdem kann jede Linie in Form einer farbigen Kachel auf dem Bildschirm nach oben verschoben werden.  Dies ist f√ºr die wichtigsten Websites, die in erster Linie vor Ihren Augen sein sollten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9v/7_/7q/9v7_7qc9d8rbacokyuyloyuxths.jpeg"></div><br>  <i>Chrome-Tab-Liste</i> <br><br>  Die Farben f√ºr die Kacheln werden automatisch basierend auf dem Domainnamen der Site ausgew√§hlt.  Die Funktion akzeptiert die URL.  Der Dom√§nenname ist in drei ungef√§hr gleiche Zeichengruppen unterteilt. Die ersten Zeichen aus jeder Gruppe werden in die Werte der Farbkomponenten konvertiert: R, G, B. Diese Konvertierung wird wie folgt durchgef√ºhrt.  Die Codes dieser drei Zeichen werden auf den Bereich d1 von 0 bis 25 reduziert, indem der Rest der Division um 26 genommen wird. Sogar die Zeichen des russischen Alphabets werden auf diesen Bereich reduziert.  Es spielt keine Rolle, dass der 27. Buchstabe dort der erste wird: Wir brauchen nicht, dass die Farbkomponenten aller Buchstaben des Alphabets notwendigerweise unterschiedlich sind, lassen Sie sie wiederholen.  Dann werden die drei aus dem Bereich d1 (0 ... 25) erhaltenen Zahlen proportional auf den Bereich d2 (150 ... 255) reduziert.  Im Allgemeinen werden diese Bereiche zu Beginn der Funktion festgelegt und k√∂nnen in andere ge√§ndert werden.  Ich habe 150 ... 255 genommen, damit die Farbkomponenten hell sind.  Wenn Sie beispielsweise 0 ... 100 einstellen, werden die Kacheln dunkel.  Somit werden drei Zeichen aus dem Domainnamen in 3 Zahlen aus dem Bereich 150 ... 255 konvertiert.  Und dann, wie Sie wahrscheinlich vermutet haben, werden sie als Farbkomponenten der Kacheln R, G und B interpretiert. Alles ist sehr einfach. <br><br><pre> <code class="javascript hljs">getSiteColor=<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> d1=[<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">25</span></span>], d2=[<span class="hljs-number"><span class="hljs-number">150</span></span>,<span class="hljs-number"><span class="hljs-number">255</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> code=<span class="hljs-number"><span class="hljs-number">0</span></span>, codep=<span class="hljs-number"><span class="hljs-number">0</span></span>, color=<span class="hljs-number"><span class="hljs-number">0</span></span>, str=<span class="hljs-string"><span class="hljs-string">''</span></span>, domen=<span class="hljs-string"><span class="hljs-string">''</span></span>, ar=[], inc=<span class="hljs-number"><span class="hljs-number">0</span></span>; ar=url.split(<span class="hljs-string"><span class="hljs-string">'//'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ar.length&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>) {str=ar[<span class="hljs-number"><span class="hljs-number">1</span></span>];} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {str=ar[<span class="hljs-number"><span class="hljs-number">0</span></span>];}; str=str.split(<span class="hljs-string"><span class="hljs-string">'www.'</span></span>).join(<span class="hljs-string"><span class="hljs-string">''</span></span>); domen=str.split(<span class="hljs-string"><span class="hljs-string">'/'</span></span>)[<span class="hljs-number"><span class="hljs-number">0</span></span>]; str=domen.split(<span class="hljs-string"><span class="hljs-string">'.'</span></span>).join(<span class="hljs-string"><span class="hljs-string">''</span></span>); ar=[]; inc=<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.floor(str.length/<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (str.length % <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;<span class="hljs-number"><span class="hljs-number">0</span></span>) {inc++;}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;str.length; i+=inc) { code=str.slice(i, i+<span class="hljs-number"><span class="hljs-number">1</span></span>).charCodeAt(<span class="hljs-number"><span class="hljs-number">0</span></span>); codep=code % (d1[<span class="hljs-number"><span class="hljs-number">1</span></span>]-d1[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>); color=<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.round( codep * (d2[<span class="hljs-number"><span class="hljs-number">1</span></span>]-d2[<span class="hljs-number"><span class="hljs-number">0</span></span>]) / (d1[<span class="hljs-number"><span class="hljs-number">1</span></span>]-d1[<span class="hljs-number"><span class="hljs-number">0</span></span>]) ) + d2[<span class="hljs-number"><span class="hljs-number">0</span></span>]; ar.push(color); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">r</span></span>:ar[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-attr"><span class="hljs-attr">g</span></span>:ar[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-attr"><span class="hljs-attr">b</span></span>:ar[<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-attr"><span class="hljs-attr">domen</span></span>:domen}; }</code> </pre> <br><h3>  HTML-Dokumentstruktur </h3><br>  Ein HTML-Dokument besteht aus mehreren Elementen der Zeichenfl√§che mit absoluter Positionierung, kombiniert durch √úberlagerung, und einem Div-Block, in dem die Liste angezeigt wird.  An der Gr√∂√üe des Browserfensters h√§ngt eine Funktion, die die Gr√∂√üe aller dieser Elemente √§ndert und sie an die neue H√∂he und Breite anpasst.  Es gibt auch eine Mindestgr√∂√üe, die das Auftreten von Bildlaufleisten verursacht.  Das Hintergrundbild wird auf der unteren Leinwand angezeigt.  Ich entschied, dass f√ºr verschiedene Listen (dh Computer) unterschiedliche Hintergr√ºnde festgelegt werden sollten, um dem Benutzer die Navigation zu erleichtern.  Das Hintergrundbild f√ºllt das Fenster unter Beibehaltung seiner Proportionen und wird leicht aufgehellt, um nicht auf sich aufmerksam zu machen - dar√ºber wird ein wei√ües durchscheinendes Rechteck gezeichnet.  √úber dem Hintergrundbereich befindet sich der Bereich des Hauptmen√ºs, der nur den oberen Bildschirmrand ausf√ºllt.  Gut und noch h√∂her liegt der div-Block, in dem die Liste der Registerkarten selbst gebildet wird.  Die Navigation im Canvas-Men√º erfolgt √ºber meine Minibibliothek. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/hf/yo/7z/hfyo7zhfazg4zngh50ulh7mibte.jpeg"></div><br>  <i>Opera und Yandex Browser</i> <br><br><h3>  Lokalisierung </h3><br>  Auf dem Hauptbildschirm befindet sich eine Flagge, auf die durch Klicken zwischen Russisch und Englisch umgeschaltet wird.  Hier wird die Seite an dieselbe Adresse umgeleitet, jedoch mit einem Parameter in der Befehlszeile.  Dieser Parameter wird gelesen, bevor alle anderen Elemente geladen werden.  Und basierend auf ihrem Wert wird diese oder jene js-Datei mit russischen oder englischen Phrasen in das assoziative Array f√ºr Phrasen geladen: lng_en.js oder lng_ru.js.  In der Anwendung selbst werden zum Anzeigen von Schnittstellenphrasen bereits Links zu Textzeichenfolgen aus diesem assoziativen Array verwendet.  Abh√§ngig vom Wert in der Adressleiste wird au√üerdem eine Datei geladen, die die Elemente der grafischen Oberfl√§che enth√§lt - Schaltfl√§chen: button_en.png oder keys_ru.png.  Ich habe beschlossen, dass es besser ist, Schaltfl√§chen direkt zusammen mit den Symbolen und Beschriftungen in jeder Sprache im Grafikeditor zu erstellen, als eine leere Schaltfl√§che zu erstellen und Symbole und Beschriftungen darauf zu √ºberlagern, zumal es nicht viele davon gibt und diese gesamte Sprite-Liste nur 50 wiegt Kb  Ich habe vor, weiter am Design zu arbeiten und alle Schaltfl√§chen in ihrer Form unterschiedlich zu gestalten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4j/42/i8/4j42i89k06pbdosro4pe1ytjm50.jpeg"></div><br><br>  Die allgemeine Datei mit den Sprites main.png, die grafische Elemente enth√§lt, die nicht an eine bestimmte Lokalisierung gebunden sind, wird trotzdem geladen. <br><br><h3>  Webversion </h3><br>  Ich dachte, es w√§re sch√∂n, wenn die Links, die sorgf√§ltig vom Heim- oder Arbeitscomputer gespeichert wurden, auf dem Weg vom Telefon aus angezeigt werden k√∂nnten.  Aber nicht alle Browser f√ºr mobile Betriebssysteme unterst√ºtzen Erweiterungen.  Also habe ich eine Web-Assembly erstellt.  Wenn Sie die Site unter einer bestimmten Adresse besuchen, k√∂nnen Sie sich weiterhin √ºber eines der sozialen Netzwerke anmelden und Ihre Registerkarten anzeigen. <br><br>  Ja, es gibt keine M√∂glichkeit, Registerkarten zur Liste hinzuzuf√ºgen oder zu bearbeiten.  Sie k√∂nnen jedoch zumindest Registerkarten aus der Liste √∂ffnen und die Seiten anzeigen.  Ich denke, es lohnt sich, an der mobilen Version dieser Website zu arbeiten und gr√∂√üere Listen mit Registerkarten darin anzuzeigen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vh/h8/3p/vhh83pbba9_0rje4wdcjtye33ve.jpeg"></div><br>  <i>Webversion in IE 11</i> <br><br><h3>  Werbung </h3><br>  Ich habe bisher nicht wirklich daran gearbeitet, meine Expansion voranzutreiben.  Er hat gerade Gruppen in sozialen Netzwerken gegr√ºndet und alle seine Freunde dort eingeladen.  Ja, er hat in Yandex Direct eine Werbekampagne f√ºr 1.500 Rubel gestartet.  Sie hat keine besonderen Ergebnisse geliefert, aber vielleicht habe ich die Ank√ºndigung nicht richtig gemacht.  Oder vielleicht liegt das Problem darin, dass ich einen Link zur englischen Version der Homepage der Erweiterung angegeben habe.  Und vielleicht hat es sich gelohnt, einen Link nicht zur Homepage, sondern sofort zu einem der Extension Stores zu geben.  Wie Sie wissen, bin ich kein Marketing-Genie.  Im Allgemeinen werde ich es mit anderen Parametern erneut versuchen.  Die Kampagne gab 39 Klicks.  Es ist schwer zu sagen, ob ich dadurch einige neue Benutzer gewonnen habe. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/89/sb/dg/89sbdgtfmp59-vykztuj4i-z3li.jpeg"></div><br>  Es gab eine Kuriosit√§t mit der Version unter Firefox. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k5/ku/so/k5kuso8qgka09q2ahx76mettkmo.jpeg"></div><br>  Statistiken f√ºr den 17. Oktober zeigen bis zu 227 Downloads.  Ich wei√ü nicht, ob die Kampagne in Yandex.Direct dazu beigetragen hat oder nicht, aber aus irgendeinem Grund werden aus irgendeinem Grund wieder 1-2 Downloads pro Tag durchgef√ºhrt.  Gleichzeitig gibt es f√ºr die Erweiterung von Firefox das Konzept der t√§glichen Benutzer: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h2/8j/2c/h28j2cd3ylazbx7nnqflnqghsmu.jpeg"></div><br>  Warum es 227 Downloads gab, aber nur 1-2 Benutzer pro Tag, ist nicht klar.  Vielleicht war es eine Art Misserfolg.  Im Allgemeinen verstand ich immer noch nicht, was es war und wo all diese Leute sind ... <br><br>  Die Statistiken im Chrome Web Store-Erweiterungsspeicher erfreuten sich an einem ewig nicht geladenen Zeitplan - das habe ich nicht gesehen - und an 5-10 t√§glichen Nutzern. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dt/2u/zt/dt2uzt-5i74e8m947qxfntmuhgs.jpeg"></div><br>  Au√üerdem habe ich die Assembly an den Opera-Erweiterungsspeicher gesendet.  Nachdem ich jedoch zwei Versionen entworfen hatte und nicht auf die Moderation einer von ihnen gewartet hatte, spuckte ich irgendwann darauf, dort neue zu verbreiten.  Und warum ist dies tats√§chlich erforderlich, wenn Opera Erweiterungen aus dem Chrome Store perfekt installiert? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/or/6l/kt/or6lkthk4ovyqbuv3_hsyf8ypny.jpeg"></div><br><h3>  Zusammenfassung </h3><br>  Ich habe drei Erweiterungs-Builds erstellt - f√ºr Chrome, Firefox und die Webversion.  Tats√§chlich sind alle drei Assemblys ein und dieselbe Assembly, was in der Konfiguration lediglich angibt, welche Browser-Engine derzeit verwendet wird.  Die entsprechenden Funktionen zum Arbeiten mit Registerkarten werden initialisiert.  Ich √§ndere diesen Wert, bevor ich in zip packe und das Paket an den entsprechenden Erweiterungsspeicher sende. <br><br>  Die Versionen f√ºr Chrome und Firefox wurden getestet und in den jeweiligen offiziellen Erweiterungsgesch√§ften abgelegt.  Dar√ºber hinaus kostet die Registrierung als Erweiterungsentwickler bei Google 5 US-Dollar.  Mozilla hat es kostenlos.  Die Webversion der Erweiterung befindet sich auf dem Server.  Die Assembly aus dem Chrome Store funktioniert in kompatiblen Browsern einwandfrei: Sie kann auch in Yandex Browser und Opera installiert werden.  Ich plane, neue Versionen mit noch erweiterten Funktionen zu ver√∂ffentlichen. <br><br>  Im Allgemeinen sind Browser-Erweiterungen Power.  Jetzt muss ich nicht mehr von der Couch aufstehen und es besteht auch kein Grund zur Wut, um das Tablet zu zerbrechen.  Das ist volles Zen.  Gut zu allen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de427773/">https://habr.com/ru/post/de427773/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de427759/index.html">√úber die L√∂sbarkeit von Umgehungsproblemen in der Polynomzeit</a></li>
<li><a href="../de427761/index.html">Implementierung des k-means (k-means) -Algorithmus am Beispiel der Arbeit mit Pixeln</a></li>
<li><a href="../de427763/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 13: Netzwerkprotokolle, Teil 1</a></li>
<li><a href="../de427767/index.html">Situation: In Kanada wurde vorgeschlagen, eine Steuer auf Streaming einzuf√ºhren - wir diskutieren das Problem</a></li>
<li><a href="../de427771/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 13: Netzwerkprotokolle, Teil 2</a></li>
<li><a href="../de427775/index.html">Ein als Programmierer getarnter Bot korrigiert Codefehler</a></li>
<li><a href="../de427779/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 13: Netzwerkprotokolle, Teil 3</a></li>
<li><a href="../de427781/index.html">Warum Kreditorganisationen Data Science</a></li>
<li><a href="../de427783/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 14: ‚ÄûSSL und HTTPS‚Äú, Teil 1</a></li>
<li><a href="../de427785/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 14: ‚ÄûSSL und HTTPS‚Äú, Teil 2</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>