<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≤üèº üõ∏ üõéÔ∏è GOTO Volver üí± üõ∏ üíáüèΩ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ahora todos entienden que usar el operador GOTO no es solo una mala pr√°ctica, sino una pr√°ctica terrible. El debate sobre su uso termin√≥ en los a√±os 8...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>GOTO Volver</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484840/"><p> Ahora todos entienden que usar el operador GOTO no es solo una mala pr√°ctica, sino una pr√°ctica terrible.  El debate sobre su uso termin√≥ en los a√±os 80 del siglo XX y fue excluido de la mayor√≠a de los lenguajes de programaci√≥n modernos.  Pero, como corresponde a un verdadero mal, logr√≥ disfrazarse y resucitar en el siglo XXI bajo la apariencia de excepciones. </p><a name="habracut"></a><br><p>  Las excepciones, por un lado, son un concepto bastante simple en los lenguajes de programaci√≥n modernos.  Por otro lado, a menudo se usan incorrectamente.  Existe una regla simple y bien conocida: las excepciones son solo para el manejo de da√±os.  Y es demasiado flojo interpretar el concepto de "desglose" que lleva a todos los problemas del uso de GOTO. </p><br><h2 id="teoreticheskiy-primer">  Ejemplo te√≥rico </h2><br><p>  La diferencia entre los desgloses y los escenarios comerciales negativos es claramente visible en la ventana de inicio de sesi√≥n con un caso de uso muy simple: </p><br><ol><li>  El usuario ingresa nombre de usuario / contrase√±a. </li><li>  El usuario hace clic en el bot√≥n "Iniciar sesi√≥n". </li><li>  La aplicaci√≥n cliente env√≠a una solicitud al servidor. </li><li>  El servidor verifica con √©xito el nombre de usuario / contrase√±a (considera la presencia del par correspondiente como correcto). </li><li>  El servidor env√≠a informaci√≥n al cliente de que la autenticaci√≥n fue exitosa y un enlace a la p√°gina de transici√≥n. </li><li>  El cliente va a la p√°gina especificada. </li></ol><br><p>  Y una extensi√≥n negativa: </p><br><p>  4.1.  El servidor no encontr√≥ el par de inicio de sesi√≥n / contrase√±a correspondiente y env√≠a una notificaci√≥n al cliente sobre esto. </p><br><p>  Considerar que el escenario 4.1 es un "problema" y, por lo tanto, debe implementarse utilizando una excepci√≥n es un error bastante com√∫n.  Este no es realmente el caso.  Los desajustes de inicio de sesi√≥n y contrase√±a son parte de nuestra experiencia de usuario est√°ndar seg√∫n lo dispuesto por la l√≥gica empresarial del script.  Nuestros clientes comerciales esperan este desarrollo.  Por lo tanto, esto no es un desglose y no puede usar excepciones aqu√≠. </p><br><p>  Las aver√≠as son: desconexi√≥n de la conexi√≥n entre el cliente y el norte, inaccesibilidad del DBMS, esquema incorrecto en la base de datos.  Y un mill√≥n de razones m√°s que rompen nuestras aplicaciones y no tienen nada que ver con la l√≥gica empresarial del usuario. </p><br><p>  En uno de los proyectos, en el desarrollo del cual particip√©, hab√≠a una l√≥gica de inicio de sesi√≥n m√°s compleja.  Al ingresar la contrase√±a incorrecta 3 veces seguidas, el usuario fue bloqueado temporalmente durante 15 minutos.  Obteniendo 3 veces seguidas en un bloqueo temporal, el usuario recibi√≥ un bloqueo permanente.  Tambi√©n hab√≠a reglas adicionales seg√∫n el tipo de usuario.  La implementaci√≥n de excepciones ha hecho que sea extremadamente dif√≠cil introducir nuevas reglas. </p><br><p>  Ser√≠a interesante considerar este ejemplo, pero es demasiado grande y no muy visual.  C√≥mo el c√≥digo confuso con la l√≥gica empresarial en las excepciones se vuelve claro y conciso, te mostrar√© en otro ejemplo. </p><br><h2 id="primer-zagruzka-svoystv">  Ejemplo de propiedades de carga </h2><br><p>  Intenta mirar este c√≥digo y entender claramente lo que hace.  El procedimiento no es grande con una l√≥gica bastante simple.  Con un buen estilo de programaci√≥n, la comprensi√≥n de su esencia no debe exceder m√°s de 2-3 minutos (no recuerdo cu√°nto tiempo me llev√≥ comprender completamente este c√≥digo, pero definitivamente m√°s de 15 minutos). </p><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WorkspaceProperties</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ Properties loadedProperties = readPropertiesFromFile(WORK_PROPERTIES_PATH, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-comment"><span class="hljs-comment">//These mappings will replace any mappings that this hashtable had for any of the //keys currently in the specified map. getProperties().putAll( loadedProperties ); //     loadedProperties = readPropertiesFromFile(MY_WORK_PROPERTIES_PATH, false); if (loadedProperties != null){ getProperties().putAll( loadedProperties ); } System.out.println("Loaded properties:" + getProperties()); } /** *  ,    . * @param filepath * @param throwIfNotFound -  FileNotFoundException,     * @return    null,      !throwIfNotFound * @throws FileNotFoundException throwIfNotFound        * @throws IOException     */ private Properties readPropertiesFromFile(String filepath, boolean throwIfNotExists){ Properties loadedProperties = new Properties(); System.out.println("Try loading workspace properties" + filepath); InputStream is = null; InputStreamReader isr = null; try{ int loadingTryLeft = 3; String relativePath = ""; while (loadingTryLeft &gt; 0){ try{ File file = new File(relativePath + filepath); is = new FileInputStream(file); isr = new InputStreamReader( is, "UTF-8"); loadedProperties.load(isr); loadingTryLeft = 0; } catch( FileNotFoundException e) { loadingTryLeft -= 1; if (loadingTryLeft &gt; 0) relativePath += "../"; else throw e; } finally { if (is != null) is.close(); if (isr != null) isr.close(); } } System.out.println("Found file " + filepath); } catch( FileNotFoundException e) { System.out.println("File not found " + filepath); if (throwIfNotExists) throw new RuntimeException("Can`t load workspace properties." + filepath + " not found", e ); }catch (IOException e){ throw new RuntimeException("Can`t read " + filepath, e); } return loadedProperties; }</span></span></code> </pre> <br><p>  Entonces, revelemos el secreto: lo que est√° sucediendo aqu√≠.  Se <code>WORK_PROPERTIES</code> las propiedades de dos archivos: las <code>WORK_PROPERTIES</code> requeridas y las <code>MY_WORK_PROPERTIES</code> adicionales, que se agregan al almac√©n de propiedades generales.  Hay un matiz, no sabemos exactamente d√≥nde se encuentra el archivo de propiedades espec√≠fico, puede encontrarse tanto en el directorio actual como en los directorios de antepasados ‚Äã‚Äã(hasta tres niveles hacia arriba). </p><br><p>  Al menos dos cosas son confusas aqu√≠: el par√°metro <code>throwIfNotExists</code> y el bloque l√≥gico grande en <code>catch FileNotFoundException</code> .  Todo esto insin√∫a opacamente: las excepciones se utilizan para implementar la l√≥gica de negocios (pero ¬øde qu√© otra manera explicar eso en un escenario, lanzar una excepci√≥n es un fracaso y en el otro no?). </p><br><h2 id="delaem-pravilnyy-kontrakt">  Hacer el contrato correcto </h2><br><p>  Primero, <code>throwIfNotExists</code> con <code>throwIfNotExists</code> .  Cuando se trabaja con excepciones, es muy importante comprender d√≥nde se debe procesar exactamente en t√©rminos de casos de uso.  En este caso, es obvio que el m√©todo <code>readPropertiesFromFile</code> no puede decidir cu√°ndo la ausencia de un archivo es "mala" y cu√°ndo es "buena".  Dicha decisi√≥n se toma en el momento de su convocatoria.  Los comentarios muestran que decidimos si este archivo debe existir o no.  Pero, de hecho, no nos interesa el archivo en s√≠, sino la configuraci√≥n del mismo.  Desafortunadamente, esto no se sigue del c√≥digo. </p><br><p>  Arreglamos ambas deficiencias: </p><br><pre> <code class="java hljs">Properties loadedProperties = readPropertiesFromFile(WORK_PROPERTIES_PATH); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (loadedProperties.isEmpty()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(<span class="hljs-string"><span class="hljs-string">"Can`t load workspace properties"</span></span>); } loadedProperties = readPropertiesFromFile(MY_WORK_PROPERTIES_PATH); getProperties().putAll( loadedProperties );</code> </pre> <br><p>  Ahora la sem√°ntica se muestra claramente: <br>  <code>WORK_PROPERTIES</code> debe especificarse, pero <code>MY_WORK_PROPERTIES</code> no <code>MY_WORK_PROPERTIES</code> especificarse.  Tambi√©n durante la refactorizaci√≥n, not√© que <code>readPropertiesFromFile</code> nunca podr√≠a devolver <code>null</code> y aprovech√© esto al leer <code>MY_WORK_PROPERTIES</code> . </p><br><h2 id="proveryaem-ne-lomaya">  Comprobamos sin romper </h2><br><p>  La refactorizaci√≥n previa tambi√©n afect√≥ la implementaci√≥n, pero no significativamente.  Acabo de eliminar el <code>throwIfNotExists</code> procesamiento <code>throwIfNotExists</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (throwIfNotExists) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(‚Ä¶);</code> </pre> <br><p>  Habiendo examinado la implementaci√≥n m√°s de cerca, comenzamos a comprender la l√≥gica del autor del c√≥digo para buscar un archivo.  Primero, se verifica que el archivo est√© en el directorio actual; si no se encuentra, lo verificamos en un nivel superior, etc.  Es decir  queda claro que el algoritmo prev√© la ausencia de un archivo.  En este caso, la verificaci√≥n se realiza utilizando una excepci√≥n.  Es decir  se viola el principio: la excepci√≥n se percibe no como "algo se ha roto", sino como parte de la l√≥gica empresarial. </p><br><p>  Hay una funci√≥n para verificar la disponibilidad de un archivo para leer <code>File.canRead()</code> .  Al usarlo, puede deshacerse de la l√≥gica de negocios en un <code>catch</code> </p><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ File file = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(relativePath + filepath); is = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(file); isr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader( is, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); loadedProperties.load(isr); loadingTryLeft = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>( FileNotFoundException e) { loadingTryLeft -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (loadingTryLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) relativePath += <span class="hljs-string"><span class="hljs-string">"../"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> e; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) is.close(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isr != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) isr.close(); } }</code> </pre> <br><p>  Al cambiar el c√≥digo, obtenemos lo siguiente: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Properties </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readPropertiesFromFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String filepath)</span></span></span><span class="hljs-function"> </span></span>{ Properties loadedProperties = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Properties(); System.out.println(<span class="hljs-string"><span class="hljs-string">"Try loading workspace properties"</span></span> + filepath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> loadingTryLeft = <span class="hljs-number"><span class="hljs-number">3</span></span>; String relativePath = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (loadingTryLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { File file = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(relativePath + filepath); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file.canRead()) { InputStream is = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; InputStreamReader isr = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { is = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(file); isr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(is, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); loadedProperties.load(isr); loadingTryLeft = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) is.close(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isr != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) isr.close(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { loadingTryLeft -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (loadingTryLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { relativePath += <span class="hljs-string"><span class="hljs-string">"../"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileNotFoundException(); } } } System.out.println(<span class="hljs-string"><span class="hljs-string">"Found file "</span></span> + filepath); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (FileNotFoundException e) { System.out.println(<span class="hljs-string"><span class="hljs-string">"File not found "</span></span> + filepath); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(<span class="hljs-string"><span class="hljs-string">"Can`t read "</span></span> + filepath, e); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadedProperties; }</code> </pre> <br><p>  Tambi√©n reduje el nivel de variables ( <code>is</code> , <code>isr</code> ) al m√≠nimo permitido. </p><br><p>  Tal refactorizaci√≥n simple mejora enormemente la legibilidad del c√≥digo.  El c√≥digo muestra directamente el algoritmo (si el archivo existe, entonces lo leemos, de lo contrario reducimos el n√∫mero de intentos y buscamos en el directorio anterior). </p><br><h2 id="vyyavlyaem-goto">  Revelando GOTO </h2><br><p>  Considere en detalle lo que sucede en una situaci√≥n si no se encuentra el archivo: </p><br><pre> <code class="java hljs">} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { loadingTryLeft -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (loadingTryLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { relativePath += <span class="hljs-string"><span class="hljs-string">"../"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileNotFoundException(); } }</code> </pre> <br><p>  Se puede ver que aqu√≠ la excepci√≥n se usa para interrumpir el ciclo de ejecuci√≥n y realmente realizar la funci√≥n GOTO. </p><br><p>  Para los que dudan, haremos otro cambio.  En lugar de usar una peque√±a muleta en el formulario <code>loadingTryLeft = 0</code> (muleta, porque de hecho un intento exitoso no <code>loadingTryLeft = 0</code> n√∫mero de intentos restantes), indicamos expl√≠citamente que leer el archivo conduce a la salida de la funci√≥n (sin olvidar escribir un mensaje): </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { is = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(file); isr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(is, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); loadedProperties.load(isr); System.out.println(<span class="hljs-string"><span class="hljs-string">"Found file "</span></span> + filepath); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadedProperties; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> {</code> </pre> <br><p>  Esto nos permite reemplazar la condici√≥n <code>while (loadingTryLeft &gt; 0)</code> con <code>while(true)</code> : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> loadingTryLeft = <span class="hljs-number"><span class="hljs-number">3</span></span>; String relativePath = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { File file = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(relativePath + filepath); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file.canRead()) { InputStream is = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; InputStreamReader isr = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { is = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(file); isr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(is, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); loadedProperties.load(isr); System.out.println(<span class="hljs-string"><span class="hljs-string">"Found file "</span></span> + filepath); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadedProperties; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) is.close(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isr != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) isr.close(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { loadingTryLeft -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (loadingTryLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { relativePath += <span class="hljs-string"><span class="hljs-string">"../"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileNotFoundException(); <span class="hljs-comment"><span class="hljs-comment">// GOTO: FFN } } } } catch (FileNotFoundException e) { // LABEL: FFN System.out.println("File not found " + filepath); } catch (IOException e) { throw new RuntimeException("Can`t read " + filepath, e); }</span></span></code> </pre> <br><p>  Para deshacerse del obvio mal olor que <code>throw new FileNotFoundException</code> , debe recordar el contrato de la funci√≥n.  En cualquier caso, la funci√≥n devuelve un conjunto de propiedades, si no pueden leer el archivo, lo devolvemos vac√≠o.  Por lo tanto, no hay raz√≥n para lanzar una excepci√≥n y atraparla.  La condici√≥n <code>while (loadingTryLeft &gt; 0)</code> habitual <code>while (loadingTryLeft &gt; 0)</code> suficiente: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Properties </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readPropertiesFromFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String filepath)</span></span></span><span class="hljs-function"> </span></span>{ Properties loadedProperties = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Properties(); System.out.println(<span class="hljs-string"><span class="hljs-string">"Try loading workspace properties"</span></span> + filepath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> loadingTryLeft = <span class="hljs-number"><span class="hljs-number">3</span></span>; String relativePath = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (loadingTryLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { File file = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(relativePath + filepath); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file.canRead()) { InputStream is = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; InputStreamReader isr = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { is = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(file); isr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(is, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); loadedProperties.load(isr); System.out.println(<span class="hljs-string"><span class="hljs-string">"Found file "</span></span> + filepath); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadedProperties; } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) is.close(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isr != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) isr.close(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { loadingTryLeft -= <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (loadingTryLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) relativePath += <span class="hljs-string"><span class="hljs-string">"../"</span></span>; } } System.out.println(<span class="hljs-string"><span class="hljs-string">"file not found"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(<span class="hljs-string"><span class="hljs-string">"Can`t read "</span></span> + filepath, e); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadedProperties; }</code> </pre> <br><p>  En principio, desde el punto de vista del trabajo correcto con excepciones, todo est√° aqu√≠.  Existe una duda sobre la necesidad de lanzar una RuntimeException en caso de problemas de IOException, pero la dejaremos como est√° por razones de compatibilidad. </p><br><h2 id="navodim-losk">  Traer brillo </h2><br><p>  Quedan algunas cositas que podemos hacer que el c√≥digo sea a√∫n m√°s flexible y comprensible: </p><br><ul><li>  El nombre del m√©todo readPropertiesFromFile expone su implementaci√≥n (por cierto, as√≠ como arroja FileNotFoundException).  Es mejor llamarlo m√°s neutral y conciso - loadProperties (...) </li><li>  El m√©todo busca y lee simult√°neamente.  Para m√≠, estas son dos responsabilidades diferentes que se pueden dividir en diferentes m√©todos. </li><li>  El c√≥digo se escribi√≥ originalmente en Java 6, pero ahora se usa en Java 7. Esto permite el uso de recursos que se pueden cerrar. </li><li>  S√© por experiencia que al mostrar informaci√≥n sobre un archivo encontrado o no encontrado, es mejor usar la ruta completa al archivo, en lugar de relativa. </li><li> <code>if (loadingTryLeft &gt; 0) relativePath += "../";</code>  - si observa cuidadosamente el c√≥digo, puede ver - esta verificaci√≥n es innecesaria, porque  Si el l√≠mite de b√∫squeda se agota, el nuevo valor no se utilizar√° de todos modos.  Y si hay algo superfluo en el c√≥digo, esto es basura que deber√≠a eliminarse. </li></ul><br><p>  La versi√≥n final del c√≥digo fuente: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WorkspaceProperties</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Properties()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (defaultInstance != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IllegalStateException(); Properties loadedProperties = readPropertiesFromFile(WORK_PROPERTIES_PATH); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (loadedProperties.isEmpty()) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(<span class="hljs-string"><span class="hljs-string">"Can`t load workspace properties"</span></span>); } getProperties().putAll(loadedProperties); loadedProperties = readPropertiesFromFile(MY_WORK_PROPERTIES_PATH); getProperties().putAll(loadedProperties); System.out.println(<span class="hljs-string"><span class="hljs-string">"Loaded properties:"</span></span> + getProperties()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Properties </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readPropertiesFromFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String filepath)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"Try loading workspace properties"</span></span> + filepath); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> loadingTryLeft = <span class="hljs-number"><span class="hljs-number">3</span></span>; String relativePath = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (loadingTryLeft &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { File file = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(relativePath + filepath); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (file.canRead()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> read(file); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { relativePath += <span class="hljs-string"><span class="hljs-string">"../"</span></span>; loadingTryLeft -= <span class="hljs-number"><span class="hljs-number">1</span></span>; } } System.out.println(<span class="hljs-string"><span class="hljs-string">"file not found"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RuntimeException(<span class="hljs-string"><span class="hljs-string">"Can`t read "</span></span> + filepath, e); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Properties(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Properties </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File file)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (InputStream is = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(file); InputStreamReader isr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(is, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)) { Properties loadedProperties = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Properties(); loadedProperties.load(isr); System.out.println(<span class="hljs-string"><span class="hljs-string">"Found file "</span></span> + file.getAbsolutePath()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> loadedProperties; } }</code> </pre> <br><h2 id="rezyume">  Resumen </h2><br><p>  El ejemplo analizado ilustra claramente a qu√© conduce el manejo descuidado del c√≥digo fuente.  En lugar de usar una excepci√≥n para manejar el desglose, se decidi√≥ usarlo para implementar la l√≥gica empresarial.  Esto condujo inmediatamente a la complejidad de su apoyo, lo que se reflej√≥ en su mayor desarrollo para cumplir con los nuevos requisitos y, como resultado, una desviaci√≥n de los principios de la programaci√≥n estructural.  El uso de una regla simple (excepciones solo para aver√≠as) lo ayudar√° a evitar volver a la era GOTO y a mantener su c√≥digo limpio, comprensible y extensible. </p></div></div><p>Source: <a href="https://habr.com/ru/post/484840/">https://habr.com/ru/post/484840/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../484824/index.html">La guerra por apagar las luces</a></li>
<li><a href="../484826/index.html">La inteligencia artificial empeora a√∫n m√°s la mala medicina</a></li>
<li><a href="../484834/index.html">C√≥mo construir una estrategia corporativa para capacitaci√≥n y desarrollo</a></li>
<li><a href="../484836/index.html">C√°lculo de rentabilidad del Arancel Verde en 2020, Ucrania</a></li>
<li><a href="../484838/index.html">13 ejemplos de configuraci√≥n de reglas en Google Ads [instrucci√≥n]</a></li>
<li><a href="../484846/index.html">Mi relaci√≥n con el c√≥digo abierto.</a></li>
<li><a href="../484854/index.html">Ejecuta el juego en C # en MS-DOS</a></li>
<li><a href="../484860/index.html">Nombre de implementaci√≥n y nombre del resultado</a></li>
<li><a href="../484862/index.html">Migraci√≥n de AngularJS a Angular7 a trav√©s de una aplicaci√≥n h√≠brida</a></li>
<li><a href="../484866/index.html">Uso de Astra Linux en una computadora integrada ARM</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>