<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∞üèø üìÅ üëºüèº Utilisation d'Unity3D dans une application iOS / Android native pour mod√©liser l'√©clairage des espaces ouverts ‚ôøÔ∏è üò© üç∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unity3D est une plateforme de d√©veloppement de jeux 3D et 2D bien connue qui a gagn√© en popularit√© dans le monde entier. Dans le m√™me temps, ses capac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Utilisation d'Unity3D dans une application iOS / Android native pour mod√©liser l'√©clairage des espaces ouverts</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/simbirsoft/blog/417779/"><img src="https://habrastorage.org/webt/ac/6n/is/ac6nistgzfsvyyhyj3wqngoiak4.png" alt="image"><br><br>  Unity3D est une plateforme de d√©veloppement de jeux 3D et 2D bien connue qui a gagn√© en popularit√© dans le monde entier.  Dans le m√™me temps, ses capacit√©s ne se limitent pas au d√©veloppement d'applications de jeu uniquement, mais conviennent √† une utilisation dans tous les autres domaines qui n√©cessitent la cr√©ation d'applications multiplateformes pour travailler avec des graphiques.  Dans cet article, nous parlerons de l'exp√©rience d'utilisation d'Unity3D pour d√©velopper un syst√®me de calcul de l'√©clairage des espaces ouverts. <br><a name="habracut"></a><br>  L'entreprise avec laquelle nous avons collabor√© est la soci√©t√© internationale d'√©clairage <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BOOS LIGHTING GROUP</a> .  Afin d'√©tendre l'attractivit√© de ses produits et de simplifier l'interaction avec les clients, il √©tait n√©cessaire de d√©velopper une application qui permet de simuler visuellement l'emplacement des dispositifs d'√©clairage, ainsi que d'effectuer des calculs d'√©clairage et d'afficher les informations techniques n√©cessaires dans le rapport.  Il a √©t√© suppos√© que l'application a √©t√© lanc√©e sur un iPad ou une tablette Android par un client potentiel ou un repr√©sentant commercial et permet au client de se faire une id√©e imm√©diate de la possibilit√© d'√©clairage. <br><br>  Le travail a √©t√© r√©alis√© par √©tapes sur la base du cahier des charges √©labor√© et des consultations de la soci√©t√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BOOS LIGHTING GROUP</a> sur le sujet du projet. <br><br>  De mani√®re g√©n√©rale, l'application est un √©diteur qui vous permet d'ajouter et de modifier des √©l√©ments d'√©clairage, des routes, des √©l√©ments d√©coratifs, d'effectuer des calculs d'ing√©nierie d'√©clairage de la sc√®ne, d'afficher un rapport en pdf.  Chaque √©l√©ment poss√®de son propre ensemble de param√®tres d'√©dition et de sous-types qui affectent son affichage et son calcul. <br><br><ul><li>  Il existe plusieurs types de m√¢ts d'√©clairage, avec diff√©rents types de luminaires, des angles d'inclinaison des lampes et des longueurs d'extension.  Pour certains types de luminaires, un r√©glage individuel est possible avec indication de la direction de l'√©clairage. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2o/ci/da/2ocida45cxhpgpekhtfat_mc_6y.png" width="70%" alt="image"></div></li><li>  Les routes peuvent √™tre des sections lin√©aires, des √©l√©ments d'arc, une zone, un anneau.  Pour chaque √©l√©ment, les dimensions, la position, le type de disposition, la couche peuvent √™tre personnalis√©s. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/s1/3s/lx/s13slxoinkzba4yyljw518pqw78.png" alt="image" width="70%"></div></li><li>  √âl√©ments d√©coratifs - voitures, arbres, buissons, panneaux de signalisation </li></ul><br>  Tous les √©l√©ments de la sc√®ne peuvent √™tre tourn√©s et d√©plac√©s.  Les actions standard pour revenir en arri√®re ou r√©essayer sont √©galement prises en charge.  Les param√®tres g√©n√©raux du projet vous permettent de d√©finir la texture du dorg, la surface de la terre, en affichant des param√®tres suppl√©mentaires.  La sc√®ne est affich√©e en modes 2D / 3D.  Et lors du calcul de l'illumination sur la surface, une carte de l'illumination de la surface en couleurs fictives est affich√©e. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ac/6n/is/ac6nistgzfsvyyhyj3wqngoiak4.png" width="100%" alt="image"></div><br><br>  Si possible, l'interface utilisateur compl√®te doit √™tre r√©alis√©e avec des outils iOS / Android natifs. <br>  La principale exigence technique de l'application est de pouvoir calculer l'√©clairage de la sc√®ne en fonction des sp√©cifications techniques des luminaires.  La capacit√© de chaque appareil √† afficher et √† visualiser son diagramme de rayonnement (courbes d'intensit√© lumineuse) en modes 3D / 2D √©tait √©galement requise. <br><br><h4>  S√©lection de la plateforme </h4><br>  Pour impl√©menter le projet, nous avons choisi Unity comme plus pratique pour nous d'impl√©menter les fonctionnalit√©s requises.  En g√©n√©ral, notre entreprise avait de l'exp√©rience avec d'autres moteurs et plates-formes 3D (OpenSceneGraph, Ogre3D, LibGdx) et techniquement, ils peuvent tous faire face √† la t√¢che requise, mais cette fois, le choix s'est port√© sur Unity, ce qui facilite la gestion de la sc√®ne lors du d√©veloppement et du d√©bogage. en cours de travail. <br><br><h4>  Les principales difficult√©s </h4><br>  Nous n'entrerons pas dans les subtilit√©s du d√©veloppement de l'application enti√®re, car la fonctionnalit√© technique pour afficher et √©diter la sc√®ne est assez standard.  Naturellement, il y avait des difficult√©s avec les m√©canismes d'√©dition sp√©cifique d'objets, en les ajoutant et en les supprimant, ainsi qu'en sauvegardant une cha√Æne de commandes pour la possibilit√© de r√©p√©ter et d'annuler des actions. <br>  Nous aimerions nous attarder uniquement sur les caract√©ristiques du syst√®me li√©es √† l'utilisation de l'interface utilisateur native, √† la g√©n√©ration de rapports pdf et au travail avec les calculs de photom√©trie et d'√©clairage. <br><br><h4>  Travailler avec l'interface utilisateur native </h4><br>  Dans la plupart des cas, Unity interagit avec les fonctions natives du syst√®me √† l'aide du syst√®me de plug-in, ce qui vous permet d'incorporer les fonctionnalit√©s souhait√©es dans l'application.  Cependant, dans notre cas, la situation est quelque peu oppos√©e.  Nous devions avoir une interface utilisateur compl√®te affich√©e en haut de la fen√™tre Unity. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4z/0s/41/4z0s41r48kbp8cuzxnc7naj6l3i.png" width="70%" alt="image"></div><br><br>  Heureusement, Unity peut exporter un projet qui peut √™tre utilis√© comme base pour une application native.  La principale difficult√© dans ce cas est de savoir comment int√©grer une interface utilisateur suppl√©mentaire dans le projet r√©sultant.  En outre, il est tout aussi important que lors de l'assemblage d'un projet Unity, son format et l'emplacement du fichier soient form√©s par Unity et partiellement r√©√©crits, ce qui limite la possibilit√© de modifier le projet. <br><br>  Lors du d√©veloppement d'une application iOS, nous avons utilis√© le m√©canisme propos√© dans l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> .  Pendant le d√©veloppement, Unity 5.5 a √©t√© utilis√© et pour le moment, ce qui y est indiqu√© peut perdre de sa pertinence.  Lors de l'assemblage du projet Android, il n'y a eu aucun probl√®me suppl√©mentaire, √† l'exception que Unity √©crase le fichier manifeste et les fichiers de ressources √† chaque fois. <br>  Un probl√®me suppl√©mentaire est que Unity ne peut fonctionner que dans une seule fen√™tre.  Dans le m√™me temps, nous devions nous assurer que Unity affiche la sc√®ne enti√®re, et lors de l'ouverture de la fen√™tre des param√®tres, un mod√®le 3D du corps photom√©trique de la lampe doit √™tre affich√©.  Pour ce faire, j'ai d√ª utiliser un ¬´hack¬ª et utiliser le m√™me objet UIView dans diff√©rentes fen√™tres. <br><br>  Pour envoyer des messages, nous avons utilis√© la fonctionnalit√© standard offerte par Unity.  Autrement dit, tous les messages √©taient au format json et transmis en lignes simples.  Cela n'imposait aucune restriction sur les performances, car la taille des messages atteignait un maximum de 100 caract√®res et leur fr√©quence √©tait d√©termin√©e par la vitesse du programme.  Dans le m√™me temps, dans des applications plus exigeantes, il est logique de cr√©er votre propre gestionnaire de messages tel que pr√©sent√© sur Haber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h4>  Calcul d'√©clairage </h4><br>  Toutes les sources lumineuses utilis√©es dans l'application sont livr√©es au format <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IES</a> standard, qui d√©crit la r√©partition de la lumi√®re dans diff√©rentes directions ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sp√©cification</a> ).  Ce format est largement utilis√© dans les syst√®mes de CAO professionnels et les √©diteurs 3D.  Il s'agit d'un fichier texte indiquant l'intensit√© lumineuse dans diff√©rentes directions et des m√©ta-informations suppl√©mentaires indiquant le type, l'intensit√© totale de la source, les axes et les plans de sym√©trie.  √âtant donn√© la sym√©trie des appareils, le fichier ies peut √™tre tr√®s petit.  Par exemple, dans le cas d'une sym√©trie axiale, il suffit d'indiquer le trac√© de la lumi√®re dans un seul plan. <br><br><div class="spoiler">  <b class="spoiler_title">Exemple d'un simple fichier IES</b> <div class="spoiler_text"><pre><code class="plaintext hljs">IESNA91[TEST] Simple demo intensity distribution [MANUFAC] Lightscape Technologies, Inc. TILT=NONE 1 -1 1 8 1 1 2 0.0 0.0 0.0 1.0 1.0 0.0 0.0 5.0 10.0 20.0 30.0 45.0 65.0 90.0 0.0 1000.0 1100.0 1300.0 1150.0 930.0 650.0 350.0 0.0</code> </pre> <br></div></div><br>  Pour afficher le diagramme de rayonnement, deux types d'affichage ont √©t√© utilis√©s: <br><br><ul><li>  Les courbes d'intensit√© lumineuse (KSS) est un graphique √† deux dimensions qui montre l'intensit√© lumineuse dans l'un des plans principaux en fonction de la direction.  Pour plus de commodit√©, ce graphique peut √™tre repr√©sent√© √† la fois dans le syst√®me de coordonn√©es polaire et cart√©sien. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/df/89/xc/df89xcesta0qlw4jcyuxpbihmyi.png" width="100%" alt="image"></div></li><li>  Corps photom√©trique - une image tridimensionnelle de l'intensit√© lumineuse dans diff√©rentes directions <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/su/1s/if/su1sifzigs4cwuy-jg6bhpni79o.png" width="100%" alt="image"></div></li></ul><br><h4>  Module de calcul </h4><br>  Pour calculer l'√©clairage, le client avait son propre module C ++ utilis√© dans d'autres produits de l'entreprise, et il a donc √©t√© n√©cessaire de l'int√©grer dans le projet Unity.  L'ordre de connexion des modules √©tait diff√©rent de la plate-forme utilis√©e. <br><br><ul><li>  Sur la plate-forme iOS, Unitu peut appeler directement les fonctions C, il suffit donc de copier le code source du module directement dans le projet et d'ajouter des classes pour son interaction avec Unity.  Les classes peuvent √™tre stock√©es √† la fois directement dans le projet iOS et dans le dossier des plugins, qui sont automatiquement copi√©s lorsque le projet est export√© vers Xcode.  Un exemple d'appel de fonctions C ++ est le suivant: <br><br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">DllImport(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"__Internal"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">extern</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculateLight</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[MarshalAs(UnmanagedType.LPArray, SizeParamIndex = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-function">)] Light[] lights, </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> size, </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">ref</span></span></span><span class="hljs-function"> CalculationResult result)</span></span>;</code> </pre> </li><li>  Sur la plate-forme Android, le module C ++ doit √™tre pr√©compil√© dans une biblioth√®que distincte.  Cela peut √™tre fait directement en ajoutant des sources C ++ au projet et en configurant gradle pour les construire dans des biblioth√®ques so. </li><li>  De plus, pour le d√©bogage et le test de la partie Unity, le d√©veloppement a √©t√© effectu√© sur une machine Windows, il √©tait donc n√©cessaire de connecter le code source du module sous Windows √©galement.  Cela se fait de mani√®re similaire au projet Android, seulement dans ce cas, les fichiers t√©l√©charg√©s sont collect√©s dans la biblioth√®que dll et connect√©s au projet. </li></ul><br><h4>  Affichage de la carte lumineuse </h4><br>  √Ä la demande du client, les r√©sultats du calcul de l'√©clairage doivent √™tre affich√©s √† la surface de la sc√®ne.  Sur la surface des routes, il est n√©cessaire d'utiliser des couleurs fictives avec l'affichage d'une √©chelle pour faire correspondre la couleur et l'intensit√© lumineuse, et sur le reste de la surface, il suffit d'afficher sa luminosit√©. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/18/5q/k9/185qk9lbx4fsoq3ax0miaedzjkm.png" width="70%" alt="image"></div><br><br>  Comme mentionn√© pr√©c√©demment, le calcul complet a √©t√© effectu√© par un plug-in C ++ auquel les donn√©es sur les sources de couleurs ont √©t√© transmises.  Le r√©sultat du calcul √©tait un r√©seau bidimensionnel d'intensit√© lumineuse sur toute la surface de la sc√®ne avec un d√©tail donn√©. <br><br>  La carte d'irradiance r√©sultante a √©t√© analys√©e pour la valeur minimale et maximale par laquelle une texture de gradient unidimensionnelle (GradientRamp) a √©t√© construite.  En utilisant cette texture, l'intensit√© lumineuse a √©t√© convertie en couleurs fictives directement dans le fragment shader.  Dans le m√™me temps, le m√™me shader a √©t√© utilis√© pour diff√©rentes surfaces de route et la surface de la terre, et la commutation du mode d'√©clairage a √©t√© fournie en utilisant le shader " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">multi-compilation</a> ". <br><br><h4>  G√©n√©ration de fichiers PDF </h4><br>  Conform√©ment aux exigences techniques, un rapport devait √™tre g√©n√©r√© pour l'utilisateur, contenant des informations sur la sc√®ne g√©n√©rale (dimensions, ses images, param√®tres d'√©clairage) et des informations sur chaque type de luminaire utilis√©, indiquant leur position, la direction des caract√©ristiques, ainsi que des diagrammes KCC et l'affichage du corps photom√©trique. <br>  Comme le rapport devait √™tre affich√© sur iOS et Android, il √©tait n√©cessaire de g√©n√©rer son rapport directement dans le module Unity, puis de l'afficher √† l'aide d'outils natifs standard. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aw/fo/je/awfojewyanvogdxu6sihv6zr-i8.png" alt="image"></div><br>  Pour construire le pdf, la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">iTextSharp</a> a √©t√© s√©lectionn√©e qui r√©pond √† nos exigences.  La cr√©ation d'un rapport n'est pas particuli√®rement difficile et consiste √† cr√©er des blocs de texte, des tableaux, des images directement √† partir du code.  Cependant, au cours du d√©veloppement, nous avons √©t√© confront√©s √† de nombreuses nuances, dont la solution n√©cessitait parfois des efforts consid√©rables.  Le probl√®me principal √©tait le lancement de la g√©n√©ration de rapports dans le fil de fond. <br><br>  Si lors des tests sur une machine de bureau, la g√©n√©ration de pdf √©tait de l'ordre de quelques secondes, alors lors des tests sur iPad mini 3, cette fois atteignait facilement 1 √† 3 minutes.  Naturellement, la cr√©ation du rapport devait √™tre transf√©r√©e dans un thread s√©par√©, afin d'√©viter des probl√®mes avec la suspension de l'interface.  Dans le cas g√©n√©ral, ce n'est pas un probl√®me, mais ce n'est pas le cas lors de l'utilisation de Unity, dans lequel il est explicitement interdit d'utiliser l'API Unity en dehors du thread principal.  Dans le m√™me temps, pour le rapport, nous avions besoin, au minimum, de rendre le CSS et l'image de la sc√®ne, ce qui ne devrait √™tre fait qu'√† partir du flux principal. <br><br>  Ainsi, pour cr√©er le rapport, nous devons ex√©cuter les t√¢ches dans une certaine s√©quence, et en m√™me temps, certaines d'entre elles peuvent fonctionner dans le thread d'arri√®re-plan, et une partie doit √™tre lanc√©e dans le thread principal. <br><br>  √Ä premi√®re vue, pour r√©soudre ce probl√®me, vous pouvez essayer d'utiliser le m√©canisme standard et ex√©cuter chaque op√©ration dans une coroutine distincte.  Cependant, cela ne nous √©vite pas le probl√®me du freinage de l'interface.  Comme vous le savez, les coroutines fonctionnent dans le thread principal et ne conviennent pas aux op√©rations lentes.  Dans le m√™me temps, lors de la g√©n√©ration d'un rapport, de nombreuses op√©rations n√©cessitent beaucoup de temps, et donc les coroutines ne peuvent pas aider √† r√©soudre notre probl√®me. <br><br><h4>  UniRx </h4><br>  Une autre solution consiste √† diviser le code en une partie qui doit fonctionner dans le thread principal et une partie qui peut √™tre ex√©cut√©e dans un thread s√©par√©.  Dans ce cas, par exemple, les images peuvent √™tre construites √† l'aide du m√©canisme coroutine, puis elles peuvent √™tre int√©gr√©es dans le rapport dans un flux distinct.  Cependant, dans ce cas, il sera n√©cessaire de sauvegarder les r√©sultats interm√©diaires quelque part, ce qui impose des restrictions suppl√©mentaires sur la quantit√© de m√©moire utilis√©e ou l'espace libre sur l'appareil. <br><br>  Dans notre application, nous avons pr√©f√©r√© aller directement et ex√©cuter les t√¢ches s√©quentiellement dans les threads principaux ou d'arri√®re-plan.  Le seul probl√®me √©tait de savoir comment organiser un tel lancement de t√¢ches pour ne pas s'enliser dans ce p√©trin et synchroniser correctement les op√©rations. <br>  Une aide significative pour r√©soudre ce probl√®me a √©t√© apport√©e par l'utilisation de Rx, son mode de r√©alisation en tant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">qu'actif</a> UniRx gratuit, qui a d√©j√† √©t√© d√©crit en d√©tail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">hub</a> . <br><br>  Son utilisation a grandement simplifi√© l'interaction entre les threads et l'exemple ci-dessous montre que vous pouvez ex√©cuter plusieurs m√©thodes dans un ordre strict, mais dans des threads diff√©rents <br><br><div class="spoiler">  <b class="spoiler_title">Exemple de code</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> initializer = Observable.FromCoroutine(initMethod); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> heavyMethod1 = Observable.Start(() =&gt; doHardWork()); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mainThread1 = Observable.FromCoroutine(renderImage); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> heavyMethod2 = Observable.Start(() =&gt; doHardWork2()); initializer.SelectMany(heavyMethod1) .SelectMany(mainThread1) .SelectMany(heavyMethod2) .ObserveOnMainThread() .Subscribe((x) =&gt; done()) .AddTo(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>);</code> </pre><br>  Dans cet exemple, la m√©thode doHardWork () sera ex√©cut√©e s√©quentiellement dans le thread d'arri√®re-plan.  Apr√®s son ach√®vement, renderImage () sera lanc√© dans le thread principal, et apr√®s cela doHardWork2 () sera √† nouveau ex√©cut√© dans le thread d'arri√®re-plan. <br></div></div><br>  Il convient √©galement de noter que lors de l'analyse de la g√©n√©ration de rapport pour les performances, il a √©t√© constat√© que la partie la plus lente est la mise en ≈ìuvre des images dans le rapport.  Une recherche sur Internet a montr√© que nous ne sommes pas les seuls √† faire face √† ce probl√®me, mais il n'y avait pas de solution appropri√©e pour nous.  Nous avons d√ª r√©duire l√©g√®rement la qualit√© de l'image √† un niveau acceptable, ce qui a entra√Æn√© une augmentation de la vitesse de 20 √† 40%. <br><br>  Ainsi, dans l'application que nous avons cr√©√©e, il a √©t√© possible d'introduire avec succ√®s le moteur graphique Unity dans l'application iOS / Android native.  Cela diff√®re de l'approche traditionnelle lorsque Unity est la partie principale de l'application et traite les propri√©t√©s sp√©cifiques du syst√®me via le syst√®me de plug-in.  Dans le m√™me temps, notre approche peut √™tre utile si vous avez besoin de d√©velopper une interface native complexe dans laquelle vous souhaitez int√©grer des graphiques 3D non triviaux. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr417779/">https://habr.com/ru/post/fr417779/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr417769/index.html">Conception de la m√©moire utilisateur: comment concevoir pour les √¢ges</a></li>
<li><a href="../fr417771/index.html">Plan de l'ICANN: la soci√©t√© propose un nouveau mod√®le de gestion de serveur racine DNS</a></li>
<li><a href="../fr417773/index.html">Installateur de composants OpenPnP fait maison</a></li>
<li><a href="../fr417775/index.html">M√©canisme de commission Bitcoin et pourquoi √™tre ami avec les mineurs</a></li>
<li><a href="../fr417777/index.html">Week-end de lecture: 25 documents pour les amateurs de vinyle d√©butants</a></li>
<li><a href="../fr417781/index.html">La sonde de la NASA ¬´touche¬ª le Soleil - et ne fond pas</a></li>
<li><a href="../fr417783/index.html">Optimisations utilis√©es en Python: liste et tuple</a></li>
<li><a href="../fr417785/index.html">Quel administrateur syst√®me ne r√™ve pas de son entreprise d'externalisation?</a></li>
<li><a href="../fr417787/index.html">Mon exp√©rience professionnelle sur le r√¥le du coach agile en Europe, premi√®re partie</a></li>
<li><a href="../fr417789/index.html">Discussions sur les perspectives des t√©l√©coms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>