<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ≤Ô∏è üå™Ô∏è üçÖ Geduld und Arbeit werden den gesamten Text extrahieren üñïüèΩ üßôüèΩ ü§õ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="W√§hrend der Schulungssitzung (Mai-Juni und Dezember-Januar) bitten uns Benutzer, jede Minute nach Ausleihen von bis zu 500 Dokumenten zu suchen. Dokum...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Geduld und Arbeit werden den gesamten Text extrahieren</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/antiplagiat/blog/458842/"><p>  W√§hrend der Schulungssitzung (Mai-Juni und Dezember-Januar) bitten uns Benutzer, jede Minute nach Ausleihen von bis zu 500 Dokumenten zu suchen.  Dokumente werden in Dateien in verschiedenen Formaten geliefert, deren Komplexit√§t unterschiedlich ist.  Um ein Dokument auf Ausleihe zu √ºberpr√ºfen, m√ºssen wir zuerst seinen Text aus der Datei extrahieren und uns gleichzeitig mit der Formatierung befassen.  Die Aufgabe besteht darin, eine qualitativ hochwertige Extraktion von halben tausend Texten mit Formatierung pro Minute zu implementieren, w√§hrend sie selten (oder besser gar nicht) fallen, wenig Ressourcen verbrauchen und nicht die H√§lfte des galaktischen Budgets f√ºr die Entwicklung und den Betrieb der endg√ºltigen Idee bezahlen. </p><br><p>  Ja, ja, nat√ºrlich wissen wir, dass Sie aus drei Dingen - schnell, kosteng√ºnstig und effizient - zwei ausw√§hlen m√ºssen.  Das Schlimmste ist jedoch, dass wir in unserem Fall nichts l√∂schen k√∂nnen.  Die Frage ist, wie gut wir es gemacht haben ... </p><br><p><img src="https://habrastorage.org/webt/us/nu/t4/usnut4dlt0wwlqzbkwhnmlud1uo.png"></p><br><p>  <sub><em>Bildquelle: <a href="">Wikipedia</a></em></sub> <br></p><p><a name="habracut"></a></p><br><p>  Uns wird oft gesagt, dass das Schicksal der Menschen von der Qualit√§t unserer Arbeit abh√§ngt.  Deshalb muss man Perfektionisten in sich erziehen.  Nat√ºrlich verbessern wir st√§ndig die Qualit√§t des Systems (in allen Aspekten), da skrupellose Autoren neue Wege finden, um dies zu umgehen.  Und ich hoffe, dass der Tag nahe ist, an dem die Komplexit√§t der T√§uschung einerseits und das Gef√ºhl der Zufriedenheit durch eine gut gemachte Arbeit andererseits die √ºberwiegende Mehrheit der Studenten dazu veranlassen werden, ihren geliebten Wunsch, herumzuspielen, aufzugeben.  Gleichzeitig verstehen wir, dass der Preis f√ºr Fehler das m√∂gliche Leiden unschuldiger Menschen sein kann, wenn wir ihn pl√∂tzlich vort√§uschen. </p><br><p>  Warum bin ich  Wenn wir Perfektionisten w√§ren, w√ºrden wir nachdenklich eine Reihe von Artikeln √ºber die Arbeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">des Anti-Plagiat-Systems</a> schreiben.  Wir w√ºrden sorgf√§ltig einen Ver√∂ffentlichungsplan formulieren, um alles auf die logischste und erwartete Weise f√ºr den Leser darzulegen: </p><br><ul><li>  Zun√§chst w√ºrden wir √ºber die Struktur unseres Systems sprechen (die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">f√ºnfte Ver√∂ffentlichung</a> zu Habr√©) und die drei Hauptphasen der Verarbeitung eines Dokuments beschreiben, wenn es auf Ausleihe gepr√ºft wird: <br><ol><li>  Extrahieren Sie den Text des Dokuments (Sie sind hier!); </li><li>  Suche nach Krediten (St√ºcke sind bereits <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">in mehreren unserer Artikel enthalten</a> ); </li><li>  Erstellen eines Berichts √ºber das Dokument (in Pl√§nen). </li></ol></li><li>  Ferner w√ºrden wir beginnen, den Leser dem Ger√§t interessanter Hilfsmechanismen zu widmen, wie der Suche nach √ºbertragbaren Anleihen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erster Artikel</a> ), der Definition der Paraphrase ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vierter</a> ) und der thematischen Klassifizierung ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zweiter</a> ). </li><li>  Und schlie√ülich kamen wir zur Suchmaschine - dem Index der G√ºrtelrose ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">siebter Artikel</a> ). </li></ul><br><p> Ein aufmerksamer Leser muss bemerkt haben, dass wir immer noch nicht unter √ºberm√§√üigem Perfektionismus leiden. Es ist also an der Zeit, mit der ersten Phase fortzufahren - dem Extrahieren von Text und dem Formatieren von Dokumenten.  Dies ist, was wir heute tun werden, auf dem Weg √ºber die Sterblichkeit des Seins und √ºber das Licht am Ende des Tunnels, √ºber die Nichtexistenz von etwas Idealem und √ºber das Streben nach Exzellenz, dar√ºber, einen Plan zu haben und ihm zu folgen und √ºber die Kompromisse, zu denen das Leben uns immer neigt. </p><br><h1>  Am Anfang war das Wort </h1><br><p>  Zuerst haben wir aus den Dokumenten nur das extrahiert, was f√ºr die √úberpr√ºfung auf Ausleihe am notwendigsten ist - den Text der Dokumente selbst.  Die Hauptformate wurden unterst√ºtzt - docx, doc, txt, pdf, rtf, html.  Dann wurden die weniger verbreiteten ppt, pptx, odt, epub, fb2, djvu hinzugef√ºgt, aber es war <abbr title="Da die sehr geringe Nachfrage den Aufwand f√ºr die Unterst√ºtzung dieser Formate nicht rechtfertigte">notwendig, sich zu weigern, in Zukunft</abbr> mit den meisten von ihnen <abbr title="Da die sehr geringe Nachfrage den Aufwand f√ºr die Unterst√ºtzung dieser Formate nicht rechtfertigte">zu</abbr> arbeiten.  Jeder von ihnen wurde auf seine Weise verarbeitet - irgendwo in einer separaten Bibliothek, irgendwo in einem eigenen Parser.  Im Durchschnitt dauerte die Textextraktion etwa Hunderte von Millisekunden.  Es scheint, dass die Haupt- und fast die einzige Schwierigkeit beim Extrahieren von Text das ‚ÄûParsen‚Äú des Formats selbst ist, was insbesondere f√ºr bin√§re PDF- und Doc-Formate gilt (und die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">propriet√§re Natur des</a> letzteren macht die Arbeit damit noch problematischer).  Bereits zu diesem Zeitpunkt, als sich unsere W√ºnsche nur auf das Extrahieren des Textes beschr√§nkten, wurde jedoch klar, dass jede Art des Lesens der ben√∂tigten Formate eine Reihe unangenehmer Merkmale mit sich bringt.  Die bedeutendsten von ihnen: </p><br><ul><li>  Ausnahmen sind auch bei der Verarbeitung einiger g√ºltiger Dokumente, ganz zu schweigen von der Verarbeitung falsch geformter ‚Äûdefekter‚Äú Dokumente.  Was noch mehr Probleme verursacht, ist, dass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nativer Code</a> fallen kann und der Umgang mit solchen Situationen in .net-Code schwierig ist. </li><li>  Unzureichend hoher Speicherverbrauch, der sowohl benachbarte als auch den aktuellen Prozess, der das ‚ÄûProblem‚Äú -Dokument verarbeitet, beeintr√§chtigen kann (nicht gen√ºgend Speicher in verwaltetem oder nicht verwaltetem Code); </li><li>  Zu lange Verarbeitung eines Dokuments, was durch das Fehlen von Stornierungsmechanismen f√ºr die meisten Bibliotheken und manchmal durch die Komplexit√§t (sprich: fast unm√∂glich) des Abbrechens eines nicht verwalteten Codeaufrufs von einem verwalteten verschlimmert wird; </li><li>  "Textextraktion aus Dokumenten."  Das Generieren des Textes eines PDF-Dokuments (und dieses Format ist der Schl√ºssel f√ºr uns), dessen Analyse wider Erwarten bereits durchgef√ºhrt wurde, ist keine triviale Aufgabe.  Tatsache ist, dass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das PDF-Format</a> urspr√ºnglich haupts√§chlich f√ºr die elektronische Pr√§sentation von Druckmaterialien entwickelt wurde.  Text in PDFs ist eine Reihe von Textbl√∂cken, die sich auf den Seiten eines Dokuments befinden.  Dar√ºber hinaus kann der Block ein Textabsatz oder ein einzelnes Zeichen sein.  Die Aufgabe, den Text in seiner urspr√ºnglichen Form aus diesem Satz von Bl√∂cken wiederherzustellen, liegt bei der Bibliothek (Code / Programm), die das Dokument liest.  Ja, das Format, beginnend mit einer bestimmten Version, bietet die M√∂glichkeit, die Reihenfolge der Bl√∂cke anzugeben. Leider sind Dokumente mit einer markierten Folge von Textbl√∂cken selten.  Daher enthalten PDF- <s>Textlesebibliotheken</s> eine Reihe von Heuristiken (dies ist hier Standard: maschinelles Lernen, <s>BigData, Blockchain</s> , ...), mit denen Sie den Text in der richtigen Form mit dem einen oder anderen Grad wiederherstellen k√∂nnen. Wie erwartet ist das Ergebnis von Bibliothek zu Bibliothek unterschiedlich . </li></ul><br><p><img src="https://habrastorage.org/webt/nr/hu/jb/nrhujbad4ji9xkwm5qzajzmvq24.png"></p><br><p>  <sub><em>Unten Bildquelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Artikel</a></em></sub> </p><br><p>  <sub><em>Top Bildquelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hmm ...</a></em></sub> </p><br><h1>  Ben√∂tigen Sie weitere Daten! </h1><br><p>  Wenn f√ºr die Analyse eines Dokuments zum Ausleihen der Texthintergrund des Dokuments ausreichte, ist die Implementierung einer Reihe neuer Funktionen unm√∂glich oder sehr schwierig, ohne zus√§tzliche Daten aus dem Dokument zu extrahieren.  Heute extrahieren wir neben dem Texthintergrund auch die Dokumentformatierung und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">rendern</a> Seitenbilder.  Letzteres verwenden wir zur optischen Texterkennung ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OCR</a> ) sowie zur Identifizierung einiger Arten von Byp√§ssen. </p><br><p>  Das Formatieren eines Dokuments umfasst die geometrische Anordnung aller W√∂rter und Zeichen auf den Seiten sowie die Schriftgr√∂√üe aller Zeichen.  Diese Informationen erm√∂glichen es uns: </p><br><ul><li>  Zeigen Sie den Dokument√ºberpr√ºfungsbericht auf sch√∂ne Weise an und zeichnen Sie erkannte Anleihen direkt auf das Originaldokument. <br><img src="https://habrastorage.org/webt/hk/uo/am/hkuoamt7hjscszy6lcgoc4vjeoy.png"><br></li><li>  Die Dokumentbl√∂cke (Titelseite, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bibliographie</a> ) genauer zu bestimmen und ihre Metadaten (Autoren, Berufsbezeichnung, Jahr und Arbeitsort usw.) abzurufen; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Systemumgehungsversuche erkennen.</a> </li></ul><br><p>  Um die Verarbeitung von Dokumenten und einer Reihe extrahierter Daten zu vereinheitlichen, konvertieren wir Dokumente aller von uns unterst√ºtzten Formate in PDF.  Somit wird das Verfahren zum Extrahieren von Dokumentdaten in zwei Schritten ausgef√ºhrt: </p><br><ul><li>  Konvertieren Sie ein Dokument in PDF; </li><li>  Daten aus PDF extrahieren. </li></ul><br><h1>  In PDF konvertieren.  Bibliotheksauswahl </h1><br><p>  Da es nicht so einfach ist, ein Dokument in PDF zu konvertieren, haben wir beschlossen, das Rad nicht neu zu erfinden und vorgefertigte L√∂sungen zu suchen, um die f√ºr uns am besten geeignete auszuw√§hlen.  Es war zur√ºck im Jahr 2017. </p><br><p>  Kriterien f√ºr die Auswahl der Kandidaten: </p><br><ul><li>  Bibliothek auf .net, idealerweise .net Core und plattform√ºbergreifend <div class="spoiler">  <b class="spoiler_title">Spoiler!</b> <div class="spoiler_text">  Infolgedessen war das Ideal in diesem Moment unerreichbar </div></div></li><li>  Unterst√ºtzung f√ºr erforderliche Formate - doc, docx, rtf, odf, ppt, pptx </li><li>  Stabilit√§t </li><li>  Leistung </li><li>  Qualit√§t des technischen Supports </li><li>  Ausgabepreis </li></ul><br><p>  Wir haben die verf√ºgbaren L√∂sungen analysiert und unter ihnen die 6 f√ºr unsere Aufgaben am besten geeigneten ausgew√§hlt: </p><br><div class="scrollable-table"><table><tbody><tr><th>  Die Bibliothek </th><th>  Oberfl√§chenprobleme </th></tr><tr><td>  MS Word.  Interop </td><td>  <b>Ben√∂tigt:</b> MS Word.  Rufen Sie Microsoft Word √ºber COM auf.  Die Methode hat viele Nachteile: die Notwendigkeit von installiertem MS Word, Instabilit√§t, schlechte Leistung.  Es gibt Lizenzbeschr√§nkungen. </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DevExpress (17)</a> </td><td>  Unterst√ºtzt nicht ppt, pptx </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Groupdocs</a> </td><td>  - - </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Syncfusion</a> </td><td>  Unterst√ºtzt ppt, pptx, odt nicht </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Neevia Document Converter Pro</a> </td><td>  Ben√∂tigt: MS Word.  Unterst√ºtzt odt nicht </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dynamicpdf</a> </td><td>  Ben√∂tigt: MS Word, Internet Explorer.  Unterst√ºtzt odt nicht </td></tr></tbody></table></div><br><p>  MS Word Interop, Neevia Document Converter Pro und DynamicPdf erfordern die Installation von MS Office in der Produktion, was uns endg√ºltig und unwiderruflich an Windows binden k√∂nnte.  Daher haben wir diese Optionen nicht mehr ber√ºcksichtigt. </p><br><p>  Somit haben wir noch drei Hauptkandidaten, und nur einer von ihnen unterst√ºtzt alle ben√∂tigten Formate vollst√§ndig.  Nun, es ist Zeit zu sehen, wozu sie f√§hig sind. </p><br><p>  Zum Testen der Bibliotheken haben wir eine Stichprobe von 120.000 realen Benutzerdokumenten erstellt, wobei das Verh√§ltnis der Formate ungef√§hr dem entspricht, was wir jeden Tag in der Produktion sehen. </p><br><p>  Also die erste Runde.  Mal sehen, welcher Anteil der Dokumente erfolgreich in die betrachteten PDF-Bibliotheken konvertiert werden kann.  In unserem Fall ist es erfolgreich, keine Ausnahme auszul√∂sen, das 3-Minuten-Timeout einzuhalten und einen nicht leeren Text zur√ºckzugeben. </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Konverter </th><th rowspan="2">  Erfolgreich (%) </th><th colspan="5">  Nicht erfolgreich (%) </th></tr><tr><th>  Insgesamt </th><th>  Leerer Text </th><th>  Ausnahme </th><th>  Zeit√ºberschreitung (3 Minuten) </th><th>  Prozessabfall </th></tr><tr><td>  Groupdocs </td><td>  99.012 </td><td>  0,988 </td><td>  0,039 </td><td>  0,873 </td><td>  0,076 </td><td>  0 </td></tr><tr><td>  DevExpress </td><td>  99,819 </td><td>  0,181 </td><td>  0,123 </td><td>  0,019 </td><td>  0,039 </td><td>  0 </td></tr><tr><td>  Syncfusion </td><td>  98.358 </td><td>  1,632 </td><td>  0,039 </td><td>  0,848 </td><td>  0,745 </td><td>  0,01 </td></tr></tbody></table></div><br><p>  Syncfusion fiel sofort auf, wodurch nicht nur die kleinste Anzahl von Dokumenten erfolgreich verarbeitet werden konnte, sondern auch der gesamte Prozess auf einige Dokumente √ºbertragen wurde (wodurch Ausnahmen wie OutOfMemoryException oder Ausnahmen aus dem nativen Code generiert wurden, die nicht abgefangen wurden, ohne mit einem Tamburin zu tanzen). </p><br><p>  GroupDocs konnte etwa <b>5,5-</b> mal mehr Dokumente als DevExpress nicht verarbeiten (alles ist auf der obigen Tafel zu sehen).  Dies trotz der Tatsache, dass eine einzelne Entwicklerlizenz von GroupDocs ungef√§hr neunmal teurer ist als eine einzelne Entwicklerlizenz von DevExpress.  Das ist √ºbrigens so. </p><br><p>  Der zweite ernsthafte Test ist die Konvertierungszeit, die gleichen 120.000 Dokumente: </p><br><div class="scrollable-table"><table><tbody><tr><th>  Konverter </th><th>  Mittelwert (Sek.) </th><th>  Median (Sek.) </th><th>  Std (Sek.) </th></tr><tr><td>  Groupdocs </td><td>  1.301966 </td><td>  0,328000 </td><td>  6.401197 </td></tr><tr><td>  DevExpress </td><td>  0,523453 </td><td>  0,252000 </td><td>  1,781898 </td></tr><tr><td>  Syncfusion </td><td>  8,922892 </td><td>  4,987000 </td><td>  12.929588 </td></tr></tbody></table></div><br><img src="https://habrastorage.org/webt/g5/2h/3k/g52h3klfh-leliffdwmrtmgapxy.png"><br><br><p>  Beachten Sie, dass DevExpress Dokumente nicht nur im Durchschnitt schneller verarbeitet, sondern auch eine viel stabilere Verarbeitungszeit aufweist. </p><br><p>  Stabilit√§t und Verarbeitungsgeschwindigkeit bedeuten jedoch nichts, wenn die Ausgabe als PDF schlecht ist.  Vielleicht √ºberspringt DevExpress den halben Text?  Wir pr√ºfen.  Also, die gleichen 120.000 Dokumente, dieses Mal berechnen wir das Gesamtvolumen des extrahierten Textes und den durchschnittlichen Anteil der W√∂rterbuchw√∂rter (je mehr extrahierte W√∂rter W√∂rterbuch sind, desto weniger M√ºll / falsch extrahierter Text): </p><br><div class="scrollable-table"><table><tbody><tr><th>  Konverter </th><th>  Die Gesamtmenge an Text (in Zeichen) </th><th>  Der durchschnittliche Anteil an Vokabeln </th></tr><tr><td>  Groupdocs </td><td>  6 321 145 966 </td><td>  0,949172 </td></tr><tr><td>  DevExpress </td><td>  6 135 668 416 </td><td>  0,950629 </td></tr><tr><td>  Syncfusion </td><td>  5,995,008,572 </td><td>  0,938693 </td></tr></tbody></table></div><br><p>  Zum Teil war die Annahme richtig.  Wie sich herausstellte, k√∂nnen GroupDocs im Gegensatz zu DevExpress mit Fu√ünoten arbeiten.  DevExpress √ºberspringt sie einfach, wenn Sie ein Dokument in PDF konvertieren.  √úbrigens, ja, der Text aus dem empfangenen PDF wird in jedem Fall mit DevExpress'a extrahiert. </p><br><p>  Daher haben wir die Geschwindigkeit und Stabilit√§t der betreffenden Bibliotheken untersucht und nun die Qualit√§t der Konvertierung von PDF-Dokumenten sorgf√§ltig bewertet.  Dazu analysieren wir nicht nur das Volumen des zu extrahierenden Textes und den Anteil der darin enthaltenen W√∂rterbuchw√∂rter, sondern vergleichen auch die aus den empfangenen PDFs extrahierten Texte mit den mit MS Word erhaltenen PDF-Texten.  Wir akzeptieren das Ergebnis der Konvertierung eines Dokuments mit MS Word als <i>Referenz-PDF</i> .  F√ºr diesen Test wurden ca. 4.500 Paare ‚Äû <i>Dokument, Referenz-PDF</i> ‚Äú vorbereitet. </p><br><div class="scrollable-table"><table><tbody><tr><th rowspan="2">  Konverter </th><th rowspan="2">  <abbr title="Prozentsatz der Dokumente, die die Bibliothek extrahieren konnte">Text extrahiert (%)</abbr> </th><th colspan="3">  N√§he zur Textl√§nge </th><th colspan="3">  N√§he nach Worth√§ufigkeit </th></tr><tr><th>  Durchschnitt </th><th>  Median </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SKO</a> </th><th>  Durchschnitt </th><th>  Median </th><th>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SKO</a> </th></tr><tr><td>  Groupdocs </td><td>  99,131 </td><td>  0,985472 </td><td>  0,999756 </td><td>  0,095304 </td><td>  0,979952 </td><td>  1.000000 </td><td>  0,102316 </td></tr><tr><td>  DevExpress </td><td>  99,726 </td><td>  0,971326 </td><td>  0,996647 </td><td>  0,075951 </td><td>  0,965686 </td><td>  0,996101 </td><td>  0,082192 </td></tr><tr><td>  Syncfusion </td><td>  89,336 </td><td>  0,880229 </td><td>  0,996845 </td><td>  0,306920 </td><td>  0,815760 </td><td>  0,998206 </td><td>  0,348621 </td></tr></tbody></table></div><br><p>  F√ºr jedes Paar " <i>Referenz-PDF, Konvertierungsergebnis</i> " haben wir die √Ñhnlichkeit in der L√§nge des extrahierten Textes und in den H√§ufigkeiten der extrahierten W√∂rter berechnet.  Nat√ºrlich wurden diese Metriken nur in den F√§llen erhalten, in denen die Konvertierung erfolgreich war.  Daher ber√ºcksichtigen wir die Ergebnisse der Syncfusion hier nicht.  DevExpress und GroupDocs zeigten ungef√§hr die gleiche Leistung.  Auf der DevExpress-Seite gibt es einen signifikant h√∂heren Prozentsatz erfolgreicher Conversions, auf der GD-Seite die korrekte Arbeit mit Fu√ünoten. </p><br><p>  Angesichts der Ergebnisse war die Wahl offensichtlich.  Bis heute verwenden wir die L√∂sung von DevExpress und planen in K√ºrze ein Upgrade auf die 19. Version. </p><br><h1>  Es gibt ein PDF, Text mit Formatierung extrahieren </h1><br><p>  So k√∂nnen wir Dokumente in PDF konvertieren.  Jetzt haben wir eine andere Aufgabe: DevExpress zum Extrahieren des Textes verwenden und √ºber jedes Wort alle Informationen wissen, die wir ben√∂tigen.  N√§mlich: </p><br><ul><li>  Auf welcher Seite steht das Wort; </li><li>  Die Position des Wortes auf der Seite (Einrahmen eines Rechtecks); </li><li>  Die Schriftgr√∂√üe des Wortes (Wortzeichen). </li></ul><br><p>  Das Bild zeigt die Aufteilung des Textes in Seiten sowie die Entsprechung eines Textworts zum Seitenbereich. </p><br><p><img src="https://habrastorage.org/webt/sv/zy/ja/svzyjafy1nmstmlbblte4uhdpwg.png"></p><br><p>  <sub><em>Bildquelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Extraktion von Header-Metadaten aus wissenschaftlichen Dokumenten</a></em></sub> </p><br><p>  Es scheint, dass alles einfach sein sollte.  Wir schauen uns an, was API DevExpress uns bietet: </p><br><ul><li>  Wir haben eine Methode, die den Text des gesamten Dokuments zur√ºckgibt.  Einfache <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schnur</a> ; </li><li>  Wir haben die M√∂glichkeit, gem√§√ü dem Dokument zu iterieren.  F√ºr jedes Wort k√∂nnen wir bekommen: <br><ul><li>  Text des Wortes; </li><li>  Die Seite, auf der sich das Wort befindet; </li><li>  Das Rahmenrechteck des Wortes; </li><li>  Informationen zu den einzelnen Zeichen des Wortes (die Bedeutung des Zeichens, das das Rechteck umrahmt, Schriftgr√∂√üe, ...). </li></ul><br></li></ul><br><p>  Okay, alles scheint da zu sein.  Nur hier erfahren Sie, wie Sie die erforderlichen Daten f√ºr jedes Wort im Text des Dokuments abrufen, das DevExpress zur√ºckgibt.  Wir m√∂chten den Text des Dokuments nicht wirklich selbst aus W√∂rtern sammeln, da wir beispielsweise keine Informationen haben, bei denen nur ein Leerzeichen zwischen den W√∂rtern und der Zeilenvorschub vorhanden ist.  Wir m√ºssen Heuristiken entwickeln, die auf der Position der W√∂rter basieren ... Der Text ist - hier ist er vor uns bereits zusammengestellt. </p><br><p><img src="https://habrastorage.org/webt/ti/d9/ru/tid9ruengnw06fe0krbvfqbpfle.jpeg"></p><br><p>  <sub><em>Bildquelle: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Eureka!</a></em></sub> </p><br><p>  Die naheliegende L√∂sung besteht darin, die W√∂rter mit dem Text des Dokuments abzugleichen.  Wir schauen - tats√§chlich sind die W√∂rter im Text des Dokuments in derselben Reihenfolge angeordnet, in der sie vom Iterator gem√§√ü den W√∂rtern des Dokuments zur√ºckgegeben werden. </p><br><p>  Wir implementieren schnell einen einfachen Algorithmus zum Abgleichen von W√∂rtern mit dem Text des Dokuments, f√ºgen √úberpr√ºfungen hinzu, ob alles korrekt √ºbereinstimmt, starten ... </p><br><p><img src="https://habrastorage.org/webt/uc/xw/ks/ucxwkst9qdybxsrwsgrxi4qncyk.png"></p><br><p>  In der Tat funktioniert auf den meisten Seiten alles korrekt, aber leider nicht auf allen Seiten. </p><br><img src="https://habrastorage.org/webt/mm/sc/gb/mmscgb1gygbne-ail3tsccjs_ik.png"><br><p>  <sub><em>Top Bildquelle: <a href="">Sind Sie sicher?</a></em></sub> </p><br><p>  Seitens der Dokumente sehen wir, dass die W√∂rter im Text nicht in der Reihenfolge sind, in der sie beim Durchlaufen der W√∂rter des Dokuments ablaufen.  Dar√ºber hinaus ist ersichtlich, dass die √∂ffnende eckige Klammer im Text in der Wortliste als schlie√üende Klammer dargestellt wird und sich in einem anderen ‚ÄûWort‚Äú befindet.  Die korrekte Anzeige dieses Textfragments kann durch √ñffnen des Dokuments in MS Word angezeigt werden.  Interessanter ist, dass Sie, wenn Sie das Dokument nicht in PDF konvertieren, sondern den Text direkt aus dem Dokument extrahieren, die dritte Version des Textfragments erhalten, die weder der richtigen Reihenfolge noch den beiden anderen von der Bibliothek erhaltenen Bestellungen entspricht.  In diesem Fragment, wie in den meisten anderen, bei denen ein √§hnliches Problem auftritt, liegt der Punkt in unsichtbaren "RTL" -Zeichen, die die Reihenfolge der benachbarten Zeichen / W√∂rter √§ndern. </p><br><p>  An dieser Stelle sei daran erinnert, dass wir die Qualit√§t des technischen Supports bei der Auswahl einer Bibliothek als wichtig bezeichnet haben.  Wie die Praxis gezeigt hat, ist die Interaktion mit DevExpress in dieser Hinsicht sehr effektiv.  Das Problem mit dem eingereichten Dokument wurde schnell behoben, nachdem wir das entsprechende Ticket erstellt hatten.  Eine Reihe anderer Probleme im Zusammenhang mit Ausnahmen / hohem Speicherverbrauch / langer Dokumentverarbeitung wurden ebenfalls behoben. </p><br><p>  Obwohl DevExpress keine direkte M√∂glichkeit bietet, den Text mit den erforderlichen Informationen f√ºr jedes Wort abzurufen, vergleichen wir den Vergleich manchmal unvergleichlich.  Wenn wir keine exakte √úbereinstimmung zwischen W√∂rtern und Text herstellen k√∂nnen, verwenden wir eine Reihe von Heuristiken, die kleine Permutationen von W√∂rtern erm√∂glichen.  Wenn nichts hilft, bleibt das Dokument ohne Formatierung.  Selten, aber das passiert. </p><br><p>  Tsch√ºss :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de458842/">https://habr.com/ru/post/de458842/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de458830/index.html">Dell Technologies-Webinare: Alle Details unseres Tutorials</a></li>
<li><a href="../de458832/index.html">F√ºnf Studenten und drei verteilte Schl√ºsselwertspeicher</a></li>
<li><a href="../de458834/index.html">Seite der Pers√∂nlichkeit von Paul Allen, von der nicht so viele Menschen wussten, wie ich m√∂chte</a></li>
<li><a href="../de458836/index.html">Borsch Index. Ein systematischer Ansatz zur Bewertung, zum Vergleich und zur Bestimmung des Preis-Leistungs-Verh√§ltnisses</a></li>
<li><a href="../de458840/index.html">Wie wir die Great Chinese Firewall durchbohrt haben (Teil 2)</a></li>
<li><a href="../de458844/index.html">Silozerst√∂rung durch VeriSM ‚Ñ¢ -Anpassungsansatz</a></li>
<li><a href="../de458846/index.html">So entwickeln Sie mit Unity einen weiteren Plattformer. Ein weiteres Tutorial</a></li>
<li><a href="../de458848/index.html">Rust 1.36.0 Release: Zuk√ºnftiges Merkmal, Allokationsstabilisierung und MaybeUninit <T></a></li>
<li><a href="../de458850/index.html">Lerne Englisch billig und effizient. Teil 2</a></li>
<li><a href="../de458854/index.html">MotionLayout: Animationen sind besser, weniger Code</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>