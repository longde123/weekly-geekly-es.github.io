<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©‚Äç‚öñÔ∏è üçÑ ü§πüèº Un peu plus sur les graphiques, ou comment d√©tecter les d√©pendances entre vos applications üë®üèº‚Äçüíº üö≠ ‚úåüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, chers coll√®gues. R√©cemment, il a √©t√© beaucoup question de transf√©rer des applications des infrastructures physiques, lire les centres de donn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un peu plus sur les graphiques, ou comment d√©tecter les d√©pendances entre vos applications</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425235/"><p>  Bonjour, chers coll√®gues.  R√©cemment, il a √©t√© beaucoup question de transf√©rer des applications des infrastructures physiques, lire les centres de donn√©es, vers le cloud.  Par exemple, dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Microsoft Azure</a> .  Eh bien, ou en g√©n√©ral, √† propos de tout autre transfert d'une ou plusieurs applications d'un endroit √† un autre.  L'un des plus gros probl√®mes de ce type de probl√®me est la n√©cessit√© de trouver toutes les d√©pendances externes de l'application.  Cela ne fait pas r√©f√©rence aux d√©pendances dans le code, mais aux d√©pendances sur les syst√®mes externes par rapport √† l'application.  En fait, nous devons parfois trouver avec qui notre proposition parle et qui lui parle.  Comment faire si nous n'avons pas de SIEM complet, pour ainsi dire, en utilisant le SIEM pour les pauvres.  En fait, pour les syst√®mes sous Windows, il y a la phrase suivante. </p><a name="habracut"></a><br><p>  Nous avons besoin de: </p><br><ul><li>  Activer la journalisation dans le pare-feu Windows sur toutes les machines, d'une mani√®re ou d'une autre associ√©es √† l'application </li><li>  T√©l√©charger sur le <a href="">module PSQuickGraph de la</a> station d'administration </li><li>  Compiler et analyser les journaux, construire un graphique de liens </li></ul><br><p>  Dans sa forme la plus simple, l'analyse des journaux ressemble √† ceci.  Horrible, front, mais que pouvez-vous faire.  En fait, j'√©tais trop paresseux pour √©crire la logique de la course aux journaux, je viens de tout copier deux fois.  Mais pour nos fins, "grossi√®rement et dans le front" ira aussi afin de montrer l'id√©e </p><br><pre><code class="hljs powershell"><span class="hljs-variable"><span class="hljs-variable">$f</span></span> = gc <span class="hljs-string"><span class="hljs-string">"C:\Temp\pfirewall_public.log"</span></span> <span class="hljs-variable"><span class="hljs-variable">$regex</span></span> = <span class="hljs-string"><span class="hljs-string">'^(?&lt;datetime&gt;\d{4,4}-\d{2,2}-\d{2,2}\s\d{2}:\d{2}:\d{2})\s(?&lt;action&gt;\w+)\s(?&lt;protocol&gt;\w+)\s(?&lt;srcip&gt;\b(?:\d{1,3}\.){3}\d{1,3}\b)\s(?&lt;dstip&gt;\b(?:\d{1,3}\.){3}\d{1,3}\b)\s(?&lt;srcport&gt;\d{1,5})\s(?&lt;dstport&gt;\d{1,5})\s(?&lt;size&gt;\d+|-)\s(?&lt;tcpflags&gt;\d+|-)\s(?&lt;tcpsyn&gt;\d+|-)\s(?&lt;tcpack&gt;\d+|-)\s(?&lt;tcpwin&gt;\d+|-)\s(?&lt;icmptype&gt;\d+|-)\s(?&lt;icmpcode&gt;\d+|-)\s(?&lt;info&gt;\d+|-)\s(?&lt;path&gt;.+)$'</span></span> <span class="hljs-variable"><span class="hljs-variable">$log</span></span> = <span class="hljs-variable"><span class="hljs-variable">$f</span></span> | % { <span class="hljs-variable"><span class="hljs-variable">$_</span></span> <span class="hljs-operator"><span class="hljs-operator">-match</span></span> <span class="hljs-variable"><span class="hljs-variable">$regex</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>) { [<span class="hljs-type"><span class="hljs-type">PSCustomObject</span></span>]<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>{ action = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.action srcip = [<span class="hljs-type"><span class="hljs-type">ipaddress</span></span>]<span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.srcip dstport = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.dstport tcpflags = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.tcpflags dstip = [<span class="hljs-type"><span class="hljs-type">ipaddress</span></span>]<span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.dstip info = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.info size = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.size protocol = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.protocol tcpack = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.tcpac srcport = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.srcport tcpsyn = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.tcpsyn datetime = [<span class="hljs-built_in"><span class="hljs-built_in">datetime</span></span>]<span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.datetime icmptype = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.icmptype tcpwin = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.tcpwin icmpcode = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.icmpcode path = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.path } } } <span class="hljs-variable"><span class="hljs-variable">$f</span></span> = gc <span class="hljs-string"><span class="hljs-string">"C:\Temp\pfirewall_public2.log"</span></span> <span class="hljs-variable"><span class="hljs-variable">$log2</span></span> = <span class="hljs-variable"><span class="hljs-variable">$f</span></span> | % { <span class="hljs-variable"><span class="hljs-variable">$_</span></span> <span class="hljs-operator"><span class="hljs-operator">-match</span></span> <span class="hljs-variable"><span class="hljs-variable">$regex</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">Out-Null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>) { [<span class="hljs-type"><span class="hljs-type">PSCustomObject</span></span>]<span class="hljs-selector-tag"><span class="hljs-selector-tag">@</span></span>{ action = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.action srcip = [<span class="hljs-type"><span class="hljs-type">ipaddress</span></span>]<span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.srcip dstport = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.dstport tcpflags = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.tcpflags dstip = [<span class="hljs-type"><span class="hljs-type">ipaddress</span></span>]<span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.dstip info = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.info size = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.size protocol = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.protocol tcpack = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.tcpac srcport = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.srcport tcpsyn = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.tcpsyn datetime = [<span class="hljs-built_in"><span class="hljs-built_in">datetime</span></span>]<span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.datetime icmptype = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.icmptype tcpwin = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.tcpwin icmpcode = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.icmpcode path = <span class="hljs-variable"><span class="hljs-variable">$Matches</span></span>.path } } } <span class="hljs-variable"><span class="hljs-variable">$l</span></span> = <span class="hljs-variable"><span class="hljs-variable">$log</span></span> + <span class="hljs-variable"><span class="hljs-variable">$log2</span></span> <span class="hljs-variable"><span class="hljs-variable">$g</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new-graph</span></span> <span class="hljs-literal"><span class="hljs-literal">-Type</span></span> BidirectionalGraph <span class="hljs-variable"><span class="hljs-variable">$l</span></span> | ? {<span class="hljs-variable"><span class="hljs-variable">$_</span></span>.srcip <span class="hljs-operator"><span class="hljs-operator">-and</span></span> <span class="hljs-variable"><span class="hljs-variable">$_</span></span>.dstip} | % { <span class="hljs-built_in"><span class="hljs-built_in">Add-Edge</span></span> <span class="hljs-literal"><span class="hljs-literal">-From</span></span> <span class="hljs-variable"><span class="hljs-variable">$_</span></span>.srcip <span class="hljs-literal"><span class="hljs-literal">-To</span></span> <span class="hljs-variable"><span class="hljs-variable">$_</span></span>.dstip <span class="hljs-literal"><span class="hljs-literal">-Graph</span></span> <span class="hljs-variable"><span class="hljs-variable">$g</span></span> | <span class="hljs-built_in"><span class="hljs-built_in">out-null</span></span> } <span class="hljs-built_in"><span class="hljs-built_in">Show-GraphLayout</span></span> <span class="hljs-literal"><span class="hljs-literal">-Graph</span></span> <span class="hljs-variable"><span class="hljs-variable">$g</span></span></code> </pre> <br><p>  En fait, dans cet exemple, nous analysons simplement le journal du pare-feu Windows √† l'aide d'une expression r√©guli√®re, en le divisant en objets - un objet par ligne.  Que Dieu la b√©nisse avec RAM, ne meurs pas.  Dans cet exemple, nous avons deux journaux, provenant de deux machines diff√©rentes.  Apr√®s l'analyse, nous fusionnons simplement tout dans un grand tableau et ex√©cutons une recherche dessus, en ajoutant des sommets et des bords du graphique.  Eh bien, et en cons√©quence - affichez-le.  Donc, approximativement, cela ressemble √† ceci: </p><br><p><img src="https://habrastorage.org/webt/w4/ut/jc/w4utjc6nd9sk07znxb7b0x5yh-0.png" alt="appLinks"></p><br><p>  J'esp√®re que quelqu'un vous sera utile. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr425235/">https://habr.com/ru/post/fr425235/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr425225/index.html">Comment voir les liens √† l'int√©rieur de votre module PowerShell</a></li>
<li><a href="../fr425227/index.html">Les chercheurs ont trouv√© un moyen de d√©tecter et de contourner les cl√©s Honeytoken dans un certain nombre de services Amazon.</a></li>
<li><a href="../fr425229/index.html">Comment nous avons aid√© CDN MegaFon.TV √† ne pas participer √† la Coupe du monde 2018</a></li>
<li><a href="../fr425231/index.html">FAQ sur le travail d'une h√¥tesse de l'air</a></li>
<li><a href="../fr425233/index.html">Python 3 sur Facebook</a></li>
<li><a href="../fr425237/index.html">Mesure du temps avec une pr√©cision en nanosecondes</a></li>
<li><a href="../fr425241/index.html">D√©veloppeur 20 ans plus tard: Vasily Lebedev sur ICRE, l'√©ducation, son livre et sa programmation</a></li>
<li><a href="../fr425243/index.html">Le manuel de John Willis</a></li>
<li><a href="../fr425245/index.html">Annonce de RamblerFront & # 6</a></li>
<li><a href="../fr425247/index.html">Crowdsourcing dans les tests</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>