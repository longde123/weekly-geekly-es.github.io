<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçæ ü§Ωüèæ üåÄ Montre intelligente avec BASIC sur 6502 physique üßõüèæ üèä ‚öôÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le processeur 6502 existe depuis plus de 40 ans et est toujours utilis√© dans un certain nombre de syst√®mes embarqu√©s. WDC continue de produire des puc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Montre intelligente avec BASIC sur 6502 physique</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448758/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/gy/bi/ze/gybizext5yt88kfg3elkyxr5gic.jpeg"></div><br>  Le processeur 6502 existe depuis plus de 40 ans et est toujours utilis√© dans un certain nombre de syst√®mes embarqu√©s.  WDC continue de produire des puces p√©riph√©riques des s√©ries 65C02 et 65Cxx.  L'auteur a constat√© qu'elles sont d√©sormais disponibles dans les packages PLCC et QFP, mais ces options de puce sont rarement utilis√©es.  Les microcircuits dans des bo√Ætiers DIP ne sont plus disponibles, car la demande des fabricants maison est √† elle seule trop faible.  L'auteur a d√©cid√© de fabriquer la plus petite carte simple sur 6502, ce qu'il peut.  Il est possible que le plus petit processeur monocarte artisanal connu sur ce processeur (non self-made et moins, par exemple, Tamagotchi).  Le r√©sultat est un appareil sur lequel vous pouvez √©ventuellement d√©velopper un √©tui de poignet avec une sangle.  L'√©cran a √©t√© pris √† partir du Nokia 5110, la coque a √©t√© √©crite avec une belle interface, et il s'est av√©r√©, peut-√™tre, la seule montre intelligente sur 6502. <br><br>  La montre contient: un processeur 65C02 avec une fr√©quence d'horloge de 8 MHz, une puce 65C22, un √©cran LCD de contr√¥le et des boutons d'interrogation sur la carte et un clavier externe, un √©cran Nokia 5110 (84x48 pixels), 32 Ko de RAM statique, 16 Ko de ROM dans l'espace d'adressage.  La tension d'alimentation est de 3,3 V. <br><br>  Et surtout: en tant que station d'accueil, vous pouvez connecter la matrice du clavier du Commodore 64 au connecteur de la carte, obtenant quelque chose de similaire √† Seiko UC-2000 ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">avis sur Habr√©</a> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zn/b-/iq/znb-iqhvb8vu2mp7d5b48xvq_vu.jpeg"></div><a name="habracut"></a><br>  Circuit et topologie de la carte de circuits imprim√©s compil√©e dans KiCad.  Les dimensions de la planche double face sont de 3x1,5 pouces.  Tous les composants sont SMD, √† l'exception du panneau PLCC, ainsi que des connecteurs pour le clavier et l'√©cran LCD. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wx/ut/md/wxutmdfpfozprh_v2l1cjmwbfak.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a4/nj/qk/a4njqkemdtxq2arzw5s9whpxghg.png"></div><br>  La topologie de l'illustration n'est pas √† l'√©chelle.  L'apparence de la planche avant assemblage: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/v1/kj/p4/v1kjp4nloyqq_ykq96qr8fvycpw.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x3/pn/t1/x3pnt11c_bbq0i_e_jl5glbvmi0.jpeg"></div><br>  Apr√®s: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rt/sq/ma/rtsqmarlhhk9r1smkhs5xqrlete.jpeg"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sg/m5/ol/sgm5ol1cibggd321fi02pnuwtge.jpeg"></div><br>  <a href="">Archive</a> (circuit, cartes, firmware, etc.) <br><br>  Sur la montre, vous pouvez ex√©cuter plusieurs applications int√©gr√©es.  L'un d'eux, G'Mon (Generic Monitor), est le principal outil de d√©veloppement et de d√©bogage.  Il vous permet d'afficher et de modifier le contenu de la m√©moire dans des cellules et des fragments s√©par√©s, de basculer vers des programmes, de remplir les sections RAM avec l'octet sp√©cifi√© et de d√©placer des fragments dans l'espace d'adressage.  La version du moniteur utilis√©e dans la montre est simplifi√©e pour qu'en plus, EhBasic rentre dans la ROM.  Il y est √† peine entr√©, il ne reste que ~ 100 octets libres.  L'interpr√®te est refait de telle mani√®re qu'il a pu se combiner avec le noyau.  √Ä son tour, il contient toutes les routines d'initialisation, fonctionne avec des interfaces externes, ainsi que la relation de tous les logiciels disponibles.  Et une autre application - le menu principal. <br><br>  Une partie importante du c≈ìur est occup√©e par du code qui interagit avec l'√©cran LCD du Nokia 5110 via le protocole SPI impl√©ment√© par logiciel via 6522. Les sous-programmes WriteBYTE et Command envoient respectivement des donn√©es graphiques et des commandes √† l'√©cran LCD.  Puisqu'il n'y a pas de mode texte mat√©riel, les proc√©dures d'envoi de caract√®res √† l'√©cran sont √©crites.  Le g√©n√©rateur de caract√®res est stock√© dans la ROM et est repr√©sent√© par deux tables de recherche: une pour l'octet haut, l'autre pour l'octet bas.  Ensemble, ils indiquent la position absolue de l'octet de caract√®re de d√©part dans la ROM.  La routine d'√©criture doit √™tre ex√©cut√©e apr√®s l'√©criture du code ASCII sur la batterie du processeur et elle est √©galement utilis√©e comme coordonn√©e X pour les tables de recherche.  La routine √©crit d'abord le code ASCII dans le tampon d'√©cran en m√©moire.  Elle recherche ensuite les donn√©es de la tuile correspondante et y place un pointeur.  Affichage de 8 octets cons√©cutifs du pointeur, il appelle le sous-programme CCheck.  Cela v√©rifie par programme la position du curseur et, si l'√©cran est plein, appelle le sous-programme Scroll, qui d√©cale l'image d'une ligne de texte.  √âtant donn√© que l'auteur n'a pas impl√©ment√© la lecture √† partir du contr√¥leur LCD, le texte est index√© en fonction de la position du curseur et √©crit dans le tampon en m√©moire.  Le sous-programme Scroll affiche les trois derni√®res lignes du tampon aux trois premi√®res lignes de l'√©cran LCD, puis remplit la derni√®re ligne avec des espaces.  La routine restante pour travailler avec les √©crans LCD est CReturn.  Il recherche dans la table de recherche la position initiale de la ligne suivante et si la ligne actuelle n'est pas en bas, il augmente la position du curseur de un.  Si la ligne du bas - appelle la proc√©dure de d√©filement, puis seulement se termine. <br><br>  Le clavier est interrog√© via 6522 par le sous-programme GetKey.  Il lit la matrice du clavier ligne par ligne et √©crit des octets dans la m√©moire.  Si des bits s'av√®rent √™tre nuls, il d√©termine le code ASCII de la touche enfonc√©e dans la table de recherche.  Fondamentalement, le code ne contient pas de cycles afin de fonctionner le plus rapidement possible.  Les sous-programmes pour convertir des bits donn√©s en indices n'utilisent pas de tables de recherche, mais en cons√©quence, le code s'est av√©r√© assez volumineux et inefficace. <br><br>  Vid√©o: <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Votre navigateur ne prend pas en charge la vid√©o HTML5. <source src="http://notartyoms-box.net/images/6502Watch/Demo.mp4" type="video/mp4"></video></div></div></div><br>  L'auteur ne travaille plus sur ce firmware, il est pass√© √† d'autres projets.  Il esp√®re que le code sera utile pour ceux qui veulent contr√¥ler l'√©cran LCD du Nokia 5110 d'une seule carte √† 6502. Les routines correspondantes peuvent facilement √™tre transf√©r√©es vers d'autres logiciels.  Les plus importants d'entre eux sont Write, Write_NS, Command, WriteBYTE, LCDInit, LCDClear, CCheck, CCheck_NS, CReturn, Scroll et SETCursor.  LCDHome et WriteBMP sont d'autres routines utiles.  Il est n√©cessaire de placer les variables LCDCursor, GTmp, GTmp5 et GTmp6 en m√©moire, ainsi que la table Screen de 84 octets de long.  En plus d'eux, des tables de recherche CRTbl, CTableX et CTableY sont n√©cessaires, ainsi que des bitmaps Char et Char2 avec toutes les tuiles. <br><br>  Si vous souhaitez cr√©er d'autres ensembles de tuiles, utilisez les mod√®les du dossier Assets.  Dans GIMP, exportez le bitmap vers un fichier .data au format RGB (pas RGBX).  Ne faites pas attention au fichier .pal et placez le fichier .data dans le dossier BitConvert de l'archive.  Ex√©cutez Convert.sh filename.data pour obtenir le fichier FONT.bin, qui sera l'ensemble de tuiles. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr448758/">https://habr.com/ru/post/fr448758/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr448744/index.html">Comment transf√©rer une variable d'un fragment √† une activit√© dans Android?</a></li>
<li><a href="../fr448746/index.html">Index dans PostgreSQL - 7 (GIN)</a></li>
<li><a href="../fr448750/index.html">√Ä propos d'une vuln√©rabilit√© qui n'est pas</a></li>
<li><a href="../fr448754/index.html">Qui est qui en open source: biographies de geek</a></li>
<li><a href="../fr448756/index.html">Contexte: pourquoi Apple et Qualcomm se sont disput√©s, puis se sont r√©concili√©s</a></li>
<li><a href="../fr448760/index.html">D√©veloppement dans le cloud, s√©curit√© de l'information et donn√©es personnelles: condens√© pour lecture le week-end depuis 1cloud</a></li>
<li><a href="../fr448762/index.html">√âmeute sur le Picaba. Les utilisateurs vont massivement sur Reddit</a></li>
<li><a href="../fr448768/index.html">Contr√¥le d'√©clairage √† plusieurs niveaux: r√©silience des solutions et des produits</a></li>
<li><a href="../fr448770/index.html">Mise √† jour de la prise en charge de Razor dans Visual Studio Code. Maintenant avec blazor</a></li>
<li><a href="../fr448774/index.html">SQL vers CSV √† l'aide de DBMS_SQL</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>