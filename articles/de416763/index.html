<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§≤ üîì üîÄ Puppet Salt Chef Ensemble: Vergleichen Sie Ansible, SaltStack, Chef und Puppet ü§ï üóÑÔ∏è üåä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heute werden wir dar√ºber sprechen, was SCM ist, und einige Geschichten erz√§hlen, durch deren Prisma wir Ansible, SaltStack, Chef und Puppet betrachten...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Puppet Salt Chef Ensemble: Vergleichen Sie Ansible, SaltStack, Chef und Puppet</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/416763/">  Heute werden wir dar√ºber sprechen, was SCM ist, und einige Geschichten erz√§hlen, durch deren Prisma wir Ansible, SaltStack, Chef und Puppet betrachten und die beste Option f√ºr eine bestimmte Aufgabe ausw√§hlen. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3xA2SggKQKo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Das Material basiert auf einer Abschrift eines <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Berichts von Andrei Filatov</a> , leitender Systemingenieur bei EPAM Systems, von unserer DevOops 2017-Konferenz im Oktober. <br><a name="habracut"></a><br><h2>  Was ist SCM und womit isst es? </h2><br><img src="https://habrastorage.org/webt/hc/qk/qz/hcqkqz63ox1qwcu5qrfc08hkg7o.jpeg"><br><br>  Was ist SCM?  Erstens ist es eine Sache, die es unserer Infrastruktur von Zustand A aus erm√∂glicht, Zustand B durch Ausf√ºhren einer Art Code auszuf√ºhren. Viele Entwickler, die in der Praxis keine DevOps-Ingenieure sind, glauben, dass etwas auf eine ‚Äûautomatische‚Äú Weise geschieht auf die Infrastruktur. <br><br>  Die "automatische" Methode implementiert uns SCM (System Configuration Management).  Wof√ºr ist das?  In erster Linie, um wiederholbare und konsistente Infrastrukturen aufzubauen.  SCM erweitert CI / CD-Prozesse gut.  Da dies Code ist, kann er in jedem Versionskontrollsystem gespeichert werden: Git, Mercurial.  Es ist ganz einfach zu entwickeln und zu warten. <br><br>  Das letzte ist ein geschlossener Automatisierungszyklus: Alles kann automatisch erledigt werden, von der Erstellung der Infrastruktur √ºber die Bereitstellung bis hin zur Bereitstellung des Codes. <br><br><h2>  Was ist SCM: Ansible </h2><br><img src="https://habrastorage.org/webt/w8/kg/5z/w8kg5z-9n6uy-eva2x5ofgeiuig.jpeg"><br><br>  Betrachten Sie unsere Bewerber.  Der erste ist Ansible.  Es hat eine agentenlose Architektur, wenn es sich um eine Open-Source-Version handelt, es ist in Python geschrieben, es hat ein Yaml-√§hnliches DSL, es ist aufgrund der in Python geschriebenen Module leicht erweiterbar, es ist sehr einfach und leicht.  Ansible hat die niedrigste Einstiegsschwelle - Sie k√∂nnen jeden unterrichten. <br><br>  Es gibt Erfahrung, als eine Person, die Python nicht kannte und nichts √ºber SCM wusste, in nur zwei Tagen Ansible betrat und bereits anfing, etwas zu tun. <br>  Unten sehen Sie ein Beispiel f√ºr ChatOps: einen Notifier in Slack.  Der Ansible-Code, der Yaml gesehen hat, ist nichts Neues. <br><br><pre><code class="hljs pgsql">- block: - <span class="hljs-type"><span class="hljs-type">name</span></span>: "SlackNotify : Deploy Start" local_action: module: slack token: "{{ slack_url }}" attachments: - title: "Deploy to {{ inventory_hostname }} has been Started" <span class="hljs-type"><span class="hljs-type">text</span></span>: "&lt;!here&gt; :point_up_2:" color: "#551a8b" - <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>: configure.yml tags: - configure - <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>: remote-<span class="hljs-keyword"><span class="hljs-keyword">fetch</span></span>.yml tags: - remote - <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>: assets.yml</code> </pre> <br><hr><br><h2>  Was ist SCM: Chef </h2><br><img src="https://habrastorage.org/webt/wi/kr/bd/wikrbdzapzntbjimi4ns5jw2bm0.jpeg"><br><br>  Chef ist eine Client-Server-Architektur, es gibt einen Chef-Server und einen Chef-Client.  Die in Ruby geschriebene suchbasierte Konfiguration verf√ºgt √ºber Ruby DSL.  Dementsprechend k√∂nnen Sie in Ihren Kochb√ºchern und Rezepten die volle Leistung von Ruby nutzen, aber ich rate nicht dazu.  Chefkoch hat eine riesige Community und die gr√∂√üte Auswahl an Tools unter allen SCMs.  So sieht Chef-Code aus, dies ist Jetty-Bereitstellung. <br><br><pre> <code class="ruby hljs"><span class="hljs-comment"><span class="hljs-comment"># # Cookbook Name:: dg-app-edl # Recipe::fe # node.normal[:jetty][:home] = "/usr/share/jetty" node.normal[:jetty][:group] = "deploy" include_recipe "dg-auth::deploy" include_recipe "newrelic::repository" include_recipe "newrelic::server-monitor" include_recipe "dg-jetty::jetty9" include_recipe "newrelic::java-agent" directory "edl" do action :create owner group "deploy" mode "0775" path "/usr/share/where/edl" recursive true end</span></span></code> </pre><br><hr><br><h2>  Was ist SCM: SaltStack </h2><br><img src="https://habrastorage.org/webt/um/dp/qa/umdpqavcnru1d40qd-bncyclmx8.jpeg"><br><br>  SaltStack verf√ºgt sowohl √ºber eine agentenlose Architektur, die im Push-Modus mit Salt-SSH arbeitet, als auch √ºber eine Client-Server-Architektur, wenn Salt-Master und Salt-Minion vorhanden sind.  Der Schwerpunkt liegt auf der Echtzeitautomatisierung, der sofortigen parallelen Ausf√ºhrung aller Prozesse und der in Python geschriebenen.  Der Code ist ebenfalls eine Yaml-√§hnliche Sprache und Ansible sehr √§hnlich. <br><br><pre> <code class="hljs mel">#ntp-packages: pkg.installed: - pkgs: - ntp - ntpdate #/etc/ntp.conf: <span class="hljs-keyword"><span class="hljs-keyword">file</span></span>: - managed - <span class="hljs-keyword"><span class="hljs-keyword">source</span></span>: salt:<span class="hljs-comment"><span class="hljs-comment">//common/ntpd/ntp.conf - template: jinja - mode: 644 #/etc/sysconfig/ntpd: file: - managed - source: salt://common/ntpd/ntpd - template: jinja - mode: 644 #ntp-service: service.running: - name: ntpd</span></span></code> </pre><br><hr><br><h2>  Was ist SCM: Marionette </h2><br><img src="https://habrastorage.org/webt/iz/-3/ac/iz-3acdxp8hdgg-lxxk_lp8oilq.jpeg"><br><br>  Der letzte unserer Bieter ist Puppet.  Es hat auch eine Client-Server-Architektur, wie Chef, die Konfiguration basiert nicht auf der Suche, sondern auf den "Fakten", die mit dem in Ruby geschriebenen Puppet-Master kommen, hat ein Ruby-√§hnliches DSL.  Aber die Puppet-Jungs d√ºrfen in ihren Manifesten keinen reinen Ruby-Code verwenden.  Dies ist sowohl ein Plus als auch ein Minus.  So sieht der Puppet-Manifestcode aus: <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> { '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::server</span></span></span><span class="hljs-class">' : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">root_password</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">password</span></span></span><span class="hljs-class">' } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::db</span></span></span><span class="hljs-class">{ ['</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test2</span></span></span><span class="hljs-class">', '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test3</span></span></span><span class="hljs-class">']: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensure</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">present</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">charset</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">utf8</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">require</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Class</span></span></span><span class="hljs-class">['</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::server</span></span></span><span class="hljs-class">'], } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::db</span></span></span><span class="hljs-class">{ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test4</span></span></span><span class="hljs-class">': </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensure</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">present</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">charset</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">latin1</span></span></span><span class="hljs-class">', } </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mysql::db</span></span></span><span class="hljs-class">{ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test5</span></span></span><span class="hljs-class">': </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensure</span></span></span><span class="hljs-class"> =&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">present</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">charset</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binary</span></span></span><span class="hljs-class">', </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">collate</span></span></span><span class="hljs-class"> =&gt; '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">binary</span></span></span><span class="hljs-class">', }</span></span></code> </pre><br><h2>  SCM in der Praxis </h2><br><h3>  SaltStack in einer entmilitarisierten Umgebung </h3><br>  Zun√§chst m√∂chte ich ein Projekt teilen, das auf SaltStack geschrieben wurde.  Dies ist unser vorheriges Projekt und der frischeste Schmerz, und der frischeste Schmerz ist immer der schmerzhafteste.  Unser Kunde besch√§ftigt sich mit Datenspeicherung - dies ist die Herstellung von Eisenservern zum Speichern von Daten auf GPFS, GlusterFS, aber kundenspezifischen Builds.  Er kam mit folgenden Aufgaben zu uns: <br><br><ol><li>  Erstellen eines USB / DVD-Installationsprogramms.  Sie m√ºssen ein Medium erstellen, auf dem alles installiert ist.  Dies geschieht f√ºr Kunden, die in geschlossenen R√§umen leben, in denen die Server meist nicht √ºber das Internet verf√ºgen.  Wir m√ºssen eine ISO einpacken und an Au√üendiensttechniker senden, die alles Notwendige vor Ort bereitstellen. <br></li><li>  Stellen Sie einen Produktcluster bereit.  Kunden haben mehrere gro√üe Produkte. Wir m√ºssen sie im Cluster-Modus bereitstellen k√∂nnen. <br></li><li>  Verwaltung, Konfiguration und Wartung des Clusters mit dem CLI-Dienstprogramm.  Unser Framework soll Au√üendiensttechnikern bei der Verwaltung des Clusters helfen. <br></li></ol><br>  Der Kunde hatte mehrere Anforderungen.  Erstens verf√ºgt er √ºber eine gro√üe Menge an Python-Fachwissen, in der Tat nur C- und Python-Entwickler.  Der Kunde sagte sofort: ‚ÄûWir wollen SaltStack‚Äú und lie√ü keine Wahl. <br><br>  Was stehen wir vor?  Der Kunde hat mehrere Produkte in der Installation, alle m√ºssen mit Salt-Masters sein.  Wir stehen jedoch vor dem Problem, die Multi-Master-Konfiguration zu skalieren.  In NODE Info (dem Status eines bestimmten Servers) haben wir beispielsweise Millisekunden mit einer Zwei-Master-Konfiguration ausgew√§hlt, Sekunden mit drei Mastern und mit f√ºnf haben wir nie auf den Abschluss des Vorgangs gewartet.  MultiMaster ist eine gute Funktion, l√§sst sich aber nicht gut skalieren. <br><br>  Das zweite Problem war die Teamarbeit: SaltStack verf√ºgt √ºber Runner und Module.  Das Modul ist eine Erweiterung, die maschinenseitig auf Salt Minion ausgef√ºhrt wird.  Runner wird auf der Serverseite ausgef√ºhrt.  Wir hatten oft Schlachten: Was tun Runner und was tun Module? <br><br>  Dann stie√üen wir auf eine kleine √úberraschung von cache.mine: <br><br><pre> <code class="python hljs">ime = ImeActions() id = __grains__[<span class="hljs-string"><span class="hljs-string">'id'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> id == ime.master_id: ret = __salt__[<span class="hljs-string"><span class="hljs-string">'mine.get'</span></span>](id, <span class="hljs-string"><span class="hljs-string">'ime_actions.make_bfs_uuid'</span></span>) ime_dict = ret.get(id, <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> ime_dict: <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: result = __salt__[<span class="hljs-string"><span class="hljs-string">'mine.send'</span></span>](<span class="hljs-string"><span class="hljs-string">'ime_actions.make_bfs_uuid'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> Exeption, e: log.error(<span class="hljs-string"><span class="hljs-string">"Failed to generate uuid: {0}."</span></span>.format(str(e))) result = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>:</code> </pre><br>  Wir haben ein Dienstprogramm, das in C geschrieben ist. Wir f√ºhren es aus, es generiert eine zuf√§llige ID.  Es muss unter allen Teilnehmern des Clusters eindeutig sein. Wir m√ºssen dies einmal auf dem Master tun und es dann auf die Maschinen verteilen.  Wir haben daf√ºr cache.mine verwendet.  Wie sich herausstellte, wird kein Neustart durchgef√ºhrt. <br><br><img src="https://habrastorage.org/webt/g1/n6/bo/g1n6boipselezqysof41glvfa5s.jpeg"><br><br>  "Rennzustand."  Die Parallelisierung ist gut, aber in der Grundkonfiguration wird state.orchestrate in state.sls ausgef√ºhrt, wenn lange Prozesse auftreten.  Bis zum Timeout glaubt er, dass der Staat bereits abgeschlossen ist, obwohl er noch l√§uft, und versucht, den n√§chsten zu starten.  Ein Fehler tritt auf.  Und dieses Problem wurde noch nicht behoben. <br><br><img src="https://habrastorage.org/webt/uq/s5/wb/uqs5wbeqhfc8o22yr9mwck3fcbg.jpeg"><br>  Sie k√∂nnen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sich GitHub ansehen</a> . <br><br>  Was k√∂nnten wir au√üer SaltStack verwenden? <br><br><h3>  SaltStack in einer DMZ-Umgebung </h3><br><img src="https://habrastorage.org/webt/ze/k6/me/zek6meak3aivzorfh7rsgf4e9na.jpeg"><br><br><ul><li>  DMZ  Chefkoch packt gro√üartig, Puppet auch.  Und bei Ansible besteht das Problem darin, dass es - wenn kein Tower vorhanden ist - keine M√∂glichkeit gibt, die Konfiguration im Pull-Modus von unseren Knoten aus zu starten, was in der entmilitarisierten Zone erfolgen muss. <br></li><li>  Framework f√ºr CLI (in Python).  Chef und Puppet sind nicht sehr gut geeignet. Wenn Sie jedoch keine Einschr√§nkungen haben, nur Python zu verwenden, k√∂nnen Sie in Ruby schreiben und die Chef- oder Puppet-APIs verwenden.  Ansible Toolkit unterst√ºtzt dies nicht. <br></li><li>  Clusterverwaltung.  Chef eignet sich gut f√ºr die Verwaltung von Clustern, auch f√ºr Puppet, und Ansible wurde urspr√ºnglich f√ºr die Verwaltung von Clustern bei Amazon entwickelt. <br></li></ul><br><h3>  Koch in einer gro√üen und dynamischen Umgebung </h3><br>  Der Kunde hatte die Aufgabe, alle Ressourcen in einer Cloud zu konsolidieren - es war Openstack.  Davor war alles verstreut: etwas in der Rackspace Cloud, etwas auf dedizierten Servern oder deren privaten Rechenzentren. <br><br>  Sie wollten ein vollst√§ndig dynamisches Ressourcenmanagement und auch, damit ihre Anwendungen sich bei Bedarf selbst Kapazit√§t hinzuf√ºgen k√∂nnen.  Das hei√üt, wir brauchen eine vollst√§ndige dynamische Infrastruktur und eine vollst√§ndig dynamische Umgebung auf und ab. <br><br>  Um den CD-Prozess ordnungsgem√§√ü zu erstellen, ben√∂tigen Sie eine vollautomatisierte Umgebung.  Wir haben f√ºr sie SDLC - Software Development Lifecycle erstellt und angewendet, auch f√ºr SCM.  Sie bestehen Integrationstests nicht nur f√ºr Anwendungen, sondern auch f√ºr die Infrastruktur. <br><br>  Dementsprechend sollten wir, wie die Leute von Netflix, in der Lage sein, defekte Ressourcen zu t√∂ten und frische und garantierte Arbeiter an ihren Platz zur√ºckzubringen, wenn etwas mit uns schief geht. <br><br>  Auf welche Probleme sind wir gesto√üen: <br><br><ol><li>  Es war 2013, Chef 10 verwendet, in dem eine langsame Suche.  Wir begannen mit der Suche, gingen um alle Autos herum und es dauerte ewig.  Wir haben versucht, das Problem mit der Namenskonvention sowie der Auswahl und Suche nach fqdn zu l√∂sen.  Dies verengte den Umfang der Suche, wodurch sie beschleunigt wurde. <br><br>  Einige Operationen m√ºssen jedoch f√ºr die gesamte Umgebung durchgef√ºhrt werden.  Dementsprechend wurde die Suche zu Beginn einmal ausgef√ºhrt, das Ergebnis im Attribut gespeichert und mit Ruby die Ergebnisse gefiltert: Wir haben die ben√∂tigten Teile analysiert und das getan, was ben√∂tigt wurde. <br><br><pre> <code class="ruby hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !Chef::Config[<span class="hljs-symbol"><span class="hljs-symbol">:solo</span></span>] search(<span class="hljs-symbol"><span class="hljs-symbol">:node</span></span>, <span class="hljs-string"><span class="hljs-string">"fqdn:*metro-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{node[</span></span><span class="hljs-symbol"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-symbol">:env</span></span></span></span><span class="hljs-string"><span class="hljs-subst">]}</span></span></span><span class="hljs-string">-mongodb*"</span></span>).each <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|mongo|</span></span> @mongodbs &lt;&lt; mongo.fqdn <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> @mongodbs = [<span class="hljs-string"><span class="hljs-string">"lvs-metro-</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">#{node[</span></span><span class="hljs-symbol"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-symbol">:env</span></span></span></span><span class="hljs-string"><span class="hljs-subst">]}</span></span></span><span class="hljs-string">-mongodb3001.qa.example.com"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre><br>  Fazit: Verwenden Sie Namenskonventionen, f√ºhren Sie die Suche einmal aus und filtern Sie die gew√ºnschten Ergebnisse mit Ruby. <br></li><li>  Die Verwendung von "node.save" ist unsicher. Seien Sie vorsichtig und vorsichtig.  Dieses Problem trat beim Bereitstellen von MySQL-Clustern auf und verwendete node.save innerhalb des Rezepts auf einem unvollst√§ndig konfigurierten MySQL-Knoten.  Zum Zeitpunkt des Scale-up gaben einige Anwendungen einen Fehler von 500 an.  Es stellte sich heraus, dass wir den Knoten zur falschen Zeit gespeichert haben: Er geht zum Chef-Server, genau dort nimmt der Chef-Client auf der Benutzeroberfl√§che einen neuen Knoten auf, der nicht vor dem Betriebsmodus konfiguriert wurde. <br></li><li>  Das Fehlen von "Spreizung" kann den Server des K√ºchenchefs t√∂ten.  Splay ist ein Chef-Client-Parameter, mit dem Sie den Bereich festlegen k√∂nnen, wenn der Client zur Konfiguration zum Server wechselt.  Wenn Sie bei hoher Last viele Knoten gleichzeitig bereitstellen m√ºssen, wird der Server nicht zerst√∂rt. <br></li></ol><br>  Was k√∂nnen wir anstelle des K√ºchenchefs verwenden? <br><br><img src="https://habrastorage.org/webt/0w/xx/rm/0wxxrmdr90fpnyppzwoumgkbmai.jpeg"><br><br><ul><li>  Dynamische Bereitstellung  SaltStack ist perfekt, weil es SaltCloud hat, das sich √ºberall perfekt integrieren l√§sst.  Puppet hat √§hnliche Funktionen, ist jedoch nur in Puppet Enterprise f√ºr Geld erh√§ltlich.  Ansible ist gut geeignet, wenn das Unternehmen in Amazon "lebt", wenn etwas anderes - Sie k√∂nnen es in Alternativen einbinden, aber es ist nicht so bequem. <br></li><li>  SDLC.  Chefkoch hat alles von Test Kitchen bis zur Auswahl von Tools f√ºr Integrationstests.  SaltStack verf√ºgt √ºber alle Python-Tools, jetzt hat Puppet alles.  Ansible hat eine Rollenspezifikation. Sie k√∂nnen Chef's Test Kitchen verwenden, aber es ist kein natives Tool. <br></li><li>  Ressourcenersatz.  In Chef ist alles in Ordnung, in SaltStack k√∂nnen Sie SaltCloud bis zum gew√ºnschten Status beenden, in Puppet-Tools nur in der Enterprise-Version und Ansible funktioniert nur mit Amazon. <br></li></ul><br><h3>  EPAM Private Cloud mit K√ºchenchef </h3><br>  Eineinhalb Jahre vor dem Aufkommen von AWS OpsWorks wollten wir durch die Integration von Chef eine erweiterte Amazon CloudFormation erstellen, damit Ressourcen nicht nur bereitgestellt, sondern auch konfiguriert werden. <br><br>  Die zweite globale Aufgabe besteht darin, einen Servicekatalog zu erstellen, damit Kunden und Benutzer die CLI verwenden k√∂nnen, um beispielsweise einen vollst√§ndig gebrauchsfertigen LAMP-Stack bereitzustellen. <br><br><img src="https://habrastorage.org/webt/a4/cy/f6/a4cyf6ep8anoudzr6ydh7as2yrg.jpeg"><br><br>  Wir haben uns f√ºr Chef entschieden, aber das Projekt musste verschiedene SCMs unterst√ºtzen.  Wir haben mit dem eingebauten Chef-Server begonnen, und Benutzer k√∂nnen auch ihren eigenen Chef-Server verwenden, der irgendwo bei ihnen gehostet wird.  Das hei√üt, wir haben keinen Zugriff auf Benutzerressourcen und Laptops erhalten, aber es hat trotzdem funktioniert. <br><br><img src="https://habrastorage.org/webt/xf/vh/py/xfvhpysd5j89seh3qgrei3o5ryi.jpeg"><br><br>  Mit jedem SCM kann CloudFormation + OpsWork implementiert werden. Jeder ist geeignet.  So erstellen Sie einen Katalog: Alle au√üer SaltStack tun dies gut.  SaltStack hat seine Nuancen: Es ist √§u√üerst schwierig, einen Spezialisten zu finden, der SaltStack gut kennt und einen Service erstellen und den Katalog f√ºllen kann. <br><br><h3>  Die Popularit√§t von SCM in EPAM </h3><br><img src="https://habrastorage.org/webt/d3/o1/z2/d3o1z2giceihh4izcy4r6zlnkpq.jpeg"><br><br>  Dies sind Statistiken zur SCM-Popularit√§t innerhalb von EPAM.  SaltStack liegt sehr weit zur√ºck.  Erstens ist Ansible das einfachste und mit einer niedrigen Eintrittsschwelle.  Wenn wir versuchen, jemanden auf dem Markt mit SCM-Kenntnissen zu finden, sieht der Markt ungef√§hr gleich aus. <br><br><h3>  Arbeite mit Ansible </h3><br>  Tipps, die ich bei der Arbeit mit Ansible geben kann: <br><ol><li>  Verwenden Sie 'Beschleunigen', um Konfigurationen 2-6 mal schneller als SSH (f√ºr el6) bereitzustellen.  F√ºr alle anderen gibt es "Pipelining".  Es ist aus Gr√ºnden der Abw√§rtskompatibilit√§t ausgeschaltet, aber das Wiedereinschalten des Pipelining ist sehr einfach. Ich empfehle es. <br></li><li>  Verwenden Sie 'with_items' <br><br><pre> <code class="hljs powershell">- name: project apt dependencies installed apt: name: <span class="hljs-string"><span class="hljs-string">"{{ item }}"</span></span> become: yes with_items: - build<span class="hljs-literal"><span class="hljs-literal">-essential</span></span> - acl - git - curl - gnupg2 - libpcre3<span class="hljs-literal"><span class="hljs-literal">-dev</span></span> - python<span class="hljs-literal"><span class="hljs-literal">-apt</span></span> - python<span class="hljs-literal"><span class="hljs-literal">-pycurl</span></span> - python<span class="hljs-literal"><span class="hljs-literal">-boto</span></span> - imagemagick - libmysqlclient<span class="hljs-literal"><span class="hljs-literal">-dev</span></span> <span class="hljs-comment"><span class="hljs-comment"># needed for data import</span></span></code> </pre><br>  In diesem Beispiel installieren wir Pakete. Mit diesem Schema k√∂nnen Benutzer und √§hnliche Vorg√§nge erstellt werden. <br></li><li>  Verwenden Sie vorsichtig 'local_action' und 'delegated'.  Mit dem ersten k√∂nnen Sie etwas √Ñhnliches wie mit dem SaltStack Runner erhalten, mit dem zweiten k√∂nnen Sie Aufgaben an bestimmte Computer delegieren. <br><br><pre> <code class="hljs sql">- name: <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> postgresql <span class="hljs-keyword"><span class="hljs-keyword">database</span></span> postgresql_db: <span class="hljs-keyword"><span class="hljs-keyword">name</span></span>: <span class="hljs-string"><span class="hljs-string">"{{ database_name }}"</span></span> login_host: <span class="hljs-string"><span class="hljs-string">"{{ database_host }}"</span></span> login_user: <span class="hljs-string"><span class="hljs-string">"{{ database_master_user }}"</span></span> login_password: <span class="hljs-string"><span class="hljs-string">"{{ database_master_password }}"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">encoding</span></span>: <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span> lc_collate: <span class="hljs-string"><span class="hljs-string">"en_US.UTF-8"</span></span> lc_ctype: <span class="hljs-string"><span class="hljs-string">"en_US.UTF-8"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>: <span class="hljs-string"><span class="hljs-string">"template0"</span></span> state: <span class="hljs-keyword"><span class="hljs-keyword">present</span></span> delegate_to: <span class="hljs-string"><span class="hljs-string">"{{ groups.pg_servers|random}}"</span></span></code> </pre><br>  Dies ist ein Teil der Datenbankerstellung.  Ohne die letzte Zeile w√ºrde die Operation mehrmals ausgef√ºhrt und fiel beim zweiten Versuch, dieselbe Datenbank zu erstellen. <br></li><li>  Optimieren Sie Ihre Rollen und Leistung mit Tags.  Dies kann die Vorlaufzeit erheblich verk√ºrzen. <br></li></ol><br><h3>  Schlussfolgerungen </h3><br>  Ansible ist f√ºr mich ein Favorit.  SaltStack ist sehr gut, sehr flexibel, erfordert jedoch Python-Kenntnisse. Ohne sie ist SaltStack besser nicht zu verwenden.  Chefkoch ist eine universelle Silberkugel f√ºr jede Aufgabe und jeden Ma√üstab, erfordert jedoch mehr Wissen als Ansible.  Und wer Puppet benutzt - wei√ü ich nicht.  Im Prinzip ist es dem Chef sehr √§hnlich, aber mit seinen eigenen Nuancen. <br><blockquote>  Minute der Werbung.  Wenn Ihnen dieser Bericht von der <b>DevOops-</b> Konferenz <b>gefallen hat</b> , beachten Sie, dass am 14. Oktober die neuen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DevOops 2018</a> in St. Petersburg stattfinden werden. Das Programm enth√§lt viele interessante Dinge.  Die Seite hat bereits die ersten Redner und Berichte. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de416763/">https://habr.com/ru/post/de416763/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de416753/index.html">Beliebtes Hola VPN Plugin kompromittiert</a></li>
<li><a href="../de416755/index.html">Extreme Likes - Untersuchungsausschuss gegen</a></li>
<li><a href="../de416757/index.html">Flockige Tests</a></li>
<li><a href="../de416759/index.html">Warum k√ºnstliche Intelligenz nicht alle Probleme l√∂st</a></li>
<li><a href="../de416761/index.html">Kosmische Sprache, Teil 1: Ist universelle Grammatik universell?</a></li>
<li><a href="../de416765/index.html">Foliplast-Unternehmen: Ein vollst√§ndiger Zyklus der digitalen Produktion in Russland</a></li>
<li><a href="../de416767/index.html">Ein Deuce f√ºr Sie oder ein Audit mit Hacking</a></li>
<li><a href="../de416775/index.html">Noch ein Papercraft</a></li>
<li><a href="../de416777/index.html">Das Funktionsprinzip des Faltungsnetzwerks. Fast kompliziert</a></li>
<li><a href="../de416781/index.html">Wer wird die Relativit√§tstheorie retten?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>