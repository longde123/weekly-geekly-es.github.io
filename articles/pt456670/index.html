<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¥üèΩ üë©‚Äçüî¨ üìí Sobre o m√©todo de autentica√ß√£o muito espi√£o üë©üèº‚Äç‚úàÔ∏è üíà üêº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ent√£o, enviamos agentes super secretos Alice e Bob para um pa√≠s inimigo disfar√ßado. Durante a miss√£o, eles ter√£o que entrar em contato e trabalhar jun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sobre o m√©todo de autentica√ß√£o muito espi√£o</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456670/"><p> Ent√£o, enviamos agentes super secretos Alice e Bob para um pa√≠s inimigo disfar√ßado.  Durante a miss√£o, eles ter√£o que entrar em contato e trabalhar juntos, trocar informa√ß√µes, assuntos comuns de espionagem.  Obviamente, tudo isso deve ser feito em conformidade com todas as regras e procedimentos de seguran√ßa poss√≠veis. </p><br><p>  De fato, no √∫ltimo turno, queremos revel√°-los: tanto a pr√≥pria miss√£o quanto os pr√≥prios agentes e toda a seguran√ßa nacional est√£o em risco.  Portanto, √© do nosso interesse fornecer aos espi√µes as informa√ß√µes m√≠nimas necess√°rias.  Em particular, quanto menos eles se conhecerem e sobre t√©cnicas de comunica√ß√£o, melhor. </p><br><p>  Mas como eles identificar√£o o camarada da sede? </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ceb/454/721/ceb4547217be4972a9e5f8fe323cf257.gif" alt="KDPV"></p><br><p>  TL; DR - inventando um mecanismo de autentica√ß√£o de usu√°rio usando esteganografia para uma ag√™ncia imagin√°ria de tr√™s caracteres de um pa√≠s inexistente. </p><a name="habracut"></a><br><h2 id="o-volkah-i-ovechih-shkurah">  Sobre lobos e peles de ovelhas </h2><br><p>  Uma capa √© uma capa, ent√£o nem Alice nem Bob devem levantar suspeitas por nenhuma de suas a√ß√µes.  O planejamento adequado implica paran√≥ia sobre o monitoramento constante deles em todos os n√≠veis poss√≠veis.  Esta publica√ß√£o n√£o abordar√° a tarefa de troca direta de informa√ß√µes (ela merece uma s√©rie separada), mas apenas uma maneira de garantir que ela seja transmitida por quem precisa e para quem precisa. </p><br><p>  Muito provavelmente, ambos os espi√µes ter√£o uma hist√≥ria no formato de cidad√£os comuns, al√©m disso, de forma alguma conectados um ao outro.  Portanto, voc√™ precisa vetar imediatamente o uso de ferramentas criptogr√°ficas cl√°ssicas e canais seguros - cada agente de contraintelig√™ncia sabe que pessoas honestas que n√£o t√™m um relacionamento pr√≥ximo n√£o t√™m nada a esconder. </p><br><h2 id="chto-delat">  O que fazer </h2><br><p>  Obviamente, essa tarefa n√£o √© nova, existia felizmente e foi resolvida muito antes do advento desses na Internet.  E n√£o apenas foi decidido, como algumas decis√µes foram fortalecidas na cultura e ainda s√£o encontradas em livros, filmes e jogos. </p><br><p>  Vejamos exatamente essa cena: duas pessoas em casacos longos convergem para um local p√∫blico e trocam frases muito estranhas.  Se a frase e a resposta iniciais estiverem corretas, a autentica√ß√£o foi bem-sucedida e as pessoas trocam pastas marcadas com "Top Secret" e divergem em dire√ß√µes desconhecidas. </p><br><p>  A desvantagem de tal esquema √© imediatamente √≥bvia - as frases devem ser mantidas em segredo e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">muitas vezes alteradas</a> , o que n√£o √© muito simples no territ√≥rio inimigo.  Ao mesmo tempo, para n√£o serem falados aleatoriamente e n√£o levarem ao caso do KDPV, eles se tornam bastante proeminentes e aleat√≥rios, o que significa que podem distribuir agentes que os pronunciam. </p><br><p><img src="https://habrastorage.org/webt/pl/pe/sh/plpeshe7ifcmijrxlaziosekgey.png"></p><br><p>  N√≥s, na era da tecnologia digital, n√£o gostamos desse m√©todo.  Especialmente se voc√™ se lembrar de que quase todos os canais de comunica√ß√£o s√£o controlados por algu√©m e aproveitados por motivos bons e ruins.  E n√£o importa o que eles nos assegurem, a vida das pessoas n√£o deve ser confi√°vel na pol√≠tica de privacidade de qualquer Facebook. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/984/c5d/c5d/984c5dc5dae5cba450b58907693ceed6.png"></p><br><h2 id="steganografiya-opyat">  Esteganografia (de novo?) </h2><br><p>  Hedgehog, √© claro que a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">capacidade de se esconder</a> em tal situa√ß√£o parece mais atraente do que nunca.  De fato, mesmo o m√©todo descrito √© sua subesp√©cie - as frases de c√≥digo podem ser consideradas como cont√™ineres com apenas um bit de informa√ß√£o. </p><br><p>  O mesmo mam√≠fero do desapego dos inset√≠voros entende que n√£o se trata simplesmente de atirar cont√™ineres uns aos outros.  Essa troca causar√° quase mais suspeitas do que alguma criptografia PGP comum, por isso n√£o estamos interessados. </p><br><h3 id="a-o-chem-togda">  E ent√£o? </h3><br><p>  Diferentemente dos criptogramas, os cont√™ineres t√™m uma vantagem √≥bvia - o contexto do aplicativo.  Qualquer texto, imagem, arquivo de √°udio etc., al√©m do conte√∫do √≥bvio, tamb√©m traz a possibilidade de sua discuss√£o <strong>natural</strong> e pode ser enviado n√£o apenas da ba√≠a, mas no processo de um di√°logo que n√£o causa suspeitas. </p><br><p>  Munidos dessas id√©ias, j√° podemos elaborar um protocolo simples de autentica√ß√£o esteganogr√°fica com base em uma chave comum: </p><br><ul><li>  A -&gt; B: uma mensagem bonita solicitando um cont√™iner esteganogr√°fico de certos par√¢metros; </li><li>  B: seleciona o cont√™iner <em>C</em> que corresponde ao contexto e aos par√¢metros solicitados; </li><li>  B: similarmente cria uma mensagem <em>M</em> ; </li><li>  B -&gt; A: <em>C '= Incorporado (C, M, K)</em> ; </li><li>  A: Verifica <em>C '</em> quanto √† conformidade com os par√¢metros definidos; </li><li>  A -&gt; B: <em>M '= Extrato (C', K)</em> ; </li><li>  B: Verifica se <em>M</em> e <em>M '</em> correspondem. </li></ul><br><p>  Esse protocolo tem desvantagens √≥bvias - Alice e Bob devem ter uma chave comum e fun√ß√µes de incorpora√ß√£o e extra√ß√£o.  Seu comprometimento pode levar √† possibilidade de uma an√°lise detalhada do m√©todo de autentica√ß√£o do inimigo e colocar em risco outros usu√°rios e a sede.  Algo precisa ser consertado. </p><br><h2 id="ispolnitel-ne-cherepashka">  O artista n√£o √© um bug </h2><br><p>  Se o leitor foi para a escola ap√≥s o advento das aulas de inform√°tica, ele deveria se lembrar de aprender o b√°sico da algoritmo usando o artista de uma tartaruga, formiga e coisas do g√™nero.  Sua id√©ia era demonstrar as possibilidades de otimizar um grande n√∫mero de a√ß√µes √∫nicas manuais, criando programas simples.  Para resolver nosso problema, precisamos seguir na dire√ß√£o oposta. </p><br><p><img src="https://habrastorage.org/webt/nc/lo/lo/nclolotljunb2zzbkgr2-4qo0ri.png" alt="Bem, n√£o √© fofo?"></p><br><p>  Como podemos simplificar a escrita do algoritmo final da sequ√™ncia de etapas at√© a descri√ß√£o processual de acordo com os par√¢metros fornecidos, podemos realizar o processo inverso.  Se voc√™ imaginar um cont√™iner como uma matriz de alguns de seus componentes, a incorpora√ß√£o de uma mensagem por chave pode ser escrita como uma sequ√™ncia ordenada de opera√ß√µes nos elementos do cont√™iner em √≠ndices espec√≠ficos com v√°rios par√¢metros constantes. </p><br><p>  √â a√≠ que a n√£o-matem√°tica come√ßa, ent√£o pe√ßo aos t√≠midos que simplesmente folheiem os par√°grafos de apar√™ncia dif√≠cil para a se√ß√£o de opera√ß√µes ou at√© um pouco mais.  Nada terr√≠vel vai acontecer, eu prometo. </p><br><p>  Para incorporar os dados, precisamos de uma sequ√™ncia do formul√°rio: <em>(f1, S1, i, D1), (f2, S2, j, D2) ...</em> , onde: </p><br><ul><li>  <em>Di</em> - alguma parte dos dados incorporados; </li><li>  <em>i, j</em> s√£o os √≠ndices dos elementos do cont√™iner; </li><li>  <em>fi: (Estado, Elemento, D) -&gt; (Estado, Elemento)</em> - fun√ß√£o incorporada; </li><li>  <em>Si</em> √© um certo estado, o contexto da opera√ß√£o, <em>(El ', S [i + 1]) = fi (Si, El, Di)</em> . </li></ul><br><p>  Para extra√≠-lo, voc√™ n√£o precisa armazenar partes dos dados (K.O.), portanto, existem triplos suficientes: <em>(g1, S1, I1), (g2, S2, I2) ...</em> com os mesmos valores, apenas <em>gi: (State, Element) -&gt; (Estado, D)</em> . </p><br><p>  Tudo isso pode ser representado pelo diagrama sim√©trico abaixo.  Se, por algum motivo, n√£o consegui alcan√ßar clareza, n√£o √© assustador, basta ler. </p><br><p><img src="https://habrastorage.org/webt/l7/yk/pk/l7ykpkwfi8sfkcebwxryswzo1r0.png" alt="Bem ou n√£o mais"></p><br><p>  Pode-se observar que a fun√ß√£o de incorpora√ß√£o possui um maior n√∫mero de graus de liberdade.  Ao contr√°rio de sua irm√£, ela modifica o cont√™iner, enquanto faz isso com base em dois elementos independentes - dados incorporados e o elemento.  Obrigado, ou, mais precisamente, por isso, s√£o poss√≠veis duas abordagens globais para a implementa√ß√£o do algoritmo de esteganografia por esse sistema: </p><br><ol><li>  Escolha os √≠ndices mais apropriados dos elementos a serem alterados de acordo com a fun√ß√£o de incorpora√ß√£o (menos percept√≠vel ou que n√£o exija nada) e transfira a sequ√™ncia formada ligada a um cont√™iner espec√≠fico.  Com essa abordagem, eles precisam ser isolados um do outro antes que seja necess√°rio incorporar usando m√©todos cl√°ssicos, como criptografia e outras m√≠dias seguras; </li><li>  Encontre um m√©todo para dividir o cont√™iner em elementos e a fun√ß√£o de incorpora√ß√£o que qualquer altera√ß√£o esperada ser√° igualmente invis√≠vel.  Nesse caso, a sequ√™ncia √© independente do cont√™iner e pode ser criada mesmo por um gerador completamente aleat√≥rio.  Menos flexibilidade e falta de controle do pior caso poss√≠vel.  Por outro lado, essa abordagem √© mais simples e mais conveniente quando aplicada em campo, portanto, a seguir, a utilizarei. </li></ol><br><p>  Se o estado n√£o for necess√°rio para o algoritmo, todas as op√ß√µes acima permanecer√£o v√°lidas, simplesmente sem uma √∫nica letra e bloco no diagrama.  Sem ele, √© ainda mais f√°cil, na verdade. </p><br><h2 id="i-zachem-ono-nam">  E por que precisamos disso? </h2><br><p>  Agora, se voc√™ souber com anteced√™ncia quais cont√™ineres com quais mensagens e chaves ser√£o usadas, em vez de divulgar completamente as partes do algoritmo, poder√° gerar e fornecer agentes para usar apenas sequ√™ncias semelhantes e um int√©rprete para elas.  Bem, ok, n√£o apenas dando, √© claro, mas mais sobre isso mais tarde. </p><br><h3 id="dobavlyaem-asimmetrichnost">  Adicionar assimetria </h3><br><p>  Mesmo um artista de tartaruga pode desenhar um quadrado de centenas de maneiras diferentes, simplesmente mudando a ordem das opera√ß√µes e adicionando novas.  Isso significa que ningu√©m nos incomoda e faz o mesmo com as seq√º√™ncias descritas para dados de entrada fixos. </p><br><p>  Ou seja, podemos pegar a sequ√™ncia de incorpora√ß√£o, adicionar novas opera√ß√µes, misturar tudo e, para que o resultado permane√ßa o mesmo.  A menos que, na presen√ßa de um estado, seja necess√°rio rastre√°-lo e adicionar separadamente as altera√ß√µes necess√°rias √† sequ√™ncia.  √â por isso que sem √© mais f√°cil, sim. </p><br><p>  De um jeito ou de outro, depois de t√£o amassado e barulhento, at√© o pr√≥prio incorporador n√£o ser√° mais capaz de entender o que ele est√° realmente incorporando: qualquer sequ√™ncia de <em>N</em> opera√ß√µes representar√° <em>N!</em>  mensagens potencialmente incorporadas - uma para cada permuta√ß√£o das partes incorporadas.  Ao mesmo tempo, o pr√≥prio <em>N</em> √© uma grande quest√£o.  Portanto, pode-se abrir essas seq√º√™ncias - elas n√£o fornecem nenhuma informa√ß√£o sobre a mensagem incorporada, nem sobre o algoritmo e a chave usados. </p><br><p>  Ao extrair informa√ß√µes, √© muito importante para n√≥s, tanto a ordem (restaurar a mesma mensagem correta quanto poss√≠vel) e o n√∫mero de partes a serem extra√≠das, para que as seq√º√™ncias de extra√ß√£o permane√ßam inalteradas desde o momento do nascimento.  Como eles cont√™m implicitamente informa√ß√µes sobre a chave, gerador e algoritmo usado, eles, como os animais do livro vermelho, precisam ser armazenados e protegidos.  E mantenha isso em segredo. </p><br><p>  O que a assimetria tem a ver com isso?  O fato √© que agora cada sequ√™ncia de extra√ß√£o est√° associada a um n√∫mero infinito de incorporadores.  E restaurar um do outro √©, no caso geral, uma tarefa insol√∫vel. </p><br><h3 id="ekspluatiruem">  Estamos operando </h3><br><p>  Esquecemos qualquer matem√°tica pr√≥xima e retornamos √† tarefa original - como podemos enviar Alice e Bob para o territ√≥rio inimigo, a fim de: </p><br><ul><li>  eles n√£o se conheciam </li><li>  n√£o tinha algoritmos secretos na m√£o </li><li>  mas voc√™ pode verificar um ao outro enquanto se comunica em um canal aberto? </li></ul><br><p>  Bem, com o primeiro par√°grafo, tudo fica claro, apenas n√£o fornecemos informa√ß√µes expl√≠citas uma sobre a outra, nem chaves compartilhadas.  Para o segundo, voc√™ precisa se lembrar da descri√ß√£o do protocolo acima.  Agora podemos excluir diretamente os algoritmos <em>Incorporar</em> e <em>Extrair</em> que representam potenciais segredos de estado e tudo mais.  E, levando isso em considera√ß√£o, no terceiro √© poss√≠vel elaborar o seguinte protocolo de duas etapas. </p><br><p>  Gera√ß√£o de informa√ß√µes de autentica√ß√£o <strong>antes do in√≠cio da miss√£o</strong> com sede como parte confi√°vel de Trent: </p><br><ul><li>  T: seleciona o algoritmo secreto e a chave secreta K, cria com a ajuda deles: <br><ul><li>  Sequ√™ncia de extra√ß√£o <em>Ex</em> ; </li><li>  adequado para autentica√ß√£o (abaixo) do contexto <em>Ctx</em> ; </li></ul></li><li>  T -&gt; A: <em>Ctx, Ex</em> ; </li><li>  T: usando <em>Ex</em> e o contexto criado, gera: <br><ul><li>  mensagem <em>M</em> n√£o usada anteriormente para os agentes selecionados dentre as partes <em>| Ex |</em>  ; </li><li>  uma sequ√™ncia √∫nica de <em>Em</em> , abrindo-a como descrito acima; </li></ul></li><li>  T -&gt; B: <em>Em, h (M)</em> , se desejado, cria conjuntos adicionais. </li></ul><br><p>  Assim, Alice tem apenas uma sequ√™ncia para todas as ocasi√µes e o contexto de contato futuro, e Bob se torna o feliz propriet√°rio de um conjunto de sequ√™ncias √∫nicas e hashes de mensagens que eles incorporam. </p><br><p>  O protocolo de autentica√ß√£o j√° <strong>durante a miss√£o</strong> √© assim: </p><br><ul><li>  A -&gt; B: uma mensagem <em>IM inicial com</em> base no contexto <em>Ctx</em> com uma descri√ß√£o do cont√™iner; </li><li>  B: seleciona o <em>C ~ IM</em> apropriado; </li><li>  B -&gt; A: <em>C '= Em (C)</em> ; </li><li>  A: verifica a conformidade com <em>C '~ IM</em> (como as altera√ß√µes s√£o invis√≠veis, elas devem ser salvas); </li><li>  A -&gt; B: <em>M '= Ex (C')</em> , marca M 'como usado; </li><li>  B: verifica, <em>h (M ') == h (M)</em> , destr√≥i <em>Em, h (M)</em> . </li></ul><br><p>  Um leitor atento perceber√° que, antes do protocolo, Alice e Bob t√™m apenas um conjunto de informa√ß√µes, o que por si s√≥ n√£o significa nada para eles, nem para um advers√°rio em potencial, e apenas durante o "brincar com as cores". </p><br><p>  Cada conjunto aberto de Bob √© usado apenas uma vez, que √© controlado pelo pen√∫ltimo passo de Alice.  Ao encontrar um <em>M</em> usado anteriormente (e, portanto, <em>Em</em> invis√≠vel <em>por</em> ela) por outra pessoa, ela percebe que um de seus "associados" √© falso. </p><br><p>  O uso repetido pela mesma pessoa diz a ela que ela n√£o est√° ciente dos meandros do protocolo e certamente n√£o √© a pessoa com quem ela teve que fazer contato.  Bem, antes tarde do que nunca. </p><br><p><img src="https://habrastorage.org/webt/bv/6v/0h/bv6v0hcim8kmzndrvn5__thsp1y.png"></p><br><p>  Ok, √© assim que tudo parece muito complicado e incompreens√≠vel.  Algu√©m chegou aqui? </p><br><p>  Vamos demonstr√°-lo melhor na pr√°tica, porque at√© os pr√≥prios espi√µes n√£o precisam conhecer os detalhes do protocolo para uso, muito menos os leitores pobres.  Apenas a princ√≠pio um pouco sobre como tudo foi implementado. </p><br><h2 id="vysokie-tehnologii">  Alta tecnologia </h2><br><p>  Portanto, resta apenas escrever tudo o que √© necess√°rio para o protocolo.  Bem, voc√™ n√£o faz tudo com as m√£os (embora possa).  E hoje a v√≠tima do meu c√≥digo estar√° ... <em>girando a roda da fortuna</em> ... Java?  Bem, tudo bem, ao mesmo tempo em que tudo estiver na STL, voc√™ n√£o precisar√° procurar nada. </p><br><p>  Vamos come√ßar com a API necess√°ria.  Para funcionar, voc√™ s√≥ precisa determinar a classe da matriz de elementos de cont√™iner com a capacidade de receber e alterar elementos por √≠ndice: </p><br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyContainer</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StegoContainer</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyElement</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MyElement </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  i-  } public void set(int i, MyElement v) { //  i-  } public int size() { //    } }</span></span></code> </pre> <br><p>  O uso adicional √© reduzido √† cria√ß√£o de um inv√≥lucro de um aut√¥mato esteganogr√°fico sobre o cont√™iner necess√°rio e ao fornecimento das fun√ß√µes de incorpora√ß√£o e extra√ß√£o de sua entrada: </p><br><pre> <code class="java hljs">StegoMachine&lt;MyState, MyElement&gt; myMachine = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StegoMachine( initialState, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyContainer&lt;MyElement&gt;(<span class="hljs-comment"><span class="hljs-comment">/*   */</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> StegoEmbed myEmbed = (st, el, dp) -&gt; { <span class="hljs-comment"><span class="hljs-comment">//    dp   el   st }; final StegoExtract myExtract = (st, el) -&gt; { //     el   st return dp; }; //    MyDataPart part = /*    */; myMachine.exec(1337, myEmbed, part); //... //    /,   //      State currState = myMachine.getState(); //... //    part = myMachine.exec(80085, myExtract); //... //        MyContainer container = (MyContainer) myMachine.getContainer();</span></span></code> </pre> <br><p>  Classes com o sufixo Stateless s√£o usadas da mesma maneira, se a implementa√ß√£o do algoritmo n√£o exigir a manuten√ß√£o do estado interno. </p><br><p>  Os geradores de sequ√™ncia podem funcionar como voc√™ gosta e n√£o possui uma API comum.  No caso geral, qualquer coisa pode fazer parte dos dados em geral, de bits isolados a arte rupestre em uma codifica√ß√£o separada. </p><br><h3 id="primer-realizacii">  Exemplo de implementa√ß√£o </h3><br><h4 id="o-metode">  Sobre o m√©todo </h4><br><p>  Como exemplo de implementa√ß√£o, usando as interfaces criadas, implementei um algoritmo simples da fam√≠lia LSB para imagens de bitmap com compacta√ß√£o sem perdas.  Seus elementos s√£o pixels que n√£o t√™m vizinhos no bit menos significativo de todos os componentes RGB.  A fun√ß√£o incorporar trabalha com bits √∫nicos dos dados de origem e simplesmente altera o bit de ordem inferior do valor de um dos componentes (para o qual o √≠ndice apontar√°). </p><br><p>  √â bastante simples, mas √© √≥timo para implementar o protocolo, j√° que alterar qualquer elemento √© igualmente impercept√≠vel de acordo com a escolha deles, portanto os √≠ndices dos elementos a serem alterados s√£o gerados usando um gerador aleat√≥rio.  No caso de Java, usando <em>SecureRandom</em> , mas se desejado, ele muda facilmente para sua fonte de entropia. </p><br><p>  <em>No entanto, este √© um m√©todo muito simples, n√£o recomendo us√°-lo para espi√µes de verdade.</em> </p><br><h4 id="o-heshah">  Sobre hashes </h4><br><p>  Como o texto tende a ficar distorcido, dependendo da identidade simulada do agente (alguns n√£o colocam letras mai√∫sculas, outros gostam de colocar emoticons etc., outros geralmente s√£o analfabetos), sugiro usar sha256 para calcular o hash, mas apenas com palavras impressas em letras min√∫sculas: </p><br><pre> <code class="plaintext hljs">h("Hello world?...") == h("hello, world!11")</code> </pre> <br><h4 id="ob-interfeyse">  Sobre a interface </h4><br><p>  O pacote de software consiste em duas partes - uma para gerar sequ√™ncias e outros hashes para o Trent, a outra para incorporar e verificar as mensagens recebidas quanto √† conformidade. </p><br><p>  O trabalho com ambos ocorre na linha de comando, atrav√©s de seus argumentos e fluxos de entrada e sa√≠da; nenhuma outra interface foi fornecida (medo e horror).  Ainda assim, ser aquele funcion√°rio da sede, que o espi√£o - significa ter algum tipo de qualifica√ß√£o.  Bem, se n√£o, ainda mostrarei um exemplo. </p><br><div class="spoiler">  <b class="spoiler_title">Aqui est√° uma ajuda</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/yx/1m/ge/yx1mge8ligshzbsv7hxi3olw__g.png" alt="Captura de tela de uso"></p><br></div></div><br><h3 id="chto-im-vsem-delat-to">  O que todos eles fazem? </h3><br><p>  Para come√ßar, Trent na sede precisa elaborar informa√ß√µes de autentica√ß√£o.  Em particular, pensar antecipadamente em uma situa√ß√£o na qual os agentes trabalhar√£o. </p><br><p>  Por exemplo, deixe Bob ser um freelancer de gr√°ficos e Alice, sua cliente.  A autentica√ß√£o ocorrer√° sob o disfarce de um pedido para criar gr√°ficos / design / outra coisa. </p><br><p>  Relatamos essas informa√ß√µes √∫teis para ambos e retornamos ao pr√≥prio protocolo.  Prepararemos uma mensagem incorporada no <em>M.txt</em> com <em>anteced√™ncia</em> , minimizando o n√∫mero de caracteres: "√© adequado para mim onde transferir dinheiro".  Gere <em>Em</em> e <em>Ex</em> usando o utilit√°rio para Trent: </p><br><pre> <code class="bash hljs">Trent@HQWorkstation:~$ java -jar HQUtil.jar -ex $(<span class="hljs-built_in"><span class="hljs-built_in">stat</span></span> -c%s <span class="hljs-string"><span class="hljs-string">"M.txt"</span></span>) 4096 &gt; Ex.txt Trent@HQWorkstation:~$ cat Ex.txt | java -jar HQUtil.jar -em <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$(cat M.txt)</span></span></span><span class="hljs-string">"</span></span> 0.25 4096 &gt; Em.txt Trent@HQWorkstation:~$ cat M.txt | java -jar HQUtil.jar -h &gt; hash.bin</code> </pre> <br><p>  Aqui <code>$(stat -c%s "M.txt")</code> retorna o tamanho da mensagem em bytes e 4096 - a restri√ß√£o no intervalo de √≠ndices gerados (para permitir o uso de cont√™ineres menores).  Da mesma forma, <code>$(cat M.txt)</code> usado para passar a pr√≥pria mensagem para o par√¢metro da linha de comandos.  Em princ√≠pio, voc√™ pode fazer sem o bash, usando seu pr√≥prio trabalho manual, mas para quem √© mais conveniente. </p><br><p>  <em>Ex.txt</em> √© passado para Alice, <em>Em.txt</em> e <em>hash.bin</em> para Bob.  Agora imagine que os agentes foram implantados com sucesso e desejam se comunicar - prosseguimos para a execu√ß√£o do protocolo.  Bob coloca seu curr√≠culo ou oferta de emprego em alguma troca e Alice come√ßa a se comunicar: </p><br><pre> <code class="plaintext hljs">: ,     %_% :        ,   .  ? : ,   </code> </pre> <br><p>  Bob procura a imagem de um guarda-chuva, talvez at√© desenhe ele mesmo se a alma √© criativa, comprime / imp√µe um pouco uma marca d'√°gua (ou o que os freelancers est√£o fazendo l√° agora) e faz: </p><br><pre> <code class="bash hljs">Bob@PC:~$ cat Em.txt | java -jar SpyUtil.jar -e umbrella.png</code> </pre> <br><p>  Depois de esperar um pouco, fingindo trabalhar, se na verdade ele n√£o fez isso, ele envia a Alice o cont√™iner recebido, naturalmente, tendo em mente o contexto: </p><br><pre> <code class="plaintext hljs">: ,  ,     </code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Transmite um guarda-chuva com uma mensagem, 670kb</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/qw/nk/in/qwnkinuhpppynf6ve9gkrmpnehm.png"></p></div></div><br><p>  Por sua vez, recupera a mensagem armazenada internamente: </p><br><pre> <code class="bash hljs">Alice@PC:~$ cat Ex.txt | java -jar SpyUtil.jar -e umbrella.png      </code> </pre> <br><p>  Transforma um conjunto de palavras em uma frase normal e envia para Bob: </p><br><pre> <code class="plaintext hljs">: ,  ,   ?</code> </pre><br><p>  Ele verifica a precis√£o da mensagem: </p><br><pre> <code class="java hljs">Bob<span class="hljs-meta"><span class="hljs-meta">@PC</span></span>:~$ java -jar SpyUtil.jar -c hash.bin <span class="hljs-string"><span class="hljs-string">",  ,   ?"</span></span> ,  ,   ? - Correct</code> </pre><br><p>  E continua a comunica√ß√£o f√°cil, se estiver tudo bem.  Todo o di√°logo por parte do observador √© mais ou menos assim: </p><br><div class="spoiler">  <b class="spoiler_title">500 kilobyte gif</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ff/ye/he/ffyeheonv4qo9dxdjygalg8kvtq.gif"></p></div></div><br><p>  √â claro que a contraintelig√™ncia n√£o encontrar√° nada suspeito em tudo isso interceptado.  De fato, mesmo os m√©todos de an√°lise stego neste caso nem sempre ser√£o aplicados - bem, algu√©m encomendou uma foto de um guarda-chuva por 5 d√≥lares, encontrou algo para surpreender a Internet.  Os recursos e pessoas de computa√ß√£o n√£o s√£o infinitos para verificar todas essas situa√ß√µes.  A autentica√ß√£o foi bem sucedida, a cortina. </p><br><p>  -&gt; <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt456670/">https://habr.com/ru/post/pt456670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt456658/index.html">Crescimento: como avaliamos as habilidades em uma equipe</a></li>
<li><a href="../pt456662/index.html">Como economizar dinheiro com um terapeuta usando desenvolvimento orientado a testes</a></li>
<li><a href="../pt456664/index.html">Quem processar quando um rob√¥ perde seu dinheiro</a></li>
<li><a href="../pt456666/index.html">WebTotem ou como queremos tornar a Internet mais segura</a></li>
<li><a href="../pt456668/index.html">Microsoft ML Spark: uma extens√£o Spark que torna o SparkML mais humano e o LightGBM como um b√¥nus</a></li>
<li><a href="../pt456672/index.html">Receitas Nginx: notifica√ß√µes ass√≠ncronas do PostgreSQL para o websocket</a></li>
<li><a href="../pt456674/index.html">Novas oportunidades de promo√ß√£o no Facebook que voc√™ n√£o conhecia</a></li>
<li><a href="../pt456676/index.html">Efetuando login em um aplicativo php distribu√≠do</a></li>
<li><a href="../pt456678/index.html">O estado eletr√¥nico do futuro. Parte 4</a></li>
<li><a href="../pt456680/index.html">Oito leis de nomenclatura no design de UX (parte 2)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>