<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèø üëµüèæ üë®üèæ‚Äçüî¨ Control LCD F-51543NFU-LW-ADN / PWB51543C-2-V0 (de la biblioteca de cintas) ü•ù üë©‚Äçüé® ‚òùüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola de nuevo, Habr! Tras traducir el art√≠culo sobre la administraci√≥n del m√≥dulo LCD con un controlador, pero sin mi propia RAM de video, decid√≠ trad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Control LCD F-51543NFU-LW-ADN / PWB51543C-2-V0 (de la biblioteca de cintas)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444912/"><img src="https://habrastorage.org/webt/yz/yf/la/yzyflade5gq71l7xiakjzym4utg.jpeg"><br><br>  Hola de nuevo, Habr!  Tras <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">traducir el</a> art√≠culo sobre la administraci√≥n del m√≥dulo LCD con un controlador, pero sin mi propia RAM de video, decid√≠ traducir otra publicaci√≥n sobre el mismo tema.  Aqu√≠ el m√≥dulo ya es m√°s simple, monocromo, pero para "revivir" no es menos interesante. <a name="habracut"></a><br><br><h1>  Control LCD con controlador, pero sin controlador </h1><br>  La pantalla con la que va a trabajar el autor se toma de una antigua biblioteca de cintas.  El controlador no sobrevivi√≥, pero una b√∫squeda de cualquier cosa relacionada con "263645-001" mostr√≥ que hab√≠a un FPGA.  Se cree que controla directamente dichos m√≥dulos LCD desde Arduino, etc.  imposible, necesita un enlace intermedio: el controlador de la serie SEDxxxxx, que no es "amigable" con la placa de pruebas y tiene m√°s entradas que el m√≥dulo en s√≠.  Pero esto no es as√≠.  Aqu√≠ hay cuatro proyectos similares: <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">En el ATmega8515</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">En ella</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">En la foto</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">En ESP32</a> <br><br>  Y algunos generalmente controlan monitores AVR VGA de ocho bits ... <br><br>  En general, el autor tuvo √©xito, el software bajo la licencia MIT est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><h1>  Imagen fija </h1><br>  Para asegurarse de que todo funciona, primero debe intentar generar una imagen r√°ster de un solo bit desde la memoria flash del microcontrolador.  Para obtener un voltaje negativo, tomamos tres "Crones", el voltaje del divisor, que se utiliz√≥ como resistencia de sintonizaci√≥n, se aplic√≥ al terminal V0.  Y aqu√≠ en la pantalla est√° Lenna: <br><br><img src="https://habrastorage.org/webt/yb/7-/fg/yb7-fgxw6yf64l_ylhqaccnhq-g.jpeg"><br><br>  El autor todav√≠a no puede entender c√≥mo logr√≥ voltear la imagen (mira de qu√© lado est√° el cable).  En cualquier caso, existe este ejemplo en la p√°gina del proyecto en GitHub. <br><br><h1>  Modo de texto </h1><br>  Pero la ROM de video es de poca utilidad, y no hay 9600 bytes para RAM de video en el Arduino.  El modo de texto viene al rescate, en el que la ROM del generador de caracteres y la RAM de video combinada son m√°s peque√±as que la RAM de video en el modo gr√°fico.  Los partidarios de la Rep√∫blica de Kazajst√°n y el "Especialista" pueden romper lanzas sin cesar sobre este tema. <br><br><img src="https://habrastorage.org/webt/yz/yf/la/yzyflade5gq71l7xiakjzym4utg.jpeg"><br><br>  Un breve ejemplo en lenguaje ensamblador AVR: <br><br><pre><code class="plaintext hljs">... lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ld r30, X+ swap r24; (CL2 rising edge) out %[data_port], r24 lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ...</code> </pre> <br><h1>  Hardware requerido </h1><br><img src="https://habrastorage.org/webt/85/p_/52/85p_52apzq0nmbzcnde9vaphrxy.jpeg"><br><br>  Para el m√≥dulo F-51543NFU-LW-ADN / PWB51543C-2-V0, el autor solicit√≥: <br><br>  Arduino en AVR con una frecuencia de reloj de 16 MHz (probado en Uno, Leonardo y un clon similar a ProMicro). <br><br>  Fuente de voltaje negativo.  Para el autor, este es un convertidor CC-CC no estabilizado A0524S-1W con aislamiento de entrada y salida.  Los convertidores para el MC34063 tambi√©n son adecuados (este chip es muy f√°cil de encontrar, solo desmonte la carga USB m√°s barata para un encendedor) o MAX749.  No se requiere estabilizaci√≥n, el rango de voltajes permitidos en esta entrada para el m√≥dulo utilizado aqu√≠ es bastante amplio.  El valor nominal es menos 24 V, el m√°ximo es menos 30 en relaci√≥n con el cable com√∫n y 35 entre Vdd y Vee.  El consumo de corriente es de 6 mA. <br><br>  Dos transistores MOS de canal N con control de nivel l√≥gico.  El autor us√≥ IRL530n, el stock, por supuesto, es grande, pero ciertamente no se agotar√°.  Un transistor controla la luz de fondo, el otro una fuente de voltaje negativo. <br><br>  Resistencia de corte de 250 kŒ© para suministrar voltaje a la entrada V0.  Ajuste de modo que -16.8 V a una temperatura de +25 ¬∞ C en el contacto m√≥vil.  Esto es de una hoja de datos, por lo que, por supuesto, dicha precisi√≥n no es necesaria. <br><br>  Varias resistencias de 10 kilo para tirar hacia abajo. <br><br>  Dise√±o y puentes. <br><br>  ¬øQu√© har√≠as ahora?  Reloj QR?  Preg√∫ntale a kote: <br><br><img src="https://habrastorage.org/webt/lw/yv/qp/lwyvqp84jo4uvj5byzropcuzf7k.jpeg"><br><br>  Kote ofrece implementar una simulaci√≥n de algunos LCD comunes con un controlador.  Para que otro "pensamiento" que funcione con la pantalla en el HD44780, solo grande, se pueda conectar a este Arduino. <br><br><h1>  Fuente - tambi√©n en RAM </h1><br>  Tomamos un ejemplo con EGA y VGA: all√≠, cuando se trabaja en modo texto, se hizo exactamente eso.  Solo aqu√≠ hab√≠a 64 caracteres en total, pero al menos todo entr√≥ en la RAM, a diferencia del modo gr√°fico.  Es cierto que el ciclo principal de eventos se ha ralentizado, pero puede probar los gr√°ficos de mosaico: <br><br><img src="https://habrastorage.org/webt/ie/5w/qa/ie5wqaezqkvosxnzrjhvu3bzpaa.jpeg"><br><br><h1>  Modo gr√°fico y medios tonos </h1><br>  En Arduino en AVR no hay tanta RAM, y ese es el punto.  Incluso en mega.  320x240 incluso con un bit por p√≠xel: ya son 9600 bytes.  Solo cuatro medios tonos requerir√°n el doble.  Con RAM externa, por ejemplo, 23LC512 en modo SQI, puede intentar implementar algo similar a DMA, pero es m√°s simple y rentable rehacer todo en ESP32, donde hay m√°s RAM est√°tica y DMA es m√°s f√°cil. <br><br>  Si solo desea conectar dicha pantalla a una PC a trav√©s de USB, puede intentar usar ATmega32u4 para esto: habr√° suficientes recursos incluso para las gradaciones de brillo (usando FRC, lo que se describe en mi traducci√≥n anterior).  Pero no con el "mega" utilizado como convertidor de interfaz, sino con una PC que escanear√° la pantalla LCD sobre la marcha a una velocidad de 5.4 megabits por segundo. <br><br>  Cuando el m√≥dulo todav√≠a estaba en la biblioteca de cintas, hab√≠a una GUI y gradaciones de brillo: todo estaba all√≠. <br><br>  Las actualizaciones ser√°n.  Mientras tanto ... <br><br><img src="https://habrastorage.org/webt/9z/cu/p9/9zcup9llwkpyuzyzxky3wghu_hs.jpeg"><br><br>  Y esto no es un montaje fotogr√°fico, sino el resultado del control desde una PC.  Y cambiaremos de Hackaday.io a GitHub; todav√≠a hay muchas cosas interesantes en README.md. <br><br><h1>  Se√±ales para controlar dichos m√≥dulos. </h1><br>  FLM - Marcador de primera l√≠nea: marcador de primera l√≠nea, tambi√©n se puede llamar MARCO, VSYNC, etc. <br>  CL1: pulso de enclavamiento de fila: tambi√©n se puede llamar pulso de cadena de escritura.  CARGA, HSYNC, etc. <br>  CL2: reloj de desplazamiento de p√≠xeles: tambi√©n se puede llamar pulso de cambio de p√≠xeles.  CP (cambiar p√≠xel), etc. <br>  M - la se√±al alterna, debido a que los p√≠xeles est√°n controlados por voltaje alterno, tambi√©n se puede llamar BIAS (offset), etc. <br><br>  D0-D3 es un bus de datos paralelo de cuatro bits. <br><br>  Conductores para cable com√∫n, potencia de retroiluminaci√≥n (por ejemplo, VLED ¬±), potencia del m√≥dulo (VEE y V0) <br><br>  No descuides las hojas de datos.  El m√≥dulo puede requerir otro voltaje negativo, o puede ser positivo, o el convertidor puede estar incorporado.  La l√≥gica puede diferir, por ejemplo, con una unidad en CL1 no habr√° reacci√≥n en CL2.  Puede haber una luz de fondo diferente (CCFL (con cuidado, el inversor es una "mordida") en lugar de LED), o no hay pinout en el tablero, entonces no lo sabr√° sin una hoja de datos.  No puedes conectar nada al azar. <br><br><h1>  Que hay para hacer </h1><br>  Transmita la cadena en trozos de cuatro bits, la grabaci√≥n se realiza en la disminuci√≥n en la l√≠nea CL2.  Despu√©s de pasar la l√≠nea, an√≥telo en la recesi√≥n en la l√≠nea CL1 (s√≠, despu√©s de todo, un poco de RAM en el m√≥dulo est√° en una l√≠nea).  La siguiente l√≠nea se seleccionar√° autom√°ticamente.  Despu√©s de transmitir toda la trama, regrese al principio utilizando la se√±al FLM.  En una hoja de datos sobre LC79401 hay un ejemplo.  Grabe a una velocidad suficiente, aplique pulsos a CL1 de manera uniforme.  El controlador vacil√≥ un poco: la pantalla parpade√≥ fea. <br><br>  Despu√©s de cada cuadro, cambie el nivel l√≥gico en la entrada M al opuesto, de modo que los p√≠xeles est√©n controlados por voltaje alterno.  De lo contrario, la pantalla se deteriora: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZP0KxZl5N2o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  No puede confiar esta operaci√≥n al microcontrolador, pero ponga un disparador contable.  La entrada a FLM, la salida a M, en general, es comprensible. <br><br>  Un ejemplo para generar im√°genes desde la memoria flash (vea el comienzo del art√≠culo) se llama clglcd_simple en este repositorio. <br><br>  Como ya se mencion√≥, es imposible hacer lo mismo con RAM en Arduino en AVR; no ser√° suficiente, por lo tanto ... <br><br><h1>  Y de nuevo - modo texto </h1><br>  Seg√∫n la hoja de datos, puede transmitir datos en un bus de cuatro bits y "extraer" CL2 con una frecuencia de hasta 6 MHz.  Por lo tanto, puede transferir r√°pida y r√°pidamente la l√≠nea, luego el microcontrolador resuelve un poco otras tareas, y cuando el temporizador lo "dice", "tira" de CL1 y repite el ciclo. <br><br>  Al generar caracteres para una resoluci√≥n horizontal de 320 p√≠xeles, todo esto se puede hacer en 20 Œºs (320 p√≠xeles / 4 bits = 80 pulsos, CL2 "pull" con una frecuencia de 4 MHz).  Para las tareas restantes, quedan 39.5 Œºs.  CL1 se ‚Äúsacude‚Äù cada 59.5 Œºs y obtiene una velocidad de cuadro de 70 Hz.  Bueno, habr√° m√°s procedimientos para manejar las interrupciones, etc., en general, el microcontrolador estar√° ocupado controlando la pantalla el 45% del tiempo.  ¬ø"Entero" 45 o "total" 45?  Probablemente el segundo: sobrescribir datos en la RAM de video puede ser lo suficientemente r√°pido. <br><br>  ¬øDesea que el microcontrolador pase menos tiempo administrando el indicador y m√°s en otras tareas?  Puede reducir la velocidad de cuadros a 50 Hz, puede overclockear el microcontrolador a 20 MHz.  Con cualquiera de estos m√©todos, se realizar√°n m√°s ciclos de reloj entre las rutinas de interrupci√≥n. <br><br>  Un temporizador de comparaci√≥n de salida cambia la l√≠nea CL2 cada cuatro pulsos de reloj con un ciclo de trabajo del 50%.  Al mismo tiempo, los datos van a las salidas del puerto PORTB, conectado al bus de datos de cuatro bits del m√≥dulo de tal manera que cambian en el momento en que el nivel sube a CL2, y en el momento de la disminuci√≥n permanecen sin cambios.  Por supuesto, esto no se puede hacer sin ensamblador: <br><br><pre> <code class="plaintext hljs">... lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ld r30, X+ swap r24; (CL2 rising edge) out %[data_port], r24 lpm r24, Z ;---------- (CL2 rising edge) out %[data_port], r24 ...</code> </pre> <br>  8 ciclos y se transmiten cuatro mordiscos.  Y qu√© transmitir exactamente depende de qu√© s√≠mbolo est√° en la celda RAM de video correspondiente, qu√© p√≠xeles correspondientes a este s√≠mbolo deben transferirse desde la ROM del generador de caracteres y qu√© se almacena en las celdas correspondientes de esta ROM. <br><br>  Lo m√°s inconveniente aqu√≠ es la necesidad de detener el temporizador despu√©s de exactamente 80 pulsos.  Algunos temporizadores, como Timer4 en 32u4, no pueden. <br><br>  Para obtener la se√±al suministrada a la l√≠nea CL1, el autor aplic√≥ una salida diferente del microcontrolador, destinada tanto al temporizador como a PWM r√°pido.  Cu√°l de esto se aplica aqu√≠ es comprensible.  Cambia cada 952 medidas.  O si cuenta despu√©s del divisor de reloj por 8, resulta que cada 119 pulsos.  En este punto, comienza la rutina de procesamiento de interrupciones y obliga al microcontrolador a enviar nuevos datos a la l√≠nea de control que se requerir√°n durante el siguiente impulso a CL1.  Bueno, el nivel en la l√≠nea M cambia con la mitad de la frecuencia.  Y la pantalla LCD no se deteriora.  Todas las se√±ales juntas se ven as√≠: <br><br><img src="https://habrastorage.org/webt/yt/_0/dh/yt_0dhpk4km7w-yml5spdz5ukl8.png"><br><br>  El generador de caracteres consta de 256 caracteres, suficiente para 866, KOI-8R o 1251. Se colocan 40xN caracteres en la RAM de video, donde N es el n√∫mero de l√≠neas dependiendo de la altura del car√°cter.  El ancho del s√≠mbolo siempre es de 8 p√≠xeles y la altura puede ser de 6, 8, 10, 12, 15, 16. Cuanto m√°s peque√±o es, menos ROM se requiere para el generador de caracteres y m√°s RAM de video.  Con una fuente de 8x8 (40 caracteres por 30 l√≠neas) necesita 1200 bytes de RAM y 2048 bytes de ROM.  Con una fuente de 8x16 (que se ve mejor en este m√≥dulo), RAM necesita 600 bytes y ROM 4096. Del traductor: puede almacenar la fuente en forma de 8x8, y escalarla verticalmente dos veces por programa, y ‚Äã‚Äãcuesta 600 bytes de RAM y 2048 ROM.  Para almacenar varias fuentes en ROM, debe mantener la direcci√≥n de inicio de la fuente no en una constante, sino en una variable, pero no funcionar√° imprimir el texto en varias fuentes a la vez, a menos que, por supuesto, cambie esta direcci√≥n sobre la marcha mediante el procedimiento de procesamiento de interrupci√≥n justo durante la transferencia de p√≠xeles a la pantalla. <br><br>  La fuente se almacena as√≠: primero las l√≠neas superiores de los 256 caracteres, luego una l√≠nea debajo, y as√≠ sucesivamente.  Hay una secuencia de comandos Python en la carpeta misc del repositorio, que convierte autom√°ticamente la fuente TTF al archivo de encabezado clglcd_font.h con la matriz PROGMEM en el formato requerido.  Las fuentes cl√°sicas de p√≠xeles para CC-BY-SA 4.0 se pueden encontrar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><h1>  Y de nuevo: tome un ejemplo con EGA y VGA </h1><br>  Pero esta vez con detalles.  El generador de caracteres en la RAM, como se indic√≥ anteriormente, acomoda un total de 64 caracteres, se pueden identificar por n√∫meros del 0 al n o del 255-n al 255. Se almacenan de la misma manera: las l√≠neas superiores de todos los caracteres, luego los siguientes, y as√≠ sucesivamente.  Solo todo esto se alinea teniendo en cuenta el hecho de que los caracteres no son 256, sino 64. Para caracteres de 8x16 p√≠xeles de tama√±o, se requieren 16 * 64 = 1024 bytes.  El repositorio tiene un ejemplo de trabajo con el generador de caracteres en RAM. <br><br>  Si se utilizan ambos generadores de caracteres al mismo tiempo: 256 caracteres en ROM y 64 caracteres en RAM, tendr√° que aceptar que no solo habr√° menos RAM, sino que tambi√©n disminuir√° la velocidad de transferencia de datos de las l√≠neas en el m√≥dulo, en lugar de 8 ciclos de reloj, dos mordiscos necesitar√°n 12, es decir, no 20 microsegundos, sino 30, y en lugar del 45% del tiempo para el control LCD, tomar√° 60. <br><br><h1>  Modo gr√°fico de medios tonos </h1><br>  Como se indic√≥ anteriormente, en este caso, el microcontrolador funciona simplemente como un convertidor de interfaz.  Necesitar√° ATmega32u4, y <a href="">aqu√≠</a> se describe qu√© hacer.  Tenga en cuenta que el m√≥dulo puede da√±arse debido a la congelaci√≥n del programa en la PC. <br><br>  Entonces, ¬øqu√© es este bucle de cuatro hilos? Resulta que desde el sensor resistivo. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/mMqvBnYOjEQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h1>  Donde conectar </h1><br>  Como se indic√≥ anteriormente, se requiere un voltaje negativo, que en los primeros experimentos se puede eliminar de tres "Crones", y luego montar el convertidor, por ejemplo, en el MAX749.  Las se√±ales de control de potencia, as√≠ como la se√±al DISPOFF (esta es una se√±al inversa, el m√≥dulo se enciende a la una), bajan las resistencias.  Durante la actualizaci√≥n y el reinicio del microcontrolador, la aparici√≥n de unidades l√≥gicas all√≠ es inaceptable. <br><br>  Aplique voltaje negativo despu√©s del voltaje + 5V, y una unidad l√≥gica a la l√≠nea DISPOFF, cuando los datos ya est√©n presentes en las l√≠neas de control: al menos una unidad en el bus de datos, unidad en CL1.  De lo contrario, el m√≥dulo puede fallar. <br><br>  Las entradas D0-D3 se pueden conectar a las salidas del mismo puerto del microcontrolador, por ejemplo, Px4-Px7, mientras que las salidas Px0-Px3 no se pueden usar como GPIO.  Puede asignarles otras funciones, por ejemplo, usarlas como salidas de temporizadores, interfaces seriales, etc.  Si los usa como entradas, tenga cuidado: las resistencias pull-up incorporadas pueden cambiar arbitrariamente si no est√°n deshabilitadas (PUD - pull-up deshabilitado). <br><br>  Entrada M - a la salida del temporizador de comparaci√≥n o PWM. <br><br>  Entrada CL1 - a otra salida del mismo temporizador. <br><br>  Entrada CL2 - a la salida de otro temporizador de comparaci√≥n. <br><br>  FLM - a cualquier salida digital. <br><br>  DISPOFF - a cualquier otra salida digital. <br><br>  El resto depende de c√≥mo encienda el m√≥dulo.  El autor prefiere controlar la luz de fondo y Vee por separado. <br><br><h1>  C√≥mo usar el firmware </h1><br>  Coloque los archivos clglcd.h y clglcd.cpp en el boceto. <br><br>  Haga una copia de seguridad del archivo clglcd_config.h y ed√≠telo teniendo en cuenta lo que est√° conectado y las funciones que necesita: un generador de caracteres en RAM, etc.  Atenci√≥n, el c√≥digo no indica los nombres de los pines Arduino, sino los nombres de los pines del microcontrolador de acuerdo con la hoja de datos.  Los nombres de las salidas de los domadores de comparaci√≥n se descifran de la siguiente manera: por ejemplo, 2, B es OC2B, que en el Arduino Uno corresponde a PD3.  Los ejemplos muestran las opciones de conexi√≥n que ha obtenido el autor. <br><br>  Genere el archivo de fuente clglcd_font.h con un script Python en la carpeta misc (ver arriba). <br><br>  Vea en ejemplos c√≥mo inicializar, encender y apagar la pantalla.  Coloque en la matriz de pantalla el texto que desea mostrar para su verificaci√≥n. <br><br>  Compila y rellena el boceto.  Verifique con un analizador l√≥gico que las se√±ales correctas ir√°n a la pantalla y con un volt√≠metro que todos los voltajes de suministro son normales.  Solo entonces conecte la pantalla. <br><br>  Agregue un c√≥digo al boceto que haga algo, por ejemplo, reciba texto en un puerto serie y mu√©strelo. <br><br><h1>  Mostrar interrupciones </h1><br>  La pantalla debe actualizarse constantemente, que es lo que hacen los procedimientos de manejo de interrupciones.  Si las interrupciones se detienen durante m√°s de 30 microsegundos, la pantalla parpadear√° y, si hay m√°s de 60 microsegundos para una unidad en la l√≠nea FLM, puede fallar.  Si necesita detener las interrupciones durante mucho tiempo, primero apague la pantalla con la se√±al DISPOFF (repito, esta es una se√±al inversa, el m√≥dulo se enciende a la una).  Por supuesto, si se apaga durante dos segundos cada vez que necesite procesar datos de un sensor de humedad y temperatura, a pocos les gustar√°, pero es mejor que arruinar el m√≥dulo.  Mejor a√∫n, cargue el resto en un microcontrolador separado.  El intercambio de informaci√≥n por el mismo microcontrolador con dispositivos que funcionan con el protocolo de 1 cable y los LED de direcci√≥n es especialmente inaceptable.  Los clones Arduino Pro Micro son lo suficientemente econ√≥micos como para comprar dos. <br><br><h1>  Comunicaci√≥n </h1><br>  Pero las interfaces implementadas en hardware funcionar√°n perfectamente: puertos seriales, bus I <sup>2</sup> C, SPI en modo maestro.  En el esclavo: solo si el maestro permite una "reducci√≥n" peri√≥dica del esclavo en 25-35 Œºs.  Por supuesto, a√∫n depende de cu√°ntas "patas" quedan desocupadas despu√©s de conectar la pantalla. <br><br>  USB en 32u4 funciona bien si no interroga el punto final de administraci√≥n con demasiada frecuencia (c√≥digo de rutina de interrupci√≥n lenta).  El controlador CDC y sus API fueron lo suficientemente r√°pidos. <br><br>  Luego, en el archivo README.md en GitHub, se repite la lista de proyectos similares, igual que en la p√°gina del proyecto en Hackaday.io <br><br>  Gracias por su atencion! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/444912/">https://habr.com/ru/post/444912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../444902/index.html">Optimizaci√≥n estructural por m√©todos de teor√≠a del control autom√°tico.</a></li>
<li><a href="../444904/index.html">Recuperaci√≥n de una contrase√±a maestra de un administrador de contrase√±as bloqueadas de SafeInCloud</a></li>
<li><a href="../444906/index.html">Leer basura</a></li>
<li><a href="../444908/index.html">Donde cultivar tel√©fonos inteligentes</a></li>
<li><a href="../444910/index.html">La estimulaci√≥n de sonido y luz ayuda con el Alzheimer, mientras que en ratones, pero los resultados son alentadores</a></li>
<li><a href="../444916/index.html">No compr√≥ DLC: una funci√≥n que salvar√≠a al 737 ca√≠do, Boeing vendi√≥ como una opci√≥n</a></li>
<li><a href="../444918/index.html">Donde crecen los tel√©fonos inteligentes: una hoja de ruta para convertirse en una computadora completa</a></li>
<li><a href="../444920/index.html">El nuevo algoritmo acelera 200 veces el dise√±o autom√°tico de las redes neuronales.</a></li>
<li><a href="../444922/index.html">C√≥mo protegerse del hipnovirus</a></li>
<li><a href="../444924/index.html">El primer WIAD en Mosc√∫: c√≥mo fue y de qu√© hablaron</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>