<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤱🏻 🎿 👨‍💼 深度学习识别绘画 ✋🏼 🙎🏼 🛄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha！ 今天，我想谈一谈深度学习如何帮助我们更好地理解艺术。 根据我们解决的任务，本文分为几部分： 


1. 从手机拍摄的照片中搜索数据库中的照片； 
2. 确定不在数据库中的图片的样式和风格。 


 所有这些都成为Arthive数据库服务及其移动应用程序的一部分。 


 识别绘画的任务是从...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>深度学习识别绘画</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/singularis/blog/421187/"><p> 哈Ha！ 今天，我想谈一谈深度学习如何帮助我们更好地理解艺术。 根据我们解决的任务，本文分为几部分： </p><br><ol><li> 从手机拍摄的照片中搜索数据库中的照片； </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">确定不在数据库中的图片的样式和风格。</a> </li></ol><br><p> 所有这些都成为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arthive数据库服务</a>及其移动应用程序的一部分。 </p><br><p> 识别绘画的任务是从数据库中来自移动应用程序的图像中找到相应的图片，为此花费了不到一秒钟的时间。 在设计前的研究阶段，完全排除了在移动设备中进行处理。 另外，事实证明，在真实拍摄条件下， <s>不可能</s>保证在移动设备上执行图片与背景的分离。 因此，我们决定我们的服务将接受来自手机的整个照片作为输入，所有失真，噪声和可能的部分重叠。 </p><br><img src="https://habrastorage.org/webt/cn/if/2y/cnif2ycyblx3ytn1e66pngunngq.jpeg"><br><p> 我们是否可以帮助Dasha在超过200,000张图像的数据库中找到这些画作？ </p><a name="habracut"></a><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Arthive</a>艺术<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">库</a>包含近250,000张图像，以及各种元数据。 基础不断更新-每天从数十张到数百张图像。 即使以有限的分辨率（大多数侧面不超过1400像素）抽出图像，图像占用的空间也超过80 GB。 不幸的是，数据库是“脏”的：文件损坏或太小，未对齐和未处理的图像，重复的图像。 但是，总体而言，这是好的数据。 </p><br><h2> 绘画比较 </h2><br><p> 让我们看看数据库中的图像如何： <br></p><table><tbody><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/sz/1q/rz/sz1qrz48kric62h7miqopl9lj1u.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">马克·罗斯科（Mark Rothko）</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">橙色，红色，黄色</a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/2s/2j/fi/2s2jfinlqycohujkfvv9khkcv2q.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">伊利亚·列宾</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">修女</a> <br></td><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><img src="https://habrastorage.org/webt/9l/ri/v0/9lriv0ga3emv589y3yrsbkxzwji.jpeg"><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">大卫·伯留克</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">来自热带地区的女性</a> <br></td></tr></tbody></table><br><p> 基本上，数据库中的图像是对齐的，裁剪到画布的边框，保留了颜色。 </p><br><p> 以下是来自移动设备的请求： </p><br><p><img src="https://habrastorage.org/webt/1p/iv/ej/1pivejjuiwsrqmhrh1yjonxeu-c.jpeg"></p><br><p> 颜色几乎总是失真的-发现复杂的照明，存在眩光，甚至发现玻璃中其他绘画的反射。 图像本身是透视变形的，可以被部分裁剪，或者相反，仅占据图片的不到一半，可以被例如人局部关闭。 </p><br><p> 为了识别图片，您需要能够将查询的图像与数据库中的图像进行比较。 </p><br><p> 为了比较容易出现透视失真和颜色失真的图像，我们使用关键点匹配。 为此，我们在图像上找到带有描述符的关键点，找到它们的对应关系，然后使用RANSAC方法单应显示相应的点。 通常以与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">OpenCV</a>示例中所述相同的方式完成此操作。 如果RANSAC发现的“内在”点的数量足够大，并且发现的单应性变换看起来合理（没有很强的缩放或旋转），那么我们可以假设所需的图像是一幅并且是同一幅图像，并且透视失真。 </p><br><p> 映射关键点的示例： </p><br><p><img src="https://habrastorage.org/webt/jg/vq/df/jgvqdfnkcmhe9-ohvbubeyajiua.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">否定匹配示例</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/q_/8b/yz/q_8byzpsh8rizjhgsol2z1nye4g.jpeg"></div></div><br><div class="spoiler">  <b class="spoiler_title">上例中绘画的比较</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/df/qb/ff/dfqbffq4ibpvjz1qh4_xhjhejvm.jpeg"><br><img src="https://habrastorage.org/webt/l4/b9/5a/l4b95adleete923jqu8leqc_gr4.jpeg"><br><img src="https://habrastorage.org/webt/sw/zc/os/swzcosr49hcjkuqc98lux5cwces.jpeg"><br><img src="https://habrastorage.org/webt/cn/hi/rr/cnhirrksz5srhe81bc3i0mc1exc.jpeg"><br><img src="https://habrastorage.org/webt/4r/y5/uf/4ry5ufekvsefkbba9allszpesro.jpeg"><br><img src="https://habrastorage.org/webt/70/oj/jy/70ojjy-ovr6eouymbnx7h0jel9i.jpeg"></div></div><br><p> 当然，寻找关键点通常是一个相当缓慢的过程，但是要搜索数据库，您可以提前找到所有图片的关键点并保存其中的一些。 在我们的实验中，我们得出的结论是，不足1000点足以可靠地搜索绘画。 当使用每点64个字节（坐标+ AKAZE描述符）存储1024个点时，每个图像64 KB或每个基础大约15 GB就足够了。 </p><br><p> 在我们的案例中，按关键点比较图片大约需要15毫秒，也就是说，要完全枚举250,000张图片的数据库，大约需要1个小时。 好多 </p><br><p> 另一方面，如果我们学会从整个数据库中快速选择几个（例如100个）最有可能的候选人，我们将满足每个请求1秒的目标时间。 </p><br><h2> 相似度排名 </h2><br><p> 深度卷积网络已将其自身确立为搜索相似图像的好方法。 该网络用于提取特征并在其基础上计算描述符，该描述符具有以下特性：相似图像的描述符之间的距离（欧几里德，余弦或其他）比不同图像的距离小。 </p><br><p> 您可以通过以下方式训练网络：对于来自基础的图片的图像以及来自图片的失真的图像，它会生成接近的描述符，而对于不同的图片（更远的图片）。 此外，这种网络用于计算数据库中所有图像的描述符和请求中的照片描述符。 您可以快速选择最接近的图像，并根据描述符之间的距离进行排列。 <br></p><p> 训练网络以计算描述符的基本方法是使用暹罗网络。 </p><br><p><img src="https://habrastorage.org/webt/eh/1l/xi/eh1lxi3gh88kjrqucs6kc2a4lpq.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.155ex" height="2.298ex" viewBox="0 -780.1 1789 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-62" x="1359" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> a，b </script>  -输入图像 <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi><mo>=</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.416ex" height="2.298ex" viewBox="0 -728.2 2332.1 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-79" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-3D" x="775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-31" x="1831" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-2"> y = 1 </script> 如果 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x4E00;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.928ex" height="2.298ex" viewBox="0 -780.1 830 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">一</text></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>一</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3">一</script> 和 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.057ex" viewBox="0 -780.1 429.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-62" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> b </script>  -一堂课 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="1.937ex" viewBox="0 -728.2 500.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-30" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-5"> 0 </script> 如果不同 <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mi>D</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><msup><mi>R</mi><mi>d</mi></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.981ex" height="2.78ex" viewBox="0 -935.7 9464.1 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-66" x="0" y="0"></use><g transform="translate(550,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="1380" y="0"></use><g transform="translate(1909,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(2739,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-66" x="3569" y="0"></use><g transform="translate(4120,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-62" x="4950" y="0"></use><g transform="translate(5379,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-44" x="6209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-69" x="7288" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6E" x="7633" y="0"></use><g transform="translate(8234,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="1074" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mi>D</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><msup><mi>R</mi><mi>d</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-6"> f（a），f（b）D \ in R ^ d </script>  -图像描述符 <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>=</mo><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>f</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.819ex" height="2.419ex" viewBox="0 -780.1 13699.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="0" y="0"></use><g transform="translate(523,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="1353" y="0"></use><g transform="translate(1882,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-62" x="2712" y="0"></use><g transform="translate(3142,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-3D" x="4250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="5306" y="0"></use><g transform="translate(5830,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-66" x="6659" y="0"></use><g transform="translate(7210,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="8040" y="0"></use><g transform="translate(8569,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(9399,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-66" x="10229" y="0"></use><g transform="translate(10780,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-62" x="11610" y="0"></use><g transform="translate(12039,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(12869,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>=</mo><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-7"> d（a，b）= d（f（a），f（b））</script>  -一对特征向量之间的距离 <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>y</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mn>1</mn><mo>&amp;#x2212;</mo><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>&amp;#x2212;</mo><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>b</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="70.122ex" height="2.419ex" viewBox="0 -780.1 30191.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-73" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-73" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-3D" x="2000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-79" x="3057" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-63" x="3804" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="4238" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6F" x="4761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-74" x="5247" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="5608" y="0"></use><g transform="translate(6132,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="6962" y="0"></use><g transform="translate(7491,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-62" x="8321" y="0"></use><g transform="translate(8751,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-2B" x="9803" y="0"></use><g transform="translate(10803,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-31" x="11633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-2212" x="12356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-79" x="13357" y="0"></use><g transform="translate(13854,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-63" x="14934" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="15368" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6F" x="15891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-74" x="16377" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6D" x="16738" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="17617" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-78" x="18146" y="0"></use><g transform="translate(18719,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-30" x="19549" y="0"></use><g transform="translate(20049,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6D" x="20879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="21758" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-72" x="22287" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-67" x="22739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-69" x="23219" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6E" x="23565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-2212" x="24388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="25388" y="0"></use><g transform="translate(25912,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="26742" y="0"></use><g transform="translate(27271,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-62" x="28101" y="0"></use><g transform="translate(28531,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(29361,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi>y</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mn>1</mn><mo>−</mo><mi>y</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>i</mi><mi>n</mi><mo>−</mo><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>b</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-8"> loss = y \ cdot d（a，b）+（1-y）\ cdot max（0，margin-d（a，b））</script>  -目标函数 </p><br><p> 为了构建这样的体系结构，在模型中使用具有共同权重的计算描述符的网络（特征提取器）两次。 几个图像被馈送到网络输入。 特征提取器网络计算图像描述符，然后网络根据指定的度量标准计算距离（通常使用欧几里得距离或余弦距离）。 网络训练的目标功能的构建方式是，对于正数对（一张图片的图像），距离减小，而对于负数对（不同图片的图像），距离增大。 为了减少负对的影响，它们之间的距离受边距值限制。 </p><br><p> 因此，我们可以说，在学习过程中，网络试图计算具有余量半径的超球体内的相似图像的描述符，以及不同边缘的描述符，以将其推出该球体。 </p><br><p> 例如，这看起来像是在MNIST数据集上使用暹罗网络训练二维描述符。 </p><br><p><img src="https://habrastorage.org/webt/vs/5y/7n/vs5y7nggt4cvqls3ohka9v8qmqi.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">训练动画</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hl/-u/fv/hl-ufvknsfliuuxpfvaqrynkusm.gif"></div></div><br><p> 要训​​练暹罗网络，您需要输入成对的图片和一个标签，如果图片属于同一类，则标签等于1；如果不同，则标签等于0。 存在选择正负对的比例的问题。 当然，理想情况下，当然有必要将训练集中所有可能的成对组合提交给网络训练，但这在技术上是不可能的。 负对的数量在这种情况下大大超过正对的数量，这对学习过程也不会产生很好的影响。 </p><br><p> 通过使用三元组体系结构解决了选择训练对的比例问题的部分问题。 </p><br><p><img src="https://habrastorage.org/webt/u4/a5/yz/u4a5yzgvxnum6zlvbugpj9japvm.png"><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.649ex" height="2.419ex" viewBox="0 -780.1 3293.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-70" x="1359" y="0"></use><g transform="translate(1862,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6E" x="2692" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> a，p，n </script>  -输入图像： <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.327ex" height="2.419ex" viewBox="0 -780.1 1863 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-70" x="1359" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>p</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> a，p </script>  -一张照片， <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6E" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> n </script>  -另一个 <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x635F;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x5931;</mo></mrow><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>p</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>&amp;#x2212;</mo><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>a</mi><mo>&amp;#x200B;</mo><mo>&amp;#x200B;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x4FDD;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x8BC1;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x91D1;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mn>0</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="49.759ex" height="2.419ex" viewBox="0 -780.1 21424 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">损</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">失</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-3D" x="1937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6D" x="2994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="3872" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-78" x="4402" y="0"></use><g transform="translate(4974,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="5804" y="0"></use><g transform="translate(6328,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="7157" y="0"></use><g transform="translate(7687,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-70" x="8517" y="0"></use><g transform="translate(9020,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-2212" x="10073" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-64" x="11073" y="0"></use><g transform="translate(11597,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-61" x="12427" y="0"></use><g transform="translate(13290,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMATHI-6E" x="14120" y="0"></use><g transform="translate(14720,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-2B" x="15772" y="0"></use><g transform="translate(16773,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">保</text></g><g transform="translate(17603,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">证</text></g><g transform="translate(18433,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">金</text></g><g transform="translate(19263,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/singularis/blog/421187/&amp;usg=ALkJrhj-Ueeko3pfm-naRYczC3Lp2RYeDg#MJMAIN-30" x="20093" y="0"></use><g transform="translate(20594,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mo>损</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>失</mo></mrow><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>p</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>−</mo><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>a</mi><mo>​</mo><mo>​</mo><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo>保</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>证</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>金</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mn>0</mn><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-12">损失= max（d（a，p）-d（a​​，n）+保证金，0）</script>  -目标函数 </p><br><p> 在这种网络的输入端，立即形成3张图像，形成正负对。 </p><p></p><p> 此外，几乎所有研究人员都认为，负对的选择对于网络学习至关重要。 如果许多样本不违反边际限制，则它们的目标函数（暹罗语对，三胞胎三对）的目标函数变为0，因此，此类样本不参与网络的训练。 随着时间的流逝，学习过程的速度甚至会进一步降低，因为目标函数非零值的样本越来越少。 为了解决这个问题，否定对不是偶然选择的，而是通过搜索困难案例来选择的。 实际上，为此选择了几个否定候选，使用网络权重的最新版本（从以前的时代甚至从当前的时代）计算出每个描述符的描述符。 有了描述符，您可以在每三个中选择一个负数，以产生已知的非零损耗。 </p><br><p> 为了搜索相似的图像，特征提取器与网络分离，用于计算描述符。 对于数据库中的图像，添加描述符时会预先计算它们。 因此，查找相似图像的任务是计算查询中的图像描述符，并在数据库中搜索最接近给定度量的描述符。 </p><br><p> 我们的网络特征提取器基于Inception v3架构。 实验选择了中间层之一，根据中间层的输出，计算出512个实数的描述符。 </p><br><p><img src="https://habrastorage.org/webt/0q/w2/mz/0qw2mzgdztu_zyr9fxxsijznzrw.png"></p><br><h2> 数据扩充 </h2><br><p> 如果我们可以将每张图片放在不同的帧中，在不同的墙壁上，并且每次在不同的手机上以不同的角度拍摄图片，那就太好了。 实际上，这当然是不可能的。 因此，有必要生成训练数据。 </p><br><p> 为了生成数据，收集了大约500张在不同光照条件下具有不同背景的各种绘画的照片。 对于每张照片，选择了4个与图片画布的角相对应的点。 对于四个点，我们可以将任何图片任意地放入框架中，从而替换图片并从数据库中获取图片的几乎随机的透视失真。 通过随机裁剪，噪声和颜色失真来补充此过程，我们有机会生成完全合适的图像来模仿绘画照片。 </p><br><p><img src="https://habrastorage.org/webt/fi/ad/wg/fiadwgwcbv0bqqgbfiphnthicm8.jpeg" alt="艺术化"></p><br><h2> 图片与背景的分离 </h2><br><p> 用于识别绘画的作品和模型的质量，以及用于对流派/风格进行分类的模型，在很大程度上取决于图片与背景的分离程度。 理想情况下，在将图片输入模型之前，需要找到其画布的4个角并以正方形显示透视图。 在实践中，事实证明很难实施一种可以保证这一点的算法。 一方面，有大量的背景，框架和对象可能掉入图片附近的框架中。 另一方面，在内部的绘画中，有相当明显的矩形轮廓（窗户，建筑立面，画中画）。 结果，通常很难说出图片的结束位置和环境的开始位置。 </p><br><p> 最后，我们基于经典的计算机视觉方法（边界检测+形态学过滤+所连组件的分析）确定了一个简单的实现，它使您可以放心地切掉单声道的背景，但又不会丢失某些图片。 </p><br><h2> 工作速度 </h2><br><p> 查询处理算法包括以下主要步骤： </p><br><ol><li> 准备-实际上，实现了图片的简单检测器，如果图像包含纯背景，该检测器将很好地工作； </li><li> 使用深度网络计算图片描述符； </li><li> 按与数据库中描述符的距离对图片进行排名； </li><li> 在图片中搜索关键点； </li><li> 按排名检查候选人。 </li></ol><br><p> 我们测试了200个请求的网络速度，得出了每个阶段的以下处理时间（以秒为单位的时间）： <br></p><table><thead><tr><th> 舞台 </th><th> 分 </th><th> 最大值 </th><th> 平均 </th></tr></thead><tbody><tr><td> 准备（图片搜索） </td><td>  0.008 </td><td>  0.011 </td><td>  0.016 </td></tr><tr><td> 描述符计算（GPU） </td><td>  0.082 </td><td>  0.092 </td><td>  0.088 </td></tr><tr><td>  KNN（k &lt;500，CPU，蛮力） </td><td>  0.199 </td><td>  <strong>0.820</strong> </td><td>  0.394 </td></tr><tr><td> 关键点搜索 </td><td>  0.031 </td><td>  0.432 </td><td>  0.156 </td></tr><tr><td> 检查关键点 </td><td>  0.007 </td><td>  <strong>9.844</strong> </td><td>  2.585 </td></tr><tr><td>  <strong>总请求时间</strong> </td><td>  0.358 </td><td>  10.386 </td><td>  3.239 </td></tr></tbody></table><br><p> 由于候选者的验证会立即停止，因此当找到足够有把握的图片时，我们可以假定请求的最短处理时间与在第一个候选者中找到的图片相对应。 对于根本找不到的绘画，将获得最大请求时间-检查500个候选对象后停止检查。 </p><br><p> 可以看出，大部分时间都花在了候选人的选择和验证上。 值得注意的是，这些步骤的执行非常不理想，并且具有很大的加速潜力。 </p><br><h2> 重复搜寻 </h2><br><p> 建立了绘画基础的完整索引后，我们用它来搜索数据库中的重复项。 在查看数据库大约3个小时后，发现在数据库中至少重复了13657张图像两次（大约三张）。 </p><br><p> 此外，发现了非常有趣的案例，这些案例不是重复的。 </p><br><img src="https://habrastorage.org/webt/hj/nh/kr/hjnhkregrx0th9cdshhzvf79b9y.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一二</a> 。 看来这是同一工作的两个阶段。 <br><br><img src="https://habrastorage.org/webt/eo/0o/qd/eo0oqdq2yip70qungxv6gttad3k.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">二</a> ， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">三</a> 。 不要注意名称-所有三张图片都是不同的。 <br><br> 以及通过关键点进行误报识别的示例。 <br><br><img src="https://habrastorage.org/webt/5t/gr/cr/5tgrcrmewazx_lqxd_po9cqd5v4.jpeg"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一二</a> 。 <br><br><div class="spoiler">  <b class="spoiler_title">关键点映射</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/y1/ug/7i/y1ug7idfof7szcvsbmsbr64h7fy.jpeg"></div></div><br><h2> 而不是结论 </h2><br><p> 总的来说，我们对服务的结果感到满意。 </p><br><p> 在测试装置上，识别精度达到80％以上。 在实践中，通常会发现，如果不是第一次找到图片，那么从另一个角度拍摄就足够了，就可以找到它。 发现错误图像时几乎不会发生错误。 </p><br><p> 总之，解决方案被包装在docker容器中并提供给客户。 现在，可以使用Arthive服务在应用程序中通过照片识别绘画作品，例如Play市场上的普希金博物馆（但是，它使绘画与背景分离，要求背景变亮，有时使摄影变得困难）。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN421187/">https://habr.com/ru/post/zh-CN421187/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN421173/index.html">自定义Google搜索视图</a></li>
<li><a href="../zh-CN421175/index.html">使用Prometheus监控Kubernetes集群</a></li>
<li><a href="../zh-CN421177/index.html">当您的公司甚至没有网站时，如何吸引数据分析专家</a></li>
<li><a href="../zh-CN421179/index.html">Java内部HashMap</a></li>
<li><a href="../zh-CN421183/index.html">IBM专利无人机可以区分情绪并带给人们咖啡。 还有周五还要写些什么？</a></li>
<li><a href="../zh-CN421189/index.html">将数据库迁移到旧版本的MS SQL Server</a></li>
<li><a href="../zh-CN421191/index.html">工匠用3D核心实现梦想有多么容易</a></li>
<li><a href="../zh-CN421193/index.html">奥迪PB18 e-tron</a></li>
<li><a href="../zh-CN421195/index.html">人工智能</a></li>
<li><a href="../zh-CN421197/index.html">在俄罗斯，正在为有言语和运动障碍的人开发神经耳机</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>