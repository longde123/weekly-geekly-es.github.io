<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÉüèº üß† üò≥ Opera√ß√£o "Migra√ß√£o": como √© a mudan√ßa para a nuvem DataLine üòæ üõÄüèø ‚òîÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cerca de 7 anos atr√°s, os primeiros projetos foram movidos para a nossa nuvem de maneira simples e despretensiosa. Imagens de m√°quinas virtuais foram ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Opera√ß√£o "Migra√ß√£o": como √© a mudan√ßa para a nuvem DataLine</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/476828/">  Cerca de 7 anos atr√°s, os primeiros projetos foram movidos para a nossa nuvem de maneira simples e despretensiosa.  Imagens de m√°quinas virtuais foram carregadas em um servidor FTP ou trazidas para discos r√≠gidos.  Em seguida, por meio de um servidor de importa√ß√£o especial, as VMs foram carregadas na nuvem. <br><br>  Se n√£o for um problema para o cliente desligar a m√°quina virtual por um dia ou dois (ou n√£o outras op√ß√µes), √© poss√≠vel.  Mas se o tempo de inatividade for de no m√°ximo uma hora, esse m√©todo n√£o funcionar√°.  Hoje, mostrarei quais ferramentas o ajudar√£o a migrar para a nuvem com um tempo de inatividade m√≠nimo e como o processo de migra√ß√£o funciona conosco. <br><br><img src="https://habrastorage.org/webt/5x/cx/dg/5xcxdguftiv1yk7grwcbj7fmf4q.jpeg"><br><a name="habracut"></a><br><h3>  Migrando com o Veeam Backup and Replication </h3><br>  Todo mundo conhece o Veeam Backup and Replication como uma ferramenta para criar backups e r√©plicas.  N√≥s o usamos para a migra√ß√£o entre nossos sites e para transportar clientes com virtualiza√ß√£o privada para nossa nuvem.  As m√°quinas virtuais clientes s√£o replicadas no vCenter, ap√≥s as quais o engenheiro as adiciona ao vCloud Director. <br><br>  A replica√ß√£o prim√°ria √© realizada em uma m√°quina virtual ativada.  No hor√°rio combinado, a m√°quina do lado do cliente √© desligada.  A replica√ß√£o √© iniciada novamente para transferir as altera√ß√µes que ocorreram desde a primeira replica√ß√£o.  Depois disso, a m√°quina virtual j√° inicia em nossa nuvem. <br><br><img src="https://habrastorage.org/webt/mn/us/t0/mnust0ek7ckllt7afy8kty-y_qa.png"><br><br>  Normalmente, a partir do momento em que a m√°quina √© desligada na infraestrutura do cliente e at√© o momento em que √© ligada, n√£o mais de meia hora, mas 15 a 20 minutos, passam em nossa nuvem. <br><br>  Ao mesmo tempo, a m√°quina virtual original permanece no site do cliente.  Se de repente algo der errado, voc√™ sempre poder√° reverter e lig√°-lo.  Para o cliente, esse m√©todo tamb√©m √© conveniente, pois n√£o exige dele o Veeam. <br><br>  <i>Caso 1</i> <i><br></i>  <i>O cliente tinha sua pr√≥pria infraestrutura virtual baseada no VMware - 40 VMs com capacidade de 30 TB.</i>  <i>O equipamento no qual o cluster foi implantado j√° est√° desatualizado e o cliente decidiu n√£o se envolver na compra de um novo e migrar para uma nuvem p√∫blica.</i>  <i>O requisito para o tempo de inatividade de sistemas cr√≠ticos n√£o passava de uma hora.</i>  <i>A Veeam Replication foi escolhida como ferramenta.</i>  <i>A vantagem tamb√©m foi que o provedor de Internet do cliente estava presente em nosso data center, o que nos permitiu organizar um bom canal.</i>  <i>A migra√ß√£o levou cerca de um m√™s, enquanto a troca era simples, levou at√© 30 minutos para um grupo de m√°quinas virtuais.</i> <br><br><h3>  Migrar com o Veeam Cloud Connect </h3><br>  O Veeam Cloud Connect √© uma ferramenta que ajuda a configurar a replica√ß√£o da m√°quina virtual e executar r√©plicas na nuvem do provedor de servi√ßos.  Ap√≥s a atualiza√ß√£o em <a href="https://habr.com/ru/company/dataline/blog/436086/">2019</a> , tornou-se poss√≠vel replicar m√°quinas virtuais diretamente no vCloud Director.  A √∫nica condi√ß√£o √© que, no lado do cliente, o Veeam Backup and Replication deva ser implantado pelo menos na vers√£o 9. Em resumo (uma vers√£o detalhada est√° <a href="https://habr.com/ru/company/dataline/blog/308984/">aqui</a> ), todo o processo √© o seguinte. <br><br>  O VCloud Director cria uma organiza√ß√£o com os recursos e redes necess√°rios.  No Veeam Cloud Connect, criamos uma conta, o cliente se conecta a ela no Veeam B&amp;R, seleciona o provedor e a organiza√ß√£o do DataLine e configura tarefas para replica√ß√£o.  Al√©m do fato de que durante essa migra√ß√£o, o tempo de inatividade ser√° de 15 a 20 minutos, o cliente n√£o depende do suporte t√©cnico do provedor e gerencia todo o processo de forma independente: ele cria tarefas de replica√ß√£o, a replica√ß√£o em si, desliga as m√°quinas e inicia o in√≠cio em um novo site. <br><br><img src="https://habrastorage.org/webt/g7/bm/j9/g7bmj9ziorp-bxksjcep9s73kfw.png"><br><br>  <i>Caso 2</i> <i><br></i>  <i>A infraestrutura do cliente de onde a migra√ß√£o foi planejada estava localizada na Bielorr√∫ssia.</i>  <i>Era necess√°rio transportar 90 VMs com um volume total de 27 TB, apesar do canal da Internet ter 100 Mbps.</i>  <i>Se voc√™ fizer um backup e envi√°-lo imediatamente para a nossa nuvem, em algumas VMs, isso levar√° v√°rios dias.</i>  <i>Durante esse per√≠odo, um grande delta aumentaria na VM e isso j√° poderia afetar adversamente o desempenho das m√°quinas ou, pior ainda, o local no armazenamento de dados se esgotou.</i>  <i>Eles agiram da seguinte maneira: primeiro, o cliente fez um backup completo local e nos transferiu uma c√≥pia para n√≥s na nuvem via Veeam Cloud Connect.</i>  <i>Ent√£o ele fez e jogou o incremento na nuvem.</i>  <i>A m√°quina virtual original continuou a funcionar.</i>  <i>Depois de desligar a VM, o cliente fez outro incremento e tamb√©m o transferiu para a nuvem.</i>  <i>Do nosso lado, implantamos uma m√°quina virtual a partir de um backup completo e, em seguida, fizemos dois incrementos nela.</i>  <i>Esse esquema nos permitiu minimizar o tempo de inatividade para 2 horas ao mudar para o nosso site.</i> <br><br><h3>  Migra√ß√£o com disponibilidade do VMware vCloud </h3><br>  Em mar√ßo deste ano, a VMware lan√ßou o vCloud Availability 3.0, que permite a migra√ß√£o de m√°quinas virtuais entre nuvens diferentes (vCloud Director - vCloud Director) e da virtualiza√ß√£o de cliente privado para a nuvem (vCenter - vCloud Director).  A principal conveni√™ncia √© a integra√ß√£o com a interface do vCloud Director.  Isso simplifica bastante o gerenciamento de replica√ß√£o e minimiza o tempo de inatividade ao alternar. <br><br>  Usando essa ferramenta, migramos um dos clientes da nossa nuvem de Moscou para a nossa nuvem em S√£o Petersburgo.  Era necess√°rio transportar 18 m√°quinas virtuais com uma capacidade total de 14 TB.  Para o cliente, uma organiza√ß√£o foi criada na nuvem de S√£o Petersburgo e as redes necess√°rias foram organizadas.  Em seguida, na interface do vCloud Director, o cliente mudou para as configura√ß√µes de disponibilidade do vCloud, criou tarefas de replica√ß√£o e mudou para o site de S√£o Petersburgo em um momento conveniente.  O tempo de inatividade quando a troca foi de 12 minutos. <br><br><img src="https://habrastorage.org/webt/3p/v8/9b/3pv89bdu2lsktkf8kcjg3tikqme.png"><br>  <i>O esquema de migra√ß√£o entre as nuvens do DataLine em S√£o Petersburgo e Moscou.</i> <br><br>  O VCloud Availability possui um mecanismo para migrar VMs de um site cliente para nossa nuvem.  Para fazer isso, um aplicativo especial de disponibilidade do vCloud √© implantado no cliente vCenter.  Ap√≥s uma configura√ß√£o simples, voc√™ est√° conectado √† nuvem e as tarefas de migra√ß√£o s√£o configuradas.  O cliente tamb√©m gerencia independentemente todo o processo e o tempo de migra√ß√£o √© minimizado. <br><br><img src="https://habrastorage.org/webt/qe/0h/xg/qe0hxg2qd306tw-ismqzsvuftue.png"><br>  <i>Um diagrama da migra√ß√£o de m√°quinas virtuais de uma instala√ß√£o privada para a nuvem.</i> <br><br>  O VMware vCloud Availability tem muitos outros casos de uso; falaremos sobre eles em um artigo separado em breve. <br><br><h3>  Preparando para a migra√ß√£o </h3><br>  Para selecionar uma ferramenta e realmente prosseguir com a migra√ß√£o, voc√™ precisa decidir sobre os seguintes pontos: <br><br>  <b>De onde estamos migrando.</b>  Se voc√™ estiver migrando de uma solu√ß√£o privada, ter√° total liberdade na escolha de ferramentas.  Se voc√™ sair do provedor, √© mais dif√≠cil.  Provavelmente, conectar a infraestrutura dos dois provedores e simplesmente arrastar a VM falhar√° por motivos de seguran√ßa.  √Äs vezes, o provedor, que o cliente recusar√°, come√ßa completamente a ser prejudicial e leva tempo.  Voc√™ pode deixar o provedor √† moda antiga: fazendo o upload da VM para discos e FTP ou migrando no n√≠vel do aplicativo.  O nome deste √∫ltimo √© arbitr√°rio e se parece com isso. <br><br>  <i>Caso 3</i> <i><br></i>  <i>Era necess√°rio migrar o sistema SAP do cliente de um provedor europeu: 34 VMs com um volume de 54 Tb.</i>  <i>Os recursos foram alocados para o cliente em nossa nuvem.</i>  <i>Entre n√≥s e a infraestrutura do provedor europeu estava organizada a conectividade de rede.</i>  <i>Os servidores de aplicativos foram reimplantados, com o roll-up das configura√ß√µes necess√°rias.</i>  <i>Grandes bancos de dados migrados atrav√©s do upload de backups para a nossa nuvem.</i>  <i>Em seguida, a replica√ß√£o entre os bancos de dados em nossos sites e nos sites de origem foi configurada.</i>  <i>No hor√°rio combinado, mudamos para os bancos de dados em nossa nuvem.</i> <br><br>  <b>A quantidade de dados e o canal da Internet.</b>  Normalmente, solicitamos ao cliente que forne√ßa descarga nos sistemas com par√¢metros de mem√≥ria, CPU, discos.  Estimamos se o canal √© suficiente para enviar diretamente r√©plicas ou backups de m√°quinas virtuais. <br><br>  <b>Simples v√°lido.</b>  Para sistemas diferentes e, consequentemente, m√°quinas virtuais, pode ser diferente dependendo da sua import√¢ncia para os neg√≥cios.  Normalmente, um cliente vem com requisitos prontos para o tempo de inatividade durante a migra√ß√£o e, com base nisso, escolhemos a ferramenta e o plano de migra√ß√£o certos.  Tentamos planejar a mudan√ßa final para noite ou fim de semana, para que at√© um pequeno tempo de inatividade n√£o seja percept√≠vel para os usu√°rios finais do cliente. <br><br>  Com base nesses dados, voc√™ pode escolher uma ferramenta e prosseguir com a migra√ß√£o.  Aqui est√° o que acontece a seguir. <br><br><ol><li>  <b>Configurando a conectividade de rede.</b>  Organizamos a conectividade de rede entre nossa nuvem e a infraestrutura do cliente.  M√°quinas virtuais ser√£o copiadas nesta rede.  Se o Veeam Backup and Replication for usado, esse ser√° um canal dedicado, menos comumente um canal VPN.  Se o Veeam Cloud Connect, tudo passa pela Internet ou pelo mesmo canal dedicado. <br><br>  Em seguida, a rede est√° configurada para a VM na nuvem.  Carros geralmente se movem em grupos e mais de um dia.  Depois que as VMs foram transferidas para n√≥s e lan√ßadas, elas devem interagir com as m√°quinas que ainda permanecem no local de partida. </li><li>  <b>Agenda de migra√ß√£o.</b>  Quando h√° muitos carros, √© razo√°vel dividi-los em grupos e transport√°-los em lotes.  Juntamente com o cliente, concordamos com um plano no qual prescrevemos quando e quais m√°quinas ser√£o movidas e quando a replica√ß√£o final e a mudan√ßa para um novo site ser√£o executadas. </li><li>  <b>Teste a migra√ß√£o.</b>  Migramos a m√°quina virtual de teste e verificamos se tudo est√° configurado corretamente: conectividade de rede entre sites, disponibilidade da m√°quina virtual para m√°quinas no site de origem, direitos de conta e muito mais.  Esse teste ajuda a evitar problemas durante a fase de migra√ß√£o de combate. </li></ol><br>  Isso √© tudo para mim.  Fa√ßa perguntas nos coment√°rios e fale sobre sua experi√™ncia de migra√ß√£o. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt476828/">https://habr.com/ru/post/pt476828/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt476806/index.html">MPS 2019.2: tipos de dados enumerados, personaliza√ß√£o de mensagens de erro, transi√ß√£o para o JDK 11 e muito mais</a></li>
<li><a href="../pt476812/index.html">Notas sobre tudo. Fontes de alimenta√ß√£o simples e perigosas</a></li>
<li><a href="../pt476816/index.html">Dubai Mall em um smartphone ou como adicionar uma planta baixa de um edif√≠cio ao seu aplicativo</a></li>
<li><a href="../pt476824/index.html">McKinsey: Repensando a arquitetura de software e eletr√¥nica no setor automotivo</a></li>
<li><a href="../pt476826/index.html">M√∫ltiplas Experi√™ncias: Teoria e Pr√°tica</a></li>
<li><a href="../pt476830/index.html">Como implementar fun√ß√µes do utilit√°rio JavaScript usando o Reduce?</a></li>
<li><a href="../pt476834/index.html">Red Hat OpenShift 4.2: Novas Ferramentas</a></li>
<li><a href="../pt476838/index.html">Como capturar luz com espuma: rede de espuma-f√≥ton</a></li>
<li><a href="../pt476842/index.html">Como construir um sistema eficaz de suporte ao cliente</a></li>
<li><a href="../pt476844/index.html">Espec√≠fico e global: programa Mobius 2019 Moscou</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>