<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏼‍🎓 🍀 🌪️ Neugierige Perversionen aus der IT-Welt - 4 🚭 🍯 👋🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Daily WTF sammelt seit 15 Jahren lustige, wilde und / oder traurige Geschichten aus der IT-Welt. Ich übersetzte mehrere Geschichten, die mir inter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Neugierige Perversionen aus der IT-Welt - 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446714/"><div style="text-align:center;"><img src="https://ic.pics.livejournal.com/egor_23/73280836/1707368/1707368_1000.jpg" alt="Bild"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Daily WTF</a> sammelt seit 15 Jahren lustige, wilde und / oder traurige Geschichten aus der IT-Welt.  Ich übersetzte mehrere Geschichten, die mir interessant erschienen.  Alle Firmennamen und Namen wurden geändert.  Frühere Ausgaben finden Sie unter dem Label " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">kuriose Perversionen</a> ". <br><br><h2>  Die erste Geschichte.  Ende <s>des</s> Monats </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[Original]</a> <br><br>  Wenn Sie einen Konstrukteur fragen, ob das Überqueren einer Brücke sicher ist, teilt er Ihnen gerne mit, wie zuverlässig die Brücken sind, wie die Mathematik darin funktioniert und wie weit wir in Sachen Gebäudesicherheit gekommen sind.  Wenn Sie mit ihm gesprochen haben, werden Sie den Eindruck haben, dass keine einzige Brücke auf der Erde jemals auseinanderfallen wird.  Wenn Sie jedoch den Softwareentwickler nach den Banken fragen, werden Sie höchstwahrscheinlich entsetzt sein und sich mit einer Wahrscheinlichkeit von 50/50 davon überzeugen, das gesamte Geld in Bitcoin zu investieren.  Banken sind für ihre schlechten Entscheidungen bei der Erstellung von Software berüchtigt - nicht weil diese Entscheidungen widerlich sind, sondern weil die meisten Leute davon ausgehen, dass Banken genauer und vorsichtiger mit Sicherheit umgehen. <br><br>  <b>Kato</b> arbeitet bei der Inibank, wo ein kommerzielles Produkt namens T24 als Kern des Bankensystems verwendet wird.  Das T24-System wird von Hunderten von Banken auf der ganzen Welt verwendet.  Es kann an eine Vielzahl von Banklösungen angepasst werden.  Wie bei den meisten benutzerdefinierten Paketen.  Es gibt Programmierer, die sich darauf spezialisiert haben, Code dafür zu schreiben, und Berater, die Banken bei wichtigen Updates helfen. <br><a name="habracut"></a><br>  Die Mitarbeiter der Inibank waren beschäftigt, daher lud die Bank einen Berater ein, an einem speziellen Projekt teilzunehmen.  Am Ende des Arbeitstages führte die Bank den Abschlussprozess durch, der erforderlich ist, damit das gesamte Geld dorthin fließt, wohin es geleitet wurde, alle erforderlichen Ausgabedaten neu berechnet und alle erforderlichen Berichte ausgeführt werden.  Bei Banken ändert dieser Prozess auch das Systemdatum auf den nächsten Geschäftstag.  Aus diesem Grund wird beim Online-Banking am Sonntag erst am Montagmorgen eine einzige Transaktion verarbeitet.  Der Berater musste einen neuen Bericht erstellen, der während des Abschlussprozesses ausgeführt wurde und eine zusätzliche Verarbeitung beinhaltete, wenn das Datum dem Monatsende entsprach. <br><br>  Kato zeigte dem neuen Berater, wie die Bank Tagesabschlussberichte erstellt.  „Sehen Sie, wir haben globale Variablen für den vorherigen Arbeitstag, für heute und für den nächsten Arbeitstag.  Sie haben das Format JJMMTT, um die Arbeit zu erleichtern. " <br><br>  „Ja, ja, verstanden.  Ich verstehe.  In welchem ​​Format sind sie? " <br><br>  "... Ähh ... ich kann nur annehmen, dass dies das Jahr, der Monat und der Tag ist." <br><br>  „Ja, ja, okay.  Großartig.  Dann mache ich mich an die Arbeit. “ <br><br>  Nach diesem Gespräch hatte Kato ein schlechtes Gefühl dabei.  aber er versuchte ihn loszuwerden.  Der Berater sagte, dass alles eingerichtet und bereit sei.  Er weiß genau, was er tut, oder?  Kato warf dies aus seinem Kopf und hörte auf, sich Sorgen zu machen, bis die Zeit für die Codeüberprüfung kam und er eine solche Perle fand: <br><br><pre> <code class="hljs pgsql">TH.DATE = R.DATES(EB.DAT.NEXT.WORKING.DAY)[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>]:"01" <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> CDT(<span class="hljs-string"><span class="hljs-string">'ES00'</span></span>,TH.DATE,"-1C") WTODAY = OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DY") : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DM"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) : FMT(OCONV(<span class="hljs-type"><span class="hljs-type">DATE</span></span>(),"DD"),<span class="hljs-string"><span class="hljs-string">'R%2'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> TH.DATE EQ WTODAY <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span></code> </pre> <br>  Erklären Sie kurz, was hier passiert: <br><br><ol><li>  Nehmen Sie den nächsten Werktag und ändern Sie den Tag auf 01, um den ersten Tag des Monats zu erhalten. </li><li>  Wir ändern dieses Datum, indem wir 1 Kalendertag vom Kalender Spaniens abziehen. </li><li>  Wir nehmen das Datum vom Server und übersetzen es in das Format JJJJMMTT, wobei wir den Befehl Datum dreimal aufrufen. </li><li>  Wenn das in Schritt 2 berechnete Datum dem in Schritt 3 berechneten Datum entspricht, starten Sie den Vorgang. </li></ol><br>  Nun, eigentlich ... es funktioniert.  Zum größten Teil.  Es sei denn, aus irgendeinem Grund erfolgt das Ende des Tages nicht nach Mitternacht am vorletzten Tag des Monats - und dies ist nicht so selten.  In diesem Fall glaubt der Code fälschlicherweise, dass dies der letzte Tag des Monats ist, und beginnt mit der Erstellung des Berichts.  Was gut zu einem anderen Problem passt: Wenn am letzten Tag des Monats dasselbe passiert, wird die Erstellung des Berichts nicht versehentlich gestartet.  Und der beste Fehler: Wenn sich herausstellt, dass der letzte Tag des Monats Sonntag ist, wird der Kalender des Servers niemals darauf installiert, da er arbeitsfreie Tage überspringt. <br><br>  Apropos arbeitsfreie Tage: Da sich die Inibank in den USA befindet, gibt es keinen Grund, den spanischen Kalender zu verwenden.  Ja, die Monate und Wochen sind gleich, aber im spanischen Softwarekalender müssen Sie Feiertage in den USA angeben, da das Programm sonst weiterhin funktioniert.  Als ob all dies noch nicht genug wäre, bedeutet der dreifache Datumsaufruf, dass es zu Meinungsverschiedenheiten kommen kann, wenn genau um Mitternacht begonnen wird: Der Monatswert wird vor Mitternacht und am Tag danach angefordert. <br><br>  Kato fügte einen Kommentar hinzu und schlug eine Möglichkeit vor, den Code zu ändern: <br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">IF</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.TODAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> # <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DATES</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">EB</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAT</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.LAST</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.WORKING</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.DAY</span></span>)<span class="hljs-selector-attr"><span class="hljs-selector-attr">[5,2]</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">THEN</span></span></code> </pre> <br>  Fünf Minuten später ging der Berater zu seinem Schreibtisch.  "Was bedeutet diese Bearbeitung?" <br><br>  Kato war in diesem Moment nicht in der Stimmung zu streiten.  „Dein Code ist kaputt, Freund.  All dies ist nicht notwendig. " <br><br>  „Ich verstehe, ich verstehe.  Dies ist eigentlich nur ein Standardverfahren für unsere Branche.  Na gut. " <br><br>  Kato bezweifelte das sehr, zuckte aber nur die Achseln.  „Dann ist die Branche falsch.  Ich habe alles im Kommentar erklärt. " <br><br>  „Ja.  Ja, ich habe es gelesen.  Aber ich werde es noch einmal lesen. “  Und er verschwand so plötzlich wie er erschien. <br><br>  Änderungen wurden vorgenommen, Kato genehmigte den Code und der Berater verschwand im Nebel. <br><br>  Manchmal, als Kato nachts im Bett lag, fragte er sich: Hat der Berater wirklich verstanden, was er falsch gemacht hatte, oder war er nur einverstanden zu schauen, erhielt seinen Scheck und schrieb irgendwo einen schrecklichen Code für einen Preis, der doppelt so hoch war wie das Gehalt von Kato?  In Banken, in denen es keine Mitarbeiter gibt, die den Code überprüfen können. <br><br>  Aber investieren Sie nicht das ganze Geld in Bitcoin.  Dort ist es noch schlimmer. <br><br><h2>  Die zweite Geschichte.  Wie wird das gemacht? </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[Original]</a> <br><br>  Die Leute lieben es, Hot Dogs zu essen, bis sie herausfinden, wie sie kochen.  Die meisten fragen nicht, weil sie nicht wissen wollen und weiterhin Hot Dogs essen.  Bei der Entwicklung von Software müssen wir manchmal fragen.  Nicht nur, um Probleme zu lösen, sondern auch, weil einige Programmierer befürchten, dass die Software in ihren Autos, die mit einer Geschwindigkeit von 100 km / h die Autobahn entlang fährt, aus Klebeband und Sticks zusammengesetzt ist.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Unsere gesamte Branche erledigt ihre Aufgaben schlecht</a> . <br><br>  <strong>Brett</strong> arbeitete als Systemanalytiker am MedStitute Medical Research Center.  MedStitute verwendete eine proprietäre Software namens MedTech, um Daten zu speichern und zu analysieren.  Ärzte und Forscher mochten die Ergebnisse von MedTech, aber Kollege Brett Tyree wusste, wie sie geschaffen wurden. <br><br>  Die Software hatte keinen Zugriff auf das Backend und der gesamte Entwicklungsprozess fand in der GUI "Programmable Mouse" statt.  Diese Oberfläche sah aus, als ob sie von einer Person geschrieben wurde, die das Programmieren mit Copy-Paste-Websites aus den 90er Jahren studierte, zehn Minuten <em>Jurassic Park betrachtete</em> und nach Antworten auf StackOverflow suchte, bis etwas kompiliert werden konnte.  Die "Programmiersprache" zeigte auch in der Designphilosophie ein ähnliches Maß an Nachdenklichkeit.  Jeder <em>muss</em> einen <code>else</code> <em>gehabt</em> haben.  Einige Module verwendeten Boolesche Werte, andere gaben leere Zeichenfolgen zurück, um falsche Werte anzuzeigen.  Aus der Dokumentation war nicht ersichtlich, in welcher Situation die eine oder andere passiert ist.  Tatsächlich wurde jede <code>if</code> zu drei Anweisungen. <br><br>  Brett musste eine neue Studie beginnen.  Es basierte auf einer einfachen Reihe von Statistiken und gruppierten Patienten unter Verwendung einer randomisierten Variablen.  Brett suchte in der Liste nach einer Variablen, die randomisiert werden konnte, fand sie aber nicht notwendig.  Er schlug vor, einen Fehler zu machen, und ging ein paar Bildschirme zurück, um ihren Namen zu überprüfen, indem er ihn für eine Suche kopierte.  Brett kehrte zur Liste der zufälligen Variablen zurück.  Sie war nicht da.  Er sah sich die Liste genauer an und stellte fest, dass die Liste der zufälligen Variablen Daten aus Multiple-Choice-Feldern enthielt.  Das Feld, das er randomisieren musste, basierte auf einem berechneten Feld. <br><br>  Brett wusste, dass Tyree an einem anderen Projekt arbeitete, das nach berechneten Feldern randomisiert war, und kontaktierte ihn daher bei Slack.  „Wie haben Sie diese Zufallsvariable codiert?  Verhindert Medtech dies? “ <br><br>  "Ich spreche über Konferenzen, ich rufe Sie später zurück", schrieb Tyree. <br><br>  Ein paar Minuten später rief Tyree Brett an. <br><br>  „Sie müssen mit zwei Feldern beginnen.  Sagen wir mal.  Nennen wir sie <code>$variable_choice</code> , dh eine Multiple-Choice-Frage, und <code>$variable_calced</code> , dh Ihr berechnetes Feld.  Wenn Sie eine Variable erstellen möchten, die eine zufällige Auswahl basierend auf einem berechneten Feld durchführt, teilen Sie Medtech mit, dass diese zufällige Variable auf <code>$variable_choice</code> basiert.  Dann löschen Sie <code>$variable_choice</code> und benennen <code>$variable_calced</code> in <code>$variable_choice</code> “ <br><br>  „Stop, das System erlaubt es Ihnen, aber erlaubt Ihnen nicht, die berechneten Felder auf andere Weise zufällig zu ordnen?  Und sie überprüft es nicht? " <br><br>  "Ich hoffe, dass sich nichts ändert, und sie beginnt erst nach Abschluss meines Projekts, dies zu überprüfen", antwortete Tyree. <br><br>  „Diese Studie sollte über zehn Jahre stattfinden.  Und sein erfolgreicher Abschluss hängt davon ab, ob die Entwickler diesen Trick für einen Fehler halten? “ <br><br>  „Ich habe nur eine solche Lösung gefunden.  Lass es mich wissen, wenn du etwas Besseres findest. “ <br><br>  Brett befriedigte einen solchen Hack nicht und studierte wieder die Dokumentation.  Er fand eine „bessere“ Lösung: Sie können ein schreibgeschütztes Multiple-Choice-Feld mit dem einzigen Standardwert erstellen - dem Wert des berechneten Felds.  Leider kann der Benutzer die Liste versehentlich ändern, indem er eine Multiple-Choice-Frage beantwortet, <em>bevor er</em> den Wert des berechneten Felds berechnet. <br><br>  Am Ende blieb Brett nur noch eine Pause, in die Cafeteria gehen und ein paar Hot Dogs kaufen. <br><br><h2>  Die dritte Geschichte.  Portabilität und Hardware </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[Original]</a> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52e/2cb/0c2/52e2cb0c2e0b8465a1b713aa60dfd474.jpg"></div><br>  Vor vielen Monden, als PCs Schwermetall- und Kunststoffgehäuse hatten, wurden <b>Matt</b> und sein Kollege gebeten, das Softwarepaket für den bevorstehenden Betrieb der Verkaufsabteilung zu evaluieren.  Leider arbeiteten er und sein Kollege in verschiedenen Büros innerhalb derselben Stadt.  In dieser Zeit gab es noch keine effektiven Tools für die Online-Zusammenarbeit, sodass Matt regelmäßig in ein anderes Büro reisen und einen PC mitnehmen musste.  Dies bedeutete, dass jedes Mal, wenn es notwendig war, Peripheriekabel vom Gehäuse 473 zu trennen, den Computer entlang der Korridore und die Treppe hinunter zu tragen, einen Bus zu nehmen, um zu einem anderen Büro zu gelangen, in dem er dies alles in umgekehrter Reihenfolge tat.  Manchmal zwang die falsche Arbeitsorganisation dieses Paar, am Wochenende zu arbeiten, was bedeutet, dass sie Arbeitsmaschinen nach Hause tragen. <br><br>  Dabei lief die 20-MB-Festplatte in Matts Computer über.  Von seinem Büro aus schickte er eine Anfrage an die IT-Abteilung.  Um den Antrag zu erfüllen, wurde Garys Techniker ernannt, der nach einiger Zeit in Matts Würfel erschien und eine neue Festplatte und einen Schraubenzieher in der Hand hielt.  Gary schickte Matt zum Kaffee, um sich auf seinen „Patienten“ zu konzentrieren.  Nach einer kleinen Operation schaltete sich Matts PC ein und arbeitete mit einer großen Festplatte. <br><br>  Am Tag vor Projektschluss hätte Matt seinen Teil der Arbeit fast abgeschlossen.  Er musste nur ein paar Ergänzungen zu seinem Bericht vornehmen und ihn dann auf Disketten kopieren und an die Verkaufsabteilung senden.  Er stellte seinen PC wieder in den Würfel und verband die Kabel, schaltete den Strom ein und hörte ein Knallen.  Der PC war tot und zeigte keine Lebenszeichen. <br><br>  Nach einem Panikanruf an die IT-Abteilung erschien Gary erneut mit einem Schraubenzieher in seinem Büro.  Er öffnete das PC-Gehäuse und schrie sofort: „Warte eine Minute!  Hast du irgendwo einen Computer gezogen? " <br><br>  Matt runzelte die Stirn.  „Nun ja.  Ist das das Ding? " <br><br>  „Ja natürlich!  Das hättest du nicht tun sollen! “Gary begann zu fluchen.  "Die Festplatte fing an rumzuhängen und hat alles im Inneren kurzgeschlossen!" <br><br>  Matt beugte sich über Gary, um sich selbst ein Bild vom Inneren des Computers zu machen.  Er bemerkte sofort, dass die neue Festplatte auf Band „repariert“ war. <br><br>  „Hör auf!  Das <i>hättest du</i> nicht tun sollen! “  Matt zeigte auf ein Stück Klebeband.  "Soll ich mich für alle Fälle an Ihren Vorgesetzten wenden?" <br><br>  Garys Gesicht runzelte die Stirn.  "Sie geben mir nicht die notwendigen Befestigungselemente!" <br><br>  "Dann finde den, der sie hat!" <br><br>  Angesichts der bevorstehenden Frist übertrug Matt mit Erlaubnis des Chefs seine Bewerbung noch weiter.  Fast sofort wurde das Klebeband durch echte Hardware ersetzt.  Er verstand nie, <i>warum</i> die Mitarbeiter der IT-Abteilung keinen Zugang zu den erforderlichen Geräten hatten.  er schlug vor, dass es die geniale Idee eines Idioten war, Geld zu sparen.  Matt konnte nur raten, welche anderen verzweifelten Improvisationen ihre IT-Infrastruktur zum Funktionieren brachten und wie lange sie unbemerkt bleiben würden, wenn sein PC nicht kaputt gehen würde. <br><br><h2>  Die vierte Geschichte.  So wirkt sich PL / SQL auf Ihr Gehirn aus. </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[Original]</a> <br><br>  Der ewige Champion unter den seltsamsten und erfolglosesten Entscheidungen wird für immer <em>Oracle</em> bleiben.  Heute schauen wir uns einen kleinen PL / SQL-Code an. <br><br>  PL / SQL ist eine seltsame Sprache, eine Mischung aus SQL und <strong>P</strong> rocedural (prozedural) Sprache (Sprache) mit objektorientiertem Seitenkleben.  Die Syntax kann hervorragend den Eindruck erwecken, dass sie in den 1970er Jahren entwickelt wurde, und jede neue Funktion oder jeder Sprachwechsel setzt diese Tradition fort. <br><br>  Die Struktur jedes PL / SQL-Codemoduls ist <em>blockbasiert</em> .  Jeder Block ist ein unabhängiger Namespace.  Kurz gesagt, seine Anatomie sieht folgendermaßen aus: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">-- variable declarations go here BEGIN -- code goes here EXCEPTIONS -- exception handling code goes here, using WHEN clauses END;</span></span></code> </pre> <br>  Wenn Sie eine gespeicherte Prozedur oder einen Ereignishandler schreiben, ersetzen Sie das Schlüsselwort <code>DECLARE</code> durch <code>CREATE [OR REPLACE]</code> .  Sie können Blöcke auch in anderen Blöcken verschachteln, sodass Sie häufig Code sehen, der folgendermaßen strukturiert ist: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-comment"><span class="hljs-comment">--stuff BEGIN --actions END; --more actions END;</span></span></code> </pre> <br>  Ja, ziemlich schnell wird es verwirrend.  Und ja, wenn Sie zumindest eine annähernd strukturierte Fehlerbehandlung bereitstellen möchten, <em>müssen</em> Sie beginnen, Blöcke ineinander zu setzen. <br><br>  Die Sprache und die Datenbank haben andere lustige Funktionen.  Vor Version 12c hatten sie keinen <code>IDENTITY</code> .  In früheren Versionen mussten Sie das <code>SEQUENCE</code> Objekt verwenden und Prozeduren oder Ereignishandler schreiben, die eine erzwungene automatische Nummerierung durchführen.  In der Regel wurde der Operator <code>SELECT INTO…</code> verwendet, um einer Variablen einen Wert zuzuweisen.  Bonus: Für Oracle SQL muss in der <code>FROM</code> Anweisung <em>immer</em> eine Tabelle angegeben werden. <code>FROM</code> müssen Sie eine erfundene <code>dual</code> wie folgt verwenden: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE_AUTONUMBER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SOME_TABLE"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> myseq.nextval <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> :new.id <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre> <br>  <code>:new</code> in diesem Zusammenhang die Zeile an, für die wir automatisch nummerieren.  In älteren Versionen von Oracle war dies die „übliche“ Methode zum Erstellen von Spalten mit automatischer Nummerierung.  <strong>Benoit</strong> entdeckte eine andere, etwas weniger verbreitete Methode, um dieselbe Operation durchzuführen: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIGGER</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1_TRIGGER"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEFORE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-string"><span class="hljs-string">"SCHEMA1"</span></span>.<span class="hljs-string"><span class="hljs-string">"TABLE1"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EACH</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ROW</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> pl_error_id table1.error_id%<span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span>; CURSOR get_seq IS <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> table1_seq.nextval <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> dual; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OPEN</span></span> get_seq; FETCH get_seq INTO pl_error_id; IF get_seq%NOTFOUND THEN raise_application_error(-20001, 'Sequence TABLE1_SEQ does not exist'); CLOSE get_seq; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; CLOSE get_seq; :new.error_id := pl_error_id; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> table1_trigger;</code> </pre> <br>  Hier ist viel los.  <code>DECLARE</code> , dass der Abschnitt <code>CURSOR</code> Anweisung <code>DECLARE</code> enthält.  Mit Cursorn können Sie Datensätze durchlaufen.  Sie sind sehr teuer und in der Oracle-Welt ist es eine Ressource, die freigegeben werden muss. <br><br>  Dieser Ereignishandler (Trigger) verwendet ohne Grund einen verschachtelten Block.  Es wird auch die zusätzliche Variable <code>pl_error_id</code> , auf die verzichtet werden kann. <br><br>  Aber der wirklich seltsame Teil ist der <code>IF get_seq%NOTFOUND</code> Block <code>IF get_seq%NOTFOUND</code> .  Alles ist ganz einfach: Es überprüft die Bedingung, dass der Cursor keine Zeichenfolge zurückgibt.  Bei diesem Cursor kann dies nicht einmal <em>theoretisch</em> geschehen, sodass die darin enthaltenen Operationen niemals ausgeführt werden.  Eine Sequenz gibt immer einen Wert zurück.  Und das ist <em>gut</em> angesichts des Codes, der weiter geht. <br><br>  <code>raise_application_error</code> ist ein Analogon von werfen in Oracle.  Diese Anweisung geht den Stapel ausführbarer Blöcke hoch, bis der Abschnitt <code>EXCEPTIONS</code> wird, um den Fehler zu behandeln.  Beachten Sie, dass wir den Cursor <em>nach</em> dieser Anweisung schließen - das heißt, wir schließen den Cursor <em>niemals</em> .  Cursor sind, wie oben erwähnt, teuer, und Oracle erlaubt nur die Verwendung einer begrenzten Anzahl von Cursorn. <br><br>  Hier sehen wir ein seltsames Beispiel dafür, wie ein Entwickler versucht, sich gegen einen Fehler zu verteidigen, der nicht auftreten kann und der im Laufe der Zeit zu neuen Fehlern führt. <br><br><h2>  Die fünfte Geschichte.  Doppelte verschlüsselte Anmeldungen </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[Original]</a> <br><br>  Das Erstellen einer Authentifizierung für die Web-API ist eine <em>schwierige</em> Aufgabe, bietet jedoch <em>viele</em> etablierte Lösungen.  Am schwierigsten ist es tatsächlich, eine der verschiedenen Optionen auszuwählen. Danach reicht es aus, einfach eine Komponente hinzuzufügen. <br><br>  Bei korrekter Implementierung ist das System unabhängig vom Client-Typ.  Ich kann über einen Browser, einen Thick Client oder über cURL auf den Dienst zugreifen.  Bei falscher Implementierung erhalten Sie, was mit <strong>Amira</strong> passiert ist. <br><br>  Sie löste das Problem, die benötigten Statistiken aus dem Backend abzurufen, konnte jedoch die Authentifizierungsmethode nicht herausfinden.  Daher untersuchte sie den Front-End-Code, um zu verstehen, wie er die Authentifizierung durchführt: <br><br><pre> <code class="javascript hljs">crypt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JSEncrypt(); crypt.setPublicKey(<span class="hljs-string"><span class="hljs-string">'&lt;removed&gt;'</span></span>); challenge = <span class="hljs-string"><span class="hljs-string">"&lt;removed&gt;"</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doChallengeResponse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/&amp;/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%26'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value.replace(<span class="hljs-regexp"><span class="hljs-regexp">/\\+/g</span></span>, <span class="hljs-string"><span class="hljs-string">'%2B'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = crypt.encrypt(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.response.value = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.password.value = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.loginForm.submit(); }</code> </pre> <br>  Einerseits kann ich davon ausgehen, dass dieser Code angesichts der <code>document.loginForm</code> die für Interaktionen mit DOM-Elementen verwendet wird, sehr alt ist.  Auf der anderen Seite wurde <code>JSEncrypt</code> erstmals 2013 veröffentlicht, was uns die maximale Altersgrenze gibt. <br><br>  Wir übergeben die Zugriffsparameter an das Backend, indem wir das Formular senden, das laut Codeentwickler bereinigt werden muss - alle <code>&amp;</code> <code>+</code> im Passwort werden ersetzt, aber ... dies ist nicht erforderlich, da das Formular die <code>POST</code> Anforderung erfüllen muss und <em>wir</em> zusätzlich <em>die Daten verschlüsselt haben</em> . <br><br>  Hier ist was ich denke.  Der Code <em>ist eigentlich</em> ziemlich alt.  Der Entwickler hat es aus einem Beitrag auf StackOverflow um 2005 kopiert, in dem keine Verschlüsselung und Formularübermittlung per <code>POST</code> .  Jahr für Jahr wurden kleine Änderungen hinzugefügt.  Der zugrunde liegende Mechanismus hat sich jedoch nie geändert. <br><br>  Amira überprüfte den Verlauf und stellte fest, dass in der vorherigen Version keine Verschlüsselung verwendet wurde.      <code>challenge</code> ,    MD5,     <em></em>  ,     ,       . <br><br>     :   ,     ,         ,     ,    cURL      -.          ,    <em>    SSL/TLS</em> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de446714/">https://habr.com/ru/post/de446714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de446702/index.html">Und noch ein komischer Kopfhörer - zum Schlafen</a></li>
<li><a href="../de446706/index.html">Parallele Abfragen in PostgreSQL</a></li>
<li><a href="../de446708/index.html">Vergleich von Weltraumkommunikationssystemen</a></li>
<li><a href="../de446710/index.html">Vier echte Geschichten über die Arbeit mit Microservice-Architektur - Bericht aus dem Backend United 3-Mitap: Kholodets</a></li>
<li><a href="../de446712/index.html">HTTPS ist nicht immer so sicher, wie es scheint. In 5,5% der HTTPS-Sites wurden Sicherheitslücken gefunden</a></li>
<li><a href="../de446716/index.html">Doomsday Bewusstsein und Argument</a></li>
<li><a href="../de446718/index.html">Rückblick auf die interessantesten Berichte des CodeFest 2019: Version von True Engineering</a></li>
<li><a href="../de446722/index.html">Tests zeigen: Wie Sie sich auf die Implementierung von Cisco ISE vorbereiten und welche Funktionen des Systems Sie benötigen</a></li>
<li><a href="../de446724/index.html">Wie iOS-Entwickler versuchen, mit Cloud Computing die Nase vorn zu haben</a></li>
<li><a href="../de446726/index.html">Deep Learning in der optischen Flussberechnung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>