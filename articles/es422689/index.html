<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÖ±Ô∏è üëÇüèæ üìÖ Detecci√≥n de color de autom√≥viles utilizando redes neuronales y TensorFlow üé£ üí£ üë®üèº‚Äç‚öñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola, mi nombre es Roman Lapin, soy estudiante de segundo a√±o de la facultad de la Escuela Superior de F√≠sica General y Aplicada de la UNN. Este a√±o l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Detecci√≥n de color de autom√≥viles utilizando redes neuronales y TensorFlow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/intel/blog/422689/"><img src="https://habrastorage.org/webt/ay/jz/uv/ayjzuvpfvae66prncupgndyiwpc.jpeg"><br><br>  Hola, mi nombre es Roman Lapin, soy estudiante de segundo a√±o de la facultad de la Escuela Superior de F√≠sica General y Aplicada de la UNN.  Este a√±o logr√© completar la selecci√≥n y participar en el trabajo de Intel Summer School en Nizhny Novgorod.  Mi tarea consist√≠a en determinar el color del autom√≥vil utilizando la biblioteca Tensorflow, en la que trabaj√© con mi mentor e ingeniero del equipo de ICV Alexei Sidnev. <br>  Y esto es lo que tengo. <br><a name="habracut"></a><br>  Hay varios aspectos de esta tarea: <br><br><ol><li>  El autom√≥vil se puede pintar en varios colores, como en KDPV.  Y en uno de los conjuntos de datos, por ejemplo, ten√≠amos un autom√≥vil camuflado. </li><li>  Dependiendo de la iluminaci√≥n y la c√°mara que tome fotos de lo que est√° sucediendo en la carretera, los autos del mismo color se ver√°n muy diferentes.  Los autom√≥viles "iluminados" pueden tener una parte muy peque√±a que corresponde al color "verdadero" del autom√≥vil. </li></ol><br><h2>  <font color="#0071c5">Detecci√≥n de color del autom√≥vil</font> </h2><br>  El color del autom√≥vil es una sustancia bastante extra√±a.  El fabricante tiene una clara comprensi√≥n de qu√© color producen el autom√≥vil, por ejemplo: fantasma, hielo, perla negra, plut√≥n, lima, cript√≥n, angkor, cornalina, platino, azul.  La polic√≠a de tr√°nsito tiene una opini√≥n sobre los colores de los autom√≥viles bastante conservadores y muy limitados.  Cada persona individual tiene una percepci√≥n subjetiva del color (puede recordar la historia popular sobre el color del vestido).  Por lo tanto, decidimos marcar de la siguiente manera. <br><br>  En cada imagen, se marcaron las coordenadas de los v√©rtices de los rect√°ngulos aleda√±os alrededor de los autom√≥viles (en adelante usar√© la versi√≥n en ingl√©s - <i>cuadro delimitador del autom√≥vil</i> ) y dentro de ellas se encuentran las √°reas que mejor describen el color de los veh√≠culos ( <i>cuadro de color</i> ).  El n√∫mero de este √∫ltimo es igual al color del autom√≥vil ( <i>n</i> x <i>caja de color</i> - autom√≥vil n-color). <br><br>  En lo sucesivo, los n√∫meros de los autom√≥viles se ven borrosos por la posibilidad de publicar fotos en el dominio p√∫blico. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mh/p7/z5/mhp7z5aebrmyfhgw-cack-fm8zi.png" alt="imagen"></div><br>  <i>Marcado del conjunto de datos de autom√≥viles</i> <br><br>  En el futuro, trabajamos con dos espacios de color: RGB y LAB, con las clases 8 y 810/81, respectivamente.  Para comparar los resultados de diferentes enfoques, utilizamos 8 clases en RGB para determinar el color, que se obtienen dividiendo el cubo BGR en 8 cubos peque√±os iguales.  Pueden llamarse f√°cilmente nombres comunes: blanco, negro, rojo, verde, azul, rosa, amarillo, cian.  Para evaluar el error de cualquier m√©todo, ya hemos utilizado el espacio de color LAB, en el que se determina la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">distancia</a> entre los colores. <br><br>  Hay dos formas intuitivas de determinar el color por <i>cuadro de color</i> : <i>color</i> medio o mediano.  Pero en el <i>cuadro de color</i> hay p√≠xeles de varios colores, por lo que quer√≠a saber con qu√© precisi√≥n funciona cada uno de estos dos enfoques. <br><br>  Para 8 colores RGB para cada <i>cuadro de color de</i> cada m√°quina en el conjunto de datos, determinamos el color de p√≠xel promedio y la mediana, los resultados se muestran en las siguientes figuras.  Los colores "verdaderos" est√°n marcados en las l√≠neas, es decir, los colores definidos respectivamente como promedio o como la mediana, en las columnas, colores que se encuentran en principio.  Al agregar una m√°quina a la tabla, el n√∫mero de p√≠xeles de cada color se normaliz√≥ a su n√∫mero, es decir, la suma de todos los valores agregados a la fila era igual a uno. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ic/q-/ep/icq-ep_xxwuaiuuec8bordv3_cu.png" alt="imagen"></div><br>  <i>Investigaci√≥n de la precisi√≥n de determinar el color de una m√°quina como el color promedio de p√≠xeles color 'abox.</i>  <i>Precisi√≥n media: <b>75%</b></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/at/b3/wm/atb3wmizgurxd0gemdqiltoj62w.png" alt="imagen"></div><br>  <i>Investigaci√≥n de la precisi√≥n de determinar el color de una m√°quina como el color medio de los p√≠xeles en un cuadro de color.</i>  <i>Precisi√≥n media: <b>76%</b></i> <br><br>  Como puede ver, no hay una diferencia particular entre los m√©todos, lo que indica un buen marcado.  En el futuro, usamos la mediana, porque mostr√≥ el mejor resultado. <br>  El color del autom√≥vil se determinar√° en funci√≥n del √°rea dentro del <i>cuadro delimitador</i> del <i>autom√≥vil</i> . <br><br><h2>  <font color="#0071c5">¬øNecesitas redes?</font> </h2><br>  La pregunta es inevitable: ¬øson realmente necesarias las redes neuronales para resolver una tarea intuitivamente simple?  ¬øQuiz√°s pueda tomar el color medio o medio de los p√≠xeles en un <i>cuadro delimitador de</i> un <i>autom√≥vil</i> de la misma manera?  Las siguientes figuras muestran el resultado de este enfoque.  Como se mostrar√° m√°s adelante, es peor que el m√©todo que usa redes neuronales. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/an/bl/o8/anblo8jtdfojv3v7b1yd_bt5zzi.png" alt="imagen"></div><br>  <i>La distribuci√≥n de la proporci√≥n de autom√≥viles con el valor de error L2 en el espacio LAB entre el color del cuadro de color definido como el promedio y el color del cuadro delimitador del valor del error</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="imagen"></div><br>  <i>Distribuci√≥n de la proporci√≥n de autom√≥viles con el valor de error L2 en el espacio LAB entre el cuadro de color definido como la mediana y el color del <i>cuadro delimitador</i> del <i>autom√≥vil a</i> partir del valor de este error</i> <br><br><h2>  <font color="#0071c5">Descripci√≥n del enfoque de la tarea.</font> </h2><br>  En nuestro trabajo, utilizamos la arquitectura Resnet-10 para resaltar caracter√≠sticas.  Para resolver una etiqueta y problemas de m√∫ltiples etiquetas, se eligieron las funciones de activaci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">softmax</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">sigmoide,</a> respectivamente. <br>  Una cuesti√≥n importante fue la elecci√≥n de la m√©trica por la cual pudimos comparar nuestros resultados.  En el caso de las tareas de una etiqueta, puede seleccionar la clase que corresponde a la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">respuesta m√°xima</a> .  Sin embargo, una soluci√≥n de este tipo obviamente no funcionar√° en el caso de m√°quinas multilabel / multicolores, ya que argmax produce un color muy probable.  La m√©trica <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">L1</a> depende del n√∫mero de clases, por lo tanto, tampoco podr√≠a usarse para comparar todos los resultados.  Por lo tanto, se decidi√≥ detenerse en el √°rea m√©trica bajo la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">curva</a> ROC (ROC AUC - √°rea bajo la curva) como universal y universalmente reconocida. <br><br>  Trabajamos en dos espacios de color.  El primero es el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RGB</a> est√°ndar, en el que elegimos 8 clases: dividimos el cubo RGB en 8 subcubos id√©nticos: blanco, negro, rojo, verde, azul, rosa, amarillo, cian.  Tal partici√≥n es muy cruda, pero simple. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vq/4z/pd/vq4zpd9edgxx4m9z0cnk-8jso2i.png" alt="imagen"></div><br>  <i>Divida el espacio de color RGB en 8 √°reas</i> <br><br>  Adem√°s, realizamos estudios con el espacio de color LAB, que utiliz√≥ la partici√≥n en 810 clases.  ¬øPor qu√© tanto?  LAB se introdujo despu√©s de que el cient√≠fico estadounidense <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">David MacAdam</a> estableciera que hay √°reas de colores que no son visibles para el ojo humano ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">elipses de MacAdam</a> ).  LAB se construy√≥ de modo que en √©l estas elipses parec√≠an c√≠rculos (en la secci√≥n de brillo L constante). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-1/y5/q9/-1y5q9owfaqva2sd7sxy45auef0.png" alt="imagen"></div><br>  <i>Elipses de MacAdam y espacio de color LAB ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fuente</a> )</i> <br><br>  En total, hay 81 c√≠rculos en la secci√≥n de dichos c√≠rculos. Tomamos el paso 10 con respecto al par√°metro L (de 0 a 100), obteniendo 810 clases.  Adem√°s, realizamos un experimento con una clase L constante y, en consecuencia, 81. <br><br><h2>  <font color="#0071c5">RGB y LAB</font> </h2><br>  Se obtuvieron los siguientes resultados para el problema de 8 clases y el espacio RGB: <br><table><tbody><tr><th>  Funci√≥n de activaci√≥n </th><th>  Tarea multicabel </th><th>  ROC AUC </th></tr><tr><td>  softmax </td><td>  - </td><td>  0,97 </td></tr><tr><td>  sigmoide </td><td>  ‚úì </td><td>  0,88 </td></tr></tbody></table>  <i>Tabla de resultados de reconocimiento de color para m√°quinas en un problema de 8 clases</i> <br><br>  Parece que el resultado para la tarea de m√∫ltiples etiquetas ya es bastante bueno.  Para verificar este supuesto, construimos una matriz de error, tomando 0.55 como el valor umbral para la probabilidad.  Es decir  Si se supera la probabilidad de este valor para el color correspondiente, suponemos que la m√°quina est√° pintada en este color.  A pesar de que el umbral se elige lo suficientemente bajo, se pueden ver errores t√≠picos en la determinaci√≥n del color del autom√≥vil y sacar conclusiones. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5s/5q/9t/5s5q9tyt_8nbe4c0vb-mgxtoday.png" alt="imagen"></div><br>  <i>Tabla de resultados de reconocimiento de color para autom√≥viles en problemas de 8a clase</i> <br><br>  Solo mira las l√≠neas correspondientes a los colores verde o rosa para asegurarte de que el modelo est√° lejos de ser perfecto.  Sobre la pregunta de por qu√©, con un gran valor m√©trico, se obtiene un resultado tan infructuoso tan extra√±o, volveremos e indicaremos de inmediato: cuando consideramos solo 8 clases, una gran cantidad de colores cae en las clases "blanco" y "negro", por lo tanto, tal resultado . <br><br>  Por lo tanto, pasaremos al espacio de color LAB y realizaremos investigaciones all√≠. <br><table><tbody><tr><th>  Funci√≥n de activaci√≥n </th><th>  Tarea multicabel </th><th>  ROC AUC </th></tr><tr><td>  softmax </td><td>  - </td><td>  0.915 </td></tr><tr><td>  sigmoide </td><td>  ‚úì </td><td>  0.846 </td></tr></tbody></table>  <i>Tabla de resultados de reconocimiento de color de m√°quina en el problema de clase 810</i> <br><br>  El resultado es menor, lo cual es l√≥gico, ya que el n√∫mero de clases ha aumentado en dos √≥rdenes de magnitud.  Tomando el resultado sigmoideo como punto de partida, intentamos mejorar nuestro modelo. <br><br><h2>  <font color="#0071c5">LAB: experimentos con diferentes pesos</font> </h2><br>  Antes de esto, todos los experimentos se realizaron con pesos unitarios en la funci√≥n de <i>p√©rdida</i> ( <i>p√©rdida</i> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ox/u5/af/oxu5afajo-qngyg1t6tdml1sdxo.png" alt="imagen"></div><br><br>  Aqu√≠ GT es verdad fundamental, W es pesas. <br><br>  Puede ingresar una <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">distancia en el</a> espacio de color LAB.  Digamos que tenemos una unidad en GT.  Entonces corresponde a alg√∫n paralelep√≠pedo rectangular en el espacio de color LAB.  Este paralelep√≠pedo (m√°s precisamente, su centro) se elimina a una distancia diferente de todos los dem√°s paralelep√≠pedos (nuevamente, sus centros).  Dependiendo de esta distancia, puede experimentar con las siguientes escalas: <br><br>  a) Cero en lugar de una unidad en GT, y al alejarse de √©l, un aumento en los pesos; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/in/ql/zsinql6ut3hucnr3ytrvkc0xxqi.png" alt="imagen"></div><br><br>  b) Por el contrario, en lugar de una unidad en GT, es uno; cuando se retira, es una ca√≠da de peso; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8v/-l/oo/8v-looj6mqsgrtzvz9elevykcak.png" alt="imagen"></div><br><br>  c) Opci√≥n a) m√°s un peque√±o aditivo gaussiano con una amplitud de ¬Ω en lugar de una unidad en GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yx/qy/ac/yxqyac6ks3cvy10qh6lilp4ib0q.png" alt="imagen"></div><br><br>  d) Opci√≥n a) m√°s un peque√±o aditivo gaussiano con una amplitud de 1 en lugar de una unidad en GT; <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ep/0s/01/ep0s01rau7n0oiak71zjkp5vhxg.png" alt="imagen"></div><br><br>  e) Opci√≥n b) con un peque√±o aditivo a la m√°xima distancia de la unidad en GT. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ff/9q/ft/ff9qftnoidusfhdhz1p9jjoqwi0.png" alt="imagen"></div><br><br>  La √∫ltima versi√≥n de las escalas con las que realizamos experimentos es, como la llamamos, triple Gauss, es decir, tres distribuciones normales con centros en lugar de unidades en el GT, as√≠ como a la mayor distancia de ellos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/qk/jr/kb/qkjrkbhyxschjibmya3xt3hik9y.png" alt="imagen"></div><br>  <i>Tres distribuciones normales centradas en las unidades en el GT y a la mayor distancia de ellas</i> <br><br>  Tendr√° que explicarse con m√°s detalle.  Puede seleccionar los dos paralelep√≠pedos m√°s distantes y, por lo tanto, las clases, y compararlos en la lejan√≠a del original.  Para la clase correspondiente a la lejana, la amplitud de distribuci√≥n se establece igual a 0,8, y para la segunda es m veces menor, donde m es la relaci√≥n de la distancia desde la fuente al remoto lejano a la distancia entre la fuente y la cercana. <br><br>  Los resultados se muestran en la tabla.  Debido al hecho de que en la escala de la opci√≥n a) hab√≠a cero pesos, solo para las unidades en GT, el resultado en ellas result√≥ incluso peor que el punto de partida, ya que la red no tuvo en cuenta las definiciones de color exitosas, aprendiendo peor.  Las variantes de los pesos b) ye) pr√°cticamente coincidieron, por lo tanto, el resultado en ellas coincidi√≥.  El mayor incremento en puntos porcentuales en comparaci√≥n con el resultado inicial se mostr√≥ por la variante de pesos f) - triple gauss. <br><table><tbody><tr><th>  Funci√≥n de activaci√≥n </th><th>  Numero de clases </th><th>  Tipo de pesos </th><th>  ROC AUC </th></tr><tr><td rowspan="5">  sigmoide </td><td rowspan="5">  810 </td><td>  a) </td><td>  0.844 </td></tr><tr><td>  b), e) </td><td>  0.848 </td></tr><tr><td>  c) </td><td>  0,888 </td></tr><tr><td>  d) </td><td>  0.879 </td></tr><tr><td>  f) </td><td>  0,909 </td></tr></tbody></table>  <i>Resultados de reconocimiento de color de m√°quinas con problemas de clase 810 con diferentes opciones de peso</i> <br><br><h2>  <font color="#0071c5">LAB: experimentando con nuevas etiquetas</font> </h2><br>  Entonces, realizamos experimentos con diferentes pesos en <i>p√©rdida</i> .  Luego decidimos intentar dejar los pesos como uno solo, y cambiar las etiquetas, que se transfieren a la funci√≥n de p√©rdida y se utilizan para optimizar la red.  Si antes de eso las etiquetas coincid√≠an con GT, ahora decidieron usar nuevamente distribuciones gaussianas con centros en el lugar de las unidades en GT: <br><br>  La motivaci√≥n para esta decisi√≥n es la siguiente.  El hecho es que con las etiquetas ordinarias todos los autom√≥viles en los conjuntos de datos se dividen en un n√∫mero fijo de clases, menos de 810, por lo que la red aprende a determinar el color de los autom√≥viles de solo estas clases.  Con nuevas etiquetas, los valores distintos de cero caen en todas las clases, y podemos esperar un aumento en la precisi√≥n para determinar el color del autom√≥vil.  Experimentamos con dos sigma (desviaciones est√°ndar) para las distribuciones gaussianas anteriores: 41.9 y 20.9.  Por qu√©  La primera sigma se elige de la siguiente manera: se toma la distancia m√≠nima entre clases (28) y la sigma se determina a partir de la condici√≥n de que la distribuci√≥n disminuye dos veces en la clase adyacente al GT'nom.  Y la segunda sigma es solo dos veces m√°s peque√±a que la primera. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jk/z4/xq/jkz4xqdkl-nwecfnttwzuhwgyuo.png" alt="imagen"></div><br>  <i>Distribuci√≥n de conjuntos de datos de entrenamiento de autom√≥viles por clases con diferentes etiquetas en p√©rdida</i> <br><br>  De hecho, fue posible mejorar a√∫n m√°s el resultado utilizando dicho truco, como se muestra en la tabla.  Como resultado, la precisi√≥n de la determinaci√≥n alcanz√≥ 0.955. <br><table><tbody><tr><th>  Funci√≥n de activaci√≥n </th><th>  Numero de clases </th><th>  Tipo de etiqueta </th><th>  Tipo de pesos </th><th>  ROC AUC </th></tr><tr><td rowspan="4">  sigmoide </td><td rowspan="4">  810 </td><td>  de costumbre </td><td>  unos </td><td>  0.846 </td></tr><tr><td>  de costumbre </td><td>  tres gauss </td><td>  0,909 </td></tr><tr><td>  nuevo, œÉ <sub>1</sub> </td><td rowspan="2">  tres gauss </td><td>  0.955 </td></tr><tr><td>  nuevo, œÉ <sub>2</sub> </td><td>  0.946 </td></tr></tbody></table>  <i>Resultados de reconocimiento de color para m√°quinas en el problema de la clase 810: con etiquetas ordinarias y pesos unitarios, con etiquetas y pesos ordinarios en forma de triple Gauss, con nuevas etiquetas y pesos unitarios</i> <br><br><h2>  <font color="#0071c5">LABORATORIO: 81</font> </h2><br>  Si hablamos de experimentos fallidos, debemos mencionar el intento de entrenar una red con 81 clases y un par√°metro constante L. Notamos durante experimentos anteriores que el brillo est√° determinado por la red con bastante precisi√≥n, y decidimos entrenar solo los par√°metros ayb (entonces llamado las otras dos coordenadas en LAB).  Desafortunadamente, a pesar del hecho de que la red pudo entrenar perfectamente en el avi√≥n, mostrando un mayor valor en t√©rminos de m√©trica, la idea de establecer el par√°metro L en la salida de la red como promedio para el <i>cuadro delimitador</i> del <i>autom√≥vil se</i> estrell√≥ y el color real y, por lo tanto, definidos fueron muy diferentes. <br><br><h2>  <font color="#0071c5">Comparaci√≥n con la resoluci√≥n de un problema sin usar redes neuronales</font> </h2><br>  Ahora volvamos al principio y comparemos lo que nos pas√≥ con el reconocimiento del color del autom√≥vil sin el uso de redes neuronales. <br>  Los resultados se muestran en las siguientes figuras.  Se puede ver que el pico se ha vuelto 3 veces m√°s, y la cantidad de autos con un gran error entre el verdadero y un cierto color ha disminuido significativamente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l-/ir/o0/l-iro02-06n4ugotazhlmumisii.png" alt="imagen"></div><br>  <i>La distribuci√≥n de la proporci√≥n de autom√≥viles con el valor de error L2 en el espacio LAB entre el cuadro delimitador del color definido como la mediana y el color del cuadro delimitador del valor del error</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6j/wr/b5/6jwrb5imhzh2rbvnaxrgzedf0p8.png" alt="imagen"></div><br>  <i>Distribuci√≥n de la proporci√≥n de autom√≥viles con el valor de error L2 en el espacio LAB entre el color en la salida de la red neuronal y el color del cuadro delimitador del autom√≥vil del valor de este error</i> <br><br><h2>  <font color="#0071c5">Ejemplos</font> </h2><br>  Los siguientes son ejemplos de reconocimiento de color de autom√≥viles.  La primera es que la m√°quina negra (un caso t√≠pico) se reconoce como negra, y la distancia en el espacio LAB entre el color verdadero y el espec√≠fico (18.16) es menor que la distancia m√≠nima entre las clases (28).  En la segunda figura, la red no solo pudo determinar que el autom√≥vil estaba iluminado (hay una alta probabilidad que corresponde a una de las clases de colores blancos), sino tambi√©n su color real (plata).  Sin embargo, la m√°quina de la siguiente figura, tambi√©n iluminada, no fue detectada por la red como roja.  La red no pudo determinar el color del autom√≥vil que se muestra en la figura a continuaci√≥n, que se deduce del hecho de que las probabilidades para todos los colores son demasiado peque√±as. <br><br>  En muchos sentidos, la tarea se debi√≥ a la necesidad de reconocer los autom√≥viles multicolores.  La √∫ltima figura representa un autom√≥vil negro y amarillo de dos tonos.  Es muy probable que la red reconozca el color negro, lo que probablemente se deba al predominio de m√°quinas de este y otros colores similares en el conjunto de datos de entrenamiento, y el color amarillo, que es casi verdadero, entr√≥ en el top 3. <br><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/ro/l7/re/rol7re300p2hf30rtsvaiyfbi20.png" align="right" alt="imagen"></th><th><img src="https://habrastorage.org/webt/n8/ig/cl/n8igclilt4ep3qlmipvt9rmbt5w.png" align="left" alt="imagen"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/o5/pf/fj/o5pffjzvnat7mouv8yhf-kuzs3g.png" align="right" alt="imagen"></th><th><img src="https://habrastorage.org/webt/vn/ml/wa/vnmlwawbhys7tkvrwquwc6bttsw.png" align="left" alt="imagen"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/jh/mi/hs/jhmihs9rnoqounq2ostwq8iz1q0.png" align="right" alt="imagen"></th><th><img src="https://habrastorage.org/webt/pv/sg/ft/pvsgftesuo5lmmy_gvuzsj-rg4o.png" align="left" alt="imagen"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/f7/uj/p3/f7ujp3uavgqz6aobfa_hbk6xpos.png" align="right" alt="imagen"></th><th><img src="https://habrastorage.org/webt/0c/mo/l1/0cmol16qj3ghtsc49jqag2dy8yc.png" align="left" alt="imagen"></th></tr></tbody></table><table><tbody><tr><th width="200"><img src="https://habrastorage.org/webt/dd/hi/th/ddhithwwjdez_q6sr8xa9cwcs-i.png" align="right" alt="imagen"></th><th><img src="https://habrastorage.org/webt/gg/hf/px/gghfpxgurqddwvldmop4t1zszfo.png" align="left" alt="imagen"></th></tr></tbody></table><br><h2>  <font color="#0071c5">Curva ROC: visualizaci√≥n y problemas.</font> </h2><br>  Entonces, en la salida obtuvimos un resultado m√©trico bastante alto.  La siguiente figura muestra curvas ROC para resolver un problema con 8 clases, y para un problema con 810 clases, as√≠ como soluciones sin usar redes neuronales.  Se puede ver que el resultado es ligeramente diferente al que se escribi√≥ anteriormente.  Los resultados anteriores se obtuvieron usando TensorFlow, los gr√°ficos a continuaci√≥n se obtuvieron usando el paquete scikit-learn. <br><table><tbody><tr><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/yq/zm/ib/yqzmib4v_0jaco5torqqvu0fdmo.png" alt="imagen"></div></th><th><div style="text-align:center;"><img src="https://habrastorage.org/webt/k0/nb/gn/k0nbgn7ows7rcx-q3so38ugg_dw.png" alt="imagen"></div></th></tr></tbody></table>  <i>Curva ROC para varias opciones para resolver el problema.</i>  <i>A la derecha est√° la esquina superior izquierda del gr√°fico izquierdo</i> <br><br>  Puede tomar cualquier n√∫mero fijo como valores de umbral (por ejemplo, Tensorflow, cuando establece el par√°metro correspondiente en 50, toma el mismo n√∫mero de umbrales de 0 a 1 a intervalos iguales), puede usar los valores en la salida de la red, o puede limitarlos desde la parte inferior para no tener en cuenta valores del orden de 10 <sup>-4</sup> , por ejemplo.  El resultado de este √∫ltimo enfoque se muestra en la siguiente figura. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fb/2c/b2/fb2cb2dxnaxvjjtywmlbdb-xs54.png" alt="imagen"></div><br>  <i>Curva ROC para varias opciones para resolver el problema con un umbral de 10 <sup>-4</sup></i> <br><br>  Se puede ver que todas las curvas correspondientes a la soluci√≥n del problema utilizando redes neuronales son caracter√≠sticamente mejores (m√°s altas) que la soluci√≥n del problema sin ellas, pero no se puede elegir la mejor curva entre las primeras.  Seg√∫n el umbral que elija el usuario, las diferentes curvas corresponder√°n a las diferentes soluciones √≥ptimas para el problema.  Por lo tanto, por un lado, encontramos un enfoque que nos permite determinar con precisi√≥n el color de la m√°quina y muestra una m√©trica alta, por otro lado, hemos demostrado que el l√≠mite a√∫n no se ha alcanzado y la m√©trica del √°rea bajo la curva ROC tiene sus inconvenientes. <br><br>  Listo para responder preguntas y escuchar comentarios en los comentarios. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es422689/">https://habr.com/ru/post/es422689/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es422679/index.html">Problemas imaginarios: la raz√≥n del mal software</a></li>
<li><a href="../es422681/index.html">Integraci√≥n de SAP y Python o c√≥mo tomar datos de SAP m√°s f√°cilmente</a></li>
<li><a href="../es422683/index.html">En los EE. UU., Dos comerciantes establecieron una empresa de corretaje falso para robar dinero de inversores novatos</a></li>
<li><a href="../es422685/index.html">Reloj inteligente Samsung Galaxy Watch: actualizaci√≥n de Android Wear OS a Tizen OS - experiencia personal</a></li>
<li><a href="../es422687/index.html">Mensajeros en peligro</a></li>
<li><a href="../es422691/index.html">La c√°mara h√≠brida y el LIDAR mejoran las capacidades de los robom√≥viles, complementando la informaci√≥n sobre el mundo exterior.</a></li>
<li><a href="../es422693/index.html">Equipo de complementos para configurar componentes JavaFX en una aplicaci√≥n de escritorio</a></li>
<li><a href="../es422697/index.html">Webpack 4 y dividiendo el archivo de configuraci√≥n en m√≥dulos</a></li>
<li><a href="../es422699/index.html">Una escapatoria cerrada confirma la irrealidad del mundo cu√°ntico</a></li>
<li><a href="../es422701/index.html">Deep Learning y OpenVINO Toolkit. Haga una pregunta a un experto de Intel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>