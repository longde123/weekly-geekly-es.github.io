<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¦ƒ ğŸ‘©ğŸ¼â€ğŸ’¼ ğŸ‘©ğŸ¾â€ğŸ’¼ å¤šè‡‚å¼ºç›—é—®é¢˜-æ¯”è¾ƒEpsilon-Greedyç­–ç•¥å’ŒThompsonæŠ½æ · ğŸ¤· â” ğŸ‚ğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHaï¼ æˆ‘å‘æ‚¨ä»‹ç»äº†è§£å†³å¤šè‡‚åŒªå¾’çš„é¦–é¡µï¼šepsilon-greedyå’ŒThompsonæŠ½æ ·çš„æ¯”è¾ƒ ã€‚ 

 å¤šè‡‚åŒªå¾’é—®é¢˜ 


 å¤šè‡‚åŒªå¾’é—®é¢˜æ˜¯è§£å†³æ–¹æ¡ˆç§‘å­¦ä¸­æœ€åŸºæœ¬çš„ä»»åŠ¡ä¹‹ä¸€ã€‚ å³ï¼Œè¿™æ˜¯åœ¨ä¸ç¡®å®šæ¡ä»¶ä¸‹èµ„æºçš„æœ€ä½³åˆ†é…çš„é—®é¢˜ã€‚ â€œå¤šè‡‚åŒªâ€è¿™ä¸ªåç§°æœ¬èº«æ¥è‡ªç”±æ‰‹æŸ„æ§åˆ¶çš„æ—§è€è™æœºã€‚ è¿™äº›çªå‡»æ­¥æªè¢«æ˜µç§°ä¸ºâ€œåœŸ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å¤šè‡‚å¼ºç›—é—®é¢˜-æ¯”è¾ƒEpsilon-Greedyç­–ç•¥å’ŒThompsonæŠ½æ ·</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425619/">  <i>å“ˆHaï¼</i>  <i>æˆ‘å‘æ‚¨ä»‹ç»äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è§£å†³å¤šè‡‚åŒªå¾’çš„é¦–é¡µï¼šepsilon-greedyå’ŒThompsonæŠ½æ ·çš„æ¯”è¾ƒ</a> ã€‚</i> <br><br><h1> å¤šè‡‚åŒªå¾’é—®é¢˜ </h1><br><p> å¤šè‡‚åŒªå¾’é—®é¢˜æ˜¯è§£å†³æ–¹æ¡ˆç§‘å­¦ä¸­æœ€åŸºæœ¬çš„ä»»åŠ¡ä¹‹ä¸€ã€‚ å³ï¼Œè¿™æ˜¯åœ¨ä¸ç¡®å®šæ¡ä»¶ä¸‹èµ„æºçš„æœ€ä½³åˆ†é…çš„é—®é¢˜ã€‚  â€œå¤šè‡‚åŒªâ€è¿™ä¸ªåç§°æœ¬èº«æ¥è‡ªç”±æ‰‹æŸ„æ§åˆ¶çš„æ—§è€è™æœºã€‚ è¿™äº›çªå‡»æ­¥æªè¢«æ˜µç§°ä¸ºâ€œåœŸåŒªâ€ï¼Œå› ä¸ºä¸ä»–ä»¬äº¤è°ˆåï¼Œäººä»¬é€šå¸¸ä¼šæ„Ÿåˆ°è¢«æŠ¢ã€‚ ç°åœ¨æƒ³è±¡ä¸€ä¸‹ï¼Œæœ‰å‡ å°è¿™æ ·çš„æœºå™¨ï¼Œè€Œä¸å…¶ä»–æ±½è½¦å¯¹æŠ—çš„æœºä¼šä¹Ÿä¸åŒã€‚ è‡ªä»æˆ‘ä»¬å¼€å§‹ä½¿ç”¨è¿™äº›æœºå™¨ä»¥æ¥ï¼Œæˆ‘ä»¬æƒ³ç¡®å®šå“ªä¸ªæœºä¼šæ›´é«˜ï¼Œå¹¶ä¸”æ¯”å…¶ä»–æœºå™¨æ›´é¢‘ç¹åœ°ä½¿ç”¨è¯¥æœºå™¨ã€‚ </p><br><p> é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬å¦‚ä½•æœ€æœ‰æ•ˆåœ°äº†è§£å“ªå°æœºå™¨æœ€é€‚åˆï¼ŒåŒæ—¶å®æ—¶å°è¯•è®¸å¤šåŠŸèƒ½ï¼Ÿ è¿™ä¸æ˜¯æŸç§ç†è®ºä¸Šçš„é—®é¢˜ï¼Œè€Œæ˜¯ä¼ä¸šä¸€ç›´é¢ä¸´çš„é—®é¢˜ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºéœ€è¦å‘ç”¨æˆ·æ˜¾ç¤ºçš„æ¶ˆæ¯ï¼Œå…¬å¸æœ‰å‡ ä¸ªé€‰é¡¹ï¼ˆä¾‹å¦‚ï¼Œæ¶ˆæ¯åŒ…æ‹¬å¹¿å‘Šï¼Œç½‘ç«™ï¼Œå›¾åƒï¼‰ï¼Œä»¥ä¾¿æ‰€é€‰æ¶ˆæ¯æœ€å¤§åŒ–ç‰¹å®šä¸šåŠ¡ä»»åŠ¡ï¼ˆè½¬æ¢ï¼Œå¯ç‚¹å‡»æ€§ç­‰ï¼‰ã€‚ </p><br><a name="habracut"></a><p> è§£å†³æ­¤é—®é¢˜çš„ä¸€ç§å…¸å‹æ–¹æ³•æ˜¯å¤šæ¬¡è¿è¡Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">A / Bæµ‹è¯•</a> ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼ŒèŠ±å‡ ä¸ªæ˜ŸæœŸæ¥å¹³å‡æ˜¾ç¤ºæ¯ä¸ªé€‰é¡¹ï¼Œç„¶åæ ¹æ®ç»Ÿè®¡æµ‹è¯•ç¡®å®šå“ªä¸ªé€‰é¡¹æ›´å¥½ã€‚ æ­¤æ–¹æ³•é€‚ç”¨äºå¾ˆå°‘çš„é€‰é¡¹ï¼ˆä¾‹å¦‚2æˆ–4ï¼‰ã€‚ä½†æ˜¯ï¼Œå½“é€‰é¡¹å¾ˆå¤šæ—¶ï¼Œæ­¤æ–¹æ³•å°†å˜å¾—æ— æ•ˆ-æ—¢æµªè´¹æ—¶é—´ï¼ŒåˆæŸå¤±åˆ©æ¶¦ã€‚ </p><br><p> æµªè´¹æ—¶é—´çš„æ¥æºåº”è¯¥å¾ˆå®¹æ˜“ç†è§£ã€‚ æ›´å¤šé€‰é¡¹-éœ€è¦æ›´å¤šçš„A / Bæµ‹è¯•-éœ€è¦æ›´å¤šæ—¶é—´æ¥åšå‡ºå†³å®šã€‚ åˆ©æ¶¦æŸå¤±çš„å‘ç”Ÿå¹¶ä¸é‚£ä¹ˆæ˜æ˜¾ã€‚ æœºä¼šæŸå¤±ï¼ˆæœºä¼šæˆæœ¬ï¼‰-ä¸æˆ‘ä»¬æ‰§è¡Œä¸€é¡¹è¡ŒåŠ¨è€Œä¸æ˜¯æ‰§è¡Œå¦ä¸€é¡¹è¡ŒåŠ¨ï¼ˆå³ç®€å•è€Œè¨€ï¼‰æœ‰å…³çš„æˆæœ¬ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æŠ•èµ„Aè€Œä¸æ˜¯æŠ•èµ„Bæ‰€æŸå¤±çš„ã€‚æŠ•èµ„Bæ˜¯æŠ•èµ„æŸå¤±çš„åˆ©æ¶¦åœ¨Aä¸­ã€‚ä¸é€‰é¡¹æ£€æŸ¥ç›¸åŒã€‚ åœ¨å®ŒæˆA / Bæµ‹è¯•ä¹‹å‰ï¼Œè¯·å‹¿ä¸­æ–­å®ƒä»¬ã€‚ è¿™æ„å‘³ç€åœ¨æµ‹è¯•ç»“æŸä¹‹å‰ï¼Œå®éªŒè€…ä¸çŸ¥é“å“ªä¸ªé€‰é¡¹æ›´å¥½ã€‚ ä½†æ˜¯ï¼Œä»ç„¶ç›¸ä¿¡ä¸€ç§é€‰æ‹©ä¼šæ¯”å¦ä¸€ç§æ›´å¥½ã€‚ è¿™æ„å‘³ç€ï¼Œé€šè¿‡å»¶é•¿A / Bæµ‹è¯•ï¼Œæˆ‘ä»¬ä¸ä¼šä¸ºè¶³å¤Ÿå¤šçš„è®¿å®¢æ˜¾ç¤ºæœ€ä½³é€‰æ‹©ï¼ˆå°½ç®¡æˆ‘ä»¬ä¸çŸ¥é“å“ªä¸ªé€‰æ‹©ä¸æ˜¯æœ€ä½³é€‰æ‹©ï¼‰ï¼Œä»è€ŒæŸå¤±äº†æˆ‘ä»¬çš„åˆ©æ¶¦ã€‚ è¿™æ˜¯A / Bæµ‹è¯•å¤±å»çš„å¥½å¤„ã€‚ å¦‚æœåªæœ‰ä¸€ä¸ªA / Bæµ‹è¯•ï¼Œé‚£ä¹ˆæŸå¤±çš„åˆ©æ¶¦å¯èƒ½æ ¹æœ¬å°±ä¸ç®—å¤§ã€‚ å¤§é‡çš„A / Bæµ‹è¯•æ„å‘³ç€é•¿æœŸä»¥æ¥ï¼Œæˆ‘ä»¬ä¸å¾—ä¸å‘å®¢æˆ·å±•ç¤ºå¾ˆå¤šå¹¶éæœ€ä½³é€‰æ‹©ã€‚ å¦‚æœæ‚¨å¯ä»¥å®æ—¶åœ°å¿«é€Ÿä¸¢å¼ƒä¸è‰¯é€‰é¡¹ï¼Œé‚£å°±æ›´å¥½äº†ï¼Œåªæœ‰è¿™æ ·ï¼Œå½“å‰©ä¸‹çš„é€‰é¡¹å¾ˆå°‘æ—¶ï¼Œæ‰å¯¹å®ƒä»¬ä½¿ç”¨A / Bæµ‹è¯•ã€‚ </p><br><p> é‡‡æ ·å™¨æˆ–ä»£ç†æ˜¯å¿«é€Ÿæµ‹è¯•å’Œä¼˜åŒ–é€‰é¡¹åˆ†é…çš„æ–¹æ³•ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å‘æ‚¨ä»‹ç»<i>æ±¤æ™®æ£®é‡‡æ ·</i>åŠå…¶å±æ€§ã€‚ æˆ‘è¿˜å°†æ±¤æ™®æ£®é‡‡æ ·ä¸epsilon-greedyç®—æ³•è¿›è¡Œæ¯”è¾ƒï¼Œepsilon-greedyç®—æ³•æ˜¯å¤šè‡‚åŒªå¾’é—®é¢˜çš„å¦ä¸€ç§æµè¡Œé€‰æ‹©ã€‚ ä¸€åˆ‡éƒ½å°†ä»å¤´å¼€å§‹ç”¨Pythonå®ç°-æ‰€æœ‰ä»£ç éƒ½å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚ </p><br><h2> ç®€è¦æ¦‚å¿µè¯å…¸ </h2><br><p></p><ul><li> ä»£ç†ï¼Œé‡‡æ ·å™¨ï¼ŒåŒªå¾’ï¼ˆ <i>ä»£ç†ï¼Œé‡‡æ ·å™¨ï¼ŒåŒªå¾’</i> ï¼‰-ä¸€ç§ç®—æ³•ï¼Œç”¨äºå†³å®šè¦æ˜¾ç¤ºçš„é€‰é¡¹ã€‚ </li><li> å˜ä½“-è®¿é—®è€…çœ‹åˆ°çš„æ¶ˆæ¯çš„å¦ä¸€ç§å˜ä½“ã€‚ </li><li> åŠ¨ä½œ-ç®—æ³•é€‰æ‹©çš„åŠ¨ä½œï¼ˆæ˜¾ç¤ºå“ªä¸ªé€‰é¡¹ï¼‰ã€‚ </li><li> ä½¿ç”¨ï¼ˆ <i>åˆ©ç”¨</i> ï¼‰-æ ¹æ®å¯ç”¨æ•°æ®åšå‡ºé€‰æ‹©ä»¥ä½¿æ€»å¥–åŠ±æœ€å¤§åŒ–ã€‚ </li><li> æ¢ç´¢ï¼Œ <i>æ¢ç´¢</i> -åšå‡ºé€‰æ‹©ä»¥æ›´å¥½åœ°äº†è§£æ¯ä¸ªé€‰é¡¹çš„å›æŠ¥ã€‚ </li><li> å¥–åŠ±ï¼Œç§¯åˆ†ï¼ˆ <i>åˆ†æ•°ï¼Œå¥–åŠ±</i> ï¼‰-ä¸šåŠ¡ä»»åŠ¡ï¼Œä¾‹å¦‚è½¬æ¢æˆ–å¯ç‚¹å‡»æ€§ã€‚ ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒæ˜¯äºŒé¡¹åˆ†å¸ƒçš„ï¼Œå¹¶ä¸”ç­‰äº1æˆ–0-å•å‡»æˆ–ä¸å•å‡»ã€‚ </li><li> ç¯å¢ƒ-ä»£ç†è¿è¡Œçš„ä¸Šä¸‹æ–‡-é€‰é¡¹å’Œå¯¹ç”¨æˆ·éšè—çš„â€œå›æŠ¥â€ã€‚ </li><li> æŠ•èµ„å›æŠ¥ç‡ï¼ŒæˆåŠŸæ¦‚ç‡ï¼ˆå›æŠ¥<i>ç‡</i> ï¼‰-ä¸€ä¸ªéšè—å˜é‡ï¼Œç­‰äºè·å¾—åˆ†æ•°çš„æ¦‚ç‡= 1ï¼Œå¯¹äºæ¯ä¸ªé€‰é¡¹æ¥è¯´ï¼Œå®ƒéƒ½æ˜¯ä¸åŒçš„ã€‚ ä½†æ˜¯ç”¨æˆ·çœ‹ä¸åˆ°å¥¹ã€‚ </li><li> å°è¯•ï¼ˆ <i>è¯•ç”¨</i> ï¼‰-ç”¨æˆ·è®¿é—®é¡µé¢ã€‚ </li><li> åæ‚”æ˜¯æ‰€æœ‰å¯ç”¨é€‰é¡¹çš„æœ€ä½³ç»“æœä¸å½“å‰å°è¯•ä¸­å¯ç”¨é€‰é¡¹çš„ç»“æœä¹‹é—´çš„åŒºåˆ«ã€‚ å¯¹å·²ç»é‡‡å–çš„è¡ŒåŠ¨æ„Ÿåˆ°åæ‚”çš„æ¬¡æ•°è¶Šå°‘è¶Šå¥½ã€‚ </li><li> è®¯æ¯ï¼ˆ <i>message</i> ï¼‰-æ¨ªå¹…ï¼Œé¡µé¢é€‰é¡¹ä»¥åŠå…¶ä»–æˆ‘ä»¬æƒ³è¦å°è¯•çš„ä¸åŒç‰ˆæœ¬ã€‚ </li><li> é‡‡æ ·-æ ¹æ®ç»™å®šåˆ†å¸ƒç”Ÿæˆæ ·æœ¬ã€‚ </li></ul><br><h2> æ¢ç´¢å’Œåˆ©ç”¨ </h2><br><p> ä»£ç†æ˜¯å¯»æ±‚å®æ—¶å†³ç­–æ–¹æ³•çš„ç®—æ³•ï¼Œç›®çš„æ˜¯åœ¨æ¢ç´¢é€‰æ‹©ç©ºé—´ä¸ä½¿ç”¨æœ€ä½³é€‰æ‹©ä¹‹é—´å–å¾—å¹³è¡¡ã€‚ è¿™ç§å¹³è¡¡éå¸¸é‡è¦ã€‚ å¿…é¡»è°ƒæŸ¥é€‰é¡¹çš„ç©ºé—´ï¼Œä»¥äº†è§£å“ªä¸ªé€‰é¡¹æ˜¯æœ€ä½³çš„ã€‚ å¦‚æœæˆ‘ä»¬é¦–å…ˆå‘ç°äº†è¿™ä¸ªæœ€ä½³é€‰æ‹©ï¼Œç„¶åä¸€ç›´ä½¿ç”¨å®ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†ä½¿ç¯å¢ƒä¸­å¯è·å¾—çš„æ€»å›æŠ¥æœ€å¤§åŒ–ã€‚ å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬ä¹Ÿæƒ³æ¢ç´¢å…¶ä»–å¯èƒ½çš„é€‰æ‹©-å¦‚æœå°†æ¥å®ƒä»¬ä¼šå˜å¾—æ›´å¥½ï¼Œé‚£åˆä¼šæ€æ ·å‘¢ï¼Œä½†æˆ‘ä»¬è¿˜ä¸çŸ¥é“å‘¢ï¼Ÿ æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›é¿å…å¯èƒ½çš„æŸå¤±ï¼Œå°è¯•å°è¯•ä¸€äº›æ¬¡ä¼˜çš„é€‰æ‹©ï¼Œä»¥ä¾¿è‡ªå·±å¼„æ¸…å…¶å›æŠ¥ã€‚ å¦‚æœä»–ä»¬çš„å›æŠ¥å®é™…ä¸Šæ›´é«˜ï¼Œåˆ™å¯ä»¥æ›´é¢‘ç¹åœ°å±•ç¤ºå®ƒä»¬ã€‚ æ¢ç´¢æ–¹æ¡ˆçš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬ä¸ä»…å¯ä»¥æ›´å¥½åœ°ç†è§£å¹³å‡æŠ•èµ„å›æŠ¥ç‡ï¼Œè€Œä¸”å¯ä»¥æ›´å¥½åœ°ç†è§£æŠ•èµ„å›æŠ¥ç‡çš„åˆ†å¸ƒèŒƒå›´ï¼Œå³å¯ä»¥æ›´å¥½åœ°ä¼°ç®—ä¸ç¡®å®šæ€§ã€‚ <br> å› æ­¤ï¼Œä¸»è¦é—®é¢˜æ˜¯è¦è§£å†³-è§£å†³å‹˜æ¢ä¸å¼€å‘ï¼ˆæ¢ç´¢ä¸å¼€å‘æƒè¡¡ï¼‰ä¹‹é—´çš„éš¾é¢˜çš„æœ€ä½³æ–¹æ³•æ˜¯ä»€ä¹ˆã€‚ </p><br><h2>  Epsilon-è´ªå©ªç®—æ³• </h2><br><p> è§£å†³è¿™ä¸ªéš¾é¢˜çš„å…¸å‹æ–¹æ³•æ˜¯epsilon-greedyç®—æ³•ã€‚  â€œè´ªå©ªâ€æ˜¯æŒ‡æ‚¨çš„æƒ³æ³•ã€‚ ç»è¿‡ä¸€æ®µåˆå§‹æ—¶é—´åï¼Œå½“æˆ‘ä»¬æ„å¤–è¿›è¡Œå°è¯•ï¼ˆä¾‹å¦‚ï¼Œå°è¯•1000æ¬¡ï¼‰æ—¶ï¼Œè¯¥ç®—æ³•ä¼šæ€¥äºé€‰æ‹©<i>e</i> ï¼…çš„å°è¯•æ¥é€‰æ‹©æœ€ä½³é€‰é¡¹kã€‚ ä¾‹å¦‚ï¼Œå¦‚æœ<i>e</i> = 0.05ï¼Œåˆ™ç®—æ³•åœ¨95ï¼…çš„æ—¶é—´å†…é€‰æ‹©æœ€ä½³é€‰é¡¹ï¼Œè€Œåœ¨å…¶ä½™5ï¼…çš„æ—¶é—´å†…é€‰æ‹©éšæœºå°è¯•ã€‚ å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“æœ‰æ•ˆçš„ç®—æ³•ï¼Œä½†æ˜¯ï¼Œå®ƒå¯èƒ½ä¸è¶³ä»¥æ¢ç´¢æœŸæƒçš„ç©ºé—´ï¼Œå› æ­¤ï¼Œè¯„ä¼°å“ªä¸ªæœŸæƒæ˜¯æœ€ä½³çš„ï¼Œå¡åœ¨æ¬¡ä¼˜æœŸæƒä¸Šæ˜¯ä¸å¤Ÿçš„ã€‚ è®©æˆ‘ä»¬åœ¨ä»£ç ä¸­å±•ç¤ºè¯¥ç®—æ³•çš„å·¥ä½œåŸç†ã€‚ </p><br><p> ä½†æ˜¯é¦–å…ˆï¼Œä¸€äº›ä¾èµ–æ€§ã€‚ æˆ‘ä»¬å¿…é¡»å®šä¹‰ç¯å¢ƒã€‚ è¿™æ˜¯ç®—æ³•å°†åœ¨å…¶ä¸­è¿è¡Œçš„ä¸Šä¸‹æ–‡ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸Šä¸‹æ–‡éå¸¸ç®€å•ã€‚ ä»–å‘¼å«ä»£ç†ï¼Œä»¥ä¾¿ä»£ç†å†³å®šé€‰æ‹©å“ªä¸ªæ“ä½œï¼Œç„¶åä¸Šä¸‹æ–‡å¯åŠ¨è¯¥æ“ä½œï¼Œå¹¶å°†ä¸ºè¯¥æ“ä½œæ”¶åˆ°çš„è¦ç‚¹è¿”å›ç»™ä»£ç†ï¼ˆåè€…ä»¥æŸç§æ–¹å¼æ›´æ–°äº†ä»–çš„çŠ¶æ€ï¼‰ã€‚ </p><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Environment</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, variants, payouts, n_trials, variance=False)</span></span></span><span class="hljs-function">:</span></span> self.variants = variants <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> variance: self.payouts = np.clip(payouts + np.random.normal(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.04</span></span>, size=len(variants)), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">.2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: self.payouts = payouts <span class="hljs-comment"><span class="hljs-comment">#self.payouts[5] = self.payouts[5] if i &lt; n_trials/2 else 0.1 self.n_trials = n_trials self.total_reward = 0 self.n_k = len(variants) self.shape = (self.n_k, n_trials) def run(self, agent): """Run the simulation with the agent. agent must be a class with choose_k and update methods.""" for i in range(self.n_trials): # agent makes a choice x_chosen = agent.choose_k() # Environment returns reward reward = np.random.binomial(1, p=self.payouts[x_chosen]) # agent learns of reward agent.reward = reward # agent updates parameters based on the data agent.update() self.total_reward += reward agent.collect_data() return self.total_reward</span></span></code> </pre> <br> æ ¹æ®åŠ¨ä½œçš„æ•°é‡ï¼Œç‚¹ä»¥æ¦‚ç‡pè¿›è¡ŒäºŒé¡¹åˆ†å¸ƒï¼ˆå°±åƒå®ƒä»¬å¯ä»¥è¿ç»­åˆ†å¸ƒä¸€æ ·ï¼Œæœ¬è´¨ä¸ä¼šæ”¹å˜ï¼‰ã€‚ æˆ‘è¿˜å°†å®šä¹‰BaseSamplerç±»-ä»…ç”¨äºå­˜å‚¨æ—¥å¿—å’Œå„ç§å±æ€§ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseSampler</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, env, n_samples=None, n_learning=None, e=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0.05</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> self.env = env self.shape = (env.n_k, n_samples) self.variants = env.variants self.n_trials = env.n_trials self.payouts = env.payouts self.ad_i = np.zeros(env.n_trials) self.r_i = np.zeros(env.n_trials) self.thetas = np.zeros(self.n_trials) self.regret_i = np.zeros(env.n_trials) self.thetaregret = np.zeros(self.n_trials) self.a = np.ones(env.n_k) self.b = np.ones(env.n_k) self.theta = np.zeros(env.n_k) self.data = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> self.reward = <span class="hljs-number"><span class="hljs-number">0</span></span> self.total_reward = <span class="hljs-number"><span class="hljs-number">0</span></span> self.k = <span class="hljs-number"><span class="hljs-number">0</span></span> self.i = <span class="hljs-number"><span class="hljs-number">0</span></span> self.n_samples = n_samples self.n_learning = n_learning self.e = e self.ep = np.random.uniform(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, size=env.n_trials) self.exploit = (<span class="hljs-number"><span class="hljs-number">1</span></span> - e) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">collect_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.data = pd.DataFrame(dict(ad=self.ad_i, reward=self.r_i, regret=self.regret_i))</code> </pre> <br> åœ¨ä¸‹é¢ï¼Œæˆ‘ä»¬å®šä¹‰10ä¸ªé€‰é¡¹å’Œæ¯ä¸ªé€‰é¡¹çš„å›æŠ¥ã€‚ æœ€å¥½çš„é€‰æ‹©æ˜¯é€‰é¡¹9ï¼ŒæŠ•èµ„å›æŠ¥ç‡ä¸º0.11ï¼…ã€‚ <br><br><pre> <code class="python hljs">variants = [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>] payouts = [<span class="hljs-number"><span class="hljs-number">0.023</span></span>, <span class="hljs-number"><span class="hljs-number">0.03</span></span>, <span class="hljs-number"><span class="hljs-number">0.029</span></span>, <span class="hljs-number"><span class="hljs-number">0.001</span></span>, <span class="hljs-number"><span class="hljs-number">0.05</span></span>, <span class="hljs-number"><span class="hljs-number">0.06</span></span>, <span class="hljs-number"><span class="hljs-number">0.0234</span></span>, <span class="hljs-number"><span class="hljs-number">0.035</span></span>, <span class="hljs-number"><span class="hljs-number">0.01</span></span>, <span class="hljs-number"><span class="hljs-number">0.11</span></span>]</code> </pre> <br> ä¸ºäº†å»ºç«‹åŸºç¡€ï¼Œæˆ‘ä»¬è¿˜å®šä¹‰äº†RandomSamplerç±»ã€‚ æ­¤ç±»éœ€è¦ä½œä¸ºåŸºçº¿æ¨¡å‹ã€‚ ä»–åªæ˜¯åœ¨æ¯æ¬¡å°è¯•æ—¶çº¯ç²¹éšæœºé€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼Œè€Œä¸ä¼šæ›´æ–°ä»–çš„å‚æ•°ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RandomSampler</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BaseSampler)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, env)</span></span></span><span class="hljs-function">:</span></span> super().__init__(env) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">choose_k</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.k = np.random.choice(self.variants) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.k <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># nothing to update #self.thetaregret[self.i] = self.thetaregret[self.i] #self.regret_i[self.i] = np.max(self.thetaregret) - self.theta[self.k] #self.thetas[self.i] = self.theta[self.k] self.thetaregret[self.i] = np.max(self.theta) - self.theta[self.k] self.a[self.k] += self.reward self.b[self.k] += 1 self.theta = self.a/self.b self.ad_i[self.i] = self.k self.r_i[self.i] = self.reward self.i += 1</span></span></code> </pre> <br><p> å…¶ä»–å‹å·å…·æœ‰ä»¥ä¸‹ç»“æ„ã€‚ éƒ½å…·æœ‰choose_kå’Œæ›´æ–°æ–¹æ³•ã€‚  choice_kå®ç°äº†ä»£ç†é€‰æ‹©é€‰é¡¹çš„æ–¹æ³•ã€‚  updateæ›´æ–°ä»£ç†çš„å‚æ•°-æ­¤æ–¹æ³•è¡¨å¾ä»£ç†é€‰æ‹©é€‰é¡¹çš„èƒ½åŠ›å¦‚ä½•å˜åŒ–ï¼ˆå¯¹äºRandomSamplerï¼Œæ­¤èƒ½åŠ›ä¸ä¼šä»¥ä»»ä½•æ–¹å¼æ”¹å˜ï¼‰ã€‚ æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹æ¨¡å¼åœ¨ç¯å¢ƒä¸­è¿è¡Œä»£ç†ã€‚ </p><br><pre> <code class="python hljs">en0 = Environment(machines, payouts, n_trials=<span class="hljs-number"><span class="hljs-number">10000</span></span>) rs = RandomSampler(env=en0) en0.run(agent=rs)</code> </pre> <br><p>  epsilon-greedyç®—æ³•çš„æœ¬è´¨å¦‚ä¸‹ã€‚ <br><br></p><ol><li> éšæœºé€‰æ‹©kæ¬¡å°è¯•næ¬¡ã€‚ </li><li> åœ¨æ¯æ¬¡å°è¯•ä¸­ï¼Œé’ˆå¯¹æ¯ä¸ªé€‰é¡¹ï¼Œè¯„ä¼°å½©é‡‘ã€‚ </li><li> ç»è¿‡næ¬¡å°è¯•ï¼š </li><li> ä»¥æ¦‚ç‡1- <i>e</i>é€‰æ‹©å¢ç›Šæœ€é«˜çš„kï¼› </li><li> ä»¥æ¦‚ç‡<i>e</i>éšæœºé€‰æ‹©Kã€‚ </li></ol><br>  Epsilon-è´ªå©ªä»£ç ï¼š <br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eGreedy</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BaseSampler)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, env, n_learning, e)</span></span></span><span class="hljs-function">:</span></span> super().__init__(env, n_learning, e) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">choose_k</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># e% of the time take a random draw from machines # random k for n learning trials, then the machine with highest theta self.k = np.random.choice(self.variants) if self.i &lt; self.n_learning else np.argmax(self.theta) # with 1 - e probability take a random sample (explore) otherwise exploit self.k = np.random.choice(self.variants) if self.ep[self.i] &gt; self.exploit else self.k return self.k # every 100 trials update the successes # update the count of successes for the chosen machine def update(self): # update the probability of payout for each machine self.a[self.k] += self.reward self.b[self.k] += 1 self.theta = self.a/self.b #self.total_reward += self.reward #self.regret_i[self.i] = np.max(self.theta) - self.theta[self.k] #self.thetaregret[self.i] = self.thetaregret[self.i] self.thetas[self.i] = self.theta[self.k] self.thetaregret[self.i] = np.max(self.thetas) - self.theta[self.k] self.ad_i[self.i] = self.k self.r_i[self.i] = self.reward self.i += 1</span></span></code> </pre> <br><br><p> åœ¨å›¾è¡¨çš„ä¸‹æ–¹ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°çº¯éšæœºæŠ½æ ·çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é‡Œæ²¡æœ‰æ¨¡å‹ã€‚ è¯¥å›¾æ˜¾ç¤ºäº†ç®—æ³•çš„æ¯æ¬¡é€‰æ‹©ï¼ˆå¦‚æœæœ‰1ä¸‡æ¬¡å°è¯•ï¼‰æ‰€åšå‡ºçš„é€‰æ‹©ã€‚ è¯¥ç®—æ³•ä»…å°è¯•ï¼Œä½†ä¸å­¦ä¹ ã€‚ ä»–æ€»å…±è·å¾—418åˆ†ã€‚ <br> <a href=""><img src="https://habrastorage.org/webt/sn/ql/2r/snql2roqbdiruuskxsathithz8i.jpeg"></a> </p><br><p> è®©æˆ‘ä»¬çœ‹çœ‹epsilon-greedyç®—æ³•åœ¨ç›¸åŒç¯å¢ƒä¸­çš„è¡Œä¸ºã€‚ åœ¨<i>e</i> = 0.1å’Œn_learning = 500çš„æƒ…å†µä¸‹è¿è¡Œè¯¥ç®—æ³•ä¸€ä¸‡æ¬¡ï¼ˆä»£ç†ä»…å°è¯•å‰500æ¬¡å°è¯•ï¼Œç„¶åä»¥<i>e</i> = 0.1çš„æ¦‚ç‡å°è¯•ï¼‰ã€‚ è®©æˆ‘ä»¬æ ¹æ®å®ƒåœ¨ç¯å¢ƒä¸­å¾—åˆ†çš„æ€»æ•°æ¥è¯„ä¼°ç®—æ³•ã€‚ </p><br><pre> <code class="python hljs">en1 = Environment(machines, payouts, n_trials) eg = eGreedy(env=en1, n_learning=<span class="hljs-number"><span class="hljs-number">500</span></span>, e=<span class="hljs-number"><span class="hljs-number">0.1</span></span>) en1.run(agent=eg)</code> </pre> <br> <a href=""><img src="https://habrastorage.org/webt/-f/zf/14/-fzf14djbqtdl5-0vyrapuhcp5c.jpeg"></a> <br><p>  Epsilon-greedyç®—æ³•è·å¾—788åˆ†ï¼Œå‡ ä¹æ˜¯éšæœºç®—æ³•çš„2å€-è¶…çº§ï¼ ç¬¬äºŒå¼ å›¾å¾ˆå¥½åœ°è¯´æ˜äº†è¯¥ç®—æ³•ã€‚ æˆ‘ä»¬çœ‹åˆ°ï¼Œå¯¹äºå‰500ä¸ªæ­¥éª¤ï¼ŒåŠ¨ä½œè¿‘ä¼¼å‡åŒ€åœ°åˆ†å¸ƒï¼Œå¹¶ä¸”Kæ˜¯éšæœºé€‰æ‹©çš„ã€‚ ä½†æ˜¯ï¼Œç„¶åå®ƒå¼€å§‹å¤§é‡åˆ©ç”¨é€‰é¡¹5-è¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„é€‰é¡¹ï¼Œä½†ä¸æ˜¯æœ€ä½³é€‰æ‹©ã€‚ æˆ‘ä»¬è¿˜çœ‹åˆ°ä»£ç†ä»ç„¶éšæœºé€‰æ‹©10ï¼…çš„æ—¶é—´ã€‚ </p><br><p> è¿™éå¸¸é…·-æˆ‘ä»¬åªå†™äº†å‡ è¡Œä»£ç ï¼Œç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç®—æ³•ï¼Œå¯ä»¥æ¢ç´¢æœŸæƒçš„ç©ºé—´å¹¶åšå‡ºæ¥è¿‘æœ€ä½³çš„å†³ç­–ã€‚ å¦ä¸€æ–¹é¢ï¼Œè¯¥ç®—æ³•æœªæ‰¾åˆ°æœ€ä½³é€‰æ‹©ã€‚ æ˜¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¢åŠ å­¦ä¹ çš„æ­¥éª¤æ•°ï¼Œä½†æ˜¯è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°†åœ¨éšæœºæœç´¢ä¸ŠèŠ±è´¹æ›´å¤šçš„æ—¶é—´ï¼Œä»è€Œè¿›ä¸€æ­¥æ¶åŒ–æœ€ç»ˆç»“æœã€‚ å¦å¤–ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå°†éšæœºæ€§ç¼å…¥æ­¤è¿‡ç¨‹-å¯èƒ½æ‰¾ä¸åˆ°æœ€ä½³ç®—æ³•ã€‚ </p><br><p> ç¨åï¼Œæˆ‘å°†å¤šæ¬¡è¿è¡Œæ¯ç§ç®—æ³•ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥ç›¸äº’æ¯”è¾ƒå®ƒä»¬ã€‚ ä½†æ˜¯ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ±¤æ™®æ£®é‡‡æ ·å¹¶åœ¨ç›¸åŒçš„ç¯å¢ƒä¸­å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚ </p><br><h2> æ±¤æ™®æ£®é‡‡æ · </h2><br><p> æ±¤æ™®æ£®é‡‡æ ·ä¸epsilon-greedyç®—æ³•åœ¨æœ¬è´¨ä¸Šæœ‰ä¸‰ç‚¹ä¸åŒï¼š <br><br></p><ol><li> è¿™ä¸æ˜¯è´ªå©ªã€‚ </li><li> å®ƒä»¥æ›´å¤æ‚çš„æ–¹å¼è¿›è¡Œå°è¯•ã€‚ </li><li> æ˜¯è´å¶æ–¯ã€‚ </li></ol><br> è¦ç‚¹æ˜¯ç¬¬3æ¬¾ï¼Œå…¶åæ˜¯ç¬¬1å’Œç¬¬2æ¬¾ã€‚ <br><p> è¯¥ç®—æ³•çš„æœ¬è´¨æ˜¯è¿™æ ·çš„ï¼š <br><br></p><ol><li> å°†æ¯ä¸ªé€‰é¡¹çš„æŠ•èµ„å›æŠ¥ç‡çš„åˆå§‹Betaåˆ†å¸ƒè®¾ç½®åœ¨0å’Œ1ä¹‹é—´ã€‚ </li><li> ä»æ­¤åˆ†å¸ƒä¸­é‡‡æ ·é€‰é¡¹ï¼Œé€‰æ‹©æœ€å¤§Thetaå‚æ•°ã€‚ </li><li> é€‰æ‹©ä¸æœ€å¤§thetaç›¸å…³çš„é€‰é¡¹kã€‚ </li><li> æŸ¥çœ‹å·²è®¡åˆ†çš„åˆ†æ•°ï¼Œæ›´æ–°åˆ†é…å‚æ•°ã€‚ </li></ol><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>é˜…è¯»æœ‰å…³betaåˆ†å‘çš„æ›´å¤šä¿¡æ¯ã€‚ <br> å…³äºå®ƒåœ¨Pythonä¸­çš„ä½¿ç”¨- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨è¿™é‡Œ</a> ã€‚ <br><p> ç®—æ³•ä»£ç ï¼š <br><br></p><pre> <code class="python hljs"> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThompsonSampler</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(BaseSampler)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, env)</span></span></span><span class="hljs-function">:</span></span> super().__init__(env) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">choose_k</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># sample from posterior (this is the thompson sampling approach) # this leads to more exploration because machines with &gt; uncertainty can then be selected as the machine self.theta = np.random.beta(self.a, self.b) # select machine with highest posterior p of payout self.k = self.variants[np.argmax(self.theta)] #self.k = np.argmax(self.a/(self.a + self.b)) return self.k def update(self): #update dist (a, b) = (a, b) + (r, 1 - r) self.a[self.k] += self.reward self.b[self.k] += 1 - self.reward # ie only increment b when it's a swing and a miss. 1 - 0 = 1, 1 - 1 = 0 #self.thetaregret[self.i] = self.thetaregret[self.i] #self.regret_i[self.i] = np.max(self.theta) - self.theta[self.k] self.thetas[self.i] = self.theta[self.k] self.thetaregret[self.i] = np.max(self.thetas) - self.theta[self.k] self.ad_i[self.i] = self.k self.r_i[self.i] = self.reward self.i += 1</span></span></code> </pre> <br> è¯¥ç®—æ³•çš„å½¢å¼ç¬¦å·å¦‚ä¸‹æ‰€ç¤ºã€‚ <br> <a href=""><img src="https://habrastorage.org/webt/5f/n6/xe/5fn6xew2i7v1jjh_10h9jqkjdzu.png"></a> <br><p> è®©æˆ‘ä»¬å¯¹æ­¤ç®—æ³•è¿›è¡Œç¼–ç¨‹ã€‚ åƒå…¶ä»–ä»£ç†ä¸€æ ·ï¼ŒThompsonSamplerç»§æ‰¿è‡ªBaseSamplerå¹¶å®šä¹‰äº†è‡ªå·±çš„select_kå’Œupdateæ–¹æ³•ã€‚ ç°åœ¨å¯åŠ¨æˆ‘ä»¬çš„æ–°ä»£ç†ã€‚ </p><br><pre> <code class="python hljs"> en2 = Environment(machines, payouts, n_trials) tsa = ThompsonSampler(env=en2) en2.run(agent=tsa)</code> </pre> <br> <a href=""><img src="https://habrastorage.org/webt/ml/kj/1p/mlkj1pvs8xnpxtkqmehmm_3xhgo.jpeg"></a> <br><p> å¦‚æ‚¨æ‰€è§ï¼Œä»–çš„å¾—åˆ†é«˜äºepsilon-greedyç®—æ³•ã€‚ å¤ªå¥½äº†ï¼ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹å°è¯•é€‰æ‹©çš„å›¾è¡¨ã€‚ å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæœ‰è¶£çš„ä¸œè¥¿ã€‚ é¦–å…ˆï¼Œä»£ç†æ­£ç¡®åœ°å‘ç°äº†æœ€ä½³é€‰é¡¹ï¼ˆé€‰é¡¹9ï¼‰å¹¶å……åˆ†åˆ©ç”¨äº†å®ƒã€‚ å…¶æ¬¡ï¼Œè¯¥ä»£ç†ä½¿ç”¨äº†å…¶ä»–é€‰é¡¹ï¼Œä½†æ˜¯ä»¥ä¸€ç§æ›´æ£˜æ‰‹çš„æ–¹å¼-åœ¨å°è¯•äº†1000æ¬¡ä¹‹åï¼Œè¯¥ä»£ç†é™¤äº†ä¸»è¦é€‰é¡¹ä¹‹å¤–ï¼Œè¿˜ä¸»è¦ä½¿ç”¨äº†å…¶ä»–é€‰é¡¹ä¸­æœ€å¼ºå¤§çš„é€‰é¡¹ã€‚ æ¢å¥è¯è¯´ï¼Œä»–ä¸æ˜¯éšæœºé€‰æ‹©ï¼Œè€Œæ˜¯æ›´èƒœä»»ã€‚ </p><br><p> ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ è¿™å¾ˆç®€å•-æ¯ä¸ªé€‰é¡¹çš„é¢„æœŸæ”¶ç›Šçš„åéªŒåˆ†å¸ƒçš„ä¸ç¡®å®šæ€§æ„å‘³ç€ï¼Œæ¯ä¸ªé€‰é¡¹çš„é€‰æ‹©æ¦‚ç‡å¤§çº¦ä¸å®ƒçš„å½¢çŠ¶æˆæ­£æ¯”ï¼Œç”±alphaå’Œbetaå‚æ•°ç¡®å®šã€‚ æ¢å¥è¯è¯´ï¼Œåœ¨æ¯æ¬¡å°è¯•ä¸­ï¼ŒThompsoné‡‡æ ·éƒ½ä¼šæ ¹æ®å…·æœ‰æœ€å¤§åˆ©ç›Šçš„åéªŒæ¦‚ç‡è§¦å‘æœŸæƒã€‚ ç²—ç•¥åœ°è¯´ï¼Œä»£ç†ä»åˆ†å¸ƒä¿¡æ¯ä¸­è·å¾—æœ‰å…³ä¸ç¡®å®šæ€§çš„ä¿¡æ¯ï¼Œç„¶åå†³å®šä½•æ—¶æ£€æŸ¥ç¯å¢ƒä»¥åŠä½•æ—¶ä½¿ç”¨è¯¥ä¿¡æ¯ã€‚ ä¾‹å¦‚ï¼Œå…·æœ‰è¾ƒé«˜åéªŒä¸ç¡®å®šæ€§çš„å¼±é€‰æ‹©å¯èƒ½ä¼šä¸ºæ­¤å°è¯•æœ€å¤šã€‚ ä½†æ˜¯å¯¹äºå¤§å¤šæ•°å°è¯•è€Œè¨€ï¼Œå…¶åéªŒåˆ†å¸ƒè¶Šå¼ºï¼Œå…¶å¹³å‡å€¼è¶Šå¤§ï¼Œå…¶æ ‡å‡†åå·®å°±è¶Šå°ï¼Œå› æ­¤ï¼Œé€‰æ‹©å®ƒçš„æœºä¼šå°±è¶Šå¤§ã€‚ </p><br><p> æ±¤æ™®æ£®ç®—æ³•çš„å¦ä¸€ä¸ªæ˜¾ç€ç‰¹æ€§ï¼šç”±äºå®ƒæ˜¯è´å¶æ–¯ç®—æ³•ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å…¶å‚æ•°æ¥ä¼°è®¡æ¯ä¸ªé€‰é¡¹çš„æŠ•èµ„å›æŠ¥ä¼°è®¡ä¸­çš„ä¸ç¡®å®šæ€§ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†6ä¸ªä¸åŒç‚¹çš„åéªŒåˆ†å¸ƒï¼Œå¹¶å°è¯•äº†20,000æ¬¡ã€‚ æ‚¨ä¼šçœ‹åˆ°åˆ†é…å¦‚ä½•é€æ¸æ”¶æ•›åˆ°å…·æœ‰æœ€ä½³å›æŠ¥çš„æœŸæƒã€‚ </p><br> <a href=""><img src="https://habrastorage.org/webt/bb/ka/fb/bbkafb4nv1pajwkygxy2brtmowy.jpeg"></a> <br><p> ç°åœ¨åœ¨100ä¸ªæ¨¡æ‹Ÿä¸­æ¯”è¾ƒæ‰€æœ‰3ä¸ªä»£ç†ã€‚  1æ¬¡æ¨¡æ‹Ÿæ˜¯ä¸€æ¬¡10,000æ¬¡å°è¯•çš„ä»£ç†å¯åŠ¨ã€‚ </p><br> <a href=""><img src="https://habrastorage.org/webt/j6/v1/sm/j6v1smcrwkwyhlo27ffhly13pwk.jpeg"></a> <br><p> ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œepsilon-greedyç­–ç•¥å’ŒThompsoné‡‡æ ·éƒ½æ¯”éšæœºé‡‡æ ·è¦å¥½å¾—å¤šã€‚ æ‚¨å¯èƒ½ä¼šæƒŠè®¶äºepsilonè´ªå©ªç­–ç•¥å’ŒThompsoné‡‡æ ·åœ¨æ€§èƒ½æ–¹é¢å®é™…ä¸Šæ˜¯å¯æ¯”çš„ã€‚  Epsilon-greedyç­–ç•¥å¯èƒ½éå¸¸æœ‰æ•ˆï¼Œä½†é£é™©æ›´é«˜ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šå¡åœ¨æ¬¡ä¼˜çš„é€‰é¡¹ä¸Š-ä»å›¾ä¸­çš„å¤±è´¥ä¸­å¯ä»¥çœ‹å‡ºã€‚ ä½†æ˜¯æ±¤æ™®æ£®é‡‡æ ·ä¸èƒ½ï¼Œå› ä¸ºå®ƒä»¥æ›´å¤æ‚çš„æ–¹å¼åœ¨é€‰é¡¹ç©ºé—´ä¸­è¿›è¡Œé€‰æ‹©ã€‚ </p><br><h2> é—æ†¾ </h2><br><p> è¯„ä¼°ç®—æ³•æ•ˆæœçš„å¦ä¸€ç§æ–¹æ³•æ˜¯è¯„ä¼°åæ‚”ã€‚ ç²—ç•¥åœ°è¯´ï¼Œç›¸å¯¹äºå·²ç»é‡‡å–çš„è¡ŒåŠ¨ï¼Œå®ƒè¶Šå°è¶Šå¥½ã€‚ ä¸‹é¢æ˜¯å¯¹é”™è¯¯çš„æ€»é—æ†¾å’Œé—æ†¾çš„å›¾è¡¨ã€‚ å†è¯´ä¸€æ¬¡-åæ‚”è¶Šå°‘è¶Šå¥½ã€‚ </p><br> <a href=""><img src="https://habrastorage.org/webt/8p/kd/o3/8pkdo3bilrde28bwsimdnbesqwg.jpeg"></a> <br><p> åœ¨ä¸Šæ–¹çš„å›¾è¡¨ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æ€»çš„é—æ†¾ï¼Œè€Œåœ¨ä¸‹æ–¹çš„å›¾è¡¨ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†è¿™æ¬¡å°è¯•ã€‚ ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ±¤æ™®æ£®é‡‡æ ·æ”¶æ•›åˆ°æœ€å°åæ‚”çš„é€Ÿåº¦æ¯”Îµ-è´ªå©ªç­–ç•¥å¿«å¾—å¤šã€‚ å¹¶ä¸”å®ƒæ”¶æ•›åˆ°ä¸€ä¸ªè¾ƒä½çš„æ°´å¹³ã€‚ ä½¿ç”¨Thompsoné‡‡æ ·ï¼Œä»£ç†å¯ä»¥å‡å°‘åæ‚”ï¼Œå› ä¸ºä»–å¯ä»¥æ›´å¥½åœ°æ£€æµ‹æœ€ä½³é€‰é¡¹å¹¶æ›´å¥½åœ°å°è¯•æœ€æœ‰å‰é€”çš„é€‰é¡¹-å› æ­¤Thompsoné‡‡æ ·ç‰¹åˆ«é€‚åˆäºæ›´é«˜çº§çš„ç”¨ä¾‹ï¼Œä¾‹å¦‚ç”¨äºé€‰æ‹©kçš„ç»Ÿè®¡æ¨¡å‹æˆ–ç¥ç»ç½‘ç»œã€‚ </p><br><h2> ç»“è®º </h2><br><p> è¿™æ˜¯ä¸€ç¯‡å¾ˆé•¿çš„æŠ€æœ¯æ–‡ç« ã€‚ æ€»è€Œè¨€ä¹‹ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¾ˆå¤šè¦å®æ—¶æµ‹è¯•çš„é€‰é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸å½“å¤æ‚çš„é‡‡æ ·æ–¹æ³•ã€‚ æ±¤æ™®æ£®é‡‡æ ·çš„ä¸€ä¸ªå¾ˆå¥½çš„ç‰¹ç‚¹ä¹‹ä¸€æ˜¯å®ƒä»¥ä¸€ç§ç›¸å½“æ£˜æ‰‹çš„æ–¹å¼å¹³è¡¡äº†ä½¿ç”¨å’Œæ¢ç´¢ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®©ä»–å®æ—¶ä¼˜åŒ–è§£å†³æ–¹æ¡ˆé€‰é¡¹çš„åˆ†é…ã€‚ è¿™äº›æ˜¯å¾ˆé…·çš„ç®—æ³•ï¼Œå¯¹äºä¼ä¸šè€Œè¨€ï¼Œå®ƒä»¬åº”è¯¥æ¯”A / Bæµ‹è¯•æ›´æœ‰ç”¨ã€‚ </p><br><p>  <b>é‡è¦ï¼</b>  <b>æ±¤æ™®æ£®é‡‡æ ·å¹¶ä¸æ„å‘³ç€æ‚¨ä¸éœ€è¦è¿›è¡ŒA / Bæµ‹è¯•ã€‚</b>  <b>é€šå¸¸ï¼Œä»–ä»¬é¦–å…ˆåœ¨ä»–çš„å¸®åŠ©ä¸‹æ‰¾åˆ°æœ€ä½³é€‰æ‹©ï¼Œç„¶åå¯¹å®ƒä»¬è¿›è¡ŒA / Bæµ‹è¯•ã€‚</b> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN425619/">https://habr.com/ru/post/zh-CN425619/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN425605/index.html">æ¥å—ä¸å¸¦ä¿¡ç”¨å¡çš„ä»˜æ¬¾ã€‚ Yandex.Moneyä¸Šçš„é¢å­”</a></li>
<li><a href="../zh-CN425607/index.html">ä½¿ç”¨Enronæ•°æ®é›†è¯†åˆ«æ¬ºè¯ˆã€‚ ç¬¬2éƒ¨åˆ†ï¼Œæ‰¾åˆ°æœ€ä½³æ¨¡å‹</a></li>
<li><a href="../zh-CN425609/index.html">åšå¼ˆè®ºï¼šç§‘ç‰¹æ—çš„äº‹ä¾‹å†³ç­–</a></li>
<li><a href="../zh-CN425611/index.html">é«˜å±‚å‰ç«¯æ¶æ„ã€‚ Yandexè®²åº§</a></li>
<li><a href="../zh-CN425613/index.html">æˆ‘å¦‚ä½•ç»„åˆç”¨äºJira Serverå’ŒJira Cloudçš„Tempoæ’ä»¶çš„æ•°æ®å¹¶å°†å…¶è¿ç§»å›Jira Cloud</a></li>
<li><a href="../zh-CN425621/index.html">ä¸€å®¶åˆ©ç”¨å¤§æ°”äºŒæ°§åŒ–ç¢³çš„å…¬å¸å¼€å§‹ç”Ÿäº§ç”²çƒ·</a></li>
<li><a href="../zh-CN425623/index.html">è”åˆæ‘„å½±ä¹‹æ—…â€œé’¥åŒ™â€</a></li>
<li><a href="../zh-CN425625/index.html">èŠ±è´¹äº†ï¼Œæˆ–è€…æœ¬åœ°åŒ–è€…ä¸ºä»€ä¹ˆä¼šé”™è¯¯åœ°ç¿»è¯‘æ¸¸æˆ</a></li>
<li><a href="../zh-CN425627/index.html">ç”¨äºæœåŠ¡å¼€å‘çš„IaaSï¼šè°ä»¥åŠä¸ºä»€ä¹ˆåˆ‡æ¢åˆ°è™šæ‹ŸåŸºç¡€æ¶æ„</a></li>
<li><a href="../zh-CN425629/index.html">æˆ‘ä»¬å¦‚ä½•é€šè¿‡é¥æ§å™¨åˆ¶ä½œæ£‹ç›˜æ¸¸æˆ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>