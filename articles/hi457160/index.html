<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯМ╝ ЁЯСйЁЯП╛тАНЁЯОУ ЁЯЪУ C ++ рдореЗрдВ рдкреНрд░рддрд┐рдирд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореЗрд░рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг: рд░рдирдЯрд╛рдЗрдо рдкрд░ рдЕрдЬреНрдЮрд╛рдд рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛ ЁЯНД ЁЯЪЛ ЁЯТг</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдкреНрд░рд╛рдЧрд┐рддрд┐рд╣рд╛рд╕ 
 рдореБрдЭреЗ C ++ рднрд╛рд╖рд╛ рдкрд╕рдВрдж рд╣реИред рдореИрдВ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд╣реВрдВрдЧрд╛ рдХрд┐ рдпрд╣ рдореЗрд░реА рдкрд╕рдВрджреАрджрд╛ рднрд╛рд╖рд╛ рд╣реИред рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдореИрдВ рдЕрдкрдиреЗ рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП .NET рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C ++ рдореЗрдВ рдкреНрд░рддрд┐рдирд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдореЗрд░рд╛ рджреГрд╖реНрдЯрд┐рдХреЛрдг: рд░рдирдЯрд╛рдЗрдо рдкрд░ рдЕрдЬреНрдЮрд╛рдд рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рдирд╛</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457160/"><h2>  рдкреНрд░рд╛рдЧрд┐рддрд┐рд╣рд╛рд╕ </h2><br>  рдореБрдЭреЗ C ++ рднрд╛рд╖рд╛ рдкрд╕рдВрдж рд╣реИред  рдореИрдВ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд╣реВрдВрдЧрд╛ рдХрд┐ рдпрд╣ рдореЗрд░реА рдкрд╕рдВрджреАрджрд╛ рднрд╛рд╖рд╛ рд╣реИред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдореИрдВ рдЕрдкрдиреЗ рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП .NET рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ, рдФрд░ рдЗрд╕рдореЗрдВ рдХрдИ рд╡рд┐рдЪрд╛рд░, рдореЗрд░реА рд░рд╛рдп рдореЗрдВ, рдмрд╕ рдЕрджреНрднреБрдд рд╣реИрдВред  рдПрдХ рдмрд╛рд░ рдЬрдм рдореИрдВ рдЗрд╕ рд╡рд┐рдЪрд╛рд░ рдХреЗ рд╕рд╛рде рдЖрдпрд╛ - C ++ рдореЗрдВ рдкреНрд░рддрд┐рдмрд┐рдВрдм рдФрд░ рдЧрддрд┐рд╢реАрд▓ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреЗ рдХреБрдЫ рд╕рд╛рдзрдиреЛрдВ рдХреЛ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рдП?  рдореИрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ C ++ рдЪрд╛рд╣рддрд╛ рдерд╛ рдХрд┐ рдПрдХ рд╕реАрдПрд▓рдЖрдИ рд▓рд╛рдн рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рдЕрдЬреНрдЮрд╛рдд рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдФрд░ рдЙрдирдХреЗ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЛ рдмреБрд▓рд╛рдПред  рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЬрдм рдпрд╣ рдкрд╣рд▓реЗ рд╕реЗ рдЬреНрдЮрд╛рдд рдирд╣реАрдВ рд╣реИ рдХрд┐ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br>  рдмреЗрд╢рдХ, рдкреНрд░рддрд┐рдирд┐рдзрд┐рдпреЛрдВ рдХреА рдПрдХ рдкреВрд░реА рдирдХрд▓ рдмрд╣реБрдд рдЬрдЯрд┐рд▓ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рд▓реЗрдЦ рдХреЗрд╡рд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреА рд╕рд╛рдорд╛рдиреНрдп рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ рдФрд░ рдХреБрдЫ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╕рдорд╕реНрдпрд╛рдУрдВ рдХреЗ рд╕рдорд╛рдзрд╛рди рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗрдЧрд╛ рдЬреЛ рднрд╛рд╖рд╛ рджреНрд╡рд╛рд░рд╛ рд╕реАрдзреЗ рд╕рдорд░реНрдерд┐рдд рдирд╣реАрдВ рд╣реЛрдиреЗ рдкрд░ рд╡реНрдпрд╡рд╣рд╛рд░ рдХрд░рддреЗ рд╣реИрдВред <br><a name="habracut"></a><br><h2>  рд╕рдВрдХрд▓рди рдХреЗ рджреМрд░рд╛рди рдорд╛рдкрджрдВрдбреЛрдВ рдФрд░ рдЕрдЬреНрдЮрд╛рдд рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рдЕрдирд┐рд╢реНрдЪрд┐рдд рд╕рдВрдЦреНрдпрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рд░реНрдп рдХрд░рдирд╛ </h2><br>  рдмреЗрд╢рдХ, рдпрд╣ рд╕реА ++ рдХреЗ рд╕рд╛рде рдореБрдЦреНрдп рд╕рдорд╕реНрдпрд╛ рд╣реИ, рдЬрд┐рд╕реЗ рд╣рд▓ рдХрд░рдирд╛ рдЗрддрдирд╛ рдЖрд╕рд╛рди рдирд╣реАрдВ рд╣реИред  рдмреЗрд╢рдХ, C ++ рдореЗрдВ C - <i>varargs</i> рд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рдорд┐рд▓рд╛ рдПрдХ рдЙрдкрдХрд░рдг рд╣реИ, рдФрд░ рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛ рд╣реИ рдХрд┐ рдпрд╣ рдкрд╣рд▓реА рдЪреАрдЬ рд╣реИ рдЬреЛ рджрд┐рдорд╛рдЧ рдореЗрдВ рдЖрддреА рд╣реИ ... рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡реЗ рдлрд┐рдЯ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВ, рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЙрдирдХреЗ рдкреНрд░рдХрд╛рд░-рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдкреНрд░рдХреГрддрд┐ (рдЬреИрд╕реЗ C рд╕реЗ рдХрдИ рдЪреАрдЬреЗрдВ) рдХреЗ рдХрд╛рд░рдгред рджреВрд╕рд░реЗ, рдРрд╕реЗ рддрд░реНрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдЖрдкрдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рдпрд╣ рдЬрд╛рдирдирд╛ рд╣реЛрдЧрд╛ рдХрд┐ рддрд░реНрдХ рдХрд┐рд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╣реИрдВред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд▓рдЧрднрдЧ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рдпрд╣ <i>рд╡реИрд░рдЧ рдХреЗ</i> рд╕рд╛рде рд╕рднреА рд╕рдорд╕реНрдпрд╛рдПрдВ рдирд╣реАрдВ рд╣реИрдВред  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рдпрд╣ рдЙрдкрдХрд░рдг рдпрд╣рд╛рдВ рд╕рд╣рд╛рдпрдХ рдирд╣реАрдВ рд╣реИред <br><br>  рдФрд░ рдЕрдм рдореИрдВ рдЙрди рдЙрдкрдХрд░рдгреЛрдВ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░реВрдВрдЧрд╛ рдЬрд┐рдиреНрд╣реЛрдВрдиреЗ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдореЗрдВ рдореЗрд░реА рдорджрдж рдХреАред <br><br><h3>  рдПрд╕рдЯреАрдбреА :: рдХреЛрдИ рднреА </h3><br>  C ++ 17 рдХреЗ рд╕рд╛рде рд╢реБрд░реВ, рднрд╛рд╖рд╛ рдореЗрдВ рдХрд┐рд╕реА рднреА рдЪреАрдЬрд╝ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрджреНрднреБрдд рдХрдВрдЯреЗрдирд░ рдХрдВрдЯреЗрдирд░ рд╣реИ - CLI рдореЗрдВ <i>System.Object рдХреЗ</i> рд▓рд┐рдП рдХреБрдЫ рджреВрд░ рдХреА рд╕рдорд╛рдирддрд╛ <i>:: рдХреЛрдИ рднреА</i> ред  рдпрд╣ рдХрдВрдЯреЗрдирд░ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреБрдЫ рднреА рд╕реНрдЯреЛрд░ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдФрд░ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдХреИрд╕реЗ: рдХреБрд╢рд▓рддрд╛ рд╕реЗ!  - рдорд╛рдирдХ рдЕрдиреБрд╢рдВрд╕рд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдк рдЫреЛрдЯреА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рд╕реАрдзреЗ рдЗрд╕рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддреЗ рд╣реИрдВ, рдмрдбрд╝реА рд╡рд╕реНрддреБрдУрдВ рдХреЛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЧрддрд┐рд╢реАрд▓ рдореЗрдореЛрд░реА рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ рд╡реНрдпрд╡рд╣рд╛рд░ рдЕрдирд┐рд╡рд╛рд░реНрдп рдирд╣реАрдВ рд╣реИ, рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рдиреЗ рдЕрдкрдиреЗ рд╕реА ++ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдпрд╣ рдХрд┐рдпрд╛ рд╣реИ, рдЬреЛ рдЕрдЪреНрдЫреА рдЦрдмрд░ рд╣реИ)ред  рдФрд░ рдХреЗрд╡рд▓ рдЗрд╕реЗ рд╕рдорд╛рдирддрд╛ рдХрд╣рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ System.Object рд╡рдВрд╢рд╛рдиреБрдХреНрд░рдо рд╕рдВрдмрдВрдз ("a") рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдФрд░ std :: рдХреЛрдИ рднреА рд╕рджрд╕реНрдпрддрд╛ рд╕рдВрдмрдВрдз рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИ ("a")ред  рдбреЗрдЯрд╛ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдСрдмреНрдЬреЗрдХреНрдЯ <i>std :: type_info</i> - RTTI рдореЗрдВ рдПрдХ рд╕рдВрдХреЗрддрдХ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдкреНрд░рдХрд╛рд░ рдХрдВрдЯреЗрдирд░ рдореЗрдВ "рдЭреВрда" рд╣реИред <br><br>  рдХрдВрдЯреЗрдирд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдкреВрд░реА рд╣реЗрдбрд░ рдлрд╝рд╛рдЗрд▓ <b>&lt;any&gt;</b> рдЖрд╡рдВрдЯрд┐рдд рдХреА рдЬрд╛рддреА рд╣реИред <br><br>  рдХрдВрдЯреЗрдирд░ рд╕реЗ рдХрд┐рд╕реА рд╡рд╕реНрддреБ рдХреЛ "рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рдиреЗ" рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ <i>std :: any_cast ()</i> рдЯреЗрдореНрдкреНрд▓реЗрдЯ рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬреЛ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИред <br>  рдЙрдкрдпреЛрдЧ рдЙрджрд╛рд╣рд░рдг: <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;any&gt; void any_test() { std::any obj = 5; int from_any = std::any_cast&lt;int&gt;(obj); }</span></span></span></span></code> </pre> <br>  рдпрджрд┐ рдЕрдиреБрд░реЛрдзрд┐рдд рдкреНрд░рдХрд╛рд░ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рд╕реЗ рдореЗрд▓ рдирд╣реАрдВ рдЦрд╛рддрд╛ рд╣реИ, рддреЛ рдПрдХ рдЕрдкрд╡рд╛рдж <i>std :: bad_any_cast рдлреЗрдВрдХ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</i> ред <br><br>  <i>Std :: any</i> , <i>std :: bad_any_cast classes</i> рдФрд░ <i>std :: any_cast рдлрд╝рдВрдХреНрд╢рди рдХреЗ рдЕрд▓рд╛рд╡рд╛</i> , рд╢реАрд░реНрд╖ рд▓реЗрдЦ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЯреЗрдореНрдкрд▓реЗрдЯ <i>std :: make_any</i> рд╕рдорд╛рди <i>std :: make_sared</i> , <i>std ::_pair</i> рдФрд░ рдЗрд╕ рддрд░рд╣ рдХреЗ рдЕрдиреНрдп рдХрд╛рд░реНрдп рд╣реИрдВред <br><br><h3>  RTTI </h3><br>  рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ, рдпрд╣ рд╕реА + + рдореЗрдВ рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рд░реВрдк рд╕реЗ рдЕрд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╣реЛрдЧрд╛ рддрд╛рдХрд┐ рд░рдирдЯрд╛рдЗрдо рдкрд░ рдЯрд╛рдЗрдк рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдЧрддрд┐рд╢реАрд▓ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреЛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗред  рдЖрдЦрд┐рд░рдХрд╛рд░, рдХрд┐рд╕реА рддрд░рд╣ рдпрд╣ рдЬрд╛рдВрдЪрдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИ рдХрд┐ рд╕рд╣реА рдкреНрд░рдХрд╛рд░ рдкрд╛рд░рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВ рдпрд╛ рдирд╣реАрдВред <br><br>  C ++ рдореЗрдВ рдЖрджрд┐рдо RTTI рдХрд╛ рд╕рдорд░реНрдерди рдХрд╛рдлреА рд╕рдордп рд╕реЗ рд╣реИред  рдпрд╣ рд╕рд┐рд░реНрдл рдПрдХ рдмрд┐рдВрджреБ рд╣реИ, рдЬреЛ рдХрд┐ рдЖрджрд┐рдо рд╣реИ - рд╣рдо рдПрдХ рдкреНрд░рдХрд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╣реБрдд рдХрдо рд╕реАрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрдм рддрдХ рдХрд┐ рд╕рдЬрд╛рдП рдЧрдП рдФрд░ рдЕрдШреЛрд╖рд┐рдд рдирд╛рдо рди рд╣реЛрдВред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рд╕рд╛рде рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдЖрдорддреМрд░ рдкрд░, "RTTI" рд╢рдмреНрдж рдХрд╛ рдЙрдкрдпреЛрдЧ рдмрд╣реБрд░реВрдкрддрд╛ рдХреЗ рд╕рдВрдмрдВрдз рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдпрд╣рд╛рдБ рд╣рдо рдЗрд╕ рд╢рдмреНрдж рдХрд╛ рд╡реНрдпрд╛рдкрдХ рдЕрд░реНрде рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдо рдЗрд╕ рддрдереНрдп рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦреЗрдВрдЧреЗ рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХрд╛рд░ рдореЗрдВ рд░рдирдЯрд╛рдЗрдо рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╣реЛрддреА рд╣реИ (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдЖрдк рдХреЗрд╡рд▓ рдкреЙрд▓рд┐рдореЛрд░реНрдлрд┐рдХ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд, рдЗрд╕реЗ рд╕рдВрдХрд▓рд┐рдд рд╕рдордп рдкрд░ рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд░реВрдк рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ)ред  рдЗрд╕рд▓рд┐рдП, рд░рдирдЯрд╛рдЗрдо рдХреЗ рджреМрд░рд╛рди рдЧреИрд░-рдкреЙрд▓реАрдореЙрд░реНрдлрд┐рдХ рдкреНрд░рдХрд╛рд░ (рдЯреЛрдЯреЛрд▓реЙрдЬреА рдХреЗ рд▓рд┐рдП рдЦреЗрдж) рдХреЗ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдирд╛ рд╕рдВрднрд╡ (рдФрд░ рдЖрд╡рд╢реНрдпрдХ) рд╣реИред <br>  RTTI рдХреЛ <i>std :: type_info рд╡рд░реНрдЧ</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдпрд╣ рд╡рд░реНрдЧ <b>&lt;typeinfo&gt;</b> рд╣реЗрдбрд░ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред  рдЗрд╕ рд╡рд░реНрдЧ рдХреЗ рдХрд┐рд╕реА рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рд╕рдВрджрд░реНрдн рдХреЗрд╡рд▓ <i>рдЯрд╛рдЗрдкрд┐рдб ()</i> рдСрдкрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ (рдХрдо рд╕реЗ рдХрдо рдЕрднреА рдХреЗ рд▓рд┐рдП) рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br><h3>  рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ </h3><br>  рднрд╛рд╖рд╛ рдХреА рдПрдХ рдФрд░ рдЕрддреНрдпрдВрдд рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛ рдЬрд┐рд╕реЗ рд╣рдореЗрдВ рдЕрдкрдиреЗ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдорд╣рд╕реВрд╕ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рд╡рд╣ рд╣реИ рдЯреЗрдореНрдкрд▓реЗрдЯред  рдпрд╣ рдЙрдкрдХрд░рдг рдХрд╛рдлреА рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдФрд░ рдЕрддреНрдпрдВрдд рдХрдард┐рди рд╣реИ, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдпрд╣ рдЖрдкрдХреЛ рд╕рдВрдХрд▓рди рд╕рдордп рдкрд░ рдХреЛрдб рдЙрддреНрдкрдиреНрди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред <br><br>  рдЯреЗрдореНрдкреНрд▓реЗрдЯ рдПрдХ рдмрд╣реБрдд рд╡реНрдпрд╛рдкрдХ рд╡рд┐рд╖рдп рд╣реИ, рдФрд░ рдЗрд╕реЗ рд▓реЗрдЦ рдХреЗ рдврд╛рдВрдЪреЗ рдХреЗ рднреАрддрд░ рдкреНрд░рдХрдЯ рдХрд░рдирд╛ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реЛрдЧрд╛, рдФрд░ рдпрд╣ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред  рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдкрд╛рдардХ рд╕рдордЭрддрд╛ рд╣реИ рдХрд┐ рдпрд╣ рдХрд┐рд╕ рдмрд╛рд░реЗ рдореЗрдВ рд╣реИред  рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдореЗрдВ рдХреБрдЫ рдЕрд╕реНрдкрд╖реНрдЯ рдмрд┐рдВрджреБ рд╕рд╛рдордиреЗ рдЖрдПрдВрдЧреЗред <br><br><h3>  рдХреЙрд▓ рдХреЗ рдмрд╛рдж рддрд░реНрдХ рд▓рдкреЗрдЯрдирд╛ </h3><br>  рддреЛ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдХрдИ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд▓реЗрддрд╛ рд╣реИред <br><br>  рдореИрдВ рдЖрдкрдХреЛ рдПрдХ рдХреЛрдб рд╕реНрдХреЗрдЪ рджрд┐рдЦрд╛рдКрдВрдЧрд╛ рдЬреЛ рдореЗрд░реЗ рдЗрд░рд╛рджреЛрдВ рдХреЛ рд╕рдордЭрд╛рдПрдЧрд╛ред <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Variadic_args_binder.hpp&gt; #include &lt;string&gt; #include &lt;iostream&gt; #include &lt;vector&gt; #include &lt;any&gt; int f(int a, std::string s) { std::cout &lt;&lt; "int: " &lt;&lt; a &lt;&lt; "\nstring: " &lt;&lt; s &lt;&lt; std::endl; return 1; } void demo() { std::vector&lt;std::any&gt; params; params.push_back(5); params.push_back(std::string{ "Hello, Delegates!" }); delegates::Variadic_args_binder&lt;int(*)(int, std::string), int, std::string&gt; binder{ f, params }; binder(); }</span></span></span></span></code> </pre> <br>  рдЖрдк рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╣ рдХреИрд╕реЗ рд╕рдВрднрд╡ рд╣реИ?  рд╡рд░реНрдЧ рдирд╛рдо <i>Variadic_args_binder</i> рдЖрдкрдХреЛ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдСрдмреНрдЬреЗрдХреНрдЯ рдлрд╝рдВрдХреНрд╢рди рдФрд░ рдЙрди рддрд░реНрдХреЛрдВ рдХреЛ рдмрд╛рдВрдзрддрд╛ рд╣реИ, рдЬрдм рдЖрдк рдЗрд╕реЗ рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдпрд╣ рдХреЗрд╡рд▓ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдмрд┐рдирд╛ рдПрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд░реВрдк рдореЗрдВ рдЗрд╕ рдмрд╛рдЗрдВрдбрд░ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрдиреА рд╣реБрдИ рд╣реИ! <br>  рдЗрд╕рд▓рд┐рдП рдпрд╣ рдмрд╛рд╣рд░ рджрд┐рдЦрддрд╛ рд╣реИред <br><br>  рдпрджрд┐ рддреБрд░рдВрдд, рдмрд┐рдирд╛ рд╕реЛрдЪреЗ-рд╕рдордЭреЗ, рдпрд╣ рдзрд╛рд░рдгрд╛ рдмрдирд╛ рд▓реЗрдВ рдХрд┐ рдЗрд╕реЗ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, рддреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд▓рд┐рдП рдХрдИ <i>Variadic_args_binder</i> рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛рдУрдВ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдорди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ рдпрджрд┐ рдЕрд╕реАрдорд┐рдд рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдорд╛рдкрджрдВрдбреЛрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред  рдФрд░ рдпрд╣рд╛рдБ рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ: рддрд░реНрдХ, рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреЛ рд╕рд╛рдВрдЦреНрдпрд┐рдХреАрдп рд░реВрдк рд╕реЗ рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЕрд░реНрдерд╛рддреН, рдЕрдВрдд рдореЗрдВ рд╕рдВрдХрд▓рдХ рдХреЗ рд▓рд┐рдП, рдХреЙрд▓ рдХреЛрдб рдХреЛ рдЗрд╕ рдкрд░ рдХрдо рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП: <br><br><pre> <code class="cpp hljs">fun_ptr(param1, param2, тАж, paramN);</code> </pre> <br>  рдпрд╣ C ++ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рдФрд░ рдпрд╣ рд╕рдм рдмрд╣реБрдд рдЬрдЯрд┐рд▓ рд╣реИред <br><br>  рдХреЗрд╡рд▓ рдЯреЗрдореНрдкрд▓реЗрдЯ рдЬрд╛рджреВ рдЗрд╕реЗ рд╕рдВрднрд╛рд▓ рд╕рдХрддрд╛ рд╣реИ! <br><br>  рдореБрдЦреНрдп рд╡рд┐рдЪрд╛рд░ рдкреБрдирд░рд╛рд╡рд░реНрддреА рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдмрдирд╛рдирд╛ рд╣реИ рдЬреЛ рдкреНрд░рддреНрдпреЗрдХ рдШреЛрдВрд╕рд▓реЗ рдХреЗ рд╕реНрддрд░ рдкрд░ рддрд░реНрдХреЛрдВ рдпрд╛ рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕реЗ рдПрдХ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдЗрд╕рд▓рд┐рдП, <i>_Tagged_args_binder</i> рд╡рд░реНрдЧ рдШреЛрд╖рд┐рдд рдХрд░реЗрдВ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> delegates::impl { <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Func_type, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tagged_args_binder</span></span></span><span class="hljs-class">;</span></span> }</code> </pre> <br>  рдкреИрдХреЗрдЬреЛрдВ рдХреЛ рдЖрд╕рд╛рдиреА рд╕реЗ "рдЯреНрд░рд╛рдВрд╕рдлрд░" рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдПрдХ рд╕рд╣рд╛рдпрдХ рдкреНрд░рдХрд╛рд░ <i>рдмрдирд╛рдПрдВрдЧреЗ</i> , <i>Type_pack_tag</i> (рдпрд╣ рдХреНрдпреЛрдВ рдЖрд╡рд╢реНрдпрдХ рдерд╛, рдпрд╣ рдЬрд▓реНрдж рд╣реА рдмрди рдЬрд╛рдПрдЧрд╛): <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... T&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Type_pack_tag</span></span></span><span class="hljs-class"> {</span></span> };</code> </pre> <br>  рдЕрдм рд╣рдо <i>_Tagged_args_binder</i> рд╡рд░реНрдЧ рдХреЗ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮ рдмрдирд╛рддреЗ рд╣реИрдВред <br><br><h4>  рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛рдУрдВ </h4><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЬрд╛рдирддреЗ рд╣реИрдВ, рддрд╛рдХрд┐ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рдЕрдирдВрдд рди рд╣реЛ, рд╕реАрдорд╛ рдорд╛рдорд▓реЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рд╣реИред <br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рд╣реИрдВред  рд╕рд╛рджрдЧреА рдХреЗ рд▓рд┐рдП, рдореИрдВ рдХреЗрд╡рд▓ рдЧреИрд░-рд╕рдВрджрд░реНрдн рдкреНрд░рдХрд╛рд░ рдФрд░ рд╕рдВрджрд░реНрдн рд╕рдВрджрд░реНрдн рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рдХрд╛ рд╣рд╡рд╛рд▓рд╛ рджреВрдВрдЧрд╛ред <br>  рд╕реАрдзреЗ рдкреИрд░рд╛рдореАрдЯрд░ рдорд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Func_type, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T1, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Types_to_construct&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tagged_args_binder</span></span></span><span class="hljs-class">&lt;Func_type, Type_pack_tag&lt;T1, Types_to_construct...&gt;, Type_pack_tag&lt;&gt;&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(!<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::is_same_v&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, T1&gt;, <span class="hljs-string"><span class="hljs-string">"Void argument is not allowed"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Ret_type = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">invoke_result_t</span></span>&lt;Func_type, T1, Types_to_construct...&gt;; _Tagged_args_binder(Func_type func, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any&gt;&amp; args) : ap_arg{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(unihold::reference_any_cast&lt;T1&gt;(args.at(<span class="hljs-number"><span class="hljs-number">0</span></span>))) }, ap_caller_part{ func, args } { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constexpr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::is_same_v&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Ret_type&gt;)</span></span></span><span class="hljs-function"> </span></span>{ ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(ap_arg)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Ret_type&gt;(ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(ap_arg))); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::is_same_v&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Ret_type&gt;)</span></span></span><span class="hljs-function"> </span></span>{ ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(ap_arg)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Ret_type&gt;(ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(ap_arg))); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: _Tagged_args_binder&lt;Func_type, Type_pack_tag&lt;Types_to_construct...&gt;, Type_pack_tag&lt;T1&gt;&gt; ap_caller_part; T1 ap_arg; };</code> </pre> <br>  <i>Ap_arg</i> рдХреЙрд▓ рдХрд╛ рдкрд╣рд▓рд╛ рддрд░реНрдХ рдФрд░ рдмрд╛рдХреА рдкреБрдирд░рд╛рд╡рд░реНрддреА <i>ap_caller_part</i> рдСрдмреНрдЬреЗрдХреНрдЯ рдпрд╣рд╛рдВ <i>рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИ</i> ред  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ <i>рдЯреА 1</i> рдкреНрд░рдХрд╛рд░ рдЗрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдкрд╣рд▓реЗ рдкреИрдХреЗрдЯ рд╕реЗ "рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд" рд╣реЛрддрд╛ рд╣реИ рдФрд░ рдкреБрдирд░рд╛рд╡рд░реНрддреА рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ "рдкреВрдВрдЫ" рдореЗрдВ рджреВрд╕рд░реЗ рдирдВрдмрд░ рдкрд░ рд╣реЛрддрд╛ рд╣реИред <br><br>  рд▓рд┐рдВрдХ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Func_type, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T1, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Types_to_construct&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tagged_args_binder</span></span></span><span class="hljs-class">&lt;Func_type, Type_pack_tag&lt;T1&amp;&amp;, Types_to_construct...&gt;, Type_pack_tag&lt;&gt;&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> move_ref_T1 = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">add_rvalue_reference_t</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">remove_reference_t</span></span>&lt;T1&gt;&gt;; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Ret_type = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">invoke_result_t</span></span>&lt;Func_type, move_ref_T1, Types_to_construct&gt;; _Tagged_args_binder(Func_type func, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any&gt;&amp; args) : ap_arg{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(unihold::reference_any_cast&lt;T1&gt;(args.at(<span class="hljs-number"><span class="hljs-number">0</span></span>))) }, ap_caller_part{ func, args } { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::is_same_v&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Ret_type&gt;)</span></span></span><span class="hljs-function"> </span></span>{ ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(unihold::reference_any_cast&lt;T1&gt;(ap_arg))); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Ret_type&gt;(ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(unihold::reference_any_cast&lt;T1&gt;(ap_arg)))); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::is_same_v&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Ret_type&gt;)</span></span></span><span class="hljs-function"> </span></span>{ ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(unihold::reference_any_cast&lt;T1&gt;(ap_arg))); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Ret_type&gt;(ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(unihold::reference_any_cast&lt;T1&gt;(ap_arg)))); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: _Tagged_args_binder&lt;Func_type, Type_pack_tag&lt;Types_to_construct...&gt;, Type_pack_tag&lt;move_ref_T1&gt;&gt; ap_caller_part; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any ap_arg; };</code> </pre> <br><br>  рдЯреЗрдореНрдкрд▓реЗрдЯ "рд░рд╛рдЗрдЯ-рд╣реИрдВрдбреЗрдб" рд▓рд┐рдВрдХ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рд░рд╛рдЗрдЯ-рд╣реИрдВрдб рдЕрд░реНрде рдирд╣реАрдВ рд╣реИрдВред  рдпреЗ рддрдерд╛рдХрдерд┐рдд "рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рд▓рд┐рдВрдХ" рд╣реИрдВ, рдЬреЛ рдХрд┐ <i>T1</i> рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░, <i>T1 &amp;</i> , рдпрд╛ <i>T1 &amp;&amp;</i> рдмрди рдЬрд╛рддреЗ рд╣реИрдВред  рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рд╡рд░реНрдХрдЕрд░рд╛рдЙрдВрдб рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛: рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЪреВрдВрдХрд┐ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛рдУрдВ рдХреЛ рджреЛрдиреЛрдВ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдВрдХ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рдпрд╣ рдХрд╛рдлреА рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдирд╣реАрдВ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рдкрд╣рд▓реЗ рд╕реЗ рдмрддрд╛рдП рдЧрдП рдХрд╛рд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП) рдФрд░ рдЧреИрд░-рд╕рдВрджрд░реНрдн рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд▓рд┐рдП, рдЬрдм рдЖрдк рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЛ рддреНрд╡рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рдХрд╛ рдЪрдпрди рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рднрд▓реЗ рд╣реА рдпрд╣ рдПрдХ рджрд╛рд╣рд┐рдиреЗ рд╣рд╛рде рдХреА рдХрдбрд╝реА рд╣реЛ;  рджреВрд╕рд░реА рдмрд╛рдд, <i>T1</i> рдкреНрд░рдХрд╛рд░ рдХреЛ рдкреИрдХреЗрдЬ рд╕реЗ рдкреИрдХреЗрдЬ рдореЗрдВ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <i>Move_ref_T1</i> рдХреЗ рд╕рд╣реА рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ <i>рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</i> , рдЬрд┐рд╕реЗ рдПрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рддрд┐рджреНрд╡рдВрджреНрд╡рд┐рддрд╛ рд▓рд┐рдВрдХ рдореЗрдВ рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдПрдХ рд╕рд╛рдорд╛рдиреНрдп рд▓рд┐рдВрдХ рдХреЗ рд╕рд╛рде рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рдЙрд╕реА рддрд░рд╣ рд╕реЗ рдХреА рдЬрд╛рддреА рд╣реИ, рдЖрд╡рд╢реНрдпрдХ рд╕реБрдзрд╛рд░ рдХреЗ рд╕рд╛рдеред <br><br><h4>  рдЕрдВрддрд┐рдо рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ </h4><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Func_type, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Param_type&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tagged_args_binder</span></span></span><span class="hljs-class">&lt;Func_type, Type_pack_tag&lt;&gt;, Type_pack_tag&lt;Param_type...&gt;&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Ret_type = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">invoke_result_t</span></span>&lt;Func_type, Param_type...&gt;; <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> _Tagged_args_binder(Func_type func, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any&gt;&amp; args) : ap_func{ func } { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Param_type... param)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constexpr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::is_same_v&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">decltype</span></span></span></span><span class="hljs-function"><span class="hljs-params">(ap_func(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::forward&lt;Param_type&gt;(param)...))&gt;)</span></span></span><span class="hljs-function"> </span></span>{ ap_func(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Param_type&gt;(param)...); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Ret_type&gt;(ap_func(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Param_type&gt;(param)...)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Param_type... param)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constexpr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::is_same_v&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Ret_type&gt;)</span></span></span><span class="hljs-function"> </span></span>{ ap_func(param...); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Ret_type&gt;(ap_func(param...)); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: Func_type ap_func; };</code> </pre> <br>  рдпрд╣ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рдПрдХ рдХрд╛рд░реНрдпрд╛рддреНрдордХ рд╡рд╕реНрддреБ рдХреЗ рднрдВрдбрд╛рд░рдг рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИ рдФрд░, рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЗрд╕рдХреЗ рдКрдкрд░ рдПрдХ рдЖрд╡рд░рдг рд╣реИред  рдпрд╣ рдЕрдВрддрд┐рдо рдкреБрдирд░рд╛рд╡рд░реНрддреА рдкреНрд░рдХрд╛рд░ рд╣реИред <br><br>  рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ <i>Type_pack_tag рдХрд╛</i> рдЙрдкрдпреЛрдЧ рдпрд╣рд╛рдБ рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╕рднреА рдкреИрд░рд╛рдореАрдЯрд░ рдкреНрд░рдХрд╛рд░ рдЕрдм рдмрд╛рдПрдВ рдкреИрдХреЗрдЬ рдореЗрдВ рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдП рдЧрдП рд╣реИрдВред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╡реЗ рд╕рднреА рд╕рдВрд╕рд╛рдзрд┐рдд рдФрд░ рдкреИрдХ рдХрд┐рдП рдЧрдП рд╣реИрдВред <br><br>  рдЕрдм, рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ, рдпрд╣ рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ <i>Type_pack_tag</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдХреНрдпреЛрдВ рдЖрд╡рд╢реНрдпрдХ рдерд╛ред  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐, рднрд╛рд╖рд╛ рджреЛ рдкреНрд░рдХрд╛рд░ рдХреЗ рдкреИрдХреЗрдЬреЛрдВ рдХреЛ рдПрдХ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрдЧреА, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЗрд╕ рддрд░рд╣: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Func_type, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T1, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Types_to_construct, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Param_type&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tagged_args_binder</span></span></span><span class="hljs-class">&lt;Func_type, T1, Types_to_construct..., Param_type...&gt; {</span></span> };</code> </pre> <br>  рдЗрд╕рд▓рд┐рдП, рдЖрдкрдХреЛ рдЙрдиреНрд╣реЗрдВ рджреЛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдЕрдВрджрд░ рджреЛ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдкреИрдХреЗрдЬреЛрдВ рдореЗрдВ рдЕрд▓рдЧ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд, рдЖрдкрдХреЛ рд╕рдВрд╕рд╛рдзрд┐рдд рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЛ рдЙрди рд▓реЛрдЧреЛрдВ рд╕реЗ рдЕрд▓рдЧ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдЕрднреА рддрдХ рд╕рдВрд╕рд╛рдзрд┐рдд рдирд╣реАрдВ рд╣реБрдП рд╣реИрдВред <br><br><h4>  рдЗрдВрдЯрд░рдореАрдбрд┐рдПрдЯ рд╕реНрдкреЗрд╢рд▓рд╛рдЗрдЬреЗрд╢рди </h4><br>  рдордзреНрдпрд╡рд░реНрддреА рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рд╕реЗ, рдореИрдВ рдЕрдВрдд рдореЗрдВ рдПрдХ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рджреВрдВрдЧрд╛, рдлрд┐рд░ рд╕реЗ, рдореВрд▓реНрдп рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП, рдмрд╛рдХреА рдЙрдкрдорд╛ рд╕реЗ рд╣реИ: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Func_type, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T1, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Types_to_construct, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Param_type&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Tagged_args_binder</span></span></span><span class="hljs-class">&lt;Func_type, Type_pack_tag&lt;T1, Types_to_construct...&gt;, Type_pack_tag&lt;Param_type...&gt;&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Ret_type = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">invoke_result_t</span></span>&lt;Func_type, Param_type..., T1, Types_to_construct...&gt;; <span class="hljs-keyword"><span class="hljs-keyword">static_assert</span></span>(!<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::is_same_v&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, T1&gt;, <span class="hljs-string"><span class="hljs-string">"Void argument is not allowed"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> _Tagged_args_binder(Func_type func, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any&gt;&amp; args) : ap_arg{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(unihold::reference_any_cast&lt;T1&gt;(args.at(<span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>...(Param_type)))) }, ap_caller_part{ func, args } { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Param_type... param)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::is_same_v&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Ret_type&gt;)</span></span></span><span class="hljs-function"> </span></span>{ ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Param_type&gt;(param)..., <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(ap_arg)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Ret_type&gt;(ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Param_type&gt;(param)..., <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(ap_arg))); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Param_type... param)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">if</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">constexpr</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::is_same_v&lt;</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">, Ret_type&gt;)</span></span></span><span class="hljs-function"> </span></span>{ ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Param_type&gt;(param)..., <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(ap_arg)); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Ret_type&gt;(ap_caller_part(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::forward&lt;Param_type&gt;(param)..., <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(ap_arg))); } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: _Tagged_args_binder&lt;Func_type, Type_pack_tag&lt;Types_to_construct...&gt;, Type_pack_tag&lt;Param_type..., T1&gt;&gt; ap_caller_part; T1 ap_arg; };</code> </pre> <br>  рдЗрд╕ рд╡рд┐рд╢реЗрд╖рдЬреНрдЮрддрд╛ рдХрд╛ рдЙрджреНрджреЗрд╢реНрдп рдкрд╣рд▓реЗ рдХреЛ рдЫреЛрдбрд╝рдХрд░ рдХрд┐рд╕реА рднреА рддрд░реНрдХ рдХреЛ рдкреИрдХ рдХрд░рдирд╛ рд╣реИред <br><br><h4>  рдмрд╛рдЗрдВрдбрд░ рдХреНрд▓рд╛рд╕ </h4><br>  <i>_Tagged_args_binder</i> рд╡рд░реНрдЧ рдкреНрд░рддреНрдпрдХреНрд╖ рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдЕрднрд┐рдкреНрд░реЗрдд рдирд╣реАрдВ рд╣реИ, рдЬрд┐рд╕реЗ рдореИрдВ рдЗрд╕рдХреЗ рдирд╛рдо рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ рдПрдХ рдПрдХрд▓ рдЕрдВрдбрд░рд╕реНрдХреЛрд░ рдХреЗ рд╕рд╛рде рдЬреЛрд░ рджреЗрдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ред  рдЗрд╕рд▓рд┐рдП, рдореИрдВ рдПрдХ рдЫреЛрдЯреЗ рд╡рд░реНрдЧ рдХрд╛ рдХреЛрдб рджреВрдВрдЧрд╛, рдЬреЛ рдХрд┐ рдЯрд╛рдЗрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдмрджрд╕реВрд░рдд рдФрд░ рдЕрд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдХреЗ рд▓рд┐рдП "рдЗрдВрдЯрд░рдлрд╝реЗрд╕" рдХрд╛ рдПрдХ рдкреНрд░рдХрд╛рд░ рд╣реИ (рдЬреЛ, рд╣рд╛рд▓рд╛рдВрдХрд┐, рдмрд▓реНрдХрд┐ рдЕрд╕рд╛рдорд╛рдиреНрдп рд╕реА ++ рдЯреНрд░рд┐рдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдЗрд╕реЗ рдХреБрдЫ рдЖрдХрд░реНрд╖рдг рджреЗрддрд╛ рд╣реИ, рдореЗрд░реА рд░рд╛рдп рдореЗрдВ): <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> cutecpplib::delegates { <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> Functor_type, <span class="hljs-keyword"><span class="hljs-keyword">typename</span></span>... Param_type&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Variadic_args_binder</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> binder_type = impl::_Tagged_args_binder&lt;Functor_type, Type_pack_tag&lt;Param_type...&gt;, Type_pack_tag&lt;&gt;&gt;; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Ret_type = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">invoke_result_t</span></span>&lt;binder_type&gt;; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Variadic_args_binder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Functor_type function, Param_type... param)</span></span></span><span class="hljs-function"> : ap_tagged_binder</span></span>{ function, param... } { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Variadic_args_binder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Functor_type function, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::any&gt;&amp; args)</span></span></span><span class="hljs-function"> : ap_tagged_binder</span></span>{ function, args } { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ap_tagged_binder(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ap_tagged_binder(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span>: binder_type ap_tagged_binder; }; }</code> </pre><br><h4>  Unihold рдХрдиреНрд╡реЗрдВрд╢рди - <i>std рдХреЗ</i> рдЕрдВрджрд░ рдкрд╛рд╕рд┐рдВрдЧ рд▓рд┐рдВрдХ <i>:: рдХреЛрдИ рднреА</i> </h4><br>  рдПрдХ рдЪреМрдХрд╕ рдкрд╛рдардХ рдиреЗ рджреЗрдЦрд╛ рд╣реЛрдЧрд╛ рдХрд┐ рдХреЛрдб <i>unihold :: reference_any_cast ()</i> рдлрд╝рдВрдХреНрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдлрд╝рдВрдХреНрд╢рди, рд╕рд╛рде рд╣реА рдЗрд╕рдХреЗ рдПрдирд╛рд▓реЙрдЧ <i>рдпреВрдиреАрд╣реЛрд▓реНрдб :: рдкреЙрдЗрдВрдЯрд░_рдиреНрдп_рдХрд╛рд╕реНрдЯ ()</i> , рдХреЛ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕рдордЭреМрддреЗ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: рд╕рдВрджрд░реНрдн рджреНрд╡рд╛рд░рд╛ рдкрд╛рд░рд┐рдд рдХрд┐рдП рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ рддрд░реНрдХреЛрдВ рдХреЛ рдкреЙрдЗрдВрдЯрд░ рджреНрд╡рд╛рд░рд╛ <i>std :: any</i> рджреНрд╡рд╛рд░рд╛ рдкрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  <i>рд╕рдВрджрд░реНрдн_рдпрд╛_рдХрд╛рд╕реНрдЯ</i> рдлрд╝рдВрдХреНрд╢рди рд╣рдореЗрд╢рд╛ рдХрд┐рд╕реА рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рд╕рдВрджрд░реНрдн рджреЗрддрд╛ рд╣реИ, рдЪрд╛рд╣реЗ рд╡рд╣ рдСрдмреНрдЬреЗрдХреНрдЯ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реЛ рдпрд╛ рдХреЗрд╡рд▓ рдПрдХ рдкреЙрдЗрдВрдЯрд░ рд╣реЛред  рдпрджрд┐ <i>std :: рдХрд┐рд╕реА</i> рд╡рд╕реНрддреБ рдореЗрдВ рдХреЛрдИ рд╡рд╕реНрддреБ рд╕рдорд╛рд╣рд┐рдд рд╣реИ, рддреЛ рдЗрд╕ рд╡рд╕реНрддреБ рдХрд╛ рдПрдХ рд╕рдВрджрд░реНрдн рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рддрд╛ рд╣реИ;  рдпрджрд┐ рдЗрд╕рдореЗрдВ рдПрдХ рдкреЙрдЗрдВрдЯрд░ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдкреЙрдЗрдВрдЯрд░ рджреНрд╡рд╛рд░рд╛ рдЗрдВрдЧрд┐рдд рдСрдмреНрдЬреЗрдХреНрдЯ рдкрд░ рдПрдХ рд╕рдВрджрд░реНрдн рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рдкреНрд░рддреНрдпреЗрдХ рдлрд╝рдВрдХреНрд╢рди рдХреЗ рд▓рд┐рдП, рдирд┐рд░рдВрддрд░ <i>std :: рдХрд┐рд╕реА рднреА</i> рдФрд░ рдЕрддрд┐рднрд╛рд░рд┐рдд рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЗ рд▓рд┐рдП рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдХрдВрдЯреЗрдирд░ <i>std :: рдХрд┐рд╕реА рднреА</i> рд╡рд╕реНрддреБ рдХрд╛ рдорд╛рд▓рд┐рдХ рд╣реИ рдпрд╛ рдХреЗрд╡рд▓ рдПрдХ рдкреЙрдЗрдВрдЯрд░ рд╣реИред <br><br>  рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХреЛ рд╕реНрдЯреЛрд░ рдХрд┐рдП рдЧрдП рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдкреНрд░рдХрд╛рд░ рдореЗрдВ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рд╡рд┐рд╢реЗрд╖ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдЬреИрд╕реЗ рд╕реА ++ рдкреНрд░рдХрд╛рд░ рд░реВрдкрд╛рдВрддрд░рдг рдФрд░ рд╕рдорд╛рди рдЯреЗрдореНрдкрд▓реЗрдЯ рдлрд╝рдВрдХреНрд╢рдиред <br><br>  рдЗрди рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдХреЛрдб: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">remove_reference_t</span></span>&lt;T&gt;&amp; unihold::reference_any_cast(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any&amp; wrapper) { <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reference_any_cast&lt;T&gt;(wrapper, result); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">remove_reference_t</span></span>&lt;T&gt;&amp; unihold::reference_any_cast(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any&amp; wrapper) { <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> result; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> reference_any_cast&lt;T&gt;(wrapper, result); } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">remove_reference_t</span></span>&lt;T&gt;&amp; unihold::reference_any_cast(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any&amp; wrapper, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&amp; is_owner) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> ptr = pointer_any_cast&lt;T&gt;(&amp;wrapper, is_owner); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!ptr) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::bad_any_cast{ }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *ptr; } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">remove_reference_t</span></span>&lt;T&gt;&amp; unihold::reference_any_cast(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any&amp; wrapper, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&amp; is_owner) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> ptr = pointer_any_cast&lt;T&gt;(&amp;wrapper, is_owner); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!ptr) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::bad_any_cast{ }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> *ptr; } <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-keyword"><span class="hljs-keyword">remove_reference_t</span></span>&lt;T&gt;* unihold::pointer_any_cast(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::any* wrapper, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&amp; is_owner) { <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> NR_T = <span class="hljs-keyword"><span class="hljs-keyword">remove_reference_t</span></span>&lt;T&gt;; <span class="hljs-comment"><span class="hljs-comment">// No_reference_T //     wrapper NR_T** double_ptr_to_original = any_cast&lt;NR_T*&gt;(wrapper); //      wrapper NR_T* ptr_to_copy; if (double_ptr_to_original) { // Wrapper      is_owner = false; return *double_ptr_to_original; } else if (ptr_to_copy = any_cast&lt;NR_T&gt;(wrapper)) { // Wrapper    is_owner = true; return ptr_to_copy; } else { throw bad_any_cast{}; } } template &lt;typename T&gt; const std::remove_reference_t&lt;T&gt;* unihold::pointer_any_cast(const std::any* wrapper, bool&amp; is_owner) { using namespace std; using NR_T = remove_reference_t&lt;T&gt;; // No_reference_T //     wrapper NR_T*const * double_ptr_to_original = any_cast&lt;NR_T*&gt;(wrapper); //      wrapper const NR_T* ptr_to_copy; //remove_reference_t&lt;T&gt;* ptr2 = any_cast&lt;remove_reference_t&lt;T&gt;&gt;(&amp;wrapper); if (double_ptr_to_original) { // Wrapper      is_owner = false; return *double_ptr_to_original; } else if (ptr_to_copy = any_cast&lt;NR_T&gt;(wrapper)) { // Wrapper    is_owner = true; return ptr_to_copy; } else { throw bad_any_cast{}; } } template &lt;typename T&gt; std::remove_reference_t&lt;T&gt;* unihold::pointer_any_cast(std::any* wrapper) { bool result; return pointer_any_cast&lt;T&gt;(wrapper, result); } template &lt;typename T&gt; const std::remove_reference_t&lt;T&gt;* unihold::pointer_any_cast(const std::any* wrapper) { bool result; return pointer_any_cast&lt;T&gt;(wrapper, result); }</span></span></code> </pre><br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br>  рдореИрдВрдиреЗ C ++ рдореЗрдВ рдЧрддрд┐рд╢реАрд▓ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдВрднрд╛рд╡рд┐рдд рддрд░реАрдХреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХрд╛ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рд╡рд░реНрдгрди рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХреАред  рдЗрд╕рдХреЗ рдмрд╛рдж, рдпрд╣ C ++ рдбреЗрд▓реАрдЧреЗрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЖрдзрд╛рд░ рдмрдиреЗрдЧрд╛ (рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдореИрдВрдиреЗ рдкрд╣рд▓реЗ рд╣реА рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдореВрд▓ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛, рдЕрд░реНрдерд╛рддреН рдмрд╣реБрд░реВрдкреА рдкреНрд░рддрд┐рдирд┐рдзрд┐рдпреЛрдВ рдХреЛ рд▓рд┐рдЦ рджрд┐рдпрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЛрдб рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдФрд░ рдХреБрдЫ рдЕрд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЛ рдЕрднреА рднреА рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ)ред  рдирд┐рдХрдЯ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдореИрдВ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдкрд░ рдХрд╛рдо рдЦрддреНрдо рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рдмрдирд╛ рд░рд╣рд╛ рд╣реВрдВ рдФрд░ рдпрд╣ рдмрддрд╛рддрд╛ рд╣реВрдВ рдХрд┐ рдореИрдВрдиреЗ рд╕реА ++ рдореЗрдВ рдмрд╛рдХреА рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЛ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ред <br><br>  PS RTTI рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдЧрд▓реЗ рднрд╛рдЧ рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi457160/">https://habr.com/ru/post/hi457160/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi457144/index.html">рд╣рдо рдПрдХ рдПрдореБрд▓реЗрдЯрд░ рд▓рд┐рдЦрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдХреА рдХрд┐рд╕реА рдХреЛ рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ</a></li>
<li><a href="../hi457150/index.html">рдирдпрд╛ рд╡рд┐рдВрдбреЛрдЬ рдЯрд░реНрдорд┐рдирд▓ рдЕрдм рдорд╛рдЗрдХреНрд░реЛрд╕реЙрдлреНрдЯ рд╕реНрдЯреЛрд░ рдкрд░ рдЙрдкрд▓рдмреНрдз рд╣реИ</a></li>
<li><a href="../hi457152/index.html">DEFCON 25 рд╕рдореНрдореЗрд▓рдиред рдЧреИрд░реА рдХрд╛рд╕реНрдкрд░реЛрд╡ред "рдорд╕реНрддрд┐рд╖реНрдХ рдХреА рдЕрдВрддрд┐рдо рд▓рдбрд╝рд╛рдИред" рднрд╛рдЧ 1</a></li>
<li><a href="../hi457154/index.html">рдкреНрд░рддреНрдпреЗрдХ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдЙрддреНрддрд░рджрд╛рдпреА рдРрдк рдбрд┐рдЬрд╝рд╛рдЗрди</a></li>
<li><a href="../hi457156/index.html">рднрд╡рд┐рд╖реНрдп рдХреЗ рдХрдВрдкреНрдпреВрдЯрд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреНрдпрд╛ рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi457164/index.html">ReactiveUI рдФрд░ Avalonia рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдбрд┐рд╕реНрдХ рдХреЛ рд╕рд╣реЗрдЬрдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рдПрдХ рдХреНрд░реЙрд╕-рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо .NET рдХреЛрд░ рдПрдкреНрд▓реАрдХреЗрд╢рди рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрд╢рди</a></li>
<li><a href="../hi457168/index.html">рдкрд╛рдпрдерди рдФрд░ TextBlob рдХреЗ рд╕рд╛рде рдкреНрд░реЛрдЯреЛрдЯрд╛рдЗрдк рд╕реЗрдВрдЯреАрдореЗрдВрдЯ рд╡рд┐рд╢реНрд▓реЗрд╖рдг</a></li>
<li><a href="../hi457172/index.html">ScreenLogger - рдореБрд╕реНрдХрд╛рди, рдЖрдкрдХреЛ рдПрдХ рдЫрд┐рдкреЗ рд╣реБрдП рдХреИрдорд░реЗ рджреНрд╡рд╛рд░рд╛ рдлрд┐рд▓реНрдорд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ</a></li>
<li><a href="../hi457178/index.html">рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреИрд╕реЗ рдбрд┐рдЬрд╛рдЗрди рдФрд░ рдирд┐рд░реНрдорд┐рдд рд╣реЛрддреЗ рд╣реИрдВ: рд╕реАрдкреАрдпреВ рдбрд┐рдЬрд╛рдЗрди</a></li>
<li><a href="../hi457180/index.html">рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕рд╛рдЗрдЯ Node.js рдЕрдм рд░реВрд╕реА рдореЗрдВ рд╣реИ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>