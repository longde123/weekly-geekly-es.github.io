<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéØ üë®‚Äçüë®‚Äçüë¶ üï• Automatizaci√≥n contra el caos üë®‚Äç‚ù§Ô∏è‚Äçüíã‚Äçüë® üõ•Ô∏è üë∂üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El desarrollo moderno de las tecnolog√≠as de TI ha permitido frenar los enormes flujos de datos. 
 El negocio tiene varias herramientas: CRM, ERP, BPM,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatizaci√≥n contra el caos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421705/"><img src="https://habrastorage.org/webt/qz/sq/j9/qzsqj9kwc7g4xeaponeocm3phxy.jpeg"><br><br>  El desarrollo moderno de las tecnolog√≠as de TI ha permitido frenar los enormes flujos de datos. <br>  El negocio tiene varias herramientas: CRM, ERP, BPM, sistemas de contabilidad o, en casos extremos, solo Excel y Word. <br><br>  Las empresas tambi√©n son diferentes.  Algunos est√°n formados por muchas ramas separadas.  En este caso, el negocio tiene un problema de sincronizaci√≥n de datos en el zool√≥gico de sistemas de TI.  Adem√°s, las sucursales difieren en los proveedores o las versiones de software.  Y los cambios frecuentes en los requisitos de informes de la compa√±√≠a administradora causan episodios de "alegr√≠a" incontrolada en el campo. <br><br>  Esta historia trata sobre un proyecto en el que encontr√© un caos que necesitaba ser sistematizado y automatizado.  Un presupuesto modesto y plazos ajustados limitaron el uso de la mayor√≠a de las soluciones industriales, pero abrieron espacio para la creatividad. <br><a name="habracut"></a><br><h2>  Formato universal </h2><br>  El cliente estableci√≥ la tarea de recopilar datos para informes de todas las sucursales de la empresa.  Para comprender la escala del desastre, hay docenas de sistemas, incluidos los hechos a s√≠ mismos y los monstruos como SAP y, por supuesto, 1C, sin ellos. <br><br>  En un informe, podr√≠an cruzarse datos de: contabilidad, reparadores, especialistas en relaciones p√∫blicas, el Ministerio de Emergencias, meteor√≥logos. <br><br>  Antes del inicio del proyecto, la mayor parte de los datos se enviaron a la empresa matriz por correo electr√≥nico en forma de archivos adjuntos de Word / Excel.  Adem√°s, el proceso se parec√≠a a una puesta de sol de forma manual: los datos fueron procesados ‚Äã‚Äãpor personas especialmente capacitadas y se ingresaron en un par de sistemas.  El resultado del trabajo fueron docenas de informes, sobre la base de los cuales se tomaron decisiones administrativas. <br><br>  La elecci√≥n del enfoque se debi√≥ al formato de los archivos transferidos, a saber, xlsx / docx.  Incluso los sistemas "antiguos" en las sucursales soportaban la carga de datos a estos formatos, bueno, o en casos extremos, nadie cancel√≥ copiar y pegar. <br><br>  Nuestro obstinado plan era este: <br><br><ol><li>  describa la estructura de cada informe y las reglas para su transmisi√≥n; </li><li>  reducimos los requisitos para configurar sistemas de env√≠o de documentos por correo electr√≥nico de acuerdo con la normativa a las sucursales.  Donde no hay sistemas: env√≠o, como antes, a mano; </li><li>  Estamos desarrollando un programa que: <br><ul><li>  selecciona ciertos documentos del correo entrante; </li><li>  extrae datos de ellos; </li><li>  escribe los datos extra√≠dos en la base de datos, as√≠ como "golpeando" a los infractores de las regulaciones. </li></ul><br></li></ol><br><img src="https://habrastorage.org/webt/6b/na/ev/6bnaevbsj113vtojoryl6pkxt2s.png"><br><br><h2>  Implementaci√≥n </h2><br><h3>  Asuntos de organizaci√≥n </h3><br>  En la etapa de recopilaci√≥n y formalizaci√≥n de los requisitos para la estructura y regulaci√≥n de la transferencia de datos, result√≥ que no hab√≠a una descripci√≥n de la estructura de los informes.  Todo fue almacenado en la mente de algunos empleados y fue transmitido como cuentos populares rusos de boca en boca.  Pero los problemas reales comenzaron m√°s tarde, al configurar el intercambio de datos. <br><br><h4>  Problema uno </h4><br>  La diferencia entre la estructura de los documentos de la referencia y la calidad de los datos.  En los informes, las cantidades a veces no converg√≠an, las columnas se mezclaban o ten√≠an nombres incorrectos.  El problema se observ√≥ principalmente en las sucursales donde los datos se introdujeron manualmente. <br><br>  La soluci√≥n es la implementaci√≥n de una verificaci√≥n de tres pasos: <br><br><ol><li>  Creaci√≥n de documentos Excel de referencia con una estructura r√≠gida, utilizando Excel mismo.  En dichos documentos, solo las celdas de entrada de datos estaban disponibles.  Sobre los cuales se impusieron controles adicionales: tipo, convergencia de importes, etc. </li><li>  Comprueba al extraer datos del informe.  Por ejemplo, una comparaci√≥n de la fecha actual y la fecha en un p√°rrafo de un documento de Word o verificaciones aritm√©ticas de datos de un documento de Excel (si no se pueden especificar en el documento mismo). </li><li>  An√°lisis profundo de datos despu√©s de la recolecci√≥n.  Por ejemplo, la detecci√≥n de desviaciones significativas en indicadores clave en comparaci√≥n con per√≠odos anteriores. </li></ol><br><h4>  Segundo problema </h4><br>  Una violaci√≥n sistem√°tica del cronograma de transferencia de datos o intentos sin escr√∫pulos de sabotaje: "En general, nunca enviamos datos a nadie, pero aqu√≠ est√°s con los m√≠os ...", "S√≠, envi√© todo a tiempo, probablemente sea un mal ping". <br><br>  La soluci√≥n es la retroalimentaci√≥n.  El sistema notifica autom√°ticamente a las personas responsables en la sucursal en caso de una violaci√≥n de horario.  M√°s tarde, el subsistema de retroalimentaci√≥n se atornill√≥ al sistema de control de calidad de datos de entrada y al sistema de informe final, de modo que la sucursal recibir√≠a inmediatamente un conjunto de sus datos y se comparar√≠a con los "vecinos".  <s>Para dejar en claro por qu√© rastrilla.</s> <br><br><h3>  Subsistemas Desarrollados </h3><br><br><ol><li>  Configurador de tipos de documentos con datos, en los que puede describir r√°pidamente: <br><ul><li>  signos para identificar el documento; </li><li>  regulaciones de transferencia; </li><li>  algoritmo de extracci√≥n de datos; </li><li>  otros atributos como la ruta al c√≥digo que valida y almacena los datos. </li></ul><br></li><li>  Un destinatario de correo que mueve los archivos adjuntos a un almacenamiento aislado (sandbox) y almacena informaci√≥n relacionada sobre la carta; </li><li>  Un analizador de archivos adjuntos que define tipos de documentos y extrae datos de ellos. </li></ol><br><img src="https://habrastorage.org/webt/7s/bp/ef/7sbpefc8oczlxcc6xyrauq4309y.png"><br><br><h4>  Configurador </h4><br>  Hist√≥ricamente, todos los documentos con datos llegan al correo general, donde est√° lleno de otras cartas importantes y no tan importantes.  Necesitamos signos por los cuales se determinar√°n los documentos necesarios.  El nombre del documento o el texto en el cuerpo del correo electr√≥nico es poco confiable e inconveniente para el remitente.  Por lo tanto, se decidi√≥ que la membres√≠a en el informe estar√° determinada solo por el contenido del documento.  Adem√°s, debe determinar inequ√≠vocamente qu√© tipo de informe contiene el documento. <br><br>  Se les ocurri√≥ una lluvia de ideas sobre el r√°bano picante que sabe cu√°ntos signos identificar un documento: el color del texto en una celda, fuente, etc.  Pero lo m√°s correcto fue el signo de la presencia de una subcadena en una determinada "ranura" de celda o una matriz de celdas para Excel y un p√°rrafo o encabezado para Word.  Se agreg√≥ una l√≥gica formal simple para el "espacio": "igual", "desigual", "m√°s", "menos", etc. Ejemplo para Excel: en el rango A2-E4, el texto de la celda debe ser igual a "Resumen diario de carga de equipo". <br><br><img src="https://habrastorage.org/webt/km/aj/ea/kmajeaf8og5y17cnfronq3x2wmq.png"><br><br>  El √°rea del documento en la que desea buscar el principio y el final de los datos se configura de manera similar (aprox. Condiciones para encontrar el final: 2 l√≠neas en blanco en una fila). <br><br><img src="https://habrastorage.org/webt/u1/9t/hh/u19thhrwphi6bbdfifx1bt6tk84.png"><br><br>  Otras configuraciones √∫tiles incluyen una lista de remitentes resueltos, un tipo de documento (Excel / Word) y una ruta para exportar datos. <br><br>  En la salida, obtenemos una estructura JSON (plantilla) que describe el informe. <br><br><h4>  Destinatario de correo </h4><br>  Un lector de correo que coloca todos los documentos de los archivos adjuntos en la caja de arena, guarda los atributos de la carta y coloca los documentos en la cola de tareas para su an√°lisis. <br><br>  Hay 2 preguntas de seguridad: <br><br><ol><li>  ¬øQu√© pasa si los datos se env√≠an a otra sucursal? </li><li>  ¬øQu√© pasa si los atacantes env√≠an los datos? </li></ol><br>  El primer problema se resuelve al conciliar la direcci√≥n de correo electr√≥nico de la rama de env√≠o y la rama especificada en el cuerpo del informe. <br><br>  El segundo est√° usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SPF</a> . <br><br><h4>  Analizador de archivos adjuntos </h4><br>  Casi todas las bibliotecas para analizar Word y Excel tienen serias limitaciones en las versiones compatibles, por lo que, para empezar, el documento debe convertirse.  Libre Office resuelve este problema por cinco. <br><br>  Despu√©s de la conversi√≥n: <br><br><ol><li>  filtramos una matriz de plantillas de acuerdo con las caracter√≠sticas b√°sicas del configurador (Word / Excel, remitente ...); </li><li>  ejecute el documento con las plantillas restantes; </li><li>  Si se encuentra la plantilla, extraemos los datos y los transferimos al repositorio. </li></ol><br><h2>  Resumen </h2><br>  Lo hicimos! <br>  Despu√©s de dos meses de arduo trabajo, la oficina central comenz√≥ a recibir regularmente datos para informes de todas las sucursales.  Adem√°s, la calidad e integridad de los datos fue sin precedentes diferente de lo que era antes, y los recursos humanos liberados recuperaron los costos del proyecto a finales de a√±o. <br><br>  Para nosotros mismos, aprendimos que la integraci√≥n no siempre es dolorosa y destacamos los principales aspectos del √©xito: <br><br><ol><li>  no entramos en sistemas en sucursales; </li><li>  formaliz√≥ y aprob√≥ una estructura √∫nica de informes y reglamentos para su transmisi√≥n; </li><li>  plantillas creadas de formatos de salida generalmente disponibles para todos los sistemas en forma de documentos Excel y Word; </li><li>  eligi√≥ el m√©todo m√°s com√∫n de entrega de datos: correo electr√≥nico. </li></ol><br>  Y dos desventajas principales: <br><br><ul><li>  Baja velocidad de entrega de datos. </li><li>  El tama√±o del paquete de datos no debe exceder el tama√±o de un archivo adjunto de correo electr√≥nico normal. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es421705/">https://habr.com/ru/post/es421705/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es421693/index.html">La historia de una API: c√≥mo convertimos a Frankenstein en guapo</a></li>
<li><a href="../es421695/index.html">[No] redes convencionales: c√≥mo detectar agua en una bolsa usando Wi-Fi</a></li>
<li><a href="../es421699/index.html">C√≥mo deshacerse de los errores con las tablas de objetos activos al restaurar Jira desde la copia de seguridad</a></li>
<li><a href="../es421701/index.html">Python Learning Sandbox y Cheat Sheet</a></li>
<li><a href="../es421703/index.html">Linux en casa o ...</a></li>
<li><a href="../es421707/index.html">FB2D - Marco 2D para Linux Frame Buffer (Rust)</a></li>
<li><a href="../es421709/index.html">Unidades CSS nuevas (y antiguas) de las que apenas oy√≥ hablar</a></li>
<li><a href="../es421711/index.html">An√°lisis de solicitudes de servicio utilizando machine learning</a></li>
<li><a href="../es421713/index.html">C√≥mo encontrar bots en YouTube: patrones de interacci√≥n de comentaristas externos</a></li>
<li><a href="../es421717/index.html">¬øD√≥nde estudian los analistas?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>