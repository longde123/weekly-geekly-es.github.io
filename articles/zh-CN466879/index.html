<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â™ï¸ ğŸ•¢ ğŸš½ JavaScriptå’ŒNode.jsä¸­çš„æœ€ä½³æµ‹è¯•æŠ€æœ¯ ğŸˆ¸ ğŸ—ï¸ ğŸ¤µğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="è¿™æ˜¯æä¾›JavaScriptå’ŒNode.jså¯é æ€§çš„ç»¼åˆæŒ‡å—ã€‚ è¿™é‡Œæ”¶é›†äº†æ•°åç§æœ€å¥½çš„å¸–å­ï¼Œä¹¦ç±å’Œå·¥å…·ã€‚ 

 é¦–å…ˆï¼Œå¤„ç†ä½œä¸ºä»»ä½•åº”ç”¨ç¨‹åºåŸºç¡€çš„å…¬è®¤æµ‹è¯•æ–¹æ³•ã€‚ ç„¶åï¼Œæ‚¨å¯ä»¥æ·±å…¥ç ”ç©¶è‡ªå·±æ„Ÿå…´è¶£çš„é¢†åŸŸï¼šå‰ç«¯å’Œæ¥å£ï¼Œåç«¯ï¼ŒCIæˆ–ä»¥ä¸Šæ‰€æœ‰å†…å®¹ã€‚ 

 ç›®å½•å†…å®¹ 


- ç¬¬0èŠ‚ã€‚é»„é‡‘æ³•åˆ™ã€‚ ä¸€ä¸ªå»ºè®®æ˜¯æ‰€æœ‰å…¶...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>JavaScriptå’ŒNode.jsä¸­çš„æœ€ä½³æµ‹è¯•æŠ€æœ¯</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/466879/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/t2/fe/u-/t2feu-mapmlc7txb2ith9futkie.jpeg"></div><br> è¿™æ˜¯æä¾›JavaScriptå’ŒNode.jså¯é æ€§çš„ç»¼åˆæŒ‡å—ã€‚ è¿™é‡Œæ”¶é›†äº†æ•°åç§æœ€å¥½çš„å¸–å­ï¼Œä¹¦ç±å’Œå·¥å…·ã€‚ <br><br> é¦–å…ˆï¼Œå¤„ç†ä½œä¸ºä»»ä½•åº”ç”¨ç¨‹åºåŸºç¡€çš„å…¬è®¤æµ‹è¯•æ–¹æ³•ã€‚ ç„¶åï¼Œæ‚¨å¯ä»¥æ·±å…¥ç ”ç©¶è‡ªå·±æ„Ÿå…´è¶£çš„é¢†åŸŸï¼šå‰ç«¯å’Œæ¥å£ï¼Œåç«¯ï¼ŒCIæˆ–ä»¥ä¸Šæ‰€æœ‰å†…å®¹ã€‚ <br><a name="habracut"></a><br><h1> ç›®å½•å†…å®¹ </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬0èŠ‚ã€‚é»„é‡‘æ³•åˆ™ã€‚</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ä¸ªå»ºè®®æ˜¯æ‰€æœ‰å…¶ä»–å»ºè®®èƒŒåçš„æ¨åŠ¨åŠ›ï¼ˆ1ä¸ªç‰¹æ®Šç« èŠ‚ï¼‰ã€‚</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬1èŠ‚ã€‚æµ‹è¯•çš„å‰–æã€‚</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸºç¡€çŸ¥è¯†ï¼šåˆ›å»ºå¯ç†è§£çš„æµ‹è¯•ï¼ˆ12ç« ï¼‰ã€‚</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬2èŠ‚ã€‚åç«¯ã€‚</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ‰æ•ˆåœ°ç¼–å†™é’ˆå¯¹åç«¯å’Œå¾®æœåŠ¡çš„æµ‹è¯•ï¼ˆ8ç« ï¼‰ã€‚</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬3èŠ‚ã€‚å‰ç«¯ï¼Œæ¥å£ï¼Œç«¯åˆ°ç«¯ã€‚</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘ä»¬æ­£åœ¨ä¸ºWebç•Œé¢ç¼–å†™æµ‹è¯•ï¼ŒåŒ…æ‹¬ç»„ä»¶å’ŒE2Eæµ‹è¯•ï¼ˆ11ç« ï¼‰ã€‚</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬4èŠ‚ã€‚æµ‹è¯•æœ‰æ•ˆæ€§çš„åº¦é‡ã€‚</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è§‚å¯Ÿè€…çš„è§‚å¯Ÿï¼šæµ‹è¯•è´¨é‡è¯„ä¼°ï¼ˆ4ç« ï¼‰ã€‚</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬5èŠ‚ã€‚æŒç»­é›†æˆã€‚</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JSä¸–ç•Œä¸­çš„CIå»ºè®®ï¼ˆ9ç« ï¼‰ã€‚</a> </li></ul><br><a name="1"></a><h1> ç¬¬0èŠ‚ï¼šé»„é‡‘æ³•åˆ™ </h1><br><h2>  0.é»„é‡‘æ³•åˆ™ï¼šåšæŒç²¾ç›Šæµ‹è¯• </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> æµ‹è¯•ä»£ç ä¸æ‰€è¿è¡Œçš„ä»£ç ä¸åŒã€‚ ä½¿å®ƒå°½å¯èƒ½ç®€å•ï¼Œç®€çŸ­ï¼Œæ²¡æœ‰æŠ½è±¡ï¼Œå•ä¸€ï¼Œå·¥ä½œç²¾ç›Šå’ŒèŠ‚ä¿­ã€‚ å¦ä¸€ä¸ªäººåº”è¯¥æŸ¥çœ‹æµ‹è¯•å¹¶ç«‹å³äº†è§£ä»–åœ¨åšä»€ä¹ˆã€‚ <br><br> æˆ‘ä»¬çš„è´Ÿè´£äººå¿™äºç”Ÿäº§ä»£ç ï¼Œä»–ä»¬æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å¢åŠ å¤æ‚æ€§ã€‚ å¦‚æœæˆ‘ä»¬å°†æ–°çš„å¤æ‚ä»£ç éƒ¨åˆ†æ”¾åˆ°æˆ‘ä»¬çš„å¯æ€œçš„å¤´è„‘ä¸­ï¼Œè¿™å°†å‡æ…¢æ•´ä¸ªå›¢é˜Ÿåœ¨è¯¥ä»»åŠ¡ä¸Šçš„å·¥ä½œï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬æ­£åœ¨å¯¹å…¶è¿›è¡Œæµ‹è¯•ã€‚ å®é™…ä¸Šï¼Œå› æ­¤ï¼Œè®¸å¤šå›¢é˜Ÿåªæ˜¯é¿å¼€äº†æµ‹è¯•ã€‚ <br><br> æµ‹è¯•æ˜¯è·å¾—å‹å¥½å’Œå¾®ç¬‘åŠ©æ‰‹çš„æœºä¼šï¼Œä¸ä»–ä¸€èµ·å·¥ä½œéå¸¸å¥½ï¼Œå¹¶ä¸”ä»å°é¢æŠ•èµ„ä¸­è·å¾—äº†ä¸°åšçš„å›æŠ¥ã€‚ ç§‘å­¦å®¶è®¤ä¸ºï¼Œåœ¨æˆ‘ä»¬çš„å¤§è„‘ä¸­ï¼Œæœ‰ä¸¤ç§ç³»ç»Ÿï¼šä¸€ç§ç”¨äºä¸éœ€è¦åŠ›æ°”çš„åŠ¨ä½œï¼ˆä¾‹å¦‚åœ¨ç©ºæ—·çš„é“è·¯ä¸Šè¡Œé©¶ï¼‰ï¼Œå¦ä¸€ç§ç”¨äºéœ€è¦æ„è¯†çš„å¤æ‚æ“ä½œï¼ˆä¾‹å¦‚æ±‚è§£æ•°å­¦æ–¹ç¨‹å¼ï¼‰ã€‚ ä¸ºç¬¬ä¸€ä¸ªç³»ç»Ÿåˆ›å»ºæµ‹è¯•ï¼Œä»¥ä¾¿åœ¨æŸ¥çœ‹ä»£ç æ—¶è·å¾—ä¸ç¼–è¾‘HTMLæ–‡æ¡£ç±»ä¼¼çš„ç®€å•æ„Ÿè§‰ï¼Œè€Œæ— éœ€ä½¿ç”¨<code>2X(17 Ã— 24)</code>è§£å†³æ–¹æ¡ˆ<code>2X(17 Ã— 24)</code> ã€‚ <br><br> å¯ä»¥é€šè¿‡ä»”ç»†é€‰æ‹©æµ‹è¯•çš„æ–¹æ³•ï¼Œå·¥å…·å’Œç›®æ ‡æ¥å®ç°è¿™ä¸€ç›®æ ‡ï¼Œä»è€Œä½¿å®ƒä»¬æ—¢ç»æµåˆå¯ä»¥å¸¦æ¥è¾ƒå¤§çš„æŠ•èµ„å›æŠ¥ç‡ã€‚ ä»…æ ¹æ®éœ€è¦è¿›è¡Œæµ‹è¯•ï¼Œå¹¶å°½é‡ä¿æŒçµæ´»æ€§ã€‚ æœ‰æ—¶ä¸ºäº†å¿«é€Ÿå’Œç®€å•èµ·è§ï¼Œç”šè‡³å€¼å¾—æ”¾å¼ƒä¸€äº›æµ‹è¯•å¹¶ç‰ºç‰²å¯é æ€§ã€‚ <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f27/bc3/5f9/f27bc35f96e79037157cea807ac5be23.png"><br><br> ä»¥ä¸‹å¤§å¤šæ•°å»ºè®®å‡æºäºè¯¥åŸåˆ™ã€‚ <br>  <b>å‡†å¤‡å¥½äº†å—</b> <br><br><a name="2"></a><h1> ç¬¬1èŠ‚ã€‚æµ‹è¯•å‰–æ </h1><br><h2>  1.1æ¯ä¸ªæµ‹è¯•çš„åç§°åº”ç”±ä¸‰éƒ¨åˆ†ç»„æˆ </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> æµ‹è¯•æŠ¥å‘Šåº”æŒ‡å‡ºè¯¥åº”ç”¨ç¨‹åºçš„å½“å‰ç‰ˆæœ¬æ˜¯å¦æ»¡è¶³é‚£äº›ä¸ç†Ÿæ‚‰è¯¥ä»£ç çš„äººçš„éœ€æ±‚ï¼šå‚ä¸DevOpså·¥ç¨‹å¸ˆéƒ¨ç½²çš„æµ‹è¯•äººå‘˜ä»¥åŠæ‚¨è‡ªå·±åœ¨ä¸¤å¹´å†…ã€‚ æœ€å¥½çš„æ˜¯ï¼Œæµ‹è¯•ä»¥è¦æ±‚çš„è¯­è¨€æŠ¥å‘Šä¿¡æ¯ï¼Œå¹¶ä¸”å…¶åç§°ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š <br><br><ol><li> åˆ°åº•åœ¨æµ‹è¯•ä»€ä¹ˆï¼Ÿ ä¾‹å¦‚ï¼Œ <code>ProductsService.addNewProduct</code>æ–¹æ³•ã€‚ </li><li> åœ¨ä»€ä¹ˆæ¡ä»¶å’Œæƒ…å†µä¸‹ï¼Ÿ ä¾‹å¦‚ï¼Œä»·æ ¼ä¸ä¼ é€’ç»™è¯¥æ–¹æ³•ã€‚ </li><li> é¢„æœŸçš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ ä¾‹å¦‚ï¼Œæ–°äº§å“æœªè¢«æ‰¹å‡†ã€‚ </li></ol><br>  <b>å¦åˆ™ã€‚</b> éƒ¨ç½²å¤±è´¥ï¼Œç§°ä¸ºâ€œæ·»åŠ äº§å“â€çš„æµ‹è¯•å¤±è´¥ã€‚ æ‚¨äº†è§£ä»€ä¹ˆæ˜¯é”™è¯¯çš„å—ï¼Ÿ <br><br>  <b>æ³¨æ„äº‹é¡¹</b> æ¯ç« éƒ½æœ‰ç¤ºä¾‹ä»£ç ï¼Œæœ‰æ—¶è¿˜æœ‰æ’å›¾ã€‚ è§æ‰°æµæ¿ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text">  <b>æ­£ç¡®çš„åšæ³•ã€‚</b> æµ‹è¯•åç§°ç”±ä¸‰éƒ¨åˆ†ç»„æˆã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//1. unit under test describe('Products Service', function() { describe('Add new product', function() { //2. scenario and 3. expectation it('When no price is specified, then the product status is pending approval', ()=&gt; { const newProduct = new ProductService().add(...); expect(newProduct.status).to.equal('pendingApproval'); }); }); });</span></span></code> </pre> <br></div></div><br><h2>  1.2æ ¹æ®AAAæ¨¡å¼æ„å»ºæµ‹è¯• </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> æ¯ä¸ªæµ‹è¯•åº”åŒ…æ‹¬ä¸‰ä¸ªæ˜æ˜¾åˆ†å¼€çš„éƒ¨åˆ†ï¼šå®‰æ’ï¼ˆå‡†å¤‡ï¼‰ï¼Œè¡Œä¸ºï¼ˆè¡ŒåŠ¨ï¼‰å’Œå£°æ˜ï¼ˆç»“æœï¼‰ã€‚ åšæŒè¿™æ ·çš„ç»“æ„å¯ä»¥ç¡®ä¿æ‚¨çš„ä»£ç é˜…è¯»è€…ä¸å¿…ä½¿ç”¨å¤§è„‘å¤„ç†å™¨æ¥ç†è§£æµ‹è¯•è®¡åˆ’ï¼š <br><br> å®‰æ’ï¼šæ ¹æ®æµ‹è¯•æ–¹æ¡ˆä½¿ç³»ç»Ÿè¿›å…¥çŠ¶æ€çš„æ‰€æœ‰ä»£ç ã€‚ è¿™å¯èƒ½åŒ…æ‹¬åœ¨æµ‹è¯•è®¾è®¡å™¨ä¸­åˆ›å»ºæ¨¡å—çš„å®ä¾‹ï¼Œå°†è®°å½•æ·»åŠ åˆ°æ•°æ®åº“ï¼Œåˆ›å»ºå­˜æ ¹è€Œä¸æ˜¯å¯¹è±¡ä»¥åŠä»»ä½•å…¶ä»–å‡†å¤‡ç³»ç»Ÿè¿›è¡Œæµ‹è¯•è¿è¡Œçš„ä»£ç ã€‚ <br><br> è¡ŒåŠ¨ï¼šå°†ä»£ç æ‰§è¡Œä½œä¸ºæµ‹è¯•çš„ä¸€éƒ¨åˆ†ã€‚ é€šå¸¸åªæœ‰ä¸€è¡Œã€‚ <br> å£°æ˜ï¼šç¡®ä¿è·å¾—çš„ä»·å€¼ç¬¦åˆæœŸæœ›ã€‚ é€šå¸¸åªæœ‰ä¸€è¡Œã€‚ <br><br>  <b>å¦åˆ™ã€‚</b> æ‚¨ä¸ä»…ä¼šèŠ±è´¹å¤§é‡æ—¶é—´æ¥å¤„ç†ä¸»è¦ä»£ç ï¼Œè€Œä¸”æ‚¨çš„å¤§è„‘ä¹Ÿä¼šå› åº”åšçš„ç®€å•å·¥ä½œ-æµ‹è¯•è€Œè†¨èƒ€ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text">  <b>æ­£ç¡®çš„åšæ³•ã€‚</b> æ ¹æ®AAAæ¨¡å¼æ„é€ çš„æµ‹è¯•ã€‚ <br><br><pre> <code class="javascript hljs">describe.skip(<span class="hljs-string"><span class="hljs-string">'Customer classifier'</span></span>, () =&gt; { test(<span class="hljs-string"><span class="hljs-string">'When customer spent more than 500$, should be classified as premium'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Arrange const customerToClassify = {spent:505, joined: new Date(), id:1} const DBStub = sinon.stub(dataAccess, "getCustomer") .reply({id:1, classification: 'regular'}); //Act const receivedClassification = customerClassifier.classifyCustomer(customerToClassify); //Assert expect(receivedClassification).toMatch('premium'); }); });</span></span></code> </pre><br>  <b>åæ¨¡å¼çš„ä¸€ä¸ªä¾‹å­ã€‚</b> ä¸€ä»¶ä¸€ä»¶æ²¡æœ‰ä¸€ä»¶åˆ†å¼€çš„äº‹æ›´éš¾è§£é‡Šã€‚ <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'Should be classified as premium'</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> customerToClassify = {<span class="hljs-attr"><span class="hljs-attr">spent</span></span>:<span class="hljs-number"><span class="hljs-number">505</span></span>, <span class="hljs-attr"><span class="hljs-attr">joined</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>(), <span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> DBStub = sinon.stub(dataAccess, <span class="hljs-string"><span class="hljs-string">"getCustomer"</span></span>) .reply({<span class="hljs-attr"><span class="hljs-attr">id</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">classification</span></span>: <span class="hljs-string"><span class="hljs-string">'regular'</span></span>}); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> receivedClassification = customerClassifier.classifyCustomer(customerToClassify); expect(receivedClassification).toMatch(<span class="hljs-string"><span class="hljs-string">'premium'</span></span>); });</code> </pre> <br></div></div><br><h2>  1.3ç”¨äº§å“çš„è¯­è¨€æè¿°æœŸæœ›ï¼šä»¥BDDçš„é£æ ¼é™ˆè¿° </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> ä»¥å£°æ˜å¼çš„æ–¹å¼è¿›è¡Œç¼–ç¨‹æµ‹è¯•ï¼Œä½¿ç”¨æˆ·å¯ä»¥ç«‹å³äº†è§£å…¶æœ¬è´¨ï¼Œè€Œæ— éœ€èŠ±è´¹å•ä¸ªè„‘éƒ¨å¤„ç†å™¨å‘¨æœŸã€‚ å½“æ‚¨ç¼–å†™ä»¥æ¡ä»¶é€»è¾‘åŒ…è£…çš„å‘½ä»¤å¼ä»£ç æ—¶ï¼Œè¯»è€…å¿…é¡»ä»˜å‡ºå¾ˆå¤šåŠªåŠ›ã€‚ ä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œæ‚¨éœ€è¦ä½¿ç”¨æœŸæœ›/åº”è¯¥å¹¶ä¸”ä¸ä½¿ç”¨è‡ªå®šä¹‰ä»£ç ï¼Œä»¥å£°æ˜æ€§çš„BDDé£æ ¼ç”¨ç±»äººè¯­è¨€æè¿°æœŸæœ›ã€‚ å¦‚æœåœ¨Chaiå’ŒJestä¸­æ²¡æœ‰å¿…è¦çš„æ–­è¨€ï¼ˆé€šå¸¸ä¼šé‡å¤æ‰§è¡Œï¼‰ï¼Œåˆ™å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰©å±•åŒ¹é…å™¨Jest</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸ºChai</a>ç¼–å†™<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è‡ªå·±çš„æ’ä»¶</a> ã€‚ <br><br>  <b>å¦åˆ™ã€‚</b> è¯¥å›¢é˜Ÿå°†ç¼–å†™æ›´å°‘çš„æµ‹è¯•ï¼Œå¹¶<code>with .skip()</code>è£…é¥°ä»¤äººè®¨åŒçš„æµ‹è¯•ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨Mochaçš„ç¤ºä¾‹</a> ã€‚ <br><br>  <b>åæ¨¡å¼çš„ä¸€ä¸ªä¾‹å­ã€‚</b> ä¸ºäº†ç†è§£æµ‹è¯•çš„æœ¬è´¨ï¼Œç”¨æˆ·è¢«è¿«é€šè¿‡ç›¸å½“é•¿çš„å¼ºåˆ¶æ€§ä»£ç ã€‚ <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When asking for an admin, ensure only ordered admins in results"</span></span> , ()={ <span class="hljs-comment"><span class="hljs-comment">//assuming we've added here two admins "admin1", "admin2" and "user1" const allAdmins = getUsers({adminOnly:true}); const admin1Found, adming2Found = false; allAdmins.forEach(aSingleUser =&gt; { if(aSingleUser === "user1"){ assert.notEqual(aSingleUser, "user1", "A user was found and not admin"); } if(aSingleUser==="admin1"){ admin1Found = true; } if(aSingleUser==="admin2"){ admin2Found = true; } }); if(!admin1Found || !admin2Found ){ throw new Error("Not all admins were returned"); } });</span></span></code> </pre><br>  <b>æ­£ç¡®çš„åšæ³•ã€‚</b> é˜…è¯»æ­¤å£°æ˜æ€§æµ‹è¯•å¾ˆç®€å•ã€‚ <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When asking for an admin, ensure only ordered admins in results"</span></span> , ()={ <span class="hljs-comment"><span class="hljs-comment">//assuming we've added here two admins const allAdmins = getUsers({adminOnly:true}); expect(allAdmins).to.include.ordered.members(["admin1" , "admin2"]) .but.not.include.ordered.members(["user1"]); });</span></span></code> </pre> <br></div></div><br><h2>  1.4åšæŒé»‘ç›’æµ‹è¯•ï¼šä»…æµ‹è¯•å…¬å…±æ–¹æ³• </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> æµ‹è¯•å†…éƒ¨å°†å¯¼è‡´å·¨å¤§çš„å¼€é”€ï¼Œå¹¶ä¸”å‡ ä¹ä¸€æ— æ‰€è·ã€‚ å¦‚æœæ‚¨çš„ä»£ç æˆ–APIæä¾›äº†æ­£ç¡®çš„ç»“æœï¼Œæ˜¯å¦å€¼å¾—èŠ±ä¸‰ä¸ªå°æ—¶æµ‹è¯•å®ƒå¦‚ä½•åœ¨å†…éƒ¨å·¥ä½œå¹¶éšåæ”¯æŒè¿™äº›è„†å¼±çš„æµ‹è¯•ï¼Ÿ å½“æ£€æŸ¥å…¬å…±è¡Œä¸ºæ—¶ï¼ŒåŒæ—¶éšå¼æ£€æŸ¥å®ç°æœ¬èº«ï¼Œåªæœ‰åœ¨å­˜åœ¨ç‰¹å®šé—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œé”™è¯¯çš„è¾“å‡ºï¼‰æ—¶ï¼Œæµ‹è¯•æ‰ä¼šå¤±è´¥ã€‚ è¿™ç§æ–¹æ³•ä¹Ÿç§°ä¸ºè¡Œä¸ºæµ‹è¯•ã€‚ å¦ä¸€æ–¹é¢ï¼Œå¦‚æœæ‚¨æ­£åœ¨æµ‹è¯•å†…éƒ¨ç»“æ„ï¼ˆâ€œç™½ç›’â€æ–¹æ³•ï¼‰ï¼Œé‚£ä¹ˆæ‚¨å°†ä¸ç€é‡äºè®¡åˆ’ç»„ä»¶çš„è¾“å‡ºï¼Œè€Œæ˜¯å°†é‡ç‚¹æ”¾åœ¨å°ç»†èŠ‚ä¸Šï¼Œå¹¶ä¸”å³ä½¿ä»£ç æ²¡é—®é¢˜ï¼Œæ‚¨çš„æµ‹è¯•ä¹Ÿå¯èƒ½ç”±äºä»£ç çš„ç»†å¾®æ”¹åŠ¨è€Œä¸­æ–­ï¼Œä½†æ˜¯æŠ¤é€å°†å ç”¨æ›´å¤šèµ„æºã€‚ <br><br>  <b>å¦åˆ™ã€‚</b> æ‚¨çš„æµ‹è¯•å°±åƒä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç”·å­©åœ¨å–Šâ€œç‹¼ï¼â€</a>  ï¼šå¤§å£°æŠ¥å‘Šè¯¯æŠ¥ï¼ˆä¾‹å¦‚ï¼Œç”±äºç§æœ‰å˜é‡åç§°çš„æ›´æ”¹ï¼Œæµ‹è¯•å¤±è´¥ï¼‰ã€‚ å¾ˆå¿«äººä»¬å°†å¼€å§‹å¿½ç•¥CIé€šçŸ¥å°±ä¸è¶³ä¸ºå¥‡äº†ï¼Œæœ‰ä¸€å¤©ä»–ä»¬ä¼šé”™è¿‡ä¸€ä¸ªçœŸæ­£çš„bug ... <br><br><div class="spoiler">  <b class="spoiler_title">ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text">  <b>åæ¨¡å¼çš„ä¸€ä¸ªä¾‹å­ã€‚</b> æ²¡æœ‰å……åˆ†çš„ç†ç”±æµ‹è¯•å†…éƒ¨ã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨Mochaçš„ç¤ºä¾‹</a> ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProductService</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//this method is only used internally //Change this name will make the tests fail calculateVAT(priceWithoutVAT){ return {finalPrice: priceWithoutVAT * 1.2}; //Change the result format or key name above will make the tests fail } //public method getPrice(productId){ const desiredProduct= DB.getProduct(productId); finalPrice = this.calculateVATAdd(desiredProduct.price).finalPrice; } } it("White-box test: When the internal methods get 0 vat, it return 0 response", async () =&gt; { //There's no requirement to allow users to calculate the VAT, only show the final price. Nevertheless we falsely insist here to test the class internals expect(new ProductService().calculateVATAdd(0).finalPrice).to.equal(0); });</span></span></code> </pre> <br></div></div><br><h2>  1.5é€‰æ‹©æ­£ç¡®çš„æ¨¡æ‹Ÿå®ç°ï¼šé¿å…ä½¿ç”¨ä¼ªé€ çš„å¯¹è±¡ï¼Œè€Œä½¿ç”¨å­˜æ ¹å’Œé—´è° </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> æ¨¡æ‹Ÿå®ç°ï¼ˆæµ‹è¯•åŒæ‰“ï¼‰æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå› ä¸ºå®ƒä»¬ä¸åº”ç”¨ç¨‹åºçš„å†…éƒ¨ç›¸å…³è”ï¼Œå¹¶ä¸”æœ‰äº›å…·æœ‰å¾ˆå¤§çš„ä»·å€¼ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ·æ–°æ¨¡ä»¿çš„å®ç°çš„å†…å­˜ï¼šä¼ªé€ çš„å¯¹è±¡ï¼ˆæ¨¡æ‹Ÿï¼‰ï¼Œå­˜æ ¹å’Œé—´è°å¯¹è±¡ï¼ˆé—´è°ï¼‰ï¼‰</a> ï¼‰ ä½†æ˜¯ï¼Œå¹¶éæ‰€æœ‰æŠ€æœ¯éƒ½æ˜¯ç­‰æ•ˆçš„ã€‚ é—´è°ç¨‹åºå’Œå­˜æ ¹æ—¨åœ¨æµ‹è¯•éœ€æ±‚ï¼Œä½†å…·æœ‰ä¸å¯é¿å…çš„å‰¯ä½œç”¨-å®ƒä»¬è¿˜ä¼šå¯¹å†…éƒ¨äº§ç”Ÿè½»å¾®å½±å“ã€‚ ä¼ªé€ çš„å¯¹è±¡è¢«è®¾è®¡ä¸ºæµ‹è¯•å†…éƒ¨ï¼Œè¿™å¯¼è‡´äº†å·¨å¤§çš„å¼€é”€ï¼Œå¦‚ç¬¬1.4ç« æ‰€è¿°ã€‚ <br><br> åœ¨ä½¿ç”¨æ¨¡æ‹Ÿå®ç°ä¹‹å‰ï¼Œè¯·é—®è‡ªå·±ä¸€ä¸ªæœ€ç®€å•çš„é—®é¢˜ï¼šâ€œæˆ‘æ˜¯å¦ä½¿ç”¨å®ƒæ¥æµ‹è¯•å·²å‡ºç°åœ¨æ–‡æ¡£ä¸­æˆ–å¯èƒ½å‡ºç°åœ¨éœ€æ±‚ä¸­çš„åŠŸèƒ½ï¼Ÿâ€ å¦‚æœä¸æ˜¯è¿™æ ·ï¼Œå°±ä¼šå‡ºç°ç™½ç›’æµ‹è¯•çš„ç—•è¿¹ã€‚ <br><br> ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æƒ³äº†è§£å½“æ”¯ä»˜æœåŠ¡ä¸å¯ç”¨æ—¶åº”ç”¨ç¨‹åºçš„è¿è¡Œæƒ…å†µæ˜¯å¦åº”è¯¥æŒ‰å…¶åº”æœ‰çš„æ–¹å¼è¿è¡Œï¼Œå¯ä»¥æ”¹æˆä¸€ä¸ªå­˜æ ¹å¹¶è¿”å›â€œ No answerâ€ä»¥æ£€æŸ¥è¢«æµ‹æ¨¡å—æ˜¯å¦è¿”å›äº†æ­£ç¡®çš„å€¼ã€‚ å› æ­¤ï¼Œæ‚¨å¯ä»¥åœ¨æŸäº›æƒ…å†µä¸‹æ£€æŸ¥åº”ç”¨ç¨‹åºçš„è¡Œä¸º/å“åº”/è¾“å‡ºã€‚ æ‚¨è¿˜å¯ä»¥åœ¨é—´è°çš„å¸®åŠ©ä¸‹ç¡®è®¤ï¼Œå½“æœåŠ¡ä¸å¯ç”¨æ—¶ï¼Œä¼šå‘é€ä¿¡å‡½ï¼Œè¿™ä¹Ÿæ˜¯è¡Œä¸ºæµ‹è¯•ï¼Œå¯ä»¥æ›´å¥½åœ°åæ˜ åœ¨æ–‡æ¡£ä¸­ï¼Œå¹¶å¸¦æœ‰è¦æ±‚ï¼ˆâ€œå¦‚æœæ— æ³•ä¿å­˜ä»˜æ¬¾ä¿¡æ¯ï¼Œè¯·å‘é€ä¿¡å‡½â€ï¼‰ã€‚ åŒæ—¶ï¼Œå¦‚æœæ‚¨æä¾›äº†ä¼ªé€ çš„ä»˜æ¬¾æœåŠ¡å¹¶ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„JSç±»å‹è°ƒç”¨äº†è¯¥æœåŠ¡ï¼Œåˆ™æ‚¨çš„æµ‹è¯•å°†é’ˆå¯¹ä¸åº”ç”¨ç¨‹åºåŠŸèƒ½æ— å…³ä¸”å¯èƒ½ç»å¸¸æ›´æ”¹çš„å†…éƒ¨ã€‚ <br><br>  <b>å¦åˆ™ã€‚</b> ä»»ä½•ä»£ç é‡æ„éƒ½æ¶‰åŠæŸ¥æ‰¾å’Œæ›´æ–°ä»£ç ä¸­çš„æ‰€æœ‰ä¼ªé€ å¯¹è±¡ã€‚ æ¥è‡ªåŠ©ç†æœ‹å‹çš„æµ‹è¯•å˜æˆäº†è´Ÿæ‹…ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text">  <b>åæ¨¡å¼çš„ä¸€ä¸ªä¾‹å­ã€‚</b> ä¼ªé€ ç‰©å“æ˜¯ä¸ºäº†èƒ†é‡ã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨Sinonçš„ç¤ºä¾‹</a> ã€‚ <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When a valid product is about to be deleted, ensure data access DAL was called once, with the right product and right config"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Assume we already added a product const dataAccessMock = sinon.mock(DAL); //hmmm BAD: testing the internals is actually our main goal here, not just a side-effect dataAccessMock.expects("deleteProduct").once().withArgs(DBConfig, theProductWeJustAdded, true, false); new ProductService().deletePrice(theProductWeJustAdded); mock.verify(); });</span></span></code> </pre><br>  <b>æ­£ç¡®çš„åšæ³•ã€‚</b> é—´è°æ—¨åœ¨æµ‹è¯•éœ€æ±‚ï¼Œä½†æœ‰å‰¯ä½œç”¨-å®ƒä»¬ä¸å¯é¿å…åœ°ä¼šå½±å“å†…éƒ¨ã€‚ <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When a valid product is about to be deleted, ensure an email is sent"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Assume we already added here a product const spy = sinon.spy(Emailer.prototype, "sendEmail"); new ProductService().deletePrice(theProductWeJustAdded); //hmmm OK: we deal with internals? Yes, but as a side effect of testing the requirements (sending an email) });</span></span></code> </pre> <br></div></div><br><h2>  1.6ä¸è¦ä½¿ç”¨â€œ fooâ€ï¼Œè¦ä½¿ç”¨çœŸå®çš„è¾“å…¥ </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> ç”Ÿäº§é”™è¯¯é€šå¸¸å‘ç”Ÿåœ¨éå¸¸å…·ä½“ä¸”ä»¤äººæƒŠè®¶çš„è¾“å…¥æ•°æ®ä¸Šã€‚ æµ‹è¯•æœŸé—´çš„æ•°æ®è¶ŠçœŸå®ï¼Œå°±è¶Šå¯èƒ½åŠæ—¶å‘ç°é”™è¯¯ã€‚ è¦ç”Ÿæˆæ¨¡æ‹Ÿç”Ÿäº§æ•°æ®çš„ç§ç±»å’Œç±»å‹çš„ä¼ªçœŸå®æ•°æ®ï¼Œè¯·ä½¿ç”¨ç‰¹æ®Šçš„åº“ï¼Œä¾‹å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Faker</a> ã€‚ è¿™æ ·çš„åº“å¯ä»¥ç”Ÿæˆç°å®çš„ç”µè¯å·ç ï¼Œç”¨æˆ·æ˜µç§°ï¼Œé“¶è¡Œå¡ï¼Œå…¬å¸åç§°ï¼Œç”šè‡³æ˜¯æ–‡æœ¬â€œ lorem ipsumâ€ã€‚ æ‚¨å¯ä»¥åˆ›å»ºæµ‹è¯•ï¼ˆåœ¨å•å…ƒæµ‹è¯•ä¹‹ä¸Šï¼Œè€Œä¸æ˜¯ä»£æ›¿å•å…ƒæµ‹è¯•ï¼‰ï¼Œä»¥å°†ä¼ªé€ çš„æ•°æ®éšæœºåŒ–ä»¥ä½¿æ¨¡å—é€‚åˆæµ‹è¯•ï¼Œç”šè‡³å¯ä»¥ä»ç”Ÿäº§ç¯å¢ƒä¸­å¯¼å…¥çœŸå®æ•°æ®ã€‚ æƒ³èµ°å¾—æ›´è¿œå—ï¼Ÿ é˜…è¯»ä¸‹ä¸€ç« ï¼ˆå…³äºåŸºäºå±æ€§çš„æµ‹è¯•ï¼‰ã€‚ <br><br>  <b>å¦åˆ™ã€‚</b> ä½¿ç”¨è¯¸å¦‚â€œ Fooâ€ä¹‹ç±»çš„åˆæˆè¾“å…¥ï¼Œæ‚¨çš„å¼€å‘æµ‹è¯•å°†çœ‹èµ·æ¥æˆåŠŸï¼Œå¹¶ä¸”å½“é»‘å®¢<code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code>è¯¸å¦‚<code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code>ç±»<code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code>æ£˜æ‰‹ä»£ç æ—¶ï¼Œç”Ÿäº§æ•°æ®å¯èƒ½ä¼šå¤±è´¥<code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code>  <code>@3e2ddsf . ##' 1 fdsfds . fds432 AAAA</code> ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text">  <b>åæ¨¡å¼çš„ä¸€ä¸ªä¾‹å­ã€‚</b> ç”±äºä½¿ç”¨äº†ä¸çœŸå®çš„æ•°æ®ï¼Œæµ‹è¯•å¥—ä»¶æˆåŠŸè¿è¡Œã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨Jestçš„ç¤ºä¾‹</a> ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addProduct = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name, price</span></span></span><span class="hljs-function">) =&gt;</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> productNameRegexNoSpace = <span class="hljs-regexp"><span class="hljs-regexp">/^\S*$/</span></span>;<span class="hljs-comment"><span class="hljs-comment">//no white-space allowed if(!productNameRegexNoSpace.test(name)) return false;//this path never reached due to dull input //some logic here return true; }; test("Wrong: When adding new product with valid properties, get successful confirmation", async () =&gt; { //The string "Foo" which is used in all tests never triggers a false result const addProductResult = addProduct("Foo", 5); expect(addProductResult).to.be.true; //Positive-false: the operation succeeded because we never tried with long //product name including spaces });</span></span></code> </pre><br>  <b>æ­£ç¡®çš„åšæ³•ã€‚</b> éšæœºåŒ–ç°å®è¾“å…¥ã€‚ <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"Better: When adding new valid product, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> addProductResult = addProduct(faker.commerce.productName(), faker.random.number()); <span class="hljs-comment"><span class="hljs-comment">//Generated random input: {'Sleek Cotton Computer', 85481} expect(addProductResult).to.be.true; //Test failed, the random input triggered some path we never planned for. //We discovered a bug early! });</span></span></code> </pre> <br></div></div><br><h2>  1.7ä½¿ç”¨åŸºäºå±æ€§çš„æµ‹è¯•æ¥éªŒè¯å¤šä¸ªè¾“å…¥ç»„åˆ </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> é€šå¸¸ï¼Œå¯¹äºæ¯ä¸ªæµ‹è¯•ï¼Œæˆ‘ä»¬éƒ½ä¼šé€‰æ‹©å‡ ä¸ªè¾“å…¥æ•°æ®æ ·æœ¬ã€‚ å³ä½¿è¾“å…¥æ ¼å¼ç±»ä¼¼äºçœŸå®æ•°æ®ï¼ˆè¯·å‚é˜…â€œè¯·å‹¿ä½¿ç”¨â€ fooâ€ä¸€ç« ï¼‰ï¼Œæˆ‘ä»¬ä¹Ÿä»…æ¶µç›–è¾“å…¥æ•°æ®çš„å‡ ç§ç»„åˆï¼ˆæ–¹æ³•<code>('', true, 1)</code> ï¼Œæ–¹æ³•<code>("string" , false" , 0)</code> ï¼‰ã€‚ä½†åœ¨æ“ä½œä¸­ï¼Œå¯ä»¥ç”¨æ•°åƒç§ä¸åŒçš„ç»„åˆè°ƒç”¨ç”¨äº”ä¸ªå‚æ•°è°ƒç”¨çš„APIï¼Œå…¶ä¸­ä¸€ç§ä¼šå¯¼è‡´è¿›ç¨‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å´©æºƒ</a> ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¨¡ç³Š</a> ï¼‰ã€‚å¦‚æœç¼–å†™ä¸€ä¸ªè‡ªåŠ¨å‘é€1000ä¸ªè¾“å…¥æ•°æ®ç»„åˆçš„æµ‹è¯•ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿä¿®å¤ï¼Œä»£ç ä»¥ä»€ä¹ˆç»„åˆä¸èƒ½è¿”å›æ­£ç¡®ç­”æ¡ˆï¼Ÿæˆ‘ä»¬å¯¹mæ‰€åšçš„ç›¸åŒæ“ä½œ  todikeåŸºäºæ€§èƒ½æµ‹è¯•ï¼šé€šè¿‡å‘é€è¾“å…¥æ•°æ®çš„æ‰€æœ‰å¯èƒ½ç»„åˆæˆæµ‹è¯•å•å…ƒæˆ‘ä»¬å¢åŠ ä¸€ä¸ªé”™è¯¯æ£€æµ‹çš„æœºä¼šï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹æ³•ã€‚ <code>addNewProduct(id, name, isDiscount)</code>æ”¯æŒä»–çš„åº“å°†è°ƒç”¨æ­¤æ–¹æ³•æœ‰å¤šç§ç»„åˆã€‚ <code>(,  ,  )</code> ï¼Œä¾‹å¦‚<code>(1, "iPhone", false)</code> ï¼Œ <code>(2, "Galaxy", true)</code>ç­‰ã€‚æ‚¨å¯ä»¥ä½¿ç”¨è‡ªå·±å–œæ¬¢çš„æµ‹è¯•è¿è¡Œå™¨ï¼ˆMochaï¼ŒJest <code>(2, "Galaxy", true)</code>åŸºäºå±æ€§è¿›è¡Œæµ‹è¯•ç­‰ï¼‰å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">js-verify</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">testcheckä¹‹</a>ç±»çš„åº“ï¼ˆå®ƒæœ‰æ›´å¥½çš„æ–‡æ¡£ï¼‰ã€‚ æ‚¨è¿˜å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°è¯•å¿«é€Ÿæ£€æŸ¥åº“</a> ï¼Œè¯¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åº“</a>æä¾›äº†é™„åŠ åŠŸèƒ½ï¼Œå¹¶ç”±ä½œè€…ç§¯ææä¾›ã€‚ <br><br>  <b>å¦åˆ™ã€‚</b> æ‚¨æ— æ‰€é¡¾å¿Œåœ°ä¸ºæµ‹è¯•é€‰æ‹©äº†è¾“å…¥æ•°æ®ï¼Œè¯¥æ•°æ®ä»…æ¶µç›–åŠŸèƒ½è‰¯å¥½çš„ä»£ç æ‰§è¡Œè·¯å¾„ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œè¿™é™ä½äº†æµ‹è¯•ä½œä¸ºæ£€æµ‹é”™è¯¯çš„æ‰‹æ®µçš„æœ‰æ•ˆæ€§ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text">  <b>æ­£ç¡®çš„åšæ³•ã€‚</b> ä½¿ç”¨mocha-testcheckæµ‹è¯•å¤šç§ç»„åˆã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'mocha-testcheck'</span></span>).install(); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {expect} = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'chai'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> faker = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'faker'</span></span>); describe(<span class="hljs-string"><span class="hljs-string">'Product service'</span></span>, () =&gt; { describe(<span class="hljs-string"><span class="hljs-string">'Adding new'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//this will run 100 times with different random properties check.it('Add new product with random yet valid properties, always successful', gen.int, gen.string, (id, name) =&gt; { expect(addNewProduct(id, name).status).to.equal('approved'); }); }) });</span></span></code> </pre> <br></div></div><br><h2>  1.8å¦‚æœ‰å¿…è¦ï¼Œè¯·ä»…ä½¿ç”¨çŸ­é•œå¤´å’Œå†…è”é•œå¤´ã€‚ </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> å½“æ‚¨éœ€è¦<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸºäºå¿«ç…§</a>è¿›è¡Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æµ‹è¯•æ—¶</a> ï¼Œè¯·ä»…ä½¿ç”¨ç®€çŸ­çš„å¿«ç…§ï¼Œè€Œä¸ä½¿ç”¨æ‰€æœ‰å¤šä½™çš„å¿«ç…§ï¼ˆä¾‹å¦‚ï¼Œåœ¨3-7è¡Œä¸­ï¼‰ï¼ŒåŒ…æ‹¬å®ƒä»¬ä½œä¸ºæµ‹è¯•çš„ä¸€éƒ¨åˆ†ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Inline Snapshot</a> ï¼‰ï¼Œè€Œä¸ä½œä¸ºå¤–éƒ¨æ–‡ä»¶ã€‚ éµå¾ªæ­¤å»ºè®®å°†ä½¿æ‚¨çš„æµ‹è¯•ä¸è¨€è€Œå–»ï¼Œå¹¶ä¸”æ›´åŠ å¯é ã€‚ <br><br> å¦ä¸€æ–¹é¢ï¼Œâ€œç»å…¸å¿«ç…§â€æŒ‡å—å’Œå·¥å…·ä¿ƒä½¿æˆ‘ä»¬åœ¨å¤–éƒ¨åª’ä½“ä¸Šå­˜å‚¨å¤§æ–‡ä»¶ï¼ˆä¾‹å¦‚ï¼Œç”¨äºæ¸²æŸ“ç»„ä»¶çš„æ ‡è®°æˆ–JSON APIç»“æœï¼‰ï¼Œå¹¶åœ¨æ¯æ¬¡è¿è¡Œæµ‹è¯•æ—¶å°†ç»“æœä¸ä¿å­˜çš„ç‰ˆæœ¬è¿›è¡Œæ¯”è¾ƒã€‚ å¯ä»¥è¯´ï¼Œå®ƒå¯ä»¥å°†æˆ‘ä»¬çš„æµ‹è¯•ä¸åŒ…å«3000ä¸ªå€¼çš„1000è¡Œéšå¼å…³è”ï¼Œè¯¥å€¼æ˜¯æµ‹è¯•ä½œè€…ä»æœªè§è¿‡çš„ï¼Œä»–ä»æœªæƒ³åˆ°è¿‡ã€‚ ä¸ºä»€ä¹ˆè¿™æ ·ä¸å¥½ï¼Ÿ å› ä¸ºæµ‹è¯•å¤±è´¥æœ‰1000ä¸ªåŸå› ã€‚ ç”šè‡³åªæœ‰ä¸€è¡Œå¯ä»¥ä½¿å¿«ç…§æ— æ•ˆï¼Œå¹¶ä¸”è¿™ç§æƒ…å†µç»å¸¸å‘ç”Ÿã€‚ å¤šå°‘é’± åœ¨æ¯ä¸ªç©ºæ ¼ä¹‹åï¼Œæ³¨é‡Šæˆ–CSSæˆ–HTMLä¸­çš„å¾®å°å˜åŒ–ã€‚ æ­¤å¤–ï¼Œæµ‹è¯•çš„åç§°ä¸ä¼šå‘Šè¯‰æ‚¨æœ‰å…³å¤±è´¥çš„ä¿¡æ¯ï¼Œå› ä¸ºå®ƒåªä¼šæ£€æŸ¥1000è¡Œæ²¡æœ‰æ›´æ”¹ï¼Œå¹¶ä¸”è¿˜é¼“åŠ±æµ‹è¯•çš„ä½œè€…å°½å¯èƒ½å¤šåœ°è·å–ä»–æ— æ³•åˆ†æå’ŒéªŒè¯çš„é•¿æ–‡æ¡£ã€‚ æ‰€æœ‰è¿™äº›éƒ½æ˜¯æ¨¡ç³Šè€Œä»“ä¿ƒçš„æµ‹è¯•çš„ç—‡çŠ¶ï¼Œè¯¥æµ‹è¯•æ²¡æœ‰æ˜ç¡®çš„ä»»åŠ¡ï¼Œå¹¶ä¸”è¯•å›¾å®ç°å¤ªå¤šç›®æ ‡ã€‚ <br><br> å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä½¿ç”¨é•¿è€Œå¤–éƒ¨çš„å›¾åƒæ˜¯å¯ä»¥æ¥å—çš„ï¼Œä¾‹å¦‚ï¼Œåœ¨ç¡®è®¤æ–¹æ¡ˆæ—¶ï¼Œè€Œä¸æ˜¯æ•°æ®ï¼ˆæå–å€¼å¹¶å…³æ³¨å­—æ®µï¼‰æ—¶ï¼Œæˆ–è€…æ¥æ”¶çš„æ–‡æ¡£å¾ˆå°‘æ›´æ”¹æ—¶ï¼Œéƒ½æ˜¯å¯ä»¥æ¥å—çš„ã€‚ <br><br>  <b>å¦åˆ™ã€‚</b>  UIæµ‹è¯•å¤±è´¥ã€‚ ä»£ç çœ‹èµ·æ¥ä¸é”™ï¼Œç†æƒ³çš„åƒç´ æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ æ‚¨å¯¹å¿«ç…§çš„æµ‹è¯•åªæ˜¯æ­ç¤ºäº†åŸå§‹æ–‡æ¡£å’Œåˆšæ”¶åˆ°çš„æ–‡æ¡£ä¹‹é—´çš„åŒºåˆ«-åœ¨æ ‡è®°ä¸­æ·»åŠ äº†ä¸€ä¸ªç©ºæ ¼å­—ç¬¦... <br><br><div class="spoiler">  <b class="spoiler_title">ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text">  <b>åæ¨¡å¼çš„ä¸€ä¸ªä¾‹å­ã€‚</b> å°†æµ‹è¯•ä¸ä¸€äº›æœªçŸ¥çš„2000è¡Œä»£ç ç›¸å…³è”ã€‚ <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'TestJavaScript.com is renderd correctly'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Arrange //Act const receivedPage = renderer .create( &lt;DisplayPage page = "http://www.testjavascript.com" &gt; Test JavaScript &lt; /DisplayPage&gt;) .toJSON(); //Assert expect(receivedPage).toMatchSnapshot(); //We now implicitly maintain a 2000 lines long document //every additional line break or comment - will break this test });</span></span></code> </pre><br>  <b>æ­£ç¡®çš„åšæ³•ã€‚</b> æœŸæœ›æ˜¯å¯è§çš„ï¼Œå¹¶ä¸”æ˜¯äººä»¬å…³æ³¨çš„ç„¦ç‚¹ã€‚ <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'When visiting TestJavaScript.com home page, a menu is displayed'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//Arrange //Act receivedPage tree = renderer .create( &lt;DisplayPage page = "http://www.testjavascript.com" &gt; Test JavaScript &lt; /DisplayPage&gt;) .toJSON(); //Assert const menu = receivedPage.content.menu; expect(menu).toMatchInlineSnapshot(` &lt;ul&gt; &lt;li&gt;Home&lt;/li&gt; &lt;li&gt; About &lt;/li&gt; &lt;li&gt; Contact &lt;/li&gt; &lt;/ul&gt; `); });</span></span></code> </pre> <br></div></div><br><h2>  1.9é¿å…ä½¿ç”¨å…¨å±€æµ‹è¯•å¹³å°å’Œåˆå§‹æ•°æ®ï¼Œå°†æ•°æ®åˆ†åˆ«æ·»åŠ åˆ°æ¯ä¸ªæµ‹è¯•ä¸­ </h2><br>  <b>æ€ä¹ˆåŠã€‚</b> æ ¹æ®é»„é‡‘æ³•åˆ™ï¼ˆç¬¬0ç« ï¼‰ï¼Œæ¯ä¸ªæµ‹è¯•éƒ½åº”åœ¨æ•°æ®åº“ä¸­è‡ªå·±çš„è¡Œé›†ä¸­è¿›è¡Œæ·»åŠ å’Œå·¥ä½œï¼Œä»¥é¿å…ç»‘å®šï¼Œå¹¶ä¸”ä½¿ç”¨æˆ·æ›´å®¹æ˜“ç†è§£æµ‹è¯•ã€‚ å®é™…ä¸Šï¼Œæµ‹è¯•äººå‘˜é€šå¸¸åœ¨è¿è¡Œä½¿ç”¨åˆå§‹æ•°æ®ï¼ˆç§å­ï¼‰ï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¹Ÿç§°ä¸ºâ€œæµ‹è¯•å°â€</a> ï¼‰å¡«å……æ•°æ®åº“çš„æµ‹è¯•ä¹‹å‰è¿åæ­¤è§„åˆ™ï¼Œä»¥æé«˜ç”Ÿäº§ç‡ã€‚       ,     (.  Â« Â»),              .                .    ,           ,     (, ). <br><br> <b>  .</b>   ,  ,     ,   ?  , , ,         . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åæ¨¡å¼çš„ä¸€ä¸ªä¾‹å­ã€‚</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æµ‹è¯•ä¸æ˜¯ç‹¬ç«‹çš„ï¼Œè€Œæ˜¯ä½¿ç”¨æŸç§å…¨å±€æŒ‚é’©ä»æ•°æ®åº“è·å–å…¨å±€æ•°æ®ã€‚</font></font><br><br><pre> <code class="javascript hljs">before(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//adding sites and admins data to our DB. Where is the data? outside. At some external json or migration framework await DB.AddSeedDataFromJson('seed.json'); }); it("When updating site name, get successful confirmation", async () =&gt; { //I know that site name "portal" exists - I saw it in the seed files const siteToUpdate = await SiteService.getSiteByName("Portal"); const updateNameResult = await SiteService.changeName(siteToUpdate, "newName"); expect(updateNameResult).to.be(true); }); it("When querying by site name, get the right site", async () =&gt; { //I know that site name "portal" exists - I saw it in the seed files const siteToCheck = await SiteService.getSiteByName("Portal"); expect(siteToCheck.name).to.be.equal("Portal"); //Failure! The previous test change the name :[ });</span></span></code> </pre><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­£ç¡®çš„åšæ³•ã€‚</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ‚¨å¯ä»¥åœç•™åœ¨æµ‹è¯•ä¸­ï¼Œæ¯ä¸ªæµ‹è¯•ä»…é€‚ç”¨äºè‡ªå·±çš„æ•°æ®ã€‚</font></font><br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When updating site name, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//test is adding a fresh new records and acting on the records only const siteUnderTest = await SiteService.addSite({ name: "siteForUpdateTest" }); const updateNameResult = await SiteService.changeName(siteUnderTest, "newName"); expect(updateNameResult).to.be(true); });</span></span></code> </pre><br></div></div><br><h2> 1.10   ,    </h2><br> <b> .</b>  ,  -     ,     try-catch-finally  ,      .        ( ),        . <br><br>        Chai: <code>expect(method).to.throw</code> (  Jest: <code>expect(method).toThrow()</code> ).      ,    ,    . ,     ,        . <br><br> <b>  .</b>     (, CI-)   ,    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>   ,     try-catch   . <br><br><pre> <code class="javascript hljs">/it(<span class="hljs-string"><span class="hljs-string">"When no product name, it throws error 400"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> errorWeExceptFor = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> addNewProduct({<span class="hljs-attr"><span class="hljs-attr">name</span></span>:<span class="hljs-string"><span class="hljs-string">'nest'</span></span>});} <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { expect(error.code).to.equal(<span class="hljs-string"><span class="hljs-string">'InvalidInput'</span></span>); errorWeExceptFor = error; } expect(errorWeExceptFor).not.to.be.null; <span class="hljs-comment"><span class="hljs-comment">//if this assertion fails, the tests results/reports will only show //that some value is null, there won't be a word about a missing Exception });</span></span></code> </pre><br> <b>  .</b>     ,   , ,   QA    . <br><br><pre> <code class="javascript hljs">it.only(<span class="hljs-string"><span class="hljs-string">"When no product name, it throws error 400"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span>() =&gt; { expect(addNewProduct)).to.eventually.throw(AppError).with.property(<span class="hljs-string"><span class="hljs-string">'code'</span></span>, <span class="hljs-string"><span class="hljs-string">"InvalidInput"</span></span>); });</code> </pre><br></div></div><br><h2> 1.11    </h2><br> <b> .</b>       : <br><br><ul><li>  smoke-, <br></li><li> IO-less, <br></li><li> ,   ,      , <br></li><li>   ,       pull request',   . <br></li></ul><br>   ,     , , #cold #api #sanity.            . ,     Mocha     : <code>mocha â€” grep 'sanity'</code> . <br><br> <b>  .</b>   ,    ,   ,   ,  ,       ,      ,      . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>   '#cold-test'      (Cold=== ,     -    ,     ). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//this test is fast (no DB) and we're tagging it correspondingly //now the user/CI can run it frequently describe('Order service', function() { describe('Add new order #cold-test #sanity', function() { it('Scenario - no currency was supplied. Expectation - Use the default currency #sanity', function() { //code logic here }); }); });</span></span></code> </pre> <br></div></div><br><h2> 1.12      </h2><br> <b> .</b>    ,    Node.js       .          ,    Node. <br><br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> TDD</a> .     ,   ,       ,      .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">--</a> ,       - .   ,      ,      .       ,    .       ,  ,     ,    ,     (,   ..). <br><br> <b>  .</b>   ,    . <br><br><a name="3"></a><h1>  2:   </h1><br><h2> ï¸2.1    :        </h2><br> <b> .</b>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>  10 ,                 .         .   ,      10  (, ,   ),   ,   ,      <i></i>  ?         ? <br><br>    :  2019-  , TDD        , , ,      . ,     ,    , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   </a> .  IoT-,         Kafka  RabbitMQ,     ,       -  .          ,  ,         ?      (, ,  ),      ,      - . <br><br>             (    )    ,        ,    (Â«   API,    ,  !Â» (consumer-driven contracts)).     ,      : ,    ,  ,     . <br><br> :   TDD      - .    TDD ,     .  ,     . <br><br> <b>  .</b>       ROI,  Fuzz,   ,      10 . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Cindy Sridharan        'Testing Microservices â€” the sane way' <br><br><img src="https://habrastorage.org/getpro/habr/post_images/375/7ab/6f0/3757ab6f02f3bad93c7235ad2ee0ad95.png"><br><br> ä¸€ä¸ªä¾‹å­ï¼š <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/-2zP494wdUY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br><h2> 2.2        </h2><br> <b> .</b>       ,     .        ,     .          ,   ,   ?   â€”   .        :      TDD-,     . <br><br>      Â«Â»,    API,   ,     (,   ,     in-memory ),      , ,   .     ,  ,      Â«   Â»,        . <br><br> <b>  .</b>         ,   ,       20 %. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>     Express API   (     ). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/625/d5d/7c1/625d5d7c195e640bacb1b4f50d8a0cdc.png"><br></div></div><br><h2> 2.3 ,       API </h2><br> <b> .</b>     ,        (   ).    - ,  ! â€”    ,       , .  Â« <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-22</a> Â»   :          ,       ,      .           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   (consumer-driven contracts)   PACT</a> :       , â€¦ ! PACT           â€” Â«Â»,          .   PACT-      â€”    .  ,   API           CI,       . <br><br> <b>  .</b>  â€”       . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/308/385/2ff/3083852ffe6faa62f826bc9c131027d7.png"><br></div></div><br><h2> 2.4     </h2><br> <b> .</b>     ,           Express-.   .   ,         ,        ,  JS- {req,res}.     ,      (,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sinon</a> )    {req,res},  ,     .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://www.npmjs.com/package/node-mocks-">node-mock-http</a>       {req,res}    . ,   ,    HTTP-,  res- (.  ). <br><br> <b>  .</b>   Express- ===        . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>    ,         Express-. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//the middleware we want to test const unitUnderTest = require('./middleware') const httpMocks = require('node-mocks-http'); //Jest syntax, equivalent to describe() &amp; it() in Mocha test('A request without authentication header, should return http status 403', () =&gt; { const request = httpMocks.createRequest({ method: 'GET', url: '/user/42', headers: { authentication: '' } }); const response = httpMocks.createResponse(); unitUnderTest(request, response); expect(response.statusCode).toBe(403); });</span></span></code> </pre><br></div></div><br><h2> 2.5         </h2><br> <b> .</b>                   .    CI-   ,         .                  (,   ),     (,   ),          .   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sonarqube</a> (2600+ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> )  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Code Climate</a> (1500+ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> ). :: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Keith Holliday</a> <br><br> <b>  .</b>            ,            . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>   CodeClimate,    : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c63/a0c/6d2/c63a0c6d207ab1fc67f540db7b2d6259.png"><br></div></div><br><h2> 2.6 ,      Node </h2><br> <b> .</b>   ,         .     (   )   . ,  - ,      ?      ?      ,  API    50 % ?      ,  Netflix   - ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Chaos Engineering</a> ).  :   ,              . ,     Netflix, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">chaos monkey</a> ,    ,  ,     ,     -   (   Kubernetes   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">kube-monkey</a> ,   ).         ,         . , ,   Node-     ,   ,    v8    1,7 ,    UX ,     ?   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">node-chaos</a> (-),        ,   Node. <br><br> <b>  .</b>      ,     production   . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Node-chaos     ,   Node.js,          . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/39d/46d/fc1/39d46dfc17d7bc4a6d50735681bd1025.png"><br></div></div><br><h2> 2.7       ,        </h2><br> <b> .</b>    ( 0),              ,   ,        .       ,        (seeds) ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   Â« Â»</a> )   .       ,     (.  Â« Â»),     ,         .                .    ,           ,     (, ). <br><br> <b>  .</b>   ,  ,     ,   ?  , , ,         . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>       -        . <br><br><pre> <code class="javascript hljs">before(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//adding sites and admins data to our DB. Where is the data? outside. At some external json or migration framework await DB.AddSeedDataFromJson('seed.json'); }); it("When updating site name, get successful confirmation", async () =&gt; { //I know that site name "portal" exists - I saw it in the seed files const siteToUpdate = await SiteService.getSiteByName("Portal"); const updateNameResult = await SiteService.changeName(siteToUpdate, "newName"); expect(updateNameResult).to.be(true); }); it("When querying by site name, get the right site", async () =&gt; { //I know that site name "portal" exists - I saw it in the seed files const siteToCheck = await SiteService.getSiteByName("Portal"); expect(siteToCheck.name).to.be.equal("Portal"); //Failure! The previous test change the name :[ });</span></span></code> </pre><br> <b>  .</b>     ,       . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">"When updating site name, get successful confirmation"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//test is adding a fresh new records and acting on the records only const siteUnderTest = await SiteService.addSite({ name: "siteForUpdateTest" }); const updateNameResult = await SiteService.changeName(siteUnderTest, "newName"); expect(updateNameResult).to.be(true); });</span></span></code> </pre><br></div></div><br><a name="4"></a><h1>  3:   </h1><br><h2>  3.1ã€‚  UI   </h2><br> <b> .</b>      ,      ,   ,        .        ,         ,      (    HTML  CSS)    . ,                (, , , ),      ,         ,         . <br><br> <b>  .</b>          10 ,     500  (100  = 1 ) - -    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>    . <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'When users-list is flagged to show only VIP, should display only VIP members'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// Arrange const allUsers = [ { id: 1, name: 'Yoni Goldberg', vip: false }, { id: 2, name: 'John Doe', vip: true } ]; // Act const { getAllByTestId } = render(&lt;UsersList users={allUsers} showOnlyVIP={true}/&gt;); // Assert - Extract the data from the UI first const allRenderedUsers = getAllByTestId('user').map(uiElement =&gt; uiElement.textContent); const allRealVIPUsers = allUsers.filter((user) =&gt; user.vip).map((user) =&gt; user.name); expect(allRenderedUsers).toEqual(allRealVIPUsers); //compare data with data, no UI here });</span></span></code> </pre><br> <b><b> .</b>     UI  .</b> <br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'When flagging to show only VIP, should display only VIP members'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// Arrange const allUsers = [ {id: 1, name: 'Yoni Goldberg', vip: false }, {id: 2, name: 'John Doe', vip: true } ]; // Act const { getAllByTestId } = render(&lt;UsersList users={allUsers} showOnlyVIP={true}/&gt;); // Assert - Mix UI &amp; data in assertion expect(getAllByTestId('user')).toEqual('[&lt;li data-testid="user"&gt;John Doe&lt;/li&gt;]'); });</span></span></code> </pre><br></div></div><br><h2> 3.2  HTML-   ,     </h2><br> <b> .</b>  HTML-   ,     . ,  ,   CSS-.      ,      'test-id-submit-button'.              .   ,    ,           . <br><br> <b>  .</b>     ,    ,   .    â€” , ,  Ajax .   .    ,      CSS  'thick-border'  'thin-border' <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>     ,    . <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// the markup code (part of React component) &lt;b&gt; &lt;Badge pill className="fixed_badge" variant="dark"&gt; &lt;span data-testid="errorsLabel"&gt;{value}&lt;/span&gt; &lt;!-- note the attribute data-testid --&gt; &lt;/Badge&gt; &lt;/b&gt; // this example is using react-testing-library test('Whenever no data is passed to metric, show 0 as default', () =&gt; { // Arrange const metricValue = undefined; // Act const { getByTestId } = render(&lt;dashboardMetric value={undefined}/&gt;); expect(getByTestId('errorsLabel')).text()).toBe("0"); });</span></span></code> </pre><br> <b> .</b>   CSS-. <br><br><pre> <code class="javascript hljs">&lt;!-- the markup code (part <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> React component) --&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"metric"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">className</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"d-flex-column"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{value}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;!-- what <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the designer changes the classs? --&gt; <span class="hljs-comment"><span class="hljs-comment">// this exammple is using enzyme test('Whenever no data is passed, error metric shows zero', () =&gt; { // ... expect(wrapper.find("[className='d-flex-column']").text()).toBe("0"); });</span></span></code> </pre><br></div></div><br><h2> 3.3           </h2><br> <b> .</b>   ,   ,     .   ,    ,      .   ,     â€”  -       ,       (.  <i>    Â« Â»</i> ).      (, )     ,     . <br><br>  ,  :        ,      .            (  )     .           ,       . <br><br> <b>  .</b>               ,           .         ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>        . <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Calendar</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">React</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> defaultProps = {<span class="hljs-attr"><span class="hljs-attr">showFilters</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>} render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;div&gt; A filters panel </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">with</span></span></span></span><span class="hljs-function"><span class="hljs-params"> a button to hide</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/show filters &lt;FiltersPanel showFilter={showFilters} title='Choose Filters'/</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt; &lt;</span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/div&gt; ) } } /</span></span></span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/Examples use React &amp; Enzyme test('Realistic approach: When clicked to show filters, filters are displayed', () =&gt; { /</span></span></span></span><span class="hljs-regexp"><span class="hljs-function"><span class="hljs-params"><span class="hljs-regexp">/ Arrange const wrapper = mount(&lt;Calendar showFilters={false} /</span></span></span></span><span class="hljs-function"><span class="hljs-params">&gt;</span></span></span><span class="hljs-function">) // </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Act</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">wrapper</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">find</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'button'</span></span></span></span></span><span class="hljs-function">).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">simulate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'click'</span></span></span></span></span><span class="hljs-function">); // </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Assert</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">expect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">wrapper.text(</span></span></span><span class="hljs-function">).</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">includes</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'Choose Filter'</span></span></span></span></span><span class="hljs-function">)); // </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">This</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">is</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">how</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">the</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">will</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">approach</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">this</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">element</span></span></span><span class="hljs-function">: </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">by</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">text</span></span></span><span class="hljs-function"> })</span></span></code> </pre><br> <b> .</b>      . <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'Shallow/mocked approach: When clicked to show filters, filters are displayed'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// Arrange const wrapper = shallow(&lt;Calendar showFilters={false} title='Choose Filter'/&gt;) // Act wrapper.find('filtersPanel').instance().showFilters(); // Tap into the internals, bypass the UI and invoke a method. White-box approach // Assert expect(wrapper.find('Filter').props()).toEqual({title: 'Choose Filter'}); // what if we change the prop name or don't pass anything relevant? })</span></span></code> </pre><br></div></div><br><h2> 3.4          .     </h2><br> <b> .</b>        (,    ).      (, <code>setTimeOut</code> )     ,   .       (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Cypress cy.request('url')</a> ),     API,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> wait(expect(element))  @testing-library/DOM</a> .       ,    API,      ,    .      ,   ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">hurry-up the clock</a> .  â€”  ,   ,          (      ).        ,       ,    - npm-   , , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wait-for-expect</a> . <br><br> <b>  .</b>   ,    .          ,      .           . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> E2E API       (Cypress). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// using Cypress cy.get('#show-products').click()// navigate cy.wait('@products')// wait for route to appear // this line will get executed only when the route is ready</span></span></code> </pre><br> <b>  .  ,  DOM- (@testing-library/dom).</b> <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// @testing-library/dom test('movie title appears', async () =&gt; { // element is initially not present... // wait for appearance await wait(() =&gt; { expect(getByText('the lion king')).toBeInTheDocument() }) // wait for appearance and return the element const movie = await waitForElement(() =&gt; getByText('the lion king')) })</span></span></code> </pre><br> <b> .</b>    . <br><br><pre> <code class="javascript hljs">test(<span class="hljs-string"><span class="hljs-string">'movie title appears'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// element is initially not present... // custom wait logic (caution: simplistic, no timeout) const interval = setInterval(() =&gt; { const found = getByText('the lion king'); if(found){ clearInterval(interval); expect(getByText('the lion king')).toBeInTheDocument(); } }, 100); // wait for appearance and return the element const movie = await waitForElement(() =&gt; getByText('the lion king')) })</span></span></code> </pre><br></div></div><br><h2> 3.5.      </h2><br> <b> .</b>   -   ,        .    ,    ,      .      :    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">pingdom</a> , AWS CloudWatch  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">gcp StackDriver</a>    ,  ,          SLA.          ,     ,    (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">lighthouse</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">pagespeed</a> ),   .    â€” ,      :     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   </a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">       (TTI)</a> .  ,      ,   ,     ,  ,   DOM, SSL   .      ,   CI,     247     CDN. <br><br> <b>  .</b>   ,  ,       ,       ,       -    CDN. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>  Lighthouse   . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/857/732/c2c/857732c2c3976c167757a9da12d81e05.png"><br></div></div><br><h2> 3.6         API  </h2><br> <b> .</b>     ( 2),    ,         ,      (  ).      API    (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Sinon</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Test doubles</a> ),    API.         .    API      ,           (         ).      API,     . ,     ,   API  .  ,    :     . <br><br> <b>  .</b>       ,   API   100 ,     20  . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>    API-. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// unit under test export default function ProductsList() { const [products, setProducts] = useState(false) const fetchProducts = async() =&gt; { const products = await axios.get('api/products') setProducts(products); } useEffect(() =&gt; { fetchProducts(); }, []); return products ? &lt;div&gt;{products}&lt;/div&gt; : &lt;div data-testid='no-products-message'&gt;No products&lt;/div&gt; } // test test('When no products exist, show the appropriate message', () =&gt; { // Arrange nock("api") .get(`/products`) .reply(404); // Act const {getByTestId} = render(&lt;ProductsList/&gt;); // Assert expect(getByTestId('no-products-message')).toBeTruthy(); });</span></span></code> </pre><br></div></div><br><h2> 3.7     ,    </h2><br> <b> .</b>  E2E (end-to-end,  )      UI   (.  3.6).       ,    ,  .     ,         ,    -     .  ,   â€”        (,        ),      .   -   ,      ,  UI-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Cypress</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pupeteer</a> .           ,    :    50 ,    ,       .           10  .   ,         ,    , â€”    .     ,   . <br><br> <b>  .</b> UI        ,     ,      ( ,     UI)    . <br><br><h2> 3.8            </h2><br> <b> .</b>   ,       API   ,     ,           .          (before-all),    -        .   ,       :       .     ,      .  - API-         .      ,          .      (,    ),  ,      ,       .  ,    :      ,       API  (.  3.6). <br><br> <b>  .</b> ,   200  ,     100 ,         20    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>      (before-all),       (before-each) (,   Cypress). <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   Cypress</a> . <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> authenticationToken; <span class="hljs-comment"><span class="hljs-comment">// happens before ALL tests run before(() =&gt; { cy.request('POST', 'http://localhost:3000/login', { username: Cypress.env('username'), password: Cypress.env('password'), }) .its('body') .then((responseFromLogin) =&gt; { authenticationToken = responseFromLogin.token; }) }) // happens before EACH test beforeEach(setUser =&gt; () { cy.visit('/home', { onBeforeLoad (win) { win.localStorage.setItem('token', JSON.stringify(authenticationToken)) }, }) })</span></span></code> </pre><br></div></div><br><h2> 3.9    smoke-,       </h2><br> <b> .</b>  production-          ,         ,    .    ,       ,       ,    ,     .   smoke-        .         production,  ,    ,       . , smoke-    ,      . <br><br> <b>  .</b>    ,   ,    production  .             /Payment. <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Smoke-    . <br><br><pre> <code class="javascript hljs">it(<span class="hljs-string"><span class="hljs-string">'When doing smoke testing over all page, should load them all successfully'</span></span>, () =&gt; { <span class="hljs-comment"><span class="hljs-comment">// exemplified using Cypress but can be implemented easily // using any E2E suite cy.visit('https://mysite.com/home'); cy.contains('Home'); cy.contains('https://mysite.com/Login'); cy.contains('Login'); cy.contains('https://mysite.com/About'); cy.contains('About'); })</span></span></code> </pre><br></div></div><br><h2> 3.10        </h2><br> <b> .</b>    ,     .    Â«Â»   ,        , ,   ,          . ,        (   )   ,     ,  -,  ,      ,     .      Â« Â»,         . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   </a>   .       , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Cucumber   JavaScript</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">StoryBook</a>   UI-    ,           (,      ,        ,  ..)  ,    .      ,           ,   . <br><br> <b>  .</b>     ,        . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b>        cucumber-js. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// this is how one can describe tests using cucumber: plain language that allows anyone to understand and collaborate Feature: Twitter new tweet I want to tweet something in Twitter @focus Scenario: Tweeting from the home page Given I open Twitter home Given I click on "New tweet" button Given I type "Hello followers!" in the textbox Given I click on "Submit" button Then I see message "Tweet saved"</span></span></code> </pre><br> <b>  .</b>   Storybook  ,      . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/135/d4c/6c5/135d4c6c5dcf2758cfd90bc20dbad939.png"><br></div></div><br><h2> 3.11        </h2><br> <b> .</b>   ,                 .       ,     .    ,     .            ,     -    .         ,     .      , ,      ,       .   ,        -   .      UI        Â« Â».     ,      (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wraith</a> , PhantomCSS),        .   (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Applitools</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Perci.io</a> )          , ,     Â« Â» (, ),      DOM/CSS,    . <br><br> <b>  .</b>   ,    (   )   ,       ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>   :  ,   . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b00/b82/ad7/b00b82ad77c637eb6e00742f38780216.png"><br><br> <b>  </b> .  wraith      UI. <br><br><pre> <code class="javascript hljs">â€‹# Add <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> many domains <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> necessary. Key will act <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> a labelâ€‹ domains: english: <span class="hljs-string"><span class="hljs-string">"http://www.mysite.com"</span></span>â€‹ â€‹# Type screen widths below, here are a couple <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> examplesâ€‹ screen_widths: - <span class="hljs-number"><span class="hljs-number">600</span></span>â€‹ - <span class="hljs-number"><span class="hljs-number">768</span></span>â€‹ - <span class="hljs-number"><span class="hljs-number">1024</span></span>â€‹ - <span class="hljs-number"><span class="hljs-number">1280</span></span>â€‹ â€‹# Type page URL paths below, here are a couple <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> examplesâ€‹ paths: about: path: <span class="hljs-regexp"><span class="hljs-regexp">/about selector: '.about'â€‹ subscribe: selector: '.subscribe'â€‹ path: /</span></span>subscribe</code> </pre><br></div></div><br><a name="5"></a><h1>  4:    </h1><br><h2> 4.1    (~80 %),      </h2><br> <b> .</b>   â€”   ,   .    ,     .  â€”     (,    ),  .    ? ,  10-30 %      .  100 %  ,                .      . ,   :         Airbus,     ;     ,   50 %   .     ,       ,       80 % ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Fowler: Â«in the upper 80s or 90sÂ»</a> ), ,  ,    . <br><br> :      (CI),     ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Jest</a> )     ,    .       ,   .  ,       (      ) â€”           .  ,  â€”   ,      ,     .       ,    . <br><br> <b>  .</b>       .    ,     ,     .     . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>    .</b> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d94/db1/8bf/d94db18bf89f833800bf8234c40f095c.png"><br><br> <b>  </b> .       (  Jest). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b97/d73/d8b/b97d73d8b66e627b8fee40d9fa940d7f.png"><br></div></div><br><h2> 4.2    ,        </h2><br> <b> .</b>    ,       .   , , ,   ,     . ,   ,  -     ,   .     <code>PricingCalculator</code>    ,  ,     ,     10 000    â€¦     ,     ,  .  ,      .   80-     ,    .   :             ,    ,  ,      .      ,    - . <br><br> <b>  .</b>    ,     ,    ,    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>      ?   ,        QA       . :     , -   . ,   -    API  . </div></div><br><br><img src="https://habrastorage.org/getpro/habr/post_images/18e/7d7/2dc/18e7d72dcf5440fe964269002529b69c.png"><br><br><h2> 4.3        </h2><br> <b> .</b>     :       100 %,        . æ€ä¹ˆä¼šè¿™æ ·      ,  ,   ,    .       .    -          :    ,    ,   ,       . <br><br>        ,    .        JavaScript- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Stryker</a> : <br><br><ol><li>      Â« Â». ,  <code>newOrder.price===0</code>   <code>newOrder.price!=0</code> .  Â«Â»  . <br></li><li>    ,     ,    :      ,  .    ,   ,   . <br></li></ol><br>   ,     ,       ,     . <br><br> <b>  .</b>   ,  85-     85 %   . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>  100 %,  0 %. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addNewOrder</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">newOrder</span></span></span><span class="hljs-function">) </span></span>{ logger.log(<span class="hljs-string"><span class="hljs-string">`Adding new order </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${newOrder}</span></span></span><span class="hljs-string">`</span></span>); DB.save(newOrder); Mailer.sendMail(newOrder.assignee, <span class="hljs-string"><span class="hljs-string">`A new order was places </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${newOrder}</span></span></span><span class="hljs-string">`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-attr"><span class="hljs-attr">approved</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>}; } it(<span class="hljs-string"><span class="hljs-string">"Test addNewOrder, don't use such test names"</span></span>, () =&gt; { addNewOrder({<span class="hljs-attr"><span class="hljs-attr">asignee</span></span>: <span class="hljs-string"><span class="hljs-string">"John@mailer.com"</span></span>,<span class="hljs-attr"><span class="hljs-attr">price</span></span>: <span class="hljs-number"><span class="hljs-number">120</span></span>}); });<span class="hljs-comment"><span class="hljs-comment">//Triggers 100% code coverage, but it doesn't check anything</span></span></code> </pre><br> <b>  .</b> Stryker reports,   ,       (). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/880/047/5ed/8800475ed27d8c632aa2fb7a0372da68.png"><br></div></div><br><h2> 4.4      - </h2><br> <b> .</b>             ESLint.  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">eslint-plugin-mocha</a>  ,       (     <code>describe()</code> ),    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a> ,           .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">eslint-plugin-jest</a>  ,       (    ). <br><br> <b>  .</b>   90-     ,    ,   ,          . ,          . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>    ,  ,   . <br><br><pre> <code class="javascript hljs">describe(<span class="hljs-string"><span class="hljs-string">"Too short description"</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> userToken = userService.getDefaultToken() <span class="hljs-comment"><span class="hljs-comment">// *error:no-setup-in-describe, use hooks (sparingly) instead it("Some description", () =&gt; {});//* error: valid-test-description. Must include the word "Should" + at least 5 words }); it.skip("Test name", () =&gt; {// *error:no-skipped-tests, error:error:no-global-tests. Put tests only under describe or suite expect("somevalue"); // error:no-assert }); it("Test name", () =&gt; {*//error:no-identical-title. Assign unique titles to tests });</span></span></code> </pre><br></div></div><br><a name="6"></a><h1>  5: CI     </h1><br><h2> 5.1      ,      </h2><br> <b> .</b>  â€”   .        ,           .  ,        (   !).     ,         .      ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ESLint standard</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Airbnb</a> ),     . , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">eslint-plugin-chai-expect</a>   ,    . <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Eslint-plugin-promise</a>     (    ). <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Eslint-plugin-security</a>     ,     DOS-.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">eslint-plugin-you-dont-need-lodash-underscore</a>  ,      ,      V8, , <code>Lodash._map(â€¦)</code> . <br><br> <b>  .</b>    ,      ,     . è¿™æ˜¯æ€ä¹ˆå›äº‹ï¼Ÿ      ,   ,     .      .          ,    ,      . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b> .</b>   ,        .  , ESLint   production-. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ec/386/b94/2ec386b943b21f0dee093e6c50e5ae75.png"><br></div></div><br><h1> 5.2            </h1><br> <b> .</b>   CI         , ,    ..?      ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a> . æ€ä¹ˆäº†        : (1)  -&gt; (2)   -&gt; (3) .    ,          ,     . <br><br>             ,       ,   ,         ,   -   . <br><br>  CI- ( , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CircleCI local CLI</a> )     .   ,  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">wallaby</a> ,      (  )    .    npm-  package.json,    ,     (, , , ).       (non-zero exit code)           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">concurrently</a> .             â€” , <code>npm run quality</code> .             githook ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">husky </a> ). <br><br> <b>  .</b>           ,           . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Npm-,   ,  ,        . <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"inspect:sanity-testing"</span></span>: <span class="hljs-string"><span class="hljs-string">"mocha **/**--test.js --grep \"sanity\""</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:lint"</span></span>: <span class="hljs-string"><span class="hljs-string">"eslint ."</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:vulnerabilities"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm audit"</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:license"</span></span>: <span class="hljs-string"><span class="hljs-string">"license-checker --failOn GPLv2"</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:complexity"</span></span>: <span class="hljs-string"><span class="hljs-string">"plato ."</span></span>, <span class="hljs-string"><span class="hljs-string">"inspect:all"</span></span>: <span class="hljs-string"><span class="hljs-string">"concurrently -c \"bgBlue.bold,bgMagenta.bold,yellow\" \"npm:inspect:quick-testing\" \"npm:inspect:lint\" \"npm:inspect:vulnerabilities\" \"npm:inspect:license\""</span></span> }, <span class="hljs-string"><span class="hljs-string">"husky"</span></span>: { <span class="hljs-string"><span class="hljs-string">"hooks"</span></span>: { <span class="hljs-string"><span class="hljs-string">"precommit"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm run inspect:all"</span></span>, <span class="hljs-string"><span class="hljs-string">"prepush"</span></span>: <span class="hljs-string"><span class="hljs-string">"npm run inspect:all"</span></span> } }</code> </pre><br></div></div><br><h2> 5.3     production- </h2><br> <b> .</b>   â€”     CI-.                .   â€” <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Docker-compose</a>           .     (,  )     production-.   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AWS Local</a>      AWS-.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> </a>  ,    serverless  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AWS SAM</a>    Faas-. <br><br>   Kubernetes           CI-,        . ,   Â« KubernetesÂ»     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Minikube</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MicroK8s</a> ,    ,     .       Â« KubernetesÂ»:   CI- (, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Codefresh</a> )     Kubernetes-,     CI-   ;          . <br><br> <b>  .</b>                    . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b></b> : CI-,     Kubernetes- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">(Dynamic-environments Kubernetes</a> ) <br><br><pre> <code class="javascript hljs">deploy: stage: deploy image: registry.gitlab.com/gitlab-examples/kubernetes-deploy script: - ./configureCluster.sh $KUBE_CA_PEM_FILE $KUBE_URL $KUBE_TOKEN - kubectl create ns $NAMESPACE - kubectl create secret -n $NAMESPACE docker-registry gitlab-registry --docker-server=<span class="hljs-string"><span class="hljs-string">"$CI_REGISTRY"</span></span> --docker-username=<span class="hljs-string"><span class="hljs-string">"$CI_REGISTRY_USER"</span></span> --docker-password=<span class="hljs-string"><span class="hljs-string">"$CI_REGISTRY_PASSWORD"</span></span> --docker-email=<span class="hljs-string"><span class="hljs-string">"$GITLAB_USER_EMAIL"</span></span> - mkdir .generated - echo <span class="hljs-string"><span class="hljs-string">"$CI_BUILD_REF_NAME-$CI_BUILD_REF"</span></span> - sed -e <span class="hljs-string"><span class="hljs-string">"s/TAG/$CI_BUILD_REF_NAME-$CI_BUILD_REF/g"</span></span> templates/deals.yaml | tee <span class="hljs-string"><span class="hljs-string">".generated/deals.yaml"</span></span> - kubectl apply --namespace $NAMESPACE -f .generated/deals.yaml - kubectl apply --namespace $NAMESPACE -f templates/my-sock-shop.yaml environment: name: test-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-ci</code> </pre><br></div></div><br><h2> 5.4    </h2><br> <b> .</b>    ,      ,     .  ,     500  ,   ,     .  ,      CI- ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Jest</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AVA</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Mocha</a> )      ,     .  CI-      (!),       .  ,          CLI   ,    ,        . <br><br> <b>  .</b>      â€”         ,       . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> Mocha parallel  Jest    Mocha    ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JavaScript Test-Runners Benchmark</a> ) <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d87/ff4/d2e/d87ff4d2e1664df527d8a69d4403e8e9.png"><br></div></div><br><h2> 5.5             </h2><br> <b> .</b> ,           .         10 ?       CI-  npm-  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">license check</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">plagiarism check</a> (   ),        ,    ,   Stackoveflow     . <br><br> <b>  .</b>  ,       ,     . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>  .</b> <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//install license-checker in your CI environment or also locally npm install -g license-checker //ask it to scan all licenses and fail with exit code other than 0 if it found unauthorized license. The CI system should catch this failure and stop the build license-checker --summary --failOn BSD</span></span></code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/09b/b9b/2ad/09bb9b2ad230b17b0006bd137f480606.png"><br></div></div><br><h2> 5.6        </h2><br> <b> .</b>    ,  Express,   .           <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">npm audit</a> ,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">snyk</a> (     ).       CI   . <br><br> <b>  .</b>              .   . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>:</b>   NPM Audit <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a89/b1a/ed3/a89b1aed3ab2301c3f4d077e0a259c60.png"><br></div></div><br><h2> 5.7    </h2><br> <b> .</b>  package-lock.json  Yarn  npm    (     ):       .           <code>npm install</code>  <code>npm update</code> ,     .         ,    â€”   .         ,    package.json     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ncu</a> . <br><br>       ,    .   : <br><br><ul><li> CI   ,   ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">npm outdated</a>  npm-check-updates (ncu).     . <br></li><li>    ,      pull request'   . <br></li></ul><br>    :      ?       ,          (          ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  eslint-scope</a> ).       Â« Â»:        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">latest</a> ,    ,     (,   1.3.1,     â€” 1.3.8). <br><br> <b>  .</b>     ,     . <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b></b> :  ,       ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ncu</a>     CI-. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c09/9c2/640/c099c264012f534b4bf8dc8ef83d2f4b.png"><br></div></div><br><h2> 5.8  CI-,    Node </h2><br> <b> .</b>      ,   Node     .         ,    Node. <br><br><ol><li>   .      ,    Jenkins     . <br></li><li>      Docker. <br></li><li>     ,  .     .   smoke-,       (, ,  )       . <br></li><li>  ,       ,    ,   ,   ,    . <br></li><li>        ,      . ,            -.           -  (       ). <br></li><li>        .        . <br></li><li>      ,    ,    . <br></li><li>            (, Docker-). <br></li><li>    ,      .      <code>node_modules</code> . <br></li></ol><br> <b>  .</b>    ,   . <br><br><h2> 5.9  :      CI-,    Node </h2><br> <b> .</b>    ,     ,     .                Node,   CI        . ,      MySQL,    Postgres.  CI-     Â«Â»,        MySQl, Postgres    Node.      ,  -   (,        ).   CI,    ,      . <br><br> <b>  .</b>              -   ? <br><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"> <b>:</b>   Travis ( CI)             Node. <br><br><pre> <code class="javascript hljs">language: node_js node_js: - <span class="hljs-string"><span class="hljs-string">"7"</span></span> - <span class="hljs-string"><span class="hljs-string">"6"</span></span> - <span class="hljs-string"><span class="hljs-string">"5"</span></span> - <span class="hljs-string"><span class="hljs-string">"4"</span></span> install: - npm install script: - npm run test</code> </pre> <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN466879/">https://habr.com/ru/post/zh-CN466879/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466863/index.html">è®¾ç½®æ¸è¿‘çº¿</a></li>
<li><a href="../zh-CN466865/index.html">ç­‰å¾…11æœˆ1æ—¥ï¼šç¦æ­¢æˆ–ä½¿åŠ å¯†è´§å¸åˆæ³•åŒ–</a></li>
<li><a href="../zh-CN466873/index.html">JavaScriptæœ€ä¸äº†è§£çš„5ä»¶äº‹</a></li>
<li><a href="../zh-CN466875/index.html">Visual C ++ä¸­Unicodeå­—ç¬¦çš„printfå‡½æ•°æ ¼å¼è¯´æ˜ç¬¦çš„ä¸å¹¸å‘½è¿</a></li>
<li><a href="../zh-CN466877/index.html">æ¶æ„ç‰©èµ„å·²ç»æ›´æ–°ï¼Œå¹¶ä¸”æ­£åœ¨é€šè¿‡Eximçš„æ¼æ´ä¼ æ’­ï¼ˆCVE-2019-10149ï¼‰</a></li>
<li><a href="../zh-CN466881/index.html">ä¼Šä¸‡Â·æ²™é©¬æ‰˜å¤«ï¼ˆIvan Shamatovï¼‰ï¼šå¦‚ä½•å†™é’±</a></li>
<li><a href="../zh-CN466887/index.html">åªæ˜¯é™¤æ³•ï¼Œæˆ–å¦‚ä½•åˆ›å»ºæ•°å­¦ç†è®ºå¹¶ä»ä¸­è·åˆ©40ä¸‡ç¾â€‹â€‹å…ƒ</a></li>
<li><a href="../zh-CN466889/index.html">2019å¹´8æœˆçš„æ³¢ç½—çš„æµ·åŸŸååŒºåŸŸçŠ¶æ€</a></li>
<li><a href="../zh-CN466899/index.html">ä¸ºä»€ä¹ˆç°åœ¨æ”¾å¼ƒæ‰€æœ‰å†…å®¹å¹¶å­¦ä¹ Swiftå’ŒKotlin</a></li>
<li><a href="../zh-CN466903/index.html">æ€»æ˜¯å±•ç¤ºä½ çš„ä½œå“</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>