<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèΩ‚Äçü§ù‚Äçüë®üèª ‚ûó üë©üèΩ‚Äçü§ù‚Äçüë®üèæ Comment j'ai failli attraper un virus en essayant de vendre des bottes üñ±Ô∏è üåÜ ü§∞üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je fais partie de ces gens qui, avec le d√©but de l'automne, essaient de passer moins de temps dans la rue. √Ä Moscou, ce n'est pas difficile: vous √™tes...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment j'ai failli attraper un virus en essayant de vendre des bottes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/430074/"><img src="https://habrastorage.org/webt/wf/yz/a_/wfyza_3hf3mtbnqlffsve6xijoo.png"><br><br>  Je fais partie de ces gens qui, avec le d√©but de l'automne, essaient de passer moins de temps dans la rue.  √Ä Moscou, ce n'est pas difficile: vous √™tes limit√© √† la route du domicile au bureau et retour.  Cependant, le temps humide peut causer de l'inconfort dans la pi√®ce, surtout si votre lieu de travail, comme le mien, est √† la fen√™tre, et qu'un coll√®gue sur deux, se plaignant de congestion, demande √† a√©rer le bureau.  Afin de ne pas tomber dans la rate, cet automne j'ai mis √† jour la garde-robe. <br><br>  En pensant au sort des choses inutiles, je me suis demand√© quoi en faire: les jeter, les couper en lambeaux, les donner √† mon petit fr√®re pour les transporter?  Mais pour une chose, aucune de ces m√©thodes ne convenait: il s'agissait de bottes en cuir 44 d'une taille d√©cente, mais elles me d√©rangeaient dans l'ordre.  J'ai d√©cid√© de les vendre sur Avito.  J'ai t√©l√©charg√© des photos, indiqu√© un faux nom (la s√©curit√© de l'information est la m√™me), j'ai mis mes bottes, quelques autres choses et je me suis endormi.  Comment savais-je que cela entra√Ænerait une longue analyse de l'application des menaces cach√©es? <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/2m/re/zj/2mrezjviqrbnbh6xwbn__ps6j4u.png"><br><br><h2>  Agr√©able surprise </h2><br>  Le lendemain de quelques appels douteux, j'ai re√ßu un message SMS int√©ressant avec le contenu suivant: <br><br><img src="https://habrastorage.org/webt/je/mo/fs/jemofsiwbf3qmf5fsslki95roz8.jpeg"><br><br>  Apr√®s quelques jours, j'ai re√ßu un autre message similaire: <br><br><img src="https://habrastorage.org/webt/ru/k3/ap/ruk3apc1cjlrzjdqinme0ucnmgc.jpeg"><br><br>  Surpris que quelqu'un ait pu me transf√©rer de l'argent sur Internet (apparemment, je suis le seul vieux - j'utilise toujours des livres d'√©pargne papier), j'ai cliqu√© sur le lien dans SMS. <br><br>  Apr√®s cela, on m'a propos√© de t√©l√©charger une application Android (fichier apk).  Heureusement en t√©l√©chargeant le fichier, j'ai vu ce qui suit: <br><br><img src="https://habrastorage.org/webt/ab/c7/kd/abc7kd6qq9puqe7y7mc4f_vmaks.png"><br><br>  C'est cr√©dible!  Je voulais ardemment tout installer rapidement et y mettre fin. <br>  Mais ici, comme d'habitude, le syst√®me d'exploitation Android ennuyeux pour une raison quelconque ne m'a pas permis d'ex√©cuter le fichier.  "Donnez-moi d√©j√† l'argent!"  J'√©tais indign√©.  J'ai d√ª aller dans les param√®tres et activer une option "Sources inconnues", le t√©l√©phone est-il vraiment si stupide en 2018?  Au fait, mon t√©l√©phone est Xiaomi Remdi avec Andoid 6.0.1 (note pour les techniciens). <br><br><img src="https://habrastorage.org/webt/hp/jf/0z/hpjf0z2umptn_vvgxee1qiosvw8.png"><img src="https://habrastorage.org/webt/y2/-8/8o/y2-88olz-wcbay7wpanhxlwf3fw.png"><br><br>  Cela a √©t√© suivi d'une cha√Æne d'√©v√©nements √©tranges.  Le t√©l√©phone a continu√© de signaler des sources non fiables.  Mais Avito est une <b>source fiable</b> !  J'ai d√ª le rechercher sur Google, trouver un moyen de contourner ce probl√®me, puis le d√©sactiver dans les param√®tres.  Bient√¥t un certain antivirus est apparu que je n'ai pas install√©. <br><br><img src="https://habrastorage.org/webt/nl/ur/6c/nlur6cxmseun_mdsyj-uzqvls8a.png" width="170"><img src="https://habrastorage.org/webt/u7/qg/gg/u7qgggolf8mjgrf29o7ldijdpty.png" width="170"><img src="https://habrastorage.org/webt/52/le/x9/52lex9ukzmeujeoxah1bbraecsi.png" width="170"><img src="https://habrastorage.org/webt/b9/st/2g/b9st2gunjymlfnui5hogoyxp074.png" width="170"><br><br>  Enfin, j'ai vu la fen√™tre d'installation standard tant convoit√©e - <i>cela n'a aucun sens de regarder les autorisations de nos jours</i> , maintenant m√™me un ordinateur portable ne d√©marre pas tant que vous ne lui donnez pas un acc√®s complet au t√©l√©phone.  Moment joyeux de la fin de l'installation de l'application et COMMENCEZ!  J'attendais avec impatience l'argent promis.  En outre, l'application a demand√© des privil√®ges d'administrateur, avec lesquels j'ai joyeusement accept√©.  Malheureusement, l'application s'est comport√©e √©trangement et ne voulait pas payer, et bient√¥t elle a compl√®tement disparu de la liste des applications sur l'√©cran commun. <br><br><img src="https://habrastorage.org/webt/2l/og/wo/2logwomobffteufrjrghz6mtnme.png" width="170"><img src="https://habrastorage.org/webt/cl/qp/nl/clqpnlxzkas8ij9z1zx1beteckq.png" width="170"><br><br><img src="https://habrastorage.org/webt/3n/qw/r_/3nqwr_xdxrtrnsbdnwypzu02obo.png" width="170"><img src="https://habrastorage.org/webt/cu/oy/tk/cuoytkopc5plrkilwany_tizlpy.png" width="170"><img src="https://habrastorage.org/webt/jp/y6/b2/jpy6b2sosh_zxdtn5bbwohhnkug.png" width="170"><br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  Plus tard, j'ai v√©rifi√© sur un autre t√©l√©phone - Lenovo avec Android 4.4.2 √† bord.  La liste des autorisations lors de l'installation s'est av√©r√©e beaucoup plus longue.  Et aucune protection contre le jeu et anti-virus n'interf√®rent, vous devez uniquement autoriser l'installation √† partir de sources non fiables. <br><br><img src="https://habrastorage.org/webt/j_/9i/w1/j_9iw1jlp7dtyroivluxzlhftne.png" width="170"><img src="https://habrastorage.org/webt/ku/ay/h1/kuayh1icnuip2mwccqzdsrghvci.png" width="170"><br><br><img src="https://habrastorage.org/webt/lf/lc/v8/lflcv85sqajn4ju5-7qimh14rgu.png" width="170"><img src="https://habrastorage.org/webt/pk/2w/ps/pk2wpsjo3csovecieetanlqouki.png" width="170"><img src="https://habrastorage.org/webt/nu/ka/8a/nuka8a6nsp79yjtdibadpld5huw.png" width="170"><br></div></div><br><h2>  Altruisme </h2><br><br>  Alors, o√π en sommes-nous: <br><br><ul><li>  L'installation a dur√© 20 minutes. </li><li>  Je n'ai pas re√ßu d'argent. </li></ul><br>  Je pensais que le probl√®me √©tait une erreur de code, comme c'est souvent le cas avec les programmeurs.  J'ai d√©cid√© d'identifier les erreurs qui se produisent lorsque l'application s'ex√©cute sur mon t√©l√©phone et d'envoyer un rapport √† ce sujet au d√©veloppeur. <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  Maintenant, il reste si peu de gens d√©sint√©ress√©s, l'un d'eux est moi. <br></div></div><br>  Il est clair que ce type d'application devrait fonctionner lorsque Internet est connect√©, donc pour commencer j'ai essay√© d'analyser le trafic entre le t√©l√©phone et le serveur d'application. <br><br><div class="spoiler">  <b class="spoiler_title">Guide technique de configuration du proxy</b> <div class="spoiler_text">  Vous pouvez √©couter le trafic Internet √† tout moment entre le t√©l√©phone et le serveur, qu'il s'agisse d'un routeur domestique, d'un fournisseur Internet local, d'un r√©seau f√©d√©rateur Internet ou d'un serveur d'applications. <br><br>  Les probl√®mes: <br><br><ul><li>  L'acc√®s √† cet √©quipement est obligatoire. </li><li>  Il est n√©cessaire de s√©parer le trafic de l'application souhait√©e du reste. </li><li>  Dans le cas du cryptage (et en 2018, tout est d√©j√† crypt√©) - la connaissance de la cl√© est n√©cessaire. </li></ul><br>  J'ai d√©cid√© d'aller de mani√®re plus classique et de configurer des proxy sur le t√©l√©phone avec un serveur proxy sur mon propre ordinateur portable.  Afin d'att√©nuer le probl√®me de cryptage, j'ai d√©cid√© d'importer mon certificat et je n'ai pas d√©marr√© d'autres applications pour s√©parer le trafic des applications. <br>  J'ai choisi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">burp suite</a> comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">programme de</a> serveur proxy.  J'ai configur√© un serveur proxy et export√© un certificat sur mon t√©l√©phone. <br><br><img src="https://habrastorage.org/webt/h6/fl/tn/h6fltnqujuaa37og8s77oejovh8.png" width="520"><br><br><img src="https://habrastorage.org/webt/xy/xz/6k/xyxz6knuzcxtjobyss5-cpvpyrg.png" width="170"><img src="https://habrastorage.org/webt/-a/4e/vd/-a4evdiy2zz3pspeaai7idntxzk.png" width="170"><img src="https://habrastorage.org/webt/ol/52/82/ol528281ja24jszgftyz_hhpyes.png" width="170"><br></div></div><br>  Apr√®s avoir install√© un logiciel sp√©cialis√©, j'ai pu voir quelles demandes l'application envoie au serveur: <br><br> <a href=""><img src="https://habrastorage.org/webt/ar/0v/fu/ar0vfughbbfcewogzbpklk6egh0.png"></a> <br><br>  Comme vous pouvez le constater, les donn√©es ne sont pas envoy√©es (la valeur d'h√¥te inconnue est indiqu√©e dans la colonne IP), de plus, elles ne peuvent pas √™tre analys√©es en raison de la pr√©sence d'un chiffrement suppl√©mentaire au niveau de l'application.  A en juger par erreur, le t√©l√©phone n'a pas pu d√©terminer l'adresse IP du serveur et de ses sous-domaines <b>https: //*.sky-sync.pw</b> par son nom de domaine. <br><br>  Cela ne peut signifier que les options suivantes: <br><br><ul><li>  <b>Le nom de domaine a cess√© d'exister</b> <br><ul><li>  Il a √©t√© bloqu√© par le propri√©taire lui-m√™me. </li><li>  Il a √©t√© bloqu√© par le greffier sur la plainte. </li></ul></li><li>  <b>Probl√®me avec le serveur DNS</b> <br><ul><li>  Le serveur DNS ne conna√Æt pas l'adresse, car le d√©veloppeur en production a d√©ploy√© l'adresse DNS locale. </li><li>  Le serveur DNS a sp√©cifiquement bloqu√© cette demande, ce qui n'est pas surprenant √† l'√®re de la censure sur Internet. </li></ul></li></ul><br>  Pour v√©rifier l'hypoth√®se d'un probl√®me avec le serveur DNS, j'ai essay√© de faire des demandes √† partir de diff√©rents grands serveurs DNS: Google, Yandex, OpenDNS (g√©n√©ralement le DNS local est censur√©): <br><br><img src="https://habrastorage.org/webt/8n/-q/me/8n-qmebbunqccfns6anpcdghsg8.png"><br><br>  On peut voir qu'aucun d'eux ne sait rien de ce nom.  Ensuite, j'ai regard√© les informations whois sur l'enregistrement de domaine: <br><br><img src="https://habrastorage.org/webt/dd/hw/ms/ddhwmsu4lilowe1twixzng6klqs.png"><br><br>  Curieusement: le domaine est enregistr√©, c'est-√†-dire qu'il n'est probablement pas local, mais comme le domaine ne se r√©sout pas, il peut avoir √©t√© bloqu√© par le registraire pour abus.  Mais pour quoi?  Quel mal a-t-il fait? <br><br>  Pour d√©couvrir ce qu'est cette application tout de m√™me et comment je peux prendre mon argent, j'ai d√©cid√© d'utiliser la <s>magie du</s> reverse engineering. <br><br><h2>  Abyss </h2><br>  Si vous √™tes un humaniste et avez lu jusqu'√† cet endroit, alors c'est bien - pour le d√©veloppement de la suite, vous m√©ritez un prix <s>posthume</s> . <br><br><h3>  <i>Bo√Æte √† outils</i> </h3><br>  Pour savoir ce qui est ¬´sous le capot¬ª de l'application, nous devons t√©l√©charger des outils sp√©cialis√©s.  Vous pouvez les t√©l√©charger individuellement: <br><br><ul><li>  <b>D√©baller le conteneur apk</b> <br><ul><li>  Classique - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ApkTool</a> . </li><li>  Vous pouvez le d√©compresser avec un archiveur classique, mais toutes les ressources binaires, y compris les applications et le fichier manifeste, seront alors illisibles. </li></ul></li><li>  <b>D√©compilateur de code Smali</b> <br><ul><li>  La norme est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dex2Jar</a> , mais apprenez que ce programme fonctionne souvent de mani√®re tordue. </li><li>  Vous devez aborder la question tr√®s attentivement, car le d√©compilateur au d√©compilateur est diff√©rent, nous y r√©fl√©chirons plus tard. </li></ul></li><li>  <b>Un programme pour visualiser le code d√©compil√©</b> , je recommanderais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">jd-gui</a> </li></ul><br>  Ou vous pouvez utiliser le produit, g√©n√©ralement pay√©, o√π il y a tout √† la fois.  Je pr√©f√®re <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">JebDecompiler</a> : il peut simplement soumettre une application apk √† son entr√©e, et il organisera soigneusement tout dans les onglets, en plus il est pratique de basculer entre smali et code Java d√©compil√©. <br><br>  S√©par√©ment, je veux noter: <br><br><ul><li>  S'il y avait des biblioth√®ques natives (le dossier / libs dans la structure de l'application), un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©sassembleur</a> serait n√©cessaire. </li><li>  Vous aurez peut-√™tre besoin d'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ensemble d'utilitaires</a> pour travailler avec le code smali (dex √† smali, smali √† dex). </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Syntaxe en surbrillance</a> dans Notepad ++ afin de ne pas casser les yeux. </li></ul><br><h3>  <i>Seuls les vieillards entrent dans la bataille</i> </h3><br><h4>  Revue </h4><br>  Lorsque vous ouvrez le code d√©compil√©, il devient imm√©diatement clair qu'il est obscurci. <br><br><img src="https://habrastorage.org/webt/jg/m4/ah/jgm4ahs5rxpts6cfz_lmq9ycp5m.png"><br><br>  Comment est-ce que je comprends cela? <br><br><ul><li> Noms de classe lisibles par l'homme <br> <code>isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq.wukovicq;</code> </li> <li>  Code inaccessible <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span>) {&lt;/li&gt; String v1 = <span class="hljs-string"><span class="hljs-string">"flnwznvh"</span></span>;&lt;/li&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v1.length() != <span class="hljs-number"><span class="hljs-number">661</span></span> &amp;&amp; v1.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">104</span></span>) {&lt;/li&gt; v1.length();&lt;/li&gt; }</code> </pre> </li><li>  Cryptage des cha√Ænes <br><pre> <code class="java hljs">vcgrnfjx.execSQL(nvhdzjfo.xipswfqb(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6"</span></span>,<span class="hljs-string"><span class="hljs-string">"378f40211b6e32a5406cd97e85bcf9ad"</span></span>,<span class="hljs-string"><span class="hljs-string">"6378a459b1c20edf"</span></span>, <span class="hljs-string"><span class="hljs-string">"gexnfwok"</span></span>, <span class="hljs-string"><span class="hljs-string">"meazfhdp"</span></span>, <span class="hljs-string"><span class="hljs-string">"bsmotaxn"</span></span>})</code> </pre> </li></ul><br>  Il est peu probable que le programmeur ait √©t√© assez fou pour d√©velopper initialement le code.  Tr√®s probablement, il a utilis√© l'un des obscurcisseurs accessibles au public.  Cette √©tape est assez courante pour compliquer l'analyse de code afin de prot√©ger la propri√©t√© intellectuelle, par exemple, mais quel genre de ¬´twist¬ª pour le chercheur. <br><br>  Prenons attention √† la fonction de cryptage principale: <br><br><img src="https://habrastorage.org/webt/ok/y9/dz/oky9dzmhwwrdykheiepdiuzzlao.png"><br><br>  La fonction de cryptage elle-m√™me accepte 3 lignes d'entr√©e (si plus, les autres n'ont pas de sens): <br><br><ol><li>  texte chiffr√© </li><li>  la cl√© </li><li>  vecteur d'initialisation pour CBC - AES </li></ol><br>  Cette fonction est r√©f√©renc√©e dans le programme au moins 213 fois: <br><br><img src="https://habrastorage.org/webt/ok/y9/dz/oky9dzmhwwrdykheiepdiuzzlao.png"><br><br>  Je note qu'il s'agit d'une cl√© importante pour l'analyse de code normale.  Ensuite, <s><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vous devez penser que</a></s> nous avons les fa√ßons suivantes d'analyser le programme: <br><br><ol><li>  Restaurer la logique de la fonction, collecter tous les appels dans l'analyse statique, d√©crypter les lignes.  Cela peut √™tre difficile et long, mais cela donnera un r√©sultat √† 100%. </li><li>  Apportez des modifications au code smali de l'application, compilez √† nouveau, ex√©cutez l'application et capturez les lignes d√©chiffr√©es dans les journaux.  C'est facile √† faire, mais le comportement de l'application √† un lancement particulier est inconnu, et vous risquez de ne pas voir l'image dans son int√©gralit√© (pas d'appels √† toutes les fonctions).  De plus, il peut y avoir des probl√®mes avec l'autocontr√¥le par l'application du certificat et (ou) l'int√©grit√©. </li><li>  S'il est difficile de restaurer la logique de la fonction, vous pouvez collecter tous les appels de fonction et extraire ces fonctions elles-m√™mes avec les param√®tres n√©cessaires directement dans la dynamique (en utilisant, par exemple, le logiciel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Frida</a> . </li></ol><br>  Nous choisirons la m√©thode num√©ro 1 comme la m√©thode la plus fiable. <br><br><h2>  D√©sobfuscation </h2><br>  Faites imm√©diatement une r√©servation, la d√©sobfuscation est souvent un processus long et fastidieux, vous devez donc √©valuer correctement votre calendrier.  Pour notre analyse, il suffit de d√©crypter toutes les lignes au moins d'une certaine mani√®re et de le faire en un minimum de temps, m√™me de mani√®re b√©quille, que de jouer pendant un mois dans le but d'une vague option id√©ale. <br><br>  La d√©sobfuscation qualitative est logique dans le cas d'une ing√©nierie inverse compl√®te, par exemple, les voleurs de propri√©t√© intellectuelle doivent le faire lorsqu'ils essaient de copier la solution d'un concurrent, ou si vous devez souvent analyser des programmes trait√©s par un obscurcisseur, mais ce n'est pas notre cas. <br><br>  Code source apr√®s le d√©compilateur JEB Decompiler v.1.4 <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">podxiwkt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v6; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v4; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v2; Cipher v1; String v10 = args[<span class="hljs-number"><span class="hljs-number">0</span></span>]; String v7 = args[<span class="hljs-number"><span class="hljs-number">1</span></span>]; String v0 = args[<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { goto label_9; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10.length() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_11; } goto label_9; label_11: IvParameterSpec v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IvParameterSpec(v0.getBytes()); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { v1 = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"AES/CBC/NoPadding"</span></span>); goto label_15; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(NoSuchPaddingException v3) { } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(NoSuchAlgorithmException v3_1) { } String v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; goto label_10; label_15: SecretKeySpec v9 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecretKeySpec(v7.getBytes(), <span class="hljs-string"><span class="hljs-string">"AES"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v11_1 = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v2.length &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_48; } v4 = <span class="hljs-number"><span class="hljs-number">0</span></span>; v6 = v2.length - <span class="hljs-number"><span class="hljs-number">1</span></span>; label_29: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v6 &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_38; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v2[v6] != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_33; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception v3_2) { goto label_51; } ++v4; label_33: --v6; goto label_29; label_38: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v4 &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_48; } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v8 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[v2.length - v4]; System.arraycopy(v2, <span class="hljs-number"><span class="hljs-number">0</span></span>, v8, <span class="hljs-number"><span class="hljs-number">0</span></span>, v2.length - v4); v2 = v8; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception v3_2) { label_51: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; goto label_10; } label_48: v11 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(v2); goto label_10; label_9: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; label_10: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v11; } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Note du d√©compilateur</b> <div class="spoiler_text">  Soit dit en passant, dex2jar plante souvent.  Ainsi, dans la figure ci-dessous, on peut voir que la version 2.0 dex2jar ne pouvait pas faire face et vient de publier un code smali. <br><br><img src="https://habrastorage.org/webt/qr/gw/wa/qrgwwazampyf69hicr0-0evyrxe.png"><br><br>  Sa derni√®re version, compil√©e √† partir des sources, a produit un code d√©compil√© pour cette fonction, mais n'a pas pu en d√©compiler beaucoup d'autres (c'est l'astuce). <br><br><img src="https://habrastorage.org/webt/66/3v/kp/663vkp2d0rmiwxsbblllpyxpytm.png"><br><br><img src="https://habrastorage.org/webt/i7/n_/8p/i7n_8p01cstevantsmbaxamb7xe.png"><br><br>  Conclusion: r√©fl√©chissez soigneusement au choix d'un d√©compilateur - cela vous fera gagner beaucoup de temps et sera plus facile que d'analyser le code smali. </div></div><br><br>  Donc, si nous collons simplement ce code dans l'IDE maintenant, cela ne fonctionnera pas en raison d'erreurs. <br><br>  <b>Il est important de se souvenir: le</b> d√©compilateur n'est pas oblig√© de produire du code valide √©crit par le d√©veloppeur.  Il n'est qu'une bou√©e de sauvetage dans l'analyse et fait des hypoth√®ses sur la fa√ßon dont le code pourrait √™tre √©crit.  Dans la plupart des cas, apr√®s optimisation par le compilateur, la t√¢che de restauration du code d'origine cesse compl√®tement d'√™tre triviale. <br><br>  Exemple de d√©compilation incorrecte: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { goto label_9; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10.length() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_11; } goto label_9; ‚Ä¶ label_9: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v11;</code> </pre> <br>  On voit que √ßa s'est mal pass√© et inop√©rant.  Nous r√©√©crivons: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) || (v10.length() == <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; }</code> </pre><br>  Maintenant, c'est beaucoup plus clair, voici la v√©rification d'entr√©e habituelle.  Dans ce cas, nous avons besoin de: <br><br><ul><li>  Remplacez tous les "goto" par d'autres constructions de langage, comme  "Goto" est depuis longtemps un op√©rateur invalide. </li><li>  Remplacez les appels de biblioth√®que Android par des appels de biblioth√®que Java (si nous essayons d'ex√©cuter du code dans l'IDE Java). </li><li>  Ins√©rez des classes d√©pendantes r√©f√©renc√©es par notre code. </li><li>  Pensez par vous-m√™me √† ce qui ne va pas. </li></ul><br>  En cons√©quence, nous obtenons: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.company; <span class="hljs-comment"><span class="hljs-comment">//package isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq; import java.util.Base64; //import android.util.Base64; //import bnxvhlyg.nkhoirul.zfxogwqi.mdpqejcw.srnepbly.pcbvwxrs.vixdqclm.wnuqvrhp.bnvceayd.bwdoclkr; //   import java.security.Key; import java.security.NoSuchAlgorithmException; import java.security.spec.AlgorithmParameterSpec; import javax.crypto.Cipher; import javax.crypto.NoSuchPaddingException; import javax.crypto.spec.IvParameterSpec; import javax.crypto.spec.SecretKeySpec; public abstract class Main { public Main() { super(); } //hex to ascii public static byte[] xkvasepi(String str) { byte[] v0 = null; if(str != null &amp;&amp; str.length() &gt;= 2) { int v2 = str.length() / 2; v0 = new byte[v2]; int v1; for(v1 = 0; v1 &lt; v2; ++v1) { v0[v1] = ((byte)Integer.parseInt(str.substring(v1 * 2, v1 * 2 + 2), 16)); } } return v0; } public static String podxiwkt(String[] args) { int v6; int v4; byte[] v2; Cipher v1; String v10 = args[0]; //text String v7 = args[1]; //key String v0 = args[2]; //IV //check if ((v10 == null) || (v10.length() == 0)) { return ""; } IvParameterSpec v5 = new IvParameterSpec(v0.getBytes()); try { v1 = Cipher.getInstance("AES/CBC/NoPadding"); } catch(NoSuchPaddingException v3) { return ""; } catch(NoSuchAlgorithmException v3_1) { return ""; } SecretKeySpec v9 = new SecretKeySpec(v7.getBytes(), "AES"); int v11_1 = 2; try { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); //v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), 0); v2=v1.doFinal(xkvasepi(v10)); //check if(v2.length &lt;= 0) { return new String(v2); } } catch(Exception v3_2) { return ""; } v4=0; for (v6=v2.length-1;v6&gt;=0;v6--){ if (v2[v6]==0) ++v4; } if(v4 &gt; 0) { try { byte[] v8 = new byte[v2.length - v4]; System.arraycopy(v2, 0, v8, 0, v2.length - v4); v2 = v8; } catch (Exception v3_2) { return ""; } } v2 = Base64.getDecoder().decode(v2); return new String(v2); } public static void main(String[] args) { // write your code here System.out.println(podxiwkt(new String[] { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc", "637904cd08aeb2d3f6a21b5c7e84f519", "8f4c796d5a3120eb", "zcmwgvdn", "mkngbsyr", "rwcdaieu" })); } }</span></span></code> { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc", "637904cd08aeb2d3f6a21b5c7e84f519", "8f4c796d5a3120eb", "zcmwgvdn", "mkngbsyr", "rwcdaieu"})); <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.company; <span class="hljs-comment"><span class="hljs-comment">//package isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq; import java.util.Base64; //import android.util.Base64; //import bnxvhlyg.nkhoirul.zfxogwqi.mdpqejcw.srnepbly.pcbvwxrs.vixdqclm.wnuqvrhp.bnvceayd.bwdoclkr; //   import java.security.Key; import java.security.NoSuchAlgorithmException; import java.security.spec.AlgorithmParameterSpec; import javax.crypto.Cipher; import javax.crypto.NoSuchPaddingException; import javax.crypto.spec.IvParameterSpec; import javax.crypto.spec.SecretKeySpec; public abstract class Main { public Main() { super(); } //hex to ascii public static byte[] xkvasepi(String str) { byte[] v0 = null; if(str != null &amp;&amp; str.length() &gt;= 2) { int v2 = str.length() / 2; v0 = new byte[v2]; int v1; for(v1 = 0; v1 &lt; v2; ++v1) { v0[v1] = ((byte)Integer.parseInt(str.substring(v1 * 2, v1 * 2 + 2), 16)); } } return v0; } public static String podxiwkt(String[] args) { int v6; int v4; byte[] v2; Cipher v1; String v10 = args[0]; //text String v7 = args[1]; //key String v0 = args[2]; //IV //check if ((v10 == null) || (v10.length() == 0)) { return ""; } IvParameterSpec v5 = new IvParameterSpec(v0.getBytes()); try { v1 = Cipher.getInstance("AES/CBC/NoPadding"); } catch(NoSuchPaddingException v3) { return ""; } catch(NoSuchAlgorithmException v3_1) { return ""; } SecretKeySpec v9 = new SecretKeySpec(v7.getBytes(), "AES"); int v11_1 = 2; try { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); //v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), 0); v2=v1.doFinal(xkvasepi(v10)); //check if(v2.length &lt;= 0) { return new String(v2); } } catch(Exception v3_2) { return ""; } v4=0; for (v6=v2.length-1;v6&gt;=0;v6--){ if (v2[v6]==0) ++v4; } if(v4 &gt; 0) { try { byte[] v8 = new byte[v2.length - v4]; System.arraycopy(v2, 0, v8, 0, v2.length - v4); v2 = v8; } catch (Exception v3_2) { return ""; } } v2 = Base64.getDecoder().decode(v2); return new String(v2); } public static void main(String[] args) { // write your code here System.out.println(podxiwkt(new String[] { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc", "637904cd08aeb2d3f6a21b5c7e84f519", "8f4c796d5a3120eb", "zcmwgvdn", "mkngbsyr", "rwcdaieu" })); } }</span></span></code> </pre> <br>  Ce code remplit avec succ√®s.  Une fois que son travail est devenu clair, il peut √™tre simplifi√© et simplifi√©, conduisant au genre pr√©tendument laconique √©crit par le programmeur (√† moins, bien s√ªr, que ses mains n'√©taient pas tordues au d√©part). <br><br><div class="spoiler">  <b class="spoiler_title">Remarque</b> <div class="spoiler_text">  Soit dit en passant, dans ce cas, le d√©chiffrement des cha√Ænes peut √™tre d√©montr√© en utilisant un tas de ressources en ligne.  Un exemple d'appel d'une cha√Æne crypt√©e dans un programme: <br><br><img src="https://habrastorage.org/webt/wk/0q/h4/wk0qh4-_qox9qigts4orp76gu2u.png"><br><br>  Ici, le vecteur d'initialisation doit d'abord √™tre converti au format Hex: <br><br><img src="https://habrastorage.org/webt/ey/us/ob/eyusob7yodb8dkmiucxaf8mfrpi.png"><br><br>  Remplacez toutes les valeurs: <br><br><img src="https://habrastorage.org/webt/5j/xd/fg/5jxdfg4z4xyl1qoiqxpdtjzv1hc.png"><br><br>  Et √† la fin, d√©codez √† partir de base64: <br><br><img src="https://habrastorage.org/webt/p6/s4/oy/p6s4oyvyfxrwkoodlfqj0l8c6ii.png"><br><br>  En cons√©quence, nous obtenons la cha√Æne habituelle et l'appel prend un aspect significatif. <br></div></div><br>  Ainsi, vous devez parcourir tout le code et collecter toutes les cha√Ænes crypt√©es, maintenant nous pouvons les d√©crypter ind√©pendamment.  Le point important ici est qu'au stade de ¬´modifier et commenter le code¬ª, nous pouvons travailler √† la fois au niveau smali et au niveau Java (smali d√©compil√©). <br><br><table><tbody><tr><td width="120"></td><td width="330">  Avantages de la modification </td><td width="330">  Mods </td></tr><tr><td>  Smali </td><td>  Vous pouvez apporter des modifications, recompiler en dex et d√©compiler avec de nouvelles lignes </td><td>  Il n'est pas toujours facile de travailler avec le code smali.  Si la modification est incorrecte, l'application ne compilera pas </td></tr><tr><td>  Java </td><td>  Il est souvent beaucoup plus facile d'extraire des donn√©es d'op√©rations de niveau sup√©rieur. </td><td>  La plupart des visualiseurs de code Java ne peuvent pas modifier. </td></tr></tbody></table><br>  Un autre exemple de ligne <br><br><pre> <code class="java hljs">vcgrnfjx.execSQL(nvhdzjfo.xipswfqb(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6"</span></span>,<span class="hljs-string"><span class="hljs-string">"378f40211b6e32a5406cd97e85bcf9ad"</span></span>,<span class="hljs-string"><span class="hljs-string">"6378a459b1c20edf"</span></span>, <span class="hljs-string"><span class="hljs-string">"gexnfwok"</span></span>, <span class="hljs-string"><span class="hljs-string">"meazfhdp"</span></span>, <span class="hljs-string"><span class="hljs-string">"bsmotaxn"</span></span>})</code> </pre> <br>  De l√†, il est tr√®s facile de r√©cup√©rer des param√®tres √† l'aide d'une expression r√©guli√®re, que d'√©crire un r√©gulier sur le code suivant: <br><br>  <b>Exemple de code Smali 1</b> <br><br><pre> <code class="plaintext hljs">00000280 new-instance v13, Ljava/lang/StringBuilder; 00000284 invoke-direct {v13}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V 0000028A const/4 v14, 0x6 0000028C new-array v14, v14, [Ljava/lang/String; 00000290 const/4 v15, 0x0 00000292 const-string v16, "f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6" 00000296 aput-object v16, v14, v15 0000029A const/4 v15, 0x1 0000029C const-string v16, "378f40211b6e32a5406cd97e85bcf9ad" 000002A0 aput-object v16, v14, v15 000002A4 const/4 v15, 0x2 000002A6 const-string v16, "6378a459b1c20edf" 000002AA aput-object v16, v14, v15 000002AE const/4 v15, 0x3 000002B0 const-string v16, "gexnfwok" 000002B4 aput-object v16, v14, v15 000002B8 const/4 v15, 0x4 000002BA const-string v16, "meazfhdp" 000002BE aput-object v16, v14, v15 000002C2 const/4 v15, 0x5 000002C4 const-string v16, "bsmotaxn" 000002C8 aput-object v16, v14, v15</code> </pre> <br><br>  <b>Exemple de code Smali 2</b> <br><br><pre> <code class="plaintext hljs">0000008E new-array v0, v0, [Ljava/lang/String; 00000092 move-object/from16 v89, v0 00000096 const/16 v90, 0x0 0000009A const-string v91, "4500b5e2e2ad26b7545eb54d70ab360ae28c9d031e2afcc3f6a2b2ac488ea440" 0000009E aput-object v91, v89, v90 000000A2 const/16 v90, 0x1 000000A6 const-string v91, "da96f678922d4b07350b3a184ecc1f5e" 000000AA aput-object v91, v89, v90 000000AE const/16 v90, 0x2 000000B2 const-string v91, "0cf69e3d2745a1b8" 000000B6 aput-object v91, v89, v90 000000BA const/16 v90, 0x3 000000BE const-string v91, "jhiqsaoe" 000000C2 aput-object v91, v89, v90 000000C6 const/16 v90, 0x4 000000CA const-string v91, "khbqxurn" 000000CE aput-object v91, v89, v90</code> </pre> <br><br>  <b>Exemple de code Smali 3</b> <br><br><pre> <code class="plaintext hljs">00000D3E new-array v0, v0, [Ljava/lang/String; 00000D42 move-object/16 v298, v0 00000D48 const/4 v0, 0x0 00000D4A move/16 v299, v0 00000D50 const-string v0, "b286945744e085f4d5c19916fd261481" 00000D54 move-object/16 v300, v0 00000D5A move-object/from16 v0, v300 00000D5E move-object/from16 v1, v298 00000D62 move/from16 v2, v299 00000D66 aput-object v0, v1, v2 00000D6A const/4 v0, 0x1 00000D6C move/16 v299, v0 00000D72 const-string v0, "df6883742b2911ac5ac7b4dee065390f" 00000D76 move-object/16 v300, v0 00000D7C move-object/from16 v0, v300 00000D80 move-object/from16 v1, v298 00000D84 move/from16 v2, v299 00000D88 aput-object v0, v1, v2 00000D8C const/4 v0, 0x2 00000D8E move/16 v299, v0 00000D94 const-string v0, "90a463ce2df17b58" 00000D98 move-object/16 v300, v0 00000D9E move-object/from16 v0, v300 00000DA2 move-object/from16 v1, v298 00000DA6 move/from16 v2, v299 00000DAA aput-object v0, v1, v2 00000DAE const/4 v0, 0x3 00000DB0 move/16 v299, v0 00000DB6 const-string v0, "cupyzsgq" 00000DBA move-object/16 v300, v0 00000DC0 move-object/from16 v0, v300 00000DC4 move-object/from16 v1, v298 00000DC8 move/from16 v2, v299 00000DCC aput-object v0, v1, v2</code> </pre> <br><br>  Comme nous pouvons le voir, les variables internes changent, la s√©quence des commandes varie, le nombre d'arguments varie √©galement, en plus, dans le programme, la fonction de d√©chiffrement est appel√©e non pas directement, mais via les fonctions de la couche.  Essayez d'√©crire vous-m√™me une r√®gle pour rechercher cette construction, √©vitez les erreurs de capture de cha√Ænes √† partir d'autres fonctions et faites tout cela rapidement ( <s>bonne chance</s> ). <br><br>  Plan de pi√®ge: <br><br><ol><li>  Nous allons extraire toutes les valeurs du code d√©compil√©. </li><li>  D√©chiffrez. </li><li>  Remplacez le texte chiffr√© par celui ouvert dans le code smali.  Nous substituons, par exemple, au lieu du premier op√©rateur.  (Il serait plus professionnel de couper tout l'appel de fonction et de laisser la cha√Æne d√©chiffr√©e retourn√©e, mais l√† encore, il y a un gros risque de rupture du programme). </li><li>  Collectons le code smali dans un fichier dex. </li><li>  Il sera commode d'approfondir l'analyse de code, o√π nous avons commenc√©. </li></ol><br>  Si vous collectez tout le code d√©compil√© dans un seul fichier, vous obtenez environ 20000 lignes, ce qui pour l'analyse manuelle n√©cessite beaucoup de temps, ce qui co√ªte clairement plus cher que les bottes que je mets en vente.  Tout d'abord, rassemblez toutes les lignes avec une expression r√©guli√®re. <br><br><img src="https://habrastorage.org/webt/gq/42/ln/gq42ln2llsfpoxt2yjw0orhfr2m.png"><br><br>  On voit 593 matches, plus une dizaine qui ne tombent pas sous cette r√®gle, <s>la famille a son mouton noir</s> .  Un exemple: <br><br><img src="https://habrastorage.org/webt/zw/bn/5y/zwbn5y1ghfnrf8i3auethghnzdo.png"><br><br>  Trier, filtrer, 422 lignes uniques au total: <br><br><img src="https://habrastorage.org/webt/en/c1/ji/enc1jiwqkssvsa3irluzvvxfyzu.png"><br><br>  Nous passons par la fonction de d√©cryptage que nous avons restaur√©e plus t√¥t.  R√©sultat: <br><br><img src="https://habrastorage.org/webt/cv/no/op/cvnoopawvfln2h4yq-ducg3zite.png"><br><br>  Remplacez le texte chiffr√© par celui ouvert en code smali en utilisant Python: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os words_replace=dict() words_replace[<span class="hljs-string"><span class="hljs-string">"0018aacad3d146266317d8d8c51785fd"</span></span>]=<span class="hljs-string"><span class="hljs-string">"imei"</span></span> words_replace[<span class="hljs-string"><span class="hljs-string">"016d15e4d0a72667c61428e736a6f3b8"</span></span>]=<span class="hljs-string"><span class="hljs-string">"WakeLock"</span></span> words_replace[<span class="hljs-string"><span class="hljs-string">"032c534efb6c9990cd845a08c5a08b95"</span></span>]=<span class="hljs-string"><span class="hljs-string">"inbox"</span></span> #‚Ä¶  .. # smali- #      <span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">change</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"file="</span></span></span></span><span class="hljs-function"><span class="hljs-params">+path)</span></span></span><span class="hljs-function"> file_handle </span></span>= open(path, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) context_full = file_handle.read() file_handle.close() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i in words_replace: context_full=context_full.replace(i, words_replace[i]) #print (i+<span class="hljs-string"><span class="hljs-string">""</span></span>+words_replace[i]) file_handle = open(path, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) context_full = file_handle.write(context_full) file_handle.close() #      smali- <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> top, dirs, files in os.walk(<span class="hljs-string"><span class="hljs-string">'C:\\work\\test'</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> nm in files: path=os.path.join(top, nm) print (path) change(path)</code> </pre> <br>  Nous collectons les fichiers smali en dex: <br><br><img src="https://habrastorage.org/webt/dz/41/qz/dz41qzrvcue-bl2j-vb2jp4cw_w.png"><br><br>  Maintenant, cela peut √™tre en quelque sorte analys√© (en lisant le premier argument de l'ensemble de la construction): <br><br><img src="https://habrastorage.org/webt/ik/5g/ro/ik5grom-c0igb9zqgh-hzdhf6yg.png"><br><br><h2>  Analyse </h2><br>  Donc, nous avons 20 000 lignes de code plus ou moins lisibles, nous n'avons pas besoin de faire une analyse compl√®te.  Il est n√©cessaire de comprendre la fonctionnalit√© dans son ensemble.  Ici, en fait, seule la possibilit√© de lire le code source Java est requise.  Parcourez le code, examinez les r√©f√©rences crois√©es, renommez les variables et les fonctions. <br><br>  Quelle est la meilleure fa√ßon d'analyser une application Android, en particulier une grande? <br><br>  <b>Option 1: vous pouvez vous d√©placer √† partir du fichier manifeste</b> <br><br>  Par exemple, s√©quentiellement √† partir de LAUNCHER, essayez de d√©rouler toute la cha√Æne d'appels.  Soit dit en passant, n'oubliez pas qu'il existe toujours ¬´Receiver¬ª et ¬´Service¬ª qui peuvent changer l'ex√©cution lin√©aire du programme. <br><br><img src="https://habrastorage.org/webt/hk/rd/j1/hkrdj1deeuxaq294dxfpgswr1pu.png"><br><br><div class="spoiler">  <b class="spoiler_title">Fichier manifeste complet</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" standalone="no"?&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:installLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"internalOnly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.permission.C2D_MESSAGE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.permission.RECEIVE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SEND_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_PHONE_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WAKE_LOCK"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SYSTEM_ALERT_WINDOW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.MODIFY_AUDIO_SETTINGS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_NETWORK_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_WIFI_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.permission.C2D_MESSAGE"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:protectionLevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"signature"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/tgiwmpqy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:noHistory</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:excludeFromRecents</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/tgiwmpqy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"zemquyog.csrtmnak.xrkfygen.wkahrnjd.acnfunjh.rgipxbuf.lruiwxeg.blqndche.dcjihbou"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xbfrscou.hxrvwnoi.djvpcqri.enlnrfio.aoegxbiu.heywzmnb.znfnxcht.nazcxobq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hcfkagds.timkagsd.oetvghzr.fcioynvl.psynofdj.slcghdjz.tapnwsdk.gzvwnban.htenafdb.qwebhzgy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:noHistory</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:excludeFromRecents</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"njfbwmre.voefarqx.ftuxvngl.wrmshxqj.zdenywgn.eiwyunlg.jysgkbam.yrijthab.vstqxpuo.iplamgxf"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483647"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gfbaznoc.asyoqtnm.kbetoqca.mqysobzu.gqwfibrv.dorxijuk.wgzkmiep.ywnnurzv.csfpqhrn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BIND_DEVICE_ADMIN"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/pkzrlscm"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/ynqukvnb"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.action.DEVICE_ADMIN_ENABLED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ykwbodxc.gymjhibn.kgmdfqor.hbasvmfz.yegkmaif.ortzknvm.quplincn.cuxytvhs.fqonzuts.cyuoxgqi.znumwyct"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.permission.SEND"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.RECEIVE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.REGISTRATION"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.UNREGISTRATION"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:exported</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"kqwihjot.nvkqjloc.grjnyknm.owydvckh.mugknwdx.enhcyvja.mhvbpcue.ztbwjhfo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.LOCKED_BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.htc.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.USER_PRESENT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BATTERY_OKAY"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BATTERY_LOW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.ACTION_POWER_CONNECTED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.ACTION_POWER_DISCONNECTED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.APP_ERROR"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.HEADSET_PLUG"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PHONE_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.NEW_OUTGOING_CALL"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.TIME_TICK"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.SCREEN_ON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.SCREEN_OFF"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.net.conn.CONNECTIVITY_CHANGE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.net.wifi.WIFI_STATE_CHANGED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.DREAMING_STOPPED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.HOME"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btnsxnuz.wmjizbky.lynvjxqz.zinomjuv.yizlgcnf.qwoikgnc.wnrskjea.wfqgmeny.lcgvqrms.ocwkgblp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ltvsrezg.ehxndrat.twnnyxrf.nqynefws.dhbalcnr.ynjkuxod.nhoxmsbq.nackoyhn.voycgfek.znhwkqba.taxvnfyn"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rbnakfzo.qsreiubk.pwvlnngs.twoxnhfv.mftarcnd.pfioxcub.xjlaftqr.nxrqvlwh"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.ugshpjvo"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  <b>Option 2: vous pouvez vous d√©placer √† partir de lignes int√©ressantes</b> <br><br><img src="https://habrastorage.org/webt/ey/vs/oe/eyvsoe_svrnkzau5dfdp4yvht7g.png"><br><br><div class="spoiler">  <b class="spoiler_title">Partie de cha√Ænes d√©chiffr√©es</b> <div class="spoiler_text"><pre> <code class="bash hljs">system_update.apk () () , error = , unregistered = ,  .permission.C2D_MESSAGE //sky-sync.pw/ //sms/inbox /system_update.apk ALLCONTACTS ALLMSG AUTHENTICATION_FAILED Acquiring wakelock Application BLOCKER_BANKING_START BLOCKER_EXTORTIONIST_START BLOCKER_STOP BLOCKER_UPDATE_START Banking CHANGE_GCM_ID CONTACTS CONTACTS_PRO CREATE TABLE IF NOT EXISTS END Error|No process list|No access Extortionist Foreground GCM returned invalid number of GCMBaseIntentService GCMBroadcastReceiver GCMIntentService- GCMRegistrar GCM_LIB GET MESSAGE Mobile Network NEWMSG Not retrying failed operation ONLINE PAGE POST Process finished with <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> code 0 RESTART Received deleted messages Registering receiver Releasing wakelock SERVICE_NOT_AVAILABLE SSL START STOP Saving regId on app version Scheduling registration retry, backoff = Setting registeredOnServer status as Stop System UNBLOCK UPDATE UPDATE_PATTERNS URL UTF-8 Update WakeLock Wakelock reference is null Wi-Fi WiMax _success add_msg_ok address android.intent.action.QUICKBOOT_POWERON answer_text answer_to api_url app appVersion application application/vnd.android.package-archive apps_list ask backoff_ms blocker blocker_banking blocker_banking_autolock blocker_banking_forced_access blocker_banking_success blocker_extortionist blocker_extortionist_autolock blocker_extortionist_forced_access blocker_extortionist_success blocker_update blocker_update_forced_access blocker_update_success body build callback cardSuccess check com.android.settings com.google.android.c2dm.intent.RECEIVE com.google.android.c2dm.intent.REGISTER com.google.android.c2dm.intent.REGISTRATION com.google.android.c2dm.intent.UNREGISTER com.google.android.gcm com.google.android.gcm.intent.RETRY com.google.android.gsf com.htc.intent.action.QUICKBOOT_POWERON <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> command_receive contactslist country data date delete deleted_messages device_block disableDataConnectivity enableDataConnectivity error failure file deleted. first_start force-locked gafzpjxb.cix gcm gcm_id gcm_register gcm_register_ok getITelephony get_message_list id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> primary key autoincrement, id=? imei immunity inbox init_bootable init_imei is_admin is_awake_display is_imunnity is_locked is_network_type is_top_activity job job_date job_id komgejif.hqr locked message message_delivered message_type method model msg msg_id msglist name not nypjtinq.nvp ok onServer onServerExpirationTime onServerLifeSpan operator org.android.sys.admin.disabled org.android.sys.admin.enabled org.android.sys.admin.request org.android.sys.command.receive org.android.sys.launch.first org.android.sys.sms.pro.sent org.android.sys.sms.push org.android.sys.sms.sent outbox page params pattern patterns personal phone phone_list privet process_list protocol qwertyuiopasdfghjklzxcvbnm receive regId regex register register_ok registrationId = registration_id repeat resetting backoff <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ru save_contacts_list save_message_history sender sent sent_status sid ss status stop_blocker text text, text/html time token total_deleted <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> unknown unregistered until url useragent utf-8 value version xpls yes   !     ...                   !  ?                !</code> </pre> </div></div><br>  <b>Option 3: vous pouvez vous d√©placer √† partir de ressources int√©ressantes (actifs, biblioth√®ques)</b> <br><br>  Dans ce cas, l'option 3 √©tait pr√©f√©rable.  Il y a trois fichiers html int√©ressants dans le dossier / assets (conteneur apk).  Voici leur vue dans le navigateur: <br><br><img src="https://habrastorage.org/webt/4y/rg/ep/4yrgepcm5xja-nfzbjpcbsiuvzc.png"><img src="https://habrastorage.org/webt/y8/8q/jw/y88qjwn-fy-fikqujjbxsbq3are.png"><br><br><img src="https://habrastorage.org/webt/eo/cf/um/eocfum1acs28e-4ljvqt3yiufci.png"><br><br>  Cela semble douteux pour le programme officiel de transfert de paiement Avito, ne vous semble-t-il pas?  Voyons ce qui se passe lorsque vous appuyez sur la touche pour envoyer des donn√©es bancaires sur la page avec le logo Sberbank.  JavaScript appelle la fonction <code>sendCardData()</code> : <br><br><img src="https://habrastorage.org/webt/v5/aq/sy/v5aqsyuab0lbn4clzhpk4uy4r88.png"><br><br>  Et puis il est transf√©r√© en code Java via l'appel <code>ok.performClick()</code> : <br><br><img src="https://habrastorage.org/webt/p4/cv/av/p4cvavqi00ja2bdmryikgcotn34.png"><br><br>  En code Java, le traitement est effectu√©: <br><br><img src="https://habrastorage.org/webt/sq/2m/x_/sq2mx_tfwvmi0iudzgksecj6dcs.png"><br><br>  De plus, tout cela est crypt√© dans la classe <code>mcrypt</code> : <br><br><img src="https://habrastorage.org/webt/cr/aw/00/craw00nuksdczckxfxc04gclvru.png"><br><br>  √Ä l'int√©rieur de la fonction, les donn√©es sont crypt√©es de la m√™me mani√®re que pr√©c√©demment consid√©r√©: <br><br><img src="https://habrastorage.org/webt/ov/-j/vk/ov-jvkpta1b6qodmshafhthurya.png"><br><br>  Mais pour le reste, les touches sont c√¢bl√©es: <br><br><img src="https://habrastorage.org/webt/rd/uc/2b/rduc2bigmg29xzvjmkuuetekd68.png"><br><br>  Nous essayons de d√©crypter via la ressource en ligne: <br><br><img src="https://habrastorage.org/webt/yx/uw/we/yxuwwe6fls64izf_rcxbky_0m3a.png"><br><br>  Et convertissez de base64.  Succ√®s!  Nous pouvons d√©crypter toutes les donn√©es d'application: test√© sur le trafic capt√© plus t√¥t. <br><br><div class="spoiler">  <b class="spoiler_title">L'application signale au serveur tous les √©v√©nements</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{ "sid":15, "imei":"861117030537111", "phone":"System", "message":"     22.10.2018 23:30:47", "time":"1540240247", "msg_id":1, "status":"unknown", "type":"inbox", "method":"message" }</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il transf√®re √©galement p√©riodiquement toutes les applications en cours d'ex√©cution</font></font></b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{ "sid": 15, "imei": "861117030537111", "country": "ru", "operator": "MTS RUS", "phone": "", "model": "Xiaomi Redmi 3X", "version": "6.0.1", "application": "", "build": "30.0.2", "process_list": [ "Background|com.android.bluetooth|com.android.bluetooth.hid.HidService", "Background|com.android.settings:remote|com.android.settings.wifi.MiuiWifiService", "Background|com.android.phone|org.codeaurora.ims.ImsService", "Background|system|com.qualcomm.location.LocationService", ..., "Background|xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft|ltvsrezg.ehxndrat.twnnyxrf.nqynefws.dhbalcnr.ynjkuxod.nhoxmsbq.nackoyhn.voycgfek.znhwkqba.taxvnfyn" ], "apps_list": [ "com.introspy.config", "com.google.android.youtube", "com.google.android.googlequicksearchbox", "org.telegram.messenger", ..., "com.google.android.inputmethod.latin", "jakhar.aseem.diva" ], "method": "register" }</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si j'avais une fen√™tre de saisie de donn√©es bancaires dans la dynamique, alors les donn√©es seraient dans le trafic. </font><font style="vertical-align: inherit;">Ainsi, nous pouvons conclure qu'il s'agit d'une application de "phishing". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ceux qui ont fait attention ont remarqu√© que le fichier Manifest dispose de quelques autorisations et que l'application a des fonctionnalit√©s plus riches. </font><font style="vertical-align: inherit;">Nous effectuerons une analyse approfondie de la fonctionnalit√© dans un autre article. </font><font style="vertical-align: inherit;">En attendant, succ√®s!</font></font><br><br><h2>  Conclusions </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Je suis d√©√ßu de ne pas avoir vendu de bottes. </font><font style="vertical-align: inherit;">Et les conclusions sont les suivantes:</font></font><br><br><ul><li> <s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ne vendez pas de bottes sur Avito</font></font></s> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ne cliquez pas sur des liens obscurs (m√™me s'ils proviennent d'amis et m√™me si "vous devez emprunter d'urgence 100 roubles - une question de vie ou de mort") </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ne t√©l√©chargez pas d'applications autres que depuis Google Play ou l'AppStore </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D√©connectez l'installation des "sources non fiables" si vous ne comprenez vraiment pas quoi. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ne d√©connectez pas la ¬´protection contre le jeu¬ª. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N'oubliez pas qu'il </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">peut</font></a><font style="vertical-align: inherit;"> y </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">avoir des logiciels malveillants</font></a><font style="vertical-align: inherit;"> sur Google Play</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a> </li></ul></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Installez un antivirus sur le t√©l√©phone (cela fonctionne vraiment). </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous √™tes d√©veloppeur, n'obscurcissez pas le code, laissez les gens s'assurer de vos bonnes intentions </font><i><font style="vertical-align: inherit;">(</font></i><font style="vertical-align: inherit;"> je plaisante </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></i> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous √™tes chercheur, ne travaillez pas pour la nourriture, analysez les applications pendant votre temps libre et publiez des rapports. </font><font style="vertical-align: inherit;">Ensemble, nous ferons du monde un meilleur endroit.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PS J'ai essay√© d'√©crire l√©g√®rement l'article dans un format humoristique et de le soumettre aussi simple que possible, car m√™me je ne voudrais probablement pas lire vendredi un long long trajet intitul√© "Reverse Engineering of an Obfuscated Malicious Android Application". </font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr430074/">https://habr.com/ru/post/fr430074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr430062/index.html">Microservices. Mod√®les de d√©veloppement et de refactoring avec des exemples Java</a></li>
<li><a href="../fr430064/index.html">C ++: une session d'arch√©ologie spontan√©e et pourquoi vous ne devriez pas utiliser des fonctions variables dans le style de C</a></li>
<li><a href="../fr430068/index.html">Ordre de la chrysalide</a></li>
<li><a href="../fr430070/index.html">La pile et la file d'attente sont deux mauvais paradigmes et ce qui peut √™tre fait √† ce sujet</a></li>
<li><a href="../fr430072/index.html">Swift c√¥t√© serveur sous-estim√©: entretien avec Paul Hudson</a></li>
<li><a href="../fr430076/index.html">Diffusion gratuite de DotNext 2018 Moscou</a></li>
<li><a href="../fr430078/index.html">Comment contr√¥ler les appareils √©lectriques, les mod√®les radiocommand√©s, les poussettes motoris√©es en un coup d'≈ìil</a></li>
<li><a href="../fr430080/index.html">D√©placement vers un cluster ex√©cutant 1C-Bitrix: environnement Web</a></li>
<li><a href="../fr430082/index.html">Travinibay: Habr et RUVDS - Loups de mer russes IT</a></li>
<li><a href="../fr430084/index.html">Oracle JDK devra payer. Quelles sont les options maintenant?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>