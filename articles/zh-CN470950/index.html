<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•·ï¸ ğŸ§“ğŸ¾ ğŸ†‘ bear_hugï¼šPython3.6ä¸­çš„ASCIIè‰ºæœ¯æ¸¸æˆ+ ğŸŒ‘ ğŸ‘³ ğŸ‰</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¯¹äºæˆ‘çš„ASCIIè‰ºæœ¯æ¸¸æˆï¼Œæˆ‘ç¼–å†™äº†bear_hugåº“ï¼Œå…¶ä¸­åŒ…å«äº‹ä»¶é˜Ÿåˆ—ï¼Œå°éƒ¨ä»¶é›†åˆï¼ŒECSæ”¯æŒä»¥åŠå…¶ä»–æœ‰ç”¨çš„å°ä¸œè¥¿ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨å®ƒæ¥åˆ¶ä½œæœ€å°çš„æ¸¸æˆã€‚ 

 å…è´£å£°æ˜ 

- æˆ‘æ˜¯è¯¥åº“çš„å”¯ä¸€å¼€å‘äººå‘˜ï¼Œå› æ­¤æˆ‘å¯èƒ½ä¼šæœ‰æ‰€åè§ã€‚ 
- bear_hugæœ¬è´¨ä¸Šæ˜¯ç»•ç€bearlibtermi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>bear_hugï¼šPython3.6ä¸­çš„ASCIIè‰ºæœ¯æ¸¸æˆ+</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/470950/"><img src="https://habrastorage.org/webt/b0/zu/vj/b0zuvjk4xdzcznbys9oslxl_veo.png"><br><br> å¯¹äºæˆ‘çš„ASCIIè‰ºæœ¯æ¸¸æˆï¼Œæˆ‘ç¼–å†™<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº†bear_hugåº“ï¼Œ</a>å…¶ä¸­åŒ…å«äº‹ä»¶é˜Ÿåˆ—ï¼Œå°éƒ¨ä»¶é›†åˆï¼ŒECSæ”¯æŒä»¥åŠå…¶ä»–æœ‰ç”¨çš„å°ä¸œè¥¿ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å¦‚ä½•ä½¿ç”¨å®ƒæ¥åˆ¶ä½œæœ€å°çš„æ¸¸æˆã€‚ <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">å…è´£å£°æ˜</b> <div class="spoiler_text"><ul><li> æˆ‘æ˜¯è¯¥åº“çš„å”¯ä¸€å¼€å‘äººå‘˜ï¼Œå› æ­¤æˆ‘å¯èƒ½ä¼šæœ‰æ‰€åè§ã€‚ </li><li>  bear_hugæœ¬è´¨ä¸Šæ˜¯ç»•ç€<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">bearlibterminal</a>çš„åŒ…è£…å™¨ï¼Œå› æ­¤ä¸ä¼šæœ‰ç›¸å¯¹ä½çº§çš„å¸¦æœ‰å­—å½¢çš„æ“ä½œã€‚ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">clubsandwich</a>ä¹Ÿæœ‰ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰ä½¿ç”¨å®ƒï¼Œä¹Ÿæ— æ³•æ¯”è¾ƒã€‚ </li></ul></div></div><br> åœ¨bear_hugçš„èƒŒåæ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">bearlibterminal</a> ï¼Œè¿™æ˜¯ä¸€ä¸ªSDLåº“ï¼Œç”¨äºåˆ›å»ºä¼ªæ§åˆ¶å°çª—å£ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨çº¯TTYä¸­ï¼ŒåƒæŸäº›ncursesä¸€æ ·ï¼Œå®ƒå°†ä¸èµ·ä½œç”¨ã€‚ ä½†æ˜¯ï¼Œéšåçš„æƒ…å†µåœ¨Linuxå’ŒWindowsä¸Šæ˜¯ç›¸åŒçš„ï¼Œå¹¶ä¸”ä¸ç”¨æˆ·ç»ˆç«¯çš„è®¾ç½®æ— å…³ã€‚ è¿™å¾ˆé‡è¦ï¼Œå°¤å…¶æ˜¯å¯¹äºæ¸¸æˆè€Œè¨€ï¼Œå› ä¸ºå½“æ‚¨æ›´æ”¹ASCII-artå­—ä½“æ—¶ï¼Œä¸Šå¸å¯èƒ½ä¼šå˜æˆï¼š <br><br><img src="https://habrastorage.org/webt/ys/rh/6f/ysrh6fhay5u9slnpwvqn53is1ek.png"><br>  <i>åŸå§‹å›¾å½¢çš„ç›¸åŒå›¾å½¢ï¼Œå¤åˆ¶åç²˜è´´åˆ°ä¸åŒçš„ç¨‹åºä¸­</i> <br><br> å½“ç„¶ï¼Œè¯¥åº“æ˜¯ä¸ºè¾ƒå¤§è§„æ¨¡çš„é¡¹ç›®ç¼–å†™çš„ã€‚ ä½†æ˜¯ä¸ºäº†ä¸è¢«æ¸¸æˆè®¾è®¡å’Œä½“ç³»ç»“æ„æ‰€å¹²æ‰°ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€äº›ç®€å•çš„ä¸œè¥¿ã€‚ ä¸€ä¸ªä¸ºæœŸä¸€å¤œçš„é¡¹ç›®ï¼Œå…¶ä¸­åŒ…å«ä¸€äº›å†…å®¹æ¥å±•ç¤ºåº“çš„åŸºæœ¬åŠŸèƒ½ã€‚ å³-ä¸Dandyï¼ˆå®ƒä»¬ä¹Ÿæ˜¯Battle Cityï¼‰ç›¸åŒçš„å¦å…‹çš„ç®€åŒ–å…‹éš†ã€‚ ä¼šæœ‰ç©å®¶çš„å¦å…‹ï¼Œæ•Œæ–¹å¦å…‹ï¼Œå¯ç ´åçš„å¢™å£ï¼Œå£°éŸ³å’Œè®¡åˆ†ã€‚ ä½†æ˜¯ä¸»èœå•ï¼Œçº§åˆ«å’Œé€‰å®šçš„å¥–é‡‘éƒ½ä¸ä¼šã€‚ ä¸æ˜¯å› ä¸ºä¸å¯èƒ½æ·»åŠ å®ƒä»¬ï¼Œè€Œæ˜¯å› ä¸ºè¿™ä¸ªé¡¹ç›®ä¸è¿‡æ˜¯ä¸€ä¸ªHalloworldã€‚ <br><br><img src="https://habrastorage.org/webt/8k/e7/my/8ke7mymnrejpei7isjbxtbwvyjs.png"><br>  <i>ä¼šæœ‰ä¸€åœºæ¯”èµ›ï¼Œä½†ä¸ä¼šæœ‰èƒœåˆ©ã€‚</i>  <i>å› ä¸ºç”Ÿæ´»æ˜¯ç—›è‹¦ã€‚</i> <br><br> æœ¬æ–‡ä¸­ä½¿ç”¨çš„æ‰€æœ‰ææ–™éƒ½<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨githubä¸Š</a> ; è¯¥åº“æœ¬èº«<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¹Ÿåœ¨</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PyPIä¸Š</a> ï¼ˆæ ¹æ®MITè®¸å¯ï¼‰ã€‚ <br><br> é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦èµ„äº§ã€‚ ä¸ºäº†ç»˜åˆ¶ASCIIè‰ºæœ¯ï¼Œæˆ‘ä½¿ç”¨ç§‘å¹»ç™¾å‰é¥¼<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Cogmind</a>çš„å¼€å‘å•†Josh Geï¼ˆåˆåKyzratiï¼‰çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">REXpaint</a> ã€‚ ç¼–è¾‘å™¨æ˜¯å…è´¹çš„ï¼Œå°½ç®¡ä¸æ˜¯å¼€æºçš„ã€‚ å®˜æ–¹ç‰ˆæœ¬ä»…é€‚ç”¨äºWindowsï¼Œä½†åœ¨wineä¸‹ä¸€åˆ‡æ­£å¸¸ã€‚ ç•Œé¢éå¸¸æ¸…æ™°æ–¹ä¾¿ï¼š <br><br><img src="https://habrastorage.org/webt/jf/x-/bi/jfx-bigu3sedblmkuspxh_pd4d4.png"><br><br> æˆ‘ä»¬ä»¥æœ¬åœ°äºŒè¿›åˆ¶æ ¼å¼.xpä¿å­˜å¹¶ä»<code>/path/to/rexpaint/images</code>å¤åˆ¶åˆ°å°†æ¥çš„æ¸¸æˆæ–‡ä»¶å¤¹ä¸­ã€‚ åŸåˆ™ä¸Šä¹Ÿæ”¯æŒä».txtæ–‡ä»¶åŠ è½½å›¾åƒï¼Œä½†æ˜¯æ˜¾ç„¶ä¸å¯èƒ½å°†å•ä¸ªå­—ç¬¦çš„é¢œè‰²ä¿å­˜åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­ã€‚ æ˜¯çš„ï¼Œåœ¨æˆ‘è‡ªå·±çš„ç¬”è®°æœ¬ä¸Šç¼–è¾‘ASCIIè‰ºæœ¯ä½œå“å¹¶ä¸æ–¹ä¾¿ã€‚ ä¸ºäº†ä¸å¯¹æ¯ä¸ªå…ƒç´ çš„åæ ‡å’Œå¤§å°è¿›è¡Œç¡¬ç¼–ç ï¼Œæ­¤æ•°æ®å­˜å‚¨åœ¨å•ç‹¬çš„JSONæ–‡ä»¶ä¸­ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">Battlecity.json</b> <div class="spoiler_text"><pre> <code class="json hljs">[ { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"player_r"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"x"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"y"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-attr"><span class="hljs-attr">"xsize"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ysize"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"player_l"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"x"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"y"</span></span>: <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-attr"><span class="hljs-attr">"xsize"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ysize"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> }, ... ]</code> </pre> <br></div></div><br> å¯ä»Internetä¸‹è½½å…è´¹è®¸å¯è¯ä¸‹çš„å£°éŸ³ã€‚ åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä»…æ”¯æŒ.wavã€‚ è¿™å°±æ˜¯èµ„äº§ï¼Œæ‚¨å¯ä»¥å¼€å§‹ç¼–ç ã€‚ é¦–å…ˆï¼Œæ‚¨éœ€è¦åˆå§‹åŒ–ç»ˆç«¯å’Œäº‹ä»¶é˜Ÿåˆ—ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">game.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  terminal = BearTerminal(font_path='cp437_12x12.png', size='91x60', title='AsciiCity', filter=['keyboard', 'mouse']) #   dispatcher = BearEventDispatcher() # ,         loop = BearLoop(terminal, dispatcher)</span></span></code> </pre> <br></div></div><br> ç»ˆç«¯æ˜¯æ¸¸æˆçš„å®é™…çª—å£ã€‚ æ‚¨å¯ä»¥åœ¨å…¶ä¸Šæ”¾ç½®å°éƒ¨ä»¶ï¼Œå¹¶åœ¨å¿…è¦æ—¶å¼•å‘<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¾“å…¥äº‹ä»¶</a> ã€‚ ä½œä¸ºåˆ›å»ºç»ˆç«¯æ—¶çš„é”®ï¼Œå¯ä»¥ä½¿ç”¨æ‰€æœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç»ˆç«¯é€‰é¡¹bearlibterminal</a> ; åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è®¾ç½®å­—ä½“ï¼Œçª—å£å¤§å°ï¼ˆä»¥å­—ç¬¦ä¸ºå•ä½ï¼‰ï¼Œçª—å£æ ‡é¢˜å’Œæˆ‘ä»¬æ„Ÿå…´è¶£çš„è¾“å…¥æ³•ã€‚ <br><br> è‡³äºäº‹ä»¶é˜Ÿåˆ—ï¼Œå®ƒæœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„ç•Œé¢ï¼šdispatcher.add_eventï¼ˆäº‹ä»¶ï¼‰å°†äº‹ä»¶æ·»åŠ åˆ°é˜Ÿåˆ—ä¸­ï¼Œè€Œdispatcher.register_listenerï¼ˆlistenerï¼Œevent_typesï¼‰å…è®¸æ‚¨è®¢é˜…å®ƒã€‚ ç­¾åè€…ï¼ˆä¾‹å¦‚ï¼Œå°éƒ¨ä»¶æˆ–ç»„ä»¶ï¼‰å¿…é¡»å…·æœ‰on_eventå›è°ƒï¼Œè¯¥å›è°ƒå°†äº‹ä»¶ä½œä¸ºå•ä¸ªå‚æ•°ï¼Œå¹¶ä¸”ä¸è¿”å›ä»»ä½•å†…å®¹æˆ–è¿”å›å¦ä¸€ä¸ªäº‹ä»¶æˆ–ä¸€ç»„äº‹ä»¶ã€‚ äº‹ä»¶æœ¬èº«ç”±ç±»å‹å’Œå€¼ç»„æˆã€‚ è¿™é‡Œçš„ç±»å‹ä¸æ˜¯åœ¨stræˆ–intçš„æ„ä¹‰ä¸Šï¼Œè€Œæ˜¯åœ¨â€œ varietyâ€çš„æ„ä¹‰ä¸Šï¼Œä¾‹å¦‚â€œ key_downâ€æˆ–â€œ tickâ€ã€‚ é˜Ÿåˆ—ä»…æ¥å—å…¶å·²çŸ¥ç±»å‹çš„äº‹ä»¶ï¼ˆå†…ç½®æˆ–ç”±ç”¨æˆ·åˆ›å»ºï¼‰ï¼Œå¹¶å°†æ‰€æœ‰è®¢é˜…æ­¤ç±»å‹çš„äº‹ä»¶å‘é€ç»™on_eventã€‚ å®ƒä¸ä¼šä»¥ä»»ä½•æ–¹å¼æ£€æŸ¥å€¼ï¼Œä½†æ˜¯åº“ä¸­å­˜åœ¨å…³äºæ¯ç§äº‹ä»¶çš„æœ‰æ•ˆå€¼æ˜¯ä»€ä¹ˆçš„çº¦å®šã€‚ <br><br> é¦–å…ˆï¼Œæˆ‘ä»¬å°†å‡ ä¸ªä¾¦å¬å™¨æ’é˜Ÿã€‚ è¿™æ˜¯å¯ä»¥é¢„è®¢äº‹ä»¶ä½†ä¸æ˜¯çª—å£å°éƒ¨ä»¶æˆ–ç»„ä»¶çš„å¯¹è±¡çš„åŸºç±»ã€‚ åŸåˆ™ä¸Šï¼Œåªè¦ç­¾åè€…å…·æœ‰on_eventæ–¹æ³•ï¼Œå°±ä¸å¿…ä½¿ç”¨å®ƒã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">å¬ä¼—</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       dispatcher.register_listener(ClosingListener(), ['misc_input', 'tick']) #       dispatcher.register_listener(EntityTracker(), ['ecs_create', 'ecs_destroy']) #   jukebox = SoundListener({'shot': 'shot.wav', 'explosion': 'explosion.wav'}) # https://freesound.org/people/EMSIarma/sounds/108852/ # https://freesound.org/people/FlashTrauma/sounds/398283/ dispatcher.register_listener(jukebox, 'play_sound')</span></span></code> </pre> <br></div></div><br> å†…ç½®äº‹ä»¶ç±»å‹çš„å®Œæ•´åˆ—è¡¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ–‡æ¡£ä¸­</a> ã€‚ ä¸éš¾å‘ç°ï¼Œæœ‰ä¸€äº›äº‹ä»¶åˆ›é€ å’Œç ´åå®ä½“ï¼Œä½†æ²¡æœ‰ç ´åã€‚ ç”±äºæˆ‘ä»¬æ‹¥æœ‰çš„ç‰©ä½“ä¸ä¼šç¦»ä¸€æ†å°„å‡»ï¼ˆç©å®¶çš„å¢™å£å’Œå¦å…‹ï¼‰åˆ†å¼€ï¼Œå› æ­¤æˆ‘ä»¬å°†åˆ›å»ºå®ƒï¼š <br><br><div class="spoiler">  <b class="spoiler_title">æ´»åŠ¨ç±»å‹æ³¨å†Œ</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      ,    #   dispatcher.register_event_type('ac_damage') #       logger = LoggingListener(sys.stderr) dispatcher.register_listener(logger, ['ac_damage', 'play_sound'])</span></span></code> </pre> <br></div></div><br> æˆ‘ä»¬åŒæ„ï¼Œä½œä¸ºä¸€ä¸ªå€¼ï¼Œæ­¤äº‹ä»¶å°†åŒ…å«é­å—æŸåçš„å®ä½“çš„IDå’ŒæŸåå€¼çš„å…ƒç»„ã€‚  LoggingListeneråªæ˜¯ä¸€ä¸ªè°ƒè¯•å·¥å…·ï¼Œå¯ä»¥æ‰“å°æ‰€æœ‰æ”¶åˆ°çš„äº‹ä»¶ï¼Œæ— è®ºå®ƒä»¬è¯´çš„æ˜¯ä»€ä¹ˆï¼Œåœ¨æœ¬ä¾‹ä¸­éƒ½æ˜¯stderrã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘æƒ³ç¡®ä¿æŸåèƒ½å¤Ÿæ­£ç¡®é€šè¿‡ï¼Œå¹¶ä¸”å§‹ç»ˆåœ¨éœ€è¦çš„æ—¶å€™å‘å‡ºå£°éŸ³ã€‚ <br><br> ç°åœ¨ï¼Œä½¿ç”¨ä¾¦å¬å™¨ï¼Œå¯ä»¥æ·»åŠ ç¬¬ä¸€ä¸ªå°éƒ¨ä»¶ã€‚ æˆ‘ä»¬æœ‰è¿™ä¸ªECSLayoutç±»çš„ç«äº‰ç¯å¢ƒã€‚ è¿™æ ·çš„å¸ƒå±€å¯ä»¥å°†å°éƒ¨ä»¶æ”¾ç½®åœ¨å®ä½“ä¸Šå¹¶å“åº”ecs_moveäº‹ä»¶ç§»åŠ¨å®ƒä»¬ï¼ŒåŒæ—¶è€ƒè™‘å†²çªã€‚ åƒå¤§å¤šæ•°å°éƒ¨ä»¶ä¸€æ ·ï¼Œå®ƒå…·æœ‰ä¸¤ä¸ªå¿…éœ€çš„å‚æ•°ï¼šåµŒå¥—çš„å­—ç¬¦åˆ—è¡¨ï¼ˆå¯èƒ½ä¸ºç©º-ç©ºæ ¼æˆ–æ— ï¼‰å’Œæ¯ä¸ªå­—ç¬¦çš„é¢œè‰²åµŒå¥—åˆ—è¡¨ã€‚ å¯æ¥å—ä½¿ç”¨å‘½åé¢œè‰²ä½œä¸ºé¢œè‰²ï¼ŒRGBæ ¼å¼ä¸º'0xAARRGGBB'ï¼ˆæˆ–'0xARGB`ï¼Œ'0xRGB`ï¼Œ'0xRRGGBB'ï¼‰å’Œæ ¼å¼ä¸º#fffã€‚ ä¸¤ä¸ªåˆ—è¡¨çš„å¤§å°å¿…é¡»åŒ¹é…ï¼› å¦åˆ™ï¼Œå°†å¼•å‘å¼‚å¸¸ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç¬¬ä¸€ä¸ªå°éƒ¨ä»¶</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   .  8460,   9160. # 7         chars = [[' ' for x in range(84)] for y in range(60)] colors = copy_shape(chars, 'gray') layout = ECSLayout(chars, colors) # 'all' -  ,      dispatcher.register_listener(layout, 'all')</span></span></code> </pre> <br></div></div><br> ç”±äºç°åœ¨æœ‰äº†æ”¾ç½®æ¸¸æˆå¯¹è±¡çš„å†…å®¹ï¼Œå› æ­¤å¯ä»¥å¼€å§‹åˆ›å»ºå®ä½“ã€‚ å®ä½“å’Œç»„ä»¶çš„æ‰€æœ‰ä»£ç éƒ½ç§»åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚ å…¶ä¸­æœ€ç®€å•çš„æ˜¯å¯ç ´åçš„ç –å¢™ã€‚ å¥¹çŸ¥é“å¦‚ä½•åœ¨æŸä¸ªåœ°æ–¹æ‘†æ”¾è‡ªå·±çš„å°éƒ¨ä»¶ï¼Œå……å½“ç¢°æ’å¯¹è±¡å¹¶å—åˆ°ä¼¤å®³ã€‚ ç»è¿‡è¶³å¤Ÿçš„ç ´ååï¼Œå¢™æ¶ˆå¤±äº†ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">Entitys.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_wall</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dispatcher, atlas, entity_id, x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#   wall = Entity(entity_id) #  wall.add_component(PositionComponent(dispatcher, x, y)) wall.add_component(CollisionComponent(dispatcher)) wall.add_component(PassingComponent(dispatcher)) wall.add_component(DestructorComponent(dispatcher)) #     ,      #    -  /   images_dict = {'wall_3': atlas.get_element('wall_3'), 'wall_2': atlas.get_element('wall_2'), 'wall_1': atlas.get_element('wall_1')} wall.add_component(SwitchWidgetComponent(dispatcher, SwitchingWidget(images_dict=images_dict, initial_image='wall_3'))) wall.add_component(VisualDamageHealthComponent(dispatcher, hitpoints=3, widgets_dict={3: 'wall_3', 2: 'wall_2', 1: 'wall_1'})) #     dispatcher.add_event(BearEvent('ecs_create', wall)) dispatcher.add_event(BearEvent('ecs_add', (wall.id, wall.position.x, wall.position.y)))</span></span></code> </pre> <br></div></div><br> é¦–å…ˆï¼Œåˆ›å»ºå®ä½“å¯¹è±¡æœ¬èº«ã€‚ å®ƒä»…åŒ…å«ä¸€ä¸ªåç§°ï¼ˆå¿…é¡»å”¯ä¸€ï¼‰å’Œä¸€ç»„ç»„ä»¶ã€‚ å®ƒä»¬æ—¢å¯ä»¥åœ¨åˆ›å»ºæ—¶ç«‹å³å…¨éƒ¨è½¬ç§»ï¼Œä¹Ÿå¯ä»¥ä¸€æ¬¡æ·»åŠ ä¸€æ¬¡ã€‚ ç„¶ååˆ›å»ºæ‰€æœ‰å¿…è¦çš„ç»„ä»¶ã€‚ ä½œä¸ºä¸€ä¸ªå°éƒ¨ä»¶ï¼Œä½¿ç”¨äº†SwitchWidgetï¼Œå®ƒåŒ…å«å¤šä¸ªç›¸åŒå¤§å°çš„å›¾å½¢ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡å‘½ä»¤å¯¹å…¶è¿›è¡Œæ›´æ”¹ã€‚ é¡ºä¾¿è¯´ä¸€å¥ï¼Œåœ¨åˆ›å»ºçª—å£å°éƒ¨ä»¶æ—¶ä¼šä»åœ°å›¾é›†ä¸­åŠ è½½å›¾å½¢ã€‚ æœ€åï¼Œæœ‰å…³åˆ›å»ºå®ä½“çš„å…¬å‘Šä»¥åŠåœ¨å¿…è¦çš„åæ ‡ä¸Šç»˜åˆ¶å®ä½“çš„å‘½ä»¤è¿›å…¥äº†é˜Ÿåˆ—ã€‚ <br><br> åœ¨éå†…ç½®ç»„ä»¶ä¸­ï¼Œåªæœ‰å¥åº·ã€‚ æˆ‘åˆ›å»ºäº†â€œå¥åº·ç»„ä»¶â€åŸºç±»ï¼Œå¹¶ä»ä¸­ç»§æ‰¿äº†â€œå¥åº·ç»„ä»¶æ›´æ”¹å°éƒ¨ä»¶â€ï¼ˆä»¥æ˜¾ç¤ºå®Œå¥½æ— æŸçš„å¢™å¹¶å¤„äºç ´åçš„å¤šä¸ªé˜¶æ®µï¼‰ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">ç±»HealthComponent</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HealthComponent</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Component)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, *args, hitpoints=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">3</span></span></span></span><span class="hljs-function"><span class="hljs-params">, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(*args, name=<span class="hljs-string"><span class="hljs-string">'health'</span></span>, **kwargs) self.dispatcher.register_listener(self, <span class="hljs-string"><span class="hljs-string">'ac_damage'</span></span>) self._hitpoints = hitpoints <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_event</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, event)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> event.event_type == <span class="hljs-string"><span class="hljs-string">'ac_damage'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> event.event_value[<span class="hljs-number"><span class="hljs-number">0</span></span>] == self.owner.id: self.hitpoints -= event.event_value[<span class="hljs-number"><span class="hljs-number">1</span></span>] @property <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hitpoints</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._hitpoints @hitpoints.setter <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hitpoints</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, value)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> isinstance(value, int): <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> BearECSException( <span class="hljs-string"><span class="hljs-string">f'Attempting to set hitpoints of </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{self.owner.id}</span></span></span><span class="hljs-string"> to non-integer </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{value}</span></span></span><span class="hljs-string">'</span></span>) self._hitpoints = value <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self._hitpoints &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>: self._hitpoints = <span class="hljs-number"><span class="hljs-number">0</span></span> self.process_hitpoint_update() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_hitpoint_update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Should be overridden by child classes. """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> NotImplementedError(<span class="hljs-string"><span class="hljs-string">'HP update processing should be overridden'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__repr__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#           return dumps({'class': self.__class__.__name__, 'hitpoints': self.hitpoints})</span></span></code> </pre> <br></div></div><br> åˆ›å»ºç»„ä»¶æ—¶ï¼Œâ€œåç§°â€é”®å°†ä¼ é€’ç»™superï¼ˆï¼‰.__ init__ã€‚ å°†ç»„ä»¶æ·»åŠ åˆ°å®ä½“æ—¶ï¼Œå°†ä»¥è¯¥é”®çš„åç§°å°†å…¶æ·»åŠ åˆ°å®ä½“çš„__dict__ä¸­ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡entity_object.healthå¯¹å…¶è¿›è¡Œè®¿é—®ã€‚ é™¤äº†æ–¹ä¾¿ç•Œé¢ä¹‹å¤–ï¼Œæ­¤æ–¹æ³•è¿˜ä¸é”™ï¼Œå› ä¸ºå®ƒç¦æ­¢å‘å¸ƒå¤šä¸ªåŒç±»ç»„ä»¶çš„å®ä½“ã€‚ è€Œä¸”å®ƒæ˜¯åœ¨ç»„ä»¶å†…éƒ¨è¿›è¡Œç¡¬ç¼–ç çš„äº‹å®ï¼Œä¸å…è®¸æ‚¨é”™è¯¯åœ°å°†WidgetComponentæ’å…¥åˆ°è¿è¡ŒçŠ¶å†µç»„ä»¶çš„æ’æ§½ä¸­ã€‚ åˆ›å»ºåï¼Œè¯¥ç»„ä»¶ç«‹å³è®¢é˜…ä¸å…¶ç›¸å…³çš„äº‹ä»¶ç±»ï¼Œåœ¨æœ¬ä¾‹ä¸­ä¸ºac_damageã€‚ æ”¶åˆ°æ­¤ç±»äº‹ä»¶åï¼Œon_eventæ–¹æ³•å°†æ£€æŸ¥ä¸€ä¸ªå°æ—¶æ˜¯å¦ä¸å…¶æ‰€æœ‰è€…æœ‰å…³ã€‚ å¦‚æœæ˜¯è¿™æ ·ï¼Œä»–å°†ä»å‘½ä¸­ç‚¹ä¸­å‡å»æ‰€éœ€çš„å€¼å¹¶æ‹‰å›å›è°ƒä»¥æ›´æ”¹è¿è¡ŒçŠ¶å†µï¼ŒåŸºç±»æ˜¯æŠ½è±¡çš„ã€‚ è¿˜æœ‰__repr__æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JSONä¸­çš„åºåˆ—åŒ–</a> ï¼ˆä¾‹å¦‚ï¼Œç”¨äºä¿å­˜ï¼‰ã€‚ ä¸éœ€è¦æ·»åŠ å®ƒï¼Œä½†æ˜¯æ‰€æœ‰å†…ç½®ç»„ä»¶å’Œå¤§å¤šæ•°å†…ç½®å°éƒ¨ä»¶éƒ½å…·æœ‰å®ƒã€‚ <br><br> ä»VisualDamageHealthComponentçš„åŸºç¡€è¿è¡ŒçŠ¶å†µç»„ä»¶ç»§æ‰¿å°†è¦†ç›–è¿è¡ŒçŠ¶å†µæ›´æ”¹çš„å›è°ƒï¼š <br><br><div class="spoiler">  <b class="spoiler_title">ç±»VisualDamageHealthComponent</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VisualDamageHealthComponent</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(HealthComponent)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""       .    HP=0 """</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, *args, widgets_dict={}, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(*args, **kwargs) self.widgets_dict = OrderedDict() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(widgets_dict.keys()): self.widgets_dict[int(x)] = widgets_dict[x] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">process_hitpoint_update</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.hitpoints == <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> hasattr(self.owner, <span class="hljs-string"><span class="hljs-string">'destructor'</span></span>): self.owner.destructor.destroy() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.widgets_dict: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.hitpoints &gt;= x: self.owner.widget.switch_to_image(self.widgets_dict[x])</code> </pre> <br></div></div><br> å½“å¥åº·çŠ¶å†µå¤§äº0æ—¶ï¼Œä»–è¦æ±‚è´Ÿè´£å°éƒ¨ä»¶çš„ç»„ä»¶ä»¥æ‰€éœ€çŠ¶æ€ç»˜åˆ¶å¢™ã€‚ åœ¨æ­¤ï¼Œä¸Šè¿°è°ƒç”¨é€šè¿‡å®ä½“å¯¹è±¡çš„å±æ€§ä½¿ç”¨ã€‚ ä¸€æ—¦ç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œè´Ÿè´£æ­£ç¡®ç ´åå®ä½“çš„ç»„ä»¶å’Œæ‰€æœ‰ç»„ä»¶å°†ä»¥ç›¸åŒçš„æ–¹å¼è°ƒç”¨ã€‚ <br><br> å¯¹äºå…¶ä»–å®ä½“ï¼Œä¸€åˆ‡éƒ½ç›¸ä¼¼ï¼Œåªæ˜¯ç»„ä»¶é›†ä¸åŒã€‚ å¦å…‹è¢«æ·»åŠ äº†æ§åˆ¶å™¨ï¼ˆç©å®¶çš„è¾“å…¥ï¼ŒAIæ˜¯å¯¹æ‰‹çš„è¾“å…¥ï¼‰å’Œæ—‹è½¬çš„å°éƒ¨ä»¶ï¼ˆç”¨äºç‚®å¼¹ï¼‰-ä¸€ç§ç¢°æ’ç»„ä»¶ï¼Œä¼šå¯¹è¢«å‡»ä¸­çš„äººé€ æˆä¼¤å®³ã€‚ æˆ‘ä¸ä¼šåˆ†æå®ƒä»¬ä¸­çš„æ¯ä¸€ä¸ªï¼Œå› ä¸ºå®ƒä»¬ç¬¨é‡ä¸”ç›¸å½“çç¢ã€‚ åªçœ‹å°„å¼¹å¯¹æ’æœºã€‚ å®ƒæœ‰ä¸€ä¸ªcollided_intoæ–¹æ³•ï¼Œå½“ä¸»æœºå®ä½“å´©æºƒæ—¶ä¼šè°ƒç”¨è¯¥æ–¹æ³•ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å­å¼¹å¯¹æ’æœº</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">collided_into</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, entity)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> entity: self.owner.destructor.destroy() <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> hasattr(EntityTracker().entities[entity], <span class="hljs-string"><span class="hljs-string">'collision'</span></span>): self.dispatcher.add_event(BearEvent(event_type=<span class="hljs-string"><span class="hljs-string">'ac_damage'</span></span>, event_value=( entity, self.damage))) self.owner.destructor.destroy()</code> </pre> <br></div></div><br> ä¸ºäº†ç¡®ä¿ç¡®å®æœ‰å¯èƒ½æˆä¸ºå—å®³è€…ï¼ˆä¾‹å¦‚èƒŒæ™¯å…ƒç´ å¯èƒ½æ˜¯é”™è¯¯çš„ï¼‰ï¼Œå°„å¼¹ä½¿ç”¨EntityTrackerï¼ˆï¼‰ã€‚ è¿™æ˜¯ä¸€ä¸ªè·Ÿè¸ªæ‰€æœ‰å·²åˆ›å»ºå’Œå·²é”€æ¯å®ä½“çš„å•ä¾‹ï¼› é€šè¿‡å®ƒï¼Œæ‚¨å¯ä»¥æŒ‰åç§°è·å–å®ä½“å¯¹è±¡ï¼Œå¹¶å¯¹å…¶ç»„ä»¶è¿›è¡Œæ“ä½œã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥éªŒè¯entity.collisionï¼ˆå—å®³è€…å†²çªå¤„ç†ç¨‹åºï¼‰æ˜¯å¦å­˜åœ¨ã€‚ <br><br> ç°åœ¨ï¼Œåœ¨æ¸¸æˆçš„ä¸»æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬åªéœ€è°ƒç”¨åˆ›å»ºå®ä½“æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½ï¼š <br><br><div class="spoiler">  <b class="spoiler_title">å›åˆ°game.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  , -     atlas = Atlas(XpLoader('battlecity.xp'), 'battlecity.json') #   create_player_tank(dispatcher, atlas, 30, 50) #    wall_array = [[0 for _ in range(14)], [0 for _ in range(14)], [1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0], [1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0], [1, 1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1], [1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0], [1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0], [0 for _ in range(14)], [0 for _ in range(14)], [0 for _ in range(14)] ] for y in range(10): for x in range(14): if wall_array[y][x] == 1: create_wall(dispatcher, atlas, f'wall{x}{y}', x*6, y*6) #   -  .     . create_spawner_house(dispatcher, atlas, 35, 0)</span></span></code> </pre> <br></div></div><br> ç‚¹æ•°å’Œå‘½ä¸­ç‚¹è®¡æ•°å™¨ä¸æ˜¯å®ä½“ï¼Œä¹Ÿä¸åœ¨æˆ˜åœºä¸Šã€‚ å› æ­¤ï¼Œå®ƒä»¬ä¸ä¼šæ·»åŠ åˆ°ECSLayoutï¼Œè€Œæ˜¯ç›´æ¥æ·»åŠ åˆ°åœ°å›¾å³ä¾§çš„ç»ˆç«¯ã€‚ ç›¸å…³çš„çª—å£å°éƒ¨ä»¶ç»§æ‰¿è‡ªLabelï¼ˆæ–‡æœ¬è¾“å‡ºçª—å£å°éƒ¨ä»¶ï¼‰ï¼Œå¹¶å…·æœ‰on_eventæ–¹æ³•æ¥æŸ¥æ‰¾å®ƒä»¬æ„Ÿå…´è¶£çš„å†…å®¹ã€‚ ä¸Layoutä¸åŒï¼Œç»ˆç«¯ä¸ä¼šåœ¨æ¯ä¸ªåˆ»åº¦ä¸Šè‡ªåŠ¨æ›´æ–°å°éƒ¨ä»¶ï¼Œå› æ­¤åœ¨æ›´æ”¹æ–‡æœ¬åï¼Œå°éƒ¨ä»¶ä¼šå‘Šè¯‰ä»–è¿™æ ·åšï¼š <br><br><div class="spoiler">  <b class="spoiler_title">listeners.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ScoreLabel</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Label)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""   """</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(text=<span class="hljs-string"><span class="hljs-string">'Score:\n0'</span></span>) self.score = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_event</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, event)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> event.event_type == <span class="hljs-string"><span class="hljs-string">'ecs_destroy'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">'enemy'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> event.event_value <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">'bullet'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> event.event_value: <span class="hljs-comment"><span class="hljs-comment">#    self.score += 10 self.text = f'Score:\n{self.score}' self.terminal.update_widget(self) class HPLabel(Label): """   """ def __init__(self, *args, **kwargs): super().__init__(text='HP:\n5') self.hp = 5 def on_event(self, event): if event.event_type == 'ac_damage' and event.event_value[0] == 'player': self.hp -= event.event_value[1] self.text = f'HP:\n{self.hp}' self.terminal.update_widget(self)</span></span></code> </pre> <br></div></div><br> æ ¹æœ¬ä¸æ˜¾ç¤ºæ•Œäººç”Ÿæˆå™¨å’Œè´Ÿè´£â€œ GAME OVERâ€è¾“å‡ºçš„å¯¹è±¡ï¼Œå› æ­¤å®ƒä»¬ä»ä¾¦å¬å™¨ç»§æ‰¿ã€‚ åŸç†æ˜¯ç›¸åŒçš„ï¼šå¯¹è±¡ä¾¦å¬é˜Ÿåˆ—ï¼Œç­‰å¾…æ­£ç¡®çš„æ—¶é—´ï¼Œç„¶ååˆ›å»ºå®ä½“æˆ–å°éƒ¨ä»¶ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ¸¸æˆç»“æŸ</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    - . . . class GameOverListener(Listener): """       """ def __init__(self, *args, widget=None, **kwargs): print (args) super().__init__(*args, *kwargs) self.widget = widget def on_event(self, event): if event.event_type == 'ecs_destroy' and event.event_value == 'player': self.terminal.add_widget(self.widget, pos=(20, 20), layer=5)</span></span></code> </pre><br></div></div><br> ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»åˆ›å»ºäº†æ‰€éœ€çš„ä¸€åˆ‡ï¼Œç„¶åå°±å¯ä»¥å¼€å§‹æ¸¸æˆäº†ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æˆ‘ä»¬å¯åŠ¨</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      ,   Listeners    terminal.start() terminal.add_widget(layout) terminal.add_widget(score, pos=(85, 10)) terminal.add_widget(hp, pos=(85, 15))</span></span></code> </pre> <br></div></div><br> çª—å£å°éƒ¨ä»¶ä»…åœ¨å¯åŠ¨åæ‰æ·»åŠ åˆ°å±å¹•ã€‚ å®ä½“å¯ä»¥åœ¨æ·»åŠ åˆ°åœ°å›¾ä¹‹å‰-åˆ›å»ºäº‹ä»¶ï¼ˆå­˜å‚¨æ•´ä¸ªå®ä½“ï¼ˆåŒ…æ‹¬å°éƒ¨ä»¶ï¼‰çš„äº‹ä»¶ï¼‰ç®€å•åœ°ç´¯ç§¯åœ¨é˜Ÿåˆ—ä¸­ï¼Œå¹¶åœ¨ç¬¬ä¸€ä¸ªåˆ»åº¦æ—¶è§£å†³ã€‚ ä½†æ˜¯ç»ˆç«¯åªæœ‰åœ¨æˆåŠŸä¸ºå…¶åˆ›å»ºçª—å£ä¹‹åæ‰èƒ½æ·»åŠ å°éƒ¨ä»¶ã€‚ <br><br> è‡³æ­¤ï¼Œæˆ‘ä»¬æœ‰äº†ä¸€ä¸ªå¯è¡Œçš„åŸå‹ï¼Œæ‚¨å¯ä»¥<s>åœ¨æŠ¢å…ˆ</s>ä½“éªŒä¸­<s>å‘è¡ŒäºŒåç¾å…ƒä»¥</s>å¢åŠ åŠŸèƒ½å¹¶å®Œå–„æ¸¸æˆç©æ³•ã€‚ ä½†æ˜¯ï¼Œè¿™å·²ç»è¶…å‡ºäº†â€œå¹»æƒ³ä¸–ç•Œâ€çš„èŒƒå›´ï¼Œå› æ­¤ä¹Ÿè¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚ æˆ‘åªä¼šè¡¥å……è¯´ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">pyinstaller</a>æ„å»ºç‹¬ç«‹äºç³»ç»Ÿpythonçš„æ„å»ºã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN470950/">https://habr.com/ru/post/zh-CN470950/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN470930/index.html">äº§å“çš„æ¸¸æˆåŒ–ã€‚ å†å²åˆ†ç±»</a></li>
<li><a href="../zh-CN470934/index.html">å©šç¤¼å‰æ„ˆï¼šæ°´æ¯çš„ç»†èƒå¢æ®–å’Œå†ç”Ÿèƒ½åŠ›</a></li>
<li><a href="../zh-CN470938/index.html">å¦‚ä½•åœ¨Pythonä¸­æ‰“å¼€é“¾æ¥ã€‚ ä½¿ç”¨WebBrowserå¹¶è§£å†³Internet Explorerçš„é—®é¢˜</a></li>
<li><a href="../zh-CN470940/index.html">Mail.rué›†å›¢çš„MSK VUE.JSèšä¼šï¼ƒ3ï¼šmitapçš„èµ„æ–™</a></li>
<li><a href="../zh-CN470942/index.html">ä»åˆå­¦è€…åˆ°æ ·å¼å›¾æ ‡ï¼šæˆ‘ä»¬å¦‚ä½•åœ¨2GISä¸­è·å¥–</a></li>
<li><a href="../zh-CN470952/index.html">æ•°å­—å–è¯æŠ€å·§å’Œçªé—¨ï¼šâ€œæ‚¨çš„ç”µè¯â€åº”ç”¨å–è¯</a></li>
<li><a href="../zh-CN470954/index.html">åœ¨Ubuntu 18.04 LTSä¸Šå®‰è£…Zimbra OSE 8.8.15å’ŒZextras Suite Pro</a></li>
<li><a href="../zh-CN470958/index.html">Kubernetesä¸­çš„æ´»åŠ¨æ¢é’ˆå¯èƒ½å¾ˆå±é™©</a></li>
<li><a href="../zh-CN470962/index.html">å¸ƒè¾¾ä½©æ–¯JSConf 2019</a></li>
<li><a href="../zh-CN470964/index.html">æœ¨åˆ¶ç©å…·-é“­æ–‡</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>