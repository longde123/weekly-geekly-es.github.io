<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👍🏾 👰🏻 👨‍👦‍👦 Escribir un juego de cartas de memoria en Swift 🗼 ⚛️ 👩🏼‍🔧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Este artículo describe el proceso de crear un juego de entrenamiento de memoria simple que realmente me gusta. Además de ser bueno en sí mismo, aprend...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Escribir un juego de cartas de memoria en Swift</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/447598/"><img src="https://habrastorage.org/getpro/habr/post_images/bd8/736/e74/bd8736e74ae382f71c8c0c8220a5b4be.jpg"><br><br>  Este artículo describe el proceso de crear un juego de entrenamiento de memoria simple que realmente me gusta.  Además de ser bueno en sí mismo, aprenderá un poco más sobre las clases y protocolos de Swift durante el trabajo.  Pero antes de comenzar, descubramos el juego en sí. <br><a name="habracut"></a><br><blockquote>  <b>Le recordamos:</b> <i>para todos los lectores de "Habr": un descuento de 10.000 rublos al registrarse en cualquier curso de Skillbox con el código de promoción "Habr".</i> <br><br>  <b>Skillbox recomienda:</b> El curso educativo en línea <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Profession Java-developer"</a> . </blockquote><br><h3>  Cómo jugar la tarjeta de memoria </h3><br>  El juego comienza con una demostración de un conjunto de cartas.  Se acuestan "camisa" hacia arriba (respectivamente, boca abajo).  Cuando hace clic en cualquiera, se abre una imagen durante unos segundos. <br><br>  La tarea del jugador es encontrar todas las cartas con las mismas imágenes.  Si después de abrir la primera carta, le das la vuelta a la segunda y las imágenes coinciden, ambas cartas permanecen abiertas.  Si no coinciden, las cartas se vuelven a cerrar.  La tarea es abrir todo. <br><br><h3>  Estructura del proyecto </h3><br>  Para crear una versión simple de este juego necesitas los siguientes componentes: <br><br><ul><li>  Un controlador: GameController.swift. </li><li>  Una vista: CardCell.swift. </li><li>  Dos modelos: MemoryGame.swift y Card.swift. </li><li>  Main.storyboard para que todo el conjunto de componentes esté disponible. </li></ul><br>  Comenzamos con el componente más simple del juego, la tarjeta. <br><br>  <b>Card.swift</b> <br><br>  El modelo de tarjeta tendrá tres propiedades: identificación para identificar cada una, una variable lógica que se muestra para aclarar el estado de la tarjeta (oculta o abierta) y artworkURL para las imágenes en las tarjetas. <br><br><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Card</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shown: <span class="hljs-type"><span class="hljs-type">Bool</span></span> = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> artworkURL: <span class="hljs-type"><span class="hljs-type">UIImage!</span></span> }</code> </pre> <br>  También necesitará estos métodos para controlar la interacción del usuario con las tarjetas: <br><br>  <b>Método para mostrar una imagen en una tarjeta.</b>  Aquí restablecemos todas las propiedades a sus valores predeterminados.  Para la identificación, genere una identificación aleatoria llamando a NSUUIS (). UuidString. <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(image: <span class="hljs-type"><span class="hljs-type">UIImage</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.id = <span class="hljs-type"><span class="hljs-type">NSUUID</span></span>().uuidString <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.shown = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.artworkURL = image }</code> </pre> <br>  <b>Método para comparar tarjetas de identificación.</b> <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> card: Card)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (card.id == id) }</code> </pre> <br>  <b>El método para crear una copia de cada tarjeta</b> es obtener una mayor cantidad de <b>tarjetas</b> idénticas.  Este método devolverá la tarjeta con valores similares. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Card</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">Card</span></span>(card: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(card: <span class="hljs-type"><span class="hljs-type">Card</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.id = card.id <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.shown = card.shown <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.artworkURL = card.artworkURL }</code> </pre> <br>  <b>Y se necesita otro método para mezclar tarjetas al comienzo.</b>  Lo haremos una extensión de la clase Array. <br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Array</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">mutating</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shuffle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">_</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>...<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">sort</span></span> { (<span class="hljs-number"><span class="hljs-number">_</span></span>,<span class="hljs-number"><span class="hljs-number">_</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> arc4random() &lt; arc4random() } } } }</code> </pre> <br>  Y aquí está la implementación del código para el modelo de Tarjeta con todas las propiedades y métodos. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Card</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shown: <span class="hljs-type"><span class="hljs-type">Bool</span></span> = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> artworkURL: <span class="hljs-type"><span class="hljs-type">UIImage!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> allCards = [<span class="hljs-type"><span class="hljs-type">Card</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(card: <span class="hljs-type"><span class="hljs-type">Card</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.id = card.id <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.shown = card.shown <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.artworkURL = card.artworkURL } <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(image: <span class="hljs-type"><span class="hljs-type">UIImage</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.id = <span class="hljs-type"><span class="hljs-type">NSUUID</span></span>().uuidString <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.shown = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.artworkURL = image } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> card: Card)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (card.id == id) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Card</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">Card</span></span>(card: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Array</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">mutating</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shuffle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">_</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>...<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">sort</span></span> { (<span class="hljs-number"><span class="hljs-number">_</span></span>,<span class="hljs-number"><span class="hljs-number">_</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> arc4random() &lt; arc4random() } } } }</code> </pre> <br>  Adelante <br><br>  El segundo modelo es MemoryGame, aquí configuramos la cuadrícula 4 * 4.  El modelo tendrá propiedades tales como cartas (una matriz de cartas en la cuadrícula), una matriz de Cartas mostradas con cartas ya abiertas, y el booleano isPlaying para rastrear el estado del juego. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MemoryGame</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cards:[<span class="hljs-type"><span class="hljs-type">Card</span></span>] = [<span class="hljs-type"><span class="hljs-type">Card</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cardsShown:[<span class="hljs-type"><span class="hljs-type">Card</span></span>] = [<span class="hljs-type"><span class="hljs-type">Card</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isPlaying: <span class="hljs-type"><span class="hljs-type">Bool</span></span> = <span class="hljs-literal"><span class="hljs-literal">false</span></span> }</code> </pre> <br>  También necesitamos desarrollar métodos para controlar la interacción del usuario con la red. <br><br>  <b>Un método que baraja cartas en una cuadrícula.</b> <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shuffleCards</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cards:[Card])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Card</span></span>] { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> randomCards = cards randomCards.shuffle() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> randomCards }</code> </pre> <br>  <b>Método para crear un nuevo juego.</b>  Aquí llamamos al primer método para iniciar el diseño inicial e inicializar la variable isPlaying como true. <br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">newGame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cardsArray:[Card])</span></span></span></span> -&gt; [<span class="hljs-type"><span class="hljs-type">Card</span></span>] { cards = shuffleCards(cards: cardsArray) isPlaying = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cards }</code> </pre> <br>  <b>Si queremos reiniciar el juego,</b> establezca la variable isPlaying en falso y elimine el diseño inicial de las tarjetas. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">restartGame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { isPlaying = <span class="hljs-literal"><span class="hljs-literal">false</span></span> cards.removeAll() cardsShown.removeAll() }</code> </pre> <br>  <b>Método para la verificación de tarjetas prensadas.</b>  Más sobre eso más tarde. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cardAtIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index: Int)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Card?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cards.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> &gt; index { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cards[index] } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } }</code> </pre> <br>  <b>Un método que devuelve la posición de una carta específica.</b> <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">indexForCard</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> card: Card)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> index <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>...cards.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>-<span class="hljs-number"><span class="hljs-number">1</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> card === cards[index] { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> index } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> }</code> </pre> <br>  Comprobación del cumplimiento de la tarjeta seleccionada con el estándar. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unmatchedCardShown</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cardsShown.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> % <span class="hljs-number"><span class="hljs-number">2</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> </pre> <br>  Este método lee el último elemento en la matriz ** cardsShown ** y devuelve una tarjeta inapropiada. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">didSelectCard</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> card: Card?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> card = card <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> unmatchedCardShown() { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> unmatched = unmatchedCard()! <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> card.equals(unmatched) { cardsShown.append(card) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> secondCard = cardsShown.removeLast() } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { cardsShown.append(card) } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> cardsShown.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> == cards.<span class="hljs-built_in"><span class="hljs-built_in">count</span></span> { endGame() } }</code> </pre> <br><h3>  Main.storyboard y GameController.swift </h3><br>  Main.storyboard se parece a esto: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/560/fdb/a5b/560fdba5bf68f57bd0b8741b0b91cd0f.png"><br><br>  Inicialmente, en el controlador, debe instalar un nuevo juego como viewDidLoad, incluidas las imágenes para la cuadrícula.  En el juego, todo esto estará representado por 4 * 4 collectionView.  Si no está familiarizado con collectionView, aquí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">puede obtener la información necesaria</a> . <br><br>  Configuraremos GameController como el controlador raíz de la aplicación.  Habrá un collectionView en GameController, al que haremos referencia como IBOutlet.  Otro enlace es el botón IBAction onStartGame (), este es UIButton, puedes verlo en el guión gráfico llamado PLAY. <br><br>  Un poco sobre la implementación de controladores: <br><br><ul><li>  Primero, inicializamos los dos objetos principales: la cuadrícula (juego): juego = MemoryGame (), y en el conjunto de tarjetas: tarjetas = [Tarjeta] (). </li><li>  Establezca las variables iniciales como viewDidLoad, este es el primer método que se llama durante el juego. </li><li>  establece collectionView como oculto, ya que todos los mapas están ocultos hasta que el usuario presiona PLAY. </li><li>  Tan pronto como presionamos PLAY, comienza la sección onStartGame IBAction, y establecemos la propiedad collectionView isHidden en false para que las tarjetas puedan ser visibles. </li><li>  Cada vez que un usuario selecciona una tarjeta, se llama al método didSelectItemAt.  En el método, llamamos a didSelectCard para implementar la lógica básica del juego. </li></ul><br>  Aquí está la implementación final de GameController: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@IBOutlet</span></span> <span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> collectionView: <span class="hljs-type"><span class="hljs-type">UICollectionView!</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> game = <span class="hljs-type"><span class="hljs-type">MemoryGame</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> cards = [<span class="hljs-type"><span class="hljs-type">Card</span></span>]() <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() game.delegate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> collectionView.dataSource = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> collectionView.delegate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> collectionView.isHidden = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-type"><span class="hljs-type">APIClient</span></span>.shared.getCardImages { (cardsArray, error) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> <span class="hljs-number"><span class="hljs-number">_</span></span> = error { <span class="hljs-comment"><span class="hljs-comment">// show alert } self.cards = cardsArray! self.setupNewGame() } } override func viewDidDisappear(_ animated: Bool) { super.viewDidDisappear(animated) if game.isPlaying { resetGame() } } func setupNewGame() { cards = game.newGame(cardsArray: self.cards) collectionView.reloadData() } func resetGame() { game.restartGame() setupNewGame() } @IBAction func onStartGame(_ sender: Any) { collectionView.isHidden = false } } // MARK: - CollectionView Delegate Methods extension GameController: UICollectionViewDelegate, UICollectionViewDataSource { func numberOfSections(in collectionView: UICollectionView) -&gt; Int { return 1 } func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int { return cards.count } func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&gt; UICollectionViewCell { let cell = collectionView.dequeueReusableCell(withReuseIdentifier: "CardCell", for: indexPath) as! CardCell cell.showCard(false, animted: false) guard let card = game.cardAtIndex(indexPath.item) else { return cell } cell.card = card return cell } func collectionView(_ collectionView: UICollectionView, didSelectItemAt indexPath: IndexPath) { let cell = collectionView.cellForItem(at: indexPath) as! CardCell if cell.shown { return } game.didSelectCard(cell.card) collectionView.deselectItem(at: indexPath, animated:true) } }</span></span></code> </pre> <br>  Ahora hablemos de algunos protocolos importantes. <br><br><h3>  Protocolos </h3><br>  Trabajar con protocolos es la base de la programación Swift.  Los protocolos proporcionan la capacidad de establecer reglas para una clase, estructura o enumeración.  Este principio le permite escribir código modular y extensible.  Esta es realmente una plantilla que ya estamos implementando para collectionView en GameController.  Ahora hagamos nuestra propia versión.  La sintaxis se verá así: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MemoryGameProtocol</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//protocol definition goes here }</span></span></code> </pre> <br>  Sabemos que un protocolo le permite definir reglas o instrucciones para implementar una clase, así que pensemos cuáles deberían ser.  Solo se necesitan cuatro. <br><br><ul><li>  Inicio del juego: memoryGameDidStart. </li><li>  Necesita voltear la tarjeta boca abajo: memoryGameShowCards. </li><li>  Necesita voltear la tarjeta boca abajo: memoryGameHideCards. </li><li>  Finalización del juego: memoryGameDidEnd. </li></ul><br>  Implementamos los cuatro métodos para la clase principal, y este es GameController. <br><br><h3>  memoryGameDidStart </h3><br>  Cuando se inicia este método, el juego debería comenzar (el usuario presiona PLAY).  Aquí, simplemente recargamos el contenido llamando a collectionView.reloadData (), lo que hará que los mapas se barajen. <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memoryGameDidStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> game: MemoryGame)</span></span></span></span> { collectionView.reloadData() }</code> </pre> <br><h3>  memoryGameShowCards </h3><br>  Llame a este método desde collectionSDViewSelectItemAt.  Primero, muestra el mapa seleccionado.  Luego, verifica si hay una tarjeta no coincidente en la matriz cardsShown (si el número de cartasShown es impar).  Si hay una, la tarjeta seleccionada se compara con ella.  Si las imágenes son iguales, ambas tarjetas se agregan a las tarjetas mostradas y permanecen abiertas.  Si es diferente, la carta deja las cartas mostradas, y ambas se dan vuelta. <br><br><h3>  memoryGameHideCards </h3><br>  Si las tarjetas no coinciden, se llama a este método y se ocultan las imágenes de la tarjeta. <br><br>  se muestra = falso. <br><br><h3>  memoryGameDidEnd </h3><br>  Cuando se llama a este método, significa que todas las cartas ya están abiertas y están en la lista cardsShown: cardsShown.count = cards.count, por lo que el juego ha terminado.  El método se llama específicamente después de que llamamos a endGame () para establecer isPlaying var en false, después de lo cual se muestra un mensaje sobre la finalización del juego.  AlertController también se utiliza como indicador para el controlador.  Se llama a ViewDidDisappear y se reinicia el juego. <br><br>  Así es como se ve todo en GameController: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameController</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MemoryGameProtocol</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memoryGameDidStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> game: MemoryGame)</span></span></span></span> { collectionView.reloadData() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memoryGame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> game: MemoryGame, showCards cards: [Card])</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> card <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cards { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> index = game.indexForCard(card) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell = collectionView.cellForItem( at: <span class="hljs-type"><span class="hljs-type">IndexPath</span></span>(item: index, section:<span class="hljs-number"><span class="hljs-number">0</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">CardCell</span></span> cell.showCard(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, animted: <span class="hljs-literal"><span class="hljs-literal">true</span></span>) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memoryGame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> game: MemoryGame, hideCards cards: [Card])</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> card <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> cards { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> index = game.indexForCard(card) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cell = collectionView.cellForItem( at: <span class="hljs-type"><span class="hljs-type">IndexPath</span></span>(item: index, section:<span class="hljs-number"><span class="hljs-number">0</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">CardCell</span></span> cell.showCard(<span class="hljs-literal"><span class="hljs-literal">false</span></span>, animted: <span class="hljs-literal"><span class="hljs-literal">true</span></span>) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memoryGameDidEnd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> game: MemoryGame)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> alertController = <span class="hljs-type"><span class="hljs-type">UIAlertController</span></span>( title: defaultAlertTitle, message: defaultAlertMessage, preferredStyle: .alert ) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cancelAction = <span class="hljs-type"><span class="hljs-type">UIAlertAction</span></span>( title: <span class="hljs-string"><span class="hljs-string">"Nah"</span></span>, style: .cancel) { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] (action) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.collectionView.isHidden = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> playAgainAction = <span class="hljs-type"><span class="hljs-type">UIAlertAction</span></span>( title: <span class="hljs-string"><span class="hljs-string">"Dale!"</span></span>, style: .<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>) { [<span class="hljs-keyword"><span class="hljs-keyword">weak</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>] (action) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.collectionView.isHidden = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>?.resetGame() } alertController.addAction(cancelAction) alertController.addAction(playAgainAction) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.present(alertController, animated: <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { } resetGame() } }</code> </pre> <br><img src="https://habrastorage.org/getpro/habr/post_images/1fd/b6b/1e7/1fdb6b1e7b62a4d49397b1e2d590d57b.gif"><br>  Eso es todo  Puedes usar este proyecto para crear tu propia versión del juego. <br><br>  Buena codificación! <br><br><blockquote>  <b>Skillbox recomienda:</b> <br><br><ul><li>  Curso práctico <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Mobile Developer PRO"</a> . </li><li>  Curso en línea de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Python Data Analyst</a> aplicado. </li><li>  Curso práctico de dos años <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Soy un desarrollador web PRO"</a> . </li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/447598/">https://habr.com/ru/post/447598/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../447584/index.html">Anatomía del "Centro de datos espaciales". Servidor alto: mira bajo el capó</a></li>
<li><a href="../447586/index.html">Interpolación avanzada de cadenas en Swift 5.0</a></li>
<li><a href="../447588/index.html">Cómo hacer que la aplicación sea más estable con 2 tipos de pruebas unitarias</a></li>
<li><a href="../447592/index.html">WhatsApp en la palma de tu mano: ¿dónde y cómo puedes detectar artefactos forenses?</a></li>
<li><a href="../447594/index.html">Instrumentos personalizados: cuando la señalización no es suficiente</a></li>
<li><a href="../447604/index.html">Dientes lisos, C ++ y matemáticas: ¿cómo se relacionan? Conversación con Alinear</a></li>
<li><a href="../447606/index.html">Recolector de basura CLRium # 5: Peter - Agotado</a></li>
<li><a href="../447608/index.html">Evolución de CI en el equipo de desarrollo móvil</a></li>
<li><a href="../447610/index.html">Cómo tomar el control de su infraestructura de red. Capítulo tres Seguridad de red. Parte tres</a></li>
<li><a href="../447612/index.html">Centro de datos espaciales. Traducción de texto del lanzamiento del servidor a la estratosfera</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>