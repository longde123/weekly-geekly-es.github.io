<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♈️ 🤱🏿 🍴 Cálculo de integrales definidas: algoritmos básicos 🐜 👂🏽 👨🏼‍🎤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Esta publicación describe los métodos más simples para calcular las integrales de funciones de una variable en un segmento, también llamadas fórmulas ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cálculo de integrales definidas: algoritmos básicos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420867/"><p><img src="https://habrastorage.org/webt/u9/v3/cz/u9v3czzjh1wakdvjgj5u64tyxhy.gif" alt="imagen"><br>  Esta publicación describe los métodos más simples para calcular las integrales de funciones de una variable en un segmento, también llamadas fórmulas de cuadratura.  Por lo general, estos métodos se implementan en bibliotecas matemáticas estándar, como la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Biblioteca científica GNU</a> para C, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SciPy</a> para Python y otras.  La publicación tiene como objetivo demostrar cómo funcionan estos métodos "bajo el capó" y llamar la atención sobre algunos problemas de precisión y rendimiento de los algoritmos.  También me gustaría señalar la relación de las fórmulas en cuadratura y los métodos de integración numérica de las ecuaciones diferenciales ordinarias, sobre las cuales quiero escribir otra publicación. </p><a name="habracut"></a><br><h3 id="opredelenie-integrala">  Definición de la integral </h3><br><p>  Integral (según Riemann) de una función <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">f</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">x</span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.418ex" height="2.66ex" viewBox="0 -832 1902 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-29" x="1512" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> f (x) </script>  en el segmento <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-6"><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">a</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">b</span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.555ex" height="2.66ex" viewBox="0 -832 1961.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-5B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-61" x="278" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-3B" x="808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-62" x="1253" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-5D" x="1682" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> [a; b] </script>  El siguiente límite se llama: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-12"><span class="MJXp-mtext" id="MJXp-Span-13">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">n</span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">b</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-18">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20">f</span><span class="MJXp-mo" id="MJXp-Span-21" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">x</span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">x</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-27">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29">i</span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-32" style="vertical-align: -0.4em;"><span class="MJXp-mtext" id="MJXp-Span-33">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-35">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39">x</span><span class="MJXp-mtext" id="MJXp-Span-40">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">o</span><span class="MJXp-mn" id="MJXp-Span-43">0</span></span></span><span class="MJXp-mtext" id="MJXp-Span-44">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46">u</span><span class="MJXp-msubsup" id="MJXp-Span-47"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-53"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">n</span><span class="MJXp-mo" id="MJXp-Span-55">−</span><span class="MJXp-mn" id="MJXp-Span-56">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-49"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">i</span><span class="MJXp-mo" id="MJXp-Span-51">=</span><span class="MJXp-mn" id="MJXp-Span-52">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57">f</span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-59">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60">x</span><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-65" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-68" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69">i</span><span class="MJXp-mo" id="MJXp-Span-70">+</span><span class="MJXp-mn" id="MJXp-Span-71">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-73"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-75" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-77" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-78">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-79">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-81">1</span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="58.661ex" height="3.142ex" viewBox="0 -935.7 25256.8 1352.7" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6E" x="595" y="0"></use><g transform="translate(1196,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-62" x="511" y="499"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-61" x="511" y="-210"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-66" x="2031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-28" x="2582" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="2971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-29" x="3544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-64" x="3933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="4457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-3D" x="5307" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6C" x="6613" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="6912" y="0"></use><g transform="translate(7257,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-44" x="353" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-65" x="1182" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6C" x="1648" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-74" x="1947" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-61" x="2308" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="2838" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-74" x="3764" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6F" x="4125" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-30" x="4611" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-73" x="12100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-75" x="12570" y="0"></use><g transform="translate(13142,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-2212" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-31" x="1379" y="0"></use></g><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-30" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-66" x="15450" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-28" x="16000" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="16640" y="0"></use><g transform="translate(17212,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="488" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-29" x="17902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-28" x="18292" y="0"></use><g transform="translate(18681,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-2B" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-2212" x="20725" y="0"></use><g transform="translate(21725,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-29" x="22642" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-2C" x="23032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-28" x="23977" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-31" x="24366" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-29" x="24867" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> \ int_a ^ bf (x) dx = \ lim _ {\ Delta x \ to 0} \ sum_ {i = 0} ^ {n-1} f (\ xi_i) (x_ {i + 1} - x_i), ~ ~ (1) </script></p><br><p>  donde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-83"><span class="MJXp-mtext" id="MJXp-Span-84">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">x</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-92">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">x</span><span class="MJXp-mtext" id="MJXp-Span-96">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-101">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">e</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">i</span><span class="MJXp-mo" id="MJXp-Span-107">+</span><span class="MJXp-mn" id="MJXp-Span-108">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-112" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-113">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.795ex" height="2.539ex" viewBox="0 -780.1 16703.5 1093.4" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-44" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-65" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6C" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-74" x="1843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-61" x="2205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="2734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-3D" x="3584" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6D" x="4891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-61" x="5769" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="6299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6C" x="7121" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-62" x="7420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-72" x="7849" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-61" x="8301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-63" x="8830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-65" x="9264" y="0"></use><g transform="translate(9730,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-2B" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-2212" x="11773" y="0"></use><g transform="translate(12774,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-72" x="13941" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-62" x="14393" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-72" x="14822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-61" x="15274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-63" x="15803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-65" x="16237" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ Delta x = \ max \ lbrace x_ {i + 1} - x_i \ rbrace </script>  - finura de la partición, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-120"><span class="MJXp-msubsup" id="MJXp-Span-121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-123" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="1.817ex" viewBox="0 -520.7 2890 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-30" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-3D" x="1304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-61" x="2360" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> x_0 = a </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-126"><span class="MJXp-msubsup" id="MJXp-Span-127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-129" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-130" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.644ex" height="2.419ex" viewBox="0 -780.1 2860.7 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-6E" x="809" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMAIN-3D" x="1374" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/post/420867/&amp;usg=ALkJrhgUnvmOxle9dLJrcOZ-v-OreuOXMg#MJMATHI-62" x="2431" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> x_n = b </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-132"><span class="MJXp-mtext" id="MJXp-Span-133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">x</span><span class="MJXp-msubsup" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-137" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> \ xi_i </script>  - un número arbitrario en el segmento <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-138"><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-140"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-142" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-143" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-146" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">i</span><span class="MJXp-mo" id="MJXp-Span-148">+</span><span class="MJXp-mn" id="MJXp-Span-149">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-150" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> [x_i; x_ {i + 1}] </script>  . </p><br><p>  Si existe la integral de la función, entonces el valor límite es el mismo independientemente de la partición, si solo fuera lo suficientemente pequeño. <br><img src="https://habrastorage.org/webt/v7/8-/m1/v78-m1x-bgt79lmesfocurqftek.png" alt="imagen"><br>  La definición geométrica es más clara: la integral es igual al área del trapecio curvado delimitado por el eje 0 <em>x</em> , el gráfico de la función y las líneas rectas <em>x = a</em> y <em>x = b</em> (región rellena en la figura). </p><br><h3 id="kvadraturnye-formuly">  Fórmulas de cuadratura </h3><br><p>  La definición de integral (1) se puede reescribir en la forma </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-151"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">I</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-154">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">n</span><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-158" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">b</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">f</span><span class="MJXp-mo" id="MJXp-Span-162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">x</span><span class="MJXp-mo" id="MJXp-Span-164" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">x</span><span class="MJXp-mtext" id="MJXp-Span-167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">x</span><span class="MJXp-msubsup" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-175" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-177" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">b</span><span class="MJXp-mo" id="MJXp-Span-179" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">a</span><span class="MJXp-mo" id="MJXp-Span-181" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-182">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">u</span><span class="MJXp-msubsup" id="MJXp-Span-185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-191"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">n</span><span class="MJXp-mo" id="MJXp-Span-193">−</span><span class="MJXp-mn" id="MJXp-Span-194">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-187"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">i</span><span class="MJXp-mo" id="MJXp-Span-189">=</span><span class="MJXp-mn" id="MJXp-Span-190">0</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-195"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-197" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">f</span><span class="MJXp-mo" id="MJXp-Span-199" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-200">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">x</span><span class="MJXp-msubsup" id="MJXp-Span-202"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-204" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-205" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-206" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-207">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-208">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-210">2</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> I = \ int_a ^ b f (x) dx \ aprox I_n = (b - a) \ sum_ {i = 0} ^ {n-1} w_i f (\ xi_i), ~~ (2) </script></p><br><p>  donde <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-212"><span class="MJXp-msubsup" id="MJXp-Span-213"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-215" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> w_i </script>  - coeficientes de ponderación, cuya suma debe ser igual a 1, y los coeficientes en sí mismos - tienden a cero con un número creciente <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> n </script>  puntos en los que se calcula la función. </p><br><p>  La expresión (2) es la base de todas las fórmulas de cuadratura (es decir, fórmulas para el cálculo aproximado de la integral).  El desafío es seleccionar puntos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-218"><span class="MJXp-mtext" id="MJXp-Span-219">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">e</span><span class="MJXp-mtext" id="MJXp-Span-226">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">x</span><span class="MJXp-msubsup" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-230" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-231">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> \ lbrace \ xi_i \ rbrace </script>  y peso <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-238"><span class="MJXp-msubsup" id="MJXp-Span-239"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-241" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> w_i </script>  de modo que la suma en el lado derecho se aproxima a la integral requerida con la mayor precisión posible. </p><br><h3 id="vychislitelnaya-zadacha">  Tarea computacional </h3><br><p>  Conjunto de funciones <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-243">f</span><span class="MJXp-mo" id="MJXp-Span-244" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">x</span><span class="MJXp-mo" id="MJXp-Span-246" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> f (x) </script>  para lo cual existe un algoritmo para calcular valores en cualquier punto del intervalo <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-247"><span class="MJXp-mo" id="MJXp-Span-248" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">a</span><span class="MJXp-mo" id="MJXp-Span-250" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">b</span><span class="MJXp-mo" id="MJXp-Span-252" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> [a; b] </script>  (Me refiero a los puntos representados por un número de coma flotante, ¡no hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">funciones de Dirichlet</a> allí!). </p><br><p>  Se requiere encontrar el valor aproximado de la integral <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-253"><span class="MJXp-mtext" id="MJXp-Span-254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-255">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">n</span><span class="MJXp-msubsup" id="MJXp-Span-257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">b</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">f</span><span class="MJXp-mo" id="MJXp-Span-262" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263">x</span><span class="MJXp-mo" id="MJXp-Span-264" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> \ int_a ^ b f (x) dx </script>  . <br>  Las soluciones se implementarán en Python 3.6. </p><br><p>  Para verificar los métodos, use la integral <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-267"><span class="MJXp-mtext" id="MJXp-Span-268">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">n</span><span class="MJXp-msubsup" id="MJXp-Span-271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-274"><span class="MJXp-mn" id="MJXp-Span-275">3</span><span class="MJXp-mrow" id="MJXp-Span-276"><span class="MJXp-mo" id="MJXp-Span-277">/</span></span><span class="MJXp-mn" id="MJXp-Span-278">2</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-273">0</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">t</span><span class="MJXp-mo" id="MJXp-Span-284" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-285">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">x</span><span class="MJXp-mo" id="MJXp-Span-287" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-288">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">c</span><span class="MJXp-mrow" id="MJXp-Span-293"><span class="MJXp-mn" id="MJXp-Span-294">1</span></span><span class="MJXp-mrow" id="MJXp-Span-295"><span class="MJXp-mtext" id="MJXp-Span-296">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">t</span><span class="MJXp-mrow" id="MJXp-Span-301"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">x</span><span class="MJXp-mo" id="MJXp-Span-303" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-304">1</span><span class="MJXp-mrow" id="MJXp-Span-305"><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-307">16</span></span></span><span class="MJXp-mtext" id="MJXp-Span-308">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">t</span><span class="MJXp-mo" id="MJXp-Span-314" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">x</span><span class="MJXp-mo" id="MJXp-Span-317" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-318">17</span><span class="MJXp-mrow" id="MJXp-Span-319"><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-321">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> \ int_0 ^ {3/2} \ left [2x + \ frac {1} {\ sqrt {x + 1/16}} \ right] dx = 17/4 </script>  . </p><br><h3 id="kusochno-postoyannaya-approksimaciya">  Aproximación constante por partes </h3><br><p>  Las fórmulas de cuadratura idealmente simples surgen de la aplicación de la expresión (1) "en la frente": </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-322"><span class="MJXp-msubsup" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-325" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-327">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">u</span><span class="MJXp-msubsup" id="MJXp-Span-330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-336"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">n</span><span class="MJXp-mo" id="MJXp-Span-338">−</span><span class="MJXp-mn" id="MJXp-Span-339">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-332"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">i</span><span class="MJXp-mo" id="MJXp-Span-334">=</span><span class="MJXp-mn" id="MJXp-Span-335">0</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">f</span><span class="MJXp-mo" id="MJXp-Span-341" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-342">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">x</span><span class="MJXp-msubsup" id="MJXp-Span-344"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-346" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-347" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-351" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">i</span><span class="MJXp-mo" id="MJXp-Span-353">+</span><span class="MJXp-mn" id="MJXp-Span-354">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-355" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-356"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-358" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> I_n = \ sum_ {i = 0} ^ {n-1} f (\ xi_i) (x_ {i + 1} - x_i) </script></p><br><p>  Porque  del método de dividir un segmento por puntos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-360"><span class="MJXp-mtext" id="MJXp-Span-361">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">e</span><span class="MJXp-msubsup" id="MJXp-Span-368"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-370" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-371">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> \ lbrace x_i \ rbrace </script>  y seleccione puntos <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-378"><span class="MJXp-mtext" id="MJXp-Span-379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-380">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-382">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">e</span><span class="MJXp-mtext" id="MJXp-Span-386">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">x</span><span class="MJXp-msubsup" id="MJXp-Span-388"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-390" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-391">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-397">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> \ lbrace \ xi_i \ rbrace </script>  el valor límite no depende, entonces los elegimos para que puedan calcularse convenientemente; por ejemplo, tomamos la partición de manera uniforme y para los puntos del cálculo de la función consideramos las opciones: 1) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-398"><span class="MJXp-mtext" id="MJXp-Span-399">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">x</span><span class="MJXp-msubsup" id="MJXp-Span-401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-403" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-404" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-407" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ xi_i = x_i </script>  ;  2) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-408"><span class="MJXp-mtext" id="MJXp-Span-409">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">x</span><span class="MJXp-msubsup" id="MJXp-Span-411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-413" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-414" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-417" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">i</span><span class="MJXp-mo" id="MJXp-Span-419">+</span><span class="MJXp-mn" id="MJXp-Span-420">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> \ xi_i = x_ {i + 1} </script>  ;  3) <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-mtext" id="MJXp-Span-422">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">x</span><span class="MJXp-msubsup" id="MJXp-Span-424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425" style="margin-right: 0.05em;">i</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-426" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-430" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-431" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-433"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-434" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-435" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">i</span><span class="MJXp-mo" id="MJXp-Span-437">+</span><span class="MJXp-mn" id="MJXp-Span-438">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-439" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-440"><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-442">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ xi_i = (x_i + x_ {i + 1}) / 2 </script>  . </p><br><p>  Obtenemos los métodos de rectángulos izquierdos, rectángulos derechos y rectángulos con un punto medio, respectivamente. </p><br><div class="spoiler">  <b class="spoiler_title">Implementación</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_rectangle_rule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func, a, b, nseg, frac)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  ."""</span></span> dx = <span class="hljs-number"><span class="hljs-number">1.0</span></span> * (b - a) / nseg sum = <span class="hljs-number"><span class="hljs-number">0.0</span></span> xstart = a + frac * dx <span class="hljs-comment"><span class="hljs-comment"># 0 &lt;= frac &lt;= 1    , #    , #     dx for i in range(npoints): sum += func(xstart + i * dx) return sum * dx def left_rectangle_rule(func, a, b, nseg): """  """ return _rectangle_rule(func, a, b, nseg, 0.0) def right_rectangle_rule(func, a, b, nseg): """  """ return _rectangle_rule(func, a, b, npoints, 1.0) def midpoint_rectangle_rule(func, a, b, nseg): """    """ return _rectangle_rule(func, a, b, nseg, 0.5)</span></span></code> </pre> </div></div><br><p>  Para analizar el rendimiento de las fórmulas en cuadratura, construimos una gráfica del error en las coordenadas "el número de puntos es la diferencia entre el resultado numérico y el exacto". </p><br><p><img src="https://habrastorage.org/webt/ph/s1/hn/phs1hnoimtbjlywmsxy14ucmlcq.png" alt="imagen"></p><br><p>  Lo que puedes notar: </p><br><ol><li>  Una fórmula con un punto medio es mucho más precisa que con un punto derecho o izquierdo </li><li>  El error de la fórmula con el punto medio cae más rápido que los otros dos </li><li>  Con una partición muy pequeña, el error de la fórmula con el punto medio comienza a aumentar <br>  Los primeros dos puntos están relacionados con el hecho de que la fórmula de los rectángulos con un punto medio tiene un segundo orden de aproximación, es decir. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-443"><span class="MJXp-mrow" id="MJXp-Span-444"><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-448" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">I</span><span class="MJXp-mrow" id="MJXp-Span-451"><span class="MJXp-mo" id="MJXp-Span-452" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">O</span><span class="MJXp-mo" id="MJXp-Span-455" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-456">1</span><span class="MJXp-mrow" id="MJXp-Span-457"><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-461" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> | I_n - I | = O (1 / n ^ 2) </script>  , y las fórmulas de los rectángulos derecho e izquierdo son de primer orden, es decir <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-463"><span class="MJXp-mrow" id="MJXp-Span-464"><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-468" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">I</span><span class="MJXp-mrow" id="MJXp-Span-471"><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-473" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">O</span><span class="MJXp-mo" id="MJXp-Span-475" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-476">1</span><span class="MJXp-mrow" id="MJXp-Span-477"><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">n</span><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> | I_n - I | = O (1 / n) </script>  . <br>  Un aumento en el error durante la rectificación del paso de integración se asocia con un aumento en el error de redondeo al sumar una gran cantidad de términos.  Este error crece como <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-481"><span class="MJXp-mrow" id="MJXp-Span-482"><span class="MJXp-mo" id="MJXp-Span-483" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-486" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-487" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">I</span><span class="MJXp-mrow" id="MJXp-Span-489"><span class="MJXp-mo" id="MJXp-Span-490" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">O</span><span class="MJXp-mo" id="MJXp-Span-493" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-494">1</span><span class="MJXp-mrow" id="MJXp-Span-495"><span class="MJXp-mo" id="MJXp-Span-496" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">n</span><span class="MJXp-mo" id="MJXp-Span-498" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> | I_n - I | = O (1 / n) </script>  eso no permite la integración para lograr la precisión de la máquina. <br>  <strong>Conclusión: los</strong> métodos de rectángulos con puntos derecho e izquierdo tienen baja precisión, que también crece lentamente con el refinamiento de la partición.  Por lo tanto, solo tienen sentido para fines de demostración.  El método de los rectángulos con un punto medio tiene un orden de aproximación más alto, lo que le da la oportunidad de ser utilizado en aplicaciones reales (más sobre eso a continuación). </li></ol><br><h3 id="kusochno-lineynaya-approksimaciya">  Aproximación lineal por partes </h3><br><p>  El siguiente paso lógico es aproximar la función integrable en cada uno de los subsegmentos mediante una función lineal, que proporciona la fórmula en cuadratura de los trapecios: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-499"><span class="MJXp-msubsup" id="MJXp-Span-500"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-502" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-503" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-504">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">u</span><span class="MJXp-msubsup" id="MJXp-Span-507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-513"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">n</span><span class="MJXp-mo" id="MJXp-Span-515">−</span><span class="MJXp-mn" id="MJXp-Span-516">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">i</span><span class="MJXp-mo" id="MJXp-Span-511">=</span><span class="MJXp-mn" id="MJXp-Span-512">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-517">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">c</span><span class="MJXp-mrow" id="MJXp-Span-522"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-523">f</span><span class="MJXp-mo" id="MJXp-Span-524" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-527" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-528" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-529" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">f</span><span class="MJXp-mo" id="MJXp-Span-531" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-534" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">i</span><span class="MJXp-mo" id="MJXp-Span-536">+</span><span class="MJXp-mn" id="MJXp-Span-537">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-538" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-539"><span class="MJXp-mn" id="MJXp-Span-540">2</span></span><span class="MJXp-mo" id="MJXp-Span-541" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-542"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-544" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">i</span><span class="MJXp-mo" id="MJXp-Span-546">+</span><span class="MJXp-mn" id="MJXp-Span-547">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-548" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-549"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-551" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-552" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-553">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-554">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-555" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-556">3</span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-27"> I_n = \ sum_ {i = 0} ^ {n-1} \ frac {f (x_i) + f (x_ {i + 1})} {2} (x_ {i + 1} - x_i) ~~ ( 3) </script></p><br><p><img src="https://habrastorage.org/webt/bo/u_/kq/bou_kqhspiicqeppteokzj-bivc.png" alt="imagen"><br>  Ilustración del método trapezoidal para <em>n</em> = 1 <em>yn</em> = 2. </p><br><p>  En el caso de una cuadrícula uniforme, las longitudes de todos los segmentos de la partición son iguales, y la fórmula tiene la forma </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-558"><span class="MJXp-msubsup" id="MJXp-Span-559"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-561" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">h</span><span class="MJXp-mtext" id="MJXp-Span-564">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">t</span><span class="MJXp-mo" id="MJXp-Span-569" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-570">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">c</span><span class="MJXp-mrow" id="MJXp-Span-575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">f</span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">a</span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">f</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">b</span><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-585"><span class="MJXp-mn" id="MJXp-Span-586">2</span></span><span class="MJXp-mo" id="MJXp-Span-587" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-588">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">u</span><span class="MJXp-msubsup" id="MJXp-Span-591"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">n</span><span class="MJXp-mo" id="MJXp-Span-599">−</span><span class="MJXp-mn" id="MJXp-Span-600">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">i</span><span class="MJXp-mo" id="MJXp-Span-595">=</span><span class="MJXp-mn" id="MJXp-Span-596">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">f</span><span class="MJXp-mo" id="MJXp-Span-602" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">a</span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">h</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">t</span><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-615" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-616">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617">h</span><span class="MJXp-mo" id="MJXp-Span-618" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">c</span><span class="MJXp-mrow" id="MJXp-Span-624"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">a</span></span><span class="MJXp-mrow" id="MJXp-Span-627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">n</span></span><span class="MJXp-mtext" id="MJXp-Span-629">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-630">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-631" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-632">3</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">a</span><span class="MJXp-mo" id="MJXp-Span-634" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-28"> I_n = h \ left (\ frac {f (a) + f (b)} {2} + \ sum_ {i = 1} ^ {n-1} f (a + ih) \ right), ~ h = \ frac {ba} {n} ~~ (3a) </script></p><br><div class="spoiler">  <b class="spoiler_title">Implementación</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trapezoid_rule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func, a, b, nseg)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  nseg -  ,    [a;b]"""</span></span> dx = <span class="hljs-number"><span class="hljs-number">1.0</span></span> * (b - a) / nseg sum = <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (func(a) + func(b)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, nseg): sum += func(a + i * dx) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum * dx</code> </pre> </div></div><br><p>  Después de trazar el error versus el número de puntos divididos, vemos que el método trapezoidal también tiene un segundo orden de aproximación y generalmente da resultados ligeramente diferentes del método del rectángulo del punto medio (en adelante, simplemente el método del rectángulo). <br><img src="https://habrastorage.org/webt/zu/j_/zj/zuj_zjj9ey9nmiiymayupp0ikxg.png" alt="imagen"></p><br><h3 id="kontrol-tochnosti-vychisleniya">  Control de precisión de cálculo </h3><br><p>  Establecer el número de puntos divididos como un parámetro de entrada no es muy práctico, ya que generalmente se requiere calcular la integral no con una densidad de partición dada, sino con un error dado.  Si el integrando se conoce de antemano, entonces podemos estimar el error de antemano y elegir un paso de integración de tal manera que se logre la precisión especificada.  Pero esto rara vez es el caso en la práctica (y, en general, ¿no es más fácil, con la función conocida de antemano, integrar la integral por adelantado?), Por lo tanto, es necesario un procedimiento para ajustar automáticamente el paso a un error dado. </p><br><p>  ¿Cómo implementar esto?  Uno de los métodos simples para estimar el error, la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">regla Runge</a> , la diferencia en los valores de las integrales calculados a partir de <em>n</em> y 2 <em>n</em> puntos, proporciona una estimación de error: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-mtext" id="MJXp-Span-636">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-638">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-639">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">t</span><span class="MJXp-msubsup" id="MJXp-Span-641"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-643" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-644">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">n</span></span></span><span class="MJXp-mtext" id="MJXp-Span-646">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">x</span><span class="MJXp-mrow" id="MJXp-Span-652"><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-656" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-657">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-659" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-660"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661" style="margin-right: 0.05em;">I</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-662" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-663"><span class="MJXp-mo" id="MJXp-Span-664" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ Delta_ {2n} \ aprox | I_ {2n} - I_n | </script>  .  El método trapezoidal es más conveniente para duplicar la finura de una partición que el método de rectángulos con un punto central.  Al calcular mediante el método trapezoidal, para duplicar el número de puntos, solo se necesitan nuevos valores de la función en el medio de los segmentos de la partición anterior, es decir,  la aproximación previa de la integral se puede usar para calcular la siguiente. </p><br><div class="spoiler">  <b class="spoiler_title">¿Para qué más es bueno el método de rectángulo?</b> <div class="spoiler_text"><p>  El método del rectángulo no requiere calcular los valores de la función en los extremos del segmento.  Esto significa que se puede utilizar para funciones que tienen características integrables en los bordes del segmento (por ejemplo, sen <em>x</em> / <em>x</em> o <em>x</em> <sup>-1/2</sup> de 0 a 1).  Por lo tanto, el método de extrapolación que se muestra a continuación funcionará exactamente igual para el método del rectángulo.  La diferencia con el método trapezoidal es solo que cuando el paso se reduce a la mitad, el resultado de los cálculos anteriores se descarta, sin embargo, puede <em>triplicar el</em> número de puntos, y luego el valor anterior de la integral también se puede usar para calcular uno nuevo.  Las fórmulas para la extrapolación en este caso deben ajustarse a una proporción diferente de pasos de integración. </p></div></div><br><p>  Desde aquí obtenemos el siguiente código para el método trapezoidal con control de precisión: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trapezoid_rule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func, a, b, rtol = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1e-8</span></span></span></span><span class="hljs-function"><span class="hljs-params">, nseg0 = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  rtol -     nseg0 -    """</span></span> nseg = nseg0 old_ans = <span class="hljs-number"><span class="hljs-number">0.0</span></span> dx = <span class="hljs-number"><span class="hljs-number">1.0</span></span> * (b - a) / nseg ans = <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (func(a) + func(b)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, nseg): ans += func(a + i * dx) ans *= dx err_est = max(<span class="hljs-number"><span class="hljs-number">1</span></span>, abs(ans)) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (err_est &gt; abs(rtol * ans)): old_ans = ans ans = <span class="hljs-number"><span class="hljs-number">0.5</span></span> * (ans + midpoint_rectangle_rule(func, a, b, nseg)) <span class="hljs-comment"><span class="hljs-comment">#      #       nseg *= 2 err_est = abs(ans - old_ans) return ans</span></span></code> </pre> <br><p>  Con este enfoque, el integrando no se calculará varias veces en un punto, y todos los valores calculados se utilizan para el resultado final. </p><br><p>  Pero, ¿es posible lograr una mayor precisión con el mismo número de cálculos de funciones?  Resulta que es posible, hay fórmulas que funcionan con mayor precisión que el método trapezoidal en la misma cuadrícula. </p><br><h3 id="kusochno-parabolicheskaya-approksimaciya">  Aproximación parabólica por partes </h3><br><p>  El siguiente paso es aproximar la función con elementos parabólicos.  Esto requiere que el número de segmentos de la partición sea par, luego se pueden dibujar parábolas a través de triples de puntos con abscisas {( <em>x</em> <sub>0</sub> = <em>a</em> , <em>x</em> <sub>1</sub> , <em>x</em> <sub>2</sub> ), ( <em>x</em> <sub>2</sub> , <em>x</em> <sub>3</sub> , <em>x</em> <sub>4</sub> ), ..., ( <em>x</em> <sub><em>n</em> -2</sub> , <em>x</em> <sub><em>n</em> -1</sub> , <em>x <sub>n</sub></em> = <em>b</em> )}. </p><br><p><img src="https://habrastorage.org/webt/ko/rw/ll/korwllkbzphjpl_uvs10zpfnx6u.png"><br>  Ilustración de una aproximación parabólica por partes en 3 y 5 puntos ( <em>n</em> = 2 <em>yn</em> = 3). </p><br><p>  Acercarse a la integral de la función en cada uno de los segmentos [ <em>x <sub>k</sub></em> ;  <em>x</em> <sub><em>k</em> +2</sub> ] por la integral de la aproximación parabólica en este segmento y suponiendo que los puntos se distribuyan uniformemente ( <em>x</em> <sub><em>k</em> +1</sub> = <em>x <sub>k</sub></em> + <em>h</em> ), obtenemos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la fórmula de Simpson</a> : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-665"><span class="MJXp-msubsup" id="MJXp-Span-666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-668" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-673">s</span><span class="MJXp-mo" id="MJXp-Span-674">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-676" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-677">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">u</span><span class="MJXp-msubsup" id="MJXp-Span-680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-686"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">n</span><span class="MJXp-mrow" id="MJXp-Span-688"><span class="MJXp-mo" id="MJXp-Span-689">/</span></span><span class="MJXp-mn" id="MJXp-Span-690">2</span><span class="MJXp-mo" id="MJXp-Span-691">−</span><span class="MJXp-mn" id="MJXp-Span-692">1</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-683">i</span><span class="MJXp-mo" id="MJXp-Span-684">=</span><span class="MJXp-mn" id="MJXp-Span-685">0</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">c</span><span class="MJXp-mrow" id="MJXp-Span-698"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">h</span></span><span class="MJXp-mrow" id="MJXp-Span-700"><span class="MJXp-mn" id="MJXp-Span-701">3</span></span><span class="MJXp-mo" id="MJXp-Span-702" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">f</span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-705"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-707" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-708">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-710" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-712">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">f</span><span class="MJXp-mo" id="MJXp-Span-714" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-717" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-718">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">i</span><span class="MJXp-mo" id="MJXp-Span-720">+</span><span class="MJXp-mn" id="MJXp-Span-721">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-722" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724">f</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-728" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-729">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">i</span><span class="MJXp-mo" id="MJXp-Span-731">+</span><span class="MJXp-mn" id="MJXp-Span-732">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-733" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-735" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-736" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-737" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-738">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-739">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-741">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">c</span><span class="MJXp-mrow" id="MJXp-Span-743"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">h</span></span><span class="MJXp-mrow" id="MJXp-Span-745"><span class="MJXp-mn" id="MJXp-Span-746">3</span></span><span class="MJXp-mo" id="MJXp-Span-747" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">f</span><span class="MJXp-mo" id="MJXp-Span-749" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">a</span><span class="MJXp-mo" id="MJXp-Span-751" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-752" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-753">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">f</span><span class="MJXp-mo" id="MJXp-Span-755" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">a</span><span class="MJXp-mo" id="MJXp-Span-757" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">h</span><span class="MJXp-mo" id="MJXp-Span-759" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-761">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">f</span><span class="MJXp-mo" id="MJXp-Span-763" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">a</span><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-766">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">h</span><span class="MJXp-mo" id="MJXp-Span-768" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-770" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-773" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-774">4</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">f</span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">h</span><span class="MJXp-mo" id="MJXp-Span-779" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-780" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">f</span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">b</span><span class="MJXp-mo" id="MJXp-Span-784" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-786">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-787">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-789">4</span><span class="MJXp-mo" id="MJXp-Span-790" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-30"> I_ {Simps, n} = \ sum_ {i = 0} ^ {n / 2-1} \ frac {h} {3} [f (x_ {2i}) + 4f (x_ {2i + 1}) + f (x_ {2i + 2})] = \\ = \ frac {h} {3} [f (a) + 4f (a + h) + 2f (a + 2h) + ... + 4f (bh) + f (b)] ~~ (4) </script></p><br><p>  La fórmula (4) produce directamente una implementación "ingenua" del método Simpson: </p><br><div class="spoiler">  <b class="spoiler_title">Encabezado de spoiler</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpson_rule</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func, a, b, nseg)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""  nseg -  ,    [a;b]"""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> nseg%<span class="hljs-number"><span class="hljs-number">2</span></span> = <span class="hljs-number"><span class="hljs-number">1</span></span>: nseg += <span class="hljs-number"><span class="hljs-number">1</span></span> dx = <span class="hljs-number"><span class="hljs-number">1.0</span></span> * (b - a) / nseg sum = (func(a) + <span class="hljs-number"><span class="hljs-number">4</span></span> * func(a + dx) + func(b)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, nseg / <span class="hljs-number"><span class="hljs-number">2</span></span>): sum += <span class="hljs-number"><span class="hljs-number">2</span></span> * func(a + (<span class="hljs-number"><span class="hljs-number">2</span></span> * i) * dx) + <span class="hljs-number"><span class="hljs-number">4</span></span> * func(a + (<span class="hljs-number"><span class="hljs-number">2</span></span> * i + <span class="hljs-number"><span class="hljs-number">1</span></span>) * dx) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sum * dx / <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> </div></div><br><p>  Para estimar el error, puede usar el mismo cálculo de la integral con los pasos <em>h</em> y <em>h</em> / 2, pero aquí está el problema, al calcular la integral con un paso más pequeño, el resultado del cálculo anterior deberá descartarse, aunque la mitad de los cálculos de la nueva función estarán en los mismos puntos que antes. </p><br><p>  Afortunadamente, puede evitar perder el tiempo de la máquina si implementa el método Simpson de una manera más ingeniosa.  Después de mirar más de cerca, notamos que la integral por la fórmula de Simpson se puede representar a través de dos integrales por la fórmula trapezoidal con diferentes pasos.  Esto se ve más claramente en el caso básico de aproximación de la integral en tres puntos. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-791"><span class="MJXp-mo" id="MJXp-Span-792" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">a</span><span class="MJXp-mo" id="MJXp-Span-794" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-797" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-798" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-799" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-800">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">a</span><span class="MJXp-mo" id="MJXp-Span-803" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">h</span><span class="MJXp-mo" id="MJXp-Span-805" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-808" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-809" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-810" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-811">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">a</span><span class="MJXp-mo" id="MJXp-Span-814" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-815">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">h</span><span class="MJXp-mo" id="MJXp-Span-817" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-820" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-821" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> (a, f_0), ~ (a + h, f_1), ~ (a + 2h, f_2) </script>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-822"><span class="MJXp-msubsup" id="MJXp-Span-823"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-825" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830">s</span><span class="MJXp-mo" id="MJXp-Span-831">,</span><span class="MJXp-mn" id="MJXp-Span-832">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-834">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">c</span><span class="MJXp-mrow" id="MJXp-Span-839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">h</span></span><span class="MJXp-mrow" id="MJXp-Span-841"><span class="MJXp-mn" id="MJXp-Span-842">3</span></span><span class="MJXp-mo" id="MJXp-Span-843" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-844"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-846" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-848">4</span><span class="MJXp-msubsup" id="MJXp-Span-849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-851" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-852" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-855" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-856" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-857" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-858">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">c</span><span class="MJXp-mrow" id="MJXp-Span-863"><span class="MJXp-mn" id="MJXp-Span-864">4</span></span><span class="MJXp-mrow" id="MJXp-Span-865"><span class="MJXp-mn" id="MJXp-Span-866">3</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">h</span><span class="MJXp-mtext" id="MJXp-Span-868">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">t</span><span class="MJXp-mo" id="MJXp-Span-873" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-874">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-878">c</span><span class="MJXp-mrow" id="MJXp-Span-879"><span class="MJXp-msubsup" id="MJXp-Span-880"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-882" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-886" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mrow" id="MJXp-Span-887"><span class="MJXp-mn" id="MJXp-Span-888">2</span></span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-890">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">c</span><span class="MJXp-mrow" id="MJXp-Span-895"><span class="MJXp-msubsup" id="MJXp-Span-896"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-898" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-902" style="vertical-align: -0.4em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-903"><span class="MJXp-mn" id="MJXp-Span-904">2</span></span><span class="MJXp-mtext" id="MJXp-Span-905">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">t</span><span class="MJXp-mo" id="MJXp-Span-911" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-912" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-913">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">c</span><span class="MJXp-mrow" id="MJXp-Span-918"><span class="MJXp-mn" id="MJXp-Span-919">1</span></span><span class="MJXp-mrow" id="MJXp-Span-920"><span class="MJXp-mn" id="MJXp-Span-921">3</span></span><span class="MJXp-mtext" id="MJXp-Span-922">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">t</span><span class="MJXp-mn" id="MJXp-Span-927">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">h</span><span class="MJXp-mtext" id="MJXp-Span-929">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">c</span><span class="MJXp-mrow" id="MJXp-Span-934"><span class="MJXp-msubsup" id="MJXp-Span-935"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-937" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-938" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-939"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940" style="margin-right: 0.05em;">f</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-941" style="vertical-align: -0.4em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-942"><span class="MJXp-mn" id="MJXp-Span-943">2</span></span><span class="MJXp-mo" id="MJXp-Span-944" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mspace" id="MJXp-Span-945" style="width: 0em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-946" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-947">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">c</span><span class="MJXp-mrow" id="MJXp-Span-952"><span class="MJXp-mn" id="MJXp-Span-953">4</span><span class="MJXp-msubsup" id="MJXp-Span-954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-956" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">p</span><span class="MJXp-mo" id="MJXp-Span-961">,</span><span class="MJXp-mn" id="MJXp-Span-962">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-963" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-966" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">p</span><span class="MJXp-mo" id="MJXp-Span-971">,</span><span class="MJXp-mn" id="MJXp-Span-972">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-973"><span class="MJXp-mn" id="MJXp-Span-974">3</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> I_ {Simps, 2} = \ frac {h} {3} (f_0 + 4f_1 + f_2) = \ frac {4} {3} h \ left (\ frac {f_0 + f_1} {2} + \ frac { f_1 + f_2} {2} \ right) - \ frac {1} {3} \ cdot2h \ frac {f_0 + f_2} {2} = \\ = \ frac {4I_ {trap, 2} - I_ {trap, 1 }} {3} </script></p><br><p>  Por lo tanto, si implementamos el procedimiento de reducir el paso a la mitad y almacenamos los dos últimos cálculos mediante el método trapezoidal, el método Simpson con control de precisión se implementa de manera más eficiente. </p><br><div class="spoiler">  <b class="spoiler_title">Algo asi ...</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    """</span></span> __sum = <span class="hljs-number"><span class="hljs-number">0.0</span></span> __nseg = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">#    __ncalls = 0 #      def __restart(func, x0, x1, nseg0, reset_calls = True): """    .       """ if reset_calls: Quadrature.__ncalls = 0 Quadrature.__nseg = nseg0 #           nseg0 Quadrature.__sum = 0.5 * (func(x0) + func(x1)) dx = 1.0 * (x1 - x0) / nseg0 for i in range(1, nseg0): Quadrature.__sum += func(x0 + i * dx) Quadrature.__ncalls += 1 + nseg0 return Quadrature.__sum * dx def __double_nseg(func, x0, x1): """  .       """ nseg = Quadrature.__nseg dx = (x1 - x0) / nseg x = x0 + 0.5 * dx i = 0 AddedSum = 0.0 for i in range(nseg): AddedSum += func(x + i * dx) Quadrature.__sum += AddedSum Quadrature.__nseg *= 2 Quadrature.__ncalls += nseg return Quadrature.__sum * 0.5 * dx def trapezoid(func, x0, x1, rtol = 1e-10, nseg0 = 1): """     . rtol -  , nseg0 -    """ ans = Quadrature.__restart(func, x0, x1, nseg0) old_ans = 0.0 err_est = max(1, abs(ans)) while (err_est &gt; abs(rtol * ans)): old_ans = ans ans = Quadrature.__double_nseg(func, x0, x1) err_est = abs(old_ans - ans) print("Total function calls: " + str(Quadrature.__ncalls)) return ans def simpson(func, x0, x1, rtol = 1.0e-10, nseg0 = 1): """     . rtol -  , nseg0 -    """ old_trapez_sum = Quadrature.__restart(func, x0, x1, nseg0) new_trapez_sum = Quadrature.__double_nseg(func, x0, x1) ans = (4 * new_trapez_sum - old_trapez_sum) / 3 old_ans = 0.0 err_est = max(1, abs(ans)) while (err_est &gt; abs(rtol * ans)): old_ans = ans old_trapez_sum = new_trapez_sum new_trapez_sum = Quadrature.__double_nseg(func, x0, x1) ans = (4 * new_trapez_sum - old_trapez_sum) / 3 err_est = abs(old_ans - ans) print("Total function calls: " + str(Quadrature.__ncalls)) return ans</span></span></code> </pre> </div></div><br><p>  Compare la efectividad del método de trapecio y parábola: </p><br><pre> <code class="hljs powershell">&gt;&gt;&gt; import math &gt;&gt;&gt; Quadrature.trapezoid(lambda x: <span class="hljs-number"><span class="hljs-number">2</span></span> * x + <span class="hljs-number"><span class="hljs-number">1</span></span> / math.sqrt(x + <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-number"><span class="hljs-number">16</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1</span></span>e<span class="hljs-literal"><span class="hljs-literal">-9</span></span>) Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">65537</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">4</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">250000001385811</span></span></span><span class="hljs-function"> &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpson</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lambda x: 2 * x + 1 / math.sqrt(x + 1 / 16)</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">5</span></span></span><span class="hljs-function">, </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rtol</span></span></span><span class="hljs-function">=</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">1e-9</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Total</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">2049</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">4</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">2500000000490985</span></span></span></span></code> </pre> <br><p>  Como puede ver, con ambos métodos se puede obtener la respuesta con una precisión bastante alta, pero el número de llamadas al integrando es muy diferente: ¡un método de orden superior es 32 veces más eficiente! </p><br><p>  Al trazar el error de integración frente al número de pasos, podemos verificar que el orden de aproximación de la fórmula de Simpson es cuatro, es decir  error de integración numérica <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-975"><span class="MJXp-mrow" id="MJXp-Span-976"><span class="MJXp-mo" id="MJXp-Span-977" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-978"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-980" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">s</span><span class="MJXp-mo" id="MJXp-Span-986">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-988" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">I</span><span class="MJXp-mrow" id="MJXp-Span-990"><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-992" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993">O</span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-995">1</span><span class="MJXp-mrow" id="MJXp-Span-996"><span class="MJXp-mo" id="MJXp-Span-997" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999" style="margin-right: 0.05em;">n</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1000" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1001" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> | I_ {Simps, n} - I | = O (1 / n ^ 4) </script>  (¡y las integrales de polinomios cúbicos que usan esta fórmula se calculan hasta errores de redondeo para cualquier par <em>n</em> &gt; 0!). <br><img src="https://habrastorage.org/webt/4w/-8/jk/4w-8jkj9y4wc1g9wnn9ynlfdxsk.png" alt="imagen"><br>  Por lo tanto, tal aumento en la eficiencia surge en comparación con la fórmula trapezoidal simple. </p><br><h3 id="chto-dalshe">  Que sigue </h3><br><p>  La lógica adicional de aumentar la precisión de las fórmulas de cuadratura es generalmente comprensible: si continuamos aproximando la función con polinomios de un grado cada vez mayor, entonces la integral de estos polinomios se aproximará cada vez con mayor precisión a la integral de la función original.  Este enfoque se llama la construcción de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fórmulas cuadráticas de Newton-Cotes</a> .  Se conocen fórmulas de hasta 8 órdenes de aproximación, pero los términos alternos aparecen entre los coeficientes de ponderación <em>w <sub>i</sub></em> en (2), y las fórmulas pierden estabilidad en los cálculos. </p><br><p>  Probemos a la inversa.  El error de la fórmula en cuadratura se representa como una serie en potencias del paso de integración <em>h</em> .  Una propiedad notable del método trapezoidal (¡y rectángulos con un punto medio!) Es que, para él, esta serie consta solo de grados pares: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1002"><span class="MJXp-msubsup" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1005" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">p</span><span class="MJXp-mo" id="MJXp-Span-1010">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">f</span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">a</span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">b</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1019" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1020">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">n</span><span class="MJXp-msubsup" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">b</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">a</span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">f</span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">x</span><span class="MJXp-mo" id="MJXp-Span-1030" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">x</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1036" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-1037"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1039" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1040" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1043" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-msubsup" id="MJXp-Span-1044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1046" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1047" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-1048"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1050" style="vertical-align: -0.4em;">6</span></span><span class="MJXp-msubsup" id="MJXp-Span-1051"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1053" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1054" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1055" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1057" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1058" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-1059">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">h</span><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1062">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">c</span><span class="MJXp-mrow" id="MJXp-Span-1067"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">a</span></span><span class="MJXp-mrow" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">n</span></span><span class="MJXp-mtext" id="MJXp-Span-1072">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1073">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1074">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1075" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1076">5</span><span class="MJXp-mo" id="MJXp-Span-1077" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> I_ {trap, n} [f, a, b] = \ int_a ^ bf (x) dx + C_2h ^ 2 + C_4h ^ 4 + C_6h ^ 6 + ..., ~ h = \ frac {ba} {n } ~~~ (5) </script></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">La extrapolación de Richardson se</a> basa en encontrar aproximaciones sucesivas a esta expansión: en lugar de aproximar el integrando por un polinomio, a partir de las aproximaciones calculadas de la integral <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">I</span><span class="MJXp-mo" id="MJXp-Span-1080" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">h</span><span class="MJXp-mo" id="MJXp-Span-1082" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> I (h) </script>  se construye una aproximación polinómica, que para <em>h</em> = 0 debería dar la mejor aproximación al valor verdadero de la integral. </p><br><p>  Ampliar el error de integración en potencias pares del paso de partición acelera bruscamente la convergencia de la extrapolación, porque  para la aproximación del orden 2 <em>n</em> , el método trapezoide solo necesita <em>n</em> valores de la integral. </p><br><p>  Si asumimos que cada término subsiguiente es menor que el anterior, entonces podemos excluir secuencialmente los grados de <em>h</em> , teniendo aproximaciones integrales calculadas con diferentes pasos.  Dado que la implementación anterior nos permite dividir fácilmente la partición por la mitad, es conveniente considerar las fórmulas para los pasos <em>h</em> y <em>h</em> / 2. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1083"><span class="MJXp-msubsup" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1086" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">p</span><span class="MJXp-mo" id="MJXp-Span-1091">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1093" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">I</span><span class="MJXp-mtext" id="MJXp-Span-1095">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">x</span><span class="MJXp-msubsup" id="MJXp-Span-1101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1103" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-1104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1106" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-1108">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1111" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">p</span><span class="MJXp-mo" id="MJXp-Span-1116">,</span><span class="MJXp-mn" id="MJXp-Span-1117">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1119" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1120">I</span><span class="MJXp-mtext" id="MJXp-Span-1121">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">x</span><span class="MJXp-msubsup" id="MJXp-Span-1127"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1129" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1134">t</span><span class="MJXp-mo" id="MJXp-Span-1135" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1136">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">c</span><span class="MJXp-mrow" id="MJXp-Span-1141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">h</span></span><span class="MJXp-mrow" id="MJXp-Span-1143"><span class="MJXp-mn" id="MJXp-Span-1144">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1145">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1146">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1148">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">t</span><span class="MJXp-msubsup" id="MJXp-Span-1151"><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1153" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> I_ {trap, n} - I \ aprox C_2h ^ 2; ~ I_ {trap, 2n} - I \ aprox C_2 \ left (\ frac {h} {2} \ right) ^ 2 </script></p><br><p>  Es fácil demostrar que la excepción del término principal del error de la fórmula trapezoidal dará exactamente la fórmula de Simpson: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">I</span><span class="MJXp-mo" id="MJXp-Span-1156" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1159" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">p</span><span class="MJXp-mo" id="MJXp-Span-1164">,</span><span class="MJXp-mn" id="MJXp-Span-1165">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1167" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1168"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1170" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1171">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1174">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">t</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1177">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">c</span><span class="MJXp-mrow" id="MJXp-Span-1182"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">h</span></span><span class="MJXp-mrow" id="MJXp-Span-1184"><span class="MJXp-mn" id="MJXp-Span-1185">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1186">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">t</span><span class="MJXp-msubsup" id="MJXp-Span-1192"><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1194" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">O</span><span class="MJXp-mo" id="MJXp-Span-1197" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1200" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1204">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">x</span><span class="MJXp-msubsup" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1211" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">p</span><span class="MJXp-mo" id="MJXp-Span-1216">,</span><span class="MJXp-mn" id="MJXp-Span-1217">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1219" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1220">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">c</span><span class="MJXp-mrow" id="MJXp-Span-1225"><span class="MJXp-msubsup" id="MJXp-Span-1226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1228" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">p</span><span class="MJXp-mo" id="MJXp-Span-1233">,</span><span class="MJXp-mn" id="MJXp-Span-1234">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1237"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1239" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">p</span><span class="MJXp-mo" id="MJXp-Span-1244">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">n</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1246"><span class="MJXp-mn" id="MJXp-Span-1247">1</span><span class="MJXp-mo" id="MJXp-Span-1248" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1249"><span class="MJXp-mn" id="MJXp-Span-1250" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1251" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1252" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1255" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1260">s</span><span class="MJXp-mo" id="MJXp-Span-1261">,</span><span class="MJXp-mn" id="MJXp-Span-1262">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">n</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> I = I_ {trap, 2n} - C_2 \ left (\ frac {h} {2} \ right) ^ 2 + O (h ^ 4) \ approx I_ {trap, 2n} - \ frac {I_ {trap, 2n} -I_ {trap, n}} {1-2 ^ 2} = I_ {Simps, 2n} </script></p><br><p>  Repitiendo un procedimiento similar para la fórmula de Simpson, obtenemos: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1264"><span class="MJXp-msubsup" id="MJXp-Span-1265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1267" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1269">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">s</span><span class="MJXp-mo" id="MJXp-Span-1273">,</span><span class="MJXp-mn" id="MJXp-Span-1274">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1276" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1277">I</span><span class="MJXp-mtext" id="MJXp-Span-1278">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">x</span><span class="MJXp-mo" id="MJXp-Span-1284" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-1285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1286" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1287" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mtext" id="MJXp-Span-1288">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">z</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1295">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">a</span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1299">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">c</span><span class="MJXp-mrow" id="MJXp-Span-1304"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">h</span></span><span class="MJXp-mrow" id="MJXp-Span-1306"><span class="MJXp-mn" id="MJXp-Span-1307">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1308">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1310">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">a</span><span class="MJXp-msubsup" id="MJXp-Span-1316"><span class="MJXp-mo" id="MJXp-Span-1317" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1318" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mtext" id="MJXp-Span-1320">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1323" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1327">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328">s</span><span class="MJXp-mo" id="MJXp-Span-1329">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1331" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">I</span><span class="MJXp-mtext" id="MJXp-Span-1333">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1337">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">x</span><span class="MJXp-mo" id="MJXp-Span-1339" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-1340"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1342" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-msubsup" id="MJXp-Span-1343"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1345" style="vertical-align: 0.5em;">4</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> I_ {Simps, 2n} - I \ aprox. C_4 \ izquierda (\ frac {h} {2} \ derecha) ^ 4; ~ I_ {Simps, n} - I \ aprox. C_4h ^ 4 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1346"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">I</span><span class="MJXp-mo" id="MJXp-Span-1348" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1351" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1352">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1354">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356">s</span><span class="MJXp-mo" id="MJXp-Span-1357">,</span><span class="MJXp-mn" id="MJXp-Span-1358">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1360" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1363" style="vertical-align: -0.4em;">4</span></span><span class="MJXp-mtext" id="MJXp-Span-1364">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1367">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1368">t</span><span class="MJXp-mo" id="MJXp-Span-1369" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1370">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1371">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1372">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1374">c</span><span class="MJXp-mrow" id="MJXp-Span-1375"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1376">h</span></span><span class="MJXp-mrow" id="MJXp-Span-1377"><span class="MJXp-mn" id="MJXp-Span-1378">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1379">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1381">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1382">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384">t</span><span class="MJXp-msubsup" id="MJXp-Span-1385"><span class="MJXp-mo" id="MJXp-Span-1386" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1387" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-1388" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1389">O</span><span class="MJXp-mo" id="MJXp-Span-1390" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1392" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1393" style="vertical-align: 0.5em;">6</span></span><span class="MJXp-mo" id="MJXp-Span-1394" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1395">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1396">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1397">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1398">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1399">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">x</span><span class="MJXp-msubsup" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1403" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1405">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1406">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">s</span><span class="MJXp-mo" id="MJXp-Span-1409">,</span><span class="MJXp-mn" id="MJXp-Span-1410">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1413">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1416">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">c</span><span class="MJXp-mrow" id="MJXp-Span-1418"><span class="MJXp-msubsup" id="MJXp-Span-1419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1421" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1423">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1424">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1426">s</span><span class="MJXp-mo" id="MJXp-Span-1427">,</span><span class="MJXp-mn" id="MJXp-Span-1428">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1433" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1435">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1437">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1438">s</span><span class="MJXp-mo" id="MJXp-Span-1439">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">n</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1441"><span class="MJXp-mn" id="MJXp-Span-1442">1</span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1444"><span class="MJXp-mn" id="MJXp-Span-1445" style="margin-right: 0.05em;">2</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1446" style="vertical-align: 0.5em;">4</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> I = I_ {Simps, 2n} - C_4 \ left (\ frac {h} {2} \ right) ^ 4 + O (h ^ 6) \ aprox I_ {Simps, 2n} - \ frac {I_ {Simps, 2n} -I_ {Simps, n}} {1-2 ^ 4} </script></p><br><p>  Si continúa, aparece la siguiente tabla: </p><br><table><thead><tr><th>  2 orden </th><th>  4 orden </th><th>  6 orden </th><th>  ... </th></tr></thead><tbody><tr><td>  <em>Yo</em> <sub>0,0</sub> </td><td></td><td></td></tr><tr><td>  <em>Yo</em> <sub>1,0</sub> </td><td>  <em>Yo</em> <sub>1,1</sub> </td><td></td></tr><tr><td>  <em>Yo</em> <sub>2.0</sub> </td><td>  <em>Yo</em> <sub>2.1</sub> </td><td>  <em>I</em> <sub>2.2</sub> </td></tr><tr><td>  ... </td><td>  ... </td><td>  ... </td></tr></tbody></table><br><p>  La primera columna contiene las integrales calculadas por el método trapezoidal.  Cuando se mueve desde la fila superior hacia abajo, la división del segmento se vuelve dos veces más pequeña, y cuando se mueve desde la columna izquierda hacia la derecha, el orden de aproximación de la integral aumenta (es decir, la segunda columna contiene las integrales por el método Simpson, etc.). </p><br><p>  Los elementos de la tabla, como se puede deducir de la expansión (5), están relacionados por la relación de recurrencia: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1447"><span class="MJXp-msubsup" id="MJXp-Span-1448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1450" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">i</span><span class="MJXp-mo" id="MJXp-Span-1452">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1453">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1454" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1456" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1457" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1458">i</span><span class="MJXp-mo" id="MJXp-Span-1459">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">j</span><span class="MJXp-mo" id="MJXp-Span-1461">−</span><span class="MJXp-mn" id="MJXp-Span-1462">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1464">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1465">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1466">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">c</span><span class="MJXp-mrow" id="MJXp-Span-1469"><span class="MJXp-msubsup" id="MJXp-Span-1470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1471" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1472" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">i</span><span class="MJXp-mo" id="MJXp-Span-1474">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1475">j</span><span class="MJXp-mo" id="MJXp-Span-1476">−</span><span class="MJXp-mn" id="MJXp-Span-1477">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1478" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1481" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">i</span><span class="MJXp-mo" id="MJXp-Span-1483">−</span><span class="MJXp-mn" id="MJXp-Span-1484">1</span><span class="MJXp-mo" id="MJXp-Span-1485">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">j</span><span class="MJXp-mo" id="MJXp-Span-1487">−</span><span class="MJXp-mn" id="MJXp-Span-1488">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1489"><span class="MJXp-mn" id="MJXp-Span-1490">1</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1492">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">t</span><span class="MJXp-mo" id="MJXp-Span-1497" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1498">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">c</span><span class="MJXp-mrow" id="MJXp-Span-1503"><span class="MJXp-msubsup" id="MJXp-Span-1504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1505" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1506" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1509"><span class="MJXp-msubsup" id="MJXp-Span-1510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1511" style="margin-right: 0.05em;">h</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1512" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1513">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">t</span><span class="MJXp-msubsup" id="MJXp-Span-1519"><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1521" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1525" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1526">i</span><span class="MJXp-mo" id="MJXp-Span-1527">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">j</span><span class="MJXp-mo" id="MJXp-Span-1529">−</span><span class="MJXp-mn" id="MJXp-Span-1530">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-mtext" id="MJXp-Span-1532">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1534">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1535">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1536">c</span><span class="MJXp-mrow" id="MJXp-Span-1537"><span class="MJXp-msubsup" id="MJXp-Span-1538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1540" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1541">i</span><span class="MJXp-mo" id="MJXp-Span-1542">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1543">j</span><span class="MJXp-mo" id="MJXp-Span-1544">−</span><span class="MJXp-mn" id="MJXp-Span-1545">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1549" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1550">i</span><span class="MJXp-mo" id="MJXp-Span-1551">−</span><span class="MJXp-mn" id="MJXp-Span-1552">1</span><span class="MJXp-mo" id="MJXp-Span-1553">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">j</span><span class="MJXp-mo" id="MJXp-Span-1555">−</span><span class="MJXp-mn" id="MJXp-Span-1556">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1557"><span class="MJXp-mn" id="MJXp-Span-1558">1</span><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1560"><span class="MJXp-mn" id="MJXp-Span-1561" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1562" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1563">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">j</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1565">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1566">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-1567">&nbsp;</span><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-1569">6</span><span class="MJXp-mo" id="MJXp-Span-1570" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> I_ {i, j} = I_ {i, j-1} - \ frac {I_ {i, j-1} -I_ {i-1, j-1}} {1- \ left (\ frac {h_ {ij}} {h_i} \ right) ^ 2} = I_ {i, j-1} - \ frac {I_ {i, j-1} -I_ {i-1, j-1}} {1-2 ^ {2j}} ~~~ (6) </script></p><br><p>  El error de la aproximación de la integral se puede estimar a partir de la diferencia de fórmulas de diferentes órdenes en una línea, es decir. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1571"><span class="MJXp-mtext" id="MJXp-Span-1572">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1576">t</span><span class="MJXp-msubsup" id="MJXp-Span-1577"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1579" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1580">i</span><span class="MJXp-mo" id="MJXp-Span-1581">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1582">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1583">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1585">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1586">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588">x</span><span class="MJXp-msubsup" id="MJXp-Span-1589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1590" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1591" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1592">i</span><span class="MJXp-mo" id="MJXp-Span-1593">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-1596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1598" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">i</span><span class="MJXp-mo" id="MJXp-Span-1600">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">j</span><span class="MJXp-mo" id="MJXp-Span-1602">−</span><span class="MJXp-mn" id="MJXp-Span-1603">1</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-41"> \ Delta_ {i, j} \ aprox I_ {i, j} - I_ {i, j-1} </script></p><br><p>  El uso de la extrapolación de Richardson junto con la integración trapezoidal se llama <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">método Romberg</a> .  Si el método Simpson toma en cuenta los dos valores anteriores por el método trapezoidal, el método Romberg usa todos los valores calculados previamente por el método trapezoidal para obtener una estimación más precisa de la integral. </p><br><div class="spoiler">  <b class="spoiler_title">Implementación</b> <div class="spoiler_text"><p>  Se agrega un método adicional a la clase Quadrature </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    """</span></span> __sum = <span class="hljs-number"><span class="hljs-number">0.0</span></span> __nseg = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-comment"><span class="hljs-comment">#    __ncalls = 0 #      def __restart(func, x0, x1, nseg0, reset_calls = True): """    .       """ if reset_calls: Quadrature.__ncalls = 0 Quadrature.__nseg = nseg0 #          nseg0  Quadrature.__sum = 0.5 * (func(x0) + func(x1)) dx = 1.0 * (x1 - x0) / nseg0 for i in range(1, nseg0): Quadrature.__sum += func(x0 + i * dx) Quadrature.__ncalls += 1 + nseg0 return Quadrature.__sum * dx def __double_nseg(func, x0, x1): """  .       """ nseg = Quadrature.__nseg dx = (x1 - x0) / nseg x = x0 + 0.5 * dx i = 0 AddedSum = 0.0 for i in range(nseg): AddedSum += func(x + i * dx) Quadrature.__sum += AddedSum Quadrature.__nseg *= 2 Quadrature.__ncalls += nseg return Quadrature.__sum * 0.5 * dx def romberg(func, x0, x1, rtol = 1e-10, nseg0 = 1, maxcol = 5, reset_calls = True): """   nseg0 -     maxcol -   """ #   Itable = [[Quadrature.__restart(func, x0, x1, nseg0, reset_calls)]] i = 0 maxcol = max(0, maxcol) ans = Itable[i][i] error_est = max(1, abs(ans)) while (error_est &gt; abs(rtol * ans)): old_ans = ans i += 1 d = 4.0 ans_col = min(i, maxcol) Itable.append([Quadrature.__double_nseg(func, x0, x1)] * (ans_col + 1)) for j in range(0, ans_col): diff = Itable[i][j] - Itable[i - 1][j] Itable[i][j + 1] = Itable[i][j] + diff / (d - 1.0) d *= 4.0 ans = Itable[i][ans_col] if (maxcol &lt;= 1): #       error_est = abs(ans - Itable[i - 1][-1]) elif (i &gt; maxcol): error_est = abs(ans - Itable[i][min(i - maxcol - 1, maxcol - 1)]) else: error_est = abs(ans - Itable[i - 1][i - 1]) print("Total function calls: " + str(Quadrature.__ncalls)) return ans</span></span></code> </pre> </div></div><br><p>  Veamos cómo funciona la aproximación de alto orden: </p><br><pre> <code class="hljs lua">&gt;&gt;&gt; Quadrature.romberg(lambda x: <span class="hljs-number"><span class="hljs-number">2</span></span> * x + <span class="hljs-number"><span class="hljs-number">1</span></span> / <span class="hljs-built_in"><span class="hljs-built_in">math</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(x + <span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">16</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-9</span></span>, maxcol = <span class="hljs-number"><span class="hljs-number">0</span></span>) #  Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 65537 4.250000001385811 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lambda x: 2 * x + 1 / math.sqrt(x + 1/16)</span></span></span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-9</span></span>, maxcol = <span class="hljs-number"><span class="hljs-number">1</span></span>) #  Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 2049 4.2500000000490985 &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature.romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lambda x: 2 * x + 1 / math.sqrt(x + 1/16)</span></span></span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.5</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1e-9</span></span>, maxcol = <span class="hljs-number"><span class="hljs-number">4</span></span>) Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: 257 4.250000001644076</span></span></code> </pre> <br><p>  Estamos convencidos de que, en comparación con el método de la parábola, el número de llamadas al integrando ha disminuido otras 8 veces.  Con un aumento adicional en la precisión requerida, las ventajas del método Romberg se vuelven aún más pronunciadas: <br><img src="https://habrastorage.org/webt/pw/d8/3r/pwd83rerz_10ju9x5jia4kpt9bm.png" alt="imagen"></p><br><h3 id="nekotorye-zamechaniya">  Algunas notas </h3><br><p>  <strong>Observación 1. El</strong> número de llamadas a funciones en estos problemas caracteriza el número de sumas al calcular la integral.  Reducir el número de cálculos del integrando no solo ahorra recursos informáticos (aunque también es el caso de una implementación más optimizada), sino que también reduce el efecto de los errores de redondeo en el resultado.  Entonces, cuando intenta calcular la integral de la función de prueba, el método trapezoidal se congela cuando intenta alcanzar una precisión relativa de 5 × <sup>10-15</sup> , el método de parábola - con la precisión deseada de 2 × <sup>10-16</sup> (que es el límite para números de doble precisión), y el método Romberg hace frente al cálculo prueba integral hasta la precisión de la máquina (con un error de bit bajo)  Es decir, no solo se aumenta la precisión de la integración para un número dado de llamadas de función, sino también la precisión máxima alcanzable del cálculo de la integral. </p><br><p>  <strong>Observación 2.</strong> Si el método converge cuando se especifica una cierta precisión, esto no significa que el valor calculado de la integral tenga la misma precisión.  En primer lugar, esto se aplica a los casos en que el error especificado está cerca de la precisión de la máquina. </p><br><p>  <strong>Observación 3.</strong> Aunque el método Romberg para una serie de funciones funciona de una manera casi mágica, se supone que el integrando tiene derivados acotados de órdenes altas.  Esto significa que para funciones con torceduras o interrupciones, puede resultar peor que los métodos simples.  Por ejemplo, integre <em>f</em> ( <em>x</em> ) = |  <em>x</em> |: </p><br><pre> <code class="hljs powershell">&gt;&gt;&gt; Quadrature.trapezoid(abs, <span class="hljs-literal"><span class="hljs-literal">-1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, rtol=<span class="hljs-number"><span class="hljs-number">1</span></span>e<span class="hljs-literal"><span class="hljs-literal">-5</span></span>) Total <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">9</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">5</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpson</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(abs, -1, 3, rtol=1e-5)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Total</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">17</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">5</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(abs, -1, 3, rtol=1e-5, maxcol = 2)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Total</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">17</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">5</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(abs, -1, 3, rtol=1e-5, maxcol = 3)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Total</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">5</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">0</span></span></span><span class="hljs-function"> &gt;&gt;&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Quadrature</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">romberg</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(abs, -1, 3, rtol=1e-5, maxcol = 4)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Total</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calls</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">33</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">5</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">000001383269357</span></span></span></span></code> </pre> <br><p>  <strong>Observación 4.</strong> Puede parecer que cuanto mayor sea el orden de aproximación, mejor.  De hecho, es mejor limitar el número de columnas en la tabla de Romberg a 4-6.  Para entender esto, mira la fórmula (6).  El segundo término es la diferencia de dos elementos consecutivos de la <em>j</em> -1ª columna dividida por aproximadamente 4 <sup><em>j</em></sup> .  Porque  la <em>j</em> -ésima columna contiene aproximaciones de una integral de orden 2 <em>j</em> , entonces la diferencia en sí misma es del orden de (1 / <em>n <sub>i</sub></em> ) <sup>2 <em>j</em></sup> ~ 4 <sup>- <em>ij</em></sup> .  Teniendo en cuenta la división, <sup><sup>se</sup></sup> obtiene ~ 4 <sup>- ( <em>i</em> +1) <em>j</em></sup> ~ 4 <sup>- <em>j</em> <sup>2</sup></sup> .  Es decir  para <em>j</em> ~ 7, el segundo término en (6) pierde precisión después de la reducción de las órdenes al agregar números de punto flotante, y un aumento en el orden de aproximación puede conducir a la acumulación de errores de redondeo. </p><br><p>  <strong>Observación 5.</strong> Las partes interesadas pueden usar los métodos descritos para encontrar la integral por interés. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1604"><span class="MJXp-mtext" id="MJXp-Span-1605">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1607">n</span><span class="MJXp-msubsup" id="MJXp-Span-1608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1609" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1611">1</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1610">0</span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-1612">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1615">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1616">t</span><span class="MJXp-mrow" id="MJXp-Span-1617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1618">x</span></span><span class="MJXp-mtext" id="MJXp-Span-1619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">n</span><span class="MJXp-mrow" id="MJXp-Span-1623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624">x</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> \ int_0 ^ 1 \ sqrt {x} \ sin {x} dx </script>  y equivalente a él <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1627"><span class="MJXp-mtext" id="MJXp-Span-1628">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">n</span><span class="MJXp-msubsup" id="MJXp-Span-1631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1632" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-1634">1</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1633">0</span></span></span></span></span></span><span class="MJXp-mn" id="MJXp-Span-1635">2</span><span class="MJXp-msubsup" id="MJXp-Span-1636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1638" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-1639">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">n</span><span class="MJXp-mrow" id="MJXp-Span-1643"><span class="MJXp-msubsup" id="MJXp-Span-1644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1646" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">t</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> \ int_0 ^ 1 2t ^ 2 \ sin {t ^ 2} dt </script>  .  Como dicen, siente la diferencia. </p><br><h3 id="zaklyuchenie">  Conclusión </h3><br><p>  Se presenta la descripción e implementación de los métodos básicos de integración numérica de funciones en una cuadrícula uniforme.  Se demuestra cómo, utilizando una modificación simple, obtener la clase de fórmulas en cuadratura utilizando el método de Romberg sobre la base del método trapezoidal, que acelera significativamente la convergencia de la integración numérica.  El método funciona bien para integrar funciones "ordinarias", es decir  variando débilmente en el intervalo de integración, no teniendo singularidades en los bordes del segmento (ver Observación 5), oscilaciones rápidas, etc. </p><br><p>                ( [3] —     C++). </p><br><h3 id="literatura">  </h3><br><ol><li> <em>.. , .. .</em>  . .: . 1989. </li><li> <em>J. Stoer, R. Bulirsch.</em> Introduction to Numerical Analysis: Second Edition. Springer-Verlag New York. 1993. </li><li> <em>WH Press, SA Teukolsky, WT Vetterling, BP Flannery.</em> Numerical Recipes: Third Edition. Cambridge University Press. 2007. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es420867/">https://habr.com/ru/post/es420867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es420857/index.html">Roaming Wi-Fi sin interrupciones: teoría en la práctica</a></li>
<li><a href="../es420859/index.html">A la pregunta de Wirth y cadenas</a></li>
<li><a href="../es420861/index.html">Preparándose para C ++ 20. Estudio de caso de Coroutines TS Real</a></li>
<li><a href="../es420863/index.html">Como hicimos el primer teléfono inteligente ruso, continuó</a></li>
<li><a href="../es420865/index.html">El principio de menor acción. Parte 1</a></li>
<li><a href="../es420869/index.html">Evacuación, HAMR y MAMR: tres formas de maximizar la capacidad de los discos duros modernos</a></li>
<li><a href="../es420871/index.html">Cómo reubicamos el estudio web en Bali</a></li>
<li><a href="../es420873/index.html">Una búsqueda que nadie puede pasar</a></li>
<li><a href="../es420875/index.html">¿Por qué necesito una impresora 3D?</a></li>
<li><a href="../es420877/index.html">YouDrive introdujo el registro a través del pasaporte Telegram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>