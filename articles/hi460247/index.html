<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯзЬЁЯП╜ ЁЯСйЁЯП╛тАНЁЯПл ЁЯзХЁЯП╜ рдИрдПрд▓рдПрдл рдХреЗ рд▓рд┐рдП рд╡реНрдпрдВрдЬрди рд╡рд┐рдзрд┐ ЁЯМА ЁЯТ┤ тмЬя╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд░реВрд╕реА рдореЗрдВ, рдПрд▓рдПрд▓рдПрдл рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рд╣реИ (рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдФрд░ рд▓рд┐рдВрдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдкреНрд░рд╛рд░реВрдк - рд▓рд┐рдирдХреНрд╕ рдФрд░ рдХрдИ рдпреВрдирд┐рдХреНрд╕ рдкреНрд░рдгрд╛рд▓рд┐...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдИрдПрд▓рдПрдл рдХреЗ рд▓рд┐рдП рд╡реНрдпрдВрдЬрди рд╡рд┐рдзрд┐</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/inforion/blog/460247/"><p><img src="https://habrastorage.org/webt/xk/e_/v6/xke_v6gzyavn2y7zh5skzlm3op0.jpeg" alt="рдЫрд╡рд┐"></p><br><p>  рд░реВрд╕реА рдореЗрдВ, рдПрд▓рдПрд▓рдПрдл рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рд╣реИ (рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдФрд░ рд▓рд┐рдВрдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдкреНрд░рд╛рд░реВрдк - рд▓рд┐рдирдХреНрд╕ рдФрд░ рдХрдИ рдпреВрдирд┐рдХреНрд╕ рдкреНрд░рдгрд╛рд▓рд┐рдпреЛрдВ рдХреА рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП рдореБрдЦреНрдп рдкреНрд░рд╛рд░реВрдк)ред  рд╣рдо рдХрд▓реНрдкрд┐рдд рдмреМрдиреЗ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд╕рднреА рд╕рдВрднрд╛рд╡рд┐рдд рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдХрд╡рд░ рдХрд░рдиреЗ рдХрд╛ рджрд╛рд╡рд╛ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдЙрдореНрдореАрдж рд╣реИ рдХрд┐ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрджрд░реНрдн рдкреБрд╕реНрддрдХ рдФрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдорд░ рдФрд░ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░реЛрдВ рдХреЗ рд▓рд┐рдП рд╡реНрдпрдВрдЬрдиреЛрдВ рдХреЗ рд╕рдВрдЧреНрд░рд╣ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧреАред </p><br><p>  рдпрд╣ рд╕рдордЭрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдмреБрдирд┐рдпрд╛рджреА рд╕реНрддрд░ рдкрд░ рдкрд╛рдардХ рдИрдПрд▓рдПрдл рдкреНрд░рд╛рд░реВрдк рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рд╣реИ (рдЕрдиреНрдпрдерд╛, рд╣рдо рд▓реЗрдЦреЛрдВ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдФрд░ рд▓рд┐рдВрдХ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдкреНрд░рд╛рд░реВрдк 101 рдХреА</a> рдЕрдиреБрд╢рдВрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ)ред </p><br><p>  рдХрдЯ рдХреЗ рддрд╣рдд рдХрд╛рдо рдХреЗ рд▓рд┐рдП рдЙрдкрдХрд░рдг рд╕реВрдЪреАрдмрджреНрдз рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ, рдореЗрдЯрд╛-рд╕реВрдЪрдирд╛ рдкрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд░реНрдгрд┐рдд рддрдХрдиреАрдХреЛрдВ, рд╕рдВрд╢реЛрдзрди, рд╕рддреНрдпрд╛рдкрди рдФрд░ <del>  рдкреНрд░рдЬрдирди </del>  рдХрд▓реНрдкрд┐рдд рдмреМрдиреЗ, рд╕рд╛рде рд╣реА рдЙрдкрдпреЛрдЧреА рд╕рд╛рдордЧреНрд░рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдВрдХ рдмрдирд╛рдирд╛ред </p><a name="habracut"></a><br><blockquote>  "рдореИрдВ рднреА рдПрдХ рдпреЛрдЧрд┐рдиреА рд╣реВрдБ ... рд▓рд╛рд▓ рд░рдВрдЧ рдореЗрдВ рдиреАрд▓рд╛ ... рдмрд╣реБрдд рд▓рд╛рд▓ рд░реЛрдЧреА рд╣реИрдВ ... рд▓рд╛рд▓ рд░рдВрдЧ рдореЗрдВ рдиреАрд▓рд╛ ... рдФрд░ рд╣рдо рд▓рд╛рд▓ рд╣реИрдВ ... рд▓рд╛рд▓ рд░рдВрдЧ рдореЗрдВ рдиреАрд▓рд╛ ... рдЬрд╛рджреВ рд╕реЗ рдХреЗрд╡рд▓ рдкрд░реЗрд╢рд╛рдирд┐рдпрд╛рдБ рд╣реИрдВ ... <br>  (c) рдмреЗрди рдФрд░ рд╣реЛрд▓реА рдХреЗ рд▓рд┐рдЯрд┐рд▓ рдХрд┐рдВрдЧрдбрдо </blockquote><br><h1 id="instrumenty">  рдЙрдкрдХрд░рдг </h1><br><p>  рдЬреНрдпрд╛рджрд╛рддрд░ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдЙрджрд╛рд╣рд░рдг рд▓рд┐рдирдХреНрд╕ рдФрд░ рд╡рд┐рдВрдбреЛрдЬ рджреЛрдиреЛрдВ рдкрд░ рдЪрд▓рд╛рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рд╡реНрдпрдВрдЬрдиреЛрдВ рдореЗрдВ рд╣рдо рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ: </p><br><ul><li>  рдмрд┐рдиреНрдпреВрдЯрд┐рд▓реНрд╕ рд╕реЗрдЯ (objcopy, objdump, readelf, strip) рд╕реЗ рдЙрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">radare2 рдврд╛рдВрдЪрд╛</a> ; </li><li>  рдлрд╝рд╛рдЗрд▓ рдЯреЗрдореНрдкрд▓реЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рдХреЗ рд╕рд╛рде рд╣реЗрдХреНрд╕ рд╕рдВрдкрд╛рджрдХ (рдЙрджрд╛рд╣рд░рдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">010Editor</a> рджрд┐рдЦрд╛рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЖрдк рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдлреНрд░реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡реЗрд▓реЗрд╕</a> ); </li><li>  рдкрд╛рдпрдерди рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">LIEF</a> рдкреБрд╕реНрддрдХрд╛рд▓рдп; </li><li>  рдЕрдиреНрдп рдЙрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ (рд▓рд┐рдВрдХ рдиреБрд╕реНрдЦрд╛ рдореЗрдВ рд╣реИрдВ)ред </li></ul><br><h1 id="testovye-elfy">  рдЯреЗрд╕реНрдЯ рдХрд▓реНрдкрд┐рдд рдмреМрдиреЗ </h1><br><p>  "рдкреНрд░рд╛рдпреЛрдЧрд┐рдХ" рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдо <em>рд╕рд░рд▓</em> рдИрдПрд▓рдПрдл рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреНрд░реИрдХрдореНрд╕</a> рдкрд░ рдкреЙрдХреЗрдореНрд╕ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреАрдЖрдИрдЖрдИрдПрд╕рдПрдорд╡рд╛рдИрдПрдлрдПрд╡реА рдХрд╛рд░реНрдп</a> рд╕реЗ рдХрд░реЗрдВрдЧреЗ, рд▓реЗрдХрд┐рди "рдПрд▓рд╡реЗрди" рдкрд░рд┐рд╡рд╛рд░ рдХрд╛ рдХреЛрдИ рднреА рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХрд░реЗрдЧрд╛ред  рдпрджрд┐ рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЗ рд╕рд╛рде рддреИрдпрд╛рд░ рдлрд╝рд╛рдЗрд▓ рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдбреЛрдореЗрди рдореЗрдВ рдирд╣реАрдВ рдорд┐рд▓реА рдереА, рддреЛ рдЗрд╕ рддрд░рд╣ рдХреА рдпреЛрдЧрд┐рдиреА рдмрдирд╛рдиреЗ рдХреА рдПрдХ рд╡рд┐рдзрд┐ рджреА рдЬрд╛рдПрдЧреАред </p><br><p>  рд▓рд┐рдВрдХ рдкрд░ рдореБрдлреНрдд рдХрд▓реНрдкрд┐рдд рдмреМрдиреЗ рднреА рдорд┐рд▓ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд┐рднрд┐рдиреНрди рдкреНрд▓реЗрдЯрдлрд╛рд░реНрдореЛрдВ рдХреЗ рд▓рд┐рдП рдХрд▓реНрдкрд┐рдд рдмреМрдиреЗ рдХреЗ рдЙрджрд╛рд╣рд░рдг</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░рдбрд╛рд░ 2 рдХреЗ рд▓рд┐рдП рдкрд░реАрдХреНрд╖рдг рдХрд▓реНрдкрд┐рдд рдмреМрдиреЗ</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬреАрдердм рдкрд░ рдПрд▓реНрдлрд╣реИрдХреНрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛</a> - рд╡рд┐рднрд┐рдиреНрди рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЗ рд╕рд╛рде рдЫреЛрдЯреЗ рдХрд▓реНрдкрд┐рдд рдмреМрдиреЗ рдХрд╛ рдЪрдпрди; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпреВрдирд┐рдХреНрд╕ / рд▓рд┐рдирдХреНрд╕ рдХреЗ рд▓рд┐рдП рджрд░рд╛рд░</a> - рд▓реЗрдХрд┐рди рдзреНрдпрд╛рди рд░рдЦреЗрдВ рдХрд┐ рдореБрд╢реНрдХрд┐рд▓ рдирдореВрдиреЗ рдпрд╣рд╛рдВ рдЖ рд╕рдХрддреЗ рд╣реИрдВред </li></ul><br><h1 id="chtenie-poluchenie-informacii">  рдкрдврд╝рдирд╛, рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ </h1><br><h2 id="tip-fayla-zagolovok-sekcii">  рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░, рд╢реАрд░реНрд╖рдХ, рдЕрдиреБрднрд╛рдЧ </h2><br><p>  рдХрд╛рд░реНрдп рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдмреНрдпрд╛рдЬ рдХреА рд╣реЛ рд╕рдХрддреА рд╣реИ: </p><br><ul><li>  рдлрд╝рд╛рдЗрд▓ рдкреНрд░рдХрд╛рд░ (рдбрд╛рдпрди - рдкреБрд╕реНрддрдХрд╛рд▓рдп, EXEC - рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп, RELOC - рд▓рд┐рдВрдХреЗрдмрд▓); </li><li>  рд▓рдХреНрд╖реНрдп рд╡рд╛рд╕реНрддреБрдХрд▓рд╛ (E_MACHINE - x86_64, x86, ARM, рдЖрджрд┐); </li><li>  рдЖрд╡реЗрджрди рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрд┐рдВрджреБ (рдПрдВрдЯреНрд░реА рдкреЙрдЗрдВрдЯ); </li><li>  рдЕрдиреБрднрд╛рдЧ рдХреА рдЬрд╛рдирдХрд╛рд░реАред </li></ul><br><h3 id="010editor">  010Editor </h3><br><p>  HEX рд╕рдВрдкрд╛рджрдХ 010Editor рдПрдХ рдЯреЗрдореНрдкрд▓реЗрдЯ рд╕рд┐рд╕реНрдЯрдо рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  ELF рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд▓рд┐рдП, рдЯреЗрдореНрдкреНрд▓реЗрдЯ рдХреЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рд╡рд┐рдЪрд┐рддреНрд░ рд░реВрдк рд╕реЗ рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ, <em>ELF.bt</em> рдФрд░ <em>рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп</em> рд╢реНрд░реЗрдгреА (рдореЗрдиреВ рдЯреЗрдореНрдкреНрд▓реЗрдЯ - рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп) рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИред <br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ (рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдмрд┐рдВрджреБ) (рдлрд╝рд╛рдЗрд▓ рд╢реАрд░реНрд╖рд▓реЗрдЦ рдореЗрдВ рджрд░реНрдЬ) рд╣реЛ рд╕рдХрддрд╛ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/uz/f4/i6/uzf4i6yhfy9epat61pd4uolvegw.png" alt="рдЫрд╡рд┐"></p><br><h3 id="readelf">  readelf </h3><br><p>  рдкрдврд╝рдиреЗ рдпреЛрдЧреНрдп рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЛ рдИрдПрд▓рдПрдл рдлрд╝рд╛рдЗрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдорд╛рдирдХ рдорд╛рдирд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><ul><li>  рдлрд╝рд╛рдЗрд▓ рд╣реЗрдбрд░ рдкрдврд╝реЗрдВ: <br><pre><code class="bash hljs">$ readelf -h simple</code> </pre> </li></ul><br><div class="spoiler">  <b class="spoiler_title">рдЯреАрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо</b> <div class="spoiler_text"><pre> <code class="markdown hljs">ELF Header: Magic: 7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 Class: ELF64 Data: 2's complement, little endian Version: 1 (current) OS/ABI: UNIX - System V ABI Version: 0 Type: DYN (Shared object file) Machine: Advanced Micro Devices X86-64 Version: 0x1 Entry point address: 0x1070 Start of program headers: 64 (bytes into file) Start of section headers: 14800 (bytes into file) Flags: 0x0 Size of this header: 64 (bytes) Size of program headers: 56 (bytes) Number of program headers: 11 Size of section headers: 64 (bytes) Number of section headers: 30 Section header string table index: 29</code> </pre> </div></div><br><ul><li>  рдЦрдВрдбреЛрдВ рдФрд░ рд╡рд░реНрдЧреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВ: <br><pre> <code class="bash hljs">$ readelf -l -W simple</code> </pre> </li></ul><br><div class="spoiler">  <b class="spoiler_title">рдЯреАрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо</b> <div class="spoiler_text"><p>  рдкрдардиреАрдпрддрд╛ рдХреЗ рд▓рд┐рдП, рдкрддреЗ 32-рдмрд┐рдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ: </p><br><pre> <code class="markdown hljs">Elf file type is DYN (Shared object file) Entry point 0x1070 There are 11 program headers, starting at offset 64 Program Headers: Type Offset VirtAddr PhysAddr FileSiz MemSiz Flg Align PHDR 0x000040 0x00000040 0x00000040 0x000268 0x000268 R 0x8 INTERP 0x0002a8 0x000002a8 0x000002a8 0x00001c 0x00001c R 0x1 [Requesting program interpreter: /lib64/ld-linux-x86-64.so.2] LOAD 0x000000 0x00000000 0x00000000 0x0005f8 0x0005f8 R 0x1000 LOAD 0x001000 0x00001000 0x00001000 0x00026d 0x00026d RE 0x1000 LOAD 0x002000 0x00002000 0x00002000 0x0001b8 0x0001b8 R 0x1000 LOAD 0x002de8 0x00003de8 0x00003de8 0x000258 0x000260 RW 0x1000 DYNAMIC 0x002df8 0x00003df8 0x00003df8 0x0001e0 0x0001e0 RW 0x8 NOTE 0x0002c4 0x000002c4 0x000002c4 0x000044 0x000044 R 0x4 GNU<span class="hljs-emphasis"><span class="hljs-emphasis">_EH_</span></span>FRAME 0x002070 0x00002070 0x00002070 0x00003c 0x00003c R 0x4 GNU<span class="hljs-emphasis"><span class="hljs-emphasis">_STACK 0x000000 0x00000000 0x00000000 0x000000 0x000000 RW 0x10 GNU_</span></span>RELRO 0x002de8 0x00003de8 0x00003de8 0x000218 0x000218 R 0x1 Section to Segment mapping: Segment Sections... 00 01 .interp 02 .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version<span class="hljs-emphasis"><span class="hljs-emphasis">_r .rela.dyn .rela.plt 03 .init .plt .plt.got .text .fini 04 .rodata .eh_</span></span>frame<span class="hljs-emphasis"><span class="hljs-emphasis">_hdr .eh_</span></span>frame 05 .init<span class="hljs-emphasis"><span class="hljs-emphasis">_array .fini_</span></span>array .dynamic .got .got.plt .data .bss 06 .dynamic 07 .note.ABI-tag .note.gnu.build-id 08 .eh<span class="hljs-emphasis"><span class="hljs-emphasis">_frame_</span></span>hdr 09 10 .init<span class="hljs-emphasis"><span class="hljs-emphasis">_array .fini_</span></span>array .dynamic .got</code> </pre> </div></div><br><ul><li>  рдЕрдиреБрднрд╛рдЧ рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝реЗрдВ: <br><pre> <code class="bash hljs">$ readelf -S -W simple</code> </pre> </li></ul><br><div class="spoiler">  <b class="spoiler_title">рдЯреАрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо</b> <div class="spoiler_text"><p>  рдкрдардиреАрдпрддрд╛ рдХреЗ рд▓рд┐рдП, рдкрддреЗ 32-рдмрд┐рдЯ рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рд╣реЛ рдЬрд╛рддреЗ рд╣реИрдВ: </p><br><pre> <code class="markdown hljs">There are 30 section headers, starting at offset 0x39d0: Section Headers: [Nr] Name Type Address Off Size ES Flg Lk Inf Al [ 0] NULL 00000000 000000 000000 00 0 0 0 [ 1] .interp PROGBITS 000002a8 0002a8 00001c 00 A 0 0 1 [ 2] .note.ABI-tag NOTE 000002c4 0002c4 000020 00 A 0 0 4 [ 3] .note.gnu.build-id NOTE 000002e4 0002e4 000024 00 A 0 0 4 [ 4] .gnu.hash GNU<span class="hljs-emphasis"><span class="hljs-emphasis">_HASH 00000308 000308 000024 00 A 5 0 8 [ 5] .dynsym DYNSYM 00000330 000330 0000d8 18 A 6 1 8 [ 6] .dynstr STRTAB 00000408 000408 0000a2 00 A 0 0 1 [ 7] .gnu.version VERSYM 000004aa 0004aa 000012 02 A 5 0 2 [ 8] .gnu.version_</span></span>r VERNEED 000004c0 0004c0 000030 00 A 6 1 8 [ 9] .rela.dyn RELA 000004f0 0004f0 0000c0 18 A 5 0 8 [10] .rela.plt RELA 000005b0 0005b0 000048 18 AI 5 23 8 [11] .init PROGBITS 00001000 001000 000017 00 AX 0 0 4 [12] .plt PROGBITS 00001020 001020 000040 10 AX 0 0 16 [13] .plt.got PROGBITS 00001060 001060 000008 08 AX 0 0 8 [14] .text PROGBITS 00001070 001070 0001f2 00 AX 0 0 16 [15] .fini PROGBITS 00001264 001264 000009 00 AX 0 0 4 [16] .rodata PROGBITS 00002000 002000 000070 00 A 0 0 8 [17] .eh<span class="hljs-emphasis"><span class="hljs-emphasis">_frame_</span></span>hdr PROGBITS 00002070 002070 00003c 00 A 0 0 4 [18] .eh<span class="hljs-emphasis"><span class="hljs-emphasis">_frame PROGBITS 000020b0 0020b0 000108 00 A 0 0 8 [19] .init_</span></span>array INIT<span class="hljs-emphasis"><span class="hljs-emphasis">_ARRAY 00003de8 002de8 000008 08 WA 0 0 8 [20] .fini_</span></span>array FINI_ARRAY 00003df0 002df0 000008 08 WA 0 0 8 [21] .dynamic DYNAMIC 00003df8 002df8 0001e0 10 WA 6 0 8 [22] .got PROGBITS 00003fd8 002fd8 000028 08 WA 0 0 8 [23] .got.plt PROGBITS 00004000 003000 000030 08 WA 0 0 8 [24] .data PROGBITS 00004030 003030 000010 00 WA 0 0 8 [25] .bss NOBITS 00004040 003040 000008 00 WA 0 0 1 [26] .comment PROGBITS 00000000 003040 00001c 01 MS 0 0 1 [27] .symtab SYMTAB 00000000 003060 000630 18 28 44 8 [28] .strtab STRTAB 00000000 003690 000232 00 0 0 1 [29] .shstrtab STRTAB 00000000 0038c2 000107 00 0 0 1 Key to Flags: W (write), A (alloc), X (execute), M (merge), S (strings), l (large) I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown) O (extra OS processing required) o (OS specific), p (processor specific)</code> </pre> </div></div><br><ul><li>  рдкрдврд╝реЗрдВ рдкреНрд░рддреАрдХ рд╕реВрдЪрдирд╛: <br><pre> <code class="bash hljs">$ readelf -s -W simple</code> </pre> </li></ul><br><div class="spoiler">  <b class="spoiler_title">рдЯреАрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо</b> <div class="spoiler_text"><p>  рдЖрдЙрдЯрдкреБрдЯ рдкрдардиреАрдпрддрд╛ рдХреЗ рд▓рд┐рдП рдЫреЛрдЯрд╛ рд╣реИ: </p><br><pre> <code class="markdown hljs">Symbol table '.dynsym' contains 9 entries: Num: Value Size Type Bind Vis Ndx Name 0: 00000000 0 NOTYPE LOCAL DEFAULT UND 1: 00000000 0 NOTYPE WEAK DEFAULT UND <span class="hljs-emphasis"><span class="hljs-emphasis">_ITM_</span></span>deregisterTMCloneTable 2: 00000000 0 FUNC GLOBAL DEFAULT UND puts@GLIBC<span class="hljs-emphasis"><span class="hljs-emphasis">_2.2.5 (2) 3: 00000000 0 FUNC GLOBAL DEFAULT UND printf@GLIBC_</span></span>2.2.5 (2) 4: 00000000 0 FUNC GLOBAL DEFAULT UND <span class="hljs-strong"><span class="hljs-strong">__libc_start_main@GLIBC_2.2.5 (2) 5: 00000000 0 NOTYPE WEAK DEFAULT UND __</span></span>gmon<span class="hljs-emphasis"><span class="hljs-emphasis">_start_</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_ 6: 00000000 0 FUNC GLOBAL DEFAULT UND _</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_isoc99_</span></span>scanf@GLIBC<span class="hljs-emphasis"><span class="hljs-emphasis">_2.7 (3) 7: 00000000 0 NOTYPE WEAK DEFAULT UND _</span></span>ITM<span class="hljs-emphasis"><span class="hljs-emphasis">_registerTMCloneTable 8: 00000000 0 FUNC WEAK DEFAULT UND _</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_cxa_</span></span>finalize@GLIBC<span class="hljs-emphasis"><span class="hljs-emphasis">_2.2.5 (2) Symbol table '.symtab' contains 66 entries: Num: Value Size Type Bind Vis Ndx Name 0: 00000000 0 NOTYPE LOCAL DEFAULT UND 1: 000002a8 0 SECTION LOCAL DEFAULT 1 2: 000002c4 0 SECTION LOCAL DEFAULT 2 3: 000002e4 0 SECTION LOCAL DEFAULT 3 4: 00000308 0 SECTION LOCAL DEFAULT 4 5: 00000330 0 SECTION LOCAL DEFAULT 5 6: 00000408 0 SECTION LOCAL DEFAULT 6 7: 000004aa 0 SECTION LOCAL DEFAULT 7 .... 26: 00000000 0 SECTION LOCAL DEFAULT 26 27: 00000000 0 FILE LOCAL DEFAULT ABS crtstuff.c 28: 000010a0 0 FUNC LOCAL DEFAULT 14 deregister_</span></span>tm<span class="hljs-emphasis"><span class="hljs-emphasis">_clones 29: 000010d0 0 FUNC LOCAL DEFAULT 14 register_</span></span>tm<span class="hljs-emphasis"><span class="hljs-emphasis">_clones 30: 00001110 0 FUNC LOCAL DEFAULT 14 _</span></span><span class="hljs-emphasis"><span class="hljs-emphasis">_do_</span></span>global<span class="hljs-emphasis"><span class="hljs-emphasis">_dtors_</span></span>aux 31: 00004040 1 OBJECT LOCAL DEFAULT 25 completed.7389 ....</code> </pre> </div></div><br><p>  рдХрдВрд╕реЛрд▓ рдЖрдЙрдЯрдкреБрдЯ (рдбрд┐рдлрд╝реЙрд▓реНрдЯ, 80 рд╡рд░реНрдг) рдХреА рдЪреМрдбрд╝рд╛рдИ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП <code>-W</code> рд╡рд┐рдХрд▓реНрдк рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред </p><br><h3 id="lief">  рд░рд╛рд╣рдд </h3><br><p>  рдЖрдк рдкрд╛рдпрдерди рдХреЛрдб рдФрд░ LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╣реЗрдбрд░ рдФрд░ рд╕реЗрдХреНрд╢рди рдХреА рдЬрд╛рдирдХрд╛рд░реА рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ (рдХреЗрд╡рд▓ рдкрд╛рдпрдерди рдХреЗ рд▓рд┐рдП рдПрдХ рдПрдкреАрдЖрдИ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ): </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"simple.elf"</span></span>) header = binary.header print(<span class="hljs-string"><span class="hljs-string">"Entry point: %08x"</span></span> % header.entrypoint) print(<span class="hljs-string"><span class="hljs-string">"Architecture: "</span></span>, header.machine_type) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> section <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> binary.sections: print(<span class="hljs-string"><span class="hljs-string">"Section %s - size: %s bytes"</span></span> % (section.name, section.size)</code> </pre> <br><h2 id="informaciya-o-kompilyatore">  рд╕рдВрдХрд▓рдХ рдЬрд╛рдирдХрд╛рд░реА </h2><br><p>  рдХрдВрдкрд╛рдЗрд▓рд░ рдФрд░ рдмрд┐рд▓реНрдб рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рд▓рд┐рдП, <code>.comment</code> рдФрд░ <code>.note</code> ред </p><br><h3 id="objdump">  objdump </h3><br><pre> <code class="bash hljs">$ objdump -s --section .comment simple</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдЯреАрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо</b> <div class="spoiler_text"><pre> <code class="markdown hljs">simple: file format elf64-x86-64 Contents of section .comment: 0000 4743433a 20284465 6269616e 20382e32 GCC: (Debian 8.2 0010 2e302d39 2920382e 322e3000 .0-9) 8.2.0.</code> </pre> </div></div><br><h3 id="readelf-1">  readelf </h3><br><pre> <code class="bash hljs">$ readelf -p .comment simple</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдЯреАрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо</b> <div class="spoiler_text"><pre> <code class="markdown hljs">String dump of section '.comment': [ 0] GCC: (Debian 8.2.0-9) 8.2.0</code> </pre> </div></div><br><pre> <code class="bash hljs">$ readelf -n simple</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдЯреАрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо</b> <div class="spoiler_text"><pre> <code class="markdown hljs">Displaying notes found at file offset 0x000002c4 with length 0x00000020: Owner Data size Description GNU 0x00000010 NT<span class="hljs-emphasis"><span class="hljs-emphasis">_GNU_</span></span>ABI<span class="hljs-emphasis"><span class="hljs-emphasis">_TAG (ABI version tag) OS: Linux, ABI: 3.2.0 Displaying notes found at file offset 0x000002e4 with length 0x00000024: Owner Data size Description GNU 0x00000014 NT_</span></span>GNU<span class="hljs-emphasis"><span class="hljs-emphasis">_BUILD_</span></span>ID (unique build ID bitstring) Build ID: dae0509e4edb79719a65af37962b74e4cf2a8c2e</code> </pre> </div></div><br><h3 id="lief-1">  рд░рд╛рд╣рдд </h3><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"simple"</span></span>) comment = binary.get_section(<span class="hljs-string"><span class="hljs-string">".comment"</span></span>) print(<span class="hljs-string"><span class="hljs-string">"Comment: "</span></span>, bytes(comment.content))</code> </pre><br><h2 id="ya-vychislyu-tebya-po-rpath">  рдореИрдВ рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдЧрдгрдирд╛ рдХрд░реВрдБрдЧрд╛ ... RPATH </h2><br><p>  рдХрд▓реНрдкрд┐рдд рд░реВрдк рд╕реЗ рдЬреБрдбрд╝реЗ рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд▓реНрдкрд┐рдд рдкрде рдХреЛ рдмрдЪрд╛ рд╕рдХрддрд╛ рд╣реИред  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╕рд┐рд╕реНрдЯрдо рд╡реЗрд░рд┐рдПрдмрд▓ <code>LD_LIBRARY_PATH</code> рдХреЛ рд╕реЗрдЯ рдирд╣реАрдВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдмрд╕ рдЗрд╕ рдкрде рдХреЛ ELF рдлрд╝рд╛рдЗрд▓ рдореЗрдВ "рдПрдореНрдмреЗрдб" рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <code>DT_RPATH</code> рдпрд╛ <code>DT_RUNPATH</code> рдХреЗ рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рд╛рде <code>.dynamic</code> рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ (рдкреНрд░рд▓реЗрдЦрди рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░рдирдЯрд╛рдЗрдо рд▓рд┐рдВрдХрд░ рдЕрдзреНрдпрд╛рдп рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬреЗ рдЧрдП рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛рдПрдБ</a> рджреЗрдЦреЗрдВ)ред </p><br><p>  <strong>рдФрд░ рд╕рд╛рд╡рдзрд╛рди рд░рд╣реЗрдВ, рдпреБрд╡рд╛ рдбреЗрд╡рд▓рдкрд░, рдЕрдкрдиреА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдХреЛ "рдиреАрдВрдж" рди рдХрд░реЗрдВ!</strong> </p><br><h3 id="kak-poyavlyaetsya-rpath">  RPATH рдХреИрд╕реЗ рдкреНрд░рдХрдЯ рд╣реЛрддрд╛ рд╣реИ? </h3><br><p>  рдпреЛрдЧрд┐рдиреА рдореЗрдВ RPATH рд░рд┐рдХреЙрд░реНрдб рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХрд╛ рдореБрдЦреНрдп рдХрд╛рд░рдг рдбрд╛рдпрдиреЗрдорд┐рдХ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд▓рд┐рдВрдХрд░ <code>-rpath</code> рд╡рд┐рдХрд▓реНрдк рд╣реИред  рдХреБрдЫ рдЗрд╕ рддрд░рд╣: </p><br><pre> <code class="bash hljs">$ gcc -L./lib -Wall -Wl,-rpath=/run/media/pablo/disk1/projects/cheat_sheets/ELF/lib/ -o test_rpath.elf bubble_main.c -lbubble</code> </pre> <br><p>  рдЗрд╕ рддрд░рд╣ рдХрд╛ рдХрдорд╛рдВрдб рдореВрд▓реНрдп <code>/run/media/pablo/disk1/projects/cheat_sheets/ELF/lib/</code> рд╕рд╛рде <code>.dynamic</code> рд╕реЗрдХреНрд╢рди рдореЗрдВ рдПрдХ RPATH рд░рд┐рдХреЙрд░реНрдб рдмрдирд╛рдПрдЧрд╛ред </p><br><h3 id="readelf-2">  readelf </h3><br><p>  рдЖрдк <code>.dynamic</code> рдЕрдиреБрднрд╛рдЧ (рдЬрд┐рд╕рдореЗрдВ рдЖрд░рдкреАрдПрдЯреАрдПрдЪ рд╣реИ) рд╕реЗ рддрддреНрд╡реЛрдВ рдХреЛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ readelf -d test_rpath.elf</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">рдЯреАрдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо</b> <div class="spoiler_text"><p>  рдкрдврд╝рдиреЗ рдореЗрдВ рдЖрд╕рд╛рдиреА рдХреЗ рд▓рд┐рдП, рдЖрджреЗрд╢ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдЫреЛрдЯрд╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><pre> <code class="markdown hljs">Dynamic section at offset 0x2dd8 contains 28 entries: Tag Type Name/Value 0x0000000000000001 (NEEDED) Shared library: [libbubble.so] 0x0000000000000001 (NEEDED) Shared library: [libc.so.6] 0x000000000000000f (RPATH) Library rpath: [/run/media/pablo/disk1/projects/cheat_sheets/ELF/lib/] 0x000000000000000c (INIT) 0x1000 0x000000000000000d (FINI) 0x11c8 ....</code> </pre> </div></div><br><h3 id="lief-2">  рд░рд╛рд╣рдд </h3><br><p>  LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдпреЛрдЧрд┐рдиреА рдореЗрдВ RPATH рд░рд┐рдХреЙрд░реНрдб рднреА рдкрдврд╝ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lief.ELF <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DYNAMIC_TAGS elf = lief.parse(<span class="hljs-string"><span class="hljs-string">"test_rpath.elf"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> elf.has(DYNAMIC_TAGS.RPATH): rpath = next(filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.tag == DYNAMIC_TAGS.RPATH, elf.dynamic_entries)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> path <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rpath.paths: print(path) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print(<span class="hljs-string"><span class="hljs-string">"No RPATH in ELF"</span></span>)</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">.Dynamic рдЕрдиреБрднрд╛рдЧ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝реЗрдВ</a> </p><br><h2 id="proverka-elfa-na-bezopasnost">  рд╕реБрд░рдХреНрд╖рд╛ рдХреЗ рд▓рд┐рдП рдПрд▓реНрдл рдХреА рдЬрд╛рдБрдЪ </h2><br><p>  рд╢реЛрдзрдХрд░реНрддрд╛ рдЯреЛрдмреАрд╕ рдХреНрд▓реЗрди ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдП рдмрдЧ рд╣рдВрдЯрд░ рдХреА рдбрд╛рдпрд░реА рдХреЗ</a> рд▓реЗрдЦрдХ) рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреА рдЬрд╛рдВрдЪ 2011 рд╕реЗ рдЕрдкрдбреЗрдЯ рдирд╣реАрдВ рдХреА рдЧрдИ рд╣реИред  рдпрд╣ ELF рдлрд╛рдЗрд▓ рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд╡рд┐рдХрд▓реНрдк Relro (рд░реАрдб рдУрдирд▓реА рд░рд┐рд▓реЛрдХреЗрд╢рдВрд╕), NX (рдиреЙрди-рдПрдХреНрдЬрд╝реАрдХреНрдпреВрдЯреЗрдмрд▓ рд╕реНрдЯреИрдХ), рд╕реНрдЯреИрдХ рдХреИрдирд░реАрдЬрд╝, PIE (рдкреЛрдЬрд╝рд┐рд╢рди рдЗрдВрдбрд┐рдкреЗрдВрдбреЗрдВрдЯ рдПрдХреНрдЬрд╝реАрдХреНрдпреВрдЯреЗрдмрд▓реНрд╕) рдХреА рдЙрдкрд▓рдмреНрдзрддрд╛ рдХреА рдЬрд╛рдБрдЪ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЕрдкрдиреЗ рдХрд╛рдо рдХреЗ рд▓рд┐рдП рд░реАрдбрдлрд╝рд╛рдЗрд▓ рдпреВрдЯрд┐рд▓рд┐рдЯреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </p><br><h3 id="lief-3">  рд░рд╛рд╣рдд </h3><br><p>  рдЖрдк рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рдПрдирд╛рд▓реЙрдЧ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ <del>  рдШреБрдЯрдирд╛ </del>  рдкрд╛рдпрдерди рдФрд░ LIEF (рдкреВрд░реНрд╡рдЬ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдереЛрдбрд╝рд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрд▓рдЧ</a> рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрд▓рдЧ-рдЕрд▓рдЧ-рдХреЛрдб</a> рд╡рд┐рдХрд▓реНрдк рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рддреНрдпрд╛рдкрди рдХреЗ рд╕рд╛рде): </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lief.ELF <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DYNAMIC_TAGS, SEGMENT_TYPES <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">filecheck</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(filename)</span></span></span><span class="hljs-function">:</span></span> binary = lief.parse(filename) <span class="hljs-comment"><span class="hljs-comment"># check RELRO if binary.has(SEGMENT_TYPES.GNU_RELRO): print("+ Full RELRO") if binary.has(DYNAMIC_TAGS.BIND_NOW) else print("~ Partial RELRO") else: print("- No RELRO") # check for stack canary support print("+ Canary found") if binary.has_symbol("__stack_chk_fail") else print("- No canary found") # check for NX support (check X-flag for GNU_STACK-segment) print("+ NX enabled") if binary.has_nx else print("- NX disabled") # check for PIE support print("+ PIE enabled") if binary.is_pie else print("- No PIE") # check for rpath / run path print("+ RPATH") if binary.has(DYNAMIC_TAGS.RPATH) else print("- No RPATH") print("+ RUNPATH")if binary.has(DYNAMIC_TAGS.RUNPATH) else print("- No RUNPATH") # check separate-code option if set(binary.get_section('.text').segments) == set(binary.get_section('.rodata').segments): print("- Not Separated Code Sections") else: print("+ Separated Code Sections") filecheck('test_rpath.elf')</span></span></code> </pre> <br><h3 id="radare2">  Radare2 </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">рдЪреЗрдХрдХреЗ</a> рд╕рдорд╛рди рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Radare2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдЕрд▓рд╛рд╡рд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=" class="user_link">dukebarman рдХреЗ</a> рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж: </p><br><pre> <code class="bash hljs">&gt; r2 -ci~pic,canary,nx,crypto,stripped,static,relocs test_stack_proteck</code> </pre> <br><h2 id="syroy-kod-iz-elfa-binary-from-elf">  рдПрд▓реНрдл рд╕реЗ рдХрдЪреНрдЪрд╛ рдХреЛрдб (рдИрдПрд▓рдПрдл рд╕реЗ рдмрд╛рдЗрдирд░реА) </h2><br><p>  рдРрд╕реЗ рд╣рд╛рд▓рд╛рдд рд╣реИрдВ рдЬрдм рдИрдПрд▓рдПрдл рд╕рдВрд░рдЪрдирд╛ рдХреЗ рд░реВрдк рдореЗрдВ "elven рдХрдкрдбрд╝реЗ" рдХреА рдЬрд░реВрд░рдд рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдХреЗрд╡рд▓ "рдирдВрдЧреЗ" рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </p><br><h3 id="objcopy">  objcopy </h3><br><p>  рдлрд░реНрдорд╡реЗрдпрд░ рд▓рд┐рдЦрдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЗ рд▓рд┐рдП рд╢рд╛рдпрдж <em>рдСрдЬреНрдХреЙрдкреА рдХрд╛</em> рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдкрд░рд┐рдЪрд┐рдд рд╣реИ: </p><br><pre> <code class="bash hljs">$ objcopy -O binary -S -g simple.elf simple.bin</code> </pre> <br><ul><li>  <code>-S</code> - рдЪрд░рд┐рддреНрд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП; </li><li>  <code>-g</code> - рдбрд┐рдмрдЧрд┐рдВрдЧ рдЬрд╛рдирдХрд╛рд░реА рдирд┐рдХрд╛рд▓рдиреЗ рдХреЗ рд▓рд┐рдПред </li></ul><br><h3 id="lief-4">  рд░рд╛рд╣рдд </h3><br><p>  рдХреЛрдИ рдЬрд╛рджреВ рдирд╣реАрдВред  рдмрд╕ рд▓реЛрдб рдХрд┐рдП рдЧрдП рдЕрдиреБрднрд╛рдЧреЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рд▓реЗрдВ рдФрд░ рдЙрдирд╕реЗ рдПрдХ рдмрд╛рдирд░ рдмрдирд╛рдПрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> lief.ELF <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SECTION_FLAGS, SECTION_TYPES binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"test"</span></span>) end_addr = <span class="hljs-number"><span class="hljs-number">0</span></span> data = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> section <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.has(SECTION_FLAGS.ALLOC) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> x.type != SECTION_TYPES.NOBITS, binary.sections): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> &lt; end_addr &lt; section.virtual_address: align_bytes = <span class="hljs-string"><span class="hljs-string">b'\x00'</span></span> * (section.virtual_address - end_addr) data.append(align_bytes) data.append(bytes(section.content)) end_addr = section.virtual_address + section.size <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'test.lief.bin'</span></span>, <span class="hljs-string"><span class="hljs-string">'wb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> d_bytes <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data: f.write(d_bytes)</code> </pre> <br><h2 id="mangled---demangled-imena-funkciy">  рдордВрдЧрд▓реА - рдзреНрд╡рд╕реНрдд рдлрд╝рдВрдХреНрд╢рди рдирд╛рдо </h2><br><p>  C ++ рдХреЛрдб рд╕реЗ рдмрдирд╛рдИ рдЧрдИ ELFs рдореЗрдВ, рд╕рдВрдмрдВрдзрд┐рдд рд╡рд░реНрдЧ рдлрд╝рдВрдХреНрд╢рди рдХреА рдЦреЛрдЬ рдХреЛ рдЖрд╕рд╛рди рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рдВрдХреНрд╢рди рдирд╛рдо рд╕рдЬрд╛рдП рдЧрдП рд╣реИрдВ (mangled)ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдореЗрдВ рдРрд╕реЗ рдирд╛рдореЛрдВ рдХреЛ рдкрдврд╝рдирд╛ рдмрд╣реБрдд рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдирд╣реАрдВ рд╣реИред </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЯреЗрд╕реНрдЯ рдпреЛрдЧрд┐рдиреА</a> </p><br><h3 id="nm">  рдПрдирдПрдо </h3><br><p>  рдорд╛рдирд╡-рдкрдардиреАрдп рд░реВрдк рдореЗрдВ рдирд╛рдореЛрдВ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдмрд┐рдиреНрдпреВрдЯрд┐рд▓реНрд╕ рд╕реЗрдЯ рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрдирдПрдо</a> рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#        $ nm -D demangle-test-cpp ... U _Unwind_Resume U _ZdlPv U _Znwm U _ZSt17__throw_bad_allocv U _ZSt20__throw_length_errorPKc #        $ nm -D --demangle demangle-test-cpp ... U _Unwind_Resume U operator delete(void*) U operator new(unsigned long) U std::__throw_bad_alloc() U std::__throw_length_error(char const*)</span></span></code> </pre> <br><h3 id="lief-5">  рд░рд╛рд╣рдд </h3><br><p>  LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдзреНрд╡рд╕реНрдд рд░реВрдк рдореЗрдВ рдкреНрд░рддреАрдХ рдирд╛рдо рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдирд╛: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"demangle-test-cpp"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> symb <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> binary.symbols: print(symb.name, symb.demangled_name)</code> </pre> <br><h1 id="sborka-zapis-modifikaciya-elfa">  рдЕрд╕реЗрдВрдмрд▓реА рдХреА рдЕрд╕реЗрдВрдмрд▓реА, рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ, рд╕рдВрд╢реЛрдзрди </h1><br><h2 id="elf-bez-metainformacii">  рдореЗрдЯрд╛-рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдмрд┐рдирд╛ рдПрд▓реНрдл </h2><br><p>  рдЖрд╡реЗрджрди рдХреЛ рдбрд┐рдмрдЧ рдХрд░рдиреЗ рдФрд░ рдЬрдВрдЧрд▓реА рджреБрдирд┐рдпрд╛ рдореЗрдВ рдЬрд╛рд░реА рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдпрд╣ рдореЗрдЯрд╛-рд╕реВрдЪрдирд╛ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ: </p><br><ul><li>  рдбрд┐рдмрдЧ рд╕реЗрдХреНрд╢рди - рдЬреНрдпрд╛рджрд╛рддрд░ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдмреЗрдХрд╛рд░; </li><li>  рдЪрд░ рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдирд╛рдо - рдЕрдВрдд рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рднреА рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ (рдереЛрдбрд╝рд╛ рдЙрд▓реНрдЯрд╛ рдкреЗрдЪреАрджрд╛ рд╣реЛрддрд╛ рд╣реИ); </li><li>  рдЕрдиреБрднрд╛рдЧ рддрд╛рд▓рд┐рдХрд╛ - рдЖрд╡реЗрджрди рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд┐рд▓реНрдХреБрд▓ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИ (рдЗрд╕рдХреА рдХрдореА рд░рд┐рд╡рд░реНрд╕ рдХреЛ рдереЛрдбрд╝рд╛ рдЬрдЯрд┐рд▓ рдХрд░реЗрдЧреА)ред </li></ul><br><h2 id="udalenie-simvolnoy-informacii">  рдЪрд░рд┐рддреНрд░ рдЬрд╛рдирдХрд╛рд░реА рд╣рдЯрд╛рдПрдВ </h2><br><p>  рдЪрд░рд┐рддреНрд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА рд╡рд╕реНрддреБрдУрдВ рдФрд░ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рдирд╛рдо рд╣реИрдВред  рдЗрд╕рдХреЗ рдмрд┐рдирд╛, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рд░рд┐рд╡рд░реНрд╕ рдереЛрдбрд╝рд╛ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИред </p><br><h3 id="strip">  рдкрдЯреНрдЯреА </h3><br><p>  рд╕рд░рд▓рддрдо рдорд╛рдорд▓реЗ рдореЗрдВ, рдЖрдк рдмрд┐рдиреБрдЯрд┐рд▓реНрд╕ рд╕реЗрдЯ рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкрдЯреНрдЯреА рдХреА</a> рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╕рднреА рд╡рд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдПрдБ: </p><br><ul><li>  рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП: <br><pre> <code class="bash hljs">$ strip -s simple</code> </pre> </li><li>  рдЧрддрд┐рд╢реАрд▓ рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рд▓рд┐рдП: <br><pre> <code class="bash hljs">$ strip --strip-unneeded libsimple.so</code> </pre> </li></ul><br><h3 id="sstrip">  sstrip </h3><br><p>  рдЪрд░рд┐рддреНрд░ рдЬрд╛рдирдХрд╛рд░реА (рдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдВрдд рдореЗрдВ рдЕрдирд╛рд╡рд╢реНрдпрдХ рд╢реВрдиреНрдп рдмрд╛рдЗрдЯреНрд╕ рд╕рд╣рд┐рдд) рдХреЛ рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ELFkickers рд╕реВрдЯ</a> рд╕реЗ sstrip рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╕рднреА рд╡рд░реНрдг рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдХрдорд╛рдВрдб рдЪрд▓рд╛рдПрдБ: </p><br><pre> <code class="bash hljs">$ sstrip -z simple</code> </pre> <br><h3 id="lief-6">  рд░рд╛рд╣рдд </h3><br><p>  LIEF рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдЖрдк рдПрдХ рддреНрд╡рд░рд┐рдд рдкрдЯреНрдЯреА (рдкреНрд░рддреАрдХ рддрд╛рд▓рд┐рдХрд╛ рд╣рдЯрд╛ рджреА рдЧрдИ рд╣реИ - рдЕрдиреБрднрд╛рдЧ <code>.symtab</code> ) рднреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"simple"</span></span>) binary.strip() binary.write(<span class="hljs-string"><span class="hljs-string">"simple.stripped"</span></span>)</code> </pre> <br><h2 id="udalenie-tablicy-sekciy">  рдПрдХ рд╡рд┐рднрд╛рдЬрди рддрд╛рд▓рд┐рдХрд╛ рд╣рдЯрд╛рдирд╛ </h2><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЕрдиреБрднрд╛рдЧ рддрд╛рд▓рд┐рдХрд╛ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ / рдЕрдиреБрдкрд╕реНрдерд┐рддрд┐ рдЖрд╡реЗрджрди рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░рддреА рд╣реИред  рд▓реЗрдХрд┐рди рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ, рдПрдХ рдЦрдВрдб рддрд╛рд▓рд┐рдХрд╛ рдХреЗ рдмрд┐рдирд╛, рдЖрд╡реЗрджрди рдХрд╛ рд░рд┐рд╡рд░реНрд╕ рдереЛрдбрд╝рд╛ рдФрд░ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред <br>  рд╣рдо рдкрд╛рдпрдерди рдХреЗ рддрд╣рдд LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдФрд░ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реЗрдХреНрд╢рди рдЯреЗрдмрд▓ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВрдЧреЗ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"simple"</span></span>) binary.header.numberof_sections = <span class="hljs-number"><span class="hljs-number">0</span></span> binary.header.section_header_offset = <span class="hljs-number"><span class="hljs-number">0</span></span> binary.write(<span class="hljs-string"><span class="hljs-string">"simple.modified"</span></span>)</code> </pre> <br><h2 id="izmenenie-i-udalenie-rpath">  рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░реЗрдВ рдФрд░ RPATH рдХреЛ рд╣рдЯрд╛рдПрдБ </h2><br><h3 id="chrpath-patchelf">  рдЪрд░рдкрде, рдкреИрдЪреЗрд▓рдПрдл </h3><br><p>  рд▓рд┐рдирдХреНрд╕ рдХреЗ рддрд╣рдд RPATH рдХреЛ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк <em>chrpath</em> рдЙрдкрдпреЛрдЧрд┐рддрд╛рдУрдВ (рдЕрдзрд┐рдХрд╛рдВрд╢ рд╡рд┐рддрд░рдгреЛрдВ рдкрд░ рдЙрдкрд▓рдмреНрдз) рдпрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">PatchELF рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><ul><li><p>  RPATH рдмрджрд▓реЗрдВ: </p><br><pre> <code class="bash hljs">$ chrpath -r /opt/my-libs/lib:/foo/lib test_rpath.elf</code> </pre> <br><p>  рдпрд╛ </p><br><pre> <code class="bash hljs">$ patchelf --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-rpath /opt/my-libs/lib:/foo/lib test_rpath.elf</code> </pre> <br></li><li><p>  RPATH рдирд┐рдХрд╛рд▓реЗрдВ: </p><br><pre> <code class="bash hljs">$ chrpath -d test_rpath.elf</code> </pre> <br><p>  рдпрд╛ </p><br><pre> <code class="bash hljs">$ patchelf --shrink-rpath test_rpath.elf</code> </pre> <br></li></ul><br><h3 id="lief-7">  рд░рд╛рд╣рдд </h3><br><p>  LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЖрдкрдХреЛ RPATH рд░рд┐рдХреЙрд░реНрдб рдХреЛ рд╕рдВрд╢реЛрдзрд┐рдд рдХрд░рдиреЗ рдФрд░ рд╣рдЯрд╛рдиреЗ рджреЛрдиреЛрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИред </p><br><ul><li><p>  RPATH рдмрджрд▓реЗрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"test_rpath.elf"</span></span>) rpath = next(filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x.tag == lief.ELF.DYNAMIC_TAGS.RPATH, binary.dynamic_entries)) rpath.paths = [<span class="hljs-string"><span class="hljs-string">"/opt/my-lib/here"</span></span>] binary.write(<span class="hljs-string"><span class="hljs-string">"test_rpath.patched"</span></span>)</code> </pre> <br></li><li><p>  RPATH рдирд┐рдХрд╛рд▓реЗрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"test_rpath.elf"</span></span>) binary.remove(lief.ELF.DYNAMIC_TAGS.RPATH) binary.write(<span class="hljs-string"><span class="hljs-string">"test_rpath.patched"</span></span>)</code> </pre> <br></li></ul><br><h2 id="obfuskaciya-simvolnoy-informacii">  рдЪрд░рд┐рддреНрд░ рдХреА рдЬрд╛рдирдХрд╛рд░реА obfuscation </h2><br><p>  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд░рд┐рд╡рд░реНрд╕ рдХреЛ рдЬрдЯрд┐рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдкреНрд░рддреАрдХрд╛рддреНрдордХ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рдмрдЪрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдирд╛рдо рдХреЛ рднреНрд░рдорд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдо рдПрдХ рдкрд░реАрдХреНрд╖рдг <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд┐рд╖рдп рдХреЗ</a> рд░реВрдк рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">seveb рджреНрд╡рд╛рд░рд╛ crackme01</a> рд╕реЗ рдпреЛрдЧрд┐рдиреА <em>crackme01_32bit рдХрд╛</em> рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИрдВ</a> ред </p><br><p>  LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд╕реЗ рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЙрджрд╛рд╣рд░рдг</a> рдХрд╛ рд╕рд░рд▓реАрдХреГрдд рд╕рдВрд╕реНрдХрд░рдг рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗ рд╕рдХрддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"crackme01_32bit"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, symb <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(binary.static_symbols): symb.name = <span class="hljs-string"><span class="hljs-string">"zzz_%d"</span></span> % i binary.write(<span class="hljs-string"><span class="hljs-string">"crackme01_32bit.obfuscated"</span></span>)</code> </pre> <br><p>  рдирддреАрдЬрддрди, рд╣рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ readelf -s crackme01_32bit.obfuscated ... Symbol table <span class="hljs-string"><span class="hljs-string">'.symtab'</span></span> contains 78 entries: Num: Value Size Type Bind Vis Ndx Name 0: 00000000 0 NOTYPE LOCAL DEFAULT UND zzz_0 1: 08048154 0 SECTION LOCAL DEFAULT 1 zzz_1 2: 08048168 0 SECTION LOCAL DEFAULT 2 zzz_2 3: 08048188 0 SECTION LOCAL DEFAULT 3 zzz_3 4: 080481ac 0 SECTION LOCAL DEFAULT 4 zzz_4 5: 080481d0 0 SECTION LOCAL DEFAULT 5 zzz_5 6: 080482b0 0 SECTION LOCAL DEFAULT 6 zzz_6 7: 0804835a 0 SECTION LOCAL DEFAULT 7 zzz_7 8: 08048378 0 SECTION LOCAL DEFAULT 8 zzz_8 9: 080483b8 0 SECTION LOCAL DEFAULT 9 zzz_9 10: 080483c8 0 SECTION LOCAL DEFAULT 10 zzz_10 ...</code> </pre> <br><h2 id="podmena-funkciy-cherez-pltgot">  PLT / GOT рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдлрд╝рдВрдХреНрд╢рди рдкреНрд░рддрд┐рд╕реНрдерд╛рдкрди </h2><br><p>  рдЬрд┐рд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">ELF PLT INFECTION рдХреЗ</a> рдирд╛рдо рд╕реЗ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдХреЙрдкреА-рдкреЗрд╕реНрдЯ рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╡рд┐рд╖рдп рдкрд░ рд▓рд┐рдВрдХ рдЫреЛрдбрд╝реЗрдВ: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рд╛рдЭрд╛ рдИрдПрд▓рдПрдл рдкреБрд╕реНрддрдХрд╛рд▓рдпреЛрдВ рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдкреБрдирд░реНрдирд┐рд░реНрджреЗрд╢рди</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдкреАрдЯреАрдЖрдИ рдХреЛ рд╕рдВрдХреНрд░рдорд┐рдд рдХрд░рдирд╛ / LIEF рдХреЗ рд╕рд╛рде рдорд┐рд▓рд╛</a> </li></ul><br><h2 id="izmenit-tochku-vhoda">  рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдмрджрд▓реЗрдВ </h2><br><p>  рдкреИрдЪ рдмрдирд╛рддреЗ рд╕рдордп, рд╣реБрдХ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдФрд░ рдЕрдиреНрдп рдЧрддрд┐рд╢реАрд▓ рдЗрдВрд╕реНрдЯреНрд░реВрдореЗрдВрдЯреЗрд╢рди рдпрд╛ рдЫрд┐рдкреЗ рд╣реБрдП рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  рдкреНрд░рд╛рдпреЛрдЧрд┐рдХ рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">seveb рджреНрд╡рд╛рд░рд╛ рдХреНрд░реИрдХрдореЗ</a> 01 рд╕реЗ рдПрд▓реНрдл рдХреНрд░реИрдХрдореЗ__32рдмрд┐рдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ </p><br><h3 id="radare2-1">  radare2 </h3><br><p>  radare2 рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рдореЛрдб рдореЗрдВ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ (рд╡рд┐рдХрд▓реНрдк <code>-w</code> ) - рдореВрд▓ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд┐рдП рдЬрд╛рдПрдВрдЧреЗ: </p><br><pre> <code class="bash hljs">$ ./crackme01_32bit Please enter the secret number: ^C $ r2 -w -nn crackme01_32bit [0x00000000]&gt; .pf.elf_header.entry=0x0804860D [0x00000000]&gt; q $ ./crackme01_32bit Nope.</code> </pre> <br><h3 id="lief-8">  рд░рд╛рд╣рдд </h3><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"crackme01_32bit"</span></span>) header = binary.header header.entrypoint = <span class="hljs-number"><span class="hljs-number">0x0804860D</span></span> binary.write(<span class="hljs-string"><span class="hljs-string">"crackme01_32bit.patched"</span></span>)</code> </pre> <br><h2 id="patching-koda">  рдХреЛрдб рдкреИрдЪ </h2><br><p>  рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдкрд░реАрдХреНрд╖рдг рдХреЗ рд░реВрдк рдореЗрдВ, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рджрд░рд╛рд░ рдХреЗ рд╕рд╛рде novn91 рдХреЗ рдХреНрд░реИрдХрдордкрд╛рд▓ рдХреЛ рд▓реЗрдВ</a> ред  рдЬрдм рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдмрд┐рдирд╛ рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдХрд╛рд░реНрдпрдХреНрд░рдо рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИ: </p><br><pre> <code class="bash hljs">$ ./crackmeMario usage &lt;password&gt;</code> </pre> <br><p>  рдЬрдм рдПрдХ рдордирдорд╛рдирд╛-рд╕реНрдЯреНрд░рд┐рдВрдЧ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдпрд╣ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИ: </p><br><pre> <code class="bash hljs">./crackmeMario qwerty try again pal.</code> </pre> <br><p>  рд╣рдо рдПрдХ рдкреИрдЪ рдмрдирд╛рдПрдВрдЧреЗ рддрд╛рдХрд┐ рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдкрд░ рдХрд╛рд░реНрдпрдХреНрд░рдо рд╕рдВрджреЗрд╢ "рдЕрдЪреНрдЫрд╛ рдХрд╛рдо" рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░реЗ!  рдЕрдм рдореБрдЭреЗ keygen! тАЭ </p><br><h3 id="radare2-2">  radare2 </h3><br><p>  radare2 рдХрд┐рд╕реА рднреА рдкреНрд░рд╛рд░реВрдк рдХреЛ рдкреИрдЪ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЗрд╕реЗ рд╕реНрд╡рдпрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдкрд╛рда рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдкреИрдЪ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реИ: </p><br><pre> <code class="plaintext hljs"># Rapatch for https://crackmes.one/crackme/5ccecc7e33c5d4419da559b3 !echo Patching crackme 0x115D : jmp 0x1226</code> </pre> <br><p>  рдЖрдк рдЗрд╕ рддрд░рд╣ рдХреЗ рдкреИрдЪ рдХреЛ рдХрдорд╛рдВрдб рдХреЗ рд╕рд╛рде рд▓рдЧрд╛ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">$ r2 -P patch.txt crackmeMario</code> </pre> <br><p>  рд░рд╛рдбрд╛рд░ 2 рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдкреИрдЪрд┐рдВрдЧ рдХреЛрдб рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкрдврд╝реЗрдВ: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рднреЗрдбрд╝рд┐рдпрд╛рд╢рд░реНрдЯ рджреНрд╡рд╛рд░рд╛ рдмрд╛рдЗрдирд░реА рдкреИрдЪрд┐рдВрдЧ рд░реЗрдбрд╛рд░реЗ 2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░реЗрдбрд╛рд░реЗ 2 рдПрдХреНрд╕рдкреНрд▓реЛрд░реЗрд╢рдиред</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓ 1 - рд╕рд╛рдзрд╛рд░рдг рдкреИрдЪ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЧреНрд░рд╛рдЙрдВрдб рдЬрд╝реАрд░реЛ: рдкрд╛рд░реНрдЯ 3-2 - рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ - рд░реЗрдбрд╛рд░реЗ 2 рдХреЗ рд╕рд╛рде рдкреИрдЪрд┐рдВрдЧ рдмрд╛рдпрдиреЗрд░рд┐рдЬрд╝ - рдПрдЖрд░рдПрдо 64</a> </li></ul><br><h3 id="lief-9">  рд░рд╛рд╣рдд </h3><br><p>  LIEF рдЖрдкрдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рд╡рд░реНрдЪреБрдЕрд▓ рдкрддреЗ рдкрд░ рдпреЛрдЧрд┐рдиреА (рдЕрдзрд┐рд▓реЗрдЦрд┐рдд рдмрд╛рдЗрдЯреНрд╕) рдХреЛ рдкреИрдЪ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдкреИрдЪ рдмрд╛рдЗрдЯреНрд╕ рдХреЗ рдПрдХ рд╕рд░рдгреА рдХреЗ рд░реВрдк рдореЗрдВ рдпрд╛ рдкреВрд░реНрдгрд╛рдВрдХ рдорд╛рди рдХреЗ рд░реВрдк рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"crackmeMario"</span></span>) binary.patch_address(<span class="hljs-number"><span class="hljs-number">0x115D</span></span>, bytearray(<span class="hljs-string"><span class="hljs-string">b"\xe9\xc4\x00\x00\x00"</span></span>)) binary.write(<span class="hljs-string"><span class="hljs-string">"crackmeMario.patched"</span></span>)</code> </pre> <br><p>  рдкреИрдЪ рд▓рдЧрд╛рдиреЗ рдХреЗ рдмрд╛рдж, рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЖрдЙрдЯрдкреБрдЯ рд╣реЛрдЧрд╛: </p><br><pre> <code class="bash hljs">$ ./crackmeMario.patched good job! now keygen me!</code> </pre> <br><h2 id="dobavit-sekciyu-v-elf">  ELF рдореЗрдВ рд╕реЗрдХреНрд╢рди рдЬреЛрдбрд╝реЗрдВ </h2><br><h3 id="objcopy-1">  objcopy </h3><br><p>  <em>objcopy</em> рдЖрдкрдХреЛ рдПрдХ рд╕реЗрдХреНрд╢рди рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕реЗрдХреНрд╢рди рдХрд┐рд╕реА рднреА рд╕реЗрдЧрдореЗрдВрдЯ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд╣реАрдВ рд╣реЛрдЧрд╛ рдФрд░ рдЖрд╡реЗрджрди рдХреЗ рд╕рдордп рд░реИрдо рдореЗрдВ рд▓реЛрдб рдирд╣реАрдВ рд╣реЛрдЧрд╛: </p><br><pre> <code class="bash hljs">$ objcopy --add-section .testme=data.zip \ --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-section-flags .testme=alloc,contents,load,<span class="hljs-built_in"><span class="hljs-built_in">readonly</span></span> \ --change-section-address .testme=0x08777777 \ simple simple.patched.elf</code> </pre> <br><h3 id="lief-10">  рд░рд╛рд╣рдд </h3><br><p>  LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЖрдкрдХреЛ рдПрдХ рдореМрдЬреВрджрд╛ ELF рдореЗрдВ рдПрдХ рдирдпрд╛ рдЦрдВрдб рдФрд░ рдЙрд╕рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдЦрдВрдб ( <strong><code>loaded=True</code></strong> рдлреНрд▓реИрдЧ) рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреА рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"simple"</span></span>) data = bytearray(<span class="hljs-string"><span class="hljs-string">b"\xFF"</span></span> * <span class="hljs-number"><span class="hljs-number">16</span></span>) section = lief.ELF.Section(<span class="hljs-string"><span class="hljs-string">".testme"</span></span>, lief.ELF.SECTION_TYPES.PROGBITS) section += lief.ELF.SECTION_FLAGS.EXECINSTR section += lief.ELF.SECTION_FLAGS.ALLOC section.content = data binary.add(section, loaded=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) binary.write(<span class="hljs-string"><span class="hljs-string">"simple.testme.lief"</span></span>)</code> </pre> <br><h2 id="izmenit-sekciyu">  рдЦрдВрдб рдмрджрд▓реЗрдВ </h2><br><h3 id="objcopy-2">  objcopy </h3><br><p>  <em>objcopy рдЖрдкрдХреЛ</em> рдПрдХ рдлрд╝рд╛рдЗрд▓ рд╕реЗ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЕрдиреБрднрд╛рдЧ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рд╕рд╛рде рд╣реА рдПрдХ рдЕрдиреБрднрд╛рдЧ рдФрд░ рдЭрдВрдбреЗ рдХреЗ рдЖрднрд╛рд╕реА рдкрддреЗ рдХреЛ рдмрджрд▓ рджреЗрддрд╛ рд╣реИред </p><br><pre> <code class="bash hljs">$ objcopy --update-section .testme=patch.bin \ --change-section-address .testme=0x08999999 simple simple.testme.elf</code> </pre> <br><h3 id="lief-11">  рд░рд╛рд╣рдд </h3><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"simple"</span></span>) data = bytearray(<span class="hljs-string"><span class="hljs-string">b"\xFF"</span></span> * <span class="hljs-number"><span class="hljs-number">17</span></span>) section = binary.get_section(<span class="hljs-string"><span class="hljs-string">".text"</span></span>) section.content = data binary.write(<span class="hljs-string"><span class="hljs-string">"simple.patched"</span></span>)</code> </pre> <br><h2 id="udalit-sekciyu">  рдЕрдиреБрднрд╛рдЧ рд╣рдЯрд╛рдПрдБ </h2><br><h3 id="objcopy-3">  objcopy </h3><br><p>  <em>objcopy рдЖрдкрдХреЛ</em> рдирд╛рдо рд╕реЗ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдиреБрднрд╛рдЧ рдХреЛ рд╣рдЯрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="bash hljs">$ objcopy --remove-section .testme simple.testme.elf simple.no_testme.elf</code> </pre> <br><h3 id="lief-12">  рд░рд╛рд╣рдд </h3><br><p>  LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрднрд╛рдЧ рдХреЛ рд╣рдЯрд╛рдирд╛ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"simple.testme.elf"</span></span>) binary.remove_section(<span class="hljs-string"><span class="hljs-string">".testme"</span></span>) binary.write(<span class="hljs-string"><span class="hljs-string">"simple.no_testme"</span></span>)</code> </pre> <br><h2 id="elf-konteyner">  рдПрд▓реНрдл рдХрдВрдЯреЗрдирд░ </h2><br><p>  рдиреБрд╕реНрдЦрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Gremlins рдФрд░ ELF рдЬрд╛рджреВ</a> рд╕реЗ рдкреНрд░реЗрд░рд┐рдд рд╣реИ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">: рдХреНрдпрд╛ рд╣реЛрдЧрд╛ рдпрджрд┐ ELF рдлрд╝рд╛рдЗрд▓ рдПрдХ рдХрдВрдЯреЗрдирд░ рд╣реИ?</a>  ред  рдореВрд▓ рд░реВрдк рд╕реЗ рд╕реЛрд▓рд╛рд░рд┐рд╕ рд╕реЗ рдПрд▓реНрдлреНрд░реИрдк рдЙрдкрдпреЛрдЧрд┐рддрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреА рдЖрджрдореА рд╣реИрдВ, рдЬреЛ рдЖрдкрдХреЛ рдордирдорд╛рдиреЗ рдбреЗрдЯрд╛ рд╕реЗ рдПрдХ рдИрдПрд▓рдПрдл рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ, рдФрд░ рдИрдПрд▓рдПрдл рдкреНрд░рд╛рд░реВрдк рдХреЗрд╡рд▓ рдПрдХ рдХрдВрдЯреЗрдирд░ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдЪрд▓реЛ рдкрд╛рдпрдерди рдФрд░ LIEF рдореЗрдВ рднреА рдРрд╕рд╛ рд╣реА рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВред <br>  рджреБрд░реНрднрд╛рдЧреНрдп рд╕реЗ, рдЗрд╕ рд╕рдордп, LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдЦрд░реЛрдВрдЪ рд╕реЗ рдПрдХ рдпреЛрдЧрд┐рдиреА рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЖрдкрдХреЛ рдЗрд╕рдХреА рдорджрдж рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ - рдПрдХ рдЦрд╛рд▓реА рдИрдПрд▓рдПрдл рдЯреЗрдореНрдкрд▓реЗрдЯ рдмрдирд╛рдПрдВ: </p><br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> | gcc -m32 -fpic -o empty.o -c -xc - $ gcc -m32 -shared -o libempty.so empty.o</code> </pre> <br><p>  рдЕрдм рдЖрдк рдЗрд╕ рдЯреЗрдореНрдкрд▓реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдбреЗрдЯрд╛ рдХреЛ рдкреЙрдкреНрдпреБрд▓реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"libempty.so"</span></span>) filename = <span class="hljs-string"><span class="hljs-string">"crackme.zip"</span></span> data = open(filename, <span class="hljs-string"><span class="hljs-string">'rb'</span></span>).read() <span class="hljs-comment"><span class="hljs-comment"># Add section with zip-archive as content section = lief.ELF.Section() section.content = data section.name = ".%s"%filename binary.add(section, loaded=True) # Add symbol as a reference to zip-archive symb = lief.ELF.Symbol() symb.type = lief.ELF.SYMBOL_TYPES.OBJECT symb.binding = lief.ELF.SYMBOL_BINDINGS.GLOBAL symb.size = len(data) symb.name = filename symb.value = section.virtual_address binary.add_static_symbol(symb) binary.write("libdata.crackme.container")</span></span></code> </pre> <br><h2 id="elf-s-pricepom">  рдПрд▓реНрдл "рдПрдХ рдЯреНрд░реЗрд▓рд░ рдХреЗ рд╕рд╛рде" </h2><br><p>  ELF рдкреНрд░рд╛рд░реВрдк рдЙрд╕ рдбреЗрдЯрд╛ рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рдирд╣реАрдВ рд▓рдЧрд╛рддрд╛ рд╣реИ рдЬреЛ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдХрд┐рд╕реА рдЦрдВрдб рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдирд╣реАрдВ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдПрдХ рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдирд╛ рд╕рдВрднрд╡ рд╣реИ, рдЬрд┐рд╕реЗ рдИрдПрд▓рдПрдл рд╕рдВрд░рдЪрдирд╛ рдХреЗ рдмрд╛рдж рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрд╣ <em>рдХреБрдЫ рдРрд╕рд╛ рд╣реИ рдЬрд┐рд╕реЗ</em> рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рд░реИрдо рдореЗрдВ рд▓реЛрдб рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рд▓реЗрдХрд┐рди рдпрд╣ рдбрд┐рд╕реНрдХ рдкрд░ рд▓рд┐рдЦрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рдХрд┐рд╕реА рднреА рд╕рдордп рдЗрд╕реЗ рдбрд┐рд╕реНрдХ рд╕реЗ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><ul><li>  <em>рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддреЗ рд╕рдордп рдЖрдИрдбреАрдП рдкреНрд░реЛ рдЗрд╕ рдбреЗрдЯрд╛ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд░реЗрдЧрд╛</em> </li></ul><br><p>  <em>рдЯреНрд░реЗрд▓рд░ рдХреЗ рд╕рд╛рде рдлрд╝рд╛рдЗрд▓ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЙрджрд╛рд╣рд░рдг</em> <br><img src="https://habrastorage.org/webt/rr/br/sk/rrbrsktjs_p8l7fmdfq7t4mejns.jpeg" alt="рдЫрд╡рд┐"></p><br><h3 id="radare2-3">  radare2 </h3><br><p>  "рдЯреНрд░реЗрд▓рд░" рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдФрд░ рдЧрдгрдирд╛ рдХреА рдЧрдИ рдлрд╝рд╛рдЗрд▓ рдЖрдХрд╛рд░реЛрдВ рдХреА рддреБрд▓рдирд╛ рдХрд░рдХреЗ рд╕реНрдерд╛рдкрд┐рдд рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ: </p><br><pre> <code class="bash hljs">$ radare2 test.elf [0x00001040]&gt; ?v <span class="hljs-variable"><span class="hljs-variable">$s</span></span> 0x40c1 [0x00001040]&gt; iZ 14699</code> </pre> <br><h3 id="readelf-3">  readelf </h3><br><p>  <em>readelf</em> "рдЯреНрд░реЗрд▓рд░" рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рджрд┐рдЦрд╛рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдЧрдгрдирд╛ рдХреА рдЬрд╛ рд╕рдХрддреА рд╣реИ: </p><br><pre> <code class="bash hljs">$ ls -l test.elf <span class="hljs-comment"><span class="hljs-comment">#   16577  $ readelf -h test.elf Start of section headers e_shoff 14704 Size of section headers e_shentsize 64 Number of section headers e_shnum 29 #  ELF-: e_shoff + ( e_shentsize * e_shnum ) = 16560</span></span></code> </pre> <br><h3 id="lief-13">  рд░рд╛рд╣рдд </h3><br><p>  LIEF рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЖрдкрдХреЛ "рдЯреНрд░реЗрд▓рд░" рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рджреЛрдиреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдиреЗ рдФрд░ рдЗрд╕реЗ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  LIEF рдХреЗ рдкреНрд░рдпреЛрдЧ рд╕реЗ, рд╕рдм рдХреБрдЫ рдХрд╛рдлреА рд░рд╕реАрд▓рд╛ рд▓рдЧрддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lief binary = lief.parse(<span class="hljs-string"><span class="hljs-string">"test"</span></span>) <span class="hljs-comment"><span class="hljs-comment"># check if overlay exists print('ELF has overlay data') if binary.has_overlay else print("No overlay data") # add overlay data to ELF data = bytearray(b'\xFF'*17) binary.overlay = data binary.write('test.overlay')</span></span></code> </pre> <br><h2 id="elf-iz-pustoty-elf-from-scratch">  рд╢реВрдиреНрдп рдПрд▓реНрдл (рдЦрд░реЛрдВрдЪ рд╕реЗ рдИрдПрд▓рдПрдл) </h2><br><p>  рдЗрдВрдЯрд░рдиреЗрдЯ рдкрд░ рдЖрдк "рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ" рдИрдПрд▓рдПрдл рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ - рд╕рд╛рдорд╛рдиреНрдп рдирд╛рдо "рд╕реНрдХреНрд░реИрдЪ рд╕реЗ рдИрдПрд▓рдПрдл" рдХреЗ рддрд╣рдд рд╕рдВрдХрд▓рдХ рдФрд░ рд▓рд┐рдВрдХрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдмрд┐рдирд╛: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬреАрдердм рдкреНрд░реЛрдЬреЗрдХреНрдЯ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЦрд░реЛрдВрдЪ</a> рд▓реЗрдЦ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реЗ рдПрд▓реНрдл</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">LIEF</a> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рдореЗрдВ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Elf_from_scratch</a> рд╢рд╛рдЦрд╛ </li></ul><br><p>  рдЗрди рдкрд░рд┐рдпреЛрдЬрдирд╛рдУрдВ рдХреЗ рд╕рд╛рде рдкрд░рд┐рдЪрд┐рдд рд╣реЛрдиреЗ рд╕реЗ ELF рдкреНрд░рд╛рд░реВрдк рдХреЗ рдЕрд╡рд╢реЛрд╖рдг рдкрд░ рд▓рд╛рднрдХрд╛рд░реА рдкреНрд░рднрд╛рд╡ рдкрдбрд╝рддрд╛ рд╣реИред </p><br><h2 id="samyy-malenkiy-elf">  рд╕рдмрд╕реЗ рдЫреЛрдЯреА рдпреЛрдЧрд┐рдиреА </h2><br><p>  рдпреЛрдЧрд┐рдиреА рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд╕рд╛рде рджрд┐рд▓рдЪрд╕реНрдк рдкреНрд░рдпреЛрдЧ рд▓реЗрдЦреЛрдВ рдореЗрдВ рд╡рд░реНрдгрд┐рдд рд╣реИрдВ: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдирдХреНрд╕ рдХреЗ рд▓рд┐рдП рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рддреАрдХреНрд╖реНрдг рдИрдПрд▓рдПрдл рдирд┐рд╖реНрдкрд╛рджрди рдмрдирд╛рдиреЗ рдкрд░ рдПрдХ рдмрд╡рдВрдбрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд▓рд┐рдирдХреНрд╕ рдХреЗ рд▓рд┐рдП рдХреБрдЫ рд╣рдж рддрдХ рддреАрдХреНрд╖реНрдг рдИрдПрд▓рдПрдл рдПрдХреНрдЬрд╝реАрдХреНрдпреВрдЯреЗрдмрд▓реНрд╕ рдмрдирд╛рдиреЗ рдкрд░ рдПрдХ рдмрд╡рдВрдбрд░ рдЯреНрдпреВрдЯреЛрд░рд┐рдпрд▓</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдИрдПрд▓рдПрдл рдкреНрд░рд╛рд░реВрдк рдореЗрдВ рдиреНрдпреВрдирддрдо рдХрд╛рд░реНрдпрдХреНрд░рдо</a> </li></ul><br><p>  рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ, рдУрдПрд╕ рдореЗрдВ рд▓реЛрдбрд░ рд╕рднреА рд╣реЗрдбрд░ рдлрд╝реАрд▓реНрдб рдФрд░ рд╕реЗрдЧрдореЗрдВрдЯ рдЯреЗрдмрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдХреБрдЫ рдиреНрдпреВрдирддрдо рдирд┐рд╖реНрдкрд╛рджрди рдпреЛрдЧреНрдп рдХреЛрдб рдХреЛ рд╕реАрдзреЗ рдИрдПрд▓рдПрдл рд╣реЗрдбрд░ рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рд░рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдХреЛрдб рдкрд╣рд▓реЗ рд▓реЗрдЦ рд╕реЗ рд▓рд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ): </p><br><pre> <code class="plaintext hljs">; tiny.asm BITS 32 org 0x00010000 db 0x7F, "ELF" ; e_ident dd 1 ; p_type dd 0 ; p_offset dd $$ ; p_vaddr dw 2 ; e_type ; p_paddr dw 3 ; e_machine dd _start ; e_version ; p_filesz dd _start ; e_entry ; p_memsz dd 4 ; e_phoff ; p_flags _start: mov bl, 42 ; e_shoff ; p_align xor eax, eax inc eax ; e_flags int 0x80 db 0 dw 0x34 ; e_ehsize dw 0x20 ; e_phentsize db 1 ; e_phnum ; e_shentsize ; e_shnum ; e_shstrndx filesize equ $ - $$</code> </pre> <br><p>  рдЗрдХрдЯреНрдард╛ рдХрд░реЗрдВ рдФрд░ рдЖрдХрд╛рд░ рдХрд╛ рдПрдХ рдИрдПрд▓рдПрдл рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ ... <strong>45 рдмрд╛рдЗрдЯреНрд╕</strong> : </p><br><pre> <code class="bash hljs"> $ nasm -f bin -o a.out tiny.asm $ chmod +x a.out $ ./a.out ; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> $? 42 $ wc -c a.out 45 a.out</code> </pre> <br><h2 id="elf-po-shablonu">  рдкреИрдЯрд░реНрди рдпреЛрдЧрд┐рдиреА </h2><br><p>  LIEF рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдпреЛрдЧрд┐рдиреА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХрджрдо рдЙрдард╛ рд╕рдХрддреЗ рд╣реИрдВ (рдиреБрд╕реНрдЦрд╛ "рдПрд▓реНрдл-рдХрдВрдЯреЗрдирд░" рджреЗрдЦреЗрдВ): </p><br><ul><li>  рдЯреЗрдореНрдкрд▓реЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдИрдПрд▓рдПрдл рдлрд╝рд╛рдЗрд▓ рд▓реЗрдВ; </li><li>  рдЕрдиреБрднрд╛рдЧреЛрдВ рдХреА рд╕рд╛рдордЧреНрд░реА рдХреЛ рдмрджрд▓реЗрдВ, рдирдП рдЕрдиреБрднрд╛рдЧ рдЬреЛрдбрд╝реЗрдВ; </li><li>  рдЖрд╡рд╢реНрдпрдХ рдорд╛рдкрджрдВрдбреЛрдВ (рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ, рдЭрдВрдбреЗ) рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░реЗрдВред </li></ul><br><h1 id="vmesto-zaklyucheniya">  рдПрдХ рдирд┐рд╖реНрдХрд░реНрд╖ рдХреЗ рдмрдЬрд╛рдп </h1><br><p>  рд▓реЗрдЦ рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реБрдП, рд╣рдордиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдпрд╣ LIEF рдкреБрд╕реНрддрдХрд╛рд▓рдп рдХреЗ рд▓рд┐рдП рдПрдХ ode рдЬреИрд╕рд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдпрд╣ рдпреЛрдЬрдирд╛рдмрджреНрдз рдирд╣реАрдВ рдерд╛ - рдореИрдВ рдпрд╣ рджрд┐рдЦрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ рдХрд┐ рд╡рд┐рднрд┐рдиреНрди рдЙрдкрдХрд░рдгреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдИрдПрд▓рдПрдл рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЗ рд╕рд╛рде рдХреИрд╕реЗ рдХрд╛рдо рдХрд┐рдпрд╛ рдЬрд╛рдПред </p><br><p>  рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рдРрд╕реА рд╕реНрдХреНрд░рд┐рдкреНрдЯреНрд╕ рдпрд╛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдПрдВ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдпрд╣рд╛рдВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ - рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдореЗрдВ рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рд▓рд┐рдЦреЗрдВред </p><br><h1 id="ssylki-i-literatura">  рд╕рдиреНрджрд░реНрдн рдФрд░ рд╕рд╛рд╣рд┐рддреНрдп </h1><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдИрдПрд▓рдПрдл рдкреНрд░рд╛рд░реВрдк рд╡рд┐рдирд┐рд░реНрджреЗрд╢</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдУрд░реЗрдХрд▓ рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдореЗрдВ рдПрдХ рдФрд░ рдкреНрд░рд╛рд░реВрдк рд╡рд┐рдирд┐рд░реНрджреЗрд╢</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд░рдбрд╛рд░ 2 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдИрдПрд▓рдПрдл рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">LIEF рдкреБрд╕реНрддрдХрд╛рд▓рдп рдкреНрд░рд▓реЗрдЦрди</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">LIEF рдкреБрд╕реНрддрдХрд╛рд▓рдп рдЙрджрд╛рд╣рд░рдг</a> </li><li>  рдкреБрд╕реНрддрдХ "рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рджреНрд╡рд┐рдШрд╛рдд рд╡рд┐рд╢реНрд▓реЗрд╖рдг", рдбреЗрдирд┐рд╕ рдПрдВрдбреНрд░рд┐рдпрд╛рд╕ </li><li>  рд░реЗрдпрд╛рди "рдПрд▓реНрдлрдорд╛рд╕реНрдЯрд░" рдУ'рдиреАрд▓ рджреНрд╡рд╛рд░рд╛ рд▓рд┐рдирдХреНрд╕ рдмрд╛рдЗрдирд░реА рд╡рд┐рд╢реНрд▓реЗрд╖рдг рд╕реАрдЦрдирд╛ </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi460247/">https://habr.com/ru/post/hi460247/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi460231/index.html">OpenGear - рдЖрдЙрдЯ-рдСрдл-рдмреИрдВрдб рдкреНрд░рдмрдВрдзрди рдХреЗ рд╕рд╛рде рдХрдВрд╕реЛрд▓ рд╕рд░реНрд╡рд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд┐рдЬрдиреЗрд╕ рдбрд╛рдЙрдирдЯрд╛рдЗрдо рдХреЛ рдХрдо рдХрд░реЗрдВ</a></li>
<li><a href="../hi460233/index.html">рдЦреЗрд▓ рд╢рд╣рд░реЛрдВ: Skylines рдЯреНрдпреВрд░рд┐рдВрдЧ-рдкреВрд░реНрдг рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдХрд▓рд╛: рд╣рдо рдПрдХ 4-рдмрд┐рдЯ рдпреЛрдЬрдХ рдмрдирд╛рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi460237/index.html">рдИрдмреЗ рд╕реНрдХреИрдорд░ (рдПрдХ рдзреЛрдЦрд╛ рдХрд╣рд╛рдиреА)</a></li>
<li><a href="../hi460239/index.html">NextGen Firewall рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдЕрдкрдиреЗ рдЖрдк рдХреЛ рдмрд┐рд▓реНрдХреБрд▓ рдореБрдлреНрдд рдШрд░</a></li>
<li><a href="../hi460241/index.html">рдирд░рдХ рдпрд╛ рдЙрдЪреНрдЪ рдкрд╛рдиреА: рд░реВрд╕реА рд▓реЛрдХрдкреНрд░рд┐рдп рд╡рд┐рдЬреНрдЮрд╛рди рд╕рд╛рд╣рд┐рддреНрдп рдХрд╛ рдЗрддрд┐рд╣рд╛рд╕</a></li>
<li><a href="../hi460249/index.html">Pwnable.kr 07 рдХреЗ рд╕рд╛рде рдХрд╛рд░реНрдп рдХрд╛ рд╕рдорд╛рдзрд╛рди - рдЗрдирдкреБрдЯред Pwntools рд╕рдордЭрдирд╛</a></li>
<li><a href="../hi460251/index.html">рдЖрд░реНрдЯрд┐рдлрд┐рд╢рд┐рдпрд▓ рд╕реНрдЯреБрдкрд┐рдбрд┐рдЯреА: рдПрдХ рдмреЙрдЯ рдЬреЛ рдореЗрд░реА рдорджрдж рдирд╣реАрдВ рдХрд░рддрд╛ рдерд╛</a></li>
<li><a href="../hi460255/index.html">Node.js рдкрд░ рдкрд┐рдЫрд▓реЗ рджрд░рд╡рд╛рдЬреЗ: рдХреНрдпреЛрдВ, рдХреНрдпреЛрдВ рдФрд░ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi460257/index.html">рдирдорд╕реНрддреЗ рд╡рд┐рд╢реНрд╡! рдЯрд░реНрдорд┐рдирд▓реЛрдВ рдореЗрдВ рдЧрд╣рд░рд╛ рд╡рд┐рд╕рд░реНрдЬрди</a></li>
<li><a href="../hi460259/index.html">рдпреВрдЖрдИ рдФрд░ рдпреВрдПрдХреНрд╕ рдбрд┐рдЬрд╛рдЗрди рдХреНрдпрд╛ рд╣реИ? рдХреНрдпрд╛ рдЖрдо рдФрд░ рдЕрд▓рдЧ рд╣реИ?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>