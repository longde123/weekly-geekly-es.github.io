<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏁 🗃️ 🧗🏼 مدير الحزم لـ Kubernetes - Helm: الماضي والحاضر والمستقبل 🌠 👨🏻‍🚀 🏴󠁧󠁢󠁷󠁬󠁳󠁿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ملاحظة perev. : في هذه المقالة نفتح سلسلة من المنشورات حول مدير الحزم لـ Kubernetes ، والتي نستخدمها بنشاط في العمل اليومي ، - Helm. المؤلف الأصلي لهذ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>مدير الحزم لـ Kubernetes - Helm: الماضي والحاضر والمستقبل</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/417079/" style=";text-align:right;direction:rtl">  <i><b>ملاحظة</b></i>  <i><b>perev.</b></i>  <i>: في هذه المقالة نفتح سلسلة من المنشورات حول مدير الحزم لـ Kubernetes ، والتي نستخدمها بنشاط في العمل اليومي ، - Helm.</i>  <i>المؤلف الأصلي لهذه المادة هو مات باتشر ، أحد مؤسسي مشروع هيلم ، الذي يعمل على مشاريع مفتوحة المصدر في مايكروسوفت ويكتب 8 كتب فنية (على وجه الخصوص ، "اذهب في الممارسة").</i>  <i>ومع ذلك ، يتم استكمال المقالة بتعليقاتنا (المكثفة في بعض الأحيان) ، وسيتم توسيعها قريبًا بملاحظات جديدة حول Helm مع تركيز عملي أكثر.</i>  <i><b>تحديث</b> (09/03/2018): ظهرت التكملة - " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">التعارف العملي مع مدير الحزم لـ Kubernetes - Helm</a> ".</i> <br><br><img src="https://habrastorage.org/webt/ff/1x/js/ff1xjsnvdlnfinirlwb-0p42tlo.png"><br><br>  في شهر يونيو ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">انتقل</a> هيلم من حالة Kubernetes الرائدة إلى مؤسسة الحوسبة السحابية الأصلية (CNCF).  أصبحت CNCF المنظمة الأم لأفضل أدواتها الأصلية السحابية مفتوحة المصدر.  لذلك ، إنه لشرف عظيم أن يصبح هيلم جزءًا من مثل هذا الأساس.  وأول مشروع مهم لنا تحت رعاية CNCF هو واسع النطاق حقًا: نحن نصنع Helm 3. <a name="habracut"></a><br><br><h2 style=";text-align:right;direction:rtl">  تاريخ موجز هيلم </h2><br>  ظهر هيلم في الأصل كمشروع Deis مفتوح المصدر.  تم تصميمه على غرار <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Homebrew</a> <i>(مدير الحزم لنظام macOS - Translations <b>تقريبًا</b> )</i> ، وكانت مهمة Helm 1 فرصة سهلة للمستخدمين لتثبيت أحمال عملهم الأولى بسرعة على Kubernetes.  تم الإعلان الرسمي عن Helm في مؤتمر KubeCon San Francisco الأول في عام 2015. <br><br>  <i><b>ملاحظة</b></i>  <i><b>عبر:</b> من الإصدار الأول ، الذي كان يسمى dm (مدير النشر) ، تم اختيار بناء جملة YAML لوصف موارد Kubernetes ، وتم دعم <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">قوالب Jinja</a> ونصوص Python النصية عند كتابة التكوينات.</i> <br><br>  <i>قد يبدو قالب تطبيق الويب البسيط كما يلي:</i> <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Yaml</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">resources: - name: frontend type: github.com/kubernetes/application-dm-templates/common/replicatedservice:v1 properties: service_port: 80 container_port: 80 external_service: true replicas: 3 image: gcr.io/google_containers/example-guestbook-php-redis:v3 - name: redis type: github.com/kubernetes/application-dm-templates/storage/redis:v1 properties: null</code> </pre> </div></div><br>  <i>عند وصف مكونات التطبيق الذي تم طرحه ، يشار إلى الاسم والقالب المستخدم وكذلك المعلمات الضرورية لهذا النموذج.</i>  <i>في المثال أعلاه ، تستخدم <code>redis</code> <code>frontend</code> و <code>redis</code> قوالب من المستودع الرسمي.</i> <br><br>  <i>بالفعل في هذا الإصدار ، يمكنك استخدام الموارد من قاعدة معارف مشتركة ، وإنشاء مستودعات القوالب الخاصة بك وبناء تطبيقات معقدة بسبب المعلمات وتداخل القوالب.</i> <br><br>  <i>تتكون هندسة Helm 1 من ثلاثة مكونات.</i>  <i>يوضح الرسم البياني التالي العلاقة بينهما:</i> <br><br><img src="https://habrastorage.org/webt/66/f8/l_/66f8l_blo_rfzohvo1wpobchuzg.png"><br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <i>يقوم <code>Manager</code> بوظيفة خادم الويب (يحدث التواصل مع العملاء عبر REST API) ، ويدير عمليات النشر في مجموعة Kubernetes ويستخدم كمخزن للبيانات.</i> </li><li style=";text-align:right;direction:rtl">  <i>يجلب المكون <code>expandybird</code> تكوينات المستخدم إلى شكل مسطح ، أي</i>  <i>يطبق قوالب جينجا وينفذ نصوص بايثون.</i> </li><li style=";text-align:right;direction:rtl">  <i>بعد تلقي تكوين مسطح ، يقوم مورد <code>resourcifier</code> بإجراء المكالمات اللازمة إلى kubectl وإرجاع رسائل الحالة ورسائل الخطأ ، إن وجدت ، إلى <code>manager</code> .</i> </li></ol><br>  <i>لفهم إمكانيات الإصدار الأول من Helm ، سأقدم المساعدة في الأمر <code>dm</code></i> : <div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">مساعدة الإخراج من DM</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">Usage: ./dm [&lt;flags&gt;] &lt;<span class="hljs-built_in"><span class="hljs-built_in">command</span></span>&gt; [(&lt;template-name&gt; | &lt;deployment-name&gt; | (&lt;configuration&gt; [&lt;import1&gt;...&lt;importN&gt;]))] Commands: expand Expands the supplied configuration(s) deploy Deploys the named template or the supplied configuration(s) list Lists the deployments <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the cluster get Retrieves the supplied deployment manifest Lists manifests <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> deployment or retrieves the supplied manifest <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the form (deployment[/manifest]) delete Deletes the supplied deployment update Updates a deployment using the supplied configuration(s) deployed-types Lists the types deployed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the cluster deployed-instances Lists the instances of the named <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> deployed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the cluster templates Lists the templates <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a given template registry (specified with --registry) registries Lists the registries available describe Describes the named template <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a given template registry getcredential Gets the named credential used by a registry setcredential Sets a credential used by a registry createregistry Creates a registry that holds charts Flags: -apitoken string Github api token that overrides GITHUB_API_TOKEN environment variable -binary string Path to template expansion binary (default <span class="hljs-string"><span class="hljs-string">"../expandybird/expansion/expansion.py"</span></span>) -httptest.serve string <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> non-empty, httptest.NewServer serves on this address and blocks -name string Name of deployment, used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> deploy and update commands (defaults to template name) -password string Github password that overrides GITHUB_PASSWORD environment variable -properties string Properties to use when deploying a template (eg, --properties k1=v1,k2=v2) -regex string Regular expression to filter the templates listed <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a template registry -registry string Registry name (default <span class="hljs-string"><span class="hljs-string">"application-dm-templates"</span></span>) -registryfile string File containing registry specification -service string URL <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> deployment manager (default <span class="hljs-string"><span class="hljs-string">"http://localhost:8001/api/v1/proxy/namespaces/dm/services/manager-service:manager"</span></span>) -serviceaccount string Service account file containing JWT token -stdin Reads a configuration from the standard input -timeout int Time <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> seconds to <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> response (default 20) -username string Github user name that overrides GITHUB_USERNAME environment variable --stdin requires a file name and either the file contents or a tar archive containing the named file. a tar archive may include any additional files referenced directly or indirectly by the named file.</code> </pre></div></div><br>  <i>والآن نعود إلى النص الأصلي حول تاريخ هيلم ...</i> <br><br>  بعد بضعة أشهر ، انضممنا إلى فريق Kubernetes Deployment Manager من Google وبدأنا العمل في Helm 2. وكان الهدف هو إبقاء Helm سهل الاستخدام بإضافة ما يلي: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  قوالب المخططات <i>("مخطط" -</i> نظير <i>لحزمة في نظام هيلم البيئي - <b>ترجمة تقريبًا</b> )</i> للتخصيص ؛ </li><li style=";text-align:right;direction:rtl">  إدارة المجموعات للفرق ؛ </li><li style=";text-align:right;direction:rtl">  مستودع مخطط كامل </li><li style=";text-align:right;direction:rtl">  تنسيق حزمة مستقرة وموقعة ؛ </li><li style=";text-align:right;direction:rtl">  التزام قوي بالإصدار الدلالي والحفاظ على التوافق العكسي من إصدار إلى آخر. </li></ol><br>  لتحقيق هذه الأهداف ، تمت إضافة مكون ثانٍ إلى النظام البيئي Helm.  أصبحت المجموعة الداخلية تيلر ، والتي قدمت تركيب خرائط هيلم وإدارتها. <br><br>  <i><b>ملاحظة</b></i>  <i><b>perev.</b> وبالتالي ، في الإصدار الثاني من Helm ، يكون المكون الوحيد المتبقي في المجموعة مسؤولاً عن دورة حياة التثبيت ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الإصدار</a> ) ، ويتم إرسال إعداد التكوين إلى عميل Helm.</i> <br><br>  <i>إذا أدت إعادة تشغيل نظام المجموعة عند استخدام الإصدار الأول من Helm إلى فقدان كامل لبيانات الخدمة (حيث تم تخزينها في ذاكرة الوصول العشوائي) ، ثم في Helm 2 يتم تخزين جميع البيانات في <code>ConfigMaps</code> ، أي</i>  <i>الموارد داخل Kubernetes.</i>  <i>كانت الخطوة المهمة الأخرى هي الانتقال من واجهة برمجة تطبيقات متزامنة (حيث كان كل طلب يحظر) إلى استخدام gRPC غير المتزامن.</i> <br><br>  منذ إطلاق Helm 2 في عام 2016 ، شهد مشروع Kubernetes نموًا هائلاً وفرصًا جديدة مهمة.  تمت إضافة التحكم في الوصول المستند إلى الدور (RBAC).  يتم إدخال العديد من أنواع الموارد الجديدة.  موارد الطرف الثالث اخترع (تعريفات الموارد المخصصة ، CRD).  والأهم من ذلك ، هناك أفضل الممارسات.  مرت كل هذه التغييرات ، واصلت هيلم لخدمة احتياجات مستخدمي Kubernetes.  ولكن أصبح من الواضح لنا أن الوقت قد حان لإجراء تغييرات رئيسية عليه حتى تستمر تلبية احتياجات هذا النظام البيئي النامي. <br><br>  لذلك جئنا إلى Helm 3. بعد ذلك سأتحدث عن بعض الابتكارات الواردة في خارطة طريق المشروع. <br><br><h2 style=";text-align:right;direction:rtl">  تحياتي لوا </h2><br>  في Helm 2 ، قدمنا ​​قوالب.  في المرحلة المبكرة من تطوير Helm 2 ، دعمنا قوالب Go و Jinja ورمز Python النظيف ، وكان لدينا حتى نموذج أولي لدعم ksonnet.  لكن وجود العديد من محركات القوالب أدى إلى مشاكل أكثر مما تم حلها.  لذلك ، وصلنا إلى نقطة اختيار واحد. <br><br>  تتميز قوالب Go بأربع مزايا: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تم بناء</a> المكتبة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">في Go</a> . </li><li style=";text-align:right;direction:rtl">  يتم تنفيذ القوالب في بيئة رمل محدودة للغاية ؛ </li><li style=";text-align:right;direction:rtl">  يمكننا إدراج <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وظائف وأشياء تعسفية</a> في المحرك ؛ </li><li style=";text-align:right;direction:rtl">  عملوا بشكل جيد مع YAML. </li></ol><br>  على الرغم من أننا احتفظنا بالواجهة في Helm لدعم محركات القوالب الأخرى ، أصبحت قوالب Go معيارنا الافتراضي.  وأظهرت السنوات القليلة القادمة من الخبرة كيف أن المهندسين من العديد من الشركات قاموا بإنشاء آلاف الرسوم البيانية باستخدام قوالب Go. <br><br>  وتعلمنا عن خيبات أملهم: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  من الصعب قراءة البنية وتوثيقها بشكل سيئ. </li><li style=";text-align:right;direction:rtl">  قضايا اللغة ، مثل المتغيرات الثابتة ، وأنواع البيانات المعقدة ، وقواعد الرؤية المقيدة ، حولت الأشياء البسيطة إلى معقدة. </li><li style=";text-align:right;direction:rtl">  جعلت عدم القدرة على تحديد الوظائف داخل القوالب إنشاء مكتبات قابلة لإعادة الاستخدام أكثر صعوبة. </li></ol><br>  الأهم من ذلك ، باستخدام لغة القالب ، قمنا "باقتطاع" كائنات Kubernetes لتمثيل خطها.  (بعبارة أخرى ، كان على مطوري النماذج إدارة موارد Kubernetes كمستندات نصية بتنسيق YAML.) <br><br><h2 style=";text-align:right;direction:rtl">  اعمل على الأشياء وليس قطع YAML </h2><br>  سمعنا مرارًا وتكرارًا من المستخدمين طلبًا للقدرة على فحص وتعديل موارد Kubernetes ككائنات ، وليس سلاسل.  في الوقت نفسه ، كانوا مصرين على أنه بغض النظر عن طريقة التنفيذ التي اخترناها لذلك ، يجب أن يكون من السهل التعلم والحفاظ عليها بشكل جيد في النظام البيئي. <br><br>  بعد أشهر من البحث ، قررنا توفير لغة برمجة نصية مدمجة يمكن تعبئتها في وضع الحماية وتخصيصها.  من بين أفضل 20 لغة ، كان هناك مرشح واحد فقط استوفى المتطلبات: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Lua</a> . <br><br>  في عام 1993 ، أنشأت مجموعة من مهندسي تكنولوجيا المعلومات البرازيليين لغة برمجة خفيفة الوزن للتضمين في أدواتهم.  تحتوي Lua على بنية بسيطة ، وهي مدعومة على نطاق واسع وظهرت في قائمة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أفضل 20 لغة</a> لفترة طويلة.  وهو مدعوم من قبل IDE ومحرري النصوص ، وهناك العديد من الكتيبات والبرامج التعليمية.  في مثل هذا النظام البيئي الحالي ، نود تطوير حلنا. <br><br>  لا يزال عملنا في Helm Lua في مرحلة الإثبات المفاهيمي ، ونتوقع بناء جملة مألوف ومرن.  بمقارنة النهجين القديم والجديد ، يمكنك أن ترى أين نتجه. <br><br>  فيما يلي <a href="">مثال</a> على قالب الموقد مع Alpine في Helm 2: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apiVersion: v1 kind: Pod metadata: name: {{ template "alpine.fullname" . }} labels: heritage: {{ .Release.Service }} release: {{ .Release.Name }} chart: {{ .Chart.Name }}-{{ .Chart.Version }} app: {{ template "alpine.name" . }} spec: restartPolicy: {{ .Values.restartPolicy }} containers: - name: waiter image: "{{ .Values.image.repository }}:{{ .Values.image.tag }}" imagePullPolicy: {{ .Values.image.pullPolicy }} command: ["/bin/sleep", "9000"]</code> </pre> <br>  في هذا النموذج <code>{{ .Chart.Name }}</code> ، يمكنك أن ترى على الفور جميع توجيهات القالب المضمنة ، مثل <code>{{ .Chart.Name }}</code> . <br><br>  وإليك تعريف الموقد نفسه في النسخة الأولية من قانون لوا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs">unction create_alpine_pod(_) <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> pod = { apiVersion = <span class="hljs-string"><span class="hljs-string">"v1"</span></span>, kind = <span class="hljs-string"><span class="hljs-string">"Pod"</span></span>, metadata = { name = alpine_fullname(_), labels = { heritage = _.Release.Service <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"helm"</span></span>, release = _.Release.Name, chart = _.Chart.Name .. <span class="hljs-string"><span class="hljs-string">"-"</span></span> .. _.Chart.Version, app = alpine_name(_) } }, spec = { restartPolicy = _.Values.restartPolicy, containers = { { name = waiter, image = _.Values.image.repository .. <span class="hljs-string"><span class="hljs-string">":"</span></span> .. _.Values.image.tag, imagePullPolicy = _.Values.image.pullPolicy, command = { <span class="hljs-string"><span class="hljs-string">"/bin/sleep"</span></span>, <span class="hljs-string"><span class="hljs-string">"9000"</span></span> } } } } } _.resources.add(pod) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  ليست هناك حاجة للنظر في كل سطر من هذا المثال لفهم ما يحدث.  من الواضح على الفور أنه في التعليمات البرمجية يتم تعريفه تحت.  ولكن بدلاً من استخدام سلاسل YAML مع توجيهات القالب المضمنة ، فإننا نعرّفها ككائن في Lua. <br><br><h2 style=";text-align:right;direction:rtl">  دعونا نختصر هذا الرمز </h2><br>  نظرًا لأننا نعمل مباشرة مع الكائنات (بدلاً من معالجة جزء كبير من النص) ، يمكننا الاستفادة الكاملة من البرمجة النصية.  تبدو فرص إنشاء مكتبات مشتركة تظهر هنا جذابة حقًا.  ونأمل أنه من خلال تقديم مكتبات متخصصة (أو السماح للمجتمع بإنشائها) ، يمكننا تقليل الرمز أعلاه إلى شيء مثل هذا: <br><br><pre style=";text-align:right;direction:rtl"> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> pods = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">"mylib.pods"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_alpine_pod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_)</span></span></span></span> myPod = pods.new(<span class="hljs-string"><span class="hljs-string">"alpine:3.7"</span></span>, _) myPod.spec.restartPolicy = <span class="hljs-string"><span class="hljs-string">"Always"</span></span> <span class="hljs-comment"><span class="hljs-comment">-- set any other properties _.Manifests.add(myPod) end</span></span></code> </pre> <br>  في هذا المثال ، نستخدم القدرة على العمل مع تعريف المورد ككائن ، والذي يسهل تعيين الخصائص ، مع الحفاظ على دقة وإمكانية قراءة التعليمات البرمجية. <br><br><h2 style=";text-align:right;direction:rtl">  قوالب ... لوا ... لماذا لا نجمعها معًا؟ </h2><br>  على الرغم من أن القوالب ليست رائعة لجميع المهام ، إلا أنها لا تزال تتمتع بمزايا معينة.  القوالب في Go هي تقنية مستقرة مع قاعدة مستخدمين راسخة والعديد من الرسوم البيانية الحالية.  يدعي العديد من مطوري المخططات أنهم يحبون كتابة القوالب.  لذلك ، لن نقوم بإزالة دعم القالب. <br><br>  بدلاً من ذلك ، نريد السماح باستخدام كل من القوالب ولوا في نفس الوقت.  سيتمكن نصوص Lua من الوصول إلى قوالب Helm قبل وبعد عرضها ، مما سيسمح لمطوري المخططات المتقدمة بإجراء تحويلات معقدة على الرسوم البيانية الحالية ، مع الاحتفاظ بالقدرة البسيطة على إنشاء مخططات Helm باستخدام القوالب. <br><br>  يشجعنا للغاية دعم النصوص على Lua ، ولكن في نفس الوقت نتخلص من جزء كبير من هندسة Helm ... <br><br><h2 style=";text-align:right;direction:rtl">  وداعا لتيلير </h2><br>  أثناء تطوير Helm 2 ، قدمنا ​​Tiller كعنصر تكامل مع مدير النشر.  لعب Tiller دورًا مهمًا للفرق التي تعمل على نفس المجموعة: فقد جعل من الممكن التفاعل مع نفس مجموعة الإصدارات للعديد من المسؤولين المختلفين. <br><br>  ومع ذلك ، عمل Tiller كخادم sudo عملاق ، مما يمنح مجموعة واسعة من الحقوق لكل من لديه حق الوصول إلى Tiller.  وكان نظام التثبيت الافتراضي الخاص بنا هو التكوين المسموح به.  لذلك ، كان على مهندسي DevOps و SRE تعلم الخطوات الإضافية لتثبيت Tiller في مجموعات متعددة المستأجرين. <br><br>  علاوة على ذلك ، مع ظهور CRD ، لم يعد بإمكاننا الاعتماد بشكل موثوق على Tiller للحفاظ على الحالة أو العمل كمحور مركزي لمعلومات إصدار Helm.  يمكننا فقط تخزين هذه المعلومات كإدخالات منفصلة في Kubernetes. <br><br>  يمكن تحقيق الهدف الرئيسي من تيلر دون تيلر نفسه.  لذلك ، كان أحد القرارات الأولى التي تم اتخاذها خلال مرحلة تخطيط Helm 3 هو التخلي تمامًا عن Tiller. <br><br><h2 style=";text-align:right;direction:rtl">  تحسين الأمان </h2><br>  بدون Tiller ، تم تبسيط نموذج الأمان Helm بشكل جذري.  يتم تفويض مصادقة المستخدم من قبل Kubernetes.  والتفويض أيضا.  تُعرف حقوق Helm بأنها حقوق Kubernetes (عبر RBAC) ، ويمكن لمسؤولي المجموعات تقييد حقوق Helm بأي مستوى مطلوب من التفاصيل. <br><br><h2 style=";text-align:right;direction:rtl">  الإصدارات ، إصدارات الإصدار ، وتخزين الدولة </h2><br>  في حالة عدم وجود Tiller ، للحفاظ على حالة الإصدارات المختلفة داخل المجموعة ، نحتاج إلى طريقة جديدة لجميع العملاء للتفاعل (في إدارة الإصدار). <br><br>  للقيام بذلك ، قدمنا ​​إدخالين جديدين: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>Release</code> - لتثبيت معين لمخطط معين.  إذا قمنا بتشغيل <code>helm install my-wordpress stable/wordpress</code> ، فسيتم إنشاء إصدار يسمى <code>my-wordpress</code> والحفاظ عليه طوال فترة تثبيت WordPress هذا. </li><li style=";text-align:right;direction:rtl">  <code>ReleaseVersion</code> - في كل مرة تقوم فيها بتحديث مخطط Helm ، تحتاج إلى النظر في ما تغير وما إذا كان التغيير ناجحًا.  <code>ReleaseVersion</code> مرتبط بإصدار ولا يخزن إلا السجلات التي تحتوي على معلومات حول التحديث والتراجع والحذف.  عندما نقوم بتشغيل <code>helm upgrade my-wordpress stable/wordpress</code> ، يظل كائن <code>Release</code> الأصلي كما هو ، ولكن <code>ReleaseVersion</code> كائن <code>ReleaseVersion</code> بمعلومات حول عملية التحديث. </li></ol><br>  سيتم تخزين <code>Releases</code> <code>ReleaseVersions</code> في نفس مساحات الأسماء مثل كائنات المخطط. <br><br>  باستخدام هذه الميزات ، ستتمكن فرق مستخدمي Helm من تتبع سجلات منشآت Helm في المجموعة دون الحاجة إلى Tiller. <br><br><h2 style=";text-align:right;direction:rtl">  لكن انتظر ، هذا ليس كل شيء! </h2><br>  حاولت في هذه المقالة التحدث عن بعض التغييرات الرئيسية في Helm 3. ومع ذلك ، هذه القائمة ليست كاملة على الإطلاق.  <a href="">تتضمن خطة Helm 3 أيضًا</a> تغييرات أخرى ، مثل التحسينات في تنسيق المخطط ، وتحسينات الأداء لمستودعات المخططات ، ونظام أحداث جديد يمكن لمطوري المخططات استخدامه.  نحن أيضًا نصنع إريك ريموند باسم <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">علم آثار الرمز من خلال</a> تنظيف قاعدة الرمز وتحديث المكونات التي فقدت أهميتها في السنوات الثلاث الماضية. <br><br>  <i><b>ملاحظة</b></i>  <i><b>perev.</b></i>  <i>: إنها مفارقة ، ولكن مدير حزم Helm 2 ، عندما يكون <code>install</code> أو <code>upgrade</code> ناجحًا ، أي</i>  <i>لا يضمن وجود إصدار في حالة <code>success</code> أن موارد التطبيق قد تم طرحها بنجاح (على سبيل المثال ، لا توجد أخطاء مثل <code>ImagePullError</code> ).</i>  <i>ربما يسمح لك نموذج الحدث الجديد بإضافة خطافات إضافية للموارد والتحكم بشكل أفضل في عملية الطرح - سنكتشف ذلك قريبًا.</i> <br><br>  مع انضمام Helm إلى CNCF ، ليس فقط Helm 3 مصدر إلهام لنا ، ولكن أيضًا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">متحف Chart</a> ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وأداة اختبار المخططات</a> الرائعة ، <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ومستودع المخططات الرسمي</a> والمشاريع الأخرى تحت رعاية Helm في CNCF.  نحن واثقون من أن إدارة الحزم الجيدة لـ Kubernetes لا تقل أهمية للنظام البيئي السحابي الأصلي مثل مديري الحزم الجيدين لنظام Linux. <br><br><h2 style=";text-align:right;direction:rtl">  ملاحظة من المترجم </h2><br>  اقرأ أيضا في مدونتنا: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مقدمة عملية لمدير مجموعة Kubernetes - Helm</a> " ؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الممارسة مع dapp.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 2. نشر صور Docker في Kubernetes باستخدام Helm</a> "؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">بناء وتثبيت التطبيقات في Kubernetes باستخدام dapp و GitLab CI</a> " ؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">أفضل ممارسات CI / CD مع Kubernetes و GitLab</a> " <i>(مراجعة وتقرير فيديو)</i> ؛ </li><li style=";text-align:right;direction:rtl">  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تجربتنا مع Kubernetes في المشاريع الصغيرة</a> " <i>(تقرير بالفيديو ، يتضمن مقدمة لجهاز Kubernetes التقني).</i> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar417079/">https://habr.com/ru/post/ar417079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar417065/index.html">كيف سبلون ، أو كيف وأين تعلم سبلونك</a></li>
<li><a href="../ar417069/index.html">مرة أخرى حول OpenSSL</a></li>
<li><a href="../ar417071/index.html">الجمعة PHP: ندوات عبر الإنترنت مجانية على Skillbox</a></li>
<li><a href="../ar417073/index.html">يوم مطور أوبر موبايل</a></li>
<li><a href="../ar417075/index.html">CSS Paint API</a></li>
<li><a href="../ar417081/index.html">الشمال ، سوف ، نأمل ، بلد بلا حدود ، أو كيف تتم المشاريع في ظروف سيبيريا قاسية</a></li>
<li><a href="../ar417083/index.html">أحمال عالية من كأس العالم 2018</a></li>
<li><a href="../ar417085/index.html">تقوم المستعرضات بكتم الصوت في تطبيق WebRTC. توقف ماذا؟</a></li>
<li><a href="../ar417087/index.html">HPE Digitize 2018: الحدث والبث المباشر</a></li>
<li><a href="../ar417089/index.html">الكمبيوتر الكمومي: فوتون واحد يحكم الجميع</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>