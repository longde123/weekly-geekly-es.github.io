<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÖüèº üêü üéÖüèæ CAN Driving üßëüèø‚Äçü§ù‚Äçüßëüèæ üéÖüèΩ üíï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√©sentation 
 Le v√©hicule sans pilote StarLine bas√© sur la plateforme Lexus RX 450h est un projet de recherche lanc√© en 2018. Le projet est ouvert au...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>CAN Driving</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450140/"><h3>  Pr√©sentation </h3><br>  <b>Le v√©hicule sans pilote StarLine</b> bas√© sur la plateforme <b>Lexus RX 450h</b> est un projet de recherche lanc√© en 2018.  Le projet est ouvert aux professionnels ambitieux de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">communaut√© Open Source</a> .  Nous proposons √† chacun de participer au processus de d√©veloppement au niveau du code, de tester ses algorithmes sur une vraie voiture √©quip√©e d'un mat√©riel co√ªteux.  Pour contr√¥ler la voiture, il a √©t√© d√©cid√© d'utiliser Apollo, un framework ouvert.  Pour qu'Apollo fonctionne, nous devions connecter un ensemble de modules.  Ces modules aident le programme √† recevoir des informations sur la voiture et √† la contr√¥ler selon les algorithmes sp√©cifi√©s. <br><br>  <b>Ces modules comprennent:</b> <br><br><ul><li>  module de positionnement d'une voiture dans l'espace √† l'aide de coordonn√©es GPS; </li><li>  module de direction, d'acc√©l√©ration et de freinage d'une voiture; </li><li>  module de l'√©tat des syst√®mes automobiles: vitesse, acc√©l√©ration, position du volant, enfoncement des p√©dales, etc.; </li><li>  module pour obtenir des informations sur l'environnement de la voiture.  Les capteurs √† ultrasons, les cam√©ras, les radars et les lidars peuvent g√©rer cela. </li></ul><br>  Tout d'abord, notre √©quipe a √©t√© confront√©e √† la t√¢che d'apprendre √† contr√¥ler le volant, l'acc√©l√©ration et le freinage de la voiture.  Et recevez √©galement des informations sur l'√©tat des syst√®mes automobiles.  Pour cela, beaucoup de travail a √©t√© fait pour √©tudier le bus Lexus CAN. <br><a name="habracut"></a><br><h3>  Partie th√©orique </h3><br><h4>  Qu'est-ce qu'un bus CAN? </h4><br>  Dans les voitures modernes, les syst√®mes √©lectroniques ont pris le contr√¥le de tous les syst√®mes (Fig. 1.).  Les composants √©lectroniques sont des ordinateurs sp√©cialis√©s, dont chacun a toutes les interfaces n√©cessaires pour l'int√©gration avec une voiture.  √Ä l'aide d'interfaces de communication num√©riques, les unit√©s sont mises en r√©seau pour √©changer des informations entre elles.  Les interfaces num√©riques les plus courantes dans les voitures sont CAN, LIN, FLEXRay.  Parmi ceux-ci, le CAN est le plus largement utilis√©. <br><br>  Le bus CAN (Controller Area Network) est le r√©seau standard de l'industrie.  En 1986, cette norme a √©t√© d√©velopp√©e par Bosch.  Et la premi√®re voiture avec un bus CAN √©tait la Mercedes-Benz W140, sortie en 1991.  La norme a √©t√© d√©velopp√©e pour permettre aux appareils de communiquer entre eux sans h√¥te.  Les informations sont √©chang√©es √† l'aide de messages sp√©ciaux, qui se composent de champs d'identification, de la longueur du message et de donn√©es.  Chaque bloc a son propre ensemble d'ID.  Dans ce cas, un message avec un ID inf√©rieur est prioritaire sur le bus.  Le champ de donn√©es peut contenir des informations, par exemple, sur l'√©tat des syst√®mes et des capteurs, des commandes pour contr√¥ler les m√©canismes, etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e6/109/0a4/1e61090a4149347d85f1b19488b27e94.jpg" alt="image"><br>  <i>Fig.</i>  <i>1. Bus CAN v√©hicule.</i> <br><br>  Au niveau physique, le bus est une paire torsad√©e de conducteurs en cuivre.  Le signal est transmis diff√©rentiellement, ce qui permet d'obtenir une immunit√© au bruit √©lev√©e. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/288/59d/b2f/28859db2fc4d7f30bb521f4e6c0a3123.jpg" alt="image"><br>  <i>Fig.</i>  <i>2. Repr√©sentation physique du signal sur le bus CAN</i> <br><br>  Via le bus CAN, vous pouvez recevoir des informations sur l'√©tat des diff√©rents capteurs et syst√®mes du v√©hicule.  √âgalement via CAN, vous pouvez contr√¥ler les composants de la voiture.  Ce sont ces opportunit√©s que nous utilisons pour notre projet. <br><br>  Nous avons choisi Lexus RX parce que nous savions que nous pouvions g√©rer tous les n≈ìuds n√©cessaires via CAN.  Depuis la chose la plus difficile lors de la recherche d'une voiture est des protocoles ferm√©s.  Par cons√©quent, l'une des raisons du choix de ce mod√®le de voiture particulier √©tait la pr√©sence d'une description de la partie du protocole de bus CAN dans le projet open source Openpilot. <br><br>  Conduire correctement une voiture signifie comprendre le fonctionnement des pi√®ces m√©caniques des syst√®mes d'une voiture.  Nous devions avoir une bonne compr√©hension de la fa√ßon de travailler avec un amplificateur de puissance √©lectrique ou de contr√¥ler la d√©c√©l√©ration d'une voiture.  En effet, par exemple, lorsque les roues tournent, elles cr√©ent une r√©sistance √† la direction, ce qui introduit des restrictions sur la direction lors des virages.  Certains syst√®mes ne peuvent pas √™tre utilis√©s sans entrer dans la voiture dans des modes de fonctionnement sp√©ciaux.  Nous avons d√ª √©tudier ces d√©tails et d'autres dans le processus. <br><br><h4>  Direction assist√©e √©lectrique </h4><br>  La direction assist√©e √©lectrique EPS (direction assist√©e √©lectrique) est un syst√®me con√ßu pour r√©duire la force de direction lors des virages (Fig. 3).  Le pr√©fixe "electro" parle du type de syst√®me - √©lectrique.  La direction du volant avec ce syst√®me devient confortable, le conducteur tourne le volant dans la bonne direction et le moteur √©lectrique aide √† le tourner √† l'angle souhait√©. <br><br>  Un amplificateur de puissance √©lectrique est install√© sur l'arbre de direction d'une voiture, dont les parties sont reli√©es entre elles par un arbre de torsion.  Un capteur de couple (capteur de couple) est mont√© sur l'arbre de torsion.  Lorsque le volant tourne, l'arbre de torsion se tord, ce qui est enregistr√© par le capteur de couple.  Les donn√©es re√ßues du capteur de couple, des capteurs de vitesse et des r√©volutions du vilebrequin sont transmises √† l'unit√© de commande √©lectronique de l'ECU.  Et l'ECU, √† son tour, calcule d√©j√† la force de compensation n√©cessaire et donne une commande au moteur √©lectrique de l'amplificateur. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5b7/b45/063/5b7b4506386956bd872df48432858d8c.jpg" alt="image"><br>  <i>Fig.</i>  <i>3. Sch√©ma de principe du syst√®me de direction assist√©e √©lectrique</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Fkgp64e-nNQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>Vid√©o: Le syst√®me LKA pilote une voiture √† l'aide du syst√®me EPS.</i> <br><br><h4>  P√©dale d'acc√©l√©rateur √©lectronique </h4><br>  L'acc√©l√©rateur est un m√©canisme permettant de r√©gler la quantit√© de m√©lange de carburant qui tombera dans le moteur.  Plus il y a de m√©lange, plus la voiture va vite. <br>  La p√©dale de gaz √©lectronique est un syst√®me qui implique le fonctionnement de plusieurs composants √©lectroniques.  Le signal concernant la position de la p√©dale, lorsqu'elle est enfonc√©e, entre dans l'unit√© de commande du moteur ECM (Engine Control Module).  L'ECM, sur la base de ce signal, calcule la quantit√© de carburant requise qui doit √™tre fournie au moteur.  Selon la quantit√© de carburant n√©cessaire, l'ECM ajuste l'angle d'ouverture de l'acc√©l√©rateur. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6e8/16b/a1b/6e816ba1b6d687c9849321d8aac3f431.jpg" alt="image"><br>  <i>Fig.</i>  <i>4. Le syst√®me √©lectronique de p√©dale d'acc√©l√©rateur.</i> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/98brdhB3n04" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i>Vid√©o: la p√©dale d'acc√©l√©rateur √©lectronique est utilis√©e pour actionner le r√©gulateur de vitesse.</i> <br><br><h4>  Syst√®mes √©lectroniques d'aide √† la conduite </h4><br>  Nous avons achet√© une voiture qui est √©quip√©e d'une vari√©t√© d'unit√©s num√©riques et de syst√®mes d'aide √† la conduite (ADAS).  Dans notre projet, nous utilisons LKA, ACC et PCS. <br><br>  LKA (Lane Keep Assist) est un syst√®me de r√©tention de bande compos√© d'une cam√©ra frontale et d'une unit√© informatique.  LKA garde la voiture dans la voie lorsque le conducteur, par exemple, est distrait.  Les algorithmes de l'unit√© de calcul re√ßoivent des donn√©es de la cam√©ra et en fonction de ceux-ci prennent une d√©cision sur l'√©tat de la voiture sur la route.  Le syst√®me est capable de comprendre que la voiture se d√©place de mani√®re incontr√¥lable vers la voie de droite ou de gauche.  Dans de tels cas, un bip retentit pour attirer l'attention du conducteur.  Lors du franchissement de la voie, le syst√®me lui-m√™me ajustera l'angle de rotation des roues afin que la voiture reste dans la voie.  Le syst√®me ne doit intervenir que s'il se rend compte que la man≈ìuvre entre les voies n'a pas √©t√© provoqu√©e par le conducteur. <br><br>  ACC (Adaptive Cruise Control) - un syst√®me de r√©gulateur de vitesse adaptatif qui vous permet de r√©gler la vitesse souhait√©e.  La voiture elle-m√™me acc√©l√®re et ralentit pour maintenir la vitesse souhait√©e, tandis que le conducteur peut retirer son pied des p√©dales d'acc√©l√©rateur et de frein.  Ce mode est pratique √† utiliser lors de la conduite sur autoroutes et autoroutes.  Le r√©gulateur de vitesse adaptatif est capable de voir les obstacles devant la voiture et de ralentir pour √©viter les collisions avec eux.  Si un autre v√©hicule √† une vitesse inf√©rieure roule en avant, l'ACC ralentira et suivra.  Lorsqu'un objet statique est d√©tect√©, l'ACC ralentit jusqu'√† ce qu'il s'arr√™te.  Pour d√©tecter des objets devant la voiture, un tel syst√®me utilise un radar avec une gamme de longueurs d'onde millim√©triques.  En r√®gle g√©n√©rale, ces radars fonctionnent √† une fr√©quence de 24 √† 72 GHz et sont capables de voir en toute confiance des objets √† une distance de 300 m√®tres.  Le radar est g√©n√©ralement install√© derri√®re le badge avant sur la calandre. <br><br>  PCS (Pre-Collision System) - syst√®me anti-collision.  Le syst√®me est con√ßu pour √©viter une collision avec une voiture qui se d√©place devant.  Lorsqu'une collision est in√©vitable, le syst√®me minimise les dommages par collision.  Il utilise √©galement un radar pour estimer la distance √† l'objet et une cam√©ra frontale pour sa reconnaissance.  Le front PCS pr√©dit la probabilit√© d'une collision en fonction de la vitesse du v√©hicule, de la distance √† l'objet et de sa vitesse.  En r√®gle g√©n√©rale, un syst√®me comporte deux √©tapes de fonctionnement.  La premi√®re √©tape - le syst√®me sonne et affiche sur le tableau de bord informe le conducteur du danger.  Deuxi√®me √©tape - le freinage d'urgence est activ√© √† l'aide du syst√®me ABS et les pr√©tendeurs de ceinture de s√©curit√© sont activ√©s. <br><br><h3>  Partie pratique </h3><br><h4>  Volant </h4><br>  La premi√®re chose que notre √©quipe voulait faire √©tait d'apprendre √† piloter.  Le volant d'une voiture peut √™tre contr√¥l√© par deux syst√®mes: l'assistant de stationnement IPAS (Intelligent Park Assist) et le LKA. <br><br>  IPAS vous permet de r√©gler l'angle de braquage en degr√©s directement.  Notre voiture ne disposant pas de ce syst√®me, il est impossible de contr√¥ler et de ma√Ætriser la direction de cette mani√®re. <br><br>  Par cons√©quent, nous avons √©tudi√© les circuits √©lectriques de la voiture et r√©alis√© quels bus CAN pourraient √™tre utiles.  Nous avons connect√© un analyseur de bus CAN.  Le journal contient un fichier d'enregistrements de messages dans le bus dans un ordre chronologique.  Notre t√¢che consistait √† trouver des √©quipes de direction assist√©e EPS (direction assist√©e √©lectrique).  Nous avons pris le journal du volant d'un c√¥t√© √† l'autre, dans le journal, nous avons pu trouver les lectures de l'angle de rotation et de la vitesse de rotation du volant.  Voici un exemple de modification des donn√©es dans le bus CAN.  Les donn√©es qui nous int√©ressent sont mises en √©vidence avec un marqueur. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e9e/2ff/eee/e9e2ffeee019069421b869be9fb6d6d4.gif" alt="image"><br>  <i>Direction √† 360 degr√©s vers la gauche</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b5/259/583/3b5259583320120b011d47f3c4517dd8.gif" alt="image"><br>  <i>Tournez le volant de 270 degr√©s vers la droite</i> <br><br>  Dans l'√©tape suivante, nous avons examin√© le syst√®me de r√©tention des voies.  Pour ce faire, nous sommes all√©s dans une rue calme et avons enregistr√© les journaux d'√©change entre l'unit√© de maintien de voie et le DSU (Driving Support ECU).  √Ä l'aide de l'analyseur de bus CAN, nous avons pu calculer les messages du syst√®me LKA.  La figure 6 montre la commande de contr√¥le EPS. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/76f/2a7/159/76f2a7159e1b5b36232ae0702079af45.jpg" alt="image"><br>  <i>Fig.</i>  <i>5. Commande de direction √† l'aide du syst√®me LKA</i> <br><br>  Le LKA commande le volant en r√©glant la valeur de couple sur l'arbre (STEER_TORQUE_CMD) du volant.  La commande est accept√©e par le module EPS.  Chaque message contient une valeur de compteur (COUNTER) dans l'en-t√™te, qui est incr√©ment√©e √† chaque envoi.  Le champ LKA_STATE contient des informations d'√©tat LKA.  Pour capturer le contr√¥le, vous devez d√©finir le bit STEER_REQUEST. <br><br>  Les messages qui sont responsables du fonctionnement des syst√®mes automobiles importants sont prot√©g√©s par une somme de contr√¥le (CHECKSUM) pour minimiser les risques de fausses alarmes.  La voiture ignorera une telle commande si le message contient une somme de contr√¥le ou une valeur de compteur incorrecte.  Il s'agit d'une protection con√ßue par le fabricant contre les interf√©rences de syst√®mes tiers et les interf√©rences dans la ligne de communication. <br><br>  Le graphique (Fig. 6.) montre le diagramme de fonctionnement du LKA.  Capteur de couple - valeur du capteur de couple sur l'arbre de torsion.  Torque Cmd est une √©quipe de LKA pour la direction.  La photo montre comment la LKA est dirig√©e pour maintenir la voiture dans la voie.  Lors du passage par z√©ro, le sens de rotation du volant change.  C'est-√†-dire  un signal n√©gatif indique un virage √† droite, une valeur positive √† gauche.  Le maintien de la commande √† z√©ro indique un manque de contr√¥le de la LKA.  Avec l'intervention du conducteur, le syst√®me cesse d'√©mettre le contr√¥le.  LKA d√©tecte l'intervention du conducteur avec un deuxi√®me capteur de couple sur l'arbre c√¥t√© volant. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2ac/562/2c8/2ac5622c84943c61207d0ac0c17a20fa.jpg" alt="image"><br>  <i>Fig.</i>  <i>6. Calendrier du syst√®me LKA</i> <br><br>  Nous avons d√ª v√©rifier le travail de l'√©quipe de pilotage.  √Ä l'aide du module StarLine Sigma 10, nous avons pr√©par√© le micrologiciel pour les tests de contr√¥le.  StarLine Sigma 10 devrait √©mettre des commandes au volant pour tourner le volant √† gauche ou √† droite.  A cette √©poque, nous n'avions pas d'interface graphique pour contr√¥ler le module, nous avons donc d√ª utiliser les moyens standards de la voiture.  Nous avons trouv√© l'√©tat de la position du levier du r√©gulateur de vitesse dans le bus CAN et programm√© le module de telle sorte que la position sup√©rieure du levier a conduit le volant √† tourner √† droite, la position inf√©rieure √† tourner √† gauche (Fig.7). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/147/82e/068/14782e068fe5ac6bc3636603d2113cee.gif" alt="image"><br>  <i>Fig.</i>  <i>7. Les premi√®res tentatives de pilotage</i> <br><br>  La vid√©o montre que le contr√¥le est effectu√© en courtes sections.  Cela se produit pour plusieurs raisons. <br><br>  La premi√®re raison est le manque de r√©troaction.  Si l'√©cart entre le signal de couple Cmd et le capteur de couple d√©passe une certaine valeur Œî, le syst√®me cesse automatiquement d'accepter les commandes (Fig. 8).  Nous r√©glons l'algorithme pour ajuster la commande de sortie (couple CMD) en fonction de la valeur du couple sur l'arbre (capteur de couple). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3bd/ff5/458/3bdff5458f46a6de9f48598a735db625.jpg" alt="image"><br>  <i>Fig.</i>  <i>8. Un √©cart de signal entra√Æne une erreur syst√®me</i> <br><br>  La restriction suivante est li√©e au syst√®me de s√©curit√© int√©gr√© √† EPS.  Le syst√®me EPS ne permet pas aux √©quipes LKA de se diriger sur une large gamme.  Ce qui est assez logique, car  lors de la conduite sur route, les man≈ìuvres brusques ne sont pas s√ªres.  Ainsi, lorsque la valeur seuil du couple sur l'arbre est d√©pass√©e, le syst√®me LKA g√©n√®re une erreur et s'√©teint (Fig.9). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/360/888/015/3608880153b575b2874efd8db45fe7f8.jpg" alt="image"><br>  <i>Fig.</i>  <i>9. D√©passement de la valeur seuil de la commande de couple sur l'arbre</i> <br><br>  Que le syst√®me LKA soit activ√© ou non, des messages avec des commandes sont constamment pr√©sents sur le bus.  Nous demandons au module EPS de tourner les roues avec une force sp√©cifique √† gauche ou √† droite.  Pendant ce temps, LKA interrompt nos packages avec des messages "vides".  Apr√®s notre √©quipe avec la valeur du moment, la norme vient avec z√©ro (Fig.10). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c0a/85b/1a9/c0a85b1a9ad409684dbcb740acfd18ed.jpg" alt="image"><br>  <i>Fig.</i>  <i>10. Les messages r√©guliers sont livr√©s avec des valeurs de moment nul et interrompent notre contr√¥le</i> <br><br>  Ensuite, en utilisant le module StarLine Sigma 10, nous avons pu filtrer tout le trafic provenant de LKA et bloquer les messages avec l'ID 2E4 lorsque nous en avions besoin.  Cela a r√©solu le probl√®me et nous avons r√©ussi √† obtenir une commande de direction fluide (Fig. 11). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/712/6ab/cff/7126abcff6446d6a6477c667880747a7.jpg" alt="image"><br>  <i>Fig.</i>  <i>11. R√©glage en douceur du volant sans erreurs</i> <br><br><h4>  Gestion du gaz </h4><br>  Le syst√®me ACC Adaptive Cruise Control contr√¥le le logiciel d'acc√©l√©ration et de freinage via le bus CAN.  L'unit√© de commande du moteur ECU re√ßoit les commandes DSU, si vous devez acc√©l√©rer, elle active la p√©dale de gaz √©lectronique.  Le freinage r√©g√©n√©ratif est utilis√© pour freiner la voiture.  Dans ce cas, une commande est utilis√©e pour le freinage et l'acc√©l√©ration, seules les valeurs diff√®rent. <br><br>  La commande de commande d'acc√©l√©ration ou de d√©c√©l√©ration est illustr√©e √† la figure 12. Elle se compose de la valeur d'acc√©l√©ration ACCEL_CMD, d'une paire de bits de surd√©bit et d'une somme de contr√¥le de somme de contr√¥le.  Pour l'acc√©l√©ration du v√©hicule, ACCEL_CMD est positif; pour la d√©c√©l√©ration, n√©gatif.  L'acc√©l√©ration est r√©gl√©e dans la plage de 0 √† 3 m / s ^ 2, la d√©c√©l√©ration est similaire, mais avec un signe moins.  Pour envoyer des donn√©es au bus, il est n√©cessaire de recalculer l'acc√©l√©ration ou la d√©c√©l√©ration souhait√©e avec un coefficient de 0,001.  Par exemple, pour acc√©l√©rer 1 m / s ^ 2, ACCEL_CMD = 1000 (0x03E8). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4fc/0a2/042/4fc0a20425a9718cb90eb40f4b5a127f.jpg" alt="image"><br>  <i>Fig.</i>  <i>12. La commande pour contr√¥ler l'acc√©l√©ration / d√©c√©l√©ration de la voiture</i> <br><br>  Nous avons supprim√© les journaux du syst√®me ACC standard et analys√© les √©quipes.  Compar√© √† notre description des √©quipes et commenc√© les tests. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f37/e3d/9a4/f37e3d9a42d8164a6b5e1f21c4fba704.gif" alt="image"><br>  <i>Fig.</i>  <i>13. Journal d'acc√©l√©ration / d√©c√©l√©ration du r√©gulateur de vitesse adaptatif ACC (mis en √©vidence par un marqueur)</i> <br><br>  Ce ne fut pas sans difficult√©s.  Nous avons roul√© sur une route tr√®s fr√©quent√©e pour tester l'√©quipe d'acc√©l√©ration.  Les commandes de contr√¥le d'acc√©l√©ration ou de d√©c√©l√©ration du v√©hicule ne fonctionnent que lorsque le r√©gulateur de vitesse est activ√©, il ne suffit pas de l'activer avec le bouton.  Il est n√©cessaire de trouver la voiture qui se d√©place devant et d'activer le mode suivant. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9e0/4eb/012/9e04eb01233c579da82c01d623c05c40.gif" alt="image"><br>  <i>Fig.</i>  <i>14. L'activation du r√©gulateur de vitesse se produit lorsqu'un autre v√©hicule se trouve devant</i> <br><br>  En utilisant le module StarLine Sigma 10, nous envoyons une commande d'acc√©l√©ration et la voiture commence √† prendre de la vitesse.  √Ä ce stade, nous avons connect√© l'interface graphique pour contr√¥ler le module StarLine Sigma 10. Nous contr√¥lons maintenant le volant, l'acc√©l√©ration et le freinage √† l'aide des boutons de l'application. <br><br>  Les √©quipes ont travaill√© jusqu'√† ce qu'elles perdent la voiture devant elles.  Le r√©gulateur de vitesse a √©t√© d√©sactiv√© et les commandes d'acc√©l√©ration ont donc cess√© de fonctionner. <br>  Nous avons commenc√© √† √©tudier la possibilit√© d'utiliser des √©quipes sans r√©gulateur de vitesse actif.  J'ai d√ª passer beaucoup de temps √† analyser les donn√©es dans le bus CAN pour comprendre comment cr√©er les conditions de travail des √©quipes.  Nous nous sommes d'abord int√©ress√©s au bloc qui bloque l'ex√©cution des commandes ACC pour l'acc√©l√©ration ou la d√©c√©l√©ration.  J'ai d√ª √©tudier les identifiants qui proviennent du DSU, du LKA, du radar et de la cam√©ra, en repoussant les fausses donn√©es de divers capteurs. <br><br>  La d√©cision est venue 3 semaines plus tard.  √Ä ce moment-l√†, nous avions une id√©e de la fa√ßon dont les blocs de la voiture interagissaient, avons men√© une √©tude du trafic des messages et identifi√© des groupes de messages envoy√©s par chaque bloc.  Le calculateur d'assistance √† la conduite (DSU) est responsable du r√©gulateur de vitesse adaptatif ACC.  Le DSU √©met des commandes pour acc√©l√©rer et ralentir la voiture, et c'est cette unit√© qui re√ßoit les donn√©es du radar √† port√©e millim√©trique.  Le radar indique au DSU √† quelle distance de la machine l'objet se d√©place, √† quelle vitesse relative et d√©termine sa position horizontale (√† gauche, √† droite ou au centre). <br><br>  Notre id√©e √©tait de remplacer les donn√©es radar.  Nous avons enlev√© le journal pour suivre la voiture, nous en avons retir√© les donn√©es radar au moment de suivre.  Maintenant, apr√®s avoir allum√© le r√©gulateur de vitesse, nous envoyons de fausses donn√©es sur la pr√©sence d'une voiture devant.  Il s'av√®re que nous trompons notre voiture, en disant qu'une autre voiture devant se d√©place √† une distance sp√©cifique. <br><br>  a) <img src="https://habrastorage.org/getpro/habr/post_images/18e/762/ed2/18e762ed2cf1f72b3240fe1bc3647048.gif" alt="image">  b) <img src="https://habrastorage.org/getpro/habr/post_images/be9/c16/276/be9c162764819ce5e0f733c67506ac4d.gif" alt="image"><br>  <i>Fig.</i>  <i>15. Activation de la croisi√®re: a) tentative d'activation sans remplacer les donn√©es radar;</i>  <i>b) activation lors du remplacement des donn√©es du radar.</i> <br><br>  Lorsque nous commen√ßons notre accroc, sur le tableau de bord, l'ic√¥ne de pr√©sence du v√©hicule devant est allum√©e.  Nous pouvons maintenant tester notre gestion.  Nous d√©marrons la commande d'acc√©l√©ration et la voiture commence √† acc√©l√©rer rapidement. <br><br>  Comme nous l'avons d√©j√† appris, la commande d'acc√©l√©ration et de d√©c√©l√©ration en est une.  Par cons√©quent, ils ont imm√©diatement v√©rifi√© la d√©c√©l√©ration.  Nous sommes all√©s √† grande vitesse avec le r√©gulateur de vitesse actif, avons lanc√© une commande de freinage et la voiture a imm√©diatement ralenti. <br><br>  En cons√©quence, il s'av√®re maintenant acc√©l√©rer et ralentir la voiture exactement comme nous en avions besoin. <br><br>  Le but est atteint. <br><br><h4>  Quoi d'autre utilisons-nous </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pour cr√©er un drone, il est n√©cessaire de contr√¥ler les syst√®mes auxiliaires: clignotants, feux stop, alarmes, klaxon, etc. Tout cela peut √©galement √™tre contr√¥l√© via le bus CAN. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mat√©riel et logiciel </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pour travailler avec la voiture aujourd'hui, nous utilisons un ensemble de divers √©quipements: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'analyseur de bus Marathon vous permet de connecter et de lire les donn√©es de deux bus simultan√©ment. </font><font style="vertical-align: inherit;">Le site du fabricant de l'analyseur propose un logiciel gratuit d'analyse des journaux. </font><font style="vertical-align: inherit;">Mais nous utilisons des logiciels √©crits dans notre entreprise pour un usage interne.</font></font></li><li>  StarLine  10         .   CAN  LIN .       C,       .       CAN-.    ,  ID         . </li><li>   Toyota/Lexus.          : , -, ,  . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aujourd'hui, un travail actif est en cours pour d√©velopper un v√©hicule sans pilote, dans un avenir proche, la mise en ≈ìuvre du freinage d'urgence avant les obstacles, leur d√©tour et la restructuration de l'itin√©raire de la voiture en fonction de la circulation et des instructions du conducteur. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le v√©hicule sans pilote StarLine</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est une plate-forme ouverte pour combiner les meilleurs esprits de l'ing√©nierie de la Russie et du monde dans le but de cr√©er des technologies de conduite sans pilote avanc√©es qui rendront notre avenir s√ªr et confortable. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Projet Gitlab</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr450140/">https://habr.com/ru/post/fr450140/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr450130/index.html">Les √©quipes survivent-elles apr√®s le hackathon?</a></li>
<li><a href="../fr450132/index.html">Impossible d'expliquer la monade</a></li>
<li><a href="../fr450134/index.html">La deuxi√®me vie des bagues et des broches: comment recr√©er rapidement des bijoux en utilisant la technologie 3D</a></li>
<li><a href="../fr450136/index.html">Quand les murs ne suffisent pas. Comment prot√©ger les points de terminaison</a></li>
<li><a href="../fr450138/index.html">R√©sum√© de la gestion des produits # 7 (mars - avril 2019)</a></li>
<li><a href="../fr450142/index.html">En mai: ordonn√© - de survivre</a></li>
<li><a href="../fr450144/index.html">Comment les nouvelles technologies rapprochent-elles le r√™ve de l'immortalit√©?</a></li>
<li><a href="../fr450146/index.html">Mon erreur d'un milliard de dollars</a></li>
<li><a href="../fr450148/index.html">Un Veeam ONE. Renseignements, cartes, agents et bien plus encore - aujourd'hui sur les √©crans du pays</a></li>
<li><a href="../fr450150/index.html">Security Week 18: l'attaque de ShadowHammer en d√©tail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>