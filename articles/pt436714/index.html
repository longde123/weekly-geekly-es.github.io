<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçª üòü ‚úåüèº O trabalho come√ßa com o teste. üë®üèº‚Äçü§ù‚Äçüë®üèª ‚ÜòÔ∏è üö£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Na vida de todo desenvolvedor, chega um momento em que ele pensa em criar um componente de teste para sua ideia. Vou melhorar - na vida de todo bom de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O trabalho come√ßa com o teste.</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436714/">  Na vida de todo desenvolvedor, chega um momento em que ele pensa em criar um componente de teste para sua ideia.  Vou melhorar - na vida de todo bom desenvolvedor.  Quando voc√™ √© j√∫nior e n√£o assume nenhuma responsabilidade especial, tem direito a muitos erros e pode corrigi-los a qualquer momento.  Voc√™ n√£o √© respons√°vel pelo produto criado e n√£o tem motiva√ß√£o para gastar um minuto extra para verificar novamente o c√≥digo gerado.  ‚ÄúNada, esse batente n√£o pode ser reproduzido‚Äù, ‚Äúisso parece funcionar‚Äù, ‚Äúbem, pelo menos, faz o que precisa ser‚Äù - se voc√™ quiser superar o n√≠vel do ber√ß√°rio do programador, ter√° que negar cada um desses pensamentos. <br><br>  Com o desenvolvimento de sua pr√≥pria experi√™ncia de programa√ß√£o, voc√™ tem novos e mais legais e grandes clientes.  Voc√™ ficar√° encantado com alguns (de todos, se tiver sorte) - as pessoas s√£o boas e pagam generosamente e n√£o s√£o exigentes quanto aos problemas que surgem.  Vejamos um caso simples (muito simples, mas a principal coisa por tr√°s disso) de criar um manipulador de formul√°rios a partir de um programador que n√£o conhece o inc√¥modo. <br><a name="habracut"></a><br>  Ent√£o, a tarefa simples chegou - escrever um manipulador de formul√°rios.  O objetivo √© aceitar solicita√ß√µes de clientes para a compra de tijolos.  O cliente √© grande, ele est√° envolvido em grandes entregas de tijolos a granel (por exemplo, para uma quantidade superior a 500.000 rublos - para sentir pelo menos algum n√≠vel de responsabilidade pelo que est√° acontecendo).  A concorr√™ncia √© acirrada - os clientes podem ir rapidamente ao fornecedor de tijolos se n√£o responderem dentro de um dia. <br><br>  Foi dito ao nosso programador que √© necess√°rio salvar os dados do cliente a partir do formul√°rio - o nome do representante, n√∫mero de telefone, nome da empresa do cliente, volume do pedido e um campo opcional de descri√ß√£o do pedido.  No c√©rebro de Porakinin, um formul√°rio simples foi criado rapidamente com campos padr√£o para a frente do site: <br><br><img src="http://dl4.joxi.net/drive/2019/01/16/0025/3302/1694950/50/6d6647072b.png" alt="o formul√°rio"><br><br>  Os dados do formul√°rio s√£o enviados por uma solicita√ß√£o AJAX, sem recarregar a p√°gina.  Al√©m disso, o programador assume o design do manipulador de formul√°rios e precisa lidar com uma tarefa bastante trivial - adicionar entradas para o novo cliente √† tabela de pedidos j√° existente e enviar ao cliente um e-mail com uma notifica√ß√£o sobre o novo cliente. <br><br><img src="http://dl3.joxi.net/drive/2019/01/16/0025/3302/1694950/50/4393f0f44e.png" alt="c√≥digo de inser√ß√£o simples"><br><br>  O formul√°rio funciona, os dados s√£o salvos com sucesso, o cliente est√° satisfeito.  Mas, de repente, uma liga√ß√£o irritada √© recebida pelo cliente: "assim, eles dizem que o pedido chegou - a empresa milion√°ria quer comprar todos os tijolos de mim, mas o n√∫mero de telefone n√£o veio do formul√°rio e como posso contat√°-los agora?!  Amanh√£ encontrar√£o outro fornecedor!  Como assim o que voc√™ fez ?!  A culpa √© sua ... "  O cliente rasga e joga, menos nervos, menos confian√ßa e menos respeito.  A situa√ß√£o √© extremamente padr√£o para um j√∫nior - a aus√™ncia de qualquer valida√ß√£o e teste dos dados recebidos do formul√°rio.  A primeira tarefa (valida√ß√£o) √© resolvida extremamente simplesmente adicionando regras de valida√ß√£o: <br><br><img src="http://dl4.joxi.net/drive/2019/01/16/0025/3302/1694950/50/3cbaa9c0e8.png" alt="valida√ß√£o"><br><cut><br>  A partir de agora, o cliente do site indicar√° apenas os dados corretos necess√°rios para o processamento posterior.  No mesmo est√°gio, o desenvolvedor tem a id√©ia de testar o c√≥digo para evitar ainda mais uma situa√ß√£o t√£o embara√ßosa.  Por exemplo, testar o campo de sobrenome ter√° esta apar√™ncia (para simplificar o exemplo b√°sico, a prote√ß√£o csrf est√° desativada): <br><br><img src="http://dl3.joxi.net/drive/2019/01/16/0025/3302/1694950/50/00ccfbb500.png" alt="teste de campo ausente"><br><br>  Sabemos que, na aus√™ncia desse campo, o c√≥digo deve retornar uma resposta com um erro e um status de 400 prescritos por n√≥s. Esses m√©todos de teste s√£o prescritos para cada situa√ß√£o espec√≠fica (ou valida√ß√£o de campo espec√≠fica, tudo depende das tarefas e da imagina√ß√£o do desenvolvedor). <br><br>  Mas existe um m√©todo de desenvolvimento diferente do que "eu fiz, mas agora vou verificar"?  Primeiro escrevemos o c√≥digo, trope√ßamos nos batentes da execu√ß√£o, corrigimos e depois lembramos dos testes.  Essa abordagem pode ir de sosla para n√≥s e nossos clientes, considerando o cliente multimilion√°rio perdido (embora teoricamente todos esses clientes ficariam).  E ent√£o me perguntei - e se come√ßarmos a l√≥gica de criar o aplicativo pelo lado oposto - primeiro faremos exig√™ncias ao "executor" e depois faremos com que atenda a esses requisitos?  Vamos tentar. <br><br>  Deixamos a tarefa como antes, mudamos apenas a abordagem.  Precisamos escrever um manipulador de formul√°rios com os campos fio, telefone, corp, quant e conte√∫do.  O resultado da execu√ß√£o bem-sucedida √© o status 200, adicionando um campo ao Pedido com a mensagem "ok" e retornando dados no registro inserido, outras op√ß√µes - status 400 e uma lista de erros. <br><cut><br>  Primeiro, precisamos escrever um m√©todo de teste para preencher validamente os dados do formul√°rio: <br><br><img src="http://dl3.joxi.net/drive/2019/01/16/0025/3302/1694950/50/479183d938.png" alt="m√©todo v√°lido"><br><br>  Em seguida, crie a rota e o m√©todo do controlador necess√°rios (enquanto vazio).  Se executarmos o teste agora, espera-se um erro.  Validar dados v√°lidos n√£o √© tudo o que precisamos.  Agora come√ßamos a testar a valida√ß√£o do campo do formul√°rio.  Determinamos quais campos s√£o obrigat√≥rios - fio, telefone, corp, quant e adicionamos um m√©todo para verifica√ß√£o (o coment√°rio √© opcional): <br><br><img src="http://dl3.joxi.net/drive/2019/01/16/0025/3302/1694950/50/9fbc334d6e.png" alt="vazio"><br><br>  O manipulador de formul√°rios simplesmente ter√° que verificar se h√° dados recebidos fio, telefone, corp, quant.  Como removemos todos os campos obrigat√≥rios da solicita√ß√£o, um erro nos erros deve ser retornado para cada um deles.  No caso de pelo menos um deles n√£o estar presente - o problema de execu√ß√£o.  Se desejar, voc√™ pode adicionar uma verifica√ß√£o de mensagem, como foi feito anteriormente (verifique ‚Äúok‚Äù). <br>  Emitimos uma verifica√ß√£o do comprimento m√≠nimo dos campos fio, telefone e corp (uma verifica√ß√£o semelhante ser√° feita para o tamanho m√°ximo e para caracteres inv√°lidos nesses campos). <br><br><img src="http://dl3.joxi.net/drive/2019/01/16/0025/3302/1694950/50/e6d3507ea2.png" alt="comprimento m√≠nimo"><br><br>  Nossas verifica√ß√µes est√£o em vigor, voc√™ pode executar e verificar <br><br><img src="http://dl4.joxi.net/drive/2019/01/16/0025/3302/1694950/50/d3d2572d83.png" alt="verificar resultado"><br><br>  Perfeito.  Nosso aplicativo falhou em 5 de 5 testes.  Nosso objetivo adicional √© passar por m√©todos de teste que definem valores inv√°lidos para campos e formam regras de valida√ß√£o para os dados recebidos.  A l√≥gica √© mais ou menos assim: o campo fio n√£o pode estar vazio;  Comprimento n√£o inferior a 3 e n√£o superior a 120;  esta √© uma sequ√™ncia com o conjunto de caracteres permitido no nome (letras, h√≠fens, recuos).  O resultado dessa l√≥gica em todos os campos: <br><br><img src="http://dl4.joxi.net/drive/2019/01/16/0025/3302/1694950/50/1bc13f4444.png" alt="valida√ß√£o"><br><br>  Em resposta a um arquivo, uma lista de erros foi adicionada, erros que correspondem a cada campo "problema".  Isso nos ajudar√° a verificar campos espec√≠ficos para valida√ß√£o (assertJsonStructure no arquivo de teste).  Em seguida, adicionamos o m√©todo de valida√ß√£o e obtemos a vers√£o final: <br><br><img src="http://dl4.joxi.net/drive/2019/01/16/0025/3302/1694950/50/b979543be1.png" alt="m√©todo final"><br><br>  E, finalmente, podemos verificar como nosso script funciona nos testes (lembro-me, houve 5 falhas em 5 testes). <br><br><img src="http://dl3.joxi.net/drive/2019/01/16/0025/3302/1694950/50/e17df357d5.png" alt="ok"><br><br>  Como voc√™ pode ver, todos os testes foram aprovados com √™xito e apenas uma entrada foi inserida no banco de dados (pois apenas um m√©todo foi configurado para funcionar corretamente). <br><br><img src="http://dl4.joxi.net/drive/2019/01/16/0025/3302/1694950/50/77c0dabe23.png" alt="o resultado √© inserido no banco de dados"><br><br>  Quais s√£o as descobertas?  O desenvolvimento de aplicativos, come√ßando com testes, √© uma op√ß√£o melhor do que a escrita usual de funcionalidade.  A necessidade de receber do m√©todo apenas o necess√°rio √© compar√°vel √† disciplina do ex√©rcito - o c√≥digo faz exatamente o que voc√™ precisa dele, n√£o um passo para o lado.  No entanto, essa abordagem tem um lado negativo (embora controverso) - o fato √© que escrever funcionalidades adicionais (que est√£o testando) tamb√©m leva algum tempo alocado para o desenvolvimento do projeto.  Quanto a mim, a escolha √© clara - um bom programador deve escrever testes, e come√ßar com a funcionalidade do teste ajuda a escrever um projeto confi√°vel e que funcione bem.  Vou tentar us√°-lo em algo menos trivial. </cut></cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt436714/">https://habr.com/ru/post/pt436714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt436700/index.html">Anti-spoofing: como os sistemas de reconhecimento de rosto resistem aos golpistas?</a></li>
<li><a href="../pt436704/index.html">A hist√≥ria de como escolhemos balan√ßas para automa√ß√£o de caixas registradoras</a></li>
<li><a href="../pt436708/index.html">Em que consiste a IoT</a></li>
<li><a href="../pt436710/index.html">As tend√™ncias do mercado gamedev do ano 2019 IMHO. Descentraliza√ß√£o?</a></li>
<li><a href="../pt436712/index.html">Como promover um jogo incremental? Gratuito, r√°pido e eficaz *</a></li>
<li><a href="../pt436716/index.html">Porta Falsa como parte do Desenvolvimento do Cliente</a></li>
<li><a href="../pt436718/index.html">Experi√™ncia pessoal: cinco desafios ao iniciar um neg√≥cio nos EUA</a></li>
<li><a href="../pt436720/index.html">Existe uma opini√£o: o IPv6 falhou - quem pensa assim e por qu√™</a></li>
<li><a href="../pt436724/index.html">Criando produtos formadores de h√°bitos</a></li>
<li><a href="../pt436726/index.html">Usu√°rios relatam perda de bitcoins como resultado de invas√£o inteligente das carteiras da Electrum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>