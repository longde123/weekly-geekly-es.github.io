<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¼â€ğŸ« â›·ï¸ ğŸ’œ åœ¨å…·æœ‰ä¸åŒæ“ä½œç³»ç»Ÿçš„ç½‘ç»œä¸­ï¼Œé€šè¿‡æˆ–ä¸é€šè¿‡åŸŸæˆæƒä»å¤´å¼€å§‹è®¾ç½®CUPSæ‰“å°æœåŠ¡å™¨ ğŸ¤µğŸ» â¿ ğŸ¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨å…·æœ‰ä¸åŒæ“ä½œç³»ç»Ÿçš„ç½‘ç»œä¸­ï¼Œé€šè¿‡æˆ–ä¸é€šè¿‡åŸŸæˆæƒä»å¤´å¼€å§‹è®¾ç½®CUPSæ‰“å°æœåŠ¡å™¨ 
 å‚èµ›ä½œå“ 


 è¿™æ ·å•Š å¤§æ¦‚æ˜¯ï¼ŒCUPSæ‰“å°æœåŠ¡æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„è§£å†³æ–¹æ¡ˆï¼Œå¯è®©æ‚¨åœ¨å…¬å¸ä¸­ç»„ç»‡é›†ä¸­å¼æ‰“å°æœºç®¡ç†ã€‚ ç¡®å®å¦‚æ­¤ï¼Œä½†æ˜¯åœ¨è®¾ç½®è¿‡ç¨‹ä¸­ï¼Œæ‚¨å°†éœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´æ¥å¯»æ‰¾è§£å†³Googleä¼—å¤šå°é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œå°¤å…¶æ˜¯å¦‚æœæ‚¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>åœ¨å…·æœ‰ä¸åŒæ“ä½œç³»ç»Ÿçš„ç½‘ç»œä¸­ï¼Œé€šè¿‡æˆ–ä¸é€šè¿‡åŸŸæˆæƒä»å¤´å¼€å§‹è®¾ç½®CUPSæ‰“å°æœåŠ¡å™¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443094/"><h2 id="nastroyka-s-nulya-printservera-cups-s-domennoy-avtorizaciey-i-bez-nee-v-seti-s-raznymi-os"> åœ¨å…·æœ‰ä¸åŒæ“ä½œç³»ç»Ÿçš„ç½‘ç»œä¸­ï¼Œé€šè¿‡æˆ–ä¸é€šè¿‡åŸŸæˆæƒä»å¤´å¼€å§‹è®¾ç½®CUPSæ‰“å°æœåŠ¡å™¨ </h2><br><h3 id="vstuplenie"> å‚èµ›ä½œå“ </h3><br><p> è¿™æ ·å•Š å¤§æ¦‚æ˜¯ï¼ŒCUPSæ‰“å°æœåŠ¡æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„è§£å†³æ–¹æ¡ˆï¼Œå¯è®©æ‚¨åœ¨å…¬å¸ä¸­ç»„ç»‡é›†ä¸­å¼æ‰“å°æœºç®¡ç†ã€‚ ç¡®å®å¦‚æ­¤ï¼Œä½†æ˜¯åœ¨è®¾ç½®è¿‡ç¨‹ä¸­ï¼Œæ‚¨å°†éœ€è¦èŠ±è´¹ä¸€äº›æ—¶é—´æ¥å¯»æ‰¾è§£å†³Googleä¼—å¤šå°é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œå°¤å…¶æ˜¯å¦‚æœæ‚¨çš„éœ€æ±‚è¶…å‡ºäº†æ ‡å‡†è®¾ç½®æ‰‹å†Œçš„èŒƒå›´ã€‚ </p><br><p> æœ¬æ–‡å°†æè¿°CUPSæ‰“å°æœåŠ¡å™¨åœ¨å…·æœ‰æ´»åŠ¨Active DirectoryåŸŸçš„ç½‘ç»œä¸Šçš„Ubuntu Serverä¸Šçš„å®‰è£…ï¼Œå°½ç®¡å®ƒçš„å­˜åœ¨æ˜¯å®Œå…¨å¯é€‰çš„ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥å®‰å…¨åœ°è·³è¿‡æœ‰å…³ä¸å…¶è¿›è¡Œäº¤äº’ï¼Œè®¾ç½®ä»¥åŠä¸Linuxå’ŒWindowså®¢æˆ·ç«¯è®¡ç®—æœºè¿›è¡Œäº¤äº’çš„è¯´æ˜ã€‚æ­¤æ‰“å°æœåŠ¡å™¨ã€‚ </p><a name="habracut"></a><br><p> åœ¨è¯´æ˜ä¸­ï¼Œè¯¥åŸŸå°†å‘½åä¸º<strong>example.com</strong> ï¼Œæ‰“å°æœåŠ¡å™¨æœ¬èº«å°†æ˜¯IPåœ°å€ä¸º10.10.100.50çš„<strong>cupsserver</strong> ï¼ˆ <strong>cupsserver.example.com</strong> ï¼‰ï¼Œä»¥åŠå®¢æˆ·ç«¯è®¡ç®—æœºLinuxå’Œ<strong>Windows1</strong> ï¼Œ <strong>Windows1</strong> ï¼Œ <strong>Windows2</strong> ï¼Œ <strong>Windows3</strong>å’Œ<strong>Windows</strong> <strong>XP</strong>çš„å®¢æˆ·ç«¯è®¡ç®—æœº<strong>linux1</strong> ï¼Œ <strong>linux2</strong> ï¼Œ <strong>linux3</strong>ç­‰ã€‚ç­‰ åˆ†åˆ«ç”¨äºWindowså®¢æˆ·ç«¯è®¡ç®—æœºã€‚ </p><br><h3 id="nastroyka-printservera"> è®¾ç½®æ‰“å°æœåŠ¡å™¨ </h3><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬å°†é…ç½®æ‰“å°æœåŠ¡å™¨ï¼Œæˆ–è€…æ›´ç¡®åˆ‡åœ°è¯´ï¼Œåœ¨å…¶ä¸Šé…ç½®ç®¡ç†è®¿é—®æƒé™ï¼Œç„¶ååœ¨å…¶ä¸Šé…ç½®æ‰“å°ï¼Œç„¶åæè¿°å®¢æˆ·ç«¯è®¡ç®—æœºçš„é…ç½®ã€‚ </p><br><p> æˆ‘ä»¬ä»¥ä»»ä½•æ–¹ä¾¿çš„æ–¹å¼è¿›å…¥æ‰“å°æœåŠ¡å™¨å¹¶æ›´æ–°å…¶ä¸­çš„è½¯ä»¶åŒ…ï¼š </p><br><pre><code class="plaintext hljs">root@cupsserver:~# apt update &amp;&amp; apt uprgrade -y</code> </pre> <br><p> æ¥ä¸‹æ¥ï¼Œæ£€æŸ¥æœåŠ¡å™¨ä¸Šæ˜¯å¦å®‰è£…äº†CUPSï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# which cupsd</code> </pre> <br><p> å¦‚æœè¾“å‡ºçœ‹èµ·æ¥åƒè¿™æ ·ï¼š </p><br><pre> <code class="plaintext hljs">/usr/bin/cupsd</code> </pre> <br><p> ç„¶åå®‰è£…CUPSï¼Œå¦‚æœæ²¡æœ‰è¾“å‡ºï¼Œè¯·å®‰è£…CUPSï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# apt install cups -y</code> </pre> <br><p> ç°åœ¨ï¼Œé…ç½®å¯¹CUPS Webç•Œé¢çš„ç®¡ç†è®¿é—®ã€‚ æ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½ä½äºè·¯å¾„<em>/ etc / cups /ä¸­</em> ã€‚ é¦–å…ˆï¼Œä»¥é˜²ä¸‡ä¸€ï¼Œæˆ‘ä»¬å°†å¤‡ä»½ä¸»è¦çš„CUPSé…ç½®æ–‡ä»¶ï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# cp /etc/cups/cupsd.conf /etc/cups/cupsd.conf.original root@cupsserver:~# cp /etc/cups/cups-files.conf /etc/cups/cups-files.conf.original root@cupsserver:~# cp /etc/cups/cups-browsed.conf /etc/cups/cups-browsed.conf.original</code> </pre> <br><p> ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æ²¡æœ‰æ‰§è¡Œæ­¤æ“ä½œ-æ²¡å…³ç³»ï¼Œåˆ™é»˜è®¤æƒ…å†µä¸‹ï¼Œç¤ºä¾‹æ•°æ®æ–‡ä»¶ä½äº<em>/ usr / share / cups</em>è·¯å¾„ä¸­ã€‚ è¿˜å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥CUPSé…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰æ·»åŠ é€‰é¡¹ï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# cupsd -t</code> </pre> <br><p> å¦‚æœå¼„ä¹±ï¼Œå¯†å°æˆ–ä½¿ç”¨äº†CUPSä¸å†æ”¯æŒçš„é€‰é¡¹ï¼Œåˆ™å‘½ä»¤çš„è¾“å‡ºå°†åæ˜ è¿™äº›é”™è¯¯ã€‚ </p><br><p> ä½†æœ€åï¼Œè®©æˆ‘ä»¬å¼€å§‹è¿›è¡Œè®¾ç½®ã€‚ å¯¹<em>/ etc / cups /</em>æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶è¿›è¡Œä»»ä½•æ›´æ”¹åï¼Œæ‚¨éœ€è¦é‡æ–°å¯åŠ¨CUPSæœåŠ¡ä»¥è·å¾—æ•ˆæœï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# service cups restart  root@cupsserver:~# systemctl restart cups  root@cupsserver:~# /etc/init.d/cups restart</code> </pre> <br><p> å¹¶ä¸”ï¼Œå¦‚æœæ‚¨ç¼–è¾‘äº†æ–‡ä»¶<em>/etc/cups/cups-browsed.conf</em> ï¼Œåˆ™ç”±å•ç‹¬çš„<strong>cups-browsed</strong>æœåŠ¡è´Ÿè´£ï¼Œè¯¥æœåŠ¡ä¹Ÿéœ€è¦é‡æ–°å¯åŠ¨ï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# service cups-browsed restart  root@cupsserver:~# systemctl restart cups-browsed  root@cupsserver:~# /etc/init.d/cups-browsed restart</code> </pre> <br><p> è¿è¡Œå‘½ä»¤ </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# nano /etc/cups/cupsd.conf</code> </pre> <br><p> ç¬¬ä¸€ä¸ªæœªæ³¨é‡Šçš„é€‰é¡¹æ˜¯ </p><br><pre> <code class="plaintext hljs">LogLevel warn</code> </pre> <br><p> å®ƒç¡®å®šCUPSæ—¥å¿—çš„æœ€ä½ä¿¡æ¯å†…å®¹ã€‚  CUPSæ—¥å¿—æ–‡ä»¶ä½äº<em>/ var / log / cups /</em> ã€‚ åœ¨å®‰è£…ï¼Œé…ç½®å’Œè°ƒè¯•æ‰“å°æœåŠ¡å™¨æ—¶ï¼Œæœ€å¥½å°†æ—¥å¿—è®°å½•è®¾ç½®ä¸ºè°ƒè¯•æ¨¡å¼ã€‚ ä¸ºæ­¤ï¼Œå°†warnæ›´æ”¹ä¸ºdebug2ï¼š </p><br><pre> <code class="plaintext hljs">LogLevel debug2</code> </pre> <br><p> é»˜è®¤æƒ…å†µä¸‹ï¼ŒCUPSä»…ä¾¦å¬æ¥è‡ª<strong>localhostçš„</strong>ä¼ å…¥è¿æ¥ï¼Œå³åœ¨å›é€æ¥å£ä¸Šã€‚ ä¸ºäº†ç¡®ä¿è¿™ä¸€ç‚¹ï¼Œæ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# netstat -plutn</code> </pre> <br><p> å…¶ä¸­ä¸€è¡Œå°†å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="plaintext hljs">tcp 0 0 127.0.0.1:631 0.0.0.0:* LISTEN 737/cupsd</code> </pre> <br><p> è¿›ä¸€æ­¥çš„è¡ŒåŠ¨å–å†³äºæ‚¨çš„åæ‰§ç¨‹åº¦ã€‚ æ‚¨å¯ä»¥åœ¨è¯¥å—ä¸­æ·»åŠ ï¼Œè¯¥å—æœ‰æ¡ä»¶åœ°ä»¥ä»¥ä¸‹æ³¨é‡Š<strong>å¼€å¤´ï¼šï¼ƒä»…ä¾¦å¬æ¥è‡ªæœ¬åœ°è®¡ç®—æœºçš„è¿æ¥ï¼Œ</strong>å‡ è¡ŒæŒ‡ç¤ºIPåœ°å€æˆ–å­ç½‘ï¼Œå°†å…è®¸CUPSä»ä¸­ä¾¦å¬è¿æ¥ã€‚ </p><br><pre> <code class="plaintext hljs"># Only listen for connections from the local machine. Listen localhost:631 Listen /run/cups/cups.sock #    IP  Listen 10.10.100.67:631 #     Listen 172.16.0.0:631</code> </pre> <br><p> æˆ–è€…ï¼Œæ‚¨å¯ä»¥å…è®¸CUPSç›‘å¬æ¥è‡ªæ‰€æœ‰åœ°å€çš„è¿æ¥ </p><br><pre> <code class="plaintext hljs"># Only listen for connections from the local machine. Listen /run/cups/cups.sock Port 631</code> </pre> <br><p> ä¸‹ä¸€ä¸ªé…ç½®ç‚¹æ˜¯å‘ç°ç½‘ç»œæ‰“å°æœºå’Œå…±äº«æ‰“å°æœºã€‚ </p><br><pre> <code class="plaintext hljs"># Show shared printers on the local network. Browsing Off BrowseLocalProtocols dnssd</code> </pre> <br><p> æˆ‘è®¤ä¸ºï¼Œæ­¤é€‰é¡¹åº”ä¿æŒå…³é—­çŠ¶æ€ï¼Œå› ä¸ºå®ƒç¡®å®šæ˜¯å¦å°†é€šè¿‡ç½‘ç»œå‘é€æœ‰å…³è¿æ¥åˆ°æ‰“å°æœåŠ¡å™¨çš„æ‰“å°æœºçš„å¹¿æ’­ä¿¡æ¯ã€‚ ä½†æ˜¯å®ƒä»¬éƒ½å°†è¿æ¥åˆ°å®ƒã€‚ å› æ­¤ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯è®¡ç®—æœºå°†ç«‹å³æ˜¾ç¤ºæ‰€æœ‰æ‰“å°æœºã€‚ æˆ‘ä»¬çš„æ‰“å°æœåŠ¡å™¨åº”è¯¥æœç´¢å¹¶æ£€æµ‹ç½‘ç»œä¸Šçš„æ‰€æœ‰æ‰“å°æœºï¼Œä½†ä¸è¦æ¯«æ— é¡¾å¿Œåœ°é€šè¿‡ç½‘ç»œå‘é€å®ƒä»¬ã€‚ </p><br><p> ä»¥ä¸‹æ˜¯èº«ä»½éªŒè¯è®¾ç½®ï¼š </p><br><pre> <code class="plaintext hljs"># Default authentication type, when authentication is required... DefaultAuthType Basic</code> </pre> <br><p> å®šä¹‰å¯¹CUPS Webç•Œé¢åŠå…¶ç®¡ç†éƒ¨åˆ†çš„è®¿é—®æƒé™ã€‚ ä¸ºäº†ä½¿ç”¨æˆ·<strong>ç”¨æˆ·</strong>æœ‰æƒç®¡ç†CUPSï¼Œå¿…é¡»å°†å…¶æ·»åŠ åˆ°<strong>lpadmin</strong>ç³»ç»Ÿç»„ä¸­ï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# usermod -a -G lpadmin user</code> </pre> <br><p> é€šå¸¸ï¼Œåœ¨å—ä¸­çš„<em>cups-files.conf</em>é…ç½®æ–‡ä»¶ä¸­å®šä¹‰äº†å…è®¸å¯¹CUPSè¿›è¡Œç®¡ç†è®¿é—®çš„ç»„ã€‚ </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin</code> </pre> <br><p> å¦‚æœè¦å‘æŸäº›Linuxç”¨æˆ·ç»„æ·»åŠ ç®¡ç†æ‰“å°æœåŠ¡å™¨ï¼ˆä¾‹å¦‚<strong>printadminsï¼‰</strong>çš„æƒé™ï¼Œåªéœ€åœ¨<strong>lpadminä¸­</strong>æ·»åŠ ç©ºæ ¼å³å¯ã€‚ å¦‚æœè¯¥ç»„æ˜¯åŸŸï¼Œåˆ™å®ƒä¼šç¨å¾®å¤æ‚ä¸€äº›ï¼Œå°†åœ¨åé¢è¿›è¡Œæè¿°ã€‚ </p><br><p> ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥<strong>&lt;Location /&gt;</strong>å—ï¼š </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny &lt;/Location&gt;</code> </pre> <br><p>  <strong>é¡ºåºå…è®¸ï¼Œæ‹’ç»</strong>è¡¨ç¤ºç¦æ­¢ä»ä»»ä½•åœ°æ–¹è¿›è¡Œè¿æ¥ï¼Œé™¤éç‰¹åˆ«æŒ‡æ˜å…è®¸ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚¨éœ€è¦ä»¥<em>â€œ</em>å…è®¸æ¥è‡ª[å…è®¸çš„åœ°å€] *â€ <em>çš„å½¢å¼</em>æ·»åŠ IPåœ°å€ï¼Œå­ç½‘ï¼Œä¸»æœºæˆ–æ©ç ï¼ˆ <em><strong>.example.com</strong> ï¼‰çš„</em>ä¸»æœºï¼š </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny Allow from cupsserver #         Allow from cupsserver.example.com #       FQDN Allow from localhost #       loopback  Allow from 10.10.100.* #    Allow from linux4.example.com #     Allow from 172.168.5.125 #  , IP   &lt;/Location&gt;</code> </pre> <br><p> ä¸ºäº†å®Œå…¨æ”¾å¿ƒå¹¶è¿›è¡Œè°ƒè¯•ï¼Œæ‚¨å¯ä»¥ä¿ç•™ä¸€ä¸ªè®¾è®¡ï¼Œè¯¥è®¾è®¡å¯ä»¥ä»ä»»ä½•åœ°æ–¹è¿›è¡Œæ‰“å°ï¼Œç›´åˆ°è¿›è¡Œå…¶ä»–æ‰€æœ‰é…ç½®ä¸ºæ­¢ï¼š </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny Allow from all &lt;/Location&gt;</code> </pre> <br><p> è®©æˆ‘ä»¬åœ¨æ‰“å°æœåŠ¡å™¨ä¸Šè®¾ç½®å¯¹CUPSçš„ç®¡ç†è®¿é—®æƒé™ã€‚ ç¡®å®šæ‚¨è¦ä»CUPSè¿æ¥åˆ°å“ªäº›IPå’Œ/æˆ–å­ç½‘ï¼Œå¹¶é€šè¿‡ä¸<strong>&lt;Location /&gt;</strong>å—ç±»ä¼¼çš„æ–¹å¼æ·»åŠ å®ƒä»¬ï¼š </p><br><pre> <code class="plaintext hljs"># Restrict access to the admin pages... &lt;Location /admin&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt; # Restrict access to configuration files... &lt;Location /admin/conf&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt; # Restrict access to log files... &lt;Location /admin/log&gt; Order allow,deny Allow from localhost Allow from 10.10.100.* Allow from admin.example.com &lt;/Location&gt;</code> </pre> <br><p>  ï¼ˆå¯é€‰ï¼‰æ‚¨å¯ä»¥æ·»åŠ é»˜è®¤ç•Œé¢è¯­è¨€ã€‚ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å¯ç”¨è¯­è¨€çš„åˆ—è¡¨ï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:~# ls /usr/share/cups/locale</code> </pre> <br><p> å¦‚æœæ‚¨éœ€è¦æœ¬åœ°åŒ–ï¼ˆä¾‹å¦‚<strong>ruï¼‰</strong> ï¼Œè¯·åœ¨<em>/etc/cups/cupsd.confä¸­</em>æ·»åŠ ä¸€è¡Œï¼š </p><br><pre> <code class="plaintext hljs">DefaultLanguage ru</code> </pre> <br><p> ä¸ºäº†ä½¿å…¶ä¸»æœºï¼ˆä¸»æœºåï¼‰è®¿é—®æ‰“å°æœåŠ¡å™¨<strong>cupsserver.example.com</strong> ï¼Œéœ€è¦åœ¨<em>/ etc / cups /</em>æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª<em>client.conf</em>æ–‡ä»¶ï¼Œå…¶å†…å®¹å¦‚ä¸‹ï¼š </p><br><pre> <code class="plaintext hljs">ServerName _</code> </pre> <br><p> ä»¥æœ€ç®€å•çš„æ–¹å¼ï¼Œå¯ä»¥è¿™æ ·å®Œæˆï¼š </p><br><pre> <code class="plaintext hljs">root@cupsserver:/etc/cups# echo "ServerName $(cat /etc/hostname)" &gt; /etc/cups/client.conf</code> </pre> <br><p> ç”±äºæˆ‘ä»¬å‡è®¾ç½‘ç»œä¸­å­˜åœ¨DNSæœåŠ¡å™¨ï¼Œå› æ­¤æœ€å¥½é€šè¿‡å…¶åŸŸåï¼ˆ <strong>cupsserver.example.com</strong> ï¼‰è®¿é—®æ‰“å°æœåŠ¡å™¨ã€‚ è¿˜å¯ä»¥åœ¨DNSæœåŠ¡å™¨ä¸Šä¸ºæœåŠ¡å™¨åˆ†é…CNAMEåˆ«åï¼Œä¾‹å¦‚<strong>print</strong>æˆ–<strong>cups</strong> ã€‚ ä¸ºäº†ä½¿æ‰“å°æœåŠ¡å™¨èƒ½å¤Ÿæ¥å—æ­¤ç±»è°ƒç”¨çš„è¿æ¥ï¼Œå¿…é¡»<em>å°†ä»¥</em>ä¸‹è¡Œæ·»åŠ åˆ°<em>/etc/cups/cupsd.conf</em>æ–‡ä»¶ä¸­ï¼š </p><br><pre> <code class="plaintext hljs">ServerAlias cupsserver.example.com print cups</code> </pre> <br><p> å¦‚æœè¦æ‰“å°æœåŠ¡å™¨æ¥å—ä»»ä½•å‘¼å«ï¼Œæˆ–ä¸æƒ³æ‰“æ‰°ï¼Œåˆ™å¯ä»¥æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š </p><br><pre> <code class="plaintext hljs">ServerAlias *</code> </pre> <br><p> æ‚¨è¿˜éœ€è¦æŸ¥çœ‹<em>/etc/cups/cups-browsed.conf</em>æ–‡ä»¶ã€‚ è¯¥æ–‡ä»¶æ§åˆ¶æ‰“å°æœåŠ¡å™¨å¦‚ä½•æœç´¢ç½‘ç»œä¸Šçš„æ‰“å°æœºå¹¶å¹¿æ’­å…¶æ‰“å°æœºã€‚ æˆ‘å»ºè®®å®Œå…¨ç¦ç”¨æ–°é—»é€šè®¯é€‰é¡¹ã€‚ æ‰“å°æœåŠ¡å™¨å°†åœ¨ç½‘ç»œä¸Šæœç´¢æ‰“å°æœºï¼Œä½†æ˜¯ä»è¯¥æ‰“å°æœºåˆ°å®¢æˆ·ç«¯è®¡ç®—æœºçš„æ‰“å°æœºå°†è¢«æ‰‹åŠ¨è¿æ¥ã€‚ ä¸‹é¢å°†æè¿°åŸå› ã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†<strong>BrowseRemoteProtocols dnssd cupsè¡Œ</strong> ï¼š </p><br><pre> <code class="plaintext hljs"># Which protocols will we use to discover printers on the network? # Can use DNSSD and/or CUPS and/or LDAP, or 'none' for neither. BrowseRemoteProtocols dnssd cups</code> </pre> <br><p> ç”±äºä½¿ç”¨äº†è¯¥é€‰é¡¹ï¼Œæ‰“å°æœåŠ¡å™¨å¯ä»¥åœ¨ç½‘ç»œä¸Šæœç´¢å…±äº«æ‰“å°æœºã€‚ æˆ‘ä»¬å°†å…¶ä¿æŒæ‰“å¼€çŠ¶æ€ï¼Œå› ä¸ºæ‰“å°æœåŠ¡å™¨åœ¨ç½‘ç»œä¸Šæœç´¢æ‰“å°æœºç¬¦åˆæˆ‘ä»¬çš„åˆ©ç›Šã€‚ ä½†æ˜¯æˆ‘ä»¬ç»å¯¹ä¸éœ€è¦æ‰“å°æœåŠ¡å™¨å‘é€ä¸å…¶è¿æ¥çš„æ‰€æœ‰æ‰“å°æœºï¼Œå¦åˆ™ä¼šé€ æˆå¾ˆå¤šæ··ä¹±ã€‚ ä¸ºé˜²æ­¢å‡ºç°è¿™ç§æƒ…å†µï¼Œè¯·æ‰¾åˆ°ä»¥ä¸‹<strong>#BrowseLocalProtocols none</strong>é€‰é¡¹å¹¶å–æ¶ˆæ³¨é‡Šï¼š </p><br><pre> <code class="plaintext hljs"># Which protocols will we use to broadcast shared local printers to the network? # Can use DNSSD and/or CUPS, or 'none' for neither. # Only CUPS is actually supported, as DNSSD is done by CUPS itself (we ignore DNSSD in this directive). BrowseLocalProtocols none</code> </pre> <br><p> åœ¨æ­¤ï¼Œæˆ‘ä»¬æš‚åœæ‰“å°æœåŠ¡å™¨çš„é…ç½®ï¼Œç„¶åç»§ç»­é…ç½®å®¢æˆ·ç«¯è®¡ç®—æœºWindowså’ŒLinuxã€‚ å®ƒä»¬çš„è¦æ±‚å¦‚ä¸‹ï¼šå…è®¸å°†æ‰“å°ä½œä¸šå‘é€åˆ°æ‰“å°æœåŠ¡å™¨ï¼Œå¹¶åœ¨éœ€è¦æ‰“å°åˆ°ç½‘ç»œæ‰“å°æœºæ—¶å°†æ‰“å°ä½œä¸šå‘é€åˆ°ï¼ˆä»…ï¼‰æ‰“å°æœåŠ¡å™¨ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œæˆ‘ä»¬å°†åœ¨ä¸¤å°åˆ†åˆ«å…·æœ‰Linuxï¼ˆä¸»æœºå<strong>linux1</strong> ï¼‰å’ŒWindows 8ï¼ˆä¸»æœºå<strong>windows1</strong> ï¼‰çš„å®¢æˆ·æœºä¹‹é—´é€šè¿‡æ‰“å°æœåŠ¡å™¨é…ç½®æ‰“å°ã€‚ é¦–å…ˆï¼Œå°†<strong>Windows1</strong>é…ç½®ä¸ºæ¥è‡ªæ‰“å°æœåŠ¡å™¨çš„æ‰“å°æ¥æ”¶å™¨ã€‚ æˆ‘æœ‰ä¸€å°ä½³èƒ½i-SENSYS MF4410æ‰“å°æœºå·²è¿æ¥å¹¶ä¸”å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ æ‰“å°æœºåç§°ä¸ºCanon-MF4400ã€‚ å®é™…ä¸Šï¼Œç¡®ä¿ä»<strong>Windows1</strong>ä¸Šçš„æ‰“å°æœåŠ¡å™¨è¿›è¡Œæ‰“å°çš„æœ€ç®€å•æ–¹æ³•æ˜¯è½¬åˆ°â€œ <em>æ§åˆ¶é¢æ¿â€&gt;â€œç¨‹åºâ€&gt;â€œç¨‹åºå’ŒåŠŸèƒ½â€&gt;â€œæ‰“å¼€æˆ–å…³é—­WindowsåŠŸèƒ½â€</em> ã€‚ åœ¨é‚£é‡Œï¼Œæˆ‘ä»¬æ‰“å¼€<em>äº†æ‰“å°å’Œæ–‡æ¡£æœåŠ¡&gt; LPDæ‰“å°æœåŠ¡</em>ç»„ä»¶ã€‚ è¿™å°†å…è®¸æ‚¨ä½¿ç”¨<em>lpdï¼š// windows1 / Canon-MF4400 address</em>å°†æ‰“å°æœºè¿æ¥åˆ°æ‰“å°æœåŠ¡å™¨ã€‚ å½“ç„¶ï¼Œé—®é¢˜æ­£åœ¨æˆç†Ÿï¼Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨SMBè¿æ¥ï¼Ÿ æ²¡æœ‰äººç¦æ­¢ã€‚ å¦‚æœå·²è°ƒè¯•æ­¤æ–¹æ³•ï¼Œåˆ™å¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å…±äº«æ‰“å°æœºï¼Œå¹¶ä½¿ç”¨SMBåè®®å°†å…¶è¿æ¥åˆ°æ‰“å°æœåŠ¡å™¨ã€‚ æˆ‘è®¤ä¸ºï¼Œæœ‰å…³æ­¤è¿æ¥çš„è¯´æ˜è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ï¼Œæœ¬æ–‡å·²ç»è¶³å¤Ÿå¤šäº†ã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºè¯»è€…æˆåŠŸåœ°è®¿é—®äº†åœ°å€<code>http://cupsserver:631/admin</code>å•å‡»â€œæ·»åŠ æ–°æ‰“å°æœºâ€æŒ‰é’®ï¼Œå¹¶ä¸”æŒ‰ç…§ç›´è§‰ï¼Œé€»è¾‘å’Œæ—©å…ˆé˜…è¯»çš„æ‰‹å†Œï¼Œä»–é€šè¿‡<strong>LPD</strong>åè®®å°†<strong>Windows1</strong>æ‰“å°æœºæˆåŠŸè¿æ¥åˆ°<strong>cupsserver [ç¤ºä¾‹ã€‚ com]</strong> ï¼Œæ‰“å°æœºé¡µé¢å¯ä»ä»¥ä¸‹<code>http://cupsserver:631/printers/Canon-MF4400</code>è·å¾—ï¼š <code>http://cupsserver:631/printers/Canon-MF4400</code> ã€‚ </p><br><p> ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ä¸»æœºåä¸º<strong>linux1</strong>çš„Linuxå®¢æˆ·ç«¯è®¡ç®—æœºä¸Šæ‰§è¡Œç±»ä¼¼çš„æ“ä½œã€‚ é€šå¸¸ï¼Œè¿™éƒ¨åˆ†å°†æ›´å¤§ï¼Œå› ä¸ºå®¢æˆ·ç«¯è®¡ç®—æœºå…·æœ‰è‡ªå·±çš„CUPSæœåŠ¡ï¼Œå¹¶ä¸”é™¤äº†ç»„ç»‡æ‰“å°çš„ä»å±è§’è‰²å¤–ï¼Œè¿˜éœ€è¦ä»¥ä¸æ‰“å°æœåŠ¡å™¨å‡ ä¹ç›¸åŒçš„æ–¹å¼è¿›è¡Œé…ç½®ã€‚ </p><br><h3 id="ispravlenie-oshibki-obrascheniya-k-cups-cherez-loopback-po-imeni-hosta"> é€šè¿‡ä¸»æœºåé€šè¿‡ç¯å›è®¿é—®CUPSçš„é”™è¯¯çš„æ›´æ­£ </h3><br><p> æœ‰ä¸€ä¸ªä¸æ„‰å¿«çš„æ—¶åˆ»ã€‚ å¦‚æœå°†<strong>linux1</strong>è¾“å…¥åŸŸï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹è¯´æ˜åœ¨å…¶ä¸Šé…ç½®CUPSï¼Œå½“æ‚¨å¯ä»¥ä»å¤–éƒ¨è®¿é—®<strong>linux1</strong> WEBæ¥å£æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ä¸€ç§è’è°¬çš„æƒ…å†µï¼Œä½†æ˜¯æ‚¨ä¸èƒ½åœ¨ä¸»æœºæœ¬èº«ä¸Šæ‰§è¡Œæ­¤æ“ä½œï¼ ç”¨äºæœ¬åœ°é…ç½®æ‰“å°æœºçš„å›¾å½¢åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚Linux Mintä¸­çš„<strong>system-config-printer</strong>åº”ç”¨ç¨‹åºï¼‰æ‹’ç»è¿è¡Œã€‚ å¦‚æœå°è¯•åœ¨åœ°å€<code>http://linux1:631/</code>ä¸Šè¿æ¥åˆ°è‡ªå·±çš„CUPSï¼Œå°†å‡ºç°ä¸€æ¡æ¶ˆæ¯â€œ Forbiddenâ€æˆ–â€œ Bad Requestâ€ã€‚ åœ¨è®¸å¤šInternetè®ºå›ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„ä½†å°šæœªçœŸæ­£è§£å†³çš„é—®é¢˜ã€‚ </p><br><p> åœ¨å…³äºå°†Linuxå¼•å…¥åŸŸçš„å¤§å¤šæ•°è¯´æ˜ä¸­ï¼Œè¦ç‚¹ä¹‹ä¸€å°±æ˜¯ä½¿<em>/ etc / hostsæ–‡ä»¶</em>çœ‹èµ·æ¥åƒè¿™æ ·ï¼š </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost 127.0.1.1 linux1.example.com linux1 # The following lines are desirable for IPv6 capable hosts ::1 ip6-localhost ip6-loopback fe02::2 ip6-localnet ff00::0 ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters</code> </pre> <br><p> ç”±äºæŸäº›åŸå› ï¼ŒCUPSæ— æ³•å°†é€šè¿‡127.0.1.1ï¼ˆå³é€šè¿‡Loopbackæ¥å£ï¼‰çš„å‘¼å«ä¸ä¸»æœºåç›¸å…³è”ã€‚ </p><br><p> æ­¤é”™è¯¯æœ‰ä¸¤ç§è§£å†³æ–¹æ³•ã€‚ å¦‚æœæ‚¨çš„ç½‘ç»œIPåœ°å€æ˜¯é™æ€çš„ï¼Œåˆ™åœ¨<em>/ etc / hostsæ–‡ä»¶ä¸­ï¼Œå°†</em> 127.0.1.1æ›´æ”¹ä¸ºå®¢æˆ·ç«¯è®¡ç®—æœºçš„å¤–éƒ¨ç½‘ç»œæ¥å£çš„IPåœ°å€ï¼Œä¾‹å¦‚ï¼š </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost 192.168.1.50 linux1.example.com linux1</code> </pre> <br><p> æˆ–è€…ï¼Œç”±äºæ‚¨å°†Linuxè¾“å…¥åŸŸï¼Œå› æ­¤å®ƒå‡å®šDHCPå’ŒActive Directory DNSæœåŠ¡å™¨æ­£åœ¨ç½‘ç»œä¸Šè¿è¡Œã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªéœ€æ³¨é‡Šæ‰è¿™ä¸€è¡Œï¼š </p><br><pre> <code class="plaintext hljs">127.0.0.1 localhost # 127.0.1.1 linux1.example.com linux1</code> </pre> <br><p> å°šæœªå‘ç°æ­¤æ“ä½œçš„æ€§èƒ½å·®å¼‚æˆ–é—®é¢˜ã€‚ </p><br><h3 id="nastroyka-adresov-proslushivaniya-podklyucheniy-k-cups-u-klientskih-mashin-linux"> åœ¨Linuxå®¢æˆ·ç«¯è®¡ç®—æœºä¸Šè®¾ç½®CUPSè¿æ¥ä¾¦å¬åœ°å€ </h3><br><p> æˆ‘ä»¬ä»¥ä»»ä½•æ–¹ä¾¿çš„æ–¹å¼è¿›å…¥<strong>linux1</strong> ã€‚ ç¼–è¾‘æ–‡ä»¶<em>/etc/cups/cupsd.conf</em> ï¼š </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo nano /etc/cups/cupsd.conf</code> </pre> <br><p> æˆ‘ä»¬åœ¨å…¶ä¸­æ‰¾åˆ°ï¼Œæ·»åŠ æˆ–ä¿®æ”¹è¡Œï¼š </p><br><pre> <code class="plaintext hljs">DefaultLanguage ru #      /usr/share/cups/locale ServerAlias linux1.example.com linux1 [CNAME    DNS ]  ServerAlias * #      Listen /run/cups/cups.sock Listen localhost:631 #  localhost Listen 10.10.100.50:631 # IP   . Listen cupsserver:631 #   .    IP  ,    Listen linux1:631 #  Port 631 #       Listen /run/cups/cups.sock Browsing off # .       DefaultAuthType Basic #  .     Kerberos,     </code> </pre> <br><h3 id="nastroyka-adresov-proslushivaniya-podklyucheniy-k-cups"> è®¾ç½®CUPSè¿æ¥ä¾¦å¬åœ°å€ </h3><br><p> åœ¨ä¸Šä¸€ä¸ªå—ä¸­ï¼Œæˆ‘ä»¬é…ç½®äº†è¿æ¥åˆ°CUPSçš„åŠŸèƒ½ã€‚ ç°åœ¨ï¼Œè®©æˆ‘ä»¬ç»§ç»­è®¾ç½®æ‰“å°æƒé™ï¼Œä»¥åŠ<strong>linux1</strong>ä¸»æœºä¸ŠCUPSæœåŠ¡çš„ç®¡ç†é¡µé¢ã€‚ å¦‚æœå…³é—­ï¼Œæˆ‘ä»¬å°†é‡æ–°æ‰“å¼€<em>/etc/cups/cupsd.conf</em>æ–‡ä»¶ï¼Œå¹¶ç»§ç»­ç¼–è¾‘<strong>&lt;Location /&gt;</strong> ï¼Œ <strong>&lt;Location / admin&gt;</strong> ï¼Œ <strong>&lt;Location / admin / conf&gt;</strong> ï¼Œ <strong>&lt;Location / admin / log&gt;</strong>å—ï¼š </p><br><pre> <code class="plaintext hljs"># Restrict access to the server... &lt;Location /&gt; Order allow,deny #    "  ,  " Allow from localhost #    linux1 Allow from linux1 #     .      Allow from cupsserver #  CUPS    DNS,  . ,     Allow from cupsserver.example.com # FQDN  Allow from 10.10.100.50 #     IP  **cupsserver** &lt;/Location&gt; # Restrict access to the admin pages... &lt;Location /admin&gt; Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt; # Restrict access to configuration files... &lt;Location /admin/conf&gt; #   Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt; # Restrict access to log files... &lt;Location /admin/log&gt; #   Order allow,deny #   Allow from localhost #      Allow from linux1 #   Allow from 10.10.101.71 # ,  IP  Allow from 10.20.50.* # ,    IT  AuthType Default #   CUPS    .   Require user @SYSTEM #     CUPS &lt;/Location&gt;</code> </pre> <br><h3 id="nastroyka-razdachi-i-polucheniya-shirokoveschatelnoy-rassylki-setevyh-printerov"> é…ç½®ç½‘ç»œæ‰“å°æœºçš„åˆ†å‘å’Œå¹¿æ’­ </h3><br><p> å³ä½¿åœ¨Linuxå®¢æˆ·æœºï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º<strong><em>linux1ï¼‰ä¸Š</em></strong> ï¼Œæ‚¨ä¹Ÿéœ€è¦ç¼–è¾‘<em>/etc/cups/cups-browsed.conf</em>æ–‡ä»¶ï¼š </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo nano /etc/cups/cups-browsed.conf BrowseRemoteProtocols none #  none      . BrowseLocalProtocols cups #     . DNSSD   ,    cupsd.conf BrowseOrder Allow,Deny #   Order  cupsd.conf -   ,        BrowseAllow 10.10.100.50 # IP  BrowseAllow cupsserver #    BrowseAllow cupsserver.example.com #    </code> </pre> <br><h3 id="nastroyka-administrativnogo-dostupa"> é…ç½®ç®¡ç†è®¿é—® </h3><br><p> åœ¨æ‰“å°æœåŠ¡å™¨å’Œä»»ä½•Linuxå®¢æˆ·ç«¯è®¡ç®—æœºä¸Šçš„CUPS WEBç•Œé¢ä¸Šï¼Œæœ‰å…³ç®¡ç†è®¿é—®çš„æ›´å¤šä¿¡æ¯ã€‚ å³ä½¿æ‚¨æ‹¥æœ‰30åˆ°50å°è®¡ç®—æœºï¼Œä¹Ÿéœ€è¦ç»Ÿä¸€CUPSä¸Šçš„æˆæƒï¼Œå¹¶ä¸”ä¸è¦ç´§è®°æ¯å°è®¡ç®—æœºçš„å¯†ç æˆ–å¯†ç ã€‚ è¿™åœ¨æ‰€æœ‰Linuxæœºå™¨ä¸Šéƒ½å¾ˆé‡è¦ï¼Œå› ä¸ºè¦å°†æ‰“å°æœºæ·»åŠ åˆ°æœåŠ¡å™¨ï¼Œå¿…é¡»é¦–å…ˆåœ¨æœ¬åœ°å®‰è£…å®ƒã€‚ æˆ‘çœ‹åˆ°å‡ ç§æ–¹æ³•ã€‚ </p><br><p> ç¬¬ä¸€ç§æ˜¯åœ¨æ¯ä¸ªLinuxç³»ç»Ÿä¸Šåˆ›å»ºä¸€ä¸ª<strong>printeradmin</strong>ç”¨æˆ·ï¼ˆä¾‹å¦‚ï¼‰ï¼Œå¹¶å°†<strong>lpadmin</strong>æ·»åŠ åˆ°è¯¥ç»„ï¼š </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo usermod -a -G lpamin printeradmin</code> </pre> <br><p> å¹¶ä½¿ç”¨ä»–çš„å‡­æ®ç™»å½•åˆ°<code>http://_:631/admin</code> ã€‚ </p><br><p> ç¬¬äºŒä¸ªé€‰é¡¹å‡ ä¹ç›¸åŒï¼Œå»ºè®®åœ¨ç³»ç»Ÿä¸­åˆ›å»ºä¸€ä¸ªç»„ï¼Œä¾‹å¦‚<strong>printersadmins</strong> ï¼Œåœ¨å…¶ä¸­æ·»åŠ æ‰€éœ€çš„CUPSç®¡ç†å‘˜ï¼ˆ <strong>printeradmin</strong> ï¼Œ <strong>user</strong> ï¼‰ï¼š </p><br><pre> <code class="plaintext hljs">user@linux1:~$ sudo groupadd printersadmins user@linux1:~$ sudo usermod -a -G printersadmins printeradmin user@linux1:~$ sudo usermod -a -G printersadmins user</code> </pre> <br><p> ç„¶åï¼Œæ‚¨éœ€è¦åœ¨<em>/etc/cups/cups-files.conf</em>æ–‡ä»¶ä¸­æ‰¾åˆ°è¯¥è¡Œã€‚ </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin</code> </pre> <br><p> å¹¶æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªæœ‰æƒé€šè¿‡ç©ºæ ¼ç®¡ç†CUPSçš„ç”¨æˆ·ç»„ã€‚ </p><br><pre> <code class="plaintext hljs"># Administrator user group, used to match @SYSTEM in cupsd.conf policy rules... # This cannot contain the Group value for security reasons... SystemGroup lpadmin printersadmins somegroup</code> </pre> <br><p> æœ€åï¼Œç¬¬ä¸‰ç§é€‰æ‹©ã€‚ ä½¿æ‰“å°æœåŠ¡å™¨çš„ç®¡ç†å‘˜å’Œå®¢æˆ·ç«¯è®¡ç®—æœºçš„CUPSæˆä¸ºç”¨æˆ·çš„åŸŸç»„ã€‚ ä¸ºæ­¤ï¼Œå¿…é¡»å°†æ‰“å°æœåŠ¡å™¨å’ŒLinuxå®¢æˆ·ç«¯è®¡ç®—æœºåŠ å…¥ADåŸŸã€‚ æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å°†Linuxè¿æ¥åˆ°WindowsåŸŸï¼Œä½†æ®æˆ‘æ‰€çŸ¥ï¼Œä¸»è¦æ–¹æ³•æ˜¯ä½¿ç”¨winbindå’ŒSSSDï¼ˆrealmdï¼‰è¿æ¥ã€‚ æœ¬æ–‡ä¸­æœªåŒ…å«å¯¹è¿™äº›æ–¹æ³•çš„æè¿°ï¼Œå› æ­¤ï¼Œæˆ‘å°†ä»…å…³æ³¨ä¸CUPSç‰¹åˆ«ç›¸å…³çš„æ–¹é¢ã€‚ </p><br><h3 id="nastroyka-ispolzovaniya-domennyh-grupp-polzovateley-dlya-administrirovaniya-cups"> é…ç½®å¯¹CUPSç®¡ç†ä½¿ç”¨åŸŸç”¨æˆ·ç»„ </h3><br><p> åœ¨Linuxä¸­ï¼ŒåŠ å…¥ä¸­å¤®æˆæƒç³»ç»Ÿçš„æ¯ç§æ–¹æ³•éƒ½ä¼šåˆ›å»ºä¸€ä¸ªç‰¹æ®Šçš„â€œç®¡é“â€æ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºå¯é€šè¿‡è¯¥æ–‡ä»¶æŸ¥çœ‹åŸŸç”¨æˆ·åˆ—è¡¨ã€‚ ä¸ºäº†ä½¿CUPSèƒ½å¤Ÿåšåˆ°è¿™ä¸€ç‚¹ï¼Œæ‚¨éœ€è¦å…è®¸å®ƒä½¿ç”¨AppArmorä¸­çš„ç®¡é“å¯¹ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯ã€‚  AppArmoræ˜¯Linuxå®‰å…¨è®¿é—®æ§åˆ¶æ¨¡å—ã€‚ å°†æŸäº›ç¨‹åºé™åˆ¶ä¸ºå…¶ç­–ç•¥ä¸­åˆ—å‡ºçš„æ–‡ä»¶é›†ã€‚ è¦å°†CUPSæˆäºˆé€šè¿‡winbinddä½¿ç”¨åŸŸç”¨æˆ·å’Œç»„çš„æƒåˆ©ï¼Œè¯·å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°<em>/etc/apparmod.d/local/usr.sbin.cupsd</em>æ–‡ä»¶ä¸­ï¼š </p><br><pre> <code class="plaintext hljs">/var/lib/samba/winbindd_privileged/pipe rw</code> </pre> <br><p> å¦‚æœLinuxé€šè¿‡SSSDè¾“å…¥åˆ°åŸŸä¸­ï¼Œåˆ™å¿…é¡»åœ¨<em>/etc/apparmod.d/local/usr.sbin.cupsdä¸­</em>æŒ‡å®šå…¶ç®¡é“çš„ä½ç½®ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ ä»¥ä¸‹è¡Œï¼š </p><br><pre> <code class="plaintext hljs">/var/lib/sss/pipes/private/pam rw</code> </pre> <br><p> å¦å¤–ï¼Œå¯¹äºSSSDï¼Œè¿™å…è®¸è¿›è¡Œèº«ä»½éªŒè¯ï¼ˆæ‰¾å‡ºè°åœ¨ç™»å½•ï¼‰ï¼Œä½†æ˜¯ä¸ºäº†è¿›è¡Œèº«ä»½éªŒè¯ï¼ˆç¡®å®šç”¨æˆ·æ˜¯å¦æœ‰æƒç®¡ç†CUPSï¼‰ï¼Œè¿˜å¿…é¡»å°†è¯¥è¡Œæ·»åŠ åˆ°SSSDé…ç½®æ–‡ä»¶<em>/etc/sssd/sssd.confä¸­</em> ï¼š </p><br><pre> <code class="plaintext hljs">ad_gpo_map_interactive = +cups</code> </pre> <br><p> ä»æ¡ä»¶ä¸Šæ¥è®²ï¼Œè¿™ä½¿CUPSæœ‰æƒâ€œæŸ¥çœ‹â€ SSSDã€‚ </p><br><p> æ­¤å¤–ï¼Œç”±äºCUPSç°åœ¨ä¾èµ–äºSSSDæœåŠ¡ï¼Œå› æ­¤æ‚¨éœ€è¦å‘Šè¯‰CUPSå®ƒåº”åœ¨SSSDä¹‹åå¯åŠ¨ï¼Œå¦åˆ™å®ƒå°†åœ¨æ‰“å¼€æ—¶è„±è½ï¼Œå¹¶ä¸”æ¯æ¬¡éƒ½éœ€è¦æ‰‹åŠ¨æ‰“å¼€ã€‚ </p><br><p> æ·»åŠ CUPSæŒ‡ä»¤ä»¥åœ¨SSSDä¹‹åå¯åŠ¨ã€‚ æ²¿ç€è·¯å¾„<em>/ lib / systemd / system /</em>ç¼–è¾‘<em>cups.service</em>æœåŠ¡<em>æ–‡ä»¶</em> ï¼Œå°†<strong>After</strong>è¯­å¥æ·»åŠ åˆ°<strong>[Unit]</strong>éƒ¨åˆ†ï¼š </p><br><pre> <code class="plaintext hljs">[Unit] Description=CUPS Scheduler Documentation=man:cupsd(8) After=sssd.service</code> </pre> <br><p> å› æ­¤ï¼Œå°†CUPSé…ç½®ä¸ºé€šè¿‡åŸŸè¿›è¡ŒåŸºæœ¬æˆæƒï¼Œå³é€šè¿‡è¾“å…¥å…·æœ‰CUPSç®¡ç†ç‰¹æƒçš„åŸŸç”¨æˆ·çš„ç™»å½•åå’Œå¯†ç è¿›è¡Œæˆæƒã€‚ </p><br><p> å¯ä»¥å¯¹æˆæƒè¿›è¡Œä¸åŒçš„é…ç½®ï¼Œä½†æ˜¯åŸç†ï¼ˆç®¡é“æ–‡ä»¶ï¼‰é€šå¸¸æ˜¯é€šç”¨çš„ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç±»æ¨ä¸ºLDAPï¼ŒFreeIPAå’Œå…¶ä»–ç›®å½•æœåŠ¡é…ç½®æˆæƒã€‚ </p><br><h3 id="ustanovka-printera-v-linux"> åœ¨Linuxä¸Šå®‰è£…æ‰“å°æœº </h3><br><p> åœ¨Linuxä¸Šå®‰è£…æ‰“å°æœºé€šå¸¸æ˜¯ä¸€é¡¹ç‰¹å®šçš„ä»»åŠ¡ï¼Œå¯¹äºä¸åŒçš„å“ç‰Œç”šè‡³å‹å·ï¼Œè¯¥ä»»åŠ¡éƒ½ä¸ç›¸åŒã€‚ å› æ­¤ï¼Œæˆ‘è®¤ä¸ºæ²¡æœ‰ç†ç”±æè¿°æ‰“å°æœºçš„å®‰è£…ï¼Œå¹¶ä¸”å‡è®¾<strong>linux1</strong>ä¸»æœº<strong>å®‰è£…</strong>äº†åç§°ä¸º<strong>Kyocera-1024FP</strong>çš„Kyocera-1024FPæ‰“å°æœºï¼Œå¹¶ä¸”æ‰“å°æœºé¡µé¢ä½äº<code>http://linux1:631/printers/Kyocera-1024FP</code> ã€‚ </p><br><p> ç°åœ¨ï¼Œå·²ç»é…ç½®äº†LinuxæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯è®¡ç®—æœºï¼Œå…¶ä¸­ä¸€äº›å·²è¿æ¥äº†æ‰“å°æœºï¼Œå¹¶ä¸”è¿˜å…·æœ‰ç”¨äºæ‰“å°çš„Windowsè®¡ç®—æœºï¼Œå³ä½¿å¿…é¡»åœ¨å…¶ä¸­ä¸€å°PCä¸Šæ›´æ¢æ‰“å°æœºï¼Œæ•´ä¸ªç³»ç»Ÿä¹Ÿå¿…é¡»ç¨³å®šã€‚ ï¼Œé‚£ä¹ˆè¿™ä¸åº”æ„å‘³ç€å¯¹å…¨éƒ¨PCä¸­çš„ä¸€åŠï¼ˆå¦‚æœä¸æ˜¯å…¨éƒ¨ï¼‰è¿›è¡Œé‡æ–°é…ç½®ã€‚ æ­¤å¤–ï¼Œæ‚¨éœ€è¦å°½å¯èƒ½å°‘çš„é©±åŠ¨ç¨‹åºé—®é¢˜ã€‚ è¿™å¾ˆæœ‰å¯èƒ½ã€‚ </p><br><h3 id="gruppy-printerov-classes"> æ‰“å°æœºç»„ï¼ˆç±»ï¼‰ </h3><br><p>     <strong>Canon-MF4400</strong> c  <strong>windows1</strong>   LPD.            <code>http://cupsserver:631/printers/Canon-MF4400</code> .          <strong>cupsserver</strong> <code>http://cupsserver:631/admin</code> .      " " [Add Class].   .      "", "", "",       .            .  <strong>Canon-MF4400</strong>    ,    "" ,  <strong>printer-windows1</strong> , ""  ""   ,   " ". </p><br><p>      <strong>printer-windows1</strong>   <strong>Canon-MF4400</strong>  .           <strong>Canon-MF4400</strong>       â€” <code>http://cupsserver:631/classes/printer-windows1</code> . </p><br><p>         <strong>linux1</strong>  Kyocera-1024FP.      HTTP.    "   (http)" [Internet Printing Protocol (http)],      "Generic",  "IPP Everywhere".    ,        <strong>linux1</strong> â€” <strong>Kyocera-1024FP</strong> .        <code>http://cupsserver:631/printers/Kyocera-1024FP</code> .    <strong>printer-windows1</strong>   <strong>printer-linux1</strong> c  <strong>Kyocera-1024FP</strong>  .    <code>http://cupsserver:631/classes/printer-linux1</code> . </p><br><p>    <strong>Kyocera-1024FP</strong>   <strong>linux1</strong>   <strong>cupsserver</strong>   <strong>windows1</strong>   Windows 8      (!)  .        "    ".  <strong></strong>    <code>http://_c:631/classes/_</code> .     â€” <code>http://cupsserver:631/classes/printer-linux1</code> .        "Generic",  â€” "MS Publisher Imagesetter".   ,        <code>printer-linux1  http://cupsserver:631</code> .             ,          Kyocera-1024FP. </p><br><p>    <strong>Canon-MF4400</strong>   <strong>windows1</strong>   <strong>cupsserver</strong>   <strong>linux1</strong>   Linux      (!)  .         ,   <strong>Kyocera-1024FP</strong>   <strong>cupsserver</strong> .       <strong>linux1</strong>    "   (http)",     ( <strong>Canon-MF4400</strong> )       â€” <code>http://cupsserver:631/classes/printer-windows1</code> .        "Generic",  â€” "IPP Everywhere".    ,       â€” <strong>printer-windows1</strong> .     <strong>linux1</strong>   <code>http://linux1:631/printers/printer-windows1</code> ,        . </p><br><p>      ,        ,   ,     ,       ,         .      â€”     ,   ,     ,  ,       .        ,          .  "IPP Everywhere"  "MS Publisher Imagesetter"     ,   ..,          . </p><br><h3 id="zaklyuchenie"> ç»“è®º </h3><br><p>   ,   - ,       .  ,   ,    ,      ,           . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443094/">https://habr.com/ru/post/zh-CN443094/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443082/index.html">ä¸ºä»€ä¹ˆåœ¨å­¦ä¹ ä¸€ç§è¯­è¨€æ—¶ä¸åº”è¯¥çœ‹åˆ«äºº</a></li>
<li><a href="../zh-CN443084/index.html">Facebookæ‹’ç»å°†æœåŠ¡å™¨è½¬ç§»åˆ°ä¾µçŠ¯è¨€è®ºè‡ªç”±çš„å›½å®¶ï¼Œå¹¶å¼•å…¥äº†ç«¯åˆ°ç«¯åŠ å¯†</a></li>
<li><a href="../zh-CN443086/index.html">é£Ÿå“è®¾è®¡æ–‡æ‘˜ï¼Œ2019å¹´2æœˆ</a></li>
<li><a href="../zh-CN443090/index.html">ç½—æ–¯æ‰˜å¤«æ ¸ç”µç«™æ¸¸è§ˆ</a></li>
<li><a href="../zh-CN443092/index.html">æ–°çš„è¶…å£°æ³¢ä¼ æ„Ÿå™¨ä½¿æ‚¨å¯ä»¥â€œå¬â€ç»†èŒ-å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„</a></li>
<li><a href="../zh-CN443096/index.html">è®¾è®¡å¸ˆä¸æ˜¯æ–°é—»è®°è€…ã€‚ å¦‚ä½•è¿›è¡Œç”¨æˆ·é‡‡è®¿</a></li>
<li><a href="../zh-CN443098/index.html">ä½¿ç”¨ç£é“å’Œæ¿€å…‰å°†æ•°æ®å†™å…¥å…‰ç›˜</a></li>
<li><a href="../zh-CN443100/index.html">è®¡ç®—Windowsè®¡ç®—å™¨ä¸­çš„é”™è¯¯</a></li>
<li><a href="../zh-CN443102/index.html">è¡Œä¸ºæ”¹å˜ä½œä¸ºä¸€ç§äº§å“ï¼šä¸ºä»€ä¹ˆç›ä¸½Â·è¿‘è—¤ï¼ˆMarie Kondoï¼‰ä¸çº¢æ‰èµ„æœ¬ï¼ˆSequoia Capitalï¼‰è¿›è¡Œäº†4000ä¸‡ç¾å…ƒçš„èèµ„ï¼Ÿ</a></li>
<li><a href="../zh-CN443104/index.html">åœ¨Pythonä¸­ä½¿ç”¨æ¨¡ç³Šä¸‰è§’æ•°è®¡ç®—ç¬¦å·è¡¨è¾¾å¼</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>