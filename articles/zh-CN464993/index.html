<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤙🏿 👨🏿 ♠️ 在实践中为Rosa Linux构建RPM软件包 🦗 🙏🏼 💶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="如果您已经使用Linux操作系统很长时间了，甚至对编程一点也不了解，那么您可能迟早需要从源代码编译该程序。 可能所需的程序将不在分发存储库中。 或者该程序在这些存储库中有旧版本，并且您需要最新版本。 或者，也许您创建了一个新程序并希望与其他用户共享。 



 当然，您可以根据源代码随附的说明安装程...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>在实践中为Rosa Linux构建RPM软件包</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464993/"><p> 如果您已经使用Linux操作系统很长时间了，甚至对编程一点也不了解，那么您可能迟早需要从源代码编译该程序。 可能所需的程序将不在分发存储库中。 或者该程序在这些存储库中有旧版本，并且您需要最新版本。 或者，也许您创建了一个新程序并希望与其他用户共享。 <br></p><br><p> 当然，您可以根据源代码随附的说明安装程序。 但是随后您将需要手动管理程序文件并监视其依赖性。 最好使用程序构建程序包并使用操作系统中内置的应用程序管理器。 <br></p><br><p> 我希望本文能帮助您快速弄清楚如何为<em>Rosa Linux</em>或使用RPM软件包管理器的其他发行版（Mandriva，RedHat）构建RPM软件包。 或者至少告诉我在哪里寻找信息。 <br></p><br><p> 在这里，我将通过一个简单的示例展示如何在本地计算机上创建RPM软件包。 我们将在<em>Rosa Linux</em>操作系统中构建<em>xkb-switch</em>程序。 我们将从<em>GitHub</em>中获取程序的源代码。 <br></p><br><br><a name="habracut"></a><br><br><div class="spoiler">  <b class="spoiler_title">文章分为多个小部分，因此目录在扰流器下方</b> <div class="spoiler_text"><h2> 目录 </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于Rosa Linux的一些知识</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于xkb-switch的一些知识</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">设置，完成，检查程序</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在GitHub上没有您的个人资料的情况下检查源代码</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">将项目保存到GitHub个人资料进行验证</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">创建补丁</a> </li></ul><br></li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">准备“工作场所”以创建包</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">让我们开始创建一个规范文件</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于规范文件语法的一些知识</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">规格文件头</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">来源准备</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">合编</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">安装方式</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文件包装</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">什么是rpmlint</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rosa Linux的RPM软件包类型</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我们的结果</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如果您需要将包装分成几部分</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">添加一些宏</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">稍微改变标题</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">定义库包</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">定义软件包文件</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">解决其他问题</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">结论</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">主要队伍</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">生成软件包的有用命令</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">检查成品包装</a> </li></ul><br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有用的链接（主要来源）</a> </li></ul><br></div></div><br><br><a name="foreword"></a><br><h2> 关于Rosa Linux的一些知识 </h2><br><p>  <em>Rosa Linux</em>是由<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">俄罗斯开发人员</a>创建并支持的发行版。 它基于<em>Mandriva</em> ，但具有一些功能。 我使用的是2014年发布的32位版本的<em>Rosa Fresh R8</em> 。 现在，开发人员不再支持<em>R8</em>版本（它的存储库未更新），但是在我的笔记本电脑上可以很好地工作，因此我不想安装新版本。 <br></p><br><p> <em>Rosa Fresh R8</em>使用<em>KDE4</em>桌面。 分发软件包的所有版本都使用<code>rpm</code>和<code>urpm</code>管理器来管理带有应用程序的软件包，并且相应的命令是<code>rpm</code> ， <code>urpmi</code> ， <code>urpme</code> ， <code>urpmq</code>和<code>urpmf</code> 。 <br></p><br><p> 在同一Linux发行系列中，软件包构建原则通常很少更改。 因此，本文中描述的内容应在<em>Rosa</em>发行版的所有版本中均适用。 <br></p><br><p>  <em>与</em>基于<em>RPM</em>的其他<em>发行</em>版相比，在Rosa Linux上构建软件包要简单一些。 有些点是自动的，不需要进行配置。 <br></p><br><br><a name="foreword-xkb-switch"></a><br><h2> 关于xkb-switch的一些知识 </h2><br><p> 我喜欢将插件用于Vim文本编辑器<em>xkbswitch的想法</em> ，关于该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章在Habré上</a>有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一篇文章</a> 。 退出输入模式时，它将自动将键盘布局切换为英语，反之亦然-如果您再次进入输入模式，则切换为上一次输入文本的键盘布局。 为了使该插件正常工作，您需要使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">xkb-switch</a>程序，该程序可让您从命令行和<em>Vim</em>编辑器的插件中切换键盘布局。 该程序不在<em>Rosa Linux R8</em>存储库中（并且很可能没人会添加它，因为该发行版已经很旧，并且<em>xkb-switch</em>程序不是很流行）。 <br></p><br><br><a name="test_program"></a><br><h2> 设置，完成，检查程序 </h2><br><p> 通常，必须配置程序的编译以使其在特定发行版甚至特定系统中正常工作。 碰巧需要使用其他选项或某些特殊驱动程序的支持来构建程序。 或者，也许您想修复程序代码中的错误，或者只是检查它是否有效。 为此，最好在构建RPM软件包之前将源代码复制到您的计算机上，尝试对其进行编译并检查已编译程序的工作方式。 <br></p><br><p> 如果您确定不需要修改项目文件，则可以使用项目网站上的原始源代码并立即继续构建软件包。 但是，如果需要更改编译设置，通常比在源代码文件夹（即所谓的<em>makefile</em> ）中更改文件要容易得多，然后再处理编译命令的选项和spec文件的内部宏设备。 <br></p><br><br><a name="test_program-local"></a><br><h3> 在GitHub上没有您的个人资料的情况下检查源代码 </h3><br><p> 如果您决定使用源代码或项目编译设置，但是在GitHub上没有自己的个人资料或不想使用它，则只需下载并解压缩源代码即可。 在我们的例子中，它可能看起来像这样（我将<code>~/Projects/cpp</code>文件夹用于<em>C ++</em>源代码）： <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p> 这将创建<code>~/Projects/cpp/xkb-switch</code>文件夹，其中包含源代码。 当然<code>git</code>您可以使用程序下载存档并解压缩，而不是使用<code>git</code> 。 <br></p><br><p> 从项目文件夹中的<code>README.md</code>文件中，很容易猜出<code>cmake</code>实用程序用于构建程序。 因此，如果您需要更改编译设置，在我们的情况下，它们位于<code>CMakeLists.txt</code>文件中。 我们只是尝试编译该程序并检查它是否有效。 您需要为此使用的命令写在项目根目录的同一<code>README.md</code>文件中。 <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> xkb-switch mkdir build &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build cmake .. make ./xkb-switch <span class="hljs-comment"><span class="hljs-comment">#         ./xkb-switch -l #       ./xkb-switch -s ru #       (  )</span></span></code> </pre><br><br><p> 之后，为了使用更改后的项目，您将必须从项目中清除或删除<code>build</code>文件夹，并将源代码打包到存档中。 它可能看起来像这样： <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/xkb-switch rm -rf ./build <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp zip -r xkb-switch.zip xkb-switch</code> </pre><br><br><p> 然后<code>xkb-switch.zip</code>需要使用<code>xkb-switch.zip</code>文件来生成软件包。 <br></p><br><br><a name="test_program-github"></a><br><h3> 将项目保存到GitHub个人资料进行验证 </h3><br><p> 我认为阅读本节的任何人至少对<em>git的</em>使用有点熟悉，并且已经在<em>GitHub上</em>建立了个人资料。 我认为这种方法是最好的，因此，除非另有说明，否则本文的其余部分将暗示已使用该方法。 <br></p><br><p> 首先，您需要将原始项目分叉到<em>GitHub中</em> 。 之后，像前面的方法一样，我们将项目克隆到我们的计算机上，但是从我们的存储库中克隆（在我的情况下，用户名是<em>alexandersolovyov</em> ）： <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/alexandersolovyov/xkb-switch.git</code> </pre><br><br><p> 要添加任何更改，最好使用新分支。 然后，如果需要，可以使用该程序的不同版本。 而且还可以使用拉取请求向项目作者提出更改建议。 例如，如果您决定稍微修复<code>CMakeLists.txt</code>文件，那么在此之前，您需要使用以下命令创建一个新分支： <br></p><br><br><pre> <code class="bash hljs">git branch cmake_corrections</code> </pre><br><br><p> 进行更改，检查并添加到分支后（使用<code>git commit -am " "</code> ），可以将新分支添加到GitHub： <br></p><br><br><pre> <code class="bash hljs">git push origin cmake_corrections</code> </pre><br><br><p> 之后，如有必要，您可以提出请求请求。 <br></p><br><p> 您可以链接到原始存储库： <br></p><br><br><pre> <code class="bash hljs">git remote add ierton https://github.com/ierton/xkb-switch.git</code> </pre><br><br><p> 然后更新存储库的主分支，使其与原始分支匹配： <br></p><br><br><pre> <code class="bash hljs">git pull ierton master</code> </pre><br><br><p> 构建RPM时，可以使用与更正后的分支相对应的程序代码。 为此，您将需要在spec文件中的表单中指定档案的地址： <br></p><br><br><pre> <code class="plaintext hljs">Source0: https://github.com/-/-/archive/---.zip</code> </pre><br><br><p> 但是， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">正如specblog用户提示的那样</a> ，实际上并非如此。 最好以补丁的形式传达您的更改。 为此，您需要根据分支中的更改创建补丁文件，并将其复制到源文件夹以构建软件包（ <code>~/rpmbuild/SOURCES/</code> ）。 然后，您需要在规格文件中指定它们。 我们稍后会考虑，但是如果您愿意， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">可以在这里阅读</a> 。 如果您不知道如何创建补丁，则可以在扰流板下面查看。 <br></p><br><br><a name="test_program-github-patches"></a><br><div class="spoiler">  <b class="spoiler_title">如何使用git创建补丁</b> <div class="spoiler_text"><h4> 创建补丁 </h4><br><p>  <em>补丁</em> ，它们是<em>补丁</em> -这些文件中的更改记录在程序的源代码中。 如果不方便从远程存储库中“拉”出更改，或者项目的更改历史记录和使用它的原则使得最好使用补丁程序，它们可以用作<code>git pull</code>和<code>git push</code>命令的替代方法，以在本地代码存储库之间进行通信。 <br></p><br><br><p> 假设我们需要对<code>CMakeLists.txt</code>文件进行更改。 首先，您需要执行如上所述的所有操作：我们的GitHub存储库中的<em>master</em>分支应对应于原始项目的main分支，并且对于您的更改，您需要使用<em>cmake_corrections</em>分支。 然后，您需要转到此分支，进行必要的更改，然后使用提交将其保存在<em>git</em>中。 <br></p><br><p> 现在，您需要将更改作为补丁文件保存到<code>~/rpmbuild/SOURCES</code>文件夹（如果您未使用Rosa Linux，则<code>SOURCES</code>文件夹的路径可能不同）。 例如，这（我的意思是我们在项目文件夹中，例如<code>~/Projects/cpp/xkb-switch</code> ，并且在<code>cmake_corrections</code>分支上）： <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES origin/master</code> </pre><br><p>  <code>git format-patch</code>命令为每次提交创建一个<code>git format-patch</code>文件。 以这种形式，它将制作补丁程序，该补丁程序由最后一个参数指定的提交开始，并以当前分支的最后一次提交结束。 您可以以任何方式指定提交：在散列的开头，使用<em>HEAD</em>指针或分支名称（现在指示所需的提交）。 最主要的是， <code>git log</code>执行<code>git log</code>时可见的提交之一作为开始。 也就是说，您不能从另一个分支中的提交开始制作补丁。 <br></p><br><p> 您可以记住（或看到）我们从主分支分支返回的提交数量，并为一定数量的提交打补丁。 例如，如果我们进行了两次提交，则命令为： <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES -2</code> </pre><br><p> 这里的提交次数是使用<code>-2</code>设置的。 您可以指定任意数量的数字来代替该数字。 <br></p><br><p> 您可以通过在指向初始提交和最终提交的链接之间放置两点来指定提交补丁的提交范围： <br></p><br><pre> <code class="bash hljs">git format-patch -o ~/rpmbuild/SOURCES master..cmake_corrections</code> </pre><br><p> 每个补丁文件的名称均由序列号和提交注释的第一行组成。 因此，最好重命名每个文件，以便对补丁程序的描述更简短，更清楚地描述其本质。 例如，像这样： <br></p><br><pre> <code class="bash hljs">mv 0001-Return-memory-allocated-by-XkbRf-getNamesProp()-<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>-tmp.patch 001-Fix-memory-leak.patch</code> </pre><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于规范文件语法的文章中补丁的命名约定</a>建议在每个补丁文件的描述之前添加<em>package_name-version-rosa-</em> 。 如果您通过电子邮件发送补丁，而不是用于构建软件包，那么这也许是一个好习惯。 我们是在计算机上构建软件包的，因此最好在每次使用另一个程序或新版本的软件包<code>~/rpmbuild/SOURCES</code>软件包之前，先清空<code>~/rpmbuild/SOURCES</code>文件夹。 <br></p><br><p> 现在，如果需要更新主存储库分支（ <em>master</em> ）以使其与原始存储库分支匹配，则此后，将需要使用<code>git rebase</code>来更新更改分支（ <em>cmake_corrections</em> ）。 您<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">可以在此处查看</a>如何执行此操作。 之后，将需要重新创建补丁。 <br></p><br></div></div><br><br><a name="prepare"></a><br><h2> 准备“工作场所”以创建包 </h2><br><p> 首先，您需要创建目录结构。 所有组装都在<code>rpmbuild</code>主文件夹的<code>rpmbuild</code>文件夹中进行。 创建初始目录结构，然后转到规格文件的文件夹： <br></p><br><br><pre> <code class="bash hljs">mkdir -p ~/rpmbuild/SPECS &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/SPECS</code> </pre><br><br><p> 对于Rosa Linux，这已经足够：其余文件夹将自动创建。 <br></p><br><p> 另一个发行版可能会使用其他文件位置来构建程序包。 也许您必须手动创建整个文件夹层次结构。 如果您不使用Rosa Linux，请查找有关发行的信息。 例如， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在Red Hat中可能看起来像这样</a> 。 <br></p><br><p> 如果该软件包是用错误构建的，则不会删除<code>rpmbuild</code>命令创建的所有文件-与成功构建相同。 我们将尝试多次收集软件包，而上次之后剩余的文件将受到干扰。 因此，最好制作一个简单的脚本来帮助快速删除它们。 创建cleanup.sh文件并将其放在<code>~/rpmbuild/SPECS</code> 。 其内容如下： <br></p><br><br><pre> <code class="bash hljs">!<span class="hljs-comment"><span class="hljs-comment">#/bin/sh rm -rf ~/rpmbuild/BUILD/* rm -rf ~/rpmbuild/BUILDROOT/* rm -rf ~/rpmbuild/RPMS/* rm -rf ~/rpmbuild/SRPMS/*</span></span></code> </pre><br><br><p> 当然，最好使用<code>chmod u+x cleanup.sh</code>为其添加执行权限。 <br></p><br><p> 如果您想从本地计算机上的文件中收集软件包-如果您不使用<em>GitHub</em>并对项目文件进行了更改，或者想从仅存储在计算机上的您自己的程序中创建一个软件包-您需要将该项目打包到一个档案中（例如<code>.zip</code> ， <code>.tar</code>或<code>.tar.gz</code> ），然后将其放在<code>SOURCES</code>文件夹中。 例如，像这样： <br></p><br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/Projects/cpp/ zip -r xkb-switch.zip xkb-switch mkdir -p ~/rpmbuild/SOURCES cp xkb-switch.zip ~/rpmbuild/SOURCES/</code> </pre><br><br><p> 如果在构建程序后要构建另一个或相同但不同的版本，则需要从<code>~/rpmbuild/SOURCES</code>文件夹中删除所有文件，然后将存档复制到该文件夹​​中（如果您不从<em>GitHub</em>下载）。补丁文件（如果使用）。 否则，很可能不会从<em>GitHub</em>下载存档文件（为什么-稍后再看），并且也很难弄清楚哪个补丁文件属于哪个程序。 <br></p><br><br><a name="specfile_start"></a><br><h2> 让我们开始创建一个规范文件 </h2><br><p> 构建RPM软件包的基础是所谓的<em>斑点文件</em> 。 该文件包含构建软件包所需的<code>rpmbuild</code>程序（或<code>rpm</code> ）的说明。 <br></p><br><p> 在<code>~/rpmbuild/SPECS/</code>创建<code>xkb-switch.spec</code>文件。 最简单的开始方法是在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">模板规范文件</a>网站上找到<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">模板</a> 。 <br></p><br><p> 从<em>xkb-switch</em>项目页面上的<code>README</code> ，可以知道该程序是使用<code>cmake</code>实用程序编译的。 因此，我们将为<strong>使用CMake构建的程序</strong>选择<strong>Spec文件，</strong>然后将整个模板复制到我们的spec文件中。 当然，为了正确地组装我们的RPM软件包，我们需要对此模板进行很多更改。 <br></p><br><br><a name="specfile_syntax"></a><br><h2> 关于规范文件语法的一些知识 </h2><br><ul><li>  spec文件语法允许您添加bash样式的注释。 <br></li><li> 您可以使用空格作为同一行上的值之间的空格，以创建偶数列的外观，但是文档强烈建议使用制表符（一或两个，只要列是偶数）。  <strong>注意：</strong>在本文的所有代码示例中，仅使用空格，因此最好不要将所有文本从此处复制到规范文件中，而是自己打印。 <br></li><li> 选项字段由带有冒号的特殊选项名称和制表符（或空格）中的下一个值组成。 字段名称中字符的大小写无关紧要。 例如： <br><pre> <code class="plaintext hljs"> Name: xkb-switch</code> </pre><br></li><li> 如果单词前面带有<code>%</code>符号（例如<code>%description</code> ），则这是一个特殊的关键字。 它可以是命令，宏或脚本调用。 然后，可以在其后指示其使用的参数。 并且有一些关键字指示命令或选项块的开始。 然后，可以在其旁边指示参数，并且在下一行应该有我在上一段中描述的命令或选项列表。 在这样的块之后，应留空行。 <br></li><li> 要使用常量的值，您需要在<code>%{_}</code>插入<code>%{_}</code>形式的构造。 它的值可以是预定义的，也可以由选项（例如<code>Name: xkb-switch</code> ）或关键字<code>%define</code> 。 所有这些常量也被视为宏。 它们的使用将在下面更详细地讨论。 <br></li></ul><br><br><a name="specfile_header"></a><br><h2> 规格文件头 </h2><br><p> 在spec文件中，标题始终是最先写入的。 这是适用于主RPM软件包的选项列表。 准备好包装后，查看其说明时将显示几乎所有这些信息。 以下是各行指示的内容： <br></p><br><br>  <b>总结：</b> <br> 包装的简短说明。 我在<em>xkb-switch</em>项目的<code>README.md</code>文件中监视了该描述： <code>Query and change XKB layout state</code> 。 <br><br>  <b>名称：</b> <br> 包的名称。 在我们的例子中，这是<code>xkb-switch</code> 。 <br><br>  <b>版本号：</b> <br> 程序版本。 要找出<code>CMakeLists.txt</code> ，最好查看项目根文件夹中的<code>CMakeLists.txt</code>文件。 当然，您需要从将用于汇编的项目副本中获取文件。 如果您使用原始项目，则<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">可以直接在其GitHub页面上打开文件</a> 。 如您所见，该版本由<code>MAJOR_VERSION</code> ， <code>MINOR_VERSION</code>和<code>RELEASE_VERSION</code> 。 我使用的程序版本为<code>1.6.0</code> 。 <br><br>  <b>发布：</b> <br> 软件包本身的版本号。 显示何时组装具有相同版本程序的软件包。 在我们的例子中，这是“ 1”，因为没有人汇编过该版本的程序。 在理想情况下，如果我们已经尝试构建软件包并且程序集已到达末尾（即使有错误），那么在每次进行新的尝试后，您都需要将该数字增加1，同时不要从<code>rpmbuild/RPMS</code>和<code>rpmbuild/SRPMS</code>删除旧收集的软件包。 ：接下来，将创建具有新内部版本号的新软件包。 如果您使用特殊的服务器进行组装，也许应该这样做。 我们使用计算机，而是清理文件夹。 如果包含此版本程序的软件包已在Linux发行版的存储库中，但您正在使用其他设置进行编译，则最好将发行号指定为1。 <br><br>  <b>执照：</b> <br> 程序分发所依据的许可证的简称。 根据Rosa Linux的规则，您只能使用允许免费分发的许可证来构建软件包。  <code>README.md</code>可以从<code>README.md</code>文件中找到许可证是<em>GNU GPLv3</em> 。 所以我们写： <code>GPLv3+</code> 。 <br><br>  <b>组别：</b> <br> 程序所属的组或类别。 使用这些组，可以在应用程序启动菜单和窗口程序管理器中对程序进行排序（“添加或删除程序”）。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rosa Linux的组列表可以在这里找到</a> 。 我认为<code>Development\X11</code>最适合我们，因为该程序与X11相关，并且主要是为Vim创建脚本和插件所必需的。 <br><br>  <b>网址：</b> <br> 您可以在其中下载程序原始源代码的Internet地址。 在查看RPM软件包信息时将指定它。 此项是可选的，但我们将指出： <code>https://github.com/ierton/xkb-switch</code> : <code>https://github.com/ierton/xkb-switch</code> <br><br>  <b>来源0：</b> <br> 包含源代码的存档文件的名称，或可下载该文件的Internet地址。 如果您在Internet上指定地址，则在首次构建期间，文件将下载到<code>~/rpmbuild/SOURCES/</code> 。 如果已经存在这样的文件，则将不再下载该文件，也就是说， <code>rpmbuild</code>程序将仅使用此URL末尾指定的文件名。 您可以仅指定文件名，但随后需要将其手动放置在<code>~/rpmbuild/SOURCES/</code>文件夹中。 最好在GitHub上提供项目副本的地址。 我使用了<code>https://github.com/alexandersolovyov/xkb-switch/archive/master.zip</code>文件。 您可以指定多个不同的源，以借助一个斑点文件从多个归档中收集源。 然后，在添加每个后续存档的选项的名称中，数量应增加（ <code>Source1</code> ， <code>Source2</code>等）。 当查看RPM软件包信息时，这些文件地址不可见。 <br><br>  <b>补丁0：</b> <br> 此选项不在模板文件中。 如果您决定以补丁程序的形式在程序的项目文件中传输更改，它可能会派上用场。 对于<code>Source0</code>选项，每个文件必须在单独的行中指示，并且选项名称末尾的数字必须每次增加。 修补程序文件应位于<code>~/rpmbuild/SOURCES</code>文件夹中（已下载源归档文件旁边）。 每个文件的名称都必须写成没有路径的文件。 不必在此处指定所有补丁文件-只有要应用的补丁文件可以。 <br><br>  <b>构建要求：</b> <br> 生成程序所需的软件包。 模板<code>cmake</code> 。  <code>CMakeLists.txt</code>文件指示用于组装的CMake的最低版本应不低于<em>2.6</em> ，因此最好指定<code>cmake &gt;= 2.6</code> 。 您可以使用单独的<code>BuildRequires:</code>选项添加其他程序包，每个程序包都放在单独的行上。 可以通过阅读项目的<code>README</code>并仔细查看<code>CMakeLists.txt</code>文件（尤其是<code>FIND_PACKAGE</code> ， <code>TARGET_LINK_LIBRARY</code>和<code>FIND_PROGRAM</code> ）来找到组装所需的软件包列表。 然后，您需要使用命令<code>urpmq -a __</code>在存储库中找到正确的软件包名称。 在我们的例子中，编译设置文件（ <code>CMakeLists.txt</code> ）已经包含用于检查系统中必要软件包是否存在的行。 但最好也在此处指定整个列表： <br><pre> <code class="plaintext hljs"># CMake  2.6   BuildRequires: cmake &gt;= 2.6 #  C/C++ BuildRequires: gcc #    libxkbfile BuildRequires: libxkbfile-devel #   X11   libxkbfile, #  libx11-devel   . #    man: BuildRequires: xz</code> </pre><br><br>  <b>需要：，提供：</b> <br> 这些选项不在示例中，但有时可以派上用场。 它们在软件包之间建立依赖关系。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该选项</font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指定要生成</font><font style="vertical-align: inherit;">的软件包提供</font><font style="vertical-align: inherit;">的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这可能是语言文件头的名称</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，或动态链接库名，或者任何特殊功能。该选项</font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示该</font><font style="vertical-align: inherit;">软件包依赖于其他软件包的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。软件包管理器（</font></font><code>rpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>urpm</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或谁使用发行人），搜索寻找这些依赖关系时</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的机会</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，而不是包名。因此，为了</font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提供最佳的指定版本</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的功能</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，并为</font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-提供什么版本的</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">机会</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">适应。版本用符号表示</font></font><code>&gt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font></font><code>&lt;=</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，由空格包围。通常，首先显示所有选项</font></font><code>Requires</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，然后显示- </font></font><code>Provides</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，即每行一个功能名称-与相同</font></font><code>BuildRequires:</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。通常，在Rosa Linux上构建软件包时，将自动识别依赖项，并且很少需要指定这些选项。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoReq：，AutoProv：</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您正在</font><b><font style="vertical-align: inherit;">构建使用</font></b></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">管理器是</font><font style="vertical-align: inherit;">新</font><font style="vertical-align: inherit;">语言</font><font style="vertical-align: inherit;">或专有</font><font style="vertical-align: inherit;">语言编写</font><b><font style="vertical-align: inherit;">的</font></b><font style="vertical-align: inherit;">程序</font><font style="vertical-align: inherit;">，并且不能正确地自动检测依赖关系，则可以禁用对</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">功能</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（带有</font></font><code>AutoProv: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）和/或</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">依赖项</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（带有帮助</font></font><code>AutoReq: no</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％说明</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">该块不再是标题的一部分，而是与其关联。</font><font style="vertical-align: inherit;">他将在RPM软件包中添加对该程序的完整描述。</font><font style="vertical-align: inherit;">其后应留空行。</font><font style="vertical-align: inherit;">描述可以如下：</font></font><br><pre> <code class="plaintext hljs">%description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">仅当您构建支持多种语言的应用程序时才需要</font><font style="vertical-align: inherit;">模板中以</font></font><code>%files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font><font style="vertical-align: inherit;">开头的行</font></font><code>%find_lang</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，因此将其删除。</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此外，在分隔行注释之后，接着是在打包文件之前必须完成的命令和宏。</font><font style="vertical-align: inherit;">所有这些命令都分为使用特殊关键字定义的块。</font></font></p><br><br><a name="prep"></a><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 来源准备 </font></font></h2><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">第一个是</font></font><code>%prep</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">指示要准备编译的命令</font><font style="vertical-align: inherit;">的块</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它是一个宏命令</font></font><code>%setup</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">她运行一个脚本，该脚本执行以下操作：</font></font></p><br><br><ul><li>       ,      <code>SourceX:</code>    (  —  <code>Source0:</code> ).         ,    . <br></li><li>      <code>~/rpmbuild/SOURCES/</code> . <br></li><li>      <code>~/rpmbuild/BUILD/</code> . <br></li><li>      . <br></li></ul><br><br><p>   <code>-q</code> ,       . </p><br><p>     ,     <code>%prep</code> : </p><br><br><pre> <code class="bash hljs">rpmbuild -bp ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>rpmbuild</code> .       ,      <code>rpm</code>    : <code>rpmbuild</code>    ,      .           (   <code>root</code>    <code>sudo</code> ).    <code>rpmbuild</code>  ,  <code>man rpmbuild</code> .      ,       ,   , —  ,          <code>rpmbuild</code> . <br></p><br><p>      : <code>xkb-switch-1.6.0: No such file or directory</code> .    ,          <code>~/rpmbuild/BUILD/xkb-switch-1.6.0</code> ,  .   <br></p><br><br><pre> <code class="bash hljs">ls ~/rpmbuild/BUILD/</code> </pre><br><br><p> ,     <code>xkb-switch-master</code> .     <code>%setup</code>    <code>-n</code> .    <code>%prep</code>  -   : <br></p><br><br><pre> <code class="bash hljs">%prep %setup -q -n xkb-switch-master</code> </pre><br><br><p>    <code>~/rpmbuild/SPECS/cleanup.sh</code> ,    <code>BUILD</code> ,     ,   <code>%prep</code> .  ,     <code>exit 0</code> .  ,     . <br></p><br><p>          ,         .       <code>%prep</code> .       ,    ,      : <br></p><br><pre> <code class="plaintext hljs">%apply_patches</code> </pre><br><p>       <code>rpmbuild -bp xkb-switch.spec</code> .    —    . <br></p><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  Maximum RPM</a> . <br></p><br><p>    . <br></p><br><br><a name="build"></a><br><h2>  </h2><br><p>      <code>%build</code> .   <code>README</code>  ,     <code>cmake ..</code>  <code>make</code> ,     -   .  :           ,     .    ,        <code>%build</code> : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bc ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>     <code>exit 0</code> :    . <br></p><br><p> ,         .     shell (  bash  zsh,     ).  <code>rpmbuild</code>      ,           .    shell    - —        . (    .) <br></p><br><p>     -  , ,  ,     <code>%build</code>  shell  . <br></p><br><p>     ,    ,   .      <code>cmake</code> , , ,        <code>%cmake</code>      -  ,      ,    .         (   — <code>CMakeLists.txt</code> ).             ,    . <br></p><br><br><a name="install"></a><br><h2> 安装方式 </h2><br><p> , <em></em> .   <code>%install</code>   ,               ,     ,    <code>~/rpmbuild/BUILDROOT/__-buildroot/</code> . <br></p><br><p>  <code>__</code>    ,     <code>Name:</code>   -,   ( <code>Version:</code>  -),   ( <code>Release:</code>  -),  ,     . <br></p><br><p>   <code>README</code>  ,     <code>make install</code> ,    <code>build</code>   .  - - <code>%makeinstall_std -C build</code>    ,   .       ( ,   ): <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -bi ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p>      ,       RPM.   -   ,     . <br></p><br><br><a name="packing"></a><br><h2>   </h2><br><p>         ,      -  .     ,     <code>~/rpmbild/BUILDROOT/</code> . ( , ,     <code>tree</code> ,  -      Linux.)  ,       ,       <code>.debug</code> .    , ,    :        . <br></p><br><p>  ,       ,   <code>%files</code>  -.   ,     ,      .  . <br></p><br><p>       <code>%files</code>  -.  ,    .   Rosa Linux       <code>%prep</code> (  -   ).   ,   ,     ,  ,        —   .          - (,    ,     ). <br></p><br><p>   <code>%files</code>    ,      RPM. ,     : <br></p><br><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz</code> </pre><br><br><p>         -.   , ,     <code>/usr/lib/rpm/macros</code> .  , <code>%{_bindir}</code>     , <code>%{_libdir}</code> —   ,  <code>%{_mandir}</code> —    man.   <code>%{name}</code>  <code>%{version}</code>    <code>Name:</code>  <code>Version:</code>   -. <br></p><br><p>     : <br></p><br><br><pre> <code class="bash hljs">~/rpmbuild/SPECS/cleanup.sh rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> </pre><br><br><p> …   2   1 .    <code>rpmlint</code> ,      .  ,   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> Rpmlint Errors</a>  ,   : <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586：E：名称不一致（</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误：</font><b><font style="vertical-align: inherit;">50）1`</font></b><font style="vertical-align: inherit;">错误：库包名称中的版本未正确指定。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586：E：库中可执行文件包（Badness：1）/ usr / bin / xkb-switch`</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">错误：库包中包含可执行文件。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`xkb-switch.i586：W：非开发包</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font><b><font style="vertical-align: inherit;">/ usr / lib / libxkbswitch.so`</font></b><font style="vertical-align: inherit;">警告在非</font><em><font style="vertical-align: inherit;">开发包</font></em></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中找到</font><font style="vertical-align: inherit;">了</font><em><font style="vertical-align: inherit;">开发包</font></em><font style="vertical-align: inherit;">文件</font><font style="vertical-align: inherit;">（</font><font style="vertical-align: inherit;">）。</font></font><br><br><br><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一切都清楚了吗？</font><font style="vertical-align: inherit;">我不这么认为。</font><font style="vertical-align: inherit;">让我们仔细看看这里发生了什么。</font></font><br></p><br><br><a name="packing-rpmlint"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 什么是rpmlint </font></font></h3><br><p>     Rosa Linux  <code>rpmbuild</code>   <code>rpmlint</code> ,    .  <code>rpmlint</code>    ,   ,      .   ,     Rosa Linux (  ,     <code>rpmlint</code> )     . <br></p><br><p>     ,     ,      .       <code>~/rpmbuild/RPMS/_/</code>         <code>rpmlint -i __</code> . <br></p><br><p> ,      RPM   - ,  ,    ,  ,      Rosa Linux,      <code>rpmlint -i __</code> . <br></p><br><br><a name="packing-package_types"></a><br><h3>   RPM  Rosa Linux </h3><br><p>   Rosa Linux   6 .   ,          . <br></p><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">可执行程序包</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它是二进制的。它仅包含直接用于执行的二进制文件或脚本。这些软件包的文件通常安装在文件夹</font></font><code>/bin/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或中</font></font><code>/usr/bin</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。也可能包含链接-用于使用几个不同名称调用程序的可能性。程序包的名称与程序的名称相对应。此类软件包通常取决于库。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">包含程序使用的动态连接（“共享”，“共享”）库的编译文件。通常，这是库文件本身，其名称以版本结尾，并且指向该文件的链接，其名称以第一个版本号结尾。例如，对于库</font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">版本1.0.2，它将是一个文件</font></font><code>libxkbfile.so.1.0.2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">及其链接，</font></font><code>libxkbfile.so.1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。库软件包的名称（在安装程序的存储库中通过该名称进行识别）以第一个版本号结束，并以prefix开头</font></font><code>lib</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。该库具有</font></font><code>libxkbfile</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">正确的名称- </font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。这是由于通常只有在不兼容的库更改的情况下才会更改第一个版本号，因此，如果某些程序使用库的旧版本，而其他程序使用库的较新版本，则可以安装具有不同版本的库的多个软件包。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发人员软件包</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译使用该库的程序所需的文件，而对于现成程序的工作则不必要的文件。对于简单的</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C ++</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">程序</font><font style="vertical-align: inherit;">，这是指向库文件的链接，但名称中没有版本（例如，</font></font><code>libxkbfile.so</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）以及头文件（扩展名为</font></font><code>.h</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。包的名称结尾</font></font><code>-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，例如：</font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。在安装期间，它始终取决于适当的库。例如，包</font></font><code>libxkbfile-devel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">取决于</font></font><code>libxkbfile1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">源代码</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rosa Linux存储库具有RPM软件包，其中包含某些程序的源代码-大多数仅用于那些</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确实需要</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">重建的程序。这些软件包的名称以</font></font><code>-src</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">或</font><font style="vertical-align: inherit;">结尾</font></font><code>-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（例如</font></font><code>apache-source</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）。</font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">总是自动创建这样一个包并放入</font></font><code>~/rpmbuild/SRPMS/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调试符号</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这是可用于调试完成的程序的信息。</font><font style="vertical-align: inherit;">它将已编译文件中的位置与源代码相关联。</font><font style="vertical-align: inherit;">此类软件包由团队</font></font><code>rpmbuild</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自动</font><font style="vertical-align: inherit;">创建，并</font><font style="vertical-align: inherit;">为它们的名称指定了结尾</font></font><code>-debuginfo</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">我在Rosa Linux存储库中找不到此类软件包。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文档</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Rosa Linux存储库具有用于各种程序和库的文档包。</font><font style="vertical-align: inherit;">我（暂时）不了解构建此类软件包的功能。</font><font style="vertical-align: inherit;">他们的名字通常最终在</font></font><code>doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：例如</font></font><code>libx11-doc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，</font></font><code>java-1.7.0-openjdk-javadoc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">顺便说一下，几乎所有文件都是按照网站样式制作的，要查看它们，最好打开浏览器，转到地址</font></font><code>file:///usr/share/doc/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并选择所需的文件夹和文件。</font></font><br><br><br><br><a name="packing-result"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 我们的结果 </font></font></h3><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 现在，一切都变得更加清晰了。 </font></font><br></p><br><br><ul><li>    <code>xkb-switch</code>   <code>libxkbswitch.so</code> , ,  ,    <em>  </em> .   ,          : <code>xkb-switch.i586: W: devel-file-in-non-devel-package /usr/lib/libxkbswitch.so</code> . <br></li><li>     <em></em> ,      <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> .       ,       .  : <code>xkb-switch.i586: E: executable-in-library-package (Badness: 1) /usr/bin/xkb-switch</code> . <br></li><li>    ,          (1).   : <code>xkb-switch.i586: E: incoherent-version-in-name (Badness: 50) 1</code> . <br></li></ul><br><br><p> ,  <code>rpmlint</code> ,     .          .   <em>xkb-switch</em> ,      <code>libxkbswitch.so.1.6.0</code>       ,        <em>Vim</em> .            <em>xkb-switch</em> ,          <em>C</em>  <em>C++</em> .  RPM-    . <br></p><br><p>       -: <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-   xkb-switch</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">Summary: Query and change XKB layout state Name: xkb-switch Version: 1.6.0 Release: 1 License: GPLv3+ Group: Development/X11 URL: https://github.com/ierton/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor via 'libxkbswitch.so'. It is mainly used by a plugin for Vim text editor, vim-xkbswitch. Originally ruby-based code written by J.Broomley. %files %{_bindir}/%{name} %{_libdir}/libxkbswitch.so %{_libdir}/libxkbswitch.so.1 %{_libdir}/libxkbswitch.so.%{version} %{_mandir}/man1/%{name}.1.xz #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="subpackaging"></a><br><h2>       </h2><br><p>        — ,         .    ,  ,       <code>xkb-switch</code>  3 : <em></em> , <em></em>   <em></em> . : <br></p><br><br><ul><li>  <em></em>     <code>/usr/bin/xkb-switch</code>    <code>/usr/share/man/man1/xkb-switch.1.xz</code> , <br></li><li>  <em></em> —  <code>/usr/lib/libxkbswitch.so.1</code>  <code>/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <em> </em> — <code>/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       -.  ,   , <br>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  - Maximum RPM</a> .     <a href=""> -  libxkbfile</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   Rosa Linux</a> . <br></p><br><p>    . <br></p><br><br><a name="subpackaging-macros"></a><br><h3>    </h3><br><p>        —   <a href="">-  libxkbfile</a> .     -  : <br></p><br><br><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch</code> </pre><br><br><p>    <code>%define</code>  .        ,    (     ) —   ,       .     ,    <code>%{major}</code>   <code>1</code> ,      . <br></p><br><p>  <code>%mklibname</code>   «lib»,     ,      —   (  ).     <code>%{libname}</code>  <em>«lib» + «xkbswitch» + (  %{major}) =</em> <code>libxkbswitch1</code> —   . <br></p><br><p>  <code>-d</code>  <code>%mklibname</code>   <code>-devel</code> .    <code>%{develname}</code>  <code>libxkbswitch-devel</code> —    . <br></p><br><br><a name="subpackaging-change_header"></a><br><h3>    </h3><br><p>     <code>Version:</code>   <br></p><br><br><pre> <code class="plaintext hljs">Version: %{major}.6.0</code> </pre><br><br><p>  ,           -. <br></p><br><p>      -       .      .      : <br></p><br><pre> <code class="plaintext hljs">Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley.</code> </pre><br><br><a name="subpackaging-packages"></a><br><h3>    </h3><br><p>     <em>-</em>     . <em>-</em>   , -      (    <em>rpm</em> ).       <code>%package</code> .        -.     ,    -.          <code>Version</code> , <code>Summary</code> , <code>Group</code> .      <code>Provides</code>  <code>Requires</code>   <em></em>  <em></em> ,     .  <code>Name</code>   :    ,     <code>%package</code> . <br></p><br><p>      .     <code>%description</code>       —   ,     <code>%package</code> . <br></p><br><p>  Rosa Linux   -   <code>%description</code>  -.    <code>libxkbswitch1</code> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'.</code> </pre><br><br><p>  <code>-n</code>    <code>%package</code>  <code>%description</code> ,       .    -        ,    <code>xkb-switch-libxkbswitch1</code> .       <code>libxkbswitch1</code> .           . <br></p><br><p>    <em> </em> : <br></p><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'.</code> </pre><br><br><a name="subpackaging-files"></a><br><h3>     </h3><br><p>   ,      .     <code>%files</code> . <br></p><br><p>      ,     ,    <code>%package</code> , <code>%description</code>  <code>%files</code> .  ,    <code>%description</code>  -    .   ,      ,    — <code>xkb-switch</code> . <br></p><br><p>  -  Rosa Linux     <code>%files</code>   ,    <code>%prep</code> .       : <br></p><br><pre> <code class="plaintext hljs">%files %{_bindir}/%{name} %{_mandir}/%{name}.1.xz %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %files -n %{develname} %{_libdir}/libxkbswitch.so</code> </pre><br><br><p>    , : <br></p><br><br><ul><li>   <code>xkb-switch</code>   <code>~/usr/bin/xkb-switch</code>  <code>~/usr/share/man/man1/xkb-switch.1</code> , <br></li><li>   <code>libxkbswitch1</code>   <code>~/usr/lib/libxkbswitch.so.1</code>  <code>~/usr/lib/libxkbswitch.so.1.6.0</code> , <br></li><li>    <code>libxkbswitch-devel</code>   <code>~/usr/lib/libxkbswitch.so</code> . <br></li></ul><br><br><p>       <code>cleanup.sh</code>       <code>rpmbuild -ba ~/rpmbuild/SPECS/xkb-switch.spec</code> .    3 : <br></p><br><br><pre> <code class="plaintext hljs">libxkbswitch1.i586: W: no-documentation libxkbswitch-devel.i586: W: no-documentation libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> </pre><br><br><p>   ,       .   ,     .     . 让我们尝试找出答案。 <br></p><br><br><a name="subpackaging-problems"></a><br><h3>    </h3><br><p> ,      ,  ,        <code>README.md</code> .     <code>%files</code>      —    <code>%doc</code> : <br></p><br><br><pre> <code class="plaintext hljs">%doc README.md</code> </pre><br><br><p>      .    <code>%doc</code> —    .        <code>~/rpmbuild/BUILD/xkb-switdh-master/README.md</code> . <br></p><br><p>       : <code>libxkbswitch-devel.i586: W: no-dependency-on libxkbswitch/libxkbswitch-libs/liblibxkbswitch</code> .  ,    <code>libxkbswitch-devel</code>    <code>libxkbswitch</code>  . <br></p><br><p>    <code>rpm -qp  --</code>       .            : <br></p><br><pre> <code class="bash hljs">[user@pc ~] $ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/rpmbuild/RPMS/i586/ [user@pc ~/rpmbuild/RPMS/i586] $ ls libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm xkb-switch-debuginfo-1.6.0-1-rosa2014.1.i586.rpm [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch1-1.6.0-1-rosa2014.1.i586.rpm libxkbswitch.so.1 libxkbswitch1 = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --provides libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libxkbswitch) libxkbswitch-devel = 1.6.0-1:2014.1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires libxkbswitch-devel-1.6.0-1-rosa2014.1.i586.rpm devel(libX11) devel(libgcc_s) devel(libstdc++) devel(libxkbfile) rpmlib(PayloadIsXz) &lt;= 5.2-1 [user@pc ~/rpmbuild/RPMS/i586] $ rpm -qp --requires xkb-switch-1.6.0-1-rosa2014.1.i586.rpm libc.so.6 libc.so.6(GLIBC_2.0) libc.so.6(GLIBC_2.1.3) libgcc_s.so.1 libgcc_s.so.1(GCC_3.0) libstdc++.so.6 libstdc++.so.6(CXXABI_1.3) libstdc++.so.6(GLIBCXX_3.4) libstdc++.so.6(GLIBCXX_3.4.11) libstdc++.so.6(GLIBCXX_3.4.20) libstdc++.so.6(GLIBCXX_3.4.9) libxkbswitch.so.1 rpmlib(PayloadIsXz) &lt;= 5.2-1</code> </pre><br><br><p>  ,    <code>libxkbswitch1</code>   <code>libxkbswitch.so.1</code>  <code>libxkbswitch1</code> .  <code>xkb-switch</code>   <code>libxkbswitch.so.1</code> ,     <code>libxkbswitch-devel</code>    <code>libxkbswitch1</code> .   ,     <code>%package</code>  <code>libxkbswitch-devel</code> .      : <br></p><br><br><pre> <code class="plaintext hljs">%package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version}</code> </pre><br><br><p>        , …       .     <code>libxkbswitch-devel</code>  ,  ,    .     ,         ,  <code>rpmbuild</code>      . <br></p><br><p> -,     (  <code>README.md</code>    ), —  : <br></p><br><br><div class="spoiler"> <b class="spoiler_title">-    </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">%define major 1 %define libname %mklibname xkbswitch %{major} %define develname %mklibname -d xkbswitch # Main package. Automaticaly requires libxkbswitch and libxkbswitch-devel Name: xkb-switch Version: %{major}.6.0 Release: 1 Summary: Query and change XKB layout state License: GPLv3+ Group: Development/X11 URL: https://github.com/alexandersolovyov/xkb-switch Source0: https://github.com/alexandersolovyov/xkb-switch/archive/master.zip BuildRequires: cmake &gt;= 2.6 BuildRequires: gcc BuildRequires: libxkbfile-devel BuildRequires: xz %description xkb-switch is a C++ program that allows to query and change the keyboard layout state for X11 Window System (XKB) via command line. It provides a command 'xkb-switch', and bindings for API of the Vim text editor, a library 'libxkbswitch'. It is mainly used for some plugins for Vim text editor, such as vim-xkbswitch. Originally ruby-based code written by J.Broomley. # libxkbswitch %package -n %{libname} Version: %{version} Summary: A library for xkb-switch tool, provides API bindings for Vim text editor Group: Development/X11 %description -n %{libname} libxkbswitch library, required by xkb-switch tool. It provides bindings for API of the Vim text editor, which can be used via 'libxkbswitch.so.1'. # libxkbswitch-devel %package -n %{develname} Version: %{version} Summary: Development library libxkbswitch, provides API bindings for Vim text editor Group: Development/X11 Requires: %{libname} &gt;= %{version} %description -n %{develname} Development files for libxkbswitch. Provides bindings for API of the Vim text editor via 'libxkbswitch.so'. # xkb-switch %files %{_bindir}/%{name} %{_mandir}/man1/%{name}.1.xz # libxkbswitch1 %files -n %{libname} %{_libdir}/libxkbswitch.so.%{major} %{_libdir}/libxkbswitch.so.%{version} %doc README.md # libxkbswitch-devel %files -n %{develname} %{_libdir}/libxkbswitch.so %doc README.md #------------------------------------------------------------------ %prep %setup -q -n xkb-switch-master %build %cmake %make %install %makeinstall_std -C build</code> </pre><br></div></div><br><br><a name="summary"></a><br><h2> 结论 </h2><br><p>  ,      RPM    <em>Rosa Linux</em> (       ).       ,   -. ,       — ,   ,   <em>rpmrc</em> ,      <em>ABF</em>   , —         . <br></p><br><p>        —    ,      -,         - , —     . <br></p><br><br><a name="commands"></a><br><h2>   </h2><br><br><a name="commands-build"></a><br><h3>     </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bp specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">准备</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（％准备）。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-bc的rpmbuild specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">编译</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（％建立）和所有以前的操作。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -bi specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">执行</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">伪</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装（％安装）和所有前面的步骤。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmbuild -ba specfile.spec</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">完全构建软件包。</font></font><br><br><br><br><a name="commands-package"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 检查成品包装 </font></font></h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpmlint -i package_file_name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">常规检查-软件包的构建情况。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp-提供package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查软件包提供了哪些“功能”。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qp-需要package_filename.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">检查此软件包所依赖的其他软件包的“功能”。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpl package_file_name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">软件包中包含的文件列表。</font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rpm -qpi package-file-name.rpm</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">有关软件包的信息（来自spec文件的“标题”或</font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">％package</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">块</font><font style="vertical-align: inherit;">）。</font></font><br><br><br><br><p>          ,    <code>p</code> .    ,     Rosa Linux,   .     <code>urpmq</code> ,   <code>rpm -q</code> . , <code>urpmq -l _</code>    ,  <code>urpmq --requires _</code>   . <br></p><br><br><a name="links"></a><br><h2>   ( ) </h2><br><ol><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Building RPMs — Quick Start</a> —         RPM  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="> RPM</a> —    ,   ,       .   . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RPM:  spec </a> —    -  Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Maximum RPM</a> —        <code>rpm</code>   RPM-  RedHat Linux.         ,      Rosa Linux.    . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Template Spec Files</a> —   <code>.spec</code> .  ,      -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Automatic Build Farm (ABF)</a> —      Rosa Linux.             ,   ,     ,    <code>.spec</code> .     -. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Rpmlint Errors</a> —    ,   <code>rpmlint</code> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Packaging Group</a> —    Rosa Linux. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   Rosa Linux</a> . </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Git — </a> —      <em>Git</em> . </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN464993/">https://habr.com/ru/post/zh-CN464993/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN464981/index.html">Google提供论据来证明用户跟踪的合理性-该公司被指控存在不诚实和操纵行为</a></li>
<li><a href="../zh-CN464985/index.html">物联网（IoT）将改变世界。 物联网的未来</a></li>
<li><a href="../zh-CN464987/index.html">Kubernetes中的存储库：OpenEBS，Rook（Ceph），Rancher Longhorn，StorageOS，Robin，Portworx，Linstor</a></li>
<li><a href="../zh-CN464989/index.html">盛会背景</a></li>
<li><a href="../zh-CN464991/index.html">没有起飞的项目</a></li>
<li><a href="../zh-CN464995/index.html">在Swift中包装序列</a></li>
<li><a href="../zh-CN464997/index.html">关于VR技术的发展：他们在哪里使用，为什么选择VR业务以及使用哪些设备</a></li>
<li><a href="../zh-CN464999/index.html">使用OpenLiberty示例如何更改与应用程序服务器一起使用的细节</a></li>
<li><a href="../zh-CN465001/index.html">2019年Amazon Prime Day-由AWS提供支持</a></li>
<li><a href="../zh-CN465003/index.html">对ARPG类型的兴趣</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>