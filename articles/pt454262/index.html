<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëõ üîÑ ü§¥üèº Por que todo cientista de dados deve conhecer o Dask üë®üèΩ‚Äçüåæ ü§≥üèª üí∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° colegas! 

 Talvez o t√≠tulo da publica√ß√£o de hoje parecesse melhor com um ponto de interroga√ß√£o - √© dif√≠cil dizer. De qualquer forma, hoje queremo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Por que todo cientista de dados deve conhecer o Dask</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/454262/"> Ol√° colegas! <br><br>  Talvez o t√≠tulo da publica√ß√£o de hoje parecesse melhor com um ponto de interroga√ß√£o - √© dif√≠cil dizer.  De qualquer forma, hoje queremos oferecer a voc√™ um breve tour que apresentar√° a biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Dask</a> , projetada para paralelizar tarefas no Python.  Esperamos retornar a esse t√≥pico mais detalhadamente no futuro. <br><br><img src="https://habrastorage.org/webt/v1/sy/al/v1syalwkg-cp2dnxebftth8yhnu.png"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><i>Foto tirada em</i></a> <br><a name="habracut"></a><br>  O Dask √©, sem exagero, a ferramenta de processamento de dados mais revolucion√°ria que j√° encontrei.  Se voc√™ gosta de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pandas e Numpy</a> , mas √†s vezes n√£o consegue lidar com dados que n√£o cabem na RAM, o Dask √© exatamente o que voc√™ precisa.  O Dask suporta o quadro de dados do Pandas e as estruturas de dados Numpy (matrizes).  O Dask pode ser executado no computador local ou em escala e, em seguida, no cluster.  Em ess√™ncia, voc√™ escreve o c√≥digo apenas uma vez e, em seguida, escolhe se deseja us√°-lo na m√°quina local ou implant√°-lo em um cluster de muitos n√≥s, usando a sintaxe Python mais comum para tudo isso.  O recurso em si √© √≥timo, mas decidi escrever este artigo apenas para enfatizar: todo cientista de dados (pelo menos usando Python) deve usar o Dask.  Do meu ponto de vista, a m√°gica do Dask √© que, ao minimizar o c√≥digo, voc√™ pode paralelizar usando o poder de computa√ß√£o que j√° est√° dispon√≠vel, por exemplo, no meu laptop.  Com o processamento paralelo de dados, o programa √© executado mais rapidamente, voc√™ precisa esperar menos e, consequentemente, mais tempo resta para a an√°lise.  Em particular, neste artigo, falaremos sobre o objeto <code>dask.delayed</code> e como ele se encaixa no fluxo de tarefas da ci√™ncia de dados. <br><br><h3>  Apresentando o Dask </h3><br>  Como uma introdu√ß√£o ao Dask, aqui est√£o alguns exemplos apenas para lhe dar uma id√©ia de sua sintaxe completamente discreta e natural.  A conclus√£o mais importante que quero sugerir neste caso √© que o conhecimento que voc√™ j√° possui ser√° suficiente para funcionar;  Voc√™ n√£o precisa aprender uma nova ferramenta de big data como o Hadoop ou Spark. <br><br>  O Dask oferece 3 cole√ß√µes paralelas nas quais √© poss√≠vel armazenar dados que excedem o tamanho da RAM, nomeadamente quadros de dados, bolsas e matrizes.  Em cada um desses tipos de cole√ß√µes, voc√™ pode armazenar dados segmentando-os entre RAM e disco r√≠gido, al√©m de distribuir dados entre v√°rios n√≥s em um cluster. <br><br>  Um Dask DataFrame consiste em quadros de dados fragmentados, como os do Pandas, permitindo que voc√™ use um subconjunto dos recursos da sintaxe de consulta do Pandas.  Abaixo est√° um c√≥digo de exemplo que baixa todos os arquivos CSV para 2018, analisa um campo com um carimbo de data e hora e inicia uma solicita√ß√£o do Pandas: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.dataframe <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> dd df = dd.read_csv(<span class="hljs-string"><span class="hljs-string">'logs/2018-*.*.csv'</span></span>, parse_dates=[<span class="hljs-string"><span class="hljs-string">'timestamp'</span></span>]) df.groupby(df.timestamp.dt.hour).value.mean().compute()</code> </pre> <br>  <i>Exemplo do Dask Dataframe</i> <br><br>  No Dask Bag, voc√™ pode armazenar e processar cole√ß√µes de objetos pit√¥nicos que n√£o cabem na mem√≥ria.  O Dask Bag √© √≥timo para processar logs e cole√ß√µes de documentos no formato json.  Neste exemplo de c√≥digo, todos os arquivos json para 2018 s√£o carregados na estrutura de dados do Dask Bag, cada registro json √© analisado e os dados do usu√°rio s√£o filtrados usando a fun√ß√£o lambda: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.bag <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> db <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> json records = db.read_text(<span class="hljs-string"><span class="hljs-string">'data/2018-*-*.json'</span></span>).map(json.loads) records.filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> d: d[<span class="hljs-string"><span class="hljs-string">'username'</span></span>] == <span class="hljs-string"><span class="hljs-string">'Aneesha'</span></span>).pluck(<span class="hljs-string"><span class="hljs-string">'id'</span></span>).frequencies()</code> </pre> <br>  <i>Exemplo do Dask Bag</i> <br><br>  A estrutura de dados do Dask Arrays suporta fatias no estilo Numpy.  No exemplo a seguir, um conjunto de dados HDF5 √© dividido em blocos de dimens√£o (5000, 5000): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> h5py f = h5py.File(<span class="hljs-string"><span class="hljs-string">'myhdf5file.hdf5'</span></span>) dset = f[<span class="hljs-string"><span class="hljs-string">'/data/path'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dask.array <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> da x = da.from_array(dset, chunks=(<span class="hljs-number"><span class="hljs-number">5000</span></span>, <span class="hljs-number"><span class="hljs-number">5000</span></span>))</code> </pre> <br>  <i>Exemplo de matriz do Dask</i> <br><br><h3>  Processamento paralelo no Dask </h3><br>  Outro t√≠tulo igualmente preciso para esta se√ß√£o seria "Morte de um ciclo seq√ºencial".  De vez em quando, encontro um padr√£o comum: itere sobre a lista de elementos e execute o m√©todo Python com cada elemento, mas com argumentos de entrada diferentes.  Os cen√°rios comuns de processamento de dados incluem o c√°lculo de agregados de recursos para cada cliente ou a agrega√ß√£o de eventos do log para cada aluno.  Em vez de aplicar uma fun√ß√£o a cada argumento em um loop seq√ºencial, o objeto Dask Delayed permite processar muitos elementos em paralelo.  Ao trabalhar com o Dask atrasado, todas as chamadas de fun√ß√£o s√£o enfileiradas, colocadas no gr√°fico de execu√ß√£o, ap√≥s o que planejam ser processadas. <br><br>  Eu sempre tive um pouco de pregui√ßa de escrever meu pr√≥prio mecanismo de encadeamento ou usar ass√≠ncrono, ent√£o nem mostrarei exemplos semelhantes para compara√ß√£o.  Com o Dask, voc√™ n√£o pode alterar nem a sintaxe nem o estilo de programa√ß√£o!  Voc√™ s√≥ precisa anotar ou agrupar o m√©todo, que ser√° executado em paralelo com <code>@dask.delayed</code> e chamar o m√©todo computacional ap√≥s a execu√ß√£o do c√≥digo do loop. <br><br><img src="https://habrastorage.org/webt/e_/_t/k9/e__tk9l_qrxshram0hqh-golmie.png"><br><br><h3>  Exemplo de gr√°fico de computa√ß√£o dask </h3><br>  No exemplo abaixo, os dois m√©todos s√£o anotados em <code>@dask.delayed</code> .  Tr√™s n√∫meros s√£o armazenados em uma lista, eles precisam ser elevados ao quadrado e depois somados.  O Dask constr√≥i um gr√°fico computacional que fornece execu√ß√£o paralela do m√©todo quadr√°tico, ap√≥s o qual o resultado dessa opera√ß√£o √© passado para o m√©todo <code>sum_list</code> .  O gr√°fico computacional pode ser exibido chamando <code>calling .visualize()</code> .  <code>Calling .compute()</code> executa o gr√°fico de computa√ß√£o.  Como resulta da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conclus√£o</a> , os itens da lista s√£o processados ‚Äã‚Äãn√£o em ordem, mas em paralelo. <br><br>  O n√∫mero de threads pode ser definido (por exemplo, <code>dask.set_options( pool=ThreadPool(10)</code> ) e tamb√©m podem ser facilmente trocados para usar processos no seu laptop ou PC (por exemplo, <code>dask.config.set( scheduler='processes'</code> ) . <br><br>  Ent√£o, demonstrei como ser√° trivial adicionar processamento paralelo de tarefas a um projeto do campo de Ci√™ncia de Dados usando o Dask.  Pouco antes de escrever este artigo, usei o Dask para dividir os dados sobre fluxos de cliques do usu√°rio (hist√≥rico de visitas) em sess√µes de 40 minutos e, em seguida, agregar os atributos de cada usu√°rio para cluster adicional.  Conte-nos como voc√™ usou o Dask! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt454262/">https://habr.com/ru/post/pt454262/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt454248/index.html">Servos na era da intelig√™ncia artificial</a></li>
<li><a href="../pt454252/index.html">Mesmo os recursos da Web de organiza√ß√µes conhecidas n√£o est√£o protegidos dos erros das crian√ßas.</a></li>
<li><a href="../pt454254/index.html">Escrevemos o proxy Reverse socks5 no PowerShell.</a></li>
<li><a href="../pt454256/index.html">O que h√° de errado com nossa TI</a></li>
<li><a href="../pt454260/index.html">Dia das Crian√ßas com C√≥digo Ruim</a></li>
<li><a href="../pt454264/index.html">4 canais sens√≠veis do Youtube sobre entrevistas t√©cnicas</a></li>
<li><a href="../pt454266/index.html">Dell e Alienware na Computex 2019: fale sobre as principais inova√ß√µes</a></li>
<li><a href="../pt454272/index.html">Toda a verdade sobre o RTOS. Artigo # 27 Hora do sistema</a></li>
<li><a href="../pt454274/index.html">Luz, c√¢mera ... nuvem: como as nuvens mudam a ind√∫stria cinematogr√°fica</a></li>
<li><a href="../pt454278/index.html">Seguro cibern√©tico no mercado russo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>