<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸš˜ ğŸ––ğŸ¿ ğŸ—½ Plugin toko online WordPress segar ğŸ‘©ğŸ¼â€ğŸ¨ â¤µï¸ ğŸ§–ğŸ¾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beberapa waktu yang lalu saya perlu membuat toko online di WordPress. Ada banyak solusi bagus di repositori resmi. Di antara mereka, pemimpin - Woocom...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Plugin toko online WordPress segar</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467937/">  Beberapa waktu yang lalu saya perlu membuat toko online di WordPress.  Ada banyak solusi bagus di repositori resmi.  Di antara mereka, pemimpin - Woocommerce telah lama menonjol.  Saya pikir dia tidak perlu diperkenalkan.  Pasukan jutaan pengguna, ratusan ekstensi berbayar dan gratis, serta fleksibilitas luar biasa.  Inilah sebabnya mengapa Woocommerce memiliki lebih dari 5 juta instalasi aktif dan mencakup sebagian besar toko online di seluruh dunia. <br><br>  Namun, saya memutuskan untuk menciptakan sepeda saya.  Sebagian untuk memompa keterampilan, sebagian untuk mencoba membuat plugin e-niaga yang tidak membutuhkan banyak sumber daya dan cukup cepat.  Saya baru-baru ini mempostingnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di repositori resmi</a> , oleh karena itu, saya mengundang semua orang untuk mengujinya.  Dalam artikel ini saya tidak akan melakukan tinjauan kemungkinan, tetapi saya hanya akan berbicara tentang beberapa solusi teknis yang menarik. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/275/768/f10/275768f10305ee3e6490d68f761cc1c7.png" width="772" height="250"><br><a name="habracut"></a><br><h2>  Permalinks Problem </h2><br>  Secara umum, permalinks di WordPress adalah salah satu situs yang paling sulit, karena mereka memerlukan penyelesaian sejumlah masalah koneksi dan dependensi.  WpStore memiliki kemampuan untuk mengelola permalink.  Misalnya, Anda dapat menghapus siput <code>product</code> dari url <code>product</code> , ubah ke slug Anda atau tambahkan kategori siput atau bahkan kategori yang bersarang.  Tautan ke produk mungkin terlihat seperti ini: <code>./-/---/---/-/</code> .  Tidak buruk. <br><br>  Saya harus banyak berkeringat untuk mendapatkan kategori bersarang.  Menggunakan fungsi <code>wp_get_object_terms,</code> kami mendapatkan kategori produk yang ditentukan, dan kemudian dalam siklus kami mengumpulkan kelemahan dan membentuk url sesuai dengan hierarki dari induk ke anak.  Untuk menampilkan tautan yang diperlukan, kami menggunakan filter post_link.  Ini hanya sebagian dari kode (Anda dapat melihat kode lengkap di sumber): <br><br><pre> <code class="php hljs">add_filter( <span class="hljs-string"><span class="hljs-string">'post_link'</span></span>, <span class="hljs-string"><span class="hljs-string">'wpsl_post_type_permalink'</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> ); add_filter( <span class="hljs-string"><span class="hljs-string">'post_type_link'</span></span>, <span class="hljs-string"><span class="hljs-string">'wpsl_post_type_permalink'</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wpsl_post_type_permalink</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $permalink, $post_id, $leavename )</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-comment"><span class="hljs-comment">/** * Works only in the admin panel when changing the structure of permanent links or creating/updating the product * In the frontend to display links to products using $post-&gt;guid * Relevant if the structure of permalinks are used %category% or %categories% */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( is_admin() ) { <span class="hljs-comment"><span class="hljs-comment">// get all terms (product categories) of this post (product) by hierarchicaly // change %category% if ( strpos( get_option( 'product_permalink' ), '%category%' ) !== false &amp;&amp; $terms = wpsl_get_terms_hierarchicaly( $post-&gt;ID, 'product_cat' ) ) { $custom_slug = str_replace( '%category%', isset( $terms[0] ) &amp;&amp; is_object( $terms[0] ) ? $terms[0]-&gt;slug : '', $custom_slug ); } // change %categories% if ( strpos( get_option( 'product_permalink' ), '%categories%' ) !== false &amp;&amp; $terms = wpsl_get_terms_hierarchicaly( $post-&gt;ID, 'product_cat' ) ) { foreach( $terms as $term ) { $hierarchical_slugs[] = $term-&gt;slug; } $custom_slug = str_replace( '%categories%', implode( '/', $hierarchical_slugs ), $custom_slug ); } else { $custom_slug = str_replace( '%categories%', 'product', $custom_slug ); } } .... return $permalink; }</span></span></code> </pre> <br>  Tetapi pada titik ini, masalah kinerja muncul.  Situs mulai bekerja lebih lambat, terutama pada halaman keluaran beberapa produk.  Misalnya, pada halaman kategori dengan output hanya 16 produk, hampir 90 pertanyaan dibuat ke database dan waktu respons server meningkat secara dramatis sekitar 25-30%. <br><br>  Ternyata ketika memanggil fungsi <strong>the_permalink,</strong> WordPress melakukan banyak operasi: itu mendapatkan jenis CNC dan mengumpulkan data <strong>posting</strong> tergantung pada jenis ini.  Untuk menampilkan 1 tautan, WordPress menghasilkan beberapa permintaan yang tidak di-cache ke basis data.  Selain itu, proses memperoleh taksonomi dan hierarki barang bukanlah yang tercepat. <br><br>  Karena pembuatan tautan yang konstan tidak sesuai dengan kita, masuk akal untuk menyimpannya di suatu tempat lalu menariknya dari sana.  Diputuskan untuk menggunakan bidang <code>guid</code> khusus pada tabel <code>guid</code> .  Meskipun pengembang WP tidak merekomendasikan untuk mengubahnya, kami masih dapat mengabaikan peringatan ini karena beberapa alasan: <br><br><ul><li>  guid digunakan untuk menghasilkan RSS, dan beberapa orang menggunakannya. </li><li>  hanya entri yang ditampilkan dalam RSS, dan jenis posting kami adalah produk. </li></ul><br>  Untuk menjaga tautan di database dengan benar, kami <code>save_post</code> menggantung fungsi <code>save_post</code> acara yang memperbarui bidang panduan: <br><br><pre> <code class="php hljs">add_action( <span class="hljs-string"><span class="hljs-string">'save_post'</span></span>, <span class="hljs-string"><span class="hljs-string">'wpsl_guid_rewrite'</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span> ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wpsl_guid_rewrite</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $id )</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( !is_admin() ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( defined( <span class="hljs-string"><span class="hljs-string">'DOING_AUTOSAVE'</span></span> ) &amp;&amp; DOING_AUTOSAVE ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( strpos( get_option( <span class="hljs-string"><span class="hljs-string">'product_permalink'</span></span> ), <span class="hljs-string"><span class="hljs-string">'%category%'</span></span> ) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> || strpos( get_option( <span class="hljs-string"><span class="hljs-string">'product_permalink'</span></span> ), <span class="hljs-string"><span class="hljs-string">'%categories%'</span></span> ) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( $id &amp;&amp; get_post_type( (int)$id ) == <span class="hljs-string"><span class="hljs-string">'product'</span></span> ){ <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> $wpdb; $wpdb-&gt;update( $wpdb-&gt;posts, [ <span class="hljs-string"><span class="hljs-string">'guid'</span></span> =&gt; ( get_permalink( $id ) ) ], [ <span class="hljs-string"><span class="hljs-string">'ID'</span></span> =&gt; intval( $id ) ] ); } clean_post_cache( $id ); } }</code> </pre> <br>  Tetap bagi kami untuk mencegat output tautan pada hook <code>post_type_link</code> dan menampilkan tautan yang dihasilkan: <br><br><pre> <code class="php hljs">add_filter( <span class="hljs-string"><span class="hljs-string">'post_type_link'</span></span>, <span class="hljs-string"><span class="hljs-string">'wpsl_get_permalink_change'</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span> ); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wpsl_get_permalink_change</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $post_link, $post, $leavename, $sample )</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">isset</span></span>( $post-&gt;guid ) &amp;&amp; $post-&gt;guid &amp;&amp; $post-&gt;post_type == <span class="hljs-string"><span class="hljs-string">'product'</span></span> &amp;&amp; ( strpos( get_option( <span class="hljs-string"><span class="hljs-string">'product_permalink'</span></span> ), <span class="hljs-string"><span class="hljs-string">'%category%'</span></span> ) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> || strpos( get_option( <span class="hljs-string"><span class="hljs-string">'product_permalink'</span></span> ), <span class="hljs-string"><span class="hljs-string">'%categories%'</span></span> ) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> ) ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $post-&gt;guid; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $post_link; }</code> </pre> <br>  Di sini kita memeriksa kelengkapan bidang panduan, jenis posting dan jenis CNC.  Jika nilai dari ketiga parameter sesuai dengan kami, tampilkan tautan yang disimpan sebelumnya. <br><br>  Sekarang, bagian terbaiknya adalah: lihat hasilnya.  Jumlah kueri ke database berkurang hampir 2 kali - dari hampir 90 menjadi 44!  Dan waktu respons server pada pengujian hosting turun menjadi 0,24 detik yang dapat diterima. <br><br>  Memperbarui bidang panduan terjadi tidak hanya selama pembuatan dan pengeditan barang.  Plug-in memiliki sistem bawaan untuk mengimpor barang melalui csv, sehingga pembaruan juga terjadi ketika impor selesai. <br><br>  Perbarui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi plugin</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id467937/">https://habr.com/ru/post/id467937/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id467921/index.html">Keluarkan pulpen berdebu: tulisan tangan baik untuk otak</a></li>
<li><a href="../id467923/index.html">Jadi, Anda ingin menjadi seorang analis di bidang keamanan jaringan ...</a></li>
<li><a href="../id467929/index.html">Kami mengatur kekacauan atau cara menerapkan pendekatan proses dalam suatu organisasi</a></li>
<li><a href="../id467933/index.html">Namun, mengapa Posit adalah alternatif yang layak untuk IEEE 754</a></li>
<li><a href="../id467935/index.html">Ulasan perekam Edic Weeny A110 dengan fungsi "kotak hitam"</a></li>
<li><a href="../id467941/index.html">Jumlah Masalah</a></li>
<li><a href="../id467943/index.html">Fundamental risiko dan keamanan informasi yang berorientasi bisnis: konsep dan paradigma dasar</a></li>
<li><a href="../id467949/index.html">Mengapa implementasi standar antarmuka bermanfaat?</a></li>
<li><a href="../id467951/index.html">Habrastatistics: menganalisis komentar pembaca. Bagian 2, jawaban atas pertanyaan</a></li>
<li><a href="../id467953/index.html">Menguji server virtual murah</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>