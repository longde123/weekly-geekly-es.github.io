<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎫 👩🏿‍🎨 👂🏼 榆树 舒适而笨拙。 Http，任务 🦓 👲🏿 🤞🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我们继续谈论榆木0.18 。 


 榆树 舒适尴尬 
 榆树 舒适而笨拙。 组成 
 榆树 舒适而笨拙。 Json.Encoder和Json.Decoder 


 在本文中，我们考虑与服务器端交互的问题。 
 查询执行 


 简单查询的示例可以在Http包的描述中找到。 


 请求类型为Ht...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>榆树 舒适而笨拙。 Http，任务</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424979/"><p> 我们继续谈论<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">榆木0.18</a> 。 </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">榆树</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">舒适尴尬</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">榆树</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">舒适而笨拙。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">组成</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">榆树</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">舒适而笨拙。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Json.Encoder和Json.Decoder</a> </p><br><p> 在本文中，我们考虑与服务器端交互的问题。 </p><a name="habracut"></a><br><h2 id="vypolnenie-zaprosov"> 查询执行 </h2><br><p> 简单查询的示例可以在<a href="https://package.elm-lang.org/packages/elm-lang/">Http</a>包的描述中找到。 </p><br><p> 请求类型为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Request a</a> 。 <br> 查询结果类型为Result <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Error</a> a。 <br> 两种类型均由用户类型参数化，在生成请求时必须指定其解码器。 </p><br><p> 您可以使用以下功能执行请求： </p><br><ol><li>  Http.send; </li><li>  Http.toTask。 </li></ol><br><p>  Http.send允许您执行请求，并在完成后将消息传递给第一个参数中指定的更新函数。 该消息携带有关请求结果的数据。 </p><br><p> Http.toTask允许您从可以执行的请求中创建<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">任务</a> 。 我认为，使用Http.toTask函数是最方便的，因为可以<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用各种功能</a> （例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.map2）</a>组合Task实例。 </p><br><p> 让我们来看一个例子。 例如，要保存用户数据，必须执行两个连续的从属查询。 让它从用户创建帖子并将照片保存到他（使用了一些CDN）。 </p><br><p> 首先，考虑Http.Send案例的实现。 为此，我们需要两个功能： </p><br><pre><code class="hljs vbscript">save : UserData -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> UserData save userData = Http.post “/some/url” (Http.jsonBody (encodeUserData userData)) decodeUserData saveImages : <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> -&gt; Images -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Request</span></span> Http.<span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> CDNData saveImages id images = Http.post (“/some/cdn/<span class="hljs-keyword"><span class="hljs-keyword">for</span></span>/” ++ (toString id)) (imagesBody images) decodedCDNData</code> </pre> <br><p> 将不描述UserData和CDNData类型；例如，它们并不重要。 函数encodeUserData是一个编码器。  saveImages接受用于形成地址的用户数据标识符和照片列表。  imagesBody函数形成<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://package.elm-lang.org/packages/elm-lang/">multipart / form-data类型</a>的请求主体。 函数decodeUserData和decodedCDNData分别解码服务器对用户数据的响应和CDN请求的结果。 </p><br><p> 接下来，我们需要两条消息，即查询结果： </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">) | </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ImagesSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p> 假设在执行更新功能的某处，有一段代码存储数据。 例如，它可能看起来像这样： </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> ClickedSomething -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Http.send DataSaved (<span class="hljs-keyword"><span class="hljs-keyword">save</span></span> model.userData))</code> </pre> <br><p> 在这种情况下，将创建查询并用DataSaved消息标记。 此外，收到此消息： </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span> : Msg -&gt; <span class="hljs-keyword"><span class="hljs-keyword">Model</span></span> -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">Model</span></span>, Cmd Msg) <span class="hljs-keyword"><span class="hljs-keyword">update</span></span> msg <span class="hljs-keyword"><span class="hljs-keyword">model</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> Msg <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> DataSaved (Ok userData) -&gt; ( {<span class="hljs-keyword"><span class="hljs-keyword">model</span></span> | userData = userData}, Http.send ImagesSaved (saveImages userData.id model.images)) DataSaved (Err reason) -&gt; (<span class="hljs-keyword"><span class="hljs-keyword">model</span></span>, Cmd.None)</code> </pre> <br><p> 如果成功保存，我们将更新模型中的数据并调用请求以将照片保存到我们转移接收到的用户数据标识符的位置。 处理ImagesSaved消息将与DataSaved相似，因此有必要处理成功和失败的案例。 </p><br><p> 现在考虑使用Http.toTask函数的选项。 使用描述的函数，我们定义一个新函数： </p><br><pre> <code class="hljs erlang-repl">saveAll : UserData -&gt; Images -&gt; Task Http.Error (UserData, CDNData) saveAll : userData images = save model.userData |&gt; Http.toTask |&gt; Task.andThen (\newUserData -&gt; saveImages usersData.id images |&gt; Http.toTask |&gt; Task.map (\newImages -&gt; (userData, newImages) } )</code> </pre> <br><p> 现在，使用合并任务的功能，我们可以在一条消息中获得所有数据： </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">type</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Result</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Http</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Error</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">UserData</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CDNData</span></span></span><span class="hljs-class">)) update : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> -&gt; </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class">) update msg model case </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Msg</span></span></span><span class="hljs-class"> of </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ClickedSomething</span></span></span><span class="hljs-class"> -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Task</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attempt</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Saved</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">saveAll</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Ok</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">)) -&gt; ( {</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class"> | </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">userData</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">images</span></span></span><span class="hljs-class">}, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">none</span></span></span><span class="hljs-class">) </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">DataSaved</span></span></span><span class="hljs-class"> (</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Err</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reason</span></span></span><span class="hljs-class">) -&gt; (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">model</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Cmd</span></span></span><span class="hljs-class">.</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">None</span></span></span><span class="hljs-class">)</span></span></code> </pre> <br><p> 为了执行请求，我们使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.attempt</a>函数，该函数使您可以完成任务。 不要与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.perform</a>函数混淆。  Task.perform-允许您完成<strong>不会失败的</strong>任务。  Task.attempt-执行<strong>可能失败的</strong>任务。 </p><br><p> 就消息数量，更新功能的复杂性而言，此方法更为紧凑，并允许您将逻辑保持在本地。 </p><br><p> 在我的项目，应用程序和组件中，我经常创建Commands.elm模块，在其中描述与服务器部分进行交互的功能，其类型为...-&gt; Task Http.Error a。 </p><br><h2 id="sostoyanie-vypolneniya-zaprosov"> 请求执行状态 </h2><br><p> 在执行查询的过程中，通常必须完全或部分地阻塞该接口，并且还必须报告查询执行中的错误（如果有）。 通常，请求的状态可以描述为： </p><br><ol><li> 请求失败 </li><li> 请求正在进行中； </li><li> 该请求已成功完成。 </li><li> 请求失败。 </li></ol><br><p> 对于这种描述，有一个<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RemoteData</a>包。 最初，我积极使用它，但是随着时间的流逝，其他类型的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WebData</a>的存在变得多余了，使用它很乏味。 代替此软件包，出现了以下规则： </p><br><ol><li> 将服务器中的所有数据声明为Maybe。 在这种情况下，Nothing表示没有数据； </li><li> 在应用程序或组件模型中声明Int类型的加载属性。 该参数存储已执行请求的数量。 这种方法的唯一不便之处是需要分别在请求开始时和完成时增加和减少属性； </li><li> 在应用程序或组件模型中声明List String类型的错误属性。 此属性用于存储错误数据。 </li></ol><br><p> 实践证明，所描述的方案并不比RemoteData包中的选项好得多。 如果有人有其他选择，请分享评论。 </p><br><p> 请求执行状态应包括从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://package.elm-lang.org/packages/elm-lang/">Http.Progress</a>包中的下载进度。 </p><br><h2 id="posledovatelnost-zadach"> 任务顺序 </h2><br><p> 考虑开发中经常发现的任务序列的选项： </p><br><ol><li> 顺序相关任务； </li><li> 一致的独立任务； </li><li> 并行的独立任务。 </li></ol><br><p> 上面已经考虑了相继的相关任务；在本节中，我将给出一般的描述和实现方法。 </p><br><p> 第一次失败时，任务序列将中断，并返回错误。 如果成功，则返回结果的某种组合： </p><br><pre> <code class="hljs erlang-repl">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p> 此代码创建任务错误（a，b）类型的任务，稍后可以执行。 </p><br><p> 如果前一个任务成功完成，则<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.andThen</a>函数可让<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">您</a>转移新任务以执行。  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.map</a>函数允许<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">您</a>在成功的情况下转换执行的甜瓜结果。 </p><br><p> 有一些选项无法成功完成任务，因此有必要检查数据的一致性。 假设用户ID匹配： </p><br><pre> <code class="hljs pgsql">someTaskA |&gt; Task.andThen (\resultA -&gt; someTaskB |&gt; Task.andThen (\resultB -&gt; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> resultA.userId == resultB.userId <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> -&gt; Task.succeed (resultA, resultB) <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> -&gt; Task.fail “<span class="hljs-keyword"><span class="hljs-keyword">User</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> the same” ) )</code> </pre> <br><p> 值得注意的是，使用Task.andThen函数代替Task.map函数，并使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.succeed</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.fail函数</a>独立确定第二个任务的成功。 </p><br><p> 如果其中一项任务可能失败并且可以接受，那么在出现错误的情况下，您需要使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.onError</a>函数指示该值： </p><br><pre> <code class="hljs julia">someTaskA |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.onError (\msg -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>,succeed defaultValue) |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.andThen (\resultA -&gt; someTaskB |&gt; <span class="hljs-built_in"><span class="hljs-built_in">Task</span></span>.map (\resultB -&gt; (resultA, resultB) ) )</code> </pre> <br><p> 声明任务后，应立即声明对Task.onError函数的调用。 </p><br><p> 可以使用Task.mapN函数执行连续的独立查询。 这使您可以将多个任务结果合并为一个。 第一个掉落的任务会中断整个链的执行，因此请使用Task.onError函数作为默认值。 还要检查<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Task.sequence</a>函数，它使您可以执行一系列类似的任务。 </p><br><p> 当前语言实现中的并行任务未描述。 通过更新功能中的事件处理，可以在应用程序或组件级别实现它们。 所有逻辑都保留在开发人员的肩膀上。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN424979/">https://habr.com/ru/post/zh-CN424979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN424969/index.html">Node.js指南，第9部分：使用文件系统</a></li>
<li><a href="../zh-CN424971/index.html">Habrokast“手动日落”＃1。 尝试建立用于开发Windows玩具的环境</a></li>
<li><a href="../zh-CN424973/index.html">视频的人脸检测：Raspberry Pi和神经计算棒</a></li>
<li><a href="../zh-CN424975/index.html">SIEM深度：现成的相关性。 第2部分。数据模式反映“世界”模型</a></li>
<li><a href="../zh-CN424977/index.html">从错误中学习：优化App Store和Google Play上的应用程序</a></li>
<li><a href="../zh-CN424981/index.html">Google搜索引擎代码中的Easter Egg Text RPG</a></li>
<li><a href="../zh-CN424985/index.html">在重要的司法先例中，美国情报机构无法窃听信使中的电话</a></li>
<li><a href="../zh-CN424987/index.html">使用维纳滤镜恢复模糊和散焦的图像。 在C ++ OpenCV中实现</a></li>
<li><a href="../zh-CN424989/index.html">设计过程：完美项目的7个步骤</a></li>
<li><a href="../zh-CN424991/index.html">当旧方法不起作用时：Vasily Mazin-一种用于AI开发的混合方法</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>