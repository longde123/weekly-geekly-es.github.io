<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÜüèø „äôÔ∏è üë∂ Un regard sobre sur Helm 2: "Voil√† ce que c'est ..." üë®üèΩ‚Äçüíº üôÖüèΩ ü§ü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Comme toute autre solution, Helm - le gestionnaire de packages pour Kubernetes - a des avantages, des inconv√©nients et de la port√©e, donc lors de son ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un regard sobre sur Helm 2: "Voil√† ce que c'est ..."</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/438814/">  Comme toute autre solution, Helm - le gestionnaire de packages pour Kubernetes - a des avantages, des inconv√©nients et de la port√©e, donc lors de son utilisation, vous devez √©valuer correctement vos attentes ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ix/5j/fm/ix5jfmapr_v4yignapctr-x7_jc.jpeg"></div><br>  Nous utilisons Helm dans notre arsenal d'outils de roulement continu.  Au moment de la r√©daction, il y a <b>plus d'un millier d'applications</b> dans nos clusters et environ 4000 installations de ces applications dans diverses variantes.  Nous rencontrons p√©riodiquement des probl√®mes, mais en g√©n√©ral, nous sommes satisfaits de la solution, nous n'avons aucun temps d'arr√™t et aucune perte de donn√©es. <br><br>  Le principal objectif de la r√©daction de cet article est de fournir √† l'utilisateur une <b>√©valuation objective des</b> principaux probl√®mes de Helm 2 sans conclusions d√©finitives, ainsi que le d√©sir de partager l'exp√©rience et nos solutions. <a name="habracut"></a><br><br><h2>  [BOGUE] Apr√®s le d√©ploiement, l'√©tat des ressources de version dans le cluster ne correspond pas au graphique Helm d√©crit </h2><br>  Lorsqu'il travaille, Helm ne prend pas en compte l'√©tat des ressources de version dans le cluster.  Lors de la r√©installation, le r√©sultat est d√©termin√© uniquement par les configurations actuelles et enregistr√©es.  Ainsi, l'√©tat de la ressource dans le cluster et le registre Helm est diff√©rent, et Helm n'en tient pas compte. <br><br>  Consid√©rez comment ce probl√®me se manifeste: <br><br><ol><li>  Le mod√®le de ressource sur le graphique correspond √† l'√©tat X. </li><li>  L'utilisateur installe le graphique (Tiller enregistre l'√©tat de la ressource X). </li><li>  Ensuite, l'utilisateur modifie manuellement la ressource dans le cluster (l'√©tat passe de X √† Y). </li><li>  Sans apporter de modifications, il effectue la <code>helm upgrade</code> ... Et la ressource est toujours dans l'√©tat Y, bien que l'utilisateur attend X. </li></ol><br>  Et ce n‚Äôest pas tout.  √Ä un moment donn√©, l'utilisateur modifie le mod√®le de ressource sur le graphique (nouvel √©tat W) - nous avons ensuite deux sc√©narios apr√®s la <code>helm upgrade</code> : <br><br><ul><li>  L'application du patch XW est en baisse. </li><li>  Apr√®s avoir appliqu√© le patch, la ressource passe √† l'√©tat Z, qui ne correspond pas √† celui souhait√©. </li></ul><br>  Pour √©viter un tel probl√®me, il est propos√© d'organiser le travail avec les versions comme suit: <b>personne ne doit changer les ressources manuellement</b> , Helm est le seul outil pour travailler avec les ressources des versions.  Id√©alement, les modifications de graphique sont versionn√©es dans le r√©f√©rentiel Git et appliqu√©es <b>exclusivement</b> dans le CD. <br><br>  Si cette option ne convient pas, vous pouvez <b>surveiller la synchronisation des √©tats des ressources de</b> version.  La synchronisation manuelle peut ressembler √† ceci: <br><br><ol><li>  Nous d√©couvrons le statut des ressources de publication via <code>helm get</code> . </li><li>  D√©couvrez l'√©tat des ressources dans Kubernetes via <code>kubectl get</code> . </li><li>  Si les ressources sont diff√©rentes, nous synchronisons Helm avec Kubernetes: <br><ol><li>  Cr√©ez une branche distincte. </li><li>  Mise √† jour des manifestes de graphiques.  Les mod√®les doivent correspondre aux √©tats des ressources dans Kubernetes. </li><li>  Nous effectuons le d√©ploiement.  Nous synchronisons l'√©tat dans le registre et le cluster Helm. </li><li>  Apr√®s cela, la branche peut √™tre supprim√©e et continuer le travail normal. </li></ol></li></ol><br>  Lors de l'application de correctifs √† l'aide de la <code>kubectl apply</code> , la <b>fusion</b> dite √† <b>3 voies</b> est ex√©cut√©e, c'est-√†-dire  l'√©tat r√©el de la ressource mise √† jour est pris en compte.  Vous pouvez voir le code de l'algorithme <a href="">ici</a> et en savoir plus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Au moment d'√©crire ces lignes, les d√©veloppeurs de Helm recherchent des moyens d'impl√©menter la fusion √† 3 voies dans Helm 3. Avec Helm 2, les choses ne sont pas si rose: la fusion √† 3 voies n'est pas pr√©vue pour √™tre impl√©ment√©e, mais il y a un PR pour fixer la fa√ßon dont les ressources sont cr√©√©es - vous pouvez trouver des d√©tails ou m√™me participer dans le cadre de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">question pertinente</a> . <br><br><h2>  [BUG] Erreur: aucune RESSOURCE avec le nom NAME trouv√©e </h2><br>  Le probl√®me se manifeste si de <b>nouvelles ressources</b> sont cr√©√©es avec succ√®s lorsque le d√©ploiement est r√©p√©t√© et que le d√©ploiement lui-m√™me √©choue finalement.  <b>Les nouvelles ressources</b> signifient celles qui n'√©taient pas dans la derni√®re installation du graphique. <br><br>  Si le d√©ploiement √©choue, la version est enregistr√©e dans le registre marqu√©e <b>FAILED</b> et, lors de l'installation, Helm s'appuie sur l'√©tat de la derni√®re version <b>DEPLOYED</b> , qui dans ce cas ne sait rien des nouvelles ressources.  Par cons√©quent, Helm essaie de recr√©er ces ressources et √©choue avec l'erreur ¬´aucune RESSOURCE avec le nom NOM trouv√©¬ª (l'erreur indique le contraire, mais c'est le probl√®me).  Une partie du probl√®me est que Helm ne prend pas en compte l'√©tat des ressources de version dans le cluster lors de la cr√©ation du correctif, comme d√©crit dans la section pr√©c√©dente. <br><br>  Pour l'instant, la seule solution est de supprimer manuellement les nouvelles ressources. <br><br>  Afin d'√©viter un tel √©tat, il est possible de supprimer automatiquement les nouvelles ressources cr√©√©es dans la mise √† niveau / restauration actuelle si la commande √©choue finalement.  Apr√®s une longue discussion avec les d√©veloppeurs de Helm, pour les commandes de mise √† niveau / restauration, l' <code>--cleanup-on-fail</code> √©t√© ajout√©e, ce qui active le nettoyage automatique lorsque le d√©ploiement √©choue.  Notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">RP</a> est en discussion, √† la recherche de la meilleure solution. <br><br>  √Ä partir de la version 2.13 de Helm, l'option <code>--atomic</code> appara√Æt dans les <code>helm install/upgrade</code> , qui activent le nettoyage et la restauration lors d'une installation √©chou√©e (pour plus de d√©tails, voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PR</a> ). <br><br><h2>  [BUG] Erreur: veille ferm√©e avant le d√©lai d'expiration </h2><br>  Le probl√®me peut se produire lorsque le hook Helm est ex√©cut√© trop longtemps (par exemple, pendant les migrations) - m√™me si les d√©lais d' <code>spec.activeDeadlineSeconds</code> sp√©cifi√©s pour l' <code>helm install/upgrade</code> <code>spec.activeDeadlineSeconds</code> et <code>spec.activeDeadlineSeconds</code> Job correspondant ne sont pas d√©pass√©s. <br><br>  Cette erreur est g√©n√©r√©e par le serveur API Kubernetes en attendant la fin du travail de hook.  Helm ne g√®re pas cette erreur et se bloque imm√©diatement - au lieu de r√©essayer la demande d'attente. <br><br>  Comme solution, vous pouvez augmenter le d√©lai d'expiration dans api-server: <code>--min-request-timeout=xxx</code> dans le fichier <code>/etc/kubernetes/manifests/kube-apiserver.yaml</code> . <br><br><h2>  [BUG] Erreur: √âCHEC DE LA MISE √Ä NIVEAU: ¬´foo¬ª n'a aucune version d√©ploy√©e </h2><br>  Si la premi√®re version via l' <code>helm install</code> √©chou√©, la <code>helm upgrade</code> suivante renverra une erreur similaire. <br><br>  Il semblerait que la solution soit assez simple: vous devez effectuer manuellement la <code>helm delete --purge</code> apr√®s une premi√®re installation √©chou√©e, mais cette action manuelle rompt l'automatisation CI / CD.  Afin de ne pas interrompre l'ex√©cution des commandes manuelles, vous pouvez utiliser les fonctionnalit√©s <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">werf</a> pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©ployer</a> .  Lorsque vous utilisez werf, la version probl√©matique sera automatiquement recr√©√©e lors de la r√©installation. <br><br>  De plus, √† partir de la version Helm 2.13, dans les <code>helm install</code> et <code>helm upgrade --install</code> sp√©cifiez simplement l'option <code>--atomic</code> et apr√®s une installation ayant √©chou√©, la version sera automatiquement supprim√©e (voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PR pour</a> plus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de</a> d√©tails). <br><br><h2>  Autorollback </h2><br>  Helm ne dispose pas de l'option <code>--autorollback</code> , qui, une fois <code>--autorollback</code> , se souviendra de la r√©vision r√©ussie actuelle ( <code>--autorollback</code> si la derni√®re r√©vision √©choue) et, apr√®s une tentative de d√©ploiement infructueuse, reviendra √† la r√©vision enregistr√©e. <br><br>  Puisqu'il est essentiel que le produit fonctionne sans interruption, il est n√©cessaire de rechercher des solutions, le d√©ploiement doit √™tre pr√©visible.  Afin de minimiser la probabilit√© de temps d'arr√™t du produit, une <b>approche √† plusieurs contours</b> (par exemple, staging, qa et production) est souvent utilis√©e, qui consiste en un d√©ploiement s√©quentiel sur les contours.  Avec cette approche, la plupart des probl√®mes sont r√©solus avant de passer √† la productivit√© et en conjonction avec l'autorolback vous permet d'obtenir de bons r√©sultats. <br><br>  Pour organiser le rappel automatique, vous pouvez utiliser le plug <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-</a> in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">helm-monitor</a> , qui vous permet de lier le retour en arri√®re aux mesures de Prometheus.  Un bon article d√©crivant cette approche est disponible <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Pour certains de nos projets, une approche assez simple est utilis√©e: <br><br><ol><li>  Avant le d√©ploiement, nous nous souvenons de la r√©vision en cours (nous pensons que dans une situation normale, si la version existe, elle est n√©cessairement √† l'√©tat DEPLOYED): <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _RELEASE_NAME=myrelease <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _LAST_DEPLOYED_RELEASE=$(helm list -adr | \ grep <span class="hljs-variable"><span class="hljs-variable">$_RELEASE_NAME</span></span> | grep DEPLOYED | head -n2 | awk <span class="hljs-string"><span class="hljs-string">'{print $2}'</span></span>)</code> </pre> </li><li>  Ex√©cutez l'installation ou la mise √† niveau: <br><br><pre> <code class="bash hljs">helm install/upgrade ... || <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> _DEPLOY_FAILED=1</code> </pre> </li><li>  Nous v√©rifions l'√©tat du d√©ploiement et faisons un retour √† l'√©tat enregistr√©: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_DEPLOY_FAILED</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">"1"</span></span> ] &amp;&amp; [ <span class="hljs-string"><span class="hljs-string">"x</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_LAST_DEPLOYED_RELEASE</span></span></span><span class="hljs-string">"</span></span> != <span class="hljs-string"><span class="hljs-string">"x"</span></span> ] ; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> helm rollback <span class="hljs-variable"><span class="hljs-variable">$_RELEASE_NAME</span></span> <span class="hljs-variable"><span class="hljs-variable">$_LAST_DEPLOYED_RELEASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre> </li><li>  Nous terminons le pipeline avec une erreur si le d√©ploiement a √©chou√©: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$_DEPLOY_FAILED</span></span></span><span class="hljs-string">"</span></span> == <span class="hljs-string"><span class="hljs-string">"1"</span></span> ] ; <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> 1 ; <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre> </li></ol><br>  Encore une fois, √† partir de la version 2.13 de Helm, lors de l'appel de la <code>helm upgrade</code> suffit de sp√©cifier l'option <code>--atomic</code> et apr√®s un √©chec de l'installation, la restauration sera effectu√©e automatiquement (voir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PR pour</a> plus <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de</a> d√©tails). <br><br><h2>  En attente de la disponibilit√© des ressources de publication et des commentaires au moment du d√©ploiement </h2><br>  Comme pr√©vu, Helm doit surveiller l'ex√©cution des tests de vivacit√© et de pr√©paration correspondants lors de l'utilisation de l'option <code>--wait</code> : <br><br><pre> <code class="bash hljs">--<span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>, will <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> until all Pods, PVCs, Services, and minimum number of Pods of a Deployment are <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> a ready state before marking the release as successful. It will <span class="hljs-built_in"><span class="hljs-built_in">wait</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> as long as --timeout</code> </pre> <br>  Cette fonction ne fonctionne pas correctement maintenant: toutes les ressources et toutes les versions d'API ne sont pas prises en charge.  Et le processus d'attente d√©clar√© lui-m√™me ne satisfait pas nos besoins. <br><br>  Comme avec <code>kubectl wait</code> , il n'y a pas de retour rapide et il n'y a aucun moyen de r√©guler ce comportement.  Si le d√©ploiement √©choue, nous ne le saurons <b>qu'apr√®s un d√©lai d'attente</b> .  En cas d'installation probl√©matique, il est n√©cessaire de terminer le processus de d√©ploiement le plus t√¥t possible, de retourner le pipeline CI / CD, de restaurer la version vers la version de travail et de proc√©der au d√©bogage. <br><br>  Si la version probl√©matique est annul√©e et que Helm ne renvoie aucune information pendant le processus de d√©ploiement, √† quoi sert le d√©bogage?!  Dans le cas de l' <code>kubectl wait</code> de <code>kubectl wait</code> vous pouvez organiser un processus distinct pour l'affichage des journaux, qui n√©cessitera des noms de ressources de version.  Comment organiser une solution simple et efficace n'est pas imm√©diatement clair.  Et en plus des journaux de pod, des informations utiles peuvent √™tre contenues dans le processus de d√©ploiement, les √©v√©nements de ressource ... <br><br>  Notre utilitaire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">werf</a> CI / CD peut d√©ployer un graphique Helm et surveiller la disponibilit√© des ressources, ainsi que l'affichage des informations relatives au d√©ploiement.  Toutes les donn√©es sont combin√©es en un seul flux et √©mises dans le journal. <br><br>  Cette logique est r√©alis√©e dans une solution <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">kubedog</a> distincte.  √Ä l'aide de l'utilitaire, vous pouvez vous abonner √† une ressource et recevoir des √©v√©nements et des journaux, ainsi qu'en savoir plus sur les d√©ploiements ayant √©chou√© en temps opportun.  C'est-√†-dire  comme solution, apr√®s avoir appel√© <code>helm install/upgrade</code> sans l'option <code>--wait</code> , <code>--wait</code> pouvez appeler kubedog pour chaque ressource de version. <br><br>  Notre objectif √©tait de cr√©er un outil qui fournira toutes les informations n√©cessaires au d√©bogage dans la sortie du pipeline CI / CD.  En savoir plus sur l'utilitaire dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">notre r√©cent article</a> . <br><br>  Peut-√™tre qu'un jour, dans Helm 3, une solution similaire appara√Ætra, mais jusqu'√† pr√©sent, notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">probl√®me</a> est suspendu. <br><br><h2>  S√©curit√© lors de l'utilisation de helm init par d√©faut </h2><br>  Par d√©faut, lorsque la <code>helm init</code> est ex√©cut√©e, le composant serveur est install√© dans le cluster avec des privil√®ges similaires au superutilisateur, ce qui peut entra√Æner des cons√©quences ind√©sirables lors d'un acc√®s par des tiers. <br><br>  Pour assurer la s√©curit√© du cluster, il est n√©cessaire de limiter les capacit√©s de Tiller, ainsi que de prendre soin de la connexion - la s√©curit√© du r√©seau √† travers lequel la communication entre les composants Helm a lieu. <br><br>  Le premier peut √™tre atteint gr√¢ce √† l'utilisation du m√©canisme RBAC Kubernetes standard, qui limitera les actions du tiller, et le second - en d√©finissant SSL.  Pour en savoir plus, consultez la documentation de Helm: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">S√©curiser votre installation de Helm</a> . <br><br>  <i>On pense que la pr√©sence du composant serveur - Tiller - est une <b>grave erreur architecturale</b> , litt√©ralement une ressource √©trang√®re avec des droits de superutilisateur dans l'√©cosyst√®me Kubernetes.</i>  <i>En partie, nous sommes d'accord: la mise en ≈ìuvre est imparfaite, mais <b>regardons cela de l'autre c√¥t√©</b> .</i>  <i>Si vous interrompez le processus de d√©ploiement et tuez le client Helm, le syst√®me ne restera pas dans un √©tat ind√©fini, c'est-√†-dire</i>  <i>Tiller rendra le statut de version valide.</i>  <i>Il est √©galement n√©cessaire de comprendre que malgr√© le fait que Tiller soit abandonn√© dans Helm 3, ces fonctions seront en quelque sorte ex√©cut√©es par le contr√¥leur CRD.</i> <br><br><h2>  Mod√®les Martian Go </h2><br>  Les mod√®les Go ont un grand seuil d'entr√©e, mais la technologie n'a pas de limites sur les capacit√©s et les probl√®mes avec DRY.  Les principes de base, la syntaxe, les fonctions et les op√©rateurs sont discut√©s dans notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article pr√©c√©dent</a> de la s√©rie Helm. <br><br><h2>  Manque de secrets hors de la bo√Æte </h2><br>  Il est pratique de stocker et de maintenir le code d'application, l'infrastructure et les mod√®les de d√©ploiement lorsqu'ils se trouvent au m√™me endroit.  Et les secrets ne font pas exception. <br><br>  Helm ne prend pas en charge les secrets <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pr√™ts √† l'emploi</a> , mais le plugin <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">helm-secrets</a> est disponible, qui est essentiellement une couche entre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sops</a> , le gestionnaire de secrets de Mozilla et Helm. <br><br>  Lorsque nous travaillons avec des secrets, nous utilisons notre propre solution impl√©ment√©e dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">werf</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation sur les secrets</a> ).  Des fonctionnalit√©s: <br><br><ul><li>  Facilit√© de mise en ≈ìuvre. </li><li>  Garder un secret dans un fichier, pas seulement dans YAML.  Pratique lors du stockage de certificats, de cl√©s. </li><li>  R√©g√©n√©ration des secrets avec une nouvelle cl√©. </li><li>  D√©ploiement sans cl√© secr√®te (lors de l'utilisation de werf).  Il peut √™tre utile dans les cas o√π le d√©veloppeur ne poss√®de pas cette cl√© secr√®te, mais il est n√©cessaire de lancer un d√©ploiement sur un test ou un circuit local. </li></ul><br><h2>  Conclusion </h2><br>  Helm 2 se positionne comme un produit stable, mais en m√™me temps, il existe de nombreux bugs qui pendent dans les limbes (certains d'entre eux durent plusieurs ann√©es!).  Au lieu de solutions, ou du moins de correctifs, tous les efforts sont consacr√©s au d√©veloppement de Helm 3. <br><br>  Malgr√© le fait que MR et le probl√®me peuvent se bloquer pendant des mois ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">voici un exemple</a> de la fa√ßon dont nous avons ajout√© une <code>before-hook-creation policy</code> pour les hooks pendant plusieurs mois), vous pouvez toujours participer au d√©veloppement du projet.  Tous les jeudis, un rassemblement d'une demi-heure de d√©veloppeurs Helm a lieu, o√π vous pouvez en apprendre davantage sur les priorit√©s et les orientations actuelles de l'√©quipe, poser des questions et imposer vos propres meilleures pratiques.  √Ä propos de mete et d'autres canaux de communication est √©crit en d√©tail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Que vous utilisiez ou non Helm d√©pend de vous, bien s√ªr.  Aujourd'hui, nous adh√©rons nous-m√™mes √† une telle position que, malgr√© les lacunes, Helm est une solution acceptable pour le d√©ploiement et il est utile que toute la communaut√© participe √† son d√©veloppement. <br><br><h2>  PS </h2><br>  Lisez aussi dans notre blog: <br><br><ul><li>  ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cr√©ation de packages pour Kubernetes avec Helm: structure graphique et cr√©ation de mod√®les</a> ¬ª; </li><li>  ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Une introduction pratique au gestionnaire de paquets pour Kubernetes - Helm</a> ¬ª; </li><li>  ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Gestionnaire de packages pour Kubernetes - Helm: Past, Present, Future</a> ¬ª; </li><li>  ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pratique avec dapp.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2. D√©ploiement d'images Docker dans Kubernetes avec Helm</a> . " </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr438814/">https://habr.com/ru/post/fr438814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr438804/index.html">En attendant tout le monde au prochain Meetup CocoaHeads</a></li>
<li><a href="../fr438806/index.html">Probl√®mes de traduction litt√©raire</a></li>
<li><a href="../fr438808/index.html">ModelMapper: aller-retour</a></li>
<li><a href="../fr438810/index.html">HTTP / 3: de la racine √† la pointe</a></li>
<li><a href="../fr438812/index.html">Qualit√© du code frontal HH</a></li>
<li><a href="../fr438818/index.html">UDB. Qu'est-ce que c'est? Partie 5. Chemin de donn√©es. Petites choses utiles</a></li>
<li><a href="../fr438820/index.html">Gestion des connaissances: quels documents sont n√©cessaires et que corriger en eux</a></li>
<li><a href="../fr438824/index.html">Cours abr√©g√© de gestion √† distance</a></li>
<li><a href="../fr438826/index.html">Resserrer l'anglais pour une entrevue - m√©thodologie et co√ªts de main-d'≈ìuvre</a></li>
<li><a href="../fr438828/index.html">Lazarus - √©criture d'un composant pour l'animation de sprite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>