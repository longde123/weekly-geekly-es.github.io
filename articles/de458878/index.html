<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äç‚öïÔ∏è ü§µüèº üçÉ Was ist GitOps? ‚öìÔ∏è üçú üîª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hinweis perev. : Nach der j√ºngsten Ver√∂ffentlichung von Material zu Pull- und Push-Methoden in GitOps haben wir Interesse an diesem Modell als Ganzes ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Was ist GitOps?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/458878/"> <i><b>Hinweis</b></i>  <i><b>perev.</b></i>  <i>: Nach der j√ºngsten Ver√∂ffentlichung von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Material</a> zu Pull- und Push-Methoden in GitOps haben wir Interesse an diesem Modell als Ganzes gesehen. Es gab jedoch nur sehr wenige russischsprachige Ver√∂ffentlichungen zu diesem Thema (sie befinden sich einfach nicht im Hub).</i>  <i>Wir freuen uns daher, Sie auf eine √úbersetzung eines anderen Artikels aufmerksam zu machen - allerdings vor fast einem Jahr!</i>  <i>- von der Firma Weaveworks, deren Leiter den Begriff "GitOps" gepr√§gt hat.</i>  <i>Der Text erkl√§rt das Wesentliche des Ansatzes und die wichtigsten Unterschiede zu bestehenden.</i> <br><br><img src="https://habrastorage.org/webt/i0/8b/fc/i08bfcph3kkhapzkitpwhylzdhc.png"><br><br>  Vor einem Jahr haben wir eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einf√ºhrung in GitOps ver√∂ffentlicht</a> .  Anschlie√üend sprachen wir dar√ºber, wie das Weaveworks-Team SaaS auf Kubernetes-Basis gestartet und eine Reihe von Best Practices f√ºr die Bereitstellung, Verwaltung und √úberwachung in einer Cloud-nativen Umgebung entwickelt hat. <a name="habracut"></a><br><br>  Der Artikel erwies sich als beliebt.  Andere Leute sprachen √ºber GitOps und ver√∂ffentlichten neue Tools f√ºr <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Git Push</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwicklung</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Geheimnisse</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Funktionen</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">kontinuierliche Integration</a> usw.  Eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gro√üe Anzahl von</a> Ver√∂ffentlichungen und Anwendungsf√§llen von GitOps ist auf unserer Website erschienen.  Aber einige Leute haben noch Fragen.  Wie unterscheidet sich das Modell von der herk√∂mmlichen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Infrastruktur als Code</a> und kontinuierliche Bereitstellung?  Ist die Verwendung von Kubernetes obligatorisch? <br><br>  Bald stellten wir fest, dass eine neue Beschreibung erforderlich war, die Folgendes bot: <br><br><ol><li>  Eine gro√üe Anzahl von Beispielen und Geschichten; </li><li>  Die spezifische Definition von GitOps; </li><li>  Vergleich mit traditioneller kontinuierlicher Lieferung. </li></ol><br>  In diesem Artikel haben wir versucht, alle diese Themen zu behandeln.  Darin finden Sie eine aktualisierte Einf√ºhrung in GitOps und einen Blick von Seiten der Entwickler und von CI / CD.  Wir konzentrieren uns haupts√§chlich auf Kubernetes, obwohl das Modell verallgemeinert werden kann. <br><br><h2>  Treffen Sie GitOps </h2><br>  Stellen Sie sich Alice vor.  Sie leitet die Familienversicherung, ein Unternehmen, das Kranken-, Auto-, Immobilien- und Reiseversicherungen f√ºr Menschen anbietet, die zu besch√§ftigt sind, um die Nuancen ihrer Vertr√§ge selbst zu verstehen.  Ihr Gesch√§ft begann als Nebenprojekt, als Alice als Datenwissenschaftlerin bei der Bank arbeitete.  Als sie erkannte, dass sie fortschrittliche Computeralgorithmen verwenden konnte, um Daten effizienter zu analysieren und Versicherungspakete zu bilden.  Investoren haben das Projekt finanziert, und jetzt bringt ihr Unternehmen mehr als 20 Millionen US-Dollar pro Jahr ein und w√§chst rasant.  Derzeit arbeiten 180 Personen in verschiedenen Positionen.  Darunter ein Technologieteam, das eine Site und eine Datenbank entwickelt, pflegt und den Kundenstamm analysiert.  Ein Team von 60 Mitarbeitern wird von Bob, dem technischen Direktor des Unternehmens, geleitet. <br><br>  Bobs Team setzt Produktionssysteme in der Cloud ein.  Ihre Hauptanwendungen laufen auf GKE und nutzen Kubernetes in Google Cloud.  Dar√ºber hinaus verwenden sie verschiedene Tools f√ºr die Arbeit mit Daten und Analysen in ihrer Arbeit. <br><br>  Die Familienversicherung wollte keine Container verwenden, war aber von der Begeisterung f√ºr Docker befallen.  Bald stellten Unternehmensexperten fest, dass GKE die Bereitstellung von Clustern zum Testen neuer Funktionen einfach und unkompliziert macht.  Jenkins f√ºr CI und Quay wurden hinzugef√ºgt, um die Containerregistrierung zu organisieren. Es wurden Skripte f√ºr Jenkins geschrieben, die Push- oder neue Container und Konfigurationen in GKE enthalten. <br><br>  Einige Zeit ist vergangen.  Alice und Bob waren entt√§uscht von der Leistung des gew√§hlten Ansatzes und seinen Auswirkungen auf das Gesch√§ft.  Die Einf√ºhrung von Containern erh√∂hte die Produktivit√§t nicht so sehr, wie das Team gehofft hatte.  Manchmal brachen Bereitstellungen aus und es war unklar, ob die Code√§nderungen schuld waren.  Es stellte sich auch als schwierig heraus, √Ñnderungen in Konfigurationen zu verfolgen.  Oft war es notwendig, einen neuen Cluster zu erstellen und Anwendungen in diesen zu verschieben, da dies der einfachste Weg war, um das Chaos zu beseitigen, in das sich das System verwandelte.  Alice bef√ºrchtete, dass sich die Situation mit der Entwicklung der Anwendung verschlechtern w√ºrde (au√üerdem braute sich ein neues Projekt zusammen, das auf maschinellem Lernen basierte).  Bob automatisierte den gr√∂√üten Teil der Arbeit und verstand nicht, warum die Pipeline immer noch instabil ist, nicht gut skaliert und von Zeit zu Zeit manuelle Eingriffe erfordert? <br><br>  <b>Dann lernten sie GitOps kennen.</b>  <b>Diese Entscheidung erwies sich als genau das, was sie brauchten, um sicher voranzukommen.</b> <br><br>  Alice und Bob haben jahrelang von Workflows geh√∂rt, die auf Git, DevOps und Infrastruktur als Code basieren.  Die Einzigartigkeit von GitOps besteht darin, dass es eine Reihe von Best Practices - kategorisch und normativ - bringt, um diese Ideen im Kontext von Kubernetes umzusetzen.  Dieses Thema <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wurde wiederholt angesprochen</a> , auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im Weaveworks-Blog</a> . <br><br>  Die Familienversicherung beschlie√üt, GitOps zu implementieren.  Das Unternehmen verf√ºgt nun √ºber ein mit Kubernetes kompatibles automatisiertes Betriebsmodell, das <i>Geschwindigkeit</i> mit <i>Stabilit√§t</i> kombiniert, da: <br><br><ul><li>  festgestellt, dass das Team die Produktivit√§t verdoppelt hat und niemand verr√ºckt wird; </li><li>  hat die Wartung von Skripten eingestellt.  Stattdessen k√∂nnen sie sich jetzt auf neue Funktionen konzentrieren und die technischen Methoden verbessern - beispielsweise kanarische Roll-outs einf√ºhren und Tests verbessern; </li><li>  verbesserter Bereitstellungsprozess - jetzt bricht er selten ab; </li><li>  die M√∂glichkeit erhalten, Bereitstellungen nach Teilfehlern ohne manuelles Eingreifen wiederherzustellen; </li><li>  mehr Vertrauen in die Versorgungssysteme gewonnen.  Alice und Bob stellten fest, dass das Team in Gruppen unterteilt werden kann, die in Microservices arbeiten und parallel arbeiten. </li><li>  kann durch die Bem√ºhungen jeder Gruppe jeden Tag 30-50 √Ñnderungen am Projekt vornehmen und neue Techniken ausprobieren; </li><li>  Sie werden leicht von neuen Entwicklern f√ºr das Projekt angezogen, die in der Lage sind, Aktualisierungen der Produktion mithilfe von Pull-Anforderungen in wenigen Stunden durchzuf√ºhren. </li><li>  Einfache Pr√ºfung innerhalb von SOC2 <i>(zur Einhaltung der Anforderungen f√ºr die sichere Datenverwaltung durch Dienstanbieter; lesen Sie beispielsweise <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier mehr</a> - ca. √ºbersetzt)</i> . </li></ul><br><h3>  Was ist passiert? </h3><br>  GitOps sind zwei Dinge: <br><br><ol><li>  Betriebsmodell f√ºr Kubernetes und Cloud Native.  Es bietet eine Reihe von Best Practices f√ºr die Bereitstellung, Verwaltung und √úberwachung von containerisierten Clustern und Anwendungen.  Elegante Definition in einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einzigen Folie</a> von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Luis Faceira</a> : <br><br><img src="https://habrastorage.org/webt/or/fl/uu/orfluutk_hcqu6dnclf6pu1ewes.jpeg"></li><li>  Der Weg zum Erstellen einer entwicklerorientierten Umgebung f√ºr die Verwaltung von Anwendungen.  Wir wenden den Git-Workflow sowohl auf die Nutzung als auch auf die Entwicklung an.  Bitte beachten Sie, dass es hier nicht nur um Git Push geht, sondern um die Organisation des gesamten Satzes von CI / CD- und UI / UX-Tools. </li></ol><br><h3>  Ein paar Worte zu Git </h3><br>  Wenn Sie mit Versionskontrollsystemen und dem Git-basierten Workflow nicht vertraut sind, empfehlen wir Ihnen dringend, diese zu studieren.  Auf den ersten Blick mag die Arbeit mit Zweigen und Pull-Anfragen wie schwarze Magie erscheinen, aber die Profis sind die M√ºhe wert.  Hier ist ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">guter Artikel</a> , um Ihnen den Einstieg zu erleichtern. <br><br><h2>  Wie Kubernetes funktioniert </h2><br>  In unserer Geschichte wandten sich Alice und Bob an GitOps, nachdem sie eine Weile mit Kubernetes gearbeitet hatten.  In der Tat ist GitOps eng mit Kubernetes verbunden - es ist ein Betriebsmodell f√ºr die auf Kubernetes basierende Infrastruktur und Anwendungen. <br><br><h3>  Was gibt Kubernetes Benutzern? </h3><br>  Hier sind einige wichtige Funktionen: <br><br><ol><li>  Im Kubernetes-Modell kann alles deklarativ beschrieben werden. </li><li>  Der Kubernetes-API-Server akzeptiert eine solche Deklaration als Eingabe und versucht dann st√§ndig, den Cluster in den in der Deklaration beschriebenen Zustand zu bringen. </li><li>  Erkl√§rungen reichen aus, um eine Vielzahl von Workloads zu beschreiben und zu verwalten - ‚ÄûAnwendungen‚Äú. </li><li>  Infolgedessen sind √Ñnderungen an der Anwendung und am Cluster auf Folgendes zur√ºckzuf√ºhren: <br><ul><li>  √Ñnderungen an Containerbildern; </li><li>  √Ñnderungen der deklarativen Spezifikation; </li><li>  Fehler in der Umgebung - zum Beispiel Containerabst√ºrze. </li></ul></li></ol><br><h3>  Kubernetes 'gro√üe Konvergenzf√§higkeiten </h3><br>  Wenn ein Administrator Konfigurations√§nderungen vornimmt, wendet der Kubernetes-Orchestrator diese auf den Cluster an, bis sich sein Status <i>der neuen Konfiguration n√§hert</i> .  Dieses Modell funktioniert f√ºr jede Kubernetes-Ressource und wird mit benutzerdefinierten Ressourcendefinitionen (CRDs) erweitert.  Daher weisen Kubernetes-Bereitstellungen die folgenden wunderbaren Eigenschaften auf: <br><br><ul><li>  <b>Automatisierung</b> : Kubernetes-Updates bieten einen Mechanismus, um den Prozess der korrekten und zeitnahen Anwendung von √Ñnderungen zu automatisieren. </li><li>  <b>Konvergenz</b> : Kubernetes wird weiterhin versuchen, Aktualisierungen bis zum Erfolg vorzunehmen. </li><li>  <b>Idempotenz</b> : Wiederholte Konvergenzanwendungen f√ºhren zum gleichen Ergebnis. </li><li>  <b>Determinismus</b> : Bei ausreichenden Ressourcen h√§ngt der Status des aktualisierten Clusters nur vom gew√ºnschten Status ab. </li></ul><br><h2>  Wie GitOps funktioniert </h2><br>  Wir haben genug √ºber Kubernetes gelernt, um zu erkl√§ren, wie GitOps funktioniert. <br><br>  Kehren wir zu den Familienversicherungsteams zur√ºck, die sich mit Microservices befassen.  Was m√ºssen sie normalerweise tun?  Schauen Sie sich die Liste unten an (wenn Punkte darin seltsam oder ungewohnt erscheinen - verschieben Sie bitte die Kritik und bleiben Sie bei uns).  Dies sind nur Beispiele f√ºr Jenkins-basierte Workflows.  Bei der Arbeit mit anderen Tools gibt es viele andere Prozesse. <br><br>  Die Hauptsache ist, dass wir sehen, dass jedes Update mit √Ñnderungen an den Konfigurationsdateien und Git-Repositorys endet.  Diese √Ñnderungen in Git bewirken, dass die "GitOps-Anweisung" den Cluster aktualisiert: <br><br>  1. Workflow: ‚Äû <i>Jenkins Build - Hauptzweig</i> ‚Äú. <br>  Die Liste der Aufgaben: <br><br><ul><li>  Jenkins Push-Tagged-Bilder in Quay; </li><li>  Jenkins schiebt seine Konfigurations- und Helm-Diagramme in den Master-Speicherbereich. </li><li>  Die Cloud-Funktion kopiert die Konfiguration und die Diagramme aus dem Master-Speicher-Bucket in das Master-Git-Repository. </li><li>  Die GitOps-Anweisung aktualisiert den Cluster. </li></ul><br>  2. <i>Jenkins Build - Release oder Hotfix - Zweig</i> : <br><br><ul><li>  Jenkins schiebt Bilder ohne Tags in Quay; </li><li>  Jenkins schiebt die Konfigurations- und Helm-Diagramme in den Eimer mit dem Staging-Speicher. </li><li>  Die Cloud-Funktion kopiert die Konfiguration und die Diagramme aus dem Bucket des Staging-Speichers in das Git-Repository-Staging. </li><li>  Die GitOps-Anweisung aktualisiert den Cluster. </li></ul><br>  3. <i>Jenkins Build - Entwickeln oder Feature-Zweig</i> : <br><br><ul><li>  Jenkins schiebt Bilder ohne Tags in Quay; </li><li>  Jenkins schiebt die Konfigurations- und Helmdiagramme in den Entwicklungsspeicherbereich. </li><li>  Die Cloud-Funktion kopiert die Konfiguration und die Diagramme aus dem Entwicklungsspeicher-Bucket in das Entwicklungs-Git-Repository. </li><li>  Die GitOps-Anweisung aktualisiert den Cluster. </li></ul><br>  4. <i>Hinzuf√ºgen eines neuen Clients</i> : <br><br><ul><li>  Ein Manager oder Administrator (LCM / ops) ruft Gradle an, um zun√§chst Network Load Balancer (NLBs) bereitzustellen und zu konfigurieren. </li><li>  LCM / ops schreibt eine neue Konfiguration fest, um die Bereitstellung f√ºr Updates vorzubereiten. </li><li>  Die GitOps-Anweisung aktualisiert den Cluster. </li></ul><br><h3>  Kurzbeschreibung von GitOps </h3><br><ol><li>  Beschreiben Sie den gew√ºnschten Status des gesamten Systems anhand deklarativer Spezifikationen f√ºr jede Umgebung (in unserer Geschichte definiert das Bob-Team die gesamte Systemkonfiguration in Git). <br><br><ul><li>  Das Git-Repository ist die einzige Wahrheitsquelle in Bezug auf den gew√ºnschten Zustand des gesamten Systems. </li><li>  Alle √Ñnderungen am gew√ºnschten Status werden durch Commits in Git vorgenommen. </li><li>  Alle gew√ºnschten Clusterparameter k√∂nnen auch im Cluster selbst beobachtet werden.  Somit k√∂nnen wir bestimmen, ob die gew√ºnschten und beobachteten Zust√§nde zusammenfallen (konvergieren, <i>konvergieren</i> ) oder sich unterscheiden ( <i>divergieren</i> , <i>divergieren</i> ). </li></ul></li><li>  Wenn die gew√ºnschten und beobachteten Zust√§nde unterschiedlich sind, dann: <br><br><ul><li>  Es gibt einen Konvergenzmechanismus, der fr√ºher oder sp√§ter das Ziel und die beobachteten Zust√§nde automatisch synchronisiert.  Innerhalb des Clusters erledigt Kubernetes dies. </li><li>  Der Prozess beginnt sofort mit einer Benachrichtigung √ºber festgeschriebene √Ñnderungen. </li><li>  Nach einer konfigurierbaren Zeitspanne kann eine Diff-Warnung gesendet werden, wenn die Zust√§nde unterschiedlich sind. </li></ul></li><li>  Somit l√∂sen alle Commits in Git √ºberpr√ºfbare und idempotente Aktualisierungen im Cluster aus. <br><br><ul><li>  Rollback ist eine Konvergenz zu einem zuvor gew√ºnschten Zustand. </li></ul></li><li>  Konvergenz ist endg√ºltig.  √úber seinen Beginn bezeugen: <br><br><ul><li>  Fehlende "Diff" -Warnungen f√ºr einen bestimmten Zeitraum. </li><li>  Eine konvergierte Warnung (z. B. Webhook, Git Writeback-Ereignis). </li></ul></li></ol><br><h3>  Was ist Divergenz? </h3><br>  Wir wiederholen noch einmal: <i>Alle gew√ºnschten Eigenschaften des Clusters sollten im Cluster selbst beobachtbar sein</i> . <br><br>  Einige Beispiele f√ºr Abweichungen: <br><br><ul><li>  √Ñnderung in der Konfigurationsdatei durch Zusammenf√ºhren von Zweigen in Git. </li><li>  Eine √Ñnderung in der Konfigurationsdatei aufgrund eines vom GUI-Client vorgenommenen Commits in Git. </li><li>  Mehrfache √Ñnderungen im gew√ºnschten Status aufgrund von PR in Git mit der anschlie√üenden Zusammenstellung des Container-Images und √Ñnderungen an der Konfiguration. </li><li>  √Ñnderung des Clusterstatus aufgrund eines Fehlers, eines Ressourcenkonflikts, der zu ‚Äûschlechtem Verhalten‚Äú f√ºhrt, oder nur einer versehentlichen Abweichung vom urspr√ºnglichen Status. </li></ul><br><h3>  Was ist ein Konvergenzmechanismus? </h3><br>  Einige Beispiele: <br><br><ul><li>  F√ºr Container und Cluster bietet der Konvergenzmechanismus Kubernetes. </li><li>  Der gleiche Mechanismus kann verwendet werden, um Kubernetes-basierte Anwendungen und Designs (z. B. Istio und Kubeflow) zu verwalten. </li><li>  Der Mechanismus zum Verwalten der Arbeitsinteraktion zwischen Kubernetes, Image-Repositorys und Git wird <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vom Weave Flux GitOps-Operator bereitgestellt</a> , der Teil der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Weave Cloud ist</a> . </li><li>  F√ºr Basismaschinen muss der Konvergenzmechanismus deklarativ und autonom sein.  Aus eigener Erfahrung k√∂nnen wir sagen, dass <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Terraform</a> dieser Definition am n√§chsten kommt, aber dennoch menschliche Kontrolle erfordert.  In diesem Sinne erweitert GitOps die Tradition der Infrastruktur als Code. </li></ul><br>  GitOps kombiniert Git mit der hervorragenden Konvergenz-Engine von Kubernetes und bietet ein Modell f√ºr den Betrieb. <br><br>  Mit GitOps k√∂nnen wir erkl√§ren, dass <i>nur die Systeme, die beschrieben und beobachtet werden k√∂nnen, automatisiert und gesteuert werden k√∂nnen</i> . <br><br><h3>  GitOps ist f√ºr den gesamten nativen Cloud-Stack (z. B. Terraform usw.). </h3><br>  GitOps ist nicht nur Kubernetes.  Wir m√∂chten, dass das gesamte System deklarativ verwaltet wird und Konvergenz verwendet wird.  Mit einem Gesamtsystem ist eine Reihe von Umgebungen gemeint, die mit Kubernetes arbeiten, z. B. "Dev Cluster 1", "Production" usw. Jede Umgebung umfasst Maschinen, Cluster, Anwendungen sowie Schnittstellen f√ºr externe Dienste, die Daten, √úberwachung und Daten bereitstellen usw. <br><br>  Beachten Sie, wie wichtig Terraform in diesem Fall f√ºr das Bootstrapping-Problem ist.  Kubernetes muss irgendwo bereitgestellt werden. Die Verwendung von Terraform bedeutet, dass wir dieselben GitOps-Workflows verwenden k√∂nnen, um die Kontrollschicht zu erstellen, die Kubernetes und Anwendungen zugrunde liegt.  Dies ist eine gute Best Practice. <br><br>  Besonderes Augenmerk wird auf die Anwendung von GitOps-Konzepten auf Ebenen √ºber Kubernetes gelegt.  Derzeit gibt es GitOps-√§hnliche L√∂sungen f√ºr Istio, Helm, Ksonnet, OpenFaaS und Kubeflow sowie beispielsweise Pulumi, die eine Ebene f√ºr die Entwicklung von Anwendungen f√ºr Cloud Native erstellen. <br><br><h2>  Kubernetes CI / CD: Vergleich von GitOps mit anderen Ans√§tzen </h2><br>  Wie bereits erw√§hnt, sind GitOps zwei Dinge: <br><br><ol><li>  Das oben beschriebene Betriebsmodell f√ºr Kubernetes und Cloud Native. </li><li>  Der Weg zum Organisieren einer entwicklerorientierten Anwendungsverwaltungsumgebung. </li></ol><br>  F√ºr viele ist GitOps in erster Linie ein Git-Push-basierter Workflow.  Wir m√∂gen ihn auch.  Dies ist jedoch noch nicht alles: Schauen wir uns nun die CI / CD-Pipelines an. <br><br><h3>  GitOps bietet Continuous Deployment (CD) f√ºr Kubernetes </h3><br>  GitOps bietet einen kontinuierlichen Bereitstellungsmechanismus, der die Notwendigkeit separater "Bereitstellungsverwaltungssysteme" √ºberfl√ºssig macht.  Kubernetes erledigt die ganze Arbeit f√ºr Sie. <br><br><ul><li>  Das Aktualisieren der Anwendung erfordert ein Aktualisieren in Git.  Dies ist ein Transaktions-Upgrade auf den gew√ºnschten Status.  Die ‚ÄûBereitstellung‚Äú wird dann innerhalb des Clusters von Kubernetes selbst basierend auf einer aktualisierten Beschreibung durchgef√ºhrt. </li><li>  Aufgrund der Besonderheiten von Kubernetes sind diese Updates konvergent.  Dies bietet einen Mechanismus f√ºr die kontinuierliche Bereitstellung, bei dem alle Aktualisierungen atomar sind. </li><li>  Hinweis: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Weave Cloud</a> bietet einen GitOps-Operator, der Git und Kubernetes integriert und es Ihnen erm√∂glicht, eine CD auszuf√ºhren, indem Sie den gew√ºnschten und aktuellen Status des Clusters abgleichen. </li></ul><br><h3>  Ohne Kubectl und Skripte </h3><br>  Vermeiden Sie die Verwendung von Kubectl zum Aktualisieren des Clusters und insbesondere von Skripten zum Gruppieren von Kubectl-Befehlen.  Stattdessen kann ein Benutzer mit einer GitOps-Pipeline seinen Kubernetes-Cluster √ºber Git aktualisieren. <br><br>  Zu den Vorteilen geh√∂ren: <br><br><ol><li>  <b>Richtigkeit</b> .  Eine Gruppe von Updates kann angewendet, konvergiert und schlie√ülich validiert werden, was uns dem Ziel der atomaren Bereitstellung n√§her bringt.  Im Gegenteil, die Verwendung von Skripten gibt keine Garantie f√ºr die Konvergenz (mehr dazu weiter unten). </li><li>  <b>Sicherheit</b>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zitat von</a> Kelsey Hightower: ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beschr√§nken Sie den</a> Zugriff auf den Kubernetes-Cluster auf Automatisierungstools und Administratoren, die f√ºr das Debuggen oder die Wartung verantwortlich sind.‚Äú  Siehe auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">meine Ver√∂ffentlichung</a> zu Sicherheit und Compliance sowie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einen Artikel zum Hacken von Homebrew</a> durch Diebstahl von Anmeldeinformationen aus einem nachl√§ssig geschriebenen Jenkins-Skript. </li><li>  <b>Benutzererfahrung</b> .  Kubectl enth√ºllt die Mechanik des Kubernetes-Objektmodells, das recht komplex ist.  Im Idealfall sollten Benutzer auf einer h√∂heren Abstraktionsebene mit dem System interagieren.  Hier werde ich noch einmal auf Kelsey verweisen und empfehlen, sich einen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">solchen Lebenslauf anzusehen</a> . </li></ol><br><h3>  Der Unterschied zwischen CI und CD </h3><br>  GitOps verbessert vorhandene CI / CD-Modelle. <br><br>  Der moderne CI-Server ist ein Instrument f√ºr die Orchestrierung.  Insbesondere ist es ein Instrument zur Orchestrierung von CI-Pipelines.  Dazu geh√∂ren das Erstellen, Testen, Zusammenf√ºhren mit dem Trunk usw. CI-Server automatisieren die Verwaltung komplexer mehrstufiger Pipelines.  Eine h√§ufige Versuchung besteht darin, ein Skript f√ºr das Kubernetes-Update-Set zu erstellen und es als Pipeline-Element auszuf√ºhren, um √Ñnderungen an den Cluster zu √ºbertragen.  In der Tat tun dies viele Experten.  Dies ist jedoch nicht optimal, und hier ist der Grund daf√ºr. <br><br>  CI muss verwendet werden, um Aktualisierungen am Trunk vorzunehmen, und der Kubernetes-Cluster muss sich basierend auf diesen Aktualisierungen selbst √§ndern, um die CD ‚Äûintern‚Äú zu verwalten.  Wir nennen dies das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pull-Modell f√ºr die CD</a> , im Gegensatz zum CI-Push-Modell.  Die CD ist Teil einer <i>Laufzeit-Orchestrierung</i> . <br><br><h3>  Warum CI-Server keine CDs durch direkte Updates in Kubernetes erstellen sollten </h3><br>  <i>Verwenden Sie den CI-Server nicht, um direkte Updates in Kubernetes als eine Reihe von CI-Aufgaben zu orchestrieren.</i>  <i>Dies ist das Anti-Muster, √ºber das wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bereits</a> in unserem Blog gesprochen haben.</i> <br><br>  Kommen wir zur√ºck zu Alice und Bob. <br><br>  Auf welche Probleme sind sie gesto√üen?  Der CI-Server von Bob wendet die √Ñnderungen auf den Cluster an. Wenn dies jedoch der Fall ist, wei√ü Bob nicht, in welchem ‚Äã‚ÄãStatus sich der Cluster befindet (oder befinden sollte) und wie er behoben werden kann.  Das gleiche gilt, wenn erfolgreich. <br><br>  Nehmen wir an, dass Bobs Team ein neues Image zusammengestellt und dann seine Bereitstellungen gepatcht hat, um das Image bereitzustellen (alle aus der CI-Pipeline). <br><br>  Wenn das Image normal erstellt wird, die Pipeline jedoch ausf√§llt, muss das Team Folgendes herausfinden: <br><br><ul><li>  Wurde das Update bereitgestellt? </li><li>  Beginnen wir mit einem Neubau?        ‚Äî           ? </li><li>      ,    ? </li><li>     ?     (     )? </li></ul><br> <i>   Git'    ,        .  -    push' ,    -  ;          --.</i> <br><br> ,   CI-    CD: <br><br><ul><li>     ;     . </li><li> CI-      . </li><li>   .       . </li><li>      . </li></ul><br> <i>  Helm'e:     Helm,      GitOps-,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Flux-Helm</a> .    .    Helm    ,  .</i> <br><br><h2> GitOps     Continuous Delivery  Kubernetes </h2><br>      GitOps  ,        ,     .     , ,     . ,         ,  GitOps      . <br><br><h3>    Kubernetes </h3><br>    .   Git            : <br><br><ul><li>   ,       Git      . </li><li>  Runtime GitOps,      .       Git     . </li></ul><br><img src="https://habrastorage.org/webt/0h/mo/vs/0hmovs2jg182thgg_hxll6jabwk.png"><br><br><h3>   ? </h3><br><ol><li> <b> </b> :  ,      ,   Git   .  ,     CI  runtime-.    ¬´ ¬ª <i>(immutability firewall)</i> ,       .          72-87 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> . </li><li> <b>   CI-  Git-</b> : GitOps    .       CI-  Git-,     .      Continuous Delivery     CI-/Git-   .        cloud native.   GitOps     . </li><li> <b>   </b> :     Git , Weave Flux (  Weave Cloud)    runtime.  ,  Kubernetes   , Git .           GitOps,   . </li></ol><br><img src="https://habrastorage.org/webt/xh/wn/83/xhwn83itzgegzohc4vyp2sprpe8.png"><br><br><h2>  Fazit </h2><br> GitOps    ,     CI/CD: <br><br><ul><li> ; </li><li> ; </li><li> ; </li><li> . </li></ul><br>  ,          cloud native. <br><br><ul><li>           ,    runbook' <i>(     ‚Äî . .)</i> ,    deployment'. </li><li>   cloud native-         ,        . </li></ul><br>   ,              . GitOps  -      . <br><br><h2>  PS vom √úbersetzer </h2><br>  Lesen Sie auch in unserem Blog: <br><br><ul><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> werf 1.0 stable:    GitOps,   </a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitOps:   Pull  Push</a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">  kubedog     Kubernetes</a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">   Kubernetes (   )</a> ¬ª. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de458878/">https://habr.com/ru/post/de458878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de458866/index.html">Wie der Team Balancer in World of Tanks Blitz funktioniert</a></li>
<li><a href="../de458868/index.html">Rauschen in Big Data. Entropieanalyse</a></li>
<li><a href="../de458870/index.html">Die beliebtesten Computerprobleme, mit denen wir t√§glich konfrontiert sind</a></li>
<li><a href="../de458874/index.html">ASO-Checkliste: Textoptimierung</a></li>
<li><a href="../de458876/index.html">Freitag Mini CTF</a></li>
<li><a href="../de458880/index.html">Linux-Entwicklung unter Windows mit WSL und Visual Studio Code Remote</a></li>
<li><a href="../de458882/index.html">√ñffentliche Rede. Kurz zur Hauptsache</a></li>
<li><a href="../de458884/index.html">Ein bisschen √ºber Weltraumkommunikationsstandards</a></li>
<li><a href="../de458886/index.html">Am n√ºtzlichsten Mail.ru Design Conf √ó Dribbble Meetup 2019 Papers von True Engineering</a></li>
<li><a href="../de458888/index.html">Summer Droid Meetup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>