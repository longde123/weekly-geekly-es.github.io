<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚û∞ üòç ‚òùüèø Karte der Moskauer U-Bahn und der ganzen Welt f√ºr Android üò≥ üë©üèø‚ÄçüöÄ üî©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="KAPITEL 1. Ehrgeiz 
 Ende Februar 2018 



 Wir als Anh√§nger der Ideologie der freien Software und des freien Marktes glauben, dass das Monopol schlec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Karte der Moskauer U-Bahn und der ganzen Welt f√ºr Android</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/involta/blog/459684/"><h3>  KAPITEL 1. Ehrgeiz </h3><br>  <i>Ende Februar 2018</i> <br><br><img src="https://habrastorage.org/webt/lt/tg/uh/lttguhdjo8ap9vv_i4egmb-7-ma.png"><br><br>  Wir als Anh√§nger der Ideologie der freien Software und des freien Marktes glauben, dass das Monopol schlecht ist. <br><br>  Eine gro√üe Anzahl von Menschen ben√∂tigt eine bequeme und schnelle Navigation in der U-Bahn.  Es ist seltsam, dass es keinen einzigen w√ºrdigen Konkurrenten f√ºr die Yandex.Metro-Anwendung gibt.  Wir haben uns entschlossen, es selbst zu kreieren und es in unserer Freizeit als Hobby zu machen. <br><br>  Team: zu unterschiedlichen Zeiten von 2 bis 4 Personen. <br><br>  Die Geschichte behandelt nur die Android-Anwendung, da sie zuerst gestartet wurde und alle grundlegenden Mechanismen darauf ausgef√ºhrt wurden.  Nat√ºrlich ist die iOS-Version derzeit verf√ºgbar. <br><br><h3>  KAPITEL 2. Die Route in der Dunkelheit </h3><br>  <i>M√§rz - Juni 2018.</i> <br><br>  Ben√∂tigen Sie eine Karte.  Wir nehmen SVG, schieben es in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SVGView</a> , alles ist in Ordnung.  Liegt schrecklich, aber wir freuen uns.  Wie zeichne ich separate Routen?  Niemand wei√ü es. <br><br>  Im SVG-Format gibt es keine Informationen zur √úberlagerung, ob ein Element zu einer Linie geh√∂rt oder andere Informationen, die f√ºr die Erstellung einer Route von entscheidender Bedeutung sind.  Also haben wir eine Datenbank verwendet, um alle Elemente f√ºr das Rendern zu speichern. <br><br>  Au√üerdem musste die Anwendung so schnell wie m√∂glich ausgef√ºhrt werden.  Wenn Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WebView verwenden,</a> verschwindet es sofort. Sie ben√∂tigen eine GL-Oberfl√§che.  Wir haben uns entschlossen, es mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SurfaceView</a> (einer offenen Oberfl√§che, die als Leinwand verwendet werden kann) zu versuchen - das ist es nicht.  Es kann √Ñnderungen an sich selbst vornehmen und schwarz blinken, da es einfach schlecht implementiert ist und der Last nicht mehr standh√§lt als das Rendern eines 20x20-W√ºrfels.  Es kann zunehmen und einmal verschwinden.  Wir brauchten eine andere L√∂sung, die jedoch nicht so weit von SurfaceView entfernt war, da sie f√ºr uns auf der Benutzeroberfl√§che vollst√§ndig geeignet war. <br><br><img src="https://habrastorage.org/webt/ln/gp/cm/lngpcmo0m8odexmxrwgo9e6wqqk.png" alt="Bild"><br>  <i>Kurz √ºber Android-Treiberfehler</i> <br><a name="habracut"></a><br>  Wir haben eine Implementierung in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">TextureView</a> versucht.  Und, oh G√∂tter, die meisten Probleme sind weg.  Trotz der Tatsache, dass TextureView ein SurfaceView f√ºr Steroide ist, wird es normalerweise ohne magische Fehler und epileptische Anf√§lle des Videoadapters implementiert. <br><br>  Wir haben immer noch Fehler beim Synchronisieren von Streams und beim Anpassen von Ansichten in Form von nicht lesbaren Segmentierungsfehlern, aber dies war besser als ein schwarzer Blinkpunkt.  Dementsprechend zwingt jede Verwendung von View, die nicht so sein sollte, fast alle Methoden von View selbst neu zu definieren.  Dies war bei TextureView besonders problematisch, da diese Komponente aus zwei Teilen besteht: Ansicht und Oberfl√§che.  Sie k√∂nnen nicht ohne einander leben, aber gleichzeitig k√∂nnen sie das Surface-Death-Ereignis einfach nicht in der Ansicht senden, weshalb Sie nach fast jeder Aktion manuelle √úberpr√ºfungen durchf√ºhren m√ºssen. <br><br>  Die Probleme begannen, als wir die Sicht vergr√∂√üern mussten.  Canvas zeichnet alles Pixel f√ºr Pixel. Wenn wir also eine Gr√∂√üe von 400 x 400 angeben, sind Elemente von 0 bis 400 sichtbar, jedoch nicht au√üerhalb.  400 ist sehr klein, in Wirklichkeit ben√∂tigen wir auf guten Ger√§ten eine Karte mit etwa 5000 x 5600 Pixel.  Aber wie passt man 5000x5600 auf einen 1920x1080 (16: 9) Bildschirm? <br><br>  Wir erstellen eine Leinwandkarte mit einer Gr√∂√üe und einem Ma√üstab, die mit der Bildschirmaufl√∂sung zunehmen und mit abnehmender Bildschirmaufl√∂sung abnehmen.  So haben wir das Problem sehr gro√üer und schief gezeichneter Karten auf Ger√§ten mit gro√üem Bildschirm und zu kleinen Karten auf kleinen Bildschirmen gel√∂st. <br><br>  Als wir mit dem Testen der Karte begannen, stellte sich heraus, dass auf Telefonen mit derselben Aufl√∂sung die Karte anders angezeigt wird.  Ebenso anders: Auf einem wird ein wei√üer / schwarzer Fleck angezeigt.  Protokolle f√ºhren zu einem Qualcomm-Bug-Tracker und zu einem Fehler mit Adreno 330/300-Chips mit dem Status "Wontfix".  Gro√üartig <br><br>  Die einzige M√∂glichkeit, diesen Fehler zu beheben, besteht darin, die Gr√∂√üe der Karte auf Telefonen mit einem bestimmten Videochip zu untersch√§tzen, sodass anstelle der Karte kein wei√ües Quadrat angezeigt wird.  Aber woher kennen wir das Modell des Videochips?  Wir m√ºssen beim Starten der Anwendung eine GLSurfaceView mit einer Gr√∂√üe von 1x1 Pixel erstellen, Informationen √ºber den Videochip daraus abrufen und erst dann eine Karte zeichnen. <br><br>  "- Aber es ist eine Kr√ºcke."  Ja, das ist eine Kr√ºcke.  Dies ist eine Kr√ºcke im galaktischen Ma√üstab, aber es ist besser, als eine gro√üe Anzahl von Ger√§ten zu schneiden und zu hoffen, dass Qualcomm den Fehler seiner Treiber behebt und das Update an alle OEMs sendet, damit wir die Karte auf Telefonen mit diesen krummen Treibern verwenden k√∂nnen.  Dank unserer Benutzer konnten wir eine L√∂sung finden, die auf allen Ger√§ten funktioniert. <br><br><img src="https://habrastorage.org/webt/q7/id/bi/q7idbi3gu4yrpgt6wnwulawnjua.png" alt="Bild"><br>  <i>Wir haben gebaut, gebaut und endlich gebaut!</i> <br><br>  Eine sehr interessante Aufgabe war auch die √úberlagerung von Elementen.  Aufgrund der Tatsache, dass der rote Zweig √ºber dem gr√ºnen, der gr√ºne √ºber dem blauen, der gelbe √ºber dem roten usw. gezeichnet werden sollte, haben wir die Ebenennummern eingegeben und unsere (auf den ersten Blick einfache) Anwendung wurde Adobe Photoshop √§hnlich :) <br><br>  Beschlossen, wie Routen gezeichnet werden sollen.  Jetzt musste entschieden werden, wie man das Beste unter ihnen findet.  Um alle Pfade zwischen den Eckpunkten zu finden, verwenden wir den Floyd-Warshall-Algorithmus, um den k√ºrzesten Pfad zu finden, verwenden wir den Dijkstra-Algorithmus, f√ºr alternative Pfade den Yen-Algorithmus.  Wer sich f√ºr Details interessiert, stellt Fragen in den Kommentaren. <br><br><h3>  KAPITEL 3. Die Route im Sonnenschein </h3><br>  <i>Juni - Dezember 2018</i> <br><br>  Zu diesem Zeitpunkt wussten wir bereits, was zu tun ist.  Verbessern Sie das Produkt.  Wir haben neue Karten gezeichnet, neue Sprachen hinzugef√ºgt, Fehler behoben, die Arbeit beschleunigt, Funktionen verbessert, benutzerdefiniertes Feedback gesammelt und keinen Cent f√ºr die Bewerbung der Anwendung ausgegeben. <br><br>  Am 15. Juni haben wir unseren Antrag f√ºr die Ver√∂ffentlichung eingef√ºhrt und ihn durch eine U-Bahn-Karte f√ºr St. Petersburg erg√§nzt.  Auf dieser Karte haben wir beschlossen, Stauseen und Br√ºcken zu kennzeichnen.  Etwas sp√§ter zeigte Yandex ein Redesign mit einem √§hnlichen Kartenlayout.  Nicht schlecht, dachten wir. <br><br><img src="https://habrastorage.org/webt/lt/cc/ru/ltccruhk789nwccr8yp4xorpos0.jpeg" alt="Bild"><br><br>  Insgesamt haben wir 10 St√§dte hinzugef√ºgt: St. Petersburg, Barcelona, ‚Äã‚ÄãPrag, Baku, Kasan, Kiew, Minsk, Nischni Nowgorod, Samara, Nowosibirsk.  Bei der Entwicklung einer U-Bahn-Karte von Paris und New York sind die Pl√§ne - die ganze Welt. <br><br>  Im Juli wurde ein Backend bereitgestellt, um Stationsinformationen zu aktualisieren und Karten schnell zu aktualisieren. <br><br>  Im September hatten wir bereits ein starkes Produkt, das in die Massen getragen werden konnte.  Gleichzeitig haben wir uns mit dem Entwickler der Anwendung "Metro- und MCC - Stationsdiagramme" Nikolai getroffen.  In seiner Anwendung hat er Stationsdiagramme zusammengestellt, mit denen Sie schnell navigieren und den gew√ºnschten Ausgang finden k√∂nnen.  Sehr cool, aber diese Anwendung erlaubte es nicht, eine Route zu erstellen und hatte ein veraltetes Design.  F√ºr ein breites Publikum war es daher schw√§cher als Yandex.Metro. <br>  Wir haben vereinbart, Stationsdesigns in unsere Anwendung zu implementieren, und die Unternehmensleitung hat die Idee unterst√ºtzt und finanziert.  Es ist ein Feature-Killer geworden.  Unsere Benutzer waren begeistert. <br><br>  <i>Januar - M√§rz 2019</i> <br><br>  Nachdem wir ungef√§hr 10 Experimente mit der App-Seite in Google Play durchgef√ºhrt und 18 (!) Tausend Rubel f√ºr Marketing ausgegeben hatten, brachten wir die Anwendungen auf Anfrage der ‚ÄûMetro‚Äú und der ‚ÄûMetro von Moskau‚Äú in die Top 3 von Google Play. <br><br>  Im M√§rz wurde die iOS-Version der Anwendung ver√∂ffentlicht, die auf Anfrage von Moscow Metro auch erfolgreich in den Top 5 der App Stores rangierte. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Download Android: Moscow Metro - Diagramme, Routen, Ausg√§nge</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Laden Sie die Diagramme f√ºr iOS: Moscow Metro + herunter</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de459684/">https://habr.com/ru/post/de459684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de459670/index.html">Gehe nach Amsterdam</a></li>
<li><a href="../de459672/index.html">Unterstreichen Sie in Python</a></li>
<li><a href="../de459674/index.html">Threat Intelligence Epic Saga</a></li>
<li><a href="../de459680/index.html">Nach Highload ++ Siberia 2019 - 8 Oracle-Aufgaben</a></li>
<li><a href="../de459682/index.html">Datenqualit√§t im Speicher</a></li>
<li><a href="../de459688/index.html">Urbanismus in China: Weniger Hipster, mehr Wissenschaft und IT</a></li>
<li><a href="../de459692/index.html">Wie wir Materialmodifikationen entdeckten, die etablierten chemischen Prinzipien widersprechen</a></li>
<li><a href="../de459694/index.html">Museum DataArt. Packen Sie Radio 86RK aus und starten Sie es</a></li>
<li><a href="../de459696/index.html">AI-basierte Fotorestaurierung</a></li>
<li><a href="../de459698/index.html">Wie kann Oracle BI 12c gezwungen werden, so viele Sitzungsvariablen zu erstellen, wie ein Programmierer ben√∂tigt?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>