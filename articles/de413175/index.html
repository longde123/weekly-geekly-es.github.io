<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè´ ‚õπüèø üêô Statische Analyse in Go: Wie wir Zeit sparen, wenn wir Code √ºberpr√ºfen ü•£ üéß ‚ù§Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr. Mein Name ist Sergey Rudachenko, ich bin technischer Experte bei Roistat. In den letzten zwei Jahren hat unser Team verschiedene Teile des...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Statische Analyse in Go: Wie wir Zeit sparen, wenn wir Code √ºberpr√ºfen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/roistat/blog/413175/"><p><img src="https://habrastorage.org/webt/ax/ky/rf/axkyrfxrmccrmh-vbn83run9wpe.jpeg"></p><br><p> Hallo Habr.  Mein Name ist Sergey Rudachenko, ich bin technischer Experte bei Roistat.  In den letzten zwei Jahren hat unser Team verschiedene Teile des Projekts in Microservices on Go √ºbersetzt.  Sie werden von mehreren Teams entwickelt, daher mussten wir einen Qualit√§tsbalken f√ºr harten Code festlegen.  Zu diesem Zweck verwenden wir mehrere Tools. In diesem Artikel konzentrieren wir uns auf eines davon - die statische Analyse. </p><br><p>  Bei der statischen Analyse wird der Quellcode mithilfe spezieller Dienstprogramme automatisch √ºberpr√ºft.  In diesem Artikel werden die Vorteile erl√§utert, beliebte Tools kurz beschrieben und Anweisungen zur Implementierung gegeben.  Es lohnt sich zu lesen, wenn Sie auf √§hnliche Tools √ºberhaupt nicht gesto√üen sind oder sie unsystematisch verwenden. </p><br><p>  In Artikeln zu diesem Thema wird h√§ufig der Begriff "Linter" verwendet.  F√ºr uns ist dies ein praktischer Name f√ºr einfache Werkzeuge zur statischen Analyse.  Die Aufgabe des Linters besteht darin, nach einfachen Fehlern und falschem Design zu suchen. </p><a name="habracut"></a><br><h2 id="zachem-nuzhny-lintery">  Warum werden Linters ben√∂tigt? </h2><br><p> Wenn Sie in einem Team arbeiten, f√ºhren Sie h√∂chstwahrscheinlich Code√ºberpr√ºfungen durch.  In der √úberpr√ºfung √ºbersprungene Fehler sind potenzielle Fehler.  Verpasste einen nicht behandelten <code>error</code> - erhalten Sie keine informative Nachricht und Sie werden blind nach dem Problem suchen.  Beim Typ-Casting falsch oder auf Null-Karte gedreht - noch schlimmer, die Bin√§rdatei ger√§t in Panik. </p><br><p>  Die oben beschriebenen Fehler k√∂nnen zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Code-Konventionen</a> hinzugef√ºgt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> , aber es ist nicht so einfach, sie beim Lesen der Pull-Anforderung zu finden, da der Pr√ºfer den Code lesen muss.  Wenn Sie keinen Compiler im Kopf haben, werden einige der Probleme trotzdem in den Kampf ziehen.  Dar√ºber hinaus lenkt die Suche nach geringf√ºgigen Fehlern von der √úberpr√ºfung der Logik und Architektur ab.  In einiger Entfernung wird die Unterst√ºtzung eines solchen Codes teurer.  Wir schreiben in einer statisch typisierten Sprache, es ist seltsam, sie nicht zu verwenden. </p><br><h2 id="populyarnye-instrumenty">  Beliebte Tools </h2><br><p>  Die meisten Tools f√ºr die statische Analyse verwenden die Pakete <code>go/ast</code> und <code>go/parser</code> .  Sie bieten Funktionen zum Parsen der Syntax von .go-Dateien.  Der Standardausf√ºhrungsthread (z. B. f√ºr das Dienstprogramm golint) lautet wie folgt: </p><br><ul><li>  Liste der Dateien aus erforderlichen Paketen wird geladen </li><li>  <code>parser.ParseFile(...) (*ast.File, error)</code> wird f√ºr jede Datei ausgef√ºhrt </li><li>  sucht f√ºr jede Datei oder jedes Paket nach unterst√ºtzten Regeln </li><li>  Die √úberpr√ºfung durchl√§uft beispielsweise jede Anweisung wie folgt: </li></ul><br><pre> <code class="go hljs">f, err := parser.ParseFile(<span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span>) ast.Walk(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n *ast.Node)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> v := node.(<span class="hljs-keyword"><span class="hljs-keyword">type</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> *ast.FuncDecl: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> strings.Contains(v.Name, <span class="hljs-string"><span class="hljs-string">"_"</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">panic</span></span>(<span class="hljs-string"><span class="hljs-string">"wrong function naming"</span></span>) } } }, f)</code> </pre> <br><p>  Zus√§tzlich zu AST gibt es Single Static Assignment (SSA).  Dies ist eine komplexere Methode zum Parsen von Code, die eher mit einem Ausf√ºhrungsthread als mit Syntaxkonstrukten arbeitet.  In diesem Artikel werden wir nicht im Detail darauf eingehen. Sie k√∂nnen die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> lesen und sich das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiel f√ºr das</a> Dienstprogramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">stackcheck ansehen</a> . </p><br><p>  Als n√§chstes werden nur beliebte Dienstprogramme ber√ºcksichtigt, die n√ºtzliche √úberpr√ºfungen f√ºr uns durchf√ºhren. </p><br><h3 id="gofmt">  gofmt </h3><br><p>  Dies ist das Standarddienstprogramm aus dem go-Paket, das nach Stil√ºbereinstimmungen sucht und diese automatisch beheben kann.  Die Einhaltung des Stils ist f√ºr uns eine zwingende Voraussetzung, daher ist die √úberpr√ºfung der Gofmt in allen unseren Projekten enthalten. </p><br><h3 id="typecheck">  typecheck </h3><br><p>  Typecheck pr√ºft, ob der Code mit dem Typ √ºbereinstimmt, und unterst√ºtzt den Hersteller (im Gegensatz zu gotype).  Der Start ist erforderlich, um die Kompilierung zu √ºberpr√ºfen, bietet jedoch keine vollst√§ndigen Garantien. </p><br><h3 id="go-vet">  Geh zum Tierarzt </h3><br><p>  Das Dienstprogramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">go vet</a> ist Teil des Standardpakets und wird vom Go-Team empfohlen.  √úberpr√ºft eine Reihe h√§ufiger Fehler, zum Beispiel: </p><br><ul><li>  Missbrauch von printf und √§hnlichen Funktionen </li><li>  falsche Build-Tags </li><li>  Vergleich von Funktion und Null </li></ul><br><h3 id="golint">  Golint </h3><br><p>  Golint wurde vom Go-Team entwickelt und validiert Code basierend auf den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumenten</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Effective Go</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CodeReviewComments</a> .  Leider gibt es keine detaillierte Dokumentation, aber <a href="">der Code zeigt,</a> dass Folgendes √ºberpr√ºft wird: </p><br><pre> <code class="go hljs">f.lintPackageComment() f.lintImports() f.lintBlankImports() f.lintExported() f.lintNames() f.lintVarDecls() f.lintElses() f.lintRanges() f.lintErrorf() f.lintErrors() f.lintErrorStrings() f.lintReceiverNames() f.lintIncDec() f.lintErrorReturn() f.lintUnexportedReturn() f.lintTimeNames() f.lintContextKeyTypes() f.lintContextArgs()</code> </pre> <br><h3 id="staticcheck">  statische Pr√ºfung </h3><br><p>  Die Entwickler selbst pr√§sentieren <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">staticcheck</a> als verbesserten Tierarzt.  Es gibt viele Schecks, sie sind in Gruppen unterteilt: </p><br><ul><li>  Missbrauch von Standardbibliotheken </li><li>  Multithreading-Probleme </li><li>  Probleme mit Tests </li><li>  nutzloser Code </li><li>  Leistungsprobleme </li><li>  zweifelhafte Designs </li></ul><br><h3 id="gosimple">  gosimple </h3><br><p>  Es ist spezialisiert auf die Suche nach vereinfachbaren Strukturen, zum Beispiel: </p><br><p>  <strong>Vorher</strong> ( <a href="">Golint-Quellcode</a> ) </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(f *file)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isMain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ffName.Name == <span class="hljs-string"><span class="hljs-string">"main"</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> }</code> </pre> <br><p>  <strong>Nachher</strong> </p><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(f *file)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isMain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ffName.Name == <span class="hljs-string"><span class="hljs-string">"main"</span></span> }</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Dokumentation</a> √§hnelt der statischen Pr√ºfung und enth√§lt detaillierte Beispiele. </p><br><h3 id="errcheck">  Fehler √ºberpr√ºfen </h3><br><p>  Von Funktionen zur√ºckgegebene Fehler k√∂nnen nicht ignoriert werden.  Die Gr√ºnde sind im verbindlichen Dokument <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Effective Go</a> ausf√ºhrlich beschrieben.  Errcheck √ºberspringt den folgenden Code nicht: </p><br><pre> <code class="go hljs">json.Unmarshal(text, &amp;val) f, _ := os.OpenFile(<span class="hljs-comment"><span class="hljs-comment">/* ... */</span></span>)</code> </pre> <br><h3 id="gas">  Gas </h3><br><p>  Findet Schwachstellen im Code: fest codierte Zugriffe, SQL-Injektionen und Verwendung unsicherer Hash-Funktionen. </p><br><p>  Beispiele f√ºr Fehler: </p><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">//    IP  l, err := net.Listen("tcp", ":2000") //  sql  q := fmt.Sprintf("SELECT * FROM foo where name = '%s'", name) q := "SELECT * FROM foo where name = " + name //     import "crypto/md5"</span></span></code> </pre> <br><h2 id="maligned">  b√∂sartig </h2><br><p>  In Go wirkt sich die Reihenfolge der Felder in Strukturen auf den Speicherverbrauch aus.  Maligned findet nicht optimale Sortierung.  Mit dieser Reihenfolge der Felder: </p><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { a <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> b <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> }</code> </pre> <br><p>  Die Struktur belegt 32 Bit im Speicher, da nach den Feldern a und c leere Bits hinzugef√ºgt werden. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9b9/3e3/b67/9b93e3b6777d84459548ac9247b4e76f.jpg" alt="Bild"></p><br><p>  Wenn wir die Sortierung √§ndern und zwei Bool-Felder zusammenf√ºgen, ben√∂tigt die Struktur nur 24 Bit: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ec5/557/62b/ec555762b87fc61b410675ad4fbd8ac2.jpg" alt="Bild"></p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Originalbild auf Stapel√ºberlauf</a> </p><br><h3 id="goconst">  goconst </h3><br><p>  Magische Variablen im Code spiegeln nicht die Bedeutung wider und erschweren das Lesen.  Goconst findet Literale und Zahlen, die mindestens zweimal im Code vorkommen.  Bitte beachten Sie, dass oft schon eine einmalige Verwendung ein Fehler sein kann. </p><br><h3 id="gocyclo">  Gocyclo </h3><br><p>  Wir betrachten die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zyklomatische Komplexit√§t von</a> Code als eine wichtige Metrik.  Gocycle zeigt Komplexit√§t f√ºr jede Funktion.  Es k√∂nnen nur Funktionen angezeigt werden, die den angegebenen Wert √ºberschreiten. </p><br><pre> <code class="hljs pgsql">gocyclo -<span class="hljs-keyword"><span class="hljs-keyword">over</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> package/<span class="hljs-type"><span class="hljs-type">name</span></span></code> </pre> <br><p>  Wir haben f√ºr uns selbst einen Schwellenwert von 7 gew√§hlt, weil wir keinen Code mit einer h√∂heren Komplexit√§t gefunden haben, f√ºr den kein Refactoring erforderlich war. </p><br><h3 id="mertvyy-kod">  Toter Code </h3><br><p>  Es gibt verschiedene Dienstprogramme zum Auffinden nicht verwendeten Codes, deren Funktionalit√§t sich teilweise √ºberschneiden kann. </p><br><ul><li>  Ineffassign: √úberpr√ºft nutzlose Zuordnungen </li></ul><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span>{} log.Println(res) res, err := loadData() <span class="hljs-comment"><span class="hljs-comment">//  res    return err }</span></span></code> </pre> <br><ul><li>  Deadcode: Findet nicht verwendete Funktionen </li><li>  unbenutzt: Findet unbenutzte Funktionen, ist aber besser als Deadcode </li></ul><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">unusedFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { formallyUsedFunc() } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">formallyUsedFunc</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { }</code> </pre> <br><p>  Infolgedessen zeigt unbenutzt auf beide Funktionen gleichzeitig und Deadcode nur auf unusedFunc.  Dadurch wird der zus√§tzliche Code in einem Durchgang gel√∂scht.  Auch unbenutzt findet nicht verwendete Variablen und Strukturfelder. </p><br><ul><li>  varcheck: findet nicht verwendete Variablen </li><li>  nicht konvertieren: findet nutzlose Typkonvertierungen </li></ul><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> res <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(res) <span class="hljs-comment"><span class="hljs-comment">// unconvert error</span></span></code> </pre> <br><p>  Wenn Sie keine Zeit sparen m√ºssen, um √úberpr√ºfungen zu starten, ist es besser, alle zusammen auszuf√ºhren.  Wenn eine Optimierung erforderlich ist, empfehle ich die Verwendung von nicht verwendet und nicht konvertiert. </p><br><h2 id="kak-eto-vse-udobno-nastroit">  Wie bequem es zu konfigurieren ist </h2><br><p>  Das Ausf√ºhren der oben genannten Tools nacheinander ist unpraktisch: Fehler werden in einem anderen Format ausgegeben, die Ausf√ºhrung nimmt viel Zeit in Anspruch.  Das √úberpr√ºfen eines unserer Dienste mit einer Gr√∂√üe von ~ 8000 Codezeilen dauerte mehr als zwei Minuten.  Sie m√ºssen die Dienstprogramme auch separat installieren. </p><br><p>  Es gibt Aggregationsdienstprogramme, um dieses Problem zu l√∂sen, z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Goreporter</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gometalinter</a> .  Goreporter rendert den Bericht in HTML und Gometalinter schreibt in die Konsole. </p><br><p>  Gometalinter wird immer noch in einigen gro√üen Projekten verwendet (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker</a> ).  Er wei√ü, wie man alle Dienstprogramme mit einem einzigen Befehl installiert, parallel ausf√ºhrt und Fehler gem√§√ü der Vorlage formatiert.  Die Ausf√ºhrungszeit im oben genannten Dienst wurde auf eineinhalb Minuten reduziert. </p><br><p>  Die Aggregation funktioniert nur durch das genaue Zusammentreffen des Fehlertextes, daher sind wiederholte Fehler am Ausgang unvermeidlich. </p><br><p>  Im Mai 2018 erschien das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Golangci-Lint-</a> Projekt auf dem Github, das Gometalinter in seiner Bequemlichkeit weit √ºbertrifft: </p><br><ul><li>  Die Ausf√ºhrungszeit f√ºr dasselbe Projekt wurde auf 16 Sekunden (8 Mal) reduziert. </li><li>  fast keine doppelten Fehler </li><li>  yaml config l√∂schen </li><li>  sch√∂ne Fehlerausgabe mit einer Codezeile und einem Zeiger auf ein Problem <br><img src="https://habrastorage.org/webt/nu/ro/vi/nuroviwafnlgpzkyijvsucjwzme.png"></li><li>  Es m√ºssen keine zus√§tzlichen Dienstprogramme installiert werden </li></ul><br><p>  Jetzt wird die Geschwindigkeitssteigerung durch die Wiederverwendung von SSA und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Loader</a> erreicht. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Programm</a> : In Zukunft ist auch geplant, den AST-Baum wiederzuverwenden, √ºber den ich am Anfang des Abschnitts Tools geschrieben habe. </p><br><p>  Zum Zeitpunkt des Schreibens dieses Artikels auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hub.docker.com</a> gab es kein Bild mit Dokumentation, daher haben wir unser eigenes Bild erstellt, das gem√§√ü unseren Vorstellungen von Bequemlichkeit angepasst wurde.  In Zukunft wird sich die Konfiguration √§ndern. F√ºr die Produktion empfehlen wir daher, sie durch Ihre eigene zu ersetzen.  F√ºgen Sie dazu einfach die Datei .golangci.yaml zum Stammverzeichnis des Projekts hinzu ( <a href="">ein Beispiel</a> befindet sich im golangci-lint-Repository). </p><br><pre> <code class="bash hljs">PACKAGE=package/name docker run --rm -t \ -v $(GOPATH)/src/$(PACKAGE):/go/src/$(PACKAGE) \ -w /go/src/$(PACKAGE) \ roistat/golangci-lint</code> </pre> <br><p>  Dieser Befehl kann das gesamte Projekt testen.  Wenn es sich beispielsweise in <code>~/go/src/project</code> , √§ndern Sie den Wert der Variablen in <code>PACKAGE=project</code> .  Die Validierung funktioniert rekursiv f√ºr alle internen Pakete. </p><br><p>  Bitte beachten Sie, dass dieser Befehl nur bei Verwendung des Herstellers ordnungsgem√§√ü funktioniert. </p><br><h1 id="vnedrenie">  Implementierung </h1><br><p>  Alle unsere Entwicklungsdienste verwenden Docker.  Jedes Projekt wird ohne installierte go-Umgebung ausgef√ºhrt.  Verwenden Sie zum Ausf√ºhren der Befehle das Makefile und f√ºgen Sie den Befehl lint hinzu: </p><br><pre> <code class="hljs ruby"><span class="hljs-symbol"><span class="hljs-symbol">lint:</span></span> @docker run --rm -t -v $(GOPATH)/src/$(PACKAGE)<span class="hljs-symbol"><span class="hljs-symbol">:/go/src/</span></span>$(PACKAGE) -w /go/src/$(PACKAGE) roistat/golangci-lint</code> </pre> <br><p>  Jetzt wird die Pr√ºfung mit folgendem Befehl gestartet: </p><br><pre> <code class="bash hljs">make lint</code> </pre> <br><p>  Es gibt eine einfache M√∂glichkeit, fehlerhafte Codeeingabe f√ºr den Master zu blockieren - erstellen Sie einen Pre-Receive-Hook.  Es ist geeignet, wenn: </p><br><ol><li>  Sie haben ein kleines Projekt und wenige Abh√§ngigkeiten (oder sie befinden sich im Repository). </li><li>  Es ist kein Problem f√ºr Sie, einige Minuten zu warten, bis der Befehl <code>git push</code> abgeschlossen ist </li></ol><br><p>  Anweisungen zur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hook-</a> Konfiguration: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gitlab</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bitbucket Server</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github Enterprise</a> . </p><br><p>  In anderen F√§llen ist es besser, CI zu verwenden und Zusammenf√ºhrungscode zu verbieten, bei dem mindestens ein Fehler vorliegt.  Wir tun genau das und f√ºgen den Linter vor den Tests hinzu. </p><br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  Die Einf√ºhrung systematischer √úberpr√ºfungen hat den √úberpr√ºfungszeitraum erheblich verk√ºrzt.  Eine andere Sache ist jedoch wichtiger: Jetzt k√∂nnen wir die meiste Zeit √ºber das Gesamtbild und die Architektur diskutieren.  Auf diese Weise k√∂nnen Sie √ºber die Entwicklung des Projekts nachdenken, anstatt L√∂cher zu stopfen. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de413175/">https://habr.com/ru/post/de413175/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de413165/index.html">SRTP-Erkl√§rung</a></li>
<li><a href="../de413167/index.html">Wie kann ich Zimbra in ein DLP-System integrieren?</a></li>
<li><a href="../de413169/index.html">N√ºtzliche Array- und Objektmethoden in JavaScript</a></li>
<li><a href="../de413171/index.html">Tokamak JET startet neue Deuterium Tritium Kampagne</a></li>
<li><a href="../de413173/index.html">√úberwachen von JavaScript-Fehlern mit window.onerror</a></li>
<li><a href="../de413177/index.html">Digitale Events in Moskau vom 4. bis 10. Juni</a></li>
<li><a href="../de413181/index.html">Wenn externe Funktionsaufrufe schneller sind als native C-Aufrufe</a></li>
<li><a href="../de413183/index.html">Optane DC Persistent Memory - Optane im DIMM-Format</a></li>
<li><a href="../de413185/index.html">Foulspiel oder wie die Organisatoren der Auslosung uns t√§uschen</a></li>
<li><a href="../de413187/index.html">Interview mit Ryan Dahl, Sch√∂pfer von Node.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>