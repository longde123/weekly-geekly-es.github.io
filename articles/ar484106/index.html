<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ง๐ผ ๐จ ๐ต๏ธ MVCC ูู PostgreSQL-6. ูุฑุงุบ ๐คญ ๐ ๐๐ฝ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏ ุจุฏุฃูุง ุจูุดุงูู ูุชุนููุฉ ุจุงูุนุฒูุฉ ุ ููููุง ุจุงุณุชูุดุงู ุจููุฉ ุงูุจูุงูุงุช ููุฎูุถุฉ ุงููุณุชูู ุ ุซู ูุงูุดูุง ุฅุตุฏุงุฑุงุช ุงูุตู ููุงุญุธูุง ููููุฉ ุงูุญุตูู ุนูู ููุทุงุช ุงูุจูุงูุงุช ูู ุฅุตุฏุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MVCC ูู PostgreSQL-6. ูุฑุงุบ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/484106/" style=";text-align:right;direction:rtl">  ููุฏ ุจุฏุฃูุง ุจูุดุงูู ูุชุนููุฉ <a href="https://habr.com/ru/company/postgrespro/blog/467437/">ุจุงูุนุฒูุฉ</a> ุ ููููุง ุจุงุณุชูุดุงู <a href="https://habr.com/ru/company/postgrespro/blog/469087/">ุจููุฉ ุงูุจูุงูุงุช ููุฎูุถุฉ ุงููุณุชูู</a> ุ ุซู ูุงูุดูุง <a href="https://habr.com/ru/company/postgrespro/blog/477648/">ุฅุตุฏุงุฑุงุช ุงูุตู</a> ููุงุญุธูุง ููููุฉ ุงูุญุตูู ุนูู <a href="https://habr.com/ru/company/postgrespro/blog/479512/">ููุทุงุช ุงูุจูุงูุงุช</a> ูู ุฅุตุฏุงุฑุงุช ุงูุตููู. <br><br>  <a href="https://habr.com/ru/company/postgrespro/blog/483768/">ุขุฎุฑ ูุฑุฉ</a> ุชุญุฏุซูุง ูููุง ุนู ุชุญุฏูุซุงุช HOT <em>ููููุณุฉ ููุฑุจุงุฆูุฉ</em> ูู ุงูุตูุญุฉ ุ ูุงูููู ุณููุชูู ุฅูู <em>ูุฑุงุบ ูุฃููู</em> ูุนุฑูู.  ุญููุง ุ ููุฏ ููุชุจ ุงููุซูุฑ ุจุงููุนู ุญูู ูุฐุง ุงูููุถูุน ูุฏุฑุฌุฉ ุฃูู ูุง ูููููู ุฅุถุงูุฉ ุฃู ุดูุก ุฌุฏูุฏ ุ ููู ุฌูุงู ุงูุตูุฑุฉ ุงููุงููุฉ ูุชุทูุจ ุงูุชุถุญูุฉ.  ูุฐูู ุงูุญูุงุธ ุนูู ุงูุตุจุฑ. <br><br><h1 style=";text-align:right;direction:rtl">  ูุฑุงุบ </h1><br><h2 style=";text-align:right;direction:rtl">  ูุงุฐุง ูุฑุงุบ ุชูุนูุ </h2><br>  ูุนูู ุงููุฑุงุบ ุงูููุฌูุฏ ูู ุงูุตูุญุฉ ุจุณุฑุนุฉ ุ ููููู ูุญุฑุฑ ุฌุฒุกูุง ููุท ูู ุงููุณุงุญุฉ.  ุชุนูู ุถูู ุตูุญุฉ ุฌุฏูู ูุงุญุฏ ููุง ุชููุณ ุงูููุงุฑุณ. <br><br>  ูุชู ุงููุฑุงุบ "ุงูุนุงุฏู" ุงูุฃุณุงุณู ุจุงุณุชุฎุฏุงู ุฃูุฑ VACUUM ุ ูุณูุณูููุง "ูุฑุงุบ" ููุท (ูุน ุชุฑู "ูุฑุงุบ ุชููุงุฆู" ูููุงูุดุฉ ูููุตูุฉ). <br><br>  ูุฐูู ุ ูุฑุงุบ ูุนุงูุฌ ุงูุฌุฏูู ุจุฃูููู.  ุฅูู ูุง ูุฎุชูู ููุท tuples ุงูููุชุฉ ุ ูููู ุฃูุถูุง ูุดูุฑ ุฅูููู ูู ุฌููุน ุงูููุงุฑุณ. <br><br>  ุงููุฑุงุบ ูุชุฒุงูู ูุน ุงูุฃูุดุทุฉ ุงูุฃุฎุฑู ูู ุงููุธุงู.  ูููู ุงุณุชุฎุฏุงู ุงูุฌุฏูู ูุงูููุงุฑุณ ุจุทุฑููุฉ ููุชุธูุฉ ููู ูู ุงููุฑุงุกุงุช ูุงูุชุญุฏูุซุงุช (ููุน ุฐูู ุ ูุฅู ุงูุชูููุฐ ุงููุชุฒุงูู ูุฃูุงูุฑ ูุซู CREATE INDEX ู ALTER TABLE ูุจุนุถูุง ุงูุขุฎุฑ ูุณุชุญูู). <br><br>  ูุชู ูุญุต ุตูุญุงุช ุงูุฌุฏูู ุชูู ููุท ูู ุฎูุงู ุงูููุงู ุงูุฐู ุชูุช ููู ุจุนุถ ุงูุฃูุดุทุฉ.  ูุงูุชุดุงููู ุ ูุชู ุงุณุชุฎุฏุงู <em>ุฎุฑูุทุฉ ุงูุฑุคูุฉ</em> (ูุชุฐููุฑู ุ ุชููู ุงูุฎุฑูุทุฉ ุจุชุชุจุน ุงูุตูุญุงุช ุงูุชู ุชุญุชูู ุนูู tuples ุงููุฏููุฉ ุ ูุงูุชู ุชููู ูุฑุฆูุฉ ูู ุฌููุน ููุทุงุช ุงูุจูุงูุงุช ุจุงูุชุฃููุฏ).  ุชุชู ูุนุงูุฌุฉ ุชูู ุงูุตูุญุงุช ููุท ุงูุชู ูุง ูุชู ุชุนูุจูุง ุจูุงุณุทุฉ ุฎุฑูุทุฉ ุงูุฑุคูุฉ ุ ููุชู ุชุญุฏูุซ ุงูุฎุฑูุทุฉ ููุณูุง. <br><br>  ูุชู ุชุญุฏูุซ <em>ุฎุฑูุทุฉ ุงููุณุงุญุฉ ุงูุญุฑุฉ</em> ุฃูุถูุง ูู ูุฐู ุงูุนูููุฉ ูุชุนูุณ ุงููุณุงุญุฉ ุงูุญุฑุฉ ุงูุฅุถุงููุฉ ูู ุงูุตูุญุงุช. <br><a name="habracut"></a><br>  ูุงูุนุงุฏุฉ ุ ูููู ุจุฅูุดุงุก ุฌุฏูู: <br><br><pre style=";text-align:right;direction:rtl"><code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> vac( id <span class="hljs-type"><span class="hljs-type">serial</span></span>, s <span class="hljs-type"><span class="hljs-type">char</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> (autovacuum_enabled = <span class="hljs-keyword"><span class="hljs-keyword">off</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> vac_s <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> vac(s); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> vac(s) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-string"><span class="hljs-string">'A'</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> vac <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> s = <span class="hljs-string"><span class="hljs-string">'B'</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> vac <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> s = <span class="hljs-string"><span class="hljs-string">'C'</span></span>;</code> </pre> <br>  ูุญู ูุณุชุฎุฏู ุงููุนููุฉ <em>autov Vacuum_enabled</em> ูุฅููุงู ุชุดุบูู ุนูููุฉ autov Vacuum.  ุณููุงูุดูุง ูู ุงููุฑุฉ ุงููุงุฏูุฉ ุ ูุงูุขู ูู ุงูุฃูููุฉ ุจููุงู ุจุงููุณุจุฉ ูุชุฌุงุฑุจูุง ุฃู ูุชุญูู ูุฏูููุง ูู ุงูุชูุฑูุบ. <br><br>  ูุญุชูู ุงูุฌุฏูู ุงูุขู ุนูู ุซูุงุซุฉ ุตููู ุ ูุชู ุงูุฅุดุงุฑุฉ ุฅูู ูู ูููุง ูู ุงูููุฑุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> heap_page(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ctid | state | xmin | xmax | hhu | hot | t_ctid -------+--------+----------+----------+-----+-----+-------- (0,1) | normal | 4000 (c) | 4001 (c) | | | (0,2) (0,2) | normal | 4001 (c) | 4002 | | | (0,3) (0,3) | normal | 4002 | 0 (a) | | | (0,3) (3 rows)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> index_page(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> itemoffset | ctid ------------+------- 1 | (0,1) 2 | (0,2) 3 | (0,3) (3 rows)</code> </pre><br>  ุจุนุฏ ุงูุชูุธูู ุจุงููููุณุฉ ุงูููุฑุจุงุฆูุฉ ุ ูุชู ุฅุฒุงูุฉ ุงููุฑุงุบุงุช ุงูููุชุฉ ุ ููุจูู ูุงุญุฏ ููุท ูุนูุด.  ููุจูู ูุฑุฌุน ูุงุญุฏ ููุท ูู ุงูููุฑุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> vac; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> heap_page(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ctid | state | xmin | xmax | hhu | hot | t_ctid -------+--------+----------+-------+-----+-----+-------- (0,1) | unused | | | | | (0,2) | unused | | | | | (0,3) | normal | 4002 (c) | 0 (a) | | | (0,3) (3 rows)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> index_page(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> itemoffset | ctid ------------+------- 1 | (0,3) (1 row)</code> </pre><br>  ูุงุญุธ ุฃู ุฃูู ูุคุดุฑูู ุญุตูุง ุนูู ุงูุญุงูุฉ "ุบูุฑ ุงููุณุชุฎุฏูุฉ" ุจุฏูุงู ูู "ุงูููุช" ุ ูุงูุชู ุณูู ููุชุณุจูุง ูุน ุงููุฑุงุบ ูู ุงูุตูุญุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุญูู ุฃูู ุงูุตููุฉ ูุฑุฉ ุฃุฎุฑู </h2><br>  ููู ูููู ุจุฑูุงูุฌ PostgreSQL ุจุชุญุฏูุฏ ุฃู ุงูุชูุงููุฐ ูููู ุงุนุชุจุงุฑูู ููุชููุ  ููุฏ ุชุทุฑููุง ุจุงููุนู ุฅูู ููููู ุฃูู ุงููุนุงููุงุช ุนูุฏ ููุงูุดุฉ <a href="https://habr.com/ru/company/postgrespro/blog/479512/">ููุทุงุช ุงูุจูุงูุงุช</a> ุ ูููู ูู ูุถุฑ ุชูุฑุงุฑ ูุซู ูุฐู ุงููุณุฃูุฉ ุงููุงูุฉ. <br><br>  ููุจุฏุฃ ุงูุชุฌุฑุจุฉ ุงูุณุงุจูุฉ ูุฑุฉ ุฃุฎุฑู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">TRUNCATE</span></span> vac; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> vac(s) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-string"><span class="hljs-string">'A'</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> vac <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> s = <span class="hljs-string"><span class="hljs-string">'B'</span></span>;</code> </pre><br>  ูููู ูุจู ุชุญุฏูุซ ุงูุตู ูุฑุฉ ุฃุฎุฑู ุ ุฏุน ุนูููุฉ ูุงุญุฏุฉ ุฃุฎุฑู ุชุจุฏุฃ (ููู ูุง ุชูุชูู).  ูู ูุฐุง ุงููุซุงู ุ ุณูู ูุณุชุฎุฏู ูุณุชูู "ูุฑุงุกุฉ ููุชุฒู" ุ ููู ูุฌุจ ุฃู ูุญุตู ุนูู ุฑูู ูุนุงููุฉ ุญูููู (ุบูุฑ ุงูุชุฑุงุถู).  ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุฃู ุชุชุบูุฑ ุงููุนุงููุฉ ุจู ูุชุบูู ุตููููุง ูุนููุฉ ูู ุฃู ุฌุฏูู ุ ูููุณ ุฅุฌุจุงุฑููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> t <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| s | ----- | FOO | BAR | (2 rows)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> vac <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> s = <span class="hljs-string"><span class="hljs-string">'C'</span></span>;</code> </pre><br>  ููุงู ุซูุงุซุฉ ุตููู ูู ุงูุฌุฏูู ูุซูุงุซุฉ ูุฑุงุฌุน ูู ุงูููุฑุณ ุงูุขู.  ูุงุฐุง ุณูุญุฏุซ ุจุนุฏ ููุณุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> vac; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> heap_page(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ctid | state | xmin | xmax | hhu | hot | t_ctid -------+--------+----------+----------+-----+-----+-------- (0,1) | unused | | | | | (0,2) | normal | 4005 (c) | 4007 (c) | | | (0,3) (0,3) | normal | 4007 (c) | 0 (a) | | | (0,3) (3 rows)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> index_page(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> itemoffset | ctid ------------+------- 1 | (0,2) 2 | (0,3) (2 rows)</code> </pre><br>  ุชุจูู ุชูุงุจูุชุงู ูู ุงูุฌุฏูู: ูุฑุฑุช VACUUM ุฃู ุงููุฑุงุบ (0ุ2) ูุง ูููู ุชูุฑูุบู ุจุนุฏ.  ุงูุณุจุจ ูู ุจุงูุชุฃููุฏ ูู ุฃูู ุงููุนุงููุงุช ููุงุนุฏุฉ ุงูุจูุงูุงุช ุ ูุงูุชู ูุชู ุชุญุฏูุฏูุง ูู ูุฐุง ุงููุซุงู ุจุงููุนุงููุฉ ุบูุฑ ุงูููุชููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> backend_xmin <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| backend_xmin | -------------- | 4006 | (1 row)</code> </pre><br>  ูููููุง ุฃู ูุณุฃู VACUUM ููุฅุจูุงุบ ุนูุง ูุญุฏุซ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VERBOSE</span></span> vac;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INFO: vacuuming "public.vac" INFO: index "vac_s" now contains 2 row versions in 2 pages DETAIL: 0 index row versions were removed. 0 index pages have been deleted, 0 are currently reusable. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. INFO: "vac": found 0 removable, 2 nonremovable row versions in 1 out of 1 pages DETAIL: 1 dead row versions cannot be removed yet, oldest xmin: 4006 There were 1 unused item pointers. Skipped 0 pages due to buffer pins, 0 frozen pages. 0 pages are entirely empty. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. VACUUM</code> </pre><br>  ูุงุญุธ ุฃู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>2 nonremovable row versions</code> ูู ุงูุตููู ุบูุฑ ุงููุงุจูุฉ <code>2 nonremovable row versions</code> - ูููุง ุงูุฌุฏููุงู ูุง ูููู ุญุฐูููุง ูู ุงูุฌุฏูู. </li><li style=";text-align:right;direction:rtl">  <code>1 dead row versions cannot be removed yet</code> ูุงุญุฏ ูู <code>1 dead row versions cannot be removed yet</code> - ุฃุญุฏูุง ููุช. </li><li style=";text-align:right;direction:rtl">  <code>oldest xmin</code> ูุธูุฑ ุงูุฃูู ุงูุญุงูู. </li></ul><br>  ุฏุนูุง ููุฑุฑ ุงูุงุณุชูุชุงุฌ: ุฅุฐุง ูุงูุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุชุญุชูู ุนูู ูุนุงููุงุช ุทูููุฉ ุงูุฃูุฏ (ูู ุชูุชูู ุฃู ูุฌุฑู ุชูููุฐูุง ุทููููุง ุจุงููุนู) ุ ููุฏ ูุณุชูุฒู ุฐูู ุงุฒุฏูุงุฑูุง ูู ุงูุฌุฏูู ุจุบุถ ุงููุธุฑ ุนู ุนุฏุฏ ูุฑุงุช ุญุฏูุซ ููุณ.  ูุฐูู ุ ุชุชุนุงูุด ุฃุญูุงู ุงูุนูู ูู ููุน OLTP- ู OLAP ุจุดูู ุณูุก ูู ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL ูุงุญุฏุฉ: ูู ุชุณูุญ ุงูุชูุงุฑูุฑ ุงูุชู ูุชู ุชุดุบูููุง ูุณุงุนุงุช ุจุงูุชุตุงุต ุงูุฌุฏุงูู ุงููุญุฏุซุฉ ุนูู ุงููุญู ุงููุงุฌุจ.  ูุฏ ูููู ุฅูุดุงุก ูุณุฎุฉ ูุชูุงุซูุฉ ูููุตูุฉ ูุฃุบุฑุงุถ ุฅุนุฏุงุฏ ุงูุชูุงุฑูุฑ ุญูุงู ูููููุง ูุฐูู. <br><br>  ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุตููุฉ ุงูููุชูุญุฉ ุ ูุชุญุฑู ุงูุฃูู ุ ููุชู ุฅุตูุงุญ ุงููููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VERBOSE</span></span> vac;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INFO: vacuuming "public.vac" INFO: scanned index "vac_s" to remove 1 row versions DETAIL: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s INFO: "vac": removed 1 row versions in 1 pages DETAIL: CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s INFO: index "vac_s" now contains 1 row versions in 2 pages DETAIL: 1 index row versions were removed. 0 index pages have been deleted, 0 are currently reusable. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. INFO: "vac": found 1 removable, 1 nonremovable row versions in 1 out of 1 pages DETAIL: 0 dead row versions cannot be removed yet, oldest xmin: 4008 There were 1 unused item pointers. Skipped 0 pages due to buffer pins, 0 frozen pages. 0 pages are entirely empty. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. VACUUM</code> </pre><br>  ุงูุขู ููุท ุ ูุณุฎุฉ ุญูุฉ ุ ูุชู ุชุฑู ูุณุฎุฉ ูู ุงูุตู ูู ุงูุตูุญุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> heap_page(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> ctid | state | xmin | xmax | hhu | hot | t_ctid -------+--------+----------+-------+-----+-----+-------- (0,1) | unused | | | | | (0,2) | unused | | | | | (0,3) | normal | 4007 (c) | 0 (a) | | | (0,3) (3 rows)</code> </pre><br>  ูุญุชูู ุงูููุฑุณ ุฃูุถูุง ุนูู ุตู ูุงุญุฏ ููุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> index_page(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> itemoffset | ctid ------------+------- 1 | (0,3) (1 row)</code> </pre><br><h2 style=";text-align:right;direction:rtl">  ูุงุฐุง ูุญุฏุซ ูู ุงูุฏุงุฎูุ </h2><br>  ูุฌุจ ุฃู ูููู ุงููุฑุงุบ ุจูุนุงูุฌุฉ ุงูุฌุฏูู ูุงูููุงุฑุณ ูู ููุณ ุงูููุช ูุงูููุงู ุจุฐูู ุญุชู ูุง ูุชู ููู ุงูุนูููุงุช ุงูุฃุฎุฑู.  ููู ูููู ุฃู ุชูุนู ุฐููุ <br><br>  ูู ุดูุก ูุจุฏุฃ ูุน ูุฑุญูุฉ <strong>ูููุฉ ุงููุณุญ</strong> (ุฎุฑูุทุฉ ุงูุฑุคูุฉ ุชุคุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุ ููุง ุฐูุฑ ุจุงููุนู).  ูู ุงูุตูุญุงุช ุงูููุฑูุกุฉ ุ ูุชู ุงููุดู ุนู tuples ุงูููุชุฉ ุ ููุชู ุชุฏููู <code>tid</code> ุฅูู ูุฌููุนุฉ ูุชุฎุตุตุฉ.  ูุชู ุชุฎุฒูู ุงูุตููู ูู ุงูุฐุงูุฑุฉ ุงููุญููุฉ ูุนูููุฉ ูุฑุงุบ ุ ุญูุซ ูุชู ุชุฎุตูุต ุจุงูุช <em>maintenance_work_mem</em> ูู ุงูุฐุงูุฑุฉ ูุฐูู.  ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ ููุฐู ุงููุนููุฉ ูู 64 ููุบุงุจุงูุช.  ูุงุญุธ ุฃูู ูุชู ุชุฎุตูุต ูุงูู ุญุฌู ุงูุฐุงูุฑุฉ ูุฑุฉ ูุงุญุฏุฉ ุ ุจุฏูุงู ูู ุงูุญุงุฌุฉ.  ููุน ุฐูู ุ ุฅุฐุง ูู ููู ุงูุฌุฏูู ูุจูุฑูุง ุ ูุชู ุชุฎุตูุต ูููุฉ ุฃูู ูู ุงูุฐุงูุฑุฉ. <br><br>  ุซู ูุตู ุฅูู ููุงูุฉ ุงูุฌุฏูู ุฃู ุงูุชูุช ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ููุตููู.  ูู ููุชุง ุงูุญุงูุชูู ุ ุชุจุฏุฃ ูุฑุญูุฉ <strong>ููุงุฑุณ ุงูููุณ</strong> .  ุชุญููููุง ููุฐู ุงูุบุงูุฉ ุ <em>ูุชู ูุญุต</em> <em>ูู</em> ููุฑุณ ุชู ุฅูุดุงุคู ุนูู ุงูุฌุฏูู <em>ุจุดูู ูุงูู ุจุญุซูุง</em> ุนู ุงูุตููู ุงูุชู ุชุดูุฑ ุฅูู ุงูุชูุงููุฐ ุงูุฐูู ุชู ุชุฐูุฑูู.  ูุชู ุชูุธูู ุงูุตููู ุงูููุฌูุฏุฉ ุจุนูุฏูุง ุนู ุตูุญุงุช ุงูููุฑุณ. <br><br>  ูุญู ููุง ููุงุฌู ูุง ููู: ูุง ุชุญุชูู ุงูููุงุฑุณ ุจุงููุนู ุนูู ุฅุดุงุฑุงุช ุฅูู tuples ุ ุจูููุง ูุง ูุฒุงู ุงูุฌุฏูู ุจูุง.  ููุฐุง ูุง ูุชุนุงุฑุถ ูุน ุฃู ุดูุก: ุนูุฏ ุชูููุฐ ุทูุจ ุงูุจุญุซ ุ ูุฅููุง ูุง ูุถุฑุจ ุงูุชูุงููุฐ ุงููุชูู (ูุน ุฅููุงููุฉ ุงููุตูู ุฅูู ุงูููุฑุณ) ุฃู ูุฑูุถูู ุนูุฏ ูุญุต ุงูุฑุคูุฉ (ุนูุฏ ูุณุญ ุงูุฌุฏูู). <br><br>  ุจุนุฏ ุฐูู ุ ุชุจุฏุฃ ุงููุฑุญูุฉ <strong>ูููุฉ ููุณ</strong> .  ูุชู ูุญุต ุงูุฌุฏูู ูุฑุฉ ุฃุฎุฑู ููุฑุงุกุฉ ุงูุตูุญุงุช ุงูููุงุณุจุฉ ุ ูุฅูุฑุงุบูุง ูู ุงูุชูุงููุฐ ุงูุฐูู ุชู ุชุฐูุฑูู ูุฅุทูุงู ุงููุคุดุฑุงุช.  ูููููุง ุงูููุงู ุจุฐูู ูุธุฑูุง ูุนุฏู ูุฌูุฏ ูุฑุงุฌุน ูู ุงูููุงุฑุณ ุจุนุฏ ุงูุขู. <br><br>  ุฅุฐุง ูู ูุชู ูุฑุงุกุฉ ุงูุฌุฏูู ุจุงููุงูู ุฎูุงู ุงูุฏูุฑุฉ ุงูุฃููู ุ ูุณูุชู ูุณุญ ุงูุตููู ููุชูุฑุฑ ูู ุดูุก ูู ุญูุซ ูุตููุง. <br><br>  ุจุงุฎุชุตุงุฑ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชู ุฏุงุฆูุง ูุณุญ ุงูุฌุฏูู ูุฑุชูู. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ุงููุฑุงุบ ูุญุฐู ุนุฏุฏูุง ูุจูุฑูุง ูู ุงููุฌููุนุงุช ุงูุชู ูุง ุชูุงุณุจูุง ุฌููุนูุง ูู ุฐุงูุฑุฉ <em>maintenance_work_mem</em> ุจุงูุญุฌู ุ ูุณูุชู ูุณุญ ุฌููุน ุงูููุงุฑุณ ุนุฏุฉ ูุฑุงุช ุญุณุจ ุงูุญุงุฌุฉ. </li></ul><br>  ุจุงููุณุจุฉ ููุฌุฏุงูู ุงููุจูุฑุฉ ุ ูุฏ ูุชุทูุจ ุฐูู ุงููุซูุฑ ูู ุงูููุช ูุฅุถุงูุฉ ุนุจุก ุนูู ูุจูุฑ ุนูู ุงููุธุงู.  ุจุงูุทุจุน ุ ูู ูุชู ุชุฃููู ุงูุงุณุชุนูุงูุงุช ุ ููู ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ ุงูุฅุถุงูู ุฃูุฑ ุบูุฑ ูุฑุบูุจ ููู ุจุงูุชุฃููุฏ. <br><br>  ูุชุณุฑูุน ุงูุนูููุฉ ุ ูู ุงูููุทูู ุฅูุง ุงุณุชุฏุนุงุก VACUUM ูู ูุซูุฑ ูู ุงูุฃุญูุงู (ุจุญูุซ ูุง ูุชู ุชูุฑูุบ ุงููุซูุฑ ูู ุงููุฌููุนุงุช ูู ูู ูุฑุฉ) ุฃู ุชุฎุตูุต ุงููุฒูุฏ ูู ุงูุฐุงูุฑุฉ. <br><br>  ูููุงุญุธุฉ ุงูุฃููุงุณ ุ ุจุฏุกูุง ูู ุงูุฅุตุฏุงุฑ 11 ุ <a href="https://git.postgresql.org/gitweb/%3Fp%3Dpostgresql.git%3Ba%3Dcommit%3Bh%3D857f9c36cda520030381bd8c2af20adf0ce0e1d4">ูููู ูู</a> PostgreSQL <a href="https://git.postgresql.org/gitweb/%3Fp%3Dpostgresql.git%3Ba%3Dcommit%3Bh%3D857f9c36cda520030381bd8c2af20adf0ce0e1d4">ุชุฎุทู ุนูููุงุช ูุณุญ ุงูููุฑุณุฉ</a> ูุง ูู ุชูู ููุงู ุญุงุฌุฉ ููุญุฉ.  ูุฐุง ูุฌุจ ุฃู ูุฌุนู ุงูุญูุงุฉ ุฃุณูู ูุฃุตุญุงุจ ุงูุฌุฏุงูู ุงููุจูุฑุฉ ุญูุซ ูุชู ุฅุถุงูุฉ ุตููู ููุท (ูููู ูุง ุชุชุบูุฑ). <br><br><h2 style=";text-align:right;direction:rtl">  ูุฑุงูุจุฉ </h2><br>  ููู ูููููุง ูุนุฑูุฉ ุฃู VACUUM ูุง ูููููุง ุงูููุงู ุจุนูููุง ูู ุฏูุฑุฉ ูุงุญุฏุฉุ <br><br>  ููุฏ ุฑุฃููุง ุจุงููุนู ุงูุทุฑููุฉ ุงูุฃููู: ููุงุชุตุงู ุจุฃูุฑ VACUUM ุจุงุณุชุฎุฏุงู ุฎูุงุฑ VERBOSE.  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุชู ุฅุฎุฑุงุฌ ุงููุนูููุงุช ุญูู ูุฑุงุญู ุงูุนูููุฉ ุฅูู ูุญุฏุฉ ุงูุชุญูู. <br><br>  ุซุงูููุง ุ ุจุฏุกูุง ูู ุงูุฅุตุฏุงุฑ 9.6 ุ <code>pg_stat_progress_vacuum</code> ุนุฑุถ <code>pg_stat_progress_vacuum</code> ุ ูุงูุฐู ูููุฑ ุฃูุถูุง ูุงูุฉ ุงููุนูููุงุช ุงููุงุฒูุฉ. <br><br>  (ุชุชููุฑ ุงูุทุฑููุฉ ุงูุซุงูุซุฉ ุฃูุถูุง: ูุฅุฎุฑุงุฌ ุงููุนูููุงุช ุฅูู ุณุฌู ุงูุฑุณุงุฆู ุ ูููู ูุฐุง ูุนูู ููุท ูุน ูุฑุงุบ ุชููุงุฆู ุ ูุงูุฐู ุณูุชู ููุงูุดุชู ูู ุงููุฑุฉ ุงููุงุฏูุฉ.) <br><br>  ูููู ุจุฅุฏุฑุงุฌ ุจุถุนุฉ ุตููู ูู ุงูุฌุฏูู ุ ููู ุชุณุชูุฑ ุนูููุฉ ุงูุชูุฑูุบ ููุชุฑุฉ ุทูููุฉ ุ ููููู ุจุชุญุฏูุซูุง ุฌููุนูุง ุ ุญุชู ุชุญุตู VACUUM ุนูู ุฃุดูุงุก ููููุงู ุจูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">TRUNCATE</span></span> vac; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> vac(s) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-string"><span class="hljs-string">'A'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">500000</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> vac <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> s = <span class="hljs-string"><span class="hljs-string">'B'</span></span>;</code> </pre><br>  ูููู ุญุฌู ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ููุฌููุนุฉ ุงููุนุฑูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ALTER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SYSTEM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> maintenance_work_mem = <span class="hljs-string"><span class="hljs-string">'1MB'</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_reload_conf();</code> </pre><br>  ููุจุฏุฃ ุชุดุบูู VACUUM ูุฃุซูุงุก ุงูุนูู ุ ุฏุนูุง <code>pg_stat_progress_vacuum</code> ุนุฑุถ <code>pg_stat_progress_vacuum</code> ุนุฏุฉ ูุฑุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VERBOSE</span></span> vac;</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_progress_vacuum \gx</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| -[ RECORD 1 ]------+------------------ | pid | 6715 | datid | 41493 | datname | test | relid | 57383 | phase | vacuuming indexes | heap_blks_total | 16667 | heap_blks_scanned | 2908 | heap_blks_vacuumed | 0 | index_vacuum_count | 0 | max_dead_tuples | 174762 | num_dead_tuples | 174480</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_progress_vacuum \gx</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| -[ RECORD 1 ]------+------------------ | pid | 6715 | datid | 41493 | datname | test | relid | 57383 | phase | vacuuming indexes | heap_blks_total | 16667 | heap_blks_scanned | 5816 | heap_blks_vacuumed | 2907 | index_vacuum_count | 1 | max_dead_tuples | 174762 | num_dead_tuples | 174480</code> </pre><br>  ููุง ูููููุง ุฃู ูุฑู ุ ุนูู ูุฌู ุงูุฎุตูุต: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงุณู ุงููุฑุญูุฉ ุงูุญุงููุฉ - ูุงูุดูุง ุซูุงุซ ูุฑุงุญู ุฑุฆูุณูุฉ ุ ูููู ููุงู <a href="https://postgrespro.com/docs/postgresql/11/progress-reporting">ุงููุซูุฑ</a> ูููุง ุจุดูู ุนุงู. </li><li style=";text-align:right;direction:rtl">  ุฅุฌูุงูู ุนุฏุฏ ุตูุญุงุช ุงูุฌุฏูู ( <code>heap_blks_total</code> ). </li><li style=";text-align:right;direction:rtl">  ุนุฏุฏ ุงูุตูุญุงุช ุงูููุณูุญุฉ ุถูุฆููุง ( <code>heap_blks_scanned</code> ). </li><li style=";text-align:right;direction:rtl">  ุนุฏุฏ ุงูุตูุญุงุช <code>heap_blks_vacuumed</code> ุจุงููุนู ( <code>heap_blks_vacuumed</code> ). </li><li style=";text-align:right;direction:rtl">  ุนุฏุฏ ุฏูุฑุงุช ูุฑุงุบ ุงูููุฑุณ ( <code>index_vacuum_count</code> ). </li></ul><br>  ูุชู ุชุญุฏูุฏ ุงูุชูุฏู ุงูุนุงู ูู ุฎูุงู ูุณุจุฉ <code>heap_blks_vacuumed</code> ุฅูู <code>heap_blks_total</code> ุ ูููู ูุฌุจ ุฃู ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุฃู ูุฐู ุงููููุฉ ุชุชุบูุฑ ูู ุงูุฒูุงุฏุงุช ุงููุจูุฑุฉ ุจุฏูุงู ูู ุงูุณูุงุณุฉ ุจุณุจุจ ูุณุญ ุงูููุงุฑุณ.  ููุน ุฐูู ุ ููุจุบู ุฅููุงุก ุงูุงูุชูุงู ุงูุฑุฆูุณู ูุนุฏุฏ ุฏูุฑุงุช ุงููุฑุงุบ: ูุงูุนุฏุฏ ุงูุฃูุจุฑ ูู 1 ูุนูู ุฃู ุงูุฐุงูุฑุฉ ุงููุฎุตุตุฉ ูู ุชูู ูุงููุฉ ูุฅููุงู ุงููุฑุงุบ ูู ุฏูุฑุฉ ูุงุญุฏุฉ. <br><br>  ููุธูุฑ ุฅุฎุฑุงุฌ ุฃูุฑ VACUUM VERBOSE ุ ุงูุฐู ุชู ุฅููุงูู ุจุงููุนู ุจุญููู ุฐูู ุงูููุช ุ ุงูุตูุฑุฉ ุงูุนุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INFO: vacuuming "public.vac"</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INFO: scanned index "vac_s" to remove 174480 row versions DETAIL: CPU: user: 0.50 s, system: 0.07 s, elapsed: 1.36 s INFO: "vac": removed 174480 row versions in 2908 pages DETAIL: CPU: user: 0.02 s, system: 0.02 s, elapsed: 0.13 s</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INFO: scanned index "vac_s" to remove 174480 row versions DETAIL: CPU: user: 0.26 s, system: 0.07 s, elapsed: 0.81 s INFO: "vac": removed 174480 row versions in 2908 pages DETAIL: CPU: user: 0.01 s, system: 0.02 s, elapsed: 0.10 s</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INFO: scanned index "vac_s" to remove 151040 row versions DETAIL: CPU: user: 0.13 s, system: 0.04 s, elapsed: 0.47 s INFO: "vac": removed 151040 row versions in 2518 pages DETAIL: CPU: user: 0.01 s, system: 0.02 s, elapsed: 0.08 s</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">INFO: index "vac_s" now contains 500000 row versions in 17821 pages DETAIL: 500000 index row versions were removed. 8778 index pages have been deleted, 0 are currently reusable. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. INFO: "vac": found 500000 removable, 500000 nonremovable row versions in 16667 out of 16667 pages DETAIL: 0 dead row versions cannot be removed yet, oldest xmin: 4011 There were 0 unused item pointers. 0 pages are entirely empty. CPU: user: 1.10 s, system: 0.37 s, elapsed: 3.71 s. VACUUM</code> </pre><br>  ูููููุง ุฃู ูุฑู ููุง ุฃูู ูุฏ ุชู ุฅุฌุฑุงุก ุซูุงุซ ุฏูุฑุงุช ุนูู ุงูููุงุฑุณ ุ ููู ูู ุฏูุฑุฉ ุ ุชู ุชูุฑูุบ 174480 ูู ุงููุคุดุฑุงุช ุฅูู ุงููุฌููุนุงุช ุงูููุชุฉ.  ููุงุฐุง ุจุงูุถุจุท ูุฐุง ุงูุฑููุ  ูุดุบู ูุงุญุฏ <code>tid</code> 6 ุจุงูุช ุ ู 1024 * 1024/6 = 174762 ุ ููู ุงูุฑูู ุงูุฐู ูุฑุงู ูู <code>pg_stat_progress_vacuum.max_dead_tuples</code> .  ูู ุงููุงูุน ุ ูุฏ ูุชู ุงุณุชุฎุฏุงู ุฃูู ูู ุฐูู ุจูููู: ููุฐุง ูุถูู ุฃูู ุนูุฏ ูุฑุงุกุฉ ุงูุตูุญุฉ ุงูุชุงููุฉ ุ ูุฅู ุฌููุน ุงููุคุดุฑุงุช ุฅูู tuples tattles ุณูู ุชูุถุน ูู ุงูุฐุงูุฑุฉ ุจุงูุชุฃููุฏ. <br><br><h2 style=";text-align:right;direction:rtl">  ุชุญููู </h2><br>  ุงูุชุญููู ุ ุฃู ุจุนุจุงุฑุฉ ุฃุฎุฑู ุ ุฌูุน ุงูุฅุญุตุงุฆูุงุช ููุฎุทุท ุงูุงุณุชุนูุงู ุ ูุง ุนูุงูุฉ ูู ุฑุณูููุง ุจุงููููุณุฉ ุงูููุฑุจุงุฆูุฉ ุนูู ุงูุฅุทูุงู.  ููุน ุฐูู ุ ูููููุง ุฅุฌุฑุงุก ุงูุชุญููู ููุณ ููุท ุจุงุณุชุฎุฏุงู ุฃูุฑ ANALYZE ุ ูููู ูุฌูุน ุจูู ุงูุชูุธูู ูุงูุชุญููู ูู ูุฑุงุบ ุชุญููู.  ููุง ูุชู ุงููุฑุงุบ ุฃููุงู ุซู ุงูุชุญููู ุ ูุฐูู ูุฐุง ูุง ูุนุทู ุฃู ููุงุณุจ. <br><br>  ูููู ููุง ุณูุฑู ูุงุญููุง ุ ูุชู ุฅุฌุฑุงุก ุงููุญุต ุงูุชููุงุฆู ูุงูุชุญููู ุงูุชููุงุฆู ูู ุนูููุฉ ูุงุญุฏุฉ ููุชู ุงูุชุญูู ูููุง ุจุทุฑููุฉ ููุงุซูุฉ. <br><br><h1 style=";text-align:right;direction:rtl">  ูุฑุงุบ ูุงูู </h1><br>  ููุง ูู ูุฐููุฑ ุฃุนูุงู ุ ูุญุฑุฑ ุงููุฑุงุบ ูุณุงุญุฉ ุฃูุจุฑ ูู ุงููุฑุงุบ ุงูููุฌูุฏ ูู ุงูุตูุญุฉ ุ ูููู ูุง ูุญู ุงููุดููุฉ ุชูุงููุง. <br><br>  ุฅุฐุง ุฒุงุฏ ุญุฌู ุงูุฌุฏูู ุฃู ุงูููุฑุณ ูุซูุฑูุง ูุฃุณุจุงุจ ุ ูุณูููุฑ VACUUM ูุณุงุญุฉ ุฏุงุฎู ุงูุตูุญุงุช ุงูุญุงููุฉ: "ุงูุซููุจ" ุณุชุญุฏุซ ููุงู ุ ูุงูุชู ุณูุชู ุงุณุชุฎุฏุงููุง ุจุนุฏ ุฐูู ูุฅุฏุฑุงุฌ ูุฌููุนุงุช ุฌุฏูุฏุฉ.  ููู ุนุฏุฏ ุงูุตูุญุงุช ูู ูุชุบูุฑ ุ ูุจุงูุชุงูู ุ ูู ูุฌูุฉ ูุธุฑ ูุธุงู ุงูุชุดุบูู ุ ุณุชุดุบู ุงููููุงุช ููุณ ุงููุณุงุญุฉ ุชูุงููุง ููุง ูุงูุช ุนููู ูุจู ุงููุฑุงุบ.  ููุฐุง ููุณ ุฌูุฏูุง ููุฃุณุจุงุจ ุงูุชุงููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุญุต ุงููุงูู ููุฌุฏูู (ุฃู ุงูููุฑุณ) ูุจุทุฆ. </li><li style=";text-align:right;direction:rtl">  ูุฏ ุชููู ููุงู ุญุงุฌุฉ ุฅูู ุฐุงูุฑุฉ ุชุฎุฒูู ูุคูุช ุฃูุจุฑ (ูุธุฑูุง ูุฃููุง ุงูุตูุญุงุช ุงููุฎุฒูุฉ ููุงู ูุชูุงูุต ูุซุงูุฉ ุงููุนูููุงุช ุงููููุฏุฉ). </li><li style=";text-align:right;direction:rtl">  ูู ุดุฌุฑุฉ ุงูููุฑุณ ุ ูููู ุฃู ูุญุฏุซ ูุณุชูู ุฅุถุงูู ุ ููุง ุณูุคุฏู ุฅูู ุฅุจุทุงุก ุงููุตูู ุฅูู ุงูููุฑุณ. </li><li style=";text-align:right;direction:rtl">  ุชุดุบู ุงููููุงุช ูุณุงุญุฉ ุฅุถุงููุฉ ุนูู ุงููุฑุต ููู ูุณุฎ ุงุญุชูุงุทูุฉ. </li></ul><br>  (ุงูุงุณุชุซูุงุก ุงููุญูุฏ ูู ุงูุตูุญุงุช ุฐุงุช ุงููุฑุงุบ ุงููุงูู ุ ุงูููุฌูุฏุฉ ูู ููุงูุฉ ุงูููู. ูุชู ูุทุน ูุฐู ุงูุตูุญุงุช ูู ุงูููู ูุฅุนุงุฏุชูุง ุฅูู ูุธุงู ุงูุชุดุบูู.) <br><br>  ุฅุฐุง ูุงูุช ูุดุงุฑูุฉ ุงููุนูููุงุช ุงููููุฏุฉ ูู ุงููููุงุช ุฃูู ูู ุญุฏ ูุนููู ุ ููููู ูููุณุคูู ุชูููุฐ VACUUM FULL ูู ุงูุฌุฏูู.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุชู ุฅุนุงุฏุฉ ุจูุงุก ุงูุฌุฏูู ูุฌููุน ููุงุฑุณู ูู ููุทุฉ ุงูุตูุฑ ููุชู ุชุนุจุฆุฉ ุงูุจูุงูุงุช ุจุทุฑููุฉ ูุถุบูุทุฉ ูู ุงูุบุงูุจ (ุจุงูุทุจุน ุ ูุนููุฉ <code>fillfactor</code> ุชุคุฎุฐ ูู ุงูุงุนุชุจุงุฑ).  ุฃุซูุงุก ุฅุนุงุฏุฉ ุงูุฅูุดุงุก ุ ูููู PostgreSQL ุฃููุงู ุจุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุฌุฏูู ุซู ูููู ูู ูู ููุงุฑุณู ุงููุงุญุฏ ุชูู ุงูุขุฎุฑ.  ููู ูุงุฆู ุ ูุชู ุฅูุดุงุก ูููุงุช ุฌุฏูุฏุฉ ุ ูุชุชู ุฅุฒุงูุฉ ุงููููุงุช ุงููุฏููุฉ ูู ููุงูุฉ ุฅุนุงุฏุฉ ุงูุจูุงุก.  ูุฌุจ ุฃู ูุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ ุฃู ููุงู ุญุงุฌุฉ ุฅูู ูุณุงุญุฉ ุฅุถุงููุฉ ุนูู ุงููุฑุต ูู ูุฐู ุงูุนูููุฉ. <br><br>  ูุชูุถูุญ ุฐูู ุ ุฏุนูุง ูุฏุฑุฌ ูุฑุฉ ุฃุฎุฑู ุนุฏุฏูุง ูุนูููุง ูู ุงูุตููู ูู ุงูุฌุฏูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">TRUNCATE</span></span> vac; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> vac(s) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-string"><span class="hljs-string">'A'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> generate_series(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">500000</span></span>);</code> </pre><br>  ููู ูููููุง ุชูุฏูุฑ ูุซุงูุฉ ุงููุนูููุงุชุ  ููููุงู ุจุฐูู ุ ูู ุงููุฑูุญ ุงุณุชุฎุฏุงู ููุญู ูุชุฎุตุต: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXTENSION</span></span> pgstattuple; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pgstattuple(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>) \gx</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-[ RECORD 1 ]------+--------- table_len | 68272128 tuple_count | 500000 tuple_len | 64500000 tuple_percent | 94.47 dead_tuple_count | 0 dead_tuple_len | 0 dead_tuple_percent | 0 free_space | 38776 free_percent | 0.06</code> </pre><br>  ุชููู ุงููุธููุฉ ุจูุฑุงุกุฉ ุงูุฌุฏูู ุจุฃูููู ูุชุธูุฑ ุงูุฅุญุตุงุฆูุงุช: ุฃู ุงูุจูุงูุงุช ุชุดุบู ูุณุงุญุฉ ูู ุงููููุงุช.  ุงููุนูููุงุช ุงูุฑุฆูุณูุฉ ุงูุชู <code>tuple_percent</code> ุงูุขู ูู ุญูู <code>tuple_percent</code> : ุงููุณุจุฉ ุงููุฆููุฉ ููุจูุงูุงุช ุงููููุฏุฉ.  ุฅูู ุฃูู ูู 100 ุจุณุจุจ ุงููุนูููุงุช ุงูุนุงูุฉ ุงูุชู ูุง ููุฑ ูููุง ุฏุงุฎู ุงูุตูุญุฉ ุ ููููุง ูุง ุชุฒุงู ูุฑุชูุนุฉ. <br><br>  ุจุงููุณุจุฉ ุฅูู ุงูููุฑุณ ุ ูุชู ุฅุฎุฑุงุฌ ุงููุนูููุงุช ุงููุฎุชููุฉ ุ ููู ุญูู <code>avg_leaf_density</code> ูู ููุณ ุงููุนูู: ุงููุณุจุฉ ุงููุฆููุฉ ูููุนูููุงุช ุงููููุฏุฉ (ูู ุงูุตูุญุงุช ุงููุฑููุฉ). <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pgstatindex(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>) \gx</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">-[ RECORD 1 ]------+--------- version | 3 tree_level | 3 index_size | 72802304 root_block_no | 2722 internal_pages | 241 leaf_pages | 8645 empty_pages | 0 deleted_pages | 0 avg_leaf_density | 83.77 leaf_fragmentation | 64.25</code> </pre><br>  ููุฐู ูู ุฃุญุฌุงู ุงูุฌุฏูู ูุงูููุงุฑุณ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_size_pretty(pg_table_size(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>)) table_size, pg_size_pretty(pg_indexes_size(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>)) index_size;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> table_size | index_size ------------+------------ 65 MB | 69 MB (1 row)</code> </pre><br>  ุงูุขู ุฏุนููุง ูุญุฐู 90 ูช ูู ุฌููุน ุงูุตููู.  ูููู ุจุงุฎุชูุงุฑ ุนุดูุงุฆู ูู ุงูุตููู ุงููุฑุงุฏ ุญุฐููุง ุ ูุฐูู ูู ุงููุญุชูู ุฌุฏูุง ุจูุงุก ุตู ูุงุญุฏ ุนูู ุงูุฃูู ูู ูู ุตูุญุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> vac <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> random() &lt; <span class="hljs-number"><span class="hljs-number">0.9</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">DELETE 450189</code> </pre><br>  ูุง ุญุฌู ุงููุงุฆูุงุช ุจุนุฏ ุงููุฑุงุบุ <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> vac; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_size_pretty(pg_table_size(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>)) table_size, pg_size_pretty(pg_indexes_size(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>)) index_size;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> table_size | index_size ------------+------------ 65 MB | 69 MB (1 row)</code> </pre><br>  ูููููุง ุฃู ูุฑู ุฃู ุงูุญุฌู ูู ูุชุบูุฑ: ูุฑุงุบ ูุง ูููู ุจุฃู ุญุงู ูู ุงูุฃุญูุงู ุชูููู ุญุฌู ุงููููุงุช.  ููุฐุง ุนูู ุงูุฑุบู ูู ุฃู ูุซุงูุฉ ุงููุนูููุงุช ุงูุฎูุถุช ุจูุญู 10 ูุฑุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> vac.tuple_percent, vac_s.avg_leaf_density <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pgstattuple(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>) vac, pgstatindex(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>) vac_s;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> tuple_percent | avg_leaf_density ---------------+------------------ 9.41 | 9.73 (1 row)</code> </pre><br>  ุงูุขู ุฏุนููุง ูุชุญูู ููุง ุญุตููุง ุนููู ุจุนุฏ ุงููุฑุงุบ ุงููุงูู.  ุงูุขู ูุณุชุฎุฏู ุงูุฌุฏูู ูุงูููุงุฑุณ ุงููููุงุช ุงูุชุงููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_relation_filepath(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>), pg_relation_filepath(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_relation_filepath | pg_relation_filepath ----------------------+---------------------- base/41493/57392 | base/41493/57393 (1 row)</code> </pre><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">VACUUM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FULL</span></span> vac; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_relation_filepath(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>), pg_relation_filepath(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>);</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_relation_filepath | pg_relation_filepath ----------------------+---------------------- base/41493/57404 | base/41493/57407 (1 row)</code> </pre><br>  ูุชู ุงุณุชุจุฏุงู ุงููููุงุช ุจุฃุฎุฑู ุฌุฏูุฏุฉ ุงูุขู.  ุงูุฎูุถุช ุฃุญุฌุงู ุงูุฌุฏูู ูุงูููุงุฑุณ ุจุดูู ูุจูุฑ ุ ุจูููุง ุฒุงุฏุช ูุซุงูุฉ ุงููุนูููุงุช ููููุง ูุฐูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_size_pretty(pg_table_size(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>)) table_size, pg_size_pretty(pg_indexes_size(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>)) index_size;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> table_size | index_size ------------+------------ 6648 kB | 6480 kB (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> vac.tuple_percent, vac_s.avg_leaf_density <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pgstattuple(<span class="hljs-string"><span class="hljs-string">'vac'</span></span>) vac, pgstatindex(<span class="hljs-string"><span class="hljs-string">'vac_s'</span></span>) vac_s;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> tuple_percent | avg_leaf_density ---------------+------------------ 94.39 | 91.08 (1 row)</code> </pre><br>  ูุงุญุธ ุฃู ูุซุงูุฉ ุงููุนูููุงุช ูู ุงูููุฑุณ ุฃูุจุฑ ูู ุงููุซุงูุฉ ุงูุฃุตููุฉ.  ูู ุงูุฃูุถู ุฅุนุงุฏุฉ ุฅูุดุงุก ููุฑุณ (ุดุฌุฑุฉ B) ูู ุงูุจูุงูุงุช ุงููุชุงุญุฉ ุจุฏูุงู ูู ุฅุฏุฑุงุฌ ุงูุจูุงูุงุช ูู ุตู ููุฑุณ ููุฌูุฏ ุญุงูููุง. <br><br>  ูุธุงุฆู ููุญู <a href="https://postgrespro.com/docs/postgresql/11/pgstattuple">pgstattuple</a> ุงูุชู ุงุณุชุฎุฏููุงูุง ูุฑุงุกุฉ ุงูุฌุฏูู ุจุฃูููู.  ููู ูุฐุง ุบูุฑ ูุฑูุญ ุฅุฐุง ูุงู ุงูุฌุฏูู ูุจูุฑูุง ุ ูุฐุง ูุฅู ุงูููุญู ูุญุชูู ุนูู ูุธููุฉ <code>pgstattuple_approx</code> ุ ุงูุชู ุชุชุฎุทู ุงูุตูุญุงุช ุงููุญุฏุฏุฉ ูู ุฎุฑูุทุฉ ุงูุฑุคูุฉ ูุชุธูุฑ ุงูุฃุฑูุงู ุงูุชูุฑูุจูุฉ. <br><br>  ููุงู ุทุฑููุฉ ุฃุฎุฑู ุ ูููููุง ุฃูู ุฏูุฉ ุ ููู ุงุณุชุฎุฏุงู ูุชุงููุฌ ุงููุธุงู ูุชูุฏูุฑ ูุณุจุฉ ุญุฌู ุงูุจูุงูุงุช ุฅูู ุญุฌู ุงูููู ุชูุฑูุจูุง.  ููููู ุงูุนุซูุฑ ุนูู ุฃูุซูุฉ ูู ูุฐู ุงูุงุณุชุนูุงูุงุช <a href="https://wiki.postgresql.org/wiki/Show_database_bloat">ูู ุงููููู</a> . <br><br>  VACUUM FULL ุบูุฑ ูุฎุตุต ููุงุณุชุฎุฏุงู ุงูููุชุธู ูุฃูู ูุญุธุฑ ุฃู ุนูู ูุน ุงูุฌุฏูู (ูุชู ุชุถููู ุงูุงุณุชุนูุงู) ุทูุงู ูุฏุฉ ุงูุนูููุฉ.  ูู ุงููุงุถุญ ุฃูู ุจุงููุณุจุฉ ูููุธุงู ุงููุณุชุฎุฏู ุจูุซุฑุฉ ุ ููุฏ ูุจุฏู ูุฐุง ุบูุฑ ููุจูู.  ุณุชุชู ููุงูุดุฉ ุงูุฃููุงู ุจุดูู ูููุตู ุ ููู ูุฐูุฑ ุงูุขู ุณูู ููุญู <a href="https://github.com/reorg/pg_repack">pg_repack</a> ุ ุงูุฐู <a href="https://github.com/reorg/pg_repack">ูุบูู</a> ุงูุทุงููุฉ ููุชุฑุฉ ูุตูุฑุฉ ูู ุงูููุช ููุท ูู ููุงูุฉ ุงูุนูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุฃูุงูุฑ ููุงุซูุฉ </h2><br>  ููุงู ุจุนุถ ุงูุฃูุงูุฑ ุงูุชู ุชููู ุฃูุถูุง ุจุฅุนุงุฏุฉ ุฅูุดุงุก ุงูุฌุฏุงูู ูุงูููุงุฑุณ ุจุงููุงูู ูุจุงูุชุงูู ุชุดุจู VACUUM FULL.  ุฌููุนูู ูุญุธุฑูู ุชูุงููุง ุฃู ุนูู ูุน ุงูุฌุฏูู ุ ููููููู ุฌููุนูุง ุจุฅุฒุงูุฉ ูููุงุช ุงูุจูุงูุงุช ุงููุฏููุฉ ูุฅูุดุงุก ูููุงุช ุฌุฏูุฏุฉ. <br><br>  ูุชุดุงุจู ุงูุฃูุฑ CLUSTER ูุน VACUUM FULL ุ ููููู ุฃูุถูุง ูุทูุจ ุฃูุงูุฑูุง ูุนููุฉ ููููุง ูุฃุญุฏ ุงูููุงุฑุณ ุงููุชุงุญุฉ.  ูุชูุญ ุฐูู ูููุฎุทุท ุงุณุชุฎุฏุงู ุงููุตูู ุฅูู ุงูููุฑุณ ุจุดูู ุฃูุซุฑ ููุงุกุฉ ูู ุจุนุถ ุงูุญุงูุงุช.  ูููู ูุฌุจ ุฃู ูุถุน ูู ุงุนุชุจุงุฑูุง ุฃูู ูุง ูุชู ุงูุงุญุชูุงุธ ุจุงูุชุฌููุน: ุณูุชู ูุณุฑ ุงูุชุฑุชูุจ ุงููุงุฏู ูู tuples ุจุงูุชุบููุฑุงุช ุงููุงุญูุฉ ููุฌุฏูู. <br><br>  ูุนูุฏ ุงูุฃูุฑ REINDEX ุฅูุดุงุก ููุฑุณ ูููุตู ุนูู ุงูุฌุฏูู.  ูุฑุงุบ ูุงูู ู CLUSTER ูุนููุงู ุงุณุชุฎุฏุงู ูุฐุง ุงูุฃูุฑ ูุฅุนุงุฏุฉ ุฅูุดุงุก ุงูููุงุฑุณ. <br><br>  ูุดุจู ููุทู ุฃูุฑ TRUNCATE ููุทู DELETE - ูุญุฐู ุฌููุน ุตููู ุงูุฌุฏูู.  ููู DELETE ุ ููุง ุฐูุฑูุง ุณุงุจููุง ุ ุชููู ููุท ุจุชุญุฏูุฏ ุงูุนูุงูุงุช ุนูู ุฃููุง ูุญุฐููุฉ ุ ููุฐุง ูุชุทูุจ ูุฒูุฏูุง ูู ุงููุฑุงุบ.  ููุคุฏู TRUNCATE ููุท ุฅูู ุฅูุดุงุก ููู ุฌุฏูุฏ ููุธูู ุจุฏูุงู ูู ุฐูู.  ููุงุนุฏุฉ ุนุงูุฉ ุ ูุนูู ูุฐุง ุจุดูู ุฃุณุฑุน ุ ูููู ูุฌุจ ุฃู ูุถุน ูู ุงูุงุนุชุจุงุฑ ุฃู TRUNCATE ุณูููุน ุฃู ุนูู ูุน ุงูุฌุฏูู ุญุชู ููุงูุฉ ุงููุนุงููุฉ. <br><br>  <a href="https://habr.com/ru/company/postgrespro/blog/486104/">ุงูุฑุฃ ุนูู</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar484106/">https://habr.com/ru/post/ar484106/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar484092/index.html">ุฃูุฑุงุก ููุจูุงุก ูุฑุชุฏูู ููุงุจุณ ุฅูู ุญุฏ ูุง</a></li>
<li><a href="../ar484094/index.html">ุฅูุดุงุก ูุทูู ุงููุงุฑ ุบูุจูุจุฉ ุงูุดุฎุต ุงูุซุงูุซ ูุน DOTS</a></li>
<li><a href="../ar484096/index.html">ูุนุฑูุฉ ุงุซููู Yakozun ุ ุฃู ูุงุณุงูุฏุฑุง ุถุฏ HBase. ุชุฌุฑุจุฉ ูุฑูู ุณุจูุฑุจูู</a></li>
<li><a href="../ar484100/index.html">ุงูุนูู ูุน ุงููุงุฌูุฉ ูู ุฎุฑุงุฆุท Google SDK ููุธุงู Android</a></li>
<li><a href="../ar484102/index.html">PHP ููุงุจู ุจูุซูู ุถุฏ ุฑูุจู ุนูู ุงููุถุจุงู: ููุงุฑูุฉ ููุตูุฉ</a></li>
<li><a href="../ar484108/index.html">Encapsulator Etherblade.net ูุงุณุชุจุฏุงู ุงุณุชุจุฏุงู ููููุงุช ุงูุดุจูุฉ (ุงูุฌุฒุก ุงูุซุงูู)</a></li>
<li><a href="../ar484112/index.html">ูู ูู ุงููููู ุงุฎุชุฑุงู ุงูุทุงุฆุฑุฉ</a></li>
<li><a href="../ar484114/index.html">ูุฌููุนุฉ ูุฎุชุงุฑุฉ ูู 143 ุชุฑุฌูุฉ ูููุงู ุจูู ุบุฑุงูุงู (ูู 184)</a></li>
<li><a href="../ar484118/index.html">32 ููุงูุฑ</a></li>
<li><a href="../ar484120/index.html">ุฃูุซุฑ ุงูููุงุฑุงุช ุงููุทููุจุฉ ูู ูููุฉ ูููุฏุณ ุงูุจูุงูุงุช</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>