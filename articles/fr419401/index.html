<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>♊️ 👨‍⚕️ ☝🏽 Interfaces de ligne de commande Java: picocli 🛌🏾 🈺 🧦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous! 

 Le prochain démarrage du groupe Java Developer , au cours duquel nous poursuivons tous notre expérience du fait que le processus d'...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Interfaces de ligne de commande Java: picocli</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/419401/"> Bonjour à tous! <br><br>  Le prochain démarrage du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">groupe Java Developer</a> , au cours duquel nous poursuivons tous notre expérience du fait que le processus d'apprentissage ne doit pas être continu ("La controversion doit-elle être continue?").  Autrement dit, nous avons légèrement retravaillé et mélangé le programme, et l'avons divisé en trois étapes, qui peuvent être facilement passées avec une pause entre elles.  En général, c'est intéressant aussi bien pour les étudiants que pour nous, si seulement personne n'était mouillé, sinon le programme semblerait même un peu plus compliqué, même si ce n'était pas facile avant ça.  Eh bien, un article traditionnellement intéressant lié à notre cours. <br><br>  C'est parti! <br><br><img src="https://habrastorage.org/webt/op/zt/xy/opztxye_lbi2eq1jlkb1i-yvuz4.png"><a name="habracut"></a><br><br>  Sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">site officiel,</a> picocli est décrit comme «une petite interface de ligne de commande puissante», qui «est un cadre Java à fichier unique pour analyser les arguments de la ligne de commande et créer des messages d'aide sans défaut et facilement personnalisables.  Avec des fleurs. "  Cet article fournit un <a href="">bref aperçu de Picocli 0.9.7</a> et de son utilisation pour analyser des arguments de ligne de commande dans du code Java. <br><br>  Comme les autres bibliothèques de traitement en ligne de commande Java décrites dans cette série, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">picocli est open source</a> .  Étant donné que tous les picocli sont implémentés dans un seul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fichier Java</a> , vous pouvez facilement utiliser le code source directement si vous le souhaitez.  Le site picocli souligne que "la particularité de picocli est qu'il permet aux utilisateurs d'exécuter des applications qui utilisent picocli sans exiger picocli lui-même comme une dépendance externe: tout le code source est situé dans un fichier pour encourager les auteurs d'applications à l'inclure dans le code source du programme" . Si vous préférez utiliser picocli comme une bibliothèque, dans le référentiel Maven dispose d' un <a href="">fichier JAR-</a> avec l'ensemble des fichiers compilés (picocli représente un Java fichier, mais contient de nombreuses sous-classes et annotations  s). <br><br>  Le moyen le plus simple de se faire une idée de la nature d'un fichier unique de Picocli est de jeter un œil au fichier lui-même.  Le code source de CommandLine.java est disponible sur la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">page de</a> téléchargement de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Picocli</a> .  Les deux captures d'écran suivantes montrent la sortie de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">javap</a> lors de l'exécution de la classe CommandLine et lors de l'exécution de l'une de ses annotations internes et de l'une de ses classes internes. <br><br><img src="https://habrastorage.org/webt/ly/pz/rd/lypzrdilo683xyhgaldpf2iplng.png"><br><br><img src="https://habrastorage.org/webt/w8/sp/a6/w8spa6ghbqwnaxatgnmozur4ofk.png"><br><br>  Que nous compilions CommandLine.java dans notre propre fichier classe / JAR ou que nous utilisions le JAR déjà construit de Maven, le code source de l'application utilisant Picocli sera évidemment le même.  La phase de «détermination» de l'analyse des arguments à l'aide de Picocli est accomplie en annotant les champs de l'instance qui stockeront les valeurs associées aux paramètres de ligne de commande.  Ceci est illustré dans l'extrait de code ci-dessous. <br><br>  <b>Étape de «définition» de Picocli</b> <br><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/*     Java   picocli. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Command</span></span>( name=<span class="hljs-string"><span class="hljs-string">"Main"</span></span>, description=<span class="hljs-string"><span class="hljs-string">"Demonstrating picocli"</span></span>, headerHeading=<span class="hljs-string"><span class="hljs-string">"Demonstration Usage:%n%n"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Option</span></span>(names={<span class="hljs-string"><span class="hljs-string">"-v"</span></span>, <span class="hljs-string"><span class="hljs-string">"--verbose"</span></span>}, description=<span class="hljs-string"><span class="hljs-string">"Verbose output?"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> verbose; <span class="hljs-meta"><span class="hljs-meta">@Option</span></span>(names={<span class="hljs-string"><span class="hljs-string">"-f"</span></span>, <span class="hljs-string"><span class="hljs-string">"--file"</span></span>}, description=<span class="hljs-string"><span class="hljs-string">"Path and name of file"</span></span>, required=<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String fileName; <span class="hljs-meta"><span class="hljs-meta">@Option</span></span>(names={<span class="hljs-string"><span class="hljs-string">"-h"</span></span>, <span class="hljs-string"><span class="hljs-string">"--help"</span></span>}, description=<span class="hljs-string"><span class="hljs-string">"Display help/usage."</span></span>, help=<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> help;</code> </pre> <br>  L'exemple de code ci-dessus montre que Picocli vous permet de spécifier plusieurs noms d'indicateur (dans mon exemple, les noms à un caractère avec un trait d'union et les noms à plusieurs caractères avec deux traits d'union).  Cet exemple montre également que required = true peut être défini pour les paramètres requis et help = true peut être spécifié pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les options auxiliaires</a> , telles que l'impression des détails d'utilisation et l'élimination des erreurs liées à l'absence de paramètres requis.  Notez que Picocli 0.9.8 ajoute une prise en charge supplémentaire pour les types de messages d'assistance plus spécifiques <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">versionHelp</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">usageHelp</a> . <br><br>  L'étape «d'analyse» dans Picocli est effectuée dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CommandLine.populateCommand (T, String ...)</a> , où T est une instance de la classe avec des champs annotés Picocli, et les lignes restantes sont les arguments qui doivent être analysés.  Cela est illustré dans l'extrait de code suivant. <br>  <b>Phase d'analyse de Picocli</b> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Main main = CommandLine.populateCommand(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Main(), arguments);</code> </pre> <br>  L'étape «polling» de Picocli consiste à accéder simplement aux champs annotés Picocli de l'instance qui ont été passés à la méthode CommandLine.populateCommand (T, String ...) à l'étape «parsing».  Un exemple simple d'une telle «enquête» est présenté dans la liste suivante. <br><br>  <b>Phase d'enquête Picocli</b> <br><br><pre> <code class="java hljs">out.println( <span class="hljs-string"><span class="hljs-string">"The provided file path and name is "</span></span> + main.fileName + <span class="hljs-string"><span class="hljs-string">" and verbosity is set to "</span></span> + main.verbose);</code> </pre> <br>  L'affichage de messages auxiliaires ou d'informations d'utilisation à l'utilisateur lorsque -h ou --help est spécifié sur la ligne de commande est aussi simple que «d'interroger» un champ annoté Picocli pour lequel help = true a été spécifié pour déterminer si cette valeur booléenne a été définie ou non et, si elle est installée, appelez l'une des méthodes CommandLine.usage surchargées.  J'ai dû utiliser l'une des versions statiques de cette méthode, comme indiqué dans la liste suivante. <br><br>  <b>Messages d'assistance / informations d'utilisation dans Picocli</b> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (main.help) { CommandLine.usage(main, out, CommandLine.Help.Ansi.AUTO); }</code> </pre><br>  Les quelques captures d'écran suivantes illustrent une application simple écrite à l'aide de picocli.  La première capture d'écran montre le type de message d'erreur et la trace de pile si l'indicateur requis est manquant.  La deuxième capture d'écran montre comment les noms longs et courts spécifiés dans les annotations sont utilisés.  La troisième image montre la fonction d'affichage des messages auxiliaires en action. <br><br><img src="https://habrastorage.org/webt/us/sj/4d/ussj4dkuaajcytgltr_vkytopzk.png"><br><img src="https://habrastorage.org/webt/pm/qs/wd/pmqswdqvi8e9yeu3qmfdc0t7jl8.png"><br><img src="https://habrastorage.org/webt/gf/rb/uo/gfrbuozuswdqrb06-h9sth0f_b8.png"><br><br>  L'une des fonctionnalités supplémentaires de Picocli, qui n'est pas disponible dans de nombreuses autres bibliothèques d'analyse d'arguments en ligne de commande Java, est la prise en charge de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la syntaxe des couleurs</a> a.  La première liste de ce message avait des lignes définies dans les annotations avec @ |  |  @ syntaxe.  Dans la capture d'écran ci-dessus, qui montre l'utilisation de messages auxiliaires, ces caractères ont été transmis tels quels, sans traitement spécial.  Cependant, si j'exécute cet exemple de code dans Cygwin, je verrai ce que ces signes font. <br><br><img src="https://habrastorage.org/webt/hl/d2/gm/hld2gm792xahxrehyp-g-uz8tlm.png"><br><br>  Dans la capture d'écran ci-dessus, nous voyons que Picocli a automatiquement appliqué la syntaxe de couleur (jaune et blanc) aux options de message auxiliaire et a également appliqué la syntaxe en gras et soulignée aux zones avec la description des messages auxiliaires où la syntaxe @ | a été appliquée  |  @. <br><br>  Les fonctionnalités suivantes de Picocli sont à prendre en compte lors du choix d'un framework ou d'une bibliothèque pour faciliter l'analyse des arguments de ligne de commande en Java. <br><br><ul><li>  Picocli est un projet open source <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sous licence</a> avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apache 2.0.</a> </li><li>  Picocli ne nécessite pas de télécharger des bibliothèques ou des frameworks tiers. </li><li>  Tout le code source de Picocli est contenu dans un seul fichier .java, et ce code peut être copié et collé dans son propre système de gestion de configuration et compilé avec le reste du code d'application, ce qui signifie que même le fichier JAR Picocli n'est pas nécessaire. </li><li>  Le fichier source CommandLine.java (Picocli 0.9.7) contient un peu plus de 3 700 lignes (espaces et commentaires inclus) et pèse près de 200 Ko.  Le fichier picocli-0.9.7.jar pèse environ 83 Ko. </li><li>  Picocli est opportun et fréquemment mis à jour.  La version 0.9.8 a été publiée hier (après avoir écrit la plupart de ce post). </li><li>  Picocli possède <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une documentation très détaillée</a> et est à bien des égards plus à jour que la documentation de certaines autres bibliothèques de traitement en ligne de commande Java. </li><li>  La prise en charge de la syntaxe des couleurs de Picocli est facile à utiliser et l'aide à l'utilisation de la syntaxe des couleurs sur toutes les plateformes est documentée dans la section <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Plateformes prises</a> en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">charge</a> . </li><li>  L'utilisation d'annotations Picocli pour les champs de niveau instance est similaire à l'utilisation d'annotations dans certaines autres bibliothèques de traitement de ligne de commande et présente les mêmes avantages. </li><li>  Les principales fonctionnalités de Picocli sont très pratiques et faciles à apprendre, mais Picocli prend également en charge la possibilité de configurer plusieurs aspects du traitement en ligne de commande à l'aide de Picocli. </li></ul><br>  Les listes de cet article sont entièrement disponibles sur <a href="">GitHub</a> . <br><br>  Picocli est une bibliothèque prise en charge et mise à jour pour l'analyse des arguments de ligne de commande Java.  Il contient plusieurs nouvelles fonctionnalités et approches de certaines autres bibliothèques de traitement de ligne de commande disponibles écrites en Java, mais quelques fonctionnalités différentes y ont été ajoutées (telles que la syntaxe des couleurs et la bibliothèque entière encapsulée dans un fichier Java source).  Picocli est assez facile à utiliser et attrayant en soi, mais il se démarquera probablement parmi d'autres bibliothèques pour un développeur individuel si ce développeur souhaite prendre en charge la syntaxe des couleurs ou la possibilité d'ajouter un fichier de code source au projet du développeur sans fichiers JAR supplémentaires ou compilés. fichiers de classe. <br><br>  LA FIN <br><br>  Comme toujours, nous attendons vos questions et commentaires. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419401/">https://habr.com/ru/post/fr419401/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419389/index.html">Moteur de rendu Angular 6 et Ivy</a></li>
<li><a href="../fr419391/index.html">Puissance, argent et open source. Expliquer comment la communauté fonctionne avec Apache Ignite</a></li>
<li><a href="../fr419393/index.html">Créer une passerelle API simple dans ASP.NET Core</a></li>
<li><a href="../fr419395/index.html">Explication des expressions lambda</a></li>
<li><a href="../fr419399/index.html">OpenAI Five bat une équipe de personnes dans un match show Dota 2</a></li>
<li><a href="../fr419405/index.html">Comment vont les choses avec IPv6, ou ce qui entrave la transition vers une nouvelle version du protocole - discuter de la situation</a></li>
<li><a href="../fr419407/index.html">Une analyse détaillée de la correspondance Dota 2 entre OpenAI et les gens au format 5x5. Les gens ont perdu</a></li>
<li><a href="../fr419409/index.html">Nouveaux NUC Intel basés sur les processeurs Coffee Lake</a></li>
<li><a href="../fr419411/index.html">À propos du feu dans un gratte-ciel. Cinéma et réalité</a></li>
<li><a href="../fr419413/index.html">Chisel - (pas tout à fait) une nouvelle approche du développement de la logique numérique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>